var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__decorate=this&&this.__decorate||function(t,e,i,n){var o,s=arguments.length,r=3>s?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(3>s?o(r):s>3?o(e,i,r):o(e,i))||r);return s>3&&r&&Object.defineProperty(e,i,r),r},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,s){function r(t){try{l(n.next(t))}catch(e){s(e)}}function a(t){try{l(n["throw"](t))}catch(e){s(e)}}function l(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(r,a)}l((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,s&&(r=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(r=r.call(s,i[1])).done)return r;switch(s=0,r&&(i=[0,r.value]),i[0]){case 0:case 1:r=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,s=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(r=l.trys,!(r=r.length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){l.label=i[1];break}if(6===i[0]&&l.label<r[1]){l.label=r[1],r=i;break}if(r&&l.label<r[2]){l.label=r[2],l.ops.push(i);break}r[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(n){i=[6,n],s=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,s,r,a,l={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},WorldBossHeadItemRender=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isAddEff=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.haveGuildName(!1),this.isAddEff=!1,this.data instanceof UnitMonster)this.currentState="war",this.updateChar(this.data);else if(isNaN(this.data))this.data instanceof SelectInfoData&&(this.currentState="panel",this.num.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("part",this.data.num)),this.roleName.textFlow=(new egret.HtmlTextParser).parser(this.data.data.name),this.roleHead.source="yuanhead"+this.data.data.job+this.data.data.sex);else if(this.currentState="war",this.data){var t=UnitMgr.ins().getEntityByHandle(this.data)||UnitMgr.ins().getEntityBymasterhHandle(this.data);if(t)this.updateChar(t);else if(crossBossControl.isKFBossBattle&&crossBossControl.flagHandle==this.data){var e=DataCenter.ins().MonstersConfig[DataCenter.ins().CrossBossBaseConfig.flagId];if(e&&this.checkMonHead(e)){var i=crossBossControl.flagCD-egret.getTimer(),n=DateUtils.getFormatBySecond(i/1e3);0>=i?(n="",this.haveGuildName(!1)):this.haveGuildName(!0);var o=e.name+"\n|C:"+ColorUtils.RED+"&T:"+n+"|";this.roleName.textFlow=TextUtils.generateTextFlow1(o),this.roleHead.source="monhead"+e.head+"_png",this.addAttEffect()}}else if(crossArenaControl.isKFArena&&crossArenaControl.flagHandle==this.data){var e=DataCenter.ins().MonstersConfig[DataCenter.ins().CrossArenaBaseConfig.flagBossId];if(e&&this.checkMonHead(e)){var i=crossArenaControl.flagCD-egret.getTimer(),n=DateUtils.getFormatBySecond(i/1e3);0>=i?(n="",this.haveGuildName(!1)):this.haveGuildName(!0);var o=e.name+"\n|C:"+ColorUtils.RED+"&T:"+n+"|";this.roleName.textFlow=TextUtils.generateTextFlow1(o),this.roleHead.source="monhead"+e.head+"_png",this.addAttEffect()}}}else{var s=DataCenter.ins().MonstersConfig[bossControl.monsterID];s&&this.checkMonHead(s)&&(this.roleName.textFlow=(new egret.HtmlTextParser).parser(s.name),this.roleHead.source="monhead"+s.head+"_png",this.addAttEffect())}this.isAddEff||this.removeAttEffect()},e.prototype.checkMonHead=function(t){return!Assert(t.head,LangMgr.getValueByKey("babelError1",t.id,t.name))},e.prototype.updateChar=function(t){if(t instanceof UnitRole){var e=t.infoModel;if(18==MapControl.copyType){var i=e.name;if(4==e.type){var n=i.split("\n");i=n[1]?n[1]:n[0],i=StringUtils.replaceStr(i,"0xffffff",this.roleName.textColor+"")}this.roleName.textFlow=TextUtils.generateTextFlow1(i)}else{var o=e.guildName?"\n<font color='#6495ed'>"+e.guildName+"</font>":"",s=devildomControl.isDevildomBattle&&o?e.name+o:e.getNameWithServer2();s.indexOf("\n")>-1&&this.haveGuildName(!0),this.roleName.textFlow=(new egret.HtmlTextParser).parser(s)}if(Assert(e.job,LangMgr.getValueByKey("bossError2")+"，id:"+e.configID+",name:"+e.name))return;this.roleHead.source="yuanhead"+e.job+e.sex,this.checkIsCurrAttack(e.handle)&&this.addAttEffect()}else{var r=t;if(2==r.infoModel.type||crossBossControl.isKFBossBattle&&5==r.infoModel.type){var a=DataCenter.ins().MonstersConfig[r.infoModel.configID];if(Assert(a,LangMgr.getValueByKey("bossError3")+" id:"+r.infoModel.configID))return;if(!this.checkMonHead(a))return;this.roleName.textFlow=(new egret.HtmlTextParser).parser(a.name),this.roleHead.source="monhead"+a.head+"_png",this.checkIsCurrAttack(r.infoModel.handle)&&this.addAttEffect()}}},e.prototype.checkIsCurrAttack=function(t){var e=UnitMgr.ins().getRootMasterHandle(gameControl.currAttackHandle);return e==UnitMgr.ins().getRootMasterHandle(t)},e.prototype.addAttEffect=function(){t.prototype.addAttEffect.call(this),this.isAddEff=!0},e}(UnionWarMemberHeadItemRender);__reflect(WorldBossHeadItemRender.prototype,"WorldBossHeadItemRender");var AmusementBaseDataVo=function(){function t(){this._firstRedPoint=!1}return t.prototype.initAmusement=function(t){},t.prototype.updateAmusement=function(t){},t.prototype.updateAmusementExt=function(t){},t.prototype.canReward=function(){return!1},t.prototype.isOpenActivity=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return 0>t&&e>0},Object.defineProperty(t.prototype,"rewardState",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.specialState=function(){return!0},t.prototype.getHide=function(){return!1},t.prototype.loginRedPoint=function(){return!1},t.prototype.getLeftTime=function(){if(this.endTime){var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return 0>t&&(t=0),t}return 0},t.prototype.getZsLvEndActivity=function(){if(1==AmusementPanel.getAmusementTypeFromId(this.id)){var t=DataCenter.ins().PAmusementConfig[this.id];if(t&&t.endZslv&&reincarnateControl.lv>=t.endZslv)return!0}return!1},Object.defineProperty(t.prototype,"firstRedPoint",{get:function(){return this._firstRedPoint},set:function(t){if(5029==this.id){var e=ServerStorage.ins().getBitValue(ClientSetBit.activity5029);e||(this._firstRedPoint=t,t||ServerStorage.ins().setBitValue(ClientSetBit.activity5029,1))}else this._firstRedPoint=t},enumerable:!0,configurable:!0}),t}();__reflect(AmusementBaseDataVo.prototype,"AmusementBaseDataVo");var PortalBase=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this)||this;return n.isShow=!1,n.msgObject={},n.isDelayUpdateShow=!1,n.isDelayUpdate=!1,n.id=e,n.tar=i,n}return __extends(e,t),e.prototype.addCustomEvent=function(t,e){var i=""+t,n=this.msgObject[i]=this.msgObject[i]||[];-1==n.indexOf(e)&&(n.push(e),EventMgr.addListener(t,e,this))},e.prototype.getTar=function(){return this.tar?this.tar:this.createTar()},e.prototype.createTar=function(){var t=this.getConfig(),e=t.iconCls?egret.getDefinitionByName(t.iconCls):eui.Button,i=new e;if(t.iconSkin?i.skinName=t.iconSkin:i.skinName="MainButtonSkin",t.icon&&(i.icon=t.icon),t.iconParam)for(var n in t.iconParam)i[n]=t.iconParam[n];return this.tar=i,this.tar.leftGroup&&(this.tar.leftGroup.visible=!1),i},e.prototype.getConfig=function(){return DataCenter.ins().PortalConfig[this.id]},e.prototype.delayUpdateShow=function(){this.isDelayUpdateShow||(this.isDelayUpdateShow=!0,TimerMgr.ins().doTimer(100,1,this.updateShow,this))},e.prototype.updateShow=function(){this.isDelayUpdateShow=!1,e.updateShow(this)},e.prototype.delayUpdate=function(){this.isDelayUpdate||(this.isDelayUpdate=!0,TimerMgr.ins().doTimer(100,1,this.update,this))},e.prototype.update=function(){this.isDelayUpdate=!1,e.update(this)},e.prototype.checkShowIcon=function(){return!0},e.prototype.onAddToStage=function(){},e.prototype.onRemoveFromStage=function(){},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return null},e.prototype.tapExecute=function(){},e.prototype.addShowEvents=function(){if(this.showMessage)for(var t=0,e=this.showMessage;t<e.length;t++){var i=e[t];this.addCustomEvent(i,this.delayUpdateShow)}},e.prototype.addRedEvents=function(){if(this.updateMessage)for(var t=0,e=this.updateMessage;t<e.length;t++){var i=e[t];this.addCustomEvent(i,this.delayUpdate)}},e.prototype.removeRedEvents=function(){if(this.updateMessage)for(var t=0,e=this.updateMessage;t<e.length;t++){var i=e[t],n=""+i;if(EventMgr.removeListener(i,this.delayUpdate,this),this.msgObject.hasOwnProperty(n)){var o=this.msgObject[n],s=o.indexOf(this.delayUpdate);s>-1&&o.splice(s,1),o.length||delete this.msgObject[n]}}},e.prototype.removeEvents=function(){var t=Object.keys(this.msgObject);t.length&&(EventMgr.ins().removeAll(this,t),this.msgObject={})},e.prototype.getTarImg=function(){return this.tar&&this.tar.img?this.tar.img:null},e.prototype.setTarImg=function(t){if(void 0===t&&(t=""),this.tar&&this.tar.img){this.tar.img.source=t,this.tar.img.visible=t?!0:!1;var e=this.getConfig();if(e.imgData)for(var i in e.imgData)this.tar.img[i]=e.imgData[i]}},e}(egret.HashObject);__reflect(PortalBase.prototype,"PortalBase");var RankDataBaseVo=function(){function t(){}return t}();__reflect(RankDataBaseVo.prototype,"RankDataBaseVo");var DominateBossRedpoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=0,e.redpoint_1=[],e.type=10,e.addCustomEventMany(e.dispatchRedPoint,296,549),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){if(this.redpoint_1=[],this.redpoint=0,dominateBossControl.checkOpen()&&bossControl.worldInfoList[this.type]&&bossControl.worldBossBelongTime[this.type]){for(var t=bossControl.worldInfoList[this.type].slice(),e=dominateEquipControl.getTotalScore(),i=0;i<t.length;i++){var n=t[i],o=DataCenter.ins().WorldBossConfig[n.id].zhuzaiScore,s=n.canInto&&!n.isDie&&e>=o&&bossControl.getBossRemindByIndex(n.id);this.redpoint_1[n.id]=s?1:0}this.redpoint=this.redpoint_1.indexOf(1)>-1?1:0}EventMgr.ins().dispatch(548,this.redpoint)},e}(BaseSystem);__reflect(DominateBossRedpoint.prototype,"DominateBossRedpoint");var AmusementBaseView=function(t){function e(){var e=t.call(this)||this;return e.amusementPanelList=[],e.selectIndex=0,e.isTopLevel=!0,e}return __extends(e,t),e.openCheck=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t[0],o=t[1],s=AmusementControl.ins(),r=PAmusementControl.ins();if(void 0!=n){var a=s.getAmusementDataById(n),l=r.getAmusementDataById(n);if(!(a&&a.isOpenActivity()||l&&l.isOpenActivity()))return tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivityColor")),!1}var h=t[2]||e.openCheckActivityins,u=t[3]||e.openCheckPActivityins,p=s.activityData;for(var c in p)if(p[c]&&!h(p[c],o)&&s.getAmusementDataById(+c).isOpenActivity())return!0;p=r.activityData;for(var c in p)if(p[c]&&!u(p[c],o)&&r.getAmusementDataById(+c).isOpenActivity())return!0;return tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e.openCheckActivityins=function(t,e){var i=e;return!t.pageType||t.pageType!=i},e.openCheckPActivityins=function(t,e){var i=e;return!t.pageType||t.pageType!=i},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.actId=t[0],this.menuList.itemRenderer=AmusementBtnItemRender,this.closeBtn&&this.addEventTouchTap(this.closeBtn,this.onClick),this.menuList&&this.addEventChange(this.menuList,this.onClickMenu),this.leftBtn&&this.addEventTouchTap(this.leftBtn,this.onTouchBtn),this.rightBtn&&this.addEventTouchTap(this.rightBtn,this.onTouchBtn),this.addCustomEvent(4,this.zeroUpdate),this.addCustomEvent(395,this.ChangePageCallBack),this.addCustomEvent(403,this.updatePanel),this.addCustomEvent(440,this.updatePanel),this.addCustomEvent(439,this.ChangePageCallBack),this.seeRule&&this.addEventTouchTap(this.seeRule,this.onClick),this.addEventChange(this.menuScroller,this.onChange)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.amusementPanelList.length;i++)this.amusementPanelList[i].close()},e.prototype.refushRedPoint=function(){this.dataArr.replaceAll(this.BtnArr),this.menuList.dataProvider=this.dataArr},e.prototype.updateView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.pageType=t[0];for(var i=0;i<this.viewStack.numElements;i++)ObjectPool.push(this.viewStack.getElementAt(i));this.viewStack.removeChildren(),this.amusementPanelList=[],this._datas=[],this.getDataUpdataView(),this.startUpdataView()},e.prototype.getDataUpdataView=function(){var t=AmusementControl.ins(),e=PAmusementControl.ins();for(var i in t.activityData)if(t.activityData[i]&&!this.activityFiltrate(t.activityData[i])&&t.getAmusementDataById(+i).isOpenActivity()){var n=t.getbtnInfo(i);if(!n||n.activityType&&2==n.activityType)continue;Assert(n,"AmusementControl  data   "+i)||this._datas.push(n)}for(var i in e.activityData)if(e.activityData[i]&&!this.pActivityFiltrate(e.activityData[i])&&e.getAmusementDataById(+i).isOpenActivity()){var n=e.getbtnInfo(i);if(!n||n.activityType&&2==n.activityType)continue;Assert(n,"PAmusementControl  data   "+i)||this._datas.push(n)}},e.prototype.activityFiltrate=function(t){return t.pageType!=this.pageType},e.prototype.pActivityFiltrate=function(t){return t.pageType!=this.pageType},e.prototype.startUpdataView=function(){var t=AmusementControl.ins(),e=PAmusementControl.ins();this._datas.sort(this.sort),this.BtnArr=[];var i=0,n=0;for(var o in this._datas){var s=this._datas[o].id,r=void 0;if(0==this._datas[o].activityType?r=t.getAmusementDataById(+s):1==this._datas[o].activityType&&(r=e.getAmusementDataById(+s)),r&&r.id==s){var a=r.getHide();if(!a){var l=AmusementPanel.create(s,r.activityType);if(!l)continue;l.top=0,l.left=0,l.bottom=0,l.right=0,this.amusementPanelList[i]=l,this.viewStack.addChild(this.amusementPanelList[i]),this.BtnArr.push(this._datas[o]),this.actId==s&&(n=i),i++}}}if(this.dataArr=new eui.ArrayCollection(this.BtnArr),this.menuList.dataProvider=this.dataArr,this.onChange(),this.viewStack.numElements>0&&this.setOpenIndex(n,!0),this.viewStack.validateNow(),this.menuList.validateNow(),n>=5){var h=92*n;h>this.menuList.contentWidth-this.menuScroller.width&&(h=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=h}},e.prototype.sort=function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:t.activityType>e.activityType?1:-1},e.prototype.setOpenIndex=function(t,e){this.amusementPanelList[t].open(),this.viewStack.selectedIndex!=t&&(this.viewStack.selectedIndex=t,this.menuList.selectedIndex=t,0==this.amusementPanelList[t].activityType?amusementControl.setPalyEffListById(this.amusementPanelList[t].activityID,!0):1==this.amusementPanelList[t].activityType&&pAmusementControl.setPalyEffListById(this.amusementPanelList[t].activityID,!0),this.checkShowHelp(),!e&&this.refushRedPoint())},e.prototype.updatePanel=function(t){for(var e in this.amusementPanelList)if(this.amusementPanelList[e].activityID==t){this.amusementPanelList[e].updateData();break}},e.prototype.checkShowHelp=function(){var t=this.amusementPanelList[this.menuList.selectedIndex].activityID,e=AmusementPanel.getAmusementConfig(t);this.seeRule&&(this.seeRule.visible=!(!e||!e.helpInfo))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.seeRule:var e=this.amusementPanelList[this.menuList.selectedIndex].activityID,i=AmusementPanel.getAmusementConfig(e);HelpControl.openHelpWin(i.helpInfo)}},e.prototype.onClickMenu=function(t){this.actId=0,this.selectIndex!=t.currentTarget.selectedIndex&&(SoundUtils.ins().playEffect(SoundUtils.VIEW),this.amusementPanelList[this.selectIndex]&&this.amusementPanelList[this.selectIndex].close()),this.selectIndex=t.currentTarget.selectedIndex;var e=DataCenter.ins().AmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID];if(1==this.amusementPanelList[this.selectIndex].activityType&&(e=DataCenter.ins().PAmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID]),e.type){var i=void 0,n=this.amusementPanelList[this.selectIndex].activityType;0==n?i=DataCenter.ins().AmusementConfig[this.amusementPanelList[this.selectIndex].activityID]:1==n&&(i=DataCenter.ins().PAmusementConfig[this.amusementPanelList[this.selectIndex].activityID]),i&&(3==i.activityType||9==i.activityType||19==i.activityType?this.setOpenIndex(this.selectIndex):0==n?amusementControl.upChangePage(this.amusementPanelList[this.selectIndex].activityID):1==n&&pAmusementControl.upChangePage(this.amusementPanelList[this.selectIndex].activityID))}else this.setOpenIndex(this.selectIndex)},e.prototype.ChangePageCallBack=function(t){this.actId&&(this.selectIndex=this.checkIndexByActivityId(this.actId)),this.setOpenIndex(this.selectIndex)},e.prototype.onChange=function(){if(this.leftBtn&&this.rightBtn){this.viewStack.numElements<=5?(this.leftBtn.visible=!1,this.rightBtn.visible=!1):this.menuList.scrollH<46?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.menuList.scrollH>=this.menuList.contentWidth-this.menuList.width-46?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.leftRed.visible=this.leftBtn.visible,this.rightRed.visible=this.rightBtn.visible;var t=this.menuList.dataProvider.length,e=Math.floor(this.menuList.scrollH/82)+4;if(this.leftBtn.visible)for(var i=0;e-5>=i;i++)if(this._datas[i]){var n=amusementControl.getAmusementDataById(this._datas[i].id);if(n&&n.canReward()){this.leftRed.visible=!0;break}}if(this.rightBtn.visible)for(var i=e+1;t>i;i++)if(this._datas[i]){var n=amusementControl.getAmusementDataById(this._datas[i].id);if(n&&n.canReward()){this.rightRed.visible=!0;break}}}},e.prototype.onTouchBtn=function(t){var e=460,i=0;switch(t.target){case this.leftBtn:i=this.menuList.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.menuList.scrollH=i;break;case this.rightBtn:i=this.menuList.scrollH+e,i=92*Math.round(i/92),i>this.menuList.contentWidth-this.menuScroller.width&&(i=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=i}this.onChange()},e.prototype.checkIndexByActivityId=function(t){for(var e=0;e<this.amusementPanelList.length;e++)if(this.amusementPanelList[e].activityID==t)return e;return 0},e.prototype.zeroUpdate=function(){var t=!1,e=GameServer.serverTime,i=0;for(var n in amusementControl.activityData){var o=amusementControl.getAmusementDataById(+n);if(DateUtils.formatMiniDateTime(o.startTime)<=e||DateUtils.formatMiniDateTime(o.endTime)<=e){t=!0;break}i++}for(var n in pAmusementControl.activityData){var o=pAmusementControl.getAmusementDataById(+n);if(DateUtils.formatMiniDateTime(o.startTime)<=e||DateUtils.formatMiniDateTime(o.endTime)<=e){t=!0;break}i++}t&&this.updateView(),0==i&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(AmusementBaseView.prototype,"AmusementBaseView");var AmusementPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activityType=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t;var e;0==this.activityType?e=DataCenter.ins().AmusementConfig[t]:1==this.activityType&&(e=DataCenter.ins().PAmusementConfig[t]),e&&e.tabName&&(this.name=e.tabName)},enumerable:!0,configurable:!0}),e.prototype.updateData=function(){},e.create=function(t,e){var i,n;if(0==e?(i=DataCenter.ins().AmusementConfig[t],n=DataCenter.ins().AmusementBtnConfig[t]):(i=DataCenter.ins().PAmusementConfig[t],n=DataCenter.ins().PAmusementBtnConfig[t]),!n)return null;var o=n.type&&i?i.activityType:0;1==o&&(n.showType=0);var s="AmuseTarget"+o+"Panel"+(n.showType||""),r=egret.getDefinitionByName(s),a=new r(t);return a.activityID=t,a.activityType=e,a},e.getAmusementTypeFromId=function(t){var e;return DataCenter.ins().AmusementBtnConfig[t]?e=DataCenter.ins().AmusementBtnConfig[t]:DataCenter.ins().PAmusementBtnConfig[t]&&(e=DataCenter.ins().PAmusementBtnConfig[t]),e?e.activityType:0},e.getAmusementConfig=function(t){var i,n=e.getAmusementTypeFromId(t);return i=0==n?DataCenter.ins().AmusementConfig[t]:DataCenter.ins().PAmusementConfig[t]},e}(BasePanel);__reflect(AmusementPanel.prototype,"AmusementPanel");var AmuseTarget7Panel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget7Panel1Skin",e.bossMc=new GameMovieClip,e.bossGroup.addChild(e.bossMc),e.bossMc.x=e.bossGroup.x,e.bossMc.y=e.bossGroup.y,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.boss,this.onTap),this.addEventTouchTap(this.costbtn,this.onTap),this.addCustomEvent(393,this.GetCallBack),this.addCustomEvent(395,this.GetCallBack),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.boss,this.onTap),this.removeEventTouchTap(this.costbtn,this.onTap),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.onClick=function(t){},e.prototype.onTap=function(t){switch(t.currentTarget){case this.boss:UIMgr.ins().open(BossView,1);break;case this.costbtn:this.activityData&&UIMgr.ins().open(MergeServerBossIntegrateView,this.activityID)}},e.prototype.GetCallBack=function(t){this.updateData()},e.prototype.updateData=function(){var t=DataCenter.ins().Amusement7Config[this.activityID][1];t.showType==AmusementType7DataVo.TYPE_RING?this.currentState="lieyan":t.showType==AmusementType7DataVo.TYPE_HEFUBOSS?this.currentState="hefu":this.currentState="celebreate",this.validateNow();var e=DataCenter.ins().AmusementBtnConfig[this.activityID];e&&(this.title.source=e.title),this.activityData=amusementControl.getAmusementDataById(this.activityID),this.setTime(),this.actDesc.text=DataCenter.ins().AmusementConfig[this.activityID].desc;var i=amusementControl.getAmusementDataById(this.activityID);this.cost.text=LangMgr.getValueByKey("osaCurrScore1",i.bossScore);var n=GUAIWU_PREFIX+"10129_3s";t.exValue&&t.exValue.bossModel&&(n=t.exValue.bossModel),this.bossMc.playFile(PATH_GUAIWU+n,-1),this.redPoint.visible=amusementControl.getType7RedPoint(this.activityID)},e.prototype.setTime=function(){if(this.activityData){var t=Math.floor((DateUtils.formatMiniDateTime(this.activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this.activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)}},e}(BasePanel);__reflect(AmuseTarget7Panel1.prototype,"AmuseTarget7Panel1");var AmusementBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementBtnItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t,e;0==this.data.activityType?(t=this.data,e=AmusementControl.ins()):1==this.data.activityType&&(t=this.data,e=PAmusementControl.ins()),null!=t?(this.redPoint.visible=e.isShowRedPointByBtnInfo(t),this.iconDisplay.source=t.icon,t.light&&!e.getPalyEffListById(t.id)?(this.mc||(this.mc=new GameMovieClip,this.mc.x=40,this.mc.y=43),this.mc.playFile(PATH_EFF+"actIconCircle",-1),this.addChild(this.mc)):DisplayUtils.removeFromParent(this.mc),this.labelDisplay&&(this.labelDisplay.text=t.titleName)):(this.iconDisplay.source="",this.labelDisplay&&(this.labelDisplay.text=""))},e}(BaseItemRender);__reflect(AmusementBtnItemRender.prototype,"AmusementBtnItemRender");var DirectShopCashView=function(t){function e(){var e=t.call(this)||this;return e.sendToGetAward=!1,e.actId=0,e.actIdArr=[],e.actIndex=0,e.dataProMain=[],e.skinName="DirectShopCashViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.record.itemRenderer=DirectShopCashItemRenderer,this.dataPro=new eui.ArrayCollection,this.record.dataProvider=this.dataPro,this.list.itemRenderer=ItemBase,this.dataCell=new eui.ArrayCollection},e.prototype.open=function(t){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.getBtn,this.onBuy),this.addEventTouchTap(this.record,this.onTouchList),this.addCustomEvent(395,this.onResult),this.actIndex=t||0,this.resetList()},e.prototype.close=function(){TrailerPortalIcon.checkAutoOpen()},e.prototype.getActId=function(){var t=AmusementControl.ins().activityData,e=[];for(var i in t){var n=t[i];29==n.pageType&&26==n.type&&n.isOpenActivity()&&!n.getHide()&&e.push(+i)}return e},e.prototype.onResult=function(t){var e=this;this.actIdArr.filter(function(i,n){if(t==i){var o=AmusementControl.ins().getAmusementDataById(i);o&&o.isOpenActivity()&&e.updateView()}})},e.prototype.updateView=function(){if(this.actIdArr.length<=0)return void(0!=this.dataProMain.length&&UIMgr.ins().close(this));var t=[];return this.actIdArr.filter(function(e,i){var n=DataCenter.ins().Amusement26Config[e],o=AmusementControl.ins().getAmusementDataById(e);for(var s in n){var r=n[s],a=o.getShopData(r.index);(!a||r.buyCount>a.buyCount||a.canGet)&&t.push([e,r.index,r.sort])}}),0==t.length?void UIMgr.ins().close(this):(t.sort(function(t,e){return t[2]<e[2]?-1:t[2]>e[2]?1:t[1]<e[1]?-1:1}),this.dataProMain=t,this.actIndex=this.actIndex>this.dataProMain.length-1?this.dataProMain.length-1:this.actIndex,void this.updataDataView())},e.prototype.onTouchList=function(t){var e=this.record.selectedIndex;this.dataProMain[e]&&this.dataProMain[this.actIndex]&&(this.dataProMain[e].selet=!0,this.dataProMain[this.actIndex].selet=!1,this.actIndex=e,this.updataDataView())},e.prototype.updataDataView=function(){var t=this,e=[];this.dataProMain.map(function(i,n){var o=i[0],s=i[1],r=DataCenter.ins().Amusement26Config[o][s];e.push({selet:n==t.actIndex,bg:r.itemName})}),this.dataPro.replaceAll(e),this.record.validateNow(),this.updataView()},e.prototype.updataView=function(){var t=this.dataProMain[this.actIndex],e=t[0],i=t[1],n=AmusementControl.ins().getAmusementDataById(e),o=DataCenter.ins().Amusement26Config[e][i],s=n.getShopData(o.index),r=o.buyCount-s.buyCount+(s.canGet?1:0);if(this.xgtitle.source="DirectShopCashTitle"+r+"_png",this.showBtnTip&&(this.showBtnTip.visible=!!o.showBtnTips),this.originalPrice.text=LangMgr.getValueByKey("primecost")+LangMgr.getValueByKey("dollar",o.originalPrice),this.list.dataProvider=new eui.ArrayCollection(o.reward.concat()),s.canGet)this.getBtn.label=LangMgr.getValueByKey("activitGet"),this.redPoint.visible=!0;else{var a=DataCenter.ins().PayInfoConfig[o.rechargeId];this.getBtn.label=LangMgr.getValueByKey("numberRechargeRmb",a.cash),this.redPoint.visible=!1}this.infoLabel.text=o.itemDesc,this.sendToGetAward=!1,TimerMgr.ins().isExists(this.onTimer,this)||TimerMgr.ins().loop(1e3,this.onTimer,this);var l=DataCenter.ins().PayInfoConfig[o.rechargeId];this.desc&&(this.desc.text=LangMgr.getValueByKey("directDes",0==l.vipexp?LangMgr.getValueByKey("treasureNo"):"")),this.onTimer()},e.prototype.onTimer=function(){var t=this.dataProMain[this.actIndex][0],e=AmusementControl.ins().getAmusementDataById(t);e&&this.actTime1&&(this.actTime1.text=e.getRemainTime())},e.prototype.onBuy=function(){var t=this.dataProMain[this.actIndex][0],e=this.dataProMain[this.actIndex][1],i=AmusementControl.ins().getAmusementDataById(t);if(!i||!i.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("activitShow3"));var n=DataCenter.ins().Amusement26Config[t][e],o=i.getShopData(n.index);if(o.canGet){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);amusementControl.upReward(t,e),this.sendToGetAward=!0}else{var s=ClientStorage.ins().getValue(t+"_"+e)||0;GameServer.serverTime>=s?(payControl.showReCharge(n.rechargeId),ClientStorage.ins().setValue(t+"_"+e,GameServer.serverTime+5e3)):tipsControl.showTips(LangMgr.getValueByKey("oftenOpWait",Math.ceil((s-GameServer.serverTime)/1e3)))}},e.prototype.resetList=function(){this.actIdArr=this.getActId(),this.updateView()},e.prototype.onTap=function(t){(t.currentTarget==this.bgClose||t.currentTarget==this.closeBtn)&&UIMgr.ins().close(this)},e.prototype.closeEx=function(e){var i=0;ServerStorage.ins().getValue(24)||(ServerStorage.ins().setValue(24,1),i=1e4),t.prototype.closeEx.call(this,e,i)},e.openCheck=function(){var t=AmusementControl.ins().activityData;for(var e in t){var i=t[e];if(29==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide())return SwitchMgr.ins().checkOpen(80)?!0:(tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")),!1)}return GameServer.serverOpenDay<2?tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")):tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e}(BaseEuiView);__reflect(DirectShopCashView.prototype,"DirectShopCashView");var DirectShopView=function(t){function e(){var e=t.call(this)||this;return e.actId=0,e.actIndex=0,e.actIdArr=[],e.skinName="DirectShopViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.record.itemRenderer=DirectShopItemRender,this.dataPro=new eui.ArrayCollection,this.record.dataProvider=this.dataPro},e.prototype.open=function(t){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addCustomEvent(395,this.onResult),this.actIndex=t||0,this.resetList()},e.prototype.close=function(){TrailerPortalIcon.checkAutoOpen()},e.prototype.getActId=function(){var t=AmusementControl.ins().activityData,e=[];for(var i in t){var n=t[i];29==n.pageType&&26==n.type&&n.isOpenActivity()&&!n.getHide()&&e.push(+i)}return e},e.prototype.onResult=function(t){var e=this;this.actIdArr.filter(function(i,n){if(t==i){var o=AmusementControl.ins().getAmusementDataById(i);if(o&&o.isOpenActivity()){for(var s=0;s<e.dataPro.length;s++){var r=e.record.getVirtualElementAt(s);r.onFly()}e.updateView()}}})},e.prototype.updateView=function(){if(this.actIdArr.length<=0)return void(0!=this.dataPro.length&&UIMgr.ins().close(this));var t=[];if(this.actIdArr.filter(function(e,i){var n=DataCenter.ins().Amusement26Config[e],o=AmusementControl.ins().getAmusementDataById(e);for(var s in n){var r=n[s],a=o.getShopData(r.index);(!a||r.buyCount>a.buyCount||a.canGet)&&t.push([e,r.index,r.sort])}}),0==t.length)return void UIMgr.ins().close(this);t.sort(function(t,e){return t[2]<e[2]?-1:t[2]>e[2]?1:t[1]<e[1]?-1:1}),this.dataPro.replaceAll(t),this.record.validateNow();var e=DataCenter.ins().Amusement26Config[this.actIdArr[0]];for(var i in e){var n=DataCenter.ins().PayInfoConfig[e[i].rechargeId];this.desc&&(this.desc.text=LangMgr.getValueByKey("directDes",0==n.vipexp?LangMgr.getValueByKey("treasureNo"):""));break}},e.prototype.resetList=function(){this.actIdArr=this.getActId(),this.updateView()},e.prototype.onTap=function(t){(t.currentTarget==this.bgClose||t.currentTarget==this.closeBtn)&&UIMgr.ins().close(this)},e.prototype.closeEx=function(e){var i=0;ServerStorage.ins().getValue(24)||(ServerStorage.ins().setValue(24,1),i=1e4),t.prototype.closeEx.call(this,e,i)},e.openCheck=function(){var t=amusementControl.activityData;
for(var e in t){var i=t[e];if(29==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide())return SwitchMgr.ins().checkOpen(80)?!0:(tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")),!1)}return GameServer.serverOpenDay<2?tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")):tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e}(BaseEuiView);__reflect(DirectShopView.prototype,"DirectShopView");var InvestmentMonthView=function(t){function e(){var e=t.call(this)||this;return e.payId=508,e.skinName="InvestmentMonthViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.openCheck=function(t){return!investmentControl.IsAllReward(508)},e.prototype.open=function(){this.addEventTouchTap(this.showDetail1,this.onTouchBtn),this.addEventTouchTap(this.showDetail0,this.onTouchBtn),this.addEventTouchTap(this.rechargeBtn,this.onTouchBtn),this.addEventTouchTap(this.getBtn,this.onTouchBtn),this.addCustomEvent(4,this.zeroUpdate),this.addCustomEvent(449,this.updateView),this.reward.itemRenderer=ItemBase,this.updateView(),this.showDetail0.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.showDetail0.text),this.showDetail1.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.showDetail1.text)},e.prototype.updateView=function(){var t=investmentControl.getRewardDays(this.payId),e=investmentControl.getBuyState(this.payId);this.getRewardGroup.visible=this.investmentGroup.visible=!1,e?this.getRewardGroup.visible=!0:this.investmentGroup.visible=!0;var i=DataCenter.ins().InvestmentAfterConfig[this.payId],n=CommonUtils.getObjectLength(i),o=t>=n?n:investmentControl.getTodayReward(this.payId)?t:t+1;this.dayInfo.text=LangMgr.getValueByKey("whichDayAw",o),this.redPoint.visible=investmentControl.IsRedPoint(this.payId);var s=DataCenter.ins().InvestmentAfterConfig[this.payId][o];this.reward.dataProvider=new eui.ArrayCollection(s.reward),this.ybAll.data=DataCenter.ins().InvestmentBaseConfig.showYB[0],this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",DataCenter.ins().PayInfoConfig[this.payId].cash);for(var r=0;6>r;r++)this["bigReward"+r]&&DataCenter.ins().InvestmentBaseConfig.showReward[r]&&(this["bigReward"+r].data=DataCenter.ins().InvestmentBaseConfig.showReward[r]);var a=investmentControl.getTodayReward(this.payId);e&&a?(this.already.visible=!0,this.getBtn.visible=this.redPoint.visible=!1):e&&!a&&t==n?(this.already.visible=!0,this.getBtn.visible=this.redPoint.visible=!1):e&&!a&&(this.getBtn.label=LangMgr.getValueByKey("osaQuickGet"),this.already.visible=!1,this.getBtn.visible=this.redPoint.visible=!0)},e.prototype.onTouchBtn=function(t){switch(t.currentTarget){case this.showDetail0:case this.showDetail1:UIMgr.ins().open(InvestmentNewRewardTipsView,this.payId);break;case this.getBtn:if(!investmentControl.getBuyState(this.payId))return void tipsControl.showTips(LangMgr.getValueByKey("noInvestment"));if(investmentControl.getTodayReward(this.payId))return void tipsControl.showTips(LangMgr.getValueByKey("tomorrowAlrGetAw"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);investmentControl.upInvestmentReward(3,this.payId);break;case this.rechargeBtn:investmentControl.sendInvestment(this.payId)}},e.prototype.zeroUpdate=function(){var t=!1;for(var e in DataCenter.ins().InvestmentBtnConfig)if(investmentControl.isOpenInvest()){t=!0;break}t||UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(InvestmentMonthView.prototype,"InvestmentMonthView");var SealPveControl=function(t){function e(){var e=t.call(this)||this;return e.boardList=[],SwitchSceneMgr.ins().register(e),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.onEnterScene=function(){90!=MapControl.copyType||this.lastFb||(UIMgr.ins().open(SealPveFightView),this.lastFb=!0)},e.prototype.onExitScene=function(){this.lastFb&&90!=MapControl.copyType&&(this.lastFb=!1,UIMgr.ins().close(SealPveFightView),-1!=i.ins().getPveDoneIndex()&&UIMgr.ins().open(SealPveView))},e.prototype.upBoardReq=function(){var t=this.getPveActivityId();return t?[t]:!1},e.prototype.downBoard=function(t){this.boardList=[];for(var e=0;t.length>e;e++){var i=t[e][0],n=t[e][1],o=t[e][2];this.boardList.push({name:i,vip:n,power:o,index:e})}EventMgr.ins().dispatch(703)},e.prototype.downOverDateResult=function(t){},e.prototype.isPve10Activity=function(t){var e=DataCenter.ins().Amusement8Config[t];return e&&e[1].showType==AmusementType8DataVo.TYPE_SEALPVE},e.prototype.challengeNextGuan=function(){var t=this.getPveActivityId();if(!t)return void tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity"));for(var e=amusementControl.getAmusementDataById(t),i=DataCenter.ins().Amusement8Config[t],n=CommonUtils.getObjectLength(i),o=1,s=2;n+1>=s;s++)if(0==(e.record>>s-1&1)){o=s-1;break}amusementControl.upReward(t,o)},e.prototype.getPveActivityId=function(){for(var t in DataCenter.ins().Amusement8Config){var e=DataCenter.ins().Amusement8Config[t][1];if(e.showType==AmusementType8DataVo.TYPE_SEALPVE&&amusementControl.getAmusementDataById(e.Id)){var i=amusementControl.getAmusementDataById(e.Id);if(GameServer.serverTime>=DateUtils.formatMiniDateTime(i.startTime)&&GameServer.serverTime<=DateUtils.formatMiniDateTime(i.endTime))return e.Id}}return null},e.prototype.isHaveNextGuan=function(){var t=this.getPveDoneIndex();if(-1==t)return!1;var e=this.getPveActivityId();if(!e)return!1;var i=DataCenter.ins().Amusement8Config[e],n=CommonUtils.getObjectLength(i);return n>=t},e.prototype.getPveDoneIndex=function(){for(var t=this.getPveActivityId(),e=amusementControl.getAmusementDataById(t),i=DataCenter.ins().Amusement8Config[t],n=CommonUtils.getObjectLength(i),o=-1,s=2;n+1>=s;s++)if(0==(e.record>>s-1&1)){o=s-1;break}return o},e.prototype.getPveConfig=function(){var t=this.getPveActivityId();if(!t)return null;var e=this.getPveDoneIndex();return DataCenter.ins().Amusement8Config[t]?DataCenter.ins().Amusement8Config[t][e]:null},__decorate([up(55,[3])],e.prototype,"upBoardReq",null),__decorate([down(55,[[8,2,10]])],e.prototype,"downBoard",null),__decorate([down(56,[3])],e.prototype,"downOverDateResult",null),e=i=__decorate([protocolsId(25)],e);var i}(BaseSystem);__reflect(SealPveControl.prototype,"SealPveControl");var SpokesPersonRedPoint=function(t){function e(){var e=t.call(this)||this;return e.addCustomEventMany(e.dispatchRed,488,489,490,492),e.addCustomEventMany(e.dispatchTurnTableRed,267,266,268,269,485,112,461),e.addCustomEventMany(e.dispatchBuffExpRed,483,484),e.addCustomEventMany(e.dispatchAchiTask,480,481),e.addCustomEventMany(e.dispatchGodWeaponRedPoint,173,106,107,457,682,4,112,461),e.addCustomEventMany(e.dispatchWholeHourTaskRedPoint,683,695,461),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRed=function(){var t=this.red;this.red=this.turnRed||this.achiTaskTed||this.buffExpRed||this.WholeHourTaskRed,t!=this.red&&EventMgr.ins().dispatch(487,!0)},e.prototype.dispatchTurnTableRed=function(){var t=this.turnRed;this.turnRed=spokesPersonTurntableControl.checkRed(),t!=this.turnRed&&EventMgr.ins().dispatch(488,!0)},e.prototype.dispatchBuffExpRed=function(){var t=this.buffExpRed;this.buffExpRed=spokesPersonDoubleExpControl.checkRed(),t!=this.buffExpRed&&EventMgr.ins().dispatch(489,!0)},e.prototype.dispatchAchiTask=function(){var t=this.achiTaskTed;this.achiTaskTed=spokesPersonAchiTaskControl.checkRed(),t!=this.achiTaskTed&&EventMgr.ins().dispatch(490,!0)},e.prototype.dispatchGodWeaponRedPoint=function(){this.godWeaponRentRed=leaseControl.getRedPoint(),EventMgr.ins().dispatch(491)},e.prototype.dispatchWholeHourTaskRedPoint=function(){var t=this.WholeHourTaskRed;this.WholeHourTaskRed=spokesPersonTaskControl.checkRedPoint(),t!=this.WholeHourTaskRed&&EventMgr.ins().dispatch(492,!0)},e}(BaseSystem);__reflect(SpokesPersonRedPoint.prototype,"SpokesPersonRedPoint");var TotalRechargeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DoubleTwelveLimitRechargeViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.itemRenderer=DoubleTwelveRechargeItemRender,this.addEventTouchTap(this.closeBtn,this.closeWin),this.addEventTouchTap(this.bgClose,this.closeWin),this.addEventTouchTap(this.chooseBtn0,this.onSelect),this.addEventTouchTap(this.chooseBtn1,this.onSelect),this.addEventTouchTap(this.chooseBtn2,this.onSelect),this.addEventTouchTap(this.rechargeBtn,this.onRecharge),this.addCustomEvent(178,this.update),this.addCustomEvent(446,this.update),this.addCustomEvent(395,this.update),this.addCustomEvent(393,this.update),this.addCustomEvent(392,this.update),this.updateView()},e.prototype.onRecharge=function(t){this.recharge.visible?(payControl.checkOpenWin(),this.closeWin()):amusementControl.upReward(this._activityId,this._index)},e.prototype.update=function(){TimerMgr.ins().remove(this.updateView,this),TimerMgr.ins().doTimer(80,1,this.updateView,this)},e.prototype.getActivityId=function(){var t=amusementControl.activityData;for(var e in t)if(5==t[e].pageType&&amusementControl.getAmusementDataById(t[e].id).isOpenActivity()&&!amusementControl.getAmusementDataById(t[e].id).getHide())return t[e].id;return 0},e.prototype.updateView=function(){var t=this.getActivityId();this._activityId=t;var e,i=amusementControl.getAmusementDataById(t),n=i.getLeftTime(),o=Math.floor(1e3*n/DateUtils.MS_PER_DAY);0==o?(o=Math.floor(1e3*n/(DateUtils.MS_PER_DAY/24)),e=LangMgr.getValueByKey("activitHoure",o)):e=LangMgr.getValueByKey("activitDay",o),this.limitTime.text=LangMgr.getValueByKey("activitHaveDay",e);for(var s=1;3>=s;s++)this.setText(s);for(var r=1,a=DataCenter.ins().Amusement3Config[t],s=1;3>=s;s++){var l=a[s];if(l.val>i.chongzhiTotal||0==(i.recrod>>l.index&1)){r=s;break}}this.selectActivity(r)},e.prototype.selectBtn=function(t){this.select0.visible=!1,this.select1.visible=!1,this.select2.visible=!1,this["select"+t].visible=!0},e.prototype.selectActivity=function(t){var e=this._activityId;this._index=t;var i=amusementControl.getAmusementDataById(e),n=DataCenter.ins().Amusement3Config[e][t],o=Math.max(0,n.val-i.chongzhiTotal);this.rechargeCount.text=(o/(1==n.payType?GlobalModel.chargeRate:1)).toString(),1==(i.recrod>>t&1)?(this.btn.visible=!1,this.get.visible=!1,this.recharge.visible=!1):(this.btn.visible=!0,o>0?(this.recharge.visible=!0,this.get.visible=!1):(this.recharge.visible=!1,this.get.visible=!0)),this.list.dataProvider=new ArrayCollection(n.rewards),this.selectBtn(t-1)},e.prototype.setText=function(t){var e=this._activityId,i=DataCenter.ins().Amusement3Config[e][t],n=1==i.payType?i.val/GlobalModel.chargeRate:i.val;this["unit"+(t-1)].visible=!1,this["count"+(t-1)].text=n.toString()},e.prototype.onSelect=function(t){var e=t.currentTarget,i=1;i=e==this.chooseBtn0?1:e==this.chooseBtn1?2:3,this.selectActivity(i)},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TotalRechargeView.prototype,"TotalRechargeView");var TreasureBasinView=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(t){this.skinName=t?t:"TreasureBasinViewSkin",this.currentAwardList.itemRenderer=NewYearPropItemRender,this.closeBtn&&this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.submitBtn,this.onTap),this.submitBtn0&&this.addEventTouchTap(this.submitBtn0,this.onTap),this.detail&&this.addEventTouchTap(this.detail,this.onTap),this.addEventTouchTap(this.lookBtn,this.onTap),this.addCustomEvent(392,this.updateView),this.updateView()},e.prototype.updateView=function(){var t=AmusementControl.ins().getAmusementDataById(this.activityId);if(!t)return void UIMgr.ins().close(this);var e=DataCenter.ins().Amusement16Config[t.id],i=Object.keys(e);i.sort(function(t,e){return+e>+t?-1:1});var n=0;for(var o in i)e[o].bigAward&&(this.getItem(n).data=e[o],n+=1);if(t.buyState)this.timeDesc.visible=!1;else{this.timeDesc.visible=!0,TimerMgr.ins().isExists(this.updateTime,this)||TimerMgr.ins().doTimer(1e3,0,this.updateTime,this);var s=e[0],r=new Date(DateUtils.formatMiniDateTime(t.startTime));r.setDate(r.getDate()+s.buyDay),this._leftTime=Math.floor((r.getTime()-GameServer.serverTime)/1e3),this._leftTime<0&&(this._leftTime=0)}var a=t.gotId,l=DataCenter.ins().PayInfoConfig[e[0].rechargeid.rechargeId];t.buyState?(!t.hadGet&&DataCenter.ins().Amusement16Config[t.id][a+1]?(a+=1,this.submitBtn.label=LangMgr.getValueByKey("activitGet"),this.submitBtn.enabled=!0):(this.submitBtn.label=LangMgr.getValueByKey("activitAlreadingGet"),this.submitBtn.enabled=!1),this.dayCountLabel0.text=LangMgr.getValueByKey("activitDayIndex",a)):(1==e[0].rechargeid.buytype?this.submitBtn.label=LangMgr.getValueByKey("investmentPay",l.cash):2==e[0].rechargeid.buytype&&(this.submitBtn.label=LangMgr.getValueByKey("investmentPay1",e[0].rechargeid.count)),this.submitBtn.enabled=!0,this.dayCountLabel0.text="",a=1);var h;t.hadGet&&DataCenter.ins().Amusement16Config[t.id][a+1]?(this.revenueLabel0.text=LangMgr.getValueByKey("tomorrowGetAward"),this.dayCountLabel0.text="",h=DataCenter.ins().Amusement16Config[t.id][a+1]):(h=DataCenter.ins().Amusement16Config[t.id][a],this.revenueLabel0.textFlow=TextUtils.generateTextFlow1(h.awardDesc)),this.currentAwardList.dataProvider=new eui.ArrayCollection(h.reward),this.desc.text=LangMgr.getValueByKey("treasureDes",0==l.vipexp?LangMgr.getValueByKey("treasureNo"):"")},e.prototype.updateTime=function(){this.timeDesc.text=LangMgr.getValueByKey("expHaveTime",DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3)),this._leftTime>0&&this._leftTime--},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.closeBtn)UIMgr.ins().close(this);else if(e==this.submitBtn)this.sendGetAward();else if(e==this.lookBtn){var i=AmusementControl.ins().getAmusementDataById(this.activityId);i&&UIMgr.ins().open(TreasureBasinAwardView,i.id)}},e.prototype.sendGetAward=function(){if(CommonFun.checkBackpackCount(BackpackControl.BAG_ENOUGH,1)){var t=AmusementControl.ins().getAmusementDataById(this.activityId);t?t.buyState?DataCenter.ins().Amusement16Config[t.id][t.gotId+1]&&amusementControl.upReward(t.id,t.gotId+1):this.sendRecharge():tipsControl.showTips(LangMgr.getValueByKey("limitTips4"))}},e.prototype.sendRecharge=function(){var t=AmusementControl.ins().getAmusementDataById(this.activityId),e=DataCenter.ins().Amusement16Config[t.id][0];1==e.rechargeid.buytype?payControl.showReCharge(e.rechargeid.rechargeId):2==e.rechargeid.buytype&&AmusementControl.ins().upReward(t.id,t.gotId+1)},e.prototype.getItem=function(t){return this["award"+t]},e.prototype.close=function(){TimerMgr.ins().remove(this.updateTime,this)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i in amusementControl.activityData){var n=amusementControl.activityData[i];if(n&&24==n.pageType&&n.isOpenActivity()&&!n.getHide())return!0}return tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e}(BaseEuiView);__reflect(TreasureBasinView.prototype,"TreasureBasinView");var AshtartePanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isAutoUp=!1,this.upBtn.label=this.isAutoUp?LangMgr.getValueByKey("cancel1"):LangMgr.getValueByKey("wingTips6"),TimerMgr.ins().remove(this.checkUpdate,this),TimerMgr.ins().remove(this.autoUpStar,this),this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.openView(t)},e.prototype.openView=function(t){this.addEventTouchTap(this.suit,this.onEvent),this.addEventTouchTap(this.huanxing,this.onEvent),this.addEventTouchTap(this.upBtn,this.onEvent),this.addEventTouchTap(this.upBtnEx,this.onEvent),this.addEventTouchTap(this.skillIcon0,this.onEvent),this.addEventTouchTap(this.huanhua,this.onEvent),this.addEventTouchTap(this.btn0,this.onEvent),this.addEventTouchTap(this.btn1,this.onEvent),this.addEventTouchTap(this.closeBtn,this.onEvent),this.addEventTouchTap(this.checkBoxs,this.updateCost),this.addEventTouchTap(this.checkBoxs,this.updateModel),this.addEventTouchTap(this.icon,this.showIconTips),this.addEventTouchTap(this.help,this.onEvent),this.addEventItemTap(this.list,this.onSoulClick),this.addCustomEvent(266,this.timerUpdate),this.addCustomEvent(268,this.timerUpdate),this.addCustomEvent(269,this.timerUpdate),this.addCustomEvent(258,this.timerUpdate),this.addCustomEvent(259,this.timerUpdate),this.addCustomEvent(260,this.timerUpdate),this.addCustomEvent(261,this.timerUpdate),this.addCustomEvent(263,this.updateUI),this.addCustomEvent(265,this.timerUpdate),this.addCustomEvent(494,this.stopUpGrade),this.addCustomEvent(264,this.TanlentLvUpGrade),this.list.itemRenderer=AshtarteIconItemRenderer,this.list.useVirtualLayout=!1,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData,this.zlId=t[0]||0,this._tick=0,this.eventDelay=Math.floor(150/DataCenter.ins().AshtarteConfig.unitTime);for(var e=0;e<DataCenter.ins().AshtarteBaseConfig[this.zlId].skill.length;e++)this.addEventTouchTap(this["skillIcon"+(e+1)],this.onSkillEvent);for(var i in DataCenter.ins().AshtarteConfig.upgradeInfo){var n=DataCenter.ins().AshtarteConfig.upgradeInfo[i].sort;this.addEventTouchTap(this["up"+n],this.onDrugEvent)}this.addEventChangeEnd(this.listScroller,this.onChange),this.isAutoUp=!1,this.roleSelect.hideRole(),this.init(),TimerMgr.ins().doTimer(500,0,this.checkUpdate,this)},e.prototype.checkUpdate=function(){var t=this;this._tick&&this._tick<=this.eventDelay&&(this._tick=0,TimerMgr.ins().doNext(function(){t.updateUI()},this))},e.prototype.timerUpdate=function(){var t=this;this._tick++,this._tick&&this._tick>this.eventDelay&&(this._tick=0,TimerMgr.ins().doNext(function(){t.updateUI()},this))},e.prototype.init=function(){this.updateUI(!0)},e.prototype.updateState=function(){var t=ashtarteControl.getZhanLingDataById(this.zlId),e=t?t.level:0,i=CommonUtils.getObjectLength(DataCenter.ins().AshtarteLevelConfig[this.zlId])-1;this.zlId?e>=i?this.currentState="skin_max":this.currentState="skin_up":e>=i?this.currentState="zl_max":this.currentState="zl_up",this.validateNow()},e.prototype.updateUI=function(t){this.updateState(),this.updateTop(t),this.updateItem(),this.updateSkill(),this.updateValue(),this.updateDown(),this.updateCost(),this.updateRedPoint()},e.prototype.updateTop=function(t){if("skin_up"==this.currentState||"skin_max"==this.currentState){if(this.listData.replaceAll(ashtarteControl.showZLlist),this.list.validateNow(),this.zlId)for(var e=0;e<this.list.numElements;e++){var i=this.list.getVirtualElementAt(e),n=this.list.dataProvider.getItemAt(e);if(n.id==this.zlId){if(i.setSelect(!0),t){var o=0;e>3&&(this.listScroller.stopAnimation(),o=Math.floor((e+1)/4)*i.height),this.setStartPosition(o)}break}}this.onChange(),this.huanhua.visible=ashtarteControl.getZhanLingDataById(this.zlId)?!0:!1,this.huanhua.icon=ashtarteControl.ZhanLingSkinId==this.zlId?"zl_quxiao_btn":"zl_huanhua_btn"}var s=DataCenter.ins().AshtarteConfig;for(var r in s.upgradeInfo){var e=s.upgradeInfo[r].sort;this["up"+e]&&(this["up"+e].icon=DataCenter.ins().ItemConfig[r].icon+"_png"),this["redPoint"+e]&&(this["redPoint"+e].visible=ashtarteControl.getZhanLingDataByDrugUse(this.zlId,Number(r))),this["used"+e]&&(this["used"+e].text=ashtarteControl.getZhanLingDataByDrug(this.zlId,Number(r)))}var a=ashtarteControl.getZhanLingDataByLevel(this.zlId);this.lv.data=DataCenter.ins().AshtarteLevelConfig[this.zlId][a].stageDesc,this.model||(this.model=new GameMovieClip),this.model.parent||this.zhanling.addChild(this.model),this.updateModel()},e.prototype.updateModel=function(){var t,e=ashtarteControl.getZhanLingDataByLevel(this.zlId);if(this.isAutoUp){var i=ashtarteControl.getZhanLingDataByStage(this.zlId),n=10*i+1;t=DataCenter.ins().AshtarteLevelConfig[this.zlId][n],t?e=n:t=DataCenter.ins().AshtarteLevelConfig[this.zlId][e]}else t=DataCenter.ins().AshtarteLevelConfig[this.zlId][e];this.zhanlingName.source=DataCenter.ins().AshtarteLevelConfig[this.zlId][e].zlName,this.model.name!=PATH_EFF+t.innerAppearance&&this.model.playFile(PATH_EFF+t.innerAppearance,-1)},e.prototype.updateItem=function(){var t=backpackControl.getBagGoodsByType(21);t&&t.sort(this.sort);for(var e=1;e<=DataCenter.ins().AshtarteConfig.equipPosCount;e++){this["item"+e].name=e.toString();var i=ashtarteControl.getZhanLingDataByItem(this.zlId,e);this["item"+e].data={zlId:this.zlId,id:i,equips:t,pos:e}}},e.prototype.updateSkill=function(){var t=DataCenter.ins().AshtarteBaseConfig[this.zlId];if(t){var e=t.talent,i=ashtarteControl.getZhanLingDataByTalentLv(this.zlId),n=DataCenter.ins().AshtarteTalentConfig[e][i];n||(n=DataCenter.ins().AshtarteTalentConfig[e][1]),n.talentDesc&&n.talentDesc.icon?(this.skillIcon0.source=n.talentDesc.icon,!0):n.passive&&(this.skillIcon0.source=1e3*Math.floor(n.passive[0].id/1e3)+"_png");for(var o=0;o<DataCenter.ins().AshtarteBaseConfig[this.zlId].skill.length;o++){var s=DataCenter.ins().AshtarteBaseConfig[this.zlId].skill[o].id,r=DataCenter.ins().AshtarteSkillConfig[s];r.desc&&r.desc.icon?this["skillIcon"+(o+1)].source=r.desc.icon:this["skillIcon"+(o+1)].source=1e3*Math.floor(r.passive/1e3)+"_png"}this.blackImg0.visible=i?!1:!0;for(var a=ashtarteControl.getZhanLingDataByLevel(this.zlId),o=0;o<DataCenter.ins().AshtarteBaseConfig[this.zlId].skill.length;o++){var l=DataCenter.ins().AshtarteBaseConfig[this.zlId].skill[o];this["blackImg"+(o+1)].visible=l.open>a?!0:!1}}},e.prototype.updateValue=function(){var t=ashtarteControl.getZhanLingDataByLevel(this.zlId),e=DataCenter.ins().AshtarteLevelConfig[this.zlId][t];if(e){var i=ashtarteControl.getZhanLingPower(this.zlId),n=i[0]?i[0]:0;this.powerPanel.setPower(n),i[1].length||(i[1]=this.getEmptyAttrs(this.zlId)),i[2].length||(i[2]=this.getEmptyAttrs(this.zlId,!0));var o=AttributeData.getAttStr(i[1],0,1,"：")+"\n",s=AttributeData.getAttStr(i[2],0,1,"：")+"\n";this.curAtt.text=o,this.nextAtt.text=s}},e.prototype.getEmptyAttrs=function(t,e){var i=[],n=DataCenter.ins().AshtarteLevelConfig[t][0];if(i=ashtarteControl.addAttrs(i,n.attrs),!e)for(var o=0;o<i.length;o++)i[o].value=0;return i},e.prototype.updateDown=function(t){if(void 0===t&&(t=0),this.zlId){var e=ashtarteControl.getZhanLingDataById(this.zlId);if(this.starGroup.visible=this.barGroup.visible=e?!0:!1,!e)return}this.starList||(this.starList=new StarList(10),this.starList.horizontalCenter=0),this.starList.parent||this.starGroup.addChild(this.starList);var i=ashtarteControl.getZhanLingDataByLevel(this.zlId),n=Math.floor(i%10);if(i){var o=n;o||(n=10)}this.starList.setStarNum(n,t),this.barbc||(this.barbc=new ProgressBarEff,this.barbc.setWidth(525),this.barbc.x=10),this.barbc.parent||this.barGroup.addChild(this.barbc);var s=ashtarteControl.getZhanLingDataByExp(this.zlId),r=DataCenter.ins().AshtarteLevelConfig[this.zlId][i];r&&(this.barbc.reset(),this.barbc.setData(s,r.exp))},e.prototype.updateCost=function(){var t=this.getCostValue(),e=t[0],i=t[1],n=e>=i?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.countLabel.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+e+"|/"+i),this.upBtn.visible=ashtarteControl.getZhanLingDataById(this.zlId)?!0:!1,this.upBtnEx.visible=!this.upBtn.visible},e.prototype.getCostValue=function(){var t=ashtarteControl.getZhanLingDataById(this.zlId),e=DataCenter.ins().AshtarteBaseConfig[this.zlId];if(this.checkBoxs.visible=!0,this.costType=1,t||!e.mat){var i=0,n=0,o=ashtarteControl.getZhanLingDataByLevel(this.zlId),s=DataCenter.ins().AshtarteLevelConfig[this.zlId][o],r=DataCenter.ins().ItemConfig[DataCenter.ins().AshtarteConfig.stageitemid];this.icon.source=r.icon+"_png";var a=backpackControl.getBagItemById(DataCenter.ins().AshtarteConfig.stageitemid);return i=a?a.count:0,n=s.count,this.checkBoxs.selected&&n>i&&(i=ActorControl.yb,this.icon.source="szyuanbao",n=DataCenter.ins().AshtarteConfig.unitPrice*s.count,this.costType=2),this.costCount=n,[i,n]}var l=DataCenter.ins().ItemConfig[e.mat];this.icon.source=l.icon+"_png";var h=backpackControl.getBagItemById(e.mat),u=h?h.count:0,p=DataCenter.ins().AshtarteTalentConfig[this.zlId][1],c=p.costCount;return this.checkBoxs.visible=!1,this.costType=22,this.costCount=c,[u,c]},e.prototype.updateRedPoint=function(){for(var t=0;5>t;t++)this["skillRedPoint"+t]&&(this["skillRedPoint"+t].visible=!1);if(this.hhRedPoint.visible=!1,this.upRedPoint.visible=ashtarteControl.isUpGradeByStar(this.zlId)||ashtarteControl.isHintNum(this.zlId),this.skillRedPoint0.visible=ashtarteControl.isUpGradeByTalent(this.zlId),this.hxRedPoint){for(var e=!1,t=0;t<ashtarteControl.showZLlist.length;t++){var i=ashtarteControl.showZLlist[t];if(i.id){var n=ashtarteControl.isUpGradeByStar(i.id)||ashtarteControl.isHintNum(i.id)||ashtarteControl.getZhanLingItemRedPoint(i.id);if(n){e=!0;break}var o=ashtarteControl.isUpGradeByTalent(i.id);if(o){e=!0;break}}}this.hxRedPoint.visible=e}},e.prototype.onSoulClick=function(t){t&&t.itemRenderer&&t.item&&("zl_up"==this.currentState||"zl_max"==this.currentState?UIMgr.ins().open(AshtarteView,this.getIndexRule()):(this.zlId=t.item.id,this.updateUI()))},e.prototype.onSkillEvent=function(t){for(var e=0;e<DataCenter.ins().AshtarteBaseConfig[this.zlId].skill.length;e++)if(t.currentTarget==this["skillIcon"+(e+1)]){var i=DataCenter.ins().AshtarteBaseConfig[this.zlId].skill[e];UIMgr.ins().open(AshtarteSkillTipsView,this.zlId,i.id);break}},e.prototype.onDrugEvent=function(t){for(var e in DataCenter.ins().AshtarteConfig.upgradeInfo){var i=DataCenter.ins().AshtarteConfig.upgradeInfo[e].sort;if(t.currentTarget==this["up"+i]){var n=this.getDrugItemByIndex(i);this["redPoint"+i].visible?ashtarteControl.upDrug(this.zlId,n):UIMgr.ins().open(AshtarteItemTipsView,this.zlId,n)}}},e.prototype.onEvent=function(t){var e=this,i=420,n=0;switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.suit:UIMgr.ins().open(AshtarteSuitTipsView,this.zlId);break;case this.huanxing:TimerMgr.ins().remove(this.autoUpStar,this),this.stopUpGrade(),UIMgr.ins().open(AshtarteView,this.getIndexRule());break;case this.upBtn:this.sendUpGrade();break;case this.upBtnEx:this.upRedPoint.visible?ashtarteControl.upSkinUpGrade(this.zlId):tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"));break;case this.skillIcon0:if(this.skillRedPoint0&&this.skillRedPoint0.visible){var o=ashtarteControl.getZhanLingDataByTalentId(this.zlId),s=ashtarteControl.getZhanLingDataByTalentLv(this.zlId),r=DataCenter.ins().AshtarteTalentConfig[o][s+1],a=DataCenter.ins().AshtarteBaseConfig[this.zlId],l=DataCenter.ins().ItemConfig[a.mat],h=warnControl.show(LangMgr.getValueByKey("wingTips7",l.name,r.costCount),null,null,function(){ashtarteControl.upSkinUpGrade(e.zlId)},this);h.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("babelEnter"))}else UIMgr.ins().open(AshtarteSkillTipsView,this.zlId);break;case this.btn0:n=this.list.scrollV-i,n=84*Math.round(n/84),0>n&&(n=0),this.list.scrollV=n,this.onChange();break;case this.btn1:n=this.list.scrollV+i,n=84*Math.round(n/84),n>this.list.contentHeight-this.listScroller.height&&(n=this.list.contentHeight-this.listScroller.height),this.list.scrollV=n,this.onChange();break;case this.huanhua:if(!ashtarteControl.getZhanLingDataById(this.zlId))return void tipsControl.showTips(LangMgr.getValueByKey("wingTips8"));var u=this.zlId;ashtarteControl.ZhanLingSkinId==u&&(u=0),ashtarteControl.upSkinChange(u);break;case this.help:HelpControl.openHelpWin(35)}},e.prototype.sendUpGrade=function(){if(this.isAutoUp=!this.isAutoUp,this.isAutoUp){if(!this.checkUpStar())return void(this.isAutoUp=!1);this.updateModel(),TimerMgr.ins().doTimer(DataCenter.ins().AshtarteConfig.unitTime,0,this.autoUpStar,this)}else TimerMgr.ins().remove(this.autoUpStar,this);this.upBtn.label=this.isAutoUp?LangMgr.getValueByKey("cancel1"):LangMgr.getValueByKey("wingTips6")},e.prototype.stopUpGrade=function(){this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpStar,this),this.upBtn.label=this.isAutoUp?LangMgr.getValueByKey("cancel1"):LangMgr.getValueByKey("wingTips6"),this.updateDown(1),this.updateModel();var t=ashtarteControl.getZhanLingDataByLevel(this.zlId),e=DataCenter.ins().AshtarteLevelConfig[this.zlId][t];e.activeLv&&this.isTopLevel&&CommonFun.show(0,e.zlNameLabel,null,e.innerAppearance,!0,null,0,-100)},e.prototype.TanlentLvUpGrade=function(){var t=ashtarteControl.getZhanLingDataByTalentLv(this.zlId),e=ashtarteControl.getZhanLingDataByLevel(this.zlId),i=DataCenter.ins().AshtarteLevelConfig[this.zlId][e];i&&t&&1!=t&&this.isTopLevel&&CommonFun.show(1,LangMgr.getValueByKey("wingTips9",t),null,i.innerAppearance,!0,null,0,-100)},e.prototype.showIconTips=function(){var t=2;switch(this.costType){case 2:UIMgr.ins().open(CurrencyTipsView,t,this.costCount);break;case 1:t=DataCenter.ins().AshtarteConfig.stageitemid,UIMgr.ins().open(ItemTipsView,0,t,this.costCount);break;case 22:t=DataCenter.ins().AshtarteBaseConfig[this.zlId].mat,UIMgr.ins().open(AshtarteTipsView,t)}},e.prototype.autoUpStar=function(){if(this.isAutoUp){var t=this.checkBoxs.selected?1:0;if(!this._tick&&!this.checkUpStar())return this.isAutoUp=!1,void TimerMgr.ins().remove(this.autoUpStar,this);ashtarteControl.upUpExp(this.zlId,t)}},e.prototype.checkUpStar=function(){if("skin_max"==this.currentState||"zl_max"==this.currentState)return tipsControl.showTips(LangMgr.getValueByKey("hijiTips6")),this.upBtn.label=LangMgr.getValueByKey("wingTips6"),!1;if(!ashtarteControl.getZhanLingDataById(this.zlId))return tipsControl.showTips(LangMgr.getValueByKey("wingTips8")),this.upBtn.label=LangMgr.getValueByKey("wingTips6"),!1;var t=this.checkBoxs.selected?1:0,e=this.getCostValue(),i=e[0],n=e[1];if(!i||n>i){if(!t)return tipsControl.showTips(LangMgr.getValueByKey("wingTips10")),this.upBtn.label=LangMgr.getValueByKey("wingTips6"),!1;if(i=ActorControl.yb,n=DataCenter.ins().AshtarteConfig.unitPrice*n,!i||n>i)return tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),this.upBtn.label=LangMgr.getValueByKey("wingTips6"),!1}return this.upBtn.label=LangMgr.getValueByKey("cancel1"),!0},e.prototype.sort=function(t,e){var i=DataCenter.ins().AshtarteEquipConfig[t.configID],n=DataCenter.ins().AshtarteEquipConfig[e.configID];return i.level>n.level?-1:1},e.prototype.getIndexRule=function(){var t=0;ashtarteControl.updateShowZLlist(),t=ashtarteControl.showZLlist[0].id;for(var e=0;e<ashtarteControl.showZLlist.length;e++){var i=ashtarteControl.showZLlist[e].id,n=ashtarteControl.isUpGradeByStar(i),o=ashtarteControl.isUpGradeByTalent(i),s=ashtarteControl.getZhanLingItemRedPoint(i);if(n||o||s){t=i;break}var r=ashtarteControl.getZhanLingDataByLevel(i);r||(ashtarteControl.getZhanLingDataById(DataCenter.ins().AshtarteBaseConfig[t].id)?t=i:DataCenter.ins().AshtarteBaseConfig[t].sort>DataCenter.ins().AshtarteBaseConfig[i].sort&&(t=i))}return t},e.prototype.onChange=function(){this.list.scrollV<39?(this.btn0.visible=!1,this.btn1.visible=!0):this.list.scrollV>=this.list.contentHeight-this.list.height-39?(this.btn0.visible=!0,this.btn1.visible=!1):(this.btn0.visible=!0,this.btn1.visible=!0),this.list.numElements<=4&&(this.btn0.visible=this.btn1.visible=!1),this.rightRed0.visible=this.btn0.visible?this.hxRedPoint.visible:!1,this.rightRed1.visible=this.btn1.visible?this.hxRedPoint.visible:!1},e.prototype.setStartPosition=function(t){if(this.listScroller.height>=this.list.contentHeight)t=0;else{var e=this.list.contentHeight-this.listScroller.height;e=e>0?e:0,t>=e&&(t=e)}this.list.scrollV=t},e.prototype.getDrugItemByIndex=function(t){var e=0,i=DataCenter.ins().AshtarteConfig;for(var n in i.upgradeInfo){var o=i.upgradeInfo[n].sort;if(o==t){e=Number(n);break}}return e},e}(BaseEuiView);__reflect(AshtartePanel.prototype,"AshtartePanel");var WelfareView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WelfareViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.iconList.itemRenderer=WelfareBtnItemRenderer,this.allPanels=[];
for(var e in DataCenter.ins().WelfareConfig){var i=DataCenter.ins().WelfareConfig[e];this.allPanels.push(egret.getDefinitionByName(i.className))}this.panels=[],this.arrList=new eui.ArrayCollection},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventChange(this.iconList,this.onClickMenu),this.addEventChangeEnd(this.listBar,this.onChange),this.addCustomEvent(175,this.updateMenuList),this.addCustomEvent(79,this.updateMenuList),this.addCustomEvent(404,this.updateMenuList),this.addCustomEvent(181,this.updateMenuList),this.addCustomEvent(392,this.updateMenuList),this.addCustomEvent(288,this.updateMenuList),this.addCustomEvent(177,this.updateMenuList),this.addCustomEvent(677,this.updateMenuList),this.index=0,e[0]&&(this.index=e[0],this.initFunc=function(){var e=t.panels.indexOf(t.allPanels[t.index]);e=0>e?0:e,t.index=e}),this.updateMenuList([!0],e[1]),this.updateSelectPos(),this.onChange()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cruPanel.close&&this.cruPanel.close()},e.prototype.updateMenuList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._datas=[],this.panels=this.allPanels;var i,n=!1,o=0;t&&t[0]&&(t[0][0]&&(n=t[0][0]),t[0][1]&&(o=t[0][1]));for(var s in DataCenter.ins().WelfareConfig)i=DataCenter.ins().WelfareConfig[s],this._datas.push(i);this._datas.sort(function(t,e){return t.sort<e.sort?-1:1});var r=!0;for(var a in DataCenter.ins().SevenDayConfig){var l=DataCenter.ins().SevenDayConfig[a];if(0==(amusementControl.isAwards>>l.day&1)){r=!1;break}}this.panels=[];for(var h=0;h<this._datas.length;)if(platformAmuseControl.checkFuLiOpen(this._datas[h].id)){i=this._datas[h];var u=!1;switch(i.id){case 1:r&&(this._datas.splice(h,1),u=!0);break;case 6:dailyRedBagControl.checkSysOpen()||(this._datas.splice(h,1),u=!0)}u||(this.panels.push(this.allPanels[i.id]),h++)}else this._datas.splice(h,1);this.arrList.replaceAll(this._datas),this.initFunc&&(this.initFunc(),this.initFunc=null),this.iconList.selectedIndex=this.index,this.iconList.dataProvider=this.arrList,n&&(this.curId=this.iconList.selectedIndex,this.updateDetail(t[1]));var p=this.btnNum;this.btnNum=this._datas.length,p>0&&p!=this.btnNum&&(this.iconList.selectedIndex>=this.btnNum&&(this.curId=this.iconList.selectedIndex=this.btnNum?this.btnNum-1:0),this.updateDetail()),this.onChange()},e.prototype.onClickMenu=function(t){SoundUtils.ins().playEffect(SoundUtils.VIEW),this.curId=this.iconList.selectedIndex,this.index=this.curId,this.updateDetail()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.rightBtn:this.iconList.scrollH+=90,this.iconList.scrollH>this.iconList.contentWidth-this.listBar.width&&(this.iconList.scrollH=this.iconList.contentWidth-this.listBar.width),this.onChange();break;case this.leftBtn:this.iconList.scrollH-=90,this.iconList.scrollH<0&&(this.iconList.scrollH=0),this.onChange()}},e.prototype.onChange=function(){this.iconList.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.iconList.scrollH>=this.iconList.contentWidth-this.listBar.width?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.rightRedPoint.visible=this.leftRedPoint.visible=!1,this.btnNum>5&&(this.updateLeftRedPoint(),this.updateRightRedPoint())},e.prototype.updateRightRedPoint=function(){if(this.rightBtn.visible&&(!this.iconList.contentWidth||this.iconList.scrollH+450<this.iconList.contentWidth-90)){var t=this.iconList.contentWidth-(this.iconList.scrollH+425);t=0>=t?0:t;var e=Math.floor(t/85);if(e>0&&e<=this._datas.length){e=this._datas.length-e;for(var i=this._datas.length-1;i>=e;i--){var n=this.iconList.dataProvider.getItemAt(i);if(n&&!isNaN(n.id)&&(this.rightRedPoint.visible=platformAmuseControl.checkFuLiRedPoint(n.id),this.rightRedPoint.visible))break}}}},e.prototype.updateLeftRedPoint=function(){if(this.leftBtn.visible&&this.iconList.scrollH>=85){var t=Math.floor(this.iconList.scrollH/85);if(t<=this._datas.length)for(var e=0;t>e;e++){var i=this.iconList.dataProvider.getItemAt(e);if(i&&!isNaN(i.id)&&(this.leftRedPoint.visible=platformAmuseControl.checkFuLiRedPoint(i.id),this.leftRedPoint.visible))break}}},e.prototype.updateDetail=function(t){this.cruPanel&&(this.cruPanel.$onClose(),DisplayUtils.removeFromParent(this.cruPanel),this.cruPanel.close&&this.cruPanel.close()),this.cruPanel=new this.panels[this.curId],welfareControl.isOpen[this.curId]||(welfareControl.isOpen[this.curId]=!0,this.updateMenuList()),this.cruPanel&&(this.cruPanel.left=0,this.cruPanel.right=0,this.cruPanel.top=0,this.cruPanel.bottom=0,this.info.addChild(this.cruPanel),this.cruPanel.open(t),this.cruPanel.validateNow())},e.prototype.updateSelectPos=function(){this.iconList.validateNow();for(var t=0;t<this.iconList.numElements;t++){var e=this.iconList.getVirtualElementAt(t);t==this.index&&(this.iconList.scrollH=t*e.width,this.iconList.contentWidth-this.iconList.scrollH<=this.listBar.width&&(this.iconList.scrollH=this.iconList.contentWidth-this.listBar.width))}},e}(BaseEuiView);__reflect(WelfareView.prototype,"WelfareView");var BeastRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redpointEquips1=[],e.redpointEquips2=[],e.redpoints=[],e.redpoint=!1,e.addCustomEventMany(e.dispatchRedPoint,497,496,254),e.addCustomEventMany(e.dispatchRedPoint1,252,266,268,269),e.addCustomEventMany(e.dispatchRedPoint2,252,255,253),e}return __extends(e,t),e.prototype.dispatchRedPoint=function(){if(!beastControl.checkOpen())return this.redpoint=!1,void EventMgr.ins().dispatch(498,0);this.redpoints=[];for(var t in DataCenter.ins().BeastBaseConfig)if(this.redpoints[t]=this.redpointEquips1[t]&&this.redpointEquips1[t].indexOf(1)>-1,!this.redpoints[t]&&this.redpointEquips2[t]&&(this.redpoints[t]=this.redpointEquips2[t].indexOf(1)>-1),!this.redpoints[t]){var e=beastControl.getDataById(parseInt(t));this.redpoints[t]=e&&0==e.state&&beastControl.isCanBattle()}this.redpoint=this.redpoints.indexOf(!0)>-1,EventMgr.ins().dispatch(498,this.redpoint?1:0)},e.prototype.dispatchRedPoint1=function(){if(beastControl.checkOpen())for(var t in DataCenter.ins().BeastBaseConfig){var e=beastControl.dataList[t];this.redpointEquips1[t]=[];for(var i=1;i<=DataCenter.ins().BeastConfig.posCount;i++){var n=beastControl.findCanWearEquips(+t,i);n.length>0?(this.redpointEquips1[t][i]=1,e&&e.equipIDs[i]&&beastControl.checkEquipScore(e.equipIDs[i],n[0].id)&&(this.redpointEquips1[t][i]=0)):this.redpointEquips1[t][i]=0}}else this.redpointEquips1=[];EventMgr.ins().dispatch(497)},e.prototype.dispatchRedPoint2=function(){if(beastControl.checkOpen())for(var t in beastControl.dataList){var e=beastControl.dataList[t];this.redpointEquips2[t]=[];for(var i=1;5>=i;i++)e.equipIDs[i]&&this.getForgeRedpoint(e.equipIDs[i],beastControl.exp)&&2!=e.state?this.redpointEquips2[t][i]=1:this.redpointEquips2[t][i]=0}else this.redpointEquips2=[];EventMgr.ins().dispatch(496)},e.prototype.getForgeRedpoint=function(t,e){return DataCenter.ins().BeastEquipConfig[t+1]&&e>=DataCenter.ins().BeastEquipConfig[t].exp},e}(BaseSystem);__reflect(BeastRedPoint.prototype,"BeastRedPoint");var BeastEquipItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchChildren=!1,e}return __extends(e,t),e.prototype.setPosData=function(t,e){var i=DataCenter.ins().BeastBaseConfig[t].minLevel[e-1];this.imgBg.source="quality0",this.nameTxt.text=LangMgr.getValueByKey("ssQualityName"+i)+LangMgr.getValueByKey("ssEquipPosName"+(e-1)),this.nameTxt.textColor=LangMgr.getColor("qualityColor0"),this.imgIcon.source="ss_equip"+(e-1),this.equipLv.text="",this.data=null},e.prototype.dataChanged=function(){if(!isNaN(this.data)&&this.data){this.itemConfig=DataCenter.ins().ItemConfig[this.data],this.nameTxt.text=this.itemConfig.name,this.nameTxt.textColor=ItemUtils.getQualityColor(this.itemConfig),this.imgBg.source="quality"+ItemUtils.getQuality(this.itemConfig),this.imgIcon.source=this.itemConfig.icon+"_png";var t=beastControl.getEquipLv(this.itemConfig.id)-1;this.equipLv.text=t>0?"+"+t:""}},e}(BaseItemRender);__reflect(BeastEquipItemRenderer.prototype,"BeastEquipItemRenderer");var BookRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.redPoint0=!1,e.redPoint1=!1,e.redPoint2=!1,e.danRed=!1,e.addCustomEventMany(e.dispatchRedPoint,500,501,502),e.addCustomEventMany(e.dispatchRedPoint0,47,266,352),e.addCustomEventMany(e.dispatchRedPoint1,47,266),e.addCustomEventMany(e.dispatchRedPoint2,47),e.addCustomEventMany(e.postDanRed,47,267),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=this.redPoint0||this.redPoint1||this.redPoint2,t!=this.redPoint&&EventMgr.ins().dispatch(499,!0)},e.prototype.dispatchRedPoint0=function(){var t=this.redPoint0;this.redPoint0=bookControl.getBookRed(),t!=this.redPoint0&&EventMgr.ins().dispatch(500,!0)},e.prototype.dispatchRedPoint1=function(){var t=this.redPoint1;this.redPoint1=bookControl.checkResolveRedPoint(),t!=this.redPoint1&&EventMgr.ins().dispatch(501,!0)},e.prototype.dispatchRedPoint2=function(){var t=this.redPoint2;this.redPoint2=bookControl.getBookUpRed(),t!=this.redPoint2&&EventMgr.ins().dispatch(502,!0)},e.prototype.postDanRed=function(){var t=this.danRed;this.danRed=bookControl.checkDanRed(),t!=this.danRed&&EventMgr.ins().dispatch(704)},e}(BaseSystem);__reflect(BookRedPoint.prototype,"BookRedPoint");var GameNoticePanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameNoticePanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=GlobalModel.getUrlParamValue("notice"),n=i.split("_");this.title.textFlow=TextUtils.generateTextFlow(n[0]),this.desc.textFlow=TextUtils.generateTextFlow(n[1]),this.desc.height=this.desc.textHeight,noticeControl.isOpenNotice&&(noticeControl.isOpenNotice=!1,noticeControl.dispatchGameNotice(),noticeControl.upSetNoticeOPen()),this.addCustomEvent(392,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){this._cfg=DataCenter.ins().WelfareConfig[4];var t=amusementControl.getAmusementDataById(this._cfg.activityId?this._cfg.activityId:0);t?(this.updataReward.visible=!0,this.suerBtn.enabled=t.canReward(),this.redPoint.visible=this.suerBtn.enabled,t.getRewardStateById(1)==AmusementControl.Geted?(this.yilingqu.visible=!0,this.suerBtn.visible=!1):(this.yilingqu.visible=!1,this.suerBtn.visible=!0),this._collect||(this._collect=new ArrayCollection,this.reward.dataProvider=this._collect),this._collect.source=DataCenter.ins().Amusement1Config[this._cfg.activityId][1].rewards):this.updataReward.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.suerBtn:amusementControl.upReward(this._cfg.activityId,1)}},e}(BasePanel);__reflect(GameNoticePanel.prototype,"GameNoticePanel");var WorldBossRankItemVo=function(){function t(){}return t.prototype.init=function(t){this.id=t[0],this.roleName=t[1],this.value=t[2]},Object.defineProperty(t.prototype,"name",{get:function(){return this.roleName+":"+CommonUtils.overLength(this.value)},enumerable:!0,configurable:!0}),t}();__reflect(WorldBossRankItemVo.prototype,"WorldBossRankItemVo");var PublicBossRemindItemRenderer=function(t){function e(){var e=t.call(this)||this;return e._move=!1,e._lastX=0,e._lastY=0,e.addEventAddedFromStage(e,e.addToStage),e.addEventRemovedFromStage(e,e.removeToStage),e}return __extends(e,t),e.prototype.addToStage=function(){this.addEventTouchBegin(this.checkBoxs,this.onTouchBegin1),this.addEventChange(this.checkBoxs,this.onChange)},e.prototype.removeToStage=function(){this.removeEventTouchBegin(this.checkBoxs,this.onTouchBegin1),this.removeEventChange(this.checkBoxs,this.onChange)},e.prototype.setting=function(){var t=this;egret.callLater(function(){t.setSetting(t.data.id,t.checkBoxs.selected)},this)},e.prototype.setSetting=function(t,e){bossControl.setBossSetting(t,e)},e.prototype.getSetting=function(t){return bossControl.getBossRemindByIndex(t)},e.prototype.onChange=function(){this.setting()},e.prototype.onTouchBegin1=function(t){this._lastX=t.stageX,this._lastY=t.stageY,this._lastSelect=this.checkBoxs.selected,this._move=!1,this.$stage&&(this.addEventTouchMove(this.$stage,this.onTouchMove1),this.addEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.onTouchMove1=function(t){MathUtils.getDistance(this._lastX,this._lastY,t.stageX,t.stageY)>20&&(this._move=!0)},e.prototype.onTouchEnd1=function(){this._move&&(this.checkBoxs.selected=this._lastSelect,this._move=!1),this.$stage&&(this.removeEventTouchMove(this.$stage,this.onTouchMove1),this.removeEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.checkMoveEvent=function(){this._move&&this.$stage&&(this.removeEventTouchMove(this.$stage,this.onTouchMove1),this.removeEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.dataChanged=function(){this.checkMoveEvent();var t,e=this.data,i=DataCenter.ins().WorldBossConfig[e.id],n=BossControl.isCanChallenge(i);t=i.samsaraLv>0?i.showName:i.zsLevel>0?LangMgr.getValueByKey("numberRotation",i.zsLevel):i.belongvip>0?"VIP"+i.belongvip:LangMgr.getValueByKey("numberLevel",i.level),i.darkforce&&(n=e.canInto),this.checkBoxs.visible=n,n&&(this.checkBoxs.selected=bossControl.getBossRemindByIndex(e.id)),this.txt.visible=!n,this.redpoint&&(this.redpoint.visible=!1),this.checkBoxs.name=e.id+"";var o=DataCenter.ins().MonstersConfig[i.bossId];this.bossName.text=o.name,this.levelShow&&(this.levelShow.text=t)},e}(BaseItemRender);__reflect(PublicBossRemindItemRenderer.prototype,"PublicBossRemindItemRenderer");var WarriorModel=function(t){function e(){var e=t.call(this)||this;return e.warriorDataDict={},e.equipDataDict={},e.fuzhuList=[],e.equipStrenExp=0,e.canRemindBossIdList=[],e.bossRedPoint=0,e.flagFromTaskWinBattle=!1,e.firstOpenWinWhenLogin=!0,e.hasInitTask=!1,e.addCustomEventMany(e.dispatchBossRedPoint,296,43,112,466,42),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.updateWarriorData=function(t){this.warriorDataDict[t.id]=t},e.prototype.updateEquipData=function(t,e){this.equipDataDict[t]||(this.equipDataDict[t]={}),this.equipDataDict[t][e.pos]=e},e.prototype.updateBattingId=function(t){this.battingId=t},e.prototype.updateEquipStrenExp=function(t){this.equipStrenExp=t},e.prototype.updateFuzhuList=function(t){this.fuzhuList=t},e.prototype.updateTaskData=function(t,e){this.taskStaus=t,this.taskValue=e,this.hasInitTask=!0},e.prototype.getWarriorDataDict=function(){return this.warriorDataDict},e.prototype.getWarriorData=function(t){return this.warriorDataDict[t]},e.prototype.getFuzhuIdByIndex=function(t){return this.fuzhuList[t]},e.prototype.getFuzhuList=function(){return this.fuzhuList},e.prototype.getTaskValue=function(){return this.taskValue},e.prototype.getTaskStatus=function(){return this.taskStaus},e.prototype.checkIsEquipWearing=function(t,e){var i=this.getEquipData(t,e);return i&&0!=i.itemId},e.prototype.getEquipData=function(t,e){return this.equipDataDict[t]&&this.equipDataDict[t][e]},e.prototype.getAllEquipingData=function(t){var e=[];if(this.equipDataDict[t])for(var i in this.equipDataDict[t])this.checkIsEquipWearing(t,Number(i))&&e.push(this.equipDataDict[t][i]);return e},e.prototype.checkIsUpBattling=function(t){return this.checkIsActivated(t)&&t==this.battingId},e.prototype.getBattlingId=function(){return this.battingId},e.prototype.checkIsTaskStage=function(){return!(3==this.taskStaus)},e.prototype.checkIsActivated=function(t){return!!this.warriorDataDict[t]},e.prototype.checkIsStrenLevMax=function(t){var e=WarriorConfigMgr.ins().getMaxStrenLev(t);return this.getCurLev(t)==e},e.prototype.checkIsBreachLevMax=function(t){var e=WarriorConfigMgr.ins().getMaxBreachLev(t);return this.getCurBreachLev(t)==e},e.prototype.checkIsEquipPosStrenLevMax=function(t,e){var i=WarriorConfigMgr.ins().getEquipMaxStrenLev(e);return this.getCurEquipPosStrenLev(t,e)==i},e.prototype.getCurLev=function(t){var e=this.getWarriorData(t);return e?e.strenLev:0},e.prototype.getCurBreachLev=function(t){var e=this.getWarriorData(t);return e?e.breachLev:0},e.prototype.getCurEquipPosStrenLev=function(t,e){var i=this.getEquipData(t,e);return i?i.strenLev:0},e.prototype.getEquipStrenExp=function(){return this.equipStrenExp},e.prototype.getDrugAUsedNum=function(t){var e=this.getWarriorData(t);return e?e.useDrugANum:0},e.prototype.getDrugLimitNum=function(t,e){var i=this.getCurLev(t),n=-1;for(var o in e){var s=Number(o);i>=s&&s>n&&(n=s)}return e[n]?e[n]:0},e.prototype.getNextLimitDrugLev=function(t,e){var i=this.getCurLev(t),n=Number.MIN_VALUE;for(var o in e){var s=Number(o);i>=s&&s>n&&(n=s)}var r=Number.MAX_VALUE;if(n>=0)for(var o in e){var s=Number(o);s>n&&r>s&&(r=s)}return e[r]?r:null},e.prototype.getDrugALimitNum=function(t){var e=WarriorConfigMgr.ins().getAttrConfigById(t);return this.getDrugLimitNum(t,e.ADrugLimit)},e.prototype.getDrugBLimitNum=function(t){var e=WarriorConfigMgr.ins().getAttrConfigById(t);return this.getDrugLimitNum(t,e.BDrugLimit)},e.prototype.getDrugNextLimitLv=function(t,e){var i=WarriorConfigMgr.ins().getAttrConfigById(t);return 1==e?this.getNextLimitDrugLev(t,i.ADrugLimit):this.getNextLimitDrugLev(t,i.BDrugLimit)},e.prototype.getDrugBUsedNum=function(t){var e=this.getWarriorData(t);return e?e.useDrugBNum:0},e.prototype.checkCostEnough=function(t,e,i){var n=i?backpackControl.getBagItemById(t):backpackControl.getBagItemById(t,i);return n&&n.count>=e},e.prototype.getStrenLevCostNum=function(t){var e=WarriorConfigMgr.ins().getLevConfigByLev(t,this.getCurLev(t)+1);return e.count},e.prototype.getBreachLevCostNum=function(t){var e=WarriorConfigMgr.ins().getBreanchConfigByLev(t,this.getCurBreachLev(t)+1);return e.count},e.prototype.getActiveAttr=function(t){var e=WarriorConfigMgr.ins().getAttrConfigById(t),i=CommonUtils.copyDataHandler(e.attr),n=0;if(this.checkIsActivated(t)){var o=this.getWarriorData(t);n=o.useDrugBNum*e.addPre/1e4;for(var s=0,r=i;s<r.length;s++){var a=r[s];a.value*=1+n}}return i},e.prototype.getStrenLevAttr=function(t,i){if(this.checkIsActivated(t)){var n=void 0,o=WarriorConfigMgr.ins().getLevConfigByLev(t,i);n=o?CommonUtils.copyDataHandler(o.attrs):[];var s=this.getWarriorData(t),r=WarriorConfigMgr.ins().getAttrConfigById(t),a=[];if(s.useDrugANum>0)for(var l=0,h=r.Aattr;l<h.length;l++){var u=h[l];a.push({type:u.type,value:u.value*s.useDrugANum})}var p=[];if(s.useDrugBNum>0)for(var c=0,d=r.Battr;c<d.length;c++){var u=d[c];p.push({type:u.type,value:u.value*s.useDrugBNum})}for(var g=s.useDrugBNum*r.addPre/1e4,m=0,f=n;m<f.length;m++){var u=f[m];u.value*=1+g}n=AttributeData.AttrAddition(n,a),n=AttributeData.AttrAddition(n,p);var v=[],y=DataCenter.ins().WarriorSkillConfig;for(var C in y)for(var T=y[C],w=T.id,I=0,b=0,D=r.skill;b<D.length;b++){var B=D[b];B.id==w&&(I=B.open,e.ins().getCurLev(t)>=I&&(v=AttributeData.AttrAddition(v,T.attrs)))}return n=AttributeData.AttrAddition(n,v)}return[]},e.prototype.getStrenCurLevAttr=function(t){return this.getStrenLevAttr(t,this.getCurLev(t))},e.prototype.getStrenNextLevAttr=function(t){return this.getStrenLevAttr(t,this.getCurLev(t)+1)},e.prototype.getBreachLevAttr=function(t,e){if(this.checkIsActivated(t)){var i=WarriorConfigMgr.ins().getBreanchConfigByLev(t,e);return i?i.attrs:[]}return[]},e.prototype.getBreachCurAttr=function(t){return this.getBreachLevAttr(t,this.getCurBreachLev(t))},e.prototype.getBreachNextAttr=function(t){return this.getBreachLevAttr(t,this.getCurBreachLev(t)+1)},e.prototype.getEquipStrenAttr=function(t,e){var i=WarriorConfigMgr.ins().getEquipLevUpCfgByLev(e,this.getCurEquipPosStrenLev(t,e));return i?i.strengthenAttr:[]},e.prototype.getEquipStrenNextAttr=function(t,e){var i=WarriorConfigMgr.ins().getEquipLevUpCfgByLev(e,this.getCurEquipPosStrenLev(t,e)+1);return i?i.strengthenAttr:[]},e.prototype.getEquipAttr=function(t,e){if(this.checkIsEquipWearing(t,e)){var i=this.getEquipData(t,e);if(i){var n=i.itemId,o=WarriorConfigMgr.ins().getEquipCfgByid(n);return o&&o.attr}}return[]},e.prototype.getEquipSuitAttr1=function(t){var e=null,i=WarriorConfigMgr.ins().getEquipSuitDict();t.sort(function(t,e){var i=WarriorConfigMgr.ins().getEquipCfgByid(t.itemId),n=WarriorConfigMgr.ins().getEquipCfgByid(e.itemId);return n.star-i.star});for(var n in i){var o=Number(n);if(t.length>=o){var s=t[o-1],r=WarriorConfigMgr.ins().getEquipCfgByid(s.itemId),a=r.star,l=WarriorConfigMgr.ins().getEquipSuitMaxStar(o);a>l&&(a=l);var h=WarriorConfigMgr.ins().getEquipSuitCfg(o,a);if(e||(e={}),h)e[o]=[h.attrs,a,!0];else{var u=WarriorConfigMgr.ins().getEquipSuitMinStar(o);h=WarriorConfigMgr.ins().getEquipSuitCfg(o,u),e[o]=[h.attrs,u,!1]}}else{var p=WarriorConfigMgr.ins().getEquipSuitMinStar(o);if(e)for(var c in e)p<e[c][1]&&(p=e[c][1]);var h=WarriorConfigMgr.ins().getEquipSuitCfg(o,p);e||(e={}),e[o]=[h.attrs,p,!1]}}return e},e.prototype.getEquipSuitAttr=function(t){var e=this.getAllEquipingData(t);return this.getEquipSuitAttr1(e)},e.prototype.getOneEquipAllStrenAttr=function(t){for(var e=[],i=WarriorConfigMgr.ins().getEquipPosNum(),n=0;i>=n;++n)WarriorConfigMgr.ins().checkEquipPosExit(n)&&(e=AttributeData.AttrAddition(e,this.getEquipStrenAttr(t,n)));return e},e.prototype.getOneEquipAllEquipAttr=function(t){for(var e=[],i=WarriorConfigMgr.ins().getEquipPosNum(),n=0;i>=n;++n)WarriorConfigMgr.ins().checkEquipPosExit(n)&&(e=AttributeData.AttrAddition(e,this.getEquipAttr(t,n)));return e},e.prototype.getEquipCurAttr=function(t){var e=this.getOneEquipAllEquipAttr(t),i=this.getOneEquipAllStrenAttr(t),n=this.getEquipSuitAttr(t),o=[];if(n)for(var s in n){var r=n[s],a=r[2];a&&(o=AttributeData.AttrAddition(o,r[0]))}var l=[];return l=AttributeData.AttrAddition(l,e),l=AttributeData.AttrAddition(l,i),l=AttributeData.AttrAddition(l,o)},e.prototype.getEquipingNums=function(t){var e=this.getAllEquipingData(t);return e.length},e.prototype.getEquipWuxingAttr=function(){for(var t=[],e=1;5>=e;++e)t.push({type:e,value:0});for(var e=1;e<=WarriorConfigMgr.MAX_EQUIP_ID;++e)for(var i=this.getAllEquipingData(e),n=0,o=i;n<o.length;n++){var s=o[n],r=WarriorConfigMgr.ins().getEquipCfgByid(s.itemId);t=AttributeData.AttrAddition(r.FiveElementsForce,t)}return t},e.prototype.getOneEquipFiveAttr=function(t,e){var i=[];if(this.checkIsEquipWearing(t,e)){var n=this.getEquipData(t,e),o=WarriorConfigMgr.ins().getEquipCfgByid(n.itemId);i=o.FiveElementsForce?o.FiveElementsForce:i}return i},e.prototype.getStrenExp=function(t){var e=this.getWarriorData(t);return e?e.strenExp:0},e.prototype.getStrenExpMax=function(t){var e=this.getCurLev(t)+1,i=WarriorConfigMgr.ins().getLevConfigByLev(t,e);return i?i.exp:0},e.prototype.getBagEquipsByPos=function(t){var e=[],i=backpackControl.getBagItemByType(101);if(i)for(var n=0,o=i;n<o.length;n++){var s=o[n],r=WarriorConfigMgr.ins().getEquipCfgByid(s.configID);r.pos==t&&e.push(s)}return e.sort(function(t,e){return e.configID-t.configID}),e},e.prototype.filterResolveItemInfos=function(t){for(var e=[],i=this.getBagEquipsByPos(t),n=0,o=i;n<o.length;n++){var s=o[n],r=s.configID,a=WarriorConfigMgr.ins().getEquipCfgByid(r);a.totalExp&&e.push({itemInfo:s,curLeftNum:s.count})}for(var l=[],h=1;h<=WarriorConfigMgr.MAX_EQUIP_ID;++h)if(this.equipOpen(h)){var u=this.checkIsEquipWearing(h,t);if(u){var p=this.getEquipData(h,t);l.push(p.itemId)}else if(e.length>0){var c=e[0];c.curLeftNum--,c.curLeftNum<=0&&e.splice(0,1)}}l.sort(function(t,e){return e-t});var d=0;if(e.length>0&&l.length>0)for(var h=0;h<e.length;){for(var g=!1,m=0,f=l;m<f.length;m++){var v=f[m];if(e[h].itemInfo.configID>v&&(e[h].curLeftNum--,e[h].curLeftNum<=0)){e.splice(h,1),d++,g=!0;break}}if(d>=l.length)break;g||++h}return e},e.prototype.getOneWarriorPower=function(t){var e=this.checkIsActivated(t),i=[];e&&(i=this.getActiveAttr(t));var n=this.getStrenCurLevAttr(t),o=AttributeData.AttrAddition(i,n),s=BackpackControl.getAttrPower(o),r=0,a=WarriorConfigMgr.ins().getAttrConfigById(t),l=DataCenter.ins().WarriorSkillConfig;for(var h in l)for(var u=l[h],p=u.id,c=0,d=0,g=a.skill;d<g.length;d++){var m=g[d];if(m.id==p){c=m.open;this.getCurLev(t)>=c;this.getCurLev(t)>=c&&(r+=u.expower?u.expower:0)}}return(s+r)*heroControl.subRolesLen},e.prototype.getAllWarriorPower=function(){var t=0;for(var e in this.warriorDataDict)t+=this.getOneWarriorPower(this.warriorDataDict[e].id);return t},e.prototype.checkDunFive=function(t){var e=DataCenter.ins().WorldBossConfig[t],i=this.getEquipWuxingAttr(),n=!0;if(e.FiveElementsForce)for(var o=0;o<e.FiveElementsForce.length;++o){for(var s=!1,r=0;r<i.length;++r)if(e.FiveElementsForce[o].type==i[r].type){s=!0,e.FiveElementsForce[o].value>i[r].value&&(n=!1);break}if(s||(n=!1),!n)break}return n},e.prototype.getBossListDatas=function(){var t=20;if(!bossControl.worldInfoList[t])return[];for(var i=bossControl.worldInfoList[t].slice(),n=[],o=[],s=[],r=[],a=[],l=[],h=0;h<i.length;++h){var u=i[h],p=bossControl.getBossRemindByIndex(u.id),c=DataCenter.ins().WorldBossConfig[u.id];if(c){var d=this.checkDunFive(u.id),g=BossControl.isCanChallenge(c),m=c.openTime<=GameServer.serverOpenDay;m&&(p&&d&&g?u.isDie?s.push({bossItem:u,isOpenForFive:d,isOpenForLv:g}):o.push({bossItem:u,isOpenForFive:d,isOpenForLv:g}):d&&g?u.isDie?l.push({bossItem:u,isOpenForFive:d,isOpenForLv:g}):a.push({bossItem:u,isOpenForFive:d,isOpenForLv:g}):r.push({bossItem:u,isOpenForFive:d,isOpenForLv:g}))}}return o.sort(this.compareFn),s.sort(this.compareFn),r.sort(this.compareFn2),r=r.splice(0,3),a.sort(this.compareFn),l.sort(this.compareFn),n=o.concat(s,r,a,l),e.ins().canRemindBossIdList=[],n.map(function(t){return e.ins().canRemindBossIdList.push(t.bossItem.id),WorldBossItemVo}),n},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.bossItem.id],n=DataCenter.ins().WorldBossConfig[e.bossItem.id];return i.zsLevel>n.zsLevel?-1:i.zsLevel<n.zsLevel?1:t.bossItem.id>e.bossItem.id?-1:t.bossItem.id<e.bossItem.id?1:0},e.prototype.compareFn2=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.bossItem.id],n=DataCenter.ins().WorldBossConfig[e.bossItem.id];return i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:t.bossItem.id>e.bossItem.id?1:t.bossItem.id<e.bossItem.id?-1:0},e.prototype.checkCanActive=function(t){if(!this.checkIsActivated(t)){var e=WarriorConfigMgr.ins().getAttrConfigById(t);return this.checkCostEnough(e.itemId,1)}return!1},e.prototype.checkCanStrenLev=function(t){return!this.checkIsStrenLevMax(t)&&this.checkIsActivated(t)?this.checkCostEnough(WarriorConfigMgr.ins().getStrenLevCostId(),this.getStrenLevCostNum(t),WarriorConfigMgr.ins().getStrenLevlCostType()):!1},e.prototype.checkCanUseDrug=function(t){return this.checkUseDrugA(t)||this.checkUseDrugB(t)},e.prototype.checkUseDrugA=function(t){if(!this.checkIsActivated(t))return!1;var e=this.getDrugAUsedNum(t),i=this.getDrugALimitNum(t);if(e>=i)return!1;var n=WarriorConfigMgr.ins().getAttrConfigById(t),o=n.AItemId;return this.checkCostEnough(o,1)},e.prototype.checkUseDrugB=function(t){if(!this.checkIsActivated(t))return!1;var e=this.getDrugBUsedNum(t),i=this.getDrugBLimitNum(t);if(e>=i)return!1;var n=WarriorConfigMgr.ins().getAttrConfigById(t),o=n.BItemId;return this.checkCostEnough(o,1)},e.prototype.checkOneWarriorRedForTabStren=function(t){return this.checkCanActive(t)||this.checkCanStrenLev(t)||this.checkCanUseDrug(t)},e.prototype.checkAllWarriorRedForTabStren=function(){var t=WarriorConfigMgr.ins().getAttrConfigs();for(var e in t){var i=t[e];if(this.checkOneWarriorRedForTabStren(i.Id))return!0}return!1},e.prototype.checkCanBreach=function(t){return this.checkIsActivated(t)&&!this.checkIsBreachLevMax(t)?this.checkCostEnough(WarriorConfigMgr.ins().getBreachCostId(t),this.getBreachLevCostNum(t),WarriorConfigMgr.ins().getBreachCostType()):!1},e.prototype.checkOneWarriorRedForTabBreach=function(t){return this.checkCanBreach(t)},e.prototype.checkAllWarriorRedForTabBreach=function(){var t=WarriorConfigMgr.ins().getAttrConfigs();for(var e in t){var i=t[e];if(this.checkOneWarriorRedForTabBreach(i.Id))return!0}return!1},e.prototype.equipOpen=function(t){var e=WarriorConfigMgr.ins().getBaseConfig();return reincarnateControl.lv<e.EquipZSLv?!1:GameServer.serverOpenDay+1<e.EquipOpenDay?!1:null!=t?2==t?this.getBattlingId()>0:1==t?this.fuzhuList[0]>0:this.fuzhuList[1]>0:!0},e.prototype.checkEquipWearRed=function(t,e){if(!this.equipOpen(t))return!1;if(this.checkIsEquipWearing(t,e)){var i=this.getEquipData(t,e),n=this.getBagEquipsByPos(e);return n.length>0?n[0].configID>i.itemId:!1}return this.getBagEquipsByPos(e).length>0},e.prototype.checkEquipStrenRed=function(t,i){if(!this.equipOpen(t))return!1;if(this.checkIsEquipWearing(t,i)){var n=this.checkIsEquipPosStrenLevMax(t,i);if(!n){var o=WarriorConfigMgr.ins().getEquipLevUpCfgByLev(i,e.ins().getCurEquipPosStrenLev(t,i)+1);return this.getEquipStrenExp()>=o.exp}}return!1},e.prototype.checkEquipResolveRed=function(t,e){return this.equipOpen(t)?this.filterResolveItemInfos(e).length>0:!1},e.prototype.checkEquipRed=function(t,e){return this.checkEquipWearRed(t,e)||this.checkEquipStrenRed(t,e)||this.checkEquipResolveRed(t,e)},e.prototype.checkOneRedForTabEquip=function(t){for(var e=WarriorConfigMgr.ins().getEquipPosNum(),i=0;e>=i;++i)if(WarriorConfigMgr.ins().checkEquipPosExit(i)&&this.checkEquipRed(t,i))return!0;return!1},e.prototype.checkAllRedForTabEquip=function(){for(var t=1;t<=WarriorConfigMgr.MAX_EQUIP_ID;++t)if(this.checkOneRedForTabEquip(t))return!0;return!1},e.prototype.checkRedForOneBossChallengeRed=function(t,e){var i=WarriorConfigMgr.ins().getBaseConfig();if(reincarnateControl.lv<i.BossZSLv)return!1;if(GameServer.serverOpenDay+1<i.BossOpenDay)return!1;var n,o=20;if(e)n=e;else for(var s=this.getBossListDatas(),r=0,a=s;r<a.length;r++){var l=a[r];if(l.bossItem.id==t){n=l;break}}if(!n)return!1;var h=bossControl.worldBossBelongBuyTime[o],u=DataCenter.ins().WorldBossBaseConfig.belongbuycount[o-1][vipControl.lv],p=bossControl.worldBossBelongTime[o];if(0>=p&&h>=u)return!1;if(n.bossItem.isDie)return!1;var c=DataCenter.ins().WorldBossConfig[t],d=BossControl.isCanChallenge(c),g=c.openTime<=GameServer.serverOpenDay,m=bossControl.getBossRemindByIndex(t);return d&&g&&m&&n.isOpenForFive},e.prototype.checkRedForAllBossForTabFuben=function(){for(var t=this.getBossListDatas(),e=0,i=t;e<i.length;e++){var n=i[e];if(this.checkRedForOneBossChallengeRed(n.bossItem.id,n))return!0}return!1},e.prototype.dispatchBossRedPoint=function(){this.bossRedPoint=this.checkRedForAllBossForTabFuben()?1:0,EventMgr.ins().dispatch(698,this.bossRedPoint)},e.prototype.checkEquipComposeRed=function(t,e){if(!this.equipOpen(t))return!1;var i=WarriorConfigMgr.ins().getEquipCfgByid(e);if(this.checkIsEquipWearing(t,i.pos)){var n=void 0,o=this.getEquipData(t,i.pos);if(n=o.itemId,n<WarriorConfigMgr.ins().getEquipMaxIdCfgByPos(i.pos).Id&&(n++,n==e)){var s=WarriorConfigMgr.ins().getEquipCfgByid(n);if(s.composeItem){var r=WarriorConfigMgr.ins().getEquipCfgByid(s.composeItem[0].id);return this.checkIsEquipWearing(t,r.pos)&&this.checkCostEnough(s.composeItem[1].id,s.composeItem[1].count)&&this.checkCostEnough(s.composeItem[2].id,s.composeItem[2].count)}}}return!1},e.prototype.checkEquipStarComposeRed=function(t,e){var i=WarriorConfigMgr.ins().getEquipComposeTabData(),n=i[e];for(var o in n){var s=n[o];if(this.checkEquipComposeRed(t,s.Id))return!0}return!1},e.prototype.checkEquipIdComposeRed=function(t){var e=WarriorConfigMgr.ins().getEquipComposeTabData();for(var i in e)if(this.checkEquipStarComposeRed(t,Number(i)))return!0;return!1},e.prototype.checkEquipRedForTabCompose=function(){for(var t=1;t<=WarriorConfigMgr.MAX_EQUIP_ID;++t)if(this.checkEquipIdComposeRed(t))return!0;
return!1},e.prototype.checkTaskRewardRed=function(){return 1==this.taskStaus},e}(BaseSystem);__reflect(WarriorModel.prototype,"WarriorModel");var CopyRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.redPoint0=!1,e.redPoint1=!1,e.redPoint2=!1,e.redPoint3=!1,e.redPoint4=!1,e.addCustomEventMany(e.dispatchRedPoint,522,523,524,525,526),e.addCustomEventMany(e.dispatchRedPoint0,368,369,696,453),e.addCustomEventMany(e.dispatchRedPoint1,527),e.addCustomEventMany(e.dispatchRedPoint2,506),e.addCustomEventMany(e.dispatchRedPoint3,681),e.addCustomEventMany(e.dispatchRedPoint4,77,76),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=this.redPoint0||this.redPoint1||this.redPoint2||this.redPoint3||this.redPoint4,t!=this.redPoint&&EventMgr.ins().dispatch(521,!0)},e.prototype.dispatchRedPoint0=function(){var t=this.redPoint0;this.redPoint0=copyControl.hasCount(),t!=this.redPoint0&&EventMgr.ins().dispatch(522,!0)},e.prototype.dispatchRedPoint1=function(){var t=this.redPoint1;this.redPoint1=DailyCopyRedPoint.ins().redPoint,t!=this.redPoint1&&EventMgr.ins().dispatch(523,!0)},e.prototype.dispatchRedPoint2=function(){var t=this.redPoint2;this.redPoint2=copyBabelControl.curLevel>1&&1==copyBabelControl.dayReward||copyBabelControl.lotteryRemainTimes>0,t!=this.redPoint2&&EventMgr.ins().dispatch(524,!0)},e.prototype.dispatchRedPoint3=function(){var t=this.redPoint3;this.redPoint3=copyControl.checkTFRed(),t!=this.redPoint3&&EventMgr.ins().dispatch(525,!0)},e.prototype.dispatchRedPoint4=function(){var t=this.redPoint4;this.redPoint4=soulBoneControl.showHunShouRed(),t!=this.redPoint4&&EventMgr.ins().dispatch(526,!0)},e}(BaseSystem);__reflect(CopyRedPoint.prototype,"CopyRedPoint");var DailyCopyRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.goldRed=!1,e.expRed=!1,e.guardRed=!1,e.magicCircleRed=!1,e.addCustomEventMany(e.dispatchRedPoint,528,539,540,541),e.addCustomEventMany(e.dispatchGold,389),e.addCustomEventMany(e.dispatchExp,371),e.addCustomEventMany(e.dispatchGuardWeapon,112,4,378),e.addCustomEventMany(e.dispatchMagicCircle,266,267,59),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=this.goldRed||this.expRed||this.guardRed||this.magicCircleRed,t!=this.redPoint&&EventMgr.ins().dispatch(527,!0)},e.prototype.dispatchGold=function(){var t=this.goldRed;this.goldRed=copyControl.fbGoldRed(),t!=this.goldRed&&EventMgr.ins().dispatch(528,!0)},e.prototype.dispatchExp=function(){var t=this.expRed;this.expRed=copyControl.fbExpRed(),t!=this.expRed&&EventMgr.ins().dispatch(539,!0)},e.prototype.dispatchGuardWeapon=function(){var t=this.guardRed;this.guardRed=guardControl.canChallenge(),t!=this.guardRed&&EventMgr.ins().dispatch(540,!0)},e.prototype.dispatchMagicCircle=function(){var t=this.magicCircleRed;this.magicCircleRed=magicCircleControl.checkDun(),t!=this.magicCircleRed&&EventMgr.ins().dispatch(541,!0)},e}(BaseSystem);__reflect(DailyCopyRedPoint.prototype,"DailyCopyRedPoint");var CrazyDogRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=0,e.addCustomEventMany(e.dispatchRedPoint,457,461,266,268,269),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redpoint;for(var e in DataCenter.ins().CrazyDogConfig){var i=+e;if(crazyDogControl.isActivation(i)||crazyDogControl.isUpLevel(i)||crazyDogControl.isHintNum(i)||crazyDogControl.isUpStar(i)){this.redpoint=1;break}}t!=this.redpoint&&EventMgr.ins().dispatch(678,!0)},e}(BaseSystem);__reflect(CrazyDogRedPoint.prototype,"CrazyDogRedPoint");var CrossArenaRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=0,e.redpoint_1=0,e.redpoint_2=0,e.redpoint_3=0,e.joinState=0,e.JoinRedPoint=[],e.addCustomEventMany(e.dispatchRedPoint,544,545),e.addCustomEventMany(e.dispatchRedPoint_1,324,315,323),e.addCustomEventMany(e.dispatchRedPoint_2,324,323),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){this.redpoint=this.redpoint_1+this.redpoint_2+this.redpoint_3,EventMgr.ins().dispatch(543,this.redpoint)},e.prototype.dispatchRedPoint_1=function(){this.redpoint_1=0,crossArenaControl.isEasyOpen()&&(crossArenaControl.duanLevel>crossArenaControl.awardDuan&&crossArenaControl.duanLevel>=2?this.redpoint_1=1:this.redpoint_1=0,this.redpoint_1<=0&&crossArenaControl.isOpen()&&(this.redpoint_1=crossArenaControl.times)),EventMgr.ins().dispatch(544,this.redpoint_1)},e.prototype.dispatchRedPoint_2=function(){if(this.redpoint_2=this.redpoint_3=0,this.joinState=0,this.JoinRedPoint=[],crossArenaControl.isEasyOpen()){var t=DataCenter.ins().CrossArenaBaseConfig.peakAwards,e=1,i=0,n=crossArenaControl.dflState;for(var o in t)1!=(n>>e&1)&&crossArenaControl.dflCount>=t[o].count?(i++,this.JoinRedPoint[e]=1):this.JoinRedPoint[e]=0,e++;this.redpoint_2=i,this.redpoint_3=0==crossArenaControl.dailyState?1:0,this.joinState=0==crossArenaControl.dailyState?1:2}EventMgr.ins().dispatch(545)},e}(BaseSystem);__reflect(CrossArenaRedPoint.prototype,"CrossArenaRedPoint");var CrossBossRedpoint=function(t){function e(){var e=t.call(this)||this;return e.redpoints=[],e.redpoint1=!1,e.redpoint2=!1,e.addCustomEventMany(e.dispatchRedPoint,326,328,329),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){if(this.redpoints=[],this.redpoint=0,this.redpoint1=!1,this.redpoint2=!1,!crossBossControl.isOpen())return void EventMgr.ins().dispatch(546,0);for(var t=0,e=crossBossControl.fbInfo;t<e.length;t++){var i=e[t];if(i){var n=DataCenter.ins().CrossBossConfig[i.dpId],o=reincarnateControl.lv>=n.levelLimit[0]/1e3&&reincarnateControl.lv<=n.levelLimit[1]/1e3,s=n.id!=DataCenter.ins().CrossBossBaseConfig.cydDpId&&1==n.type&&i.flagRefTimer-egret.getTimer()<0&&crossBossControl.flagTimes>0,r=i.bossRefTimer-egret.getTimer()<0&&crossBossControl.bossTimes>0;if(o&&(o=s||r),this.redpoints[i.dpId]=o?1:0,1==n.type)this.redpoint1||(this.redpoint1=o);else if(2==n.type){if(!crossBossControl.byBossIsOpen())continue;10!=i.dpId&&(this.redpoint2||(this.redpoint2=o))}}}this.redpoint=this.redpoints.indexOf(1)>-1?1:0,EventMgr.ins().dispatch(546,this.redpoint)},e}(BaseSystem);__reflect(CrossBossRedpoint.prototype,"CrossBossRedpoint");var DarkHallBossRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=0,e.redpoints=[],e.addCustomEventMany(e.dispatchRedPoint,296,231),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.redById=function(t){for(var e=0;e<this.redpoints.length;e++){var i=this.redpoints[e];if(i&&i[t])return!0}return!1},e.prototype.dispatchRedPoint=function(){this.redpoint=bossControl.checkWorldBossRedPoint(8)?1:0,this.checkBossRedpoint(),EventMgr.ins().dispatch(547,this.redpoint)},e.prototype.checkBossRedpoint=function(){if(this.redpoints=[],this.redpoint)for(var t=bossControl.worldInfoList[8].slice(),e=DataCenter.ins().DarkEquipBaConfig.bossDivide,i=Object.keys(DataCenter.ins().DarkEquipBaConfig.bossDivide).length,n=1;i>=n;n++){this.redpoints[n]=[];for(var o=0;o<t.length;o++){var s=t[o];e[n-1].indexOf(s.id)>-1&&(this.redpoints[n][s.id]=s.canInto&&!s.isDie&&bossControl.getBossRemindByIndex(s.id)?1:0)}}},e}(BaseSystem);__reflect(DarkHallBossRedPoint.prototype,"DarkHallBossRedPoint");var DevildomRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint1s=[],e.addCustomEventMany(e.dispatchNRedPoint,332,334),e.addCustomEventMany(e.dispatchRedPoint,515,516),e.addCustomEventMany(e.dispatchBigRedPoint,512,697,513),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchNRedPoint=function(){var t=this.redPoint1;this.redPoint1=!1;var e=DevildomControl.ins();if(!e.isOpen())return void(t!=this.redPoint1&&EventMgr.ins().dispatch(515,!0));for(var i in e.killedState)this.redPoint1s[i]=!(e.killedState[i]||e.historyId&&e.historyId!=+i);this.redPoint1=this.redPoint1s.indexOf(!0)>-1,t!=this.redPoint1&&EventMgr.ins().dispatch(515,!0)},e.prototype.dispatchRedPoint=function(){this.redPoint=this.redPoint1||this.redPoint2,EventMgr.ins().dispatch(517,this.redPoint?0:1)},e.prototype.dispatchBigRedPoint=function(){var t=this.redPoint2;this.redPoint2=!1;var e=DevildomControl.ins();if(!e.isOpen())return void(t!=this.redPoint2&&EventMgr.ins().dispatch(516,!0));var i=DevildomFinalControl.ins();i.isOpen()&&!ServerStorage.ins().getValue(21)?this.redPoint2=!0:this.redPoint2=i.isReadyOpen()&&!i.isOver&&-1!=i.myGuildRank,t!=this.redPoint2&&EventMgr.ins().dispatch(516,!0)},e}(BaseSystem);__reflect(DevildomRedPoint.prototype,"DevildomRedPoint");var SevenDayItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="SevenDayItemRenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().SevenDayConfig[t],i=(amusementControl.dayNum,1==(amusementControl.isAwards>>e.day&1));i?(this.select.visible=!1,this.checkedMask.visible=this.checked.visible=!0):this.checkedMask.visible=this.checked.visible=!1,this.item.data=e.rewards[0]},e.prototype.setSelectImg=function(t){this.select.visible=t},e}(BaseItemRender);__reflect(SevenDayItemRender.prototype,"SevenDayItemRender");var CrossFieldRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=0,e.redPoint1=0,e.redPoint2=0,e.redPoint3=0,e.redPoint4=0,e.redPoint5=0,e.redPoint6=0,e.addCustomEventMany(e.dispatchRedPoint,551,552,553,554,555,556),e.addCustomEventMany(e.dispatchRedPoint1,517),e.addCustomEventMany(e.dispatchRedPoint2,546),e.addCustomEventMany(e.dispatchRedPoint3,547),e.addCustomEventMany(e.dispatchRedPoint4,543),e.addCustomEventMany(e.dispatchRedPoint5,548),e.addCustomEventMany(e.dispatchRedPoint6,698),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){this.redPoint=this.redPoint1+this.redPoint2+this.redPoint3+this.redPoint4+this.redPoint5+this.redPoint6,EventMgr.ins().dispatch(550,this.redPoint)},e.prototype.dispatchRedPoint1=function(){this.redPoint1=DevildomRedPoint.ins().redPoint?1:0,EventMgr.ins().dispatch(551,this.redPoint1)},e.prototype.dispatchRedPoint2=function(){this.redPoint2=CrossBossRedpoint.ins().redpoint,EventMgr.ins().dispatch(552,this.redPoint2)},e.prototype.dispatchRedPoint3=function(){this.redPoint3=DarkHallBossRedPoint.ins().redpoint,EventMgr.ins().dispatch(553,this.redPoint3)},e.prototype.dispatchRedPoint4=function(){this.redPoint4=CrossArenaRedPoint.ins().redpoint,EventMgr.ins().dispatch(554,this.redPoint4)},e.prototype.dispatchRedPoint5=function(){this.redPoint5=DominateBossRedpoint.ins().redpoint,EventMgr.ins().dispatch(555,this.redPoint5)},e.prototype.dispatchRedPoint6=function(){this.redPoint6=WarriorModel.ins().bossRedPoint,EventMgr.ins().dispatch(556,this.redPoint6)},e}(BaseSystem);__reflect(CrossFieldRedPoint.prototype,"CrossFieldRedPoint");var HatredRedpoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=!1,e.addCustomEventMany(e.dispatchRedPoint,518,520,519,461,112,4),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redpoint;if(this.redpoint=!1,!hatredControl.isOpen())return!0;for(var e,i=DataCenter.ins().ServerEenemyBaseConfig.enemyAwardCount-hatredControl.revengeNum>0,n=0,o=0;o<hatredControl.enemyListDt.length;o++){var s=hatredControl.enemyListDt.getItemAt(o);s.avenge&&!e?e=!0:hatredControl.getSeting(s.actorId)&&n++}return i&&(n>0||e)&&(this.redpoint=!0),t!=this.redpoint},e}(BaseSystem);__reflect(HatredRedpoint.prototype,"HatredRedpoint");var PeakedRedpoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint1=0,e.redpoint2=0,e.redpoint3=0,e.redpoint=0,e.addCustomEventMany(e.dispatchRedPoint,338,337,347,344,112),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){return this.redpoint1=0,this.redpoint2=0,this.redpoint3=0,this.redpoint=0,peakedControl.isOpen()?reincarnateControl.lv<DataCenter.ins().PeakRaceBaseConfig.needZsLv?void EventMgr.ins().dispatch(558,this.redpoint):(1==peakedControl.bfStatus&&0==peakedControl.isSignUp&&peakedControl.canSignUp()&&(this.redpoint1=1),peakedControl.isCross()&&PeakedHelp.canSupport()?(peakedControl.kfStatus>1||1==peakedControl.kfStatus&&peakedControl.kfStatusIsEnd)&&(this.redpoint2=DataCenter.ins().PeakRaceBaseConfig.likeCount-peakedControl.kideNum):(peakedControl.bfStatus>2||2==peakedControl.bfStatus&&peakedControl.bfStatusIsEnd)&&peakedControl.bfStatus<7&&PeakedHelp.canSupport()&&(this.redpoint2=DataCenter.ins().PeakRaceBaseConfig.likeCount-peakedControl.kideNum),this.redpoint3=peakedControl.worshipNum<DataCenter.ins().PeakRaceBaseConfig.mobaiNum&&peakedControl.kfPlayer2Data&&peakedControl.kfPlayer2Data.winId&&peakedControl.kfStatus>=1&&peakedControl.kfStatusIsEnd?1:0,this.redpoint=this.redpoint1+this.redpoint2+this.redpoint3,void EventMgr.ins().dispatch(558,this.redpoint)):void EventMgr.ins().dispatch(558,this.redpoint)},e}(BaseSystem);__reflect(PeakedRedpoint.prototype,"PeakedRedpoint");var TotemBossRedpoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=0,e.redpoints=[],e.redpointTab=[],e.addCustomEventMany(e.dispatchRedPoint,349,350,351,112,461,167),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){if(this.redpoint=0,this.redpoints=[],this.redpointTab=[],!totemBossControl.isOpen())return void EventMgr.ins().dispatch(557,!0);for(var t in DataCenter.ins().TotemBossFbConfig){for(var e=DataCenter.ins().TotemBossFbConfig[t],i=!1,n=e.bossIdList,o=0;o<n.length;o++){var s=n[o],r=DataCenter.ins().TotemBossConfig[s];totemBossControl.canKill(s)&&totemBossControl.lefttime>0&&totemBossControl.getBossRemind(s)&&TotemBossControl.hasBelong(r.belongTotemCondition)&&(this.redpoints[s]=!0,this.redpoint=1,i=!0)}this.redpointTab[e.id]=i}EventMgr.ins().dispatch(557,!0)},e}(BaseSystem);__reflect(TotemBossRedpoint.prototype,"TotemBossRedpoint");var DarkEquipRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.redPoint00=!1,e.redPoint0=!1,e.redPoint1=!1,e.redPoint2=!1,e.addCustomEventMany(e.dispatchDarkEquipRedPoint,563,564,565,566),e.addCustomEventMany(e.dispatchDarkEquipRedPoint00,231,267,266,268),e.addCustomEventMany(e.dispatchDarkEquipRedPoint0,267,266,268,232),e.addCustomEventMany(e.dispatchDarkEquipRedPoint1,231,267,266,268),e.addCustomEventMany(e.dispatchDarkEquipRedPoint2,230,267,266,268),e}return __extends(e,t),e.prototype.dispatchDarkEquipRedPoint=function(){var t=this.redPoint;this.redPoint=this.redPoint00||this.redPoint0||this.redPoint1||this.redPoint2,EventMgr.ins().dispatch(562,this.redPoint!=t)},e.prototype.dispatchDarkEquipRedPoint00=function(){var t=this.redPoint00;this.IsNotRedPoint()?this.redPoint00=!1:this.redPoint00=darkEquipControl.getRedPoint00(),EventMgr.ins().dispatch(563,this.redPoint00!=t)},e.prototype.dispatchDarkEquipRedPoint0=function(){var t=this.redPoint0;this.IsNotRedPoint()?this.redPoint0=!1:this.redPoint0=darkEquipControl.getRedPoint0(),EventMgr.ins().dispatch(564,this.redPoint0!=t)},e.prototype.dispatchDarkEquipRedPoint1=function(){var t=this.redPoint1;this.IsNotRedPoint()?this.redPoint1=!1:this.redPoint1=darkEquipControl.getRedPoint1(),EventMgr.ins().dispatch(565,this.redPoint1!=t)},e.prototype.dispatchDarkEquipRedPoint2=function(){var t=this.redPoint2;this.IsNotRedPoint()?this.redPoint2=!1:this.redPoint2=darkEquipControl.getRedPoint2(),EventMgr.ins().dispatch(566,this.redPoint2!=t)},e.prototype.IsNotRedPoint=function(){return darkEquipControl.checkSysOpen()&&darkEquipControl.darkEquips.length?!1:!0},e}(BaseSystem);__reflect(DarkEquipRedPoint.prototype,"DarkEquipRedPoint");var DevourEquipContorl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.newts=!1,e.suitInfos={},e.devourEquips={},e.selectPos=0,e.devourEquipSouls=[],e.selectRole=0,e.needUpdateSuit={0:!0,1:!0,2:!0},e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"positions",{get:function(){return[0,2,1,3,7,6,5,4]},enumerable:!0,configurable:!0}),e.prototype.chanqipositions=function(t){var e=[12,1,11,2,3,4,5,6];return e[t]},e.prototype.downDevourEquips=function(t,e){for(var i=0;t.length>i;i++){var n=t[i][0];this.devourEquips[n]=this.devourEquips[n]||{};for(var o=t[i][1],s=0;o.length>s;s++){var r=o[s][0],a=this.devourEquips[n][r]||new DevourEquipInfoVo;a.pos=r,a.setInfo(o[s][1],o[s][2],o[s][3]),this.devourEquips[n][r]=a}}TimerMgr.ins().remove(this.postSoulRP,this);var l=e.length;this.devourEquipSouls.length=l;for(var i=0;l>i;i++)this.devourEquipSouls[i]=this.devourEquipSouls[i]||new DevourEquipSoulInfoVo,this.devourEquipSouls[i].setInfo(e[i]),this.devourEquipSouls[i].time>0&&TimerMgr.ins().doTimer(DateUtils.formatMiniDateTime(this.devourEquipSouls[i].time)-GameServer.serverTime,1,this.postSoulRP,this);if(this.devourEquipSouls[0]&&0!=this.devourEquipSouls[0].time){var h=this.devourEquipSouls[0].time>0?this.devourEquipSouls[0].time:0,u=DateUtils.formatMiniDateTime(h)-GameServer.serverTime;1e3>u&&!UIMgr.ins().getView(DevourEquipView)&&UIMgr.ins().open(DevourFinishView,this.devourEquipSouls[0].pos,this.devourEquipSouls[0].bossid)}this.needUpdateSuit={0:!0,1:!0,2:!0},EventMgr.ins().dispatch(712)},e.prototype.downSingleEquip=function(t,e,i,n,o){this.devourEquips[t]=this.devourEquips[t]||{};var s=this.devourEquips[t][e]||new DevourEquipInfoVo,r=s.lv,a=s.stone;s.setInfo(i,n,o),s.pos=e,this.devourEquips[t][e]=s,s.maxsoule||(s.maxsoule=DataCenter.ins().DevourEquipLevelConfig[e][s.lv].soulMax);var l=DataCenter.ins().DevourEquipDataConfig.equipIconInfo[e],h=(DataCenter.ins().DevourEquipDataConfig.leevel[s.lv],DataCenter.ins().DevourEquipLevelConfig[e][s.lv]);r!=s.lv&&CommonFun.show(1==s.lv?0:1,""+l[0],null,h.devourRes,null,null,0,-150),a!=s.stone&&tipsControl.showCenterTips(LangMgr.getValueByKey("tunshijubianOK",s.stone)),this.needUpdateSuit[t]=!0,EventMgr.ins().dispatch(713,[t,e])},e.prototype.downDevourBossInfo=function(t){TimerMgr.ins().remove(this.postSoulRP,this);var e=t.length,i=0,n=this.devourEquipSouls.length;this.devourEquipSouls.length=e;for(var o=0;e>o;o++)this.devourEquipSouls[o]=this.devourEquipSouls[o]||new DevourEquipSoulInfoVo,this.devourEquipSouls[o].setInfo(t[o]),this.devourEquipSouls[o].time>0&&TimerMgr.ins().doTimer(DateUtils.formatMiniDateTime(this.devourEquipSouls[o].time)-GameServer.serverTime,1,this.postSoulRP,this);if(e>n?this.newts=!0:n>e&&(i=1),this.devourEquipSouls[0]&&0!=this.devourEquipSouls[0].time){var s=this.devourEquipSouls[0].time>0?this.devourEquipSouls[0].time:0,r=DateUtils.formatMiniDateTime(s)-GameServer.serverTime;1e3>r&&!UIMgr.ins().getView(DevourEquipView)&&UIMgr.ins().open(DevourFinishView,this.devourEquipSouls[0].pos,this.devourEquipSouls[0].bossid)}EventMgr.ins().dispatch(714,i)},e.prototype.downDevourBossTips=function(t,e,i,n,o){UIMgr.ins().getView(DevourSkillNoticeView)||UIMgr.ins().open(DevourSkillNoticeView,t,e,i,n,o)},e.prototype.postSoulRP=function(){EventMgr.ins().dispatch(715)},e.prototype.upUpgrade=function(t,e){return[t,e]},e.prototype.upSoulValue=function(t){return[t]},e.prototype.upWearSuit=function(t,e,i){return[t,e,i]},e.prototype.upStone=function(t,e){return[t,e]},e.prototype.checkOpen=function(){return reincarnateControl.lv<DataCenter.ins().DevourEquipDataConfig.openSysZSLevel||GameServer.serverOpenDay<DataCenter.ins().DevourEquipDataConfig.oepnSysDay-1?!1:!0},e.prototype.sendToUpgrade=function(t,e){var n=i.ins().getRoleDevourInfo(t,e),o=n.lv+1;this.canActPos(t,e,o)&&this.upUpgrade(t,e)},e.prototype.canActPos=function(t,e,i){var n=heroControl.getSubRoleByIndex(t),o=DataCenter.ins().DevourEquipLevelConfig[e][i],s=o.cond;for(var r in s){var a=s[r];switch(parseInt(r)){case DevourEquipPosType.chuanqi:var l=reincarnateStarEquipControl.getZhuHunlvByPos(t,a.pos);if(!l)return tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactNeed1")),!1;if(l<a.lv)return tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactNeedlv1",a.lv)),!1;break;case DevourEquipPosType.zhizun:var h=uitrasoneEquipControl.getZhiZunLvByRoleID(n,a.pos);if(!h)return tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactNeed2")),!1;if(h<a.lv)return tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactNeedlv2",a.lv)),!1;break;case DevourEquipPosType.leiting:var u=n.thunderSuitVos[a.pos];if(!u)return tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactNeed3")),!1;if(u.level<a.lv)return tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactNeedlv3",a.lv)),!1}}var p=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_EQUIP,o.ItemId);return p||(p=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,o.ItemId)),p<o.value?(tipsControl.showCenterTips(LangMgr.getValueByKey("tunshiactTipnoprop")),!1):!0},e.prototype.canActPosNotips=function(t,e,i){var n=heroControl.getSubRoleByIndex(t),o=DataCenter.ins().DevourEquipLevelConfig[e][i];if(!o)return!1;var s=o.cond;for(var r in s){var a=s[r];switch(parseInt(r)){case DevourEquipPosType.chuanqi:var l=reincarnateStarEquipControl.getZhuHunlvByPos(t,a.pos);if(!l||l<a.lv)return!1;break;case DevourEquipPosType.zhizun:var h=uitrasoneEquipControl.getZhiZunLvByRoleID(n,a.pos);if(!h||h<a.lv)return!1;break;case DevourEquipPosType.leiting:var u=n.thunderSuitVos[a.pos];if(!u||u.level<a.lv)return!1}}var p=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_EQUIP,o.ItemId);return p||(p=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,o.ItemId)),p<o.value?!1:!0},e.prototype.getEquipLV=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);switch(i){case DevourEquipPosType.chuanqi:var o=reincarnateStarEquipControl.getZhuHunlvByPos(t,this.chanqipositions(e));return o;case DevourEquipPosType.zhizun:var s=uitrasoneEquipControl.getZhiZunLvByRoleID(n,e);return s;case DevourEquipPosType.leiting:var r=n.thunderSuitVos[e];if(r&&r.level)return r.level}return 0},e.prototype.getDevourAllRole=function(){var t=new DevourEquipItemDataVo;t.items=this.devourEquips;var e=[0,0];t.thirteenequips=[];for(var i=heroControl.roles,n=0;n<i.length;n++){e[0]+=i[n].getExAtt(64),e[0]+=i[n].getExAtt(21),e[1]+=i[n].getExAtt(22),e[1]+=i[n].getExAtt(65);var o=new ReincarnateStarEquipVo;o.zhuHuns=[];for(var s=1;13>=s;s++){var r=reincarnateStarEquipControl.getZhuHunlvByPos(n,s);o.zhuHuns[s]=r?r:0}t.thirteenequips[n]=o}return t.roledata=e,t},e.prototype.getRoleDevourAllInfo=function(t){return this.devourEquips[t]?this.devourEquips[t]:(this.devourEquips[t]={},this.devourEquips[t])},e.prototype.getRoleDevourInfo=function(t,e){var i=this.getRoleDevourAllInfo(t);return i[e]||(i[e]=new DevourEquipInfoVo,i[e].pos=e),i[e]},e.prototype.getNextConfig=function(t,e){return e+=1,DataCenter.ins().DevourEquipLevelConfig[t][e]?DataCenter.ins().DevourEquipLevelConfig[t][e]:null},e.prototype.getSoulConfig=function(t,e){for(var i=DataCenter.ins().DevourEquipDataConfig.keyPos[t],n=1,o=0;o<i.length;o++){var s=i[o];if(s>e)break;n=s}return DataCenter.ins().DevourSoulAttrConfig[t][n]},e.prototype.getSoulValue=function(t,e,i){var n=this.getSoulConfig(t,e),o=n.attr[i],s=(e*n.prop[0]+n.prop[1])*o.value;return Math.floor(s)},e.prototype.getSuitData=function(t){if(!this.needUpdateSuit[t.index])return this.suitInfos[t.index];var e=this.getSuitDataByData(t,this.devourEquips[t.index]);return this.suitInfos[t.index]=e,this.needUpdateSuit[t.index]=!1,e},e.prototype.getSuitDataByData=function(t,e){var i=[],n=DataCenter.ins().DevourSoulSuitConfig;if(!n)return null;var o=[],s=[];for(var r in n)if(o.push(+r),!s.length)for(var a in n[r])s.push(+a);s.sort(this.sortDesc),o.sort(this.sortDesc);for(var l=[],h=0;8>h;h++){var u=e[h];l.push(u?u.lv:0)}for(var p={},h=0;h<s.length;h++){var c=s[h];p[c]=0;for(var d=0;d<l.length;d++)l[d]>=c&&p[c]++}for(var h=0;h<o.length;h++){for(var g=o[h],a=0;a<s.length;a++){var c=s[a];if(p[c]>=g){i.push({lv:n[g][c].level,count:n[g][c].count});break}}if(i.length>=o.length)break}return i},e.prototype.sortDesc=function(t,e){return t>e?-1:e>t?1:0},e.prototype.getSuitLv=function(t,e){if(!this.checkOpen())return 0;if(!this.devourEquips[t.index])return 0;var i=this.getSuitData(t);if(!i)return 0;for(var n=0;n<i.length;n++)if(i[n].count==e)return i[n].lv;return 0},e.prototype.getSuitSkills=function(t){var e=this.getSuitLv(t,6);if(!e)return null;var i=DataCenter.ins().DevourSoulSuitConfig[6][e],n=new SkillVo(i.effect);return[n]},e.prototype.getRoleBase=function(){for(var t=[0,0],e=heroControl.roles,i=0;i<e.length;i++)t[0]+=e[i].getExAtt(64),t[0]+=e[i].getExAtt(21),t[1]+=e[i].getExAtt(22),t[1]+=e[i].getExAtt(65);return t},e.prototype.suitEffSkillData1=function(t,e){var i=e[0]+6e4,n=e[1]+3e4,o=[],s=DataCenter.ins().DevourSoulSuitConfig[8][t];for(var r in s.exattr){var a=s.exattr[r];22==a.type||65==a.type?n+=a.value:(21==a.type||64==a.type)&&(i+=a.value)}return o=[n/100,i/100],o[0]=o[0].toFixed(),o[1]=o[1].toFixed(),o},e.prototype.calAttrPower=function(t,e,i,n){var o=DataCenter.ins().DevourEquipLevelConfig[i][n],s=o.specialAttr,r=[],a=[];for(var l in s){var h=s[l],u=0;switch(parseInt(l)){case DevourEquipPosType.leiting:if(!t.thunderSuitVos[h.pos])break;u=t.thunderSuitVos[h.pos].level;var p=DataCenter.ins().ThunderEquipLvConfig[h.pos][u];if(!p)break;r=p.attrs;break;case DevourEquipPosType.zhizun:if(!t||h.pos>7)return 0;var c=t.getEquipByIndex(h.pos),d=c.item.configID;if(d&&(u=c.soulLv),u){var g=DataCenter.ins().UitrasoneEquipLvConfig[h.pos][u];r=g.attrs}break;case DevourEquipPosType.chuanqi:if(e&&e.zhuHuns||(u=0),u=e&&e.zhuHuns[h.pos]?e.zhuHuns[h.pos]:0){var m=DataCenter.ins().ReincarnateStarStepSoLvConfig[h.pos][u];r=m.attrs}}r=AttributeData.getPercentAttr(r,h.prop/1e4,!1),a=AttributeData.AttrAddition(r,a)}r=[];for(var f=0;f<a.length;f++)if(a[f].type<10){var v=new AttributeData;v.type=a[f].type,v.value=a[f].value,r.push(v)}return Math.floor(BackpackControl.getAttrPower(r))},e.prototype.getRoleActNum=function(t){var e=0;for(var i in t)t[i]&&t[i].lv&&e++;return e},e.prototype.getCanDevour=function(){for(var t in this.devourEquipSouls){var e=this.devourEquipSouls[t];if(this.canDevour(e))return!0}return!1},e.prototype.canDevour=function(t){return t.time>0?DateUtils.formatMiniDateTime(t.time)-GameServer.serverTime<=0:t.time<=0},e.prototype.calSoulTime=function(t){if(0>=t)return 0;var e=DateUtils.formatMiniDateTime(t)-GameServer.serverTime;return 0>=e?0:Math.ceil(e/1e3/60)},e.prototype.setNewTs=function(t){this.newts=t,this.postSoulRP()},e.prototype.checkAllRoleDevourEquip=function(t){for(var e in t)if(t[e]&&t[e].lv)return!0;return!1},e.prototype.getDevourEquipAttrs=function(t){var e=[],i=this.devourEquips[t];if(!i)return e;for(var n in i)if(i[n]){var o=DataCenter.ins().DevourEquipLevelConfig[i[n].pos][i[n].lv];o&&(e=AttributeData.AttrAddition(e,o.attr))}return e},e.prototype.getDevourEquipMax=function(t){var e=this.devourEquips[t];if(!e)return!1;for(var i in e)if(e[i].lv&&e[i].soul<e[i].maxsoule)return!1;return!0},e.prototype.getAllDevourEquipMax=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(!this.getDevourEquipMax(e))return!1;return!0},e.prototype.canSendStone=function(t){return t.lv&&DataCenter.ins().DevourEquipDataConfig.stoneAttr[t.stone]&&BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().DevourEquipDataConfig.stoneId)},e.prototype.checkAllRoleAllDevourEquip=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++){var i=this.getRoleDevourAllInfo(e);if(this.checkAllRoleDevourEquip(i))return!1}return!0},__decorate([down(36,[[1,[2,3,3,2]],[3,1,2,3]])],e.prototype,"downDevourEquips",null),__decorate([down(37,[1,2,3,3,2])],e.prototype,"downSingleEquip",null),__decorate([down(38,[[3,1,2,3]])],e.prototype,"downDevourBossInfo",null),__decorate([down(39,[3,8,2,3,3])],e.prototype,"downDevourBossTips",null),__decorate([up(38,[1,2])],e.prototype,"upUpgrade",null),__decorate([up(40,[1])],e.prototype,"upSoulValue",null),__decorate([up(41,[1,1,2])],e.prototype,"upWearSuit",null),__decorate([up(42,[1,2])],e.prototype,"upStone",null),e=i=__decorate([protocolsId(4)],e);var i}(BaseSystem);__reflect(DevourEquipContorl.prototype,"DevourEquipContorl");var DevourEquipRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.equipPoint=!1,e.soulPoint=!1,e.roleTabPoint=[!1,!1,!1],e.addCustomEventMany(e.postDevourRedPoint,716,717),e.addCustomEventMany(e.postDevourLevelRedPoint,267,713,712,122,114,97),e.addCustomEventMany(e.postDevourSoulRedPoint,712,714,715),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.postDevourRedPoint=function(){var t=this.redPoint;this.redPoint=this.equipPoint||this.soulPoint,t!=this.redPoint&&EventMgr.ins().dispatch(718)},e.prototype.postDevourLevelRedPoint=function(){var t=this.equipPoint;this.roleTabPoint=[!1,!1,!1];for(var e=heroControl.subRolesLen,i=0;e>i;i++){var n=this.getRedPoint0(i);n&&(this.roleTabPoint[i]=n)}this.equipPoint=this.roleTabPoint.indexOf(!0)>-1,t!=this.equipPoint&&EventMgr.ins().dispatch(716)},e.prototype.postDevourSoulRedPoint=function(){var t=this.soulPoint;this.soulPoint=this.getRedPoint1(),t!=this.soulPoint&&EventMgr.ins().dispatch(717)},e.prototype.getRedPoint0=function(t){if(!DevourEquipContorl.ins().checkOpen())return!1;for(var e=0;e<heroControl.subRolesLen;e++)if(isNaN(t)||t==e)for(var i=0;i<DevourEquipContorl.ins().positions.length;i++){var n=DevourEquipContorl.ins().getRoleDevourInfo(e,i),o=DevourEquipContorl.ins().canActPosNotips(e,i,n.lv+1)||DevourEquipContorl.ins().canSendStone(n);if(o)return!0}return!1},e.prototype.getRedPoint1=function(){return DevourEquipContorl.ins().getCanDevour()},e}(BaseSystem);__reflect(DevourEquipRedPoint.prototype,"DevourEquipRedPoint");var GameSystem;!function(t){t.devourEquipRedPoint=DevourEquipRedPoint.ins.bind(DevourEquipRedPoint)}(GameSystem||(GameSystem={}));var DominateEquipRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.redPoint1=!1,e.redPoint2=!1,e.roleTab=[],e.addCustomEventMany(e.dispatchMEquipRedPoint,267,266,268,549),e.addCustomEventMany(e.dispatchTrinketRedPoint,571),e.addCustomEventMany(e.dispatchRedPoint,616,615),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchTrinketRedPoint=function(){this.redPoint2=!!DominateRedpoint.ins().redpoint;for(var t=0;t<this.roleTab.length;t++)this.roleTab[t]||(this.roleTab[t]=DominateRedpoint.ins().redpoints[t]&&DominateRedpoint.ins().redpoints[t].indexOf(1)>-1);EventMgr.ins().dispatch(616)},e.prototype.dispatchMEquipRedPoint=function(){var t=this.redPoint,e=heroControl.subRolesLen;if(!dominateEquipControl.checkOpen()){this.redPoint1=!1;for(var i=0;e>i;i++)this.roleTab[i]=!1;return!1}this.redPoint1=!1;for(var i=0;e>i;i++){var n=dominateEquipControl.checkRedByRoleIndex(i);this.roleTab[i]=n,n&&(this.redPoint1=!0)}t!=this.redPoint&&EventMgr.ins().dispatch(615,!0)},e.prototype.dispatchRedPoint=function(){this.redPoint=this.redPoint1||this.redPoint2,EventMgr.ins().dispatch(614)},e}(BaseSystem);__reflect(DominateEquipRedPoint.prototype,"DominateEquipRedPoint");var DominateRedpoint=function(t){function e(){var e=t.call(this)||this;return e.redpoint=0,e.redpoints=[],e.redpoints_1=[],e.redpoints_2=[],e.addCustomEventMany(e.dispatchRedpoint,292,291,290,266,269,268,352),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedpoint=function(){this.redpoints=[],this.redpoint=0;for(var t=heroControl.roles,e=0;e<t.length;e++){var i=t[e];this.redpoints[i.index]=[],this.redpoints_1[i.index]=[],this.redpoints_2[i.index]=[]}if(dominateControl.isOpen()){for(var n=heroControl.roles,e=0;e<n.length;e++){var i=n[e];this.redpoints[i.index]=[],this.redpoints_1[i.index]=[],this.redpoints_2[i.index]=[];var o=dominateControl.trinketDatas[i.index];if(o){for(var s in o.levels)if(s){var r=DataCenter.ins().DominateEquipMastComConfig[s],a=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,r.compose[0].id),l=DominateControl.getEquipListInBag(r.compose[1]),h=DominateControl.getEquipListInBag(r.compose[2]);
if(a>=r.compose[0].count&&l.length>0&&h.length>0&&(this.redpoints_1[i.index][s]=1,this.redpoint=1),o.levels[s]){var u=DataCenter.ins().DominateEquipMastLvConfig[s][o.levels[s]+1];if(u){for(var p=!0,c=u.mat,d=0;d<c.length;d++){var g=c[d],m=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,g.id);m<g.count&&(p=!1)}p&&(this.redpoints_2[i.index][s]=1,this.redpoint=1)}}this.redpoints[i.index][s]=this.redpoints_1[i.index][s]||this.redpoints_2[i.index][s]?1:0}}else for(var d=1;4>=d;d++){var r=DataCenter.ins().DominateEquipMastComConfig[d],a=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,r.compose[0].id),l=DominateControl.getEquipListInBag(r.compose[1]),h=DominateControl.getEquipListInBag(r.compose[2]);a>=r.compose[0].count&&l.length>0&&h.length>0&&(this.redpoints_1[i.index][d]=1,this.redpoint=1),DominateControl.checkHasInBag(d)&&(this.redpoints_2[i.index][d]=1,this.redpoint=1),this.redpoints[i.index][d]=this.redpoints_1[i.index][d]||this.redpoints_2[i.index][d]?1:0}}EventMgr.ins().dispatch(571,this.redpoint)}},e}(BaseSystem);__reflect(DominateRedpoint.prototype,"DominateRedpoint");var TargetMemberHeadItemRender=function(t){function e(){var e=t.call(this)||this;return e.addEventTouchTap(e,e.onTap),e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.removeAttEffect()},e.prototype.onTap=function(t){if(!isNaN(this.data)){if(this.showEffect(),ClientStorage.ins().setValue("mapClickTx",0),ClientStorage.ins().setValue("mapClickTy",0),crossArenaControl.isKFArena){if(!crossArenaControl.checkFBOperat(crossArenaControl.flagHandle==parseInt(this.data)))return;var e=UnitMgr.ins().getNoDieRole();if(e&&e.isSafety()){var i=DataCenter.ins().CrossArenaBaseConfig.readyPos[crossArenaControl.readyIndex-1].tranferPoint;return MapControl.moveTo((i.x+.5)*MapControl.CELL_SIZE>>0,i.y*MapControl.CELL_SIZE>>0),void EntrustMgr.ins().regEntrusTask(0,this.touchDo,this)}}this.touchDo()}},e.prototype.touchDo=function(){var t=UnitMgr.ins().getNoDieRole();if(t){if(t.hasFilter(1))return void tipsControl.showTips(LangMgr.getValueByKey("paralysisnotoperate"));if(crossBossControl.flagHandle==parseInt(this.data))crossBossControl.flagCD-egret.getTimer()>0?tipsControl.showTips("|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("qizhinotref")+"|"):crossBossControl.upCollectFlag();else if(crossArenaControl.flagHandle==parseInt(this.data)){if(crossArenaControl.flagCD-egret.getTimer()>0)return void tipsControl.showTips("|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("tianshunotref")+"|");crossArenaControl.upCollectFlag()}else gameControl.dispatchChangeAttrPoint(this.data)}},e}(WorldBossHeadItemRender);__reflect(TargetMemberHeadItemRender.prototype,"TargetMemberHeadItemRender");var GodWeaponRedPoint=function(t){function e(){var e=t.call(this)||this;return e.gwTaskRed=!1,e.gwTaskRed1=!1,e.gwTaskRed2=!1,e.gwTaskRed3=!1,e.godWeaponRed=!1,e.gwDunRed=!1,e.gwRed=!1,e.gwRed1=!1,e.gwRed2=!1,e.gwRed3=!1,e.gwBossRp=!1,e.gwItem=!1,e.addCustomEventMany(e.dispatchGodWeapon,602,607,606,608),e.addCustomEventMany(e.dispatchGwAllTab,603,604,605),e.addCustomEventMany(e.dispatchGwTask,52,49,352),e.addCustomEventMany(e.dispatchGwDun,50),e.addCustomEventMany(e.dispatchGwTab1,609,49,48),e.addCustomEventMany(e.dispatchGwTab2,609,49,48),e.addCustomEventMany(e.dispatchGwTab3,609,49,48),e.addCustomEventMany(e.dispatchgGwBossRp,296,49,307,699,457,268,266),e.addCustomEventMany(e.dispatchGodWeaponItem,266,268,269),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchGodWeaponItem=function(){var t=this.gwItem;this.gwItem=godWeaponControl.godWeaponIsOpen()&&(godWeaponItemControl.isCanCompound()||godWeaponItemControl.isCanFuse()),EventMgr.ins().dispatch(608,t!=this.gwItem)},e.prototype.dispatchGodWeapon=function(){var t=this.godWeaponRed;this.godWeaponRed=this.gwRed||this.gwDunRed||this.gwItem||this.gwBossRp,EventMgr.ins().dispatch(601,t!=this.godWeaponRed)},e.prototype.dispatchGwAllTab=function(){var t=this.gwRed;this.gwRed=this.gwRed1||this.gwRed2||this.gwRed3,EventMgr.ins().dispatch(602,t!=this.gwRed)},e.prototype.dispatchGwTab1=function(){var t=this.gwRed1;this.gwTaskRed1?this.gwRed1=!0:godWeaponControl.getWeaponData(1)?this.gwRed1=godWeaponControl.weaponIsActive(1)&&godWeaponControl.maxLvRedPoint()||godWeaponControl.getWeaponData(1).hasRedPoint||godWeaponControl.getRelicRedPoint(1):this.gwRed1=!1,EventMgr.ins().dispatch(603,t!=this.gwRed1)},e.prototype.dispatchGwTab2=function(){var t=this.gwRed2;this.gwTaskRed2?this.gwRed2=!0:godWeaponControl.getWeaponData(2)?this.gwRed2=godWeaponControl.weaponIsActive(2)&&godWeaponControl.maxLvRedPoint()||godWeaponControl.getWeaponData(2).hasRedPoint||godWeaponControl.getRelicRedPoint(2):this.gwRed2=!1,EventMgr.ins().dispatch(604,t!=this.gwRed2)},e.prototype.dispatchGwTab3=function(){var t=this.gwRed3;this.gwTaskRed3?this.gwRed3=!0:godWeaponControl.getWeaponData(3)?this.gwRed3=godWeaponControl.weaponIsActive(3)&&godWeaponControl.maxLvRedPoint()||godWeaponControl.getWeaponData(3).hasRedPoint||godWeaponControl.getRelicRedPoint(3):this.gwRed3=!1,EventMgr.ins().dispatch(605,t!=this.gwRed3)},e.prototype.dispatchGwDun=function(){var t=this.gwDunRed;this.gwDunRed=godWeaponControl.dunHadRedPoint(),EventMgr.ins().dispatch(607,t!=this.gwDunRed)},e.prototype.dispatchGwTask=function(){this.gwTaskRed;if(this.gwTaskRed=!1,godWeaponControl.taskIsOpen()){var t=godWeaponControl.gwTask;if(t.statue==GodWeaponTaskVo.DONE||t.statue==GodWeaponTaskVo.FINISH?this.gwTaskRed=!0:0==t.taskIdx&&heroControl.subRolesLen>godWeaponControl.weaponDataAry.length&&(this.gwTaskRed=!0),this.gwTaskRed)for(var e=1;3>=e;e++)godWeaponControl.getWeaponData(e)?this["gwTaskRed"+e]=!1:heroControl.getSubRoleByJob(e)&&0==t.taskIdx||t.weapon==e?this["gwTaskRed"+e]=!0:this["gwTaskRed"+e]=!1;else this.gwTaskRed1=!1,this.gwTaskRed2=!1,this.gwTaskRed3=!1}EventMgr.ins().dispatch(609,!0)},e.prototype.dispatchgGwBossRp=function(){var t=this.gwBossRp;this.gwBossRp=godWeaponControl.godWeaponIsOpen()&&(bossControl.checkWorldBossRedPoint(5)||bossControl.checkWorldBossRedPoint(6)),EventMgr.ins().dispatch(606,t!=this.gwBossRp)},e}(BaseSystem);__reflect(GodWeaponRedPoint.prototype,"GodWeaponRedPoint");var GodWeaponDunShowItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEventTouchEnd(this,this.onClick)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data)if(this._thisdata=this.data,this.itemIcon.imgJob.visible=!1,0==this._thisdata.data.type){this.itemIcon.imgIcon.source=Currency.getCurrencyRes(this._thisdata.data.id);var e=1;switch(this._thisdata.data.id){case 2:e=5;break;case 1:e=0;break;case 4:e=2;break;case 10:e=2,this.itemIcon.imgIcon.source=Currency.getCurrencyRes(this._thisdata.data.id);break;case 13:e=2}var i=this._thisdata.data.count;if(void 0!=i&&i>1?this.setCount(i+""):this.setCount(""),this._thisdata.index<=this._thisdata.start)this.nameTxt.text=Currency.getCurrencyName(this._thisdata.data.id),this.itemIcon.imgBg.source="quality"+e,this.nameTxt.textColor=LangMgr.getColor("qualityColor"+e);else{this.nameTxt.text=LangMgr.getValueByKey("godPassLayer");var n=godWeaponControl.dunInfoData;this.getImg.visible=!1;for(var o=0;o<n.listData.length;o++)if(this._thisdata.floorNum==n.listData[o].gridNum){1==n.listData[o].curPoint&&(this.getImg.visible=!0);break}this._thisdata.floorNum<=10?(this.nameTxt.textColor=LangMgr.getColor("qualityColor3"),this.itemIcon.imgBg.source="quality3"):(this.nameTxt.textColor=ColorUtils.RED,this.itemIcon.imgBg.source="quality4")}}else{if(this.itemConfig=DataCenter.ins().ItemConfig[this._thisdata.data.id],!this.itemConfig)return;var e=ItemUtils.getQuality(this.itemConfig);this.nameTxt.textColor=LangMgr.getColor("qualityColor"+e),this.itemIcon.imgBg.source="quality"+e;var i=this._thisdata.data.count;if(i>1?this.setCount(i+""):this.setCount(""),this.itemIcon.imgIcon.source=this.itemConfig.icon+"_png",this._thisdata.index<=this._thisdata.start)this.nameTxt.text=this.itemConfig.name;else{this.nameTxt.text=LangMgr.getValueByKey("godPassLayer");var n=godWeaponControl.dunInfoData;this.getImg.visible=!1;for(var o=0;o<n.listData.length;o++)if(this._thisdata.floorNum==n.listData[o].gridNum){1==n.listData[o].curPoint&&(this.getImg.visible=!0);break}}}},e.prototype.setCount=function(t){if(t.length>4){var e=Math.floor(Number(t)/1e3);t=LangMgr.getValueByKey("shopWan",e/10)}this.count.text=t},e.prototype.onClick=function(){this.showDetail()},e.prototype.showDetail=function(){0!=this._thisdata.data.type&&UIMgr.ins().open(ItemTipsView,0,this.itemConfig.id,this._thisdata.data.count)},e}(BaseItemRender);__reflect(GodWeaponDunShowItemRenderer.prototype,"GodWeaponDunShowItemRenderer");var HeartMethodRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.roleTabs={},e.addCustomEventMany(e.dispatchHeartMethodRedPoint,575),e.addCustomEventMany(e.dispatchHeartRoleRedPoint,62,63,64,269,112,352),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchHeartMethodRedPoint=function(){var t=this.redPoint;if(!heartMethodControl.checkOpen())return this.redPoint=!1,void EventMgr.ins().dispatch(574,t!=this.redPoint);for(var e=0;e<heroControl.subRolesLen;e++)if(this.roleTabs[e])for(var i in this.roleTabs[e])if(this.roleTabs[e][i])return this.redPoint=!0,void EventMgr.ins().dispatch(574,this.redPoint);this.redPoint=!1,EventMgr.ins().dispatch(574,t!=this.redPoint)},e.prototype.dispatchHeartRoleRedPoint=function(){if(!heartMethodControl.checkOpen())return void EventMgr.ins().dispatch(575);for(var t=0;t<heroControl.subRolesLen;t++){this.roleTabs[t]||(this.roleTabs[t]={});var e=heartMethodControl.heartMethodInfo[t];e||(e={});for(var i in DataCenter.ins().HeartMethodConfig){var n=e[i];if(n)if(n.id){if(this.roleTabs[t][n.id]=!1,!heartMethodControl.heartOpenCondition(n.id))continue;var o=heartMethodControl.calcHeartCost(t,n.id);if(o){var s=backpackControl.getBagItemById(o.itemid),r=s?s.count:0;if(this.roleTabs[t][n.id]=r>=DataCenter.ins().HeartMethodStageConfig[n.id][n.stage].normalCostTip,this.roleTabs[t][n.id]){if(heartMethodControl.heartUpCondition(t,n.id))continue;this.roleTabs[t][n.id]=!1}}if(n.isUp&&!heartMethodControl.isHeartMax(t,n.id)){this.roleTabs[t][n.id]=!0;continue}var a=DataCenter.ins().HeartMethodConfig[n.id];t:for(var l=0;l<a.posList.length;l++){var h=heartMethodControl.getHeartSlotItemId(t,n.id,l+1);if(h)if(heartMethodControl.calcHeartSlotCost(h))this.roleTabs[t][n.id]=!0;else for(var u=0;u<n.slots.length;u++){var p=n.slots[u],c=heartMethodControl.calcHeartSlotChange(t,n.id,p);if(this.roleTabs[t][n.id]=c?!0:!1,c)break t}else{var d=heartMethodControl.getHeartSlotItemIdWear(t,n.id,l+1);if(this.roleTabs[t][n.id]=d?!0:!1,d)break}}if(this.roleTabs[t][n.id])continue}else this.roleTabs[t][n.id]=!0;else heartMethodControl.heartOpenCondition(DataCenter.ins().HeartMethodConfig[i].id)?this.roleTabs[t][DataCenter.ins().HeartMethodConfig[i].id]=!0:this.roleTabs[t][DataCenter.ins().HeartMethodConfig[i].id]=!1}}EventMgr.ins().dispatch(575)},e.prototype.checkHeartRedPoint=function(t,e){return this.roleTabs[t]||(this.roleTabs[t]={}),this.roleTabs[t][e]?!0:!1},e}(BaseSystem);__reflect(HeartMethodRedPoint.prototype,"HeartMethodRedPoint");var HeirloomRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.roleTab=[],e.dressRedpoints=[],e.addCustomEventMany(e.dispatchHeirloomRedPoint,269,268,65,69,352),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchHeirloomRedPoint=function(){if(this.redPoint=!1,reincarnateControl.lv<3){for(var t=0;t<heroControl.subRolesLen;t++)this.roleTab[t]=!1;return!1}for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t);this.roleTab[t]=!1;for(var i=0;7>=i;i++){var n=this.getInitInfoEx(e,i),o=void 0;o=n.lv?DataCenter.ins().HeirloomEquipConfig[n.slot][n.lv]:DataCenter.ins().HeirloomEquipFireConfig[i+1];var s=0,r=0;if(o){var a=o.expend;if(!a)continue;s=backpackControl.getBagGoodsCountById(0,a.id),r=a.count}if(s>=r){this.roleTab[t]=!0;break}var l=DataCenter.ins().HeirloomEquipItemConfig[o.slot],h=backpackControl.getBagItemById(l.item),u=heirloomControl.keepEquipForRole([h]);if(this.roleTab[t]=!!u.length,this.roleTab[t]||(this.roleTab[t]=heirloomControl.IsComposeItem(t,i)),this.roleTab[t])break}this.roleTab[t]&&(this.redPoint=this.roleTab[t])}this.checkDressAct(),this.redPoint||(this.redPoint=this.dressRedpoints.indexOf(!0)>-1),EventMgr.ins().dispatch(612)},e.prototype.getInitInfoEx=function(t,e){var i=t.heirloom.getInfoBySolt(e);return i},e.prototype.checkDressAct=function(){this.dressRedpoints=[];var t=heirloomControl.getDressDpList();if(heirloomControl.dressDatas)for(var e=0;e<t.length;e++)for(var i=t[e],n=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.itemid),o=0;o<heirloomControl.dressDatas.length;o++){var s=heirloomControl.dressDatas[o];n>0&&!s.isAct(i.id)&&(this.dressRedpoints[s.roleId]=!0)}},e}(BaseSystem);__reflect(HeirloomRedPoint.prototype,"HeirloomRedPoint");var CrazybtplayCopyRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=0,e.addCustomEventMany(e.dispatchRedPoint,159,466),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){this.redPoint=0,crazybtplayCopyControl.isOpen()&&(this.redPoint=crazybtplayCopyControl.belongTimes>0?1:0),EventMgr.ins().dispatch(630,this.redPoint)},e}(BaseSystem);__reflect(CrazybtplayCopyRedPoint.prototype,"CrazybtplayCopyRedPoint");var CrazybtplayRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.UpLvRedPoint=!1,e.StrengthenRedPoint=!1,e.addCustomEventMany(e.dispatchShenWuRedPoint,611,157),e.addCustomEventMany(e.dispatchShenWuUpLvRedPoint,154,153,267,268,266),e.addCustomEventMany(e.dispatchShenWuStrengthenRedPoint,156,610),e.addCustomEventMany(e.dispatchShenWuRedPoint,611,157,466),e.addCustomEventMany(e.dispatchShenWuUpLvRedPoint,154,153,267,268,266),e.addCustomEventMany(e.dispatchShenWuStrengthenRedPoint,156,610),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchShenWuRedPoint=function(){var t=this.redPoint;this.redPoint=!1,crazybtplayControl.checkSysOpen()&&(this.redPoint=0==crazybtplayControl.step||1==crazybtplayControl.step||this.UpLvRedPoint||this.StrengthenRedPoint,EventMgr.ins().dispatch(613,t!=this.redPoint))},e.prototype.dispatchShenWuUpLvRedPoint=function(){if(this.UpLvRedPoint=!1,!crazybtplayControl.checkSysOpen())return this.UpLvRedPoint;if(crazybtplayControl.swData)for(var t in crazybtplayControl.swData){var e=crazybtplayControl.IsUpLvShenWu(crazybtplayControl.swData[t].id);if(e){this.UpLvRedPoint=e;break}}EventMgr.ins().dispatch(610,!0)},e.prototype.dispatchShenWuStrengthenRedPoint=function(){if(this.StrengthenRedPoint=!1,!crazybtplayControl.checkSysOpen())return this.StrengthenRedPoint;for(var t in DataCenter.ins().CrazybtplayBaseConfig){var e=crazybtplayControl.IsShenWuStrengthen(DataCenter.ins().CrazybtplayBaseConfig[t].id)||crazybtplayControl.IsShenWuActivation(DataCenter.ins().CrazybtplayBaseConfig[t].id);if(e){this.StrengthenRedPoint=e;break}}EventMgr.ins().dispatch(611,!0)},e.prototype.IsShenWuRedPoint=function(t){return crazybtplayControl.IsShenWuStrengthen(t)||crazybtplayControl.IsShenWuActivation(t)||crazybtplayControl.IsUpLvShenWu(t)},e}(BaseSystem);__reflect(CrazybtplayRedPoint.prototype,"CrazybtplayRedPoint");var TotemRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.roleTab=[],e.addCustomEventMany(e.dispatchTuTengRedPoint,267,266,268,169,167,457),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchTuTengRedPoint=function(){var t=this.redPoint;this.redPoint=!1;var e=heroControl.subRolesLen;if(!totemControl.checkOpen()){for(var i=0;e>i;i++)this.roleTab[i]=!1;return!1}for(var i=0;e>i;i++){var n=totemControl.checkRedByRoleID(i);this.roleTab[i]=n,n&&(this.redPoint=!0)}t!=this.redPoint&&EventMgr.ins().dispatch(617,!0)},e}(BaseSystem);__reflect(TotemRedPoint.prototype,"TotemRedPoint");var IntensifyRedPoint=function(t){function e(){var e=t.call(this)||this;return e.tabs={},e.roleTabs={},e.flexible={},e.redPoint=!1,e.danReds=[],e.addCustomEventMany(e.dispatchForgeRedPoint,588,589,590,591,592),e.addCustomEventMany(e.dispatchForgeBoostRedPoint,170,657),e.addCustomEventMany(e.dispatchForgeZhulingRedPoint,170,657),e.addCustomEventMany(e.dispatchForgeGemRedPoint,170,657),e.addCustomEventMany(e.dispatchForgeWeaponRedPoint,170,657,142,143,139),e.addCustomEventMany(e.dispatchMagicCirRedPoint,266,268,267,54,53,56,55),e.addCustomEventMany(e.dispatchDanRed,267,170,589,352),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchForgeRedPoint=function(){var t=this.redPoint;this.redPoint=this.tabs[0]||this.tabs[2]||this.tabs[1]||this.tabs[3]||this.tabs[4],EventMgr.ins().dispatch(587,t!=this.redPoint)},e.prototype.getRedPoint=function(t){return this.tabs[t]},e.prototype.getFlexibleRoleRedPoint=function(t){return this.flexible[t]},e.prototype.dispatchForgeBoostRedPoint=function(){for(var t=0,e=this.tabs[t],i=!1,n=heroControl.subRolesLen,o=0;n>o;o++){var s=heroControl.getSubRoleByIndex(o),r=s.getMinEquipIndexByType(t),a=s.getEquipByIndex(r).strengthen,l=intensifyControl.getEnhanceCostConfigByLv(a+1);if(l){var h=l.stoneNum;if(h){var u=l.stoneId,p=backpackControl.getBagGoodsCountById(0,u);if(p>=h){var c=intensifyControl.isMaxForge(s,t);c&&(i=!0)}this.roleTabs[t]||(this.roleTabs[t]={}),this.roleTabs[t][o]=p>=h}}}this.tabs[t]=i,EventMgr.ins().dispatch(588,e!=i)},e.prototype.dispatchForgeZhulingRedPoint=function(){for(var t=2,e=this.tabs[t],i=!1,n=heroControl.subRolesLen,o=0;n>o;o++){var s=heroControl.getSubRoleByIndex(o),r=s.getMinEquipIndexByType(t),a=s.getEquipByIndex(r).zhuling,l=intensifyControl.getZhulingCostConfigByLv(a+1);if(l){var h=l.count;if(h){var u=l.itemId,p=backpackControl.getBagGoodsCountById(0,u);if(p>=h){var c=intensifyControl.isMaxForge(s,t);c&&(i=!0)}this.roleTabs[t]||(this.roleTabs[t]={}),this.roleTabs[t][o]=p>=h}}}this.tabs[t]=i,EventMgr.ins().dispatch(589,e!=i)},e.prototype.dispatchForgeGemRedPoint=function(){if(ActorControl.level<DataCenter.ins().IntensifyOpenConfig[0].openLv)return void EventMgr.ins().dispatch(590,!1);for(var t=1,e=this.tabs[t],i=!1,n=heroControl.subRolesLen,o=0;n>o;o++){var s=heroControl.getSubRoleByIndex(o),r=s.getMinEquipIndexByType(t),a=s.getEquipByIndex(r).gem,l=intensifyControl.getStoneLevelCostConfigByLv(a+1);if(l){var h=l.soulNum;if(h){var u=(l.stoneId,ActorControl.soul);if(u>=h){var p=intensifyControl.isMaxForge(s,t);p&&(i=!0)}this.roleTabs[t]||(this.roleTabs[t]={}),this.roleTabs[t][o]=u>=h}}}this.tabs[t]=i,EventMgr.ins().dispatch(590,e!=i)},e.prototype.dispatchForgeWeaponRedPoint=function(){for(var t=3,e=!1,i=!1,n=heroControl.subRolesLen,o=0;n>o;o++){var s=weaponsSoulControl.checkRedPoint(o);s&&(i=s),this.roleTabs[t]||(this.roleTabs[t]={}),e||this.roleTabs[t][o]==s||(e=!0);var r=this.getFlexibleRedPoint(o);this.flexible[o]=r,this.roleTabs[t][o]=s}this.tabs[t]=i,EventMgr.ins().dispatch(591,e)},e.prototype.getFlexibleRedPointOnly=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=i.weapons.getFlexibleData();if(i.weapons.flexibleCount<=n.length)return!1;var o=i.weapons.getSoulInfoData(),s=[];for(var r in o)o[r]&&o[r].id&&s.push(o[r].id);return-1==n.indexOf(e)?!0:!1},e.prototype.getFlexibleRedPoint=function(t){var e=heroControl.getSubRoleByIndex(t),i=e.weapons.getFlexibleData();if(e.weapons.flexibleCount<=i.length)return!1;var n=e.weapons.getSoulInfoData(),o=[];for(var s in n)n[s]&&n[s].id&&o.push(n[s].id);for(var r=0;r<o.length;r++)if(-1==i.indexOf(o[r])&&e.weapons.flexibleCount-1<=DataCenter.ins().WeaponSoulBaseConfig.maxItemNum)return!0;return!1},e.prototype.dispatchMagicCirRedPoint=function(){var t=4,e=this.tabs[t],i=magicCircleControl.checkRed();this.tabs[t]=i,EventMgr.ins().dispatch(592,i!=e)},e.prototype.dispatchDanRed=function(){for(var t=this.danReds.indexOf(!0),e=heroControl.subRolesLen,i=0;e>i;i++)this.danReds[i]=this.checkDanRedByIndex(i);t!=this.danReds.indexOf(!0)&&EventMgr.ins().dispatch(704)},e.prototype.checkDanRedByIndex=function(t){for(var e=DataCenter.ins().LittleSystemBaseConfig.refineUpItem,i=0;i<e.length;i++){var n=e[i];if(!backpackControl.isHideDanIcon(n)){if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,n)&&equipControl.getMinZhuLingLvByRole(t)==DataCenter.ins().ItemConfig[n].useArg.maxLevel)return!0;break}}return!1},e}(BaseSystem);__reflect(IntensifyRedPoint.prototype,"IntensifyRedPoint");var PlayWayRedPoint=function(t){function e(){var e=t.call(this)||this;return e.battleRed=!1,e.millionRed=!1,e.paodianRed=!1,e.redPoint=!1,e.addCustomEventMany(e.dispatchRedPoint,627,628,629),e.addCustomEventMany(e.dispatchBattleRed,277,461),e.addCustomEventMany(e.dispatchPaodianRed,240,461),e.addCustomEventMany(e.dispatchMillonRed,134,135,136,138),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=this.battleRed||this.millionRed||this.paodianRed,t!=this.redPoint&&EventMgr.ins().dispatch(626,!0)},e.prototype.dispatchBattleRed=function(){var t=this.battleRed;this.battleRed=campWarControl.checkRedPoint(),t!=this.battleRed&&EventMgr.ins().dispatch(627,!0)},e.prototype.dispatchMillonRed=function(){var t=this.millionRed;this.millionRed=daifugControl.getRedPoint(),t!=this.millionRed&&EventMgr.ins().dispatch(628,!0)},e.prototype.dispatchPaodianRed=function(){var t=this.paodianRed;this.paodianRed=blisterControl.checkRedPoint(),t!=this.paodianRed&&EventMgr.ins().dispatch(629,!0)},e}(BaseSystem);__reflect(PlayWayRedPoint.prototype,"PlayWayRedPoint");var MineRedPoint=function(t){function e(){var e=t.call(this)||this;return e.addCustomEventMany(e.dispatchRedPoint,619,620,621,622),e.addCustomEventMany(e.dispatchCanRob,623,624,625,243,407),e.addCustomEventMany(e.dispatchRecordUpdate,250,247),e.addCustomEventMany(e.dispatchCanMine,243,249,245),e.addCustomEventMany(e.dispatchCanAward,243,249,245),e.addCustomEventMany(e.updateTime,623,624,407),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=this.mineCanRob||this.mineRecord||this.mineCanStart||this.mineCanAward,t!=this.redPoint&&EventMgr.ins().dispatch(618,!0)},e.prototype.dispatchCanRob=function(){var t=this.mineCanRob;this.mineCanRob=mineControl.openCheck()&&mineControl.allCanRobData.canRob(),t!=this.mineCanRob&&EventMgr.ins().dispatch(619,!0)},e.prototype.dispatchRecordUpdate=function(){var t=this.mineRecord;this.mineRecord=mineControl.hasNewRecord,t!=this.mineRecord&&EventMgr.ins().dispatch(620,!0)},e.prototype.dispatchCanMine=function(){var t=this.mineCanStart;this.mineCanStart=mineControl.openCheck()&&!mineControl.finishedData&&mineControl.mineCount<mineControl.getCanMineCount()&&mineControl.isOverTime(),t!=this.mineCanStart&&EventMgr.ins().dispatch(621,!0)},e.prototype.dispatchCanAward=function(){var t=this.mineCanAward;this.mineCanAward=!!mineControl.finishedData,t!=this.mineCanAward&&EventMgr.ins().dispatch(622,!0)},e.prototype.updateTime=function(){var t=mineControl.allCanRobData.getMiniTime();if(t){var e=t-GameServer.serverTime;if(0>=e)return;TimerMgr.ins().remove(this.dispatchMineEnd,this),TimerMgr.ins().once(e,this.dispatchMineEnd,this)}else TimerMgr.ins().remove(this.dispatchMineEnd,this)},e.prototype.dispatchMineEnd=function(){EventMgr.ins().dispatch(407)},e}(BaseSystem);__reflect(MineRedPoint.prototype,"MineRedPoint");var BasePortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this),i=this.getConfig();return i&&(this.redPoint=this.tar.redPoint,this.conditionText=this.tar.conditionText,this.imgItem=this.tar.imgItem,i.icon&&this.imgItem&&(this.imgItem.source=i.icon)),e},e.prototype.onAddToStage=function(){TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().doTimer(1e3,0,this.runTime,this),this.runTime()},e.prototype.onRemoveFromStage=function(){TimerMgr.ins().remove(this.runTime,this)},e.prototype.runTime=function(){},e}(PortalBase);__reflect(BasePortalIcon.prototype,"BasePortalIcon");var AmusementType1DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardsSum=[],e.hFTotalConsumption=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.record=t[0],this.hFTotalConsumption=t[1];for(var e=0;e<t[2].length;e++)this.rewardsSum[e+1]=t[2][e]},e.prototype.updateAmusement=function(t){this.record=t[1]},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getConfig=function(){var t;return t=1==this.activityType?DataCenter.ins().PAmusementType1Config:DataCenter.ins().Amusement1Config},e.prototype.getIns=function(){var t;return t=1==this.activityType?PAmusementControl.ins():AmusementControl.ins()},e.prototype.getRewardStateById=function(t){var e=this.getConfig()[this.id][t];switch(e.showType){case 0:if(ActorControl.level<e.level||reincarnateControl.lv<e.zslevel)return AmusementControl.NotReached;break;case 1:if(FeatherVo.getWingAllLevel()<e.wingLv)return AmusementControl.NotReached;break;case 2:if(RoleModel.getIntensifyTotalLvByType(2)<e.zzLv)return AmusementControl.NotReached;break;case 3:if(DragonSoulDataVo.getLongHunAllLevel()<e.lhLv)return AmusementControl.NotReached;break;case 5:var i=bookControl.getBookPowerNumEx();if(i<e.tjPower)return AmusementControl.NotReached;break;case 6:if(backpackControl.getEquipsScoreByRolesOfBody()<e.equipPower)return AmusementControl.NotReached;break;case 100:var n=this.getIns().getAmusementDataById(e.Id);if(n.hFTotalConsumption<e.consumeYuanbao)return AmusementControl.NotReached;break;case 7:var o=0,s=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID);if(s&&s.level&&(o=s.level),o<e.huoyanRingLv)return AmusementControl.NotReached;break;case 8:if(ActorControl.samsaraLv<e.lunhLv)return AmusementControl.NotReached;break;case 9:if(ashtarteControl.getZhanLingDataByLevel(0)<e.zhanlingLv)return AmusementControl.NotReached;break;case 10:if(magicCircleControl.getPotentionTimes()<e.skillCount)return AmusementControl.NotReached;break;case 11:if(crazybtplayControl.getStrengthenLvAll()<e.shenwuLv)return AmusementControl.NotReached;break;case 12:if(ActorControl.power<e.power)return AmusementControl.NotReached;break;case 13:if(dominateEquipControl.getTotalScore()<e.zhuzaiScore)return AmusementControl.NotReached;break;case 14:if(runeControl.totalPower<e.fuwenPower)return AmusementControl.NotReached;break;case 15:if(superRingControl.totalPower<e.aexringPower)return AmusementControl.NotReached}var r=Math.floor(this.record/Math.pow(2,e.index))%2;return r?AmusementControl.Geted:AmusementControl.CanGet},e.prototype.checkRedPoint=function(){var t=this.getConfig()[this.id];for(var e in t){var i=t[e],n=this.getRewardStateById(i.index),o=this.rewardsSum[i.index],s=i.total?i.total-o:1;switch(n){case AmusementControl.NotReached:break;case AmusementControl.CanGet:if(s>0)return!0;break;case AmusementControl.Geted:}}return!1},e.prototype.getHide=function(){if(this.isHide)return this.isHide;var t=this.record>>1,e=this.getConfig()[this.id],i=Object.keys(e);return t>=Math.pow(2,i.length)-1?(this.isHide=!0,this.isHide):(this.isHide=!1,this.isHide)},e}(AmusementBaseDataVo);__reflect(AmusementType1DataVo.prototype,"AmusementType1DataVo");var AmusementType9DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.record=t[0],this.count=t[1],this.indexs=[];for(var e=0;e<t[2].length;e++)this.indexs.push(t[2][e]);this.noticeArr=[];for(var e=0;e<t[3].length;e++)this.noticeArr.push({name:t[3][e][0],index:t[3][e][1]});this.noticeArr.reverse()},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){var t;return t=1==this.activityType?PAmusementControl.ins():AmusementControl.ins(),t.getType9RedPoint(this.id)},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e.prototype.getLastTime=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3),e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3);return e},e.prototype.getStateByIndex=function(t){return this.record>>t&1},e}(AmusementBaseDataVo);__reflect(AmusementType9DataVo.prototype,"AmusementType9DataVo");var RankDataPassVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.power=t[3],this.vip=t[4],this.count=t[5],this.month=t[6]},e}(RankDataBaseVo);__reflect(RankDataPassVo.prototype,"RankDataPassVo");var RankDataPowerVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zhuan=t[4],this.vip=t[5],this.month=t[6],this.power=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataPowerVo.prototype,"RankDataPowerVo");var ReincarnateStarRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.upGradeRed=!1,e.bossRedpoint=!1,e.equipRed=!1,e.equipRoleTab=[],e.composeRoleTab=[],e.suitRoleTab=[],e.QHRoleTab=[],e.addCustomEventMany(e.dispatchThirteenRedPoint,652,645,646,647,648,649),e.addCustomEventMany(e.dispatchThirteenUpGrade,115,112,4,461),e.addCustomEventMany(e.dispatchBossRedpoint,112,461,4,296),e.addCustomEventMany(e.dispatchEquipRed,114,266,267,268,112,115,650),e.addCustomEventMany(e.dispatchComposeRed,114,266,267,268),e.addCustomEventMany(e.dispatchSuitRed,114,650),e.addCustomEventMany(e.dispatchQHRed,114,266,267,268,112,115),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchThirteenRedPoint=function(){var t=this.redPoint;this.redPoint=this.upGradeRed||this.bossRedpoint||this.equipRed||this.composeRed||this.suitRed||this.QHRed,t!=this.redPoint&&EventMgr.ins().dispatch(651,!0)},e.prototype.dispatchThirteenUpGrade=function(){this.upGradeRed=!1,reincarnateStarControl.checkShow13ZsPanel()&&(this.upGradeRed=reincarnateStarControl.IsUpLevel13ZsExp()),EventMgr.ins().dispatch(652)},e.prototype.dispatchBossRedpoint=function(){var t=this.bossRedpoint;if(this.bossRedpoint=!1,!reincarnateStarControl.checkShow13ZsPanel())return!1;var e=bossControl.worldInfoList[11];if(!e)return!1;for(var i=0;i<e.length;i++){var n=e[i];if(this.bossRedpoint)break;n.canChallenge&&bossControl.worldBossBelongTime[11]&&bossControl.getBossRemindByIndex(n.id)&&(this.bossRedpoint=!0)}this.bossRedpoint!=t&&EventMgr.ins().dispatch(645,!0)},e.prototype.dispatchEquipRed=function(){this.equipRed=reincarnateStarEquipControl.checkEquipRed();for(var t=heroControl.subRolesLen,e=0;t>e;e++)this.equipRoleTab[e]=reincarnateStarEquipControl.checkEquipRedByRoleID(e);EventMgr.ins().dispatch(646)},e.prototype.dispatchComposeRed=function(){this.composeRed=reincarnateStarEquipControl.checkComposeRed();for(var t=heroControl.subRolesLen,e=0;t>e;e++)this.composeRoleTab[e]=reincarnateStarEquipControl.checkComRedByRoleID(e);EventMgr.ins().dispatch(647)},e.prototype.dispatchSuitRed=function(){this.suitRed=reincarnateStarEquipControl.checkSuitRed();for(var t=heroControl.subRolesLen,e=0;t>e;e++)this.suitRoleTab[e]=reincarnateStarEquipControl.checkSuitRedByRoleID(e);EventMgr.ins().dispatch(648)},e.prototype.dispatchQHRed=function(){this.QHRed=reincarnateStarEquipControl.checkQHRed();for(var t=heroControl.subRolesLen,e=0;t>e;e++)this.QHRoleTab[e]=reincarnateStarEquipControl.checkQHRedByRoleID(e);
EventMgr.ins().dispatch(649)},e}(BaseSystem);__reflect(ReincarnateStarRedPoint.prototype,"ReincarnateStarRedPoint");var RuneRedPoint=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkSingleUpgrade=function(t){if(!this.checkOpen())return!1;var e=t.itemConfig;if(!e)return!1;var i=DataCenter.ins().RuneBaseConfig[t.configID+1];if(!i)return!1;var n=DataCenter.ins().RuneBaseConfig[t.configID];if(!n)return!1;var o=ActorControl.runeShatter;return o>=n.expend},e.prototype.checkRoleUpgrade=function(t){if(!this.checkOpen())return!1;var e=runeControl.getRoleRune(t);if(e)for(var i=0,n=e;i<n.length;i++){var o=n[i];if(o&&o.itemConfig&&o.itemConfig.id>0&&this.checkSingleUpgrade(o))return!0}return!1},e.prototype.checkAllUpgrade=function(){if(!this.checkOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkRoleUpgrade(e))return!0;return!1},e.prototype.checkSingleInlay=function(t,e){if(!this.checkOpen())return!1;var i=DataCenter.ins().RuneLockPosConfig[e];if(!i)return!1;var n=i.lockLv,o=copyBabelControl.curLevel;if(o>n){var s=runeControl.getRune(t,e);if(s&&s.configID<=0)for(var r=backpackControl.getBagGoodsBySort(1),a=0,l=runeControl.getRoleRune(t),h=!0,u=0,p=r;u<p.length;u++){var c=p[u];if(c&&(a=ItemUtils.getSubType(c.itemConfig),a>0&&l)){if(h=!0)for(var d=0,g=l;d<g.length;d++){var m=g[d];if(m&&m.itemConfig&&m.itemConfig.id>0&&a==ItemUtils.getSubType(m.itemConfig)){h=!1;break}}if(h)return!0}}}return!1},e.prototype.checkRoleInlay=function(t){if(!this.checkOpen())return!1;for(var e=0;e<DataCenter.ins().RuneOtherConfig.maxEquip;e++)if(this.checkSingleInlay(t,e))return!0;return!1},e.prototype.checkAllInlay=function(){if(!this.checkOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkRoleInlay(e))return!0;return!1},e.prototype.checkRoleAllSituation=function(t){if(!this.checkOpen())return!1;var e=this.checkRoleInlay(t);return e||(e=this.checkRoleUpgrade(t)),e},e.prototype.checkAllSituation=function(t){if(void 0===t&&(t=!0),!this.checkOpen())return!1;var e=this.checkAllInlay();return e||(e=this.checkAllUpgrade()),t&&(e||(e=this.checkCanExchange())),e},e.prototype.checkCanExchange=function(){for(var t=runeControl.getExchangeDataList(),e=0;e<t.length;e++){var i=t[e];if(ActorControl.runeExchange>=i.conversion)return!0}return!1},e.prototype.checkOpen=function(){return ActorControl.level>=DataCenter.ins().RuneOtherConfig.zsLevel},e}(BaseSystem);__reflect(RuneRedPoint.prototype,"RuneRedPoint");var SoulBoneRedPoint=function(t){function e(){var e=t.call(this)||this;return e.itemPoints=[],e.roleTabs=[],e.redPoint=!1,e.addCustomEventMany(e.dispatchRedPoint,578),e.addCustomEventMany(e.dispatchRoleRedPoint,70,73,74,75,269,112,352),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=!1;for(var e=0;e<this.roleTabs.length;e++)this.roleTabs[e]&&(this.redPoint=!0);EventMgr.ins().dispatch(577,t!=this.redPoint)},e.prototype.dispatchRoleRedPoint=function(){for(var t=(SoulBoneControl.ins(),0);3>t;t++){var e=heroControl.getSubRoleByIndex(t);if(e)for(var i=0;i<DataCenter.ins().SoulBoneConfig.equipCount&&(this.roleTabs[t]=this.soulBoneItemRedPoint(e.index,i),!this.roleTabs[t]);i++);else this.roleTabs[t]=!1}EventMgr.ins().dispatch(578,!0)},e.prototype.soulBoneItemRedPoint=function(t,e){var i=SoulBoneControl.ins(),n=!1,o=i.getSoulBoneItemsList(e);return!o.length||i.soulBoneData[t]&&i.soulBoneData[t].items[e].itemId?(n=i.getSoulJadeRedPoint(t,e))?!0:(i.soulBoneData[t]&&i.soulBoneData[t].items[e].itemId&&(n=i.getUpgradeRedPoint(i.soulBoneData[t].items[e].itemId)),n):!0},e}(BaseSystem);__reflect(SoulBoneRedPoint.prototype,"SoulBoneRedPoint");var StoreRedPoint=function(t){function e(){var e=t.call(this)||this;return e.shopRedPoint=!1,e.blackMarketRedPoint=!1,e.weekShopRedPoint=!1,e.treasureStoreRedPoint=!1,e.addCustomEventMany(e.dispatchShopRedPoint,660,661,662),e.addCustomEventMany(e.dispatchBlackMarketRedPoint,196),e.addCustomEventMany(e.dispatchWeekShopRedPoint,203,701),e.addCustomEventMany(e.dispatchTreasureStoreRedPoint,266,268,267,272,205),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchShopRedPoint=function(){var t=this.shopRedPoint;this.shopRedPoint=this.blackMarketRedPoint||this.weekShopRedPoint||this.treasureStoreRedPoint,this.shopRedPoint!=t&&EventMgr.ins().dispatch(684,!0)},e.prototype.dispatchBlackMarketRedPoint=function(){var t=this.blackMarketRedPoint;this.blackMarketRedPoint=storeControl.shopData.refushTime<=0,this.blackMarketRedPoint!=t&&EventMgr.ins().dispatch(660,!0)},e.prototype.dispatchWeekShopRedPoint=function(){var t=this.weekShopRedPoint;this.weekShopRedPoint=storeControl.shopData.weekStoreRedPoint,this.weekShopRedPoint!=t&&EventMgr.ins().dispatch(661,!0)},e.prototype.dispatchTreasureStoreRedPoint=function(){var t=this.treasureStoreRedPoint;this.treasureStoreRedPoint=storeControl.zhenbaoShopData.updateTreasureStoreRP(),this.dispatchTreasureStoreUpdate(),this.treasureStoreRedPoint!=t&&EventMgr.ins().dispatch(662,!0)},e.prototype.dispatchTreasureStoreUpdate=function(){EventMgr.ins().dispatch(663)},e}(BaseSystem);__reflect(StoreRedPoint.prototype,"StoreRedPoint");var ItemTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ItemTipsViewSkin",this.itemIcon.imgJob.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1],o=t[2],s=t[3];this.addEventTouchEnd(this,this.otherClose),this.setData(i,n,o,s)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.setData=function(t,e,i,n){var o="";if(void 0==i){var s=backpackControl.getBagGoodsCountById(t,e);o=s+"",s||(this.numLabel.visible=!1,this.numTxt.visible=!1)}else o=i+"",i||(this.numLabel.visible=!1,this.numTxt.visible=!1);this.itemConfig=DataCenter.ins().ItemConfig[e],this.nameTxt.text=this.itemConfig.name,this.quaImg.source="quali"+ItemUtils.getQuality(this.itemConfig),this.nameTxt.textColor=ItemUtils.getQualityColor(this.itemConfig),this.itemIcon.setData(this.itemConfig),this.itemConfig.zsLevel?this.lvTxt.text=LangMgr.getValueByKey("numberRotation",this.itemConfig.zsLevel):this.lvTxt.text=LangMgr.getValueByKey("numberLevel",this.itemConfig.level||1),this.numTxt.text=o;var r=n?"（"+n+LangMgr.getValueByKey("currency2")+"）":"";if(this.description.textFlow=TextUtils.generateTextFlow1(this.itemConfig.desc+r),2==ItemUtils.getType(this.itemConfig)){var a=esotericaControl.getSkillIdByItemId(this.itemConfig.id);this.power.text=LangMgr.getValueByKey("wingPingfen",DataCenter.ins().EsotericaSkillConfig[a].power)}else this.power.text="";this.BG.height=170+this.description.height},e}(BaseEuiView);__reflect(ItemTipsView.prototype,"ItemTipsView");var TipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.skinName="HintTipsItemRendererSkin",e.lab.stroke=1,e.lab.strokeColor=0,e}return __extends(e,t),e.prototype.setIndex=function(t){this.index=t},Object.defineProperty(e.prototype,"labelText",{get:function(){return this._labelText},set:function(t){this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow(this._labelText),this.bg.width=this.lab.width,this.bg.visible=!1,this.lab.alpha=1,this.bg.y=0,this.lab.verticalCenter=-1,this.addToEvent||(this.addToEvent=!0,TimerMgr.ins().doTimer(1200,1,this.removeFromParent,this))},enumerable:!0,configurable:!0}),e.prototype.removeFromParent=function(){this.addToEvent=!1,DisplayUtils.removeFromParent(this),egret.Tween.removeTweens(this),ObjectPool.push(this)},e}(BasePanel);__reflect(TipsItemRenderer.prototype,"TipsItemRenderer");var GodWeaponBossChallengeView=function(t){function e(){var e=t.call(this)||this;return e._cdTime=0,e.skinName="GodWeaponBossChallengeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.reward.itemRenderer=ItemBase,this._awardAC=new eui.ArrayCollection,this.reward.dataProvider=this._awardAC},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.notBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.challengeBtn,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this._bossData=t[0],this.initView()},e.prototype.initView=function(){var t=this._bossData,e=DataCenter.ins().WorldBossConfig[t.id];this.title.text=e.showName,this._awardAC.source=e.showReward.concat();var i=DataCenter.ins().WorldBossBaseConfig.challengeItemYb[e.type-1];this.yuanbao.text=""+i;var n=DataCenter.ins().WorldBossBaseConfig.challengeItem[e.type-1];this.ticket.source=n+"_png";var o=backpackControl.getBagGoodsByTypeAndId(0,n),s=0;o&&(s=o.count),this.num.text=""+s,s?this.num.textColor=ColorUtils.GREEN:this.num.textColor=ColorUtils.RED;var r=Math.ceil((bossControl.worldBossCd[e.type]-egret.getTimer())/1e3);r>0?(this.leftCDText.visible=!0,this.updateCDTime(r)):this.leftCDText.visible=!1},e.prototype.updateCDTime=function(t){this._cdTime=t,TimerMgr.ins().remove(this.updateBtnLabel,this),t>0&&TimerMgr.ins().doTimer(1e3,t,this.updateBtnLabel,this),this.updateBtnLabel()},e.prototype.updateBtnLabel=function(){this.leftCDText.text=LangMgr.getValueByKey("bossFightCD1",this._cdTime),this._cdTime-=1,this._cdTime<=0&&(this.leftCDText.text="")},e.prototype.onTap=function(t){var e=t.currentTarget;e==this.notBtn||e==this.bgClose||e==this.fgClose?UIMgr.ins().close(this):e==this.challengeBtn&&this.onChallenge()},e.prototype.onChallenge=function(){if(copyControl.checkInFB())return!1;var t=DataCenter.ins().WorldBossConfig[this._bossData.id];if(this._bossData.canInto)if(this._bossData.isDie)tipsControl.showTips(LangMgr.getValueByKey("godBossDied"));else{if(!(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)){var e=Math.ceil((bossControl.worldBossCd[t.type]-egret.getTimer())/1e3);if(e>0)return tipsControl.showTips(LangMgr.getValueByKey("bossfightTime",e)),!1;var i=DataCenter.ins().WorldBossBaseConfig.challengeItemYb[t.type-1],n=DataCenter.ins().WorldBossBaseConfig.challengeItem[t.type-1],o=backpackControl.getBagGoodsByTypeAndId(0,n);return o&&o.count||!(ActorControl.yb<i)?(bossControl.challengWorldBoss(this._bossData.id,t.type),UIMgr.ins().close(this),!0):(tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),UIMgr.ins().close(this),!1)}UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH)}else tipsControl.showTips(LangMgr.getValueByKey("personNoLevelFight"));return!1},e.prototype.close=function(){this.removeEventTouchTap(this.notBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.challengeBtn,this.onTap)},e}(BaseEuiView);__reflect(GodWeaponBossChallengeView.prototype,"GodWeaponBossChallengeView");var AmuseTarget12Panel1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget12Panel1Skin",this.hongbaoTitle&&(this.hongbaoTitle.text=LangMgr.getValueByKey("hongbaoTitle",GlobalModel.chargeRate))},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t,this.setCurSkin()},enumerable:!0,configurable:!0}),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this),this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(395,this.updateLogs),this.addEventTouchTap(this.onbtn,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.dataArr||(this.list.itemRenderer=OffYearListsItemRender,this.dataArr=new eui.ArrayCollection,this.list.dataProvider=this.dataArr),this.index=this.getRuleIndex(),this.updateData(),this.updateLogs()},e.prototype.getRuleIndex=function(){var t=1,e=amusementControl.getAmusementDataById(this.activityID);for(var i in DataCenter.ins().Amusement12Config[this.activityID])e.score>=DataCenter.ins().Amusement12Config[this.activityID][i].score&&(t=DataCenter.ins().Amusement12Config[this.activityID][i].index);return t},e.prototype.GetCallBack=function(t){t==this.activityID&&this.updateData()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.onbtn:var e=amusementControl.getAmusementDataById(this.activityID);if(!e.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));var i=DataCenter.ins().Amusement12Config[this.activityID];i&&i[this.index]&&(e.score>=i[this.index].score?UIMgr.ins().open(RedpacketSpeakView,this.activityID,this.index):tipsControl.showTips(LangMgr.getValueByKey("osaEnoughtScore")));break;case this.leftBtn:if(this.index<=1)return;this.index--,this.updateBtn();break;case this.rightBtn:if(this.index>=CommonUtils.getObjectLength(DataCenter.ins().Amusement12Config[this.activityID]))return;this.index++,this.updateBtn()}},e.prototype.updateBtn=function(){1==this.index?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.index==CommonUtils.getObjectLength(DataCenter.ins().Amusement12Config[this.activityID])?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):this.leftBtn.visible=this.rightBtn.visible=!0;var t=DataCenter.ins().Amusement12Config[this.activityID][this.index];this.hongbao.data=t;var e=amusementControl.getAmusementDataById(this.activityID);this.redPoint.visible=e.score>=t.score},e.prototype.updateLogs=function(){var t=[],e=amusementControl.getAmusementDataById(this.activityID);this.actPoint.text=e.score+"";for(var i=e.logs.length-1;i>=0;i--){var n=DataCenter.ins().Amusement12Config[this.activityID][e.logs[i].index],o="s"+e.logs[i].serverId+"."+e.logs[i].name,s=StringUtils.replace(n.record,o);t.push(s)}this.dataArr.replaceAll(t)},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID],i=Math.floor((DateUtils.formatMiniDateTime(t.startTime)-GameServer.serverTime)/1e3),n=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);i>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=n?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=n,this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_5,3)),this.actInfo.text=e.desc,this.updateBtn()},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e}(BasePanel);__reflect(AmuseTarget12Panel1.prototype,"AmuseTarget12Panel1");var AmuseTarget18Panel1=function(t){function e(e){var i=t.call(this)||this;return i.addBoxEvent=!1,i.huntType=1,i.imgArr=[],i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget18Panel1Skin"},e.prototype.init=function(){for(var t,e=DataCenter.ins().Amusement18Config[this.activityID],i=e[0],n=i.showDrop.length,o=0;n>o&&16>o;o++)t=this["gift"+o],t.data=i.showDrop[o],1>=o&&t.setItemHeirloomBgImg(!0,"csbk03");this.list.itemRenderer=TreasureHuntListItemRenderer,this.jpList.itemRenderer=TreasureHuntListItemRenderer;for(var s in e)1==e[s].count?this.yb1.text=e[s].yb+"":10==e[s].count&&(this.yb10.text=e[s].yb+"");if("AmuseTarget18Panel1Skin2"==this.skinName)for(var r=0;14>r;r++)this["gift"+(r+2)].x=86*r,this.imgArr.push(this["gift"+(r+2)])},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.init(),this.addEventTouchTap(this.buy1,this.onBuy),this.addEventTouchTap(this.buy10,this.onBuy),this.addCustomEvent(395,this.updateData);var i=amusementControl.getAmusementDataById(this.activityID);this.endedTime=i.getLeftTime(),this.timeClock(),TimerMgr.ins().remove(this.timeClock,this),egret.Tween.removeTweens(this),TimerMgr.ins().doTimer(1e3,0,this.timeClock,this),this.addBoxEvent=!0,this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.buy1,this.onBuy),this.removeEventTouchTap(this.buy10,this.onBuy),this.removeCustomEvents(),egret.Tween.removeTweens(this),TimerMgr.ins().removeAll(this),this.addBoxEvent=!1},e.prototype.updateData=function(){this.listRefush(),this.updateBox(),this.updateMaterial()},e.prototype.getmaxDistance=function(){for(var t=0,e=0;e<this.imgArr.length;e++)t<=this.imgArr[e].x&&(t=this.imgArr[e].x);return t},e.prototype.timerFunc=function(){for(var t=0;t<this.imgArr.length;t++)this.imgArr[t].x<=-86&&(this.imgArr[t].x=this.getmaxDistance()+86),egret.Tween.get(this.imgArr[t]).to({x:this.imgArr[t].x-45},1e3)},e.prototype.timeClock=function(){this.endedTime>=0&&(this.leftTimeTxt.text=DateUtils.getFormatBySecond(this.endedTime,DateUtils.TIME_FORMAT_5,4)),this.endedTime-=1,"AmuseTarget18Panel1Skin2"==this.skinName&&this.timerFunc()},e.prototype.listRefush=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.list.dataProvider=new eui.ArrayCollection(t.logs),this.jpList.dataProvider=new eui.ArrayCollection(t.bestlogs))},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(1);break;case this.buy10:this.buyHunt(2)}},e.prototype.buyHunt=function(t){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);this.huntType=t;var e=DataCenter.ins().Amusement18Config[this.activityID],i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,e[t].item);if(i&&i.count)amusementControl.upReward(this.activityID,t);else{var n=t>1?10:1,o=e[t].yb;TreasureHuntWarnBuyView.showBuyWarn("AmuseTarget18Panel1-HuntResultWin"+(10==n?1:0),this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",o,DataCenter.ins().ItemConfig[e[t].item].name,n))}},e.prototype.huntWarnFun=function(){var t=DataCenter.ins().Amusement18Config[this.activityID][this.huntType].yb;ActorControl.yb>=t?amusementControl.upReward(this.activityID,this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.updateBox=function(){var t=DataCenter.ins().Amusement18Config[this.activityID],e=[];for(var i in t)t[i].dbCount&&e.push(t[i]);e.sort(function(t,e){return t.dbCount<e.dbCount?-1:1});var n,o,s=amusementControl.getAmusementDataById(this.activityID),r=0,a=e.length,l=0;for(var h in e){if(o=e[h],this["time"+r].text=LangMgr.getValueByKey("osaTimes",o.dbCount),this["time"+r].visible=!0,this["done"+r].visible=!1,this["boxPoint"+r].visible=!1,this["bar"+r].value=0,this["bar"+r].maximum=100,this["box"+r].source="200116_0_png",this["box"+r].name="box"+o.index,this.addBoxEvent||this.addEventTouchTap(this["box"+r],this.onGetAward),a>r)if(n=s.getStateByIndex(o.index),2==n)this["box"+r].source="200116_png",this["bar"+r].value=100,this["boxPoint"+r].visible=!0;else if(1==n)this["time"+r].visible=!1,this["done"+r].visible=!0,this["bar"+r].value=100;else{var u=Math.floor((s.num-l)/(o.dbCount-l)*100);0>u?u=0:u>100&&(u=100),this["bar"+r].value=u}l=o.dbCount,r++}this.icon10.source=this.icon1.source=DataCenter.ins().ItemConfig[t[1].item].icon+"_png"},e.prototype.onGetAward=function(t){var e=t.target.name.slice(3,4),i=amusementControl.getAmusementDataById(this.activityID),n=i.getStateByIndex(e);2==n?amusementControl.upReward(this.activityID,e):UIMgr.ins().open(TreasureHuntBoxsTipsView,e,3,this.activityID)},e.prototype.updateMaterial=function(){var t=backpackControl.getBagGoodsByTypeAndId(0,DataCenter.ins().Amusement18Config[this.activityID][1].item),e=t?t.count:0;this.num.textFlow=TextUtils.generateTextFlow1("|C:"+(e?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|"),this.num10.textFlow=TextUtils.generateTextFlow1("|C:"+(e>=10?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|")},e}(BasePanel);__reflect(AmuseTarget18Panel1.prototype,"AmuseTarget18Panel1");var AmuseTarget18Panel2=function(t){function e(e){var i=t.call(this)||this;return i.huntType=1,i.first=!1,i.sendBuyType=0,i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget18Panel2Skin"},e.prototype.init=function(){var t=DataCenter.ins().Amusement18Config[this.activityID];this.list0.itemRenderer=TreasureHuntListItemRenderer;for(var e in t)1==t[e].count?this.yb1.text=t[e].yb+"":10==t[e].count&&(this.yb10.text=t[e].yb+"")},e.prototype.open=function(){this.init(),this.addEventTouchTap(this.buy1,this.onBuy),this.addEventTouchTap(this.buy10,this.onBuy),this.addEventTouchTap(this.help,this.onBuy);for(var t=1;7>=t;t++)this.addEventTouchTap(this["ball"+t],this.onBuy);this.addEventTouchTap(this.getItemTxt,this.onBuy),this.addCustomEvent(393,this.RewardResult),this.rewardList.itemRenderer=ItemBaseNoName,this.timeClock(),TimerMgr.ins().isExists(this.timeClock,this)||TimerMgr.ins().doTimer(1e3,0,this.timeClock,this),this.updateData(),this.updateData2()},e.prototype.close=function(){TimerMgr.ins().remove(this.timeClock,this)},e.prototype.updateData2=function(){this.listRefush();var t=DataCenter.ins().Amusement18Config[this.activityID][0],e=t.relateActivityId,i=DataCenter.ins().Amusement13Config[e];this.setBallIndex();for(var n in i)this.updateLongZhu(i[n].index);null==this.rewardList.dataProvider?this.rewardList.dataProvider=new eui.ArrayCollection(t.showDrop.concat()):this.rewardList.dataProvider.replaceAll(t.showDrop.concat()),this.rewardList.validateNow()},e.prototype.RewardResult=function(t){if(this.activityID!=t){var e=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId;if(t!=e)return}this.updateData(),this.updateData2(),this.callbackPlayEff()},e.prototype.callbackPlayEff=function(){var t=this,e=amusementControl.getAmusementDataById(this.activityID);if(e){var i=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,n=amusementControl.getAmusementDataById(i);if(n){var o=void 0;o=this.sendBuyType?this.buy10.localToGlobal():this.buy1.localToGlobal(),this.globalToLocal(o.x,o.y,o),this.setBallIndex();for(var s=function(e){var i=n.playList[e];if(!r["ball"+i])return"continue";o=r["ball"+i].localToGlobal(),r.globalToLocal(o.x,o.y,o);var s=new GameMovieClip;s.playFile(PATH_EFF+"DragonBallEff",-1),s.x=o.x,s.y=o.y,r.addChild(s),egret.Tween.get(s).to({x:o.x+45,y:o.y+45},500).call(function(){s&&egret.Tween.removeTweens(s),DisplayUtils.removeFromParent(s),t.updateLongZhu(i,!0)},r)},r=this,a=0;a<n.playList.length;a++)s(a);n.playList=[]}}},e.prototype.listRefush=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.list0.dataProvider=new eui.ArrayCollection(t.logs))},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(1),this.sendBuyType=0;break;case this.buy10:this.buyHunt(2),this.sendBuyType=1;break;case this.help:HelpControl.openHelpWin(53);break;default:var e=amusementControl.getAmusementDataById(this.activityID);if(!e)return;var i=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,n=DataCenter.ins().Amusement13Config[i];if(t.currentTarget==this.getItemTxt)return void UIMgr.ins().open(AmuseTarget18Panel2TipsView,this.activityID);for(var o=CommonUtils.getObjectLength(n),s=0;o>s&&this["ball"+(s+1)];s++)if(this["ball"+(s+1)]==t.currentTarget){var r=amusementControl.getAmusementDataById(i);if(!r)return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));if(r.proReward[s+1])return void tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet"));this["ball"+(s+1)].data.count&&r.proCount[s+1]/DataCenter.ins().Amusement13Config[i][s+1].count>=1?UIMgr.ins().open(TreasureHuntSelectView,i,s+1):UIMgr.ins().open(AmuseTarget18Panel2TipsView,this.activityID);break}}},e.prototype.buyHunt=function(t){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);this.huntType=t;var e=DataCenter.ins().Amusement18Config[this.activityID],i=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e[t].item);if(i)amusementControl.upReward(this.activityID,t);else{var n=t>1?10:1,o=e[t].yb;TreasureHuntWarnBuyView.showBuyWarn("AmuseTarget18Panel2-HuntResultWin"+(10==n?1:0),this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",o,DataCenter.ins().ItemConfig[e[t].item].name,n))}},e.prototype.huntWarnFun=function(){var t=DataCenter.ins().Amusement18Config[this.activityID],e=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t[this.huntType].item);if(e)amusementControl.upReward(this.activityID,this.huntType);else{var i=DataCenter.ins().Amusement18Config[this.activityID][this.huntType].yb;ActorControl.yb>=i?amusementControl.upReward(this.activityID,this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))}},e.prototype.updateMaterial=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];this.actInfo1.text=t.desc;var e=backpackControl.getBagGoodsCountById(0,DataCenter.ins().Amusement18Config[this.activityID][1].item);this.num1.textFlow=TextUtils.generateTextFlow1("|C:"+(e?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|"),this.num10.textFlow=TextUtils.generateTextFlow1("|C:"+(e>=10?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|");var i=DataCenter.ins().Amusement18Config[this.activityID];this.icon1.source=DataCenter.ins().ItemConfig[i[1].item].icon+"_png",this.icon10.source=DataCenter.ins().ItemConfig[i[2].item].icon+"_png",this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text)},e.prototype.setBallIndex=function(){if(this.hisGrop){for(var t=1;8>t;t++){var e=this["ball"+t];e&&this.addChild(e)}for(var i=0;7>i;i++)for(var t=1;8>t;t++){var e=this["ball"+t];e&&parseInt(e.name)==i&&this.hisGrop.addChild(e)}}},e.prototype.updateLongZhu=function(t,e){void 0===e&&(e=!1);var i=this["ball"+t];if(i){i.liang.visible=!0,!i.highliang&&(i.an.source="dragonball_an_"+t),!i.highliang&&(i.liang.source="dragonball_liang_"+t);var n=amusementControl.getAmusementDataById(this.activityID);if(n){var o=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,s=amusementControl.getAmusementDataById(o);if(s){var r=s.proCount[t],a=DataCenter.ins().Amusement13Config[o][t].count;if(t>1&&!s.proReward[t-1])r=0;else{var l=DataCenter.ins().Amusement13Config[o][t].nextProgress?DataCenter.ins().Amusement13Config[o][t].nextProgress/1e4:0;r=a*l+r*(1-l)}e?i.play(r):i.data={count:r,maxcount:a,isget:s.proReward[t],index:t}}}}},e.prototype.cleanLongZhu=function(t){var e=this["ball"+t];e&&e.clean()},e.prototype.timeClock=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.endedTime=t.getLeftTime(),this.actTime1.text=DateUtils.getFormatBySecond(this.endedTime,DateUtils.TIME_FORMAT_5,3))},e.prototype.updateData=function(){this.updateMaterial()},e}(BasePanel);__reflect(AmuseTarget18Panel2.prototype,"AmuseTarget18Panel2");var AmuseTarget18Panel2TipsView=function(t){function e(){var e=t.call(this)||this;return e.panelArr=[],e.skinName="AmuseTarget18Panel2RewardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list0.itemRenderer=AmuseTarget18Panel2ListItemRender,this.rewardList1.itemRenderer=ItemBase},e.prototype.open=function(t){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventChange(this.tab,this.onTabTouch),this.activityID=t;for(var e=0;e<this.viewStack.numElements;e++){var i=this.viewStack.getVirtualElementAt(e);this.panelArr.push(i)}this.viewStack.selectedIndex=this.tab.selectedIndex=0,this.updateData()},e.prototype.onTabTouch=function(t){this.updateData()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateData=function(){if(this.panelArr[this.tab.selectedIndex]==this.longzhuPanel){var t=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,e=DataCenter.ins().Amusement13Config[t],i=[],n=[];for(var o in e)i.push(e[o]);i.reverse();for(var o in i)n.push({gift:i[o].showReward[0].id,reward:i[o].award});this.list0.dataProvider=new eui.ArrayCollection(n)}else this.panelArr[this.tab.selectedIndex]==this.xunbaoPanel&&(this.rewardList1.dataProvider=new eui.ArrayCollection(DataCenter.ins().Amusement18Config[this.activityID][0].showDrop))},e}(BaseEuiView);__reflect(AmuseTarget18Panel2TipsView.prototype,"AmuseTarget18Panel2TipsView");var AmuseTarget18Panel3=function(t){function e(e){var i=t.call(this)||this;return i.huntType=1,i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget18Panel3Skin"},e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){for(var t,e=DataCenter.ins().Amusement18Config[this.activityID],i=e[0],n=i.showDrop.length,o=0;n>o&&16>o;o++)t=this["gift"+o],t.data=i.showDrop[o],1>=o&&t.setItemHeirloomBgImg(!0,"csbk03");this.list.itemRenderer=TreasureHuntListItemRenderer,this.list.touchChildren=!1,this.list.touchEnabled=!0,this.jpList.itemRenderer=TreasureHuntListItemRenderer;for(var s in e)1==e[s].count?this.yb1.text=e[s].yb+"":10==e[s].count?this.yb10.text=e[s].yb+"":100==e[s].count&&(this.yb100.text=e[s].yb+"")},e.prototype.open=function(){this.addEventTouchTap(this,this.onBuy),this.addCustomEvent(395,this.updateData),this.timeClock(),TimerMgr.ins().remove(this.timeClock,this),TimerMgr.ins().doTimer(1e3,0,this.timeClock,this),this.hasData||(this.hasData=!0,amusementControl.upChangePage(this.activityID))},e.prototype.close=function(){this.removeEventTouchTap(this,this.onBuy),this.removeCustomEvents(),TimerMgr.ins().remove(this.timeClock,this),this.hasData=!1},e.prototype.updateData=function(){this.listRefush(),this.updateMaterial()},e.prototype.timeClock=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.endedTime=t.getLeftTime(),this.leftTimeTxt.text=""+this.endedTime)},e.prototype.listRefush=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.list.dataProvider=new eui.ArrayCollection(t.logs),this.jpList.dataProvider=new eui.ArrayCollection(t.bestlogs))},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(1);break;case this.buy10:this.buyHunt(2);break;case this.buy100:this.buyHunt(3);break;case this.list:UIMgr.ins().open(TreasureLogView,this.list.dataProvider?this.list.dataProvider.source:null)}},e.prototype.buyHunt=function(t){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);this.huntType=t;var e=DataCenter.ins().Amusement18Config[this.activityID],i=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e[t].item);if(i)amusementControl.upReward(this.activityID,t);else{var n=e[t].count,o=e[t].yb;TreasureHuntWarnBuyView.showBuyWarn("AmuseTarget18Panel3-HuntResultWin"+(t-1),this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",o,DataCenter.ins().ItemConfig[e[t].item].name,n))}},e.prototype.huntWarnFun=function(){var t=DataCenter.ins().Amusement18Config[this.activityID][this.huntType].yb;ActorControl.yb>=t?amusementControl.upReward(this.activityID,this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.updateMaterial=function(){var t=backpackControl.getBagGoodsCountById(0,DataCenter.ins().Amusement18Config[this.activityID][1].item);this.num.textFlow=TextUtils.generateTextFlow1("|C:"+(t?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+t+"|"),this.num10.textFlow=TextUtils.generateTextFlow1("|C:"+(t>=10?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+t+"|"),this.num100.textFlow=TextUtils.generateTextFlow1("|C:"+(t>=100?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+t+"|")
},e}(BasePanel);__reflect(AmuseTarget18Panel3.prototype,"AmuseTarget18Panel3");var AmuseTarget18Panel4=function(t){function e(e){var i=t.call(this)||this;return i.equipPos=[],i.equipItems=[],i.slot=0,i.aniTags=[],i.beginPoint=0,i.canDoList=[],i.huntType=1,i.first=!0,i.sendBuyType=0,i.mcArr=["chuanshishenqi2","chuanshishenqi4","chuanshishenqi5","chuanshishenqi7","chuanshishenqi8","chuanshishenqi9","chuanshishenqi11"],i.activityID=e,i.skinName="AmuseTarget18Panel4Skin",i}return __extends(e,t),e.prototype.init=function(){var t=DataCenter.ins().Amusement18Config[this.activityID];this.list0.itemRenderer=TreasureHuntListItemRenderer;for(var e in t)1==t[e].count?this.yb1.text=t[e].yb+"":10==t[e].count&&(this.yb10.text=t[e].yb+"");if(this.first)for(var i=0;8>i;i++)this["equip"+i]&&(this["equip"+i].name=i+"",this.equipPos[i]?(this["equip"+i].x=this.equipPos[i].x,this["equip"+i].y=this.equipPos[i].y):(this.equipPos[i]=new EquipPosAniVo(this["equip"+i].x,this["equip"+i].y,this["equip"+i].scaleX,this["equip"+i].scaleY),this.equipItems[i]=this["equip"+i],this.equipItems[i].x=this["equip"+i].x,this.equipItems[i].y=this["equip"+i].y,this.addEventTouchTap(this["equip"+i],this.onClick)))},e.prototype.open=function(){this.init(),this.addEventTouchTap(this.buy1,this.onBuy),this.addEventTouchTap(this.buy10,this.onBuy),this.addEventTouchTap(this.help,this.onBuy),this.addEventTouchTap(this.showbigEquip.clickBtn,this.onBuy),this.addEventTouchTap(this.rightBtn,this.onClickItemRotFun),this.addEventTouchTap(this.leftBtn,this.onClickItemRotFun),this.addEventTouchTap(this.getItemTxt,this.onBuy),this.addCustomEvent(393,this.RewardResult),this.rewardList.itemRenderer=ItemBaseNoName,this.timeClock(),TimerMgr.ins().isExists(this.timeClock,this)||TimerMgr.ins().doTimer(1e3,0,this.timeClock,this),this.updateData(),this.updateData2(),this.updateShowbigEquip(),this.updataEquipBtnRedPoint(this.first),this.first=!1},e.prototype.close=function(){TimerMgr.ins().remove(this.timeClock,this)},e.prototype.updateData=function(){this.updateMaterial()},e.prototype.updateData2=function(){this.listRefush();var t=DataCenter.ins().Amusement18Config[this.activityID][0],e=t.relateActivityId;DataCenter.ins().Amusement13Config[e];null==this.rewardList.dataProvider?this.rewardList.dataProvider=new eui.ArrayCollection(t.showDrop.concat()):this.rewardList.dataProvider.replaceAll(t.showDrop.concat()),this.rewardList.validateNow()},e.prototype.RewardResult=function(t){if(this.activityID!=t){var e=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId;if(t!=e)return}this.updateData(),this.updateData2(),this.updateShowbigEquip(),this.updataEquipBtnRedPoint()},e.prototype.listRefush=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.list0.dataProvider=new eui.ArrayCollection(t.logs))},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(1),this.sendBuyType=0;break;case this.buy10:this.buyHunt(2),this.sendBuyType=1;break;case this.help:HelpControl.openHelpWin(53);break;case this.getItemTxt:UIMgr.ins().open(AmuseTarget18Panel2TipsView,this.activityID);break;case this.showbigEquip.clickBtn:var e=amusementControl.getAmusementDataById(this.activityID);if(!e)return;var i=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,n=(DataCenter.ins().Amusement13Config[i],this.showbigEquip.data.index+1),o=amusementControl.getAmusementDataById(i);if(!o)return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));if(o.proReward[n])return void tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet"));this.showbigEquip.data.count&&o.proCount[n]/DataCenter.ins().Amusement13Config[i][n].count>=1?UIMgr.ins().open(TreasureHuntSelectView,i,n):UIMgr.ins().open(AmuseTarget18Panel2TipsView,this.activityID)}},e.prototype.buyHunt=function(t){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);this.huntType=t;var e=DataCenter.ins().Amusement18Config[this.activityID],i=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e[t].item);if(i)amusementControl.upReward(this.activityID,t);else{var n=t>1?10:1,o=e[t].yb;TreasureHuntWarnBuyView.showBuyWarn("AmuseTarget18Panel2-HuntResultWin"+(10==n?1:0),this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",o,DataCenter.ins().ItemConfig[e[t].item].name,n))}},e.prototype.huntWarnFun=function(){var t=DataCenter.ins().Amusement18Config[this.activityID],e=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t[this.huntType].item);if(e)amusementControl.upReward(this.activityID,this.huntType);else{var i=DataCenter.ins().Amusement18Config[this.activityID][this.huntType].yb;ActorControl.yb>=i?amusementControl.upReward(this.activityID,this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))}},e.prototype.updateMaterial=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];this.actInfo1.text=t.desc;var e=backpackControl.getBagGoodsCountById(0,DataCenter.ins().Amusement18Config[this.activityID][1].item);this.num1.textFlow=TextUtils.generateTextFlow1("|C:"+(e?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|"),this.num10.textFlow=TextUtils.generateTextFlow1("|C:"+(e>=10?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|");var i=DataCenter.ins().Amusement18Config[this.activityID];this.icon1.source=DataCenter.ins().ItemConfig[i[1].item].icon+"_png",this.icon10.source=DataCenter.ins().ItemConfig[i[2].item].icon+"_png",this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text)},e.prototype.updataEquipBtnRedPoint=function(t){for(var e=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,i=amusementControl.getAmusementDataById(e),n=!1,o=0;8>o;o++)if(this["equip"+o]){var s=o+1,r=i.proCount[s],a=DataCenter.ins().Amusement13Config[e][s],l=a.count;if(s>1&&!i.proReward[s-1])r=0;else{var h=a.nextProgress?a.nextProgress/1e4:0;r=l*h+r*(1-h)}var u=r/l,p=i.proReward[s],c=u>=1&&!p;this["equip"+o].redPoint.visible=c,t&&(c&&!n?(this.slot=o,n=!0):r&&l>r&&(this.slot=o))}t&&this.slot&&this.playEquipsAni()},e.prototype.updateShowbigEquip=function(){var t=this.slot+1,e=amusementControl.getAmusementDataById(this.activityID);if(e){var i=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId,n=amusementControl.getAmusementDataById(i),o=DataCenter.ins().Amusement13Config[i][t];if(n&&o){var s=n.proCount[t],r=o.count;if(t>1&&!n.proReward[t-1])s=0;else{var a=o.nextProgress?o.nextProgress/1e4:0;s=r*a+s*(1-a)}this.showbigEquip.data={count:s,maxcount:r,isget:n.proReward[t],index:this.slot,mcstr:this.mcArr[this.slot]}}}},e.prototype.timeClock=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.endedTime=t.getLeftTime(),this.actTime1.text=DateUtils.getFormatBySecond(this.endedTime,DateUtils.TIME_FORMAT_5,3))},e.prototype.onClickItemRotFun=function(t){switch(t.currentTarget){case this.sp:tipsControl.showCenterTips(LangMgr.getValueByKey("thunderSuit1"));break;case this.leftBtn:this.slot++,this.slot>7&&(this.slot=0),this.playEquipsAni();break;case this.rightBtn:this.slot--,this.slot<0&&(this.slot=7),this.playEquipsAni()}},e.prototype.onClick=function(t){if(!this.getTags())for(var e=0;8>e;e++)if(this["equip"+e]&&t.currentTarget==this["equip"+e]&&this.slot!=e){this.slot=e,this.playEquipsAni();break}},e.prototype.calcEquipItemSortData=function(){for(var t=0,e=0,i=0;i<this.equipItems.length;i++)if(this["equip"+this.slot]==this.equipItems[i]){e=i;break}var n=e;return e>this.equipItems.length/2&&(t=1),t&&(n=this.equipItems.length-e),[t,n]},e.prototype.playEquipsAni=function(){if(!this.getTags()){for(var t=this.calcEquipItemSortData(),e=t[0],i=t[1],n=[],o=0;o<this.equipItems.length;o++)n.push(this.equipItems[o]);for(var o=0;i>o;o++)if(e){var s=this.equipItems.pop();this.equipItems.unshift(s)}else{var s=this.equipItems.shift();this.equipItems.push(s)}for(var r=[],o=0;o<n.length;o++){r[o]=[];for(var a=o,l=0;i>l;l++)e?a+=1:a-=1,a>=this.equipPos.length?a=0:0>a&&(a=this.equipPos.length-1),r[o].push(new EquipPosAniVo(this.equipPos[a].x,this.equipPos[a].y,this.equipPos[a].scaleX,this.equipPos[a].scaleY)),this.equipUps.swapChildren(n[o],n[a])}for(var o=0;o<r.length;o++)this.aniTags[o]=!0,this.action(n[o],r[o],o);this.addSp(),TimerMgr.ins().isExists(this.aniTime,this)||TimerMgr.ins().doTimer(100,0,this.aniTime,this)}},e.prototype.getTags=function(){for(var t=0;t<this.aniTags.length;t++)if(this.aniTags[t])return!0;return!1},e.prototype.aniTime=function(){this.getTags()||(TimerMgr.ins().remove(this.aniTime,this),this.updateShowbigEquip(),this.cleanSp())},e.prototype.addSp=function(){this.sp||(this.sp=new eui.Group,this.sp.x=0,this.sp.y=0,this.sp.width=StageUtils.ins().getStage().width,this.sp.height=StageUtils.ins().getStage().height,this.sp.touchEnabled=!0),this.sp.parent||(StageUtils.ins().getStage().addChild(this.sp),this.addEventTouchTap(this.sp,this.onClickItemRotFun))},e.prototype.cleanSp=function(){this.removeEventTouchTap(this.sp,this.onClickItemRotFun),DisplayUtils.removeFromParent(this.sp)},e.prototype.action=function(t,e,i){var n=this;if(!e.length)return void(this.aniTags[i]=!1);var o=e.shift(),s=egret.Tween.get(t);s.to({x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY},500).call(function(){egret.Tween.removeTweens(t),n.action(t,e,i)})},e}(BasePanel);__reflect(AmuseTarget18Panel4.prototype,"AmuseTarget18Panel4");var AmuseTarget19NestedPanel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget19NestedPanel1Skin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.maskGroup,this.onClick),this.addCustomEvent(392,this.updateData),this.activityID=t[0],amusementControl.upChangePage(this.activityID)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.maskGroup:if(this.state==AmusementControl.CanGet)amusementControl.upReward(this.activityID,this.index);else{var e=DataCenter.ins().Amusement1Config[this.activityID][this.index],i=0;switch(e.showType){case 100:var n=amusementControl.getAmusementDataById(this.activityID);n.hFTotalConsumption<e.consumeYuanbao&&(i=e.consumeYuanbao-n.hFTotalConsumption)}if(!i)return void amusementControl.upReward(this.activityID,this.index);100==e.showType&&tipsControl.showTips(LangMgr.getValueByKey("osaConsumeAfterGet",i))}}},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID);if(t){if(!t.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("osaSverError"));var e=DataCenter.ins().Amusement1Config[this.activityID];this.index=this.getRuleIndex(),this.reward.data=e[this.index].rewards[0],this.reward.setImgBg1(),this.reward.hideName(),this.reward.clearEffect(),this.reward.showNum(!1),this.cost.text=t.hFTotalConsumption+"",this.target.text="/"+e[this.index].consumeYuanbao}},e.prototype.getRuleIndex=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement1Config[this.activityID],i=1;for(var n in e){var o=e[n];t.getRewardStateById(o.index);var s=t.getRewardStateById(o.index),r=t.rewardsSum[o.index],a=o.total?o.total-r:1;switch(this.state=s,i=o.index,s){case AmusementControl.NotReached:break;case AmusementControl.CanGet:0>=a?this.state=AmusementControl.NotReached:this.state=AmusementControl.CanGet;break;case AmusementControl.Geted:}if(this.state==AmusementControl.CanGet){this.currentState="can";break}if(this.state==AmusementControl.NotReached){this.currentState="cannot";break}}return this.state==AmusementControl.Geted&&(this.currentState="already"),this.validateNow(),i},e}(BasePanel);__reflect(AmuseTarget19NestedPanel1.prototype,"AmuseTarget19NestedPanel1");var AmuseTarget19Panel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget19Panel1Skin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.panelArr&&this.panelArr[this.curSelectIndex].close(),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addCustomEvent(392,this.updateRedPoint);var i=DataCenter.ins().Amusement19Config[this.activityID][1];this.amuseTarget1Panel.activityType=0,this.amuseTarget1Panel.activityID=i.activityID,this.panelArr=[this.strideServerRankPanel,this.amuseTarget1Panel,this.strideServerCostRewardPanel],this.setSelectedIndex(0),this.updateRedPoint()},e.prototype.onTabTouch=function(t){this.panelArr&&this.panelArr[this.curSelectIndex].close();var e=t.currentTarget.selectedIndex;this.setSelectedIndex(e)},e.prototype.setSelectedIndex=function(t){this.curSelectIndex=t,this.panelArr&&this.panelArr[t].open(this.activityID),this.viewStack.selectedIndex=t},e.prototype.updateRedPoint=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this.redPoint1.visible=t.canReward())},e}(BasePanel);__reflect(AmuseTarget19Panel1.prototype,"AmuseTarget19Panel1");var AmuseTarget1Panel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t;0==this.activityType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.activityType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget1PanelSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.content.itemRenderer=AmuseTarget1PanelItemRender,0==this.activityType?this.addCustomEvent(393,this.GetCallBack):1==this.activityType&&this.addCustomEvent(438,this.GetCallBack),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData()},e.prototype.setTime=function(){var t,e;0==this.activityType?(t=AmusementControl.ins(),e=t.getAmusementDataById(this.activityID)):1==this.activityType&&(t=PAmusementControl.ins(),e=t.getAmusementDataById(this.activityID)),e&&(this._time=e.getLeftTime(),this.actTime0.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.GetCallBack=function(t){if(this.activityID==t){var e,i;0==this.activityType?(e=AmusementControl.ins(),i=e.getAmusementDataById(this.activityID)):1==this.activityType&&(e=PAmusementControl.ins(),i=e.getAmusementDataById(this.activityID)),e.isSuccee||(backpackControl.getSurplusCount()?(tipsControl.showTips(LangMgr.getValueByKey("getFaile")),e.upChangePage(i.id)):tipsControl.showTips(LangMgr.getValueByKey("osaBackNoSpace"))),e.isSuccee=!1,this.updateData()}},e.prototype.updateData=function(){this.listData||(this.listData=new ArrayCollection,this.content.dataProvider=this.listData);var t,e,i,n;0==this.activityType?(t=AmusementControl.ins(),e=t.getAmusementDataById(this.activityID),i=DataCenter.ins().Amusement1Config[e.id],n=DataCenter.ins().AmusementConfig):1==this.activityType&&(t=PAmusementControl.ins(),e=t.getAmusementDataById(this.activityID),i=DataCenter.ins().PAmusementType1Config[e.id],n=DataCenter.ins().PAmusementConfig);var o=Math.floor((DateUtils.formatMiniDateTime(e.startTime)-GameServer.serverTime)/1e3),s=Math.floor((DateUtils.formatMiniDateTime(e.endTime)-GameServer.serverTime)/1e3);o>=0?this.actTime0.text=LangMgr.getValueByKey("doubleNoActivity"):0>=s?this.actTime0.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=s,this._time<0&&(this._time=0),this.actTime0.text=DateUtils.getFormatBySecond(s,DateUtils.TIME_FORMAT_5,3)),this.actInfo0.text=n[this.activityID].desc;var r=[];for(var a in i)r.push(i[a]);r=r.slice();for(var l=[],h=[],u=0;u<r.length;u++){var p=e.getRewardStateById(r[u].index);p==AmusementControl.Geted?h.push(r[u]):l.push(r[u])}if(0==r[0].showType){var c=[],d=[];d=this.sortLevelList(l),c=this.sortLevelList(h),r=d.concat(c),this.listData.replaceAll(r)}else l.sort(this.sortFunc),h.sort(this.sortFunc),r=l.concat(h),this.listData.replaceAll(r);var g=t.getbtnInfo(this.activityID.toString());this.title.source=g.title,this.setDesc(e)},e.prototype.setDesc=function(t){var e;0==this.activityType?e=DataCenter.ins().Amusement1Config[t.id][1]:1==this.activityType&&(e=DataCenter.ins().PAmusementType1Config[t.id][1]);var i="",n="";switch(e.showType){case 0:i=LangMgr.getValueByKey("osaMyLevel"),e.zslevel&&(n+=LangMgr.getValueByKey("numberRotation",reincarnateControl.lv)),e.level&&(n+=LangMgr.getValueByKey("numberLevel",ActorControl.level));break;case 1:i=LangMgr.getValueByKey("osaLevelType1"),n=FeatherVo.getWingAllLevel()+"";break;case 2:i=LangMgr.getValueByKey("osaLevelType2"),n=RoleModel.getIntensifyTotalLvByType(2)+"";break;case 3:i=LangMgr.getValueByKey("osaLevelType3"),n=DragonSoulDataVo.getLongHunAllLevel()+"";break;case 5:var o=bookControl.getBookPowerNumEx();i=LangMgr.getValueByKey("osaLevelType4"),n=o+"";break;case 6:i=LangMgr.getValueByKey("osaLevelType5"),n=backpackControl.getEquipsScoreByRolesOfBody()+"";break;case 100:i=LangMgr.getValueByKey("osaLevelType6"),n=t.hFTotalConsumption+"";break;case 7:i=LangMgr.getValueByKey("osaLevelType7");var s=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID),r=superRingControl.getRingStair(s.level),a=superRingControl.getRingStar(s.level);n=r+LangMgr.getValueByKey("osaLevelJ")+a+LangMgr.getValueByKey("roleStart");break;case 8:i=LangMgr.getValueByKey("osaLevelType8");var l=reincarnationControl.getSamsara(ActorControl.samsaraLv),h=reincarnationControl.getSamsaraLv(ActorControl.samsaraLv);n=ActorControl.samsaraLv+" "+reincarnationControl.getSamsaraDesc(l)+"·"+reincarnationControl.getSamsaraLvDesc(h);break;case 9:i=LangMgr.getValueByKey("osaLevelType9");var u=ashtarteControl.getZhanLingDataByLevel(0);n=Math.ceil(u/10)+LangMgr.getValueByKey("osaLevelJ")+(u%10==0?u?10:0:u%10)+LangMgr.getValueByKey("roleStart");break;case 10:i=LangMgr.getValueByKey("lvAct0"),n=LangMgr.getValueByKey("osaTimes",magicCircleControl.getPotentionTimes());break;case 11:i=LangMgr.getValueByKey("lvAct1"),n=LangMgr.getValueByKey("numberLevel",crazybtplayControl.getStrengthenLvAll());break;case 12:i=LangMgr.getValueByKey("lvAct2"),n=ActorControl.power+"";break;case 13:i=LangMgr.getValueByKey("lvAct3"),n=dominateEquipControl.getTotalScore()+"";break;case 14:i=LangMgr.getValueByKey("lvAct4"),n=""+runeControl.totalPower;break;case 15:i=LangMgr.getValueByKey("lvAct5"),n=""+superRingControl.totalPower}this.attr.text=i,this.myAttrValue.text=n},e.prototype.sortLevelList=function(t){for(var e=[],i=[],n=[],o=0;o<t.length;o++)t[o].zslevel?n.push(t[o]):i.push(t[o]);return i.sort(this.sortFunc),n.sort(this.sortFunc),e=i.concat(n)},e.prototype.sortFunc=function(t,e){var i;i=DataCenter.ins().PAmusementBtnConfig[t.Id]?pAmusementControl.getAmusementDataById(t.Id):amusementControl.getAmusementDataById(t.Id);i.getRewardStateById(t.index),i.getRewardStateById(e.index);if(0==t.showType){if(t.zslevel<e.zslevel)return-1;if(t.zslevel>e.zslevel)return 1;if(t.level<e.level)return-1;if(t.level>e.level)return 1}if(1==t.showType){if(t.wingLv<e.wingLv)return-1;if(t.wingLv>e.wingLv)return 1}if(2==t.showType){if(t.zzLv<e.zzLv)return-1;if(t.zzLv>e.zzLv)return 1}if(3==t.showType){if(t.lhLv<e.lhLv)return-1;if(t.lhLv>e.lhLv)return 1}if(5==t.showType){if(t.tjPower<e.tjPower)return-1;if(t.tjPower>e.tjPower)return 1}if(6==t.showType){if(t.equipPower<e.equipPower)return-1;if(t.equipPower>e.equipPower)return 1}if(100==t.showType){if(t.consumeYuanbao<e.consumeYuanbao)return-1;if(t.consumeYuanbao>e.consumeYuanbao)return 1}if(8==t.showType){if(t.lunhLv<e.lunhLv)return-1;if(t.lunhLv>e.lunhLv)return 1}if(9==t.showType){if(t.zhanlingLv<e.zhanlingLv)return-1;if(t.zhanlingLv>e.zhanlingLv)return 1}if(10==t.showType){if(t.skillCount<e.skillCount)return-1;if(t.skillCount>e.skillCount)return 1}if(11==t.showType){if(t.shenwuLv<e.shenwuLv)return-1;if(t.shenwuLv>e.shenwuLv)return 1}if(12==t.showType){if(t.power<e.power)return-1;if(t.power>e.power)return 1}if(13==t.showType){if(t.zhuzaiScore<e.zhuzaiScore)return-1;if(t.zhuzaiScore>e.zhuzaiScore)return 1}if(14==t.showType){if(t.fuwenPower<e.fuwenPower)return-1;if(t.fuwenPower>e.fuwenPower)return 1}if(15==t.showType){if(t.aexringPower<e.aexringPower)return-1;if(t.aexringPower>e.aexringPower)return 1}return 0},e}(AmusementPanel);__reflect(AmuseTarget1Panel.prototype,"AmuseTarget1Panel");var AmuseTarget20Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget20PanelSkin",e}return __extends(e,t),e.prototype.close=function(){this.removeEventTouchTap(this.goBtn,this.onTap),TimerMgr.ins().remove(this.setTime,this)},e.prototype.open=function(){this.addEventTouchTap(this.goBtn,this.onTap),this.initData(),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.initData=function(){this.rewardList.itemRenderer=ItemBase,this.updateData()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.goBtn:var e=amusementControl.getAmusementDataById(this.activityID);if(e.IsEnd())return void tipsControl.showTips(LangMgr.getValueByKey("osaAcea"));e.go2BossFb()?amusementControl.upReward(this.activityID,e.index):tipsControl.showTips(LangMgr.getValueByKey("osaNoTime"))}},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(DateUtils.formatMiniDateTime(t.startTime)/DateUtils.MS_PER_SECOND-GameServer.serverTime/DateUtils.MS_PER_SECOND),i=Math.floor(DateUtils.formatMiniDateTime(t.endTime)/DateUtils.MS_PER_SECOND-GameServer.serverTime/DateUtils.MS_PER_SECOND);e>=0?(this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"),this.readyTime=0):0>=i?(this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"),this.readyTime=0):(this._time=i,this._time<0&&(this._time=0),this.readyTime=t.getStartTimer(),this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3));var n=DataCenter.ins().AmusementConfig[this.activityID];this.actDesc.textFlow=TextUtils.generateTextFlow1(n.desc),this.redPoint.visible=t.checkRedPoint();var o=DataCenter.ins().Amusement20Config[this.activityID][t.index];o&&(this.rewardList.dataProvider=new eui.ArrayCollection(o.showReward)),this.playModel(),this.setDate()},e.prototype.setDate=function(){var t=amusementControl.getAmusementDataById(this.activityID);if(t.IsEnd())return void(this.time.text=LangMgr.getValueByKey("osaTodayKillAll"));var e=Math.floor(GameServer.serverTime/DateUtils.MS_PER_SECOND),i=t.getEndTimer();if(e>=i)return void(this.time.text=LangMgr.getValueByKey("osaEnd"));var n=t.getStartTimer();if(e>=n&&i>e)return void(this.time.text=LangMgr.getValueByKey("osaBossActivit"));var o=DataCenter.ins().Amusement20Config[this.activityID][t.index],s=DataCenter.ins().MonstersConfig[o.monsterId.id],r=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_6);this.time.text=LangMgr.getValueByKey("osaShow2",s.name,r)},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.playModel=function(){this.bossModel||(this.bossModel=new GameMovieClip),this.bossModel.parent||this.Boss.addChild(this.bossModel);var t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement20Config[this.activityID][t.index];e&&(this.bossModel.playFile(PATH_GUAIWU+e.monsterId.monster,-1),this.bossModel.scaleX=this.bossModel.scaleY=e.monsterId.scale/100)},e}(AmusementPanel);__reflect(AmuseTarget20Panel.prototype,"AmuseTarget20Panel");var AmuseTarget21Panel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this),TimerMgr.ins().remove(this.setTime,this)},e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget21PanelSkin",this.show1&&(this.show1.source="wing100_png")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.rewardList.itemRenderer=ItemBase,this.updateData(),this.updateUI(),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.updateData=function(){var t=DataCenter.ins().AmusementBtnConfig[this.activityID];t.showReward&&(this.rewardList.dataProvider=new eui.ArrayCollection(t.showReward))},e.prototype.updateUI=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(DateUtils.formatMiniDateTime(t.startTime)/DateUtils.MS_PER_SECOND-GameServer.serverTime/DateUtils.MS_PER_SECOND),i=Math.floor(DateUtils.formatMiniDateTime(t.endTime)/DateUtils.MS_PER_SECOND-GameServer.serverTime/DateUtils.MS_PER_SECOND);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=i,this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3));var n=DataCenter.ins().AmusementConfig[this.activityID];this.actDesc.text=n.desc;var o=DataCenter.ins().AmusementBtnConfig[this.activityID];o&&(this.title.source=o.title)},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e}(AmusementPanel);__reflect(AmuseTarget21Panel.prototype,"AmuseTarget21Panel");var AmuseTarget22Panel1=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget22Panel1Skin"},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.goodsOverView.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.goodsOverView.text),this.listView.itemRenderer=SpringBeginStoreItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().AmusementConfig[this.activityID];this.actInfo0.text=i.desc,this.addCustomEvent(392,this.updateData),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addCustomEvent(268,this.updateMaterial),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this,this.onTouch),this.currentState="activityStore",this.updateData(),this.updateMaterial()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.updateMaterial=function(){var t=backpackControl.getBagItemById(DataCenter.ins().Amusement22_1Config[this.activityID][1].freshItem),e=t?t.count:0;if(this.refreshItemNum.textFlow=TextUtils.generateTextFlow("|C:"+(e?LangMgr.getColor("color43"):LangMgr.getColor("color22"))+"&T:"+e),this._isEnough=e>0,"activityStore"==this.currentState){var i=amusementControl.activityData[this.activityID];this.redPoint1.visible=i.refreshFree||this._isEnough}},e.prototype.updateData=function(){this._collect||(this._collect=new ArrayCollection,this.listView.dataProvider=this._collect);for(var t=amusementControl.activityData[this.activityID],e=[],i="activityStore"==this.currentState?t.shopItems:t.scoreItems,n=i?i.length:0,o=0;n>o;o++)e.push({data:i[o],isScore:"integralStore"==this.currentState,activityID:this.activityID});if(this._collect.source=e,"activityStore"==this.currentState){this.costGroup.visible=!t.refreshFree,this.price.text=DataCenter.ins().Amusement22_1Config[this.activityID][1].freshPrice+"",this.refreshShopBtn.label=t.refreshFree?LangMgr.getValueByKey("osaFreeUpdate"):LangMgr.getValueByKey("osaUpdate"),this.redPoint1.visible=t.refreshFree||this._isEnough;var s=amusementControl.getConfig22_3(this.activityID);this.redPoint0.visible=s&&t.tScore>=s.score}this.integralNum.text=t.tScore+"";var r=DataCenter.ins().ItemConfig[DataCenter.ins().Amusement22_1Config[this.activityID][1].freshItem];this.refreshItem.source=r?r.icon+"_png":""},e.prototype.onTouch=function(t){switch(t.target){case this.goodsOverView:UIMgr.ins().open(SpringBeginStoreRewardShowView,this.activityID);break;case this.integralStoreBtn:this.currentState="integralStore"==this.currentState?"activityStore":"integralStore",this.updateData();break;case this.refreshShopBtn:var e=amusementControl.activityData[this.activityID];e.refreshFree?amusementControl.upReward(this.activityID,0,5,"0"):ActorControl.yb<DataCenter.ins().Amusement22_1Config[this.activityID][1].freshPrice&&!this._isEnough?tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):amusementControl.upReward(this.activityID,0,5,"0")}},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID];this.actTime0.text=t.getRemainTime();var e=t.getRefreshTime();this.refreshTime.text=DateUtils.getFormatBySecond(e>0?e:0,DateUtils.TIME_FORMAT_1,5)},e}(BasePanel);__reflect(AmuseTarget22Panel1.prototype,"AmuseTarget22Panel1");var AmuseTarget22Panel2=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget22Panel2Skin"},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.listView.itemRenderer=VersionCeleStoreItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(392,this.updateData),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addCustomEvent(268,this.updateMaterial),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this,this.onTouch),this.updateData(),this.updateMaterial(),this.setTime(),this.visible=!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents(),TimerMgr.ins().removeAll(this),this.objList){for(var i=void 0,n=0;n<this.objList.length;n++)i=this.objList.shift(),egret.Tween.removeTweens(i),DisplayUtils.removeFromParent(i);this.objList=null}},e.prototype.updateData=function(){this._collect||(this._collect=new ArrayCollection,this.listView.dataProvider=this._collect);for(var t=amusementControl.activityData[this.activityID],e=[],i=t.shopItems,n=i?i.length:0,o=0;n>o;o++)e.push({data:i[o],activityID:this.activityID});this.noGoods.visible=!e||!e.length,this._collect.source=e,this.redPoint.visible=t.refreshFree,this.refresh.visible=this.priceTxt.visible=this.moneyIcon.visible=!t.refreshFree;var s=DataCenter.ins().Amusement22_1Config[this.activityID][1];this.priceTxt.text=s.freshPrice+"",this.refreshFree.visible=t.refreshFree,this.icon.source=DataCenter.ins().ItemConfig[s.costItem].icon+"_png",i=t.limitItems,n=i?i.length:0;for(var r,a,o=0;5>o;o++)a=this["itemShow"+o],n-1>=o?(r=i[o],a.visible=!0,a.update({itemID:r.itemID,max:r.buyMax,buy:r.buyCount})):a.visible=!1},e.prototype.updateMaterial=function(){var t=backpackControl.getBagItemById(DataCenter.ins().Amusement22_1Config[this.activityID][1].costItem),e=t?t.count:0;this.point.text="X"+e,this.point.textColor=e?65280:16711680},e.prototype.onTouch=function(t){switch(t.target){case this.refreshShopBtn:var e=amusementControl.activityData[this.activityID];if(e.refreshFree)amusementControl.upReward(this.activityID,0,5,"0");else{var i=DataCenter.ins().Amusement22_1Config[this.activityID][1].freshPrice;ActorControl.yb<i?tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):(amusementControl.upReward(this.activityID,0,5,"0"),this.flyRMB(i))}}},e.prototype.flyRMB=function(t){var e=this;this.objList||(this.objList=[]);var i=new eui.BitmapLabel;
i.font="num_2_fnt",i.y=-10,i.x=460,i.scaleX=i.scaleY=1.5,i.text="-"+t,this.addChild(i),this.objList.push(i),egret.Tween.get(i).to({y:i.y+50},1e3).call(function(){DisplayUtils.removeFromParent(i),e.objList.shift()})},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID],e=t.getRefreshTime();this.refreshTime.text=DateUtils.getFormatBySecond(e>0?e:0,DateUtils.TIME_FORMAT_1,5),this.refreshTime.visible=this.refreshTip.visible=e>0},e}(BasePanel);__reflect(AmuseTarget22Panel2.prototype,"AmuseTarget22Panel2");var AmuseTarget25Panel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t;0==this.activityType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.activityType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t&&t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget25PanelSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.content.itemRenderer=AmuseTarget25PanelItemRenderer,0==this.activityType?this.addCustomEvent(393,this.GetCallBack):1==this.activityType&&this.addCustomEvent(438,this.GetCallBack),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.GetCallBack=function(t){if(this.activityID==t){var e=AmusementControl.ins(),i=e.getAmusementDataById(this.activityID);e.isSuccee||(backpackControl.getSurplusCount()?(tipsControl.showTips(LangMgr.getValueByKey("getFaile")),e.upChangePage(i.id)):tipsControl.showTips(LangMgr.getValueByKey("osaBackNoSpace"))),e.isSuccee=!1,this.updateData()}},e.prototype.updateData=function(){this.listData||(this.listData=new ArrayCollection,this.content.dataProvider=this.listData);var t=AmusementControl.ins(),e=t.getAmusementDataById(this.activityID),i=DataCenter.ins().Amusement25Config[e.id],n=DataCenter.ins().AmusementConfig;this.actInfo0.text=n[this.activityID].desc;var o=[];for(var s in i)o.push(i[s]);o=o.slice();for(var r=[],a=[],l=0;l<o.length;l++){var h=e.getRewardStateById(o[l].index);h==AmusementControl.Geted?a.push(o[l]):r.push(o[l])}r.sort(this.sortFunc),a.sort(this.sortFunc),o=r.concat(a),this.listData.replaceAll(o);var u=t.getbtnInfo(this.activityID.toString());this.title.source=u.title},e.prototype.sortFunc=function(t,e){var i=amusementControl.getAmusementDataById(t.Id),n=i.getRewardStateById(t.index),o=i.getRewardStateById(e.index);return o>n?-1:n>o?1:0},e}(AmusementPanel);__reflect(AmuseTarget25Panel.prototype,"AmuseTarget25Panel");var AmuseTarget2Panel1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.gift.itemRenderer=AmuseTarget2Panel1ItemRender},e.prototype.setCurSkin=function(){var t;0==this.activityType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.activityType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget2Panel1Skin"},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t,this.activityType=AmusementPanel.getAmusementTypeFromId(this._activityID),this.setCurSkin()},enumerable:!0,configurable:!0}),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.addCustomEvent(393,this.GetCallBack),this.addCustomEvent(438,this.GetCallBack),TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.dataArr||(this.dataArr=new eui.ArrayCollection,this.gift.dataProvider=this.dataArr),this.updateData()},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this),this.removeCustomEvents()},e.prototype.GetCallBack=function(t){this.updateData()},e.prototype.updateData=function(){var t,e,i;0==this.activityType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID],i=DataCenter.ins().Amusement2Config[this.activityID]):1==this.activityType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID],i=DataCenter.ins().PAmusement2Config[this.activityID]);var n=Math.floor((DateUtils.formatMiniDateTime(t.startTime)-GameServer.serverTime)/1e3),o=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);n>=0?this.actTime1.text=LangMgr.getValueByKey("doubleNoActivity"):0>=o?this.actTime1.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=o,this._time<0&&(this._time=0),this.actTime1.text=DateUtils.getFormatBySecond(o,DateUtils.TIME_FORMAT_5,3)),this.actDesc.text=e.desc;var s=[];for(var r in i)s.push([this.activityType,i[r]]);this.dataArr.replaceAll(s)},__decorate([callDelay(100)],e.prototype,"open",null),e}(BasePanel);__reflect(AmuseTarget2Panel1.prototype,"AmuseTarget2Panel1");var AmuseTarget2Panel12=function(t){function e(){var e=t.call(this)||this;return e.actIdx=1,e.skinName="AmuseTarget2Panel12Skin",e}return __extends(e,t),e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.buyLabelTxt=this.buyBtn0.label},e.prototype.open=function(){this.addCustomEvent(437,this.GetCallBack),this.addEventTouchTap(this.buyBtn0,this.onClick),this.updateData(),this.updateTime()},e.prototype.onClick=function(t){var e=pAmusementControl.getAmusementDataById(this.activityID),i=DataCenter.ins().PAmusement2Config[this.activityID][this.actIdx];switch(t.currentTarget){case this.buyBtn0:if(i&&i.vip&&vipControl.lv<i.vip)return void tipsControl.warnTips(LangMgr.getValueByKey("doubleVip"));var n=e.buyData[i.index]>=i.count?!1:!0;if(!n)return void tipsControl.showTips(LangMgr.getValueByKey("inbuylimit"));var o=ActorControl.yb<i.price?!1:!0;if(!o)return void tipsControl.warnTips(LangMgr.getValueByKey("osaNoMoney"));CommonFun.checkBackpackCount()&&pAmusementControl.upReward(this.activityID,i.index);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.updateData=function(){for(var t=DataCenter.ins().PAmusement2Config[this.activityID][this.actIdx],e=0;e<this.rewardGroup.numElements;e++){var i=e+1;this["reward"+i]&&(this["reward"+i].visible=!!t.rewards[e],this["reward"+i].visible&&(this["reward"+i].data=t.rewards[e]))}this.money0.text=LangMgr.getValueByKey("primecost")+t.originalPrice,this.Money1.text=LangMgr.getValueByKey("limitTimediscountprice")+t.price,this.gifttips.source=t.source[0];var n=pAmusementControl.activityData[this.activityID];this.buyBtn0.enabled=0==n.buyData[this.actIdx],this.redPoint0.visible=pAmusementControl.isShowRedPointByBtnInfo(DataCenter.ins().PAmusementBtnConfig[this.activityID]),n.buyData[this.actIdx]>0?this.buyBtn0.label=LangMgr.getValueByKey("fdAlreadingBuy"):this.buyBtn0.label=this.buyLabelTxt},e.prototype.updateTime=function(){TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.setTime()},e.prototype.GetCallBack=function(t){if(this.activityID==t){var e=pAmusementControl.getAmusementDataById(this.activityID);pAmusementControl.isSuccee||pAmusementControl.upChangePage(e.id),pAmusementControl.isSuccee=!1,this.updateData()}},e.prototype.setTime=function(){var t=pAmusementControl.getAmusementDataById(this.activityID);if(t){var e=Math.floor((DateUtils.formatMiniDateTime(t.startTime)-GameServer.serverTime)/DateUtils.MS_PER_SECOND),i=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/DateUtils.MS_PER_SECOND);e>=0?this.countdown.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.countdown.text=LangMgr.getValueByKey("doubleEndActivity"):this.countdown.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)}},e}(BasePanel);__reflect(AmuseTarget2Panel12.prototype,"AmuseTarget2Panel12");var AmuseTarget2Panel2=function(t){function e(){var e=t.call(this)||this;return e._index=0,e.skinName="AmuseTarget2Panel2Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.activityType=AmusementPanel.getAmusementTypeFromId(this.activityID);var e=this.getRule();this.updateData(e)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.buy,this.onTap),this.addEventTouchTap(this.szlb,this.onTap),this.addEventTouchTap(this.lhlb,this.onTap),this.addEventTouchTap(this.yylb,this.onTap),this.addEventTouchTap(this.sblb,this.onTap),this.addCustomEvent(393,this.GetCallBack),this.addCustomEvent(438,this.GetCallBack),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.hideSelect();var i=this.getRule();this.updateData(i)},e.prototype.hideSelect=function(){for(var t=0;4>t;t++)this["select"+t].visible=!1,this["arrow"+t].visible=!1,this["select"+t].visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.buy,this.onTap),this.removeEventTouchTap(this.szlb,this.onTap),this.removeEventTouchTap(this.lhlb,this.onTap),this.removeEventTouchTap(this.yylb,this.onTap),this.removeEventTouchTap(this.sblb,this.onTap),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.GetCallBack=function(t){if(this.activityID==t){var e,i;0==this.activityType?(e=AmusementControl.ins(),i=e.getAmusementDataById(this.activityID)):1==this.activityType&&(e=PAmusementControl.ins(),i=e.getAmusementDataById(this.activityID)),e.isSuccee||(tipsControl.showTips(LangMgr.getValueByKey("getFaile")),e.upChangePage(i.id)),e.isSuccee=!1,this.hideSelect();var n=this.getRule();this.updateData(n)}},e.prototype.onTap=function(t){var e;switch(t.currentTarget){case this.buy:if(this.config.vip&&vipControl.lv<this.config.vip)tipsControl.showTips(LangMgr.getValueByKey("doubleVip"));else{if(!CommonFun.checkBackpackCount(7,1))return;ActorControl.yb>=this.config.price?0==this.activityType?amusementControl.upReward(this.activityID,this._index):1==this.activityType&&pAmusementControl.upReward(this.activityID,this._index):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))}e=-1;break;case this.lhlb:e=1;break;case this.yylb:e=2;break;case this.szlb:e=3;break;case this.sblb:e=4}if(-1!=e){for(var i=0;4>i;i++)e!=i+1?this["select"+i].visible=!1:this["select"+i].visible=!0,this["arrow"+i].visible=this["select"+i].visible;this.updateData(e)}},e.prototype.getRule=function(){var t,e;0==this.activityType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement2Config[this.activityID]):1==this.activityType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusement2Config[this.activityID]);var i=[];for(var n in e)i.push(e[n]);i.sort(this.sortFunc);for(var o=0;o<i.length;o++){var s=i[o],r=t.buyData[s.index]>=s.count?!0:!1;if(!r)return s.index}return 2},e.prototype.sortFunc=function(t,e){return t.price<e.price?-1:t.price>e.price?1:0},e.prototype.updateData=function(t){void 0===t&&(t=2),this._index=t,this["select"+(t-1)].visible=!0,this["arrow"+(t-1)].visible=!0;var e,i,n;0==this.activityType?(e=amusementControl.getAmusementDataById(this.activityID),this.config=DataCenter.ins().Amusement2Config[this.activityID][t],i=DataCenter.ins().AmusementBtnConfig[this.activityID],n=DataCenter.ins().Amusement2Config[this.activityID]):1==this.activityType&&(e=pAmusementControl.getAmusementDataById(this.activityID),this.config=DataCenter.ins().PAmusement2Config[this.activityID][t],i=DataCenter.ins().PAmusementBtnConfig[this.activityID],n=DataCenter.ins().PAmusement2Config[this.activityID]),this.setTime(),i&&(this.title.source=i.title),this.desc3.text=this.config.price+"",this.desc5.text=this.config.giftName;for(var o=0;o<this.config.rewards.length;o++){var s=this.config.rewards[o];this["item"+o].data={type:s.type,count:s.count,id:s.id}}var r=e.buyData[this._index]>=this.config.count?!0:!1;this.buy.visible=!r,this.already.visible=r,this.actTime.visible=!this.already.visible,this.showbg.source=this.config.source[2]+"_png",this.redPoint.visible=this.buy.visible&&ActorControl.yb>=this.config.price,ActorControl.level<AmusementType2DataVo.LimitLevel&&(this.redPoint.visible=!1);for(var o in n){var a=n[o];a&&a.source[0]&&(this["bg"+(+o-1)].source=a.source[0]),a&&a.source[1]&&(this["name"+(+o-1)].source=a.source[1])}},e.prototype.setTime=function(){var t;if(0==this.activityType?t=amusementControl.getAmusementDataById(this.activityID):1==this.activityType&&(t=pAmusementControl.getAmusementDataById(this.activityID)),t){var e=Math.floor((DateUtils.formatMiniDateTime(t.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)}},e}(BasePanel);__reflect(AmuseTarget2Panel2.prototype,"AmuseTarget2Panel2");var AmuseTarget2Panel3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e._curPage=1,e._maxPage=1,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t;0==this.activityType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.activityType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget2Panel3Skin"},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t,this.activityType=AmusementPanel.getAmusementTypeFromId(this._activityID),this.setCurSkin()},enumerable:!0,configurable:!0}),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.reward0.itemRenderer=ItemBase,this.addCustomEvent(393,this.GetCallBack),this.addCustomEvent(438,this.GetCallBack),this.addEventTouchTap(this,this.onTouch),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData()},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime0.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this),this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.GetCallBack=function(t){this.updateData()},e.prototype.updateData=function(){0==this.activityType?(this._activityData=amusementControl.getAmusementDataById(this.activityID),this._config=DataCenter.ins().Amusement2Config[this.activityID]):1==this.activityType&&(this._activityData=pAmusementControl.getAmusementDataById(this.activityID),this._config=DataCenter.ins().PAmusement2Config[this.activityID]);var t=Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime0.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime0.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=e,this._time<0&&(this._time=0),this.actTime0.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)),this._maxPage=Object.keys(this._config).length,this._curPage=1;for(var i,n=1;n<=this._maxPage;n++)if(i=this._config[n],this._activityData.buyData[i.index]<i.count){this._curPage=n;break}this.updatePage()},e.prototype.updatePage=function(){this.turnBackBtn.visible=this._curPage>1,this.turnNextBtn.visible=this._curPage<this._maxPage;var t=this._config[this._curPage];this.ggtxt0.source="viptitle"+t.index+"_png",this.tu0.source="vipshow"+t.index+"_png",this.vipLv0.text=t.vip+"",this.times0.text=LangMgr.getValueByKey("osaCanBuyTimes",t.count),this.get0.label=LangMgr.getValueByKey("charItemYB",t.price),this._collect||(this._collect=new ArrayCollection,this.reward0.dataProvider=this._collect),this._collect.source=t.rewards,this.buyred.visible=!1,this.already0.visible=!1,this.get0.visible=!0,this._activityData.buyData[t.index]>=t.count?(this.isGet=!1,this.already0.visible=!0,this.get0.visible=!1):(this.isGet=vipControl.lv>=t.vip&&ActorControl.yb>=t.price,this.buyred.visible=this.isGet),this.leftred.visible=this.rightred.visible=!1;for(var e=1;e<this._curPage;e++)if(t=this._config[e],this._activityData.buyData[t.index]<t.count&&vipControl.lv>=t.vip&&ActorControl.yb>=t.price){this.leftred.visible=!0;break}for(var e=this._curPage+1;e<=this._maxPage;e++)if(t=this._config[e],this._activityData.buyData[t.index]<t.count&&vipControl.lv>=t.vip&&ActorControl.yb>=t.price){this.rightred.visible=!0;break}},e.prototype.onTouch=function(t){switch(t.target){case this.get0:var e=this._config[this._curPage];this.isGet?0==this.activityType?amusementControl.upReward(e.Id,e.index):1==this.activityType&&pAmusementControl.upReward(e.Id,e.index):vipControl.lv<e.vip?tipsControl.showTips(LangMgr.getValueByKey("activitVipEnought")):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));break;case this.turnBackBtn:this._curPage>1&&(this._curPage--,this.updatePage());break;case this.turnNextBtn:this._curPage<this._maxPage&&(this._curPage++,this.updatePage())}},e}(BasePanel);__reflect(AmuseTarget2Panel3.prototype,"AmuseTarget2Panel3");var AmuseTarget2Panel5=function(t){function e(){var e=t.call(this)||this;return e._time=0,e._selectIndex=0,e._openLeftTime=0,e.isFistEnter=!0,e.skinName="DoubleElevenTimesBuyPanelSkin",e._arrayCollect=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.gift.itemRenderer=DoubleElevenTimesBuyItemRender,this.gift.dataProvider=this._arrayCollect,this.activityIDs=[],this.activityIDs.push(this.activityID);var i=DataCenter.ins().AmusementBtnConfig[this.activityID];this.activityIDs=this.activityIDs.concat(i.relyOn),this.addCustomEvent(392,this.update),this.addEventTouchTap(this,this.onTop),TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),TimerMgr.ins().doTimer(3e4,0,this.getServerTimes,this),this.update(),this.getServerTimes(),this.actDesc.text=DataCenter.ins().AmusementConfig[this.activityIDs[0]].desc},e.prototype.getServerTimes=function(){if(this.isFistEnter){this.isFistEnter=!1;for(var t=this.activityIDs.length,e=0;t>e;e++)amusementControl.upChangePage(this.activityIDs[e])}},e.prototype.update=function(){var t,e,i=this.activityIDs.length,n=0;this._openLeftTime=0;for(var o=0;i>o;o++)e=DataCenter.ins().Amusement2Config[this.activityIDs[o]][1],t=amusementControl.getAmusementDataById(this.activityIDs[o]),this["timeItem"+o].setData(e,t?t.isSpecialOpen():!1),this["timeItem"+o].setSelected(!1),this["timeItem"+o].setRedPoint(t&&t.isSpecialOpen()&&t.canReward()),this["timeItem"+o].name=o,n=t?t.getSpecialOpenLeftTime():0,n>0&&0==this._openLeftTime&&(this._openLeftTime=n),this._openLeftTime>0&&n>0&&n<this._openLeftTime&&(this._openLeftTime=n);this._time=t?t.getLeftTime():0,this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4),this.updateSelected()},e.prototype.updateSelected=function(){this["timeItem"+this._selectIndex].setSelected(!0);var t,e=DataCenter.ins().Amusement2Config[this.activityIDs[this._selectIndex]],i=amusementControl.getAmusementDataById(this.activityIDs[this._selectIndex]),n=[],o=0,s=0,r=(vipControl.lv,0),a=0,l=0;for(var h in e)t=e[h],s=i?i.buyData[o+1]>=t.count?2:i.isSpecialOpen()&&i.serverBuyData[o+1]<t.scount?1:0:0,r=i?t.count-i.buyData[o+1]:0,0>r&&(r=0),l=i?t.scount-i.serverBuyData[o+1]:0,a=i?Math.floor(Math.max(Math.min(l/t.scount*t.shamScount,t.shamScount-i.getSpecialStrikeTimes()),0)):0,5>=l&&a>5&&(a=5),0==l&&(a=0),n[o]=[t,s,r,this.activityIDs[this._selectIndex],l+a],o++;n.sort(this.sort),this._arrayCollect.source=n},e.prototype.sort=function(t,e){return 1==t[1]?-1:1==e[1]?1:t[0].index<e[0].index?-1:t[0].index>e[0].index?1:0},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.removeEventTouchTap(this,this.onTop),this.removeCustomEvents(),this.activityIDs=[],this.isFistEnter=!0},e.prototype.onTop=function(t){switch(t.target){case this.timeItem0:case this.timeItem1:case this.timeItem2:case this.timeItem3:this["timeItem"+this._selectIndex].setSelected(!1),this._selectIndex=Number(t.target.name),this.updateSelected()}},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4)),this._openLeftTime>0&&(this._openLeftTime--,0==this._openLeftTime&&this.update())},e}(AmusementPanel);__reflect(AmuseTarget2Panel5.prototype,"AmuseTarget2Panel5");var AmuseTarget3Panel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Panel1Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.open=function(){this.addEventTouchTap(this.getBtn,this.onTap),this.addEventTouchTap(this.gift0,this.onTap),this.addEventTouchTap(this.gift1,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.initData()},e.prototype.initData=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement3Config[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusement3Config[this.activityID]);var i=-1,n=Object.keys(e);for(var o in e){var s=e[o],r=+o;(t.dabiao[r-1]||0)<s.day?-1==i&&(i=n.length):0==(t.recrod>>r&1)&&(t.dabiao[r-1]||0)>=s.day&&(i=r),this["gift"+(r-1)].setData(this.activityID,r)}var a=Object.keys(e),l=+a[a.length-1];this.bar.maximum=e[l].day,this.bar.value=t.dabiao[l-1],-1==i&&(i=t.getCurIndex()),this.setSelectIndex(i),this.updateTime()},e.prototype.setSelectIndex=function(t){this._index=t;var e,i;if(0==this.actType?(e=DataCenter.ins().Amusement3Config[this.activityID][t],i=amusementControl.getAmusementDataById(this.activityID)):1==this.actType&&(e=DataCenter.ins().PAmusement3Config[this.activityID][t],i=pAmusementControl.getAmusementDataById(this.activityID)),this.reward.dataProvider=new eui.ArrayCollection(e.rewards),this.redPoint.visible=!1,(i.dabiao[t-1]||0)>=e.day){var n=i.recrod>>t&1;0==n?(this.getBtn.label=LangMgr.getValueByKey("activitGet"),this.getBtn.visible=!0,this.getBtn.enabled=!0,this.already.visible=!1,this.redPoint.visible=!0,this._state=1):(this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet"),this.getBtn.visible=!1,this.already.visible=!0,this._state=2)}else this.getBtn.label=LangMgr.getValueByKey("activitNoFinsh"),this.getBtn.visible=!0,this.getBtn.enabled=!1,this.already.visible=!1,this._state=0;var o=e.expAttr;this.show0.source=o?o[0]:"",this.show1.source=o?o[1]:"",1==t?(this.show0.visible=!0,this.show1.visible=!1,this.gift0.setSelected(!0),this.gift1.setSelected(!1)):(this.show0.visible=!1,this.show1.visible=!0,this.gift0.setSelected(!1),this.gift1.setSelected(!0))},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.onTap=function(t){var e=t.currentTarget;e==this.getBtn?1==this._state&&(0==this.actType?amusementControl.upReward(this.activityID,this._index):1==this.actType&&pAmusementControl.upReward(this.activityID,this._index)):e==this.gift0?this.setSelectIndex(1):e==this.gift1&&this.setSelectIndex(2)},e.prototype.close=function(){this.removeEventTouchTap(this.getBtn,this.onTap),this.removeEventTouchTap(this.gift0,this.onTap),this.removeEventTouchTap(this.gift1,this.onTap),TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){this.initData()},e}(BasePanel);__reflect(AmuseTarget3Panel1.prototype,"AmuseTarget3Panel1");var AmuseTarget3Panel10=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectRes=["sd_projecttitle2","sd_projecttitle1"],e.pageRedPoint=[!1,!1,!1],e}return __extends(e,t),e.prototype.initSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget3Panel10Skin"},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){this.initSkin(),this.addCustomEvent(393,this.updateDataCall),this.addCustomEvent(395,this.updateDataCall);for(var t=0;3>t;t++)this["projectbg"+t].name=t.toString(),this.addEventTouchTap(this["projectbg"+t],this.onTap);this.rechargeitem.itemRenderer=OpenDoorRedItemRender,this.rechargeitemData=new eui.ArrayCollection,this.rechargeitem.dataProvider=this.rechargeitemData,this.initData(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.updateTime=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=t.getLeftTime();this.actTime.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.updatePageRedPoint=function(t){for(var e=0;e<t.length;e++)if(t[e].redPoint)return!0;return!1},e.prototype.updateList=function(t,e){var i=DataCenter.ins().Amusement3Config[t],n=amusementControl.getAmusementDataById(t),o=[];for(var s in i){var r=new KaiMenData;r.id=i[s].Id,r.index=i[s].index,r.type=i[s].type,r.day=i[s].day,r.reward=i[s].rewards,r.already=n.recrod>0&&n.recrod>>i[s].index&1?!0:!1,3==r.type?(r.unready=n.isOverTimer(i[s].index),n.curOpenDay()+1==i[s].day?r.redPoint=n.chongzhiNum>=i[s].val?!0:!1:r.redPoint=!1):1==r.type&&(r.unready=n.dabiao[i[s].index-1]<i[s].day,r.redPoint=!r.already&&!r.unready),r.already&&(r.redPoint=!1),o.push(r)}return o},e.prototype.onTap=function(t){for(var e=0;3>e;e++)if(this["projectbg"+e].source=this.selectRes[0],t.currentTarget==this["projectbg"+e]){this.actIndex=e,this["projectbg"+e].source=this.selectRes[1];var i=this.actIds[this.actIndex],n=this.updateList(i,e);this.rechargeitemData.replaceAll(n)}},e.prototype.initData=function(){var t=DataCenter.ins().Amusement3Config[this.activityID];this.actDesc.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.actIds=[],this.actIds.push(this.activityID);for(var e=1;e<=t[1].activityID.length;e++)this.actIds.push(t[1].activityID[e-1]);this.actIndex=this.getRuleIndex(),this.updateTime(),this.updateData();var i=DataCenter.ins().AmusementBtnConfig[this.activityID];i&&(this.title.source=i.title)},e.prototype.getRuleIndex=function(){var t=0;return t},e.prototype.updateDataCall=function(t){-1!=this.actIds.indexOf(t)&&this.updateData()},e.prototype.updateData=function(){for(var t=0;3>t;t++)this["projectbg"+t].source=this.selectRes[0];this["projectbg"+this.actIndex].source=this.selectRes[1];for(var t=0;t<this.actIds.length;t++){var e=this.actIds[t],i=this.updateList(e,t);this["redpoint"+t].visible=this.updatePageRedPoint(i),t==this.actIndex&&this.rechargeitemData.replaceAll(i)}var n=amusementControl.getAmusementDataById(this.actIds[this.actIndex]);GlobalModel.isHw?this.rechargeCoumt.text=LangMgr.getValueByKey("osaTodayPay",Math.floor(n.chongzhiNum)):this.rechargeCoumt.text=LangMgr.getValueByKey("osaTodayPay",Math.floor(n.chongzhiNum/GlobalModel.chargeRate))},e}(BasePanel);__reflect(AmuseTarget3Panel10.prototype,"AmuseTarget3Panel10");var AmuseTarget3Panel15=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.setCurSkin(),this.reward.itemRenderer=ItemBase,this.awardList.itemRenderer=AmuseTarget3ItemRender15,this.progressList.itemRenderer=AmuseTarget3ItemBar15},e.prototype.setCurSkin=function(){0==this.actType?this.actDp=DataCenter.ins().AmusementConfig[this.activityID]:1==this.actType&&(this.actDp=DataCenter.ins().PAmusementConfig[this.activityID]),this.actDp.pageSkin?this.skinName=this.actDp.pageSkin:this.skinName="AmuseTarget3Panel15Skin"},e.prototype.open=function(){this.initUI(),this.addEventTouchTap(this.getBtn,this.onTouch),this.addEventItemTap(this.awardList,this.onAwardListTap),this.initData(),this.refSelect(),this.updateTime(),this.updateData(),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.refSelect=function(){var t=0;for(var e in this.curActDt.dabiao){var i=this.curActDt.recrod>>+e+1&1;if(!((this.curActDt.dabiao[e]||0)>=this.actTypeDp[+e+1].day)||0==i){t=+e;break}}this.awardList.selectedIndex=t,this.setSelectIndex(t+1)},e.prototype.initData=function(){0==this.actType?(this.curActDt=amusementControl.getAmusementDataById(this.activityID),this.actTypeDp=DataCenter.ins().Amusement3Config[this.activityID]):1==this.actType&&(this.curActDt=pAmusementControl.getAmusementDataById(this.activityID),this.actTypeDp=DataCenter.ins().PAmusement3Config[this.activityID]);var t=[],e=-1;for(var i in this.actTypeDp){var n=this.actTypeDp[i],o=+i;(this.curActDt.dabiao[o-1]||0)<n.day?-1==e&&(e=o):0==(this.curActDt.recrod>>o&1)&&(this.curActDt.dabiao[o-1]||0)>=n.day&&(e=o),t.push({actId:this.activityID,index:o})}this.awardList.dataProvider=new eui.ArrayCollection(t),this.actDesc.text=this.actDp.desc},e.prototype.onAwardListTap=function(t){var e=t.itemIndex;this.setSelectIndex(e+1)},e.prototype.setSelectIndex=function(t){this._index=t;var e=this.actTypeDp[t];if(this.reward.dataProvider=new eui.ArrayCollection(e.rewards),this.redPoint.visible=!1,(this.curActDt.dabiao[t-1]||0)>=e.day){var i=this.curActDt.recrod>>t&1;0==i?(this.getBtn.label=LangMgr.getValueByKey("activitGet"),this.getBtn.visible=!0,this.getBtn.enabled=!0,this.already.visible=!1,this.redPoint.visible=!0,this._state=1):(this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet"),this.getBtn.visible=!1,this.already.visible=!0,this._state=2)}else this.getBtn.label=LangMgr.getValueByKey("activitNoFinsh"),this.getBtn.visible=!0,this.getBtn.enabled=!1,this.already.visible=!1,this._state=0},e.prototype.updateTime=function(){this._time=this.curActDt.getLeftTime(),this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3)},e.prototype.setTime=function(){if(this.curActDt){var t=this.curActDt.getLeftTime();this._time=t,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3)}},e.prototype.updateData=function(){for(var t=[],e=1,i=this.curActDt.dabiao,n=0;n<i.length;n++){var o=i[n];o&&(t.push(o>=e),e++)}this.dayCount.text=LangMgr.getValueByKey("activitContinuousRecharge",t.length),t.pop(),this.progressList.dataProvider=new eui.ArrayCollection(t)},e.prototype.onTouch=function(t){switch(t.target){case this.getBtn:if(1==this._state){if(!CommonFun.checkBackpackCount())return;0==this.actType?amusementControl.upReward(this.activityID,this._index):1==this.actType&&pAmusementControl.upReward(this.activityID,this._index)}}},e}(BasePanel);__reflect(AmuseTarget3Panel15.prototype,"AmuseTarget3Panel15");var AmuseTarget3Panel16=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.setCurSkin(),this.content0.itemRenderer=AmuseTarget3ItemRender16,this.listDt=new eui.ArrayCollection,this.content0.dataProvider=this.listDt;for(var t=1;2>=t;t++){var e={};e.actId=this.activityID,e.index=t,this.listDt.addItem(e)
}},e.prototype.setCurSkin=function(){var t;0==this.actType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.actType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget3Panel16Skin"},e.prototype.open=function(){this.initUI(),this.addEventTouchTap(this.content0,this.onTouch),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateTime(),this.updateData()},e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){this.listDt.refresh()},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){var t;if(0==this.actType?t=amusementControl.getAmusementDataById(this.activityID):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID)),t){var e=t.getLeftTime();this._time=e,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3)}},e.prototype.onTouch=function(t){if(t.target instanceof eui.Button){if(!CommonFun.checkBackpackCount())return;amusementControl.upReward(this.activityID,+t.target.name)}},e}(BasePanel);__reflect(AmuseTarget3Panel16.prototype,"AmuseTarget3Panel16");var AmuseTarget3Panel17=function(t){function e(){var e=t.call(this)||this;return e._time=0,e.skinName="DoubleElevenPaysBackGiftPanelSkin",e._stateList=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.actDesc.text=DataCenter.ins().AmusementConfig[this.activityID].desc},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.pay0,this.onPay0),this.addEventTouchTap(this.pay1,this.onPay1),this.addCustomEvent(392,this.update),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.update()},e.prototype.update=function(){var t,e,i=amusementControl.getAmusementDataById(this.activityID),n=DataCenter.ins().Amusement3Config[this.activityID],o=0,s=[this.pay0,this.pay1],r=0;for(var a in n)t=n[a],o=i.recrod>>t.index&1?2:i.chongzhiNum>=t.val?1:0,e=s[r],2==o?e.label=LangMgr.getValueByKey("activitAlreadingGet"):1==o?e.label=LangMgr.getValueByKey("tongGetGift"):GlobalModel.isHw?e.label=LangMgr.getValueByKey("activitRechare",t.val):e.label=LangMgr.getValueByKey("activitRechare")+t.val/GlobalModel.chargeRate,e.enabled=2!=o,this._stateList[r]=o,this["redPoint"+r].visible=1==o,r++;this._time=i.getLeftTime(),this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4),this.paytxt0.text=LangMgr.getValueByKey("donateVcoin",n[1].rewards[0].count),this.paytxt1.text=LangMgr.getValueByKey("donateVcoin",n[2].rewards[0].count)},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this.pay0,this.onPay0),this.removeEventTouchTap(this.pay1,this.onPay1),TimerMgr.ins().removeAll(this)},e.prototype.onPay0=function(t){this.onPay(0)},e.prototype.onPay1=function(t){this.onPay(1)},e.prototype.onPay=function(t){var e=this._stateList[t];0==e?payControl.checkOpenWin():1==e&&amusementControl.upReward(this.activityID,t+1)},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4))},e}(AmusementPanel);__reflect(AmuseTarget3Panel17.prototype,"AmuseTarget3Panel17");var AmuseTarget3Panel2=function(t){function e(){var e=t.call(this)||this;return e._state=0,e._index=1,e._time=0,e.skinName="AmuseTarget3Panel2Skin",e}return __extends(e,t),e.prototype.open=function(){this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.getBtn,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.initData()},e.prototype.initData=function(){this.rechargeBar||(this.rechargeBar=new ProgressBarEff,this.rechargeBar.setWidth(520),this.rechargeBar.x=-272,this.rechargeBar.y=0,this.process.addChild(this.rechargeBar));var t,e,i;if(0==this.actType?(e=amusementControl.getAmusementDataById(this.activityID),i=e.getCurIndex(),t=DataCenter.ins().Amusement3Config[this.activityID][i]):1==this.actType&&(e=pAmusementControl.getAmusementDataById(this.activityID),i=e.getCurIndex(),t=DataCenter.ins().PAmusement3Config[this.activityID][i]),this._index=i,this.reward.dataProvider=new eui.ArrayCollection(t.rewards),this.redPoint.visible=!1,this.state.visible=!0,e.chongzhiTotal>=t.val){var n=e.recrod>>i&1;0==n?(this.getBtn.label=LangMgr.getValueByKey("activitGet"),this.getBtn.visible=!0,this.getBtn.enabled=!0,this.already.visible=!1,this.redPoint.visible=!0,this._state=1):(this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet"),this.getBtn.visible=!1,this.already.visible=!0,this.state.visible=!1,this._state=2),this.state.textColor=LangMgr.getColor("color43")}else this.getBtn.label=LangMgr.getValueByKey("activitNoFinsh"),this.getBtn.visible=!0,this.getBtn.enabled=!1,this.already.visible=!1,this.state.textColor=LangMgr.getColor("color48"),this._state=0;this.state.text=LangMgr.getValueByKey("osaAllRecharge",e.chongzhiTotal,t.val),this.rechargeBar.setData(e.chongzhiTotal,t.val),this.rechargeBar.setLbValueText("");var o=t.expAttr;this.showItem1.source=o?o[0]:"",this.showItem2.source=o?o[1]:"",this.showItem3.source=o?o[2]:"",this.updateTime()},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.onTap=function(){if(1==this._state){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace"));0==this.actType?amusementControl.upReward(this.activityID,this._index):1==this.actType&&pAmusementControl.upReward(this.activityID,this._index)}},e.prototype.close=function(){this.removeEventTouchTap(this.getBtn,this.onTap),TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){this.initData()},e}(BasePanel);__reflect(AmuseTarget3Panel2.prototype,"AmuseTarget3Panel2");var AmuseTarget3Panel3=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Panel3Skin",e}return __extends(e,t),e.prototype.open=function(){this.reward0.itemRenderer=ItemBase,this.reward1.itemRenderer=ItemBase,this.addEventTouchTap(this.get0,this.onTap),this.addEventTouchTap(this.get1,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.initData()},e.prototype.initData=function(){this.setIndex(0),this.setIndex(1),this.updateTime()},e.prototype.setIndex=function(t){var e,i,n,o;0==this.actType?n=amusementControl.getAmusementDataById(this.activityID):1==this.actType&&(n=pAmusementControl.getAmusementDataById(this.activityID)),0==t?(e=n.getCurIndex(3),this._index=e,i=n.chongzhiNum):(e=n.getCurIndex(2),i=n.chongzhiTotal),0==this.actType?o=DataCenter.ins().Amusement3Config[this.activityID][e]:1==this.actType&&(o=DataCenter.ins().Amusement3Config[this.activityID][e]),this["reward"+t].dataProvider=new eui.ArrayCollection(o.rewards),this["redPoint"+t].visible=!1;var s=this["already"+t],r=this["get"+t],a=this["record"+t];if(s.visible=!1,i>=o.val){var l=n.recrod>>e&1;0==l?(r.label=LangMgr.getValueByKey("osaQuickGet"),r.visible=!0,r.enabled=!0,this["redPoint"+t].visible=!0):(r.label=LangMgr.getValueByKey("activitAlreadingGet"),r.visible=!1,s.visible=!0),a.textColor=LangMgr.getColor("color43")}else r.label=LangMgr.getValueByKey("activitNoFinsh"),r.visible=!0,r.enabled=!1,a.textColor=LangMgr.getColor("color48");a.text=LangMgr.getValueByKey("osaAllRecharge",i,o.val),0==t?this.target0.text=LangMgr.getValueByKey("osaTodayAllPayGet",o.val):this.target1.text=LangMgr.getValueByKey("osaSevenAllPayGet",o.val)},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.get0)0==this.actType?amusementControl.upReward(this.activityID,this._index):1==this.actType&&pAmusementControl.upReward(this.activityID,this._index);else if(e==this.get1){var i=void 0;0==this.actType?(i=amusementControl.getAmusementDataById(this.activityID),amusementControl.upReward(this.activityID,i.getCurIndex(2))):1==this.actType&&(i=pAmusementControl.getAmusementDataById(this.activityID),pAmusementControl.upReward(this.activityID,i.getCurIndex(2)))}},e.prototype.close=function(){this.removeEventTouchTap(this.get0,this.onTap),this.removeEventTouchTap(this.get1,this.onTap),TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){this.initData()},e}(BasePanel);__reflect(AmuseTarget3Panel3.prototype,"AmuseTarget3Panel3");var AmuseTarget3Panel4=function(t){function e(){var e=t.call(this)||this;return e._time=0,e.skinName="DailyRechargePanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.content.itemRenderer=DailyRechargeItemRender,this.addCustomEvent(392,this.updateData),this.addCustomEvent(437,this.updateData),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.updateData()},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement3Config[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusement3Config[this.activityID]);var i,n=[],o=0,s=0;for(var r in e)i=e[r],s=t.recrod>>i.index&1?2:t.chongzhiTotal>=i.val?1:0,n[o]=[this.actType,i,s,t.chongzhiTotal,this.activityID,i.index],o++;var a=[],l=[],h=[];for(var u in n)0==n[u][2]?a.push(n[u]):1==n[u][2]?l.push(n[u]):2==n[u][2]&&h.push(n[u]);var p=[];p=p.concat(l).concat(a).concat(h),this.content.dataProvider=new eui.ArrayCollection(p),this._time=t.getLeftTime(),this.actTime0.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4)},e.prototype.sort=function(t,e){return 2==t[1]?1:2==e[1]?-1:0==t[1]?1:0==e[1]?-1:1==t[1]||1==e[1]?1:void 0},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime0.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4))},e}(BasePanel);__reflect(AmuseTarget3Panel4.prototype,"AmuseTarget3Panel4");var AmuseTarget3Panel5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t},enumerable:!0,configurable:!0}),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget3Panel5Skin"},e.prototype.open=function(){this.setCurSkin(),this.reward0.itemRenderer=ItemBase,this.reward1.itemRenderer=ItemBase,this.addEventTouchTap(this.getBtn0,this.onTap),this.addEventTouchTap(this.getBtn1,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.initData()},e.prototype.initData=function(){this.setIndex(0),this.setIndex(1),this.updateTime()},e.prototype.setIndex=function(t){var e,i,n,o;0==this.actType?(n=amusementControl.getAmusementDataById(this.activityID),o=DataCenter.ins().AmusementBtnConfig[this.activityID]):1==this.actType&&(n=pAmusementControl.getAmusementDataById(this.activityID),o=DataCenter.ins().PAmusementBtnConfig[this.activityID]),o&&(this.title.source=o.title),0==t?(e=n.getCurIndex(3),this._index=e,i=n.chongzhiNum):(e=n.getCurIndex(2),i=n.chongzhiTotal);var s;0==this.actType?s=DataCenter.ins().Amusement3Config[this.activityID][e]:1==this.actType&&(s=DataCenter.ins().PAmusement3Config[this.activityID][e]),this["reward"+t].dataProvider=new eui.ArrayCollection(s.rewards),this["redPoint"+t].visible=!1;var r=this["already"+t],a=this["getBtn"+t];if(r.visible=!1,i>=s.val){var l=n.recrod>>e&1;0==l?(a.label=LangMgr.getValueByKey("osaQuickGet"),a.visible=!0,a.enabled=!0,this["redPoint"+t].visible=!0):(a.label=LangMgr.getValueByKey("activitAlreadingGet"),a.visible=!1,r.visible=!0)}else a.label=LangMgr.getValueByKey("activitNoFinsh"),a.visible=!0,a.enabled=!1;0!=t&&(this.state.text=LangMgr.getValueByKey("activitAllRecharge1",i,s.val)),this.bar&&(this.bar.maximum=s.val,this.bar.value=i),158==this.activityID?this.addchong.source="l_biaoti_leichong800":212==this.activityID&&(this.addchong.source="l_biaoti_leichong800")},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.getBtn0)0==this.actType?amusementControl.upReward(this.activityID,this._index):1==this.actType&&pAmusementControl.upReward(this.activityID,this._index);else if(e==this.getBtn1){var i=void 0;0==this.actType?(i=amusementControl.getAmusementDataById(this.activityID),amusementControl.upReward(this.activityID,i.getCurIndex(2))):1==this.actType&&(i=pAmusementControl.getAmusementDataById(this.activityID),pAmusementControl.upReward(this.activityID,i.getCurIndex(2)))}},e.prototype.close=function(){this.removeEventTouchTap(this.getBtn0,this.onTap),this.removeEventTouchTap(this.getBtn1,this.onTap),TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){this.initData()},e}(BasePanel);__reflect(AmuseTarget3Panel5.prototype,"AmuseTarget3Panel5");var AmuseTarget3Panel6=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Panel6Skin",e}return __extends(e,t),e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.open=function(){this.listData=new eui.ArrayCollection,this.content.itemRenderer=AmuseTarget3ItemRender6,this.content.dataProvider=this.listData,TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.updateData()},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.updateData=function(){this.updateTime(),this.updateList()},e.prototype.updateList=function(){var t,e,i;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement3Config[this.activityID],i=amusementControl.getbtnInfo(this.activityID.toString())):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusement3Config[this.activityID],i=pAmusementControl.getbtnInfo(this.activityID.toString()));var n=[];for(var o in e)n.push([this.actType,e[o]]);n=n.slice();for(var s=[],r=[],a=0;a<n.length;a++){var l=t.getRewardStateById(n[a][1].index);l==AmusementControl.Geted?r.push(n[a]):s.push(n[a])}s.sort(this.sortFunc),r.sort(this.sortFunc),n=s.concat(r),this.listData.replaceAll(n),this.title.source=i.title},e.prototype.sortFunc=function(t,e){return t.val<e.val?-1:1},e}(BasePanel);__reflect(AmuseTarget3Panel6.prototype,"AmuseTarget3Panel6");var AmuseTarget3Panel7=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Panel7Skin",e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(393,this.GetCallBack),this.addCustomEvent(438,this.GetCallBack),this.listData=new eui.ArrayCollection,this.content0.itemRenderer=AmuseTarget3ItemRender7,this.content0.dataProvider=this.listData,TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.updateData()},e.prototype.GetCallBack=function(t){if(this.activityID==t){var e;if(0==this.actType?e=AmusementControl.ins():1==this.actType&&(e=PAmusementControl.ins()),!e.isSuccee)if(backpackControl.getSurplusCount()){tipsControl.showTips(LangMgr.getValueByKey("getFaile"));var i=void 0;0==this.actType?i=e.getAmusementDataById(this.activityID):1==this.actType&&(i=e.getAmusementDataById(this.activityID)),e.upChangePage(i.id)}else tipsControl.showTips(LangMgr.getValueByKey("osaBackNoSpace"));e.isSuccee=!1,this.updateData()}},e.prototype.updateTime=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusementConfig[this.activityID]);var i=t.getLeftTime();this._time=i,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3),this.actDesc.text=e.desc},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.updateData=function(){this.updateTime(),this.updateList()},e.prototype.updateList=function(){var t,e,i;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement3Config[this.activityID],i=amusementControl.getbtnInfo(this.activityID.toString())):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusement3Config[this.activityID],i=pAmusementControl.getbtnInfo(this.activityID.toString()));var n=[];for(var o in e)n.push([this.actType,e[o]]);n=n.slice();for(var s=[],r=[],a=0;a<n.length;a++){var l=t.getRewardStateById(n[a][1].index);l==AmusementControl.Geted?r.push(n[a]):s.push(n[a])}s.sort(this.sortFunc),r.sort(this.sortFunc),n=s.concat(r),this.listData.replaceAll(n),this.title.source=i.title},e.prototype.sortFunc=function(t,e){return t.index<e.index?-1:1},e}(BasePanel);__reflect(AmuseTarget3Panel7.prototype,"AmuseTarget3Panel7");var AmuseTarget3Panel8=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e||0,i.initSkin(),i}return __extends(e,t),e.prototype.initSkin=function(){this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID);var t;0==this.actType?(t=DataCenter.ins().AmusementConfig[this.activityID],this.skinName=t.pageSkin):1==this.actType&&(t=DataCenter.ins().PAmusementConfig[this.activityID],this.skinName=t.pageSkin)},e.prototype.open=function(){for(var t=0;6>t;t++)this.addEventTouchTap(this["reward"+t],this.onTap);this.addEventTouchTap(this.rechargeBtn,this.onTap),this.addCustomEvent(392,this.showAward),this.addCustomEvent(437,this.showAward),this.initData(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.initData=function(){var t;0==this.actType?(this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc,t=DataCenter.ins().Amusement3Config[this.activityID]):1==this.actType&&(this.actInfo1.text=DataCenter.ins().PAmusementConfig[this.activityID].desc,t=DataCenter.ins().PAmusement3Config[this.activityID]);for(var e in t){var i=t[e];if(4==i.type){this.singleReward.data=i.rewards[0];break}}this.updateTime(),this.updateData()},e.prototype.updateTime=function(){var t;0==this.actType?t=amusementControl.getAmusementDataById(this.activityID):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID));var e=t.getLeftTime();this.actTime1.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.onTap=function(t){if(t.currentTarget==this.rechargeBtn)return void payControl.checkOpenWin();var e=t.currentTarget;if(e&&e.data){var i=void 0,n=void 0;0==this.actType?(i=e.data[1],amusementControl.upReward(i.Id,i.index),n=amusementControl.getAmusementDataById(i.Id)):1==this.actType&&(i=e.data[1],pAmusementControl.upReward(i.Id,i.index),n=pAmusementControl.getAmusementDataById(i.Id));var o=n.getRewardStateById(i.index);o==AmusementControl.CanGet&&(this._sendConf=i)}},e.prototype.showAward=function(){if(this._sendConf){var t=void 0;0==this.actType?t=amusementControl.getAmusementDataById(this._sendConf.Id):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this._sendConf.Id));var e=t.getRewardStateById(this._sendConf.index);e==AmusementControl.Geted&&tipsControl.showItemTips(this._sendConf.rewards[0].id)}},e.prototype.close=function(){for(var t=0;6>t;t++)this.removeEventTouchTap(this["reward"+t],this.onTap);this.removeEventTouchTap(this.rechargeBtn,this.onTap),this.removeCustomEvents(),TimerMgr.ins().remove(this.updateTime,this)},e.prototype.updateData=function(){var t,e;0==this.actType?(t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement3Config[this.activityID]):1==this.actType&&(t=pAmusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().PAmusement3Config[this.activityID]);for(var i=0;5>i;i++)for(var n=e[i+1],o=e[i+2],s=Math.floor((t.chongzhiTotal-n.val)/(o.val-n.val)*5),r=0;5>r;r++){var a="sche"+i+"bell"+r;s>r?this[a].source="bell2":this[a].source="bell1"}for(var i=0;6>i;i++)this["reward"+i].data=[this.actType,e[i+1]];this.numLbl.text=""+Math.floor(t.chongzhiTotal/GlobalModel.chargeRate)},e}(BasePanel);__reflect(AmuseTarget3Panel8.prototype,"AmuseTarget3Panel8");var AmuseTarget3Panel9=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e||0,i.initSkin(),i}return __extends(e,t),e.prototype.initSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="DoubleElevenRechargesPanelSkin"},e.prototype.open=function(){for(var t=DataCenter.ins().Amusement3Config[this.activityID],e=CommonUtils.getObjectLength(t),i=0;e>i;i++)this["targtet"+i]&&this.addEventTouchTap(this["targtet"+i],this.onTap);this.addEventTouchTap(this.rechargeBtn,this.onTap),this.addCustomEvent(392,this.showAward),this.reward.itemRenderer=ItemBase,this.initData(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.initData=function(){this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc;for(var t in DataCenter.ins().Amusement3Config[this.activityID]){var e=DataCenter.ins().Amusement3Config[this.activityID][t];if(4==e.type){this.singleReward.data=e.rewards[0];break}}this.updateTime(),this.updateData2()},e.prototype.updateTime=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=t.getLeftTime();this.actTime1.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.onTap=function(t){if(t.currentTarget==this.rechargeBtn){if(!this._sendConf)return;var e=amusementControl.getAmusementDataById(this._sendConf.Id),i=e.getRewardStateById(this._sendConf.index);return void(i==AmusementControl.Geted?tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet")):i==AmusementControl.CanGet?amusementControl.upReward(this.activityID,this._sendConf.index):tipsControl.showTips(LangMgr.getValueByKey("osaTravelAim")))}if(t.currentTarget instanceof CelebrationRechargeItemRender||t.currentTarget instanceof DoubleElevenRechargesItemRender){var n=t.currentTarget;if(n.data){this.updateReward(n.data.config.index,n.data.config.index);var o=DataCenter.ins().Amusement3Config[this.activityID];for(var s in o)o[s].index!=n.data.config.index&&this["targtet"+(o[s].index-1)]&&this["targtet"+(o[s].index-1)].setSelect(!1)}}},e.prototype.showAward=function(){if(this._sendConf){var t=amusementControl.getAmusementDataById(this._sendConf.Id),e=t.getRewardStateById(this._sendConf.index);e==AmusementControl.Geted&&(this.showEff(this._sendConf),this.rechargeBtn.visible=!1,this.already.visible=!this.rechargeBtn.visible)}},e.prototype.close=function(){this.cleanEff(),this.removeEventTouchTap(this.rechargeBtn,this.onTap),this.removeCustomEvents(),TimerMgr.ins().remove(this.updateTime,this)},e.prototype.updateReward=function(t,e){var i=amusementControl.getAmusementDataById(this.activityID),n=DataCenter.ins().Amusement3Config[this.activityID][t];if(n&&i&&this["targtet"+(t-1)]){if(this["targtet"+(t-1)].data={curCost:i.chongzhiTotal,config:n},this["targtet"+(t-1)].setSelect(e?t==e:!1),this.rechargeBtn.visible=!0,this.bigEgg.source=n.expAttr[4],t==e){this._sendConf=n;var o=i.getRewardStateById(this._sendConf.index);this.redPoint.visible=!1,o==AmusementControl.Geted?(this.rechargeBtn.visible=!1,this.bigEgg.source=n.expAttr[5]):o==AmusementControl.CanGet&&(this.redPoint.visible=!0),this.reward.dataProvider=new eui.ArrayCollection(n.rewards)}this.already.visible=!this.rechargeBtn.visible}},e.prototype.updateData2=function(){var t=this.getRuleIndex();if(t)for(var e=(amusementControl.getAmusementDataById(this.activityID),DataCenter.ins().Amusement3Config[this.activityID]),i=CommonUtils.getObjectLength(e),n=0;i>n;n++)this.updateReward(n+1,t)},e.prototype.updateData=function(){},e.prototype.getRuleIndex=function(){var t=amusementControl.getAmusementDataById(this.activityID);if(!t)return 0;var e=DataCenter.ins().Amusement3Config[this.activityID],i=CommonUtils.getObjectLength(e),n=i;for(var o in e)if(!(e[o].index-1>=i)&&this["targtet"+(e[o].index-1)]){var s=t.getRewardStateById(e[o].index);if(s!=AmusementControl.Geted){if(s==AmusementControl.CanGet)return e[o].index;n>e[o].index&&(n=e[o].index)}}return n},e.prototype.cleanEff=function(){egret.Tween.removeTweens(this.hamer),egret.Tween.removeTweens(this.flower),DisplayUtils.removeFromParent(this.tonk),DisplayUtils.removeFromParent(this.boom)},e.prototype.showEff=function(t){var e=this;if(t){this.tonk||(this.tonk=new GameMovieClip),this.tonk.parent||this.hamer.addChild(this.tonk),this.boom||(this.boom=new GameMovieClip),this.boom.parent||this.flower.addChild(this.boom),egret.Tween.removeTweens(this.hamer),egret.Tween.removeTweens(this.flower);var i=this;this.tonk.playFile(PATH_EFF+t.expAttr[2],1,function(){var n=egret.Tween.get(e.hamer);n.wait(200).call(function(){i.updateReward(t.index,t.index)}),i.boom.playFile(PATH_EFF+t.expAttr[3],1,function(){egret.Tween.removeTweens(i.hamer),egret.Tween.removeTweens(i.flower),DisplayUtils.removeFromParent(i.tonk),DisplayUtils.removeFromParent(i.boom)})})}},e}(BasePanel);__reflect(AmuseTarget3Panel9.prototype,"AmuseTarget3Panel9");var AmuseTarget4Panel1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget4Panel1Skin"},e.prototype.open=function(t){this.setCurSkin(),this.reward0.itemRenderer=ItemBase,this.reward1.itemRenderer=ItemBase,this.reward2.itemRenderer=ItemBase,this.reward3.itemRenderer=ItemBase,this.titleEffNameMc||(this.titleEffNameMc=new GameMovieClip),this.titleEffNameMc.parent||this.titleEffGroup.addChild(this.titleEffNameMc),this.titleEffNameMc.y=this.titleEffGroup.y,this.addEventTouchTap(this.seek,this.onTap),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.model=t,this.addCustomEvent(394,this.updateData),amusementControl.upDabiaoInfo(this.activityID)},e.prototype.setTime=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this._time=t.getLeftTime(),this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){this.removeEventTouchTap(this.seek,this.onTap),TimerMgr.ins().removeAll(this),this.removeCustomEvents()},e.prototype.onTap=function(t){switch(t.target){case this.seek:for(var e=DataCenter.ins().Amusement4Config[this.activityID][0].rankType,i=this.model?this.model.getDataList():amusementControl.rankInfoList,n=Math.min(i.length,20),o=[],s=amusementControl.getAmusementDataById(this.activityID),r={idx:1},a=0;n>a;a++){var l=i[a],h=s.getCostRank(l,r);o.push({rankData:i[a],activityID:this.activityID,rank:h})}24==e&&(o=o.filter(function(t){return 0!=t.rank})),UIMgr.ins().open(AmuseRankTipsView,o,e)}},e.prototype.setMyRank=function(){this.myAttrValue.text=LangMgr.getValueByKey("osaEmpty");var t=DataCenter.ins().Amusement4Config[this.activityID][0].rankType;if(21==t||24==t)if(null==amusementControl.myPaiming||0==amusementControl.myPaiming)this.myRanking.text=LangMgr.getValueByKey("guanNoRank");else{var i=amusementControl.getAmusementDataById(this.activityID);i.myPaiming?this.myRanking.text=i.myPaiming+"":this.myRanking.text=this.myRanking.text=LangMgr.getValueByKey("guanNoRank")}else this.myRanking.text=LangMgr.getValueByKey("guanNoRank");switch(t){case 12:this.myAttrValue.text=RoleModel.getIntensifyTotalLvByType(2)+"";break;case 14:this.myAttrValue.text=DragonSoulDataVo.getLongHunAllLevel()+"";break;case 16:this.myAttrValue.text=FeatherVo.getWingAllLevel()+"";break;case 17:var n=bookControl.getBookPowerNumEx();this.myAttrValue.text=n+"";break;case 18:this.myAttrValue.text=reincarnateControl.lv+"";break;case 19:this.myAttrValue.text=backpackControl.getEquipsScoreByRolesOfBody()+"";break;case 21:this.myAttrValue.text=amusementControl.myDabiaoInfo?amusementControl.myDabiaoInfo:0;break;case 24:this.myAttrValue.text=amusementControl.myDabiaoInfo?amusementControl.myDabiaoInfo:0;break;case 0:this.myAttrValue.text=ActorControl.power+"";break;case 25:this.myAttrValue.text=""+runeControl.totalPower;break;case 26:this.myAttrValue.text=""+superRingControl.totalPower}e.setValueUnit(this.myAttrValue,t)},e.prototype.updateData=function(){var t=DataCenter.ins().Amusement4Config[this.activityID][0].rankType;21==t||24==t?this.currentState="hefu":this.currentState="kaifu",this.validateNow();var e=DataCenter.ins().AmusementConfig[this.activityID],i=DataCenter.ins().Amusement4Config[this.activityID],n=this.model?this.model.getDataList():amusementControl.rankInfoList;if(n){var o=amusementControl.getAmusementDataById(this.activityID),s=Math.floor((DateUtils.formatMiniDateTime(o.startTime)-GameServer.serverTime)/1e3),r=Math.floor((DateUtils.formatMiniDateTime(o.endTime)-GameServer.serverTime)/1e3);s>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=r?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=r,this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(r,DateUtils.TIME_FORMAT_5,3)),this.actDesc.text=e.desc,21==t||24==t?this.costRank(n,i,t):this.normalRank(n,i);
var a=DataCenter.ins().AmusementBtnConfig[this.activityID];switch(a&&(this.title.source=a.title),t){case 12:this.attr.text=LangMgr.getValueByKey("osaLevelAllType1");break;case 14:this.attr.text=LangMgr.getValueByKey("osaLevelAllType2");break;case 16:this.attr.text=LangMgr.getValueByKey("osaLevelAllType3");break;case 17:this.attr.text=LangMgr.getValueByKey("osaLevelAllType4");break;case 18:this.attr.text=LangMgr.getValueByKey("osaLevelAllType5");break;case 19:this.attr.text=LangMgr.getValueByKey("osaLevelAllType6");break;case 21:this.attr.text=LangMgr.getValueByKey("osaLevelAllType7");break;case 24:this.attr.text=LangMgr.getValueByKey("osaLevelAllType8");break;case 0:this.attr.text=LangMgr.getValueByKey("lvAct2");break;case 25:this.attr.text=LangMgr.getValueByKey("lvAct4");break;case 26:this.attr.text=LangMgr.getValueByKey("lvAct5")}if(DataCenter.ins().Amusement4Config[this.activityID][0].titleEffName){this.titleName.visible=!1;var l=DataCenter.ins().Amusement4Config[this.activityID][0].titleEffName;this.titleEffNameMc.playFile(PATH_EFF+l,-1),this.titleEffNameMc.y=this.titleEffGroup.y}else this.titleName.visible=!0,this.titleName.source=DataCenter.ins().Amusement4Config[this.activityID][0].titleName}},e.prototype.getRewards=function(t){for(var e=[],i=heroControl.getSubRoleByIndex(0).job,n=0;n<t.length;n++){var o=t[n];o.job?o.job==i&&e.push(o):e.push(o)}return e},e.prototype.costRank=function(t,i,n){for(var o=0;4>o;o++){this["name"+o]&&(this["name"+o].visible=!1),this["name"+o+"1"]&&(this["name"+o+"1"].visible=!1);var s=o+1;24!=n&&(2==o?s=4:3==o&&(s=6));var r=i[s];r.range&&this["rank"+(o+1)]&&(r.range[0]==r.range[1]?this["rank"+(o+1)].text=LangMgr.getValueByKey("ranking",r.range[0]):this["rank"+(o+1)].text=LangMgr.getValueByKey("ranking",r.range[0]+"-"+r.range[1])),this["reward"+o].dataProvider=new eui.ArrayCollection(this.getRewards(r.rewards)),this["attrValue"+o]&&(this["attrValue"+o].visible=!!r.value,this["attrValue"+o].text=LangMgr.getValueByKey("osaNeed",r.value),e.setValueUnit(this["attrValue"+o],r.rankType))}var a={idx:1},l=amusementControl.getAmusementDataById(this.activityID);for(var h in t){var u=t[h],s=l.getCostRank(u,a),p=i[s];if(s&&p&&!(s>5))if(1==s)u&&(this.name0.visible=!0,this.attrValue0.visible=this.name0.visible,this.model?(this.name0.text=u.player,this.attrValue0.text=u.value):(this.name0.text=u.name,this.attrValue0.text=LangMgr.getValueByKey("osaConsume")+u.numType),e.setValueUnit(this.attrValue0,p.rankType));else{var c="";if(2==s)c="name1";else if(3==s)24!=n?(c="name11",this.attrValue1.visible=!1):c="name2";else if(4==s)24!=n?c="name2":(c="name3",this.rank4.verticalCenter=-23);else{if(5!=s)continue;24!=n?(c="name21",this.attrValue2.visible=!1):(c="name31",this.attrValue3.visible=!1)}p=i[s];var d=this[c];d&&(d.visible=!0,this.model?d.text=u.player:d.text=u.name)}}var g=i[24!=n?6:4];this.reward3.dataProvider=new eui.ArrayCollection(this.getRewards(g.rewards)),this.model&&this.model.selfPos?(this.model.selfPos<=20?this.myRanking.text=this.model.selfPos+"":this.myRanking.text=LangMgr.getValueByKey("guanNoRank"),t[this.model.selfPos-1]?this.myAttrValue.text=t[this.model.selfPos-1].value:this.setMyRank()):this.setMyRank()},e.prototype.normalRank=function(t,i){for(var n=i[0]?i[0].rankType:-1,o=1;3>=o;o++){var s=t[o-1];s?(this["name"+(o-1)].visible=!0,this["attrValue"+(o-1)].visible=this["name"+(o-1)].visible,this.model?(this["name"+(o-1)].text=s.player,0==n?this["attrValue"+(o-1)].text=s.power:this["attrValue"+(o-1)].text=s.value):(this["name"+(o-1)].text=s.name,this["attrValue"+(o-1)].text=LangMgr.getValueByKey("osaConsume")+s.numType),e.setValueUnit(this["attrValue"+(o-1)],n)):(this["name"+(o-1)].visible=!1,this["attrValue"+(o-1)].visible=this["name"+(o-1)].visible);var r=i[o];this["reward"+(o-1)].dataProvider=new eui.ArrayCollection(this.getRewards(r.rewards))}var a=i[4];this.reward3.dataProvider=new eui.ArrayCollection(this.getRewards(a.rewards)),this.model&&this.model.selfPos?(this.model.selfPos<=20?this.myRanking.text=this.model.selfPos+"":this.myRanking.text=LangMgr.getValueByKey("guanNoRank"),t[this.model.selfPos-1]?(0==n?this.myAttrValue.text=t[this.model.selfPos-1].power:this.myAttrValue.text=t[this.model.selfPos-1].value,e.setValueUnit(this.myAttrValue,n)):this.setMyRank()):this.setMyRank()},e.setValueUnit=function(t,e){if(t&&""!=t.text)switch(e){case 12:t.text+=LangMgr.getValueByKey("numberLevel","");break;case 14:t.text+=LangMgr.getValueByKey("roleStart");break;case 16:t.text+=LangMgr.getValueByKey("osaLevelJ");break;case 18:t.text+=LangMgr.getValueByKey("numberRotation","")}},e}(BasePanel);__reflect(AmuseTarget4Panel1.prototype,"AmuseTarget4Panel1");var AmuseTarget4Panel2=function(t){function e(){var e=t.call(this)||this;return e._time=0,e.skinName="AmuseTarget4Panel2Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.reward0.itemRenderer=ItemBase,this.reward1.itemRenderer=ItemBase,this.reward2.itemRenderer=ItemBase,this.titleEffNameMc||(this.titleEffNameMc=new GameMovieClip),this.titleEffNameMc.parent||this.titleEffGroup.addChild(this.titleEffNameMc),this.titleEffNameMc.x=this.titleEffGroup.x,this.titleEffNameMc.y=this.titleEffGroup.y},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.seek,this.onTap),this.addEventTouchTap(this.seeRewardBtn,this.onTap),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),t&&(this.model=t[0]),this.addCustomEvent(394,this.updateData),amusementControl.upDabiaoInfo(this.activityID)},e.prototype.setTime=function(){var t=amusementControl.getAmusementDataById(this.activityID);t&&(this._time=t.getLeftTime(),this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.seek,this.onTap),this.removeEventTouchTap(this.seeRewardBtn,this.onTap),TimerMgr.ins().removeAll(this),this.removeCustomEvents()},e.prototype.onTap=function(t){switch(t.target){case this.seek:var e=DataCenter.ins().Amusement4Config[this.activityID][0].rankType,i=void 0,n=void 0;i=this.model?this.model.getDataList():amusementControl.rankInfoList,n=Math.min(i.length,50);for(var o=[],s=amusementControl.getAmusementDataById(this.activityID),r={idx:1},a=0;n>a;a++){var l=i[a],h=s.getCostRank(l,r);o.push({rankData:i[a],activityID:this.activityID,rank:h})}UIMgr.ins().open(AmuseRankTipsView,o,e);break;case this.seeRewardBtn:UIMgr.ins().open(AmuseTarget4PanelRankRewardView,this.activityID)}},e.prototype.setMyRank=function(){this.myAttrValue.text=LangMgr.getValueByKey("osaEmpty");var t=DataCenter.ins().Amusement4Config[this.activityID][0].rankType;if(21==t)if(null==amusementControl.myPaiming||0==amusementControl.myPaiming)this.myRanking.text=LangMgr.getValueByKey("guanNoRank");else{var e=amusementControl.getAmusementDataById(this.activityID);e.myPaiming?this.myRanking.text=e.myPaiming+"":this.myRanking.text=LangMgr.getValueByKey("guanNoRank")}else this.myRanking.text=LangMgr.getValueByKey("guanNoRank");switch(t){case 12:this.myAttrValue.text=RoleModel.getIntensifyTotalLvByType(2)+"";break;case 14:this.myAttrValue.text=DragonSoulDataVo.getLongHunAllLevel()+"";break;case 16:this.myAttrValue.text=FeatherVo.getWingAllLevel()+"";break;case 17:var i=bookControl.getBookPowerNumEx();this.myAttrValue.text=i+"";break;case 18:this.myAttrValue.text=reincarnateControl.lv+"";break;case 19:this.myAttrValue.text=backpackControl.getEquipsScoreByRolesOfBody()+"";break;case 21:this.myAttrValue.text=amusementControl.myDabiaoInfo?amusementControl.myDabiaoInfo:0}AmuseTarget4Panel1.setValueUnit(this.myAttrValue,t)},e.prototype.updateData=function(){var t=DataCenter.ins().Amusement4Config[this.activityID][0].rankType;21==t?this.currentState="hefu":this.currentState="kaifu",this.validateNow();var e,i=DataCenter.ins().AmusementConfig[this.activityID],n=DataCenter.ins().Amusement4Config[this.activityID];if(e=this.model?this.model.getDataList():amusementControl.rankInfoList){var o=amusementControl.getAmusementDataById(this.activityID),s=Math.floor((DateUtils.formatMiniDateTime(o.startTime)-GameServer.serverTime)/1e3),r=Math.floor((DateUtils.formatMiniDateTime(o.endTime)-GameServer.serverTime)/1e3);s>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=r?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=r,this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(r,DateUtils.TIME_FORMAT_5,3)),this.actDesc.text=i.desc,21==t?this.costRank(e,n):this.normalRank(e,n);var a=DataCenter.ins().AmusementBtnConfig[this.activityID];switch(a&&(this.title.source=a.title),t){case 12:this.attr.text=LangMgr.getValueByKey("osaLevelAllType1");break;case 14:this.attr.text=LangMgr.getValueByKey("osaLevelAllType2");break;case 16:this.attr.text=LangMgr.getValueByKey("osaLevelAllType3");break;case 17:this.attr.text=LangMgr.getValueByKey("osaLevelAllType4");break;case 18:this.attr.text=LangMgr.getValueByKey("osaLevelAllType5");break;case 19:this.attr.text=LangMgr.getValueByKey("osaLevelAllType6");break;case 21:this.attr.text=LangMgr.getValueByKey("osaLevelAllType7")}if(DataCenter.ins().Amusement4Config[this.activityID][0].titleEffName){var l=DataCenter.ins().Amusement4Config[this.activityID][0].titleEffName;this.titleEffNameMc.playFile(PATH_EFF+l,-1)}else this.titleName.source=DataCenter.ins().Amusement4Config[this.activityID][0].titleName}},e.prototype.costRank=function(t,e){for(var i=0;3>i;i++){this["name"+i]&&(this["name"+i].visible=!1),this["name"+i+"1"]&&(this["name"+i+"1"].visible=!1);var n=i+1,o=e[n];this["reward"+i].dataProvider=new eui.ArrayCollection(o.rewards),this["attrValue"+i]&&(this["attrValue"+i].visible=!0,this["attrValue"+i].text=LangMgr.getValueByKey("osaNeed",o.value),AmuseTarget4Panel1.setValueUnit(this["attrValue"+i],o.rankType))}var s={idx:1},r=amusementControl.getAmusementDataById(this.activityID);for(var a in t){var l=t[a],h=r.getCostRank(l,s),o=e[h];if(h&&o&&!(h>3))if(1==h)l&&(this.name0.visible=!0,this.attrValue0.visible=this.name0.visible,this.model?(this.name0.text=l.player,this.attrValue0.text=l.value,AmuseTarget4Panel1.setValueUnit(this.attrValue0,o.rankType)):(this.name0.text=l.name,this.attrValue0.text=LangMgr.getValueByKey("osaConsume")+l.numType));else{var u="";if(2==h)u="name1";else if(3==h)u="name2";else if(4==h)u="";else{if(5!=h)continue;u=""}o=e[h];var p=this[u];p.visible=!0,this.model?p.text=l.player:p.text=l.name}}this.model&&this.model.selfPos?(this.model.selfPos<=50?this.myRanking.text=this.model.selfPos+"":this.myRanking.text=LangMgr.getValueByKey("guanNoRank"),t[this.model.selfPos-1]?this.myAttrValue.text=t[this.model.selfPos-1].value:this.setMyRank()):this.setMyRank()},e.prototype.normalRank=function(t,e){for(var i=1;3>=i;i++){var n=t[i-1];n?(this["name"+(i-1)].visible=!0,this["attrValue"+(i-1)].visible=this["name"+(i-1)].visible,this.model?(this["name"+(i-1)].text=n.player,this["attrValue"+(i-1)].text=n.value):(this["name"+(i-1)].text=n.name,this["attrValue"+(i-1)].text=LangMgr.getValueByKey("osaConsume")+n.numType,AmuseTarget4Panel1.setValueUnit(this["attrValue"+(i-1)],e[0].rankType))):(this["name"+(i-1)].visible=!1,this["attrValue"+(i-1)].visible=this["name"+(i-1)].visible);var o=e[i];this["reward"+(i-1)].dataProvider=new eui.ArrayCollection(o.rewards)}this.model&&this.model.selfPos?(this.model.selfPos<=50?this.myRanking.text=this.model.selfPos+"":this.myRanking.text=LangMgr.getValueByKey("guanNoRank"),t[this.model.selfPos-1]?(this.myAttrValue.text=t[this.model.selfPos-1].value,AmuseTarget4Panel1.setValueUnit(this.myAttrValue,e[0].rankType)):this.setMyRank()):this.setMyRank()},e}(BasePanel);__reflect(AmuseTarget4Panel2.prototype,"AmuseTarget4Panel2");var AmuseTarget4Panel3=function(t){function e(){var e=t.call(this)||this;return e.maxRank=0,e.rankDtList=[],e.skinName="AmuseTarget4Panel3Skin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&(this.model=t[0]),this.rankList.itemRenderer=AmuseTarget4Panel3ItemRender,this.player.touchChildren=!1,DisplayUtils.removeFromParent(this.guildName),this.title.source=null,this.addEventTouchTap(this.gotoBtn,this.onTouch),this.addEventTouchTap(this.player,this.onTouch),this.addEventTouchTap(this.roleName,this.onTouch),this.addEventTouchTap(this.seeRule,this.onTouch),this.addCustomEvent(478,this.onPlayer),this.addCustomEvent(394,this.updateData),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData(),this.setTime(),amusementControl.upDabiaoInfo(this.activityID)},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.removeCustomEvents()},e.prototype.setTime=function(){this.activityData&&(this.actTime.text=DateUtils.getFormatBySecond(this.activityData.getLeftTime(),DateUtils.TIME_FORMAT_5,3))},e.prototype.onPlayer=function(t){e.isDisRankRoleView?UIMgr.ins().open(RankRoleView,t):(t.guildName&&(this.guildName.text=t.guildName,this.roleName.parent.addChild(this.guildName)),this.roleName.text=t.name,this.player&&this.player.setRole(t.roleData[0]))},e.prototype.updateData=function(){this.initUIInfo(),this.rankDtList.sort(function(t,e){return t.rankIndex>e.rankIndex?1:-1}),this.rankList.dataProvider=new eui.ArrayCollection(this.rankDtList);for(var t=-1,e=0;e<this.rankDtList.length;e++)if(this.rankDtList[e].id==ActorControl.actorID){t=this.rankDtList[e].rankIndex;break}this.myRanking.text=t>0?t+"":LangMgr.getValueByKey("guanNoRank");var i=null,n=this.baseActConfig.rankType;switch(n){case 12:i=RoleModel.getIntensifyTotalLvByType(2)+"";break;case 14:i=DragonSoulDataVo.getLongHunAllLevel()+"";break;case 16:i=FeatherVo.getWingAllLevel()+"";break;case 17:i=bookControl.getBookPowerNumEx()+"";break;case 18:i=reincarnateControl.lv+"";break;case 19:i=backpackControl.getEquipsScoreByRolesOfBody()+"";break;case 26:i=superRingControl.totalPower+"";break;case 21:i=amusementControl.myDabiaoInfo?amusementControl.myDabiaoInfo:0}this.myAttrValue.text=i?i:LangMgr.getValueByKey("osaEmpty"),AmuseTarget4Panel1.setValueUnit(this.myAttrValue,n)},e.prototype.onTouch=function(t){switch(t.target){case this.seeRule:var i=AmusementPanel.getAmusementConfig(this.activityID);HelpControl.openHelpWin(i.helpInfo);break;case this.gotoBtn:CommonFun.openWin(this.baseActConfig.targetWin);break;case this.player:case this.roleName:this.firstMode&&(e.isDisRankRoleView=!0,rankOtherUserControl.upFindPlayer(this.firstMode.id))}},e.prototype.initUIInfo=function(){this.activityData=amusementControl.getAmusementDataById(this.activityID),e.actCfg=DataCenter.ins().Amusement4Config[this.activityID],this.baseActConfig=e.actCfg[0],this.maxRank=Object.keys(e.actCfg).length-1;var t;if(t=this.model?this.model.getDataList():amusementControl.rankInfoList)switch(this.rankDtList=t?t.slice(0,this.maxRank):[],this.firstMode=t[0],e.isDisRankRoleView=!1,this.firstMode&&rankOtherUserControl.upFindPlayer(this.firstMode.id),this.baseActConfig.titleEffName?(this.titleMc=this.titleMc||new GameMovieClip,this.titleMc.playFile(PATH_EFF+this.baseActConfig.titleEffName,-1),this.titleEff.addChild(this.titleMc)):this.baseActConfig.titleName&&(this.title.source=this.baseActConfig.titleName),this.desc.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().AmusementConfig[this.activityID].desc),this.baseActConfig.rankType){case 12:this.attr.text=LangMgr.getValueByKey("osaLevelAllType1");break;case 14:this.attr.text=LangMgr.getValueByKey("osaLevelAllType2");break;case 16:this.attr.text=LangMgr.getValueByKey("osaLevelAllType3");break;case 17:this.attr.text=LangMgr.getValueByKey("osaLevelAllType4");break;case 18:this.attr.text=LangMgr.getValueByKey("osaLevelAllType5");break;case 19:this.attr.text=LangMgr.getValueByKey("osaLevelAllType6");break;case 21:this.attr.text=LangMgr.getValueByKey("osaLevelAllType7");break;case 26:this.attr.text=LangMgr.getValueByKey("osaLevelAllType9")}},e.isDisRankRoleView=!1,e}(AmusementPanel);__reflect(AmuseTarget4Panel3.prototype,"AmuseTarget4Panel3");var AmuseTarget4PanelRankRewardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget4PanelRankRewardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.bgClose,this.onTap),this.activityID=t,this.list.itemRenderer=AmuseTarget4PanelRankRewardItemRender,this.listdata=new eui.ArrayCollection,this.list.dataProvider=this.listdata,this.updateData()},e.prototype.onTap=function(){UIMgr.ins().close(this)},e.prototype.updateData=function(){var t=DataCenter.ins().Amusement4Config[this.activityID],e=[];for(var i in t)if(t[i].range){var n="";n=t[i].range[0]==t[i].range[1]?""+t[i].range[0]:t[i].range[0]+"-"+t[i].range[1];var o=t[i].value?LangMgr.getValueByKey("kfLookRank",t[i].value):"",s=t[i].rewards,r={rank:n,desc:o,rewards:s};e.push(r)}this.listdata.replaceAll(e);var a=this.list.parent;a.stopAnimation(),this.list.scrollV=0},e}(BaseEuiView);__reflect(AmuseTarget4PanelRankRewardView.prototype,"AmuseTarget4PanelRankRewardView");var AmuseTarget5Panel1=function(t){function e(){var e=t.call(this)||this;return e.itemary=[],e.dayindex=1,e.itemList=[],e.skinName="AmuseTarget5Panel1Skin",e.itemary=[],e}return __extends(e,t),e.prototype.initData=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().Amusement5Config[this.activityID];this.maxNum=0,this.itemList=[];for(var n=0;7>n;n++)this.itemList[n]=this["dayNum"+(n+1)],this.itemList[n].touchEnabled=!1,i[n+1]?(this["dayNum"+(n+1)]&&(this["dayNum"+(n+1)].visible=!0),this["imgDay"+(n+1)]&&(this["imgDay"+(n+1)].visible=!0),this["arrow"+(n+2)]&&(this["arrow"+(n+2)].visible=!0),this.maxNum++):(this["dayNum"+(n+1)]&&(this["dayNum"+(n+1)].visible=!1),this["imgDay"+(n+1)]&&(this["imgDay"+(n+1)].visible=!1),this["arrow"+(n+2)]&&(this["arrow"+(n+2)].visible=!1));this._activityData=amusementControl.getAmusementDataById(this.activityID),this.addEventTouchTap(this.suerBtn,this.onTouch);for(var n=0;n<this.maxNum;n++)this.addEventTouchTap(this.itemList[n],this.itemTouch);this.addCustomEvent(392,this.changeList),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData();var o=t[0];o&&this.setList(o)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.suerBtn,this.onTouch),DisplayUtils.removeFromParent(this.btnMC);for(var i=0;i<this.maxNum;i++)this.removeEventTouchTap(this.itemList[i],this.itemTouch);this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.changeList=function(){var t=1,e=this._activityData.getCurDay();e||(e=t),t=e>=this.maxNum?this.maxNum:e;for(var i=1;t>=i;i++){var n=DataCenter.ins().Amusement5Config[this.activityID][i+""];if(n&&e>=n.day&&0==(this._activityData.recrod>>n.day&1))return void this.setList(i)}this.setList(t+1)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.suerBtn:this._activityData.getCurDay()>=this.day?amusementControl.upReward(this.activityID,this.day):tipsControl.showTips(LangMgr.getValueByKey("osaNoLoadingDay"))}},e.prototype.itemTouch=function(t){this.setList(t.currentTarget.data)},e.prototype.setList=function(t){void 0===t&&(t=-1),-1==t&&(t=this.dayindex),t>this.maxNum&&(t=this.maxNum),this.dayindex=t;var e=DataCenter.ins().Amusement5Config[this.activityID][t+""],i=e.rewards;this.day=e.day;var n=1;n=this._activityData.getCurDay(),this.daylabel.text=LangMgr.getValueByKey("osaLoadDay",n),this.daylabel.visible=!0;var o=1==(this._activityData.recrod>>this.day&1);this.dayaward.text=LangMgr.getValueByKey("osaDesIndex",TextUtils.getChineseNum(t)),this.suerBtn.visible=!0,n>=this.day?o?(this.daylabel.visible=!1,this.suerBtn.visible=!1,this.redPoint.visible=!1):(this.btnMC=this.btnMC||new GameMovieClip,this.btnMC.x=this.suerBtn.width/2,this.btnMC.y=this.suerBtn.height/2,this.btnMC.playFile(PATH_EFF+"chargeff1",-1),this.suerBtn.addChild(this.btnMC),this.redPoint.visible=!0):(DisplayUtils.removeFromParent(this.btnMC),this.suerBtn.visible=!1,this.redPoint.visible=!1),this.itemary.forEach(function(t){t.parent&&(t.parent.removeChild(t),t=null)}),this.itemary=[];for(var s=0;s<i.length;s++){var r=new ItemBase;this.group1.addChild(r),r.data=i[s],this.itemary.push(r)}for(var s=0;s<this.maxNum;s++)this.itemList[s].activityID=this.activityID,this.itemList[s].data=s+1,s+1==t||s+1==this.maxNum&&t==this.maxNum?this.itemList[s].setSelectImg(!0):this.itemList[s].setSelectImg(!1);this.showRedPoint()},e.prototype.showRedPoint=function(){},e.prototype.updateData=function(){this.changeList(),this.showRedPoint(),this.setTime()},e.prototype.setTime=function(){if(this._activityData){var t=Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)}},e}(BasePanel);__reflect(AmuseTarget5Panel1.prototype,"AmuseTarget5Panel1");var ActivityHFRenderItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="SevenDayItemRenderSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.activityID,e=amusementControl.getAmusementDataById(t),i=DataCenter.ins().Amusement5Config[t][this.data+""];if(i){var n=e&&1==(e.recrod>>i.day&1);n?(this.select.visible=!1,this.checkedMask.visible=this.checked.visible=!0):this.checkedMask.visible=this.checked.visible=!1,this.item.data=i.rewards[0]}},e}(SevenDayItemRender);__reflect(ActivityHFRenderItem.prototype,"ActivityHFRenderItem");var AmuseTarget5Panel2=function(t){function e(){var e=t.call(this)||this;return e.itemary=[],e.dayindex=1,e.itemList=[],e.skinName="AmuseTarget5Panel2Skin",e.itemary=[],e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().Amusement5Config[this.activityID];this.maxNum=0,this.itemList=[];for(var n=0;3>n;n++)this.itemList[n]=this["dayNum"+(n+1)],this.itemList[n].touchEnabled=!1,i[n+1]?(this["dayNum"+(n+1)]&&(this["dayNum"+(n+1)].visible=!0),this["imgDay"+(n+1)]&&(this["imgDay"+(n+1)].visible=!0),this["arrow"+(n+1)]&&(this["arrow"+(n+1)].visible=!0),this.maxNum++):(this["dayNum"+(n+1)]&&(this["dayNum"+(n+1)].visible=!1),this["imgDay"+(n+1)]&&(this["imgDay"+(n+1)].visible=!1),this["arrow"+(n+1)]&&(this["arrow"+(n+1)].visible=!1));this._activityData=amusementControl.getAmusementDataById(this.activityID),this.addEventTouchTap(this.suerBtn,this.onTouch),this.addEventTouchTap(this.group,this.onTouch);for(var n=0;n<this.maxNum;n++)this.addEventTouchTap(this.itemList[n],this.itemTouch);this.addCustomEvent(392,this.changeList),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData();var o=t[0];o&&this.setList(o)},e.prototype.setTime=function(){if(this._activityData){var t=Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.suerBtn,this.onTouch),this.removeEventTouchTap(this.group,this.onTouch),DisplayUtils.removeFromParent(this.btnMC);for(var i=0;i<this.maxNum;i++)this.removeEventTouchTap(this.itemList[i],this.itemTouch);this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.changeList=function(){var t=1,e=this._activityData.getCurDay();e||(e=t),t=e>=this.maxNum?this.maxNum:e;for(var i=1;t>=i;i++){var n=DataCenter.ins().Amusement5Config[this.activityID][i+""];if(n&&e>=n.day&&0==(this._activityData.recrod>>n.day&1))return void this.setList(i)}this.setList(t+1)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.group:this.setList(this.group.getChildIndex(t.target));break;case this.suerBtn:this._activityData.getCurDay()>=this.day?amusementControl.upReward(this.activityID,this.day):tipsControl.showTips(LangMgr.getValueByKey("osaNoLoadingDay"))}},e.prototype.itemTouch=function(t){this.setList(t.currentTarget.data)},e.prototype.setList=function(t){void 0===t&&(t=-1),-1==t&&(t=this.dayindex),t>this.maxNum&&(t=this.maxNum),this.dayindex=t;var e=DataCenter.ins().Amusement5Config[this.activityID][t+""],i=e.rewards;this.day=e.day;var n=1;n=this._activityData.getCurDay(),this.daylabel.text=LangMgr.getValueByKey("osaLoadDay",n),this.daylabel.visible=!0;var o=1==(this._activityData.recrod>>this.day&1);this.dayaward.text=LangMgr.getValueByKey("osaDesIndex",TextUtils.getChineseNum(t)),this.suerBtn.visible=!0,n>=this.day?o?(this.daylabel.visible=!1,this.suerBtn.visible=!1,this.redPoint.visible=!1):(this.btnMC=this.btnMC||new GameMovieClip,this.btnMC.x=this.suerBtn.width/2,this.btnMC.y=this.suerBtn.height/2,this.btnMC.playFile(PATH_EFF+"chargeff1",-1),this.suerBtn.addChild(this.btnMC),this.redPoint.visible=!0):(DisplayUtils.removeFromParent(this.btnMC),this.suerBtn.visible=!1,this.redPoint.visible=!1),this.itemary.forEach(function(t){t.parent&&(t.parent.removeChild(t),t=null)}),this.itemary=[];for(var s=0;s<i.length;s++){var r=new ItemBase;this.group1.addChild(r),r.data=i[s],this.itemary.push(r)}for(var s=0;s<this.maxNum;s++)this.itemList[s].activityID=this.activityID,this.itemList[s].data=s+1,s+1==t||s+1==this.maxNum&&t==this.maxNum?this.itemList[s].setSelectImg(!0):this.itemList[s].setSelectImg(!1);this.showRedPoint()},e.prototype.showRedPoint=function(){},e.prototype.updateData=function(){this.changeList(),this.showRedPoint(),this.setTime()},e}(BasePanel);__reflect(AmuseTarget5Panel2.prototype,"AmuseTarget5Panel2");var AmuseTarget5Panel3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemary=[],e.itemList=[],e.dayindex=1,e}return __extends(e,t),Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t},enumerable:!0,configurable:!0}),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget5Panel3Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin();var i=DataCenter.ins().Amusement5Config[this.activityID];this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.itemList=[],this.maxNum=Object.keys(i).length;for(var n=0;n<this.maxNum;n++){this.itemList[n]=this["dayNum"+(n+1)],this.addEventTouchTap(this.itemList[n],this.itemTouch);var o=this.itemList[n].item;o.nameTxt.visible=!1}this._activityData=amusementControl.getAmusementDataById(this.activityID),this.addEventTouchTap(this.suerBtn,this.onTouch),this.addCustomEvent(392,this.changeList),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData();var s=t[0];s&&this.setList(s)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.suerBtn,this.onTouch),DisplayUtils.removeFromParent(this.btnMC);for(var i=0;i<this.maxNum;i++)this.removeEventTouchTap(this.itemList[i],this.itemTouch);this.itemList.length=0,this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.changeList=function(){var t=1,e=this._activityData.getCurDay();e||(e=t),t=e>=this.maxNum?this.maxNum:e;for(var i=1;t>=i;i++){var n=DataCenter.ins().Amusement5Config[this.activityID][i+""];if(e>=n.day&&0==(this._activityData.recrod>>n.day&1))return void this.setList(i)}this.setList(t+1)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.suerBtn:this._activityData.getCurDay()>=this.day?amusementControl.upReward(this.activityID,this.day):tipsControl.showTips(LangMgr.getValueByKey("osaNoLoadingDay"))}},e.prototype.itemTouch=function(t){this.setList(t.currentTarget.data)},e.prototype.setList=function(t){void 0===t&&(t=-1),-1==t&&(t=this.dayindex),t>this.maxNum&&(t=this.maxNum),this.dayindex=t;var e=DataCenter.ins().Amusement5Config[this.activityID][t+""],i=e.rewards;this.day=e.day;var n=1;n=this._activityData.getCurDay(),this.daylabel.text=LangMgr.getValueByKey("osaLoadDay",n);var o=1==(this._activityData.recrod>>this.day&1);this.dayaward.text=LangMgr.getValueByKey("osaDesIndex",TextUtils.getChineseNum(t)),this.suerBtn.visible=!0,this.done.visible=!1,n>=this.day?o?(this.suerBtn.visible=!1,this.redPoint.visible=!1,this.done.visible=!0):(this.btnMC=this.btnMC||new GameMovieClip,this.btnMC.x=this.suerBtn.width/2,this.btnMC.y=this.suerBtn.height/2,this.btnMC.playFile(PATH_EFF+"chargeff1",-1),this.suerBtn.addChild(this.btnMC),this.redPoint.visible=!0):(DisplayUtils.removeFromParent(this.btnMC),this.suerBtn.visible=!1,this.redPoint.visible=!1),this.itemary.forEach(function(t){t.parent&&(t.parent.removeChild(t),t=null)}),this.itemary=[];for(var s=0;s<i.length;s++){var r=new ItemBase;this.group1.addChild(r),r.data=i[s],this.itemary.push(r)}for(var s=0;s<this.maxNum;s++)this.itemList[s].activityID=this.activityID,this.itemList[s].data=s+1,s+1==t||s+1==this.maxNum&&t==this.maxNum?this.itemList[s].setSelectImg(!0):this.itemList[s].setSelectImg(!1)},e.prototype.updateData=function(){this.changeList(),this.setTime()},e.prototype.setTime=function(){if(this._activityData){var t=Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime1.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime1.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime1.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)}},e}(BasePanel);__reflect(AmuseTarget5Panel3.prototype,"AmuseTarget5Panel3");var AmuseTarget6Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget6PanelSkin",e.maxIndex=0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.goBtn,this.onTap),this.addCustomEvent(393,this.GetCallBack);for(var i=1;3>=i;i++)this.addEventTouchTap(this["boss"+i],this.onClick);this.maxIndex=0;for(var n in DataCenter.ins().Amusement6Config[this.activityID])this.maxIndex++;var o=this.getRule();this.updateData(o)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.leftBtn,this.onTap),this.removeEventTouchTap(this.rightBtn,this.onTap),this.removeEventTouchTap(this.goBtn,this.onTap),this.removeCustomEvents()},e.prototype.onClick=function(t){for(var e=1;3>=e;e++)if(t.currentTarget==this["boss"+e]){var i=this.calcIndex(this.index),n=DataCenter.ins().Amusement6Config[this.activityID][i];n&&n.bossID&&n.jump&&UIMgr.ins().open(n.jump[0][0],n.jump[0][1],n.bossID[e-1][0]);break}},e.prototype.onTap=function(t){var e,i;switch(t.currentTarget){case this.leftBtn:if(--this.index,i=this.calcIndex(this.index),!i)return;e=DataCenter.ins().Amusement6Config[this.activityID][i],(!e||this.index-1<=0)&&(this.index=1,this.leftBtn.visible=!1),this.rightBtn.visible=!0,this.updateData(this.index);break;case this.rightBtn:if(++this.index,i=this.calcIndex(this.index),!i)return;e=DataCenter.ins().Amusement6Config[this.activityID][i],(!e||this.index+1>this.maxIndex)&&(this.index=this.maxIndex,this.rightBtn.visible=!1),this.leftBtn.visible=!0,this.updateData(this.index);break;case this.goBtn:if(i=this.calcIndex(this.index),!i)return;this.goBtn.label==LangMgr.getValueByKey("osaGoKill")?(UIMgr.ins().close(AmusementTotalEnterView),e=DataCenter.ins().Amusement6Config[this.activityID][i],e&&e.bossID&&e.jump&&UIMgr.ins().open(e.jump[0][0],e.jump[0][1],e.bossID[0][0])):amusementControl.upReward(this.activityID,i)
}},e.prototype.GetCallBack=function(t){if(this.activityID==t){if(!amusementControl.isSuccee)if(backpackControl.getSurplusCount()){tipsControl.showTips(LangMgr.getValueByKey("getFaile"));var e=amusementControl.getAmusementDataById(this.activityID);amusementControl.upChangePage(e.id)}else tipsControl.showTips(LangMgr.getValueByKey("osaBackNoSpace"));amusementControl.isSuccee=!1;var i=this.getRule();this.updateData(i)}},e.prototype.sortRule=function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:0},e.prototype.getRule=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().Amusement6Config[this.activityID],i=0,n=0,o=!1,s=[];for(var r in e)s.push(e[r]);s.sort(this.sortRule);for(var a in s){var l=this.calcIndex(Number(a)),h=t.getBossGroupGiftIndex(s[a]),u=t.getBossGroup(t.rewardsBossSum[l],s[a]);if(h==AmusementControl.Geted);else{if(u==AmusementControl.KILL&&h==AmusementControl.CanGet){(!i||s[a].sort<i)&&(i=s[a].sort,o=!0);break}if(u==AmusementControl.NOKILL&&h==AmusementControl.CanGet){(!n||s[a].sort<n)&&(n=s[a].sort);break}}if(o)break}var p=0;return p=i?i:n,p=p?p:s[0].sort},e.prototype.updateData=function(t){if(void 0===t&&(t=1),t>this.maxIndex)return void(this.index=this.maxIndex);this.index=t;var e=this.calcIndex(this.index);if(e){var i=amusementControl.getAmusementDataById(this.activityID),n=Math.floor((DateUtils.formatMiniDateTime(i.startTime)-GameServer.serverTime)/1e3),o=Math.floor((DateUtils.formatMiniDateTime(i.endTime)-GameServer.serverTime)/1e3);n>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=o?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(o,DateUtils.TIME_FORMAT_5,3),this.actInfo.text=DataCenter.ins().AmusementConfig[this.activityID].desc;for(var s=heroControl.getSubRoleByIndex(0),r=DataCenter.ins().Amusement6Config[this.activityID][e],a=0,l=0;l<r.rewards.length&&this["item"+a];l++){var h=r.rewards[l];h.job&&s.job!=h.job||(this["item"+a].data={type:h.type,count:h.count,id:h.id},this["item"+a].visible=!0,a++)}for(var u=a;4>u;u++)this["item"+u].visible=!1;for(var p=r.bossID,l=0;3>l;l++)if(this["boss"+(l+1)]){var c=p[l][0],d=DataCenter.ins().MonstersConfig[c];this["boss"+(l+1)].source="monhead"+d.head+"_png",this["monName"+l].text=d.name}var g=i.getBossGroupGiftIndex(r),m=i.getBossGroup(i.rewardsBossSum[e],r);this.redPoint.visible=!1,g==AmusementControl.Geted?(this.successBtn.visible=!0,this.goBtn.visible=!1):m==AmusementControl.KILL&&g==AmusementControl.CanGet?(this.goBtn.visible=!0,this.successBtn.visible=!1,this.goBtn.label=LangMgr.getValueByKey("activitGet"),this.redPoint.visible=!0):m==AmusementControl.NOKILL&&g==AmusementControl.CanGet&&(this.goBtn.visible=!0,this.successBtn.visible=!1,this.goBtn.label=LangMgr.getValueByKey("osaGoKill")),this.leftBtn.visible=!0,this.rightBtn.visible=!0,1==this.index?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.index==this.maxIndex&&(this.rightBtn.visible=!1,this.leftBtn.visible=!0);for(var f=i.getBossGroupIndex(i.rewardsBossSum[e],r),l=0;l<f.length;l++)f[l]?this["state"+l].visible=!0:this["state"+l].visible=!1;this.actTitle.source=r.groupName,this.giftTitle.source=r.giftName}},e.prototype.calcSortId=function(t){for(var e in DataCenter.ins().Amusement6Config[this.activityID]){var i=DataCenter.ins().Amusement6Config[this.activityID][e];if(i.index==t)return i.sort}return 0},e.prototype.calcIndex=function(t){for(var e in DataCenter.ins().Amusement6Config[this.activityID]){var i=DataCenter.ins().Amusement6Config[this.activityID][e];if(i.sort==t)return i.index}return 0},e}(AmusementPanel);__reflect(AmuseTarget6Panel.prototype,"AmuseTarget6Panel");var ThreeHeroesControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.downGotAward=function(t){t>0&&(this.awardState=i.Geted,this.dispatchInfoChange())},e.prototype.downAwardInfo=function(t,e,n){this.loginDays=e,this.showIcon3DaysLater=n,AmusementDataFactory.createEx();var o=amusementControl.activityData[10004];if(o){var s=Math.floor((o.startTime-GameServer.serverTime)/1e3),r=Math.floor((o.endTime-GameServer.serverTime)/1e3);0>s&&r>0?(vipControl.lv>=DataCenter.ins().ThreeHeroesConfig.vipLevel?this.awardState=i.Active:this.awardState=i.NotActive,EventMgr.addListener(106,this.updateStateByVip,this),EventMgr.addListener(107,this.updateStateByVip,this)):(this.showIcon3DaysLater?this.loginDays>=DataCenter.ins().ThreeHeroesConfig.loginDays?this.awardState=i.CanGet:this.awardState=i.Active:this.awardState=t?i.Geted:i.NotActive,EventMgr.ins().removeAll(this))}amusementControl.dispatchActivityIsGetAwards(),this.dispatchInfoChange()},e.prototype.updateStateByVip=function(){var t=amusementControl.activityData[10004];if(t){var e=Math.floor((t.startTime-GameServer.serverTime)/1e3),n=Math.floor((t.endTime-GameServer.serverTime)/1e3);0>e&&n>0&&(vipControl.lv>=DataCenter.ins().ThreeHeroesConfig.vipLevel?this.awardState=i.Active:this.awardState=i.NotActive)}this.dispatchInfoChange()},e.prototype.upReward=function(){},e.prototype.dispatchInfoChange=function(){EventMgr.ins().dispatch(451)},e.NotActive=0,e.Active=1,e.CanGet=2,e.Geted=3,__decorate([down(1,[1])],e.prototype,"downGotAward",null),__decorate([down(2,[0,2,0])],e.prototype,"downAwardInfo",null),__decorate([up(1)],e.prototype,"upReward",null),e=i=__decorate([protocolsId(59)],e);var i}(BaseSystem);__reflect(ThreeHeroesControl.prototype,"ThreeHeroesControl");var AmuseTarget7Panel2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(AmuseTarget7Panel1);__reflect(AmuseTarget7Panel2.prototype,"AmuseTarget7Panel2");var AmuseTarget7Panel3=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._leftTime=0,e._matrailId=0,e._oldCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t},enumerable:!0,configurable:!0}),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget7Panel3Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.actInfo0.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.content.itemRenderer=limitChangeItemRender,this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.updateData()},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().remove(this.setTime,this),this._leftTime=0,this._oldCount=0},e.prototype.updateData=function(){this._activityData=amusementControl.getAmusementDataById(this.activityID),this.checkTime(),this.updateList()},e.prototype.updateMaterial=function(){var t=backpackControl.getBagItemById(this._matrailId),e=t?t.count:0;e!=this._oldCount&&this.updateList()},e.prototype.updateList=function(){var t=DataCenter.ins().Amusement7Config[this.activityID];this._matrailId=t[1].itemId;var e=backpackControl.getBagItemById(this._matrailId),i=e?e.count:0;this.num.text=i+"",this._oldCount=i;var n,o=[],s=0,r=0,a=0,l=0;for(var h in t)n=t[h],l=void 0==n.scount||0==n.scount?Number.MAX_VALUE:n.scount-this._activityData.worldRewardsSum[s+1],a=void 0==n.count||0==n.count?Number.MAX_VALUE:n.count-this._activityData.personalRewardsSum[s+1],r=l&&a&&i>=n.itemCount?1:0,o[s]=[this.activityID,n,r,a,l],s++;o.sort(this.sort),this._dataCollect||(this._dataCollect=new ArrayCollection,this.content.dataProvider=this._dataCollect),this._dataCollect.source=o;var u=t[1];this.itemImg&&u?this.itemImg.source=u.itemId+"_png":this.showItem&&u&&(this.showItem.source=u.itemId+"_png")},e.prototype.sort=function(t,e){return t[3]>e[3]?-1:t[2]>e[2]?-1:t[2]<e[2]?1:t[1].index<e[1].index?-1:1},e.prototype.checkTime=function(){TimerMgr.ins().remove(this.setTime,this),this._leftTime=0,Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3)>=0?this.actTime0.text=LangMgr.getValueByKey("doubleNoActivity"):(this._leftTime=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3),this._leftTime<=0?this.actTime0.text=LangMgr.getValueByKey("doubleEndActivity"):(this.actTime0.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)))},e.prototype.setTime=function(){this._leftTime--,this.actTime0.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3),this._leftTime<=0&&this.checkTime()},e}(BasePanel);__reflect(AmuseTarget7Panel3.prototype,"AmuseTarget7Panel3");var AmuseTarget7Panel4=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget7Panel4Skin",e}return __extends(e,t),e.prototype.open=function(){this.list.itemRenderer=ChritmasSnowMainItemRender,this.addEventTouchTap(this.turnBossBtn,this.onTap),this.addEventTouchTap(this.arrowUp,this.onTap),this.addEventTouchTap(this.arrowDown,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this),this.initData()},e.prototype.initData=function(){this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc;var t=DataCenter.ins().Amusement7Config[this.activityID],e=[];for(var i in t)e.push(t[i]);e.sort(function(t,e){return t.index<e.index?-1:1}),this.list.dataProvider=new eui.ArrayCollection(e),this.updateTime(),this.updateData()},e.prototype.updateTime=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=t.getLeftTime();this.actTime1.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID);this.numLbl.text=""+t.bossScore;for(var e=this.list.dataProvider,i=0,n=e.source;i<n.length;i++){var o=n[i];e.itemUpdated(o)}},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.turnBossBtn:UIMgr.ins().open(BossView,1);break;case this.arrowUp:this.arrowTo(-1);break;case this.arrowDown:this.arrowTo(1)}},e.prototype.arrowTo=function(t){var e=this.list.scrollV+130*t;0>e?e=0:e>this.list.contentHeight-this.list.parent.height&&(e=this.list.contentHeight-this.list.parent.height),this.list.scrollV=e},e.prototype.close=function(){this.removeEventTouchTap(this.turnBossBtn,this.onTap),this.removeEventTouchTap(this.arrowUp,this.onTap),this.removeEventTouchTap(this.arrowDown,this.onTap),TimerMgr.ins().remove(this.updateTime,this)},e}(BasePanel);__reflect(AmuseTarget7Panel4.prototype,"AmuseTarget7Panel4");var AmuseTarget7Panel5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(AmuseTarget7Panel1);__reflect(AmuseTarget7Panel5.prototype,"AmuseTarget7Panel5");var AmuseTarget7Panel6=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e.skinName="AmuseTarget7Panel6Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.actInfo0.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.content.itemRenderer=LastEighthChangeItemRender},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t},enumerable:!0,configurable:!0}),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(266,this.updateList),this.addCustomEvent(267,this.updateList),this.addCustomEvent(392,this.updateList),this.updateData()},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().remove(this.setTime,this),this._leftTime=0},e.prototype.updateData=function(){this._activityData=amusementControl.getAmusementDataById(this.activityID),this.checkTime(),this.updateList()},e.prototype.updateList=function(){var t=[],e=DataCenter.ins().Amusement7Config[this.activityID];for(var i in e){var n=this._activityData.getExchange(e[i].index);t.push({config:e[i],state:n})}t.sort(this.sort),this._dataCollect||(this._dataCollect=new ArrayCollection,this.content.dataProvider=this._dataCollect),this._dataCollect.replaceAll(t)},e.prototype.sort=function(t,e){return t.config.index<e.config.index?-1:1},e.prototype.checkTime=function(){this._leftTime=0,Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3)>=0?this.actTime0.text=LangMgr.getValueByKey("doubleNoActivity"):(this._leftTime=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3),this._leftTime<=0?this.actTime0.text=LangMgr.getValueByKey("doubleEndActivity"):(this.actTime0.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this)))},e.prototype.setTime=function(){this._leftTime--,this.actTime0.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3),this._leftTime<=0&&this.checkTime()},e}(BasePanel);__reflect(AmuseTarget7Panel6.prototype,"AmuseTarget7Panel6");var AmuseTarget8Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget8PanelSkin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(395,this.updateView),this.addEventTouchTap(this.chanllage,this.onChanllage);var i=0;for(var n in DataCenter.ins().Amusement8Config){var o=DataCenter.ins().Amusement8Config[n][1];if(o.showType=AmusementType8DataVo.TYPE_RING){i=o.Id;break}}this.updateView()},e.prototype.updateView=function(){var t=amusementControl.activityData[this.activityID],e=DataCenter.ins().Amusement8Config[this.activityID][1];if(e.showType==AmusementType8DataVo.TYPE_RING){var i=amusementControl.getCurrentRingAwardIndex(t.record),n=amusementControl.getRingAward(i);if(n){this.currentState="normal",this.price.setPrice(n.ybCount),this.awardIndex=i,this.needYB=n.ybCount;var o=n.rewardsNum;this.starNum.text=superRingControl.getCanUpgradeStars(o).toString(),this.rewardsCount.text=o.toString()}else{var s=amusementControl.getLastRingAward();this.starNum.text=superRingControl.getCanUpgradeStars(s.rewardsNum).toString(),this.rewardsCount.text=s.rewardsNum.toString(),this.currentState="fullcount",this.price.visible=!1,this.chanllage.visible=!1}}this.actTime.text=t.getRemainTime()},e.prototype.onChanllage=function(){ActorControl.yb>=this.needYB?(amusementControl.upReward(this.activityID,this.awardIndex),amusementControl.addEvents()):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e}(AmusementPanel);__reflect(AmuseTarget8Panel.prototype,"AmuseTarget8Panel");var AmuseTarget8Panel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget8PanelSkin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(395,this.updateView),this.addEventTouchTap(this.chanllage,this.onChanllage);var i=0;for(var n in DataCenter.ins().Amusement8Config){var o=DataCenter.ins().Amusement8Config[n][1];if(o.showType=AmusementType8DataVo.TYPE_RING){i=o.Id;break}}this.updateView()},e.prototype.updateView=function(){var t=amusementControl.activityData[this.activityID],e=DataCenter.ins().Amusement8Config[this.activityID][1];if(e.showType==AmusementType8DataVo.TYPE_RING){var i=amusementControl.getCurrentRingAwardIndex(t.record),n=amusementControl.getRingAward(i);if(n){this.currentState="normal",this.price.setPrice(n.ybCount),this.awardIndex=i,this.needYB=n.ybCount;var o=n.rewardsNum;this.starNum.text=superRingControl.getCanUpgradeStars(o).toString(),this.rewardsCount.text=o.toString()}else{var s=amusementControl.getLastRingAward();this.starNum.text=superRingControl.getCanUpgradeStars(s.rewardsNum).toString(),this.rewardsCount.text=s.rewardsNum.toString(),this.currentState="fullcount",this.price.visible=!1,this.chanllage.visible=!1}}this.actTime.text=t.getRemainTime()},e.prototype.onChanllage=function(){ActorControl.yb>=this.needYB?(amusementControl.upReward(this.activityID,this.awardIndex),amusementControl.addEvents()):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e}(AmusementPanel);__reflect(AmuseTarget8Panel1.prototype,"AmuseTarget8Panel1");var AmuseTarget9Panel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget9Panel1Skin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents();for(var i=0;3>i;i++)this.removeEventTouchTap(this["isget"+i],this.onGiftClick);egret.Tween.removeTweens(this.tttzhi),this.rolling=!1;var n,o;0==this.actType?(o=AmusementControl.ins(),n=amusementControl.activityData[this.activityID]):1==this.actType&&(o=PAmusementControl.ins(),n=pAmusementControl.activityData[this.activityID]),n&&1==n.indexs.length&&o.upReward(this.activityID,1),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),0==this.actType?this.addCustomEvent(395,this.resultCallBack):1==this.actType&&this.addCustomEvent(439,this.resultCallBack),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this.choujiangBtn,this.getLottery);for(var i=0;3>i;i++)this.addEventTouchTap(this["isget"+i],this.onGiftClick);this.list.itemRenderer=NoticeListItemRender,this.turnten.selected=!1,this.currentState="unReset",this.validateNow(),this.updateData()},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.getkey:}},e.prototype.updateData=function(){var t,e;0==this.actType?(t=amusementControl.activityData[this.activityID],e=DataCenter.ins().Amusement9Config[this.activityID][0]):1==this.actType&&(t=pAmusementControl.activityData[this.activityID],e=DataCenter.ins().PAmusementType9Config[this.activityID][0]);var i=DataCenter.ins().ItemConfig[e.item];if(i){this.icon.source=i.icon+"_png";var n=backpackControl.getBagItemById(i.id),o=0,s=1,r=ColorUtils.NORMAL_COLOR;n?(o=n.count,r=o>=s?ColorUtils.GREEN:ColorUtils.RED):r=ColorUtils.RED,this.num.textFlow=TextUtils.generateTextFlow1("|C:"+r+"&T:"+o+"|C:"+ColorUtils.NORMAL_COLOR+"&T:/"+s),this.pay0.text=e.yb+""}var a;0==this.actType?a=DataCenter.ins().Amusement9Config:1==this.actType&&(a=DataCenter.ins().PAmusementType9Config);for(var l in a[this.activityID])if(+l){var h=a[this.activityID][l],n=this["item"+(+l-1)];n.itemIcon.data=h.reward[0],n.rewardState(!1)}this.num2.visible=!1,this.updateProgress(),this.listRefush(),this.setTime()},e.prototype.resultCallBack=function(t){var e;0==this.actType?e=amusementControl.activityData[this.activityID]:1==this.actType&&(e=pAmusementControl.activityData[this.activityID]),e&&this.activityID==t&&(e.indexs.length>1?UIMgr.ins().open(LuckyResultView,this.activityID,e.indexs):1==e.indexs.length&&this.beginLottery(e.indexs[0]),this.listRefush())},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0,n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){amusementControl.upReward(e.activityID,1),e.flyItem(e["item"+(t-1)]),setTimeout(function(){e.rolling=!1},2e3)},this)},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.itemIcon.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.flyItemEx=function(t){var e=new eui.Image(t.imgIcon.source);e.x=t.imgIcon.x,e.y=t.imgIcon.y,e.width=t.imgIcon.width,e.height=t.imgIcon.height,e.scaleX=t.imgIcon.scaleX,e.scaleY=t.imgIcon.scaleY,t.imgIcon.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.getLottery=function(){if(this.rolling)return void tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1"));var t,e;0==this.actType?(t=AmusementControl.ins(),e=DataCenter.ins().Amusement9Config[this.activityID]):1==this.actType&&(t=PAmusementControl.ins(),e=DataCenter.ins().PAmusementType9Config[this.activityID]),this.turnten.selected?t.getIsRollTen(this.activityID)?t.upReward(this.activityID,2):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):t.getRollSum(this.activityID)||ActorControl.yb>=e[0].yb?t.upReward(this.activityID,1):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.onGiftClick=function(t){for(var e=0;3>e;e++)if(t.currentTarget==this["isget"+e]){var i=this["gift"+e].getItemIcon();this.flyItemEx(i),amusementControl.upReward(this.activityID,0,e+1);break}},e.prototype.updateProgress=function(){var t,e;0==this.actType?(t=DataCenter.ins().Amusement9Config[this.activityID],e=amusementControl.activityData[this.activityID]):1==this.actType&&(t=DataCenter.ins().PAmusementType9Config[this.activityID],e=pAmusementControl.activityData[this.activityID]);var i=t[0];if(i&&e){this.turntime.text=e.count+"";for(var n=0;3>n;n++){if(this["turntime"+n].text=i.reward[n].times,this["gift"+n].data={id:i.reward[n].id,type:i.reward[n].type,count:i.reward[n].count},this["gift"+n].isShowName(!1),this["bar"+n].maximum=100,this["lingqu"+n].touchEnabled=!1,e.record>>n+1&1)this["bar"+n].value=100,this["lingqu"+n].visible=!0,this["isget"+n].touchEnabled=!1;else if(this["lingqu"+n].visible=!1,e.count>=i.reward[n].times)this["bar"+n].value=100,this["isget"+n].touchEnabled=!0;else{var o=i.reward[n-1],s=e.count,r=i.reward[n].times;o&&(s=e.count-o.times,r=i.reward[n].times-o.times),s=s>0?s:0,this["bar"+n].value=Math.floor(s/r*100),this["isget"+n].touchEnabled=!1}this.updateRedPoint(this.activityID,n)}}},e.prototype.updateRedPoint=function(t,e){var i;0==this.actType?i=AmusementControl.ins():1==this.actType&&(i=PAmusementControl.ins());var n=i.isGetRollReward(t,e);this["redPoint"+e].visible=n},e.prototype.listRefush=function(){var t;if(0==this.actType?t=amusementControl.activityData[this.activityID]:1==this.actType&&(t=pAmusementControl.activityData[this.activityID]),t){for(var e=[],i=0;i<t.noticeArr.length;i++){var n={activityID:this.activityID,name:t.noticeArr[i].name,index:t.noticeArr[i].index,actType:this.actType};e.push(n)}this.list.dataProvider=new eui.ArrayCollection(e)}},e.prototype.setTime=function(){var t;0==this.actType?t=amusementControl.activityData[this.activityID]:1==this.actType&&(t=pAmusementControl.activityData[this.activityID]),t&&(this.actTime.text=LangMgr.getValueByKey("expHaveTime",t.getRemainTime()))},e}(BasePanel);__reflect(AmuseTarget9Panel1.prototype,"AmuseTarget9Panel1");var AmuseTarget9Panel2=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curAwardPage=1,e._maxAwardPages=1,e}return __extends(e,t),e.prototype.init=function(){this.list.itemRenderer=ItemBase,this.list0.itemRenderer=NoticeListItemRender;for(var t,e,i=[],n=1;8>=n;n++)0==this.actType?t=DataCenter.ins().Amusement9Config[this.activityID][n]:1==this.actType&&(t=DataCenter.ins().PAmusementType9Config[this.activityID][n]),e=new RewardVo,e.type=t.reward[0].type,e.id=t.reward[0].id,e.count=t.reward[0].count,i[n-1]=e;this.list.dataProvider=new ArrayCollection(i)},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t,isNaN(this.actType)&&(this.actType=AmusementPanel.getAmusementTypeFromId(this._activityID))},enumerable:!0,configurable:!0}),e.prototype.setCurSkin=function(){var t;0==this.actType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.actType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget9Panel2Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.init(),0==this.actType?(this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.addCustomEvent(392,this.updateData),this.addCustomEvent(395,this.resultCallBack)):1==this.actType&&(this.actInfo1.text=DataCenter.ins().PAmusementConfig[this.activityID].desc,this.addCustomEvent(437,this.updateData),this.addCustomEvent(439,this.resultCallBack)),this.addEventTouchTap(this,this.onTouch),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),TimerMgr.ins().removeAll(this),DisplayUtils.removeFromParent(this._fireEff),this.turnten&&(this.turnten.selected=!1)},e.prototype.onTouch=function(t){switch(t.target){case this.buyBtn:this.turnten.selected&&ActorControl.yb<10*this.config.yb||ActorControl.yb<this.config.yb?tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):this.turnten.selected&&backpackControl.getSurplusCount()<10||0==backpackControl.getSurplusCount()?tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace1")):this.onSend();break;case this.reward0:case this.reward1:case this.reward2:case this.reward3:var e=t.target.data;0==e.state?UIMgr.ins().open(ItemTipsView,0,e.id,e.count):1==e.state&&(this.flyItemEx(t.target),this.ins.upReward(this.activityID,0,e.index));break;case this.arrowleft:this._curAwardPage>1&&(this._curAwardPage--,this.updateAwardPage());break;case this.arrowright:this._curAwardPage<this._maxAwardPages&&(this._curAwardPage++,this.updateAwardPage())}},e.prototype.huntWarnFun=function(){var t=this.turnten.selected?10:1,e=this.config.yb*t;ActorControl.yb>=e?this.onSend():tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.onSend=function(){this.turnten.selected?this.ins.upReward(this.activityID,2):(this.ins.upReward(this.activityID,1),this.ins.upReward(this.activityID,1),this._fireEff||(this._fireEff=new GameMovieClip),this._fireEff.parent||(this.effLocation.addChild(this._fireEff),this._fireEff.scaleX=this.effLocation.scaleX,this._fireEff.scaleY=this.effLocation.scaleY),this._fireEff.playFile(PATH_EFF+"yanhuaeff",1))},e.prototype.setCurAwardPage=function(){var t,e;if(0==this.actType?(t=DataCenter.ins().Amusement9Config[this.activityID][0],e=amusementControl.activityData[this.activityID]):1==this.actType&&(t=DataCenter.ins().PAmusementType9Config[this.activityID][0],e=pAmusementControl.activityData[this.activityID]),this._maxAwardPages=t.reward.length/4,!e)return void(this._curAwardPage=1);for(var i=t.reward.length,n=0;i>n;n++)if(!(e.record>>n+1&1))return void(this._curAwardPage=Math.floor(n/4)+1);this._curAwardPage=1},e.prototype.updateData=function(){var t,e;if(0==this.actType?(this.ins=AmusementControl.ins(),this.config=DataCenter.ins().Amusement9Config[this.activityID][0],t=amusementControl.activityData[this.activityID],e=DataCenter.ins().Amusement9Config):1==this.actType&&(this.ins=PAmusementControl.ins(),this.config=DataCenter.ins().PAmusementType9Config[this.activityID][0],t=pAmusementControl.activityData[this.activityID],e=DataCenter.ins().PAmusementType9Config),this.price.setText(this.config.yb+""),this.price.setType(2),this.setCurAwardPage(),this.updateAwardPage(),this._recordCollect||(this._recordCollect=new ArrayCollection,this.list0.dataProvider=this._recordCollect),t){for(var i=[],n=t.noticeArr.length,o=void 0,s=0;n>s;s++){var r=e[this.activityID][t.noticeArr[s].index];o={activityID:this.activityID,name:t.noticeArr[s].name,index:t.noticeArr[s].index,des:r?r.middleDesc:null,actType:this.actType,activityType:t.activityType},i.push(o)}this._recordCollect.source=i}else this._recordCollect.source=null;this.setTime()},e.prototype.updateAwardPage=function(){var t,e;0==this.actType?(t=DataCenter.ins().Amusement9Config,e=amusementControl.activityData[this.activityID]):1==this.actType&&(t=DataCenter.ins().PAmusementType9Config,e=pAmusementControl.activityData[this.activityID]),this.arrowleft.visible=this._curAwardPage>1,this.arrowright.visible=this._curAwardPage<this._maxAwardPages;var i=t[this.activityID][0];if(this.redPointLeft.visible=this.redPointRight.visible=!1,e)for(var n=e.count,o=0,s=0,r=0,a=0,l=1;l<=this._maxAwardPages;l++)for(var h=0;4>h;h++)if(o=4*(l-1)+h,s=e.record>>o+1&1?2:n>=i.reward[o].times?1:0,l==this._curAwardPage)this["reward"+h].data={id:i.reward[o].id,type:i.reward[o].type,count:i.reward[o].count,index:o+1,state:s,times:i.reward[o].times,curTimes:n},h>0&&(r=this["reward"+h].data.times,n>=r?(this["bar"+(h-1)].maximum=100,this["bar"+(h-1)].value=100):(a=this["reward"+(h-1)].data.times,this["bar"+(h-1)].maximum=r-a,this["bar"+(h-1)].value=a>=n?0:n-a));else if(l<this._curAwardPage){if(1==s){this.redPointLeft.visible=!0;break}}else if(1==s){this.redPointRight.visible=!0;break}},e.prototype.resultCallBack=function(t){var e;0==this.actType?e=amusementControl.activityData[this.activityID]:1==this.actType&&(e=pAmusementControl.activityData[this.activityID]),e&&this.activityID==t&&e.indexs.length>1&&UIMgr.ins().open(LuckyResultView,this.activityID,e.indexs)},e.prototype.flyItemEx=function(t){var e=new eui.Image(t.box.source);e.x=t.box.x,e.y=t.box.y,e.width=t.box.width,e.height=t.box.height,e.scaleX=t.box.scaleX,e.scaleY=t.box.scaleY,t.box.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.setTime=function(){var t;0==this.actType?t=amusementControl.activityData[this.activityID]:1==this.actType&&(t=pAmusementControl.activityData[this.activityID]),this.actTime1.text=t.getRemainTime()},e}(BasePanel);__reflect(AmuseTarget9Panel2.prototype,"AmuseTarget9Panel2");var AmuseTarget9Panel3=function(t){function e(){var e=t.call(this)||this;return e.skinName="LuckyAccTurntablePanelSkin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventChangeEnd(this.menuScroller,this.onChange),this.removeCustomEvents(),egret.Tween.removeTweens(this.tttzhi),this.rolling=!1;var i;if(0==this.actType?i=amusementControl.activityData[this.activityID]:1==this.actType&&(i=pAmusementControl.activityData[this.activityID]),i&&1==i.indexs.length){var n=void 0;0==this.actType?n=AmusementControl.ins():1==this.actType&&(n=PAmusementControl.ins()),n.upReward(this.activityID,1)}TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),0==this.actType?(this.config9=DataCenter.ins().Amusement9Config,this.addCustomEvent(395,this.resultCallBack)):1==this.actType&&(this.config9=DataCenter.ins().PAmusementType9Config,this.addCustomEvent(439,this.resultCallBack)),this.addEventChangeEnd(this.menuScroller,this.onChange),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchTap(this.leftBtn,this.onTouch),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this.choujiangBtn,this.getLottery),this.list.itemRenderer=NoticeListItemRender,this.menuList.itemRenderer=AmuseTarget9Panel3ItemRender,this.menuListData=new eui.ArrayCollection,this.menuList.dataProvider=this.menuListData,this.turnten.selected=!1,this.currentState="reset",this.validateNow(),this.updateData()},e.prototype.onTouch=function(t){var e=460,i=0;switch(t.currentTarget){case this.leftBtn:i=this.menuList.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.menuList.scrollH=i,this.updateBtn();break;case this.rightBtn:i=this.menuList.scrollH+e,i=92*Math.round(i/92),i>this.menuList.contentWidth-this.menuScroller.width&&(i=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=i,this.updateBtn()}},e.prototype.updateData=function(){var t;0==this.actType?t=this.config9[this.activityID][0]:1==this.actType&&(t=this.config9[this.activityID][0]);var e=DataCenter.ins().ItemConfig[t.item];if(e){this.icon.source=e.icon+"_png";var i=backpackControl.getBagItemById(e.id),n=0,o=1,s=ColorUtils.NORMAL_COLOR;i?(n=i.count,s=n>=o?ColorUtils.GREEN:ColorUtils.RED):s=ColorUtils.RED,this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+n+"|C:"+ColorUtils.NORMAL_COLOR+"&T:/"+o),this.pay0.text=t.yb+""}for(var r in this.config9[this.activityID])if(+r){var a=this.config9[this.activityID][r],i=this["item"+(+r-1)];
i.itemIcon.data=a.reward[0],i.rewardState(!1)}this.num2.visible=!1,this.updateProgress(),this.listRefush(),this.setTime()},e.prototype.resultCallBack=function(t){var e;0==this.actType?e=amusementControl.activityData[this.activityID]:1==this.actType&&(e=pAmusementControl.activityData[this.activityID]),e&&this.activityID==t&&(e.indexs.length>1?UIMgr.ins().open(LuckyResultView,this.activityID,e.indexs):1==e.indexs.length&&this.beginLottery(e.indexs[0]),this.listRefush(),this.updateData())},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0;var o;0==this.actType?o=AmusementControl.ins():1==this.actType&&(o=PAmusementControl.ins()),n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){o.upReward(e.activityID,1),e.flyItem(e["item"+(t-1)]),setTimeout(function(){e.rolling=!1},2e3)},this)},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.itemIcon.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.getLottery=function(){if(this.rolling)return void tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);var t;0==this.actType?t=AmusementControl.ins():1==this.actType&&(t=PAmusementControl.ins());var e=this.config9[this.activityID][0];if(this.turnten.selected){var i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,e.item);if(i&&i.count)t.upReward(this.activityID,2);else{var n=10,o=e.yb*n;TreasureHuntWarnBuyView.showBuyWarn("LuckyResultView"+this.activityID+"-10",this.checkSend10.bind(this),LangMgr.getValueByKey("osaPayShow1",o,DataCenter.ins().ItemConfig[e.item].name,n))}}else{var i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,e.item);if(i&&i.count)t.upReward(this.activityID,1);else{var n=1,o=1*e.yb;TreasureHuntWarnBuyView.showBuyWarn("LuckyResultView"+this.activityID+"-1",this.checkSend1.bind(this),LangMgr.getValueByKey("osaPayShow1",o,DataCenter.ins().ItemConfig[e.item].name,n))}}},e.prototype.checkSend1=function(){var t;0==this.actType?t=AmusementControl.ins():1==this.actType&&(t=PAmusementControl.ins()),t.getRollSum(this.activityID)||ActorControl.yb>=this.config9[this.activityID][0].yb?t.upReward(this.activityID,1):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.checkSend10=function(){var t;0==this.actType?t=AmusementControl.ins():1==this.actType&&(t=PAmusementControl.ins()),t.getIsRollTen(this.activityID)?t.upReward(this.activityID,2):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.updateProgress=function(){var t,e,i=this;0==this.actType?(e=AmusementControl.ins(),t=e.activityData[this.activityID]):1==this.actType&&(e=PAmusementControl.ins(),t=e.activityData[this.activityID]);var n=this.config9[this.activityID][0],o=[];if(n&&t){for(var s=0;s<n.reward.length;s++){var r={index:s,config:n,actType:this.actType};o.push(r)}this.menuListData.replaceAll(o)}this.menuList.validateNow(),TimerMgr.ins().doNext(function(){for(var e=0,n=1;n<=i.menuListData.length;n++)if(0==t.getStateByIndex(n)){e=90*(n-1);break}e>i.menuList.contentWidth-i.menuList.width&&(e=i.menuList.contentWidth-i.menuList.width),i.menuList.scrollH=e,i.updateBtn()},this)},e.prototype.updateBtn=function(){this.menuListData.length<=5?this.rightBtn.visible=this.rightRed.visible=this.leftBtn.visible=this.leftRed.visible=!1:this.onChange()},e.prototype.onChange=function(){this.menuList.scrollH<46?(this.leftBtn.visible=this.leftRed.visible=!1,this.rightBtn.visible=this.rightRed.visible=!0):this.menuList.scrollH>=this.menuList.contentWidth-this.menuList.width-46?(this.leftBtn.visible=this.leftRed.visible=!0,this.rightBtn.visible=this.rightRed.visible=!1):(this.leftBtn.visible=this.leftRed.visible=!0,this.rightBtn.visible=this.rightRed.visible=!0),this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t,e=this.config9[this.activityID][0];0==this.actType?t=AmusementControl.ins():1==this.actType&&(t=PAmusementControl.ins());for(var i=!1,n=0;n<e.reward.length&&!(i=t.isGetRollReward(this.activityID,n));n++);this.leftBtn.visible&&(this.leftRed.visible=i),this.rightBtn.visible&&(this.rightRed.visible=i)},e.prototype.listRefush=function(){var t,e;if(0==this.actType?(t=AmusementControl.ins(),e=t.activityData[this.activityID]):1==this.actType&&(t=PAmusementControl.ins(),e=t.activityData[this.activityID]),e){for(var i=[],n=0;n<e.noticeArr.length;n++){var o={activityID:this.activityID,name:e.noticeArr[n].name,index:e.noticeArr[n].index,actType:this.actType};i.push(o)}this.list.dataProvider=new eui.ArrayCollection(i)}},e.prototype.setTime=function(){var t,e;0==this.actType?(t=AmusementControl.ins(),e=t.activityData[this.activityID]):1==this.actType&&(t=PAmusementControl.ins(),e=t.activityData[this.activityID]),e&&(this.actTime.text=LangMgr.getValueByKey("expHaveTime",e.getRemainTime()))},e}(BasePanel);__reflect(AmuseTarget9Panel3.prototype,"AmuseTarget9Panel3");var AmuseTarget9Panel4=function(t){function e(){var e=t.call(this)||this;return e.huntType=1,e.skinName="LuckyAccTurntablePanelSkin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventChangeEnd(this.menuScroller,this.onChange),this.removeCustomEvents(),egret.Tween.removeTweens(this.tttzhi),this.rolling=!1;var i;0==this.actType?i=this.ins.activityData[this.activityID]:1==this.actType&&(i=this.ins.activityData[this.activityID]),i&&1==i.indexs.length&&this.ins.upReward(this.activityID,1),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),0==this.actType?(this.ins=AmusementControl.ins(),this.config9=DataCenter.ins().Amusement9Config,this.addCustomEvent(395,this.resultCallBack)):1==this.actType&&(this.ins=PAmusementControl.ins(),this.config9=DataCenter.ins().PAmusementType9Config,this.addCustomEvent(439,this.resultCallBack)),this.addEventChangeEnd(this.menuScroller,this.onChange),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchTap(this.leftBtn,this.onTouch),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this.choujiangBtn,this.getLottery),this.list.itemRenderer=NoticeListItemRender,this.menuList.itemRenderer=AmuseTarget9Panel3ItemRender,this.menuListData=new eui.ArrayCollection,this.menuList.dataProvider=this.menuListData,this.turnten.selected=!1,this.currentState="resetWithKey",this.validateNow(),this.updateData()},e.prototype.onTouch=function(t){var e=460,i=0;switch(t.currentTarget){case this.leftBtn:i=this.menuList.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.menuList.scrollH=i,this.updateBtn();break;case this.rightBtn:i=this.menuList.scrollH+e,i=92*Math.round(i/92),i>this.menuList.contentWidth-this.menuScroller.width&&(i=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=i,this.updateBtn()}},e.prototype.updateData=function(){var t=this.config9[this.activityID][0],e=DataCenter.ins().ItemConfig[t.item];if(e){this.icon.source=e.icon+"_png";var i=backpackControl.getBagItemById(e.id),n=0,o=1,s=ColorUtils.NORMAL_COLOR;i?(n=i.count,s=n>=o?ColorUtils.GREEN:ColorUtils.RED):s=ColorUtils.RED,this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+n+"|C:"+ColorUtils.NORMAL_COLOR+"&T:/"+o),this.pay0.text=t.yb+""}for(var r in this.config9[this.activityID])if(+r){var a=this.config9[this.activityID][r],i=this["item"+(+r-1)];i.itemIcon.data=a.reward[0],i.rewardState(!1)}this.num2.visible=!1,this.updateProgress(),this.listRefush(),this.setTime()},e.prototype.resultCallBack=function(t){var e;0==this.actType?e=this.ins.activityData[this.activityID]:1==this.actType&&(e=this.ins.activityData[this.activityID]),e&&this.activityID==t&&(e.indexs.length>1?UIMgr.ins().open(LuckyResultView,this.activityID,e.indexs):1==e.indexs.length&&this.beginLottery(e.indexs[0]),this.listRefush(),this.updateData())},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0,n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){e.ins.upReward(e.activityID,1),e.flyItem(e["item"+(t-1)]),setTimeout(function(){e.rolling=!1},2e3)},this)},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.itemIcon.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.getLottery=function(){if(this.rolling)return void tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);this.huntType=this.turnten.selected?2:1;var t=this.config9[this.activityID][0],e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,t.item);if(e&&e.count)this.ins.upReward(this.activityID,this.huntType);else{var i=2==this.huntType?10:1;TreasureHuntWarnBuyView.showBuyWarn("LuckyResultView"+this.activityID+(10==i?"-10":"-1"),this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",t.yb*i,DataCenter.ins().ItemConfig[t.item].name,i))}},e.prototype.huntWarnFun=function(){var t=this.config9[this.activityID][0],e=2==this.huntType?10:1;ActorControl.yb>=t.yb*e?this.ins.upReward(this.activityID,this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.updateProgress=function(){var t,e=this,i=this.config9[this.activityID][0];0==this.actType?t=this.ins.activityData[this.activityID]:1==this.actType&&(t=this.ins.activityData[this.activityID]);var n=[];if(i&&t){for(var o=0;o<i.reward.length;o++){var s={index:o,config:i,actType:this.actType};n.push(s)}this.menuListData.replaceAll(n)}this.menuList.validateNow(),TimerMgr.ins().doNext(function(){for(var i=0,n=1;n<=e.menuListData.length;n++)if(0==t.getStateByIndex(n)){i=90*(n-1);break}i>e.menuList.contentWidth-e.menuList.width&&(i=e.menuList.contentWidth-e.menuList.width),e.menuList.scrollH=i,e.updateBtn()},this)},e.prototype.updateBtn=function(){this.menuListData.length<=5?this.rightBtn.visible=this.rightRed.visible=this.leftBtn.visible=this.leftRed.visible=!1:this.onChange()},e.prototype.onChange=function(){this.menuList.scrollH<46?(this.leftBtn.visible=this.leftRed.visible=!1,this.rightBtn.visible=this.rightRed.visible=!0):this.menuList.scrollH>=this.menuList.contentWidth-this.menuList.width-46?(this.leftBtn.visible=this.leftRed.visible=!0,this.rightBtn.visible=this.rightRed.visible=!1):(this.leftBtn.visible=this.leftRed.visible=!0,this.rightBtn.visible=this.rightRed.visible=!0),this.updateRedPoint()},e.prototype.updateRedPoint=function(){for(var t=this.config9[this.activityID][0],e=!1,i=0;i<t.reward.length&&!(e=this.ins.isGetRollReward(this.activityID,i));i++);this.leftBtn.visible&&(this.leftRed.visible=e),this.rightBtn.visible&&(this.rightRed.visible=e)},e.prototype.listRefush=function(){var t;if(0==this.actType?t=this.ins.activityData[this.activityID]:1==this.actType&&(t=this.ins.activityData[this.activityID]),t){for(var e=[],i=0;i<t.noticeArr.length;i++){var n={activityID:this.activityID,name:t.noticeArr[i].name,index:t.noticeArr[i].index,actType:this.actType};e.push(n)}this.list.dataProvider=new eui.ArrayCollection(e)}},e.prototype.setTime=function(){var t;0==this.actType?t=this.ins.activityData[this.activityID]:1==this.actType&&(t=this.ins.activityData[this.activityID]),t&&(this.actTime.text=LangMgr.getValueByKey("expHaveTime",t.getRemainTime()))},e}(BasePanel);__reflect(AmuseTarget9Panel4.prototype,"AmuseTarget9Panel4");var AmuseTarget9Panel5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setCurSkin=function(){var t;0==this.actType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.actType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget9Panel5Skin"},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),egret.Tween.removeTweens(this.tttzhi),this.rolling=!1;var i;0==this.actType?i=this.ins.activityData[this.activityID]:1==this.actType&&(i=this.ins.activityData[this.activityID]),i&&1==i.indexs.length&&this.ins.upReward(this.activityID,1),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.actType=AmusementPanel.getAmusementTypeFromId(this.activityID),this.setCurSkin(),0==this.actType?(this.ins=AmusementControl.ins(),this.config9=DataCenter.ins().Amusement9Config,this.addCustomEvent(395,this.resultCallBack)):1==this.actType&&(this.ins=PAmusementControl.ins(),this.config9=DataCenter.ins().PAmusementType9Config,this.addCustomEvent(439,this.resultCallBack)),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this.choujiangBtn,this.getLottery),this.list.itemRenderer=NoticeListItemRender,this.turnten.selected=!1,this.currentState="resetWithKey",this.validateNow(),this.updateData()},e.prototype.updateData=function(){var t=this.config9[this.activityID][0],e=DataCenter.ins().ItemConfig[t.item];if(e){this.icon.source=e.icon+"_png";var i=backpackControl.getBagItemById(e.id),n=0,o=1,s=ColorUtils.NORMAL_COLOR;i?(n=i.count,s=n>=o?ColorUtils.GREEN:ColorUtils.RED):s=ColorUtils.RED,this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+n+"|C:"+ColorUtils.NORMAL_COLOR+"&T:/"+o),this.pay0.text=t.yb+""}for(var r in this.config9[this.activityID])if(+r){var a=this.config9[this.activityID][r],i=this["item"+(+r-1)];i.itemIcon.data=a.reward[0],i.rewardState(!1)}this.num2.visible=!1,this.listRefush(),this.setTime()},e.prototype.resultCallBack=function(t){var e;0==this.actType?e=this.ins.activityData[this.activityID]:1==this.actType&&(e=this.ins.activityData[this.activityID]),e&&this.activityID==t&&(e.indexs.length>1?UIMgr.ins().open(LuckyResultView,this.activityID,e.indexs):1==e.indexs.length&&this.beginLottery(e.indexs[0]),this.listRefush(),this.updateData())},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0,n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){e.ins.upReward(e.activityID,1),e.flyItem(e["item"+(t-1)]),setTimeout(function(){e.rolling=!1},2e3)},this)},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.itemIcon.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.getLottery=function(){if(this.rolling)return void tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);var t=this.config9[this.activityID][0];if(this.turnten.selected){var e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,t.item);if(e&&e.count)this.ins.upReward(this.activityID,2);else{var i=10,n=t.yb*i;TreasureHuntWarnBuyView.showBuyWarn("LuckyResultView"+this.activityID+"-10",this.checkSend10.bind(this),LangMgr.getValueByKey("osaPayShow1",n,DataCenter.ins().ItemConfig[t.item].name,i))}}else{var e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,t.item);if(e&&e.count)this.ins.upReward(this.activityID,1);else{var i=1,n=1*t.yb;TreasureHuntWarnBuyView.showBuyWarn("LuckyResultView"+this.activityID+"-1",this.checkSend1.bind(this),LangMgr.getValueByKey("osaPayShow1",n,DataCenter.ins().ItemConfig[t.item].name,i))}}},e.prototype.checkSend10=function(){this.ins.getIsRollTen(this.activityID)?this.ins.upReward(this.activityID,2):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.checkSend1=function(){this.ins.getRollSum(this.activityID)||ActorControl.yb>=this.config9[this.activityID][0].yb?this.ins.upReward(this.activityID,1):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.updateRedPoint=function(){for(var t=this.config9[this.activityID][0],e=!1,i=0;i<t.reward.length&&!(e=this.ins.isGetRollReward(this.activityID,i));i++);},e.prototype.listRefush=function(){var t;if(0==this.actType?t=this.ins.activityData[this.activityID]:1==this.actType&&(t=this.ins.activityData[this.activityID]),t){for(var e=[],i=0;i<t.noticeArr.length;i++){var n=this.config9[this.activityID][t.noticeArr[i].index],o={activityID:this.activityID,name:t.noticeArr[i].name,index:t.noticeArr[i].index,actType:this.actType,des:n?n.middleDesc:null};e.push(o)}this.list.dataProvider=new eui.ArrayCollection(e)}},e.prototype.setTime=function(){var t;0==this.actType?t=this.ins.activityData[this.activityID]:1==this.actType&&(t=this.ins.activityData[this.activityID]),t&&(this.actTime.text=LangMgr.getValueByKey("expHaveTime",t.getRemainTime()))},e}(BasePanel);__reflect(AmuseTarget9Panel5.prototype,"AmuseTarget9Panel5");var AmuseTarget9Panel6=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curAwardPage=1,e._maxAwardPages=1,e.cellArr=[],e}return __extends(e,t),e.prototype.init=function(){this.list0.itemRenderer=NoticeListItemRender;for(var t,e,i=[],n=1;16>=n;n++)0==this.actType?t=DataCenter.ins().Amusement9Config[this.activityID][n]:1==this.actType&&(t=DataCenter.ins().PAmusementType9Config[this.activityID][n]),e=new RewardVo,e.type=t.reward[0].type,e.id=t.reward[0].id,e.count=t.reward[0].count,i[n-1]=e;this.cellArr=[];for(var n=0;16>n;n++)this.cellArr.push(this["cell"+n]);this.mcRight||(this.mcRight=new GameMovieClip,this.zhuanEff.addChild(this.mcRight),this.mcRight.x=300,this.mcRight.y=270,this.mcRight.playFile("resource/texiao/eff/zhanpan_great_luck_eff_fire",-1)),this.mcLeft||(this.mcLeft=new GameMovieClip,this.zhuanEff.addChild(this.mcLeft),this.mcLeft.scaleX=-1,this.mcLeft.x=270,this.mcLeft.y=270,this.mcLeft.playFile("resource/texiao/eff/zhanpan_great_luck_eff_fire",-1)),this.monsterRight||(this.monsterRight=new GameMovieClip,this.zhuanEff.addChild(this.monsterRight),this.monsterRight.x=80,this.monsterRight.y=475,this.monsterRight.playFile("resource/texiao/eff/zhanpan_great_luck_eff_monster",-1)),this.monsterLeft||(this.monsterLeft=new GameMovieClip,this.zhuanEff.addChild(this.monsterLeft),this.monsterLeft.scaleX=-1,this.monsterLeft.x=475,this.monsterLeft.y=475,this.monsterLeft.playFile("resource/texiao/eff/zhanpan_great_luck_eff_monster",-1)),this.cellArr.map(function(t,e){try{t.visible=!0,t.data={type:i[e].type,id:i[e].id,count:i[e].count}}catch(n){t.visible=!1}}),this.tipsGrou.visible=!1},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t,isNaN(this.actType)&&(this.actType=AmusementPanel.getAmusementTypeFromId(this._activityID))},enumerable:!0,configurable:!0}),e.prototype.setCurSkin=function(){var t;0==this.actType?t=DataCenter.ins().AmusementConfig[this.activityID]:1==this.actType&&(t=DataCenter.ins().PAmusementConfig[this.activityID]),this.skinName="AmuseTarget9Panel6Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.init();var i;0==this.actType?(i=AmusementControl.ins(),this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.addCustomEvent(392,this.updateData),this.addCustomEvent(395,this.resultCallBack)):1==this.actType&&(i=PAmusementControl.ins(),this.actInfo1.text=DataCenter.ins().PAmusementConfig[this.activityID].desc,this.addCustomEvent(437,this.updateData),this.addCustomEvent(439,this.resultCallBack)),this.addEventTouchTap(this,this.onTouch),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),TimerMgr.ins().removeAll(this),DisplayUtils.removeFromParent(this._fireEff),DisplayUtils.removeFromParent(this.mcRight),DisplayUtils.removeFromParent(this.mcLeft),DisplayUtils.removeFromParent(this.monsterLeft),DisplayUtils.removeFromParent(this.monsterRight),this.turnten.selected=!1},e.prototype.onTouch=function(t){switch(t.target){case this.buyBtn:this.turnten.selected&&ActorControl.yb<10*this.config.yb||ActorControl.yb<this.config.yb?tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):this.turnten.selected&&backpackControl.getSurplusCount()<10||0==backpackControl.getSurplusCount()?tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace1")):this.onSend();break;case this.wenhao:this.tipsGrou.visible=!0;break;case this.rect:this.tipsGrou.visible=!1;break;case this.reward0:case this.reward1:case this.reward2:case this.reward3:var e=t.target.data;0==e.state?UIMgr.ins().open(ItemTipsView,0,e.id,e.count):1==e.state&&(this.flyItemEx(t.target),this.ins.upReward(this.activityID,0,e.index));break;case this.arrowleft:this._curAwardPage>1&&(this._curAwardPage--,this.updateAwardPage());break;case this.arrowright:this._curAwardPage<this._maxAwardPages&&(this._curAwardPage++,this.updateAwardPage())}},e.prototype.huntWarnFun=function(){var t=this.turnten.selected?10:1,e=this.config.yb*t;ActorControl.yb>=e?this.onSend():tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},e.prototype.onSend=function(){this.turnten.selected?this.ins.upReward(this.activityID,2):(this.ins.upReward(this.activityID,1),this._fireEff||(this._fireEff=new GameMovieClip),this._fireEff.parent||(this.effLocation.addChild(this._fireEff),this._fireEff.scaleX=this.effLocation.scaleX,this._fireEff.scaleY=this.effLocation.scaleY),this._fireEff.playFile(PATH_EFF+"yanhuaeff",1))},e.prototype.setCurAwardPage=function(){var t,e;if(0==this.actType?(t=DataCenter.ins().Amusement9Config[this.activityID][0],e=amusementControl.activityData[this.activityID]):1==this.actType&&(t=DataCenter.ins().PAmusementType9Config[this.activityID][0],e=pAmusementControl.activityData[this.activityID]),this._maxAwardPages=t.reward.length/4,!e)return void(this._curAwardPage=1);for(var i=t.reward.length,n=0;i>n;n++)if(!(e.record>>n+1&1))return void(this._curAwardPage=Math.floor(n/4)+1);this._curAwardPage=1},e.prototype.zhanPanEff=function(t){var e=this,i=1+Math.floor(5*Math.random()),n=360*i+22.5*(t-1);this.arrow.rotation=this.arrow.rotation%360,egret.Tween.get(this.arrow).to({rotation:n},3*n).call(function(){e.ins.upReward(e.activityID,1)})},e.prototype.updateData=function(){var t,e;0==this.actType?(this.ins=AmusementControl.ins(),this.config=DataCenter.ins().Amusement9Config[this.activityID][0],t=amusementControl.activityData[this.activityID],e=DataCenter.ins().Amusement9Config):1==this.actType&&(this.ins=PAmusementControl.ins(),this.config=DataCenter.ins().PAmusementType9Config[this.activityID][0],t=pAmusementControl.activityData[this.activityID],e=DataCenter.ins().PAmusementType9Config),this.price.setText(this.config.yb+""),this.price.setType(2),this.setCurAwardPage(),this.updateAwardPage(),this._recordCollect||(this._recordCollect=new ArrayCollection,this.list0.dataProvider=this._recordCollect);this.list0.dataProvider;if(t){for(var i=[],n=t.noticeArr.length,o=void 0,s=0;n>s;s++){var r=e[this.activityID][t.noticeArr[s].index];o={activityID:this.activityID,name:t.noticeArr[s].name,index:t.noticeArr[s].index,des:r?r.middleDesc:null},i.push(o)}this._recordCollect.source=i}else this._recordCollect.source=null;this.setTime()},e.prototype.updateAwardPage=function(){var t,e;0==this.actType?(t=DataCenter.ins().Amusement9Config,e=amusementControl.activityData[this.activityID]):1==this.actType&&(t=DataCenter.ins().PAmusementType9Config,e=pAmusementControl.activityData[this.activityID]),this.arrowleft.visible=this._curAwardPage>1,this.arrowright.visible=this._curAwardPage<this._maxAwardPages;var i=t[this.activityID][0];if(this.redPointLeft.visible=this.redPointRight.visible=!1,e)for(var n=e.count,o=0,s=0,r=0,a=0,l=1;l<=this._maxAwardPages;l++)for(var h=0;4>h;h++)if(o=4*(l-1)+h,s=e.record>>o+1&1?2:n>=i.reward[o].times?1:0,l==this._curAwardPage)this["reward"+h].data={id:i.reward[o].id,type:i.reward[o].type,count:i.reward[o].count,index:o+1,state:s,times:i.reward[o].times,curTimes:n},h>0&&(r=this["reward"+h].data.times,n>=r?(this["bar"+(h-1)].maximum=100,this["bar"+(h-1)].value=100):(a=this["reward"+(h-1)].data.times,this["bar"+(h-1)].maximum=r-a,this["bar"+(h-1)].value=a>=n?0:n-a));else if(l<this._curAwardPage){if(1==s){this.redPointLeft.visible=!0;break}}else if(1==s){this.redPointRight.visible=!0;break}},e.prototype.resultCallBack=function(t){var e;0==this.actType?e=amusementControl.activityData[this.activityID]:1==this.actType&&(e=pAmusementControl.activityData[this.activityID]),e&&this.activityID==t&&(e.indexs.length>1?UIMgr.ins().open(LuckyResultView,this.activityID,e.indexs):1==e.indexs.length&&this.zhanPanEff(e.indexs[0]))},e.prototype.flyItemEx=function(t){var e=new eui.Image(t.box.source);e.x=t.box.x,e.y=t.box.y,e.width=t.box.width,e.height=t.box.height,e.scaleX=t.box.scaleX,e.scaleY=t.box.scaleY,t.box.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.setTime=function(){var t;0==this.actType?t=amusementControl.activityData[this.activityID]:1==this.actType&&(t=pAmusementControl.activityData[this.activityID]),this.actTime1.text=t.getRemainTime()},e}(BasePanel);__reflect(AmuseTarget9Panel6.prototype,"AmuseTarget9Panel6");var Amuse18Panel4ItemRender=function(t){function e(){var e=t.call(this)||this;return e.mc=new GameMovieClip,e.yy=[113,81,121,90,84,86,55],e.touchEnabled=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var e=this;if(t.prototype.dataChanged.call(this),this.data){this.liang.mask=this.masksp,this.currentState="index"+this.data.index;var i=this.data.count/this.data.maxcount;i=i>=1?1:i,this.percent.text=(100*i>>0)+"%",this.percent.visible=i>0&&1>i,this.canDraw.visible=1==i&&!this.data.isget,this.liang.visible=!1,TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(30,1,function(){e.masksp.y=e.yy[e.data.index]+(e.masksp.height-e.masksp.height*i),1==i?(e.mc.playFile(PATH_EFF+e.data.mcstr,-1),e.eff.addChild(e.mc),e.an.visible=e.masksp.visible=e.liang.visible=!1):(DisplayUtils.removeFromParent(e.mc),e.an.visible=e.masksp.visible=e.liang.visible=!0)},this),this.startPlayAni()}},e.prototype.startPlayAni=function(){function t(i){var n=i["word"+e];if(n){n.visible=!0;var o=egret.Tween.get(n);n.scaleX=n.scaleY=2,o.to({scaleX:.9,scaleY:.9},100).wait(30*e).call(function(){e++,n.scaleX=n.scaleY=1,t(i)})}}egret.Tween.removeTweens(this),this.word0.visible=!1,this.word1.visible=!1,this.word2.visible=!1,this.word3.visible=!1,this.word4.visible=!1,this.word5.visible=!1;var e=0;t(this)},e}(BaseItemRender);__reflect(Amuse18Panel4ItemRender.prototype,"Amuse18Panel4ItemRender");var AmuseDailyRechargeItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseDailyRechargeItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.getBtn,this.onTap)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.info.text=LangMgr.getValueByKey("activitAllRecharge",e.pay),this.reward.dataProvider=new eui.ArrayCollection(e.awardList.concat());var i=payControl.getRechargeData(0);if(i.curDayPay>=e.pay){var n=i.isAwards>>e.index&1;n?(this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet"),this.getBtn.enabled=!1):(this.getBtn.label=LangMgr.getValueByKey("activitGet"),this.getBtn.enabled=!0)}else this.getBtn.label=LangMgr.getValueByKey("activitNoFinsh"),this.getBtn.enabled=!1},e.prototype.onTap=function(t){this.data&&payControl.upGetDayReward(this.data.index)},e}(BaseItemRender);__reflect(AmuseDailyRechargeItemRender.prototype,"AmuseDailyRechargeItemRender");var AmuseTarget0Panel18ListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Item7Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rewardList.itemRenderer=ItemBase,this.addEventTouchTap(this.get0,this.onTap)},e.prototype.onTap=function(t){payControl.upGetRechargeTotalAward(this.data.id,2)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.num.text=e.id+"",this.rewardList.dataProvider=new eui.ArrayCollection(e.awardList);var i=payControl.rechargeTotal.hasGetDays1;-1!=i[0].indexOf(e.id)?(this.get0.visible=!1,this.already.visible=!0):(this.get0.visible=!0,this.already.visible=!1,e.id<=payControl.rechargeTotal.rechDay[0]?(this.get0.label=LangMgr.getValueByKey("activitGet"),this.get0.enabled=!0):(this.get0.label=LangMgr.getValueByKey("activitNoFinsh"),this.get0.enabled=!1))},e}(BaseItemRender);__reflect(AmuseTarget0Panel18ListItemRender.prototype,"AmuseTarget0Panel18ListItemRender");var AmuseTarget0Panel2ListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Item7Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rewardList.itemRenderer=ItemBase,this.addEventTouchTap(this.get0,this.onTap)},e.prototype.onTap=function(t){payControl.upGetRechargeTotalAward(this.data.id,1)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.num.text=e.id+"",this.rewardList.dataProvider=new eui.ArrayCollection(e.awardList),payControl.rechargeTotal.hasGetDays.indexOf(e.id)>=0?(this.get0.visible=!1,this.already.visible=!0):(this.get0.visible=!0,this.already.visible=!1,e.id<=payControl.rechargeTotal.totalDay?(this.get0.label=LangMgr.getValueByKey("activitGet"),this.get0.enabled=!0):(this.get0.label=LangMgr.getValueByKey("activitNoFinsh"),this.get0.enabled=!1))},e}(BaseItemRender);__reflect(AmuseTarget0Panel2ListItemRender.prototype,"AmuseTarget0Panel2ListItemRender");var AmuseTarget0Penal18RewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="Days42BigRewardItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.days.text="",e.awardList.length>1?this.reward.data=e.awardList[1]:this.reward.data=e.awardList[0],payControl.rechargeTotal.hasGetDays1[0].length>=42?payControl.rechargeTotal.hasGetDays1[0].indexOf(e.id)>=0?this.state.visible=!0:this.state.visible=!1:payControl.rechargeTotal.hasGetDays1[0].indexOf(e.id)>=0?this.state.visible=!0:this.state.visible=!1},e}(BaseItemRender);__reflect(AmuseTarget0Penal18RewardItemRender.prototype,"AmuseTarget0Penal18RewardItemRender");var AmuseTarget0Penal2RewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="Days42BigRewardItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.days.text="",e.awardList.length>1?this.reward.data=e.awardList[1]:this.reward.data=e.awardList[0],payControl.rechargeTotal.hasGetDays.length>=42?payControl.rechargeTotal.hasGetDays.indexOf(e.id)>=0?this.state.visible=!0:this.state.visible=!1:payControl.rechargeTotal.hasGetDays.indexOf(e.id)>=0?this.state.visible=!0:this.state.visible=!1},e}(BaseItemRender);__reflect(AmuseTarget0Penal2RewardItemRender.prototype,"AmuseTarget0Penal2RewardItemRender");var AmuseTarget102ItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget102ItemSkin",e.reward.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=[];for(var e in this.data.rewards)t.push(this.data.rewards[e]);this.reward.dataProvider=new eui.ArrayCollection(t),this.getBtn.icon=this.data.icond,this.img_title.source=this.data.title,this.img_icon.source=this.data.icon,this.addEventTouchTap(this.getBtn,this.onTap),this.addEventRemovedFromStage(this,this.onRmove)},e.prototype.onRmove=function(t){this.removeEventTouchTap(this.getBtn,this.onTap),this.removeEventRemovedFromStage(this,this.onRmove)},e.prototype.onTap=function(t){if(!(this.data.has<=0))if(1!=this.data.needBuyPre||this.data.index==this.data.buystate)payControl.showReCharge(this.data.payIndex);
else{var e=DataCenter.ins().Amusement102Config[this.data.activityID];tipsControl.showTips(LangMgr.getValueByKey("beforeBuyGift",e[this.data.buystate].cash))}},e}(BaseItemRender);__reflect(AmuseTarget102ItemRender.prototype,"AmuseTarget102ItemRender");var AmuseTarget18Panel2ItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var e=this;if(t.prototype.dataChanged.call(this),this.data){var i=this.data.count/this.data.maxcount;i=i>=1?1:i,this.percent.text=(100*i>>0)+"%",this.highliang?(this.masksp.visible=!0,this.liang.mask=this.masksp,this.percent.visible=i>0&&1>i,this.canDraw.visible=1==i&&!this.data.isget,1==i?this.highliang.visible=!0:this.highliang.visible=!1,this.liang.visible=this.an0.visible=i>0&&1>i,TimerMgr.ins().doTimer(10,1,function(){e.masksp.y=e.masksp.height-e.masksp.height*i,e.setChiIndex(i)},this)):(this.liang.scrollRect?this.liang.scrollRect.y=this.liang.height-this.liang.height*i:this.liang.scrollRect=new egret.Rectangle(0,this.liang.height-this.liang.height*i,this.liang.width,this.liang.height),this.liang.y=this.liang.scrollRect.y,this.clean(),1==i&&this.playEff(),this.alreadyImg.visible=this.data.isget)}},e.prototype.setChiIndex=function(t){1==this.data.index&&t>0&&!this.data.isget&&this.parent.setChildIndex(this,10),2==this.data.index&&t>0&&!this.data.isget&&this.parent.setChildIndex(this,10),6==this.data.index&&t>0&&!this.data.isget&&this.parent.setChildIndex(this,3)},e.prototype.play=function(t,e){var i=this;if(this.data){var n=this;if(this.data.count<=t){var o=t/this.data.maxcount;if(o=o>=1?1:o,this.percent.text=(100*o>>0)+"%",this.highliang){this.percent.visible=o>0&&1>o,this.canDraw.visible=1==o&&!this.data.isget,this.setChiIndex(o);var s=this.masksp.height-this.masksp.height*o,r=egret.Tween.get(this.masksp).to({y:s},500).call(function(){n.data.count=isNaN(e)?t:0,egret.Tween.removeTweens(r),isNaN(e)||n.play(e),i.highliang.visible=1==o,i.liang.visible=i.an0.visible=o>0&&1>o})}else{this.clean(),this.highliang&&(this.highliang.visible=1==o),1==o&&this.playEff();var a=this.liang.height-this.liang.height*o,l=egret.Tween.get(this.liang.scrollRect,{onChange:function(){n.liang.y=n.liang.scrollRect.y}}).to({y:a},500).call(function(){n.data.count=isNaN(e)?t:0,egret.Tween.removeTweens(l),isNaN(e)||(n.liang.y=n.liang.scrollRect.y=n.liang.height,n.play(e))})}}else this.play(this.data.maxcount,t)}},e.prototype.playEff=function(){this.highliang||(this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.eff.addChild(this.mc),this.mc.isPlaying||this.mc.playFile(PATH_EFF+"longzhuEff",-1))},e.prototype.clean=function(){DisplayUtils.removeFromParent(this.mc)},e}(BaseItemRender);__reflect(AmuseTarget18Panel2ItemRender.prototype,"AmuseTarget18Panel2ItemRender");var AmuseTarget18Panel2ListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget18Panel2ListItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=ItemBase},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.gift.setData(DataCenter.ins().ItemConfig[this.data.gift]),this.list.dataProvider=new eui.ArrayCollection(this.data.reward))},e}(BaseItemRender);__reflect(AmuseTarget18Panel2ListItemRender.prototype,"AmuseTarget18Panel2ListItemRender");var AmuseTarget1PanelItemRender=function(t){function e(){var e=t.call(this)||this;return e.init(),e}return __extends(e,t),e.prototype.init=function(){this.isGet=!0,this.addEventTouchEnd(this,this.onClick)},e.prototype.onClick=function(t){switch(t.target){case this.get:var e=void 0,i=void 0;if(DataCenter.ins().PAmusementBtnConfig[this.actId]?(e=DataCenter.ins().PAmusementType1Config[this.actId][this.index],i=PAmusementControl.ins()):(e=DataCenter.ins().Amusement1Config[this.actId][this.index],i=AmusementControl.ins()),this.isGet)i.upReward(this.actId,this.index);else{var n=0;switch(e.showType){case 0:ActorControl.level<e.level?n=e.level-ActorControl.level:reincarnateControl.lv<e.zslevel&&(n=e.zslevel-reincarnateControl.lv);break;case 1:FeatherVo.getWingAllLevel()<e.wingLv&&(n=e.wingLv-FeatherVo.getWingAllLevel());break;case 2:RoleModel.getIntensifyTotalLvByType(2)<e.zzLv&&(n=e.zzLv-RoleModel.getIntensifyTotalLvByType(2));break;case 3:DragonSoulDataVo.getLongHunAllLevel()<e.lhLv&&(n=e.lhLv-DragonSoulDataVo.getLongHunAllLevel());break;case 5:var o=bookControl.getBookPowerNumEx();o<e.tjPower&&(n=e.tjPower-o);break;case 6:var s=backpackControl.getEquipsScoreByRolesOfBody();s<e.equipPower&&(n=e.equipPower-s);break;case 100:var r=amusementControl.getAmusementDataById(this.actId);r.hFTotalConsumption<e.consumeYuanbao&&(n=e.consumeYuanbao-r.hFTotalConsumption);break;case 7:var a=0,l=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID);l&&l.level&&(a=l.level),a<e.huoyanRingLv&&(n=e.huoyanRingLv-a);break;case 8:ActorControl.samsaraLv<e.lunhLv&&(n=e.lunhLv-ActorControl.samsaraLv);break;case 12:ActorControl.power<e.power&&(n=e.power-ActorControl.power);break;case 13:var h=dominateEquipControl.getTotalScore();h<e.zhuzaiScore&&(n=e.zhuzaiScore-h);break;case 14:var u=runeControl.totalPower;u<e.fuwenPower&&(n=e.fuwenPower-u);break;case 15:var p=superRingControl.totalPower;p<e.aexringPower&&(n=e.aexringPower-p)}if(!n)return void amusementControl.upReward(this.actId,this.index);0==e.showType&&reincarnateControl.lv<e.zslevel?tipsControl.showTips(LangMgr.getValueByKey("osaRotationAfterGet",n)):12==e.showType?tipsControl.showTips(LangMgr.getValueByKey("uppowlqAw",n)):5==e.showType?tipsControl.showTips(LangMgr.getValueByKey("osaLevelAfterPicGet",n)):6==e.showType?tipsControl.showTips(LangMgr.getValueByKey("osaLevelAfterEuipmentGet",n)):100==e.showType?tipsControl.showTips(LangMgr.getValueByKey("osaConsumeAfterGet",n)):13==e.showType?tipsControl.showTips(LangMgr.getValueByKey("upzzequiplqAw",n)):14==e.showType?tipsControl.showTips(LangMgr.getValueByKey("upzwpowlqAw",n)):15==e.showType?tipsControl.showTips(LangMgr.getValueByKey("uptjpowlqAw",n)):tipsControl.showTips(LangMgr.getValueByKey("osaUpLevelAfterGet",n))}}},e.prototype.dataChanged=function(){if(this.data){var t,e=this.data;t=DataCenter.ins().PAmusementBtnConfig[e.Id]?pAmusementControl.getAmusementDataById(e.Id):amusementControl.getAmusementDataById(e.Id),this.ActivityShowType(e);for(var i=heroControl.getSubRoleByIndex(0),n=0,o=0;3>o;o++)this["item"+o].visible=!1;for(var o=0;o<e.rewards.length;o++){var s=e.rewards[o];s.job&&s.job!=i.job||(this["item"+n].visible=!0,this["item"+n].data={type:s.type,count:s.count,id:s.id},n++)}var r=t.getRewardStateById(e.index),a=t.rewardsSum[e.index],l=e.total?e.total-a:1;switch(l=l>0?l:0,this.redPoint.visible=!1,r){case AmusementControl.NotReached:l>0?this.currentState="can":this.currentState="zero",this.isGet=!1;break;case AmusementControl.CanGet:l>0?(this.currentState="can",this.redPoint.visible=!0):this.currentState="zero";break;case AmusementControl.Geted:this.currentState="already"}this.get.touchEnabled=this.redPoint.visible,this.get.touchEnabled?(this.get.label=LangMgr.getValueByKey("activitGet"),this.get.currentState="up"):(this.get.label=LangMgr.getValueByKey("activitNoFinsh"),this.get.currentState="disabled"),this.num.visible=!0,e.total?this.num.text=LangMgr.getValueByKey("osaShenyu",l):this.num.visible=!1,this.actId=e.Id,this.index=e.index,100==e.showType?(this.target.visible=this.recharge.visible=!0,this.target.visible=!1,this.recharge.text=t.hFTotalConsumption+"/"+e.consumeYuanbao):this.target.visible=this.recharge.visible=!1,this.validateNow()}},e.prototype.getRedPoint=function(t){switch(t.showType){case 0:var e=t.level?t.level:0,i=t.zslevel?t.zslevel:0;if(ActorControl.level>=e&&reincarnateControl.lv>=i)return!0;break;case 0:if(FeatherVo.getWingAllLevel()>=t.wingLv)return!0;break;case 2:if(RoleModel.getIntensifyTotalLvByType(2)>=t.zzLv)return!0;break;case 3:if(DragonSoulDataVo.getLongHunAllLevel()>=t.lhLv)return!0;break;case 5:var n=bookControl.getBookPowerNumEx();if(n>=t.tjPower)return!0;break;case 6:var o=backpackControl.getEquipsScoreByRolesOfBody();if(o>=t.equipPower)return!0;break;case 100:var s=amusementControl.getAmusementDataById(this.actId);if(s.hFTotalConsumption>=t.consumeYuanbao)return!0;break;case 7:var r=0,a=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID);return a&&a.level&&(r=a.level),r>=t.huoyanRingLv;case 8:if(ActorControl.samsaraLv>=t.lunhLv)return!0;break;case 12:if(ActorControl.power>=t.power)return!0;break;case 13:var l=dominateEquipControl.getTotalScore();if(l>=t.zhuzaiScore)return!0;break;default:return!1}},e.prototype.destruct=function(){this.removeEventTouchEnd(this,this.onClick)},e.prototype.ActivityShowType=function(t){switch(t.showType){case 0:this.lvName.text=LangMgr.getValueByKey("equipment28"),t.zslevel?this.lvName0.text=LangMgr.getValueByKey("numberRotation",t.zslevel):this.lvName0.text=t.level+"",15==t.Id&&(this.lvName.text=LangMgr.getValueByKey("zsNumber"),this.lvName0.text=LangMgr.getValueByKey("numberRotation",t.zslevel));break;case 1:this.lvName.text=LangMgr.getValueByKey("allLevel"),this.lvName0.text=t.wingLv+"";break;case 2:this.lvName.text=LangMgr.getValueByKey("allLevelJ"),this.lvName0.text=t.zzLv+"";break;case 3:this.lvName.text=LangMgr.getValueByKey("allStart"),this.lvName0.text=t.lhLv+"";break;case 5:this.lvName.text=LangMgr.getValueByKey("allFight"),this.lvName0.text=t.tjPower+"";break;case 6:this.lvName.text=LangMgr.getValueByKey("allScore"),this.lvName0.text=t.equipPower+"";break;case 100:this.lvName.text=LangMgr.getValueByKey("allContent"),this.lvName0.text=t.consumeYuanbao+"";break;case 7:this.lvName.text=LangMgr.getValueByKey("alltejiedengji");var e=t.huoyanRingLv,i=superRingControl.getRingStair(e),n=superRingControl.getRingStar(e);this.lvName0.text=LangMgr.getValueByKey("wingTips4",i,n);break;case 8:this.lvName.text=LangMgr.getValueByKey("alllunhundengji");var o=reincarnationControl.getSamsara(t.lunhLv),s=reincarnationControl.getSamsaraLv(t.lunhLv),r=reincarnationControl.getSamsaraDesc(o)+"·"+reincarnationControl.getSamsaraLvDesc(s);this.lvName0.textFlow=TextUtils.generateTextFlow1(t.lunhLv+"\n|S:16&T:"+r);break;case 9:this.lvName.text=LangMgr.getValueByKey("allzhanlindengji");var a=t.zhanlingLv;this.lvName0.text=LangMgr.getValueByKey("wingTips4",Math.ceil(a/10),a%10==0?a?10:0:a%10);break;case 10:this.lvName.text=LangMgr.getValueByKey("lvAct6"),this.lvName0.text=LangMgr.getValueByKey("osaTimes",t.skillCount);break;case 11:this.lvName.text=LangMgr.getValueByKey("lvAct7"),this.lvName0.text=LangMgr.getValueByKey("numberLevel",t.shenwuLv);break;case 12:this.lvName.text=LangMgr.getValueByKey("lvAct8"),this.lvName0.text=t.power+"";break;case 13:this.lvName.text=LangMgr.getValueByKey("lvAct9"),this.lvName0.text=t.zhuzaiScore+"";break;case 14:this.lvName.text=LangMgr.getValueByKey("lvAct10"),this.lvName0.text=t.fuwenPower+"";break;case 15:this.lvName.text=LangMgr.getValueByKey("lvAct11"),this.lvName0.text=t.aexringPower+""}},e}(BaseItemRender);__reflect(AmuseTarget1PanelItemRender.prototype,"AmuseTarget1PanelItemRender");var AmuseTarget25PanelItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget25PanelItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.isGet=!0,this.addEventTouchEnd(this,this.onClick)},e.prototype.onClick=function(t){switch(t.target){case this.get:this.isGet&&amusementControl.upReward(this.actId,this.index)}},e.prototype.dataChanged=function(){if(this.data){for(var t=this.data,e=amusementControl.getAmusementDataById(t.Id),i=heroControl.getSubRoleByIndex(0),n=0,o=0;4>o;o++)this["item"+o].visible=!1;for(var o=0;o<t.rewards.length;o++){var s=t.rewards[o];s.job&&s.job!=i.job||(this["item"+n].visible=!0,this["item"+n].data={type:s.type,count:s.count,id:s.id},n++)}var r=e.getRewardStateById(t.index);switch(this.redPoint.visible=!1,r){case AmusementControl.CanGet:this.currentState="can",this.redPoint.visible=!0;break;case AmusementControl.Geted:this.currentState="already"}this.get.touchEnabled=this.redPoint.visible,this.get.touchEnabled?(this.get.label=LangMgr.getValueByKey("activitGet"),this.get.currentState="up"):(this.get.label=LangMgr.getValueByKey("activitNoFinsh"),this.get.currentState="disabled"),this.actId=t.Id,this.index=t.index,this.validateNow()}},e.prototype.destruct=function(){this.removeEventTouchEnd(this,this.onClick)},e}(BaseItemRender);__reflect(AmuseTarget25PanelItemRenderer.prototype,"AmuseTarget25PanelItemRenderer");var AmuseTarget2Panel1ItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget2Panel1ItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase,this.addEventTouchEnd(this,this.onClick)},e.prototype.dataChanged=function(){if(this.data){this.actType=this.data[0];var t,e=this.data[1];if(0==this.actType?t=amusementControl.getAmusementDataById(e.Id):1==this.actType&&(t=pAmusementControl.getAmusementDataById(e.Id)),!e||!t)return void(this.isGet=!1);this.redPoint.visible=!1,t.buyData[e.index]>=e.count?(this.isGet=!1,this.already.visible=!0):(this.isGet=vipControl.lv>=e.vip&&ActorControl.yb>=e.price,this.already.visible=!1,this.redPoint.visible=this.getRedPoint(e));var i=e.count-t.buyData[e.index];i=0>=i?0:i;var n=i?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.times.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitCanBuy")+"|C:"+n+"&T:"+i+"|/"+e.count),this.times.visible=this.get.visible=!this.already.visible,this.original.text=e.originalPrice+"",this.now.text=e.price+"",this.reward.dataProvider=new eui.ArrayCollection(e.rewards),this.actId=e.Id,this.index=e.index,this.discountNum.text=e.discount+"",e.vip?(this.vip.visible=!0,this.vipLv.text=e.vip+""):this.vip.visible=!1,ActorControl.level<AmusementType2DataVo.LimitLevel&&(this.redPoint.visible=!1)}},e.prototype.getRedPoint=function(t){return vipControl.lv>=t.vip&&ActorControl.yb>=t.price},e.prototype.destruct=function(){this.removeEventTouchEnd(this,this.onClick)},e.prototype.onClick=function(t){switch(t.target){case this.get:if(this.isGet)0==this.actType?amusementControl.upReward(this.actId,this.index):1==this.actType&&pAmusementControl.upReward(this.actId,this.index);else{var e=this.data;e&&(vipControl.lv<e.vip?tipsControl.showTips(LangMgr.getValueByKey("activitVipEnought")):tipsControl.showTips(LangMgr.getValueByKey("userNoMony")))}}},e}(BaseItemRender);__reflect(AmuseTarget2Panel1ItemRender.prototype,"AmuseTarget2Panel1ItemRender");var AmuseTarget3BigRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setData=function(t,e){this.reward.touchEnabled=!1;var i=DataCenter.ins().Amusement3Config[t][e],n=amusementControl.getAmusementDataById(t),o=n.dabiao[e-1];this.days.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitRechargeShow1",LangMgr.getColor("color27"),o,i.day)),this.reward.data=i.rewards[0],this.reward.isShowName(!1),this.redPoint.visible=o>=i.day,1==(n.recrod>>e&1)?this.state.visible=!0:this.state.visible=!1},e.prototype.showEquipEffect=function(t){t?(this.equipEffect=this.equipEffect||new GameMovieClip,this.equipEffect.touchEnabled=!1,this.equipEffect.x=45,this.equipEffect.y=48,this.equipEffect.scaleX=1.6,this.equipEffect.scaleY=1.6,this.equipEffect.parent||this.addChild(this.equipEffect),this.equipEffect.playFile(PATH_EFF+"quaeff4",-1)):this.equipEffect&&DisplayUtils.removeFromParent(this.equipEffect)},e.prototype.setSelected=function(t){this.select.visible=t},e}(BaseItemRender);__reflect(AmuseTarget3BigRewardItemRender.prototype,"AmuseTarget3BigRewardItemRender");var AmuseTarget3ItemBar15=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.bg.visible=!0},e.prototype.dataChanged=function(){this.progress0.visible=!!this.data},e}(BaseItemRender);__reflect(AmuseTarget3ItemBar15.prototype,"AmuseTarget3ItemBar15");var AmuseTarget3ItemRender15=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rateList=[1,2,4,6],e}return __extends(e,t),e.prototype.childrenCreated=function(){this.selected=!1},e.prototype.dataChanged=function(){if(this.data){var t=this.data.actId,e=this.data.index;this.setData(t,e)}},e.prototype.setData=function(t,e){this.reward.touchEnabled=!1;var i=DataCenter.ins().Amusement3Config[t][e],n=amusementControl.getAmusementDataById(t);this.days.text=LangMgr.getValueByKey("activitContinuousRecharge",i.day),this.awardTagImg.visible=this.rateList.indexOf(e)>-1,this.reward.source=i.awardShow,1==(n.recrod>>e&1)?this.state.visible=!0:this.state.visible=!1},Object.defineProperty(e.prototype,"selected",{get:function(){return egret.superGetter(AmuseTarget3BigRewardItemRender,this,"selected")},set:function(t){this.select.visible=t,egret.superSetter(AmuseTarget3BigRewardItemRender,this,"selected",t)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(AmuseTarget3ItemRender15.prototype,"AmuseTarget3ItemRender15");var AmuseTarget3ItemRender16=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.reward1.itemRenderer=ItemBase},e.prototype.dataChanged=function(){var t=this.data.actId,e=this.data.index,i=DataCenter.ins().Amusement3Config[t][e],n=amusementControl.getAmusementDataById(t);if(this.target1.text=LangMgr.getValueByKey("whichDayPayGet",i.day,i.val),this.record1.text=LangMgr.getValueByKey("osaAllRecharge",n.chongzhiTotal,i.val),this.redPoint1.visible=!1,this.reward1.dataProvider=new eui.ArrayCollection(i.rewards),this.get1.name=e,n.chongzhiTotal>=i.val){this.get1.enabled=!0;var o=n.recrod>>e&1;0==o?(this.get1.label=LangMgr.getValueByKey("osaQuickGet"),this.redPoint1.visible=!0):this.get1.label=LangMgr.getValueByKey("activitAlreadingGet")}else this.get1.enabled=!1},e}(BaseItemRender);__reflect(AmuseTarget3ItemRender16.prototype,"AmuseTarget3ItemRender16");var AmuseTarget3ItemRender6=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Item6Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this,this.onClick),this.reward.itemRenderer=ItemBase,this.isGet=!0},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.actType=this.data[0];var e,i=this.data[1];0==this.actType?e=amusementControl.getAmusementDataById(i.Id):1==this.actType&&(e=pAmusementControl.getAmusementDataById(i.Id)),this.reward.dataProvider=new eui.ArrayCollection(i.rewards),this.target.text=LangMgr.getValueByKey("activitAllRecharge",i.val);var n=LangMgr.getColor("color43");e.chongzhiTotal<i.val&&(n=LangMgr.getColor("color22")),this.recharge.textFlow=TextUtils.generateTextFlow1("(|C:"+n+"&T:"+e.chongzhiTotal+"|C:"+LangMgr.getColor("color43")+"&T:/"+i.val+")");var o=e.getRewardStateById(i.index);switch(o){case AmusementControl.NotReached:this.get.label=LangMgr.getValueByKey("activitNoFinsh"),this.get.currentState="disabled",this.isGet=!1,this.redPoint.visible=!1;break;case AmusementControl.CanGet:this.get.label=LangMgr.getValueByKey("activitGet"),this.get.currentState="up",this.isGet=!0,this.redPoint.visible=!0;break;case AmusementControl.Geted:this.isGet=!1,this.redPoint.visible=!1,this.get.visible=!1,this.already.visible=!0}this.actId=i.Id,this.index=i.index},e.prototype.onClick=function(t){var e,i,n;switch(0==this.actType?(e=AmusementControl.ins(),i=DataCenter.ins().Amusement3Config[this.actId][this.index],n=e.getAmusementDataById(this.actId)):1==this.actType&&(e=PAmusementControl.ins(),i=DataCenter.ins().PAmusement3Config[this.actId][this.index],n=e.getAmusementDataById(this.actId)),t.target){case this.get:if(this.isGet)e.upReward(this.actId,this.index);else{var o=0;switch(i.showType){case 6:n.chongzhiTotal<i.val&&(o=i.val-n.chongzhiTotal)}if(!o)return void amusementControl.upReward(this.actId,this.index);6==i.showType&&n.chongzhiTotal<i.val&&tipsControl.showTips(LangMgr.getValueByKey("osaNoFinshPay"))}}},e}(BaseItemRender);__reflect(AmuseTarget3ItemRender6.prototype,"AmuseTarget3ItemRender6");var AmuseTarget3ItemRender7=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget3Item7Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this,this.onClick),this.rewardList.itemRenderer=ItemBase,this.isGet=!0},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.actType=this.data[0];var e,i,n=this.data[1];0==this.actType?(n=n,e=AmusementControl.ins(),i=e.getAmusementDataById(n.Id)):1==this.actType&&(n=n,e=PAmusementControl.ins(),i=e.getAmusementDataById(n.Id)),this.num.text=n.day+"",this.rewardList.dataProvider=new eui.ArrayCollection(n.rewards);var o=i.getRewardStateById(n.index);switch(o){case AmusementControl.NotReached:this.get0.label=LangMgr.getValueByKey("activitNoFinsh"),this.get0.currentState="disabled",this.isGet=!1,this.redPoint.visible=!1,this.already.visible=!1,this.get0.visible=!1;break;case AmusementControl.CanGet:this.get0.label=LangMgr.getValueByKey("activitGet"),this.get0.currentState="up",this.isGet=!0,this.redPoint.visible=!0,this.already.visible=!1,this.get0.visible=!0;break;case AmusementControl.Geted:this.isGet=!1,this.already.visible=!0,this.redPoint.visible=!1,this.get0.visible=!1}this.actId=n.Id,this.index=n.index},e.prototype.onClick=function(t){switch(t.target){case this.get0:if(this.isGet)0==this.actType?amusementControl.upReward(this.actId,this.index):1==this.actType&&pAmusementControl.upReward(this.actId,this.index);else{var e=void 0,i=void 0,n=void 0;0==this.actType?(e=DataCenter.ins().Amusement3Config[this.actId][this.index],n=AmusementControl.ins(),i=n.getAmusementDataById(this.actId)):1==this.actType&&(e=DataCenter.ins().PAmusement3Config[this.actId][this.index],n=PAmusementControl.ins(),i=n.getAmusementDataById(this.actId));var o=0;switch(e.showType){case 7:i.dabiao[this.index-1]<e.day&&(o=e.day-i.dabiao[this.index-1])}if(!o)return void n.upReward(this.actId,this.index);7==e.showType&&i.dabiao[this.index-1]<e.day&&tipsControl.showTips(LangMgr.getValueByKey("osaALlPayCanGet",o))}}},e}(BaseItemRender);__reflect(AmuseTarget3ItemRender7.prototype,"AmuseTarget3ItemRender7");var AmuseTarget4Panel3ItemRender=function(t){function e(){var e=t.call(this)||this;return e.bgRes=["osa_rank_panel4","osa_rank_panel1","osa_rank_panel2","osa_rank_panel3"],e.skinName="AmuseTarget4Panel3ItemSkin",e.basicAward.itemRenderer=ItemBaseNoNameCanTap,e.extraAward.itemRenderer=ItemBaseNoNameCanTap,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchEnd(this.playerName,this.onViewPlyer)},e.prototype.dataChanged=function(){this.data&&(this.myData=this.data,this.myData.rankIndex>3?(this.rankLab.text=this.myData.rankIndex,this.rankImg.visible=!1,this.rankLab.visible=!0,this.bg1.source=this.bgRes[0]):(this.rankImg.source="ad_rank"+this.myData.rankIndex,this.rankImg.visible=!0,this.rankLab.visible=!1,this.bg1.source=this.bgRes[this.myData.rankIndex]),this.playerName.text=this.myData.name,this.acyData=AmuseTarget4Panel3.actCfg[this.myData.rankIndex],this.basicAward.dataProvider=new eui.ArrayCollection(RewardVo.getRewardsByJob(this.acyData.rewards)),this.acyData.dabiaoRewards&&(this.extraAward.dataProvider=new eui.ArrayCollection([this.acyData.dabiaoRewards.award])),this.score.text=LangMgr.getValueByKey("rank43ItemType"+this.acyData.rankType,this.myData.numType))},e.prototype.onViewPlyer=function(){AmuseTarget4Panel3.isDisRankRoleView=!0,rankOtherUserControl.upFindPlayer(this.myData.id)},e}(BaseItemRender);__reflect(AmuseTarget4Panel3ItemRender.prototype,"AmuseTarget4Panel3ItemRender");var AmuseTarget4PanelRankRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget4PanelRankRewardItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase},e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.pos.text=t.rank+"",this.need.text=t.desc,this.reward.dataProvider=new eui.ArrayCollection(t.rewards)}},e}(BaseItemRender);__reflect(AmuseTarget4PanelRankRewardItemRender.prototype,"AmuseTarget4PanelRankRewardItemRender");var AmuseTarget4RankTipsItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget4RankTipsItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase},e.prototype.dataChanged=function(){if(this.data.rankData){var t,e=this.data.rankData,i=this.data.activityID,n=DataCenter.ins().Amusement4Config[i][1],o=n.rankType;if(21==o||24==o)if(e instanceof AmusementRankData){var s=this.data.rank?this.data.rank:e.rankIndex;switch(3>=s?(this.rankImg.source="paihang"+s,this.rankNum.visible=!1):(this.rankImg.source="",this.rankNum.visible=!0,this.rankNum.text=s+""),this.name1.text=e.name,this.value.text=e.numType,t=s,o){case 21:t=1==t?1:2==t||3==t?2:4==t||5==t?4:6;break;case 24:24==o&&(t=1==t?1:2==t?2:3==t?3:4)}n=DataCenter.ins().Amusement4Config[i][t],this.reward.dataProvider=new eui.ArrayCollection(n.rewards)}else{var s=this.data.rank?this.data.rank:e.pos;3>=s?(this.rankImg.source="paihang"+s,this.rankNum.visible=!1):(this.rankImg.source="",this.rankNum.visible=!0,this.rankNum.text=s),this.name1.text=e.player,this.value.text=e.value,t=s,t=1==t?1:2==t||3==t?2:4==t||5==t?4:6,n=DataCenter.ins().Amusement4Config[i][t],this.reward.dataProvider=new eui.ArrayCollection(n.rewards)}else e instanceof AmusementRankData?(e.rankIndex<=3?(this.rankImg.source="paihang"+e.rankIndex,this.rankNum.visible=!1):(this.rankImg.source="",this.rankNum.visible=!0,this.rankNum.text=e.rankIndex+""),this.name1.text=e.name,this.value.text=e.numType,t=e.rankIndex,t>4&&(t=4),n=DataCenter.ins().Amusement4Config[i][t],this.reward.dataProvider=new eui.ArrayCollection(this.getRewards(n.rewards))):(e.pos<=3?(this.rankImg.source="paihang"+e.pos,this.rankNum.visible=!1):(this.rankImg.source="",this.rankNum.visible=!0,this.rankNum.text=e.pos),this.name1.text=e.player,this.value.text=e.value,t=e.pos,n=DataCenter.ins().Amusement4Config[i][t],this.reward.dataProvider=new eui.ArrayCollection(this.getRewards(n.rewards)))}},e.prototype.getRewards=function(t){for(var e=[],i=heroControl.getSubRoleByIndex(0).job,n=0;n<t.length;n++){var o=t[n];o.job?o.job==i&&e.push(o):e.push(o)}return e},e}(BaseItemRender);__reflect(AmuseTarget4RankTipsItemRender.prototype,"AmuseTarget4RankTipsItemRender");var AmuseTarget9Panel3ItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget9Panel3ItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchEnd(this.isget,this.onTap)},e.prototype.onTap=function(t){var e=this.gift.getItemIcon();this.flyItemEx(e),this.ins.upReward(this.activityID,0,this.index+1)},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){this.actType=this.data.actType;var e=this.data.config;this.activityID=e.Id;var i,n=this.index=this.data.index;if(0==this.actType?(this.ins=AmusementControl.ins(),i=this.ins.activityData[e.Id]):1==this.actType&&(this.ins=PAmusementControl.ins(),i=this.ins.activityData[e.Id]),i){this.targetTime.text="/"+e.reward[n].times,this.gift.data={id:e.reward[n].id,type:e.reward[n].type,count:e.reward[n].count},this.gift.isShowName(!1),this.lingqu.touchEnabled=!1;var o=0,s=i.count>=e.reward[n].times?e.reward[n].times:i.count;if(i.record>>n+1&1)this.lingqu.visible=!0,this.isget.touchEnabled=!1,o=LangMgr.getColor("color43");else if(this.lingqu.visible=!1,i.count>=e.reward[n].times)this.isget.touchEnabled=!0,o=LangMgr.getColor("color43");else{var r=e.reward[n-1],a=i.count,l=e.reward[n].times;r&&(a=i.count-r.times,l=e.reward[n].times-r.times),a=a>0?a:0,this.isget.touchEnabled=!1,o=LangMgr.getColor("color43")}this.alreadyTime.textFlow=TextUtils.generateTextFlow1("|C:"+o+"&T:"+s),this.updateRedPoint(this.activityID,n)}}},e.prototype.updateRedPoint=function(t,e){var i=this.ins.isGetRollReward(t,e);this.redPoint.visible=i},e.prototype.flyItemEx=function(t){var e=new eui.Image(t.imgIcon.source);e.x=t.imgIcon.x,e.y=t.imgIcon.y,e.width=t.imgIcon.width,e.height=t.imgIcon.height,e.scaleX=t.imgIcon.scaleX,e.scaleY=t.imgIcon.scaleY,t.imgIcon.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e}(BaseItemRender);__reflect(AmuseTarget9Panel3ItemRender.prototype,"AmuseTarget9Panel3ItemRender");var AmuseTarget9Panel6ItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget9Panel6ItemSkin",e.touchChildren=!1,e}return __extends(e,t),e.prototype.inivit=function(t){this.info=t,this.item.data={type:t.type,id:t.id,count:t.count}},e}(BaseItemRender);__reflect(AmuseTarget9Panel6ItemRender.prototype,"AmuseTarget9Panel6ItemRender");var DailyRechargeItemRender=function(t){function e(){var e=t.call(this)||this;return e._state=0,e._totalRecharge=0,e._activityID=0,e._index=0,e.skinName="AmuseTarget3Item6Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.get,this.onTap)},e.prototype.dataChanged=function(){this._actType=this.data[0],this._config=this.data[1],this._state=this.data[2],this._totalRecharge=this.data[3],this._activityID=this.data[4],this._index=this.data[5],this.target.text=LangMgr.getValueByKey("activitAllRecharge",this._config.val),this.recharge.text="("+(this._totalRecharge>this._config.val?this._config.val:this._totalRecharge)+"/"+this._config.val+")",this.reward.dataProvider=new eui.ArrayCollection(this._config.rewards),this.redPoint.visible=1==this._state,this.get.enabled=1==this._state,this.get.label=2==this._state?LangMgr.getValueByKey("activitAlreadingGet"):1==this._state?LangMgr.getValueByKey("activitGet"):LangMgr.getValueByKey("activitNoFinsh")},e.prototype.onTap=function(t){0==this._actType?amusementControl.upReward(this._activityID,this._index):1==this._actType&&pAmusementControl.upReward(this._activityID,this._index)},e}(BaseItemRender);__reflect(DailyRechargeItemRender.prototype,"DailyRechargeItemRender");var amusementControl,GameSystem;!function(t){t.amusementControlInit=function(){amusementControl=AmusementControl.ins(),window.amusementControl=amusementControl}}(GameSystem||(GameSystem={}));var redPacketSysControl;!function(t){t.redPacketSysControlInit=function(){redPacketSysControl=RedPacketSysControl.ins(),window.redPacketSysControl=redPacketSysControl}}(GameSystem||(GameSystem={}));var threeHeroesControl;!function(t){t.threeHeroesControlInit=function(){threeHeroesControl=ThreeHeroesControl.ins(),window.threeHeroesControl=threeHeroesControl}}(GameSystem||(GameSystem={}));var pAmusementControl;!function(t){t.pAmusementControlInit=function(){pAmusementControl=PAmusementControl.ins(),window.pAmusementControl=pAmusementControl}}(GameSystem||(GameSystem={}));var dailyGiftActControl;!function(t){t.dailyGiftActControlInit=function(){dailyGiftActControl=DailyGiftActControl.ins(),window.dailyGiftActControl=dailyGiftActControl}}(GameSystem||(GameSystem={}));var investmentControl;!function(t){t.investmentControlInit=function(){investmentControl=InvestmentControl.ins(),window.investmentControl=investmentControl}}(GameSystem||(GameSystem={}));var platformAmuseControl;!function(t){t.platformAmuseControlInit=function(){platformAmuseControl=PlatformAmuseControl.ins(),window.platformAmuseControl=platformAmuseControl}}(GameSystem||(GameSystem={}));var spokesPersonBossSysControl;!function(t){t.spokesPersonBossSysControlInit=function(){spokesPersonBossSysControl=SpokesPersonBossSysControl.ins(),window.spokesPersonBossSysControl=spokesPersonBossSysControl}}(GameSystem||(GameSystem={}));var spokesPersonControl;!function(t){t.spokesPersonControlInit=function(){spokesPersonControl=SpokesPersonControl.ins(),window.spokesPersonControl=spokesPersonControl
}}(GameSystem||(GameSystem={}));var spokesPersonAchiTaskControl;!function(t){t.spokesPersonAchiTaskControlInit=function(){spokesPersonAchiTaskControl=SpokesPersonAchiTaskControl.ins(),window.spokesPersonAchiTaskControl=spokesPersonAchiTaskControl}}(GameSystem||(GameSystem={}));var spokesPersonAchiTaskOpenControl;!function(t){t.spokesPersonAchiTaskOpenControlInit=function(){spokesPersonAchiTaskOpenControl=SpokesPersonAchiTaskOpenControl.ins(),window.spokesPersonAchiTaskOpenControl=spokesPersonAchiTaskOpenControl}}(GameSystem||(GameSystem={}));var spokesPersonDoubleExpControl;!function(t){t.spokesPersonDoubleExpControlInit=function(){spokesPersonDoubleExpControl=SpokesPersonDoubleExpControl.ins(),window.spokesPersonDoubleExpControl=spokesPersonDoubleExpControl}}(GameSystem||(GameSystem={}));var onlineQuizControl;!function(t){t.onlineQuizControlInit=function(){onlineQuizControl=OnlineQuizControl.ins(),window.onlineQuizControl=onlineQuizControl}}(GameSystem||(GameSystem={}));var spokesPersonTaskControl;!function(t){t.spokesPersonTaskControlInit=function(){spokesPersonTaskControl=SpokesPersonTaskControl.ins(),window.spokesPersonTaskControl=spokesPersonTaskControl}}(GameSystem||(GameSystem={}));var spokesPersonTurntableControl;!function(t){t.spokesPersonTurntableControlInit=function(){spokesPersonTurntableControl=SpokesPersonTurntableControl.ins(),window.spokesPersonTurntableControl=spokesPersonTurntableControl}}(GameSystem||(GameSystem={}));var artifactControl;!function(t){t.artifactControlInit=function(){artifactControl=ArtifactControl.ins(),window.artifactControl=artifactControl}}(GameSystem||(GameSystem={}));var ashtarteControl;!function(t){t.ashtarteControlInit=function(){ashtarteControl=AshtarteControl.ins(),window.ashtarteControl=ashtarteControl}}(GameSystem||(GameSystem={}));var backpackControl;!function(t){t.backpackControlInit=function(){backpackControl=BackpackControl.ins(),window.backpackControl=backpackControl}}(GameSystem||(GameSystem={}));var bargainControl;!function(t){t.bargainControlInit=function(){bargainControl=BargainControl.ins(),window.bargainControl=bargainControl}}(GameSystem||(GameSystem={}));var beastControl;!function(t){t.beastControlInit=function(){beastControl=BeastControl.ins(),window.beastControl=beastControl}}(GameSystem||(GameSystem={}));var blisterControl;!function(t){t.blisterControlInit=function(){blisterControl=BlisterControl.ins(),window.blisterControl=blisterControl}}(GameSystem||(GameSystem={}));var bookControl;!function(t){t.bookControlInit=function(){bookControl=BookControl.ins(),window.bookControl=bookControl}}(GameSystem||(GameSystem={}));var bossAutoChallengeControl;!function(t){t.bossAutoChallengeControlInit=function(){bossAutoChallengeControl=BossAutoChallengeControl.ins(),window.bossAutoChallengeControl=bossAutoChallengeControl}}(GameSystem||(GameSystem={}));var bossControl;!function(t){t.bossControlInit=function(){bossControl=BossControl.ins(),window.bossControl=bossControl}}(GameSystem||(GameSystem={}));var darkMysteryBossControl;!function(t){t.darkMysteryBossControlInit=function(){darkMysteryBossControl=DarkMysteryBossControl.ins(),window.darkMysteryBossControl=darkMysteryBossControl}}(GameSystem||(GameSystem={}));var godWeaponBossControl;!function(t){t.godWeaponBossControlInit=function(){godWeaponBossControl=GodWeaponBossControl.ins(),window.godWeaponBossControl=godWeaponBossControl}}(GameSystem||(GameSystem={}));var calcForceControl;!function(t){t.calcForceControlInit=function(){calcForceControl=CalcForceControl.ins(),window.calcForceControl=calcForceControl}}(GameSystem||(GameSystem={}));var campWarControl;!function(t){t.campWarControlInit=function(){campWarControl=CampWarControl.ins(),window.campWarControl=campWarControl}}(GameSystem||(GameSystem={}));var confrontControl;!function(t){t.confrontControlInit=function(){confrontControl=ConfrontControl.ins(),window.confrontControl=confrontControl}}(GameSystem||(GameSystem={}));var confrontFightControl;!function(t){t.confrontFightControlInit=function(){confrontFightControl=ConfrontFightControl.ins(),window.confrontFightControl=confrontFightControl}}(GameSystem||(GameSystem={}));var challengeCopyControl;!function(t){t.challengeCopyControlInit=function(){challengeCopyControl=ChallengeCopyControl.ins(),window.challengeCopyControl=challengeCopyControl}}(GameSystem||(GameSystem={}));var copyBabelControl;!function(t){t.copyBabelControlInit=function(){copyBabelControl=CopyBabelControl.ins(),window.copyBabelControl=copyBabelControl}}(GameSystem||(GameSystem={}));var copyControl;!function(t){t.copyControlInit=function(){copyControl=CopyControl.ins(),window.copyControl=copyControl}}(GameSystem||(GameSystem={}));var copyHelpControl;!function(t){t.copyHelpControlInit=function(){copyHelpControl=CopyHelpControl.ins(),window.copyHelpControl=copyHelpControl}}(GameSystem||(GameSystem={}));var guardControl;!function(t){t.guardControlInit=function(){guardControl=GuardControl.ins(),window.guardControl=guardControl}}(GameSystem||(GameSystem={}));var monsterSpeakControl;!function(t){t.monsterSpeakControlInit=function(){monsterSpeakControl=MonsterSpeakControl.ins(),window.monsterSpeakControl=monsterSpeakControl}}(GameSystem||(GameSystem={}));var crazyDogControl;!function(t){t.crazyDogControlInit=function(){crazyDogControl=CrazyDogControl.ins(),window.crazyDogControl=crazyDogControl}}(GameSystem||(GameSystem={}));var crossArenaControl;!function(t){t.crossArenaControlInit=function(){crossArenaControl=CrossArenaControl.ins(),window.crossArenaControl=crossArenaControl}}(GameSystem||(GameSystem={}));var crossBossControl;!function(t){t.crossBossControlInit=function(){crossBossControl=CrossBossControl.ins(),window.crossBossControl=crossBossControl}}(GameSystem||(GameSystem={}));var darkHallBossControl;!function(t){t.darkHallBossControlInit=function(){darkHallBossControl=DarkHallBossControl.ins(),window.darkHallBossControl=darkHallBossControl}}(GameSystem||(GameSystem={}));var devildomControl;!function(t){t.devildomControlInit=function(){devildomControl=DevildomControl.ins(),window.devildomControl=devildomControl}}(GameSystem||(GameSystem={}));var devildomFinalControl;!function(t){t.devildomFinalControlInit=function(){devildomFinalControl=DevildomFinalControl.ins(),window.devildomFinalControl=devildomFinalControl}}(GameSystem||(GameSystem={}));var dominateBossControl;!function(t){t.dominateBossControlInit=function(){dominateBossControl=DominateBossControl.ins(),window.dominateBossControl=dominateBossControl}}(GameSystem||(GameSystem={}));var hatredControl;!function(t){t.hatredControlInit=function(){hatredControl=HatredControl.ins(),window.hatredControl=hatredControl}}(GameSystem||(GameSystem={}));var peakedControl;!function(t){t.peakedControlInit=function(){peakedControl=PeakedControl.ins(),window.peakedControl=peakedControl}}(GameSystem||(GameSystem={}));var totemBossControl;!function(t){t.totemBossControlInit=function(){totemBossControl=TotemBossControl.ins(),window.totemBossControl=totemBossControl}}(GameSystem||(GameSystem={}));var daifugControl;!function(t){t.daifugControlInit=function(){daifugControl=DaifugControl.ins(),window.daifugControl=daifugControl}}(GameSystem||(GameSystem={}));var darkEquipControl;!function(t){t.darkEquipControlInit=function(){darkEquipControl=DarkEquipControl.ins(),window.darkEquipControl=darkEquipControl}}(GameSystem||(GameSystem={}));var dominateControl;!function(t){t.dominateControlInit=function(){dominateControl=DominateControl.ins(),window.dominateControl=dominateControl}}(GameSystem||(GameSystem={}));var dominateEquipControl;!function(t){t.dominateEquipControlInit=function(){dominateEquipControl=DominateEquipControl.ins(),window.dominateEquipControl=dominateEquipControl}}(GameSystem||(GameSystem={}));var dragonSoulControl;!function(t){t.dragonSoulControlInit=function(){dragonSoulControl=DragonSoulControl.ins(),window.dragonSoulControl=dragonSoulControl}}(GameSystem||(GameSystem={}));var experienceJadeNewControl;!function(t){t.experienceJadeNewControlInit=function(){experienceJadeNewControl=ExperienceJadeNewControl.ins(),window.experienceJadeNewControl=experienceJadeNewControl}}(GameSystem||(GameSystem={}));var esotericaControl;!function(t){t.esotericaControlInit=function(){esotericaControl=EsotericaControl.ins(),window.esotericaControl=esotericaControl}}(GameSystem||(GameSystem={}));var experienceControl;!function(t){t.experienceControlInit=function(){experienceControl=ExperienceControl.ins(),window.experienceControl=experienceControl}}(GameSystem||(GameSystem={}));var fashionControl;!function(t){t.fashionControlInit=function(){fashionControl=FashionControl.ins(),window.fashionControl=fashionControl}}(GameSystem||(GameSystem={}));var featherControl;!function(t){t.featherControlInit=function(){featherControl=FeatherControl.ins(),window.featherControl=featherControl}}(GameSystem||(GameSystem={}));var focusAttackControl;!function(t){t.focusAttackControlInit=function(){focusAttackControl=FocusAttackControl.ins(),window.focusAttackControl=focusAttackControl}}(GameSystem||(GameSystem={}));var targetListControl;!function(t){t.targetListControlInit=function(){targetListControl=TargetListControl.ins(),window.targetListControl=targetListControl}}(GameSystem||(GameSystem={}));var godWeaponControl;!function(t){t.godWeaponControlInit=function(){godWeaponControl=GodWeaponControl.ins(),window.godWeaponControl=godWeaponControl}}(GameSystem||(GameSystem={}));var godWeaponItemControl;!function(t){t.godWeaponItemControlInit=function(){godWeaponItemControl=GodWeaponItemControl.ins(),window.godWeaponItemControl=godWeaponItemControl}}(GameSystem||(GameSystem={}));var heartMethodControl;!function(t){t.heartMethodControlInit=function(){heartMethodControl=HeartMethodControl.ins(),window.heartMethodControl=heartMethodControl}}(GameSystem||(GameSystem={}));var heirloomControl;!function(t){t.heirloomControlInit=function(){heirloomControl=HeirloomControl.ins(),window.heirloomControl=heirloomControl}}(GameSystem||(GameSystem={}));var crazybtplayControl;!function(t){t.crazybtplayControlInit=function(){crazybtplayControl=CrazybtplayControl.ins(),window.crazybtplayControl=crazybtplayControl}}(GameSystem||(GameSystem={}));var crazybtplayCopyControl;!function(t){t.crazybtplayCopyControlInit=function(){crazybtplayCopyControl=CrazybtplayCopyControl.ins(),window.crazybtplayCopyControl=crazybtplayCopyControl}}(GameSystem||(GameSystem={}));var totemControl;!function(t){t.totemControlInit=function(){totemControl=TotemControl.ins(),window.totemControl=totemControl}}(GameSystem||(GameSystem={}));var forgeControl;!function(t){t.forgeControlInit=function(){forgeControl=ForgeControl.ins(),window.forgeControl=forgeControl}}(GameSystem||(GameSystem={}));var intensifyControl;!function(t){t.intensifyControlInit=function(){intensifyControl=IntensifyControl.ins(),window.intensifyControl=intensifyControl}}(GameSystem||(GameSystem={}));var refineControl;!function(t){t.refineControlInit=function(){refineControl=RefineControl.ins(),window.refineControl=refineControl}}(GameSystem||(GameSystem={}));var ladderControl;!function(t){t.ladderControlInit=function(){ladderControl=LadderControl.ins(),window.ladderControl=ladderControl}}(GameSystem||(GameSystem={}));var magicCircleControl;!function(t){t.magicCircleControlInit=function(){magicCircleControl=MagicCircleControl.ins(),window.magicCircleControl=magicCircleControl}}(GameSystem||(GameSystem={}));var meridiansControl;!function(t){t.meridiansControlInit=function(){meridiansControl=MeridiansControl.ins(),window.meridiansControl=meridiansControl}}(GameSystem||(GameSystem={}));var mineControl;!function(t){t.mineControlInit=function(){mineControl=MineControl.ins(),window.mineControl=mineControl}}(GameSystem||(GameSystem={}));var mythEquipControl;!function(t){t.mythEquipControlInit=function(){mythEquipControl=MythEquipControl.ins(),window.mythEquipControl=mythEquipControl}}(GameSystem||(GameSystem={}));var noticeControl;!function(t){t.noticeControlInit=function(){noticeControl=NoticeControl.ins(),window.noticeControl=noticeControl}}(GameSystem||(GameSystem={}));var partnerControl;!function(t){t.partnerControlInit=function(){partnerControl=PartnerControl.ins(),window.partnerControl=partnerControl}}(GameSystem||(GameSystem={}));var payControl;!function(t){t.payControlInit=function(){payControl=PayControl.ins(),window.payControl=payControl}}(GameSystem||(GameSystem={}));var pieceControl;!function(t){t.pieceControlInit=function(){pieceControl=PieceControl.ins(),window.pieceControl=pieceControl}}(GameSystem||(GameSystem={}));var portalControl;!function(t){t.portalControlInit=function(){portalControl=PortalControl.ins(),window.portalControl=portalControl}}(GameSystem||(GameSystem={}));var prestigeControl;!function(t){t.prestigeControlInit=function(){prestigeControl=PrestigeControl.ins(),window.prestigeControl=prestigeControl}}(GameSystem||(GameSystem={}));var rankControl;!function(t){t.rankControlInit=function(){rankControl=RankControl.ins(),window.rankControl=rankControl}}(GameSystem||(GameSystem={}));var rankOtherUserControl;!function(t){t.rankOtherUserControlInit=function(){rankOtherUserControl=RankOtherUserControl.ins(),window.rankOtherUserControl=rankOtherUserControl}}(GameSystem||(GameSystem={}));var reincarnateControl;!function(t){t.reincarnateControlInit=function(){reincarnateControl=ReincarnateControl.ins(),window.reincarnateControl=reincarnateControl}}(GameSystem||(GameSystem={}));var reincarnateStarControl;!function(t){t.reincarnateStarControlInit=function(){reincarnateStarControl=ReincarnateStarControl.ins(),window.reincarnateStarControl=reincarnateStarControl}}(GameSystem||(GameSystem={}));var reincarnateStarBossControl;!function(t){t.reincarnateStarBossControlInit=function(){reincarnateStarBossControl=ReincarnateStarBossControl.ins(),window.reincarnateStarBossControl=reincarnateStarBossControl}}(GameSystem||(GameSystem={}));var reincarnateStarEquipControl;!function(t){t.reincarnateStarEquipControlInit=function(){reincarnateStarEquipControl=ReincarnateStarEquipControl.ins(),window.reincarnateStarEquipControl=reincarnateStarEquipControl}}(GameSystem||(GameSystem={}));var reincarnationControl;!function(t){t.reincarnationControlInit=function(){reincarnationControl=ReincarnationControl.ins(),window.reincarnationControl=reincarnationControl}}(GameSystem||(GameSystem={}));var resultControl;!function(t){t.resultControlInit=function(){resultControl=ResultControl.ins(),window.resultControl=resultControl}}(GameSystem||(GameSystem={}));var equipControl;!function(t){t.equipControlInit=function(){equipControl=EquipControl.ins(),window.equipControl=equipControl}}(GameSystem||(GameSystem={}));var roleControl;!function(t){t.roleControlInit=function(){roleControl=RoleControl.ins(),window.roleControl=roleControl}}(GameSystem||(GameSystem={}));var runeControl;!function(t){t.runeControlInit=function(){runeControl=RuneControl.ins(),window.runeControl=runeControl}}(GameSystem||(GameSystem={}));var skillControl;!function(t){t.skillControlInit=function(){skillControl=SkillControl.ins(),window.skillControl=skillControl}}(GameSystem||(GameSystem={}));var smeltControl;!function(t){t.smeltControlInit=function(){smeltControl=SmeltControl.ins(),window.smeltControl=smeltControl}}(GameSystem||(GameSystem={}));var soulBoneControl;!function(t){t.soulBoneControlInit=function(){soulBoneControl=SoulBoneControl.ins(),window.soulBoneControl=soulBoneControl}}(GameSystem||(GameSystem={}));var loginControl;!function(t){t.loginControlInit=function(){loginControl=LoginControl.ins(),window.loginControl=loginControl}}(GameSystem||(GameSystem={}));var storeControl;!function(t){t.storeControlInit=function(){storeControl=StoreControl.ins(),window.storeControl=storeControl}}(GameSystem||(GameSystem={}));var flameMarkControl;!function(t){t.flameMarkControlInit=function(){flameMarkControl=FlameMarkControl.ins(),window.flameMarkControl=flameMarkControl}}(GameSystem||(GameSystem={}));var superRingControl;!function(t){t.superRingControlInit=function(){superRingControl=SuperRingControl.ins(),window.superRingControl=superRingControl}}(GameSystem||(GameSystem={}));var taskControl;!function(t){t.taskControlInit=function(){taskControl=TaskControl.ins(),window.taskControl=taskControl}}(GameSystem||(GameSystem={}));var thunderControl;!function(t){t.thunderControlInit=function(){thunderControl=ThunderControl.ins(),window.thunderControl=thunderControl}}(GameSystem||(GameSystem={}));var tipsControl;!function(t){t.tipsControlInit=function(){tipsControl=TipsControl.ins(),window.tipsControl=tipsControl}}(GameSystem||(GameSystem={}));var titleControl;!function(t){t.titleControlInit=function(){titleControl=TitleControl.ins(),window.titleControl=titleControl}}(GameSystem||(GameSystem={}));var toseongControl;!function(t){t.toseongControlInit=function(){toseongControl=ToseongControl.ins(),window.toseongControl=toseongControl}}(GameSystem||(GameSystem={}));var trailerControl;!function(t){t.trailerControlInit=function(){trailerControl=TrailerControl.ins(),window.trailerControl=trailerControl}}(GameSystem||(GameSystem={}));var treasureHuntControl;!function(t){t.treasureHuntControlInit=function(){treasureHuntControl=TreasureHuntControl.ins(),window.treasureHuntControl=treasureHuntControl}}(GameSystem||(GameSystem={}));var uitrasoneEquipControl;!function(t){t.uitrasoneEquipControlInit=function(){uitrasoneEquipControl=UitrasoneEquipControl.ins(),window.uitrasoneEquipControl=uitrasoneEquipControl}}(GameSystem||(GameSystem={}));var vipControl;!function(t){t.vipControlInit=function(){vipControl=VipControl.ins(),window.vipControl=vipControl}}(GameSystem||(GameSystem={}));var warriorControl;!function(t){t.warriorControlInit=function(){warriorControl=WarriorControl.ins(),window.warriorControl=warriorControl}}(GameSystem||(GameSystem={}));var weaponsSoulControl;!function(t){t.weaponsSoulControlInit=function(){weaponsSoulControl=WeaponsSoulControl.ins(),window.weaponsSoulControl=weaponsSoulControl}}(GameSystem||(GameSystem={}));var cDKeyControl;!function(t){t.cDKeyControlInit=function(){cDKeyControl=CDKeyControl.ins(),window.cDKeyControl=cDKeyControl}}(GameSystem||(GameSystem={}));var welfareControl;!function(t){t.welfareControlInit=function(){welfareControl=WelfareControl.ins(),window.welfareControl=welfareControl}}(GameSystem||(GameSystem={}));var actorControl;!function(t){t.actorControlInit=function(){actorControl=ActorControl.ins(),window.actorControl=actorControl}}(GameSystem||(GameSystem={}));var heroControl;!function(t){t.heroControlInit=function(){heroControl=HeroControl.ins(),window.heroControl=heroControl}}(GameSystem||(GameSystem={}));var appearanceControl;!function(t){t.appearanceControlInit=function(){appearanceControl=AppearanceControl.ins(),window.appearanceControl=appearanceControl}}(GameSystem||(GameSystem={}));var gameControl;!function(t){t.gameControlInit=function(){gameControl=GameControl.ins(),window.gameControl=gameControl}}(GameSystem||(GameSystem={}));var lookControl;!function(t){t.lookControlInit=function(){lookControl=LookControl.ins(),window.lookControl=lookControl}}(GameSystem||(GameSystem={}));var moveControl;!function(t){t.moveControlInit=function(){moveControl=MoveControl.ins(),window.moveControl=moveControl}}(GameSystem||(GameSystem={}));var multiKillControl;!function(t){t.multiKillControlInit=function(){multiKillControl=MultiKillControl.ins(),window.multiKillControl=multiKillControl}}(GameSystem||(GameSystem={}));var promptControl;!function(t){t.promptControlInit=function(){promptControl=PromptControl.ins(),window.promptControl=promptControl}}(GameSystem||(GameSystem={}));var dailyRedBagControl;!function(t){t.dailyRedBagControlInit=function(){dailyRedBagControl=DailyRedBagControl.ins(),window.dailyRedBagControl=dailyRedBagControl}}(GameSystem||(GameSystem={}));var emailUserControl;!function(t){t.emailUserControlInit=function(){emailUserControl=EmailUserControl.ins(),window.emailUserControl=emailUserControl}}(GameSystem||(GameSystem={}));var guideControl;!function(t){t.guideControlInit=function(){guideControl=GuideControl.ins(),window.guideControl=guideControl}}(GameSystem||(GameSystem={}));var guideSelectControl;!function(t){t.guideSelectControlInit=function(){guideSelectControl=GuideSelectControl.ins(),window.guideSelectControl=guideSelectControl}}(GameSystem||(GameSystem={}));var leaseControl;!function(t){t.leaseControlInit=function(){leaseControl=LeaseControl.ins(),window.leaseControl=leaseControl}}(GameSystem||(GameSystem={}));var officeControl;!function(t){t.officeControlInit=function(){officeControl=OfficeControl.ins(),window.officeControl=officeControl}}(GameSystem||(GameSystem={}));var rambleBlackControl;!function(t){t.rambleBlackControlInit=function(){rambleBlackControl=RambleBlackControl.ins(),window.rambleBlackControl=rambleBlackControl}}(GameSystem||(GameSystem={}));var rambleControl;!function(t){t.rambleControlInit=function(){rambleControl=RambleControl.ins(),window.rambleControl=rambleControl}}(GameSystem||(GameSystem={}));var signInControl;!function(t){t.signInControlInit=function(){signInControl=SignInControl.ins(),window.signInControl=signInControl}}(GameSystem||(GameSystem={}));var starSunControl;!function(t){t.starSunControlInit=function(){starSunControl=StarSunControl.ins(),window.starSunControl=starSunControl}}(GameSystem||(GameSystem={}));var unionBossControl;!function(t){t.unionBossControlInit=function(){unionBossControl=UnionBossControl.ins(),window.unionBossControl=unionBossControl}}(GameSystem||(GameSystem={}));var unionControl;!function(t){t.unionControlInit=function(){unionControl=UnionControl.ins(),window.unionControl=unionControl}}(GameSystem||(GameSystem={}));var unionCopyControl;!function(t){t.unionCopyControlInit=function(){unionCopyControl=UnionCopyControl.ins(),window.unionCopyControl=unionCopyControl}}(GameSystem||(GameSystem={}));var unionStoreControl;!function(t){t.unionStoreControlInit=function(){unionStoreControl=UnionStoreControl.ins(),window.unionStoreControl=unionStoreControl}}(GameSystem||(GameSystem={}));var unionWarControl;!function(t){t.unionWarControlInit=function(){unionWarControl=UnionWarControl.ins(),window.unionWarControl=unionWarControl}}(GameSystem||(GameSystem={}));var warnControl;!function(t){t.warnControlInit=function(){warnControl=WarnControl.ins(),window.warnControl=warnControl}}(GameSystem||(GameSystem={}));var crossFieldControl;!function(t){t.crossFieldControlInit=function(){crossFieldControl=CrossFieldControl.ins(),window.crossFieldControl=crossFieldControl}}(GameSystem||(GameSystem={}));var shareGameControl;!function(t){t.shareGameControlInit=function(){shareGameControl=ShareGameControl.ins(),window.shareGameControl=shareGameControl}}(GameSystem||(GameSystem={})),function(t){t.sealPveControl=SealPveControl.ins.bind(SealPveControl)}(GameSystem||(GameSystem={})),function(t){t.spokesPersonRedPoint=SpokesPersonRedPoint.ins.bind(SpokesPersonRedPoint)}(GameSystem||(GameSystem={})),function(t){t.shenshouRedpoint=BeastRedPoint.ins.bind(BeastRedPoint)}(GameSystem||(GameSystem={})),function(t){t.bookRedPoint=BookRedPoint.ins.bind(BookRedPoint)}(GameSystem||(GameSystem={})),function(t){t.copyRedPoint=CopyRedPoint.ins.bind(CopyRedPoint)}(GameSystem||(GameSystem={})),function(t){t.dailyCopyRedPoint=DailyCopyRedPoint.ins.bind(DailyCopyRedPoint)}(GameSystem||(GameSystem={})),function(t){t.crazyDogRedPoint=CrazyDogRedPoint.ins.bind(CrazyDogRedPoint)}(GameSystem||(GameSystem={})),function(t){t.crossArenaRedPoint=CrossArenaRedPoint.ins.bind(CrossArenaRedPoint)}(GameSystem||(GameSystem={})),function(t){t.crossBossRedpoint=CrossBossRedpoint.ins.bind(CrossBossRedpoint)}(GameSystem||(GameSystem={})),function(t){t.darkHallBossRedPoint=DarkHallBossRedPoint.ins.bind(DarkHallBossRedPoint)}(GameSystem||(GameSystem={})),function(t){t.devildomRedPoint=DevildomRedPoint.ins.bind(DevildomRedPoint)}(GameSystem||(GameSystem={})),function(t){t.dominateBossRedpoint=DominateBossRedpoint.ins.bind(DominateBossRedpoint)}(GameSystem||(GameSystem={})),function(t){t.crossFieldRedPoint=CrossFieldRedPoint.ins.bind(CrossFieldRedPoint)}(GameSystem||(GameSystem={})),function(t){t.hatredRedpoint=HatredRedpoint.ins.bind(HatredRedpoint)}(GameSystem||(GameSystem={})),function(t){t.peakedRedpoint=PeakedRedpoint.ins.bind(PeakedRedpoint)}(GameSystem||(GameSystem={})),function(t){t.totemBossRedpoint=TotemBossRedpoint.ins.bind(TotemBossRedpoint)}(GameSystem||(GameSystem={})),function(t){t.darkEquipRedPointt=DarkEquipRedPoint.ins.bind(DarkEquipRedPoint)}(GameSystem||(GameSystem={})),function(t){t.dominateEquipRedPoint=DominateEquipRedPoint.ins.bind(DominateEquipRedPoint)}(GameSystem||(GameSystem={})),function(t){t.dominateRedpoint=DominateRedpoint.ins.bind(DominateRedpoint)}(GameSystem||(GameSystem={})),function(t){t.featherDeityRedPoint=FeatherDeityRedPoint.ins.bind(FeatherDeityRedPoint)}(GameSystem||(GameSystem={})),function(t){t.godweaponRedPoint=GodWeaponRedPoint.ins.bind(GodWeaponRedPoint)}(GameSystem||(GameSystem={})),function(t){t.heartMethodRedpoint=HeartMethodRedPoint.ins.bind(HeartMethodRedPoint)}(GameSystem||(GameSystem={})),function(t){t.heirloomRedPoint=HeirloomRedPoint.ins.bind(HeirloomRedPoint)}(GameSystem||(GameSystem={})),function(t){t.crazybtplayCopyRedPoint=CrazybtplayCopyRedPoint.ins.bind(CrazybtplayCopyRedPoint)}(GameSystem||(GameSystem={})),function(t){t.shenWuRedPoint=CrazybtplayRedPoint.ins.bind(CrazybtplayRedPoint)}(GameSystem||(GameSystem={})),function(t){t.tuTengRedPoint=TotemRedPoint.ins.bind(TotemRedPoint)}(GameSystem||(GameSystem={})),function(t){t.intensifyRedPoint=IntensifyRedPoint.ins.bind(IntensifyRedPoint)}(GameSystem||(GameSystem={})),function(t){t.playWayRedPoint=PlayWayRedPoint.ins.bind(PlayWayRedPoint)}(GameSystem||(GameSystem={})),function(t){t.mineRedPoint=MineRedPoint.ins.bind(MineRedPoint)}(GameSystem||(GameSystem={})),function(t){t.mythEquipRedPoint=MythEquipRedPoint.ins.bind(MythEquipRedPoint)}(GameSystem||(GameSystem={})),function(t){t.reincarnateStarRedPoint=ReincarnateStarRedPoint.ins.bind(ReincarnateStarRedPoint)}(GameSystem||(GameSystem={})),function(t){t.runeRedPoint=RuneRedPoint.ins.bind(RuneRedPoint)}(GameSystem||(GameSystem={})),function(t){t.soulBoneRedPoint=SoulBoneRedPoint.ins.bind(SoulBoneRedPoint)}(GameSystem||(GameSystem={})),function(t){StoreRedPoint.ins.bind(StoreRedPoint)}(GameSystem||(GameSystem={})),function(t){t.warriorModel=WarriorModel.ins.bind(WarriorModel)}(GameSystem||(GameSystem={})),function(t){t.entrustMgr=EntrustMgr.ins.bind(EntrustMgr)}(GameSystem||(GameSystem={})),function(t){t.dieGuide=DieGuide.ins.bind(DieGuide)}(GameSystem||(GameSystem={})),function(t){t.gameServer=GameServer.ins.bind(GameServer)}(GameSystem||(GameSystem={})),function(t){t.officeRedPoint=OfficeRedPoint.ins.bind(OfficeRedPoint)}(GameSystem||(GameSystem={})),function(t){t.clientStorage=ClientStorage.ins.bind(ClientStorage)}(GameSystem||(GameSystem={})),function(t){t.serverStorage=ServerStorage.ins.bind(ServerStorage)}(GameSystem||(GameSystem={})),function(t){t.starSunRedPoint=StarSunRedPoint.ins.bind(StarSunRedPoint)}(GameSystem||(GameSystem={})),function(t){UnionRedPoint.ins.bind(UnionRedPoint)}(GameSystem||(GameSystem={})),function(t){t.devourEquip=DevourEquipContorl.ins.bind(DevourEquipContorl)}(GameSystem||(GameSystem={})),function(t){t.devourEquipRedPoints=DevourEquipRedPoint.ins.bind(DevourEquipRedPoint)}(GameSystem||(GameSystem={}));var MidFestivalItemRender=function(t){function e(){var e=t.call(this)||this;return e._shap=new egret.Shape,e.skinName="MidFestivalItemSkin",e._shap.x=e.process.width>>1,e._shap.y=e.process.height>>1,e._shap.rotation=-90,e.processGroup.addChild(e._shap),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.config,e=this.data.percent/100;this.select.visible=this.data.select,this.redPoint.visible=this.data.redPoint,this.starName.text=t.zqStar?t.zqStar.starName:"",this.starIcon.source=t.zqStar?t.zqStar.starIcon:"",this.process.mask=this._shap,DisplayUtils.drawCir(this._shap,this.process.width>>1,360*e)}},e}(BaseItemRender);__reflect(MidFestivalItemRender.prototype,"MidFestivalItemRender");var NoticeListItemRender=function(t){function e(){var e=t.call(this)||this;return e.job=[],e.skinName="NoticeListItemSkin",e.job=["",LangMgr.getValueByKey("job2"),LangMgr.getValueByKey("job3"),LangMgr.getValueByKey("job4")],e}return __extends(e,t),e.prototype.dataChanged=function(){var t="";this.activityID=this.data.activityID,this.activityType=this.data.activityType,this.actType=this.data.actType;var e,i=this.data.name,n=this.data.index;if(0==this.actType?e=DataCenter.ins().Amusement9Config[this.activityID][n]:1==this.actType&&(e=DataCenter.ins().PAmusementType9Config[this.activityID][n]),e){var o="",s=ColorUtils.NORMAL_COLOR;if(e.reward[0].type){var r=DataCenter.ins().ItemConfig[e.reward[0].id];o=r.name,s=ItemUtils.getQualityColor(r);var a=ItemUtils.getType(r);0==a&&r&&(o+=r.zsLevel>0?"("+r.zsLevel+LangMgr.getValueByKey("numberRotation",""):"("+r.level+LangMgr.getValueByKey("numberLevel",""),o+=this.job[ItemUtils.getJob(r)]+")"),t="<font color = '#12b2ff'>"+i+"</font> "+(this.data.des?this.data.des:LangMgr.getValueByKey("resultGet",""),"")+" <font color='"+s+"'>"+o+"</font>"}else{var l=1;switch(e.reward[0].id){case 2:l=5;break;case 1:l=0;break;case 4:l=2;break;case 10:l=2;break;case 13:l=2}o=Currency.getCurrencyName(e.reward[0].id),s=LangMgr.getColor("qualityColor"+l),t="<font color = '#12b2ff'>"+i+"</font> "+LangMgr.getValueByKey("resultGet","")+"<font color='"+s+"'>"+o+"</font>"}}this.showText.textFlow=TextUtils.generateTextFlow(t)},e}(BaseItemRender);__reflect(NoticeListItemRender.prototype,"NoticeListItemRender");var NoticeYBListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoticeListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.name;this.activityID=this.data.activityID;var e=this.data.multiple,i=this.data.yb,n="",o="",s=ColorUtils.NORMAL_COLOR;o=Currency.getCurrencyName(2),s=LangMgr.getColor("color22"),n=LangMgr.getValueByKey("activitCongratulationGet1",t,s,e,s,i),this.showText.textFlow=TextUtils.generateTextFlow(n)},e}(BaseItemRender);__reflect(NoticeYBListItemRender.prototype,"NoticeYBListItemRender");var PAmusementControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activityData={},e.palyEffList=[],e.indexCurrDabiao=0,e.nextDayState=0,e.hfLoginDay=1,e.geLoginDay=1,e.isSuccee=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initZero=function(){if(this.activityData)for(var t in this.activityData){var e=+t;if(1e4>e){var i=DataCenter.ins().AmusementConfig[t];i&&this.upChangePage(e)}}},e.prototype.getAmusementDataById=function(t){return this.activityData[t]},e.prototype.getPalyEffListById=function(t){return this.palyEffList[t]},e.prototype.setPalyEffListById=function(t,e){this.palyEffList[t]=e},e.prototype.downActivityData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.activityData={};for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var o=PAmusementDataFactory.init(t[i][n]);o&&(this.activityData[o.id]=o)}this.dispatchActivityIsGetAwards()},e.prototype.dispatchActivityIsGetAwards=function(){EventMgr.ins().dispatch(437)},e.prototype.upReward=function(t,e,i){var n=[t,e],o=DataCenter.ins().PAmusementConfig[t];return o&&9==o.activityType&&(e||n.push(i)),n},e.prototype.downRewardResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var o=t[i][n];this.isSuccee=o[0];var s=o[1],r=this.getAmusementDataById(s);return r.updateAmusement(o.slice(2)),this.dispatchActivityPanel(s),this.dispatchActivityIsGetAwards(),void EventMgr.ins().dispatch(438,s)}},e.prototype.dispatchActivityPanel=function(t){EventMgr.ins().dispatch(440,t)},e.prototype.upChangePage=function(t){return[t]},e.prototype.downChangePage=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var o=PAmusementDataFactory.init(t[i][n]);
return o&&(this.activityData[o.id]=o),this.dispatchActivityIsGetAwards(),void EventMgr.ins().dispatch(439,o?o.id:0)}},e.prototype.getbtnInfo=function(t){var e=DataCenter.ins().PAmusementBtnConfig;return e[t]?e[t]:null},e.prototype.isShowRedPointByBtnInfo=function(t){var e=!1;return e=this.checkAcCanGet(t.id+"")},e.prototype.checkAcCanGet=function(t){var e=this.activityData;for(var i in e)if(i==t&&e[i].isOpenActivity()&&e[i].canReward()&&e[i].specialState())return!0;return!1},e.prototype.checkOtherCharge2CanGet=function(){var t=payControl.getRechargeData(1),e=DataCenter.ins().Recharge2Config[t.day/7>=1?2:1][t.day%7];for(var i in e)if(0==(t.isAwards>>e[i].index&1)&&t.num>=e[i].pay)return!0;return!1},e.prototype.getisCangetDabiao3=function(t){var e=pAmusementControl.getAmusementDataById(t);return e.canOnlyReward?(e.canOnlyReward(),e.btn1||e.btn2):this.checkAcCanGet(t+"")},e.prototype.getisCanBuyXianGou=function(t){var e=!1,i=DataCenter.ins().PAmusement2Config[t];if(i)for(var n=0;n<i.length&&!(e=this.getisCanBuyXianGouItem(t,n));n++);return e},e.prototype.getisCanBuyXianGouItem=function(t,e){var i=!1,n=pAmusementControl.activityData[t],o=DataCenter.ins().PAmusement2Config[t];if(n&&o){var s=o[e],r=n.buyData[e]||0;if(s&&r){var a=1==s.currencyType?ActorControl.gold:ActorControl.yb,l=1==s.currencyType,h=a>=s.price,u=s.count-r>0;i=l&&h&&u}}return i},e.prototype.getType9RedPoint=function(t){var e=!1;pAmusementControl.activityData[t];if(this.getRollSum(t))e=!0;else{var i=DataCenter.ins().PAmusementType9Config[t];for(var n in i[0].reward)if(this.isGetRollReward(t,+n)){e=!0;break}}return e},e.prototype.isGetRollReward=function(t,e){var i=pAmusementControl.activityData[t],n=DataCenter.ins().PAmusementType9Config[t];return n&&n[0]&&n[0].reward[e].times&&i.count>=n[0].reward[e].times&&!(i.record>>e+1&1)?!0:!1},e.prototype.getRollSum=function(t){var e=DataCenter.ins().PAmusementType9Config[t];if(e&&e[0]){var i=backpackControl.getBagItemById(e[0].item);if(i)return!0}return!1},e.prototype.getIsRollTen=function(t){var e=DataCenter.ins().Amusement9Config[t][0];if(e){var i=0;if(e.item){var n=backpackControl.getBagItemById(e.item);if(n&&(i+=n.count),i>=10)return!0}if(i=10-i,e.yb&&ActorControl.yb>=e.yb*i)return!0}return!1},e.NotReached=0,e.CanGet=1,e.Geted=2,e.NOKILL=0,e.KILL=1,__decorate([down(1,[ByteConst.PAmusementType1Inits,ByteConst.PAmusementType2Inits,ByteConst.PAmusementType3Inits].concat(ByteConst.PAmusementCovers,[ByteConst.PAmusementType9Inits]))],e.prototype,"downActivityData",null),__decorate([up(2,[3,2,1])],e.prototype,"upReward",null),__decorate([down(2,[ByteConst.PAmusementType1Updates,ByteConst.PAmusementType2Updates,ByteConst.PAmusementType3Updates].concat(ByteConst.PAmusementCovers,[ByteConst.PAmusementType9Updates]))],e.prototype,"downRewardResult",null),__decorate([up(7,[3])],e.prototype,"upChangePage",null),__decorate([down(7,[ByteConst.PAmusementType1Inits,ByteConst.PAmusementType2Inits,ByteConst.PAmusementType3Inits].concat(ByteConst.PAmusementCovers,[ByteConst.PAmusementType9Inits]))],e.prototype,"downChangePage",null),e=__decorate([protocolsId(68)],e)}(BaseSystem);__reflect(PAmusementControl.prototype,"PAmusementControl");var LvTimeLimitGiftTipsView=function(t){function e(){var e=t.call(this)||this;return e.actIdx=1,e.skinName="LvTimeLimitGiftTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.buyBtn,this.onTouch),this.addCustomEvent(437,this.upData),this.actData=pAmusementControl.activityData[t],this.initDt(),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime()},e.prototype.upData=function(){this.actData&&this.actData&&this.actData.buyData[this.actIdx]&&UIMgr.ins().close(this)},e.prototype.initDt=function(){var t=DataCenter.ins().PAmusement2Config[this.actData.id][this.actIdx];this.money0.text=LangMgr.getValueByKey("primecost")+t.originalPrice,this.money1.text=LangMgr.getValueByKey("limitTimediscountprice")+t.price,this.gifttips.source=t.source[0];for(var e=0;e<this.rewardGroup.numElements;e++){var i=e+1;this["reward"+i]&&(this["reward"+i].visible=!!t.rewards[e],this["reward"+i].visible&&(this["reward"+i].data=t.rewards[e]))}},e.prototype.onTime=function(){this.countdown.text=DateUtils.getFormatBySecond(this.actData.getLeftTime(),DateUtils.TIME_FORMAT_11)},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.buyBtn:if(!CommonFun.checkBackpackCount())return;if(!this.actData)return;var e=DataCenter.ins().PAmusement2Config[this.actData.id],i=e[this.actIdx];if(!CommonFun.checkCurrency(i.price))return;pAmusementControl.upReward(this.actData.id,this.actIdx)}},e}(BaseEuiView);__reflect(LvTimeLimitGiftTipsView.prototype,"LvTimeLimitGiftTipsView");var LvTimeLimitGiftView=function(t){function e(){var e=t.call(this)||this;return e.PActivityIns=PAmusementControl.ins(),e.skinName="LvTimeLimitGiftViewSkin",e.isTopLevel=!0,e.selectIndex=0,e.canVis=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.menuList.itemRenderer=AmusementBtnItemRender},e.openCheck=function(t){var e=PAmusementControl.ins();if(!(void 0==t||e.getAmusementDataById(t)&&e.getAmusementDataById(t).isOpenActivity()))return tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivityColor")),!1;var i=Object.keys(e.activityData);if(!i.length)return tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1;for(var n in e.activityData){var o=e.activityData[n];if(4==o.pageType&&o.isOpenActivity()&&!o.getHide())return!0}return tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e.prototype.open=function(e){t.prototype.open.call(this,e),this.roleSelect.hideRole(),this.updateView(),this.addCustomEvent(178,this.refushRedPoint),this.addCustomEvent(180,this.refushRedPoint),this.addCustomEvent(182,this.refushRedPoint),this.addCustomEvent(446,this.refushRedPoint),this.addCustomEvent(437,this.refushRedPoint)},e.prototype.getDataUpdataView=function(){var t=this.PActivityIns.activityData;for(var e in t){var i=t[e];if(4==i.pageType&&i.isOpenActivity()&&!i.getHide()){var n=this.PActivityIns.getbtnInfo(e);if(!n||n.activityType&&2==n.activityType)continue;Assert(n,"LvTimeLimitGiftView  data   "+e)||this._datas.push(n)}}},e.prototype.onClickMenu=function(e){t.prototype.onClickMenu.call(this,e);var i=DataCenter.ins().PAmusementConfig[this.amusementPanelList[this.selectIndex].activityID],n=DataCenter.ins().PAmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID];if(n){if(n.redPoint){var o=this.PActivityIns.getAmusementDataById(this.amusementPanelList[this.selectIndex].activityID);o&&o.firstRedPoint&&(o.firstRedPoint=!1),amusementControl.dispatchFirstRedPoint()}n.type?i&&(3==i.activityType||9==i.activityType?this.setOpenIndex(this.selectIndex):this.PActivityIns.upChangePage(this.amusementPanelList[this.selectIndex].activityID)):this.setOpenIndex(this.selectIndex)}},e.prototype.sort=function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:t.activityType>e.activityType?1:-1},e.prototype.zeroUpdate=function(){var t=!1,e=Math.floor(GameServer.serverTime/1e3),i=0;for(var n in this.PActivityIns.activityData){if(Math.floor(DateUtils.formatMiniDateTime(this.PActivityIns.getAmusementDataById(+n).startTime)/1e3)==e||DateUtils.formatMiniDateTime(this.PActivityIns.getAmusementDataById(+n).endTime)<=0){t=!0;break}i||i++}t&&this.updateView(),i||UIMgr.ins().close(this)},e}(AmusementBaseView);__reflect(LvTimeLimitGiftView.prototype,"LvTimeLimitGiftView");var PAmusementDataFactory=function(){function t(){}return t.init=function(t){var e=t[3],i=egret.getDefinitionByName("PAmusementType"+e+"DataVo"),n=new i;n.id=t[0],n.startTime=t[1],n.endTime=t[2],n.type=e,n.activityType=1;var o=DataCenter.ins().PAmusementConfig[n.id];return o&&(n.duration=o.duration,n.pageType=o.pageType),n.initAmusement(t.slice(5)),n},t}();__reflect(PAmusementDataFactory.prototype,"PAmusementDataFactory");var PAmusementType1DataVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AmusementType1DataVo);__reflect(PAmusementType1DataVo.prototype,"PAmusementType1DataVo");var PAmusementType2DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyData=[],e.serverBuyData=[],e}return __extends(e,t),e.prototype.initAmusement=function(t){for(var e=0;e<t[0].length;e++){var i=e+1;this.buyData[i]=t[0][e][0],this.serverBuyData[i]=t[0][e][1]}this.sumRMB=t[1]},e.prototype.updateAmusement=function(t){var e=t[0];this.buyData[e]=t[1],this.serverBuyData[e]=t[2]},e.prototype.canReward=function(){if(ActorControl.level<e.LimitLevel)return!1;if(this.getZsLvEndActivity())return!1;var t;t=pAmusementControl.getAmusementDataById(this.id);var i=DataCenter.ins().PAmusement2Config[this.id],n=!1;for(var o in i){var s=i[o],r=t.buyData[s.index]>=s.count?!0:!1;if(!r&&t.sumRMB>=s.needRecharge&&ActorControl.yb>=s.price&&vipControl.lv>=s.vip&&!n)return!0}return!1},e.prototype.isOpenActivity=function(){if(this.getZsLvEndActivity())return!1;var t=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return 0>t&&e>0},e.prototype.getHide=function(){if(this.isHide)return this.isHide;for(var t=DataCenter.ins().PAmusement2Config[this.id],e=1;e<this.buyData.length;e++){var i=t[e];if(this.buyData[e]<i.count)return this.isHide=!1,this.isHide}return this.isHide=!0,this.isHide},e.LimitLevel=50,e}(AmusementBaseDataVo);__reflect(PAmusementType2DataVo.prototype,"PAmusementType2DataVo");var PAmusementType3DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dabiao=[],e.chongzhiNum=0,e.chongzhiTotal=0,e.btn1=!1,e.btn2=!1,e.image1=!1,e.image2=!1,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.dabiao=[];for(var e=0;e<t[0].length;e++)this.dabiao.push(t[0][e]);this.chongzhiNum=t[1],this.chongzhiTotal=t[2],this.recrod=t[3]},e.prototype.updateAmusement=function(t){t[0];this.recrod=t[1]},e.prototype.openDay=function(){var t=DataCenter.ins().PAmusement3Config[this.id];return t&&t[0]?t[0].day:7},e.prototype.canReward=function(){var t=DataCenter.ins().PAmusement3Config[this.id],e=this.recrod,i=-1,n=0;for(var o in t){var s=e>>t[o].index&1;if(1==t[o].type){if(this.dabiao[n]>=t[o].day&&0==s)return!0}else if(2==t[o].type&&t[o].val<=this.chongzhiTotal){if(0==s)return!0}else if(3==t[o].type&&t[o].val<=this.chongzhiNum&&(-1==i&&(i=this.getCurIndex(3)),i==t[o].index&&0==s))return!0;n++}return!1},Object.defineProperty(e.prototype,"day7text",{get:function(){var t=DataCenter.ins().PAmusement3Config[this.id];for(var e in t)1==t[e].type&&(this.rewards1=t[e].rewards,this._day7text=LangMgr.getValueByKey("activitShow1","<font color='#ffff00'>"+t[e].day+"</font>","<font color='#ffff00'>"+t[e].val+"</font>"));return this._day7text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totaltext",{get:function(){var t=DataCenter.ins().PAmusement3Config[this.id];for(var e in t)2==t[e].type&&(this.maxTotal=t[e].val,this.rewards2=t[e].rewards,this._totaltext=LangMgr.getValueByKey("activitShow2","<font color='#ffff00'>"+t[e].val+"</font>"));return this._totaltext},enumerable:!0,configurable:!0}),e.prototype.canOnlyReward=function(){var t=DataCenter.ins().PAmusement3Config[this.id],e=this.recrod;this.btn1=!1,this.btn2=!1,this.image1=!1,this.image2=!1;for(var i in t){var n=e>>t[i].index&1;1==t[i].type&&this.dabiao&&this.dabiao[0]>=t[i].day&&(0==n&&(this.btn1=!0),1==n&&(this.image1=!0)),2==t[i].type&&t[i].val<=this.chongzhiTotal&&(0==n&&(this.btn2=!0),1==n&&(this.image2=!0))}},e.prototype.getDateTime=function(t){var e=t.split(/[-,.,:]/g),i=new Date(+e[0],+e[1]-1,+e[2],+e[3]||0,+e[4]||0);return i.getTime()},e.prototype.curOpenDay=function(){var t=Math.floor(GameServer.serverTime-DateUtils.formatMiniDateTime(this.startTime)/1e3/3600/24);return t},e.prototype.getCurIndex=function(t){var e=(DataCenter.ins().PAmusementConfig[this.id],DataCenter.ins().PAmusement3Config[this.id]),i=0;this.startTime&&(i=this.curOpenDay());var n={};for(var o in e)n[e[o].type]=1;var s=Object.keys(n);(1==s.length||void 0==t)&&(t=+s[0]);var r,a=[];for(r in e)e[r].type==t&&a.push(e[r]);a.sort(function(t,e){return t.day<e.day?-1:1});for(var l=0,h=a;l<h.length;l++){var u=h[l];if(r=u.index,1==t||2==t){if(i<u.day)return+r}else if(3==t&&i<u.day)return+r}return+r},e.prototype.getRewardStateById=function(t){var e=DataCenter.ins().PAmusement3Config[this.id][t];switch(e.showType){case 6:case 8:if(this.chongzhiTotal<e.val)return AmusementControl.NotReached;break;case 7:if(this.dabiao[t-1]<e.day)return AmusementControl.NotReached}var i=this.recrod>>e.index&1;return i?AmusementControl.Geted:AmusementControl.CanGet},e}(AmusementBaseDataVo);__reflect(PAmusementType3DataVo.prototype,"PAmusementType3DataVo");var PAmusementType9DataVo=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(AmusementType9DataVo);__reflect(PAmusementType9DataVo.prototype,"PAmusementType9DataVo");var SuicideLimitBuyTipsView=function(t){function e(){var e=t.call(this)||this;return e.actIdx=1,e.skinName="SuicideLimitBuyTipsViewSkin",e.uilayer=GameLayer.POPUP,e.list0.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.buyBtn,this.onTouch),this.addCustomEvent(437,this.upData),this.actData=t,this.initDt(),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime()},e.prototype.upData=function(){this.actData=pAmusementControl.activityData[this.actData.id],this.actData.buyData[this.actIdx]&&UIMgr.ins().close(this)},e.prototype.initDt=function(){var t=DataCenter.ins().PAmusement2Config[this.actData.id][1];this.list0.dataProvider=new eui.ArrayCollection(t.rewards),this.money0.text=t.originalPrice+"",this.money1.text=t.price+""},e.prototype.onTime=function(){this.countdown.text=DateUtils.getFormatBySecond(this.actData.getLeftTime(),DateUtils.TIME_FORMAT_11)},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.buyBtn:if(!CommonFun.checkBackpackCount())return;if(!this.actData)return;var e=DataCenter.ins().PAmusement2Config[this.actData.id],i=e[this.actIdx];if(!CommonFun.checkCurrency(i.price))return;pAmusementControl.upReward(this.actData.id,this.actIdx)}},e}(BaseEuiView);__reflect(SuicideLimitBuyTipsView.prototype,"SuicideLimitBuyTipsView");var SuicideLimitBuyView=function(t){function e(){var e=t.call(this)||this;return e.actIdx=1,e.isTopLevel=!0,e.skinName="SuicideLimitBuyViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.leftRed0.visible=!1,this.rightRed0.visible=!1,this.menuList0.itemRenderer=AmusementBtnItemRender,this.list0.itemRenderer=ItemBase,this.tabDt=new eui.ArrayCollection,this.menuList0.dataProvider=this.tabDt,this.buyLabelTxt=this.buyBtn0.label},e.prototype.open=function(t){this.addEventChange(this.menuList0,this.onClickMenu),this.addEventChangeEnd(this.menuScroller0,this.onChange),this.addEventTouchTap(this.buyBtn0,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.leftBtn0,this.onTouchBtn),this.addEventTouchTap(this.rightBtn0,this.onTouchBtn),this.addCustomEvent(437,this.upData),SoundUtils.ins().playEffect(SoundUtils.VIEW),this.initDt(),this.actIdList&&this.actIdList.length?(t=t||0,this.setOpenIndex(t),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime()):UIMgr.ins().close(this)},e.prototype.onTime=function(){var t=pAmusementControl.getAmusementDataById(this.curActId);this.countdown.text=DateUtils.getFormatBySecond(t.getLeftTime(),DateUtils.TIME_FORMAT_5)},e.prototype.onTouch=function(t){switch(t.target){case this.buyBtn0:if(!CommonFun.checkBackpackCount())return;var e=DataCenter.ins().PAmusement2Config[this.curActId],i=e[this.actIdx];if(!CommonFun.checkCurrency(i.price))return;pAmusementControl.upReward(this.curActId,this.actIdx);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onTouchBtn=function(t){var e=460,i=0;switch(t.target){case this.leftBtn0:i=this.menuList0.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.menuList0.scrollH=i;break;case this.rightBtn0:i=this.menuList0.scrollH+e,i=92*Math.round(i/92),i>this.menuList0.contentWidth-this.menuScroller0.width&&(i=this.menuList0.contentWidth-this.menuScroller0.width),this.menuList0.scrollH=i}this.onChange()},e.prototype.onChange=function(){this.menuList0.scrollH<46?(this.leftBtn0.visible=!1,this.rightBtn0.visible=!0):this.menuList0.scrollH>=this.menuList0.contentWidth-this.menuList0.width-46?(this.leftBtn0.visible=!0,this.rightBtn0.visible=!1):(this.leftBtn0.visible=!0,this.rightBtn0.visible=!0),this.leftRed0.visible=this.leftBtn0.visible,this.rightRed0.visible=this.rightBtn0.visible},e.prototype.onClickMenu=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.initDt=function(){this.actIdList=[];var t=[];for(var e in pAmusementControl.activityData){var i=pAmusementControl.activityData[e];i&&i instanceof PAmusementType2DataVo&&3==i.pageType&&i.isOpenActivity()&&!i.getHide()&&(t.push(DataCenter.ins().PAmusementBtnConfig[i.id]),this.actIdList.push(i.id))}this.currentState=t.length>1?"multiple":"single",this.validateNow(),t.sort(this.sort),this.tabDt.replaceAll(t),t.length<=5&&(this.leftRed0.visible=!1,this.rightRed0.visible=!1,this.leftBtn0.visible=!1,this.rightBtn0.visible=!1)},e.prototype.setOpenIndex=function(t){if(this.curActId=this.actIdList[t],DataCenter.ins().PAmusement2Config[this.curActId]){var e=DataCenter.ins().PAmusement2Config[this.curActId][this.actIdx];e&&(this.list0.dataProvider=new eui.ArrayCollection(e.rewards),this.money0.text=e.originalPrice+"",this.Money1.text=e.price+"",this.awardShow.source=e.source[0],this.upData())}},e.prototype.upData=function(){var t=pAmusementControl.activityData[this.curActId];this.buyBtn0.enabled=0==t.buyData[this.actIdx],this.redPoint0.visible=pAmusementControl.isShowRedPointByBtnInfo(DataCenter.ins().PAmusementBtnConfig[this.curActId]),t.buyData[this.actIdx]>0?this.buyBtn0.label=LangMgr.getValueByKey("fdAlreadingBuy"):this.buyBtn0.label=this.buyLabelTxt,this.menuList0.selectedIndex=this.actIdList.indexOf(this.curActId)},e.prototype.sort=function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:t.activityType>e.activityType?1:-1},e}(BaseEuiView);__reflect(SuicideLimitBuyView.prototype,"SuicideLimitBuyView");var AmusementTotalEnterView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementWinViewSkin",e}return __extends(e,t),e.openCheck=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return SwitchMgr.ins().checkOpen(2,!0)?(e[2]=function(t,e){return Boolean(t.pageType)||2==t.timeType||3==t.timeType},e[3]=function(t,e){return Boolean(t.pageType)},t.openCheck.apply(this,e)):!1},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.apply(this,e),this.updateView(),this.addCustomEvent(392,this.refushRedPoint),this.addCustomEvent(178,this.refushRedPoint),this.addCustomEvent(180,this.refushRedPoint),this.addCustomEvent(182,this.refushRedPoint),this.addCustomEvent(446,this.refushRedPoint),this.addCustomEvent(173,this.refushRedPoint),this.addCustomEvent(437,this.refushRedPoint),GameServer.serverOpenDay<7?this.title.source="biaoti_kaifuhuodong":this.title.source="biaoti_huodong"},e.prototype.activityFiltrate=function(t){return Boolean(t.pageType)||2==t.timeType||3==t.timeType},e.prototype.pActivityFiltrate=function(t){return Boolean(t.pageType)},e.prototype.zeroUpdate=function(){var t=!1,e=Math.floor(GameServer.serverTime/1e3),i=0;for(var n in amusementControl.activityData){if(Math.floor(DateUtils.formatMiniDateTime(amusementControl.getAmusementDataById(+n).startTime)/1e3)==e||DateUtils.formatMiniDateTime(amusementControl.getAmusementDataById(+n).endTime)<=0){t=!0;break}i||i++}for(var n in pAmusementControl.activityData){if(Math.floor(DateUtils.formatMiniDateTime(pAmusementControl.getAmusementDataById(+n).startTime)/1e3)==e||DateUtils.formatMiniDateTime(pAmusementControl.getAmusementDataById(+n).endTime)<=0){t=!0;break}i||i++}t&&this.updateView(),i||UIMgr.ins().close(this)},e}(AmusementBaseView);__reflect(AmusementTotalEnterView.prototype,"AmusementTotalEnterView");var CbtestAmusementView=function(t){function e(){var e=t.call(this)||this;return e.curLevelIndex=0,e.skinName="CbtestAmusementViewSkin",e.uilayer=GameLayer.POPUP,e.defaultText=LangMgr.getValueByKey("activitTips"),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.sendBtn,this.onTap),this.addEventTouchTap(this.arrowleft,this.onTap),this.addEventTouchTap(this.arrowright,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.edit,this.onTap),this.addEventChange(this.tab,this.onSelectIndex),this.addEventFocusIn(this.edit,this.onTap),this.setSelectIndex(t[0]||0)},e.prototype.setSelectIndex=function(t){if(this.viewStack.selectedIndex=t,0==t){if(!this.levelData){this.levelData=[];var e=DataCenter.ins().EmailLevelConfig;for(var i in e)e[i].mType&&this.levelData.push(+i);this.levelData.sort(function(t,e){return e>t?-1:1})}var n=ActorControl.level,o=reincarnateControl.lv;this.curLevelIndex=0;for(var s=0;s<this.levelData.length;s++){this.curLevelIndex=s;var r=Math.floor(this.levelData[s]/1e3);if(1>r){if(n<this.levelData[s])break}else if(r>o)break}this.updateLevel(this.curLevelIndex);var a=GameServer.serverOpenDay+1,l=DataCenter.ins().EmailLoginConfig[a];if(l){var h=l.idList[0],u=DataCenter.ins().EmailIdConfig[h];this.count0.text=u.attachment[0].count+""}else this.count0.text="0"}},e.prototype.updateLevel=function(t){0>t&&(t=0),t>=this.levelData.length&&(t=this.levelData.length-1),0==t?(this.arrowleft.visible=!1,this.arrowright.visible=!0):t==this.levelData.length-1?(this.arrowleft.visible=!0,this.arrowright.visible=!1):(this.arrowleft.visible=!0,this.arrowright.visible=!0),this.curLevelIndex=t;var e=this.levelData[t],i=Math.floor(this.levelData[t]/1e3);1>i?(e>ActorControl.level?this.countDesc.text=LangMgr.getValueByKey("activitMoreUpdate",e-ActorControl.level):this.countDesc.text="",this.lvText.text=LangMgr.getValueByKey("activitLevelAwards",e)):(i>reincarnateControl.lv?this.countDesc.text=LangMgr.getValueByKey("activitRotationMore",i):this.countDesc.text="",this.lvText.text=LangMgr.getValueByKey("activitRotationAwards",i));var n=DataCenter.ins().EmailLevelConfig[e],o=n.idList[0],s=DataCenter.ins().EmailIdConfig[o];this.count2.text=s.attachment[0].count+""},e.prototype.onSelectIndex=function(t){this.setSelectIndex(t.itemIndex)},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.bgClose)UIMgr.ins().close(this);else if(e==this.arrowleft)this.updateLevel(this.curLevelIndex-1);else if(e==this.arrowright)this.updateLevel(this.curLevelIndex+1);else if(e==this.sendBtn){if(0==this.edit.text.length||this.edit.text==this.defaultText)return void tipsControl.showTips(LangMgr.getValueByKey("customNoEmpty"))}else e==this.edit&&this.edit.text==this.defaultText&&(this.edit.text="",this.edit.textColor=LangMgr.getColor("color39"))},e.prototype.callBack=function(){this.edit.text=""},e.prototype.close=function(){this.removeEventTouchTap(this.sendBtn,this.onTap),this.removeEventTouchTap(this.arrowleft,this.onTap),this.removeEventTouchTap(this.arrowright,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.edit,this.onTap),this.removeEventChange(this.tab,this.onSelectIndex),this.removeEventFocusIn(this.edit,this.onTap)},e}(BaseEuiView);__reflect(CbtestAmusementView.prototype,"CbtestAmusementView");var CelebrationItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="CelebrationRechargeItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data,e=amusementControl.getAmusementDataById(t.config.Id),i=e.getRewardStateById(t.config.index);this.redPoint.visible=!1,this.already.visible=!1;var n=ColorUtils.NORMAL_COLOR;this.ball.source=t.config.expAttr[0],i==AmusementControl.Geted?(this.already.visible=!0,n=LangMgr.getColor("color43"),this.ball.source=t.config.expAttr[1]):i==AmusementControl.CanGet?(n=LangMgr.getColor("color43"),this.redPoint.visible=!0):n=LangMgr.getColor("color22"),this.now.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+Math.floor(t.curCost/GlobalModel.chargeRate)),this.target.text=Math.floor(t.config.val/GlobalModel.chargeRate)+"",this.ball0.visible=!1}},e.prototype.setSelect=function(t){this.ball0.visible=t},e}(BaseItemRender);__reflect(CelebrationItemRender.prototype,"CelebrationItemRender");var CelebrationRechargeItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="CelebrationRechargeItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data,e=amusementControl.getAmusementDataById(t.config.Id),i=e.getRewardStateById(t.config.index);this.redPoint.visible=!1,this.already.visible=!1;var n=ColorUtils.NORMAL_COLOR;this.ball.source=t.config.expAttr[0],i==AmusementControl.Geted?(this.already.visible=!0,n=LangMgr.getColor("color43"),this.ball.source=t.config.expAttr[1]):i==AmusementControl.CanGet?(n=LangMgr.getColor("color43"),this.redPoint.visible=!0):n=LangMgr.getColor("color22"),this.now.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+Math.floor(t.curCost/GlobalModel.chargeRate)),this.target.text=Math.floor(t.config.val/GlobalModel.chargeRate)+"",this.ball0.visible=!1}},e.prototype.setSelect=function(t){this.ball0.visible=t},e}(BaseItemRender);__reflect(CelebrationRechargeItemRender.prototype,"CelebrationRechargeItemRender");var ChristmasRechargeItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t,e=this.data[0],i=this.data[1];0==e?t=amusementControl.getAmusementDataById(i.Id):1==e&&(t=pAmusementControl.getAmusementDataById(i.Id)),this.reward.data=i.rewards[0],this.reward.hideName(),this.schedule.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color43")+"&T:"+Math.floor(t.chongzhiTotal/GlobalModel.chargeRate)+"|/"+Math.floor(i.val/GlobalModel.chargeRate));var n=t.getRewardStateById(i.index);n==AmusementControl.Geted?(this.lingqu.visible=!0,this.redPoint.visible=!1,this.reward.touchEnabled=!0,this.reward.touchChildren=!0,this.ball.source=this.name?"xbxuanzhongkuang":"cd_treeitembg2"):n==AmusementControl.CanGet?(this.lingqu.visible=!1,this.redPoint.visible=!0,this.reward.touchEnabled=!1,this.reward.touchChildren=!1,this.ball.source=this.name?"xbxuanzhongkuang":"cd_treeitembg2"):(this.lingqu.visible=!1,this.redPoint.visible=!1,this.reward.touchEnabled=!0,this.reward.touchChildren=!0,this.ball.source=this.name?"":"cd_treeitembg1")},e}(BaseItemRender);__reflect(ChristmasRechargeItemRender.prototype,"ChristmasRechargeItemRender");var ChritmasSnowMainItemRender=function(t){function e(){var e=t.call(this)||this;return e.states=["lingqu","normal","done"],e.skinName="ChritmasSnowMainItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchTap(this.goBtn,this.onTap)},e.prototype.onTap=function(t){var e=this.data;amusementControl.upReward(e.Id,e.index)},e.prototype.dataChanged=function(){var t=this.data,e=amusementControl.getAmusementDataById(t.Id),i=e.getAwardState(t.index);i==AmusementControl.Geted?this.currentState=this.states[2]:i==AmusementControl.CanGet?this.currentState=this.states[0]:(this.currentState=this.states[1],this.schedule.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitSnow",t.score))),this.reward.data=t.rewards[0],this.reward.hideName()},e}(BaseItemRender);__reflect(ChritmasSnowMainItemRender.prototype,"ChritmasSnowMainItemRender");var DailyGiftActControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(466,e.initData),e.addCustomEvent(454,e.initData),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initData=function(){void 0==this.buyIndex&&smeltControl.checkOpenSystem()&&this.upInfo()},e.prototype.downInfo=function(t,e){this.buyIndex=t,this.isBuy=e,EventMgr.ins().dispatch(452,this.buyIndex)},e.prototype.upInfo=function(){},e.prototype.upBuyGift=function(t){return[t]},e.prototype.getConfigList=function(){if(!this.mapList){this.mapList={};for(var t in DataCenter.ins().RechargeDailyConfig){var e=DataCenter.ins().RechargeDailyConfig[t];this.mapList[e.sum]||(this.mapList[e.sum]=[]),this.mapList[e.sum].push(e)}}return DataCenter.ins().RechargeDailyConfig[this.buyIndex]?this.mapList[DataCenter.ins().RechargeDailyConfig[this.buyIndex].sum].concat():this.mapList[1].concat()},__decorate([down(31,[2,0])],e.prototype,"downInfo",null),__decorate([up(31)],e.prototype,"upInfo",null),__decorate([up(30,[2])],e.prototype,"upBuyGift",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(DailyGiftActControl.prototype,"DailyGiftActControl");var DailyGiftAwItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.reward.data=t.bigReward?t.bigReward:t.awards[0],this.days.text="",this.state.visible=dailyGiftActControl.buyIndex>=t.id},e}(BaseItemRender);__reflect(DailyGiftAwItemRender.prototype,"DailyGiftAwItemRender");var DailysGiftItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.rewardList.itemRenderer=ItemBase},e.prototype.dataChanged=function(){var t=this.data;this.priceIcon.setPrice(t.price),this.rewardList.dataProvider=new eui.ArrayCollection(t.awards),this.reward.visible=!1,this.rewardList.visible=!0;var e=t.id%42||42;this.num.text=e+"",this.updata()},e.prototype.updata=function(){var t=DailyGiftActControl.ins();this.getBtn.enabled=t.buyIndex+1==this.data.id&&!t.isBuy,this.getBtn.visible=this.data.id>t.buyIndex+1||this.data.id==t.buyIndex+1&&!t.isBuy,this.priceIcon.visible=this.getBtn.visible,this.already.visible=!this.priceIcon.visible,this.redPoint.visible=this.getBtn.enabled&&ActorControl.yb>=this.data.price},e}(BaseItemRender);__reflect(DailysGiftItemRender.prototype,"DailysGiftItemRender");var DirectShop1View=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getActId=function(){var t=AmusementControl.ins().activityData,e=[];for(var i in t){var n=t[i];108==n.pageType&&26==n.type&&n.isOpenActivity()&&!n.getHide()&&e.push(+i)}return e},e.openCheck=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(108==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide())return SwitchMgr.ins().checkOpen(1028)?!0:(tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")),!1)}return GameServer.serverOpenDay<2?tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")):tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e}(DirectShopView);__reflect(DirectShop1View.prototype,"DirectShop1View");var DirectShopCash1View=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getActId=function(){var t=AmusementControl.ins().activityData,e=[];for(var i in t){var n=t[i];108==n.pageType&&26==n.type&&n.isOpenActivity()&&!n.getHide()&&e.push(+i)}return e},e.openCheck=function(){var t=AmusementControl.ins().activityData;for(var e in t){var i=t[e];if(108==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide())return SwitchMgr.ins().checkOpen(80)?!0:(tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")),!1)}return GameServer.serverOpenDay<2?tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")):tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1
},e}(DirectShopCashView);__reflect(DirectShopCash1View.prototype,"DirectShopCash1View");var AmusementDataFactory=function(){function t(){}return t.init=function(t){var e=t[0],i=t[1],n=t[2],o=t[3],s=egret.getDefinitionByName("AmusementType"+o+"DataVo"),r=amusementControl.activityData[e];(!r||5!=o&&12!=o&&13!=o&&18!=o&&26!=o)&&(r=new s),r.id=e,r.startTime=i,r.endTime=n,r.type=o,r.activityType=0;var a=DataCenter.ins().AmusementConfig[e];return a&&(r.timeType=a.timeType,r.pageType=a.pageType,r.pageSkin=a.pageSkin),r.initAmusement(t.slice(5)),r},t.createEx=function(){var t,e=DataCenter.ins().AmusementBtnConfig,i=DateUtils.formatMiniDateTime(GameServer._serverZeroTime),n=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime);for(var o in e){var s=e[o],r=s.hfTimes?s.hfTimes:0,a=s.timeType?s.timeType:0;if(!(a&&2==a&&r&&r!=GameServer._hefuCount||s.type)){if(t=new AmusementTypeExDataVo,t.id=s.id,t.type=s.type,t.activityType=0,t.timeType=s.timeType,s.pageType&&(t.pageType=s.pageType),s.relyOn){t.relyOn=s.relyOn;for(var l=0;l<s.relyOn.length;l++)if(amusementControl.activityData[s.relyOn[l]]){t.startTime=DateUtils.formatMiniDateTime(amusementControl.activityData[s.relyOn[l]].startTime),t.endTime=DateUtils.formatMiniDateTime(amusementControl.activityData[s.relyOn[l]].endTime);break}}else if(0==s.timeType){var h=s.startTime.split("-"),u=+h[0],p=h[1].split(":"),c=new Date(i);if(c.setDate(c.getDate()+u),c.setHours(+p[0],+p[1],0,0),t.startTime=c.getTime(),s.endTime){h=s.endTime.split("-");var d=+h[0],g=h[1].split(":"),m=new Date(i);m.setDate(m.getDate()+d),m.setHours(+g[0],+g[1],0,0),t.endTime=m.getTime()}else t.endTime=GameServer.serverTime+2592e6}else if(1==s.timeType)t.startTime=new Date(s.startTime).getTime(),t.endTime=new Date(s.endTime).getTime();else if(2==s.timeType){var h=[],d=DateUtils.DAYS_PER_WEEK;switch(s.endTime&&(h=s.endTime.split("-"),d=+h[0]),s.id){case 10005:t.startTime=n,t.endTime=n+24*DataCenter.ins().TreasureEquipConfig.hefuDay*60*60*1e3;break;case 10006:case 10007:case 10008:case 10020:t.startTime=n,t.endTime=n+d*DateUtils.SECOND_PER_DAY*1e3}}else t.startTime=i,t.endTime=GameServer.serverTime+2592e6;var f=Math.floor((t.endTime-GameServer.serverTime)/1e3);f>0?amusementControl.activityData[s.id]=t:10004==s.id&&threeHeroesControl.showIcon3DaysLater&&(amusementControl.activityData[s.id]=t)}}},t}();__reflect(AmusementDataFactory.prototype,"AmusementDataFactory");var SDKConst;!function(t){t.QuickH5ProductCode="04329687645183428532377744709589",t.QuickH5ProductKey="91188965",t.QuickH5WDProductCode="36406319476237803569932405398112",t.QuickH5WDProductKey="86240444",t.SoeasyH5SeceretKey="832db856f11b527c458812b9010d9cec",t.ZjGameId=37,t.ZjCpguId="1385bf7a49a299c6",t.ZjKey="1385bf7a49a29a0c1385bf7a49a29a4b",t.HuoAppId=214,t.QhGameId=4219,t.QunHeiH5ChargeKey="9379c9c99cba5900fb84dbfab0b604a7",t.XYouH5GameKey="5fdc4c3dc485ec35a9ef04a4f31ec283",t.Ku25H5LoginKey="40431bf3180821222b6f5df777c8b1fa",t.Ku25H5PayKey="40431bf3180821222b6f5df777c8b1fa",t.JBH5Key="5a6c9ea0f34992fc98240ca0f94deecc",t.YYBMoneyRate=100,t.YYBZoneId=1e3,t.SbCpguId="3405c999039ba798",t.SbKey="3405c999039ba7e13405c999039ba81f",t.XiaoChouSdkappid="hz",t.XiaoChouSdkkey="hzxy1dd31b53gsq565qcd16a42enthz",t.JiuZunKey="1385bf7a49a29a0c1385bf7a49a29a4b",t.XjAppKey="9bc03b0207373ea4cb1c575f669342be",t.JianwanH5Key="b17284aa42074bbebba6e223872f2c14",t.JianwanH5Code="20200116005",t.ZiwanAppSecret="U2D2RMNAQC6ETUDFS51CNSJ7R3T9LGIJ",t.LuoTuoAppSecret="MVGT9EITAWGRRRCEHRF9P97VGE2UW321",t.UGameKey="4117cb7bacc0a10770761a9033d0e048",t.Game8UH5="4117cb7bacc0a10770761a9033d0e048",t.UcPayBizId="d2563f18581046fbbb452dd6af295b79",t.CandyApp_KEY="6db22c001691e11e",t.CandyAPP_ID="1857b82b227c4c16",t.ChengZiKey="u5fHTxtsaaSGyi5SXVBRRa9klf371NJe",t.UCMiniAuditVer=0,t.BZGid=10021,t.BZSubGid=10060,t.BZOprCid=10001,t.BZSecret="5ebca35d1fa93",t.TongChengAppid="7000391",t.TongChengAppSecret="de6a41f25f0c49f09650aa3c21e96ae3",t.HaoWanBaAppSecret="0cbaced3af4786fb05e0c48dc2cd928e",t.JiuYuanAppid="",t.JiuYuanKey="",t.ZwWxMiniCycjAuditVer=6,t.ZwWxMiniH5CycjAppSecret="51QM2HL6MJWBDQRU1M4O38V8DDF7L3BM",t.ZwWxMiniLhzsAuditVer=1,t.Quick1758H5=(e={},e[100]=118101,e[101]=118102,e[102]=118103,e[1e3]=118040,e[1001]=118041,e[401]=118042,e[402]=118043,e[403]=118044,e[404]=118045,e[201]=118046,e[202]=118047,e[203]=118048,e[204]=118049,e[205]=118050,e[206]=118051,e[207]=118052,e[208]=118053,e[209]=118054,e[210]=118055,e[1]=118056,e[2]=118057,e[3]=118058,e[4]=118059,e[5]=118060,e[6]=118061,e[7]=118030,e[8]=118031,e[9]=118032,e[10]=118033,e[411]=118034,e[412]=118035,e[413]=118036,e[414]=118037,e[415]=118038,e[416]=118039,e),t.IosProductIds=(i={},i[100]=118101,i[101]=118102,i[102]=118103,i[1e3]="com.ereiak.kaiere.yk_28",i[1001]="com.ereiak.kaiere.tq_88",i[401]="com.ereiak.kaiere.y_12",i[402]="com.ereiak.kaiere.y_18",i[403]="com.ereiak.kaiere.y_50",i[404]="com.ereiak.kaiere.y_98",i[201]=118046,i[202]=118047,i[203]=118048,i[204]=118049,i[205]=118050,i[206]=118051,i[207]=118052,i[208]=118053,i[209]=118054,i[210]=118055,i[1]=118056,i[2]=118057,i[3]=118058,i[4]=118059,i[5]=118060,i[6]=118061,i[7]=118030,i[8]=118031,i[9]=118032,i[10]=118033,i[411]=118034,i[412]=118035,i[413]=118036,i[414]=118037,i[415]=118038,i[416]=118039,i),t.GooglePayProductIds=(n={},n[100]="com.mjwzcq.android0.99",n[101]="com.mjwzcq.android0.991",n[102]="com.mjwzcq.android0.992",n[1e3]="com.mjwzcq.android3.99",n[1001]="com.mjwzcq.android12.99",n[401]="com.mjwzcq.android01.991",n[402]="com.mjwzcq.android02.992",n[403]="com.mjwzcq.android07.993",n[404]="com.mjwzcq.android014.994",n[201]="com.mjwzcq.android1.99",n[202]="com.mjwzcq.android2.99",n[203]="com.mjwzcq.android7.99",n[204]="com.mjwzcq.android14.99",n[205]="com.mjwzcq.android29.99",n[206]="com.mjwzcq.android79.99",n[207]="com.mjwzcq.android84.99",n[208]="com.mjwzcq.android89.99",n[209]="com.mjwzcq.android94.99",n[210]="com.mjwzcq.android99.99",n[1]="com.mjwzcq.android1.99",n[2]="com.mjwzcq.android2.99",n[3]="com.mjwzcq.android7.99",n[4]="com.mjwzcq.android14.99",n[5]="com.mjwzcq.android29.99",n[6]="com.mjwzcq.android79.99",n[7]="com.mjwzcq.android84.99",n[8]="com.mjwzcq.android89.99",n[9]="com.mjwzcq.android94.99",n[10]="com.mjwzcq.android99.99",n[411]="com.mjwzcq.android01.99",n[412]="com.mjwzcq.android02.99",n[413]="com.mjwzcq.android07.99",n[414]="com.mjwzcq.android014.99",n[415]="com.mjwzcq.android029.99",n[416]="com.mjwzcq.android079.99",n[417]="com.mjwzcq.android084.99",n[418]="com.mjwzcq.android089.99",n[419]="com.mjwzcq.android094.99",n[420]="com.mjwzcq.android099.99",n),t.GooglePayProductIdsLhtl=(o={},o[100]="com.liehuo.android0.992",o[101]="com.liehuo.android0.992",o[102]="com.liehuo.android0.992",o[1e3]="com.liehuo.android3.99",o[1001]="com.liehuo.android12.99",o[401]="com.liehuo.android01.991",o[402]="com.liehuo.android02.992",o[403]="com.liehuo.android07.993",o[404]="com.liehuo.android015.994",o[201]="com.liehuo.android1.99",o[202]="com.liehuo.android2.99",o[203]="com.liehuo.android7.99",o[204]="com.liehuo.android15.99",o[205]="com.liehuo.android32.99",o[206]="com.liehuo.android79.99",o[207]="com.liehuo.android159.99",o[208]="com.liehuo.android249.99",o[209]="com.liehuo.android299.99",o[210]="com.liehuo.android399.99",o[1]="com.liehuo.android1.99",o[2]="com.liehuo.android2.99",o[3]="com.liehuo.android7.99",o[4]="com.liehuo.android15.99",o[5]="com.liehuo.android32.99",o[6]="com.liehuo.android79.99",o[7]="com.liehuo.android159.99",o[8]="com.liehuo.android249.99",o[9]="com.liehuo.android299.99",o[10]="com.liehuo.android399.99",o[11]="com.liehuo.android01.99",o[12]="com.liehuo.android02.99",o[13]="com.liehuo.android07.99",o[14]="com.liehuo.android015.99",o[15]="com.liehuo.android032.99",o[16]="com.liehuo.android079.99",o[17]="com.liehuo.android0159.99",o[18]="com.liehuo.android0249.99",o[411]="com.liehuo.android01.99",o[412]="com.liehuo.android02.99",o[413]="com.liehuo.android07.99",o[414]="com.liehuo.android015.99",o[415]="com.liehuo.android032.99",o[416]="com.liehuo.android079.99",o[417]="com.liehuo.android0159.99",o[418]="com.liehuo.android0249.99",o[511]="com.liehuo.androidc3.99",o[508]="com.liehuo.android14.99",o[601]="com.liehuo.androidj4.99",o[602]="com.liehuo.androidj8.99",o[603]="com.liehuo.androidj7.99",o[604]="com.liehuo.androidj19.99",o[605]="com.liehuo.androidj14.99",o),t.GooglePayProductIdsMlzt={},t.GooglePayProductIdsLzby=(s={},s[1]="com.lzby.ad.1",s[2]="com.lzby.ad.2",s[3]="com.lzby.ad.3",s[4]="com.lzby.ad.4",s[5]="com.lzby.ad.5",s[6]="com.lzby.ad.6",s[7]="com.lzby.ad.7",s[8]="com.lzby.ad.8",s[9]="com.lzby.ad.9",s[10]="com.lzby.ad.10",s[100]="com.lzby.ad.11",s[101]="com.lzby.ad.12",s[102]="com.lzby.ad.13",s[110]="com.lzby.ad.14",s[111]="com.lzby.ad.15",s[112]="com.lzby.ad.16",s[113]="com.lzby.ad.17",s[114]="com.lzby.ad.18",s[115]="com.lzby.ad.19",s[116]="com.lzby.ad.20",s[117]="com.lzby.ad.21",s[118]="com.lzby.ad.22",s[201]="com.lzby.ad.23",s[202]="com.lzby.ad.24",s[203]="com.lzby.ad.25",s[204]="com.lzby.ad.26",s[205]="com.lzby.ad.27",s[206]="com.lzby.ad.28",s[207]="com.lzby.ad.29",s[208]="com.lzby.ad.30",s[209]="com.lzby.ad.31",s[210]="com.lzby.ad.32",s[401]="com.lzby.ad.33",s[402]="com.lzby.ad.34",s[403]="com.lzby.ad.35",s[404]="com.lzby.ad.36",s[411]="com.lzby.ad.37",s[412]="com.lzby.ad.38",s[413]="com.lzby.ad.39",s[414]="com.lzby.ad.40",s[415]="com.lzby.ad.41",s[416]="com.lzby.ad.42",s[417]="com.lzby.ad.43",s[418]="com.lzby.ad.44",s[501]="com.lzby.ad.45",s[502]="com.lzby.ad.46",s[503]="com.lzby.ad.47",s[504]="com.lzby.ad.48",s[505]="com.lzby.ad.49",s[506]="com.lzby.ad.50",s[507]="com.lzby.ad.51",s[508]="com.lzby.ad.52",s[509]="com.lzby.ad.53",s[510]="com.lzby.ad.54",s[511]="com.lzby.ad.55",s[601]="com.lzby.ad.56",s[602]="com.lzby.ad.57",s[603]="com.lzby.ad.58",s[604]="com.lzby.ad.59",s[605]="com.lzby.ad.60",s[1e3]="com.lzby.ad.61",s[1001]="com.lzby.ad.62",s[701]="com.lzby.ad.63",s[702]="com.lzby.ad.64",s[703]="com.lzby.ad.65",s);var e,i,n,o,s}(SDKConst||(SDKConst={}));var DirectShopCashItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.selet.visible=this.data.selet,this.bg.source=this.data.bg},e}(BaseItemRender);__reflect(DirectShopCashItemRenderer.prototype,"DirectShopCashItemRenderer");var DirectShopItemRender=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sendToGetAward=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=ItemBase,this.addEventTouchTap(this.getBtn,this.onBuy)},e.prototype.dataChanged=function(){var t=this.data[0],e=this.data[1],i=amusementControl.getAmusementDataById(t),n=DataCenter.ins().Amusement26Config[t][e],o=i.getShopData(n.index),s=n.buyCount-o.buyCount+(o.canGet?1:0);if(this.limitLabel.text=LangMgr.getValueByKey("fdStorLimitCount",s),this.originalPrice.text=LangMgr.getValueByKey("primecost")+LangMgr.getValueByKey("dollar",n.originalPrice),this.list.dataProvider=new eui.ArrayCollection(n.reward.concat()),this.showBtnTip&&(this.showBtnTip.visible=!!n.showBtnTips),o.canGet)this.getBtn.label=LangMgr.getValueByKey("activitGet"),this.redPoint.visible=!0;else{var r=DataCenter.ins().PayInfoConfig[n.rechargeId];this.getBtn.label=LangMgr.getValueByKey("numberRechargeRmb",r.cash),this.redPoint.visible=!1}this.nameLabel.text=n.itemName,this.infoLabel.text=n.itemDesc,this.sendToGetAward=!1,TimerMgr.ins().isExists(this.onTimer,this)||TimerMgr.ins().loop(1e3,this.onTimer,this),this.onTimer()},e.prototype.onBuy=function(){var t=this.data[0],e=this.data[1],i=amusementControl.getAmusementDataById(t);if(!i||!i.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));var n=DataCenter.ins().Amusement26Config[t][e],o=i.getShopData(n.index);if(o.canGet){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);amusementControl.upReward(t,e),this.sendToGetAward=!0}else{var s=ClientStorage.ins().getValue(t+"_"+e)||0;GameServer.serverTime>=s?(payControl.showReCharge(n.rechargeId),ClientStorage.ins().setValue(t+"_"+e,GameServer.serverTime+5e3)):tipsControl.showTips(LangMgr.getValueByKey("oftenOpWait",Math.ceil((s-GameServer.serverTime)/1e3)))}},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=this.list.x+t.x+e.width/2,e.y=this.list.y+t.y+e.height/2,e.data=t.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.delayFlyItem(e)},e.prototype.onTimer=function(){var t=this.data[0],e=amusementControl.getAmusementDataById(t);e&&this.actTime0&&(this.actTime0.text=e.getRemainTime())},e.prototype.onFly=function(){if(this.sendToGetAward){this.sendToGetAward=!1;for(var t=0;t<this.list.dataProvider.length;t++){var e=this.list.getVirtualElementAt(t);this.flyItem(e)}}},e.prototype.delayFlyItem=function(t){this.addChild(t),gameControl.dispatchFlyItemEx(t)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),TimerMgr.ins().remove(this.onTimer,this)},e}(BaseItemRender);__reflect(DirectShopItemRender.prototype,"DirectShopItemRender");var DoubleElevenRechargesPanel=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e||0,i.initSkin(),i}return __extends(e,t),e.prototype.initSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];this.skinName=t.pageSkin},e.prototype.open=function(){this.initSkin();for(var t=DataCenter.ins().Amusement3Config[this.activityID],e=CommonUtils.getObjectLength(t),i=0;e>i;i++)this["targtet"+i]&&this.addEventTouchTap(this["targtet"+i],this.onTap);this.addEventTouchTap(this.rechargeBtn,this.onTap),this.addCustomEvent(392,this.showAward),this.reward.itemRenderer=ItemBase,this.initData(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.initData=function(){this.actInfo1.text=DataCenter.ins().AmusementConfig[this.activityID].desc;for(var t in DataCenter.ins().Amusement3Config[this.activityID]){var e=DataCenter.ins().Amusement3Config[this.activityID][t];if(4==e.type){this.singleReward.data=e.rewards[0];break}}this.updateTime(),this.updateData2()},e.prototype.updateTime=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=t.getLeftTime();this.actTime1.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.onTap=function(t){if(t.currentTarget==this.rechargeBtn){if(!this._sendConf)return;var e=amusementControl.getAmusementDataById(this._sendConf.Id),i=e.getRewardStateById(this._sendConf.index);return void(i==AmusementControl.Geted?tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet")):i==AmusementControl.CanGet?amusementControl.upReward(this.activityID,this._sendConf.index):tipsControl.showTips(LangMgr.getValueByKey("osaTravelAim")))}if(t.currentTarget instanceof DoubleElevenRechargesItemRender){var n=t.currentTarget;this.updateReward(n.data.config.index,n.data.config.index);var o=DataCenter.ins().Amusement3Config[this.activityID];for(var s in o)o[s].index!=n.data.config.index&&this["targtet"+(o[s].index-1)]&&this["targtet"+(o[s].index-1)].setSelect(!1)}},e.prototype.showAward=function(){if(this._sendConf){var t=amusementControl.getAmusementDataById(this._sendConf.Id),e=t.getRewardStateById(this._sendConf.index);e==AmusementControl.Geted&&(this.showEff(this._sendConf),this.rechargeBtn.visible=!1,this.already.visible=!this.rechargeBtn.visible)}},e.prototype.close=function(){this.cleanEff(),this.removeEventTouchTap(this.rechargeBtn,this.onTap),this.removeCustomEvents(),TimerMgr.ins().remove(this.updateTime,this)},e.prototype.updateReward=function(t,e){var i=amusementControl.getAmusementDataById(this.activityID),n=DataCenter.ins().Amusement3Config[this.activityID][t];if(n&&i&&this["targtet"+(t-1)]){if(this["targtet"+(t-1)].data={curCost:i.chongzhiTotal,config:n},this["targtet"+(t-1)].setSelect(e?t==e:!1),this.rechargeBtn.visible=!0,this.bigEgg.source=n.expAttr[4],t==e){this._sendConf=n;var o=i.getRewardStateById(this._sendConf.index);this.redPoint.visible=!1,o==AmusementControl.Geted?(this.rechargeBtn.visible=!1,this.bigEgg.source=n.expAttr[5]):o==AmusementControl.CanGet&&(this.redPoint.visible=!0),this.reward.dataProvider=new eui.ArrayCollection(n.rewards)}this.already.visible=!this.rechargeBtn.visible}},e.prototype.updateData2=function(){var t=this.getRuleIndex();if(t)for(var e=(amusementControl.getAmusementDataById(this.activityID),DataCenter.ins().Amusement3Config[this.activityID]),i=CommonUtils.getObjectLength(e),n=0;i>n;n++)this.updateReward(n+1,t)},e.prototype.getRuleIndex=function(){var t=amusementControl.getAmusementDataById(this.activityID);if(!t)return 0;var e=DataCenter.ins().Amusement3Config[this.activityID],i=CommonUtils.getObjectLength(e),n=i;for(var o in e)if(!(e[o].index-1>=i)&&this["targtet"+(e[o].index-1)]){var s=t.getRewardStateById(e[o].index);if(s!=AmusementControl.Geted){if(s==AmusementControl.CanGet)return e[o].index;n>e[o].index&&(n=e[o].index)}}return n},e.prototype.cleanEff=function(){egret.Tween.removeTweens(this.hamer),egret.Tween.removeTweens(this.flower),DisplayUtils.removeFromParent(this.tonk),DisplayUtils.removeFromParent(this.boom)},e.prototype.showEff=function(t){var e=this;if(t){this.tonk||(this.tonk=new GameMovieClip),this.tonk.parent||this.hamer.addChild(this.tonk),this.boom||(this.boom=new GameMovieClip),this.boom.parent||this.flower.addChild(this.boom),egret.Tween.removeTweens(this.hamer),egret.Tween.removeTweens(this.flower);var i=this;this.tonk.playFile(PATH_EFF+t.expAttr[2],1,function(){var n=egret.Tween.get(e.hamer);n.wait(200).call(function(){i.updateReward(t.index,t.index)}),i.boom.playFile(PATH_EFF+t.expAttr[3],1,function(){egret.Tween.removeTweens(i.hamer),egret.Tween.removeTweens(i.flower),DisplayUtils.removeFromParent(i.tonk),DisplayUtils.removeFromParent(i.boom)})})}},e}(BasePanel);__reflect(DoubleElevenRechargesPanel.prototype,"DoubleElevenRechargesPanel");var DoubleEleventDailyGiftPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.gift.itemRenderer=DoubleElevenDailysGiftItemRender,this.actDesc.text=DataCenter.ins().AmusementConfig[this.activityID].desc},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(392,this.update),this.addCustomEvent(106,this.update),this.addCustomEvent(107,this.update),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.update()},e.prototype.update=function(){var t,e=amusementControl.getAmusementDataById(this.activityID),i=DataCenter.ins().Amusement2Config[this.activityID],n=[],o=0,s=0,r=0;for(var a in i)t=i[a],s=e.buyData[o+1]>=t.count?2:1,r=t.count-e.buyData[o+1],0>r&&(r=0),n[o]=[t,s,r,this.activityID,e.sumRMB],o++;n.sort(this.sort),this.gift.dataProvider=new eui.ArrayCollection(n),this._time=e.getLeftTime(),this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4)},e.prototype.sort=function(t,e){return 1==t[1]&&1!=e[1]?-1:2==t[1]&&2!=e[1]?1:t[0].index<e[0].index?-1:t[0].index>e[0].index?1:0},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4))},e}(BasePanel);__reflect(DoubleEleventDailyGiftPanel.prototype,"DoubleEleventDailyGiftPanel");var DoubleEleventMotherPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this),TimerMgr.ins().remove(this.setTime,this)},e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget21PanelSkin",this.show1&&(this.show1.source=CHIBANG_PREFIX+"100_png")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.rewardList.itemRenderer=ItemBase,this.updateData(),this.updateUI(),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.updateData=function(){var t=DataCenter.ins().AmusementBtnConfig[this.activityID];t.showReward&&(this.rewardList.dataProvider=new eui.ArrayCollection(t.showReward))},e.prototype.updateUI=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(DateUtils.formatMiniDateTime(t.startTime)/DateUtils.MS_PER_SECOND-GameServer.serverTime/DateUtils.MS_PER_SECOND),i=Math.floor(DateUtils.formatMiniDateTime(t.endTime)/DateUtils.MS_PER_SECOND-GameServer.serverTime/DateUtils.MS_PER_SECOND);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=i,this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3));var n=DataCenter.ins().AmusementConfig[this.activityID];this.actDesc.text=n.desc;var o=DataCenter.ins().AmusementBtnConfig[this.activityID];o&&(this.title.source=o.title)},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e}(BasePanel);__reflect(DoubleEleventMotherPanel.prototype,"DoubleEleventMotherPanel");var DoubleEleventRedPacketPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t=amusementControl.getAmusementDataById(this.activityID);t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget12Panel1Skin",this.hongbaoTitle&&(this.hongbaoTitle.text=LangMgr.getValueByKey("hongbaoTitle",GlobalModel.chargeRate))},Object.defineProperty(e.prototype,"activityID",{get:function(){return this._activityID},set:function(t){this._activityID=t,this.setCurSkin()},enumerable:!0,configurable:!0}),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this),this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(395,this.updateLogs),this.addEventTouchTap(this.onbtn,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.dataArr||(this.list.itemRenderer=OffYearListsItemRender,this.dataArr=new eui.ArrayCollection,this.list.dataProvider=this.dataArr),this.index=this.getRuleIndex(),this.updateData(),this.updateLogs()},e.prototype.getRuleIndex=function(){var t=1,e=amusementControl.getAmusementDataById(this.activityID);for(var i in DataCenter.ins().Amusement12Config[this.activityID])e.score>=DataCenter.ins().Amusement12Config[this.activityID][i].score&&(t=DataCenter.ins().Amusement12Config[this.activityID][i].index);return t},e.prototype.GetCallBack=function(t){t==this.activityID&&this.updateData()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.onbtn:var e=amusementControl.getAmusementDataById(this.activityID);if(!e.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));var i=DataCenter.ins().Amusement12Config[this.activityID];i&&i[this.index]&&(e.score>=i[this.index].score?UIMgr.ins().open(RedpacketSpeakView,this.activityID,this.index):tipsControl.showTips(LangMgr.getValueByKey("osaEnoughtScore")));break;case this.leftBtn:if(this.index<=1)return;this.index--,this.updateBtn();break;case this.rightBtn:if(this.index>=CommonUtils.getObjectLength(DataCenter.ins().Amusement12Config[this.activityID]))return;this.index++,this.updateBtn()}},e.prototype.updateBtn=function(){1==this.index?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.index==CommonUtils.getObjectLength(DataCenter.ins().Amusement12Config[this.activityID])?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):this.leftBtn.visible=this.rightBtn.visible=!0;var t=DataCenter.ins().Amusement12Config[this.activityID][this.index];this.hongbao.data=t;var e=amusementControl.getAmusementDataById(this.activityID);this.redPoint.visible=e.score>=t.score},e.prototype.updateLogs=function(){var t=[],e=amusementControl.getAmusementDataById(this.activityID);this.actPoint.text=e.score+"";for(var i=e.logs.length-1;i>=0;i--){var n=DataCenter.ins().Amusement12Config[this.activityID][e.logs[i].index],o="s"+e.logs[i].serverId+"."+e.logs[i].name,s=StringUtils.replace(n.record,o);t.push(s)}this.dataArr.replaceAll(t)},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=DataCenter.ins().AmusementConfig[this.activityID],i=Math.floor((DateUtils.formatMiniDateTime(t.startTime)-GameServer.serverTime)/1e3),n=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);i>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=n?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this._time=n,this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_5,3)),this.actInfo.text=e.desc,this.updateBtn()},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e}(BasePanel);__reflect(DoubleEleventRedPacketPanel.prototype,"DoubleEleventRedPacketPanel");var DoubleElevenDailysGiftItemRender=function(t){function e(){var e=t.call(this)||this;return e._state=0,e._activityID=0,e._subRmb=0,e.skinName="DoubleElevenDailysGiftItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.get,this.onTap)},e.prototype.dataChanged=function(){this._config=this.data[0],this._state=this.data[1],this._activityID=this.data[3],this._subRmb=this.data[4],this.discountNum.text=this._config.discount+"",this.vipLv.text=this._config.vip+"",this.vip.visible=this._config.vip>0,this.original.text=this._config.originalPrice+"",this.now.text=this._config.price+"";var t=this.data[2]?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.times.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitCanBuy")+"|C:"+t+"&T:"+this.data[2]+"|/"+this._config.count),this.reward.dataProvider=new eui.ArrayCollection(this._config.rewards),this.redPoint.visible=1==this._state&&ActorControl.yb>=this._config.price&&this._subRmb>=this._config.needRecharge&&vipControl.lv>=this._config.vip,this.get.enabled=1==this._state,this.get.visible=2!=this._state,this.already.visible=2==this._state},e.prototype.onTap=function(t){vipControl.lv<this._config.vip?tipsControl.showTips(LangMgr.getValueByKey("activitVipEnought")):ActorControl.yb<this._config.price?tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):this._subRmb<this._config.needRecharge?tipsControl.showTips(LangMgr.getValueByKey("userNoCZ")):amusementControl.upReward(this._activityID,this._config.index)},e.prototype.destruct=function(){this.removeEventTouchTap(this.get,this.onTap)},e}(BaseItemRender);__reflect(DoubleElevenDailysGiftItemRender.prototype,"DoubleElevenDailysGiftItemRender");var DoubleElevenRechargesItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DoubleElevenRechargesItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data,e=amusementControl.getAmusementDataById(t.config.Id),i=e.getRewardStateById(t.config.index);this.redPoint.visible=!1,this.already.visible=!1;var n=ColorUtils.NORMAL_COLOR;this.ball.source=t.config.expAttr[0],i==AmusementControl.Geted?(this.already.visible=!0,n=LangMgr.getColor("color43"),this.ball.source=t.config.expAttr[1]):i==AmusementControl.CanGet?(n=LangMgr.getColor("color43"),this.redPoint.visible=!0):n=LangMgr.getColor("color22"),this.now.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+Math.floor(t.curCost/GlobalModel.chargeRate)),this.target.text=Math.floor(t.config.val/GlobalModel.chargeRate)+"",this.ball0.visible=!1}},e.prototype.setSelect=function(t){this.ball0.visible=t},e}(BaseItemRender);__reflect(DoubleElevenRechargesItemRender.prototype,"DoubleElevenRechargesItemRender");var DoubleElevenTimesBuyItemRender=function(t){function e(){var e=t.call(this)||this;return e._state=0,e._activityID=0,e.skinName="DoubleElevenTimesBuyItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.get,this.onTap)},e.prototype.dataChanged=function(){this._config=this.data[0],this._state=this.data[1],this._activityID=this.data[3],this.discountNum.text=this._config.discount+"",this.priceLabel.text=this._config.price+"";var t=this.data[2]?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.times.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitCanBuy")+"|C:"+t+"&T:"+this.data[2]+"|/"+this._config.count),this.reward.dataProvider=new eui.ArrayCollection(this._config.rewards),this.stock.text=this.data[4],this.redPoint.visible=1==this._state&&ActorControl.yb>=this._config.price,this.get.enabled=1==this._state,this.get.visible=2!=this._state,this.already.visible=2==this._state},e.prototype.onTap=function(t){ActorControl.yb<this._config.price?tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):amusementControl.upReward(this._activityID,this._config.index)},e.prototype.destruct=function(){this.removeEventTouchTap(this.get,this.onTap)},e}(BaseItemRender);__reflect(DoubleElevenTimesBuyItemRender.prototype,"DoubleElevenTimesBuyItemRender");var DoubleElevenTimesBuyTabItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DoubleElevenTimesBuyTabItemSkin",e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.setData=function(t,e){this.time.text=t.limitTime[0]+":"+(t.limitTime[1]<10?t.limitTime[1]+"0":t.limitTime[1]),this._isOpen=e,this.setSelected(!1)},e.prototype.setSelected=function(t){t?this.currentState=this._isOpen?"intimeselect":"outtimeselect":this.currentState=this._isOpen?"intime":"outtime"},e.prototype.setRedPoint=function(t){this.redPoint.visible=t},e}(BaseItemRender);__reflect(DoubleElevenTimesBuyTabItemRender.prototype,"DoubleElevenTimesBuyTabItemRender");var DoubleTwelveGiftPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._index=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=this.getRule();this.updateData(e)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.buy,this.onTap),this.addEventTouchTap(this.szlb,this.onTap),this.addEventTouchTap(this.lhlb,this.onTap),this.addEventTouchTap(this.yylb,this.onTap),this.addEventTouchTap(this.sblb,this.onTap),this.addCustomEvent(393,this.GetCallBack),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.hideSelect();var i=this.getRule();this.updateData(i)},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.hideSelect=function(){for(var t=0;4>t;t++)this["select"+t].visible=!1,this["arrow"+t].visible=!1,this["select"+t].visible=!1},e.prototype.GetCallBack=function(t){if(this.activityID==t){if(!amusementControl.isSuccee){tipsControl.showTips(LangMgr.getValueByKey("getFaile"));var e=amusementControl.doubleTwelveData[this.activityID];amusementControl.upChangePage(e.id)}amusementControl.isSuccee=!1,this.hideSelect();var i=this.getRule();this.updateData(i)}},e.prototype.onTap=function(t){var e;switch(t.currentTarget){case this.buy:if(this.config.vip&&vipControl.lv<this.config.vip)tipsControl.showTips(LangMgr.getValueByKey("doubleVip"));else{if(!CommonFun.checkBackpackCount(7,1))return;ActorControl.yb>=this.config.price?amusementControl.upReward(this.activityID,this._index):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))}e=-1;break;case this.lhlb:e=1;break;case this.yylb:e=2;break;case this.szlb:e=3;break;case this.sblb:e=4}if(-1!=e){for(var i=0;4>i;i++)e!=i+1?this["select"+i].visible=!1:this["select"+i].visible=!0,this["arrow"+i].visible=this["select"+i].visible;
this.updateData(e)}},e.prototype.getRule=function(){var t=amusementControl.doubleTwelveData[this.activityID],e=DataCenter.ins().Amusement2Config[this.activityID],i=[];for(var n in e)i.push(e[n]);i.sort(this.sortFunc);for(var o=0;o<i.length;o++){var s=i[o],r=t.buyData[s.index]>=s.count?!0:!1;if(!r)return s.index}return 2},e.prototype.sortFunc=function(t,e){return t.price<e.price?-1:t.price>e.price?1:0},e.prototype.updateData=function(t){void 0===t&&(t=2),this._index=t,this["select"+(t-1)].visible=!0,this["arrow"+(t-1)].visible=!0;var e=amusementControl.doubleTwelveData[this.activityID];this.setTime(),this.config=DataCenter.ins().Amusement2Config[this.activityID][t];var i=DataCenter.ins().AmusementBtnConfig[this.activityID];i&&(this.title.source=i.title),this.desc3.text=this.config.price+"",this.desc5.text=this.config.giftName;for(var n=0;n<this.config.rewards.length;n++){var o=this.config.rewards[n];this["item"+n].data={type:o.type,count:o.count,id:o.id},17==this["item"+n].getItemType()&&(this["item"+n].showSpeicalDetail=!1)}var s=e.buyData[this._index]>=this.config.count?!0:!1;this.buy.visible=!s,this.already.visible=s,this.actTime.visible=!this.already.visible,this.showbg.source=this.config.source[2]+"_png",this.redPoint.visible=this.buy.visible&&ActorControl.yb>=this.config.price,ActorControl.level<AmusementType2DataVo.LimitLevel&&(this.redPoint.visible=!1);for(var n in DataCenter.ins().Amusement2Config[this.activityID]){var r=DataCenter.ins().Amusement2Config[this.activityID][n];r&&r.source[0]&&(this["bg"+(+n-1)].source=r.source[0]),r&&r.source[1]&&(this["name"+(+n-1)].source=r.source[1])}},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID];if(t){var e=Math.floor((DateUtils.formatMiniDateTime(t.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)}},e}(BasePanel);__reflect(DoubleTwelveGiftPanel.prototype,"DoubleTwelveGiftPanel");var DoubleTwelveLotteryPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents();for(var i=0;3>i;i++)this.removeEventTouchTap(this["isget"+i],this.onGiftClick);egret.Tween.removeTweens(this.tttzhi),this.rolling=!1;var n=amusementControl.doubleTwelveData[this.activityID];1==n.indexs.length&&amusementControl.upReward(this.activityID,1),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(395,this.resultCallBack),this.addCustomEvent(395,this.updateView),this.addCustomEvent(393,this.updateView),this.addCustomEvent(392,this.updateView),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this.choujiangBtn,this.getLottery);for(var i=0;3>i;i++)this.addEventTouchTap(this["isget"+i],this.onGiftClick);this.list.itemRenderer=NoticeListItemRender,this.turnten.selected=!1,this.updateView()},e.prototype.onTouch=function(t){},e.prototype.updateView=function(){var t=(amusementControl.doubleTwelveData[this.activityID],DataCenter.ins().Amusement9Config[this.activityID][0]),e=DataCenter.ins().ItemConfig[t.item];if(e){this.icon.source=e.icon+"_png";var i=backpackControl.getBagItemById(e.id),n=0,o=1,s=ColorUtils.NORMAL_COLOR;i?(n=i.count,s=n>=o?ColorUtils.GREEN:ColorUtils.RED):s=ColorUtils.RED,this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+n+"|C:"+ColorUtils.NORMAL_COLOR+"&T:/"+o),this.pay0.text=t.yb+""}for(var r in DataCenter.ins().Amusement9Config[this.activityID])if(+r){var a=DataCenter.ins().Amusement9Config[this.activityID][r],i=this["item"+(+r-1)];i.itemIcon.data=a.reward[0],i.rewardState(!1)}this.num2.visible=!1,this.updateProgress(),this.listRefush(),this.setTime()},e.prototype.resultCallBack=function(){var t=amusementControl.doubleTwelveData[this.activityID];t.indexs.length>1?UIMgr.ins().open(LuckyResultView,this.activityID,t.indexs):1==t.indexs.length&&this.beginLottery(t.indexs[0]),this.listRefush()},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0,n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){amusementControl.upReward(e.activityID,1),e.flyItem(e["item"+(t-1)]),setTimeout(function(){e.rolling=!1},2e3)},this)},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.itemIcon.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.flyItemEx=function(t){var e=new eui.Image(t.imgIcon.source);e.x=t.imgIcon.x,e.y=t.imgIcon.y,e.width=t.imgIcon.width,e.height=t.imgIcon.height,e.scaleX=t.imgIcon.scaleX,e.scaleY=t.imgIcon.scaleY,t.imgIcon.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.getLottery=function(){return this.rolling?void tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1")):void(this.turnten.selected?amusementControl.getIsRollTen(this.activityID)?amusementControl.upReward(this.activityID,2):tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):amusementControl.getRollSum(this.activityID)||ActorControl.yb>=DataCenter.ins().Amusement9Config[this.activityID][0].yb?amusementControl.upReward(this.activityID,1):tipsControl.showTips(LangMgr.getValueByKey("userNoMony")))},e.prototype.onGiftClick=function(t){for(var e=0;3>e;e++)if(t.currentTarget==this["isget"+e]){var i=this["gift"+e].getItemIcon();this.flyItemEx(i),amusementControl.upReward(this.activityID,0,e+1);break}},e.prototype.updateProgress=function(){var t=DataCenter.ins().Amusement9Config[this.activityID][0],e=amusementControl.doubleTwelveData[this.activityID];if(t&&e){this.turntime.text=e.count+"";for(var i=0;3>i;i++){if(this["turntime"+i].text=t.reward[i].times,this["gift"+i].data={id:t.reward[i].id,type:t.reward[i].type,count:t.reward[i].count},this["gift"+i].isShowName(!1),this["bar"+i].maximum=100,this["lingqu"+i].touchEnabled=!1,e.record>>i+1&1)this["bar"+i].value=100,this["lingqu"+i].visible=!0,this["isget"+i].touchEnabled=!1;else if(this["lingqu"+i].visible=!1,e.count>=t.reward[i].times)this["bar"+i].value=100,this["isget"+i].touchEnabled=!0;else{var n=t.reward[i-1],o=e.count,s=t.reward[i].times;n&&(o=e.count-n.times,s=t.reward[i].times-n.times),o=o>0?o:0,this["bar"+i].value=Math.floor(o/s*100),this["isget"+i].touchEnabled=!1}this.updateRedPoint(this.activityID,i)}}},e.prototype.updateRedPoint=function(t,e){var i=amusementControl.isGetRollReward(t,e);this["redPoint"+e].visible=i},e.prototype.listRefush=function(){var t=amusementControl.doubleTwelveData[this.activityID];if(t){for(var e=[],i=0;i<t.noticeArr.length;i++){var n={activityID:this.activityID,name:t.noticeArr[i].name,index:t.noticeArr[i].index};e.push(n)}this.list.dataProvider=new eui.ArrayCollection(e)}},e.prototype.setTime=function(){var t=amusementControl.doubleTwelveData[amusementControl.doubleTwelveIDAry[2]];this.actTime.text=LangMgr.getValueByKey("expHaveTime",t.getLastTime())},e}(AmusementPanel);__reflect(DoubleTwelveLotteryPanel.prototype,"DoubleTwelveLotteryPanel");var DoubleTwelveRechargeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DoubleTwelveLimitRechargeViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.list.itemRenderer=DoubleTwelveRechargeItemRender,this.addEventTouchTap(this.closeBtn,this.closeWin),this.addEventTouchTap(this.bgClose,this.closeWin),this.addEventTouchTap(this.chooseBtn0,this.onSelect),this.addEventTouchTap(this.chooseBtn1,this.onSelect),this.addEventTouchTap(this.chooseBtn2,this.onSelect),this.addEventTouchTap(this.rechargeBtn,this.onRecharge),this.addCustomEvent(178,this.updateView),this.addCustomEvent(446,this.updateView),this.addCustomEvent(395,this.updateView),this.addCustomEvent(393,this.updateView),this.addCustomEvent(392,this.updateView),TimerMgr.ins().doNext(function(){t.updateView()},this)},e.prototype.onRecharge=function(t){var e=this.idAry[this.selectIndex];this.recharge.visible?payControl.checkOpenWin():amusementControl.upReward(e,1)},e.prototype.updateView=function(){this.idAry=amusementControl.doubleTwelveRechargeIDAry;var t,e=amusementControl.doubleTwelveRechargeData[this.idAry[0]],i=e.getLeftTime(),n=Math.floor(1e3*i/DateUtils.MS_PER_DAY);0==n?(n=Math.floor(1e3*i/(DateUtils.MS_PER_DAY/24)),t=LangMgr.getValueByKey("activitHoure",n)):t=LangMgr.getValueByKey("activitDay",n),this.limitTime.text=LangMgr.getValueByKey("activitHaveDay",t);for(var o=0;3>o;o++)this.setText(o);this.selectIndex?this.selectActivity(this.selectIndex):this.selectActivity(0)},e.prototype.selectBtn=function(t){this.select0.visible=!1,this.select1.visible=!1,this.select2.visible=!1,this["select"+t].visible=!0},e.prototype.selectActivity=function(t){this.selectIndex=t;var e=this.idAry[t],i=amusementControl.doubleTwelveRechargeData[e],n=amusementControl.getNeedRecharge(e);this.rechargeCount.text=n.toString(),i.recrod>0?this.btn.visible=!1:(this.btn.visible=!0,n>0?(this.recharge.visible=!0,this.get.visible=!1):(this.recharge.visible=!1,this.get.visible=!0));var o=DataCenter.ins().Amusement3Config[e][1];this.list.dataProvider=new ArrayCollection(o.rewards),this.selectBtn(t)},e.prototype.setText=function(t){var e=this.idAry[t],i=DataCenter.ins().Amusement3Config[e][1],n=i.val;n=0==t?Math.floor(n/1e3):Math.floor(n/1e4),this["count"+t].text=n.toString()},e.prototype.onSelect=function(t){var e=t.target,i=0;i=e==this.chooseBtn0?0:e==this.chooseBtn1?1:2,this.selectActivity(i)},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DoubleTwelveRechargeView.prototype,"DoubleTwelveRechargeView");var DoubleTwelveView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DoubleTwelvesViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.menuList.itemRenderer=AmusementBtnItemRender,this.addEventChange(this.menuList,this.onClickMenu),this.addEventTouchTap(this.closeBtn,this.closeWin),this.addCustomEvent(395,this.updateView),this.addCustomEvent(393,this.updateView),this.addCustomEvent(392,this.updateView),this.updateView()},e.prototype.close=function(){for(var t=0;t<this.viewStack.numChildren;t++)this.viewStack.getChildAt(t).close()},e.prototype.updateView=function(){var t=[];for(var e in amusementControl.doubleTwelveData){var i=amusementControl.getbtnInfo(e),n=amusementControl.doubleTwelveData[e];n.isOpenActivity()&&(t.push(i),2==n.type?this.doubleTwelveGiftPanel.activityID=n.id:this.doubleTwelveLotteryPanel.activityID=n.id)}t.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"sort")}),this.menuList.dataProvider=new ArrayCollection(t),this.panels=[this.doubleTwelveGiftPanel,this.doubleTwelveLotteryPanel],this.selectIndex||(this.selectIndex=0),this.viewStack.selectedIndex=this.selectIndex,this.panels[this.selectIndex].open()},e.prototype.closeWin=function(t){UIMgr.ins().close(e)},e.prototype.onClickMenu=function(t){this.selectIndex!=t.currentTarget.selectedIndex&&(SoundUtils.ins().playEffect(SoundUtils.VIEW),this.panels[this.selectIndex].close()),this.selectIndex=t.currentTarget.selectedIndex,this.viewStack.selectedIndex=this.selectIndex,this.panels[this.selectIndex].open(),amusementControl.setPalyEffListById(this.panels[this.selectIndex].activityID,!0)},e}(BaseEuiView);__reflect(DoubleTwelveView.prototype,"DoubleTwelveView");var DoubleTwelveRechargeItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.item.isShowName(!1),this.item.data=this.data,0==this.data.type){var t=1;switch(this.data.id){case 2:t=5;break;case 1:t=0;break;case 4:t=2;break;case 10:t=2;break;case 13:t=2}this.nameTxt.text=Currency.getCurrencyName(this.data.id),this.nameTxt.textColor=LangMgr.getColor("qualityColor"+t)}else{var e=DataCenter.ins().ItemConfig[this.data.id];this.nameTxt.text=e.name,this.nameTxt.textColor=ItemUtils.getQualityColor(e)}},e}(BaseItemRender);__reflect(DoubleTwelveRechargeItemRender.prototype,"DoubleTwelveRechargeItemRender");var RedPacketDetailView=function(t){function e(){var e=t.call(this)||this;return e.fristView=!1,e.skinName="RedPacketDetailViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=RedPacketRecorrdItemRender,this.myReward.touchEnabled=!0,this.rank0.index=0,this.rank1.index=1,this.rank2.index=2},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._info=t[0],this.addEventTouchTap(this.closeBtn,this.onClose),this.addEventTextLink(this.myReward,this.onLink),this.addCustomEvent(478,this.openOtherPlayerView),this.update();var i=t[1];i?(this._eff||(this._eff=ObjectPool.pop("GameMovieClip")),this.effGroup.addChild(this._eff),this._eff.playFile(PATH_EFF+"yanhua_eff")):this._eff&&(this._eff.destroy(),this._eff=null)},e.prototype.close=function(){this._info=null,this.rank0.data=null,this.rank1.data=null,this.rank2.data=null,this.fristView=!1,this._eff&&(this._eff.destroy(),this._eff=null)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(0);this.mayHead.source="head_"+t.job+t.sex,this.myName.text=ActorControl.myName;var e=amusementControl.getRedPacket(this._info.actID,this._info.idx);if(!e)return void UIMgr.ins().close(this);this.playerName.text=e.roleName+"["+e.serverID+"]",this.playerGuild.text=e.guildName,this.list.dataProvider=new eui.ArrayCollection(this._info.records);var i;if(0==this._info.myInfo.type){var n=LangMgr.getColor("qualityColor3");i=TextUtils.generateTextFlow1("|C:"+n+"&T:["+Currency.getCurrencyName(this._info.myInfo.id)+"]||C:16777164&T:X"+this._info.myInfo.count+"|"),i[0].style.href="event:"+this._info.myInfo.id}else{var o=DataCenter.ins().ItemConfig[this._info.myInfo.id],n=ItemUtils.getQualityColor(o);i=TextUtils.generateTextFlow1("|C:"+n+"&T:["+o.name+"]||C:16777164&T:X"+this._info.myInfo.count+"|"),i[0].style.href="event:"+this._info.myInfo.id}i[0].style.underline=!0,this.myReward.textFlow=i,rankOtherUserControl.upFindPlayer(e.roleID,e.serverID)},e.prototype.openOtherPlayerView=function(t){if(this.fristView){var e=UIMgr.ins().open(RankRoleView,t);e.hideEx(2)}else this.rank0.data={otherPlayerData:t},this.rank1.data={otherPlayerData:t},this.rank2.data={otherPlayerData:t},this.fristView=!0},e.prototype.onLink=function(t){CommonFun.viewItemTips(+t.text)},e}(BaseEuiView);__reflect(RedPacketDetailView.prototype,"RedPacketDetailView");var TreasureLogView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TreasureLogViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=TreasureHuntListItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.dataProvider=new eui.ArrayCollection(t[0]),this.addEventTouchTap(this.bgClose,this.onTouch)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TreasureLogView.prototype,"TreasureLogView");var RedPacketRecorrdItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.dropTime.text=DateUtils.getFormatBySecond(Math.floor(DateUtils.formatMiniDateTime(t.time)/1e3),DateUtils.TIME_FORMAT_15);var e,i="|C:39423&T:"+t.roleName+"|";if(t.rewardID<100){var n=LangMgr.getColor("qualityColor3");e=i+LangMgr.getValueByKey("openRedGet")+n+"&T:["+Currency.getCurrencyName(t.rewardID)+"]||C:16777164&T:X"+t.rewardCount+"|"}else{var o=DataCenter.ins().ItemConfig[t.rewardID],n=ItemUtils.getQualityColor(o);e=i+LangMgr.getValueByKey("openRedGet")+n+"&T:["+o.name+"]||C:16777164&T:X"+t.rewardCount+"|"}var s=TextUtils.generateTextFlow1(e);s[0].style.href="event:"+t.roleID+"_"+t.serverId,s[0].style.underline=!0,s[2].style.href="event:"+t.rewardID,s[2].style.underline=!0,this.record.textFlow=s,this.best.visible=t.isPrecious,this.addEventTextLink(this.record,this.onLink),this.addEventRemovedFromStage(this,this.removeFromStage)},e.prototype.onLink=function(t){var e=t.text.split("_");e.length>1?rankOtherUserControl.upFindPlayer(parseInt(e[0]),parseInt(e[1])):CommonFun.viewItemTips(+t.text)},e.prototype.removeFromStage=function(){this.removeEventTextLink(this.record,this.onLink),this.removeEventRemovedFromStage(this,this.removeFromStage)},e}(BaseItemRender);__reflect(RedPacketRecorrdItemRender.prototype,"RedPacketRecorrdItemRender");var HappySevenDayView=function(t){function e(){var e=t.call(this)||this;return e._curDay=0,e._curDayIndex=0,e._curGroupIndex=0,e.isTopLevel=!0,e.setActivityID(),e.setCurSkin(),e}return __extends(e,t),e.prototype.setActivityID=function(){var t=amusementControl.activityData;for(var e in t)if(4==t[e].pageType){this._activityID=t[e].id;break}},e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this._activityID],e="HappySevenDayViewSkin";t.pageSkin&&(e=t.pageSkin),this.skinName=e,this.actInfo0&&(this.actInfo0.text=t.desc)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.tabP.itemRenderer=HappySevenDayTabListItemRender,this.tabD.itemRenderer=HappySevenDayBtnItemRender,this.list.itemRenderer=HappySevenDayItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._activityID=t[0],this.setCurSkin(),this._curDayIndex=0,this._curGroupIndex=0,this.updateView(),this.updateTabs(),this.tabD.selectedIndex=this._curDayIndex,this.tabP.selectedIndex=this._curGroupIndex,this.updateData(),this.updateTargetAward(),this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(392,this.refreshReds),this.addEventChange(this.tabD,this.onClickBtn),this.addEventChange(this.tabP,this.onTabBtn),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.close=function(){this._tabCollect=null,this._btnCollect=null,this._listCollect=null},e.prototype.updateView=function(){var t=amusementControl.getAmusementDataById(this._activityID);this._curDay=t.getCurDay(),this._items=[];var e,i,n,o,s,r,a=DataCenter.ins().Amusement11_2Config[this._activityID],l=[];for(var h in a)e=a[h],n=e.day,i=this._items[e.day-1],i||(i=[],this._items[e.day-1]=i,l.push({res:e.dayImg,isOpen:this._curDay>=e.day,showRed:!1,day:e.day})),r=t.achieveInfo[e.index-1],this._curDay>=e.day&&!r.isGot&&r.times>=e.dayLimit&&(l[e.day-1].showRed=!0),o=e.group,s=i[o-1],s||(s=[],i[o-1]=s),s.push(e);this._btnCollect||(this._btnCollect=new ArrayCollection,this.tabD.dataProvider=this._btnCollect),this._btnCollect.source=l,this.tabD.validateNow(),this._tabCollect||(this._tabCollect=new ArrayCollection,this.tabP.dataProvider=this._tabCollect)},e.prototype.refreshReds=function(){this.updateView(),this.updateTabs(),this.updateData(),this.updateTargetAward()},e.prototype.updateData=function(){var t=this._items[this._curDayIndex][this._curGroupIndex];if(t&&t.length){this._listCollect||(this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect);for(var e,i,n=t.length,o=[],s=0,r=amusementControl.getAmusementDataById(this._activityID),a=0;n>a;a++)e=t[a],i=r.achieveInfo[e.index-1],s=i.isGot?2:i.times>=e.dayLimit?1:0,o[a]={activityID:this._activityID,conf:e,state:s,times:i.times};o.sort(this.sort),this._listCollect.source=o}},e.prototype.sort=function(t,e){return 1==t.state&&1!=e.state?-1:2==t.state&&2!=e.state?1:t.conf.index<e.conf.index?-1:t.conf.index>e.conf.index?1:0},e.prototype.updateTargetAward=function(){var t=DataCenter.ins().Amusement11_1Config[this._activityID][Object.keys(DataCenter.ins().Amusement11_1Config[this._activityID]).length];this.schedule.maximum=t.score,this.schedule.value=amusementControl.getAmusementDataById(this._activityID).gethiScore()},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.rewardBtn:UIMgr.ins().open(TaskIntegralGiftView,this._activityID)}},e.prototype.onClickBtn=function(t){if(this._curDayIndex!=t.currentTarget.selectedIndex){var e=this.tabD.getChildAt(t.currentTarget.selectedIndex);e.isOpen?(e=this.tabD.getChildAt(this._curDayIndex),e.selected=!1,this._curDayIndex=t.currentTarget.selectedIndex):tipsControl.showCenterTips(LangMgr.getValueByKey("activitOpenDay",e.day)),this.tabD.selectedIndex=this._curDayIndex,e=this.tabD.getChildAt(this._curDayIndex),e.selected=!0,this.updateTabs(),this.tabP.selectedIndex=this._curGroupIndex=0,this.updateData()}},e.prototype.onTabBtn=function(t){this._curGroupIndex!=t.currentTarget.selectedIndex&&(this._curGroupIndex=t.currentTarget.selectedIndex,this.tabP.selectedIndex=this._curGroupIndex,this.updateData())},e.prototype.updateTabs=function(){var t,e,i,n=this._items[this._curDayIndex],o=amusementControl.getAmusementDataById(this._activityID),s=[];for(var r in n){s.push({gName:n[r][0].gName,showRed:!1}),t=n[r].length;for(var a=0;t>a;a++)if(i=n[r][a],e=o.achieveInfo[i.index-1],this._curDay>=i.day&&!e.isGot&&e.times>=i.dayLimit){s[r].showRed=!0;break}}this._tabCollect.source=s},e.prototype.setTime=function(){var t=amusementControl.activityData[this._activityID];t&&(this.actTime0.text=t.getRemainTime())},e}(BaseEuiView);__reflect(HappySevenDayView.prototype,"HappySevenDayView");var TaskIntegralGiftView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TaskIntegralGiftViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=SevenDayShowItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,n=(Object.keys(DataCenter.ins().Amusement11_1Config[t[0]]).length,[]);for(var o in DataCenter.ins().Amusement11_1Config[t[0]])i=DataCenter.ins().Amusement11_1Config[t[0]][o],n.push({reward:i.reward,showText:i.showText});this.list.dataProvider=new ArrayCollection(n)},e}(BaseEuiView);__reflect(TaskIntegralGiftView.prototype,"TaskIntegralGiftView");var HappySevenDayBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.day=0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.dayImg.source=this.data.res,this.isOpen=this.data.isOpen,this.day=this.data.day,this.currentState=this.isOpen?"unlock":"lock",this.redpoint.visible=this.data.showRed},Object.defineProperty(e.prototype,"selected",{set:function(t){this.currentState=this.isOpen?t?"unlockS":"unlock":"lock",this.data&&(this.redpoint.visible=this.data.showRed)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(HappySevenDayBtnItemRender.prototype,"HappySevenDayBtnItemRender");var HappySevenDayItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ItemBase,this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect,this.addEventTouchTap(this.actBtn,this.onTouch)},e.prototype.dataChanged=function(){this._listCollect.source=this.data.conf.reward,this.pName.textFlow=TextUtils.generateTextFlow1(this.data.conf.name);var t=this.data.conf.rate||1;this.scedule.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color43")+"&T:"+Math.floor(this.data.times/t)+"|/"+Math.floor(this.data.conf.dayLimit/t)),this.currentState=2==this.data.state?"done":"normal",this.redpoint.visible=1==this.data.state,0==this.data.state&&this.data.conf.turn?(this.actBtn.enabled=!0,this.actBtn.label=LangMgr.getValueByKey("traval")):(this.actBtn.label=LangMgr.getValueByKey("take"),this.actBtn.enabled=1==this.data.state)},e.prototype.onTouch=function(t){0==this.data.state&&this.data.conf.turn?UIMgr.ins().open(this.data.conf.turn[0],this.data.conf.turn[1]):amusementControl.upReward(this.data.activityID,this.data.conf.index,2)},e.prototype.destruct=function(){this.removeEventTouchTap(this.actBtn,this.onTouch)},e}(BaseItemRender);__reflect(HappySevenDayItemRender.prototype,"HappySevenDayItemRender");var HappySevenDayTabListItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.tabName.text=this.data.gName,this.redpoint.visible=this.data.showRed},Object.defineProperty(e.prototype,"selected",{set:function(t){this.currentState=t?"select":"unselect",this.data&&(this.redpoint.visible=this.data.showRed)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(HappySevenDayTabListItemRender.prototype,"HappySevenDayTabListItemRender");var SevenDayShowItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ItemBase},e.prototype.dataChanged=function(){this.scheduleTxt.textFlow=TextUtils.generateTextFlow1(this.data.showText),this.list.dataProvider=new ArrayCollection(this.data.reward)},e}(BaseItemRender);__reflect(SevenDayShowItemRender.prototype,"SevenDayShowItemRender");var InvestmentControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.firstRedByLv=!0,e.firstRedByLogin=!0,e.InvestLvIsBuy=!1,e.InvestLvReward=0,e.InvestLoginIsBuy=!1,e.InvestLoginReward=0,e.itemId={},e.goodsBuyInfo={},e.InvestGuaQiaIsBuy=!1,e.InvestGuaQiaIsReward=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downInvestmentInfo=function(t,e,i,n,o,s){for(var r=0;r<t.length;r++){var a=t[r][0],l=t[r][1],h=t[r][2],u=t[r][3];this.goodsBuyInfo[a]={goodId:a,isBuy:l,isTodayNewLoginReward:h,inverstNewLoginReward:u}}this.InvestLvIsBuy=i,this.InvestLvReward=n,this.InvestGuaQiaIsBuy=o,this.InvestGuaQiaIsReward=s,EventMgr.ins().dispatch(449)},e.prototype.getRewardDays=function(t){return this.goodsBuyInfo[t]?this.goodsBuyInfo[t].inverstNewLoginReward:null},e.prototype.getTodayReward=function(t){return this.goodsBuyInfo[t]?this.goodsBuyInfo[t].isTodayNewLoginReward:null},e.prototype.getBuyState=function(t){return this.goodsBuyInfo[t]?this.goodsBuyInfo[t].isBuy:null},e.prototype.IsRedPoint=function(t){var e=this.goodsBuyInfo[t];return e?this.getTodayReward(t)?!1:!0:!1},e.prototype.IsAllReward=function(t){var e,i=!0,n=0;switch(t){case 2:e=investmentControl.InvestLvReward.toString(2).split("").reverse();for(var o in DataCenter.ins().InvestmentLevelConfig){var s=DataCenter.ins().InvestmentLevelConfig[o].id;(s>e.length||"0"==e[DataCenter.ins().InvestmentLevelConfig[o].id-1])&&(i=!1)}break;case 4:e=investmentControl.InvestGuaQiaIsReward.toString(2).split("").reverse();for(var o in DataCenter.ins().InvestmentChapterConfig){var s=DataCenter.ins().InvestmentChapterConfig[o].id;(s>e.length||"0"==e[DataCenter.ins().InvestmentChapterConfig[o].id-1])&&(i=!1)}break;case 1:n=CommonUtils.getObjectLength(DataCenter.ins().InvestmentLoginConfig),i=this.investLoginReward>=n?!0:!1;break;case 511:n=CommonUtils.getObjectLength(DataCenter.ins().InvestmentAfterConfig[511]),SwitchMgr.ins().checkOpen(1019)&&this.getRewardDays(511)<n&&(i=!1);break;case 508:n=CommonUtils.getObjectLength(DataCenter.ins().InvestmentAfterConfig[508]),i=this.getRewardDays(508)>=n}return i},e.prototype.isOpenInvest=function(){var t=!1;if(CommonUtils.getObjectLength(this.goodsBuyInfo))for(var e in this.goodsBuyInfo){var i=DataCenter.ins().InvestmentAfterConfig[this.goodsBuyInfo[e].goodId],n=CommonUtils.getObjectLength(i);this.goodsBuyInfo[e].inverstNewLoginReward<n&&(t=!0)}return!t&&CommonUtils.getObjectLength(this.goodsBuyInfo)<=1&&SwitchMgr.ins().checkOpen(1015)&&reincarnateControl.lv>=DataCenter.ins().InvestmentBaseConfig.afterLoginZhuansheng1&&GameServer.serverOpenDay>=DataCenter.ins().InvestmentBaseConfig.afterLoginServerDay1-1&&(SwitchMgr.ins().checkOpen(1019)&&!this.IsAllReward(511)?t=!0:this.IsAllReward(508)||(t=!0)),t},e.prototype.upInvestmentReward=function(t,e){return[t,e]},e.prototype.sendInvestment=function(t){switch(t){case 1:payControl.showReCharge(DataCenter.ins().InvestmentBaseConfig.LoginInvestMoneyId);break;case 2:payControl.showReCharge(DataCenter.ins().InvestmentBaseConfig.LevelInvestMoneyId);break;case 4:payControl.showReCharge(DataCenter.ins().InvestmentBaseConfig.ChapterInvsetMoneyId);break;default:payControl.showReCharge(t)}},e.prototype.IsExistInvest=function(t){if(this.IsExistByServer(t)){var e=!1;switch(t){case 1:e=this.isInvestLogin;break;case 2:e=this.InvestLvIsBuy;break;case 4:e=this.InvestGuaQiaIsBuy}return e?!this.IsAllReward(t):this.checkSysOpen(t)}return!1},e.prototype.IsExistByServer=function(t){for(var e in DataCenter.ins().InvestmentBtnConfig){var i=DataCenter.ins().InvestmentBtnConfig[e];if(i.type==t&&i.idOpenLimit){for(var n=!0,o=i.idOpenLimit.split(","),s=0;s<o.length;s++){var r=o[s].split("-");if(2==r.length){if(GlobalModel.srvid>=Number(r[0])&&GlobalModel.srvid<=Number(r[1])){n=!1;break}}else if(GlobalModel.srvid==Number(r[0])){n=!1;break}}if(n)return!1}}return!0},e.prototype.checkSysOpen=function(t){switch(t){case 1:if(GameServer.serverOpenDay<=DataCenter.ins().InvestmentBaseConfig.openDayBuyLoginInvest-1)return!0;break;case 2:if(GameServer.serverOpenDay<=DataCenter.ins().InvestmentBaseConfig.openDayBuyLevelInvest-1)return!0;break;case 4:var e=DataCenter.ins().InvestmentBaseConfig.chapterInvsetOpenTime+DataCenter.ins().InvestmentBaseConfig.chapterInvsetSustainTime;if(GameServer.serverOpenDay>=DataCenter.ins().InvestmentBaseConfig.chapterInvsetOpenTime-1&&GameServer.serverOpenDay<=e-2&&ActorControl.level>=DataCenter.ins().InvestmentBaseConfig.chapterInvsetOpenzs)return!0;break;case 3:return!0}return!1},e.prototype.setInvestmentFirstRedPoint=function(t){this.dispatchFirstRedPoint()},e.prototype.dispatchFirstRedPoint=function(){EventMgr.ins().dispatch(450)},e.prototype.getLeftTime=function(t){var e=0,i=0;switch(t){case 1:e=DataCenter.ins().InvestmentBaseConfig.openDayBuyLoginInvest,i=this.getLoginLeftTime(e);break;case 2:e=DataCenter.ins().InvestmentBaseConfig.openDayBuyLevelInvest,i=this.getLvLeftTime(e);break;case 4:e=DataCenter.ins().InvestmentBaseConfig.chapterInvsetOpenTime+DataCenter.ins().InvestmentBaseConfig.chapterInvsetSustainTime-2,i=this.getLvLeftTime(e)}return e-=GameServer.serverOpenDay+1,0>e?0:i},e.prototype.getLoginLeftTime=function(t){var e=DateUtils.formatMiniDateTime(GameServer._serverZeroTime)+t*DateUtils.MS_PER_DAY,i=e-GameServer.serverTime;if(i>0){var n=Math.floor(i/DateUtils.MS_PER_SECOND);return 0>n&&(n=0),n}return 0},e.prototype.getLvLeftTime=function(t){var e=DateUtils.formatMiniDateTime(GameServer._serverZeroTime)+t*DateUtils.MS_PER_DAY,i=e-GameServer.serverTime,n=i/DateUtils.MS_PER_DAY>>0,o=DateUtils.MS_PER_DAY-i%DateUtils.MS_PER_DAY,s=n*DateUtils.MS_PER_DAY+o;if(s>0){var r=Math.floor(s/DateUtils.MS_PER_SECOND);return 0>r&&(r=0),r}return 0},__decorate([down(3,[[3,1,1,3],3,1,3,1,3])],e.prototype,"downInvestmentInfo",null),__decorate([up(4,[1,2])],e.prototype,"upInvestmentReward",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(InvestmentControl.prototype,"InvestmentControl");var InvestmentLevelPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLevelPanelSkin",e}return __extends(e,t),e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.openCheck=function(t){return investmentControl.IsExistInvest(4)},e.prototype.open=function(){this.addEventTouchTap(this.rechargeBtn,this.onClick),this.addCustomEvent(449,this.updateView),this.addCustomEvent(4,this.updateView),this.addCustomEvent(112,this.updateView),this.addCustomEvent(376,this.updateView),this.content.itemRenderer=InvestmentLevelItemRender,this.actTime.visible=!1,investmentControl.InvestGuaQiaIsBuy||(this.actTime.visible=!0,TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.setTime()),this.updateView(),investmentControl.setInvestmentFirstRedPoint(4)
},e.prototype.updateView=function(){var t=[];for(var e in DataCenter.ins().InvestmentChapterConfig)t.push(DataCenter.ins().InvestmentChapterConfig[e]);t.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"id")});for(var i=[],n=[],o=[],s=investmentControl.InvestGuaQiaIsReward.toString(2).split("").reverse(),r=0;r<t.length;r++)investmentControl.IsRedPoint(t[r].id)?i.push(t[r]):"1"==s[t[r].id-1]?o.push(t[r]):n.push(t[r]);var a=i.concat(n,o);this.content.dataProvider=new eui.ArrayCollection(a);var l=DataCenter.ins().PayInfoConfig[DataCenter.ins().InvestmentBaseConfig.ChapterInvsetMoneyId];investmentControl.InvestGuaQiaIsBuy?(this.rechargeBtn.label=LangMgr.getValueByKey("alrInvestment"),this.rechargeBtn.filters=FilterUtils.ARRAY_GRAY_FILTER,this.rechargeBtn.touchEnabled=!1):this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",l.cash)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeBtn:if(investmentControl.InvestGuaQiaIsBuy)return void tipsControl.showTips(LangMgr.getValueByKey("alrInvestmentRef"));investmentControl.sendInvestment(4)}},e.prototype.setTime=function(){var t=investmentControl.getLeftTime(4);this.actTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3),investmentControl.InvestGuaQiaIsBuy&&(this.actTime.visible=!1,TimerMgr.ins().remove(this.setTime,this))},e}(BasePanel);__reflect(InvestmentLevelPanel.prototype,"InvestmentLevelPanel");var InvestmentLoginPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLoginPanelSkin",e}return __extends(e,t),e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.openCheck=function(t){return SwitchMgr.ins().checkOpen(71)?investmentControl.IsExistInvest(1):!1},e.prototype.open=function(){this.addEventTouchTap(this.rechargeBtn,this.onClick),this.addCustomEvent(449,this.updateView),this.addCustomEvent(461,this.updateView),this.addCustomEvent(457,this.updateView),this.addCustomEvent(4,this.updateView),this.content.itemRenderer=InvestmentLoginListItemRender,this.listData=new eui.ArrayCollection,this.content.dataProvider=this.listData,this.addEventItemTap(this.content,this.onSoulClick),this.actTime.visible=!1,investmentControl.isInvestLogin||(this.actTime.visible=!0,TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.setTime()),this.updateView(),investmentControl.setInvestmentFirstRedPoint(1)},e.prototype.onSoulClick=function(t){if(t&&t.itemRenderer&&t.item){if(!investmentControl.isInvestLogin)return;if(investmentControl.isTodayLoginReward)return;if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);investmentControl.upInvestmentReward(1,1)}},e.prototype.updateView=function(){var t=[];for(var e in DataCenter.ins().InvestmentLoginConfig)t.push(DataCenter.ins().InvestmentLoginConfig[e]);if(t.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"id")}),this.listData.replaceAll(t),investmentControl.isInvestLogin)this.rechargeBtn.label=LangMgr.getValueByKey("alrInvestment"),this.rechargeBtn.filters=FilterUtils.ARRAY_GRAY_FILTER,this.rechargeBtn.touchEnabled=!1;else{var i=DataCenter.ins().PayInfoConfig[DataCenter.ins().InvestmentBaseConfig.LoginInvestMoneyId];this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",i.cash)}},e.prototype.setTime=function(){var t=investmentControl.getLeftTime(1);this.actTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3),investmentControl.isInvestLogin&&(this.actTime.visible=!1,TimerMgr.ins().remove(this.setTime,this))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeBtn:if(investmentControl.isInvestLogin)return void tipsControl.showTips(LangMgr.getValueByKey("alrInvestmentRef"));investmentControl.sendInvestment(1)}},e}(BasePanel);__reflect(InvestmentLoginPanel.prototype,"InvestmentLoginPanel");var InvestmentLvGiftPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLvGiftPanelSkin",e}return __extends(e,t),e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.openCheck=function(t){return SwitchMgr.ins().checkOpen(70)?investmentControl.IsExistInvest(2):!1},e.prototype.open=function(){this.addEventTouchTap(this.rechargeBtn,this.onClick),this.addCustomEvent(449,this.updateView),this.addCustomEvent(461,this.updateView),this.addCustomEvent(457,this.updateView),this.addCustomEvent(4,this.updateView),this.addCustomEvent(112,this.updateView),this.content.itemRenderer=InvestmentLvItemRender,this.actTime.visible=!1,this.updateView(),investmentControl.setInvestmentFirstRedPoint(2)},e.prototype.updateView=function(){var t=[];for(var e in DataCenter.ins().InvestmentLevelConfig)t.push(DataCenter.ins().InvestmentLevelConfig[e]);t.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"id")});for(var i=[],n=[],o=[],s=investmentControl.InvestLvReward.toString(2).split("").reverse(),r=0;r<t.length;r++)investmentControl.IsRedPoint(t[r].id)?i.push(t[r]):"1"==s[t[r].id-1]?o.push(t[r]):n.push(t[r]);var a=i.concat(n,o);this.content.dataProvider=new eui.ArrayCollection(a);var l=DataCenter.ins().PayInfoConfig[DataCenter.ins().InvestmentBaseConfig.LevelInvestMoneyId];investmentControl.InvestLvIsBuy?(this.rechargeBtn.label=LangMgr.getValueByKey("alrInvestment"),this.rechargeBtn.filters=FilterUtils.ARRAY_GRAY_FILTER,this.rechargeBtn.touchEnabled=!1):this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",l.cash),this.first.visible=!1},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeBtn:if(investmentControl.InvestLvIsBuy)return void tipsControl.showTips(LangMgr.getValueByKey("alrInvestmentRef"));investmentControl.sendInvestment(2)}},e.prototype.setTime=function(){var t=investmentControl.getLeftTime(2);this.actTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3),investmentControl.InvestLvIsBuy&&(this.actTime.visible=!1,TimerMgr.ins().remove(this.setTime,this))},e}(BasePanel);__reflect(InvestmentLvGiftPanel.prototype,"InvestmentLvGiftPanel");var AmusementType100DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.isOpenActivity=function(){return!0},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){var t=DataCenter.ins().Amusement100Config[this.id];if(t)switch(t.jump){case 1:return DailyCopyRedPoint.ins().goldRed;case 2:return backpackControl.getDamageBagGoodsCountByType();case 3:return bossControl.checkWorldBossRedPoint(2)}return!1},e}(AmusementBaseDataVo);__reflect(AmusementType100DataVo.prototype,"AmusementType100DataVo");var InvestmentNewRewardTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentNewRewardTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.otherClose),this.fgClose&&this.addEventTouchTap(this.fgClose,this.otherClose),this.detailReward.itemRenderer=InvestMonthRewardItemRender;var i=[],n=DataCenter.ins().InvestmentAfterConfig[t[0]],o=investmentControl.getRewardDays(t[0]),s=investmentControl.getBuyState(t[0]),r=CommonUtils.getObjectLength(n),a=o>=r?r:investmentControl.getTodayReward(t[0])?o:o+1,l=investmentControl.getTodayReward(t[0]);for(var h in DataCenter.ins().InvestmentAfterConfig[t[0]]){var u=DataCenter.ins().InvestmentAfterConfig[t[0]][h];if(u.id){var p=Number(h);s?p!=a||l?o>=p?u.state=1:u.state=3:u.state=2:u.state=3,i.push(u)}}this.detailReward.dataProvider=new eui.ArrayCollection(i),this.detailReward.validateNow();var c=114*investmentControl.investNewLoginReward,d=570,g=this.detailReward.contentHeight-d;d>c?c=0:c>g?c=g:c-=114,this.detailReward.scrollV=c},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(InvestmentNewRewardTipsView.prototype,"InvestmentNewRewardTipsView");var InvestmentNewType1Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentNewType1PanelSkin",e.isTopLevel=!0,e}return __extends(e,t),e.openCheck=function(t){return SwitchMgr.ins().checkOpen(1015)&&!investmentControl.IsAllReward(508)},e}(InvestmentMonthView);__reflect(InvestmentNewType1Panel.prototype,"InvestmentNewType1Panel");var InvestmentNewType2Panel=function(t){function e(){var e=t.call(this)||this;return e.payId=511,e.skinName="InvestmentNewType2PanelSkin",e.isTopLevel=!0,e.lisrtArr=new eui.ArrayCollection,e.list.itemRenderer=InvestMonthRewardItem2Render,e.list.dataProvider=e.lisrtArr,e}return __extends(e,t),e.openCheck=function(t){return SwitchMgr.ins().checkOpen(1015)&&SwitchMgr.ins().checkOpen(1019)&&!investmentControl.IsAllReward(511)},e.prototype.open=function(){this.addEventTouchTap(this.rechargeBtn,this.onTouchBtn),this.addCustomEvent(449,this.updateView),this.updateView()},e.prototype.updateView=function(){var t=DataCenter.ins().InvestmentAfterConfig[this.payId],e=[],i=investmentControl.getRewardDays(this.payId),n=investmentControl.getBuyState(this.payId),o=CommonUtils.getObjectLength(t),s=i>=o?o:investmentControl.getTodayReward(this.payId)?i:i+1,r=investmentControl.getTodayReward(this.payId);for(var a in t)if(t[a].id){var l=t[a],h=Number(a);n?h!=s||r||i!=o?h!=s||r?i>=h?l.state=1:l.state=3:l.state=2:l.state=1:l.state=3,e.push(l)}this.list.dataProvider=new eui.ArrayCollection(e);var u=DataCenter.ins().PayInfoConfig[this.payId];n&&r?(this.rechargeBtn.currentState="disable",this.rechargeBtn.label=LangMgr.getValueByKey("tomorrowGetLq")):n&&!r&&i==o?(this.rechargeBtn.currentState="disable",this.rechargeBtn.label=LangMgr.getValueByKey("activitAlreadingGet")):n&&!r?(this.rechargeBtn.currentState="up",this.rechargeBtn.label=LangMgr.getValueByKey("osaQuickGet")):n||(this.rechargeBtn.currentState="up",this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",u.cash))},e.prototype.onTouchBtn=function(t){switch(t.currentTarget){case this.rechargeBtn:if(investmentControl.getBuyState(this.payId)){if(!investmentControl.getBuyState(this.payId))return void tipsControl.showTips(LangMgr.getValueByKey("noInvestment"));if(investmentControl.getTodayReward(this.payId))return void tipsControl.showTips(LangMgr.getValueByKey("tomorrowAlrGetAw"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);investmentControl.upInvestmentReward(3,this.payId)}else investmentControl.sendInvestment(this.payId)}},e}(BaseEuiView);__reflect(InvestmentNewType2Panel.prototype,"InvestmentNewType2Panel");var InvestmentView=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){var e=this;t.prototype.initUI.call(this),this.iconList.itemRenderer=InvestmentItemRender;var i=[{payId:508,func:InvestmentNewType1Panel,icon:DataCenter.ins().InvestmentBtnConfig[1].icon,type:1,sort:DataCenter.ins().InvestmentBtnConfig[1].sort,title:DataCenter.ins().InvestmentBtnConfig[1].title},{payId:511,func:InvestmentNewType2Panel,icon:DataCenter.ins().InvestmentBtnConfig[2].icon,type:2,sort:DataCenter.ins().InvestmentBtnConfig[2].sort,title:DataCenter.ins().InvestmentBtnConfig[2].title},{payId:DataCenter.ins().InvestmentBaseConfig.LoginInvestMoneyId,func:InvestmentLoginPanel,icon:DataCenter.ins().InvestmentBtnConfig[3].icon,type:3,sort:DataCenter.ins().InvestmentBtnConfig[3].sort,title:DataCenter.ins().InvestmentBtnConfig[3].title},{payId:DataCenter.ins().InvestmentBaseConfig.LevelInvestMoneyId,func:InvestmentLvGiftPanel,icon:DataCenter.ins().InvestmentBtnConfig[4].icon,type:4,sort:DataCenter.ins().InvestmentBtnConfig[4].sort,title:DataCenter.ins().InvestmentBtnConfig[4].title},{payId:DataCenter.ins().InvestmentBaseConfig.ChapterInvsetMoneyId,func:InvestmentLevelPanel,icon:DataCenter.ins().InvestmentBtnConfig[5].icon,type:5,sort:DataCenter.ins().InvestmentBtnConfig[5].sort,title:DataCenter.ins().InvestmentBtnConfig[5].title}];this.allPanels=[],this._datas=[],i=i.sort(function(t,e){return t.sort>e.sort?1:-1}),i.map(function(t){var i=t.func.openCheck;null!=i&&i()&&(e.allPanels.push(t.func),e._datas.push(t))}),this.panels=[],this.arrList=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventChange(this.listBar,this.onChange),this.addEventChange(this.iconList,this.onClickMenu),this.addCustomEvent(449,this.updateMenuList),this.index=0,this.curId=0,this.updateMenuList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cruPanel.close()},e.prototype.updateMenuList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.info.removeChildren(),this.panels=this.allPanels,this.arrList.replaceAll(this._datas),this.iconList.selectedIndex=this.index,this.iconList.dataProvider=this.arrList,this.btnNum=this._datas.length,this.updateDetail(),this.onChange()},e.prototype.onClickMenu=function(t){SoundUtils.ins().playEffect(SoundUtils.VIEW),this.curId=this.iconList.selectedIndex,this.index=this.curId,this.updateDetail()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.onChange=function(){this.iconList.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.iconList.scrollH>88*(this.iconList.dataProvider.length-5)+2?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.btnNum<=5&&(this.leftBtn.visible=!1,this.rightBtn.visible=!1)},e.prototype.updateDetail=function(t){this.cruPanel&&(DisplayUtils.removeFromParent(this.cruPanel),this.cruPanel.close()),this.cruPanel=new this.panels[this.curId],welfareControl.isOpen[this.curId]||(welfareControl.isOpen[this.curId]=!0,this.updateMenuList()),this.cruPanel&&(this.cruPanel.left=0,this.cruPanel.right=0,this.cruPanel.top=0,this.cruPanel.bottom=0,this.info.addChild(this.cruPanel),this.cruPanel.open(t),this.title.source=this._datas[this.curId].title)},e}(BaseEuiView);__reflect(InvestmentView.prototype,"InvestmentView");var ActBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementBtnItemSkin",DisplayUtils.removeFromParent(e.mc),e.mc=null,e}return __extends(e,t),e.prototype.dataChanged=function(){this.iconDisplay.source=this.data.icon;var t=!1;t?(this.mc||(this.mc=new GameMovieClip,this.mc.x=40,this.mc.y=42),this.mc.playFile(PATH_EFF+"actIconCircle",-1),this.addChild(this.mc)):(DisplayUtils.removeFromParent(this.mc),this.mc=null),this.redPoint.visible=t},e}(BaseItemRender);__reflect(ActBtnItemRender.prototype,"ActBtnItemRender");var InvestmentBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementBtnItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.iconDisplay.source=this.data.icon,this.redPoint.visible=investmentControl.IsRedPoint(this.data.type))},e}(BaseItemRender);__reflect(InvestmentBtnItemRender.prototype,"InvestmentBtnItemRender");var InvestmentItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementBtnItemSkin",DisplayUtils.removeFromParent(e.mc),e.mc=null,e}return __extends(e,t),e.prototype.dataChanged=function(){this.iconDisplay.source=this.data.icon;var t,e=!1;switch(this.data.type){case 1:e=investmentControl.IsRedPoint(this.data.payId);break;case 2:e=investmentControl.IsRedPoint(this.data.payId);break;case 3:e=!1;break;case 4:t=investmentControl.InvestLvReward.toString(2).split("").reverse();for(var i in DataCenter.ins().InvestmentLevelConfig){var n=DataCenter.ins().InvestmentLevelConfig[i].id,o=DataCenter.ins().InvestmentLevelConfig[i].zsLevelLimit||0,s=DataCenter.ins().InvestmentLevelConfig[i].levelLimit||0;if(!investmentControl.InvestLvIsBuy){e=!0;break}if(0!=investmentControl.InvestLvReward&&t.some(function(t){return"0"==t})){e=!0;break}if(n>t.length&&ActorControl.level>=s&&reincarnateControl.lv>=o){e=!0;break}}break;case 5:t=investmentControl.InvestGuaQiaIsReward.toString(2).split("").reverse();for(var i in DataCenter.ins().InvestmentChapterConfig){var n=DataCenter.ins().InvestmentChapterConfig[i].id,r=DataCenter.ins().InvestmentChapterConfig[i].chapter||0;if(!investmentControl.InvestGuaQiaIsBuy){e=!0;break}if(0!=investmentControl.InvestGuaQiaIsReward&&t.some(function(t){return"0"==t})){e=!0;break}if(n>t.length&&copyControl.guanqiaID>=r){e=!0;break}}}e?(this.mc||(this.mc=new GameMovieClip,this.mc.x=40,this.mc.y=42),this.mc.playFile(PATH_EFF+"actIconCircle",-1),this.addChild(this.mc)):(DisplayUtils.removeFromParent(this.mc),this.mc=null),this.redPoint.visible=e},e}(BaseItemRender);__reflect(InvestmentItemRender.prototype,"InvestmentItemRender");var InvestmentLevelItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLevelItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase,this.addEventTouchEnd(this.getBtn,this.onClick)},e.prototype.onClick=function(){if(!investmentControl.InvestGuaQiaIsBuy)return void investmentControl.sendInvestment(4);if(this.getReawrd())return void tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet"));var t=this.data.chapter||0;copyControl.guanqiaID<t?tipsControl.showTips(LangMgr.getValueByKey("happyTips7")):backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView):investmentControl.upInvestmentReward(4,this.data.id)},e.prototype.getReawrd=function(){var t=investmentControl.InvestGuaQiaIsReward.toString(2).split("").reverse();return"1"==t[this.data.id-1]},e.prototype.dataChanged=function(){if(this.data){var t=this.data.chapter||0;this.redPoint.visible=this.isCondition(),this.alreadyImg.visible=this.getReawrd();for(var e=heroControl.getSubRoleByIndex(0),i=[],n=0;n<this.data.reward.length;n++)this.data.reward[n].job?this.data.reward[n].job==e.job&&i.push(this.data.reward[n]):i.push(this.data.reward[n]);this.reward.dataProvider=new eui.ArrayCollection(i),this.getBtn.visible=!this.alreadyImg.visible,this.desc.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitToCopy","（|C:0x00ff00&T:"+copyControl.guanqiaID+"|/"+t+"）"))}},e.prototype.isCondition=function(){if(!investmentControl.InvestGuaQiaIsBuy)return!0;var t=this.data.chapter||0;return investmentControl.InvestGuaQiaIsBuy&&!this.getReawrd()&&copyControl.guanqiaID>=t},e}(BaseItemRender);__reflect(InvestmentLevelItemRender.prototype,"InvestmentLevelItemRender");var InvestmentLoginListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLoginListItemSkin",e.reward.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.dayInfo.textFlow=TextUtils.generateTextFlow1(StringUtils.replace(this.data.desc,this.data.id)),this.redPoint.visible=investmentControl.IsRedPoint(this.data.id);for(var t=investmentControl.investLoginReward>=this.data.id,e=heroControl.getSubRoleByIndex(0),i=[],n=0;n<this.data.reward.length;n++)this.data.reward[n].job?this.data.reward[n].job==e.job&&i.push(this.data.reward[n]):i.push(this.data.reward[n]);this.reward.dataProvider=new eui.ArrayCollection(i),this.reward.validateNow();for(var n=0;n<this.reward.numElements;n++){var o=this.reward.getVirtualElementAt(n);o.getImg.visible=t}}},e}(BaseItemRender);__reflect(InvestmentLoginListItemRender.prototype,"InvestmentLoginListItemRender");var InvestmentLvItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLvItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase,this.addEventTouchEnd(this.getBtn,this.onClick)},e.prototype.onClick=function(){if(!investmentControl.InvestLvIsBuy)return void investmentControl.sendInvestment(2);if(this.getReawrd())return void tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet"));var t=this.data.zsLevelLimit||0,e=this.data.levelLimit||0;ActorControl.level<e||reincarnateControl.lv<t?tipsControl.showTips(LangMgr.getValueByKey("happyTips7")):backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView):investmentControl.upInvestmentReward(2,this.data.id)},e.prototype.getReawrd=function(){var t=investmentControl.InvestLvReward.toString(2).split("").reverse();return"1"==t[this.data.id-1]},e.prototype.dataChanged=function(){if(this.data){var t=this.data.zsLevelLimit||0,e=this.data.levelLimit||0,i="";t&&(i+=LangMgr.getValueByKey("numberRotation",t)),e&&(i+=LangMgr.getValueByKey("numberLevel",e)),this.lvBitmapLabel.text=i,this.redPoint.visible=this.isCondition(),this.alreadyImg.visible=this.getReawrd();for(var n=heroControl.getSubRoleByIndex(0),o=[],s=0;s<this.data.reward.length;s++)this.data.reward[s].job?this.data.reward[s].job==n.job&&o.push(this.data.reward[s]):o.push(this.data.reward[s]);this.reward.dataProvider=new eui.ArrayCollection(o),this.getBtn.visible=!this.alreadyImg.visible}},e.prototype.isCondition=function(){if(!investmentControl.InvestLvIsBuy)return!0;var t=this.data.zsLevelLimit||0,e=this.data.levelLimit||0;return investmentControl.InvestLvIsBuy&&!this.getReawrd()&&ActorControl.level>=e&&reincarnateControl.lv>=t?!0:!1},e}(BaseItemRender);__reflect(InvestmentLvItemRender.prototype,"InvestmentLvItemRender");var InvestMonthRewardItem2Render=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestMonthRewardItem2Skin",e.rewardList.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.currentState=this.data.state,this.dayCount.text=LangMgr.getValueByKey("activitDayIndex",this.data.id),this.rewardList.dataProvider=new eui.ArrayCollection(this.data.reward))},e}(BaseItemRender);__reflect(InvestMonthRewardItem2Render.prototype,"InvestMonthRewardItem2Render");var InvestMonthRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestMonthRewardItemSkin",e.rewardList.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.already.visible=1==this.data.state,this.dayCount.text=LangMgr.getValueByKey("activitDayIndex",this.data.id),this.rewardList.dataProvider=new eui.ArrayCollection(this.data.reward))},e}(BaseItemRender);__reflect(InvestMonthRewardItemRender.prototype,"InvestMonthRewardItemRender");var LastEighthBossView=function(t){function e(){var e=t.call(this)||this;return e._curMonsterID=0,e.curValue=1,e.skinName="LastEighthBossViewSkin",e.uilayer=GameLayer.SCENE2,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.bloodBar.slideDuration=0,this.grayImg.visible=!1,this.already=!1,this.bossHurt=!1},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.otherRank.itemRenderer=LastEighthBossPlayerRankItemRender,this.rankArrayCollection=new eui.ArrayCollection,this.otherRank.dataProvider=this.rankArrayCollection,this.meRank.itemRenderer=LastEighthBossPlayerRankItemRender,this.myrankArrayCollection=new eui.ArrayCollection,this.meRank.dataProvider=this.myrankArrayCollection},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.calcTime,this),TimerMgr.ins().remove(this.updateLogic,this),this.removeCustomEvents(),this._curMonsterID=0,UIMgr.ins().close(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.addCustomEvent(444,this.updateInfo),this.addEventTouchTap(this.rankReward,this.onTap),this.updateData(),this.amusement&&this.amusement.go2BossFb()?void this.init():(UIMgr.ins().close(this),void copyControl.upExitFb())},e.prototype.init=function(){this.timer=this.amusement.getResidueTimer(),this.readyTimer=this.amusement.getResidueStartTimer(),this.already=this.amusement.checkRedPoint(),this.TimerChange()},e.prototype.updateData=function(){this.amusement=amusementControl.checkLabaBossData()},e.prototype.updateLogic=function(){this.already?this.updateFb():this.updateReady(),this.refreshBg.visible=this.refreshHints.visible=this.refreshTime.visible=!this.already,this.bossBloodGroup.visible=this.already},e.prototype.updateReady=function(){this.readyTimer?this.refreshTime.text=this.readyTimer+LangMgr.getValueByKey("activitSS"):this.refreshTime.text=LangMgr.getValueByKey("activitUpdata"),this.bossHurt?(this.timer=this.amusement.getResidueTimer(),this.already=!0):this.already=!1},e.prototype.updateFb=function(){this.updateBaseInfo();var t=DataCenter.ins().Amusement20Config[this.amusement.id][this.amusement.index],e=this.timer/t.duration;e=e>=1?1:e,this.bloodBar.value=100*e,this.bloodBar.maximum=100;var i=(100*e).toFixed(1);this.bloodBar.labelFunction=function(){return i+"%"},this.updateHurtRank()},e.prototype.updateHurtRank=function(){for(var t=[],e=[],i=0;i<bossControl.rank.length;i++){var n=bossControl.rank[i],o={rank:n.rank,name:n.roleName,damage:n.value};if(5>i&&t.push(o),n.id==ActorControl.actorID&&e.push(o),5==t.length&&!e.length)break}if(!e.length){var o={rank:0,name:ActorControl.myName,damage:0};e.push(o)}this.rankArrayCollection.replaceAll(t),this.myrankArrayCollection.replaceAll(e)},e.prototype.updateBaseInfo=function(){if(this._curMonsterID!=bossControl.monsterID){this._curMonsterID=bossControl.monsterID;var t=DataCenter.ins().MonstersConfig[bossControl.monsterID];t&&(this.head.source=t.head+"_png",this.lvTxt.text="Lv."+t.level,this.nameTxt.text=t.name)}},e.prototype.tweenBlood=function(){var t=this,i=this.curValue*e.GRAYIMG_WIDTH/100,n=this;if(egret.Tween.removeTweens(this.grayImgMask),!(3>i)){var o=egret.Tween.get(this.grayImgMask,{onChange:function(){n.grayImg&&(n.grayImg.mask=t.grayImgMask)}},n);o.to({width:i-3},1e3).call(function(){0>=i&&(n.grayImgMask.width=0,egret.Tween.removeTweens(this.grayImgMask))},n)}},e.prototype.TimerChange=function(){TimerMgr.ins().isExists(this.calcTime,this)||TimerMgr.ins().doTimer(1e3,0,this.calcTime,this),TimerMgr.ins().isExists(this.updateLogic,this)||TimerMgr.ins().doTimer(60,0,this.updateLogic,this)},e.prototype.calcTime=function(){this.timer>0?this.timer--:this.timer=0,this.bossHurt?this.readyTimer=0:this.readyTimer>0&&this.readyTimer--},e.prototype.onTap=function(t){switch(t.currentTarget){case this.rankReward:UIMgr.ins().open(LastEighthRankRewardView,this.amusement)}},e.prototype.updateReliveTime=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.updateInfo=function(){this.bossHurt=!0},e.GRAYIMG_WIDTH=0,e}(BaseEuiView);__reflect(LastEighthBossView.prototype,"LastEighthBossView");var LastEighthRankRewardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="LastEighthRankRewardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list0.itemRenderer=LastEighthRewardItemRender,this.addEventTouchTap(this.bgClose,this.onClick),this.amusement=t[0],this.updateView()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateView=function(){if(this.amusement){for(var t=DataCenter.ins().Amusement20Config[this.amusement.id][this.amusement.index],e=[],i=0;i<t.rankReward.length;i++)e.push({config:t,index:i});this.list0.dataProvider=new eui.ArrayCollection(e)}},e}(BaseEuiView);__reflect(LastEighthRankRewardView.prototype,"LastEighthRankRewardView");var LastEighthBossPlayerRankItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="LastEighthBossPlayerRankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.rank.text=this.data.rank+"",this.rank.visible=this.data.rank?!0:!1,this.name1.text=this.data.name,CommonUtils.labelIsOverLenght(this.hurt,this.data.damage))},e}(BaseItemRender);__reflect(LastEighthBossPlayerRankItemRender.prototype,"LastEighthBossPlayerRankItemRender");var LastEighthChangeItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.get,this.onTap)},e.prototype.dataChanged=function(){if(this.data){var t=this.data.config,e=this.data.state,i=amusementControl.getAmusementDataById(t.Id);this._dataCollect||(this._dataCollect=new ArrayCollection,this.reward.dataProvider=this._dataCollect),this.result.data=t.rewards[0];var n=[];for(var o in t.items){var s=DataCenter.ins().ItemConfig[t.items[o].id],r={id:t.items[o].id,count:t.items[o].count,type:ItemUtils.getType(s)};n.push(r)}this._dataCollect.replaceAll(n),this.reward.validateNow();for(var o=0;o<this.reward.numElements;o++){var a=this.reward.getVirtualElementAt(o),l=this.reward.dataProvider.getItemAt(o),h=backpackControl.getBagItemById(l.id),u=h?h.count:0,p=u>=l.count?65280:16711680;a.setName("|C:"+p+"&T:("+u+"/"+l.count+")")}var c=0;e==AmusementControl.CanGet?(this.get.enabled=!0,this.get.currentState="up",c=65280):(this.get.enabled=!1,this.get.currentState="disabled",c=16711680);var d=0;t.count?(d=t.count-i.personalRewardsSum[t.index],d=d>0?d:0,this.limitchange1.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitRest",d))):t.dailyCount&&(d=t.dailyCount-i.exchange[t.index],d=d>0?d:0,this.limitchange1.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitTodayRest",d))),t.scount?(this.slimit.visible=!0,d=t.scount-i.worldRewardsSum[t.index],d=d>0?d:0,this.limitchange1.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitAllServerRest",d))):this.slimit.visible=!1,this.redPoint.visible=this.get.enabled;var g=3;if(t.items)for(var o=0;g>o;o++)t.items[g-o-1]||this["add"+(g-o-1)]&&DisplayUtils.removeFromParent(this["add"+(g-o-1)])}},e.prototype.onTap=function(t){return this.data&&this.data.config?void(CommonFun.checkBackpackCount()&&amusementControl.upReward(this.data.config.Id,this.data.config.index)):void tipsControl.showTips(LangMgr.getValueByKey("activitDataError"))},e.prototype.destruct=function(){this.removeEventTouchTap(this.get,this.onTap)},e}(BaseItemRender);__reflect(LastEighthChangeItemRender.prototype,"LastEighthChangeItemRender");var LastEighthRewardItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rewardList.itemRenderer=ItemBase},e.prototype.dataChanged=function(){if(this.data){var t=this.data.config,e=this.data.index,i=t.rankReward[e],n="";n=e==t.rankReward.length-1?LangMgr.getValueByKey("activitOtherM"):i.start==i.endi?LangMgr.getValueByKey("ranking",i.start):LangMgr.getValueByKey("activitRankIndex1",i.start,i.endi),this.ranks.text=n,this.rewardList.dataProvider=new eui.ArrayCollection(i.reward)}},e}(BaseItemRender);__reflect(LastEighthRewardItemRender.prototype,"LastEighthRewardItemRender");var MergeServerAmusementView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementWinViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.menuList.itemRenderer=AmusementBtnItemRender},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!SwitchMgr.ins().checkOpen(2,!0))return!1;var i=amusementControl.activityData,n=t[0];if(void 0!=n){if(i[n].pageType||2!=i[n].timeType)return tipsControl.showTips(LangMgr.getValueByKey("activitExWin")),!1;var o=amusementControl.getAmusementDataById(n);if(!o||!o.isOpenActivity())return tipsControl.showTips(LangMgr.getValueByKey("activitExWinNotOpen")),!1}var s=Object.keys(amusementControl.activityData);if(!s.length)return tipsControl.showTips(LangMgr.getValueByKey("activitExWinEnd")),!1;for(var r in i)if(!i[r].pageType&&2==i[r].timeType&&amusementControl.getAmusementDataById(+r).isOpenActivity())return!0;
return tipsControl.showTips(LangMgr.getValueByKey("activitExWinEnd")),!1},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.apply(this,e),this.updateView(),this.addCustomEvent(392,this.refushRedPoint),this.addCustomEvent(178,this.refushRedPoint),this.addCustomEvent(180,this.refushRedPoint),this.addCustomEvent(446,this.refushRedPoint),this.addCustomEvent(266,this.refushRedPoint),this.addCustomEvent(267,this.refushRedPoint),this.title.source="biaoti_hefuhuodong"},e.prototype.getDataUpdataView=function(){var t=amusementControl.activityData;for(var e in t)if(!t[e].pageType&&2==t[e].timeType&&amusementControl.getAmusementDataById(+e).isOpenActivity()){var i=amusementControl.getbtnInfo(e);if(!i||i.activityType&&2==i.activityType)continue;Assert(i,"MergeServerAmusementView  data   "+e)||this._datas.push(i)}},e.prototype.onClickMenu=function(e){t.prototype.onClickMenu.call(this,e);var i=DataCenter.ins().AmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID];if(1==this.amusementPanelList[this.selectIndex].activityType&&(i=DataCenter.ins().PAmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID]),i.type){var n=DataCenter.ins().AmusementConfig[this.amusementPanelList[this.selectIndex].activityID];n&&(3==n.activityType?this.setOpenIndex(this.selectIndex):amusementControl.upChangePage(this.amusementPanelList[this.selectIndex].activityID))}else this.setOpenIndex(this.selectIndex)},e.prototype.sort=function(t,e){return t.sort>e.sort?1:t.sort<e.sort?-1:0},e}(AmusementBaseView);__reflect(MergeServerAmusementView.prototype,"MergeServerAmusementView");var MergeServerBossIntegrateView=function(t){function e(){var e=t.call(this)||this;return e.currentSelect=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="MergeServerBossIntegrateViewSkin",this.equiplist.itemRenderer=MergeServerBossBtnItemRender,this.dataArr=new eui.ArrayCollection,this.listData={},this.menuData=[]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.activityID=t[0],this.initMenu();var i=DataCenter.ins().Amusement7Config[this.activityID][1];i&&i.showType==AmusementType7DataVo.TYPE_RING?(this.currentState="lyring",this.exchangelist.itemRenderer=RingBossScoreExchangeItemRenderer):(this.currentState="hefu",this.addEventItemTap(this.equiplist,this.onTap),this.exchangelist.itemRenderer=MergeServerBossItemRender),this.addCustomEvent(393,this.onListChange),this.addCustomEvent(395,this.ChangePageCallBack),this.addEventTouchTap(this.bgClose,this.onClick),this.addEventTouchTap(this.closeBtn,this.onClick),i&&i.showType!=AmusementType7DataVo.TYPE_RING&&(this.equiplist.selectedIndex=this.currentSelect),this.refushInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeEventItemTap(this.equiplist,this.onTap),this.removeCustomEvents()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this)}},e.prototype.onListChange=function(){amusementControl.upChangePage(this.activityID)},e.prototype.ChangePageCallBack=function(){this.refushInfo()},e.prototype.initMenu=function(){var t=DataCenter.ins().Amusement7Config[this.activityID],e=-1,i=0;for(var n in t)i!=t[n].title&&(i=t[n].title,e++,this.menuData||(this.menuData=[]),this.menuData.push({id:t[n].Id,index:t[n].index})),this.listData[e]||(this.listData[e]=[]),this.listData[e].push(t[n])},e.prototype.refushInfo=function(){var t=amusementControl.getAmusementDataById(this.activityID);this.suipian.text=""+t.bossScore,this.listData[this.currentSelect]&&(this.dataArr.replaceAll(this.listData[this.currentSelect].concat()),this.exchangelist.dataProvider=this.dataArr,this.exchangelist.scrollV=0,this.exchangelist.validateNow());var e=DataCenter.ins().Amusement7Config[this.activityID][1];e&&e.showType!=AmusementType7DataVo.TYPE_RING&&(this.equiplist.dataProvider=new eui.ArrayCollection(this.menuData))},e.prototype.onTap=function(t){t&&t.itemRenderer&&t.item&&(this.currentSelect=t.itemIndex,this.refushInfo())},e}(BaseEuiView);__reflect(MergeServerBossIntegrateView.prototype,"MergeServerBossIntegrateView");var limitChangeItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase,this.addEventTouchTap(this.get,this.onTap)},e.prototype.dataChanged=function(){if(this._activityID=this.data[0],this._config=this.data[1],this.slimit.visible=this.data[4]!=Number.MAX_VALUE,this.data[4]!=Number.MAX_VALUE){var t=this.data[4]?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.limitchange0.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitAllServerRest1",t,this.data[4]))}if(this.data[3]==Number.MAX_VALUE)this.limitchange1.text="";else{var t=this.data[3]?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.limitchange1.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitAllServerRest2",t,this.data[3],this._config.count))}this._dataCollect||(this._dataCollect=new ArrayCollection,this.reward.dataProvider=this._dataCollect),this._dataCollect.source=this._config.rewards,this.consnum.text=this._config.itemCount+"",this.get.enabled=this.data[2],this.itemImg?this.itemImg.source=this._config.itemId+"_png":this.showItem&&(this.showItem.source=this._config.itemId+"_png"),this.redPoint.visible=this.get.enabled},e.prototype.onTap=function(t){return backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?void UIMgr.ins().open(BackpackFullTipsView):void amusementControl.upReward(this._activityID,this._config.index)},e.prototype.destruct=function(){this.removeEventTouchTap(this.get,this.onTap)},e}(BaseItemRender);__reflect(limitChangeItemRender.prototype,"limitChangeItemRender");var MergeServerBossBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="MergeServerBossBtnItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.id,e=this.data.index,i=DataCenter.ins().Amusement7Config[t][e];this.btnText.text=i.title+LangMgr.getValueByKey("numberRotation",""),this.redPoint.visible=amusementControl.IsBossScoreTitle(i.Id,i.title)},e}(BaseItemRender);__reflect(MergeServerBossBtnItemRender.prototype,"MergeServerBossBtnItemRender");var MergeServerBossItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="MergeServerBossItemRenderSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.goBtn,this.onClick)},e.prototype.dataChanged=function(){if(this.data){var t=this.data,e=DataCenter.ins().ItemConfig[t.rewards[0].id],i=amusementControl.getAmusementDataById(t.Id),n=i.bossScore,o=amusementControl.getIsBuy(t);this.redPoint.visible=o&&n>=t.score,this.nameLab.text=e.name;var s=n<t.score?"#F3311E":"#35E62D";if(this.descLab.textFlow=(new egret.HtmlTextParser).parser("<font color = '"+s+"'>"+t.score+"</font>"),this.goBtn.currentState="up",this.goBtn.touchEnabled=!0,t.count){this.count.visible=!0;var r=t.count-i.personalRewardsSum[t.index];r=r>0?r:0,r||(this.goBtn.currentState="disabled",this.goBtn.touchEnabled=!1);var a=0>r?ColorUtils.RED:ColorUtils.GREEN;this.count.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitBossSy",a,r))}else this.count.visible=!1;this.itemConfig=e,this.itemIcon0.data=t.rewards[0]}},e.prototype.onClick=function(){if(this.data){var t=this.data,e=amusementControl.getAmusementDataById(t.Id);if(e.bossScore<t.score)return void tipsControl.showTips(LangMgr.getValueByKey("osaEnoughtScore1"));if(!amusementControl.getIsBuy(t))return void tipsControl.showTips(LangMgr.getValueByKey("osaExchangeEnd"));amusementControl.upReward(t.Id,t.index)}},e}(BaseItemRender);__reflect(MergeServerBossItemRender.prototype,"MergeServerBossItemRender");var RingBossScoreExchangeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="RingBossScoreExchangeItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.goBtn,this.onClick)},e.prototype.dataChanged=function(){if(this.data){var t=this.data,e=DataCenter.ins().ItemConfig[t.rewards[0].id],i=amusementControl.getAmusementDataById(t.Id),n=i.bossScore,o=amusementControl.getIsBuy(t);this.redPoint.visible=o&&n>=t.score,this.nameLab.text=e.name;var s=n<t.score?"#F3311E":"#35E62D";this.descLab.textFlow=(new egret.HtmlTextParser).parser("<font color = '"+s+"'>"+n+"</font><font color = '#9F946D'>/"+t.score+"</font>"),this.itemConfig=e,this.itemIcon0.data=t.rewards[0],this.itemIcon0.hideName();var r=amusementControl.getAmusementDataById(t.Id),a=r.personalRewardsSum[t.index],l=t.count-a;l?this.count.text=LangMgr.getValueByKey("activitRest","")+l+LangMgr.getValueByKey("part",""):this.count.text=""}},e.prototype.onClick=function(){if(this.data){var t=this.data,e=amusementControl.getAmusementDataById(t.Id);if(e.bossScore<t.score)return void tipsControl.showTips(LangMgr.getValueByKey("osaEnoughtScore1"));if(!amusementControl.getIsBuy(t))return void tipsControl.showTips(LangMgr.getValueByKey("osaExchangeEnd"));amusementControl.upReward(t.Id,t.index)}},e}(BaseItemRender);__reflect(RingBossScoreExchangeItemRenderer.prototype,"RingBossScoreExchangeItemRenderer");var NationalDayAmusementView=function(t){function e(){var e=t.call(this)||this;return e.skinName="NationalDayAmusementViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(NationalDayAmusementView.prototype,"NationalDayAmusementView");var NationalDayListItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=ItemBase,this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect,this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch)},e.prototype.dataChanged=function(){if(this._listCollect.source=this.data.conf.reward.concat(),this.pName.textFlow=TextUtils.generateTextFlow1(this.data.conf.name),this.scedule){var t=this.data.conf.rate||1;this.scedule.textFlow=TextUtils.generateTextFlow1("|C:65280&T:"+Math.floor(this.data.times/t)+"|/"+Math.floor(this.data.conf.dayLimit/t))}this.currentState=2==this.data.state?"done":"normal",this.redpoint.visible=1==this.data.state,this.score&&(this.score.text=this.data.conf.score),0==this.data.state&&this.data.conf.turn?(this.actBtn.enabled=!0,this.actBtn.label=LangMgr.getValueByKey("traval")):this.buttonUpdate(this.actBtn)},e.prototype.buttonUpdate=function(t){var e=this.data.state;0==e?(t.label=LangMgr.getValueByKey("activitGet1"),t.enabled=!1):1==e?(t.label=LangMgr.getValueByKey("activitGet1"),t.enabled=!0):2==e?(t.label=LangMgr.getValueByKey("activitAlreadingGet"),t.enabled=!1):3==e&&(t.label=LangMgr.getValueByKey("activitAgainGet"),t.enabled=!0)},e.prototype.onTouch=function(t){t.target==this.actBtn&&(0==this.data.state&&this.data.conf.turn?UIMgr.ins().open(this.data.conf.turn[0],this.data.conf.turn[1],this.data.conf.turn[2]):this.getAward())},e.prototype.getAward=function(){var t=this,e=this.data.state;if(1==e)amusementControl.upReward(this.data.activityID,this.data.conf.index,2);else if(3==e){if(ActorControl.yb<this.data.conf.againYb)return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"));ClientStorage.ins().getValue("activity_type11_getaward")?amusementControl.upReward(this.data.activityID,this.data.conf.index,2):warnControl.show(LangMgr.getValueByKey("activtExpenYBLq",this.data.conf.againYb),function(e){ClientStorage.ins().setValue("activity_type11_getaward",e),amusementControl.upReward(t.data.activityID,t.data.conf.index,2)},this,null,null,"check")}},e}(BaseItemRender);__reflect(NationalDayListItemRender.prototype,"NationalDayListItemRender");var NewYearFireworkerItemRender=function(t){function e(){var e=t.call(this)||this;return e._state=0,e.skinName="NewYearFireworkerItemSkin",e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.touchEnabled=2!=this.data.state,this.redPoint.visible=1==this.data.state,this.lingqu.visible=2==this.data.state;var t=0==this.data.state?LangMgr.getColor("color22"):LangMgr.getColor("color43");if(this.boxSchadule.textFlow=TextUtils.generateTextFlow1("|C:"+t+"&T:"+(this.data.curTimes>this.data.times?this.data.times:this.data.curTimes)+"|/"+this.data.times),this.count.text=this.data.count,1==this.data.type){var e=DataCenter.ins().ItemConfig[this.data.id];this.box.source=e.icon+"_png"}else this.box.source="richman_reward"},e}(BaseItemRender);__reflect(NewYearFireworkerItemRender.prototype,"NewYearFireworkerItemRender");var NewYearHighProjectItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="NewYearHighProjectItemSkin",e.touchChildren=!1,e.touchEnabled=!0,e.addEventTouchTap(e,e.onTouch),e}return __extends(e,t),e.prototype.dataChanged=function(){this.projectName.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.data.config.name),this.jifen.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color43")+"&T:"+this.data.config.score+"|"+LangMgr.getValueByKey("activitScore"));var t=Math.floor(this.data.times/this.data.config.target),e=Math.floor(this.data.config.dayLimit/this.data.config.target);t>e&&(t=e),this.daliyCount.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color43")+"&T:"+t+"|/"+e)},e.prototype.onTouch=function(t){this.data.config.turn&&UIMgr.ins().open(this.data.config.turn[0],this.data.config.turn[1])},e.prototype.destruct=function(){this.removeEventTouchTap(this,this.onTouch)},e}(BaseItemRender);__reflect(NewYearHighProjectItemRender.prototype,"NewYearHighProjectItemRender");var NewYearHighRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="NewYearHighRewardItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ItemBase,this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect,this.addEventTouchTap(this.get,this.onTouch)},e.prototype.dataChanged=function(){this.count.text=this.data.config.score,this.currentState=2==this.data.state?"done":1==this.data.state?"kelingqu":"normal",this._listCollect.source=this.data.config.reward},e.prototype.onTouch=function(t){amusementControl.upReward(this.data.activityID,this.data.index,1)},e.prototype.destruct=function(){this.removeEventTouchTap(this.get,this.onTouch)},e}(BaseItemRender);__reflect(NewYearHighRewardItemRender.prototype,"NewYearHighRewardItemRender");var RedpacketSpeakView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedPacketSpeakViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.sendBtn,this.onClick),this.actId=t[0],this.index=t[1];var i=DataCenter.ins().Amusement12Config[this.actId][this.index];this.input.text="",this.input.prompt=i.blessWord,this.input.maxChars=i.wordCount,this.input.touchEnabled=!1},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.sendBtn:UIMgr.ins().close(this);var e=amusementControl.getAmusementDataById(this.actId);if(!e.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));amusementControl.upReward(this.actId,this.index,1,this.input.text),UIMgr.ins().close(AmusementUniversalView)}},e}(BaseEuiView);__reflect(RedpacketSpeakView.prototype,"RedpacketSpeakView");var OffYearListsItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoticeListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.showText.textFlow=TextUtils.generateTextFlow(this.data))},e}(BaseItemRender);__reflect(OffYearListsItemRender.prototype,"OffYearListsItemRender");var OffYearRedPacketItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="OffYearRedPacketItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.currentState=t.skinType,this.desc.textFlow=TextUtils.generateTextFlow1(t.desc)}},e}(BaseItemRender);__reflect(OffYearRedPacketItemRender.prototype,"OffYearRedPacketItemRender");var RedPacketOpenItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedPacketOpenItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.hbbtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onClick,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.close,this),this.list.itemRenderer=RedPacketRewardsItemRender,this.closeBtn.visible=!1},e.prototype.onClick=function(t){switch(t.currentTarget){case this.hbbtn:if(!this.data||!this.data.actId||!this.data.eId)return;var e=amusementControl.getAmusementDataById(this.data.actId);if(!e.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));amusementControl.upReward(this.data.actId,this.data.eId,2)}},e.prototype.close=function(){this.callFun&&this.bt1&&this.bt2&&this.bt3&&(TimerMgr.ins().remove(this.close,this),this.parent&&(this.parent.removeChildren(),this.callFun()))},e.prototype.dataChanged=function(){if(this.data){var t=this.data.job,e=this.data.sex,i=this.data.name,n=this.data.text,o=this.data.index;this.myFace.source="head_"+t+e,this.playerName.text=i,this.speaktxt.textFlow=TextUtils.generateTextFlow1(n);var s=DataCenter.ins().Amusement12Config[this.data.actId][o];this.title.source="hongbao_title"+s.skinType}},e.prototype.destruct=function(){this.hbbtn.removeEventListener(egret.TouchEvent.TOUCH_END,this.onClick,this)},e.prototype.playAni=function(t,e,i){var n=this;this.removeChild(this.hbbtn),this.removeChild(this.hhbtnlabel),this.removeChild(this.speaktxt),this.removeChild(this.speakbg),this.topImg.scrollRect||(this.topImg.scrollRect=new egret.Rectangle(0,0,this.topImg.width,this.topImg.height)),this.downImg.scrollRect||(this.downImg.scrollRect=new egret.Rectangle(0,0,this.downImg.width,this.downImg.height));var o=this;this.callFun=function(){e&&e.call(i)};var s=this.topImg.scrollRect,r=this.downImg.scrollRect,a=400;this.list.dataProvider=new eui.ArrayCollection(t);var l=egret.Tween.get(s,{onChange:function(){n.topImg.scrollRect=s}}).to({y:200},a).call(function(){egret.Tween.removeTweens(l),o.bt1=!0,o.closeBtn.visible=!0}),h=egret.Tween.get(r,{onChange:function(){n.downImg.scrollRect=r}}).to({height:0},a).call(function(){egret.Tween.removeTweens(h),o.bt2=!0}),u=egret.Tween.get(this.downImg).to({y:this.downImg.y+this.downImg.height},a).call(function(){egret.Tween.removeTweens(u),o.bt3=!0});TimerMgr.ins().isExists(this.close,this)||TimerMgr.ins().doTimer(1e4,0,this.close,this)},e}(BaseItemRender);__reflect(RedPacketOpenItemRender.prototype,"RedPacketOpenItemRender");var RedPacketRewardsItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedPacketRewardsItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.yb,e=this.data.gold,i=""+t,n="";this.itemIndex||this.data.name!=ActorControl.myName?(this.currentState="otherman",n=LangMgr.getValueByKey("activitGetInHongBao")):(this.currentState="owner",n=LangMgr.getValueByKey("activitGetHongBao")),e?(i=CommonUtils.overLength(e),n+=LangMgr.getValueByKey("charItemJB",i)):n+=LangMgr.getValueByKey("charItemYB",i),this.validateNow(),this.speaktxt.text=n,this.myFace.source="yuanhead"+this.data.job+this.data.sex,this.playerName.text=this.data.name}},e}(BaseItemRender);__reflect(RedPacketRewardsItemRender.prototype,"RedPacketRewardsItemRender");var RedPacketShowItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedPacketShowItemSkin",e.init(),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=!1,this.hbimg.visible=!0},e.prototype.init=function(){this.addEventTouchEnd(this.hbimg,this.onClick),this.addEventTouchEnd(this.hongbaoeff,this.onClick)},e.prototype.onClick=function(){if(this.data&&this.data.actId&&this.data.eId){var t=amusementControl.getAmusementDataById(this.data.actId);if(!t.isOpenActivity())return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));for(var e=t.envelopeData.length-1;e>=0;e--)if(!t.envelopeData[e]||t.envelopeData[e].id==this.data.eId){if(t.envelopeData[e].isOverTimer())return tipsControl.showTips(LangMgr.getValueByKey("hbOverTime")),void amusementControl.dispatchEnvelopeDataCall(null);break}amusementControl.upEnvelopeData(this.data.actId,this.data.eId)}},e.prototype.destruct=function(){this.removeEventTouchEnd(this.hbimg,this.onClick),this.removeEventTouchEnd(this.hongbaoeff,this.onClick)},e}(BaseItemRender);__reflect(RedPacketShowItemRender.prototype,"RedPacketShowItemRender");var OpenDoorRedItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="OpenDoorRedItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase,this.addEventTouchEnd(this.get,this.onClick)},e.prototype.onClick=function(){if(this.data&&this.data instanceof KaiMenData){if(this.data.already)return void tipsControl.showTips(LangMgr.getValueByKey("fdAlreadingBuy"));if(this.data.unready)return void tipsControl.showTips(LangMgr.getValueByKey("activitOverDat"));if(3==this.data.type){if(!this.data.redPoint)return void UIMgr.ins().open(PayView)}else if(1==this.data.type&&!this.data.redPoint)return void tipsControl.showTips(LangMgr.getValueByKey("activitContition"));amusementControl.upReward(this.data.id,this.data.index)}},e.prototype.dataChanged=function(){if(this.data&&this.data instanceof KaiMenData&&(this.unready.visible=!1,this.already.visible=!1,this.redPoint.visible=this.data.redPoint,this.reward.dataProvider=new eui.ArrayCollection(this.data.reward),3==this.data.type?(this.data.already?(this.already.visible=!0,this.unready.visible=!1,this.redPoint.visible=!1,this.get.visible=!1):this.data.unready?(this.unready.visible=!0,this.already.visible=!1,this.get.visible=!1,this.redPoint.visible=!1):this.get.visible=!0,this.day.text=LangMgr.getValueByKey("activitDayIndex",this.data.day),DisplayUtils.removeFromParent(this.daySchedule),this.get.parent||this.buyGroup.addChild(this.get)):1==this.data.type&&(this.already.visible=this.data.already,this.data.unready?this.get.visible=!1:(this.get.visible=this.redPoint.visible,this.get.parent||this.buyGroup.addChild(this.get)),this.unready.visible=!1,this.day.text=LangMgr.getValueByKey("activitContinuousRecharge",this.data.day),this.already.visible?DisplayUtils.removeFromParent(this.daySchedule):this.daySchedule.parent||this.buyGroup.addChild(this.daySchedule)),this.get.visible||DisplayUtils.removeFromParent(this.get),3!=this.data.type||this.data.redPoint?this.get.label=LangMgr.getValueByKey("activitGet"):this.get.label=LangMgr.getValueByKey("activitRechargeState"),this.daySchedule.parent)){var t=amusementControl.getAmusementDataById(this.data.id),e=LangMgr.getColor("color43");this.daySchedule.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitRechargeShow1",e,t.dabiao[this.data.index-1],this.data.day))}},e.prototype.destruct=function(){this.removeEventTouchEnd(this.get,this.onClick)},e}(BaseItemRender);__reflect(OpenDoorRedItemRender.prototype,"OpenDoorRedItemRender");var KaiMenData=function(){function t(){}return t}();__reflect(KaiMenData.prototype,"KaiMenData");var PlatformAmuseControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.wxInviteCount=0,e.focusState=-1,e.shareState=-1,e.isShowGameDesktop=0,e.isShowFBGift=0,e.isShowFBRate=0,e.proveState=-1,e.giftState=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchGuanZhu=function(t){this.focusState=t,1==this.focusState&&this.upGuanZhuGift(),EventMgr.ins().dispatch(690)},e.prototype.dispatchShare=function(t){this.shareState=t,EventMgr.ins().dispatch(691)},e.prototype.dispatchGameDesktop=function(t){this.isShowGameDesktop=t,EventMgr.ins().dispatch(687,t)},e.prototype.dispatchGameFBGift=function(t){this.isShowFBGift=t,EventMgr.ins().dispatch(688)},e.prototype.dispatchGameFBRate=function(t){this.isShowFBRate=t,EventMgr.ins().dispatch(689)},e.prototype.saveGameDesktop=function(){ClientStorage.ins().setValue("isSaveGameDesktop",1),this.dispatchGameDesktop(0)},e.prototype.upGuanZhuGift=function(){},e.prototype.downZhiShangData=function(){},e.prototype.upWeiXinInviteGift=function(){},e.prototype.downWeiXinInviteGift=function(t,e){platformAmuseControl.wxInviteCount=t,platformAmuseControl.inviteTime=e,this.dispatchInviteInfoUpdate()},e.prototype.dispatchInviteInfoUpdate=function(){EventMgr.ins().dispatch(479)},e.prototype.upProveInfo=function(){},e.prototype.downProveInfo=function(t){this.giftState=t?1:0,1==this.proveState&&1==this.giftState},e.prototype.dispatchVerify=function(t){this.proveState=t},e.prototype.showVerify=function(){},e.prototype.checkFuLiOpen=function(t){var e;for(var i in DataCenter.ins().WelfareConfig)if(t==DataCenter.ins().WelfareConfig[i].id){e=DataCenter.ins().WelfareConfig[i];break}if(!e)return!1;var n=GlobalModel.pf,o=DateUtils.formatMiniDateTime(GameServer._serverZeroTime);if(e.openTimeLt){var s=e.openTimeLt[""+n];if(s){var r=this.getDateTime(s);if(o>r)return!1}}if(e.openTimeGt){var a=e.openTimeGt[""+n];if(a){var r=this.getDateTime(a);if(r>o)return!1}}if(!e.channels&&!e.notchannels)return!0;if(!isNaN(e.channels)&&!e.channels.length)return!1;if(e.channels){for(var i in e.channels)if(i==GlobalModel.pf)for(var l=e.channels[i],h=l.split(","),u=0;u<h.length;u++){var p=h[u].split("-");if(2==p.length){if(GlobalModel.srvid>=Number(p[0])&&GlobalModel.srvid<=Number(p[1]))return!0}else if(GlobalModel.srvid==Number(p[0]))return!0}return!1}if(e.notchannels){for(var i in e.notchannels)if(i==GlobalModel.pf)for(var c=e.notchannels[i],h=c.split(","),u=0;u<h.length;u++){var p=h[u].split("-");if(2==p.length){if(GlobalModel.srvid>=Number(p[0])&&GlobalModel.srvid<=Number(p[1]))return!1}else if(GlobalModel.srvid==Number(p[0]))return!1}return!0}return!1},e.prototype.getDateTime=function(t){var e=t.split(/[-.:]/g),i=new Date(+e[0],+e[1]-1,+e[2],+e[3]||0,+e[4]||0);return i.getTime()},e.prototype.copyMsgToBoard=function(t){if(document&&document.createElement){var e=document.createElement("input");return e.value=t,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length),document.execCommand("Copy"),document.body.removeChild(e),!0}return!1},e.prototype.checkFuLiRedPoint=function(t){var e=!1;switch(t){case 0:e=signInControl.showRedPoint();break;case 1:e=amusementControl.getSevenDayStast();break;case 2:e=!1;break;case 3:e=payControl.franchise&&payControl.franchiseget?!0:!1;break;case 4:e=amusementControl.checkNoticeRed();break;case 5:e=!1;break;case 6:e=dailyRedBagControl.isRedPoint()}return e},__decorate([up(2)],e.prototype,"upGuanZhuGift",null),__decorate([down(3)],e.prototype,"downZhiShangData",null),__decorate([up(4)],e.prototype,"upWeiXinInviteGift",null),__decorate([down(4,[3,3])],e.prototype,"downWeiXinInviteGift",null),__decorate([up(5)],e.prototype,"upProveInfo",null),__decorate([down(5,[1])],e.prototype,"downProveInfo",null),e=__decorate([protocolsId(33)],e)}(BaseSystem);__reflect(PlatformAmuseControl.prototype,"PlatformAmuseControl");var FocusGameView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FocusGameViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.focusBtn,this.onTap),this.initList()},e.prototype.initList=function(){var t=DataCenter.ins().WeiXiFocusConstConfig.awards;this.reward.itemRenderer=ItemBase,this.reward.dataProvider=new eui.ArrayCollection(t)},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.bgClose:case this.closeBtn:UIMgr.ins().close(this);break;case this.focusBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(FocusGameView.prototype,"FocusGameView");var FranchisePanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="FranchisePanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(181,this.setView),this.addEventTouchTap(this.btn1,this.onTap),this.redPoint.visible=!1,this.feng.visible?(this.btn1.visible=!1,this.first&&(this.first.visible=!1)):(payControl.franchise>0?(TimerMgr.ins().doTimer(1e3,0,this.setTimeLbel,this),this.setTimeLbel(),this.btn1.visible=!0,this.setView()):(this.btn1.visible=!0,TimerMgr.ins().remove(this.setTimeLbel,this),this.first&&(this.first.visible=payControl.firstBuy?!0:!1)),this.leftTime.visible=payControl.franchise>0?!0:!1),this.setIconEff(),this.depictLabel.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().FranchiseConfig.rightDesc),this.first.text=LangMgr.getValueByKey("pfTips1",DataCenter.ins().MonthCardConfig.privilegeMoneyc),this.descCard.text=DataCenter.ins().MonthCardConfig.vipcardrecharge},e.prototype.setView=function(){payControl.franchiseget?(this.btn1.currentState="up",this.btn1.touchEnabled=!0,this.btn1.label=LangMgr.getValueByKey("tongGetGift"),this.redPoint.visible=!0):(this.btn1.label=LangMgr.getValueByKey("activitAlreadingGet"),this.btn1.currentState="disabled",this.btn1.touchEnabled=!1,this.redPoint.visible=!1),this.first&&(this.first.visible=!1)},e.prototype.setTimeLbel=function(){var t=payControl.franchise,e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,1);e=LangMgr.getValueByKey("expHaveTime1",e),this.leftTime.textFlow=(new egret.HtmlTextParser).parser(e)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this.btn1,this.onTap),TimerMgr.ins().remove(this.setTimeLbel,this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.btn1:this.btn1.label!=LangMgr.getValueByKey("tongGetGift")?payControl.showReCharge(1001):payControl.upGetFranchise()}},e.prototype.setIconEff=function(){var t=DataCenter.ins().TitleConfig[17];if(t){t.eff?(this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.titleMcGroup.addChild(this.mc),this.mc.playFile(PATH_EFF+"chenghaozztq_big",-1)):(this.titleImg||(this.titleImg=new eui.Image),this.titleImg.parent||this.titleMcGroup.addChild(this.titleImg),this.titleImg.source=t.img);var e=0;e=3*BackpackControl.getAttrPower(t.attrs),this.powerPanel.setPower(e)}},e}(BasePanel);__reflect(FranchisePanel.prototype,"FranchisePanel");var InviteFriendsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="InviteFriendsViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];SDKManager.ins().SDKShowShare(),this.updateInfo(),TimerMgr.ins().doTimer(1e3,0,this.updateInfo,this),this.addCustomEvent(479,this.updateInfo),this.addEventTouchTap(this.closeBtn1,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateInfo,this),this.removeEventTouchTap(this.closeBtn1,this.onTap),this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()
},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn1:case this.closeBtn:case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateInfo=function(){if(platformAmuseControl.wxInviteCount>=3)return void UIMgr.ins().close(this);var t=3;this.count.text="("+platformAmuseControl.wxInviteCount+"/"+t+")";var e=DataCenter.ins().SDKConfig.shareReward,i=e[0];if(0==i.type)this.icon.source=Currency.getCurrencyRes(i.id);else{var n=DataCenter.ins().ItemConfig[i.id];n&&(this.icon.source=n.icon+"_png")}if(this.item.source=this.icon.source,this.ybCountTxt.text=""+i.count,platformAmuseControl.wxInviteCount){var o=DateUtils.formatMiniDateTime(platformAmuseControl.inviteTime)-GameServer.serverTime;this.time.text=o>0?LangMgr.getValueByKey("pfTips3",DateUtils.getFormatBySecond(o/1e3)):""}else this.time.text=""},e}(BaseEuiView);__reflect(InviteFriendsView.prototype,"InviteFriendsView");var MonthCardView=function(t){function e(){var e=t.call(this)||this;return e.payId=1e3,e.skinName="MonthCardViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(447,this.changeMonthCard),this.addEventTouchTap(this.btn1,this.onTap),this.first.text=LangMgr.getValueByKey("pfTips1",DataCenter.ins().MonthCardConfig.monthCardMoneyc),this.descCard.text=DataCenter.ins().MonthCardConfig.cardrecharge,this.btn1.label=LangMgr.getValueByKey("activitNumBuy",DataCenter.ins().PayInfoConfig[this.payId].cash),this.leftTime.visible=!1,this.feng.visible?this.btn1.visible=!1:this.changeMonthCard()},e.prototype.changeMonthCard=function(){payControl.monthDay>0?(this.leftTime.visible=!0,TimerMgr.ins().doTimer(1e3,0,this.setTimeLbel,this),this.setTimeLbel(),this.btn1.visible=!1):(this.btn1.visible=!0,TimerMgr.ins().remove(this.setTimeLbel,this)),this.setView()},e.prototype.setView=function(){this.first.visible=!ServerStorage.ins().getValue(12)},e.prototype.setTimeLbel=function(){var t=payControl.monthDay,e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,1);e=LangMgr.getValueByKey("expHaveTime1",e),this.leftTime.textFlow=(new egret.HtmlTextParser).parser(e)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this.btn1,this.onTap),TimerMgr.ins().remove(this.setTimeLbel,this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.btn1:payControl.showReCharge(this.payId)}},e}(BasePanel);__reflect(MonthCardView.prototype,"MonthCardView");var AmusementType102DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Record=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.Record=t[0]},e.prototype.binary=function(t,e){for(var i=[],n=[],o=0;t>0;)i.push(t%2),t=parseInt(t/2+""),o++;for(var s=o-1;s>=0;s--)n.push(i[s]);if(e)for(var r=n.length;e>r;r++)n.unshift(0);return n},e.prototype.getRecordInfo=function(){return this.binary(this.Record,2)},e.prototype.isOpenActivity=function(){var t=this.getRecordInfo();return t.some(function(t,e){return 0==t})},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){return!1},e}(AmusementBaseDataVo);__reflect(AmusementType102DataVo.prototype,"AmusementType102DataVo");var SealPveFightView=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e.skinName="SealPveFightViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(370,this.setTime),this._leftTime=copyControl.curFbLeftTime,this.updateView()},e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.updateView=function(){this.updateLeftTime(),this.validateNow();var t=SealPveControl.ins().getPveConfig();t&&(this.teamFbName.source=t.nameImg)},e.prototype.setTime=function(t){this._leftTime=t[1],TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(1e3,0,this.updateLeftTime,this),this.updateLeftTime()},e.prototype.updateLeftTime=function(){this._leftTime>0?this._leftTime-=1:this._leftTime<=0&&(TimerMgr.ins().remove(this.updateLeftTime,this),this._leftTime=0),this.leftTimeTxt.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_10)},e}(BaseEuiView);__reflect(SealPveFightView.prototype,"SealPveFightView");var SealPveRankView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SealPveRankViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchEnd(this.bgClose,this.onTap),this.addCustomEvent(703,this.updateView),this.rankList.itemRenderer=SealPveRankItemRender,this.rankList.dataProvider=new eui.ArrayCollection([]),SealPveControl.ins().upBoardReq()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateView=function(){var t=SealPveControl.ins().boardList;this.rankList.itemRenderer=SealPveRankItemRender,this.rankList.dataProvider=new eui.ArrayCollection(t),this.norankLable.visible=0==t.length},e}(BaseEuiView);__reflect(SealPveRankView.prototype,"SealPveRankView");var SealPveResultView=function(t){function e(){var e=t.call(this)||this;return e.isNextGuan=!1,e.winResult=0,e.repeatTimes=5,e.skinName="SealPveResultViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.list0.itemRenderer=ResultFailItemRenderer,this.listCoin.itemRenderer=ResultCoinItemRenderer,this.listEmblem.itemRenderer=ItemBase;var e=SealPveControl.ins().getPveActivityId(),i=DataCenter.ins().Amusement8Config[e],n=CommonUtils.getObjectLength(i),o=SealPveControl.ins().getPveDoneIndex();o>=n&&DisplayUtils.removeFromParent(this.rewardBtn)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1],o=t[2],s=t[3],r=SealPveControl.ins().getPveActivityId();r&&amusementControl.upChangePage(r),this._fbType=resultControl.fbType,this.winResult=i,this.bg.source=i?"resultWin_png":"resultLost_png",this.closeBtn.name=LangMgr.getValueByKey("tongExit1"),this.title.source=i?"win_02":"lost_02",i||DisplayUtils.removeFromParent(this.rewardBtn),DieGuide.ins().dispatchdieGuide(i),this.ext=this.repeatTimes=5,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this),o&&(this.txt.text=o),this.txt.visible=0!=i,this.defeat.visible=0==i,this.succes.visible=0!=i,this.addEventTouchEnd(this.closeBtn,this.onTap),this.addEventTouchEnd(this.rewardBtn,this.onTap);for(var a=[],l=[],h=[],u=[],p=[],c=[],d=0;d<n.length;d++){var g=DataCenter.ins().ItemConfig[n[d].id],m=ItemUtils.getType(g);if(1!=m)0==n[d].type?u.push(n[d]):6==m?c.push(n[d]):c.push(n[d]);else if(l.length){for(var f=!1,v=0;v<l.length;v++)if(l[v].id==n[d].id){l[v].count+=n[d].count,f=!0;break}f||l.push(n[d])}else l.push(n[d])}this.scrollerGroup.height=324,this.labelItem.text=LangMgr.getValueByKey("tongGetProp"),this.labelEmblem.height=p.length>0?20:0,this.labelItem.height=20,this.labelEmblem.visible=p.length>0,this.labelItem.visible=!0,u.sort(this.RuleSort),CommonFun.sortAwards(c),this.listCoin.dataProvider=new eui.ArrayCollection(u),this.listEmblem.dataProvider=new eui.ArrayCollection(p),h=a.concat(u,l,c),this.listItem.dataProvider=new eui.ArrayCollection(h),0==i&&this.updateDefeatList(),this.endLable.visible=!!s,s&&(this.defeat.visible=!1)},e.prototype.close=function(){TimerMgr.ins().remove(this.updateCloseBtnLabel,this),this.isNextGuan||CopyControl.ins().upExitFb()},e.prototype.updateCloseBtnLabel=function(){this.ext--,this.ext<=0&&UIMgr.ins().close(this),this.closeBtn.label=this.closeBtn.name+"("+this.ext+"ext)"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.rewardBtn:this.isNextGuan=!0,SealPveControl.ins().challengeNextGuan(),UIMgr.ins().close(this)}},e.prototype.RuleSort=function(t,e){return t.id<e.id?-1:1},e.prototype.updateDefeatList=function(){var t=DieGuide.ins().getDiedGainWay();this.listData0.source=t,this.list0.dataProvider=this.listData0},e}(BaseEuiView);__reflect(SealPveResultView.prototype,"SealPveResultView");var SealPveView=function(t){function e(){var i=t.call(this)||this;i.selectedIndex=0,i.listObjs=[],i.lineRes=[],i.activityId=0,i.isTopLevel=!0,i.selectedIndex=0,i.listObjs=[],i.skinName="SealPveViewSkin",i.canVis=!0,i.lineRes=[];for(var n=1;9>=n;n++)i.lineRes[n]=i["lineImg"+n].source;return i.itemList2.itemRenderer=ItemBase,i.itemList.itemRenderer=ItemBase,i.activityId=SealPveControl.ins().getPveActivityId(),i.configs=DataCenter.ins().Amusement8Config[i.activityId],e.maxLen=Object.keys(i.configs).length,i.itemList2.dataProvider=new eui.ArrayCollection(i.configs[e.maxLen].rewards),i}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.closeBtn,this.onTap),this.addEventTouchEnd(this.challengeBtn,this.onTap),this.addEventTouchEnd(this.rankBtn,this.onTap),this.addEventTouchEnd(this.helpBtn,this.onTap);for(var i=1;10>=i;i++){var n=this["item"+i];n.index=i,this.addEventTouchEnd(n,this.onChoose)}this.actData=amusementControl.getAmusementDataById(this.activityId),this.addCustomEvent(437,this.updateView),this.updatePveList(),TimerMgr.ins().remove(this.updateLeftTime,this),TimerMgr.ins().doTimer(1e3,0,this.updateLeftTime,this),this.updateLeftTime()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this)},e.prototype.updateView=function(){this.activityId?(this.updateLeftTime(),this.updatePveList(),TimerMgr.ins().remove(this.updateLeftTime,this),TimerMgr.ins().doTimer(1e3,0,this.updateLeftTime,this)):UIMgr.ins().close(this)},e.prototype.updateLeftTime=function(){var t=(DateUtils.formatMiniDateTime(this.actData.endTime)-GameServer.serverTime)/1e3>>0,e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3);return""==e?(TimerMgr.ins().remove(this.updateLeftTime,this),void(this.deadlineLable.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("wyfengyindjs1")))):void(this.deadlineLable.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("wyfengyindjs2",e)))},e.prototype.updatePveList=function(){var t=SealPveControl.ins().getPveDoneIndex();-1==t?(this.selectedIndex=1,t=e.maxLen+1):this.selectedIndex=t,this.listObjs=[];var i=1;for(var n in this.configs)this.listObjs.push(this.type8Config2ItemModel(this.configs[n],t,t>i)),i++;this.upList(this.listObjs),this.updateAward(),this.upateChallengeState(),this.oldItem||(this.oldItem=this["item"+t],this.oldItem||(this.oldItem=this["item"+e.maxLen]),this.oldItem.setSelect(!0),this.updateList(t>e.maxLen?e.maxLen:t));var o=StageUtils.ins().getHeight()-595,s=this.listScroller.viewport.height-o,r=this.oldItem.y>o?this.oldItem.y-o:0,a=r>s?s:r;this.listScroller.viewport.scrollV=a},e.prototype.upList=function(t){for(var i=0;i<e.maxLen;i++){var n=this["item"+(i+1)];if(t[i]){n.setData(t[i]);var o=this["lineImg"+(i+1)];o&&(o.source=this.lineRes[i+1]+(t[i].doneIndex>i+1?"":"b"))}}},e.prototype.updateList=function(t){this.selectedIndex!=t&&(this.selectedIndex=t,this.updateAward(),this.upateChallengeState())},e.prototype.type8Config2ItemModel=function(t,e,i){return{config:t,doneIndex:e,isKill:i}},e.prototype.onChoose=function(t){this.oldItem&&this.oldItem.setSelect(!1);var e=t.currentTarget;this.oldItem=e,e.setSelect(!0),this.updateList(e.index)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.helpBtn:HelpControl.openHelpWin(210);break;case this.rankBtn:UIMgr.ins().open(SealPveRankView);break;case this.challengeBtn:if(!CommonFun.checkBackpackCount())return;if(CopyControl.ins().checkInFB())return;UIMgr.ins().close(this),this.goToChallenge()}},e.prototype.updateAward=function(){this.configs[this.selectedIndex]&&(this.itemList.dataProvider=new eui.ArrayCollection(this.configs[this.selectedIndex].rewards))},e.prototype.upateChallengeState=function(){this.challengeBtn.visible=SealPveControl.ins().isHaveNextGuan(),this.finishLable.visible=!this.challengeBtn.visible;var t=SealPveControl.ins().getPveDoneIndex();-1==t&&(t=1),this.challengeBtn.currentState=this.selectedIndex!=t?"disabled":"up",this.challengeBtn.touchEnabled=this.selectedIndex==t},e.prototype.goToChallenge=function(){SealPveControl.ins().challengeNextGuan()},e.prototype.openCheck=function(){var t=SealPveControl.ins().getPveActivityId();return t?!0:(tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")),!1)},e.maxLen=0,e}(BaseEuiView);__reflect(SealPveView.prototype,"SealPveView");var SealPveItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="SealPveItemSkin",e.touchChildren=!1,e}return __extends(e,t),e.prototype.setSelect=function(t){this.selectImg.visible=t},e.prototype.setData=function(t){this.pveData=t,this.nameLable.text=this.pveData.config.levelName,this.bodyMc=this.bodyMc||ObjectPool.pop("GameMovieClip"),this.bodyMc.playFile(PATH_GUAIWU+this.pveData.config.monsterShow,-1),this.bossGroup.addChild(this.bodyMc),this.bodyMc.addEventListener(egret.Event.CHANGE,this.onLoad,this),this.isChangeed.visible=!!this.pveData.isKill,this.index==SealPveView.maxLen&&(this.currentState="ten"),this.bossGroup.scaleX=this.bossGroup.scaleY=this.pveData.config.monsterScale/100,this.levelImg.source=this.pveData.config.levelImg,this.setSelect(!1)},e.prototype.onLoad=function(){this.bodyMc.removeEventListener(egret.Event.CHANGE,this.onLoad,this),this.pveData.isKill&&(this.bodyMc.stop(),this.bossGroup.filters=[FilterUtils.grayFilter1])},e}(BaseItemRender);__reflect(SealPveItemRender.prototype,"SealPveItemRender");var SealPveRankItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;0==t.index?(this.t3.source="rankcolor_1",this.rankbg.source="paihang1",this.rankLable.visible=!1,this.rankbg.visible=!0):1==t.index?(this.t3.source="rankcolor_2",this.rankbg.source="paihang2",this.rankLable.visible=!1,this.rankbg.visible=!0):2==t.index?(this.t3.source="rankcolor_3",this.rankbg.source="paihang3",this.rankLable.visible=!1,this.rankbg.visible=!0):(this.t3.source="bantoutiaobg",this.rankLable.visible=!0,this.rankLable.text=t.index+1+"",this.rankbg.visible=!1),this.vipimg.visible=t.vip>0,this.nameLable.text=t.name,this.powerLabel0.text=""+t.power},e}(BaseItemRender);__reflect(SealPveRankItemRender.prototype,"SealPveRankItemRender");var SeckillGiftAmuseView=function(t){function e(){var e=t.call(this)||this;return e.levelConfLst=[],e.sendToGetAward=!1,e.skinName="SeckillGiftAmuseViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.iconList.itemRenderer=SeckillGiftBtnItemRender,this.addEventTouchTap(this.originalBuyBtn,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.packBuyBtn,this.onTap),this.addEventChange(this.iconList,this.onClickMenu),this.addCustomEvent(392,this.initView),this.actIndex=0,this.initView(),this.disBigEffAni(),this.iconY=this.giftBigImg.y,this.iconMoveY=this.iconY-10,this.playIconTween()},e.prototype.playIconTween=function(){this.giftBigImg.y=this.iconY,egret.Tween.removeTweens(this.giftBigImg),egret.Tween.get(this.giftBigImg,{loop:!0}).to({y:this.iconMoveY},1e3).to({y:this.iconY},1e3)},e.prototype.disBigEffAni=function(){this.bigEffmc||(this.bigEffmc=new GameMovieClip,this.bigEff.addChild(this.bigEffmc),this.bigEffmc.playFile(PATH_EFF+"boxeff",-1))},e.prototype.close=function(){this.mc&&(DisplayUtils.removeFromParent(this.mc),this.mc=null),egret.Tween.removeTweens(this.giftBigImg)},e.prototype.getActId=function(){var t=AmusementControl.ins().activityData;for(var e in t){var i=t[e];109==i.pageType&&i.isOpenActivity()&&!i.getHide()&&(this.activityID=i.id)}},e.prototype.initView=function(){if(this.getActId(),!this.activityID)return void UIMgr.ins().close(this);this.sendToGetAward=!1,this.specialBuyConfig=null;var t=DataCenter.ins().Amusement26Config[this.activityID];AmusementControl.ins().getAmusementDataById(this.activityID);this.levelConfLst=[];for(var e in t){var i=t[e];i.pack?this.specialBuyConfig=i:this.levelConfLst.push(i)}this.iconList.dataProvider=new eui.ArrayCollection(this.levelConfLst),this.updatePageView(),this.updataSpecialBuyBtnFun()},e.prototype.updatePageView=function(){var t=this.levelConfLst[this.actIndex];this.currentState="num"+t.reward.length;for(var e=0;e<t.reward.length;e++)this["item"+e].data=t.reward[e],this["item"+e].alpha=0,egret.Tween.get(this["item"+e]).wait(100*e).to({alpha:1},100);var i=DataCenter.ins().PayInfoConfig[t.rechargeId];this.originalLabel.text=LangMgr.getValueByKey("primecost")+LangMgr.getValueByKey("dollar",t.originalPrice),this.giftBigImg.source=t.giftBigImg,this.zekouLabel.text=LangMgr.getValueByKey("chinese"+t.rebate),this.descLab.text=t.itemDesc,this.tipsImg.source=t.giftTipsImg;var n=AmusementControl.ins().getAmusementDataById(this.activityID),o=n.getShopData(t.index);this.redPoint0.visible=!1,0==o.buyCount?(this.oneBuyBtnGroup.visible=!0,this.originalBuyBtn.label=GlobalModel.currentType+LangMgr.getValueByKey(GlobalModel.isHw?"nmiaoshaBuy":"nYunmiaoshaBuy",i.cash)):o.buyCount>0&&o.canGet?(this.oneBuyBtnGroup.visible=!0,this.redPoint0.visible=!0,this.originalBuyBtn.label=LangMgr.getValueByKey("activitGet1")):o.buyCount>0&&!o.canGet&&(this.oneBuyBtnGroup.visible=!1)},e.prototype.updataSpecialBuyBtnFun=function(){var t=(DataCenter.ins().Amusement26Config[this.activityID],AmusementControl.ins().getAmusementDataById(this.activityID)),e=this.specialBuyConfig.pack,i=DataCenter.ins().PayInfoConfig[this.specialBuyConfig.rechargeId];this.packBuyBtn.label=GlobalModel.currentType+LangMgr.getValueByKey(GlobalModel.isHw?"ndabaoBuy":"nYunBuy",i.cash);var n=t.getShopData(this.specialBuyConfig.index);n.buyCount>0&&(this.packBuyBtn.label=LangMgr.getValueByKey("fdAlreadingBuy"));for(var o=0,s=0,r=e;s<r.length;s++)for(var a=r[s],l=0,h=this.levelConfLst;l<h.length;l++){var u=h[l];if(a==u.index){var p=t.getShopData(u.index),c=DataCenter.ins().PayInfoConfig[u.rechargeId];0==p.buyCount&&(o+=c.cash*u.buyCount)}}this.packBuyBtn.enabled=i.cash<o&&n.buyCount<=0,this.packBuyBtn.enabled?(this.packBuyBtn.filters=null,this.mc||(this.mc=new GameMovieClip,this.btnEffGrop.addChild(this.mc),this.mc.playFile(PATH_EFF+"chargeff1",-1),this.mc.scaleX=.8,this.mc.scaleY=.9)):(this.packBuyBtn.filters=[FilterUtils.grayFilter1],this.mc&&(DisplayUtils.removeFromParent(this.mc),this.mc=null))},e.prototype.onClickMenu=function(t){this.actIndex!=t.currentTarget.selectedIndex&&(this.actIndex=t.currentTarget.selectedIndex,this.updatePageView())},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.packBuyBtn:payControl.showReCharge(this.specialBuyConfig.rechargeId);break;case this.originalBuyBtn:if(this.sendToGetAward)return;var e=this.levelConfLst[this.actIndex],i=AmusementControl.ins().getAmusementDataById(this.activityID),n=i.getShopData(e.index);if(n.canGet){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);amusementControl.upReward(this.activityID,e.index),this.sendToGetAward=!0}else payControl.showReCharge(e.rechargeId)}},e}(BaseEuiView);__reflect(SeckillGiftAmuseView.prototype,"SeckillGiftAmuseView");var SeckillGiftBtnItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=AmusementControl.ins().getAmusementDataById(this.data.id),e=t.getShopData(this.data.index);this.redPoint.visible=e.canGet,this.iconDisplay.source=this.data.giftBtn},e}(AmusementBtnItemRender);__reflect(SeckillGiftBtnItemRender.prototype,"SeckillGiftBtnItemRender");var SeckillGiftRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="SeckillGiftRewardItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.itemIco.data=this.data},e}(BaseItemRender);__reflect(SeckillGiftRewardItemRender.prototype,"SeckillGiftRewardItemRender");var SpokesPersonBossSysControl=function(t){function e(){var e=t.call(this)||this;return e.obj={},e.addCustomEvent(375,e.bossResult),e.addCustomEvent(353,e.changeScene),e.addCustomEvent(354,e.showtalk),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"inCopy",{get:function(){return 77==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.showtalk=function(t){t.isMy&&this.roletalk(this.talktype)},e.prototype.bossResult=function(t){var e=t.fbType,i=t.result;77==e&&(i?this.roletalk("suctext"):this.roletalk("failtext"))},e.prototype.roletalk=function(t){if(this.lastFb){var e=t?"entertext"==t?null:this.exitScene:null;this.runAction13(t,e)}},e.prototype.changeScene=function(){this.inCopy?(this.lastFb=!0,UIMgr.ins().close(BossBloodView),this.roletalk("entertext")):this.lastFb&&(this.lastFb=!1,this.obj={})},e.prototype.exitScene=function(){copyControl.upExitFb()},e.prototype.runAction13=function(t,e){t!=this.talktype&&(TimerMgr.ins().removeAll(this),this.talktype=t);var i=DataCenter.ins().SpokesPersonTaskListConfig[spokesPersonTaskControl.curidx],n=i[t];if(!n)return void(e&&e());this.obj[t]||(this.obj[t]=[]);for(var o=function(i){var n=1==i.target?UnitMgr.ins().getMainRole(0):UnitMgr.ins().getEntityByMonsterId(i.target)[0];if(n&&s.obj[t].indexOf(n)<0){s.obj[t].push(n);for(var o=0,r=function(t){TimerMgr.ins().doTimer(o,1,function(){n.addTalk(t.text,t.time)},n),o+=t.time},a=0;a<i.talk.length;a++){var l=i.talk[a];r(l)}e&&TimerMgr.ins().doTimer(o,1,function(){e()},s)}},s=this,r=0;r<n.length;r++){var a=n[r];o(a)}},e}(BaseSystem);__reflect(SpokesPersonBossSysControl.prototype,"SpokesPersonBossSysControl");var SpokesPersonControl=function(t){function e(){var e=t.call(this)||this;return e.BOSS_READY_TIME=5,e.addCustomEvent(466,e.onInitServerTime),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkSysOpen=function(){for(var t in SpokesmanActID){var e=SpokesmanActID[t];if("number"==typeof e&&this.checkOpen(+e)&&!this.checkClose(+e))return!0}return!1},e.prototype.checkOpen=function(t,e){void 0===e&&(e=!1);var i=!1,n=DataCenter.ins().SpokesPersonOpenConfig[t];if(!n||!n.open)return i;switch(t){case SpokesmanActID.achiTask:i=spokesPersonAchiTaskControl.checkOpen(e);break;case SpokesmanActID.turnTable:i=spokesPersonTurntableControl.checkOpen(e);break;case SpokesmanActID.doubleExp:return spokesPersonDoubleExpControl.checkOpen(e);case SpokesmanActID.boss:return this.checkOpenBoss(e);case SpokesmanActID.backBuy:return this.checkOpenBackBuy(e);case SpokesmanActID.wholetask:return spokesPersonTaskControl.checkOpen(e)}return i},e.prototype.checkSerOpenAct=function(t){var e=!1;switch(t){case SpokesmanActID.achiTask:e=spokesPersonAchiTaskControl.checkSerOpen();break;case SpokesmanActID.turnTable:e=spokesPersonTurntableControl.checkSerOpen();break;case SpokesmanActID.doubleExp:return spokesPersonDoubleExpControl.checkSerOpen();case SpokesmanActID.boss:return this.checkOpenBoss();case SpokesmanActID.backBuy:return this.checkOpenBackBuy();case SpokesmanActID.wholetask:return spokesPersonTaskControl.checkSerOpen()}return e},e.prototype.checkBaseOpen=function(t,e){return void 0===e&&(e=!1),t&&CommonFun.checkLevel(t.level||0,e)?this.checkSerOpen(t):!1},e.prototype.checkSerOpen=function(t){if(void 0==GameServer._serverZeroTime)return!1;if(void 0!=t._servOpenState)return t._servOpenState;var e=function(e){return t._servOpenState=e,e},i=GlobalModel.pf;if(!t.pfIdOpenLimit&&!t.pfIdLimit)return e(!0);if(!t.openTimeLt&&!t.openTimeGt)return e(!0);var n,o,s,r=GlobalModel.srvid;if(t.pfIdOpenLimit?(s=t.pfIdOpenLimit[""+i],s&&this.isInSection(r,s)&&(n=!0)):n=!0,o=!0,t.pfIdLimit&&(s=t.pfIdLimit[""+i],s&&this.isInSection(r,s)&&(o=!1)),n&&o)return e(!0);n=o=!0;var a=0;if(t.openTimeLt)if(s=t.openTimeLt[""+i]){var l=this.getDateTime(s);a=DateUtils.formatMiniDateTime(GameServer._serverZeroTime),a>l&&(n=!1)}else n=!1;if(t.openTimeGt)if(s=t.openTimeGt[""+i]){var l=this.getDateTime(s);a=a?a:DateUtils.formatMiniDateTime(GameServer._serverZeroTime),l>a&&(o=!1)}else o=!1;return e(n&&o)},e.prototype.getDateTime=function(t){var e=t.split(/[-.:]/g),i=new Date(+e[0],+e[1]-1,+e[2],+e[3]||0,+e[4]||0);return i.getTime()},e.prototype.isInSection=function(t,e){var i=e.split(",");if(i)for(var n=i.length,o=0;n>o;o++){var s=i[o].split("-");if(s){if(1==s.length&&t==Number(s[0]))return!0;if(s.length>=2&&t>=Number(s[0])&&t<=Number(s[1]))return!0}}return!1},e.prototype.checkClose=function(t){var e=!1;switch(t){case SpokesmanActID.achiTask:e=spokesPersonAchiTaskControl.checkClose()}return e},e.prototype.checkRedPoint=function(t){var e=!1;switch(t){case SpokesmanActID.achiTask:e=SpokesPersonRedPoint.ins().achiTaskTed;break;case SpokesmanActID.turnTable:e=SpokesPersonRedPoint.ins().turnRed;break;case SpokesmanActID.doubleExp:return SpokesPersonRedPoint.ins().buffExpRed;case SpokesmanActID.boss:return this.isSpokesBoss(toseongControl.cityBossId);case SpokesmanActID.backBuy:var i=this.getBackBuyActData();if(i)return i.checkRedPoint();break;case SpokesmanActID.wholetask:e=SpokesPersonRedPoint.ins().WholeHourTaskRed}return e},e.prototype.onInitServerTime=function(){if(spokesPersonControl.checkNpcOpen()){var t=spokesPersonControl.getNpcs();if(t)for(var e=0;e<t.length;e++)UnitMgr.ins().getNpcByConfigID(t[e])||UnitMgr.ins().createNpc(t[e])}},e.prototype.checkNpcOpen=function(){return this.checkBaseOpen(DataCenter.ins().NpcTinyConfig)},e.prototype.getNpcs=function(){return DataCenter.ins().NpcTinyConfig.npc?DataCenter.ins().NpcTinyConfig.npc[MapControl.mapID]:null},e.prototype.checkOpenBackBuy=function(t){return this.getBackBuyActData()?!0:(t&&tipsControl.showTips(LangMgr.getValueByKey("activtyOnOpenOrEnd")),!1)},e.prototype.checkOpenBoss=function(t){return this.getBackBuyActData()&&DataCenter.ins().ToseongBaseConfig.opensrvbossid[GameServer.serverOpenDay+1]?!0:(t&&tipsControl.showTips(LangMgr.getValueByKey("activtyOnOpenOrEnd")),!1)},e.prototype.getBackBuyActData=function(){var t=DataCenter.ins().SpokesPersonOpenConfig[SpokesmanActID.backBuy];if(t.data&&t.data.actIds)for(var e=t.data.actIds,i=0;i<e.length;i++){var n=e[i],o=amusementControl.getAmusementDataById(n);if(o)return o}return null},e.prototype.isSpokesBoss=function(t){var e=DataCenter.ins().SpokesPersonOpenConfig[SpokesmanActID.boss];if(e.data&&e.data.bossIdx)for(var i=e.data.bossIdx,n=0;n<i.length;n++){var o=i[n],s=DataCenter.ins().ToseongBossConfig[o];if(s.bossId==t)return!0}return!1},e.prototype.getCurSpokesBossConfig=function(){var t=DataCenter.ins().ToseongBaseConfig.opensrvbossid[GameServer.serverOpenDay+1];if(t)for(var e in DataCenter.ins().ToseongBossConfig){var i=DataCenter.ins().ToseongBossConfig[e];if(i.killBossId==t)return i}return null},e.prototype.getNextBossDate=function(){var t=DataCenter.ins().ToseongBaseConfig.opensrvtime,e=new Date(GameServer.serverTime),i=DateUtils.formatMiniDateTime(GameServer._serverZeroTime);for(var n in DataCenter.ins().ToseongBaseConfig.opensrvbossid){var o=new Date(i);o.setDate(o.getDate()+(+n-1));for(var s=t.h,r=0;r<s.length;r++){var a=s[r];if(o.setHours(+a,+t.m),e.getTime()<=o.getTime())return o}}return null},e.prototype.checkReadyBoss=function(){if(this.checkOpenBoss()){var t=this.getNextBossDate();if(t){var e=this.BOSS_READY_TIME*DateUtils.MS_PER_MINUTE,i=t.getTime()-GameServer.serverTime;i>e&&TimerMgr.ins().once(i+1e3-e,this.dispatchReminBoss,this)}}},e.prototype.dispatchReminBoss=function(){EventMgr.ins().dispatch(694)},e}(BaseSystem);__reflect(SpokesPersonControl.prototype,"SpokesPersonControl");var SpokesmanActID=function(){function t(){}return t.achiTask=1,t.turnTable=2,t.doubleExp=3,t.boss=4,t.backBuy=5,t.wholetask=7,t}();__reflect(SpokesmanActID.prototype,"SpokesmanActID");var AmusementType103DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Record=[],e.times=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.Record=[];for(var e=0;e<t[0].length;e++){var i=t[0][e][0],n=t[0][e][1];this.Record.push({idx:i,exCount:n})}},e.prototype.getUseTimes=function(t){var e=this.Record.filter(function(e){return e.idx==t});return e.length>0?e[0].exCount:0},e.prototype.isOpenActivity=function(){return!0},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){return!1},e}(AmusementBaseDataVo);__reflect(AmusementType103DataVo.prototype,"AmusementType103DataVo");var SpokesPersonAchiTaskControl=function(t){function e(){var e=t.call(this)||this;return e.taskList={},e.awardIDs=[],e.openState=0,e.addCustomEvent(461,e.onCheckOpen),e.addCustomEvent(112,e.onCheckOpen),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.onCheckOpen=function(){0==this.openState&&this.checkOpen()&&(this.openState=1,this.dispatchState())},e.prototype.onCheckClose=function(){-1!=this.openState&&this.checkClose()&&(this.openState=-1,this.dispatchState())},e.prototype.dispatchState=function(){EventMgr.ins().dispatch(482,this.openState)},e.prototype.checkOpen=function(t){return 1==this.openState?!0:spokesPersonControl.checkBaseOpen(DataCenter.ins().SpokesPersonBaseConfig,t)},e.prototype.checkSerOpen=function(){return 1==this.openState?!0:spokesPersonControl.checkSerOpen(DataCenter.ins().SpokesPersonBaseConfig)},e.prototype.checkClose=function(){if(-1==this.openState)return!0;var t=DataCenter.ins().SpokesPersonLevelRewardsConfig;for(var e in t)if(this.awardIDs.indexOf(t[e].id)<0)return!1;return!0},e.prototype.getBagItem=function(){if(this.checkOpen()&&!this.checkClose()){var t=new ItemData;return t.configID=205612,t.handle=0,t.count=1,t}return null},e.prototype.upGetAward=function(t){return[t]},e.prototype.downLevelInit=function(t,e){this.taskList={};for(var i=0;t.length>i;i++){var n=t[i][0],o=t[i][1];this.taskList[n]=o}this.awardIDs=[];for(var i=0;e.length>i;i++)this.awardIDs.push(e[i]);this.onCheckClose(),EventMgr.ins().dispatch(480)},e.prototype.downLevelPerInfo=function(t,e){this.taskList[t]=e,EventMgr.ins().dispatch(481,t)},e.prototype.checkLevelAwardState=function(t){if(this.awardIDs.indexOf(t)>=0)return 2;for(var e=DataCenter.ins().SpokesPersonLevelRewardsConfig[t],i=e.ids,n=0;n<i.length;n++){var o=i[n],s=DataCenter.ins().SpokesPersonLevelPartConfig[o],r=this.getTaskValue(o);if(s.target>r)return 0}return 1},e.prototype.getTaskValue=function(t){var e=DataCenter.ins().SpokesPersonLevelPartConfig[t],i=this.taskList[t]||0;return void 0!=e.odfinish&&e.odfinish<=GameServer.serverOpenDay||e.zsfinish&&e.zsfinish<=reincarnateControl.lv?i=e.target:1==e.db&&(i=CommonFun.getTargetValue(e.type)),i},e.prototype.checkRed=function(){if(!this.checkOpen())return!1;var t=DataCenter.ins().SpokesPersonLevelRewardsConfig;for(var e in t)if(1==this.checkLevelAwardState(+e))return!0;return!1},__decorate([up(7,[3])],e.prototype,"upGetAward",null),__decorate([down(11,[[3,3],[3]])],e.prototype,"downLevelInit",null),__decorate([down(12,[3,3])],e.prototype,"downLevelPerInfo",null),e=__decorate([protocolsId(9)],e)}(BaseSystem);__reflect(SpokesPersonAchiTaskControl.prototype,"SpokesPersonAchiTaskControl");var SpokesPersonAchiTaskOpenControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(482,e.onUpdateState),e}return __extends(e,t),e.prototype.onUpdateState=function(t){1==t?this.open():-1==t&&this.close()},e.prototype.open=function(){this.addCustomEventMany(this.updateAchiTask,466,461,112,14)},e.prototype.updateAchiTask=function(){SpokesPersonRedPoint.ins().dispatchAchiTask()},e.prototype.close=function(){this.removeCustomEvents()},__decorate([callDelay(1e3)],e.prototype,"updateAchiTask",null),e}(BaseSystem);__reflect(SpokesPersonAchiTaskOpenControl.prototype,"SpokesPersonAchiTaskOpenControl");var SpokesPersonAchievementPanel=function(t){function e(){var e=t.call(this)||this;return e.isMcTween=!1,e.lastAwardState=0,e.skinName="SpokesPersonAchievementPanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.ins=SpokesPersonAchiTaskControl.ins(),this.titleList.itemRenderer=SpokesPersonAchiTabBarItemRender;
var t=[],e=DataCenter.ins().SpokesPersonLevelRewardsConfig;for(var i in e)t.push(e[i]);this.titlePro=new eui.ArrayCollection(t),this.titleList.dataProvider=this.titlePro,this.list.itemRenderer=SpokesPersonAchiTaskItemRender,this.listPro=new eui.ArrayCollection,this.list.dataProvider=this.listPro,this.awardList0.itemRenderer=ItemBase,this.awardPro=new eui.ArrayCollection,this.awardList0.dataProvider=this.awardPro,this.effMc=this.effMc||new GameMovieClip,this.effGroup.addChild(this.effMc),this.effMc.touchEnabled=!0,this.effMc0=this.effMc0||new GameMovieClip,this.effGroup0.addChild(this.effMc0),this.addEventChange(this.titleList,this.onTitleTap),this.addEventChanging(this.titleList,this.onTitleChange),this.addEventTouchTap(this.getBtn,this.onTap),this.addEventTouchTap(this.effMc,this.onTap)},e.prototype.open=function(){this.addCustomEvent(480,this.updateData),this.addCustomEvent(481,this.updateData),this.addCustomEvent(473,this.viewOpen);var t=this.getIndex();this.titleList.selectedIndex=t,t>3&&(this.titleList.scrollH=this.titleList.contentWidth-this.titleList.width),this.setTaskAwardId(this.titlePro.getItemAt(t).id),this.playTalk()},e.prototype.viewOpen=function(t){UIMgr.ins().checkIsTopView(SpokesPersonView)&&this.updateData()},e.prototype.playTalk=function(){var t=DataCenter.ins().SpokesPersonLevelRewardsConfig[this.curId],e=Math.random()*t.npcTalk.length>>0;this.msgTxt0.textFlow=TextUtils.generateTextFlow1(t.npcTalk[e]),this.talkGroup.scaleX=this.talkGroup.scaleY=0,egret.Tween.get(this.talkGroup).to({scaleX:1,scaleY:1},250),TimerMgr.ins().remove(this.playTalk,this),TimerMgr.ins().once(DataCenter.ins().SpokesPersonBaseConfig.talkTweenTime||5e3,this.playTalk,this)},e.prototype.close=function(){this.removeMcTween(),egret.Tween.removeTweens(this.talkGroup),TimerMgr.ins().remove(this.playTalk,this)},e.prototype.getIndex=function(){var t,e=this.titlePro.source;for(t=0;t<e.length;t++)if(2!=this.ins.checkLevelAwardState(e[t].id))return t;return t==e.length&&(t=e.length-1),t},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.getBtn){var i=this.ins.checkLevelAwardState(this.curId);0==i?tipsControl.showTips(LangMgr.getValueByKey("finishAllTaskGet")):1==i&&this.ins.upGetAward(this.curId)}else if(e==this.effMc){var n=DataCenter.ins().SpokesPersonLevelRewardsConfig[this.curId];CommonFun.viewItemTips(n.bigAward.id,n.bigAward.count)}},e.prototype.onTitleTap=function(t){var e=t.currentTarget.selectedIndex,i=this.titlePro.getItemAt(e);i.id!=this.curId&&(this.setTaskAwardId(i.id),this.playTalk(),this.initListV())},e.prototype.initListV=function(){this.list.parent.stopAnimation(),this.list.scrollV=0},e.prototype.onTitleChange=function(t){var e=t.currentTarget.selectedIndex,i=this.titlePro.getItemAt(e);CommonFun.checkLevel(i.lv||0,!0,!0)||t.preventDefault()},e.prototype.updateData=function(){for(var t=this.titlePro.source,e=0;e<t.length;e++)this.titlePro.itemUpdated(t[e]);var i=this.lastAwardState;if(this.setTaskAwardId(this.curId),1==i&&2==this.lastAwardState)for(var e=0;e<this.awardList0.numChildren;e++)CommonFun.flyItemToBag(this.awardList0.getChildAt(e))},e.prototype.setTaskAwardId=function(t){this.curId=t;var e=DataCenter.ins().SpokesPersonLevelRewardsConfig[t];this.awardPro.replaceAll(e.rewards.concat()),this.condition.textFlow=TextUtils.generateTextFlow1(e.bigAwardDesc);var i=this.ins.checkLevelAwardState(t);this.redPoint.visible=1==i,this.lastAwardState=i,2!=i?(this.getBtn.enabled=!0,this.getBtn.label=LangMgr.getValueByKey("activitGet")):(this.getBtn.enabled=!1,this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet")),this.listPro.replaceAll(e.ids.concat()),this.effMc.playFile(PATH_EFF+e.bigAwardRes,-1),this.effMc0.playFile(PATH_EFF+"awardShowEff",-1)},e.prototype.addMcTween=function(){this.effMc&&!this.isMcTween&&(this.isMcTween=!0,egret.Tween.get(this.effMc,{loop:!0}).to({y:-20},1500).to({y:0},1500))},e.prototype.removeMcTween=function(){this.isMcTween=!1,this.effMc&&egret.Tween.removeTweens(this.effMc)},e}(BasePanel);__reflect(SpokesPersonAchievementPanel.prototype,"SpokesPersonAchievementPanel");var SpokesPersonAchiTabBarItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.positionTxt.text=t.title,this.redPoint.visible=1==spokesPersonAchiTaskControl.checkLevelAwardState(t.id)},e}(BaseItemRender);__reflect(SpokesPersonAchiTabBarItemRender.prototype,"SpokesPersonAchiTabBarItemRender");var SpokesPersonAchiTaskItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchTap(this.goBtn,this.onGoTo),this.expBar0.slideDuration=0},e.prototype.onGoTo=function(t){var e=this.data,i=DataCenter.ins().SpokesPersonLevelPartConfig[e],n=i.controlTarget;n&&CommonFun.openWin(n)},e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().SpokesPersonLevelPartConfig[t];this.taskNameTxt.textFlow=TextUtils.generateTextFlow1(e.desc);var i=spokesPersonAchiTaskControl.getTaskValue(t),n=e.target;if(n>i?(this.goBtn.visible=!0,this.done.visible=!1):(this.goBtn.visible=!1,this.done.visible=!0),1==e.db){var o=CommonFun.showTargetValue(e.type,i,n);i=o[0],n=o[1]}else{var o=CommonFun.showTaskValue(e.type,i,n);i=o[0],n=o[1]}this.expBar0.maximum=n,this.expBar0.value=Math.min(i,n)},e}(BaseItemRender);__reflect(SpokesPersonAchiTaskItemRender.prototype,"SpokesPersonAchiTaskItemRender");var SpokesPersonBossPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpokesPersonBossPanelSkin",e.rewardList.itemRenderer=ItemBase,e.bossMc=new GameMovieClip,e.Boss.addChild(e.bossMc),e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.goBtn,this.onTouch),this.initDt(),this.checkTime()},e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.initDt=function(){this.cityBossDp=spokesPersonControl.getCurSpokesBossConfig(),this.actDataFb=spokesPersonControl.getBackBuyActData();var t=DataCenter.ins().MonstersConfig[this.cityBossDp.bossId];this.rewardList.dataProvider=new eui.ArrayCollection(this.cityBossDp.showReward),this.bossMc.playFile(PATH_EFF+(GUAIWU_PREFIX+t.avatar+"_eff"),-1),this.goBtn.enabled=!1;var e=DataCenter.ins().TitleMonsterConfig[t.titleId];if(e.eff?(this.titleMc=this.titleMc||new GameMovieClip,this.titleMc.playFile(PATH_EFF+e.eff,-1),this.titleGroup.addChild(this.titleMc)):e.img&&(this.titleImg=this.titleImg||new eui.Image(e.img),this.titleGroup.addChild(this.titleImg)),spokesPersonControl.isSpokesBoss(toseongControl.cityBossId))this.time.text=t.name+LangMgr.getValueByKey("arlgotoCity"),this.goBtn.enabled=!0;else{var i=spokesPersonControl.getNextBossDate();if(!i)return void(this.time.text=LangMgr.getValueByKey("trialArlEnd"));var n=i.getMonth()+1,o=i.getDate(),s=DateUtils.getFormatBySecond(i.getTime()/1e3,DateUtils.TIME_FORMAT_16);this.time.text=LangMgr.getValueByKey("yearMonthDayDown",t.name,n,o,s)}},e.prototype.onTouch=function(t){t.currentTarget==this.goBtn&&(toseongControl.isToseong?TimerMgr.ins().doNext(function(){var t=UIMgr.ins().getView(BossBelongView);t&&t.attrBoss()},this):toseongControl.enterCity(),UIMgr.ins().close(this))},e.prototype.checkTime=function(){Math.floor((DateUtils.formatMiniDateTime(this.actDataFb.startTime)-GameServer.serverTime)/1e3)>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):(this.leftTime=Math.floor((DateUtils.formatMiniDateTime(this.actDataFb.endTime)-GameServer.serverTime)/1e3),this.leftTime<=0?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):(this.actTime.text=DateUtils.getFormatBySecond(this.leftTime,DateUtils.TIME_FORMAT_5,3),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this)))},e.prototype.onTime=function(){this.actDataFb&&(this.leftTime=this.actDataFb.getLeftTime(),this.actTime.text=DateUtils.getFormatBySecond(this.leftTime,DateUtils.TIME_FORMAT_5,3),this.leftTime<=0&&this.checkTime())},e}(BasePanel);__reflect(SpokesPersonBossPanel.prototype,"SpokesPersonBossPanel");var SpokesPersonDoubleExpControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._endTime=0,e.isFirst=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upGetBuff=function(){},e.prototype.downBuffInfo=function(t,e){this.hasGoted=1==t,this._endTime=e,this._endTime&&(this._endTime=DateUtils.formatMiniDateTime(this._endTime)),!this.hasGoted&&loginControl.isCreateLogin&&this.isFirst&&(this.isFirst=!1,this.upGetBuff()),EventMgr.ins().dispatch(483)},e.prototype.dispatchRedchange=function(){EventMgr.ins().dispatch(484)},e.prototype.checkOpen=function(t){return spokesPersonControl.checkSerOpen(DataCenter.ins().SpokesPersonDyrBaseConfig)},e.prototype.checkSerOpen=function(){return spokesPersonControl.checkSerOpen(DataCenter.ins().SpokesPersonDyrBaseConfig)},e.prototype.checkRed=function(){return this.isFirst&&!this.hasGoted},e.prototype.getLeftTime=function(){return this._endTime?Math.max(Math.floor((this._endTime-GameServer.serverTime)/1e3),0):0},__decorate([up(27)],e.prototype,"upGetBuff",null),__decorate([down(27,[4,3])],e.prototype,"downBuffInfo",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(SpokesPersonDoubleExpControl.prototype,"SpokesPersonDoubleExpControl");var SpokesPersonDoubleExpPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpokesPersonDoubleExpPanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.awrdList.itemRenderer=ItemBase,this.awrdList.dataProvider=new eui.ArrayCollection(DataCenter.ins().SpokesPersonDyrBaseConfig.dailyRewards.concat())},e.prototype.open=function(){this.addCustomEvent(483,this.update),this.addEventTouchTap(this.getBtn,this.onAward),this.update(),spokesPersonDoubleExpControl.isFirst&&(spokesPersonDoubleExpControl.isFirst=!1,spokesPersonDoubleExpControl.dispatchRedchange())},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this.getBtn,this.onAward)},e.prototype.update=function(){var t=!spokesPersonDoubleExpControl.hasGoted;this.redImg.visible=t,this.getBtn.label=t?LangMgr.getValueByKey("getDoubleExp"):LangMgr.getValueByKey("todayArlGet"),this.getBtn.enabled=t},e.prototype.onAward=function(){spokesPersonDoubleExpControl.upGetBuff()},e}(BasePanel);__reflect(SpokesPersonDoubleExpPanel.prototype,"SpokesPersonDoubleExpPanel");var SpokesPersonEqiupRecyclePanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpokesPersonEqiupRecyclePanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this._activityData=spokesPersonControl.getBackBuyActData(),this._activityData&&(this.activityID=this._activityData.id,this.actInfo0.text=DataCenter.ins().AmusementConfig[this.activityID].desc,this.content.itemRenderer=LastEighthChangeItemRender)},e.prototype.open=function(){this.addCustomEvent(266,this.updateList),this.addCustomEvent(267,this.updateList),this.addCustomEvent(392,this.updateList),this.updateData()},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().remove(this.onTime,this),this._leftTime=0},e.prototype.updateData=function(){this.checkTime(),this.updateList()},e.prototype.updateList=function(){var t=[],e=DataCenter.ins().Amusement7Config[this.activityID];for(var i in e){var n=this._activityData.getExchange(e[i].index);t.push({config:e[i],state:n})}t.sort(this.sort),this._dataCollect||(this._dataCollect=new ArrayCollection,this.content.dataProvider=this._dataCollect),this._dataCollect.replaceAll(t)},e.prototype.sort=function(t,e){return t.config.index<e.config.index?-1:1},e.prototype.checkTime=function(){this._leftTime=0,Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3)>=0?this.actTime0.text=LangMgr.getValueByKey("doubleNoActivity"):(this._leftTime=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3),this._leftTime<=0?this.actTime0.text=LangMgr.getValueByKey("doubleEndActivity"):(this.actTime0.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this)))},e.prototype.onTime=function(){this._activityData&&(this._leftTime=this._activityData.getLeftTime(),this.actTime0.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3),this._leftTime<=0&&this.checkTime())},e}(BasePanel);__reflect(SpokesPersonEqiupRecyclePanel.prototype,"SpokesPersonEqiupRecyclePanel");var OnlineQuizControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isanswer=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downQuestion=function(t,e){this.curidx=t,this.time=DateUtils.formatMiniDateTime(e),this.endtimesec=DataCenter.ins().OnlineQuizBaseConfig.answerTime+Math.floor(this.time/1e3),this.curanswer=0,this.isanswer=!1,EventMgr.ins().dispatch(692)},e.prototype.downCheck=function(t){this.isanswer=t==this.curanswer,EventMgr.ins().dispatch(693)},e.prototype.downAnswer=function(){this.isanswer=!0},e.prototype.upAnswer=function(t){return this.curanswer=t,[t]},e.prototype.checkOpen=function(){var t=DataCenter.ins().OnlineQuizBaseConfig,e=spokesPersonControl.checkBaseOpen({level:t.openLv,pfIdLimit:t.pfIdLimit,pfIdOpenLimit:t.pfIdOpenLimit,openTimeLt:t.openTimeLt,openTimeGt:t.openTimeGt});return e&&this.curidx&&this.getlefttime()?!0:!1},e.prototype.getlefttime=function(){var t=this.endtimesec-Math.floor(GameServer.serverTime/1e3);return t>0?t:0},__decorate([down(20,[2,3])],e.prototype,"downQuestion",null),__decorate([down(21,[4])],e.prototype,"downCheck",null),__decorate([down(22)],e.prototype,"downAnswer",null),__decorate([up(20,[1])],e.prototype,"upAnswer",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(OnlineQuizControl.prototype,"OnlineQuizControl");var OnlineQuizView=function(t){function e(){var e=t.call(this)||this;return e.skinName="OnlineQuizViewSkin",e.uilayer=GameLayer.POPUP,e.ins=OnlineQuizControl.ins(),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rewardList.itemRenderer=ItemBase,this._col=new eui.ArrayCollection,this.rewardList.dataProvider=this._col},e.prototype.open=function(){this.addEventTouchTap(this.closebtn,this.onTap);for(var t=1;4>=t;t++)this["choiceGroup"+t]&&this.addEventTouchTap(this["choiceGroup"+t],this.onTap);this.addCustomEvent(692,this.updateView),this.addCustomEvent(693,this.showanswer),this.updateView()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.$onClose()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closebtn:UIMgr.ins().close(e);break;default:if(this.ins.isanswer)return;for(var i=1;4>=i;i++)if(!this.ins.curanswer&&this["choiceGroup"+i]&&this["choiceGroup"+i]==t.currentTarget){this.ins.upAnswer(i),this.updateView();break}}},e.prototype.updateView=function(){var t=DataCenter.ins().OnlineQuizQuestionsConfig[this.ins.curidx];this.subjectLabel.text=t.question;for(var e=1;4>=e;e++)this["choiceGroup"+e]&&(this["result"+e]&&(this["result"+e].visible=e==this.ins.curanswer),this["kuang"+e]&&(this["kuang"+e].visible=e==this.ins.curanswer),this["choice"+e]&&(this["choice"+e].text=t.options[e]));if(this._col.replaceAll(this.getreward()),this.waitgroup.visible=this.ins.isanswer,!TimerMgr.ins().isExists(this.refushEndTime,this)){var i=DataCenter.ins().OnlineQuizBaseConfig.answerTime,n=this.ins.getlefttime();this.bar.maximum=i,TimerMgr.ins().doTimer(1e3,n,this.refushEndTime,this),this.refushEndTime()}},e.prototype.showanswer=function(){tipsControl.showCenterTips3(LangMgr.getValueByKey("alrSelWaitAnswer"),7e3),this.waitgroup.visible=this.ins.isanswer},e.prototype.refushEndTime=function(){var t=this.ins.getlefttime();t>0?(this.timeLabel.text=t+"",this.bar.value=t):UIMgr.ins().close(e)},e.prototype.getreward=function(){for(var t=DataCenter.ins().OnlineQuizBaseConfig.quizRewards,e=t.length,i=e-1;i>=0;i--)if(GameServer.serverOpenDay+1>=t[i].day)return t[i].highAwards.concat(t[i].midAwards).concat(t[i].lowAwards);return[]},e}(BaseEuiView);__reflect(OnlineQuizView.prototype,"OnlineQuizView");var SpokesPersonTalkingView=function(t){function e(){var e=t.call(this)||this;return e.taskId=0,e.itemId=0,e.skinName="SpokesPersonTalkingViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t){this.taskId=t,this.addEventTouchTap(this.btn,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.updateView()},e.prototype.updateView=function(){var t=DataCenter.ins().SpokesPersonTaskListConfig[this.taskId],e=DataCenter.ins().NpcBaseConfig[t.npcID];if(this.npcName.text=e.name,this.BustImg.source=e.bust,this.npc.textFlow=TextUtils.generateTextFlow1(t.npctalking.text),this.btn.label=t.npctalking.btn,2==t.key)if(t.param){this.itemId=t.param;var i=DataCenter.ins().ItemConfig[t.param],n=backpackControl.getBagItemCount(0,t.param);n||(n=backpackControl.getBagItemCount(1,t.param)),n?this.nameLable.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("giveProp")+" |&C:"+ItemUtils.getQualityColor(i)+"&T:"+i.name+"|x1"):(this.itemId=0,this.nameLable.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("noGetProp")+" |&C:"+ItemUtils.getQualityColor(i)+"&T:"+i.name+"|"))}else void 0!=t.type?(this.itemId=this.getQuaEquip(t.type),this.itemId?this.nameLable.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("give")+" |&C:"+LangMgr.getColor("qualityColor"+t.type)+"&T:"+LangMgr.getValueByKey("qualityColorTxt"+t.type)+LangMgr.getValueByKey("colorEquip","|x1")):this.nameLable.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("noGet")+" |&C:"+LangMgr.getColor("qualityColor"+t.type)+"&T:"+LangMgr.getValueByKey("qualityColorTxt"+t.type)+LangMgr.getValueByKey("colorEquip","|"))):(this.itemId=-1,this.nameLable.text="");else this.nameLable.text=""},e.prototype.getQuaEquip=function(t){var e=backpackControl.itemCount[1],i=0,n=Number.MAX_VALUE;for(var o in e){var s=DataCenter.ins().ItemConfig[o];if(t==ItemUtils.getQuality(s)){var r=ItemUtils.pointCalNumber(s);n>r&&(n=r,i=s.id)}}return i},e.prototype.onTap=function(t){if(t.currentTarget==this.closeBtn)return void UIMgr.ins().close(this);if(t.currentTarget==this.btn){if(this.taskId!=spokesPersonTaskControl.curidx)return void tipsControl.showTips(LangMgr.getValueByKey("taskNoExist"));var e=DataCenter.ins().SpokesPersonTaskListConfig[this.taskId];if(2==e.key){if(0==this.itemId)return void tipsControl.showTips(LangMgr.getValueByKey("zhuzaiPropEnought"));-1==this.itemId?spokesPersonTaskControl.upTalkToNpc():spokesPersonTaskControl.upTalkToNpc(this.itemId)}else 3==e.key&&spokesPersonTaskControl.upEnterFb();UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(SpokesPersonTalkingView.prototype,"SpokesPersonTalkingView");var SpokesPersonTaskControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curStatus=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upTask=function(){},e.prototype.upReward=function(){},e.prototype.upTalkToNpc=function(t){return void 0===t&&(t=0),[t]},e.prototype.upEnterFb=function(){},e.prototype.downInfo=function(t,e,i,n,o){this.stage=t,this.curidx=e,this.task=i,this.pro=n,this.reward=o,this.checkStatus(),this.endTimeFun(this.endtime-GameServer.serverTime),EventMgr.ins().dispatch(683)},e.prototype.dispatchState=function(){EventMgr.ins().dispatch(695)},e.prototype.dispatchPro=function(){EventMgr.ins().dispatch(702)},e.prototype.checkOpen=function(t){var e=DataCenter.ins().SpokesPersonHourBaseConfig;return spokesPersonControl.checkBaseOpen(e,t)},e.prototype.checkSerOpen=function(){var t=DataCenter.ins().SpokesPersonHourBaseConfig;return spokesPersonControl.checkSerOpen(t)},e.prototype.checkStatus=function(){var t=this.getState();t!=this.curStatus?(this.curStatus=t,this.dispatchState()):(this.curStatus=t,3==this.curStatus&&this.dispatchPro())},e.prototype.getState=function(){var t=DataCenter.ins().SpokesPersonHourBaseConfig,e=new Date(GameServer.serverTime);e.setHours(t.firstTask.hour,t.firstTask.minute,0,0);var i=new Date(GameServer.serverTime+((t.tasknum-1)*t.intervalTime+t.finishTime)*DateUtils.MS_PER_SECOND),n=e.getTime(),o=GameServer.serverTime;if(GameServer.serverTime<n)return this.endtime=n,0;if(o>=i.getTime())return this.endtime=n,0;var s=(this.stage-1)*t.intervalTime*DateUtils.MS_PER_SECOND+n,r=s+t.acceptTime*DateUtils.MS_PER_SECOND,a=s+t.finishTime*DateUtils.MS_PER_SECOND,l=s+t.intervalTime*DateUtils.MS_PER_SECOND,h=void 0,u=Math.ceil((o-n+500)/DateUtils.MS_PER_SECOND/t.intervalTime);return u!=this.stage?(u==t.tasknum?this.endtime=n+DateUtils.MS_PER_DAY:this.endtime=u*t.intervalTime*DateUtils.MS_PER_SECOND+n,0):(this.reward?(this.endtime=l,h=5):this.task&&this.getTaskPro()?(this.endtime=l,h=6):this.task&&a>=o?(this.endtime=a,h=3):this.task&&o>a?(this.endtime=l,h=4):!this.task&&r>=o?(this.endtime=r,h=1):!this.task&&o>r&&(this.endtime=l,h=2),h)},e.prototype.endTimeFun=function(t){t>=0&&TimerMgr.ins().once(t+500,this.checkStatus,this)},e.prototype.checkRedPoint=function(){if(!this.checkOpen())return!1;var t=this.curStatus;return 3==t||1==t||6==t},e.prototype.getTaskPro=function(){if(this.curidx){var t=DataCenter.ins().SpokesPersonTaskListConfig[this.curidx];return this.pro>=t.target}return!1},Object.defineProperty(e.prototype,"refushTime",{get:function(){return this._refushTime},set:function(t){this._refushTime=t},enumerable:!0,configurable:!0}),e.prototype.getLeftTime=function(){var t=Math.floor(this.endtime-GameServer.serverTime)/1e3;return t>0?t:0},e.prototype.getNpcTask=function(t){if(this.curidx&&this.task){var e=DataCenter.ins().SpokesPersonTaskListConfig[this.curidx];if(e.npcID==t&&this.pro<e.target&&3==this.curStatus)return this.curidx}return 0},e.prototype.getCfg=function(){var t=DataCenter.ins().SpokesPersonTaskListConfig[this.curidx];return t},e.prototype.showNpcView=function(t){UIMgr.ins().open(SpokesPersonTalkingView,t)},e.prototype.getType=function(){var t=DataCenter.ins().SpokesPersonTaskListConfig[spokesPersonTaskControl.curidx],e=DataCenter.ins().SpokesPersonHourBaseConfig,i=e["interface"][t.type];return i?i:1},__decorate([up(24)],e.prototype,"upTask",null),__decorate([up(25)],e.prototype,"upReward",null),__decorate([up(28,[3])],e.prototype,"upTalkToNpc",null),__decorate([up(29)],e.prototype,"upEnterFb",null),__decorate([down(23,[3,3,1,3,1])],e.prototype,"downInfo",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(SpokesPersonTaskControl.prototype,"SpokesPersonTaskControl");var SpokesPersonTaskPanel=function(t){function e(){var e=t.call(this)||this;return e.lefttime=0,e.skinName="SpokesPersonTaskPanelSkin",e.ins=SpokesPersonTaskControl.ins(),e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.getBtn,this.onTap),this.addCustomEvent(702,this.updateBtnList),this.addCustomEvent(695,this.updateView),this.updateView()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.lefttime=0,this.laststate=-1,this.$onClose()},e.prototype.onTap=function(t){var e=this;if(!this.ins.task)return void this.ins.upTask();if(this.ins.getTaskPro())return void this.ins.upReward();var i=this.cfg;switch(i.key){case 1:var n=this.cfg["goto"];n&&UIMgr.ins().open(n[0],n[1]);break;case 2:UIMgr.ins().close(SpokesPersonView),moveControl.moveTo({npc:i.npcID});break;case 3:UIMgr.ins().close(SpokesPersonView),i.npcID?moveControl.moveTo({npc:i.npcID}):i.targetPos?moveControl.moveTo({point:{x:i.targetPos[0],y:i.targetPos[1]},callback:function(){warnControl.show(LangMgr.getValueByKey("isGotoChallenge"),function(){e.ins.upEnterFb()},e)}}):this.ins.upEnterFb()}},e.prototype.updateView=function(){this.cfg=DataCenter.ins().SpokesPersonTaskListConfig[this.ins.curidx];var t=this.ins.curStatus;this.laststate==t?"dotask"==this.currentState&&this.updateBtnList():(this.laststate=t,0==t||5==t?(this.currentState="notask",this.validateNow()):3==t||1==t||6==t?(this.currentState="dotask",this.validateNow(),this.updateBtnList()):(this.currentState="outtime",this.validateNow(),this.updateBtnList(),this.outtimeImg.source=4==t?"xietingfengtaskout1":"xietingfengtaskout2"),TimerMgr.ins().isExists(this.refushEndTime,this)||TimerMgr.ins().doTimer(1e3,0,this.refushEndTime,this),this.refushEndTime())},e.prototype.updateBtnList=function(){if(this.cfg||(this.cfg=DataCenter.ins().SpokesPersonTaskListConfig[this.ins.curidx]),this.cfg){var t=this.ins.reward?this.cfg.target:this.ins.pro,e=this.cfg.target,i=t>=e,n=i?ColorUtils.GREEN:ColorUtils.RED,o=this.cfg.desc,s="|C:"+n+"&T:"+t+"|&T:/"+e;this.taskdesLabel.textFlow=TextUtils.generateTextFlow1(o.replace("%s",s)),this.itemList&&!this._col&&(this._col=new eui.ArrayCollection,this.itemList.itemRenderer=ItemBase,this.itemList.dataProvider=this._col),this._col.replaceAll(this.cfg.award),this.ins.task?i?(this.getBtn.enabled=!0,this.redPoint.visible=!0,this.getBtn.label=LangMgr.getValueByKey("tongGetGift")):1!=this.cfg.key||this.cfg["goto"]?(this.redPoint.visible=!0,this.getBtn.enabled=!0,this.getBtn.label=LangMgr.getValueByKey("gotoFinish")):(this.redPoint.visible=!1,this.getBtn.enabled=!1,this.getBtn.label=LangMgr.getValueByKey("activitNoFinsh")):this.ins.reward?(this.getBtn.enabled=!1,this.redPoint.visible=!1,this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet")):(this.getBtn.enabled=!0,this.redPoint.visible=!0,this.getBtn.label=LangMgr.getValueByKey("godGetOrder"))}},e.prototype.refushEndTime=function(){var t=this.ins.getLeftTime(),e=t>=DateUtils.SECOND_PER_HOUR?DateUtils.TIME_FORMAT_1:DateUtils.TIME_FORMAT_3;"notask"==this.currentState?this.countdownLable.text=LangMgr.getValueByKey("taskRefresh")+DateUtils.getFormatBySecond(t,e):"outtime"==this.currentState?this.countdownLable.text=LangMgr.getValueByKey("taskRefresh")+DateUtils.getFormatBySecond(t,e):6==this.laststate?this.countdownLable.text="":this.countdownLable.text=DateUtils.getFormatBySecond(t,e),t||this.updateView()},__decorate([callLater],e.prototype,"updateView",null),e}(BasePanel);__reflect(SpokesPersonTaskPanel.prototype,"SpokesPersonTaskPanel");var SpokesPersonTurntableControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.turnTimes=0,e._awardRecord=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downBase=function(t,e){this.turnTimes=t,this._awardRecord=e,EventMgr.ins().dispatch(485)},e.prototype.upStart=function(){},e.prototype.downRewardIndex=function(t){EventMgr.ins().dispatch(486,t)},e.prototype.upAward=function(){},e.prototype.upDaBiaoAward=function(t){return[t]},e.prototype.hasGotAwardByIndex=function(t){return(this._awardRecord>>t&1)>0},e.prototype.getCurCfgs=function(){for(var t=DataCenter.ins().SpokesPersonLotteryAwardConfig,e=Object.keys(t).length,i=GameServer.serverOpenDay+1,n=1;e>=n;n++)if(t[n][1][1].openDay>i)return t[n-1]?t[n-1]:t[n];return t[e]},e.prototype.checkOpen=function(t){var e=DataCenter.ins().SpokesPersonLotteryBaseConfig;return spokesPersonControl.checkBaseOpen(e,t)},e.prototype.checkSerOpen=function(){return spokesPersonControl.checkSerOpen(DataCenter.ins().SpokesPersonLotteryBaseConfig)},e.prototype.checkRed=function(){if(!this.checkOpen())return!1;var t=DataCenter.ins().SpokesPersonLotteryBaseConfig;if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t.costItem)>0)return!0;for(var e=t.dabiao,i=e.length,n=0;i>n;n++){var o=e[n];if(this.turnTimes>=o.count&&!this.hasGotAwardByIndex(n+1))return!0}return!1},__decorate([down(16,[3,3])],e.prototype,"downBase",null),__decorate([up(17)],e.prototype,"upStart",null),__decorate([down(17,[1])],e.prototype,"downRewardIndex",null),__decorate([up(18)],e.prototype,"upAward",null),__decorate([up(19,[1])],e.prototype,"upDaBiaoAward",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(SpokesPersonTurntableControl.prototype,"SpokesPersonTurntableControl");var SpokesPersonTurntablePanel=function(t){function e(){var e=t.call(this)||this;return e._firstOpen=!0,e._lastTimes=0,e.skinName="SpokesPersonTurntablePanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.awrdList.itemRenderer=SpokesPersonTurntableItemRender,this._col=new eui.ArrayCollection,this.awrdList.dataProvider=this._col},e.prototype.open=function(){this.addCustomEvent(485,this.dataChange),this.addCustomEvent(486,this.startTurn),this.addCustomEvent(268,this.updateMaterial),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addCustomEvent(269,this.updateMaterial),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.reset()},e.prototype.dataChange=function(){var t=spokesPersonTurntableControl.turnTimes;(t+1)%DataCenter.ins().SpokesPersonLotteryBaseConfig.hightCount==0?this._isBetter=!0:this._isBetter=!1,this._lastTimes!=t&&(this._isPlaying=!1),this.update()},e.prototype.update=function(){if(!this._isPlaying){var t=DataCenter.ins().SpokesPersonLotteryBaseConfig;this._cfgs||(this._cfgs=spokesPersonTurntableControl.getCurCfgs()),this._lastTimes=spokesPersonTurntableControl.turnTimes;var e=(this._lastTimes+1)%t.hightCount==0;this._firstOpen&&(!this._isBetter&&e&&(this._isBetter=!0),this._firstOpen=!1);for(var i=this._isBetter?2:1,n=0;10>n;n++)this["item"+n].data=this._cfgs[i][n+1].award;if(this.updateMaterial(),this.bgImg.source=this._isBetter?"spokesPerson_turntable_special_png":"spokesPerson_turntable_normal_png",this.switchBtn.icon=this._isBetter?"xtf_turntable_normal_png":"xtf_turntable_special_png",this.awardBg.source=this._isBetter?"blueAwardPanel_png":"spokesPerson_redAwardPanel_png",this._eff||(this._eff=ObjectPool.pop("GameMovieClip")),this._eff.parent||this.effGroup.addChild(this._eff),this._eff.playFile(""+PATH_EFF+(this._isBetter?"spokesman_turntable1_eff":"spokesman_turntable0_eff"),-1),e)this.tipTxt.text=LangMgr.getValueByKey("alrOpenDialUpData",DataCenter.ins().SpokesPersonLotteryBaseConfig.turntableName);else{var o=t.hightCount;o=o-this._lastTimes%o-1,this.tipTxt.text=LangMgr.getValueByKey("turnAgainNnum",o,DataCenter.ins().SpokesPersonLotteryBaseConfig.turntableName)}for(var s=0,r=t.dabiao,a=r.length,l=[],n=0;a>n;n++){var h=r[n];s=h.count;var u=AmusementControl.NotReached;this._lastTimes>=h.count&&(u=spokesPersonTurntableControl.hasGotAwardByIndex(n+1)?AmusementControl.Geted:AmusementControl.CanGet),l.push({count:h.count,award:h.award[0],curTimes:this._lastTimes,lastCount:0==n?0:r[n-1].count,state:u,index:n+1})}this._col.replaceAll(l),this.turntime.text=""+Math.min(this._lastTimes,s)}},e.prototype.updateMaterial=function(){var t=DataCenter.ins().SpokesPersonLotteryBaseConfig.costItem;this.itemImg.source=DataCenter.ins().ItemConfig[t].icon+"_png";var e=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t);this.countTxt.textFlow=TextUtils.generateTextFlow("(|C:"+(e?65280:16711680)+"&T:"+e+"|/1)")},e.prototype.startTurn=function(t){var e=this;egret.Tween.removeTweens(this.tttzhi),egret.Tween.get(this.tttzhi).to({rotation:1440+36*(t-1)},4e3,egret.Ease.circOut).call(function(){e.flyToBag(t),spokesPersonTurntableControl.upAward()},this)},e.prototype.onTouch=function(t){switch(t.target){case this.switchBtn:if(this._isPlaying)return;this._isBetter=!this._isBetter,this.update();break;case this.choujiangBtn:if(this._isPlaying)return;var e=DataCenter.ins().SpokesPersonLotteryBaseConfig;if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e.costItem)>0)if((spokesPersonTurntableControl.turnTimes+1)%e.hightCount==0)this._isBetter||(this._isBetter=!0,this.update(),tipsControl.showTips(LangMgr.getValueByKey("alrOpenDialUpData",DataCenter.ins().SpokesPersonLotteryBaseConfig.turntableName))),spokesPersonTurntableControl.upStart(),this._isPlaying=!0;else if(this._isBetter){var i=e.hightCount;i=i-spokesPersonTurntableControl.turnTimes%i-1,tipsControl.showTips(LangMgr.getValueByKey("turnAgainNnum",i,DataCenter.ins().SpokesPersonLotteryBaseConfig.turntableName))
}else spokesPersonTurntableControl.upStart(),this._isPlaying=!0;else tipsControl.showTips(LangMgr.getValueByKey("activitEnought1",DataCenter.ins().ItemConfig[e.costItem].name));break;case this.itemImg:CommonFun.viewItemTips(DataCenter.ins().SpokesPersonLotteryBaseConfig.costItem)}},e.prototype.flyToBag=function(t){for(var e=this._isBetter?2:1,i=0;10>i;i++)this["item"+i].data=this._cfgs[e][i+1].award;var n=this["item"+(t-1)],o=n.parent.localToGlobal(0,0),s=n.localToGlobal(0,0),r=s.x-o.x,a=s.y-o.y,l=new ItemBase;l.data=this._cfgs[e][t].award,l.x=r,l.y=a,n.parent.addChild(l),gameControl.dispatchFlyItemEx(l)},e.prototype.reset=function(){egret.Tween.removeTweens(this.tttzhi),this.tttzhi.rotation=0,this._isPlaying&&(spokesPersonTurntableControl.upAward(),this._isPlaying=!1),this._cfgs=null,this._isBetter=!1,this._firstOpen=!0,this._eff&&(this._eff.destroy(),this._eff=null),this._lastTimes=0},e}(BasePanel);__reflect(SpokesPersonTurntablePanel.prototype,"SpokesPersonTurntablePanel");var SpokesPersonTurntableItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=new RewardVo;t.id=this.data.award.id,t.type=this.data.award.type,t.count=this.data.award.count,t.isRedPoint=this.data.state,this.itemIcon.data=t,this.count.textFlow=TextUtils.generateTextFlow("(|C:"+(this.data.curTimes>=this.data.count?65280:16711680)+"&T:"+Math.min(this.data.count,this.data.curTimes)+"|/"+this.data.count+")"),this.bar.maximum=this.data.count-this.data.lastCount,this.bar.value=this.data.curTimes-this.data.lastCount,this.data.state==AmusementControl.CanGet?(this.touchEnabled=!0,this.touchChildren=!1):(this.touchEnabled=!1,this.touchChildren=!0)},e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.addEventTouchTap(this,this.onItem)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.removeEventTouchTap(this,this.onItem)},e.prototype.onItem=function(){this.data.state==AmusementControl.CanGet&&spokesPersonTurntableControl.upDaBiaoAward(this.data.index)},e}(BaseItemRender);__reflect(SpokesPersonTurntableItemRender.prototype,"SpokesPersonTurntableItemRender");var SpokesPersonView=function(t){function e(){var e=t.call(this)||this;return e.curID=0,e.skinName="SpokesPersonViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.roleSelect.hideRole(),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.seeRule,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventChange(this.menuList,this.onTapMenu),this.addEventChanging(this.menuList,this.onTitleChange),this.menuDataPro=new eui.ArrayCollection,this.menuList.itemRenderer=SpokesPersonIconItemRender,this.menuList.dataProvider=this.menuDataPro},e.openCheck=function(t){if(t)return spokesPersonControl.checkOpen(t,!0);var e=DataCenter.ins().SpokesPersonOpenConfig;for(var i in e){var n=e[i];if(spokesPersonControl.checkOpen(n.id)&&!spokesPersonControl.checkClose(n.id))return!0}return tipsControl.showTips(LangMgr.getValueByKey("doubleNoActivity")),!1},e.prototype.open=function(t){if(this.addCustomEvent(488,this.refreshMenu),this.addCustomEvent(489,this.refreshMenu),this.addCustomEvent(491,this.refreshMenu),this.addCustomEvent(490,this.refreshMenu),this.addCustomEvent(492,this.refreshMenu),this.updateMenu(),t||this.curID)this.curID=t||this.curID,this.setMenuIndex(),this.setSelectID(this.curID);else{for(var e=0;e<this.menuData.length;e++){var i=this.menuData[e];if(spokesPersonControl.checkOpen(i.id)){this.curID=i.id;break}}this.setMenuIndex(),t=this.menuData[this.menuList.selectedIndex].id,this.setSelectID(t)}this.onChange(),this.updateSelectPos()},e.prototype.close=function(){this.curPanel&&this.curPanel.close()},e.prototype.updateMenu=function(){var t=DataCenter.ins().SpokesPersonOpenConfig;this.menuData=[];for(var e in t){var i=t[e];spokesPersonControl.checkSerOpenAct(i.id)&&!spokesPersonControl.checkClose(i.id)&&this.menuData.push(i)}this.menuData.sort(function(t,e){return t.sort<e.sort?-1:1}),this.menuDataPro.replaceAll(this.menuData),this.btnNum=this.menuDataPro.length},e.prototype.refreshMenu=function(){for(var t=0;t<this.menuData.length;t++)this.menuDataPro.itemUpdated(this.menuData[t])},e.prototype.setMenuIndex=function(){for(var t=0,e=0;e<this.menuData.length;e++)if(this.menuData[e].id==this.curID){t=e;break}this.menuList.selectedIndex=t},e.prototype.setSelectID=function(t){this.curID=t;var e=this.getPanelIndex(t);if(0>e){var i=DataCenter.ins().SpokesPersonOpenConfig[t];if(!i){for(var n="",o=0;o<this.menuData.length;o++){var s=this.menuData[o];n+=s.id+","}if(Assert(i,"spokesmanwin id:"+t+",menudata:"+n))return;this.menuData.length&&(this.setSelectID(this.menuData[0].id),this.setMenuIndex())}var r=egret.getDefinitionByName(i.cls),a=new r;a.panelConfig=i,a.right=a.top=a.left=a.bottom=0,this.viewStack.addChild(a),e=this.viewStack.numChildren-1}this.curPanel&&this.curPanel.close(),this.viewStack.selectedIndex=e,this.curPanel=this.viewStack.getChildAt(e),this.curPanel.open()},e.prototype.getPanelIndex=function(t){for(var e=0;e<this.viewStack.numChildren;e++){var i=this.viewStack.getChildAt(e);if(i.panelConfig.id==t)return e}return-1},e.prototype.onTitleChange=function(t){var e=t.currentTarget.selectedIndex,i=this.menuDataPro.getItemAt(e);spokesPersonControl.checkOpen(i.id,!0)||t.preventDefault()},e.prototype.onTapMenu=function(t){var e=this.menuData[this.menuList.selectedIndex];e.id!=this.curID&&this.setSelectID(e.id)},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.rightBtn:this.menuList.scrollH+=92,this.menuList.scrollH>this.menuList.contentWidth-this.menuList.width&&(this.menuList.scrollH=this.menuList.contentWidth-this.menuList.width),this.onChange();break;case this.leftBtn:this.menuList.scrollH-=92,this.menuList.scrollH<0&&(this.menuList.scrollH=0),this.onChange();break;case this.seeRule:break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onChange=function(){this.btnNum<=5?this.leftBtn.visible=this.rightBtn.visible=!1:this.menuList.scrollH<30?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.menuList.scrollH>=this.menuList.contentWidth-this.menuList.width?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.rightRed.visible=this.leftRed.visible=!1,this.btnNum>5&&(this.updateLeftRedPoint(),this.updateRightRedPoint())},e.prototype.updateRightRedPoint=function(){if(this.rightBtn.visible&&(!this.menuList.contentWidth||this.menuList.scrollH+460<this.menuList.contentWidth-92)){var t=this.menuList.contentWidth-(this.menuList.scrollH+460);t=0>=t?0:t;var e=Math.floor(t/92);if(e>0&&e<=this.menuData.length){e=this.menuData.length-e;for(var i=this.menuData.length-1;i>=e;i--){var n=this.menuData[i];if(this.rightRed.visible=spokesPersonControl.checkRedPoint(n.id),this.rightRed.visible)break}}}},e.prototype.updateLeftRedPoint=function(){if(this.leftBtn.visible&&this.menuList.scrollH>=82){var t=Math.floor(this.menuList.scrollH/82);if(t<=this.menuData.length)for(var e=0;t>e;e++){var i=this.menuData[e];if(this.leftRed.visible=spokesPersonControl.checkRedPoint(i.id),this.leftRed.visible)break}}},e.prototype.updateSelectPos=function(){this.menuList.validateNow(),this.menuList.selectedIndex>=5&&(this.menuList.scrollH=92*this.menuList.selectedIndex,this.menuList.contentWidth-this.menuList.width<this.menuList.scrollH&&(this.menuList.scrollH=this.menuList.contentWidth-this.menuList.width))},e}(BaseEuiView);__reflect(SpokesPersonView.prototype,"SpokesPersonView");var SpokesPersonIconItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.iconDisplay.source=t.iconRes,this.redPoint.visible=spokesPersonControl.checkRedPoint(t.id)},e}(BaseItemRender);__reflect(SpokesPersonIconItemRender.prototype,"SpokesPersonIconItemRender");var SpringBeginStoreRewardShowView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpringBeginStoreRewardShowViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.shopList.itemRenderer=SpringBeginStoreShowItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._activityID=t[0],this.update(),this.addEventTouchTap(this.bgClose,this.onTouch)},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTouch)},e.prototype.update=function(){var t=amusementControl.getConfig22_3(this._activityID);this.shopList.dataProvider=new ArrayCollection(t?t.showReward:null)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(SpringBeginStoreRewardShowView.prototype,"SpringBeginStoreRewardShowView");var SpringBeginStoreItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpringBeginStoreItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.buyBtn.label=this.data.isScore?LangMgr.getValueByKey("fdChange"):LangMgr.getValueByKey("fdBuy"),this.discount.visible=!this.data.isScore&&this.data.data.discount,this.discount.visible&&(this.discountNum.source="discountNum"+this.data.data.discount),this.itemIcon.data={type:1,id:this.data.data.itemID,count:this.data.data.itemCount},this.addEventRemovedFromStage(this,this.onRmove),this.addEventTouchTap(this.buyBtn,this.onTouch),this.data.isScore?(this.buyBtn.enabled=!0,this.yuanbao.visible=!1,this.jifen.visible=!0,this.jifenNum.text=this.data.data.score):(this.buyBtn.enabled=0==this.data.data.state,this.yuanbao.visible=!0,this.jifen.visible=!1,this.money.text=this.data.data.price)},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this.buyBtn,this.onTouch)},e.prototype.onTouch=function(t){var e=amusementControl.activityData[this.data.activityID];this.data.isScore?e.tScore<this.data.data.score?tipsControl.showTips(LangMgr.getValueByKey("osaEnoughtScore1")):amusementControl.upReward(this.data.activityID,0,4,this.data.data.id):ActorControl.yb<this.data.data.price?tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):amusementControl.upReward(this.data.activityID,0,3,this.data.data.id)},e}(BaseItemRender);__reflect(SpringBeginStoreItemRender.prototype,"SpringBeginStoreItemRender");var SpringBeginStoreShowItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="SpringBeginStoreShowItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.discount.visible=this.data.discountImg>0,this.discount.visible&&(this.discountNum.source="discountNum"+this.data.discountImg),this.money.text=this.data.cost,this.itemIcon.data=this.data},e}(BaseItemRender);__reflect(SpringBeginStoreShowItemRender.prototype,"SpringBeginStoreShowItemRender");var SpringEightDayView=function(t){function e(){var e=t.call(this)||this;return e._curDay=0,e._curDayIndex=0,e._curGroupIndex=0,e.isTopLevel=!0,e.setActivityID(),e.setCurSkin(),e}return __extends(e,t),e.prototype.setActivityID=function(){var t=amusementControl.activityData;for(var e in t)if(13==t[e].pageType){this._activityID=t[e].id;break}},e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this._activityID],e="SpringEightDayViewSkin";t.pageSkin&&(e=t.pageSkin),this.skinName=e,this.actInfo0&&(this.actInfo0.text=t.desc)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.tabP.itemRenderer=HappySevenDayTabListItemRender,this.tabD.itemRenderer=HappySevenDayBtnItemRender,this.list.itemRenderer=HappySevenDayItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._activityID=t[0],this._curDayIndex=0,this._curGroupIndex=0,this.updateView(),this.updateTabs(),this.tabD.selectedIndex=this._curDayIndex,this.tabP.selectedIndex=this._curGroupIndex,this.updateData(),this.updateTargetAward(),this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(392,this.refreshReds),this.addEventChange(this.tabD,this.onClickBtn),this.addEventChange(this.tabP,this.onTabBtn),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.close=function(){this._tabCollect=null,this._btnCollect=null,this._listCollect=null},e.prototype.updateView=function(){var t=amusementControl.getAmusementDataById(this._activityID);this._curDay=t.getCurDay(),this._items=[];var e,i,n,o,s,r,a=DataCenter.ins().Amusement11_2Config[this._activityID],l=[];for(var h in a)e=a[h],n=e.day,i=this._items[e.day-1],i||(i=[],this._items[e.day-1]=i,l.push({res:e.dayImg,isOpen:this._curDay>=e.day,showRed:!1,day:e.day})),r=t.achieveInfo[e.index-1],this._curDay>=e.day&&!r.isGot&&r.times>=e.dayLimit&&(l[e.day-1].showRed=!0),o=e.group,s=i[o-1],s||(s=[],i[o-1]=s),s.push(e);this._btnCollect||(this._btnCollect=new ArrayCollection,this.tabD.dataProvider=this._btnCollect),this._btnCollect.source=l,this.tabD.validateNow(),this._tabCollect||(this._tabCollect=new ArrayCollection,this.tabP.dataProvider=this._tabCollect)},e.prototype.refreshReds=function(){this.updateView(),this.updateTabs(),this.updateData(),this.updateTargetAward()},e.prototype.updateData=function(){var t=this._items[this._curDayIndex][this._curGroupIndex];if(t&&t.length){this._listCollect||(this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect);for(var e,i,n=t.length,o=[],s=0,r=amusementControl.getAmusementDataById(this._activityID),a=0;n>a;a++)e=t[a],i=r.achieveInfo[e.index-1],s=i.isGot?2:i.times>=e.dayLimit?1:0,o[a]={activityID:this._activityID,conf:e,state:s,times:i.times};o.sort(this.sort),this._listCollect.source=o}},e.prototype.sort=function(t,e){return 1==t.state&&1!=e.state?-1:2==t.state&&2!=e.state?1:t.conf.index<e.conf.index?-1:t.conf.index>e.conf.index?1:0},e.prototype.updateTargetAward=function(){var t=DataCenter.ins().Amusement11_1Config[this._activityID][Object.keys(DataCenter.ins().Amusement11_1Config[this._activityID]).length];this.schedule.maximum=t.score,this.schedule.value=amusementControl.getAmusementDataById(this._activityID).gethiScore()},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.rewardBtn:UIMgr.ins().open(TaskIntegralGiftView,this._activityID)}},e.prototype.onClickBtn=function(t){if(this._curDayIndex!=t.currentTarget.selectedIndex){var e=this.tabD.getChildAt(t.currentTarget.selectedIndex);e.isOpen?(e=this.tabD.getChildAt(this._curDayIndex),e.selected=!1,this._curDayIndex=t.currentTarget.selectedIndex):tipsControl.showCenterTips(LangMgr.getValueByKey("activitOpenDay",e.day)),this.tabD.selectedIndex=this._curDayIndex,e=this.tabD.getChildAt(this._curDayIndex),e.selected=!0,this.updateTabs(),this.tabP.selectedIndex=this._curGroupIndex=0,this.updateData()}},e.prototype.onTabBtn=function(t){this._curGroupIndex!=t.currentTarget.selectedIndex&&(this._curGroupIndex=t.currentTarget.selectedIndex,this.tabP.selectedIndex=this._curGroupIndex,this.updateData())},e.prototype.updateTabs=function(){var t,e,i,n=this._items[this._curDayIndex],o=amusementControl.getAmusementDataById(this._activityID),s=[];for(var r in n){s.push({gName:n[r][0].gName,showRed:!1}),t=n[r].length;for(var a=0;t>a;a++)if(i=n[r][a],e=o.achieveInfo[i.index-1],this._curDay>=i.day&&!e.isGot&&e.times>=i.dayLimit){s[r].showRed=!0;break}}this._tabCollect.source=s},e.prototype.setTime=function(){var t=amusementControl.activityData[this._activityID];this.actTime0.text=t.getRemainTime()},e}(BaseEuiView);__reflect(SpringEightDayView.prototype,"SpringEightDayView");var StrideServerDataVo=function(){function t(){this.actorId=0,this.rmb=0,this.rank=0,this.serverId=0,this.roleName="",this.job=0,this.sex=0}return t.prototype.init=function(t){this.actorId=t[0],this.rmb=t[1],this.rank=t[2],this.serverId=t[3],this.roleName=t[4],this.job=t[5],this.sex=t[6]},t}();__reflect(StrideServerDataVo.prototype,"StrideServerDataVo");var StrideServerCostRewardPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e}return __extends(e,t),e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.activityID=t[0],this.list.itemRenderer=StrideServerCostRankRewardItemRender,this.listdata=new eui.ArrayCollection,this.list.dataProvider=this.listdata,this.updateData()},e.prototype.updateData=function(){var t=amusementControl.activityData[this.activityID];if(t){var e=DataCenter.ins().Amusement19Config[this.activityID],i=[];for(var n in e){var o="";o=e[n].range[0]==e[n].range[1]?""+e[n].range[0]:e[n].range[0]+"-"+e[n].range[1];var s=e[n].condition?LangMgr.getValueByKey("kfLookRank",e[n].condition):"",r=e[n].rewards,a={rank:o,desc:s,rewards:r};i.push(a)}this.listdata.replaceAll(i),this._time=t.getleftTime();var l=this.list.parent;l.stopAnimation(),this.list.scrollV=0,this.setTime();var h=DataCenter.ins().AmusementConfig[this.activityID];this.actInfo.textFlow=TextUtils.generateTextFlow1(""+h.desc)}},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e}(BasePanel);__reflect(StrideServerCostRewardPanel.prototype,"StrideServerCostRewardPanel");var StrideServerRankPanel=function(t){function e(){var e=t.call(this)||this;return e._time=0,e.actorIds=[],e}return __extends(e,t),e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(397,this.updateData),this.addCustomEvent(478,this.openOtherPlayerView),this.addEventTouchTap(this.rechargeBtn,this.onClick),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.activityID=t[0],this.list.itemRenderer=StrideServerCostRankItemRender,this.listdata=new eui.ArrayCollection,this.list.dataProvider=this.listdata,amusementControl.upKuaFuRank(this.activityID),this.updateData()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeBtn:UIMgr.ins().open(PayFirstView)}},e.prototype.updateData=function(){var t=amusementControl.activityData[this.activityID];if(t){this._time=t.getleftTime();var e=t.GetRankList();if(e.length?this.currentState="normal":this.currentState="none",this.validateNow(),this.myNumber.text=t.mycost+"",this.myRanking.text=LangMgr.getValueByKey("guanNoRank"),"none"!=this.currentState){var i=[],n=e.length>3?e.length:3;this.actorIds=[];for(var o=0,s=0;n>s;s++){var r=e[s];if(3>s){if(r&&r.actorId){var a={actorId:r.actorId,serverId:r.serverId};this.actorIds.push(a),this["playName"+s].text="s"+r.serverId+"."+r.roleName,this["recharge"+s].text=LangMgr.getValueByKey("kfPay",r.rmb),this["playName"+s].visible=this["recharge"+s].visible=!0}else{var a={actorId:0,serverId:0};this.actorIds.push(a),this["playName"+s].visible=this["recharge"+s].visible=!1}this["rank"+s].data=null}else r&&i.push(r);r&&ActorControl.actorID==r.actorId&&(o=r.rank)}for(var l=0;l<this.actorIds.length;l++)this.actorIds[l]&&this.actorIds[l].actorId&&rankOtherUserControl.upFindPlayer(this.actorIds[l].actorId,this.actorIds[l].serverId);this.listdata.replaceAll(i),this.myNumber.text=t.mycost+"",this.myRanking.text=o?o+"":LangMgr.getValueByKey("guanNoRank");var h=this.list.parent;h.stopAnimation(),this.list.scrollV=0,this.setTime()}}},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.openOtherPlayerView=function(t){if(t)for(var e=0;e<this.actorIds.length;e++)this.actorIds[e].actorId==t.id&&(this["rank"+e].data={otherPlayerData:t})},e}(BasePanel);__reflect(StrideServerRankPanel.prototype,"StrideServerRankPanel");var StrideServerCostRankItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="StrideServerCostRankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&this.data instanceof StrideServerDataVo&&(this.pos.text=this.data.rank+"",this.player.text="s"+this.data.serverId+"."+this.data.roleName,this.value.text=LangMgr.getValueByKey("kfPay",this.data.rmb))},e}(BaseItemRender);__reflect(StrideServerCostRankItemRender.prototype,"StrideServerCostRankItemRender");var StrideServerCostRankRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="StrideServerRewardItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase},e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.pos.text=t.rank+"",this.need.text=t.desc,this.reward.dataProvider=new eui.ArrayCollection(t.rewards)}},e}(BaseItemRender);__reflect(StrideServerCostRankRewardItemRender.prototype,"StrideServerCostRankRewardItemRender");var TotalRecharge55View=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getActivityId=function(){var t=amusementControl.activityData;for(var e in t)if(103==t[e].pageType&&amusementControl.getAmusementDataById(t[e].id).isOpenActivity()&&!amusementControl.getAmusementDataById(t[e].id).getHide())return t[e].id;return 0},e}(TotalRechargeView);__reflect(TotalRecharge55View.prototype,"TotalRecharge55View");var AmusementType10DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.record=t[0],this.yb=t[1],this.index=t[2],this.state=t[3],this.noticeArr=[];for(var e=0;e<t[4].length;e++)this.noticeArr.push({name:t[4][e][0],multiple:t[4][e][1],yb:t[4][e][2]});this.noticeArr.reverse()},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){return amusementControl.getType10RedPoint(this.id)},e.prototype.getLeftTime=function(){if(this.endTime){var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return 0>t&&(t=0),t}return 0},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e.prototype.getLevel=function(){var t=DataCenter.ins().Amusement10Config[this.id],e=Object.keys(t).length,i=this.record+1;return this.record>=e&&(i=0),i},e.prototype.getCondition=function(t){var e=DataCenter.ins().Amusement10Config[this.id][t];return e?this.yb>=e.recharge:!1},e}(AmusementBaseDataVo);__reflect(AmusementType10DataVo.prototype,"AmusementType10DataVo");var TreasureBasinAwardView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.skinName=t[1]?t[1]:"TreasureBasinAwardViewSkin",this.awardlist.itemRenderer=TreasureBasinRewardItemRender,this.addEventTouchTap(this.bgClose,this.onTap),this._activityId=t[0],this.updateView()},e.prototype.updateView=function(){var t=DataCenter.ins().Amusement16Config[this._activityId],e=Object.keys(t);e.sort(function(t,e){return+e>+t?-1:1});for(var i=[],n=0;n<e.length;n++){var o=+e[n];o&&i.push(t[o])}this.awardlist.dataProvider=new eui.ArrayCollection(i),this.awardlist.validateNow();var s=amusementControl.getAmusementDataById(this._activityId),r=this.awardlist.contentHeight-this.reward0.height,a=106*s.gotId-6;a=Math.max(a,0),a=Math.min(a,r),this.awardlist.scrollV=a},e.prototype.onTap=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TreasureBasinAwardView.prototype,"TreasureBasinAwardView");var TreasureBasinBargianPanel=function(t){function e(){var e=t.call(this)||this;return e.datas=[],e._leftTime=0,e.skinName="InvestmentLevelPanelSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.rechargeBtn,this.onClick),this.addCustomEvent(392,this.updateView),this.content.itemRenderer=TreasureBasinBargianItemRenderer,this.updateView(),TimerMgr.ins().isExists(this.updateTime,this)||TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.updateView=function(){this.datas=[];var t=DataCenter.ins().Amusement16Config[this.activityId],e=AmusementControl.ins().getAmusementDataById(this.activityId);this.activityData=e;var i=Object.keys(t);i.sort(function(t,e){return+e>+t?-1:1});for(var n=0;n<i.length;n++){var o=+i[n];o&&this.datas.push(t[o])}if(this.content.dataProvider=new eui.ArrayCollection(this.datas),this.content.validateNow(),e.buyState)this.rechargeBtn.label=LangMgr.getValueByKey("alrInvestment"),this.rechargeBtn.filters=FilterUtils.ARRAY_GRAY_FILTER,this.rechargeBtn.touchEnabled=!1;else if(1==t[0].rechargeid.buytype){var s=DataCenter.ins().PayInfoConfig[t[0].rechargeid.rechargeId];this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",s.cash)}else 2==t[0].rechargeid.buytype&&(this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay1",t[0].rechargeid.count));this.first.visible=!1;var r=new Date(DateUtils.formatMiniDateTime(e.startTime));r.setDate(r.getDate()+t[0].buyDay),this._leftTime=Math.floor((r.getTime()-GameServer.serverTime)/1e3),this._leftTime<0&&(this._leftTime=0)},e.prototype.updateTime=function(){this.actTime.text=LangMgr.getValueByKey("expHaveTime",DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3)),this._leftTime>0&&this._leftTime--},e.prototype.close=function(){TimerMgr.ins().remove(this.updateTime,this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeBtn:var e=DataCenter.ins().Amusement16Config[this.activityData.id];1==e[0].rechargeid.buytype?payControl.showReCharge(e[0].rechargeid.rechargeId):2==e[0].rechargeid.buytype&&AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1)}},e}(BaseEuiView);__reflect(TreasureBasinBargianPanel.prototype,"TreasureBasinBargianPanel");var TreasureBasinEightPanel=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e.skinName="InvestmentLoginPanelSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.rechargeBtn,this.onClick),this.addCustomEvent(392,this.updateView),this.content.itemRenderer=TreasureBasinEightItemRenderer,this.listData=new eui.ArrayCollection,this.content.dataProvider=this.listData,this.content.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onSoulClick,this),this.updateView(),TimerMgr.ins().isExists(this.updateTime,this)||TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.onSoulClick=function(t){if(t&&t.itemRenderer&&t.item){if(!this.activityData.buyState)return;if(this.activityData.hadGet)return;if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1)}},e.prototype.updateView=function(){this.activityData=AmusementControl.ins().getAmusementDataById(this.activityId);for(var t=DataCenter.ins().Amusement16Config[this.activityId],e=Object.keys(t),i=(this.activityData.gotId>=e.length-1?e.length-1:0==this.activityData.gotId?1:this.activityData.gotId,[]),n=0;n<e.length;n++){var o=+e[n];o&&i.push(t[o])}if(i.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"index")}),this.listData.replaceAll(i),this.activityData.buyState)this.rechargeBtn.label=LangMgr.getValueByKey("alrInvestment"),this.rechargeBtn.filters=FilterUtils.ARRAY_GRAY_FILTER,this.rechargeBtn.touchEnabled=!1;else if(1==t[0].rechargeid.buytype){var s=DataCenter.ins().PayInfoConfig[t[0].rechargeid.rechargeId];this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",s.cash)}else 2==t[0].rechargeid.buytype&&(this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay1",t[0].rechargeid.count));var r=new Date(DateUtils.formatMiniDateTime(this.activityData.startTime));r.setDate(r.getDate()+t[0].buyDay),this._leftTime=Math.floor((r.getTime()-GameServer.serverTime)/1e3),this._leftTime<0&&(this._leftTime=0)},e.prototype.updateTime=function(){this.actTime.text=LangMgr.getValueByKey("expHaveTime",DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,3)),this._leftTime>0&&this._leftTime--},e.prototype.close=function(){TimerMgr.ins().remove(this.updateTime,this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.rechargeBtn:var e=DataCenter.ins().Amusement16Config[this.activityData.id];1==e[0].rechargeid.buytype?payControl.showReCharge(e[0].rechargeid.rechargeId):2==e[0].rechargeid.buytype&&AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1)}},e}(BaseEuiView);__reflect(TreasureBasinEightPanel.prototype,"TreasureBasinEightPanel");var TreasureBasinLuxuryPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentMonthViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.showDetail1,this.onTouchBtn),this.addEventTouchTap,this.addEventTouchTap(this.showDetail0,this.onTouchBtn),this.addEventTouchTap(this.rechargeBtn,this.onTouchBtn),this.addEventTouchTap(this.getBtn,this.onTouchBtn),this.addCustomEvent(392,this.updateView),this.reward.itemRenderer=ItemBase,this.updateView(),this.showDetail0.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.showDetail0.text)},e.prototype.updateView=function(){this.activityData=AmusementControl.ins().getAmusementDataById(this.activityId);var t=DataCenter.ins().Amusement16Config[this.activityId],e=Object.keys(t),i=this.activityData.gotId>=e.length-1?e.length-1:0==this.activityData.gotId?1:this.activityData.gotId;this.dayInfo.text=LangMgr.getValueByKey("whichDayAw",i),this.redPoint.visible=!this.activityData.hadGet,this.reward.dataProvider=new eui.ArrayCollection(t[i].reward),this.ybAll.data=t[0].showYB[0],this.getRewardGroup.visible=this.investmentGroup.visible=!1,this.activityData.buyState?this.getRewardGroup.visible=!0:this.investmentGroup.visible=!0;for(var n=0;6>n;n++)this["bigReward"+n]&&t[0].showReward&&(this["bigReward"+n].data=t[0].showReward[n]);if(this.activityData.buyState&&this.activityData.hadGet?(this.already.visible=!0,this.getBtn.visible=this.redPoint.visible=!1):this.activityData.buyState&&!this.activityData.hadGet&&this.activityData.gotId==e.length?(this.already.visible=!0,this.getBtn.visible=this.redPoint.visible=!1):this.activityData.buyState&&!this.activityData.hadGet&&(this.getBtn.label=LangMgr.getValueByKey("osaQuickGet"),this.already.visible=!1,this.getBtn.visible=this.redPoint.visible=!0),1==t[0].rechargeid.buytype){var o=DataCenter.ins().PayInfoConfig[t[0].rechargeid.rechargeId];this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay",o.cash)}else 2==t[0].rechargeid.buytype&&(this.rechargeBtn.label=LangMgr.getValueByKey("investmentPay1",t[0].rechargeid.count))},e.prototype.onTouchBtn=function(t){switch(t.currentTarget){case this.showDetail0:case this.showDetail1:UIMgr.ins().open(TreasureBasinLuxuryTipsView,this.activityId);break;case this.getBtn:if(!this.activityData.buyState)return void tipsControl.showTips(LangMgr.getValueByKey("noInvestment"));if(this.activityData.hadGet)return void tipsControl.showTips(LangMgr.getValueByKey("tomorrowAlrGetAw"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1);break;case this.rechargeBtn:var e=DataCenter.ins().Amusement16Config[this.activityData.id];1==e[0].rechargeid.buytype?payControl.showReCharge(e[0].rechargeid.rechargeId):2==e[0].rechargeid.buytype&&AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1)}},e.prototype.zeroUpdate=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TreasureBasinLuxuryPanel.prototype,"TreasureBasinLuxuryPanel");
var TreasureBasinLuxuryTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentNewRewardTipsViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.activityId=t[0],this.addEventTouchTap(this.bgClose,this.otherClose),this.fgClose&&this.addEventTouchTap(this.fgClose,this.otherClose),this.detailReward.itemRenderer=TreasureBasinLuxuryTipsItemRenderer;var i=[],n=DataCenter.ins().Amusement16Config[this.activityId];this.activityData=AmusementControl.ins().getAmusementDataById(this.activityId);for(var o=Object.keys(n),s=(this.activityData.gotId>=o.length-1?o.length-1:0==this.activityData.gotId?1:this.activityData.gotId,0);s<o.length;s++){var r=+o[s];if(r){var a={},l=n[r].index;a.state=this.activityData.buyState?l<this.activityData.gotId?!0:l==this.activityData.gotId?this.activityData.hadGet:!1:!1,a.id=n[r].index,a.reward=n[r].reward,i.push(a)}}this.detailReward.dataProvider=new eui.ArrayCollection(i),this.detailReward.validateNow()},e.prototype.otherClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TreasureBasinLuxuryTipsView.prototype,"TreasureBasinLuxuryTipsView");var TreasureBasinMainView=function(t){function e(){var e=t.call(this)||this;return e.curBtnData=[],e.showTypeClass={1:"TreasureBasinView",2:"TreasureBasinEightPanel",3:"TreasureBasinLuxuryPanel",4:"TreasureBasinBargianPanel"},e.skinName="InvestmentViewSkin",e.isTopLevel=!0,e.iconList.itemRenderer=TreasureBasinMainItemRenderer,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.listBar,this.onChange),this.addEventTouchTap(this.iconList,this.onClickMenu),this.addCustomEvent(392,this.updataView),this.index=t.length>0?t[0]:0,this.updataView()},e.prototype.updataView=function(){var t=AmusementControl.ins().activityData,e=[];for(var i in t){var n=t[i];n&&24==n.pageType&&n.isOpenActivity()&&!n.getHide()&&e.push(n)}if(!e)return void UIMgr.ins().close(this);this.curBtnData=[];for(var i in e){var o=AmusementControl.ins().getbtnInfo(e[i].id);Assert(o," not btn data   "+e[i])||this.curBtnData.push(o)}this.info.removeChildren(),this.iconList.dataProvider=new eui.ArrayCollection(this.curBtnData),this.iconList.selectedIndex=this.index,this.btnNum=this.curBtnData.length,this.updateDetail(),this.onChange()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cruPanel.close()},e.prototype.onClickMenu=function(t){this.index=this.iconList.selectedIndex,this.updateDetail()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.onChange=function(){this.iconList.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.iconList.scrollH>88*(this.iconList.dataProvider.length-5)+2?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.btnNum<=5&&(this.leftBtn.visible=!1,this.rightBtn.visible=!1)},e.prototype.updateDetail=function(t){this.cruPanel&&(this.cruPanel.close(),DisplayUtils.removeFromParent(this.cruPanel));var e=this.curBtnData[this.iconList.selectedIndex];if(e){var i=egret.getDefinitionByName(this.showTypeClass[e.showType]);this.cruPanel=new i,this.cruPanel&&(this.cruPanel.left=0,this.cruPanel.right=0,this.cruPanel.top=0,this.cruPanel.bottom=0,this.cruPanel.activityId=e.id,this.info.addChild(this.cruPanel),this.cruPanel.open(t),this.title.source=this.curBtnData[this.index].title)}},e}(BaseEuiView);__reflect(TreasureBasinMainView.prototype,"TreasureBasinMainView");var AmusementType11DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rewardInfo=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this._rewardInfo=t[0],this._achieveInfo=[],this._achieveInfo.length=Object.keys(DataCenter.ins().Amusement11_2Config[this.id]).length;for(var e=0;e<t[1].length;e++)this._achieveInfo[t[1][e][0]-1]={times:t[1][e][1],isGot:t[1][e][2]};var i,n=this._achieveInfo.length;this._hiScore=0;for(var o=this.getCurDay(),e=0;n>e;e++)this._achieveInfo[e]||(this._achieveInfo[e]={times:0,isGot:0}),i=DataCenter.ins().Amusement11_2Config[this.id][e+1],(!i.day||o>=i.day)&&(this._hiScore+=Math.floor(this._achieveInfo[e].times/i.target)*i.score)},Object.defineProperty(e.prototype,"rewardInfo",{get:function(){return this._rewardInfo},enumerable:!0,configurable:!0}),e.prototype.gethiScore=function(t){if(t&&this._achieveInfo){for(var e=0,i=0;i<this._achieveInfo.length;i++){var n=i+1,o=DataCenter.ins().Amusement11_2Config[this.id][n];o.group==t&&this._achieveInfo[i].isGot&&(e+=o.score)}return e}return this._hiScore},Object.defineProperty(e.prototype,"achieveInfo",{get:function(){return this._achieveInfo},enumerable:!0,configurable:!0}),e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkPhaseAward=function(t){for(var e=DataCenter.ins().Amusement11_1Config[this.id],i=Object.keys(e).length,n=1;i>=n;n++){var o=0;if((7==e[n].showType||9==e[n].showType||10==e[n].showType)&&(o=n,this.checkSuccess(n)&&(isNaN(t)||n==t)&&this.IsPreCondition(n)&&(this._rewardInfo>>n&1)<=0&&this.gethiScore(o)>=e[n].score))return!0}return!1},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e.prototype.getCurDay=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t>=0?0:0>=e?0:Math.ceil(Math.abs(t)/86400)},e.prototype.IsPreCondition=function(t){var e=DataCenter.ins().Amusement11_1Config[this.id][t];if(!e.condition)return!0;for(var i=0;i<e.condition.length;i++)if((this._rewardInfo>>e.condition[i]&1)<=0)return!1;return!0},e.prototype.checkSuccess=function(t){var e=DataCenter.ins().Amusement11_2Config[this.id];for(var i in e)if((isNaN(t)||t==e[i].group)&&!this._achieveInfo[e[i].index-1].isGot)return!1;return!0},e.prototype.IsCanGetReward=function(){var t=DataCenter.ins().Amusement11_1Config[this.id];if(!t)return!1;for(var e in t){var i=t[e].index;if(this.IsPreCondition(i)){var n=DataCenter.ins().Amusement11_2Config[this.id];if(!n)return!1;for(var o in n)if(isNaN(i)||i==n[o].group){var s=this._achieveInfo[n[o].index-1];if(s&&!s.isGot&&s.times>=n[o].dayLimit)return!0}}}return!1},e.prototype.checkRedPoint=function(){var t,i,n,o=DataCenter.ins().Amusement11_1Config[this.id],s=DataCenter.ins().Amusement11_2Config[this.id],r=0;switch(o[1].showType){case 1:for(var a in o)if(t=o[a],!(this.rewardInfo>>t.index&1)&&this.gethiScore()>=t.score)return!0;break;case 2:case 6:case 8:r=this.getCurDay();for(var a in s)if(i=s[a],n=this.achieveInfo[i.index-1],r>=i.day&&!n.isGot&&n.times>=i.dayLimit)return!0;break;case 5:case 4:case 3:for(var a in o)if(t=o[a],!(this.rewardInfo>>t.index&1)&&this.gethiScore()>=t.score)return!0;r=this.getCurDay();for(var a in s)if(i=s[a],n=this.achieveInfo[i.index-1],r>=i.day&&!n.isGot&&n.times>=i.dayLimit)return!0;break;case 7:for(var a in o){t=o[a];var l=t.index;if(this.IsCanGetReward())return!0;if(this.checkSuccess(l)&&this.IsPreCondition(l)&&(this._rewardInfo>>l&1)<=0&&this.gethiScore(l)>=t.score)return!0}break;case 9:case 10:for(var h in o){t=o[h];var l=t.index;for(var u in s)if(isNaN(l)||l==s[u].group){var p=this._achieveInfo[s[u].index-1];if(p&&!p.isGot&&p.times>=s[u].dayLimit)return!0}if(this.IsPreCondition(l)&&(this._rewardInfo>>l&1)<=0&&this.gethiScore(l)>=t.score)return!0}}if(o[1].activityID){var c=o[1].activityID,d=amusementControl.activityData[c];if(d&&22==d.type&&amusementControl.getAmusementDataById(c).isOpenActivity()&&!amusementControl.getAmusementDataById(c).getHide()){var g=DataCenter.ins().Amusement22_1Config[c];if(g&&2==g[1].showType){if(d.refreshFree&&e.FIRST_OPEN_SHOP)return!0}else if(e.FIRST_OPEN_SHOP||d.refreshFree)return!0}}return!1},e.prototype.getProcessByGroup=function(t){var e=DataCenter.ins().Amusement11_2Config[this.id],i=0,n=0,o=0;for(var s in e)if(isNaN(t)||t==e[s].group){var r=this._achieveInfo[e[s].index-1];r&&(n++,r.times>=e[s].dayLimit&&i++)}return o=Math.floor(i/n*100),[i,n,o]},e.FIRST_OPEN_SHOP=!0,e}(AmusementBaseDataVo);__reflect(AmusementType11DataVo.prototype,"AmusementType11DataVo");var TreasureBasinView2=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.closeBtn)UIMgr.ins().close(this);else if(e==this.submitBtn||e==this.submitBtn0)this.sendGetAward();else if(e==this.lookBtn||e==this.detail){var i=AmusementControl.ins().getAmusementDataById(this.activityId),n=this.detail?"NewYearInvestDetailViewSkin":"";i&&UIMgr.ins().open(TreasureBasinAwardView,i.id,n)}},e}(TreasureBasinView);__reflect(TreasureBasinView2.prototype,"TreasureBasinView2");var NewYearPropItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="NewYearPropItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.item.data=e,this.item.hideName()},e}(BaseItemRender);__reflect(NewYearPropItemRender.prototype,"NewYearPropItemRender");var TreasureBasinBargianItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLevelItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.reward.itemRenderer=ItemBase,this.getBtn.addEventListener(egret.TouchEvent.TOUCH_END,this.onClick,this)},e.prototype.onClick=function(){if(!this.activityData.buyState)return void AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1);if(this.getReawrd())return void tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet"));var t=this.data.zsLevelLimit||0,e=this.data.levelLimit||0;ActorControl.level<e||reincarnateControl.lv<t?tipsControl.showTips(LangMgr.getValueByKey("happyTips7")):backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView):AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1)},e.prototype.getReawrd=function(){return this.activityData.buyState?this.data.index<this.activityData.gotId?!0:this.data.index==this.activityData.gotId?this.activityData.hadGet:!1:!1},e.prototype.sendRecharge=function(){var t=DataCenter.ins().Amusement16Config[this.activityData.id];1==t[0].rechargeid.buytype?payControl.showReCharge(t[0].rechargeid.rechargeId):AmusementControl.ins().upReward(this.activityData.id,this.activityData.gotId+1)},e.prototype.dataChanged=function(){var t=this.data.zsLevelLimit||0,e=this.data.levelLimit||0,i="";t&&(i+=LangMgr.getValueByKey("numberRotation",t)),e&&(i+=LangMgr.getValueByKey("numberLevel",e)),this.lvBitmapLabel.text=i,this.reward.dataProvider=new eui.ArrayCollection(this.data.reward),this.activityData=AmusementControl.ins().getAmusementDataById(this.data.Id),this.redPoint.visible=this.isCondition(),this.alreadyImg.visible=this.getReawrd(),this.getBtn.visible=!this.alreadyImg.visible},e.prototype.isCondition=function(){if(!this.activityData.buyState)return!0;var t=this.data.zsLevelLimit||0,e=this.data.levelLimit||0;return this.activityData.buyState&&!this.getReawrd()&&ActorControl.level>=e&&reincarnateControl.lv>=t?!0:!1},e}(BaseItemRender);__reflect(TreasureBasinBargianItemRenderer.prototype,"TreasureBasinBargianItemRenderer");var TreasureBasinEightItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestmentLoginListItemSkin",e.reward.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){this.dayInfo.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("whichDayAw",this.data.index)),this.activityData=AmusementControl.ins().getAmusementDataById(this.data.Id);var t=this.activityData.gotId;this.redPoint.visible=this.activityData.hadGet?!1:this.data.index==t+1&&this.activityData.buyState,this.alreadyImg.visible=this.data.index<=t;for(var e=[],i=0;i<this.data.reward.length;i++)e.push(this.data.reward[i]);this.reward.dataProvider=new eui.ArrayCollection(e),this.reward.validateNow()},e}(BaseItemRender);__reflect(TreasureBasinEightItemRenderer.prototype,"TreasureBasinEightItemRenderer");var TreasureBasinItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="TreasureBasinItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.update()},e.prototype.update=function(){var t=this.data;this.itemIcon.data=t.bigAward;var e=amusementControl.getAmusementDataById(t.Id);this.getImg.visible=e.gotId>=t.index,this.selectImg.visible=this.getNextSelectId()==t.index},e.prototype.getNextSelectId=function(){for(var t=this.data,e=amusementControl.getAmusementDataById(t.Id),i=DataCenter.ins().Amusement16Config[t.Id],n=e.gotId+1;i[n];){if(i[n].bigAward)return n;n+=1}return e.gotId},e}(BaseItemRender);__reflect(TreasureBasinItemRender.prototype,"TreasureBasinItemRender");var TreasureBasinLuxuryTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="InvestMonthRewardItemSkin",e.rewardList.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.already.visible=this.data.state,this.dayCount.text=LangMgr.getValueByKey("activitDayIndex",this.data.id),this.rewardList.dataProvider=new eui.ArrayCollection(this.data.reward))},e}(BaseItemRender);__reflect(TreasureBasinLuxuryTipsItemRenderer.prototype,"TreasureBasinLuxuryTipsItemRenderer");var TreasureBasinMainItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ActBtnStatusSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.iconDisplay.source=this.data.icon;var t=AmusementControl.ins().activityData[this.data.id];this.redPoint.visible=t.canReward()}},e}(BaseItemRender);__reflect(TreasureBasinMainItemRenderer.prototype,"TreasureBasinMainItemRenderer");var TreasureBasinRewardItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.desc.textFlow=TextUtils.generateTextFlow1(e.awardDesc),this.dayCount.text=""+e.index,this.rewardList.itemRenderer=ItemBase,this.rewardList.dataProvider=new eui.ArrayCollection(e.reward)},e}(BaseItemRender);__reflect(TreasureBasinRewardItemRender.prototype,"TreasureBasinRewardItemRender");var UnlimitedAmusementView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementWinViewSkin",e}return __extends(e,t),e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.menuList.itemRenderer=AmusementBtnItemRender},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.apply(this,e),this.updateView(),this.addCustomEvent(392,this.refushRedPoint),this.addCustomEvent(178,this.refushRedPoint),this.addCustomEvent(180,this.refushRedPoint),this.addCustomEvent(182,this.refushRedPoint),this.addCustomEvent(446,this.refushRedPoint),this.addCustomEvent(437,this.refushRedPoint),this.title.source="biaoti_wxfl"},e.prototype.getDataUpdataView=function(){var t=amusementControl.activityData;for(var e in t)if(t[e]&&3==t[e].timeType&&amusementControl.getAmusementDataById(+e).isOpenActivity()){var i=amusementControl.getbtnInfo(e);if(!i||i.activityType&&2==i.activityType)continue;Assert(i,"UnlimitedAmusementView  data   "+e)||this._datas.push(i)}},e.prototype.onClickMenu=function(e){t.prototype.onClickMenu.call(this,e);var i=DataCenter.ins().AmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID];if(1==this.amusementPanelList[this.selectIndex].activityType&&(i=DataCenter.ins().PAmusementBtnConfig[this.amusementPanelList[this.selectIndex].activityID]),i.type){var n=void 0,o=this.amusementPanelList[this.selectIndex].activityType;0==o?n=DataCenter.ins().AmusementConfig[this.amusementPanelList[this.selectIndex].activityID]:1==o&&(n=DataCenter.ins().PAmusementConfig[this.amusementPanelList[this.selectIndex].activityID]),n&&(3==n.activityType||9==n.activityType||19==n.activityType?this.setOpenIndex(this.selectIndex):0==o?amusementControl.upChangePage(this.amusementPanelList[this.selectIndex].activityID):1==o&&pAmusementControl.upChangePage(this.amusementPanelList[this.selectIndex].activityID))}else this.setOpenIndex(this.selectIndex)},e.prototype.sort=function(t,e){return t.sort>e.sort?1:-1},e}(AmusementBaseView);__reflect(UnlimitedAmusementView.prototype,"UnlimitedAmusementView");var AmuseTarget103Panel1ItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget103Panel1ItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.get,this.onClick)},e.prototype.onClick=function(t){this.config.num&&this.haveTimes>=this.config.num?tipsControl.showTips(LangMgr.getValueByKey("guildTimeEnought")):this.goodsTimes<this.data.itemId[0].count?tipsControl.showTips(LangMgr.getValueByKey("zhuzaiPropEnought")):amusementControl.upReward(this.data.Id,this.data.index)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e,i;if(this.data&&this.data.itemId){this.config=this.data,e=AmusementControl.ins(),i=e.getAmusementDataById(this.config.Id),this.box1.data=this.data.itemId[0],this.box2.data=this.data.exchangeYB[0],this.haveTimes=i.getUseTimes(this.data.index),this.goodsTimes=backpackControl.getBagGoodsCountById(0,this.data.itemId[0].id);var n=this.goodsTimes>=this.data.itemId[0].count?ColorUtils.GREEN:LangMgr.getColor("color22");if(this.box1info.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+this.goodsTimes+"|/"+this.data.itemId[0].count),this.config.num){var o=this.haveTimes>=this.config.num?LangMgr.getColor("color22"):LangMgr.getColor("color42");this.limitchange.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitAllServerRest2",o,this.haveTimes,this.config.num))}else this.limitchange.text="";this.haveTimes>=this.config.num?this.get.currentState="disabled":this.get.currentState="up"}},e}(BaseItemRender);__reflect(AmuseTarget103Panel1ItemRender.prototype,"AmuseTarget103Panel1ItemRender");var VersionCeleProjectItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ItemBase,this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect},e.prototype.dataChanged=function(){this._listCollect.source=this.data.conf.reward,this.pName.textFlow=TextUtils.generateTextFlow1(this.data.conf.name);var t=this.data.conf.rate||1;this.scedule.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color43")+"&T:"+Math.floor(this.data.times/t)+"|/"+Math.floor(this.data.conf.dayLimit/t)),this.currentState=2==this.data.state?"done":"normal",this.redpoint.visible=1==this.data.state,this.score.text=this.data.conf.score,0==this.data.state&&this.data.conf.turn?(this.actBtn.enabled=!0,this.actBtn.label=LangMgr.getValueByKey("traval")):(this.actBtn.label=LangMgr.getValueByKey("take"),this.actBtn.enabled=1==this.data.state),this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRmove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){t.target==this.actBtn&&(0==this.data.state&&this.data.conf.turn?UIMgr.ins().open(this.data.conf.turn[0],this.data.conf.turn[1]):amusementControl.upReward(this.data.activityID,this.data.conf.index,2))},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this,this.onTouch)},e}(BaseItemRender);__reflect(VersionCeleProjectItemRender.prototype,"VersionCeleProjectItemRender");var VersionCeleRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="VersionCeleRewardItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemicon.touchChildren=!1},e.prototype.dataChanged=function(){this.tsNeed.text=this.data.config.score+LangMgr.getValueByKey("fdHappy"),this.get.visible=2==this.data.state,this.redpoint.visible=1==this.data.state,this.arrow.source=this.data.state?"fd_arrow2":"fd_arrow1";var t=this.data.config;this.itemicon.data=t.reward[0],this.itemicon.isShowName(!1),this.itemicon.showNum(!1),this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRmove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch),this.itemicon.touchEnabled=1!=this.data.state,this.itemicon.filters=0==this.data.state?FilterUtils.ARRAY_GRAY_FILTER:null},e.prototype.onTouch=function(t){1==this.data.state&&amusementControl.upReward(this.data.activityID,this.data.index,1)},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this,this.onTouch)},e}(BaseItemRender);__reflect(VersionCeleRewardItemRender.prototype,"VersionCeleRewardItemRender");var VersionCeleStoreItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="VersionCeleStoreItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.data;this.discount.visible=t.buyMax>0,this.limitCount.text=t.zhekou+"",this.itemIcon.data={type:1,id:t.itemID,count:t.itemCount},this.costIcon.source=DataCenter.ins().ItemConfig[DataCenter.ins().Amusement22_1Config[this.data.activityID][1].costItem].icon+"_png",this.money.text="X"+t.materialNum,this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRmove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch),this.buyBtn.label=0==this.data.data.state?LangMgr.getValueByKey("fdBuy"):LangMgr.getValueByKey("fdAlreadingBuy"),this.buyBtn.enabled=0==this.data.data.state},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){if(t.target==this.buyBtn){var e=backpackControl.getBagItemById(DataCenter.ins().Amusement22_1Config[this.data.activityID][1].costItem),i=e?e.count:0;i>=this.data.data.materialNum?amusementControl.upReward(this.data.activityID,0,3,this.data.data.id):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"))}},e}(BaseItemRender);__reflect(VersionCeleStoreItemRender.prototype,"VersionCeleStoreItemRender");var VersionCelestoreShowItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="VersionCelestoreShowItemSkin",e}return __extends(e,t),e.prototype.update=function(t){this.itemID=t.itemID,this.itemImg.source=DataCenter.ins().ItemConfig[t.itemID].icon+"_png",this.limitCount.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("fdStorLimit",t.buy,t.max)),this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRmove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch)},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){this.itemID&&UIMgr.ins().open(ItemTipsView,0,this.itemID)},e}(BaseItemRender);__reflect(VersionCelestoreShowItemRender.prototype,"VersionCelestoreShowItemRender");var VersionCeleTabBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){this.tabName.text=this.data.gName,this.redpoint.visible=this.data.showRed},Object.defineProperty(e.prototype,"selected",{set:function(t){this.currentState=t?"select":"unselect",this.data&&(this.redpoint.visible=this.data.showRed)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(VersionCeleTabBtnItemRender.prototype,"VersionCeleTabBtnItemRender");var ArtifactControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listArtifacts={},e.showGuide=-2e3,e.openHeji=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getNewArtifactPower=function(t){var e=DataCenter.ins().ArtifactImbaConfig[t],i=this.listArtifacts[e.id];if(!i)return 0;for(var n=0,o=0;o<e.jigsawId.length;o++){var s=i.record>>o&1;s&&(n+=DataCenter.ins().ArtifactImbaSawConfig[e.jigsawId[o]].power)}return i.open&&(n+=e.power),n},e.prototype.getAttr=function(){var t={};for(var e in DataCenter.ins().ArtifactImbaConfig){for(var i=DataCenter.ins().ArtifactImbaConfig[e],n=this.getNewArtifactBy(i.index),o=0;o<i.jigsawId.length;o++){var s=n.record>>o&1;if(s)for(var r=DataCenter.ins().ArtifactImbaSawConfig[i.jigsawId[o]],a=0;a<r.attrs.length;a++){var l=r.attrs[a];AttributeData.addAttrToList(t,l)}}if(n.open&&i.attrs)for(var o=0;o<i.attrs.length;o++)AttributeData.addAttrToList(t,i.attrs[o])}var h=[];for(var u in t)h.push(t[u]);return h.sort(AttributeData.sortAttribute),h},e.prototype.getArtifactIndexById=function(t){for(var e in DataCenter.ins().ArtifactImbaConfig)if(DataCenter.ins().ArtifactImbaConfig[e].id==t)return DataCenter.ins().ArtifactImbaConfig[e].index;return 0},e.prototype.getNewArtifactBy=function(t){var e=0;if(!DataCenter.ins().ArtifactImbaConfig[t])return null;if(e=DataCenter.ins().ArtifactImbaConfig[t].id,!this.listArtifacts[e]){var i=new ArtifactVo;i.id=e,i.record=0,this.listArtifacts[e]=i}return this.listArtifacts[e]},e.prototype.getMaxIndex=function(){if(!this.maxIndex){var t=1,e=DataCenter.ins().ArtifactImbaConfig;for(var i in e)t=Math.max(e[i].index,t);this.maxIndex=t}return this.maxIndex},e.prototype.getConfById=function(t){var e=DataCenter.ins().ArtifactImbaConfig;for(var i in e)if(e[i].id==t)return e[i]},e.prototype.showRedPoint=function(){for(var t=this.getMaxIndex(),e=1;t>=e;e++){var i=DataCenter.ins().ArtifactImbaConfig[e],n=this.getNewArtifactBy(e);if(!n.open){var o=i.jigsawId.length,s=Math.pow(2,o)-1;if(s==n.record)return!0;if(n.exitRecord!=n.record)return!0}}return!1},e.prototype.getConfByChipId=function(t){var e=DataCenter.ins().ArtifactImbaConfig;for(var i in e)if(-1!=e[i].jigsawId.indexOf(t))return e[i];return null},e.prototype.setGuide=function(){this.showGuide=egret.getTimer(),this.dispatchGuide(),TimerMgr.ins().remove(this.guideEnd,this),TimerMgr.ins().doTimer(3e3,1,this.guideEnd,this)},e.prototype.guideEnd=function(){artifactControl.showGuide=-3e3,artifactControl.dispatchGuide()},e.prototype.dispatchGuide=function(){EventMgr.ins().dispatch(686)},e.prototype.downNewArtifactInit=function(t){this.artifactsOpenDic={};for(var e=0;e<t.length;e++){var i=new ArtifactVo;i.id=t[e][0],i.record=t[e][1],i.open=0!=t[e][2],i.open?(i.exitRecord=Math.pow(2,32)-1,1==t.length&&1==this.openHeji&&(this.openHeji=2)):i.exitRecord=t[e][3],this.listArtifacts[i.id]=i,i.open&&(this.artifactsOpenDic[i.id]=i)}this.setImbaBuffDic(),EventMgr.ins().dispatch(45)},e.prototype.setImbaBuffDic=function(){if(!this.imbaBuffDic){this.imbaBuffDic={};var t=DataCenter.ins().SkillsImbaReviseConfig;for(var e in t)this.imbaBuffDic[t[e].skill]||(this.imbaBuffDic[t[e].skill]={}),this.imbaBuffDic[t[e].skill][t[e].imba_id]||(this.imbaBuffDic[t[e].skill][t[e].imba_id]={}),this.imbaBuffDic[t[e].skill][t[e].imba_id]=t[e]}var i=CommonUtils.getObjectLength(this.artifactsOpenDic);if(i){this.imbaSkillDic={};for(var n in this.imbaBuffDic)for(var o in this.imbaBuffDic[n])if(this.artifactsOpenDic[o]){this.imbaSkillDic[n]||(this.imbaSkillDic[n]={});for(var s in this.imbaBuffDic[n][o])"selfEff"==s?(this.imbaSkillDic[n][s]||(this.imbaSkillDic[n][s]=[]),this.imbaSkillDic[n][s].push(this.imbaBuffDic[n][o][s][0])):"args"==s?this.imbaSkillDic[n][s]=this.imbaBuffDic[n][o][s]:this.imbaSkillDic[n][s]+=this.imbaBuffDic[n][o][s]}}},e.prototype.getReviseBySkill=function(t){if(!this.imbaSkillDic)return null;var e=Math.floor(t/1e3);return this.imbaSkillDic[e]?this.imbaSkillDic[e]:null},e.prototype.downNewArtifactUpdate=function(t,e,i){var n=this.listArtifacts[t];if(n)n.exitRecord=e,n.record=i;else{var o=new ArtifactVo;o.id=t,o.exitRecord=e,o.record=i,this.listArtifacts[t]=o}EventMgr.ins().dispatch(46)},e.prototype.upOpenChip=function(t){return[t]},e.prototype.upOpenArtifact=function(t){return 0==this.openHeji&&(this.openHeji=1),[t]},__decorate([down(3,[[3,3,11,3]])],e.prototype,"downNewArtifactInit",null),__decorate([down(4,[3,3,3])],e.prototype,"downNewArtifactUpdate",null),__decorate([up(4,[3])],e.prototype,"upOpenChip",null),__decorate([up(3,[3])],e.prototype,"upOpenArtifact",null),e=__decorate([protocolsId(26)],e)}(BaseSystem);__reflect(ArtifactControl.prototype,"ArtifactControl");var ArtifactVo=function(){function t(){this.id=0,this.record=0,this.open=!1,this.exitRecord=0}return t.prototype.isChipExit=function(t){return 1==(this.exitRecord>>t&1)},t.prototype.isChipOpen=function(t){return 1==(this.record>>t&1)},t.prototype.getChipLength=function(){return DataCenter.ins().ArtifactImbaConfig[this.id].jigsawId.length},t.prototype.getNextChipId=function(){for(var t=DataCenter.ins().ArtifactImbaConfig[this.id],e=0;e<t.jigsawId.length;e++)if(!this.isChipExit(e))return t.jigsawId[e];return null},t.prototype.remindNumToOpen=function(){for(var t=this.getConf(),e=0,i=0;i<t.jigsawId.length;i++)this.isChipExit(i)||e++;return e},t.prototype.getConf=function(){return this.cfg||(this.cfg=artifactControl.getConfById(this.id)),this.cfg},t}();__reflect(ArtifactVo.prototype,"ArtifactVo");var RecoveryLogItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoticeListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=smeltControl.getLinkText(this.data);this.showText.textFlow=TextUtils.generateTextFlow1(t)},e.prototype.linkClick=function(t){var e=t.text.split(","),i=e.slice(1);e[0]&&(isNaN(Number(e[0]))?(UIMgr.ins().open(e[0],i[0]?i:null),UIMgr.ins().close(this)):CommonFun.viewItemTips(+e[1],+e[2]))},e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.addEventTextLink(this.showText,this.linkClick)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.removeEventTextLink(this.showText,this.linkClick)},e}(BaseItemRender);__reflect(RecoveryLogItemRender.prototype,"RecoveryLogItemRender");var ArtifactAllAttrView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ArtifactAllAttrViewSkin",e.uilayer=GameLayer.POPUP,e.list.itemRenderer=ArtifactAttrDescItemRenderer,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.rect,this.onTap),this.list.dataProvider=new eui.ArrayCollection(artifactControl.getAttr())},e.prototype.close=function(){this.removeEventTouchTap(this.rect,this.onTap)},e.prototype.onTap=function(t){switch(t.target){case this.rect:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ArtifactAllAttrView.prototype,"ArtifactAllAttrView");var ArtifactChipOpenView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ArtifactChipOpenViewSkin",e.uilayer=GameLayer.POPUP,e.list.itemRenderer=ArtifactAttrDescItemRenderer,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[1],this.mId=t[0],this.openTips(this.mId),this.addEventTouchTap(this.btnOpen,this.onTap)},e.prototype.close=function(){this.removeEventTouchTap(this.btnOpen,this.onTap)},e.prototype.openTips=function(t){var e=artifactControl.getNewArtifactBy(this.index),i=DataCenter.ins().ArtifactImbaSawConfig[t];
this.list.dataProvider=new eui.ArrayCollection(i.attrs),this.imgArtifact.source=i.img,this.labelInfo.text=LangMgr.getValueByKey("artGetOpenWin",e.remindNumToOpen()),this.labelName.text=i.name},e.prototype.onTap=function(t){switch(t.target){case this.btnOpen:artifactControl.upOpenChip(this.mId),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ArtifactChipOpenView.prototype,"ArtifactChipOpenView");var ArtifactPanel=function(t){function e(){var e=t.call(this)||this;return e.arrImage=[],e.name=LangMgr.getValueByKey("equipment19"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.mc=new GameMovieClip,this.groupEff.addChild(this.mc),this.mc.x=0,this.mc.y=0,this.mc.playFile(PATH_EFF+"artifacteff",-1),this.pieceCom.piece.itemRenderer=ArtifactChipItemRenderer,this.turnicon.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("artFaceWin")),this.eff=new GameMovieClip,this.eff.touchEnabled=!1},e.prototype.open=function(){this.index=1,this.addEventTouchTap(this.imgLeft,this.onTap),this.addEventTouchTap(this.imgRight,this.onTap),this.addEventTouchTap(this.btnOpen,this.onTap),this.addEventTouchTap(this.detail,this.onTap),this.addEventTouchTap(this.turnicon,this.onTap),this.addEventItemTap(this.pieceCom.piece,this.onLink),this.addCustomEvent(46,this.updateView),this.addCustomEvent(45,this.updateView),this.getGuideTips(),this.updateView()},e.prototype.close=function(){DisplayUtils.removeFromParent(this.eff),egret.Tween.removeTweens(this.groupMaterial),UIMgr.ins().close(ArtifactChipOpenView),this.removeCustomEvents(),this.removeEventTouchTap(this.imgLeft,this.onTap),this.removeEventTouchTap(this.imgRight,this.onTap),this.removeEventTouchTap(this.btnOpen,this.onTap),this.removeEventTouchTap(this.detail,this.onTap),this.removeEventTouchTap(this.turnicon,this.onTap),this.removeEventItemTap(this.pieceCom.piece,this.onLink)},e.prototype.onTap=function(t){switch(this.isBtnOpen=!1,t.target){case this.imgLeft:if(1==this.index)break;this.index--,this.updateView();break;case this.imgRight:this.index<artifactControl.getMaxIndex()&&this.getIsNext()&&this.index++,this.updateView();break;case this.btnOpen:this.isBtnOpen=!0,artifactControl.upOpenArtifact(this.index);break;case this.detail:UIMgr.ins().open(ArtifactAllAttrView);break;case this.turnicon:var e=DataCenter.ins().ArtifactImbaConfig[this.index];e&&e.winGuide&&(GuideControl.guidance(e.winGuide[0],e.winGuide[1]),"ExperienceView"!=e.winGuide[0]&&UIMgr.ins().close(ExperienceView))}},e.prototype.getIsNext=function(){if(1==this.index)return!0;var t=this.index-1,e=artifactControl.getNewArtifactBy(t);return e.open},e.prototype.updateView=function(){var t=DataCenter.ins().ArtifactImbaConfig[this.index],e=artifactControl.getNewArtifactBy(this.index);e&&e.open&&t.turnDesc?(this.turnicon.visible=!0,this.turnicon.textFlow=(new egret.HtmlTextParser).parser("<u>"+t.turnDesc+"</u>")):this.turnicon.visible=!1,this.imgOpen.visible=!e.open,this.getGuideMaterialId(this.index)?(this.imgArtfact.source=t.imgShadow,this.setMaterialImg(),this.groupEff.visible=!1,this.currentState="normal",DisplayUtils.removeFromParent(this.eff),egret.Tween.removeTweens(this.groupMaterial),this.groupMaterial.x=42,this.groupMaterial.y=101):e.open?(this.imgArtfact.source=t.img,this.cleanMaterialImg(),this.groupEff.visible=!0,this.currentState="normal",DisplayUtils.removeFromParent(this.eff),this.artifactTween()):(this.imgArtfact.source=t.imgShadow,this.setMaterialImg(),this.groupEff.visible=!1,this.currentState="open",this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||(this.btnOpen.addChild(this.eff),this.eff.x=this.btnOpen.width/2,this.eff.y=this.btnOpen.height/2),egret.Tween.removeTweens(this.groupMaterial),this.groupMaterial.x=42,this.groupMaterial.y=101),this.imgName.source=t.imgName,this.labelAttr.text=t.funcDesc,this.imgFunc.source=t.simpleDesc;for(var i=[],n=artifactControl.getNewArtifactBy(this.index),o=0,s=0;8>s;s++){var r=n.record>>s&1,a=n.exitRecord>>s&1&&0==r,l={};l.state=r,l.state2=a;var h=t.jigsawId[s],u="",p="";h&&(u=DataCenter.ins().ArtifactImbaSawConfig[h].name,p=DataCenter.ins().ArtifactImbaSawConfig[h].img,o++),l.name=u,l.index=h,l.img=p,i.push(l)}if(o=o>2?o:2,this.pieceCom.setData(o),this.pieceCom.piece.dataProvider=new eui.ArrayCollection(i),this.pieceCom.piece.validateNow(),this.powerPanel.setPower(artifactControl.getNewArtifactPower(this.index)),this.imgLeft.visible=1!=this.index,this.imgRight.visible=this.index<artifactControl.getMaxIndex()&&this.getIsNext(),e.open&&this.isBtnOpen){this.isBtnOpen=!1;var c=t.img.split("_"),p=c[0]+"_"+c[1];CommonFun.show(0,t.name,"j"+p+"_png",null,!0,function(){t.winGuide&&(UIMgr.ins().open(t.winGuide[0],t.winGuide[1]),"ExperienceView"!=t.winGuide[0]&&UIMgr.ins().close(ExperienceView))})}},e.prototype.artifactTween=function(){var t=egret.Tween.get(this.groupMaterial,{loop:!0});t.to({y:60},1e3).to({y:101},1e3)},e.prototype.getGuideTips=function(){for(var t=artifactControl.getMaxIndex(),e=1;t>=e;e++){var i=artifactControl.getNewArtifactBy(e);if(this.index=e,!i.open)break}},e.prototype.getGuideMaterialId=function(t){for(var e=DataCenter.ins().ArtifactImbaConfig[t],i=artifactControl.getNewArtifactBy(t),n=0,o=0;o<e.jigsawId.length;o++)if(!i.isChipOpen(o)){n=e.jigsawId[o];break}return n},e.prototype.openTips=function(t){var e=artifactControl.getNewArtifactBy(this.index),i=DataCenter.ins().ArtifactImbaConfig[this.index],n=i.jigsawId.indexOf(t),o=e.record>>n&1,s=e.exitRecord>>n&1&&!o;s?UIMgr.ins().open(ArtifactChipOpenView,t,this.index):UIMgr.ins().open(ArtifactTipsView,t,this.index)},e.prototype.setMaterialImg=function(){this.cleanMaterialImg();for(var t=DataCenter.ins().ArtifactImbaConfig[this.index],e=artifactControl.getNewArtifactBy(this.index),i=0;i<t.jigsawId.length;i++){if(!this.arrImage[i]){var n=new eui.Image;this.arrImage[i]=n,this.groupMaterial.addChild(n)}if(e.isChipOpen(i)){var o=DataCenter.ins().ArtifactImbaSawConfig[t.jigsawId[i]];this.arrImage[i].source=o.img,this.arrImage[i].visible=!0,this.arrImage[i].x=o.point.x,this.arrImage[i].y=o.point.y}}},e.prototype.cleanMaterialImg=function(){for(var t=0;t<this.arrImage.length;t++)this.arrImage[t].visible=!1},e.prototype.onLink=function(t){var e=parseInt(t.item.index);isNaN(e)||this.openTips(e)},e}(BasePanel);__reflect(ArtifactPanel.prototype,"ArtifactPanel");var ArtifactSelectItemPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setData=function(t){this.currentState=t.toString()},e}(BasePanel);__reflect(ArtifactSelectItemPanel.prototype,"ArtifactSelectItemPanel");var ArtifactTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ArtifactTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.powerPanel.setBgVis(!1),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1];this.list.itemRenderer=ArtifactAttrDescItemRenderer,this.addEventTouchTap(this.rect,this.onTap),this.setData(i,n)},e.prototype.setData=function(t,e){var i=DataCenter.ins().ArtifactImbaSawConfig[t];this.partname.text=i.name,this.getway.text=i.guide,this.icon.source=i.img;artifactControl.getNewArtifactBy(e);this.list.dataProvider=new eui.ArrayCollection(i.attrs);var n=BackpackControl.getAttrPower(i.attrs);this.powerPanel.setPower(n)},e.prototype.onTap=function(t){switch(t.target){case this.rect:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ArtifactTipsView.prototype,"ArtifactTipsView");var TargetView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TargetViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.taskTip.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.removeEventTouchTap(this.bgClose,this.onTouch),this.removeEventTouchTap(this.button,this.onTouch),this.removeEventTouchTap(this.btn2,this.onTouch),TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.button,this.onTouch),this.addEventTouchTap(this.btn2,this.onTouch),this.addCustomEvent(493,this.upDataGuanqia),1==t[0]?(this.guanqia.visible=!0,this.quest.visible=!1,this.index=this.getArtifactId()):(this.guanqia.visible=!1,this.quest.visible=!0,this.HejiSkillMc1=new GameMovieClip,this.HejiSkillMc1.x=this.roleimg.x+this.roleimg.width/2+73,this.HejiSkillMc1.y=this.roleimg.y+this.roleimg.height/2+70+73,this.quest.addChild(this.HejiSkillMc1),this.HejiSkillMc2=new GameMovieClip,this.HejiSkillMc2.x=this.enenyimg.x+this.enenyimg.width/2+80,this.HejiSkillMc2.y=this.enenyimg.y+this.enenyimg.height/2+167,this.quest.addChild(this.HejiSkillMc2)),this["show"+t[0]]()},e.prototype.show2=function(){var t=heroControl.getSubRoleByIndex(0),i=this.getTaskSum(),n=e.TASKID%100;this.skillName.source="8000"+t.job+"_png",this.questNumber.text=e.TASKID%100-i+1+"",this.mcSkillID="skill40"+t.job,this.targetSkillID="skill"+(403+t.job);var o=0;i=i>0?i:0;var s=(i-1)/n;s=0>=s?0:s,s=s>=1?1:s,o=Math.floor(100*s),this.bar2.value=i-1,this.bar2.maximum=n,this.bar2.labelFunction=function(){return o+"%"},TimerMgr.ins().remove(this.playSkillAnmi,this),TimerMgr.ins().doTimer(3e3,0,this.playSkillAnmi,this),this.playSkillAnmi()},e.prototype.getTaskSum=function(){if(taskControl.taskTrace.id>=e.TASKID)return 0;for(var t in DataCenter.ins().GuideAchievementConfig)if(taskControl.taskTrace.id==DataCenter.ins().GuideAchievementConfig[t].taskId){var i=DataCenter.ins().GuideAchievementConfig[t].index;return i>0?i:0}return 0},e.prototype.show1=function(){var t=DataCenter.ins().ArtifactImbaConfig[this.index];if(t){var e=copyControl.getNextReward();if(e){var i=copyControl.getNewChapter();if(i){var n=this.getChipNum(t),o=copyControl.getDiffChapter(),s=i.needLevel,r=DataCenter.ins().ItemConfig[e[0].id];this.artifactImg.source=t.img,this.itemImg.source=r.icon+"_png",this.artifactname.text=t.name,this.number1.text=n+"",this.des1a1.text=t.funcDesc,this.guanqiaDes2.text=copyControl.getNextNeedChapter()+"",this.artifactName1.text=r.name;var a=0,l=copyControl.guanqiaID-s-1;l=l>0?l:copyControl.guanqiaID;var h=l/o;h=h>=1?1:h,a=Math.floor(100*h),this.bar1.value=l,this.bar1.maximum=o,this.bar1.labelFunction=function(){return a+"%"},this.prossX=0,this.masksp=new egret.Sprite;var u=new egret.Shape;u.graphics.beginFill(LangMgr.getColor("color39")),u.graphics.drawRect(this.btnbar.x,this.btnbar.y,this.btnbar.width,this.btnbar.height),u.graphics.endFill(),this.prossX=this.btnbar.x-this.btnbar.width,this.masksp.y=this.btnbar.y,this.masksp.addChild(u),this.btnbar.parent.addChild(this.masksp),this.btnbar.mask=this.masksp,this.upDataGuanqia()}}}},e.prototype.upDataGuanqia=function(){if(this.masksp){var t=copyControl.currentEnergy,e=copyControl.energy,i=1;e>0&&(i=t/e),i=i>=1?1:i,this.masksp.x=this.prossX+Math.abs(this.prossX)*i}},e.prototype.getChipNum=function(t){for(var e=0,i=0;i<t.jigsawId.length;i++)for(var n in DataCenter.ins().WorldRewardConfig){var o=DataCenter.ins().WorldRewardConfig[n];if(o.rewards[0].id==t.jigsawId[i]){o.needLevel>=copyControl.guanqiaID&&e++;break}}return e},e.prototype.getArtifactId=function(){for(var t=artifactControl.getMaxIndex(),e=1,i=1;t>=i;i++){var n=artifactControl.getNewArtifactBy(i);for(var o in DataCenter.ins().ArtifactImbaConfig)if(DataCenter.ins().ArtifactImbaConfig[o].id==n.id){var s=copyControl.getChipByGuanQia();if(-1!=DataCenter.ins().ArtifactImbaConfig[o].jigsawId.indexOf(s))return e=DataCenter.ins().ArtifactImbaConfig[o].index}}return e},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.bgClose:case this.btn2:UIMgr.ins().close(this);break;case this.button:if(copyControl.currentEnergy>=copyControl.energy){var e=this;GuideControl.challengeBoss(function(){UIMgr.ins().close(e)})}else this.showTaskTips(LangMgr.getValueByKey("tipsNoChallenge"))}},e.prototype.showTaskTips=function(t){var e=this.taskTip;this.taskTipText0.textFlow=TextUtils.generateTextFlow1(t),egret.Tween.removeTweens(e),e.bottom=70,e.visible=!0,egret.Tween.get(e).to({bottom:100},500).wait(2e3).call(function(){e.visible=!1})},e.prototype.playSkillAnmi=function(){var t=this;egret.Tween.removeTweens(this.roleimg);var e=egret.Tween.get(this.roleimg);this.HejiSkillMc1.parent||this.quest.addChild(this.HejiSkillMc1),this.HejiSkillMc1.playFile(""+PATH_SKILLEFF+this.mcSkillID,1,null,!0),e.wait(1500).call(function(){t.HejiSkillMc2.parent||t.quest.addChild(t.HejiSkillMc2),t.HejiSkillMc2.playFile(""+PATH_SKILLEFF+t.targetSkillID,1,null,!0)},this)},e.TASKID=100026,e}(BaseEuiView);__reflect(TargetView.prototype,"TargetView");var ArtifactAttrDescItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ArtifactAttrDescItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=AttributeData.getAttStrByType(t,0,"：");this.labelInfo.text=e},e}(BaseItemRender);__reflect(ArtifactAttrDescItemRenderer.prototype,"ArtifactAttrDescItemRenderer");var ArtifactChipItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ArtifactChipItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){""==this.data.name?(this.itemImg.visible=!1,this.labelMaterial.visible=!1,this.closeImg.visible=!0):(this.data.state?this.labelMaterial.textColor=ColorUtils.GREEN:this.labelMaterial.textColor=LangMgr.getColor("color49"),this.data.state2?(this.mc||(this.mc=new GameMovieClip,this.mc.x=0,this.mc.y=0),this.groupMc.addChild(this.mc),this.mc.playFile(PATH_EFF+"chargeff1",-1)):this.mc&&DisplayUtils.removeFromParent(this.mc),this.itemImg.visible=!0,this.labelMaterial.visible=!0,this.closeImg.visible=!1,this.itemImg.source=this.data.img,this.labelMaterial.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.data.name+"</u>"))},e}(BaseItemRender);__reflect(ArtifactChipItemRenderer.prototype,"ArtifactChipItemRenderer");var AshtarteControl=function(t){function e(){var e=t.call(this)||this;return e._ZhanLingData={},e._ZhanLingSkinId=0,e._showZLlist=[],e.addCustomEvent(112,e.initZhanLing),e.addCustomEvent(266,e.updateShowZLlist),e.addCustomEvent(268,e.updateShowZLlist),e.addCustomEvent(269,e.updateShowZLlist),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.updateShowZLlist()},e.prototype.initZero=function(){!this.getZhanLingDataById(0)&&this.ZhanLingOpen()&&this.setZhanLingData(new AshtarteVo)},e.prototype.initZhanLing=function(){!this.getZhanLingDataById(0)&&this.ZhanLingOpen()&&this.setZhanLingData(new AshtarteVo)},e.prototype.checkRedPoint=function(){if(!this.ZhanLingOpen())return!1;var t=0,e=this.isUpGradeByStar(t)||this.isHintNum(t)||this.getZhanLingItemRedPoint(t);if(e)return!0;if(e=this.isUpGradeByTalent(t))return!0;var i=DataCenter.ins().AshtarteConfig;for(var n in i.upgradeInfo)if(e=this.getZhanLingDataByDrugUse(t,Number(n)))return!0;for(var o=0;o<this.showZLlist.length;o++){var s=this.showZLlist[o];if(t=s.id){if(e=this.isUpGradeByStar(t)||this.isHintNum(t)||this.getZhanLingItemRedPoint(t))return!0;if(e=this.isUpGradeByTalent(t))return!0}}return!1},e.prototype.ZhanLingItemTips=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1),UIMgr.ins().open(AshtarteEquipTipsView,t,e,i)},e.prototype.upUpExp=function(t,e){return void 0===e&&(e=0),[t,e]},e.prototype.upDrug=function(t,e){return[t,e]},e.prototype.upWear=function(t,e){return[t,e]},e.prototype.upComposeItem=function(t){return[t]},e.prototype.upForge=function(t,e){return[t,e]},e.prototype.downForge=function(t,e,i){var n=ashtarteControl.getZhanLingDataById(t);n.forgeLv[e-1]=i,EventMgr.ins().dispatch(709)},e.prototype.upDrugExt=function(t,e){return[t,e]},e.prototype.upSkinUpGrade=function(t){return[t]},e.prototype.upSkinChange=function(t){return[t]},e.prototype.downInfo=function(t,e){for(var i=0;i<t.length;i++){var n=t[i],o=new AshtarteVo;o.id=n[0],o.talentLv=n[1],o.level=n[2],o.exp=n[3],o.drugs=[];for(var s=0;s<n[4].length;s++){var r=n[4][s][0],a=n[4][s][1];o.drugs.push({itemId:r,count:a})}o.items=[];for(var s=0;s<n[5].length;s++)o.items.push(n[5][s]);var l=n[6];if(l)for(var h=0;l.length>h;h++)o.forgeLv[h]=n[6][h];this.setZhanLingData(o)}this.ZhanLingSkinId=e,EventMgr.ins().dispatch(258)},e.prototype.downUpExp=function(t,e,i){var n=this.getZhanLingDataById(t);if(n){var o=n.level;n.level=e,n.exp=i,e>o&&this.dispatchZhanLingUpgrade()}EventMgr.ins().dispatch(259)},e.prototype.dispatchZhanLingUpgrade=function(){EventMgr.ins().dispatch(494)},e.prototype.downDrug=function(t,e,i){var n=this.getZhanLingDataById(t);if(n){for(var o=!1,s=0;s<n.drugs.length;s++)if(n.drugs[s].itemId==e){n.drugs[s].count=i,o=!0;break}o||n.drugs.push({itemId:e,count:i})}EventMgr.ins().dispatch(260)},e.prototype.downWear=function(t,e){var i=this.getZhanLingDataById(t);if(i){var n=DataCenter.ins().AshtarteEquipConfig[e];n&&(i.items[n.pos-1]=e)}EventMgr.ins().dispatch(261)},e.prototype.downComposeItem=function(t,e){var i=this.getZhanLingDataById(t);if(i)for(var n=0;n<e.length;n++)i.items[n]=e[n];EventMgr.ins().dispatch(262)},e.prototype.downBubble=function(t,e,i){var n=UnitMgr.ins().getEntityByHandle(t);n&&n.showZhanling(i,e)},e.prototype.downSkill=function(){var t=0,e=this.getZhanLingDataById(t),i=DataCenter.ins().AshtarteLevelConfig[t][e.level].talentLevel,n=DataCenter.ins().AshtarteTalentConfig[t][i];n&&skillControl.dispatchShowSkillWord(n.showWords)},e.prototype.downSkinUpGrade=function(t,e){var i=this.getZhanLingDataById(t),n=0;i?n=i.talentLv:(i=new AshtarteVo,i.id=t,this.setZhanLingData(i)),e!=n&&EventMgr.ins().dispatch(264),i.talentLv=e,EventMgr.ins().dispatch(263)},e.prototype.downSkinChange=function(t){this.ZhanLingSkinId=t,EventMgr.ins().dispatch(265)},Object.defineProperty(e.prototype,"AshtarteVo",{get:function(){return this._ZhanLingData},enumerable:!0,configurable:!0}),e.prototype.getZhanLingDataById=function(t){return this._ZhanLingData[t]},e.prototype.setZhanLingData=function(t){t&&(this._ZhanLingData[t.id]=t)},Object.defineProperty(e.prototype,"ZhanLingSkinId",{get:function(){return this._ZhanLingSkinId},set:function(t){this._ZhanLingSkinId=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showZLlist",{get:function(){return this._showZLlist},set:function(t){this._showZLlist=t},enumerable:!0,configurable:!0}),e.prototype.ZhanLingOpen=function(){return ActorControl.level>=DataCenter.ins().AshtarteConfig.level&&reincarnateControl.lv>=DataCenter.ins().AshtarteConfig.openzhuanshenglv&&GameServer.serverOpenDay+1>=DataCenter.ins().AshtarteConfig.openserverday},e.prototype.getZhanLingDataByLevel=function(t){return this._ZhanLingData[t]?this._ZhanLingData[t].level:0},e.prototype.getZhanLingDataByStage=function(t){if(!this._ZhanLingData[t]||!this._ZhanLingData[t].level)return 1;var e=Math.floor(this._ZhanLingData[t].level/10),i=Math.floor(this._ZhanLingData[t].level%10);return e+=1,i||(e-=1),e||(e=1),e},e.prototype.getZhanLingDataByNextStage=function(t){var e=0;this._ZhanLingData[t]&&(e=this._ZhanLingData[t].talentLv);var i,n=DataCenter.ins().AshtarteLevelConfig[t];for(var o in n){var s=n[o];if(s.talentLevel>e){i=s;break}}return i?this.getStageLv(i.level):null},e.prototype.getZhanLingDataByStar=function(t){if(!this._ZhanLingData[t]||!this._ZhanLingData[t].level)return 0;var e=Math.floor(this._ZhanLingData[t].level%10);return e||(e=10),e},e.prototype.getZhanLingDataByTalentLv=function(t){if(!this._ZhanLingData[t])return 0;var e=this.getZhanLingDataByLevel(t),i=DataCenter.ins().AshtarteLevelConfig[t][e].talentLevel;return i&&(this._ZhanLingData[t].talentLv=i),this._ZhanLingData[t].talentLv},e.prototype.getZhanLingDataByExp=function(t){return this._ZhanLingData[t]?this._ZhanLingData[t].exp:0},e.prototype.getZhanLingDataByItem=function(t,e){return this._ZhanLingData[t]?this._ZhanLingData[t].items[e-1]:0},e.prototype.getZhanLingDataByDrugUse=function(t,e){if(!this._ZhanLingData[t])return!1;var i=0,n=backpackControl.getBagItemById(e);if(i=n?n.count:0,!i)return!1;var o=this._ZhanLingData[t].level,s=DataCenter.ins().AshtarteLevelConfig[t][o];t&&!s.maxCount;var r=!1;if(s.maxCount&&s.maxCount[e])for(var a=0;a<this._ZhanLingData[t].drugs.length;a++)if(this._ZhanLingData[t].drugs[a].itemId==e&&this._ZhanLingData[t].drugs[a].count>=s.maxCount[e]){r=!0;break}return r?!1:!0},e.prototype.getZhanLingDataByTalentId=function(t){var e=DataCenter.ins().AshtarteBaseConfig[t];return e?e.talent:0},e.prototype.getZhanLingDataBySkill=function(t){var e=[];return this._ZhanLingData[t]?DataCenter.ins().AshtarteBaseConfig[t].skill:e},e.prototype.getZhanLingDataByDrug=function(t,e){if(!this._ZhanLingData[t])return 0;for(var i=0;i<this._ZhanLingData[t].drugs.length;i++)if(this._ZhanLingData[t].drugs[i].itemId==e)return this._ZhanLingData[t].drugs[i].count;return 0},e.prototype.getZhanLingDataDrugExCount=function(t,e){var i=DataCenter.ins().AshtarteConfig.upgradeInfo[e].ex,n=ashtarteControl.getZhanLingDruyExtLevel(t,i);if(0==n)return 0;var o=DataCenter.ins().AshtartePillExConfig[i][n];return o?o.addLimit:0},e.prototype.getZhanLingDruyExtLevel=function(t,e){var i=this.getZhanLingDataById(t);if(!i)return 0;for(var n=i.drugExt,o=0,s=n;o<s.length;o++){var r=s[o];if(r.itemId==e)return r.level}return 0},e.prototype.getZhanLingDataBySuit=function(t){if(!this._ZhanLingData[t])return 0;for(var e=0,i=0;i<this._ZhanLingData[t].items.length;i++){var n=this._ZhanLingData[t].items[i],o=DataCenter.ins().AshtarteEquipConfig[n];if(!o)return 0;e||(e=o.level),e>o.level&&(e=o.level)}return e},e.prototype.getZhanLingDataBySuitCount=function(t,e){if(!this._ZhanLingData[t])return 0;for(var i=0,n=0;n<this._ZhanLingData[t].items.length;n++){var o=this._ZhanLingData[t].items[n],s=DataCenter.ins().AshtarteEquipConfig[o];s.level>=e&&i++}return i},e.prototype.getZhanLingDataByMat=function(t,e){if(!e&&!this._ZhanLingData[t])return 0;var i=DataCenter.ins().AshtarteBaseConfig[t],n=i.talent,o=0;if(e)o=1;else{if(!this._ZhanLingData[t].talentLv)return 0;o=this._ZhanLingData[t].talentLv+1}var s=DataCenter.ins().AshtarteTalentConfig[n][o];return s?s.costCount:0},e.prototype.getZhanLingPower=function(t){var e=0,i=this.getZhanLingDataByLevel(t),n=DataCenter.ins().AshtarteLevelConfig[t][i];if(!n)return[e,[],[]];var o=this.getZhanLingDataById(t);if(!o)return[e,[],[]];var s=DataCenter.ins().AshtarteLevelConfig[t][i+1],r=0,a=[],l=[],h=0,u=0,p=[],c=[],d=0,g=[],m=[],f=0,v=0;r+=BackpackControl.getAttrPower(n.attrs)*heroControl.subRolesLen;for(var y=0;y<heroControl.subRolesLen;y++){var C=heroControl.getSubRoleByIndex(y);for(var T in n.attrs)r+=ItemUtils.relatePower(n.attrs[T],C)}r+=(n.expower?n.expower:0)*heroControl.subRolesLen,a=this.addAttrs(a,n.attrs),s&&(l=this.addAttrs(l,s.attrs));var w=this.getZhanLingDataBySuit(t);if(w){var I=DataCenter.ins().AshtarteSuitConfig[w];if(I&&I.attrs){u+=BackpackControl.getAttrPower(I.attrs)*heroControl.subRolesLen;for(var T=0;T<I.attrs.length;T++)for(var y=0;y<heroControl.subRolesLen;y++){var C=heroControl.getSubRoleByIndex(y);u+=ItemUtils.relatePower(I.attrs[T],C)}p=AttributeData.getPercentAttr(a,I.precent/1e4),s&&(c=AttributeData.getPercentAttr(l,I.precent/1e4))}}for(var T=0;T<o.drugs.length;T++){for(var b=[],D=[],B=DataCenter.ins().AshtarteConfig.upgradeInfo[o.drugs[T].itemId],k=[],x=0;x<B.attr.length;x++){var R=new AttributeData;R.type=B.attr[x].type,R.value=B.attr[x].value*o.drugs[T].count,k.push(R)}var E={attr:k,precent:B.precent?B.precent*o.drugs[T].count:0,sort:B.sort};d+=BackpackControl.getAttrPower(E.attr)*heroControl.subRolesLen,g=this.addAttrs(g,E.attr),m=this.addAttrs(m,E.attr),E.precent&&(d+=Math.floor(r*E.precent/1e4),w&&(d+=Math.floor(r*E.precent/1e4)),b=AttributeData.getPercentAttr(a,E.precent/1e4),g=this.addAttrs(g,b),s&&(D=AttributeData.getPercentAttr(l,E.precent/1e4),m=this.addAttrs(m,D)));for(var y=0;y<heroControl.subRolesLen;y++){var C=heroControl.getSubRoleByIndex(y);d+=ItemUtils.relatePower(E.attr[T],C)}}for(var T=1;T<=DataCenter.ins().AshtarteConfig.equipPosCount;T++){var _=this.getZhanLingDataByItem(t,T);h+=this.getZhanLingItemPower(_,1)}var S=this.getZhanLingDataByTalentId(t),M=this.getZhanLingDataByTalentLv(t),P=DataCenter.ins().AshtarteTalentConfig[S][M];if(P){var L=P.expower;f+=(L?L:0)*heroControl.subRolesLen,P.attrs&&(f+=BackpackControl.getAttrPower(P.attrs)*heroControl.subRolesLen)}for(var A=DataCenter.ins().AshtarteBaseConfig[t],T=0;T<A.skill.length;T++){var V=DataCenter.ins().AshtarteSkillConfig[A.skill[T].id];if(V.attrs){v+=BackpackControl.getAttrPower(V.attrs)*heroControl.subRolesLen;for(var y=0;y<heroControl.subRolesLen;y++)for(var C=heroControl.getSubRoleByIndex(y),U=0;U<V.attrs.length;U++)v+=ItemUtils.relatePower(V.attrs[U],C);V.expower&&(v+=V.expower)}}return e=r+h+u+d+f+v,a=this.addAttrs(a,p),a=this.addAttrs(a,g),s&&(l=this.addAttrs(l,c),l=this.addAttrs(l,m)),[e,a,l]},e.prototype.addAttrs=function(t,e,i){void 0===i&&(i=!0);var n=i?[]:t;if(i)for(var o=0;o<t.length;o++)-1!=AttributeData.showTypeList.indexOf(t[o].type)&&n.push(new AttributeData(t[o].type,t[o].value));for(var s=0;s<e.length;s++){var r=!1;if(-1!=AttributeData.showTypeList.indexOf(e[s].type)){for(var a=0;a<t.length;a++)if(t[a].type==e[s].type){n[a].value+=e[s].value,r=!0;break}r||n.push(new AttributeData(e[s].type,e[s].value))}}return n},e.prototype.getZhanLingItemPower=function(t,e){void 0===e&&(e=0);var i=0,n=DataCenter.ins().AshtarteEquipConfig[t];if(!n)return i;var o=e?heroControl.subRolesLen:3;if(i+=BackpackControl.getAttrPower(n.attrs)*o,e)for(var s=0;o>s;s++)for(var r=heroControl.getSubRoleByIndex(s),a=0;a<n.attrs.length;a++)i+=ItemUtils.relatePower(n.attrs[a],r);return i},e.prototype.isUpGradeByStar=function(t){if(!this.getZhanLingDataById(t))return this.isUpGradeByTalent(t,!0);var e=this.getZhanLingDataByLevel(t),i=DataCenter.ins().AshtarteLevelConfig[t][e];if(!i||!i.exp)return!1;var n=this.getZhanLingDataByExp(t),o=i.exp-n;o=o>0?o:0;var s=Math.ceil(o/DataCenter.ins().AshtarteConfig.stageitemexp),r=backpackControl.getBagItemById(DataCenter.ins().AshtarteConfig.stageitemid),a=r?r.count:0;return a>=s},e.prototype.isHintNum=function(t){var e=this.getZhanLingDataById(t);if(!e)return!1;var i=DataCenter.ins().AshtarteLevelConfig[t][e.level];if(!i||!i.exp)return!1;var n=backpackControl.getBagItemById(DataCenter.ins().AshtarteConfig.stageitemid),o=n?n.count:0;return o>=DataCenter.ins().AshtarteConfig.hintNum},e.prototype.isUpGradeByTalent=function(t,e){void 0===e&&(e=!1);var i=this.getZhanLingDataById(t);if(!e&&!i)return!1;var n=DataCenter.ins().AshtarteBaseConfig[t];if(!n.mat)return!1;var o=backpackControl.getBagItemById(n.mat),s=o?o.count:0,r=this.getZhanLingDataByMat(t,e);return r?s>=r:!1},e.prototype.updateShowZLlist=function(){var t=[];for(var e in DataCenter.ins().AshtarteBaseConfig)DataCenter.ins().AshtarteBaseConfig[e].sort&&t.push(DataCenter.ins().AshtarteBaseConfig[e]);t.sort(function(t,e){return t.sort<e.sort?-1:1}),this.showZLlist=[];for(var i=0;i<t.length;i++)if(t[i].show){var n=this.getZhanLingDataById(t[i].id);if(n)this.showZLlist.push(t[i]);else{var o=backpackControl.getBagItemById(t[i].mat);o&&o.count&&this.showZLlist.push(t[i])}}else this.showZLlist.push(t[i])},e.prototype.getZhanLingItemRedPoint=function(t){var e=this.getZhanLingDataById(t);if(!e)return!1;var i=backpackControl.getBagGoodsByType(21);i&&i.sort(function(t,e){var i=DataCenter.ins().AshtarteEquipConfig[t.configID],n=DataCenter.ins().AshtarteEquipConfig[e.configID];return i.level>n.level?-1:1});for(var n=0;n<e.items.length;n++){var o=n+1,s=e.items[n],r=void 0;s&&(r=DataCenter.ins().AshtarteEquipConfig[s]);for(var a=0;a<i.length;a++){var l=i[a].configID,h=DataCenter.ins().ItemConfig[l];if(h){var u=DataCenter.ins().AshtarteEquipConfig[l];if(u&&o==u.pos){var p=h.level?h.level:0,c=h.zsLevel?h.zsLevel:0;if(reincarnateControl.lv>=c&&ActorControl.level>=p){if(r){if(u.level>r.level)return!0;break}return!0}}}}}return!1},e.prototype.getStageLv=function(t){var e=Math.floor(t/10),i=Math.floor(t%10);return i?e+=1:t&&t%10==0?i=10:e+=1,[e,i]},e.prototype.getZhanLingForgePower=function(t,e){var i=DataCenter.ins().AshtarteEnhanceConfig[t][e];if(!i)return 0;var n=BackpackControl.getAttrPower(i.attr)+(i.expower||0),o=this.getZhanLingDataById(0),s=o.items[t-1],r=DataCenter.ins().AshtarteEquipConfig[s];if(!r)return 0;var a=AttributeData.getAttrStarAdd(r.attrs,i.per/1e4);n+=BackpackControl.getAttrPower(a);var l=this.getZhanLingForgeLinkPower(t,e);return n*heroControl.subRolesLen+l},e.prototype.getZhanLingForgeLinkPower=function(t,e){var i=this.getAshtarteLinkConfigLvl(t,e),n=DataCenter.ins().AshtarteLinkConfig[t],o=+Object.keys(n)[0],s=n[o][i];if(!s)return 0;for(var r=0,a=0;a<heroControl.subRolesLen;a++)r+=BackpackControl.getAttrPower(s.attrs,heroControl.getSubRoleByIndex(a))+(s.ex_power||0);return r},e.prototype.getAshtarteLinkConfigLvl=function(t,e){var i=DataCenter.ins().AshtarteLinkConfig[t],n=+Object.keys(i)[0],o=this.getZhanLingDataById(0).forgeLv;return void 0==e&&(e=o[t-1]),Math.min(e,o[n-1])},e.prototype.replaceZLItems=function(t,e){var i=this.getZhanLingDataById(t);if(!i)return[!1,0];var n=backpackControl.getBagGoodsByType(21);n&&n.sort(function(t,e){var i=DataCenter.ins().AshtarteEquipConfig[t.configID],n=DataCenter.ins().AshtarteEquipConfig[e.configID];return i.level>n.level?-1:1});for(var o=0;o<i.items.length;o++){var s=o+1;if(isNaN(e)||e==s){var r=i.items[o],a=void 0;r&&(a=DataCenter.ins().AshtarteEquipConfig[r]);for(var l=0;l<n.length;l++){var h=n[l].configID,u=DataCenter.ins().ItemConfig[h];if(u){var p=DataCenter.ins().AshtarteEquipConfig[h];if(p&&s==p.pos){var c=u.level?u.level:0,d=u.zsLevel?u.zsLevel:0;if(reincarnateControl.lv>=d&&ActorControl.level>=c){if(a){if(p.level>a.level)return[!0,p.id];break}return[!0,p.id]}}}}}}return[!1,0]},__decorate([up(2,[1,1])],e.prototype,"upUpExp",null),__decorate([up(3,[1,3])],e.prototype,"upDrug",null),__decorate([up(4,[1,3])],e.prototype,"upWear",null),__decorate([up(5,[3])],e.prototype,"upComposeItem",null),__decorate([up(9,[1,1])],e.prototype,"upForge",null),__decorate([down(9,[1,1,3])],e.prototype,"downForge",null),__decorate([up(10,[1,3])],e.prototype,"upDrugExt",null),__decorate([up(11,[1])],e.prototype,"upSkinUpGrade",null),__decorate([up(12,[1])],e.prototype,"upSkinChange",null),__decorate([down(1,[[3,1,2,3,[3,2],[3],[3]],1])],e.prototype,"downInfo",null),__decorate([down(2,[1,2,3])],e.prototype,"downUpExp",null),__decorate([down(3,[1,3,2])],e.prototype,"downDrug",null),__decorate([down(4,[1,3])],e.prototype,"downWear",null),__decorate([down(6,[1,[3]])],e.prototype,"downComposeItem",null),__decorate([down(7,[10,3,1])],e.prototype,"downBubble",null),__decorate([down(8)],e.prototype,"downSkill",null),__decorate([down(11,[1,2])],e.prototype,"downSkinUpGrade",null),__decorate([down(12,[1])],e.prototype,"downSkinChange",null),e=__decorate([protocolsId(43)],e)}(BaseSystem);__reflect(AshtarteControl.prototype,"AshtarteControl");var AshtarteForgeRedPoint=function(t){function e(){var e=t.call(this)||this;return e.forgeRed=!1,e.addCustomEventMany(e.AshtarteForgeRed,267,268,274,258,709),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.AshtarteForgeRed=function(){var t=this.forgeRed;return this.forgeRed=this.getZhanLingForgeRed(),t!=this.forgeRed},e.prototype.getZhanLingForgeRed=function(){for(var t=1;4>=t;t++)if(this.getZhanLingForgeRedByPos(t))return!0;return!1},e.prototype.getZhanLingForgeRedByPos=function(t,e){var i=ashtarteControl.getZhanLingDataById(0);if(!i)return!1;var n=i.items[t-1];if(!n)return!1;var o=i.forgeLv[t-1],s=DataCenter.ins().AshtarteEnhanceConfig[t][o+1];return s?backpackControl.getBagItemCount(0,s.enhanceItem)>=s.costNum:!1},e}(BaseSystem);__reflect(AshtarteForgeRedPoint.prototype,"AshtarteForgeRedPoint");var GameSystem;!function(t){t.ashtarteForgeRedPoint=AshtarteForgeRedPoint.ins.bind(AshtarteForgeRedPoint)}(GameSystem||(GameSystem={}));var AshtarteVo=function(){function t(t){this.id=t?t:0,this.level=0,this.exp=0,this.items=[],this.forgeLv=[];
for(var e=0;e<DataCenter.ins().AshtarteConfig.equipPosCount;e++)this.items.push(0),this.forgeLv.push(0);this.talentLv=0,this.drugs=[];for(var e in DataCenter.ins().AshtarteConfig.upgradeInfo)this.drugs.push({itemId:Number(e),count:0})}return t}();__reflect(AshtarteVo.prototype,"AshtarteVo");var AshtarteDrugExtView=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.isEnough=!1,e.skinName="AshtarteDrugExtViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.useBtn,this.onTap),this.addEventTouchTap(this.cancelBtn,this.onTap),this.addCustomEvent(260,this.updateView);var i=t[0],n=t[1];this.id=t[2]||0,this.itemid=n,this.useBtn.visible=this.cancelBtn.visible=!!i;var o=DataCenter.ins().ItemConfig[n];this.itemName0.text=this.itemName1.text=o.name,this.itemIcon.data=n,this.itemIcon.isShowName(!1),this.itemIcon.destruct(),this.updateView()},e.prototype.updateView=function(){var t=DataCenter.ins().AshtarteConfig.upgradeInfo,e=0;for(var i in t)if(t[i].ex==this.itemid){e=+i;break}this.itemName.text=DataCenter.ins().ItemConfig[e].name;var n=ashtarteControl.getZhanLingDataByDrug(this.id,e),o=ashtarteControl.getZhanLingDataByLevel(this.id),s=DataCenter.ins().AshtarteLevelConfig[this.id][o],r=s.maxCount[e],a=ashtarteControl.getZhanLingDataDrugExCount(this.id,e);this.use2.text="（+"+a+"）";var l=ashtarteControl.getZhanLingDruyExtLevel(this.id,this.itemid),h=DataCenter.ins().AshtartePillExConfig[this.itemid][l+1];if(h){this.usedTips.visible=!0,this.maxTips.visible=!1,this.isEnough=backpackControl.getBagItemCount(0,this.itemid)>=h.costNum;var u=this.isEnough?65280:16711680;this.useDescLabel.textFlow=TextUtils.generateTextFlow1("|C:"+u+"&T:"+h.costNum+"|")}else this.usedTips.visible=!1,this.maxTips.visible=!0;var p=n>=r+a?65280:16711680;this.use1.textFlow=TextUtils.generateTextFlow1("|C:"+p+"&T:"+n+"|/"+r)},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.bgClose||e==this.cancelBtn)UIMgr.ins().close(this);else if(e==this.useBtn){if(this.maxTips.visible)return void tipsControl.showTips(LangMgr.getValueByKey("ashtarteForgeTips1"));if(!this.isEnough)return void tipsControl.showTips(LangMgr.getValueByKey("shopTips29"));ashtarteControl.upDrugExt(this.id,this.itemid)}},e}(BaseEuiView);__reflect(AshtarteDrugExtView.prototype,"AshtarteDrugExtView");var AshtarteEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.curPos=0,e.curPos=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(e,i,n){t.prototype.open.call(this),this.updateAttr(e,i||0,n||!1)},e.prototype.updateAttr=function(t,e,i){this.curPos=this.getPos(i,t);var n=DataCenter.ins().ItemConfig[t],o=i?1:0,s=ashtarteControl.getZhanLingItemPower(t,o),r=s,a=n.level?LangMgr.getValueByKey("numberLevel",n.level):LangMgr.getValueByKey("shopNoLevel"),l=DataCenter.ins().AshtarteEquipConfig[t],h={left:LangMgr.getValueByKey("wingTips15"),right:DataCenter.ins().AshtarteConfig.zlEquipName[l.pos-1]+"\n"+a},u="",p=0;if(this.curPos){var c=ashtarteControl.getZhanLingDataById(0);if(p=c.forgeLv[this.curPos-1],s+=ashtarteControl.getZhanLingForgePower(this.curPos,p),p){for(var d=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][p],g=AttributeData.getAttrStarAdd(l.attrs,d.per/1e4),m=0;m<g.length;m++){var f=g[m];u&&(u+="\n"),u+=LangMgr.getValueByKey("ashtarteForgeTips2")+f.value}u="|C:0xffff00&T:"+u}}var v=[];v.push({title:LangMgr.getValueByKey("hijiBasic"),attr:l.attrs,ext:{text:u}});var y=DataCenter.ins().AshtarteEquipConfig[t].level;y=y?y:1;for(var C=DataCenter.ins().AshtarteSuitConfig[y],T=65280,w=ashtarteControl.getZhanLingDataById(e),I=16711935,b=16711935,D=0,B="",m=0;m<DataCenter.ins().AshtarteConfig.equipPosCount;m++){var k=65280,x=w?DataCenter.ins().AshtarteEquipConfig[w.items[m]]:null;!w||!w.items[m]||!x||x.level<y?(k=T=16711680,I=b=6710886):D++,i||m+1==DataCenter.ins().AshtarteEquipConfig[t].pos&&(k=65280);var R="|C:"+k+"&T:"+DataCenter.ins().AshtarteConfig.zlEquipName[m];m+1<DataCenter.ins().AshtarteConfig.equipPosCount&&(R+="|C:"+k+"&T:、"),B+=R}i||(D=1);var E=LangMgr.getValueByKey("wingTips16",C.precent/100),_="|C:"+T+"&T:("+D+"/"+DataCenter.ins().AshtarteConfig.equipPosCount+")",S=B;if(v.push({title:"|C:0xff00ff&T:"+C.suitWithName+"|"+_,attr:C.attrs,colorName:I,colorValue:b,others:{suitdesc:S,exdesc:E}}),this.curPos&&p){var M=ashtarteControl.getAshtarteLinkConfigLvl(this.curPos);if(M){var P=DataCenter.ins().AshtarteLinkConfig[this.curPos],L=P[Object.keys(P)[0]][M];v.push({title:LangMgr.getValueByKey("ashtarteForgeTips3",M),others:{suitdesc:L.chainDesc}})}var d=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][p];v.push({title:LangMgr.getValueByKey("ashtarteForgeTips4",p),others:{suitdesc:LangMgr.getValueByKey("ashtarteForgeTips5",d.per/100)}})}this.updateView(BackpackControl.BAG_TYPE_OTHTER,t,r,s,h,v),this.updateBtn(e)},e.prototype.getPos=function(t,e){if(!t)return 0;var i=ashtarteControl.getZhanLingDataById(0);return i.items.indexOf(e)+1},e.prototype.updateBtn=function(t){this.changeBtn.visible=!t&&!!this.curPos,this.changeBtn.label=LangMgr.getValueByKey("ashtarteForgeTips6"),this.curPos&&(this.redPoint.visible=this.changeBtn.visible&&AshtarteForgeRedPoint.ins().getZhanLingForgeRedByPos(this.curPos))},e.prototype.getItemName=function(){var e=t.prototype.getItemName.call(this);if(this.curPos){var i=ashtarteControl.getZhanLingDataById(0);i&&i.forgeLv[this.curPos-1]&&(e=LangMgr.getValueByKey("ashtarteForgeTips7",StringUtils.LuoMaNumbers[i.forgeLv[this.curPos-1]],e))}return e},e.prototype.onTap=function(t){t.currentTarget==this.changeBtn&&(UIMgr.ins().close(this),UIMgr.ins().open(AshtarteForgeEquipView,this.curPos))},e}(EquipNormalTipsView);__reflect(AshtarteEquipTipsView.prototype,"AshtarteEquipTipsView");var AshtarteForgeEquipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteForgeEquipViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.MAIN1,e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.soulBtn,this.onTap),this.addCustomEvent(709,this.updateView),this.curPos=t||1;var e=ashtarteControl.getZhanLingDataById(0);this.itemShow.data=e.items[this.curPos-1],this.itemShow.isShowName(!1),this.itemShow.destruct(),this.updateView()},e.prototype.updateView=function(){var t=ashtarteControl.getZhanLingDataById(0);this.curLvl=t.forgeLv[this.curPos-1]||0,0!=this.curLvl&&DataCenter.ins().AshtarteEnhanceConfig[this.curPos][this.curLvl+1]?this.showCurNextAttr():this.showOnlyAttr(),this.showSkill(),this.updateItem(),this.itemName.text=this.getItemName(),this.redPoint.visible=AshtarteForgeRedPoint.ins().getZhanLingForgeRedByPos(this.curPos)},e.prototype.getItemName=function(){var t=ashtarteControl.getZhanLingDataById(0),e=DataCenter.ins().ItemConfig[t.items[this.curPos-1]].name;return this.curLvl&&(e=LangMgr.getValueByKey("ashtarteForgeTips7",StringUtils.LuoMaNumbers[this.curLvl],e)),e},e.prototype.showOnlyAttr=function(){this.attrGroup0.visible=this.attrGroup1.visible=!1,this.attrGroup3.visible=!0,this.arrow0.visible=!1;var t=this.curLvl||1,e=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][t];this.attr3.text=AttributeData.getAttStr(e.attr,0,1,":"),this.powerPanel3.setPower(ashtarteControl.getZhanLingForgePower(this.curPos,t))},e.prototype.showCurNextAttr=function(){this.attrGroup0.visible=this.attrGroup1.visible=!0,this.attrGroup3.visible=!1,this.arrow0.visible=!0;var t=this.curLvl,e=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][t];this.attr0.text=AttributeData.getAttStr(e.attr,0,1,":"),this.powerPanel0.setPower(ashtarteControl.getZhanLingForgePower(this.curPos,t));var i=t+1,n=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][i];this.attr1.text=AttributeData.getAttStr(n.attr,0,1,":"),this.powerPanel1.setPower(ashtarteControl.getZhanLingForgePower(this.curPos,i))},e.prototype.showSkill=function(){var t=ashtarteControl.getAshtarteLinkConfigLvl(this.curPos),e=t||1,i=e+1,n=DataCenter.ins().AshtarteLinkConfig[this.curPos],o=n[Object.keys(n)[0]],s=o[e];this.chainLv0.text="Lv"+e,this.chainPos.textFlow=TextUtils.generateTextFlow1(s.chainDesc);var r=o[i];if(r)if(this.nextChainTextGroup.visible=!0,0==t)this.nextChain0.text=LangMgr.getValueByKey("ashtarteForgeTips8");else{var a=r.attrs[0].value;this.nextChain0.text=LangMgr.getValueByKey("ashtarteForgeTips9",a/100)}else this.nextChainTextGroup.visible=!1;var l=this.curLvl||1,h=this.curLvl+1,u=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][l];this.soulLvText.text="Lv"+l,this.soulAttr.text=Math.floor(u.per/100)+"%";var p=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][h];if(p)if(this.nextSoulTextGroup.visible=!0,0==this.curLvl)this.nextChain1.text=LangMgr.getValueByKey("ashtarteForgeTips8");else{var c=p.per;this.nextChain1.text=LangMgr.getValueByKey("ashtarteForgeTips9",c/100)}else this.nextSoulTextGroup.visible=!1},e.prototype.updateItem=function(){var t,e=this.curLvl+1,i=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][e],n=0;i?(n=i.costNum,t=i.enhanceItem,this.soulBtn.visible=!0,this.maxLevel.visible=!1,this.costGroup.visible=!0):(i=DataCenter.ins().AshtarteEnhanceConfig[this.curPos][this.curLvl],t=i.enhanceItem,this.soulBtn.visible=!1,this.maxLevel.visible=!0,this.costGroup.visible=!1),this.costImg.source=DataCenter.ins().ItemConfig[t].icon+"_png",this.materialLabel.text=DataCenter.ins().ItemConfig[t].name,this.needNum.text="/"+n;var o=backpackControl.getBagItemCount(0,t);this.soulBtn.enabled=o>=n;var s=o>=n?65280:16711680;this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+o+"|")},e.prototype.onTap=function(t){var e=t.currentTarget;e==this.closeBtn?UIMgr.ins().close(this):e==this.soulBtn&&ashtarteControl.upForge(0,this.curPos)},e}(BaseEuiView);__reflect(AshtarteForgeEquipView.prototype,"AshtarteForgeEquipView");var AshtarteItemTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteItemTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.bgClose,this.otherClose),this.id=t[0],this.itemid=t[1];var i=DataCenter.ins().ItemConfig[this.itemid];this.itemIcon.setData(i),this.nameLabel.textFlow=TextUtils.generateTextFlow1(i.name);var n=ashtarteControl.getZhanLingDataByDrug(this.id,this.itemid),o=ashtarteControl.getZhanLingDataByLevel(this.id),s=DataCenter.ins().AshtarteLevelConfig[this.id][o],r=s.maxCount[this.itemid],a=n>=r?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.use.textFlow=TextUtils.generateTextFlow1("|C:"+a+"&T:"+n+"|/"+r);var l=backpackControl.getBagItemById(this.itemid);this.num.text=l?""+l.count:"0";var h=ashtarteControl.getZhanLingDataByStage(this.id)+1;10*h>CommonUtils.getObjectLength(DataCenter.ins().AshtarteLevelConfig[this.id])?DisplayUtils.removeFromParent(this.info):this.num0.text=LangMgr.getValueByKey("wingTips4",h,1);var u=DataCenter.ins().AshtarteConfig.upgradeInfo[this.itemid],p=AttributeData.getAttStr(u.attr,0,1,"+");u.precent&&(p+=LangMgr.getValueByKey("wingTips5",u.precent/100)),this.attr.text=p},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(AshtarteItemTipsView.prototype,"AshtarteItemTipsView");var AmusementType12DataVo=function(t){function e(){var i=null!==t&&t.apply(this,arguments)||this;return i.envelopeSum=e.maxEnvelope,i.SecondCount=0,i}return __extends(e,t),e.prototype.initAmusement=function(t){this.score=t[0],this.logs=[];for(var e=0;e<t[1].length;e++){var i=t[1][e][0],n=t[1][e][1],o=t[1][e][2];this.logs.push({name:n,serverId:o,index:i})}-1==amusementControl.activityTimers.indexOf(this.id)&&amusementControl.activityTimers.push(this.id)},e.prototype.updateAmusement=function(t){var e=t[0],i=t[1],n=t[2],o=[],s=heroControl.getSubRoleByIndex(0);o.push({job:s.job,sex:s.sex,name:ActorControl.myName,yb:i,gold:n});for(var r=0;r<t[3].length;r++){var a=t[3][r][0],l=t[3][r][1],h=t[3][r][2],u=t[3][r][3];ActorControl.myName!=h&&o.push({job:a,sex:l,name:h,yb:u,gold:0})}amusementControl.dispatchGetRedEnvelope(this.id,e,i,n,o)},Object.defineProperty(e.prototype,"envelopeData",{get:function(){return this._envelopeData=this._envelopeData?this._envelopeData:[],this._envelopeData},set:function(t){t.sort(this.sortTimer),this._envelopeData=t},enumerable:!0,configurable:!0}),e.prototype.sortTimer=function(t,e){return t.timer<e.timer?-1:1},e.prototype.checkClear=function(){this.envelopeData.length>=this.envelopeSum?(this.SecondCount=0,this.clearEnvelopeData(),this.envelopeSum>e.maxEnvelope&&(this.envelopeSum=this.envelopeData.length+e.maxEnvelope)):this.SecondCount>10&&this.envelopeSum>e.maxEnvelope?(this.SecondCount=0,this.envelopeSum=e.maxEnvelope):this.SecondCount>60&&this.envelopeData.length<e.maxEnvelope&&(this.SecondCount=0,this.clearEnvelopeData()),this.SecondCount++},e.prototype.clearEnvelopeData=function(){for(var t=0;t<this.envelopeData.length;t++)(!this.envelopeData[t]||this.envelopeData[t].isOverTimer())&&this.envelopeData.splice(t,1)},e.prototype.clearAll=function(){this.envelopeData=[],this.envelopeSum=e.maxEnvelope},e.prototype.popEnvelope=function(t){for(var e=0;e<this.envelopeData.length;e++)if(!this.envelopeData[e]||this.envelopeData[e].id==t){this.envelopeData.splice(e,1);break}},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){var t=DataCenter.ins().Amusement12Config[this.id];for(var e in t)if(this.score>=t[e].score)return!0;return!1},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e.maxEnvelope=10,e}(AmusementBaseDataVo);__reflect(AmusementType12DataVo.prototype,"AmusementType12DataVo");var RedEnvelope=function(){function t(){this.id=0,this.timer=0}return t.prototype.init=function(t){this.id=t[0],this.timer=t[1]},t.prototype.isOverTimer=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.timer)-GameServer.serverTime)/1e3);return 0>=t},t}();__reflect(RedEnvelope.prototype,"RedEnvelope");var EnvelopeData=function(){function t(){this.id=0,this.eId=0,this.job=0,this.sex=0,this.index=0,this.serverId=0,this.name="",this.desc=""}return t}();__reflect(EnvelopeData.prototype,"EnvelopeData");var AshtarteSuitTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteSuitTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.bgClose,this.otherClose),this.id=t[0];var i=ashtarteControl.getZhanLingDataBySuit(this.id),n=CommonUtils.getObjectLength(DataCenter.ins().AshtarteSuitConfig),o=DataCenter.ins().AshtarteConfig.equipPosCount,s=0;i?(s=ashtarteControl.getZhanLingDataBySuitCount(this.id,i),i>=n&&s>=o?this.currentState="max":this.currentState="active"):(this.currentState="unactive",i=1),this.validateNow();var r=DataCenter.ins().AshtarteSuitConfig[i],a=StringUtils.replace(r.suitCondition,""+s,""+o);"unactive"==this.currentState&&(this.content0.textFlow=TextUtils.generateTextFlow1(a));var l=AttributeData.getAttStr(r.attrs,0,1,"+");if(l+=LangMgr.getValueByKey("wingTips5",r.precent/100),this.attr0.text=l,this.name0.text=r.suitTname,"active"==this.currentState){var h=DataCenter.ins().AshtarteSuitConfig[i+1];s=ashtarteControl.getZhanLingDataBySuitCount(this.id,i+1),a=StringUtils.replace(h.suitCondition,""+s,""+o),this.content1.textFlow=TextUtils.generateTextFlow1(a);var u=AttributeData.getAttStr(h.attrs,0,1,"+");u+=LangMgr.getValueByKey("wingTips5",h.precent/100),this.attr1.text=u,this.name1.text=h.suitTname}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(AshtarteSuitTipsView.prototype,"AshtarteSuitTipsView");var AshtarteView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="AshtartePanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.openView(t)},e}(AshtartePanel);__reflect(AshtarteView.prototype,"AshtarteView");var AshtarteEquipItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.forgeState=!1,e.skinName="AshtarteEquipItemRendererSkin",e.addEventTouchEnd(e,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.id;if(this.equips=this.data.equips,this.bg.source="zl_equip_bg_"+this.name,this.bg.visible=!0,this.equip.visible=!this.bg.visible,this.redPoint.visible=this.getRedPoint(),this.quality.source="quality0",this.data.id){var e=DataCenter.ins().ItemConfig[t];e&&(this.quality.source="quality"+ItemUtils.getQuality(e),this.equip.source=e.icon+"_png",this.bg.visible=!1,this.equip.visible=!this.bg.visible)}}},e.prototype.getRedPoint=function(){var t=AshtarteControl.ins().replaceZLItems(this.data.zlId,this.data.pos);if(t[0])return this.bestId=t[1],!0;var e=AshtarteForgeRedPoint.ins().getZhanLingForgeRedByPos(this.data.pos,this.data.zlId);return e&&!this.data.zlId&&!!this.data.pos},e.prototype.onClick=function(){this.data&&(this.data.id||this.redPoint.visible?!this.data.id||this.redPoint.visible&&this.bestId?isNaN(this.data.zlId)?tipsControl.showTips(LangMgr.getValueByKey("wingTips2")):this.bestId?!this.data.id&&this.redPoint.visible?ashtarteControl.upWear(this.data.zlId,this.bestId):ashtarteControl.upWear(this.data.zlId,this.bestId):tipsControl.showTips(LangMgr.getValueByKey("wingTips3")):ashtarteControl.ZhanLingItemTips(this.data.id,this.data.zlId,!0):tipsControl.showTips(LangMgr.getValueByKey("wingTips1")))},e.prototype.destruct=function(){this.removeEventTouchEnd(this,this.onClick)},e}(BaseItemRender);__reflect(AshtarteEquipItemRenderer.prototype,"AshtarteEquipItemRenderer");var AshtarteIconItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteIconItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.id,e=DataCenter.ins().AshtarteBaseConfig[t];if(e){var i=ashtarteControl.getZhanLingDataByLevel(t);this.icon.source=e.icon,this.state.visible=ashtarteControl.getZhanLingDataById(t)?!1:!0,this.select.visible=!1,this.label.text=i+"",this.label.visible=!this.state.visible;var n=ashtarteControl.isUpGradeByStar(t)||ashtarteControl.isHintNum(t)||ashtarteControl.getZhanLingItemRedPoint(t);n||(n=ashtarteControl.isUpGradeByTalent(t)),this.redPoint.visible=n}}},e.prototype.setSelect=function(t){this.select.visible=t},e}(BaseItemRender);__reflect(AshtarteIconItemRenderer.prototype,"AshtarteIconItemRenderer");var BackpackControl=function(t){function e(){var e=t.call(this)||this;e.bagModel=[],e.bagNum=0,e.isExitUsedItem=0,e.isChange=0,e._useItemFunc={},e.OrangeEquipRedPoint=[],e.itemCount={0:{},1:{}},e.cancelUseItem={},e._lvUpLoginRed=!1,e.useLimitData=[],e.equipPowerDic=[],e.wearList=[],e.addCustomEvent(447,e.doBagVolChange),e.registerUseItemFunc(450001,e.useRenameItem);for(var i=0;8>i;i++)e.OrangeEquipRedPoint[i]=!1;return e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e,"fitleEquip",{get:function(){if(!i._fitleEquip){i._fitleEquip=[];for(var t in DataCenter.ins().SpecialEquipsConfig)2==DataCenter.ins().SpecialEquipsConfig[t].style&&i._fitleEquip.push(DataCenter.ins().SpecialEquipsConfig[t].id)}return i._fitleEquip},enumerable:!0,configurable:!0}),e.prototype.upAddBagGrid=function(t){return[t]},e.prototype.upUseItem=function(t,e,i){return void 0===i&&(i=0),null!=this._useItemFunc[t]?(this._useItemFunc[t](t,e),!1):[t,e,i]},e.prototype.upAddItemCount=function(t,e){var i=e.configID;return 0==e.count?void this.delItemCount(t,i):(this.itemCount[t][i]=this.itemCount[t][i]||0,1==t?this.itemCount[t][i]+=1:this.itemCount[t][i]=e.count,void(1e3==e.itemConfig.descIndex&&this.dispatchCancelUseItem(i,!1)))},e.prototype.delItemCount=function(t,e){1==t?this.itemCount[t][e]&&(this.itemCount[t][e]-=1,0==this.itemCount[t][e]&&delete this.itemCount[t][e]):delete this.itemCount[t][e]},e.prototype.getBagItemCount=function(t,e){return this.itemCount[t][e]||0},e.prototype.downBagData=function(t,e,i){0==t&&(this.bagModel[e]=[],this.itemCount[e]={});for(var n,o=0;o<i.length;o++)n=new ItemData,n.init(i[o]),this.bagModel[e].push(n),(0==e||1==e)&&(this.upAddItemCount(e,n),this.checkAutoUse(n));this.dispatchItemAdd(),this.doBagVolChange(e),2==e&&this.dispatchHuntStore(),this.getIsExitUsedItem(),this.dispatchHasItemCanUse()},e.prototype.doBagVolChange=function(t){this.dispatchBagVolChange(t)},e.prototype.dispatchBagVolChange=function(t){if(1==t||void 0==t){var e=this.ronglianCheck();this.isChange=e?1:0;var i=e?2:0;this.dispatchItemCountChange(),e||(e=this.getSurplusCount()<.05*this.getMaxBagRoom(),i=e?1:0),this.dispatchBagWillFull(i)}else this.dispatchItemCountChange()},e.prototype.ronglianCheck=function(){var t=this.bagNum;DataCenter.ins()&&DataCenter.ins().BackpackVipGridConfig&&DataCenter.ins().BackpackVipGridConfig[vipControl.lv]&&(t+=DataCenter.ins().BackpackVipGridConfig[vipControl.lv].grid+payControl.getAddBagGrid());var e=!1,i=copyControl.guanqiaID>50?this.getBagItemNum()/t>=.8:this.getBagItemNum()>=50;if(i)for(var n=this.getOutEquips(),o=0,s=n;o<s.length;o++){var r=s[o];if(r&&r.itemConfig){e=!0;break}}return e},e.prototype.downUserItemBack=function(t){t>0?tipsControl.showTips(LangMgr.getValueByKey("bagState"+t)):0==t&&this.dispatchUseItemSuccess()},e.prototype.downBagValumnAdd=function(t){this.bagNum=t,this.dispatchBagVolAdd()},e.prototype.downDeleteItem=function(t,e){for(var i=0,n=this.bagModel[t].length-1;n>=0;n--)if(this.bagModel[t][n].handle==e){i=this.bagModel[t][n].configID,this.isExitUsedItem=this.bagModel[t][n].getCanbeUsed()?1:0,this.bagModel[t].splice(n,1);break}(0==t||1==t)&&this.delItemCount(t,i),this.deleteDelay(t)},e.prototype.downAddItem=function(t,e,i,n,o,s,r){var a=new ItemData;if(a.init([e,i,n,o,s]),this.bagModel[t]){if(this.bagModel[t].push(a),(0==t||1==t)&&this.upAddItemCount(t,a),this.checkAutoUse(a),this.isExitUsedItem=a.getCanbeUsed()?1:0,r){var l=ItemUtils.getQuality(a.itemConfig);if(l>=4&&1==t)tipsControl.showGoodEquipTips(a);else if(2!=t)if(18==ItemUtils.getType(a.itemConfig))tipsControl.showHeartItemTips(a.itemConfig.id);else{var h=LangMgr.getValueByKey("bagGet")+ItemUtils.getQualityColor(a.itemConfig)+"&T:"+a.itemConfig.name+" x "+a.count+"|";tipsControl.showTips(h)}}this.addDelay(t)}},e.prototype.addDelay=function(t){this.dispatchItemAdd(),this.dispatchHasItemCanUse(),this.doBagVolChange(t),2==t&&this.dispatchHuntStore()},e.prototype.deleteDelay=function(t){this.dispatchItemDel(),this.dispatchHasItemCanUse(),this.doBagVolChange(t),2==t&&this.dispatchHuntStore()},e.prototype.downUpDataItem=function(t,e,i,n){for(var o,s=0,r=0;r<this.bagModel[t].length;r++)if(o=this.bagModel[t][r],o.handle==e){s=i-o.count,o.count=i,(0==t||1==t)&&this.upAddItemCount(t,o),this.isExitUsedItem=o.getCanbeUsed()?1:0,this.dispatchHasItemCanUse(),this.checkAutoUse(o);break}if(n&&s>0&&2!=t){if(18==ItemUtils.getType(o.itemConfig))tipsControl.showHeartItemTips(o.itemConfig.id);else{var a=ItemUtils.getQualityColor(o.itemConfig),l=LangMgr.getValueByKey("bagGet")+a+"&T:"+o.itemConfig.name+" x "+s+"|";tipsControl.showTips(l)}this.dispatchItemAdd()}this.doBagVolChange(t),this.dispatchItemChange()},e.prototype.upMergeItem=function(t,e){return[t,e]},e.prototype.downMergeItemBack=function(t,e,i){for(var n=[],o=0;o<i.length;o++)n[o]=new RewardVo,n[o].init(i[o]);return n},e.prototype.upGetGoodsByStore=function(t){return 0==t&&this.getSurplusCount()<1?(tipsControl.showTips(DataCenter.ins().ServerTipsConfig[2].tips),!1):[t]},e.prototype.upDamageItem=function(t,e){for(var i=[],n=0;n<e.length;n++)null!=e[n]&&i.push(e[n].handle);return 0==i.length?!1:[t,i]},e.prototype.downDamageItemComplete=function(t,e,i){if(0==t)return void tipsControl.showTips(LangMgr.getValueByKey("roleTips9"));for(var n=[],o=0;o<i.length;o++){var s={};s.itemId=i[o][0],s.count=i[o][1],n.push(s)}EventMgr.ins().dispatch(659,n)},e.prototype.downUseLimitData=function(t){this.useLimitData.length=0;for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1];this.useLimitData[i]=n}EventMgr.ins().dispatch(664)},e.prototype.canUse=function(t){var e=DataCenter.ins().ItemUseLimitConfig[t];if(e){var i=this.useLimitData[t]||0,n=e.uselimit[vipControl.lv]||0;return n>i}return!0},e.prototype.getNextVipCount=function(t,e){for(var i=DataCenter.ins().ItemUseLimitConfig[t],n=i.uselimit[e],o=CommonUtils.getObjectLength(DataCenter.ins().VipConfig),s=1;o>s;s++)if(i.uselimit[s]>n)return{vip:s,addCount:i.uselimit[s]-n}},e.prototype.dispatchItemChange=function(){EventMgr.ins().dispatch(267)},e.prototype.registerUseItemFunc=function(t,e){this._useItemFunc[t]=e},e.prototype.dispatchItemDel=function(){EventMgr.ins().dispatch(268)},e.prototype.dispatchItemAdd=function(){EventMgr.ins().dispatch(266)},e.prototype.checkAutoUse=function(t){t&&t.itemConfig&&t.count&&t.itemConfig.autoUse&&this.upUseItem(t.itemConfig.id,t.count)},e.prototype.dispatchItemCountChange=function(){EventMgr.ins().dispatch(269,this.isChange)},e.prototype.dispatchBagWillFull=function(t){EventMgr.ins().dispatch(270,t)},e.prototype.dispatchHuntStore=function(){EventMgr.ins().dispatch(271)},e.prototype.dispatchHasItemCanUse=function(){EventMgr.ins().dispatch(272,this.isExitUsedItem)},e.prototype.dispatchUseItemSuccess=function(){EventMgr.ins().dispatch(273)},e.prototype.dispatchBagVolAdd=function(){EventMgr.ins().dispatch(274)},e.prototype.getBagItemById=function(t,e){void 0===e&&(e=i.BAG_TYPE_OTHTER);var n=this.bagModel[e];if(!n)return null;for(var o=0,s=n;o<s.length;o++){var r=s[o];if(r.itemConfig.id==t)return r}return null},e.prototype.getBagItemByType=function(t,e){void 0===e&&(e=i.BAG_TYPE_OTHTER);for(var n=this.bagModel[e],o=[],s=0;s<n.length;s++)n[s]&&n[s].itemConfig&&ItemUtils.getType(n[s].itemConfig)==t&&o.push(n[s]);return o},e.prototype.getFilterBagItemById=function(t,e,n){void 0===n&&(n=i.BAG_TYPE_OTHTER);for(var o=this.bagModel[n],s=0,r=o;s<r.length;s++){var a=r[s];if(a.itemConfig.id==t&&e.indexOf(a.handle)<0)return a}return null},e.prototype.getBagGoodsByTypeAndId=function(t,e){for(var i=this.bagModel[t],n=0,o=i;n<o.length;n++){var s=o[n];if(s.itemConfig.id==e)return s}return null},e.prototype.getBagEquipByType=function(t){var e=this.bagModel[i.BAG_TYPE_EQUIP],n=[];for(var o in e)ItemUtils.getType(e[o].itemConfig)==t&&n.push(e[o]);return n},e.prototype.getEquipByFilter=function(t){var e=this.bagModel[i.BAG_TYPE_EQUIP];if(!e||0==e.length)return null;var n=[],o=reincarnateControl.lv;for(var s in e)if(ItemUtils.getType(e[s].itemConfig)==t.type&&e[s].itemConfig.level>=t.minLv&&e[s].itemConfig.zsLevel<=o){var r=DataCenter.ins().ItemDescConfig[e[s].itemConfig.descIndex];r.subType==t.pos&&n.push(e[s].copy())}return n},e.prototype.checkHasEquipByFilter=function(t){var e=this.bagModel[i.BAG_TYPE_EQUIP];if(!e||0==e.length)return!1;for(var n=reincarnateControl.lv,o=0,s=e;o<s.length;o++){var r=s[o],a=r.itemConfig;if(ItemUtils.getType(a)==t.type&&a.level>=t.minLv&&a.zsLevel<=n){var l=DataCenter.ins().ItemDescConfig[a.descIndex];if(l.subType==t.pos)return!0}}return!1},e.prototype.getBagByType=function(t){return this.bagModel[t]},e.prototype.getBagGoodsCountByType=function(t,e){var n=this.bagModel[i.BAG_TYPE_OTHTER];if(n)for(var o=0;o<n.length;o++){var s=ItemUtils.getType(n[o].itemConfig);if(8==s){if(this.getIsCancelUse(n[o].itemConfig.id))continue;if(1==n[o].itemConfig.bagType)continue;if(e&&-1!=e.indexOf(n[o].itemConfig.id))return!0;if(200137==n[o].itemConfig.id&&!i.checkLvDanPoint(n[o].itemConfig))continue;if(200155==n[o].itemConfig.id){if(this.checkLvUpItemRed())return!0;continue}if(200318==n[o].itemConfig.id)continue;return!0}if(12==s){if(ActorControl.level>=n[o].itemConfig.level&&0!=unionControl.guildID)return!0}else{if(17==s)return!0;if(38==s){if(officeControl.checkItemIdCanDestroy(n[o].itemConfig.id))return!0}else{if(39==s)return!0;if(102==s)return this.getTitleUpLvRedPoint(n[o].itemConfig,n[o].count);var r=DataCenter.ins().ItemComposeConfig[n[o].configID];if(r&&r.srcCount<=n[o].count)return!0}}}return!1},e.prototype.getRuneBagGoodsCountByType=function(t){var e=this.bagModel[i.BAG_TYPE_OTHTER];if(e)for(var n=0;n<e.length;n++)if(8==ItemUtils.getType(e[n].itemConfig)&&(1==e[n].itemConfig.bagType||2==e[n].itemConfig.bagType))return!0;return!1},e.prototype.getDamageBagGoodsCountByType=function(){var t=this.bagModel[i.BAG_TYPE_OTHTER];if(t)for(var e=0;e<t.length;e++)if(t[e].itemConfig&&3==t[e].itemConfig.bagType)return!0;return!1},e.prototype.getBagGoodsCountById=function(t,e){if(0==t||1==t)return this.getBagItemCount(t,e);var i=this.bagModel[t];if(i)for(var n=0;n<i.length;n++)if(i[n].itemConfig&&i[n].itemConfig.id==e)return i[n].count;return 0},e.prototype.getBagGoodsByIndex=function(t,e){return this.bagModel[t][e]},e.prototype.getBagItemNum=function(t){void 0===t&&(t=1);var e=this.bagModel[t];return e?e.length:0},e.prototype.getBagDamageItemCount=function(t){void 0===t&&(t=3);var e=0,n=this.bagModel[i.BAG_TYPE_OTHTER];if(n)for(var o=0;o<n.length;o++){var s=n[o],r=s.itemConfig;(r.bagType==t||void 0==r.bagType&&0==t)&&(e+=s.count)}return e},e.prototype.getSurplusCount=function(){return this.getMaxBagRoom()-this.getBagItemNum()},e.prototype.getMaxBagRoom=function(){return this.bagNum+DataCenter.ins().BackpackVipGridConfig[vipControl.lv].grid+payControl.getAddBagGrid()+payControl.getAddBagFranchiseGrid()},e.prototype.sort1=function(t,e){var i=t.point,n=e.point;return i>n?-1:n>i?1:0},e.prototype.sort2=function(t,e){var i=t.point,n=e.point;return n>i?-1:i>n?1:0},e.prototype.getHejiEquipsByType=function(t){for(var e=this.bagModel[1],i=[],n=0;n<e.length;n++){var o=e[n],s=ItemUtils.getType(o.itemConfig),r=ItemUtils.getSubType(o.itemConfig);5==s&&r==t&&i.push(o)}return i.sort(this.sort3),i},e.prototype.sort3=function(t,e){var i=t.point,n=e.point;return i>n?-1:n>i?1:t.configID>e.configID?-1:t.configID<e.configID?1:0},e.prototype.getBagSortEquips=function(t){void 0===t&&(t=0);var e=this.bagModel[i.BAG_TYPE_EQUIP];return t?e.sort(this.sort1):e.sort(this.sort2),e},e.prototype.getBagSortQualityEquips=function(t,e,n,o){void 0===t&&(t=5),void 0===e&&(e=0),void 0===n&&(n=0),void 0===o&&(o=null);var s=this.bagModel[i.BAG_TYPE_EQUIP],r=[];if(!s)return r;for(var a=0;a<s.length;a++){var l=ItemUtils.getQuality(s[a].itemConfig);5!=t&&(l>t||e&&t>l)||(null==o||o(s[a]))&&(r[r.length]=s[a])}return r},e.prototype.getLegendOutEquips=function(){for(var t=this.getBagEquipsByQuality(5),e=[],i=[],n=[],o=heroControl.subRolesLen,s=0;o>s;s++){var r=heroControl.getSubRoleByIndex(s);n[r.job]||(n[r.job]=[]);for(var a=r.getEquipLen(),l=0;a>l;l++){var h=r.getEquipByIndex(l);h.item.itemConfig&&this.addOneEquipToListEx(i,h,r.job)}}for(var u,s=0;s<t.length;s++){var p=t[s],c=ItemUtils.getSubType(p.itemConfig);if(0==c||2==c){for(var d=!1,g=0;g<i.length;g++){var m=ItemUtils.getSubType(p.itemConfig);if(m==c){d=!0;break}}d&&(u=this.checkEquipsIsGood(i,this.cloneItemDataInfo(p)),u&&(equipControl.checkEquipsIsWear(u)||5!=ItemUtils.getQuality(u.itemConfig)||e.push(u)))}}return e},e.prototype.getLegendHasResolve=function(){for(var t=this.getBagEquipsByQuality(4),e=[],i=heroControl.subRolesLen,n=0;i>n;n++)for(var o=heroControl.getSubRoleByIndex(n),s=o.getEquipLen(),r=0;s>r;r++){var a=o.getEquipByIndex(r);a.item.itemConfig&&this.addOneEquipToListRed(e,a,n)}for(var l,n=0;n<t.length;n++){var h=t[n];ItemUtils.getJob(h.itemConfig);if(!BreakDownView.fitleEquip[h.configID]&&(l=this.checkEquipsIsGoodRed(e,this.cloneItemDataInfo(h)),!l))return!0}return!1},e.prototype.otherEquipSmeltFilter=function(t){var e=ItemUtils.getType(t.itemConfig),i=ItemUtils.getSubType(t.itemConfig);
if(t.itemConfig&&4==e)return!0;if(0==e){for(var n in IntensifyConst.FORGE_EQUIP)if(IntensifyConst.EQUIP_POS[IntensifyConst.FORGE_EQUIP[n]]==i)return!1;return!0}return!1},e.prototype.normalEquipSmeltFilter=function(t){return 0==ItemUtils.getType(t.itemConfig)},e.prototype.getHejiOutEquips=function(){var t=[];return t.length<9&&this.checkHejiEquipsTodestroy(t),this.creatListLength(t),t},e.prototype.getOutEquips=function(t){void 0===t&&(t=0);var e=[],i=[];if(0==t||3==t){e=this.getBagSortQualityEquips(5,0,1,this.normalEquipSmeltFilter);for(var n=[],o=heroControl.subRolesLen,s=0;o>s;s++)for(var r=heroControl.getSubRoleByIndex(s),a=r.getEquipLen(),l=0;a>l;l++){var h=r.getEquipByIndex(l);h.item.itemConfig&&this.addOneEquipToList(n,h,r.job)}for(var u=void 0,s=0;s<e.length;s++){var p=e[s];if(u=this.checkEquipsIsGood(n,this.cloneItemDataInfo(p)),u&&!equipControl.checkEquipsIsWear(u)&&ItemUtils.getQuality(u.itemConfig)<4&&ItemUtils.getSubType(u.itemConfig)!=IntensifyConst.EQUIP_POS[8]&&i.push(u),i.length>=9)break}i.length<9&&this.getGuanyinEquip(i),this.upLevelEquips=[]}else if(1==t){e=this.getBagGoodsBySort(3);for(var s=0;s<e.length&&(i.push(e[s]),!(i.length>=9));s++);}else if(2==t){var c=this.getBagGoodsByType(24),d=this.getBagGoodsByType(98);e=c.concat(d);for(var s=0;s<e.length;s++){var p=e[s];i.push(p.copy())}for(var o=heroControl.subRolesLen,s=0;o>s;s++)for(var r=heroControl.getSubRoleByIndex(s),g=soulBoneControl.soulBoneData[r.index],m=0;7>=m;m++){var f=0,v=g?g.items[m].itemId:0;v||(v=DataCenter.ins().SoulBoneConfig.baseequipid[m],f=v);for(var y=DataCenter.ins().SoulBoneEquipConfig[v].stage,C=soulBoneControl.getSoulBoneItemsFormLists(i,m),T=0;T<C.length;T++){var w=DataCenter.ins().SoulBoneEquipConfig[C[T].itemConfig.id];if((w.stage>y||w.stage==y&&C[T].itemConfig.id==f)&&(v=C[T].itemConfig.id,y=w.stage,C[T].count--,C[T].count<=0))for(var I=i.length-1;I>=0;I--){var b=i[I];b.handle==C[T].handle&&i.splice(I,1)}}this.filterHunguUpItem(i,v)}}return this.creatListLength(i),i},e.prototype.filterHunguUpItem=function(t,e){var i=DataCenter.ins().SoulBoneEquipConfig[e];if(i&&i.addStageCost){for(var n in i.addStageCost)for(var o=t.length-1;o>=0;o--){var s=t[o];i.addStageCost[n].id==s.itemConfig.id&&(s.count-=i.addStageCost[n].count,s.count<=0&&t.splice(o,1))}i.nextId&&this.filterHunguUpItem(t,i.nextId)}},e.prototype.creatListLength=function(t){if(t.length<9)for(var e=0;9>e;e++)void 0==t[e]&&(t[e]=null)},e.prototype.checkUpLevelEquips=function(t){var e=ItemUtils.getJob(t.itemConfig),i=ItemUtils.getSubType(t.itemConfig),n=t.itemConfig.zsLevel,o=t.itemConfig.level,s=ItemUtils.getQuality(t.itemConfig);if(5==s)return null;this.upLevelEquips||(this.upLevelEquips=[]),this.upLevelEquips[e]||(this.upLevelEquips[e]=[]),this.upLevelEquips[e][i]||(this.upLevelEquips[e][i]=[]),this.upLevelEquips[e][i][n]||(this.upLevelEquips[e][i][n]=[]);var r=this.upLevelEquips[e][i][n][o];if(r){var a=this.checkEquipGetBest(r,t);return a==r&&(this.upLevelEquips[e][i][n][o]=t),a}return this.upLevelEquips[e][i][n][o]=t,null},e.prototype.checkUplevelBest=function(t,e){var i,n=ItemUtils.getJob(t.itemConfig),o=ItemUtils.getSubType(t.itemConfig),s=null;return e[n]||(e[n]=[]),e[n][o]||(e[n][o]=null),i=e[n][o],i&&(s=this.checkEquipGetBest(i,t)),s},e.prototype.checkEquipsIsGoodRed=function(t,e){for(var i=ActorControl.level,n=reincarnateControl.lv,o=(ItemUtils.getJob(e.itemConfig),ItemUtils.getSubType(e.itemConfig)),s=heroControl.subRolesLen,r=0;s>r;r++){t[r]||(t[r]=[]);var a=e.itemConfig.zsLevel?e.itemConfig.zsLevel:0,l=e.itemConfig.level?e.itemConfig.level:0;if(n>=a&&i>=l){if(!t[r][o])return e;var h=this.checkEquipGetBestEx(t[r][o],e);if(!equipControl.checkEquipsIsWear(h))return h}}return null},e.prototype.checkEquipsIsGood=function(t,e){var i=ActorControl.level,n=reincarnateControl.lv,o=ItemUtils.getJob(e.itemConfig),s=ItemUtils.getSubType(e.itemConfig);if(e.itemConfig.level>i||e.itemConfig.zsLevel>n){var r=this.checkUplevelBest(e,t);return r&&!equipControl.checkEquipsIsWear(r)?r:this.checkUpLevelEquips(e)}if(!t[o]||!t[o][s])return this.addOneEquipToList(t,e),null;var a=t[o][s],l=this.checkEquipGetBest(a,e);return a==l&&(t[o][s]=e),l},e.prototype.checkEquipGetBestEx=function(t,e){return t&&e?t.point>=e.point?t:e:null},e.prototype.checkEquipGetBest=function(t,e){return null!=t&&null!=e&&t.point>=e.point?e:t},e.prototype.addOneEquipToListEx=function(t,e,i){void 0===i&&(i=0);var n;n=e instanceof EquipVo?this.cloneItemDataInfo(e.item):this.cloneItemDataInfo(e);var o=ItemUtils.getJob(n.itemConfig),s=ItemUtils.getSubType(n.itemConfig);o||(o=i),t[o]||(t[o]=[]),t[o][s]=n},e.prototype.addOneEquipToListRed=function(t,e,i){var n;n=e instanceof EquipVo?this.cloneItemDataInfo(e.item):this.cloneItemDataInfo(e);var o=ItemUtils.getSubType(n.itemConfig);t[i]||(t[i]=[]),t[i][o]=n},e.prototype.addOneEquipToList=function(t,e,i){void 0===i&&(i=0);var n;n=e instanceof EquipVo?this.cloneItemDataInfo(e.item):this.cloneItemDataInfo(e);var o=ItemUtils.getJob(n.itemConfig);0==o&&(o=i);var s=ItemUtils.getSubType(n.itemConfig);t[o]||(t[o]=[]),t[o][s]=n},e.prototype.cloneItemDataList=function(t){for(var e=[],i=0;i<t.length;i++){var n=new ItemData;n.handle=t[i].handle,n.configID=t[i].configID,n.att=t[i].att,n.itemConfig=t[i].itemConfig,n.count=t[i].count,e.push(n)}return e},e.prototype.cloneItemDataInfo=function(t){var e=new ItemData;return e.handle=t.handle,e.configID=t.configID,e.att=t.att,e.itemConfig=t.itemConfig,e.count=t.count,e},e.prototype.getBagGoodsBySort=function(t){var e=this.getGoodsListByType(t,i.BAG_TYPE_OTHTER);return e.sort(function(t,e){return t.configID>e.configID?1:t.configID<e.configID?-1:0}),e},e.prototype.getBagGoodsByType=function(t){var e=this.bagModel[i.BAG_TYPE_OTHTER],n=[];for(var o in e)ItemUtils.getType(e[o].itemConfig)==t&&n.push(e[o]);return n},e.prototype.getBagGoodsByDescIndex=function(t,e){void 0===e&&(e=i.BAG_TYPE_OTHTER);var n,o=this.bagModel[e];for(var s in o)if(o[s].itemConfig.descIndex==t){n=o[s];break}return n},e.prototype.getBagEquipsByQuality=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=i.BAG_TYPE_EQUIP);var o=this.bagModel[n],s=[];for(var r in o){var a=o[r];a&&ItemUtils.getType(a.itemConfig)==e&&ItemUtils.getQuality(a.itemConfig)==t&&s.push(o[r])}return s},e.prototype.getBagGoodsByHandle=function(t,e){for(var i=this.bagModel[t],n=0;n<i.length;n++)if(i[n].handle==e)return i[n];return null},e.prototype.getHuntGoods=function(t){return this.getGoodsListByType(t)},e.prototype.getGoodsListByType=function(t,e){void 0===e&&(e=i.BAG_TYPE_TREASUREHUNT);var n=this.bagModel[e],o=[];if(n)for(var s=0;s<n.length;s++){var r=n[s].itemConfig;(r.bagType==t||void 0==r.bagType&&0==t)&&(r.split?this.splitItemData(o,n[s]):o.push(n[s]))}return o},e.prototype.splitItemData=function(t,e){var i=e.count;if(i>1)for(;i>0;){var n=e.copy();n.count=1,t.push(n),i-=1}else t.push(e)},e.prototype.getHuntGoodsBySort=function(t){var e=[];return this.bagModel[i.BAG_TYPE_TREASUREHUNT]&&(e=this.getGoodsListByType(t),e.sort(function(t,e){var i=ItemUtils.getType(t.itemConfig),n=ItemUtils.getType(e.itemConfig);if(n>i)return 1;if(i>n)return-1;if(i){if(t.configID>=e.configID)return 1;if(t.configID<e.configID)return-1}else{if(t.point>=e.point)return-1;if(t.point<e.point)return 1}return 0})),e},e.prototype.getGuanyinEquip=function(t){var e=this.getBagSortQualityEquips(5,0,0,this.otherEquipSmeltFilter),i=0,n=heroControl.subRolesLen;if(3>n)i=0;else for(var o=0;n>o;o++){var s=heroControl.getSubRoleByIndex(o),r=s.getEquipByIndex(8);(r&&r.item&&r.item.configID<i||0==i)&&(i=r.item.configID)}if(e.length>0)for(var a in e){var l=this.updateGuanyinEquip(e[a],i);if(null!=l&&t.push(l),t.length>=9)break}return t},e.prototype.updateGuanyinEquip=function(t,e){void 0===e&&(e=0);var i=heroControl.subRolesLen;if(ItemUtils.getSubType(t.itemConfig)==IntensifyConst.EQUIP_POS[8]){for(var n=t.point,o=0;i>o;o++){var s=heroControl.getSubRoleByIndex(o),r=s.getEquipByIndex(8),a=r.item.itemConfig;if(!a||a&&n>r.item.point)return null}return t}return null},e.prototype.getGuanyinLevel=function(t){var e=TextUtils.getChineseNum(t.id-600005+1);return e+LangMgr.getValueByKey("osaLevelJ")},e.prototype.getIsExitUsedItem=function(){var t=this.bagModel[i.BAG_TYPE_OTHTER];if(!t)return!1;for(var e=0;e<t.length;e++)if(t[e].getCanbeUsed())return this.isExitUsedItem=1,!0;return this.isExitUsedItem=0,!1},e.prototype.getEquipsScoreByRolesOfBody=function(){for(var t=heroControl.subRolesLen,e=0,i=0;t>i;i++){var n=heroControl.getSubRoleByIndex(i);if(n&&n.equipsData)for(var o=n.equipsData,s=0;13>s;s++)o[s]&&o[s].item&&o[s].item.itemConfig&&o[s].item.itemConfig.id&&(e+=o[s].item.point)}return e},e.prototype.calculationScore=function(t){for(var e,i=0,n=heroControl.subRolesLen,o=0;n>o;o++){var s=heroControl.getSubRoleByIndex(o);if(s.job==ItemUtils.getJob(t.itemConfig))for(var r=s.getEquipLen(),a=0;r>a;a++)e=s.getEquipByIndex(a).item,e&&e.itemConfig&&ItemUtils.getSubType(e.itemConfig)==ItemUtils.getSubType(t.itemConfig)&&(i=0==i?e.point:Math.min(e.point,i))}return t.point-i},e.prototype.useRenameItem=function(t,e){UIMgr.ins().open(RenameView)},e.getAttrAllPower=function(t,e){void 0===e&&(e=null);var i=DataCenter.ins().CombatPowerConfig,n=0;if(!t)return n;for(var o=0,s=0;s<t.length;s++){var r=t[s].type,a=t[s].value;i[r]&&a&&(n+=a*i[r].power,e&&(o+=ItemUtils.relatePower(t[s],e)))}return Math.floor(n/100)+Math.floor(o)},e.getAttrPower=function(t,e){void 0===e&&(e=null);var i=DataCenter.ins().CombatPowerConfig,n=0;if(!t)return n;for(var o=0,s=0;s<t.length;s++){var r=t[s].type,a=t[s].value;11!=r&&12!=r&&16!=r&&i[r]&&a&&(n+=a*i[r].power,65==r&&e&&(o+=ItemUtils.relatePower(t[s],e)))}return Math.floor(n/100)+Math.floor(o)},e.getAttrPower2=function(t,e){if(void 0===e&&(e=null),!t||!t.length)return 0;for(var i=DataCenter.ins().CombatPowerConfig,n=0,o=0,s=0;s<t.length;s++){var r=t[s].type,a=t[s].value;11!=r&&12!=r&&16!=r&&23!=r&&24!=r&&i[r]&&a&&(n+=a*i[r].power,65==r&&e&&(o+=ItemUtils.relatePower(t[s],e)))}return Math.floor(n/100)+Math.floor(o)},e.getEquipAddAttrs=function(t,e){if(!t||!t.length||e>=heroControl.subRolesLen)return null;var i=heroControl.getSubRoleByIndex(e);if(!i||!i.equipsData||!i.equipsData.length)return null;for(var n=[],o=t.length,s=i.equipsData.length,r=0;o>r;r++){var a=t[r];if(a.type<s){var l=i.equipsData[a.type];l&&l.item&&l.item.itemConfig&&(n=n.concat(this.getEquipAddAttrByItem(l.item,a.value)))}}return n},e.getEquipAddAttrsByPos=function(t,e,i){if(t>=heroControl.subRolesLen||0>=i)return null;var n=heroControl.getSubRoleByIndex(t);if(!n||!n.equipsData||!n.equipsData.length)return null;var o=n.equipsData[e];return o&&o.item&&o.item.itemConfig?this.getEquipAddAttrByItem(o.item,i):null},e.getEquipAddAttrByItem=function(t,e){var i={hp:2,atk:4,def:5,res:6},n=DataCenter.ins().EquipConfig[t.itemConfig.id],o=[],s=t.att?t.att.length:0;for(var r in i)if(n[r]){for(var a=n[r],l=0;s>l;l++)if(t.att[l].type==i[r]){a+=t.att[l].value;break}o.push(new AttributeData(i[r],Math.floor(a*e/100)))}return o},e.getAttPowerContainRelate=function(t,e,n){if(void 0===n&&(n=null),!t||!t.length)return 0;var o,s=DataCenter.ins().CombatPowerConfig,r=0,a=0,l=t.length;o=n?n:isNaN(e)?null:heroControl.getSubRoleByIndex(e);for(var h=0;l>h;h++){var u=t[h],p=u.type,c=u.value;if(c)if(89!=p)if(90!=p)if(i.isRelateAtt(p)){if(!o)continue;a+=ItemUtils.relatePower(u,o);var d=ItemUtils.relatePowerEx([u],o);d&&d.length&&(a+=i.getAttrPower(d))}else s[p]&&(r+=c*s[p].power);else{if(!o)continue;a+=o.power*c/1e4}else a+=c}return Math.floor(r/100)+Math.floor(a)},e.isRelateAtt=function(t){if(11==t||12==t||23==t||24==t)return!0;var e=DataCenter.ins().CombatPowerConfig[t];return e&&e.relate_type?!0:!1},e.addSkillPower=function(t,e,i){for(var n=0,o=0,s=0,r=0;r<i.length;r++)89==i[r].type?n=i[r].value:90==i[r].type&&(o=i[r].value);s+=t+n;for(var a=0;a<e.length;a++)s+=e[a].power*o/1e4;return Math.floor(s)},e.prototype.setEquipPowerDic=function(t,e,i){void 0===i&&(i=0),this.equipPowerDic[t]||(this.equipPowerDic[t]=[]),this.equipPowerDic[t][e]||(this.equipPowerDic[t][e]=0),this.equipPowerDic[t][e]=i},e.prototype.getEquipPowerDic=function(t,e){return this.equipPowerDic[t]&&this.equipPowerDic[t][e]?this.equipPowerDic[t][e]:0},e.prototype.getLowEquipIndex=function(t,e){for(var i=-1,n=Number.MAX_VALUE,o=t.length,s=0;o>s;s++)if(IntensifyConst.EQUIP_POS[s]==e){var r=t[s];if(0==r.handle)return s;var a=r.point;n>a&&(i=s,n=a)}return i},e.prototype.getHejiEquips=function(){for(var t=this.bagModel[1],e=[],i=0;i<t.length;i++){var n=t[i];5==ItemUtils.getType(n.itemConfig)&&e.push(n)}return e},e.prototype.checkIsWear=function(t){if(!t)return!1;for(var e=0;8>e;e++){var i=skillControl.equipListData[e];if(i&&i.handle==t.handle)return!1}return!0},e.prototype.makeHejiWearList=function(t){var e=ItemUtils.getSubType(t.itemConfig);this.wearList[e]=t},e.prototype.checkHejiEquipsTodestroy=function(t){if(skillControl.equipListData){for(var e=0;8>e;e++){var i=skillControl.equipListData[e];i&&0!=i.configID&&this.makeHejiWearList(i)}for(var n,o,s=this.getHejiEquips(),r=s.length,a=0;r>a;a++){n=s[a];var l=ItemUtils.getSubType(n.itemConfig);if(o=this.wearList[l],o&&0!=o.configID){var h=0,u=0;if(h=n.point,u=o.point,u>=h)t.push(n);else{var p=0;n.itemConfig.level<=p&&(this.wearList[l]=n,this.checkIsWear(o)&&t.push(o))}if(t.length>=9)break}}}},e.prototype.getEquipByPos=function(t,e){var n=this.bagModel[i.BAG_TYPE_EQUIP],o=heroControl.getSubRoleByIndex(t),s=o.getEquipByIndex(e),r=0;r=s&&s.item.itemConfig?ItemUtils.getSubType(s.item.itemConfig):e;for(var a=[],l=[],h=ActorControl.level,u=reincarnateControl.lv,p=0;p<n.length;p++){var c=ItemUtils.getJob(n[p].itemConfig),d=ItemUtils.getSubType(n[p].itemConfig),g=ItemUtils.getType(n[p].itemConfig);if(33!=g&&(c==o.job||0==c)&&d==r){if(91==Math.floor(n[p].itemConfig.id/1e4))continue;if(s&&n[p].handle==s.item.handle)continue;u<n[p].itemConfig.zsLevel||h<n[p].itemConfig.level?l.push(n[p]):a.push(n[p])}}return a=a.sort(this.sortFun),l.sort(this.sortFun),a=a.concat(l)},e.prototype.sortFun=function(t,e){var n=backpackControl.getEquipAttrs(t),o=i.getAttrPower(n),s=backpackControl.getEquipAttrs(e),r=i.getAttrPower(s);return r>o?1:o>r?-1:0},e.prototype.getEquipAttrs=function(t){var e=DataCenter.ins().EquipConfig[t.configID],i=[];for(var n in AttributeData.translate)if(!(e[n]<=0))for(var o=t.att,s=0;s<o.length;s++)if(o[s].type==RoleModel.getAttrTypeByName(n)){var r=new AttributeData;r.type=o[s].type,r.value=e[n]+o[s].value,i.push(r);break}return i},e.prototype.checkEqRedPoint=function(t,e,n){var o,s=e.getEquipByIndex(t);o=s.item.itemConfig&&ItemUtils.getQuality(s.item.itemConfig)<4?null:DataCenter.ins().ItemConfig[s.item.configID+1];var r=0,a=0;if(s.item.itemConfig&&4==ItemUtils.getQuality(s.item.itemConfig)&&s.item.itemConfig.zsLevel>=12)return null;if(s.item.itemConfig&&5==ItemUtils.getQuality(s.item.itemConfig))return null;if(null!=o&&(o.level>ActorControl.level||o.zsLevel>reincarnateControl.lv))return null;if(void 0!=o&&0!=s.item.handle&&4==ItemUtils.getQuality(s.item.itemConfig)&&1!=s.item.itemConfig.level&&-1==i.fitleEquip.indexOf(s.item.configID)){var l=DataCenter.ins().DeityEquipLevelupConfig[s.item.configID];l&&(r=l.count,a=l.itemId)}else{var h=equipControl.getEquipConfigIDByPosAndQualityByGod(e,t,4,e.job),u=DataCenter.ins().DeityEquipComposeConfig[h];if(u){r=u.count,a=u.itemId;var p=this.getBagGoodsCountById(0,a);return p>=r&&!this.OrangeEquipRedPoint[t]?(n&&(this.OrangeEquipRedPoint[t]=!1),!0):!1}}var c=this.getBagGoodsCountById(0,a);return c>=r},e.prototype.downChoosableGiftResult=function(t){0==t&&this.dispatchGiftResult()},e.prototype.dispatchGiftResult=function(){EventMgr.ins().dispatch(666)},e.prototype.upChoosableGift=function(t,e,i){return[t,e,i+1]},e.prototype.getRmbItemIsBuy=function(t){var e=DataCenter.ins().ItemConfig[t];return e&&e.needyuanbao&&ActorControl.yb>=e.needyuanbao?!0:!1},e.prototype.getAwardByOpenDay=function(t,e){var i=GameServer.serverOpenDay+1,n=[];for(var o in t)n.push(+o);n.sort(function(t,e){return e>t?0:1});for(var s=0;s<n.length;s++)if(i>=n[s]&&(void 0==n[s+1]||n[s+1]>i))return t[n[s]];return e},e.prototype.dispatchCancelUseItem=function(t,e){return void 0===e&&(e=!0),200155==t?!1:200137==t?!1:this.cancelUseItem[t]?!1:(this.cancelUseItem[t]=1,e?void 0:!1)},e.prototype.getIsCancelUse=function(t){return 1==this.cancelUseItem[t]},e.checkLvDanPoint=function(t){return t.count>0&&ActorControl.level+t.count>=70},e.prototype.checkLvUpItemRed=function(){var t=GameServer.serverOpenDay;if(2>t){if(this._lvUpLoginRed)return!0}else{if(ServerStorage.ins().getBitBool(ClientSetBit.level_up_item_red))return!0;if(Number(ClientStorage.ins().getItem("level_up_item_red_day"))!=t)return!0}return this.getRmbItemIsBuy(200155)&&payControl.isFisrtCharge()?!0:!1},e.prototype.hideLvUpRed=function(){var t=GameServer.serverOpenDay;2>t?this._lvUpLoginRed=!1:(ServerStorage.ins().setBitBool(ClientSetBit.level_up_item_red,!1),ClientStorage.ins().setItem("level_up_item_red_day",t))},e.prototype.getTitleUpLvRedPoint=function(t,e){var i=DataCenter.ins().TitleLvUpConfig[t.useArg],n=titleControl.getTitleIsFullLv(t.useArg);if(2>n||!i)return!1;if(!titleControl.lvDict[t.useArg])return!0;var o=titleControl.lvDict[t.useArg]+1;if(2>=o)return!0;var s=i[o].cost;return e>=s?!0:!1},e.prototype.recordUseDan=function(t){},e.prototype.getItemNameByID=function(t){var e=DataCenter.ins().ItemConfig[t];return e?e.name:Currency.getCurrencyName(t)},e.prototype.isHideDanIcon=function(t){if(!SwitchMgr.ins().checkOpen(2))return!0;var e=DataCenter.ins().ItemConfig[t],i=e.useArg;return i&&i.actId&&this.getDanActivity(i.actId)?!1:!0},e.prototype.getDanActivity=function(t){var e;if(t instanceof Array)for(var i=0,n=t;i<n.length;i++){var o=n[i];if(e=amusementControl.activityData[o],e&&e.isOpenActivity())return e}else if(e=amusementControl.activityData[t],e&&e.isOpenActivity())return e;return null},e.prototype.hideDan=function(t){var e,i=new Date(GameServer.serverTime),n=1e4*i.getFullYear()+100*(i.getMonth()+1)+i.getDate();switch(t){case 22:e=ServerStorage.ins().getValue(52);break;case 23:e=ServerStorage.ins().getValue(53);break;case 24:e=ServerStorage.ins().getValue(54);break;case 25:e=ServerStorage.ins().getValue(55);break;case 26:e=ServerStorage.ins().getValue(56);break;case 27:e=ServerStorage.ins().getValue(57);break;default:return!payControl.showZhShDanRe()[0]}return!e||n>e?!1:!0},e.prototype.checkDanRed=function(){var t=this.bagModel[i.BAG_TYPE_EQUIP];if(!t||!t.length)return!1;for(var e=DataCenter.ins().LittleSystemBaseConfig.equipUpItem,n=0;n<e.length;n++){var o=e[n];if(!this.isHideDanIcon(o)){if(this.getBagGoodsCountById(i.BAG_TYPE_OTHTER,o))for(var s=0;s<t.length;s++){var r=t[s];if(this.canUseDan(r,o)&&0==ItemUtils.getSubType(r.itemConfig))return!0}break}}return!1},e.prototype.canUseDan=function(t,e){var i=DataCenter.ins().ItemConfig[e].useArg,n=i.quality,o=i.levelLimit?i.levelLimit:0,s=ItemUtils.getSubType(t.itemConfig);ItemUtils.getQuality(t.itemConfig),CommonFun.convertCfgLvToComLv(t.itemConfig.level,t.itemConfig.zsLevel);return 0==ItemUtils.getType(t.itemConfig)&&s>=0&&7>=s&&ItemUtils.getQuality(t.itemConfig)<=n&&(!o||CommonFun.convertCfgLvToComLv(t.itemConfig.level,t.itemConfig.zsLevel)<=o)?!0:!1},e.prototype.getEquipsByDan=function(t){var e=this.bagModel[i.BAG_TYPE_EQUIP];if(!e||!e.length)return null;for(var n=[],o=0;o<e.length;o++){var s=e[o];this.canUseDan(s,t)&&n.push(s)}return n},e.prototype.isDanRechargeEnd=function(t){if(!SwitchMgr.ins().checkOpen(2))return!0;var e=DataCenter.ins().ItemConfig[t],i=e.useArg;return i&&i.actId&&this.getDanActivity(i.actId)?!1:!0},e.BAG_ENOUGH=20,e.BAG_DESC_TYPE_HEIR=11,e.BAG_TYPE_OTHTER=0,e.BAG_TYPE_EQUIP=1,e.BAG_TYPE_TREASUREHUNT=2,__decorate([up(2,[3])],e.prototype,"upAddBagGrid",null),__decorate([up(6,[3,3,10])],e.prototype,"upUseItem",null),__decorate([down(1,[1,1,ByteConst.ItemDatas])],e.prototype,"downBagData",null),__decorate([down(6,[1])],e.prototype,"downUserItemBack",null),__decorate([down(2,[3])],e.prototype,"downBagValumnAdd",null),__decorate([down(3,[1,10])],e.prototype,"downDeleteItem",null),__decorate([down(4,[1].concat(ByteConst.ItemDatas,[1]))],e.prototype,"downAddItem",null),__decorate([callDelay(50)],e.prototype,"addDelay",null),__decorate([callDelay(50)],e.prototype,"deleteDelay",null),__decorate([down(5,[1,10,3,1])],e.prototype,"downUpDataItem",null),__decorate([up(7,[3,3])],e.prototype,"upMergeItem",null),__decorate([down(7,[3,3,ByteConst.RewardVos])],e.prototype,"downMergeItemBack",null),__decorate([up(4,[10])],e.prototype,"upGetGoodsByStore",null),__decorate([up(100,[3,[10]])],e.prototype,"upDamageItem",null),__decorate([down(100,[1,3,[3,3]])],e.prototype,"downDamageItemComplete",null),__decorate([down(101,[[3,3]])],e.prototype,"downUseLimitData",null),__decorate([down(8,[4])],e.prototype,"downChoosableGiftResult",null),__decorate([up(8,[3,3,3])],e.prototype,"upChoosableGift",null),e=i=__decorate([protocolsId(3)],e);var i}(BaseSystem);__reflect(BackpackControl.prototype,"BackpackControl");var AmusementType13DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.proCount=[0,0,0,0,0,0,0,0],e.proReward=[0,0,0,0,0,0,0,0],e.count=0,e.playList=[],e.bestlogs=[],e}return __extends(e,t),e.prototype.initAmusement=function(t){this.count=t[0];for(var e=0;t[1].length>e;e++){var i=t[1][e][0],n=t[1][e][1],o=t[1][e][2];this.proCount[i]=n,this.proReward[i]=o?1:0}this.bestlogs=[];for(var e=0;t[2].length>e;e++){var s=[t[2][e][0],this.id,t[2][e][1],t[2][e][2]];this.bestlogs.push(s)}this.bestlogs.length&&this.bestlogs.reverse()},e.prototype.updateAmusement=function(t){this.initAmusement(t);var e=DataCenter.ins().Amusement13Config[this.id];this.playList=[];for(var i in e)if(this.proCount[e[i].index]<=e[i].count&&!this.proReward[e[i].index]&&-1==this.playList.indexOf(e[i].index)){this.playList.push(e[i].index);break}},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){for(var t=1;t<this.proCount.length;t++)if(this.proCount[t]/DataCenter.ins().Amusement13Config[this.id][t].count>=1&&!this.proReward[t])return!0;return!1},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e}(AmusementBaseDataVo);__reflect(AmusementType13DataVo.prototype,"AmusementType13DataVo");var BackpackBuyGridView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BackpackBuyGridViewSkin",this.price.setType(2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.decBtn,this.onTap),this.addEventTouchTap(this.addBtn,this.onTap),this.addEventTouchTap(this.sureBtn,this.onTap),this.addEventTouchTap(this.cancelBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTap),this.setCount(5)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.decBtn,this.onTap),this.removeEventTouchTap(this.addBtn,this.onTap),this.removeEventTouchTap(this.sureBtn,this.onTap),this.removeEventTouchTap(this.cancelBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.decBtn:this.setCount(Number(this.count.text)-5);break;case this.addBtn:this.setCount(Number(this.count.text)+5);break;case this.sureBtn:if(!(ActorControl.yb>=this.price.getPrice())){tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),UIMgr.ins().close(this);break}backpackControl.upAddBagGrid(Number(this.count.text)/5);case this.cancelBtn:UIMgr.ins().close(this);break;case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e.prototype.setCount=function(t){var e=DataCenter.ins().BackpackConfig,i=DataCenter.ins().BackpackExpandConfig,n=CommonUtils.getObjectLength(i),o=(backpackControl.bagNum-e.baseSize)/e.rowSize,s=(n-o)*e.rowSize;5>t?(t=5,tipsControl.showTips(LangMgr.getValueByKey("warnTips1"))):t>s&&(t=s,tipsControl.showTips(LangMgr.getValueByKey("warnTips2"))),this.count.text=""+t;for(var r=0,a=t/e.rowSize,l=1;a>=l;l++)r+=i[o+l].cost;this.price.setPrice(r)},e}(BaseEuiView);__reflect(BackpackBuyGridView.prototype,"BackpackBuyGridView");var BackpackView=function(t){function e(){var e=t.call(this)||this;return e.oldIndex=0,e.refThreshold={n:0,r:0},e.skinName="BackpackViewSkin",e.isTopLevel=!0,e.canVis=!0,e.exclusionWins=["RuneExchangeShopWin"],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.tab.dataProvider=this.viewStack,this.itemList.itemRenderer=ItemBase,this.itemListGoods.itemRenderer=ItemBase,this.itemListRune.itemRenderer=ItemBase,this.itemScroller.viewport=this.itemList,this.itemGoodsScroller.viewport=this.itemListGoods,this.damageItemList.itemRenderer=ItemBase,this.damageItemScroller.viewport=this.damageItemList},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.smeltBtn,this.onClick),this.addEventTouchTap(this.damageBtn,this.onClick),this.addEventTouchTap(this.addBtn,this.onClick),this.addEventChange(this.tab,this.onClick),this.addCustomEvent(270,this.setBagTips),this.addCustomEvent(274,this.setCount),this.addCustomEvent(272,this.setIsExitUsedItem),this.addCustomEvent(269,this.showBagBtnRedPoint),this.addCustomEvent(267,this.updateBag),this.addCustomEvent(266,this.updateBag),this.addCustomEvent(268,this.updateBag),this.addCustomEvent(123,this.doubleYBShow);var i=0;void 0!=t[0]&&(i=t[0],3==i&&this.piecePanel.open(t[1],t[2],t[3])),this.viewStack.selectedIndex=this.tab.selectedIndex=i,this.setBagData(i),this.setIsExitUsedItem(),backpackControl.dispatchBagVolChange(),this.showBagBtnRedPoint(backpackControl.isChange),pieceControl.isOpen()?this.openMerge():this.inactiveMerge(),SwitchMgr.ins().checkOpen(1012)?this.openDamage():this.inactiveDamage(),this.smeltBtn.label=smeltControl.checkOpenSystem()?LangMgr.getValueByKey("smeltKeySmelt1"):LangMgr.getValueByKey("smeltKeySmelt0"),this.doubleYBShow()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=UIMgr.ins().getView(GameBottomView);i&&i.closeNav(GameBottomView.NAV_BAG)},e.prototype.doubleYBShow=function(){var t=equipControl.ybTimers-GameServer.serverTime;this.ybTag.visible=t>0},e.prototype.openMerge=function(){var t=this.viewStack.getChildIndex(this.piecePanel);0>t&&this.viewStack.addChildAt(this.piecePanel,3),this.tab.dataProvider=this.viewStack,this.redPoint3.visible=pieceControl.redPoint(),this.redPointGroup.addChildAt(this.redPoint3,3)},e.prototype.inactiveMerge=function(){var t=this.viewStack.getChildIndex(this.piecePanel);t>=0&&this.viewStack.removeChildAt(t),this.tab.dataProvider=this.viewStack,this.redPoint3.parent&&this.redPoint3.parent.removeChild(this.redPoint3)},e.prototype.openDamage=function(){var t=this.viewStack.getChildIndex(this.damageGroup);0>t&&this.viewStack.addChildAt(this.damageGroup,4),this.tab.dataProvider=this.viewStack,this.redPoint4.visible=this.damageRedPoint.visible=backpackControl.getDamageBagGoodsCountByType(),this.redPointGroup.addChildAt(this.redPoint4,4)},e.prototype.inactiveDamage=function(){var t=this.viewStack.getChildIndex(this.damageGroup);t>=0&&this.viewStack.removeChildAt(t),this.tab.dataProvider=this.viewStack,this.redPoint4.parent&&this.redPoint4.parent.removeChild(this.redPoint4)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.smeltBtn:UIMgr.ins().close(this),UIMgr.ins().open(SmeltEquipView);break;case this.addBtn:var e=DataCenter.ins().BackpackConfig,i=(backpackControl.bagNum-e.baseSize)/e.rowSize;i==CommonUtils.getObjectLength(DataCenter.ins().BackpackExpandConfig)?tipsControl.showTips(StringUtils.addColor(LangMgr.getValueByKey("flowerBox"),ColorUtils.RED)):UIMgr.ins().open(BackpackBuyGridView);break;case this.tab:3==this.tab.selectedIndex?pieceControl.isOpen()?this.piecePanel.open():this.setBagData(4):this.setBagData(this.tab.selectedIndex);break;case this.damageBtn:UIMgr.ins().close(this),UIMgr.ins().open(SmeltEquipView,1)}},e.prototype.setCount=function(){this.itemCount.text=backpackControl.getBagItemNum()+"/"+backpackControl.getMaxBagRoom(),this.damageItemCount.text=backpackControl.getBagDamageItemCount().toString()},e.prototype.updateBag=function(){this.refThreshold.n=this.refThreshold.n,this.refThreshold.r=++this.refThreshold.r,this.setBagData(this.tab.selectedIndex)},e.prototype.setBagData=function(t){switch(void 0===t&&(t=1),t){case 0:var e=backpackControl.getBagSortQualityEquips(5,0,1);e.sort(backpackControl.sort3);var i=this.itemList.dataProvider;i?i.replaceAll(e):this.itemList.dataProvider=new eui.ArrayCollection(e);break;case 1:var n=backpackControl.getBagGoodsBySort(0),o=backpackControl.getBagGoodsBySort(2),s=o.concat(n),r=this.itemListGoods.dataProvider;r?r.replaceAll(s):this.itemListGoods.dataProvider=new eui.ArrayCollection(s);break;case 2:var a=backpackControl.getBagGoodsBySort(1),l=this.itemListRune.dataProvider;l?l.replaceAll(a):this.itemListRune.dataProvider=new eui.ArrayCollection(a);break;case 4:var h=backpackControl.getBagGoodsBySort(3),u=this.damageItemList.dataProvider;u?u.replaceAll(h):this.damageItemList.dataProvider=new eui.ArrayCollection(h)}this.oldIndex!=t?this.oldIndex=t:this.tab.selectedIndex=t,this.setCount()},e.prototype.setIsExitUsedItem=function(){this.redPoint1.visible=backpackControl.getIsExitUsedItem()||backpackControl.getBagGoodsCountByType(8),this.redPoint2.visible=backpackControl.getRuneBagGoodsCountByType(8),this.redPoint3.visible=pieceControl.isOpen()&&pieceControl.redPoint(),this.redPoint4.visible=this.damageRedPoint.visible=backpackControl.getDamageBagGoodsCountByType()},e.prototype.setBagTips=function(t){this.redPoint0.visible=t>0||backpackControl.isChange>0},e.prototype.showBagBtnRedPoint=function(t){this.redPoint.visible=t>0},__decorate([callDelay(100)],e.prototype,"updateBag",null),e}(BaseEuiView);__reflect(BackpackView.prototype,"BackpackView");var BargainControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFristRed=!0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.upGetList(i.TYPE_UNION),this.upGetList(i.TYPE_SERVER),this.upGetKfList()},e.prototype.upGetList=function(t){return[t]},e.prototype.downListData=function(t,e){for(var i=[],n=0;n<e.length;n++){var o=new BargainVo;o.init(e[n]),i.push(o)}i.length>=2&&i.sort(this.sort),0==t?this.auGuildDatas=i:this.auServerDatas=i,EventMgr.ins().dispatch(189)},e.prototype.sort=function(t,e){return SortUtils.sortDescByKey(t.putAwayTime,e.putAwayTime)},e.prototype.sortByAuTime=function(t,e){return SortUtils.sortDescByKey(t.time,e.time)},e.prototype.upOpenAuBox=function(t){return[t]},e.prototype.downOpenSuccess=function(t,e){UIMgr.ins().open(BargainItemChoiceView,t,e)},e.prototype.upUseAuBox=function(t,e){return[t,e]},e.prototype.upAUction=function(t,e,i){return[t,e,i]},e.prototype.downAuctionResult=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];switch(t){case 0:case 1:case 2:var n=new BargainVo;n.init(e);var o=this.getVoByID(n.id);1==t?(this.deleteVo(o),tipsControl.showTips(LangMgr.getValueByKey("auctionNoGoods"))):(this.dateChanged(o,n),tipsControl.showTips(0==t?LangMgr.getValueByKey("auctionSucces"):LangMgr.getValueByKey(LangMgr.getValueByKey("auctionChangeInfo"))));break;case 3:tipsControl.showTips(LangMgr.getValueByKey("auctionShowTime"));break;case 4:tipsControl.showTips(LangMgr.getValueByKey("auctionActiveEnought"))}EventMgr.ins().dispatch(190)},e.prototype.deleteVo=function(t){if(this.auGuildDatas){var e=this.auGuildDatas.indexOf(t);
if(e>=0)return void this.auGuildDatas.splice(e,1)}if(this.auServerDatas){var e=this.auServerDatas.indexOf(t);if(e>=0)return void this.auServerDatas.splice(e,1)}if(this.auKfDatas){var e=this.auKfDatas.indexOf(t);if(e>=0)return void this.auKfDatas.splice(e,1)}},e.prototype.dispatchUpdate=function(){EventMgr.ins().dispatch(495)},e.prototype.getVoByID=function(t){return this.getVo(t,this.auGuildDatas)||this.getVo(t,this.auServerDatas)||this.getVo(t,this.auKfDatas)},e.prototype.getVo=function(t,e){if(!e||e.length<=0)return null;for(var i=e.length,n=0;i>n;n++)if(e[n].id==t)return e[n];return null},e.prototype.upBuy=function(t,e){return[t,e]},e.prototype.downBuyResult=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];switch(t){case 0:case 1:case 2:var n=new BargainVo;n.init(e);var o=this.getVoByID(n.id);2!=t?(this.deleteVo(o),tipsControl.showTips(1==t?LangMgr.getValueByKey("auctionNoGoods"):LangMgr.getValueByKey("auctionBuySucces"))):(this.dateChanged(o,n),tipsControl.showTips(LangMgr.getValueByKey("auctionChangeInfo")));break;case 3:tipsControl.showTips(LangMgr.getValueByKey("auctionShowTime"));break;case 4:tipsControl.showTips(LangMgr.getValueByKey("auctionActiveEnought"))}EventMgr.ins().dispatch(191)},e.prototype.dateChanged=function(t,e){if(t.type==e.type)t.putAwayTime=e.putAwayTime,t.endTime=e.endTime,t.myAuPrice=e.myAuPrice,t.auctionTimes=e.auctionTimes,t.aID=e.aID;else{this.deleteVo(t);var i=this.getAuctionsByType(e.type);i&&(i.push(e),i.length>=2&&i.sort(this.sort))}},e.prototype.getMaxPageByType=function(t,e){var i=this.getAuctionsByType(t);return i&&i.length?Math.ceil(i.length/e):1},e.prototype.getDataByPage=function(t,e,i){var n=this.getAuctionsByType(t);if(!n||!n.length)return null;var o=(e-1)*i;return n.slice(o,o+i)},e.prototype.isAuctionOpen=function(){return reincarnateControl.lv>=DataCenter.ins().BargainConfig.openzhuanshenglv&&GameServer.serverOpenDay+1>=DataCenter.ins().BargainConfig.openserverday},e.prototype.upRecord=function(t){return[t]},e.prototype.downRecord=function(t,e){for(var i,n=[],o=0;o<e.length;o++)i=new BargainRecordVo,i.init(e[o]),i.type=t,n.push(i);n.length>1&&n.sort(this.sortByAuTime),EventMgr.ins().dispatch(192,{type:t,list:n})},e.prototype.downNoLimit=function(t,e){UIMgr.ins().open(BargainQuotaTipView,t,e)},e.prototype.checkRed=function(){return this.isFristRed&&(this.checkRedByType(i.TYPE_UNION)||this.checkRedByType(i.TYPE_SERVER)||this.checkRedByType(i.TYPE_KF))},e.prototype.checkRedByType=function(t){var e=this.getAuctionsByType(t);return e&&e.length>0},e.prototype.getAuctionsByType=function(t){return t==i.TYPE_UNION?this.auGuildDatas:t==i.TYPE_SERVER?this.auServerDatas:this.auKfDatas},e.prototype.upGetKfList=function(){},e.prototype.downKfAuction=function(t){this.auKfDatas=[];for(var e=0;t.length>e;e++){var i=new BargainVo;i.initKf(t[e]),this.auKfDatas.push(i)}this.auKfDatas.length>=2&&this.auKfDatas.sort(this.sort),this.auKfDatas.length&&this.checkTime(),EventMgr.ins().dispatch(193)},e.prototype.upBuyKfAu=function(t,e){return[t?1:0,e]},e.prototype.downKfAuChange=function(t,e,i,n){var o=this.getVoByID(e);1==t?this.deleteVo(o):o&&(o.auctionTimes=i,o.myAuPrice=n==ActorControl.actorID?1:0),EventMgr.ins().dispatch(194)},e.prototype.getShowTimeByType=function(t){return t==i.TYPE_UNION?DataCenter.ins().BargainConfig.guildShowTime:t==i.TYPE_SERVER?DataCenter.ins().BargainConfig.globalShowTime:DataCenter.ins().BargainConfig.crossShowTime},e.prototype.upKfRecord=function(){},e.prototype.downKfRecord=function(t){for(var e,n=i.TYPE_KF,o=[],s=0;t.length>s;s++)e=new BargainRecordVo,e.type=n,e.initKf(t[s]),o.push(e);o.length>1&&o.sort(this.sortByAuTime),EventMgr.ins().dispatch(195,{type:n,list:o})},e.prototype.checkTime=function(){TimerMgr.ins().isExists(this.dispatchShowRed,this)&&TimerMgr.ins().remove(this.dispatchShowRed,this);var t=Math.min(Number.MAX_VALUE,this.getMinTime(this.auGuildDatas),this.getMinTime(this.auServerDatas),this.getMinTime(this.auKfDatas));t!=Number.MAX_VALUE&&TimerMgr.ins().doTimer(1e3*t,1,this.dispatchShowRed,this)},e.prototype.dispatchShowRed=function(){this.showRed=!0,this.checkTime()},e.prototype.getMinTime=function(t){if(!t||!t.length)return Number.MAX_VALUE;for(var e=Number.MAX_VALUE,i=0;i<t.length;i++){var n=t[i],o=bargainControl.getShowTimeByType(n.type)-Math.floor((GameServer.serverTime-DateUtils.formatMiniDateTime(n.putAwayTime))/1e3);o>0&&e>o&&(e=o)}return e},Object.defineProperty(e.prototype,"isMoveEntrance",{get:function(){return bargainControl.isAuctionOpen()&&GameServer.serverOpenDay+1>=DataCenter.ins().BargainConfig.iconHideday},enumerable:!0,configurable:!0}),e.TYPE_UNION=0,e.TYPE_SERVER=1,e.TYPE_KF=2,__decorate([up(1,[1])],e.prototype,"upGetList",null),__decorate([down(1,[1,ByteConst.BargainVos])],e.prototype,"downListData",null),__decorate([up(2,[3])],e.prototype,"upOpenAuBox",null),__decorate([down(2,[3,3])],e.prototype,"downOpenSuccess",null),__decorate([up(3,[1,3])],e.prototype,"upUseAuBox",null),__decorate([up(4,[3,1,1])],e.prototype,"upAUction",null),__decorate([down(4,[1].concat(ByteConst.BargainVos))],e.prototype,"downAuctionResult",null),__decorate([up(5,[3,1])],e.prototype,"upBuy",null),__decorate([down(5,[1].concat(ByteConst.BargainVos))],e.prototype,"downBuyResult",null),__decorate([up(6,[1])],e.prototype,"upRecord",null),__decorate([down(6,[1,ByteConst.BargainRecordVo])],e.prototype,"downRecord",null),__decorate([down(7,[3,3])],e.prototype,"downNoLimit",null),__decorate([up(10)],e.prototype,"upGetKfList",null),__decorate([down(10,[ByteConst.BargainKfVos])],e.prototype,"downKfAuction",null),__decorate([up(11,[1,3])],e.prototype,"upBuyKfAu",null),__decorate([down(11,[4,3,3,3])],e.prototype,"downKfAuChange",null),__decorate([up(12)],e.prototype,"upKfRecord",null),__decorate([down(12,[ByteConst.BargainRecordKfVo])],e.prototype,"downKfRecord",null),e=i=__decorate([protocolsId(76)],e);var i}(BaseSystem);__reflect(BargainControl.prototype,"BargainControl");var BargainRecordVo=function(){function t(){this.type=0}return t.prototype.init=function(t){this.aId=t[0],this.roleName=t[1],this.state=t[2],this.price=t[3],this.time=t[4]},t.prototype.initKf=function(t){this.aId=t[0],this.serverID=t[1],this.roleName=t[2],this.state=t[3],this.price=t[4],this.time=t[5]},t}();__reflect(BargainRecordVo.prototype,"BargainRecordVo");var BargainVo=function(){function t(){}return t.prototype.init=function(t){this.type=t[0],this.endTime=t[1],this.id=t[2],this.putAwayTime=t[3],this.aID=t[4],this.auctionTimes=t[5],this.myAuPrice=t[6],this.owner=t[7]},t.prototype.initKf=function(t){this.type=BargainControl.TYPE_KF,this.id=t[0],this.aID=t[1],this.auctionTimes=t[2],this.putAwayTime=t[3],this.myAuPrice=t[4],this.endTime=this.putAwayTime+DataCenter.ins().BargainConfig.crossShowTime+DataCenter.ins().BargainItemConfig[this.aID].crossTime,this.owner=0},t}();__reflect(BargainVo.prototype,"BargainVo");var BargainInfoView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curPage=1,e.maxPage=1,e.type=0,e.itemCount=10,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=BargainItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.itemCount=DataCenter.ins().BargainConfig.eachPageNumber,this.addEventTouchEnd(this,this.onTouch),this.addCustomEvent(189,this.update),this.addCustomEvent(190,this.update),this.addCustomEvent(191,this.update),this.addCustomEvent(495,this.update),this.addCustomEvent(193,this.update),this.addCustomEvent(194,this.update),this.curPage=1,this.update(),TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(1e4,0,this.onSend,this)},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.onSend=function(){this.type==BargainControl.TYPE_KF?bargainControl.upGetKfList():bargainControl.upGetList(this.type)},e.prototype.update=function(){this.collect||(this.collect=new ArrayCollection,this.list.dataProvider=this.collect),this.maxPage=bargainControl.getMaxPageByType(this.type,this.itemCount),this.curPage>this.maxPage&&(this.curPage=this.maxPage),this.updateCurPage(),this.add.visible=this.maxPage>1},e.prototype.onTouch=function(t){switch(t.target){case this.btn:UIMgr.ins().open(BargainRecordView,this.type);break;case this.minBtn:this.curPage>1&&(this.curPage--,this.updateCurPage());break;case this.maxBtn:this.curPage<this.maxPage&&(this.curPage++,this.updateCurPage())}},e.prototype.updateCurPage=function(){var t=bargainControl.getDataByPage(this.type,this.curPage,this.itemCount),e=this.collect.source;if(e&&e.length==(t?t.length:0))for(var i=e.length,n=0;i>n;n++){e[n]=t[n];var o=this.list.getElementAt(n);o&&this.list.updateRenderer(o,n,t[n])}else this.collect.source=t;this["null"].visible=!this.collect.source||this.collect.source.length<=0,this.pageTxt.text=this.curPage+"/"+this.maxPage},e}(BaseEuiView);__reflect(BargainInfoView.prototype,"BargainInfoView");var BargainItemChoiceView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BargainChoiceViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemID=t[0],this.auID=t[1],this.addEventTouchEnd(this,this.onTouch),this.update()},e.prototype.update=function(){var t=DataCenter.ins().BargainItemConfig[this.auID];this.item.data=t.item,this.price1.text=t.bid+"",this.price2.text=t.buy+""},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.ownUse:bargainControl.upUseAuBox(0,this.itemID),UIMgr.ins().close(this);break;case this.auctionBtn:bargainControl.isAuctionOpen()?bargainControl.upUseAuBox(1,this.itemID):tipsControl.showTips(LangMgr.getValueByKey("actionNotOpen")),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(BargainItemChoiceView.prototype,"BargainItemChoiceView");var BargainQuotaTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BargainQuotaTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.onTouch),this.positiveQuotaNum.text=t[0],this.rechargeQuotaNum.text=t[1]},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.goRechargeBtn:payControl.checkOpenWin(),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(BargainQuotaTipView.prototype,"BargainQuotaTipView");var BargainRecordView=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.skinName="BargainRecordViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=BargainRecordItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.addCustomEvent(192,this.update),this.addCustomEvent(195,this.update);var i=LangMgr.getValueByKey(this.type?this.type==BargainControl.TYPE_SERVER?"auctionAllServer":"chatMenu2":"auctionPart");this.curAuction.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("auctionRecord",i)),this["null"].visible=!0,this.type==BargainControl.TYPE_KF?bargainControl.upKfRecord():bargainControl.upRecord(this.type),this.addEventTouchEnd(this,this.onTouch)},e.prototype.onTouch=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e.prototype.update=function(t){this.collect||(this.collect=new ArrayCollection,this.list.dataProvider=this.collect),t.type==this.type&&(this.collect.source=t.list,this["null"].visible=!this.collect.source||this.collect.source.length<=0)},e}(BaseEuiView);__reflect(BargainRecordView.prototype,"BargainRecordView");var BargainView=function(t){function e(){var e=t.call(this)||this;return e._curIndex=-1,e.skinName="BargainViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.onTouch),this.addEventChange(this.tab,this.selectIndexChange),this.addCustomEvent(189,this.updateRed),this.addCustomEvent(190,this.updateRed),this.addCustomEvent(191,this.updateRed),this.addCustomEvent(495,this.updateRed),this.addCustomEvent(193,this.updateRed),this.addCustomEvent(194,this.updateRed),this.updateRed();var i=t?t[0]:bargainControl.checkRedByType(BargainControl.TYPE_UNION)?BargainControl.TYPE_UNION:bargainControl.checkRedByType(BargainControl.TYPE_SERVER)?BargainControl.TYPE_SERVER:bargainControl.checkRedByType(BargainControl.TYPE_KF)?BargainControl.TYPE_KF:BargainControl.TYPE_UNION;this.tab.selectedIndex=this.viewStack.selectedIndex=i,this.selectIndexChange(),bargainControl.isFristRed=!1},e.prototype.close=function(){-1!=this._curIndex&&this.viewStack.getChildAt(this._curIndex).close()},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:HelpControl.openHelpWin(41)}},e.prototype.selectIndexChange=function(t){void 0===t&&(t=null),-1!=this._curIndex&&this.viewStack.getChildAt(this._curIndex).close(),this._curIndex=this.tab.selectedIndex,this._curIndex==BargainControl.TYPE_KF?bargainControl.upGetKfList():bargainControl.upGetList(this._curIndex),this.viewStack.getChildAt(this._curIndex).open(this._curIndex)},e.prototype.updateRed=function(){this.redPoint0.visible=bargainControl.checkRedByType(BargainControl.TYPE_UNION),this.redPoint1.visible=bargainControl.checkRedByType(BargainControl.TYPE_SERVER),this.redPoint2.visible=bargainControl.checkRedByType(BargainControl.TYPE_KF)},e}(BaseEuiView);__reflect(BargainView.prototype,"BargainView");var BargainWarnView=function(t){function e(){var e=t.call(this)||this;return e._lastPrice=0,e.price=0,e.skinName="BargainWarnViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(189,this.update),this.addCustomEvent(190,this.update),this.addCustomEvent(191,this.update),this.addCustomEvent(495,this.update),this.addCustomEvent(193,this.update),this.addCustomEvent(194,this.update),this.addEventTouchTap(this,this.onTouch),this._id=t[0],this.isYiKouJia=t[1],this._lastPrice=0,this.update()},e.prototype.update=function(){TimerMgr.ins().removeAll(this);var t=bargainControl.getVoByID(this._id);if(!t)return void UIMgr.ins().close(this);var e=DataCenter.ins().BargainItemConfig[t.aID],i=t.type==BargainControl.TYPE_KF?DataCenter.ins().BargainConfig.crossPriceIncrease:DataCenter.ins().BargainConfig.priceIncrease;this.price2=e.bid+Math.floor(e.bid*t.auctionTimes*i/1e4),this.price=e.buy?e.buy:0;var n=this.isYiKouJia?this.price:this.price2;this.warnLabel.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByArr(["auctionTaskPay",this.isYiKouJia?"auctionPay":"auctionNoPay"],[[n],[]])),this.groupBagTips.visible=!1,this._lastPrice&&this._lastPrice!=n&&(this.groupBagTips.visible=!0,TimerMgr.ins().doTimer(2e3,1,this.onRepeat,this)),this._lastPrice=n},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:case this.notBtn:UIMgr.ins().close(this);break;case this.sureBtn:if(ActorControl.yb<(this.isYiKouJia?this.price:this.price2))return this.noMoney(),void UIMgr.ins().close(this);var e=bargainControl.getVoByID(this._id);e.type==BargainControl.TYPE_KF?bargainControl.upBuyKfAu(this.isYiKouJia,e.id):this.isYiKouJia?bargainControl.upBuy(e.id,e.type):bargainControl.upAUction(e.id,e.type,e.auctionTimes+1),UIMgr.ins().close(this)}},e.prototype.onRepeat=function(){this.groupBagTips.visible=!1},e.prototype.noMoney=function(){tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},__decorate([callDelay(150)],e.prototype,"noMoney",null),e}(BaseEuiView);__reflect(BargainWarnView.prototype,"BargainWarnView");var BargainItemRender=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=0,e.leftTime=0,e.STATE_SHOW=0,e.STATE_AUCTION=1,e.STATE_END=2,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().BargainItemConfig[t.aID];if(e){var i=t.type==BargainControl.TYPE_KF?DataCenter.ins().BargainConfig.crossPriceIncrease:DataCenter.ins().BargainConfig.priceIncrease;this.item.data=e.item,this.btn1.visible=e.buy>0,this.jingjia.text=e.bid+Math.floor(e.bid*t.auctionTimes*i/1e4)+"",this.labelMy.visible=t.owner>0,this.labelMy.source=t.owner?1==t.owner?"labelMy":"labelGuild":"",e.buy?(this.btn1.visible=!0,this.zb0.text=e.buy+""):this.btn1.visible=!1,this.zb1.text=e.bid+Math.floor(e.bid*(t.auctionTimes>0?t.auctionTimes-1:0)*i/1e4)+"",this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRemove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch),this.checkTime()}},e.prototype.checkTime=function(){TimerMgr.ins().removeAll(this);var t=this.data,e=DateUtils.formatMiniDateTime(t.endTime),i=GameServer.serverTime,n=DateUtils.formatMiniDateTime(t.putAwayTime);this.leftTime=0,this.showTime.textColor=16711680,i>=e?(this.state=this.STATE_END,this.showTime.text="00:00:00",bargainControl.deleteVo(t),bargainControl.dispatchUpdate()):Math.floor((i-n)/1e3)<bargainControl.getShowTimeByType(t.type)?(this.state=this.STATE_SHOW,this.showTime.textColor=16767295,this.leftTime=bargainControl.getShowTimeByType(t.type)-Math.floor((i-n)/1e3)):(this.state=this.STATE_AUCTION,this.showTime.textColor=65280,this.leftTime=Math.floor((e-i)/1e3)),this.leftTime&&(this.repeat(),TimerMgr.ins().doTimer(1e3,0,this.repeat,this)),this.jingjiazhong.visible=t.auctionTimes>0,this.jingjiazhong.textFlow=TextUtils.generateTextFlow("|C:"+(t.myAuPrice?16767295:2149168)+"&T:"+(t.myAuPrice?LangMgr.getValueByKey("auctionMePlay"):LangMgr.getValueByKey("auctionPlaying"))),this.already.visible=1==t.myAuPrice},e.prototype.repeat=function(){return this.showTime.text=DateUtils.getFormatBySecond(this.leftTime,DateUtils.TIME_FORMAT_12)+(this.state==this.STATE_SHOW?LangMgr.getValueByKey("auctionAfterStart"):LangMgr.getValueByKey("auctionAfterEnd")),this.state==this.STATE_AUCTION&&this.leftTime<=DataCenter.ins().BargainConfig.rushTime&&16711680!=this.showTime.textColor&&(this.showTime.textColor=16711680),this.leftTime<=0?void this.checkTime():void this.leftTime--},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.removeEventTouchTap(this,this.onTouch),TimerMgr.ins().removeAll(this)},e.prototype.onTouch=function(t){switch(t.target){case this.yikoujia:case this.yikoujia0:if(this.state==this.STATE_END)return void tipsControl.showTips(LangMgr.getValueByKey("auctionGoodsEnd"));if(this.state==this.STATE_SHOW)return void tipsControl.showTips(LangMgr.getValueByKey("auctionShowTime1"));UIMgr.ins().open(BargainWarnView,this.data.id,t.target==this.yikoujia)}},e}(BaseItemRender);__reflect(BargainItemRender.prototype,"BargainItemRender");var BargainRecordItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().BargainItemConfig[t.aId];this.item.data=e.item,this.playerName.text=t.roleName,this.playerName.text=(t.type==BargainControl.TYPE_KF&&t.state>0?"s"+t.serverID+".":"")+t.roleName,this.price.text=t.price+"",this.successTime.text=DateUtils.getFormatBySecond(Math.floor(DateUtils.formatMiniDateTime(t.time)/1e3),DateUtils.TIME_FORMAT_15),this.text1.text=LangMgr.getValueByKey(t.state?1==t.state?"auctionValue":"auctionOneValue":0==t.type?"auctionsmoothAllServer":"auctionsmooth")},e}(BaseItemRender);__reflect(BargainRecordItemRender.prototype,"BargainRecordItemRender");var BeastControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxLimit=0,e.dataList={},e.exp=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downInfo=function(t,e,i){for(var n=0;n<t.length;n++){var o=new BeastVo;o.init(t[n]),this.dataList[o.id]=o}this.maxLimit=e,this.exp=i,EventMgr.ins().dispatch(252)},e.prototype.downWearEquip=function(t,e,i){if(this.dataList[t])this.dataList[t].equipIDs[e]=i;else{var n=new BeastVo;n.equipIDs[e]=i,n.id=t,this.dataList[t]=n}this.dataList[t].checkState(),UIMgr.ins().close(BeastWearEquipView),EventMgr.ins().dispatch(253)},e.prototype.downBattleState=function(t,e){this.dataList[t].state=e,EventMgr.ins().dispatch(254)},e.prototype.downBattleMaxLimit=function(t){this.maxLimit=t,UIMgr.ins().close(BeastDanUseView)},e.prototype.downUpdateExp=function(t){var e=this.exp;this.exp=t,this.exp-e>0&&tipsControl.showTips(LangMgr.getValueByKey("shenTips11",this.exp-e)),EventMgr.ins().dispatch(255)},e.prototype.downUpEquip=function(t,e,i){this.dataList[t].equipIDs[e]=i,EventMgr.ins().dispatch(256,i)},e.prototype.downDepartEquip=function(){EventMgr.ins().dispatch(257)},e.prototype.upWearEquip=function(t,e,i){return[t,e,i]},e.prototype.upComposeEquip=function(t){return[t.reverse()]},e.prototype.upBattle=function(t){return[t]},e.prototype.upUpLimitMax=function(){},e.prototype.upUpEquip=function(t,e){return[t,e]},e.prototype.upDepartEquip=function(t){return[t]},e.prototype.findCanWearEquips=function(t,e){var i=backpackControl.getBagGoodsByType(23),n=[],o=0,s=beastControl.dataList[t];s&&s.equipIDs[e]&&(o=BackpackControl.getAttrPower(DataCenter.ins().BeastEquipConfig[s.equipIDs[e]].attrs));for(var r=0,a=i;r<a.length;r++){var l=a[r],h=this.getEquipQuality(l.configID);BackpackControl.getAttrPower(DataCenter.ins().BeastEquipConfig[l.configID].attrs);if(ItemUtils.getSubType(l.itemConfig)==e-1&&DataCenter.ins().BeastBaseConfig[t].minLevel[e-1]<=h){var u=new BeastEquipVo;u.id=l.configID,u.pos=e,u.shenshuId=t;var p=DataCenter.ins().BeastEquipConfig[l.configID];u.sortIndex=BackpackControl.getAttrPower(p.attrs),u.best=u.sortIndex>o,n.push(u)}}return n.sort(this.compareFun),n},e.prototype.checkEquipScore=function(t,e){var i=BackpackControl.getAttrPower(DataCenter.ins().BeastEquipConfig[t].attrs),n=BackpackControl.getAttrPower(DataCenter.ins().BeastEquipConfig[e].attrs);return i>=n},e.prototype.compareFun=function(t,e){return t.sortIndex>e.sortIndex?-1:t.sortIndex<e.sortIndex?1:0},e.prototype.calcEquipScore=function(t){var e=this.getDataById(t),i=0;if(e)for(var n=1;n<=e.equipIDs.length;n++){var o=DataCenter.ins().BeastEquipConfig[e.equipIDs[n]];o&&(i+=BackpackControl.getAttrPower(o.attrs),o.expower&&(i+=o.expower))}return i},e.prototype.getDataById=function(t){var e=beastControl.dataList[t];return e},e.prototype.getAttrValue=function(t,e){var i=this.getDataById(t);if(i){var n=0;for(var o in i.equipIDs)if(o){var s=DataCenter.ins().BeastEquipConfig[i.equipIDs[o]];if(s)for(var r=0,a=s.attrs;r<a.length;r++){var l=a[r];e==l.type&&(n+=l.value)}}return n}return 0},e.prototype.getCurStatus=function(t){var e=this.getDataById(t);return e?e.state:2},e.prototype.getCurBattle=function(){var t=0;for(var e in beastControl.dataList)1==beastControl.dataList[e].state&&t++;return t},e.prototype.getCountBattle=function(){return DataCenter.ins().BeastConfig.minCount+beastControl.maxLimit},e.prototype.isCanBattle=function(){return this.getCurBattle()<this.getCountBattle()},e.prototype.getNowAttr=function(t){for(var e=[],i=0;i<t.attrs.length;i++){var n=new AttributeData(t.attrs[i].type,t.attrs[i].value-t.starattrs[i].value);e.push(n)}return e},e.prototype.getEquipLv=function(t){return parseInt((t+"").slice(4,7))},e.prototype.getEquipQuality=function(t){return parseInt((t+"").slice(2,4))},e.prototype.getEquipBaseId=function(t){return 1e3*(t/1e3>>0)+1},e.prototype.checkOpen=function(){return reincarnateControl.lv>=DataCenter.ins().BeastConfig.openzhuanshenglv&&GameServer.serverOpenDay+1>=DataCenter.ins().BeastConfig.openserverday},e.prototype.checkShowOpen=function(){return GameServer.serverOpenDay+1>=DataCenter.ins().BeastConfig.openserverday},e.prototype.getListByQuality=function(t){for(var e=[],i=DataCenter.ins().BeastConfig.posCount,n=1;i>=n;n++)e.push({type:4,id:parseInt("1"+n+(10>t?"0"+t:t)+"001")});return e},e.prototype.canTypeCompose=function(t,e){var i=DataCenter.ins().PieceConfig[t],n=!1;if(e)n=this.canListCompose(this.getListByQuality(i[e].lv));else for(var o in i)n||(n=this.canListCompose(this.getListByQuality(i[o].lv)));return n},e.prototype.canListCompose=function(t){for(var e=!1,i=0;i<t.length;i++){var n=t[i];e||(e=this.canNeedIdCompose(parseInt(n.id)-1e3))}return e},e.prototype.canNeedIdCompose=function(t){for(var e=backpackControl.getBagGoodsByType(23),i=this.getEquipQuality(t),n=this.getEquipBaseId(t),o=DataCenter.ins().BeastConfig.matLimit[i],s=o.count,r=o.id?backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,o.id):0,a=0;a<e.length;a++){var l=e[a],h=this.getEquipBaseId(l.configID);if(h==n&&(s-=l.count,(o.id&&r>=o.mixcount||!o.id)&&0>=s))return!0}return!1},e.prototype.getCanComposeList=function(t){for(var e=[],i=t-1e3,n=backpackControl.getBagGoodsByType(23),o=this.getEquipBaseId(i),s=this.getEquipQuality(i),r=DataCenter.ins().BeastConfig.matLimit[s],a=0;a<n.length;a++){var l=n[a],h=this.getEquipBaseId(l.configID);if(h==o)for(var u=l.count;u>0&&e.length<r.count;)e.push(l.configID),u--}return e.sort(SortUtils.sortDescByKey),e},e.prototype.quickWear=function(t){var e=BeastRedPoint.ins().redpointEquips1[t];for(var i in e){var n=e[i];if(n){var o=this.findCanWearEquips(t,+i);o.length&&beastControl.upWearEquip(t,+i,o[0].id)}}},e.prototype.quickTackoff=function(t){var e=beastControl.dataList[t];if(e)for(var i in e.equipIDs)beastControl.upWearEquip(t,+i,0)},__decorate([down(1,[ByteConst.BeastVos,1,3])],e.prototype,"downInfo",null),__decorate([down(2,[1,1,3])],e.prototype,"downWearEquip",null),__decorate([down(4,[1,1])],e.prototype,"downBattleState",null),__decorate([down(5,[1])],e.prototype,"downBattleMaxLimit",null),__decorate([down(6,[3])],e.prototype,"downUpdateExp",null),__decorate([down(7,[1,1,3])],e.prototype,"downUpEquip",null),__decorate([down(8)],e.prototype,"downDepartEquip",null),__decorate([up(2,[1,1,3])],e.prototype,"upWearEquip",null),__decorate([up(3,[[3]])],e.prototype,"upComposeEquip",null),__decorate([up(4,[1])],e.prototype,"upBattle",null),__decorate([up(5)],e.prototype,"upUpLimitMax",null),__decorate([up(7,[1,1])],e.prototype,"upUpEquip",null),__decorate([up(8,[[3]])],e.prototype,"upDepartEquip",null),e=__decorate([protocolsId(73)],e)}(BaseSystem);__reflect(BeastControl.prototype,"BeastControl");var AmusementType16DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyState=!1,e.gotId=0,e.hadGet=!1,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.buyState=t[0],this.gotId=t[1],this.hadGet=t[2]},e.prototype.canReward=function(t){return this.checkRedPoint(t)},e.prototype.getHide=function(){var t=DataCenter.ins().Amusement16Config[this.id],e=this.getCurDay();return this.buyState?t[this.gotId+1]?!1:!0:e>t[0].buyDay?!0:!1},e.prototype.checkRedPoint=function(t){return isNaN(t)?this.buyState&&!this.hadGet&&!!DataCenter.ins().Amusement16Config[this.id][this.gotId+1]:this.buyState&&!this.hadGet&&t==this.gotId+1},e.prototype.getCurDay=function(){var t=GameServer.serverTime-DateUtils.formatMiniDateTime(this.startTime),e=Math.floor(t/1e3/3600/24);return 0>e?0:e+1},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e}(AmusementBaseDataVo);__reflect(AmusementType16DataVo.prototype,"AmusementType16DataVo");var BeastEquipVo=function(){function t(){}return t}();__reflect(BeastEquipVo.prototype,"BeastEquipVo");var VouchersView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.allPanels=[VouchersPanel],this.arrList=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.iconList.visible=!1,this.updateMenuList()},e.prototype.updateMenuList=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cruPanel=new this.allPanels[0],this.cruPanel&&(this.cruPanel.left=0,this.cruPanel.right=0,this.cruPanel.top=0,this.cruPanel.bottom=0,this.info.addChild(this.cruPanel),this.cruPanel.open()),this.leftBtn.visible=!1,this.rightBtn.visible=!1;var i=DataCenter.ins().ClientNoticeConfig;this.title.source=i.title},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cruPanel.close()},e}(WelfareView);__reflect(VouchersView.prototype,"VouchersView");var BeastVo=function(){function t(){this.equipIDs=[],this.state=0;for(var t=1;5>=t;t++)this.equipIDs[t]=0}return t.prototype.init=function(t){this.id=t[0],this.equipIDs=[];for(var e=0;e<t[1].length;++e)this.equipIDs[e+1]=t[1][e];this.state=t[2],this.equipIDs.indexOf(0)>-1&&1!=this.state&&(this.state=2)},t.prototype.checkState=function(){1!=this.state&&(this.equipIDs.indexOf(0)>-1?this.state=2:this.state=0)},t}();__reflect(BeastVo.prototype,"BeastVo");var BeastDanUseView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BeastDanUseViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.useBtn,this.onTouch),this.addEventTouchTap(this.cancelBtn,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch);var i=t[0];this.itemIcon.data=i.id,this.ownCount.text=LangMgr.getValueByKey("shenTips1",backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().BeastConfig.battleCountItem)),this.itemIcon.hideName()},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:case this.cancelBtn:UIMgr.ins().close(this);break;case this.useBtn:beastControl.upUpLimitMax()}},e}(BaseEuiView);__reflect(BeastDanUseView.prototype,"BeastDanUseView");var BeastEquipTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BeastEquipTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.changeBtn,this.onTouch),this.addEventTouchTap(this.takeoffBtn,this.onTouch),this.addEventTouchTap(this.forgeBtn,this.onTouch),this.shenshouId=t[0],this.pos=t[1],this.shenshouId){this.refRedpoint();var i=beastControl.getDataById(this.shenshouId);2==i.state&&(this.forgeBtn.visible=!1)}else this.changeBtn.visible=!1,this.forgeBtn.visible=!1,this.takeoffBtn.visible=!1,this.changeRedPoint.visible=!1,this.forgeRedPoint.visible=!1,this.anigroup.height=505;this.itemDp=DataCenter.ins().ItemConfig[t[2]],this.initUi()},e.prototype.initUi=function(){var t=ItemUtils.getQuality(this.itemDp);this.quali.source=t?"quali"+t:"",this.equipIcon.data=this.itemDp.id,this.equipIcon.hideName(),this.nameTxt.text=this.itemDp.name,this.nameTxt.textColor=ItemUtils.getQualityColor(this.itemDp),this.type.text=LangMgr.getValueByKey("ssEquipPosName"+ItemUtils.getSubType(this.itemDp)),this.lv.text=beastControl.getEquipLv(this.itemDp.id)+LangMgr.getValueByKey("numberLevel",""),this.career.text=LangMgr.getValueByKey("shenType14");var e=DataCenter.ins().BeastEquipConfig[this.itemDp.id],i=BackpackControl.getAttrPower(e.attrs);e.expower&&(i+=e.expower),this.powerPanel.setPower(i*heroControl.subRolesLen);for(var n=DataCenter.ins().BeastEquipConfig[beastControl.getEquipBaseId(this.itemDp.id)],o=beastControl.getNowAttr(n),s=0;3>s;s++)if(o[s]){this["attr"+(s+1)].visible=!0,this["attr"+(s+1)].text=AttributeData.getAttStrByType(o[s],0,":");
var r=e.attrs[s].value-n.attrs[s].value;this["forgeAttr"+(s+1)].visible=n&&n.id!=e.id&&r>0,n&&n.id!=e.id&&r>0&&(this["forgeAttr"+(s+1)].text="+"+r)}else this["attr"+(s+1)].visible=!1,this["forgeAttr"+(s+1)].visible=!1;for(var s=0;3>s;s++)e.starattrs[s]?(this["starAttr"+(s+1)].visible=!0,this["starAttr"+(s+1)].text=AttributeData.getAttStrByType(e.starattrs[s],0,":")):this["starAttr"+(s+1)].visible=!1},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:break;case this.changeBtn:UIMgr.ins().open(BeastWearEquipView,this.shenshouId,this.pos,this.itemDp.id);break;case this.takeoffBtn:if(1==beastControl.getDataById(this.shenshouId).state)return void tipsControl.showCenterTips(LangMgr.getValueByKey("shenTips2"));beastControl.upWearEquip(this.shenshouId,this.pos,0);break;case this.forgeBtn:UIMgr.ins().open(BeastForgeView,this.shenshouId,this.pos,this.itemDp)}UIMgr.ins().close(this)},e.prototype.refRedpoint=function(){this.changeRedPoint.visible=BeastRedPoint.ins().redpointEquips1[this.shenshouId]&&BeastRedPoint.ins().redpointEquips1[this.shenshouId][this.pos],this.forgeRedPoint.visible=BeastRedPoint.ins().redpointEquips2[this.shenshouId]&&BeastRedPoint.ins().redpointEquips2[this.shenshouId][this.pos]},e}(BaseEuiView);__reflect(BeastEquipTipView.prototype,"BeastEquipTipView");var BeastForgeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BeastForgeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=BeastEquip1ItemRenderer,this.listDt=new eui.ArrayCollection,this.list.dataProvider=this.listDt,this.nowList=[],this.exp.value=0,this.exp.labelFunction=function(t,e){return beastControl.exp+"/"+e}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.shenshouId=t[0],this.pos=t[1],this.curItemDp=t[2],this.filterList=[],this.addEventTouchTap(this.departBtn,this.onTouch),this.addEventTouchTap(this.lvUpBtn,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.list,this.onList),this.addCustomEvent(256,this.onUpEquip),this.addCustomEvent(255,this.refUIData),this.addCustomEvent(257,this.onDecompose),this.addCustomEvent(496,this.refRedpoint),this.refRedpoint(),this.refUIData(),this.refList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.forgetMC)},e.prototype.onUpExp=function(){this.exp.value=beastControl.exp,this.exp.maximum=DataCenter.ins().BeastEquipConfig[this.curItemDp.id].exp,this.exp.value=beastControl.exp,this.exp.labelDisplay.text=beastControl.exp+"/"+this.exp.maximum},e.prototype.onUpEquip=function(t){this.curItemDp=DataCenter.ins().ItemConfig[t],this.refUIData(),this.forgetMC||(this.forgetMC=new GameMovieClip,this.forgetMC.x=62,this.forgetMC.y=62),this.forgetMC.playFile(PATH_EFF+"forgeSuccess",1),this.iconGroup.addChild(this.forgetMC)},e.prototype.refUIData=function(){var t=DataCenter.ins().BeastEquipConfig[this.curItemDp.id];this.curScore=BackpackControl.getAttrPower(t.attrs),t.expower&&(this.curScore+=t.expower),this.powerPanel.setPower(this.curScore*heroControl.subRolesLen),this.equipName.text=this.curItemDp.name,this.equipName.textColor=ItemUtils.getQualityColor(this.curItemDp),this.itemIcon.data=this.curItemDp.id,this.itemIcon.hideName();var e=beastControl.getEquipLv(this.curItemDp.id);this.attrPanel.lvNow.text="Lv."+e,this.attrPanel.lvNext.text="Lv."+(e+1),this.maxExpImg.visible=!1,this.maxExpTxt.visible=!1;var i=DataCenter.ins().BeastEquipConfig[this.curItemDp.id+1];i||(this.lvUpBtn.enabled=!1,this.attrPanel.currentState="max",this.exp.visible=!1,this.maxExpImg.visible=!0,this.maxExpTxt.visible=!0);for(var n=0;3>n;n++)t.attrs[n]?(this.attrPanel["attr"+(n+1)+"Now"].visible=!0,this.attrPanel["attr"+(n+1)+"Next"].visible=i&&i.attrs[n],this.attrPanel["attr"+(n+1)+"Now"].text=AttributeData.getAttStrByType(t.attrs[n],0,":"),i&&i.attrs[n]&&(this.attrPanel["attr"+(n+1)+"Next"].text=AttributeData.getAttStrByType(i.attrs[n],0,":"))):(this.attrPanel["attr"+(n+1)+"Next"].visible=!1,this.attrPanel["attr"+(n+1)+"Now"].visible=!1);this.onUpExp()},e.prototype.onDecompose=function(){for(var t=this.list.numChildren,e=0;t>e;e++){var i=this.list.getChildAt(e);i&&i.playDepartMc()}TimerMgr.ins().doTimer(500,1,this.refList,this)},e.prototype.refList=function(){var t=backpackControl.getBagGoodsByType(23);this.nowList=[];for(var e=13;--e>=0;)if(t[e])if(t[e].count>1)for(var i=0;i<t[e].count;i++)this.filterList.indexOf(t[e].configID)>-1||!this.checkCurEquip(t[e].configID)||this.nowList.push(t[e].configID);else{if(this.filterList.indexOf(t[e].configID)>-1||!this.checkCurEquip(t[e].configID))continue;this.nowList.push(t[e].configID)}this.listDt.replaceAll(this.nowList)},e.prototype.checkCurEquip=function(t){var e=DataCenter.ins().BeastEquipConfig[t],i=e?BackpackControl.getAttrPower(e.attrs):0;return this.curScore>=i},e.prototype.onList=function(t){t.target instanceof BeastEquip1ItemRenderer&&-1==this.filterList.indexOf(t.target.data)&&this.filterList.push(t.target.data),this.refList()},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;case this.lvUpBtn:if(beastControl.exp<this.exp.maximum)return void tipsControl.showCenterTips(LangMgr.getValueByKey("shenTips3"));beastControl.upUpEquip(this.shenshouId,this.pos);break;case this.departBtn:if(!this.nowList.length)return void tipsControl.showCenterTips(LangMgr.getValueByKey("shenTips4"));beastControl.upDepartEquip(this.nowList)}},e.prototype.refRedpoint=function(){this.rightRed.visible=BeastRedPoint.ins().redpointEquips2[this.shenshouId][this.pos]},__decorate([callLater],e.prototype,"onUpExp",null),__decorate([callLater],e.prototype,"refRedpoint",null),e}(BaseEuiView);__reflect(BeastForgeView.prototype,"BeastForgeView");var BeastInfoPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setID=function(t){this.curId=t,this.currentState=""+t},e.prototype.close=function(){this.stopBeatAnimat()},e.prototype.refEquipData=function(){for(var t=0;t<DataCenter.ins().BeastConfig.posCount;t++){var e=t+1;this["item"+t].name=e;var i=beastControl.getDataById(this.curId);i&&i.equipIDs[e]?this["item"+t].data=i.equipIDs[e]:this["item"+t].setPosData(this.curId,e)}},e.prototype.refState=function(t){var e=this,i="";switch(this.stopBeatAnimat(),this.shenshouImg.source=i,t){case 2:i="ss_"+this.curId+"b_png";break;case 0:i="ss_"+this.curId+"b_png";break;case 1:this.startBeatAnimat(),i="ss_"+this.curId+"a_png"}egret.callLater(function(){e.shenshouImg.source=i},this)},e.prototype.startBeatAnimat=function(){this.imgCopy||(this.imgCopy=new eui.Image),this.imgCopy.touchEnabled=!1,this.imgCopy.source="ss_"+this.curId+"a_png",this.imgCopy.visible=!1,this.addChild(this.imgCopy),TimerMgr.ins().doTimer(4e3,0,this.runTween,this),TimerMgr.ins().doTimer(500,1,this.runTween,this)},e.prototype.runTween=function(){this.imgCopy.visible=!0,this.imgCopy.alpha=0,this.imgCopy.scaleX=this.imgCopy.scaleY=1,this.imgCopy.x=this.shenshouImg.x+(this.shenshouImg.width>>1),this.imgCopy.y=this.shenshouImg.y+(this.shenshouImg.height>>1),this.imgCopy.anchorOffsetX=this.shenshouImg.width>>1,this.imgCopy.anchorOffsetY=this.shenshouImg.height>>1,this.imgCopy.top=this.shenshouImg.top,this.imgCopy.horizontalCenter=this.shenshouImg.horizontalCenter,Tween.get(this.imgCopy).to({alpha:1},250).to({alpha:0,scaleX:1.2,scaleY:1.2},2e3,egret.Ease.cubicInOut)},e.prototype.stopBeatAnimat=function(){TimerMgr.ins().remove(this.runTween,this),this.imgCopy&&(Tween.removeTweens(this.imgCopy),this.imgCopy.visible=!1)},e}(BasePanel);__reflect(BeastInfoPanel.prototype,"BeastInfoPanel");var BeastPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curId=1,e.MAX_SKILL=4,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.listMenu.itemRenderer=BeastTabItemRenderer,this.listMenuDt=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().BeastBaseConfig)),this.listMenu.dataProvider=this.listMenuDt},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.activityBtn,this.onTouch),this.addEventTouchTap(this.shenshouItem,this.onTouch),this.addEventItemTap(this.listMenu,this.onTouchMenu),this.addEventChangeEnd(this.listScroller,this.onChange);for(var i=1;i<=this.MAX_SKILL;i++)this.addEventTouchTap(this["skill"+i],this.onTouch);this.addCustomEvent(498,this.refRedPoint),this.addCustomEvent(253,this.refEquipData),this.addCustomEvent(256,this.refEquipData),this.addCustomEvent(252,this.refData),this.addCustomEvent(254,this.refData),this.listMenu.selectedIndex=0,this.showUI(this.curId),this.onChange(),this.refRedPoint()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.shenshouItem.close()},e.prototype.onTouchMenu=function(t){this.curId=t.item.id,this.showUI(this.curId)},e.prototype.onChange=function(){this.listMenu.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.listMenu.scrollH>88*(this.listMenu.dataProvider.length-5)+2?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.listMenu.dataProvider.length<=5&&(this.leftBtn.visible=!1,this.rightBtn.visible=!1),this.refArrowRedpoint()},e.prototype.showUI=function(t){for(var e=BeastControl.ins(),i=(BeastControl.ins(),e.getDataById(t),DataCenter.ins().BeastBaseConfig[t]),n=0;n<this.MAX_SKILL;n++)if(i.skill&&i.skill[n]){this["skill"+(n+1)].visible=!0,this["skill"+(n+1)].touchChildren=!1;var o=DataCenter.ins().BeastSkillConfig[i.skill[n]];this["skill"+(n+1)].name=i.skill[n],this["skill"+(n+1)].skillImg.source=o.icon,this["skill"+(n+1)].skillName.text=o.name,this["skill"+(n+1)].skillQuality.source="quality"+o.quality}else this["skill"+(n+1)].visible=!1;this.shenshouItem.setID(t),this.refEquipData()},e.prototype.refEquipData=function(){var t=BeastControl.ins();this.shenshouItem.refEquipData(),this.attr1.text="+"+t.getAttrValue(this.curId,4),this.attr2.text="+"+t.getAttrValue(this.curId,2),this.attr3.text="+"+t.getAttrValue(this.curId,5),this.attr4.text="+"+t.getAttrValue(this.curId,6),this.powerPanel.setPower(beastControl.calcEquipScore(this.curId)*heroControl.subRolesLen),this.refEquipRedpoint(),this.refData()},e.prototype.refData=function(){var t=BeastControl.ins();BeastControl.ins();this.fightCount.text=LangMgr.getValueByKey("shenTips7",t.getCurBattle(),t.getCountBattle());var e=t.getCurStatus(this.curId);switch(this.shenshouItem.refState(e),e){case 2:this.activityBtn.enabled=!1,this.activityBtn.label=LangMgr.getValueByKey("shenTips8");break;case 0:this.activityBtn.enabled=!0,this.activityBtn.label=LangMgr.getValueByKey("shenTips8");break;case 1:this.activityBtn.enabled=!0,this.activityBtn.label=LangMgr.getValueByKey("shenTips9")}this.listMenuDt.replaceAll(CommonUtils.objectToArray(DataCenter.ins().BeastBaseConfig))},e.prototype.refArrowRedpoint=function(){if(this.rightRed.visible=!1,this.leftRed.visible=!1,this.leftBtn.visible){var t=BeastRedPoint.ins().redpoints.slice(0,4);this.leftRed.visible=t.indexOf(!0)>-1}if(this.rightBtn.visible){var t=BeastRedPoint.ins().redpoints.slice(5,9);this.rightRed.visible=t.indexOf(!0)>-1}},e.prototype.refRedPoint=function(){this.refArrowRedpoint(),this.listMenuDt.replaceAll(CommonUtils.objectToArray(DataCenter.ins().BeastBaseConfig)),this.refEquipRedpoint()},e.prototype.refEquipRedpoint=function(){for(var t=0;t<DataCenter.ins().BeastConfig.posCount;t++)BeastRedPoint.ins().redpointEquips1[this.curId]&&BeastRedPoint.ins().redpointEquips1[this.curId][t+1]||BeastRedPoint.ins().redpointEquips2[this.curId]&&BeastRedPoint.ins().redpointEquips2[this.curId][t+1]?this.shenshouItem["item"+t].redPoint.visible=!0:this.shenshouItem["item"+t].redPoint.visible=!1},e.prototype.onTouch=function(t){var e=460,i=0;switch(t.target){case this.rightBtn:i=this.listMenu.scrollH+e,i=92*Math.round(i/92),i>this.listMenu.contentWidth-this.listScroller.width&&(i=this.listMenu.contentWidth-this.listScroller.width),this.listMenu.scrollH=i,this.onChange();break;case this.leftBtn:i=this.listMenu.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.listMenu.scrollH=i,this.onChange();break;case this.activityBtn:if(0==beastControl.getCurStatus(this.curId)){var n=beastControl.getCurBattle();if(n<DataCenter.ins().BeastConfig.maxCount&&backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().BeastConfig.battleCountItem)&&n>=beastControl.getCountBattle())return void UIMgr.ins().open(BeastDanUseView,DataCenter.ins().ItemConfig[DataCenter.ins().BeastConfig.battleCountItem]);if(n>=beastControl.getCountBattle())return void tipsControl.showCenterTips(LangMgr.getValueByKey("shenTips10"))}beastControl.upBattle(this.curId);break;default:if("BeastEquipItemRendererSkin"==t.target.skinName){var o=parseInt(t.target.name);t.target.data?UIMgr.ins().open(BeastEquipTipView,this.curId,o,t.target.data):UIMgr.ins().open(BeastWearEquipView,this.curId,o)}else("BeastSkillItemRendererSkin"==t.target.parent.skinName||"BeastSkillItemRendererSkin"==t.target.skinName)&&UIMgr.ins().open(BeastSkillTipView,DataCenter.ins().BeastSkillConfig[t.target.name])}},__decorate([callLater],e.prototype,"refEquipData",null),e}(BasePanel);__reflect(BeastPanel.prototype,"BeastPanel");var BeastSkillTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BeastSkillTipViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch);var i=t[0];this.quali.source=i.quality?"quali"+i.quality:"",this.equipIcon.skillQuality.source="quality"+i.quality,this.equipIcon.skillImg.source=i.icon,this.equipIcon.skillName.text="",this.nameTxt.text=i.name,this.targetTxt.text=1==i.target?LangMgr.getValueByKey("shenTips5"):LangMgr.getValueByKey("shenTips6"),this.targetTxt0.textFlow=TextUtils.generateTextFlow1(i.desc)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(BeastSkillTipView.prototype,"BeastSkillTipView");var BeastWearEquipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BeastWearEquipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.list,this.onTouch),this.list.itemRenderer=BeastWearEquipItemRenderer,this.listDt=new eui.ArrayCollection,this.list.dataProvider=this.listDt,this.shenshouId=t[0],this.pos=t[1];var i=beastControl.findCanWearEquips(this.shenshouId,this.pos);if(i.length>0){if(t[2]){var n=new BeastEquipVo;n.pos=this.pos,n.shenshuId=this.shenshouId,n.sortIndex=Number.MAX_VALUE,n.id=t[2],i.splice(0,0,n)}this.listDt.replaceAll(i),this.tipLabel2.visible=!1}else this.tipLabel2.visible=!0},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;default:if(t.target instanceof eui.Button&&t.target.parent instanceof BeastWearEquipItemRenderer){var e=t.target.parent.data;beastControl.upWearEquip(this.shenshouId,this.pos,e.id)}}},e}(BaseEuiView);__reflect(BeastWearEquipView.prototype,"BeastWearEquipView");var BeastEquip1ItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.playDepartMc=function(){this.mc||(this.mc=new GameMovieClip),this.mc.x=43,this.mc.y=44,this.mc.scaleX=1.5,this.mc.scaleY=1.5,this.addChild(this.mc),this.mc.playFile(PATH_EFF+"litboom",1)},e.prototype.dataChanged=function(){if(!isNaN(this.data)&&this.data){this.itemConfig=DataCenter.ins().ItemConfig[this.data],this.nameTxt.text="",this.imgBg.source="quality"+ItemUtils.getQuality(this.itemConfig),this.imgIcon.source=this.itemConfig.icon+"_png";var t=beastControl.getEquipLv(this.itemConfig.id)-1;this.equipLv.text=t>0?"+"+t:""}},e}(BeastEquipItemRenderer);__reflect(BeastEquip1ItemRenderer.prototype,"BeastEquip1ItemRenderer");var AmusementType18DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.num=t[0],this.recrod=t[1],this.logs?this.logs.length=0:this.logs=[];for(var e=0;e<t[2].length;e++){var i=[t[2][e][0],t[2][e][1]];this.logs.push(i)}this.logs=this.logs.reverse(),this.bestlogs?this.bestlogs.length=0:this.bestlogs=[];for(var e=0;e<t[3].length;e++){var i=[t[3][e][0],t[3][e][1]];this.bestlogs.push(i)}},e.prototype.updateAmusement=function(t){var e=t[0];this.num=t[1],this.recrod=t[2];for(var i=[],n=0;n<t[3].length;n++)i[n]=[t[3][n][0],t[3][n][1]];var o=0;2==e&&(o=1),UIMgr.ins().isShow(TreasureHuntResultView)?amusementControl.dispatchHuntResult(o,i,3,this.id):(UIMgr.ins().open(TreasureHuntResultView,o,i,2,this.id),amusementControl.dispatchHuntResult(o,i,3,this.id))},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getStateByIndex=function(t){var e=this.recrod>>t&1;if(0==e){var i=DataCenter.ins().Amusement18Config[this.id][t];i&&i.dbCount&&i.dbCount<=this.num&&(e=2)}return e},e.prototype.checkRedPoint=function(){var t=DataCenter.ins().Amusement18Config[this.id];for(var e in t){if(t[e].dbCount&&this.num>=t[e].dbCount&&0==(this.recrod>>t[e].index&1))return!0;if(t[e].relateActivityId){var i=amusementControl.getAmusementDataById(t[e].relateActivityId);if(i&&i.canReward())return!0}}return!1},e}(AmusementBaseDataVo);__reflect(AmusementType18DataVo.prototype,"AmusementType18DataVo");var BeastTabItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data.id){var t=beastControl.getDataById(this.data.id);this.redPoint.visible=BeastRedPoint.ins().redpoints[this.data.id],this.activityImg.visible=t&&1==t.state,t&&2!=t.state?this.btnName.source=DataCenter.ins().BeastBaseConfig[this.data.id].activeImg:this.btnName.source=DataCenter.ins().BeastBaseConfig[this.data.id].iconImg}},Object.defineProperty(e.prototype,"selected",{set:function(t){this.select.visible=t},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(BeastTabItemRenderer.prototype,"BeastTabItemRenderer");var BeastWearEquipItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof BeastEquipVo){this.itemIcon.data=this.data.id;var t=DataCenter.ins().ItemConfig[this.data.id];this.quality.text=DataCenter.ins().BeastConfig.equipQualityCN[ItemUtils.getQuality(t)],this.quality.textColor=ItemUtils.getQualityColor(t),this.now.visible=!1,this.best.visible=!1,this.changeBtn.visible=!0,this.data.sortIndex==Number.MAX_VALUE&&(this.now.visible=!0,this.changeBtn.visible=!1),this.data.best&&(this.best.visible=!0);for(var e=DataCenter.ins().BeastEquipConfig[beastControl.getEquipBaseId(this.data.id)],i=DataCenter.ins().BeastEquipConfig[this.data.id],n=beastControl.getDataById(this.data.shenshuId),o=n?DataCenter.ins().BeastEquipConfig[beastControl.getEquipBaseId(n.equipIDs[this.data.pos])]:null,s=0;3>s;s++)i.attrs[s]?(this["attr"+s].visible=!0,this["attr"+s].text=AttributeData.getAttStrByType(e.attrs[s],0,":"),this["betterArrow"+s].visible=!o||o&&e.attrs[s].value>o.attrs[s].value,i.attrs[s].value>e.attrs[s].value?(this["forgeAttr"+s].visible=!0,this["forgeAttr"+s].text="+"+(i.attrs[s].value-e.attrs[s].value)):this["forgeAttr"+s].visible=!1):(this["attr"+s].visible=!1,this["betterArrow"+s].visible=!1,this["forgeAttr"+s].visible=!1);var r=BackpackControl.getAttrPower(i.attrs);i.expower&&(r+=i.expower),this.power.text=LangMgr.getValueByKey("wingPingfen",3*r)}},e}(BaseItemRender);__reflect(BeastWearEquipItemRenderer.prototype,"BeastWearEquipItemRenderer");var BlisterControl=function(t){function e(){var e=t.call(this)||this;return e._openLeftTime=0,e._openTimer=0,e._enterCD=0,e._enterCDTimer=0,e._leftTime=0,e._areaId=0,e._shenBingExp=0,e._jadeChips=0,e.addCustomEvent(353,e.mapChange),e}return __extends(e,t),Object.defineProperty(e.prototype,"areaId",{get:function(){return this._areaId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shenBingExp",{get:function(){return this._shenBingExp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jadeChips",{get:function(){return this._jadeChips},enumerable:!0,configurable:!0}),e.prototype.mapChange=function(){MapControl.copyId==DataCenter.ins().BlisterConfig.fbId&&this.enterBattle(),this._isPaoDian&&MapControl.copyId!=DataCenter.ins().BlisterConfig.fbId&&this.escBattle(),this.gotoNpc&&20==MapControl.copyType&&(this.gotoNpc=!1,MapControl.myMoveTo(DataCenter.ins().BlisterConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().BlisterConfig.npcPos[1]*MapControl.CELL_SIZE,this.findComplete),MapControl.moveTo(DataCenter.ins().BlisterConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().BlisterConfig.npcPos[1]*MapControl.CELL_SIZE))},e.prototype.findComplete=function(){UIMgr.ins().open(BlisterNpcTalkView)},e.prototype.enterBattle=function(){this._isPaoDian=!0,UIMgr.ins().isShow(BlisterView)||UIMgr.ins().open(BlisterView),UIMgr.ins().close(BlisterNpcTalkView)},e.prototype.escBattle=function(){this._isPaoDian=!1,UIMgr.ins().close(BlisterView)},e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"isPaoDian",{get:function(){return this._isPaoDian},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOpen",{get:function(){return this._isOpen},enumerable:!0,configurable:!0}),e.prototype.upEnterPaoDian=function(){},e.prototype.downEnterSuccess=function(t){this._leftTime=DateUtils.formatMiniDateTime(t),EventMgr.ins().dispatch(238)},e.prototype.getLeftTime=function(){return Math.floor((this._leftTime-GameServer.serverTime)/1e3)},e.prototype.downBelongChange=function(t){this._belongs=[],this._belongs.length=t.length;for(var e=0;e<t.length;e++)this._belongs[e]={id:t[e][0],handler:t[e][1]};EventMgr.ins().dispatch(239)},e.prototype.downEnterCD=function(t){this._enterCD=t,this._enterCDTimer=egret.getTimer()},e.prototype.getEnterCD=function(){return Math.ceil(this._enterCD-(egret.getTimer()-this._enterCDTimer)/1e3)},e.prototype.downOpenInfo=function(t,e){this._isOpen=t,this._openLeftTime=e,this._openTimer=egret.getTimer(),EventMgr.ins().dispatch(240)},e.prototype.getOpenLeftTime=function(){return this._openLeftTime-(egret.getTimer()-this._openTimer)/1e3},e.prototype.upReLive=function(){},e.prototype.downRelive=function(t,e){bossControl.reliveTime=t,bossControl.killerHandler=e,UIMgr.ins().close(TargetPlayerBigBloodView),bossControl.reliveTime>0?(bossControl.clearWorldBossList(),UIMgr.ins().open(WorldBossBeKillView)):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.upCheckMyInfo=function(){},e.prototype.downMyInfo=function(t,e){this._shenBingExp=t,this._jadeChips=e,EventMgr.ins().dispatch(241)},e.prototype.downAreaChange=function(t){this._areaId=t,EventMgr.ins().dispatch(242)},e.prototype.downResult=function(t){for(var e=[],i=0;i<t.length;i++){var n=new BlisterRankVo;n.init(t[i]),e[i]=n}UIMgr.ins().open(BlisterResultView,e)},e.prototype.checkRedPoint=function(){return this.isOpen&&ActorControl.level+1e3*reincarnateControl.lv>=DataCenter.ins().BlisterConfig.openLv},e.prototype.getBelongById=function(t){if(!this._belongs||0==this._belongs.length)return null;for(var e=this._belongs.length,i=0;e>i;i++)if(this._belongs[i].id==t)return this._belongs[i];return null},__decorate([up(1)],e.prototype,"upEnterPaoDian",null),__decorate([down(1,[3])],e.prototype,"downEnterSuccess",null),__decorate([down(2,[[2,10]])],e.prototype,"downBelongChange",null),__decorate([down(3,[3])],e.prototype,"downEnterCD",null),__decorate([down(4,[0,3])],e.prototype,"downOpenInfo",null),__decorate([up(5)],e.prototype,"upReLive",null),__decorate([down(5,[3,10])],e.prototype,"downRelive",null),__decorate([up(6)],e.prototype,"upCheckMyInfo",null),__decorate([down(6,[3,3])],e.prototype,"downMyInfo",null),__decorate([down(7,[2])],e.prototype,"downAreaChange",null),__decorate([down(8,[ByteConst.BlisterRankVos])],e.prototype,"downResult",null),e=__decorate([protocolsId(62)],e)}(BaseSystem);__reflect(BlisterControl.prototype,"BlisterControl");var BlisterRankVo=function(){function t(){}return t.prototype.init=function(t){this.rank=t[0],this.roleName=t[1],this.unionName=t[2],this.shenBingExp=t[3],this.jadeChips=t[4]},t}();__reflect(BlisterRankVo.prototype,"BlisterRankVo");var BlisterCurrenView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BlisterCurrenViewSkin",e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose),this.addCustomEvent(241,this.update),this.addCustomEvent(242,this.update),this.update()},e.prototype.update=function(){this.yupeiNum.text=LangMgr.getValueByKey("currency14")+blisterControl.jadeChips,this.gwexpNum.text=LangMgr.getValueByKey("currency0")+blisterControl.shenBingExp;var t=DataCenter.ins().BlisterAwardConfig[blisterControl.areaId];this.currentArea.text=t?t.times+LangMgr.getValueByKey("paoDianType2"):"";var e=t?t.reward[1].count:0;e=Math.floor(e/1e3)/10,this.Speed.text=DataCenter.ins().BlisterConfig.efficiencyDesc.replace("{0}",(t?t.reward[0].count:0)+"").replace("{1}",e+""),this.currentArea.textColor=this.yupeiNum.textColor=this.gwexpNum.textColor=this.Speed.textColor=t?t.color:this.Speed.textColor},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onClose),this.removeCustomEvents()},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(BlisterCurrenView.prototype,"BlisterCurrenView");var BlisterNpcTalkView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BlisterNpcTalkViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onGoto),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this.goTo,this.onGoto)},e.prototype.update=function(){this.desc.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().BlisterConfig.desc),this.rule.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().HelpInfoConfig[20].text),this.redPoint.visible=blisterControl.isOpen},e.prototype.onGoto=function(t){if(t.target==this.goTo){if(!blisterControl.isOpen)return void tipsControl.showTips(DataCenter.ins().BlisterConfig.openTips);var e=DataCenter.ins().BlisterConfig.openLv;if(ActorControl.level+1e3*reincarnateControl.lv<e)return void tipsControl.showTips((1e3>e?LangMgr.getValueByKey("numberLevel",e):e%1e3==0?LangMgr.getValueByKey("numberRotation",e/1e3):LangMgr.getValueByKey("numberRotation",e/1e3)+LangMgr.getValueByKey("numberLevel",e%1e3))+LangMgr.getValueByKey("babelCanJoin"));var i=blisterControl.getEnterCD();if(i>0)return void tipsControl.showTips(LangMgr.getValueByKey("paoDianType3",i));blisterControl.upEnterPaoDian()}else t.target==this.bgClose&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(BlisterNpcTalkView.prototype,"BlisterNpcTalkView");var BlisterResultView=function(t){function e(){var e=t.call(this)||this;return e._time=5,e.skinName="BlisterResultViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rankList.itemRenderer=BlisterResultItemRenderer,this.myRewarrd.itemRenderer=BlisterIconItemRenderer,this._arrayCollect=new ArrayCollection,this.myRewarrd.dataProvider=this._arrayCollect},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addCustomEvent(241,this.updateMyScore),this.timerGroup.visible=!0,this.info.text=this._time+"",TimerMgr.ins().doTimer(1e3,5,this.repeat,this),this.updateMyScore(),this.rankList.dataProvider=new eui.ArrayCollection(t[0])},e.prototype.updateMyScore=function(){this._arrayCollect.source=[["ZSprestige",blisterControl.jadeChips],["ZSexp",blisterControl.shenBingExp]]},e.prototype.repeat=function(){this._time--,this._time>0?this.info.text=this._time+"":this.timerGroup.visible=!1},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){switch(t.target){case this.closeBtn:copyControl.upExitFb(),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(BlisterResultView.prototype,"BlisterResultView");var BlisterView=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e.skinName="BlisterViewSkin",e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(238,this.updateTime),this.addCustomEvent(239,this.update),this.addCustomEvent(242,this.updateCurrentArea),this.update(),this.updateTime(),this.updateCurrentArea()},e.prototype.update=function(){for(var t,e,i,n,o,s=0;5>s;s++)t=DataCenter.ins().BlisterConfig.expPoint[s],e=t[2],i=blisterControl.getBelongById(e),n=this["area"+s],n.name=i?i.handler+"":t[0]+","+t[1],this["occupy"+s].visible=null==i,i?(o=UnitMgr.ins().getEntityBymasterhHandle(i.handler),o?(this["name"+s].text=o.infoModel.name,this["guild"+s].text=o.infoModel.guildName):(this["name"+s].text="",this["guild"+s].text="")):(this["name"+s].text="",this["guild"+s].text="")},e.prototype.updateTime=function(){TimerMgr.ins().remove(this.repeat,this),this._leftTime=blisterControl.getLeftTime(),this._leftTime>0?(TimerMgr.ins().doTimer(1e3,0,this.repeat,this),this.repeat()):this.wholeLeftTime.text=""},e.prototype.repeat=function(){return this._leftTime<=0?(this.wholeLeftTime.text="",void TimerMgr.ins().remove(this.repeat,this)):(this.wholeLeftTime.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,4),void this._leftTime--)},e.prototype.updateCurrentArea=function(){var t=DataCenter.ins().BlisterAwardConfig,e=t[blisterControl.areaId],i=e?e.times-1:0;this.currentArea.currentState=3==i?"":LangMgr.getValueByKey("englishNumber"+(i+1))},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents(),TimerMgr.ins().remove(this.repeat,this)},e.prototype.onTouch=function(t){switch(t.target){case this.area0:case this.area1:case this.area2:case this.area3:case this.area4:var e=t.target.name.split(",");1==e.length?gameControl.dispatchChangeAttrPoint(Number(e[0])):(gameControl.upStopAI(),ClientStorage.ins().setValue("mapClickTx",0),ClientStorage.ins().setValue("mapClickTy",0),MapControl.moveTo(Number(e[0])*MapControl.CELL_SIZE,Number(e[1])*MapControl.CELL_SIZE));break;case this.currentArea:blisterControl.upCheckMyInfo(),UIMgr.ins().open(BlisterCurrenView);break;case this.help:HelpControl.openHelpWin(20)}},e}(BaseEuiView);__reflect(BlisterView.prototype,"BlisterView");var BlisterIconItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="BlisterIconItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.icon.source=this.data[0];var t=this.data[1];t=Math.floor(t/1e3)/10,this.count.text=0==t?"0":LangMgr.getValueByKey("shopWan",t)},e}(BaseItemRender);__reflect(BlisterIconItemRenderer.prototype,"BlisterIconItemRenderer");var BlisterResultItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="BlisterResultItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.award.itemRenderer=BlisterIconItemRenderer},e.prototype.dataChanged=function(){var t=this.data;this.ranking.text=t.rank+"",this.roleName.text=t.roleName,this.guild.text=t.unionName,this.award.dataProvider=new ArrayCollection([["ZSprestige",t.jadeChips],["ZSexp",t.shenBingExp]])
},e}(BaseItemRender);__reflect(BlisterResultItemRenderer.prototype,"BlisterResultItemRenderer");var BookControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listBook={},e.itemBook={},e.bookPower=0,e.score=-1,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.getSuitIdByBookId=function(t){var e=DataCenter.ins().BookConfig[t][0];if(!e)return 0;for(var i in DataCenter.ins().BookSuitConfig)if(-1!=DataCenter.ins().BookSuitConfig[i][1].idList.indexOf(t))return Number(i);return 0},e.prototype.getSuitNum=function(t){for(var e=DataCenter.ins().BookSuitConfig[t][1],i=0,n=0;n<e.idList.length;n++){var o=this.getBookById(e.idList[n]);o.level>-1&&i++}return i},e.prototype.getSuitLevel=function(t){for(var e=this.getSuitNum(t),i=0,n=1;DataCenter.ins().BookSuitConfig[t][n];)DataCenter.ins().BookSuitConfig[t][n].count<=e&&(i=DataCenter.ins().BookSuitConfig[t][n].level),n++;return i},e.prototype.getBookRed=function(){for(var t in DataCenter.ins().BookListConfig)for(var e=DataCenter.ins().BookListConfig[t].idList,i=0,n=e;i<n.length;i++)for(var o=n[i],s=DataCenter.ins().BookSuitConfig[o][1].idList,r=0,a=s;r<a.length;r++){var l=a[r];if(0==this.getBookById(l).getState())return!0}return!1},e.prototype.getBookUpRed=function(){for(var t in DataCenter.ins().BookListConfig)for(var e=DataCenter.ins().BookListConfig[t].idList,i=0,n=e;i<n.length;i++){var o=n[i];if(this.getBookUpRedByListId(o))return!0}return!1},e.prototype.getBookUpRedByListId=function(t){for(var e=DataCenter.ins().BookSuitConfig[t][1].idList,i=0,n=e;i<n.length;i++){var o=n[i],s=this.getBookById(o),r=s.getNextLevelCost();if(r&&this.score>=r)return!0}},e.prototype.getBookById=function(t){if(!this.listBook[t]){var e=new BooKVo;this.listBook[t]=e,e.id=t}return this.listBook[t]},e.prototype.getBookByItemId=function(t){return this.itemBook[t]||(this.itemBook[t]=[]),this.itemBook[t]},e.prototype.getBookPowerNum=function(t,e){var n=heroControl.subRolesLen;if(e)for(var o in DataCenter.ins().BookSuitConfig)if(-1!=i.jobs.indexOf(Number(o))&&-1!=DataCenter.ins().BookSuitConfig[o][1].idList.indexOf(e)){n=1;break}return t*n},e.prototype.getBookPowerNumEx=function(){return this.bookPower},e.prototype.getTitleById=function(t){var e=DataCenter.ins().BookListConfig;for(var i in e)if(-1!=e[i].idList.indexOf(t))return e[i].name;return""},e.prototype.downDataChange=function(t,e,i){if(-1==this.score){var n=DataCenter.ins().BookDecomposeConfig;for(var o in n){var s=this.getBookById(+o);this.getBookByItemId(n[o].itemId).push(s)}}for(var r=0;r<t.length;r++){var o=t[r][0],s=this.getBookById(o);s.level=t[r][1]}if(this.score>-1){var a=e-this.score;a>0&&tipsControl.showTips(LangMgr.getValueByKey("customBossGetTJ",a))}this.score=e,this.bookPower=i,EventMgr.ins().dispatch(47)},e.prototype.upOpen=function(t){return[t]},e.prototype.upDecompose=function(t){return[t]},e.prototype.upUpStar=function(t){return[t]},e.prototype.getDecomposeConfigByItemId=function(t){var e=DataCenter.ins().BookDecomposeConfig;if(!this.itemBook[t])return Assert(!1,LangMgr.getValueByKey("customBossTJData",t,Object.keys(this.itemBook).length)),null;if(this.itemBook[t][0]){var i=this.itemBook[t][0].id;return e[i]}return null},e.prototype.checkResolveRedPoint=function(){var t=backpackControl.getBagGoodsByType(9);if(!t.length)return!1;var e=this.itemBook,i={};for(var n in e)for(var o=0,s=e[n];o<s.length;o++){var r=s[o];if(1!=r.getState()){i[n]=!0;break}}for(var a=0,l=t;a<l.length;a++){var r=l[a];if(!i[r.configID])return!0}return!1},e.prototype.getSuitRedPoint=function(t){var e=backpackControl.getBagGoodsByType(9);if(0==e.length)return!1;for(var n=this,o=DataCenter.ins().BookSuitConfig,s={},r=0,a=e;r<a.length;r++){var l=a[r];s[l.configID]=!0}var h=function(t){for(var e=o[t][1],r=e.idList,a=0,l=r;a<l.length;a++){var h=l[a];if(n.listBook[h]&&-1==n.listBook[h].level){var u=i.jobs.indexOf(e.id);if(-1==u){var p=DataCenter.ins().BookDecomposeConfig[h];if(s[p.itemId])return!0}else{for(var c=!1,d=0;d<heroControl.subRolesLen;d++){var g=heroControl.getSubRoleByIndex(d);if(g.job==u+1){c=!0;break}}if(!c)return!1;var m=DataCenter.ins().BookConfig[h][0];if(m&&s[m.itemId])return!0}}}return!1};if(0!=t)return h(t);for(var u in o)if(h(u))return!0;return!1},e.prototype.getMaxLevel=function(t){if(this.bookMaxLevDict||(this.bookMaxLevDict={}),!this.bookMaxLevDict[t]){var e=Object.keys(DataCenter.ins().BookConfig[t]);this.bookMaxLevDict[t]=e.length-1}return this.bookMaxLevDict[t]},e.prototype.checkDanRed=function(){if(!this.listBook)return!1;for(var t=DataCenter.ins().LittleSystemBaseConfig.bookUpItem,e=0;e<t.length;e++){var i=t[e];if(!backpackControl.isHideDanIcon(i)){if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,i))for(var n in this.listBook){var o=this.listBook[n];if((!o||this.isShowBookCardCondition(o.id))&&this.canUseDan(o,i)&&0==o.level&&DataCenter.ins().BookDecomposeConfig[o.id].quality==DataCenter.ins().ItemConfig[i].useArg.quality)return!0}break}}return!1},e.prototype.getBooksByDan=function(t){if(!this.listBook)return null;var e=[];for(var i in this.listBook){var n=this.listBook[i];this.canUseDan(n,t)&&e.push(n)}return e},e.prototype.canUseDan=function(t,e){if(!t||t.level<=-1)return!1;var i=DataCenter.ins().ItemConfig[e].useArg;return DataCenter.ins().BookDecomposeConfig[t.id].quality<=i.quality&&t.level<i.maxLevel&&t.level<Object.keys(DataCenter.ins().BookConfig[t.id]).length-1?!0:!1},e.prototype.isShowBookCardCondition=function(t){var e=DataCenter.ins().BookDecomposeConfig[t];if(!e)return!1;if(1!=this.getBookById(t).getState()){var i=DataCenter.ins().ClientGlobalConfig.bookCondition;if(-1!=i.indexOf(t)){var n=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e.itemId);if(0>=n)return!1}}return isNaN(e.openDay)?!0:GameServer.serverOpenDay+1>=e.openDay?!0:!1},e.jobs=[6,7,8],__decorate([down(1,[[2,2],3,10])],e.prototype,"downDataChange",null),__decorate([up(2,[2])],e.prototype,"upOpen",null),__decorate([up(3,[[2,2]])],e.prototype,"upDecompose",null),__decorate([up(4,[2])],e.prototype,"upUpStar",null),e=i=__decorate([protocolsId(53)],e);var i}(BaseSystem);__reflect(BookControl.prototype,"BookControl");var AmusementType19DataVo=function(t){function e(){var e=t.call(this)||this;return e.awardIndex=0,e._data={},e._list=[],e}return __extends(e,t),e.prototype.CleanRandData=function(){this._data={},this._list=[]},e.prototype.SetRankData=function(t){this._list[t.rank-1]=t,this._data[t.actorId]=t},e.prototype.GetRankData=function(){return this._data},e.prototype.GetRankList=function(){return this._list},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getleftTime=function(){return this.isOpenActivity()?Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3):0},e.prototype.checkRedPoint=function(){var t=DataCenter.ins().Amusement19Config[this.id][1];if(t.activityID){var e=amusementControl.getAmusementDataById(t.activityID);if(e&&e.canReward())return!0}return!1},e}(AmusementBaseDataVo);__reflect(AmusementType19DataVo.prototype,"AmusementType19DataVo");var VouchersPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().ClientNoticeConfig,n=i.desc,o=i.desc1;this.title.textFlow=TextUtils.generateTextFlow(n),this.desc.textFlow=TextUtils.generateTextFlow(o),this.desc.height=this.desc.textHeight,noticeControl.isOpenNotice&&(noticeControl.isOpenNotice=!1,noticeControl.dispatchGameNotice(),noticeControl.upSetNoticeOPen()),this.addCustomEvent(392,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){this._cfg=DataCenter.ins().WelfareConfig[4];var t=amusementControl.getAmusementDataById(this._cfg.activityId?this._cfg.activityId:0);t?(this.updataReward.visible=!0,this.suerBtn.enabled=t.canReward(),this.redPoint.visible=this.suerBtn.enabled,t.getRewardStateById(1)==AmusementControl.Geted?(this.yilingqu.visible=!0,this.suerBtn.visible=!1):(this.yilingqu.visible=!1,this.suerBtn.visible=!0),this._collect||(this._collect=new ArrayCollection,this.reward.dataProvider=this._collect),this._collect.source=DataCenter.ins().Amusement1Config[this._cfg.activityId][1].rewards):this.updataReward.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.suerBtn:amusementControl.upReward(this._cfg.activityId,1)}},e}(GameNoticePanel);__reflect(VouchersPanel.prototype,"VouchersPanel");var BooKVo=function(){function t(){this.level=-1,this.exp=0,this.number=0}return t.prototype.getNum=function(){var t=DataCenter.ins().BookConfig[this.id][0].itemId,e=backpackControl.getBagGoodsCountById(0,t),i=bookControl.getSuitIdByBookId(this.id);if(e){if(!i)return e;var n=BookControl.jobs.indexOf(i);if(-1==n)return e;for(var o=void 0,s=0;s<heroControl.subRolesLen;s++){var r=heroControl.getSubRoleByIndex(s);if(r&&r.job==n+1){o=!0;break}}return o?e:0}return 0},t.prototype.getNextLevelCost=function(){if(-1==this.level)return 0;var t=DataCenter.ins().BookConfig[this.id][this.level+1];return t?t.cost:0},t.prototype.getState=function(){return this.level>-1?1:this.getNum()>0?0:2},t}();__reflect(BooKVo.prototype,"BooKVo");var SevenDayPanel=function(t){function e(){var e=t.call(this)||this;e.dayindex=0,e.itemList=[],e.itemary=[],e.getRewards=function(t){for(var e=[],i=heroControl.getSubRoleByIndex(0).job,n=0;n<t.length;n++){var o=t[n];o.job?o.job==i&&e.push(o):e.push(o)}return e};var i=DataCenter.ins().SevenDayBasicConfig,n=i&&i.pageSkin?i.pageSkin:"SevenDayPanelSkin";if(e.skinName=n,"SevenDayPanel2Skin"==e.skinName)e.content0.itemRenderer=SevenDayPanelItem2Render,e.listData=new eui.ArrayCollection,e.content0.dataProvider=e.listData;else{e.itemary=[],e.itemList=[];for(var o=0;14>o;o++)e.itemList[o]=e["dayNum"+(o+1)],e.itemList[o].touchEnabled=!1}return e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if("SevenDayPanel2Skin"==this.skinName){for(var n in DataCenter.ins().SevenDayConfig){var o=DataCenter.ins().SevenDayConfig[n];o.rewards=this.getRewards(o.rewards)}return this.addCustomEvent(404,this.changeList64),this.addCustomEvent(396,this.changeList64),void this.changeList64()}this.addEventTouchTap(this.suerBtn,this.onTouch);for(var n=0;14>n;n++)this.addEventTouchTap(this.itemList[n],this.itemTouch);this.addCustomEvent(404,this.setList),this.addCustomEvent(396,this.changeList),this.changeList();var s=e[0];s&&this.setList(s),TimerMgr.ins().doNext(function(){t.dayindex>7&&(t.scroller.viewport.scrollV=t.scroller.viewport.contentHeight-t.scroller.height)},this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.suerBtn,this.onTouch),DisplayUtils.removeFromParent(this.btnMC);for(var i=0;14>i;i++)this.removeEventTouchTap(this.itemList[i],this.itemTouch);this.removeCustomEvents()},e.prototype.changeList64=function(){for(var t=[],e=[],i=amusementControl.dayNum,n=1;14>=n;n++){var o=DataCenter.ins().SevenDayConfig[n];o&&(i>=o.day&&1==(amusementControl.isAwards>>o.day&1)?e.push(o):t.push(o))}this.listData.replaceAll(t.concat(e)),this.setDayShow()},e.prototype.setDayShow=function(){var t=amusementControl.dayNum;this.daylabel.text=LangMgr.getValueByKey("osaLoadDay",t),this.daylabel.visible=!0;var e=t>14?14:t,i=DataCenter.ins().SevenDayConfig[e];this.act14RewardBg.source=i.bg+"_jpg",this.act14RewardShow.source=i.displayItemIcon+"_png",this.act14RewardName.source=""+i.displayItemName},e.prototype.changeList=function(){var t=0,e=amusementControl.dayNum;t=e>=14?13:e;for(var i=1;t>=i;i++){var n=DataCenter.ins().SevenDayConfig[i];if(n&&e>=n.day&&0==(amusementControl.isAwards>>n.day&1))return void this.setList(i-1)}this.setList(t)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.suerBtn:amusementControl.dayNum>=this.day?amusementControl.upGetSevenDayAwards(this.day):tipsControl.showTips(LangMgr.getValueByKey("osaNoLoadingDay"))}},e.prototype.itemTouch=function(t){this.setList(t.currentTarget.data-1)},e.prototype.setList=function(t){void 0===t&&(t=-1),-1==t&&(t=this.dayindex),this.dayindex=t;var e;CommonUtils.getObjectLength(DataCenter.ins().SevenDayConfig);e=DataCenter.ins().SevenDayConfig[t+1].rewards,this.day=DataCenter.ins().SevenDayConfig[t+1].day;var i=0;i=amusementControl.dayNum,this.daylabel.text=LangMgr.getValueByKey("osaLoadDay",i),this.daylabel.visible=!0;var n=1==(amusementControl.isAwards>>this.day&1);this.dayaward.text=LangMgr.getValueByKey("osaDesIndex",TextUtils.getChineseNum(t+1)),this.suerBtn.visible=!0,amusementControl.dayNum>=this.day?n?(this.daylabel.visible=!1,this.suerBtn.visible=!1,this.redPoint.visible=!1):(this.btnMC=this.btnMC||new GameMovieClip,this.btnMC.x=this.suerBtn.width/2,this.btnMC.y=this.suerBtn.height/2,this.btnMC.playFile(PATH_EFF+"chargeff1",-1),this.suerBtn.addChild(this.btnMC),this.redPoint.visible=!0):(DisplayUtils.removeFromParent(this.btnMC),this.suerBtn.visible=!1,this.redPoint.visible=!1),this.itemary.forEach(function(t){t.parent&&(t.parent.removeChild(t),t=null)}),this.itemary=[];for(var o=0;o<e.length;o++){var s=new ItemBase;this.group1.addChild(s),s.data=e[o],this.itemary.push(s)}for(var o=0;14>o;o++)this.itemList[o].data=o+1,o==t||13==o&&13==t?this.itemList[o].setSelectImg(!0):this.itemList[o].setSelectImg(!1)},e}(BasePanel);__reflect(SevenDayPanel.prototype,"SevenDayPanel");var BookDanSelectView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="BookDanSelectViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._danID=t[0],this.list.itemRenderer=BookDanSelectItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col,this.addEventTouchTap(this.bgClose,this.onClose),this.addCustomEvent(47,this.update),this.addCustomEvent(466,this.checkEnd),this.update()},e.prototype.update=function(){var t=bookControl.getBooksByDan(this._danID);if(t&&t.length){t.sort(this.sort),this.empty.visible=!1;for(var e=[],i=t.length,n=0;i>n;n++)e.push({book:t[n],danID:this._danID});this._col.replaceAll(e)}else this._col.source=null,this.empty.visible=!0},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.checkEnd=function(){backpackControl.isHideDanIcon(this._danID)&&UIMgr.ins().close(this)},e.prototype.sort=function(t,e){var i=DataCenter.ins().BookDecomposeConfig[t.id].quality,n=DataCenter.ins().BookDecomposeConfig[e.id].quality;return i!=n?i>n?-1:1:t.level<e.level?-1:1},e}(BaseEuiView);__reflect(BookDanSelectView.prototype,"BookDanSelectView");var BookPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("equipment21"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.listBook.itemRenderer=BookItemRenderer,this.listMenu.itemRenderer=BookListItemRenderer,this.listBook.touchEnabled=!1,this.resolve.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("bookPartImg")),this.chargeEff1=new GameMovieClip,this.eff.addChild(this.chargeEff1),this.chargeEff1.touchEnabled=!1,this.chargeEff1.scaleY=.5,this.chargeEff1.scaleX=.75,this.greencolor=LangMgr.getColor("color38"),this.graycolor=this.attr.textColor,this.itemHeight=236},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.addEventTouchTap(this.resolve,this.onTap),this.addEventTouchTap(this.getway,this.onTap),this.addEventTouchTap(this.leftGroup,this.onTap),this.addEventTouchTap(this.rightGroup,this.onTap),this.addCustomEvent(47,this.delayItemChange),this.addCustomEvent(268,this.delayItemChange),this.addCustomEvent(266,this.delayItemChange),this.addCustomEvent(267,this.delayItemChange),this.addCustomEvent(499,this.updateRedPoint),this.addEventChangeEnd(this.listScroller,this.onChange),this.addEventItemTap(this.listBook,this.onBookTap),this.addEventItemTap(this.listMenu,this.onMenuTap),this.initView();var n=e[0]||0,o=null,s=0,r=0;if(n){o=bookControl.getDecomposeConfigByItemId(n);var a=DataCenter.ins().BookSuitConfig,l=1;for(var h in a)if(a[h][1].idList.indexOf(o.id)>=0){l=+h;break}for(var h in DataCenter.ins().BookListConfig)if(DataCenter.ins().BookListConfig[h].idList.indexOf(l)>=0){s=DataCenter.ins().BookListConfig[h].sort-1,r=DataCenter.ins().BookListConfig[h].idList.indexOf(l);break}}TimerMgr.ins().doTimer(200,1,function(){t.listMenu.selectedIndex=s;var e=t.listMenu.getVirtualElementAt(s);e&&e.idList&&(t.curId=e.idList[r],t.updateBook(),t.updateAttr())},this),this.preScrollV=0,this.upBtn.open(DataCenter.ins().LittleSystemBaseConfig.bookUpItem)},e.prototype.onChange=function(){this.listMenu.scrollH<46?(this.leftGroup.visible=!1,this.rightGroup.visible=!0):this.listMenu.scrollH>=this.listMenu.contentWidth-this.listMenu.width-46?(this.leftGroup.visible=!0,this.rightGroup.visible=!1):(this.leftGroup.visible=!0,this.rightGroup.visible=!0),this.updateRedPoint()},e.prototype.onTap=function(t){var e=460,i=0;switch(t.currentTarget){case this.resolve:UIMgr.ins().open(BreakDownView,2,9);break;case this.getway:UIMgr.ins().open(BookSuitTipsView,this.curId);break;case this.leftGroup:i=this.listMenu.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.listMenu.scrollH=i,this.onChange();break;case this.rightGroup:i=this.listMenu.scrollH+e,i=92*Math.round(i/92),i>this.listMenu.contentWidth-this.listScroller.width&&(i=this.listMenu.contentWidth-this.listScroller.width),this.listMenu.scrollH=i,this.onChange()}},e.prototype.close=function(){this.removeEventTouchTap(this.resolve,this.onTap),this.removeEventTouchTap(this.getway,this.onTap),this.removeEventTouchTap(this.listMenu,this.onMenuTap),this.removeEventTouchTap(this.leftGroup,this.onTap),this.removeEventTouchTap(this.rightGroup,this.onTap),this.removeEventChangeEnd(this.listScroller,this.onChange),this.removeEventItemTap(this.listBook,this.onBookTap),this.removeEventItemTap(this.listMenu,this.onMenuTap),this.removeCustomEvents(),this.upBtn.close()},e.prototype.initView=function(){var t=DataCenter.ins().BookListConfig,e=[];for(var i in t)e.push(t[i]);e.sort(function(t,e){return t.sort-e.sort});var n=new eui.ArrayCollection(e);this.listMenu.dataProvider=n,this.updateBook(),this.leftGroup.parent.touchEnabled=!1,this.onChange()},e.prototype.playEffect=function(){BookRedPoint.ins().redPoint1?(this.chargeEff1.parent||this.eff.addChild(this.chargeEff1),this.chargeEff1.playFile(PATH_EFF+"chargeff1",-1)):DisplayUtils.removeFromParent(this.chargeEff1)},e.prototype.delayItemChange=function(){TimerMgr.ins().isExists(this.onItemChange,this)||TimerMgr.ins().doTimer(60,1,this.onItemChange,this)},e.prototype.onItemChange=function(){this.updateBook();var t=this.listBook.parent;t.scrollV=this.preScrollV},e.prototype.setStartPosition=function(t){var e=this.listBook.parent,i=e.parent;i.stopAnimation();for(var n=0,o=0;o<t.length;o++)if(this.getCanAct(t[o])){if(o>=9){var s=Math.floor(o/3),r=this.listBook.layout;n=s>1?s*this.itemHeight+(s-1)*r.verticalGap:s*this.itemHeight}break}if(n*=this.listBook.scaleY,i.height>=this.listBook.contentHeight*this.listBook.scaleY)n=0;else{var a=this.listBook.contentHeight*this.listBook.scaleY-i.height;a=a>0?a:0,n>=a&&(n=a)}e.scrollV=n,this.preScrollV=e.scrollV},e.prototype.updateBook=function(t){if(this.curId){var e=DataCenter.ins().BookSuitConfig[this.curId][1],i=this.listBook.dataProvider;if(i&&i.source==e.idList?i.refresh():this.listBook.dataProvider=new eui.ArrayCollection(e.idList),this.listBook.validateNow(),this.setStartPosition(e.idList),!t){var n=this.listMenu.dataProvider;for(var o in n.source)n.itemUpdated(n.getItemAt(parseInt(o)))}this.updateAttr(),this.playEffect();var s=bookControl.getBookPowerNumEx();this.power.text=s+""}},e.prototype.onBookTap=function(t){var e=this.listBook.selectedItem,i=bookControl.getBookById(e);if(e&&i){var n=this.listBook.parent;this.preScrollV=n.scrollV,UIMgr.ins().open(BookUpView,i)}},e.prototype.updateAttr=function(){var t,e=DataCenter.ins().BookSuitConfig[this.curId][1],i=bookControl.getSuitLevel(this.curId);i>0?(e=DataCenter.ins().BookSuitConfig[this.curId][i],t=this.greencolor):t=this.graycolor;var n="";for(var o in DataCenter.ins().BookListConfig){var s=DataCenter.ins().BookListConfig[o];if(-1!=s.idList.indexOf(this.curId)){n=s.nameImg;break}}var r=bookControl.getSuitNum(this.curId),a=e.idList.length;this.progress.text="（"+LangMgr.getValueByKey("bookTogthAll")+r+"/"+a+"）",this.labelIcon.source=n;for(var l=AttributeData.getAttStr(e.attrs,0,1,":"),h=l.split("\n"),u=LangMgr.getValueByKey("bookTogthAllEff"),p=0;p<h.length;p++)u+=h[p]+"  ";this.attr.textFlow=TextUtils.generateTextFlow1("|C:"+t+"&T:"+u),this.expValue.text=bookControl.score+""},e.prototype.onMenuTap=function(t){var e=t.item;this.curId=e.idList[0],this.updateBook(!0),this.updateAttr()},e.prototype.getCanAct=function(t){var e=bookControl.getBookById(t),i=e.getState();return 0==i},e.prototype.updateRedPoint=function(){this.leftRed.visible=BookRedPoint.ins().redPoint,this.rightRed.visible=BookRedPoint.ins().redPoint},e}(BasePanel);__reflect(BookPanel.prototype,"BookPanel");var BookSuitTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BookSuitTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.suitlist.itemRenderer=BookSuitTipsItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.otherClose),this.suitId=t[0],this.updateData()},e.prototype.updateData=function(){this.nameLabel.text=bookControl.getTitleById(this.suitId)+LangMgr.getValueByKey("bookPartAdd");var t=DataCenter.ins().BookSuitConfig[this.suitId],e=[],i=bookControl.getSuitNum(this.suitId);for(var n in t){var o=t[n],s={config:o,curNum:i};e.push(s)}this.suitlist.dataProvider=new eui.ArrayCollection(e)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(e)},e}(BaseEuiView);__reflect(BookSuitTipsView.prototype,"BookSuitTipsView");var BookTipsView=function(t){function e(){var e=t.call(this)||this;return e._bottomY=0,e._equipPower=0,e.curRole=0,e.curId=0,e.curLevel=0,e.index=0,e.skinName="BookTipsViewSkin",e.uilayer=GameLayer.POPUP,e.powerPanel.setBgVis(!1),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.itemIcon.imgJob.visible=!1,this.anigroup.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curId=t[0],this.curLevel=t[1]||0,this.handle=t[2],this.addEventTouchEnd(this.bgClose,this.otherClose),this.addEventTouchEnd(this.btnUse,this.onTap),this.setData(this.curId)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeEventTouchTap(this.btnUse,this.onTap)},e.prototype.otherClose=function(t){UIMgr.ins().close(e)},e.prototype.onTap=function(t){UIMgr.ins().close(this),UIMgr.ins().open(ExperienceView,3,this.curId)},e.prototype.setData=function(t){var e=bookControl.getDecomposeConfigByItemId(t),i=DataCenter.ins().BookConfig[e.id][this.curLevel];this._confBase=e;var n=DataCenter.ins().ItemConfig[i.itemId];n&&(this.nameLabel.text=n.name),this.nameLabel.textColor=LangMgr.getColor("qualityColor"+e.quality),this.lvTxt.text=""+i.level+LangMgr.getValueByKey("roleStart"),this.qualityImg.source="quali"+e.quality,this.qualTxt.text=ColorUtils.getColorcChinese(e.quality),this.itemIcon.setData(n);var o=1;this.attr1.visible=!1,this.attr2.visible=!1,this.attr3.visible=!1,this.attr4.visible=!1;var s=[],r=!1,a="";for(var l in i.attrs)if(0!=i.attrs[l].type&&0!=i.attrs[l].value)if(11==i.attrs[l].type||12==i.attrs[l].type||16==i.attrs[l].type||23==i.attrs[l].type||24==i.attrs[l].type){if(!r){a=LangMgr.getValueByKey("equiAttrType5"),a+=LangMgr.getValueByKey("bookAllRole"),r=!0;var h=AttributeData.getAttrStrByType(i.attrs[l].type);(23==i.attrs[l].type||24==i.attrs[l].type)&&(h=LangMgr.getValueByKey("bookDefence")),a+=h,a+="+"+i.attrs[l].value/100+"%",s.push(i.attrs[l])}}else{var u="";u=AttributeData.getAttStrByType(i.attrs[l],0,"  "),s.push(i.attrs[l]),this["attr"+o].text=u,this["attr"+o].visible=!0,o++}if(i.specialAttr){""==a&&(a=LangMgr.getValueByKey("equiAttrType5"));for(var l in i.specialAttr)0!=i.specialAttr[l].type&&0!=i.specialAttr[l].value&&(r=!0,a+=LangMgr.getValueByKey("bookGuanJi"),a+=1==i.specialAttr[l].type?LangMgr.getValueByKey("charItemJB",""):LangMgr.getValueByKey("currency0"),a+="+"+i.specialAttr[l].value+"%")}this.specialAttr.text=a,this.specialAttr.visible=r,this._equipPower=Math.floor(BackpackControl.getAttrPower(s)),this.addTipsEx();var p=3;for(var l in DataCenter.ins().BookSuitConfig)if(-1!=BookControl.jobs.indexOf(Number(l))&&-1!=DataCenter.ins().BookSuitConfig[l][1].idList.indexOf(i.id)){p=1,this.threeLabel.visible=!1;break}this.powerPanel.setPower(this._equipPower),this.iconBg.source=e.imgShow||e.imgLight,this.quality0.source=this.quality1.source=this.quality2.source=this.quality3.source="book_"+e.quality+"c",this.quality.source="book_"+e.quality+"a",this.quality4.source="book_"+e.quality+"b";for(var c=bookControl.getBookByItemId(this.curId),d=!0,g=0,m=c;g<m.length;g++){var f=m[g];if(1!=f.getState()){d=!1;break}}d?(this.btnUse.label=LangMgr.getValueByKey("bookPart"),this.tips.source="tjyijihuo"):(this.btnUse.label=LangMgr.getValueByKey("bookUse"),this.tips.source="tjweijihuo"),this.btnUse.visible=!!this.handle},e.prototype.addTipsEx=function(){var t,e=bookControl.getBookByItemId(this.curId)[0];if(e&&(t=e.id),t){var i="";for(var n in DataCenter.ins().BookSuitConfig){var o=DataCenter.ins().BookSuitConfig[n][1];if(-1!=o.idList.indexOf(t)){i=o.name?o.name:"",t=o.id;break}}var s="";for(var r in DataCenter.ins().BookListConfig){var o=DataCenter.ins().BookListConfig[r];if(-1!=o.idList.indexOf(t)){s=o.name?o.name:"";break}}if(i||s){this.belong.visible=!0;var a=i?i+"·":"";a+=s,this.belong.text=a}else this.belong.visible=!1}},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!!bookControl.getDecomposeConfigByItemId(t[0])},e}(BaseEuiView);__reflect(BookTipsView.prototype,"BookTipsView");var BookUpView=function(t){function e(){var e=t.call(this)||this;return e.jobName=[],e.skinName="BookUpViewSkin",e.uilayer=GameLayer.POPUP,e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.listOpen.dataProvider=null,this.listOpen.itemRenderer=BookItemRenderer,this.jobName=[LangMgr.getValueByKey("job2"),LangMgr.getValueByKey("job3"),LangMgr.getValueByKey("job4")],this.barbc=new ProgressBarEff,this.barbc.setWidth(450),this.barbc.x=-10,this.barbc.y=-15,this.barGroup.addChild(this.barbc),this.selectData=t[0],this.addCustomEvent(47,this.updateView),this.addEventTouchTap(this.btnUp,this.onTap),this.addEventTouchTap(this.info,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.updateView()},e.prototype.close=function(){this.removeEventTouchTap(this.btnUp,this.onTap),this.removeEventTouchTap(this.info,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){switch(t.target){case this.btnUp:var e=bookControl.getSuitIdByBookId(this.selectData.id);if(!e)return;var i=!1,n=BookControl.jobs.indexOf(Number(e));if(-1!=n){for(var o=0;o<heroControl.subRolesLen;o++){var s=heroControl.getSubRoleByIndex(o);if(s&&s.job==n+1){i=!0;break}}if(!i)return void tipsControl.showTips(LangMgr.getValueByKey("bookJobOpen",this.jobName[n]))}var r=DataCenter.ins().BookDecomposeConfig[this.selectData.id],a=r.itemId,l=r.name,h=r.imgLight;if(i){var u=DataCenter.ins().BookConfig[this.selectData.id][0];a=u.itemId}if(-1==this.selectData.level){var p=DataCenter.ins().ItemConfig[a],c=backpackControl.getBagItemById(p.id);c?(bookControl.upOpen(this.selectData.id),UIMgr.ins().close(this),CommonFun.show(0,l,h,null,!0)):warnControl.setBuyGoodsWarn(p.id,1)}else{var d=DataCenter.ins().BookConfig[this.selectData.id][this.selectData.level];d.cost>bookControl.score?tipsControl.showTips(LangMgr.getValueByKey("bookEnoughtExp")):bookControl.upUpStar(this.selectData.id)}break;case this.info:if(-1==this.selectData.level){var g=bookControl.getSuitIdByBookId(this.selectData.id);if(!g)return;var m,p=void 0;if(-1==BookControl.jobs.indexOf(Number(g)))m=DataCenter.ins().BookDecomposeConfig[this.selectData.id],p=DataCenter.ins().ItemConfig[m.itemId],warnControl.setBuyGoodsWarn(p.id,1);else{var f=DataCenter.ins().BookConfig[this.selectData.id][0];p=DataCenter.ins().ItemConfig[f.itemId],warnControl.setBuyGoodsWarn(p.id,1)}}else UIMgr.ins().open(BreakDownView,2,9);break;case this.closeBtn:case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateView=function(){var t=DataCenter.ins().BookDecomposeConfig[this.selectData.id],e=this.selectData.level>-1?this.selectData.level:0,i=DataCenter.ins().BookConfig[this.selectData.id][e];this.listOpen.dataProvider=new eui.ArrayCollection([this.selectData.id]),this.listOpen.validateNow();for(var n=0;n<this.listOpen.numElements;n++){var o=this.listOpen.getElementAt(n);o&&o.setRemoveTween(!0)}var s=DataCenter.ins().BookConfig[this.selectData.id][this.selectData.level+1];if(this.labelCur.text=AttributeData.getAttStr(i.attrs,0,1,"："),this.barbc.setMaxValue(s?s.cost:i.cost),this.barbc.setValue(bookControl.score),this.selectData.level<0){this.currentState="noActive",this.btnUp.label=LangMgr.getValueByKey("smeltActivity"),this.info.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("bookImgDes"));var r=[];for(var n in i.attrs)11!=i.attrs[n].type&&12!=i.attrs[n].type&&16!=i.attrs[n].type&&23!=i.attrs[n].type&&24!=i.attrs[n].type&&r.push({type:i.attrs[n].type,value:0});this.labelCur.text=AttributeData.getAttStr(r,0,1,"：")}else s?(this.currentState="nomax",this.btnUp.label=LangMgr.getValueByKey("bookStart"),this.info.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("bookGetImgExp"))):(this.currentState="max",this.btnUp.label=LangMgr.getValueByKey("bookStartMax"),this.info.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("bookGetImgExp")));if(this.selectData.level<0){this.lblNeed.textColor=LangMgr.getColor("qualityColor"+t.quality);var a=DataCenter.ins().ItemConfig[t.itemId];this.lblNeed.text=a.name+"x1"}if(s){this.barbc.setMaxValue(s.cost);var l=[];for(var n in s.attrs)11!=s.attrs[n].type&&12!=s.attrs[n].type&&16!=s.attrs[n].type&&23!=s.attrs[n].type&&24!=s.attrs[n].type&&(l[n]=s.attrs[n]);this.labelNext.text=AttributeData.getAttStr(l,0,1,"：")}else this.labelNext.text=LangMgr.getValueByKey("bookStartMax"),this.barbc.setLbValueText(LangMgr.getValueByKey("bookStartMax"));this.specialAttrDese(i)},e.prototype.specialAttrDese=function(t){if(!t)return void(this.specialAttr.visible=!1);this.specialAttr.visible=!0;var e=!1,i="";for(var n in t.attrs)if(0!=t.attrs[n].type&&0!=t.attrs[n].value&&!e&&(11==t.attrs[n].type||12==t.attrs[n].type||16==t.attrs[n].type||23==t.attrs[n].type||24==t.attrs[n].type)){i=LangMgr.getValueByKey("equiAttrType5"),e=!0,i+=LangMgr.getValueByKey("bookAllRole");var o=AttributeData.getAttrStrByType(t.attrs[n].type);(23==t.attrs[n].type||24==t.attrs[n].type)&&(o=LangMgr.getValueByKey("bookDefence")),i+=o,i+="+"+t.attrs[n].value/100+"%";break}if(t.specialAttr){""==i&&(i=LangMgr.getValueByKey("equiAttrType5"));for(var n in t.specialAttr)0!=t.specialAttr[n].type&&0!=t.specialAttr[n].value&&(e=!0,i+=LangMgr.getValueByKey("bookGuanJi"),i+=1==t.specialAttr[n].type?LangMgr.getValueByKey("charItemJB",""):LangMgr.getValueByKey("currency0"),i+="+"+t.specialAttr[n].value+"%")
}this.specialAttr.text=i,this.specialAttr.visible=e},e}(BaseEuiView);__reflect(BookUpView.prototype,"BookUpView");var BreakDownView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DeityBreakDownViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.listData=new eui.ArrayCollection,e.equipList.itemRenderer=DeityBreakDownItemRenderer,e.equipList.dataProvider=e.listData,e.gainList.itemRenderer=GainGoodsItem,e.goList=new eui.ArrayCollection,e.gainList.dataProvider=e.goList,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(268,this.updateData),this.addCustomEvent(269,this.updateData),this.addEventTouchTap(this,this.onTap),this.addEventItemTap(this.gainList,this.onGo),this._breakType=t[0]||0,this._ext=t[1],this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this,this.onTap),this.removeEventItemTap(this.gainList,this.onGo),this.removeCustomEvents()},Object.defineProperty(e,"fitleEquip",{get:function(){if(!e._fitleEquip){e._fitleEquip={};for(var t in DataCenter.ins().SpecialEquipsConfig)1==DataCenter.ins().SpecialEquipsConfig[t].style&&(e._fitleEquip[DataCenter.ins().SpecialEquipsConfig[t].id]=DataCenter.ins().SpecialEquipsConfig[t])}return e._fitleEquip},enumerable:!0,configurable:!0}),e.prototype.getLegendSource=function(){var t=[];if(4==this._ext)for(var i=backpackControl.getBagEquipsByQuality(4),n=0;n<i.length;n++)e.fitleEquip[i[n].configID]||t.push(i[n]);else t=backpackControl.getBagEquipsByQuality(5);return t.sort(function(t,e){var i=DataCenter.ins().ItemConfig[t.configID],n=DataCenter.ins().ItemConfig[e.configID];return i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:i.level>n.level?1:i.level<n.level?-1:0}),t},e.prototype.getBookSource=function(){var t=backpackControl.getBagGoodsByType(this._ext);t.sort(function(t,e){var i=ItemUtils.getQuality(t.itemConfig),n=ItemUtils.getQuality(e.itemConfig);return i!=n?i-n:t.configID-e.configID});var e=[],i=bookControl.itemBook,n={};for(var o in i)for(var s=0,r=i[o];s<r.length;s++){var a=r[s];if(1!=a.getState()){n[o]=!0;break}}for(var l=0,h=t;l<h.length;l++){var a=h[l];if(!n[a.configID]){var u=new ItemData;u.count=1,u.handle=a.handle,u.configID=a.configID;for(var p=0;p<a.count;p++)e.push(u)}}return e},e.prototype.getLegendGoSource=function(){if(this.itemList)return this.itemList;var t=[];t[0]=LangMgr.getValueByKey("breakType1"),t[1]=egret.getQualifiedClassName(TreasureHuntView),t[2]=0;var e=[];e[0]=LangMgr.getValueByKey("breakType2"),e[1]=egret.getQualifiedClassName(BossView),e[2]=1;var i=[];i[0]=LangMgr.getValueByKey("breakType3"),i[1]=egret.getQualifiedClassName(CopyView),i[2]=2;var n=[];n[0]=LangMgr.getValueByKey("breakType1"),n[1]=egret.getQualifiedClassName(TreasureHuntView),n[2]=0;var o=[[],[],[],[],[t,e],[n]];return this.itemList=o[this._ext],this.itemList},e.prototype.updateData=function(){var t,e;1==this._breakType?(t=this.getLegendSource(),e=this.getLegendGoSource()):2==this._breakType&&(t=this.getBookSource(),e=[]),this.listData.source=t,this.goList.source=e;var i=e.length;this.refushPos(i)},e.prototype.refushPos=function(t){this.contrain.height=60*t,this.equipScroller.height=310+60*(3-t)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn0:case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;default:if(t.target instanceof eui.Button)switch(t.target.name){case"breakDown":t.target.parent&&this.onHandler(t.target.parent.data)}}},e.prototype.onHandler=function(t){if(1==this._breakType)equipControl.upSmeltEquip(1,[t]);else if(2==this._breakType){var e=bookControl.getDecomposeConfigByItemId(t.itemConfig.id);bookControl.upDecompose([[e.id,t.count]])}},e.prototype.onGo=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&(GuideControl.guidance(e[1],e[2]),UIMgr.ins().close(this))}},e}(BaseEuiView);__reflect(BreakDownView.prototype,"BreakDownView");var BookDanSelectItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="BookDanSelectItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this.upgrateBtn,this.onUse)},e.prototype.dataChanged=function(){var t=this.data.book.level,e=DataCenter.ins().BookConfig[this.data.book.id][t];this.itemIcon.data=DataCenter.ins().ItemConfig[e.itemId],this.attr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStrEx(e.attrs,0,1)),this.best.visible=0==t&&DataCenter.ins().BookDecomposeConfig[this.data.book.id].quality==DataCenter.ins().ItemConfig[this.data.danID].useArg.quality;for(var i=0;10>i;i++){var n=this["imgStar"+i];if(n.visible=t>i,n.visible){var o=10*((t-1)/10>>0)+i+1,s=t>=o?DataCenter.ins().BookConfig[this.data.book.id][o]:null;n.source=s&&s.showIcon?s.showIcon:"tujian_star"}}this.levelStrText.text=LangMgr.getValueByKey("xingjistr",0>=t?LangMgr.getValueByKey("persontNone"):"")},e.prototype.onUse=function(){var t=this;if(this.best.visible)this.sendAndClose();else{var e=DataCenter.ins().ItemConfig[this.data.danID],i=e.useArg.quality;warnControl.show(LangMgr.getValueByKey("zhishengdanbookTips",ItemUtils.getQualityColor(e),e.name,LangMgr.getColor("qualityColor"+i),LangMgr.getValueByKey("qualityColorTxt"+i)),function(){t.sendAndClose()},this)}},e.prototype.sendAndClose=function(){backpackControl.upUseItem(this.data.danID,1,this.data.book.id),backpackControl.recordUseDan(55),UIMgr.ins().close(BookDanSelectView)},e}(BaseItemRender);__reflect(BookDanSelectItemRender.prototype,"BookDanSelectItemRender");var BookItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="BookItemRendererSkin",e.tw=egret.Tween.get(e.canActImg,{loop:!0}),e.tw.to({scaleX:e.canActImg.scaleX+.3,scaleY:e.canActImg.scaleY+.3},500).to({scaleX:e.canActImg.scaleX,scaleY:e.canActImg.scaleY},500),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.onRemove)},e.prototype.dataChanged=function(){if("number"==typeof this.data){var t=this.data,e=bookControl.getBookById(t),i=DataCenter.ins().BookDecomposeConfig[t],n=e.level>-1?e.level:0,o=DataCenter.ins().BookConfig[t][n],s=e.getState();this.quality0.source=this.quality1.source=this.quality2.source=this.quality3.source="book_"+i.quality+"c",this.quality.source="book_"+i.quality+"a",this.quality4.source="book_"+i.quality+"b",this.setStar(n);var r=BackpackControl.getAttrPower(o.attrs);if(r=bookControl.getBookPowerNum(r,i.id),this.pown?BitmapNumber.ins().changeNum(this.pown,r,"8",5):this.pown=BitmapNumber.ins().createNumPic(r,"8",5),this.pownGP.addChild(this.pown),this.rect.visible=!1,this.noActiveImg.visible=!1,this.maxImg.visible=!1,this.canActImg.visible=!1,e.level==bookControl.getMaxLevel(t))this.maxImg.visible=!0,this.redPoint.visible=!1,this.imgBox.source=i.imgLight;else switch(this.imgBox.source=i.imgLight,s){case 0:this.redPoint.visible=!1,this.rect.visible=!0,this.canActImg.visible=!0;break;case 1:var a=e.getNextLevelCost();this.redPoint.visible=a&&bookControl.score>=a;break;case 2:this.redPoint.visible=!1,this.rect.visible=!0,this.noActiveImg.visible=!0}this.labelName.text=i.name,this.labelName.textColor=LangMgr.getColor("qualityColor"+i.quality)}},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),egret.Tween.removeTweens(this.canActImg)},e.prototype.setRemoveTween=function(t){t&&egret.Tween.removeTweens(this.canActImg)},e.prototype.setStar=function(t){for(var e=t;10>e;e++)this["imgStar"+e].visible=!1;for(var i=DataCenter.ins().BookConfig[this.data],e=0;t>e;e++){this["imgStar"+e]&&(this["imgStar"+e].visible=!0);var n=e-10*(e/10>>0);this["imgStar"+n]&&i&&i[e].showIcon&&(this["imgStar"+n].source=i[e+1].showIcon)}},e}(BaseItemRender);__reflect(BookItemRenderer.prototype,"BookItemRenderer");var BookListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.isShow=!1,e.skinName="BookListItemRendererSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.label.touchEnabled=!1},e.prototype.dataChanged=function(){var t=this.data;this.label.text=""+t.name,this.btnName.source=""+t.icon,this.idList=t.idList,this.checkRedPoint()},e.prototype.checkRedPoint=function(){for(var t=0,e=this.idList;t<e.length;t++){var i=e[t];if(bookControl.getBookUpRedByListId(i)||bookControl.getSuitRedPoint(i))return void(this.redPoint.visible=!0)}this.redPoint.visible=!1},e}(BaseItemRender);__reflect(BookListItemRenderer.prototype,"BookListItemRenderer");var BookSuitTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="BookSuitTipsItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.config;this.jieduan.text=t.level+LangMgr.getValueByKey("osaLevelJ"),this.num.text=t.count+"",this.suitNum.text=this.data.curNum+"/"+t.count;for(var e=0;e<t.attrs.length;e++){var i=AttributeData.getAttrStrByType(t.attrs[e].type);this["value"+e].text=i+"+"+t.attrs[e].value,this.data.curNum>=t.count&&(this["value"+e].textColor=LangMgr.getColor("color38"))}this.data.curNum>=t.count&&(this.suitNum.textColor=LangMgr.getColor("color38"))},e}(BaseItemRender);__reflect(BookSuitTipsItemRenderer.prototype,"BookSuitTipsItemRenderer");var BossAutoChallengeControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(296,e.checkEnter),e.addCustomEvent(445,e.delayCheckEnter),e.addCustomEvent(353,function(){0==MapControl.copyId&&e.checkEnter()}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.refBossTimeFun=function(){TimerMgr.ins().remove(this.refTimes,this),this.refType=2;var t=bossControl.worldBossrestoreTime[this.refType];t>bossControl.worldBossrestoreTime[4]&&(this.refType=4,t=bossControl.worldBossrestoreTime[this.refType]);var e=t-egret.getTimer();e>0&&TimerMgr.ins().doTimer(e,1,this.refTimes,this)},e.prototype.refTimes=function(){bossControl.upWorldBossInfo(this.refType)},e.prototype.delayCheckEnter=function(t){t[0]&&TimerMgr.ins().doTimer(1e3,2,this.checkEnter,this)},e.prototype.checkEnter=function(){if(bossControl.worldInfoList&&0==MapControl.copyId){var t=[],e=[],i=bossControl.worldInfoList[2];if(i&&this.autoPublicBoss&&bossControl.worldBossLeftTime[2])for(var n=0,o=i;n<o.length;n++){var s=o[n],r=DataCenter.ins().WorldBossConfig[s.id];BossControl.isCanChallenge(r)&&(r.samsaraLv?t.push(s):e.push(s))}t=t.sort(this.compareFn);for(var a=0;a<t.length;a++){var s=t[a];if(s.canChallenge&&bossControl.getBossRemindByIndex(s.id))return void this.enterFb(s.id,2)}if(bossControl.worldInfoList[4]&&this.autoHolyAreaBoss&&bossControl.worldBossLeftTime[4]){var l=bossControl.worldInfoList[4].slice();l=l.sort(this.compareFn);for(var a=0;a<l.length;a++){var s=l[a];if(s.canChallenge&&bossControl.getBossRemindByIndex(s.id))return void this.enterFb(s.id,4)}}e=e.sort(this.compareFn);for(var a=0;a<e.length;a++){var s=e[a];if(s.canChallenge&&bossControl.getBossRemindByIndex(s.id))return void this.enterFb(s.id,2)}}},e.prototype.enterFb=function(t,e){var i=bossControl.worldBossCd[e]-egret.getTimer();i>0?TimerMgr.ins().doTimer(i,1,this.checkEnter,this):(bossControl.dispatchBossData(!1),bossControl.challengWorldBoss(t,e))},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return n.zsLevel!=i.zsLevel?n.zsLevel-i.zsLevel:n.level-i.level},e}(BaseSystem);__reflect(BossAutoChallengeControl.prototype,"BossAutoChallengeControl");var BossControl=function(t){function e(){var e=t.call(this)||this;return e.worldBossLeftTime=[],e.worldChallengeTime=[],e.worldBossCd=[],e.worldBossrestoreTime=[],e.worldBossBelongTime=[],e.worldBossBelongBuyTime=[],e.curShield=0,e.totalShield=0,e.shieldType=0,e.curShieldFbID=0,e.worldInfoList=[],e.worldBossPlayList=[],e.rankList=[],e._monsterID=0,e.hp=0,e.bossHandler=0,e.lastBossID=-1,e.rank=[],e.isDelayShowResultView=!1,e.challengeCount=0,e.restoreTime=0,e.toDaySoul=0,e.cdTime=0,e.bossRemind=0,e.autoClear=[!1,!1,!1],e.showTip=!0,e.currBossSubType=0,e.currBossConfigID=0,e.newWorldBossData=new NewWorldBossVo,e.hideBossData={id:0,endTime:0,lastId:0},e.subTypeToFbType={1:10,2:7,3:17,4:105,5:26,6:27,7:36,8:44,10:50,11:57,12:61},e.huDunTimeDic={},e.worldPrize=0,e._reliveTime=0,e.killerHandler=0,e.winner="",e.bossAlertList=[],e.threatList=[],e.canPlayList=[],e.belongName="",e.attHandle=0,e.canClick=!0,e.addCustomEvent(353,e.checkShow),e.addCustomEvent(355,e.checkOpenBossBlood),e.addCustomEvent(356,e.checkRemoveEntity),e.addCustomEvent(112,e.dispatchUpdateWorldPlayList),e.addCustomEvent(461,e.dispatchUpdateWorldPlayList),e.addCustomEvent(466,e.kfInit),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.newWorldBossData.isOpen=!1,this.newWorldBossData.startTime=0,this.init()},Object.defineProperty(e.prototype,"monsterID",{get:function(){return this._monsterID},set:function(t){if(this._monsterID=t,t){var e=DataCenter.ins().MonstersConfig[t];e&&Assert(e.head,LangMgr.getValueByKey("monHeadEmpty")+"ID:"+t+",name:"+e.name+",fbType:"+MapControl.copyType+",fbID:"+MapControl.copyId+",lastType:"+MapControl.lastCopyTyp+",lastID:"+MapControl.lastCopyId)}},enumerable:!0,configurable:!0}),e.prototype.getSubTypeByFbType=function(t){for(var e in this.subTypeToFbType)if(this.subTypeToFbType[e]==t)return+e;return 0},e.prototype.checkIsOpenMult=function(t){var e=this.getSubTypeByFbType(t||MapControl.copyType);return e?CommonFun.getWorldBossMultNum(e)>1:!1},e.prototype.checkOpenBossBlood=function(t){var e=t[0],i=t[1],n=e.infoModel.configID;n&&n==this.monsterID&&10!=MapControl.copyType&&7!=MapControl.copyType&&105!=MapControl.copyType&&17!=MapControl.copyType&&31!=MapControl.copyType&&46!=MapControl.copyType&&47!=MapControl.copyType&&62!=MapControl.copyType&&19!=MapControl.copyType&&(this.hp=i,i>0?UIMgr.ins().open(BossBloodView):UIMgr.ins().close(BossBloodView))},e.prototype.dispatchHpChange=function(){EventMgr.ins().dispatch(444)},e.prototype.dispatchBossData=function(t,e,i,n){void 0===e&&(e=""),void 0===i&&(i=0),void 0===n&&(n=0),EventMgr.ins().dispatch(445,[t,e,i,n])},e.prototype.upWorldBossInfo=function(t){return[t]},e.prototype.downWorldBoss=function(t,e,i,n,o,s,r,a){var l=this.worldInfoList[t]=this.worldInfoList[t]||[];this.worldBossPlayList[t]=[],this.worldBossrestoreTime[t]=[],this.worldBossCd[t]=1e3*e+egret.getTimer(),this.worldBossLeftTime[t]=i,l.length=n.length;for(var h=0;h<n.length;h++){var u=l[h]||new WorldBossItemVo;u.init(n[h]),l[h]=u}this.worldBossrestoreTime[t]=1e3*o+egret.getTimer(),this.worldChallengeTime[t]=s,this.worldBossBelongTime[t]=r,this.worldBossBelongBuyTime[t]=a,this.updateBossPlayList(t),(2==t||4==t)&&bossAutoChallengeControl.refBossTimeFun(),EventMgr.ins().dispatch(296,t)},e.prototype.updateBossPlayList=function(t){var e=bossControl.worldInfoList[t].slice(),i=this.worldBossPlayList[t];for(var n in e){var o=DataCenter.ins().WorldBossConfig[e[n].id];if(o)if(2==t)reincarnateControl.lv>=o.zsLevel&&ActorControl.level>=o.level&&i.push(e[n]);else if(1==t)-1!=o.zslook.indexOf(reincarnateControl.lv)&&ActorControl.level>=o.level&&i.push(e[n]);else if(3==t){var s=void 0;for(var r in DataCenter.ins().BossHomeConfig)if(-1!=DataCenter.ins().BossHomeConfig[r].boss.lastIndexOf(e[n].id)){s=DataCenter.ins().BossHomeConfig[r];break}s&&vipControl.lv>=s.vip&&reincarnateControl.lv>=o.zsLevel&&ActorControl.level>=o.level&&i.push(e[n])}else 4==t?reincarnateControl.lv>=o.zsLevel&&ActorControl.level>=o.level&&i.push(e[n]):5==t||6==t?e[n].canInto&&i.push(e[n]):7==t?e[n].canInto&&i.push(e[n]):(11==t||12==t)&&i.push(e[n])}},e.prototype.dispatchUpdateWorldPlayList=function(){for(var t in this.worldInfoList){var e=+t;this.worldBossPlayList[e]=[],this.updateBossPlayList(e)}EventMgr.ins().dispatch(699)},e.prototype.downShieldPer=function(t,e,i,n){this.shieldType=t,this.curShield=e,this.totalShield=i,this.curShieldFbID=MapControl.copyId;var o=this.curShield==this.totalShield;if(o){var s="";n?(s=LangMgr.getValueByKey("customBossLuckly"),tipsControl.showSceneTips(s)):(s=LangMgr.getValueByKey("customBossBlood"),tipsControl.showSceneTips(s))}this.dispatchShieldPer()},e.prototype.dispatchShieldPer=function(){EventMgr.ins().dispatch(297)},e.prototype.clearCD=function(){18==MapControl.copyType?copyControl.upGuideFbAlive():20==MapControl.copyType?toseongControl.upRevival():MapControl.copyId==DataCenter.ins().CampWarConfig.fbId?campWarControl.upReLive():MapControl.copyId==DataCenter.ins().BlisterConfig.fbId?blisterControl.upReLive():19==MapControl.copyType?this.upNewBossBuyRelive():this.upClearCD()},e.prototype.upClearCD=function(){},e.prototype.downClearCD=function(t){tipsControl.showTips(t?LangMgr.getValueByKey("customBossCleanCD"):LangMgr.getValueByKey("customBossEndCD"))},e.prototype.challengWorldBoss=function(t,e){var i=this;warnControl.showDangerWarn(function(){i.upChallengWorldBoss(t,e)})},e.prototype.upChallengWorldBoss=function(t,e){return this.currBossSubType=e,this.currBossConfigID=t,[t]},e.prototype.downLottery=function(t){this.worldPrize=t,UIMgr.ins().open(WorldBossRewardView)},e.prototype.upJoinLottery=function(){},e.prototype.downLotteryRan=function(t){this.dispatchLotteryRan(t)},e.prototype.dispatchLotteryRan=function(t){EventMgr.ins().dispatch(298,t)},e.prototype.upChallengRank=function(t){return this.currBossSubType=t,[t]},e.prototype.downLotteryResult=function(t,e){this.dispatchLotteryResult(t,e)},e.prototype.dispatchLotteryResult=function(t,e){EventMgr.ins().dispatch(299,[t,e])},e.prototype.downBossBlood=function(t,e,i,n,o){if(this.monsterID=t,this.hp=e,crazybtplayCopyControl.isShenwujindi||totemBossControl.inCopy)return!1;this.hp&&this.monsterID!=this.lastBossID&&2!=MapControl.copyType&&9!=MapControl.copyType&&16!=MapControl.copyType&&18!=MapControl.copyType&&this.dispatchBossAppear(),this.lastBossID=this.monsterID,this.hp<=0&&(this.lastBossID=-1),this.bossHandler=i,this.rank.length=o.length;for(var s=0;s<o.length;s++)this.rank[s]=this.rank[s]||new WorldBossRankItemVo,this.rank[s].init(o[s]),this.rank[s].rank=s+1;this.dispatchHpChange(),UIMgr.ins().isShow(BossBloodView)||10==MapControl.copyType||7==MapControl.copyType||105==MapControl.copyType||17==MapControl.copyType||31==MapControl.copyType||46==MapControl.copyType||74==MapControl.copyType||70==MapControl.copyType||19==MapControl.copyType||UIMgr.ins().open(BossBloodView),(!this.hp||this.hp<=0&&unionWarControl.getModel().checkinAppoint(1))&&UIMgr.ins().close(BossBloodView)},e.prototype.dispatchBossAppear=function(){EventMgr.ins().dispatch(300,this.monsterID)},e.prototype.dispatchBossDisappear=function(t){this.bossHandler=0,EventMgr.ins().dispatch(301,t)},e.prototype.downUpdatePerInfo=function(t,e){return this.worldBossCd[this.currBossSubType]=1e3*t+egret.getTimer(),this.worldBossLeftTime[this.currBossSubType]=e,[this.worldBossCd,this.worldBossLeftTime]},e.prototype.downBelongChange=function(t,e,i){this.dispatchBelongChange(t,e,i)},e.prototype.dispatchBelongChange=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=""),this.changecanPlayList(t),this.attHandle=t,UnitShowMgr.ins().showHideSomeOne(t),t>0){var n=UnitMgr.ins().getMasterList(t),o="";if(n&&n[0]&&n[0].infoModel){o=n[0].infoModel.name,this.setBelongHPandColor();var s="";if(t>0&&e>0){var r=o,a=r.split("\n");r=a[1]?a[1]:a[0];var l=i;a=l.split("\n"),l=a[1]?a[1]:a[0],l=StringUtils.replaceStr(l,"0xffffff",ColorUtils.GREEN+""),s=LangMgr.getValueByKey("customWinBoss",ColorUtils.GREEN,r,ColorUtils.GREEN,l),tipsControl.showSceneTips(s)}}}EventMgr.ins().dispatch(302)},e.prototype.downAttackList=function(t){this.threatList=[];for(var e=0;e<t.length;e++){var i=UnitMgr.ins().getRootMasterHandle(t[e]);this.changeThreatList(i)}this.dispatchHasAttackChange(0)},e.prototype.downKillNotice=function(t,e,i){var n=DataCenter.ins().WorldBossKillMsgConfig[i].msg;n=StringUtils.substitute(n,t,e),tipsControl.showSceneTips(n)},e.prototype.downRemainTime=function(t,e){this.reliveTime=t,this.killerHandler=e,this.reliveTime>0&&this.clearWorldBossList(),EventMgr.ins().dispatch(305)},e.prototype.setBelongHPandColor=function(){if(this.attHandle!=ActorControl.handle){var t=UnitMgr.ins().getMasterList(this.attHandle);for(var e in t)t[e]instanceof UnitRole&&t[e].setNameTxtColor(ColorUtils.YELLOW)}},e.prototype.downWorldBossEndTime=function(t){this.winner=t;var e=6e4;godWeaponBossControl.isGwBoss?e=3e4:(darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss)&&(e=1e4),this.worldBossEndTime=egret.getTimer()+e,this.clearWorldBossList(),EventMgr.ins().dispatch(306)},e.prototype.downWorldNotice=function(t,e){var i=ActorControl.level,n=reincarnateControl.lv;if(2==t){var o=bossControl.worldInfoList[t];for(var s in o){var r=DataCenter.ins().WorldBossConfig[e];if(o[s].id==e&&this.getBossRemindByIndex(e)&&n>=r.zsLevel&&i>=r.level){var a=DataCenter.ins().MonstersConfig[r.bossId];o[s].hp=100,o[s].bossState=1;var l=this.worldBossPlayList[t];for(var h in l)if(l[h]&&l[h].id==e){l[h].hp=100,l[h].bossState=1;break}var u=LangMgr.getValueByKey("customShowPos",a.name);rambleControl.dispatchSysChatMsg(new RambleSystemVo(3,u)),bossControl.worldBossLeftTime[t]&&this.dispatchBossData(!0,a.name,1,r.bossId);break}}}else if(3==t){var r=DataCenter.ins().WorldBossConfig[e],a=DataCenter.ins().BossHomeConfig[e];if(a&&n>=r.zsLevel&&i>=r.level&&vipControl.lv>=a.vip){var o=bossControl.worldInfoList[t],l=this.worldBossPlayList[t],p=a.boss;for(var s in o)-1!=p.lastIndexOf(o[s].id)&&(o[s].hp=100,o[s].bossState=1);for(var h in l)-1!=p.lastIndexOf(l[h].id)&&(l[h].hp=100,l[h].bossState=1);var u=LangMgr.getValueByKey("customPassDay",e);rambleControl.dispatchSysChatMsg(new RambleSystemVo(3,u)),bossControl.worldBossLeftTime[t]&&this.dispatchBossData(!0,LangMgr.getValueByKey("customBossHome"),4)}}else if(4==t){var o=bossControl.worldInfoList[t];for(var s in o){var r=DataCenter.ins().WorldBossConfig[e];if(o[s].id==e&&this.getBossRemindByIndex(e)&&n>=r.zsLevel&&i>=r.level){var a=DataCenter.ins().MonstersConfig[r.bossId];o[s].hp=100,o[s].bossState=1;var l=this.worldBossPlayList[t];for(var h in l)if(l[h]&&l[h].id==e){l[h].hp=100,l[h].bossState=1;break}var u=LangMgr.getValueByKey("customBossSY",a.name);rambleControl.dispatchSysChatMsg(new RambleSystemVo(3,u)),bossControl.worldBossLeftTime[t]&&this.dispatchBossData(!0,a.name,3,r.bossId);break}}}else if(5==t||6==t){var o=bossControl.worldInfoList[t];for(var s in o){var r=DataCenter.ins().WorldBossConfig[e];if(o[s].id==e){var a=DataCenter.ins().MonstersConfig[r.bossId];o[s].hp=100,o[s].bossState=1;var l=this.worldBossPlayList[t];for(var h in l)if(l[h]&&l[h].id==e){l[h].hp=100,l[h].bossState=1;break}break}}}else if(7==t){var o=bossControl.worldInfoList[t];for(var s in o){var r=DataCenter.ins().WorldBossConfig[e];if(o[s].id==e){var a=DataCenter.ins().MonstersConfig[r.bossId];o[s].hp=100,o[s].bossState=1;var l=this.worldBossPlayList[t];for(var h in l)if(l[h]&&l[h].id==e){l[h].hp=100,l[h].bossState=1;break}if(o[s].canInto){var u=LangMgr.getValueByKey("customBossAY",a.name);rambleControl.dispatchSysChatMsg(new RambleSystemVo(3,u)),bossControl.worldBossLeftTime[t]&&this.dispatchBossData(!0,a.name,2)}break}}}else if(8==t||10==t||11==t||12==t){var o=bossControl.worldInfoList[t];for(var s in o){var r=DataCenter.ins().WorldBossConfig[e];if(o[s].id==e&&this.getBossRemindByIndex(e)){var a=DataCenter.ins().MonstersConfig[r.bossId];o[s].hp=100,o[s].bossState=1;var l=this.worldBossPlayList[t];for(var h in l)if(l[h]&&l[h].id==e){l[h].hp=100,l[h].bossState=1;break}if(o[s].canInto){var c=LangMgr.getValueByKey("darkBoss");10==t?c=LangMgr.getValueByKey("zhuzaiBoss"):11==t?c=LangMgr.getValueByKey("bazhuBoss"):12==t&&(c=LangMgr.getValueByKey("mojieBoss"));var u=LangMgr.getValueByKey("bossAppearTip",a.name,c);rambleControl.dispatchSysChatMsg(new RambleSystemVo(3,u)),(12==t&&this.worldBossBelongTime[t]||12!=t&&this.worldBossLeftTime[t])&&this.dispatchBossData(!0,a.name,12!=t?2:4)}bossControl.upWorldBossInfo(t);break}}}EventMgr.ins().dispatch(307)},e.prototype.downChallageRank=function(t,e){for(var i,n=[],o=0;o<e.length;o++)n[o]=[],i=e[o][0],n[o][0]=DateUtils.getFormatBySecond(DateUtils.formatMiniDateTime(i)/1e3,6),n[o][1]=e[o][1],n[o][2]=e[o][2].toString(),n[o][3]="1";return n.reverse(),[t,n]},e.prototype.downBossChallengeResult=function(t,e,i,n,o){for(var s=this,r=[],a=0;a<o.length;a++)r[a]=new RewardVo,r[a].init(o[a]);var l,h=UnitMgr.ins().getMasterList(this.attHandle);h&&(l=h[0]);var u="yuanhead"+(i||1)+n,p=bossControl.isDelayShowResultView;bossControl.isDelayShowResultView=!1;var c=[t,e,u,l],d=function(){p?TimerMgr.ins().once(2e3,function(){resultControl.create(MapControl.copyType,!0,r,"",null,c)},s):resultControl.create(MapControl.copyType,!0,r,"",null,c)};reincarnateStarBossControl.isInFb?CommonFun.dropEff(r,l,d):d(),d(),EventMgr.ins().dispatch(8,c)},e.prototype.setBossSetting=function(t,e){if(!isNaN(t)){var i=this.bossAlertList.indexOf(t);e?-1==i&&this.bossAlertList.push(t):i>-1&&this.bossAlertList.splice(i,1)}},e.prototype.upBossSetting=function(){return[this.bossAlertList]},e.prototype.downBossSetting=function(t){this.bossAlertList=[];for(var e=0;e<t.length;e++)this.bossAlertList.push(t[e])},e.prototype.checkNewWorldBossOpen=function(){return ActorControl.level>=DataCenter.ins().NewWorldBossBaseConfig.openLv},e.prototype.upIntoNewBoss=function(){},e.prototype.downNewBossResult=function(t,e,i,n,o,s){this.newWorldBossData.isKill=!!t,this.newWorldBossData.rank=e,this.newWorldBossData.lastKillRoleName=i,this.newWorldBossData.randomRoleName=n,this.newWorldBossData.totalTime=o,this.newWorldBossData.randomAwards=[];for(var r=0;r<s.length;r++)this.newWorldBossData.randomAwards[r]=new RewardVo,this.newWorldBossData.randomAwards[r].init(s[r]);resultControl.create(MapControl.copyType,1)},e.prototype.upGetNewBossInfo=function(){},e.prototype.downNewBossInfo=function(t,e){this.newWorldBossData.bossID=t,this.newWorldBossData.curHp=e,EventMgr.ins().dispatch(308)},e.prototype.upNewBossBuyRelive=function(){},e.prototype.downNewBossReliveTime=function(t){this.reliveTime=t,EventMgr.ins().dispatch(309)},e.prototype.downNewBossOpen=function(t,e){this.newWorldBossData.isOpen=!!t,this.newWorldBossData.startTime=e,this.newWorldBossData.startTime&&(this.newWorldBossData.startTime=DateUtils.formatMiniDateTime(this.newWorldBossData.startTime)),EventMgr.ins().dispatch(310)},e.prototype.downAddAttrNum=function(t){this.newWorldBossData.addAttrNum=t,EventMgr.ins().dispatch(311)},e.prototype.downNewBossRank=function(t){null==this.newWorldBossData.rankList&&(this.newWorldBossData.rankList=[]),this.newWorldBossData.rankList.length=t.length;for(var e=0;e<t.length;e++)this.newWorldBossData.rankList[e]=this.newWorldBossData.rankList[e]||new NewWorldBossRankVo,this.newWorldBossData.rankList[e].init(t[e]);this.newWorldBossData.rankList.sort(this.sortNewBossRank),EventMgr.ins().dispatch(312)},e.prototype.sortNewBossRank=function(t,e){return e.value-t.value},e.prototype.upBuyBelongNum=function(t){return[t]},e.prototype.downBossDieNotice=function(t){var e=DataCenter.ins().WorldBossConfig[t];if(e)switch(e.type){case 1:case 2:case 7:case 5:case 4:case 6:case 8:case 10:case 11:case 12:var i=DataCenter.ins().MonstersConfig[e.bossId];bossControl.dispatchBossData(!1,i.name),this.upWorldBossInfo(e.type);break;case 3:bossControl.dispatchBossData(!1,LangMgr.getValueByKey("customBossHome")),this.upWorldBossInfo(e.type)}},e.prototype.upBuyChallengeTimes=function(t){return[t]},e.prototype.upBuyAddAttrNum=function(){},e.prototype.getBossRemindByIndex=function(t){return-1!=this.bossAlertList.indexOf(t)},e.prototype.upCleanBelong=function(){},e.prototype.upChallengeHideBoss=function(){},e.prototype.downBaseHideBossInfo=function(t,e){this.hideBossData.id=t,this.hideBossData.endTime=e,EventMgr.ins().dispatch(313)},e.prototype.downHuDunInfo=function(t,e,i){this.huDunTimeDic[t]={time:e,endTime:i},EventMgr.ins().dispatch(314)},e.prototype.showHuDun=function(t){if(!this.huDunTimeDic[t])return!1;var e=this.huDunTimeDic[t].endTime-this.huDunTimeDic[t].time,i=DateUtils.formatMiniDateTime(this.huDunTimeDic[t].time);return Math.floor((GameServer.serverTime-i)/DateUtils.MS_PER_SECOND)<e?!0:!1},e.prototype.checkWorldBossMoney=function(){return ActorControl.yb>=this.checkWorldBossNeed()},e.prototype.checkWorldBossNeed=function(){return 18==MapControl.copyType?DataCenter.ins().LeadFubenBaseConfig.BuyRebornCost:20==MapControl.copyType?DataCenter.ins().ToseongBaseConfig.BuyRebornCost:19==MapControl.copyType?DataCenter.ins().NewWorldBossBaseConfig.clearCdCost:MapControl.copyId==DataCenter.ins().CampWarConfig.fbId?DataCenter.ins().CampWarConfig.buyRebornCdCost:MapControl.copyId==DataCenter.ins().BlisterConfig.fbId?DataCenter.ins().BlisterConfig.buyRebornCdCost:DataCenter.ins().WorldBossBaseConfig.clearCdCost[this.currBossSubType-1]},e.prototype.checkisAutoRelive=function(){if(this.reliveTime>0){if(this.autoClear[this.currBossSubType]){if(this.checkWorldBossMoney())return this.clearCD(),!1;tipsControl.showTips(LangMgr.getValueByKey("customBossNoYB")),this.autoClear[this.currBossSubType]=!1}return!0}return!1},Object.defineProperty(e.prototype,"reliveTime",{get:function(){return this._reliveTime},set:function(t){this._reliveTime!=t&&(this._reliveTime=t,TimerMgr.ins().remove(this.timeClock,this),TimerMgr.ins().doTimer(1e3,this._reliveTime,this.timeClock,this))},enumerable:!0,configurable:!0}),e.prototype.timeClock=function(){this._reliveTime--,this._reliveTime<=0&&TimerMgr.ins().remove(this.timeClock,this)},e.prototype.checkShow=function(){var t=MapControl.copyId;isNaN(t)||(MapControl.copyId!=MapControl.lastCopyId&&(this.lastBossID=-1),0!=t&&1!=MapControl.copyType?19==MapControl.copyType&&MapControl.copyId==DataCenter.ins().NewWorldBossBaseConfig.fbId?UIMgr.ins().open(NewWorldBossUIView):i.isBossFb()?UIMgr.ins().open(WorldBossUiInfoView):31==MapControl.copyType?UIMgr.ins().open(LastEighthBossView):41==MapControl.copyType?UIMgr.ins().open(DemonSceneView):77==MapControl.copyType&&UIMgr.ins().open(SpokesPersonBossFightView):(UIMgr.ins().close(WorldBossUiInfoView),UIMgr.ins().close(WorldBossBeKillView),UIMgr.ins().close(NewWorldBossUIView),UIMgr.ins().close(LastEighthBossView),UIMgr.ins().close(DemonSceneView),UIMgr.ins().close(SpokesPersonBossFightView)))},e.prototype.checkRelive=function(){if(godWeaponBossControl.isRoleDie()){if(this.checkWorldBossMoney())return!0;tipsControl.showTips(LangMgr.getValueByKey("customBossNoYB")),this.autoClear[this.currBossSubType]=!1}return!1},e.prototype.checkRemoveEntity=function(t){var e=t[0],i=t[1],n=i.infoModel;if(n&&0!=n.team&&1==n.type&&n.masterHandle){var o=n.masterHandle;UnitMgr.ins().getMasterList(o)||UnitShowMgr.ins().showNearSomeOne()}n&&e==this.bossHandler&&this.dispatchBossDisappear(i)},e.prototype.getRankList=function(t){return this.rankList[t]},e.prototype.init=function(){this.upWorldBossInfo(1),this.upWorldBossInfo(2),this.upWorldBossInfo(3),this.upWorldBossInfo(4),this.upWorldBossInfo(5),this.upWorldBossInfo(6),this.upWorldBossInfo(7),this.upWorldBossInfo(12)},e.prototype.kfInit=function(){GameServer.kfServerIDSmall&&(this.upWorldBossInfo(8),this.upWorldBossInfo(10),this.upWorldBossInfo(20),totemBossControl.upBossInfo())},e.prototype.changeThreatList=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=""),ActorControl.handle!=t){var n=this.checkListElements(t,this.threatList);e?-1==n&&this.threatList.push(t):-1!=n&&this.threatList.splice(n,1)}},e.prototype.changecanPlayList=function(t,e){void 0===e&&(e=!0);var i;ActorControl.handle!=t?0==t?(this.canPlayList=[],this.belongName=""):(this.threatList=[],this.canPlayList[0]=t,i=UnitMgr.ins().getEntityBymasterhHandle(t),i&&(this.belongName=i.infoModel.name)):(this.threatList=[],this.canPlayList=[],this.belongName=ActorControl.myName),this.dispatchHasAttackChange(0),this.dispatchCanplayChange()
},e.prototype.checkListElements=function(t,e){if(e.length<=0)return-1;for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},e.prototype.dispatchHasAttackChange=function(t){EventMgr.ins().dispatch(303,t)},e.prototype.dispatchCanplayChange=function(){EventMgr.ins().dispatch(304)},e.prototype.clearWorldBossList=function(){10==MapControl.copyType||7==MapControl.copyType||105==MapControl.copyType||17==MapControl.copyType||18==MapControl.copyType||26==MapControl.copyType||27==MapControl.copyType||36==MapControl.copyType||44==MapControl.copyType||61==MapControl.copyType?(this.threatList=[],this.canPlayList=[],gameControl.currAttackHandle=0):(bossControl.winner="",copyControl.guideBossKill=0)},e.prototype.checkBossIconShow=function(){return SwitchMgr.ins().checkOpen(11)&&!copyControl.pkGqboss},e.prototype.checkHolyAreaOpen=function(){return GameServer.serverOpenDay>=DataCenter.ins().WorldBossBaseConfig.shenyuOpenDay-1},e.prototype.checkBossOpen=function(t){if(1==t){if(reincarnateControl.lv<1)return!1}else if(7==t){if(reincarnateControl.lv<DataCenter.ins().WorldBossBaseConfig.canSennDarkBoss||GameServer.serverOpenDay<DataCenter.ins().WorldBossBaseConfig.canSeeDarkBossDay-1)return!1}else{if(8==t)return darkHallBossControl.checkOpen();if(4==t)return this.checkHolyAreaOpen()}return!0},e.prototype.checkWorldBossRedPoint=function(t){if(!this.checkBossOpen(t))return!1;var e=this.worldBossPlayList[t];if(!e)return!1;if((8==t||12==t)&&!this.worldBossBelongTime[t])return!1;if(3!=t&&8!=t&&(!this.worldBossLeftTime||this.worldBossLeftTime.length<0||!this.worldBossLeftTime[t]))return!1;if((2==t||4==t||12==t||7==t||8==t)&&this.bossAlertList&&this.bossAlertList.length){for(var i=!0,n=this.worldInfoList[t].slice(),o=1e3*reincarnateControl.lv+ActorControl.level,s=0;s<n.length;s++){var r=n[s],a=(r.relieveTime-egret.getTimer())/1e3>0||r.hp<=0;if(!a){var l=this.getBossRemindByIndex(r.id);if(l){var h=DataCenter.ins().WorldBossConfig[r.id];if(!(2==t&&h.openTime&&GameServer.serverOpenDay<h.openTime)){var u=!0;if(h.darkforce)for(var p=darkEquipControl.getDarkForceToTal(darkEquipControl.darkEquips),c=0;c<h.darkforce.length;c++){var d=h.darkforce[c];if(p[d.type-1]<d.value){u=!1;break}}var g=r.checkVip();if(h.samsaraLv){if(ActorControl.samsaraLv>=h.samsaraLv&&u&&g){i=!1;break}}else{var m=1e3*h.zsLevel+h.level;if(o>=m&&u&&g){i=!1;break}}}}}}return!i}if(5==t){for(var f=0,v=e;f<v.length;f++){var y=v[f];if(this.worldBossBelongTime[t]>0&&y.canChallenge&&this.getBossRemindByIndex(y.id))return!0}return!1}if(6==t){for(var C=0,T=e;C<T.length;C++){var y=T[C];if(y.canChallenge&&this.getBossRemindByIndex(y.id)){var w=DataCenter.ins().WorldBossBaseConfig.challengeItemYb[t-1];if(ActorControl.yb>=w)return!0;var I=DataCenter.ins().WorldBossBaseConfig.challengeItem[t-1],b=backpackControl.getBagGoodsByTypeAndId(0,I);if(b&&b.count)return!0}}return!1}for(var D=e.length,s=0;D>s;s++)if(2!=e[s].bossState)return!0;return!1},Object.defineProperty(e.prototype,"clickTime",{set:function(t){this.canClick=!1,this._clickTime=t,TimerMgr.ins().remove(this.endTimeChangeStatu,this),TimerMgr.ins().doTimer(500,this._clickTime,this.endTimeChangeStatu,this)},enumerable:!0,configurable:!0}),e.prototype.endTimeChangeStatu=function(){--this._clickTime,this._clickTime<=0&&(this.canClick=!0,TimerMgr.ins().remove(this.endTimeChangeStatu,this))},e.prototype.getPersonalListData=function(){for(var t=CopyControl.getPersonalBossFbIds().slice(),e=[],i=[],n=[],o=0,s=t;o<s.length;o++){var r=s[o],a=copyControl.getFbDataById(r.id);if(a){var l=a.getPlayCount()<=0;if(l)e.push(r);else if(r.monthcard)payControl.monthDay>0?i.unshift(r):n.push(r);else if(r.specialCard)payControl.franchise?i.unshift(r):n.push(r);else if(r.privilege)payControl.getIsForeve()?i.unshift(r):n.push(r);else{var h=1e3*reincarnateControl.lv+ActorControl.level,u=1e3*r.zsLevel+r.levelLimit;h>=u?i.push(r):n.push(r)}}}return[i,n,e]},e.prototype.getGwBossList=function(){for(var t=bossControl.worldInfoList[5].concat(),e=bossControl.worldInfoList[6].concat(),i=0;i<e.length;i++){var n=e[i];DataCenter.ins().WorldBossConfig[n.id];if(n.canInto){t.push(e[i]);break}}return t},e.prototype.checkShowAsist=function(t){var e=DataCenter.ins().InstanceBaseConfig.asistOpen,i=GameServer.serverOpenDay+1;for(var n in e)if(i>=+n&&e[n].indexOf(t)>=0)return!0;return!1},e.prototype.getAsistText=function(){return LangMgr.getValueByKey("leftAssistTime")+"："+this.getAsistCountText()},e.prototype.getAsistCountText=function(){var t=crossBossControl.assistTimes,e=t>0?ColorUtils.GREEN:ColorUtils.RED;return"|C:"+e+"&T:"+t+"|"},e.isCanChallenge=function(t){var e;if(t.samsaraLv>0)e=ActorControl.samsaraLv>=t.samsaraLv;else{var i=1e3*reincarnateControl.lv+ActorControl.level,n=1e3*t.zsLevel+t.level;e=i>=n}return e},e.isBossFb=function(){return 10==MapControl.copyType||7==MapControl.copyType||105==MapControl.copyType||17==MapControl.copyType||18==MapControl.copyType&&40001!=MapControl.copyId},e.WB_BAG_ENOUGH=50,__decorate([up(10,[3])],e.prototype,"upWorldBossInfo",null),__decorate([down(10,[1,2,2,ByteConst.WorldBossItemVos,2,2,2,2])],e.prototype,"downWorldBoss",null),__decorate([down(11,[1,3,3,1])],e.prototype,"downShieldPer",null),__decorate([up(14)],e.prototype,"upClearCD",null),__decorate([down(14,[1])],e.prototype,"downClearCD",null),__decorate([up(15,[3])],e.prototype,"upChallengWorldBoss",null),__decorate([down(16,[3])],e.prototype,"downLottery",null),__decorate([up(17)],e.prototype,"upJoinLottery",null),__decorate([down(17,[2])],e.prototype,"downLotteryRan",null),__decorate([up(28,[3])],e.prototype,"upChallengRank",null),__decorate([down(18,[8,2])],e.prototype,"downLotteryResult",null),__decorate([down(20,[3,10,10,10,ByteConst.WorldBossRankItemVos])],e.prototype,"downBossBlood",null),__decorate([down(21,[2,2])],e.prototype,"downUpdatePerInfo",null),__decorate([down(7,[10,10,8])],e.prototype,"downBelongChange",null),__decorate([down(23,[[10]])],e.prototype,"downAttackList",null),__decorate([down(24,[8,2,2])],e.prototype,"downKillNotice",null),__decorate([down(25,[2,10])],e.prototype,"downRemainTime",null),__decorate([down(26,[8])],e.prototype,"downWorldBossEndTime",null),__decorate([down(27,[1,3])],e.prototype,"downWorldNotice",null),__decorate([down(28,[3,[3,8,10]])],e.prototype,"downChallageRank",null),__decorate([down(29,[1,8,1,1,ByteConst.RewardVos])],e.prototype,"downBossChallengeResult",null),__decorate([up(29,[[3]])],e.prototype,"upBossSetting",null),__decorate([down(30,[[3]])],e.prototype,"downBossSetting",null),__decorate([up(31)],e.prototype,"upIntoNewBoss",null),__decorate([down(31,[1,3,8,8,3,ByteConst.RewardVos])],e.prototype,"downNewBossResult",null),__decorate([up(32)],e.prototype,"upGetNewBossInfo",null),__decorate([down(32,[3,10])],e.prototype,"downNewBossInfo",null),__decorate([up(33)],e.prototype,"upNewBossBuyRelive",null),__decorate([down(33,[2])],e.prototype,"downNewBossReliveTime",null),__decorate([down(34,[1,3])],e.prototype,"downNewBossOpen",null),__decorate([down(35,[2])],e.prototype,"downAddAttrNum",null),__decorate([down(36,[ByteConst.WorldBossRankItemVos])],e.prototype,"downNewBossRank",null),__decorate([up(37,[2])],e.prototype,"upBuyBelongNum",null),__decorate([down(37,[3])],e.prototype,"downBossDieNotice",null),__decorate([up(30,[1])],e.prototype,"upBuyChallengeTimes",null),__decorate([up(34)],e.prototype,"upBuyAddAttrNum",null),__decorate([up(35)],e.prototype,"upCleanBelong",null),__decorate([up(36)],e.prototype,"upChallengeHideBoss",null),__decorate([down(38,[3,3])],e.prototype,"downBaseHideBossInfo",null),__decorate([down(39,[10,3,3])],e.prototype,"downHuDunInfo",null),e=i=__decorate([protocolsId(10)],e);var i}(BaseSystem);__reflect(BossControl.prototype,"BossControl");var DarkMysteryBossControl=function(t){function e(){var e=t.call(this)||this;return e.isDarkBoss=!1,e.isBossDie=!1,e.addCustomEvent(353,function(){36==MapControl.copyType?e.dispatchEnterGwBoss():e.isDarkBoss&&e.dispatchEscGwBoss(),e.checkIsShowBtn()}),e.addCustomEvent(354,e.onCreateEntity),e.addCustomEvent(305,e.onDie),e.addCustomEvent(306,e.onBossDisappear),e.addCustomEvent(313,e.onHideBossAppear),e}return __extends(e,t),e.prototype.dispatchEnterGwBoss=function(){this.isDarkBoss=36==MapControl.copyType,this.isBossDie=!1,this.showView(!0)},e.prototype.dispatchEscGwBoss=function(){this.isDarkBoss=!1,this.isBossDie=!1,this.showView(!1),UIMgr.ins().close(BossEndView)},e.prototype.showView=function(t){t?(UIMgr.ins().isShow(BossBelongView)||UIMgr.ins().open(BossBelongView),UIMgr.ins().isShow(BossBloodView)||UIMgr.ins().open(BossBloodView),UIMgr.ins().isShow(TargetListView)||UIMgr.ins().open(TargetListView)):(UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView),UIMgr.ins().close(TargetListView))},e.prototype.onCreateEntity=function(t){t&&this.isDarkBoss&&(2!=t.type||1!=t.team||t.masterHandle||(bossControl.monsterID=t.configID,bossControl.bossHandler=t.handle,this.showView(!0)))},e.prototype.onDie=function(){this.isDarkBoss&&(this.isRoleDie()?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView))},e.prototype.isRoleDie=function(){return bossControl.reliveTime>0},e.prototype.onBossDisappear=function(){this.isDarkBoss&&(this.showView(!1),this.isBossDie=!0,UIMgr.ins().open(BossEndView))},e.prototype.checkIsShowBtn=function(){this.checkCanShow()&&MapControl.sceneInHook()?UIMgr.ins().isShow(HideBossBtnView)||UIMgr.ins().open(HideBossBtnView):UIMgr.ins().close(HideBossBtnView)},e.prototype.checkCanShow=function(){var t=bossControl.hideBossData.endTime;return bossControl.hideBossData.id&&t&&DateUtils.formatMiniDateTime(t)>GameServer.serverTime},e.prototype.onHideBossAppear=function(){var t=this;if(this.checkCanShow())if(this.isDarkBoss){var e=UnitMgr.ins().getEntityByHandle(bossControl.bossHandler);if(e&&e.parent){var i=ObjectPool.pop("GameMovieClip"),n=function(){UIMgr.ins().isShow(HideBossBtnView)||UIMgr.ins().open(HideBossBtnView,1),i.removeEventListener(egret.Event.REMOVED_FROM_STAGE,n,t),i.destroy()};i.playFile(PATH_EFF+"luckyboss_dragon_up",1,function(){n()}),i.x=e.x,i.y=e.y,i.addEventListener(egret.Event.REMOVED_FROM_STAGE,n,this),e.parent.addChild(i)}else UIMgr.ins().open(HideBossBtnView,1)}else UIMgr.ins().open(HideBossBtnView);else UIMgr.ins().close(HideBossBtnView)},e.prototype.canMove=function(){return!this.isBossDie},e.ins=function(){return t.ins.call(this)},e}(BaseSystem);__reflect(DarkMysteryBossControl.prototype,"DarkMysteryBossControl");var GodWeaponBossControl=function(t){function e(){var e=t.call(this)||this;return e.isGwBoss=!1,e.isGwTopBoss=!1,e.isBossDie=!1,e.addCustomEvent(353,function(){26==MapControl.copyType||27==MapControl.copyType?e.dispatchEnterGwBoss():(e.isGwBoss||e.isGwTopBoss)&&e.dispatchEscGwBoss()}),e.addCustomEvent(354,e.onCreateEntity),e.addCustomEvent(305,e.onDie),e.addCustomEvent(306,e.onBossDisappear),e}return __extends(e,t),e.prototype.dispatchEnterGwBoss=function(){this.isGwBoss=26==MapControl.copyType,this.isGwTopBoss=27==MapControl.copyType,this.isBossDie=!1,this.showView(!0)},e.prototype.dispatchEscGwBoss=function(){this.isGwBoss=!1,this.isGwTopBoss=!1,this.isBossDie=!1,this.showView(!1),UIMgr.ins().close(BossEndView)},e.prototype.showView=function(t){t?(UIMgr.ins().isShow(BossBelongView)||UIMgr.ins().open(BossBelongView),UIMgr.ins().isShow(BossBloodView)||UIMgr.ins().open(BossBloodView),UIMgr.ins().isShow(TargetListView)||UIMgr.ins().open(TargetListView)):(UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView),UIMgr.ins().close(TargetListView))},e.prototype.onCreateEntity=function(t){t&&(this.isGwBoss||this.isGwTopBoss)&&(2!=t.type||1!=t.team||t.masterHandle||(bossControl.monsterID=t.configID,bossControl.bossHandler=t.handle,this.showView(!0)))},e.prototype.onDie=function(){(this.isGwBoss||this.isGwTopBoss)&&(this.isRoleDie()?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView))},e.prototype.isRoleDie=function(){var t=!1;if(this.isGwTopBoss){var e=UnitMgr.ins().getNoDieRole();(!e||e.infoModel.getAtt(0)<=0)&&(t=!0)}return bossControl.reliveTime>0||t},e.prototype.onBossDisappear=function(){(this.isGwBoss||this.isGwTopBoss)&&(this.showView(!1),this.isBossDie=!0,UIMgr.ins().open(BossEndView))},e.prototype.canMove=function(){return!this.isBossDie},e.ins=function(){return t.ins.call(this)},e}(BaseSystem);__reflect(GodWeaponBossControl.prototype,"GodWeaponBossControl");var RecoveryPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="RecoveryPanelSkin",e}return __extends(e,t),e.prototype.open=function(){this.list0.itemRenderer=RecoveryLogItemRender,this.listData=new eui.ArrayCollection,this.list0.dataProvider=this.listData,this.updateView()},e.prototype.updateView=function(){var t=smeltControl.smeltLogs.reverse();this.listData.replaceAll(t)},e}(BasePanel);__reflect(RecoveryPanel.prototype,"RecoveryPanel");var SevenDayPanelItem2Render=function(t){function e(){var e=t.call(this)||this;return e.skinName="SevenDayPanelItem2Skin",e.addEventTouchTap(e.getBtn,e.onTouch,e),e.item.touchChildren=!0,e.item.touchEnabled=!0,e.listData=new eui.ArrayCollection,e.reward.dataProvider=e.listData,e}return __extends(e,t),e.prototype.dataChanged=function(){this.config=this.data;var t=this.config.rewards.slice(1,5);this.reward.itemRenderer=ItemBase,this.listData.replaceAll(t.concat()),this.item.data=this.config.rewards[0],this.item.hideName(),this.rewardBigName.source=this.config.itemName,this.act14DayTitle.source="name"+this.config.day+"Day";var e=this.getRemindByIndex(this.config.day);this.alreadyImg.visible=e,this.redPoint.visible=!1,this.getBtn.visible=!1;var i=this.config.day-amusementControl.dayNum;i>0?(this.needLogDay.visible=!0,this.needToLogDay.textFlow=TextUtils.generateTextFlow(1==i?LangMgr.getValueByKey("tomorrowget"):LangMgr.getValueByKey("numdyacanget",i))):(this.needLogDay.visible=!1,e||(this.redPoint.visible=!0,this.getBtn.visible=!0))},e.prototype.onTouch=function(t){this.config&&(amusementControl.dayNum>=this.config.day?amusementControl.upGetSevenDayAwards(this.config.day):tipsControl.showTips(LangMgr.getValueByKey("osaNoLoadingDay")))},e.prototype.getRemindByIndex=function(t){return 1==(amusementControl.isAwards>>t&1)},e}(BaseItemRender);__reflect(SevenDayPanelItem2Render.prototype,"SevenDayPanelItem2Render");var CdKeyPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="CdKeyPanelSkin",e.input.maxChars=28,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.sendBtn,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.sendBtn,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sendBtn:cDKeyControl.upCdkey(this.input.text)}},e}(BasePanel);__reflect(CdKeyPanel.prototype,"CdKeyPanel");var NewWorldBossRankVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(WorldBossRankItemVo);__reflect(NewWorldBossRankVo.prototype,"NewWorldBossRankVo");var NewWorldBossVo=function(){function t(){this.addAttrNum=0}return t}();__reflect(NewWorldBossVo.prototype,"NewWorldBossVo");var WorldBossItemVo=function(){function t(){this.id=0,this.roleName="",this.guildName="",this.relieveTime=0,this.bossState=0,this.hp=0,this.people=0,this.challengeing=0}return t.prototype.init=function(t){this.id=t[0],this.roleName=t[1],this.guildName=t[2],this.relieveTime=1e3*t[3]+egret.getTimer(),this.bossState=t[4],this.hp=t[5],this.people=t[6],this.challengeing=t[7]},Object.defineProperty(t.prototype,"isDie",{get:function(){return(this.relieveTime-egret.getTimer())/1e3>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canInto",{get:function(){var t=DataCenter.ins().WorldBossConfig[this.id],e=t.zsLevel;if("number"==typeof e)return e>0?reincarnateControl.lv>=DataCenter.ins().ReincarnateConfig.baseMaxZsLv&&t.thirteenzslv?reincarnateControl.lv>=e&&reincarnateStarControl.point>=t.thirteenzslv:reincarnateControl.lv>=e&&this.checkDarkforce(t):ActorControl.level>=e&&this.checkDarkforce(t);var i=e;return i.length>1?reincarnateControl.lv>=i[0]&&reincarnateControl.lv<=i[1]&&this.checkDarkforce(t):void debug.log("WorldBossConfig"+LangMgr.getValueByKey("configError")+"！ "+i)},enumerable:!0,configurable:!0}),t.prototype.checkVip=function(){var t=DataCenter.ins().WorldBossConfig[this.id];return!isNaN(t.belongvip)&&vipControl.lv<t.belongvip?!1:!0},t.prototype.checkDarkforce=function(t){if(t.darkforce)for(var e=darkEquipControl.getDarkForceToTal(darkEquipControl.darkEquips),i=0;i<t.darkforce.length;i++){var n=t.darkforce[i];if(e[n.type-1]<n.value)return!1}return!0},Object.defineProperty(t.prototype,"canChallenge",{get:function(){return!this.isDie&&this.canInto},enumerable:!0,configurable:!0}),t}();__reflect(WorldBossItemVo.prototype,"WorldBossItemVo");var AmusementType20DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.index=t[0]||1,this.timer=t[1],this.timer&&(this.timer=Math.floor(DateUtils.formatMiniDateTime(this.timer)/DateUtils.MS_PER_SECOND)),this.isGoIn=t[2]},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getleftTime=function(){if(!this.isOpenActivity())return 0;var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t},e.prototype.checkRedPoint=function(){if(this.IsEnd())return!1;var t=this.getStartTimer(),e=this.getEndTimer(),i=Math.floor(GameServer.serverTime/DateUtils.MS_PER_SECOND);return t>i||i>=e?!1:!0},e.prototype.IsEnd=function(){var t=this.getEndTimer(),e=new Date(t*DateUtils.MS_PER_SECOND),i=new Date(GameServer.serverTime);return i.getDate()!=e.getDate()},e.prototype.go2BossFb=function(){return this.isGoIn},e.prototype.getReadyTimer=function(){var t=DataCenter.ins().Amusement20Config[this.id][this.index];return this.timer-t.duration-t.enterTime},e.prototype.getStartTimer=function(){var t=DataCenter.ins().Amusement20Config[this.id][this.index];return this.timer-t.duration},e.prototype.getEndTimer=function(){return this.timer},e.prototype.getResidueTimer=function(){if(this.IsEnd())return 0;var t=(this.getStartTimer(),this.getEndTimer()),e=Math.floor(GameServer.serverTime/DateUtils.MS_PER_SECOND);return t-e},e.prototype.getResidueStartTimer=function(){if(this.IsEnd())return 0;var t=this.getStartTimer(),e=Math.floor(GameServer.serverTime/DateUtils.MS_PER_SECOND);return e>=t?0:t-e},e.prototype.getDateTime=function(t){var e=t.split(/[-,.,:]/g),i=new Date(+e[0],+e[1]-1,+e[2],+e[3]||0,+e[4]||0);return i},e}(AmusementBaseDataVo);__reflect(AmusementType20DataVo.prototype,"AmusementType20DataVo");var BossBelongView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossBelongViewSkin",e.uilayer=GameLayer.SCENE3,e.isShowLog=!1,e.bloodBar0.labelDisplay.visible=!1,e.attackBoss1.currentState="attbossup",e}return __extends(e,t),e.prototype.showCancel=function(){return godWeaponBossControl.isGwBoss||crossBossControl.isKFBossBattle||reincarnateStarBossControl.isInFb||devildomControl.isDevildomBattle||darkHallBossControl.isDarkHallBoss||crazybtplayCopyControl.isShenwujindi||dominateBossControl.isZhuzaiBoss||warriorControl.isWarriorBoss||totemBossControl.inCopy},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(302,this.updateBelong),this.addCustomEvent(363,this.updateTarget),this.addCustomEvent(7,this.mapClick),this.addCustomEvent(353,this.onEnterMap),this.addEventTouchTap(this.belongGroup,this.onTap),this.addEventTouchTap(this.attguishu1,this.onTap),this.addEventTouchTap(this.attackBoss1,this.onTap),this.addEventTouchTap(this.attackPlayer1,this.onTap),this.updateBelong(),this.resetPosSize(),TimerMgr.ins().remove(this.updateBelong,this),TimerMgr.ins().doTimer(200,0,this.updateBelong,this)},e.prototype.onEnterMap=function(){this.attackBoss1.currentState="attbossup",this.attackPlayer1.currentState="attgsup"},e.prototype.mapClick=function(t){t.target,t.x,t.y;this.attackBoss1.currentState="attbossup"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.attackBoss1:this.attrBoss();break;case this.attguishu1:if(bossControl.attHandle==ActorControl.handle){crossBossControl.isKFBossBattle?crossBossControl.upCleanBelong():devildomControl.isDevildomBattle?devildomFinalControl.inCopy?devildomFinalControl.upCancelBelong():devildomControl.upCleanBelong():crazybtplayCopyControl.isShenwujindi?crazybtplayCopyControl.upCleanBelong(bossControl.monsterID):totemBossControl.inCopy?totemBossControl.upCancelBelong():bossControl.upCleanBelong();break}case this.belongGroup:case this.attackPlayer1:if(0==bossControl.attHandle)return void tipsControl.showTips(LangMgr.getValueByKey("cityTips1"));if(bossControl.attHandle==ActorControl.handle||bossControl.attHandle==gameControl.currAttackHandle)return;if(!bossControl.canClick)return;gameControl.dispatchChangeAttrPoint(bossControl.attHandle),this.setBtnState()}},e.prototype.attrBoss=function(){gameControl.dispatchChangeAttrPoint(bossControl.bossHandler),this.attackBoss1.currentState="attbossing",this.attackPlayer1.currentState="attgsup"},e.prototype.updateTarget=function(){this.setBtnState()},e.prototype.setBtnState=function(){bossControl.attHandle==ActorControl.handle?(this.showCancel()?this.attguishu1.label=LangMgr.getValueByKey("cityCancelAtt"):this.attguishu1.visible=!1,this.attackPlayer1.currentState="attgsdis"):(this.attguishu1.visible=!0,this.attguishu1.label=LangMgr.getValueByKey("cityGetAtt"),gameControl.currAttackHandle&&gameControl.currAttackHandle!=bossControl.bossHandler?this.attackPlayer1.currentState="attgsing":this.attackPlayer1.currentState="attgsup"),gameControl.currAttackHandle&&gameControl.currAttackHandle==bossControl.bossHandler?this.attackBoss1.currentState="attbossing":this.attackBoss1.currentState="attbossup"},e.prototype.updateBelong=function(){this.updateTarget();var t=UnitMgr.ins().getMasterList(UnitMgr.ins().getRootMasterHandle(bossControl.attHandle));if(t&&t.length>0){for(var e=t.length,i=0,n=0,o=0,s=0,r=void 0,a=0;e>a;a++){var l=t[a];if(l instanceof UnitRole){var h=l.infoModel.getAtt(0)||0,u=l.infoModel.getAtt(2)||0;i+=h,n+=u;var p=l.infoModel.getAtt(25)||0,c=l.infoModel.getAtt(26)||0;o+=p,s+=c,r||(r=l.infoModel)}}if(!r)return this.belongGroup.visible=!1,void(this.attackPlayer1.currentState="attgsup");this.belongGroup.visible=i>0&&""==bossControl.winner;var d=void 0,g=void 0;if(ActorControl.handle!=bossControl.attHandle){g=r.getNameWithServer();var m=g.split("\n");g=m[1]?m[1]:m[0],g=StringUtils.replaceStr(g,"0xffffff",d+""),d=r.guildID&&unionControl.guildID==r.guildID?ColorUtils.GREEN:ColorUtils.YELLOW}else g=LangMgr.getValueByKey("babelme"),d=ColorUtils.GREEN;this.belongNameTxt1.textFlow=TextUtils.generateTextFlow("|C:"+d+"&T:"+g),this.roleHead1.source="yuanhead"+r.job+r.sex,this.bloodBar0.maximum=n,this.bloodBar0.value=i,this.neigongBar0.maximum=s,this.neigongBar0.value=o}else this.belongGroup.visible=!1,this.attackPlayer1.currentState="attgsup"},e.prototype.resetPosSize=function(){totemBossControl.inCopy&&(this.belongGroup.right=62,this.belongGroup.y=95)},e}(BaseEuiView);__reflect(BossBelongView.prototype,"BossBelongView");var BossBloodView=function(t){function e(){var e=t.call(this)||this;return e._curMonsterID=0,e.curValue=1,e.skinName="BossBloodViewSkin",e.isShowLog=!1,e.uilayer=GameLayer.SCENE2,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.bloodBar.slideDuration=0,this.grayImg.source="bosshp2",this.grayImgMask=new egret.Rectangle(0,0,this.grayImg.width,this.grayImg.height),this.grayImg.mask=this.grayImgMask,e.GRAYIMG_WIDTH=this.grayImg.width,this.see.visible=!1,this.ZHBossGroup.visible=!1,this.hudunbloodBar.value=100,this.hudunbloodBar.maximum=100,this.nonBelong.visible=!1,this.addCustomEvent(104,this.delayHuDunChange),this.addCustomEvent(297,this.delayHuDunChange),this.addCustomEvent(335,this.delayHuDunChange),this.addCustomEvent(503,this.delayHuDunChange),this.addCustomEvent(160,this.delayHuDunChange),this.addCustomEvent(314,this.huDunChange),this.addEventTouchTap(this.clearBtn,this.onTap),this.addEventTouchTap(this.tipBtn0,this.onTap),this.resetPosSize()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.myTxt.text=LangMgr.getValueByKey("bossSelf"),this.dropDown.setEnabled(!1),this.hudun.visible=!1,this.tipBtn0.visible=this.checkShowSeeAwardBtn();var i=bossControl.rank.concat(),n=i.length;if(n){n>10&&(n=10);var o=i.slice(1,n);this.dropDown.setData(o),this.dropDown.setLabel(i[0].name)}else this.dropDown.setData([]),this.dropDown.setLabel(""),n=i.length;for(var s=ActorControl.actorID,r=0;n>r;r++)if(i[r].id==s){this.myTxt.text=LangMgr.getValueByKey("bossSelf")+CommonUtils.overLength(i[r].value);break}this.huDunChange(),this.checkIsShowFbInfo(),this.showCurRewards();var a=DataCenter.ins().MonstersConfig[bossControl.monsterID];if(a&&(this.updateBaseInfo(),this.guildFBInfo(a)),totemBossControl.inCopy){var l=TotemBossControl.getTutenDpByBossId(bossControl.monsterID);this.nonBelong.visible=l&&!TotemBossControl.hasBelong(l.belongTotemCondition)}},e.prototype.checkShowSeeAwardBtn=function(){return toseongControl.isToseong||godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss||crossBossControl.isKFBossBattle||37==MapControl.copyType||darkMysteryBossControl.isDarkBoss||devildomControl.isDevildomBattle||darkHallBossControl.isDarkHallBoss||crazybtplayCopyControl.isShenwujindi||dominateBossControl.isZhuzaiBoss||reincarnateStarBossControl.isInFb||totemBossControl.inCopy},e.prototype.updateBaseInfo=function(){if(this._curMonsterID!=bossControl.monsterID){this._curMonsterID=bossControl.monsterID;var t,e=DataCenter.ins().MonstersConfig[bossControl.monsterID];9==MapControl.copyType&&copyBabelControl.curLevel&&(t=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel].layer);var i=t&&38!=MapControl.copyType?""+t+LangMgr.getValueByKey("bossLenManster"):"";if(18==MapControl.copyType){var n=TextUtils.generateTextFlow1(e.name),o=n[n.length-1].text;this.nameTxt.text=""+i+o+"("+e.level+LangMgr.getValueByKey("numberLevel","")+")"}else this.nameTxt.text=""+i+e.name+"("+e.level+LangMgr.getValueByKey("numberLevel","")+")";this.head.source="monhead"+e.head+"_png",(32==MapControl.copyType||37==MapControl.copyType||46==MapControl.copyType||47==MapControl.copyType)&&(bossControl.currBossConfigID=bossControl.monsterID)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.closeShowInfoPanel(),this._curMonsterID=0,this._curBoss=null,TimerMgr.ins().remove(this.onRepeatHuDun,this),this.grayImgMask&&egret.Tween.removeTweens(this.grayImgMask)},e.prototype.guildFBInfo=function(t){if(unionWarControl.getModel().checkinAppoint(1)){var e=unionWarControl.getModel().doorEndtime;this.bloodBar.value=e,this.bloodBar.maximum=120,this.barGroup.y=101,0>=e?this.visible=!1:this.visible=!0,this.bloodBar.labelFunction=function(){return Math.floor(100*e/120)+"%"},this.curValue=Math.floor(this.bloodBar.value/120*100),this.tweenBlood()}else this.myTxt.visible=this.dropDown.visible=!1,this.bloodBar.value=void 0==bossControl.hp?t.hp:bossControl.hp,this.bloodBar.maximum=t.hp,this.barGroup.y=25,this.visible=this.bloodBar.value>0,this.curValue=Math.floor(this.bloodBar.value/t.hp*100),this.tweenBlood()},e.prototype.tweenBlood=function(){var t=this,i=this.curValue*e.GRAYIMG_WIDTH/100,n=this;if(egret.Tween.removeTweens(this.grayImgMask),!(3>i)){var o=egret.Tween.get(this.grayImgMask,{onChange:function(){n.grayImg&&(n.grayImg.mask=t.grayImgMask)}},n);o.to({width:i-3},1e3).call(function(){0>=i&&(n.grayImgMask.width=0,egret.Tween.removeTweens(t.grayImgMask))},n)}},e.prototype.delayHuDunChange=function(){TimerMgr.ins().isExists(this.huDunChange,this)||TimerMgr.ins().doTimer(60,1,this.huDunChange,this)},e.prototype.huDunChange=function(){if(this.proLab.visible=!0,toseongControl.isToseong)this.proLab.visible=!1,toseongControl.hudun&&toseongControl.hudun>0?(this.hudun.visible=!0,this.hudunbloodBar.value=toseongControl.hudun,this.hudunbloodBar.maximum=toseongControl.huDunMax):this.hudun.visible=!1;else if(devildomControl.inCopy)this.proLab.visible=!1,devildomControl.hudun&&devildomControl.hudun>0?(this.hudun.visible=!0,this.hudunbloodBar.value=devildomControl.hudun,this.hudunbloodBar.maximum=devildomControl.hudunMax):this.hudun.visible=!1;else if(crazybtplayCopyControl.isShenwujindi)this.proLab.visible=!1,crazybtplayCopyControl.hudun&&crazybtplayCopyControl.hudun>0?(this.hudun.visible=!0,this.hudunbloodBar.value=crazybtplayCopyControl.hudun,this.hudunbloodBar.maximum=crazybtplayCopyControl.hudunMax):this.hudun.visible=!1;else if(crossBossControl.isKFBossBattle)this.proLab.visible=!1,crossBossControl.hudun&&crossBossControl.hudun>0?(this.hudun.visible=!0,this.hudunbloodBar.value=crossBossControl.hudun,this.hudunbloodBar.maximum=crossBossControl.hudunMax):this.hudun.visible=!1;else if(godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss||darkMysteryBossControl.isDarkBoss||reincarnateStarBossControl.isInFb||darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss||warriorControl.isWarriorBoss)this.proLab.visible=!1,bossControl.shieldType?bossControl.curShield>0&&(this.hudun.visible=!0,TimerMgr.ins().isExists(this.setTimeShieldChange,this)||(TimerMgr.ins().doTimer(1e3,0,this.setTimeShieldChange,this),this.setTimeShieldChange())):this.setHpShieldChange();else{var t=bossControl.bossHandler;this._curBoss||(this._curBoss=UnitMgr.ins().getEntityByHandle(t)),this._curBoss&&this._curBoss.infoModel&&(this._curBoss.infoModel.showHuDun()||bossControl.showHuDun(t))?(TimerMgr.ins().isExists(this.onRepeatHuDun,this)||(TimerMgr.ins().doTimer(1e3,0,this.onRepeatHuDun,this),this.onRepeatHuDun()),this.hudun.visible=!0,this.proLab.visible=!1):(TimerMgr.ins().remove(this.onRepeatHuDun,this),this.hudun.visible=!1)}},e.prototype.onRepeatHuDun=function(){var t,e;if(this._curBoss.infoModel.showHuDun()){e=this._curBoss.infoModel.huDunTime,t=this._curBoss.infoModel.huDunEndTime-e;var i=Math.floor((GameServer.serverTime-DateUtils.formatMiniDateTime(e))/DateUtils.MS_PER_SECOND);this.hudunbloodBar.maximum!=t&&(this.hudunbloodBar.maximum=t),this.hudunbloodBar.value=t-i}else if(bossControl.showHuDun(bossControl.bossHandler)){var n=bossControl.huDunTimeDic[bossControl.bossHandler];e=n.time,t=n.endTime-e;var i=Math.floor((GameServer.serverTime-DateUtils.formatMiniDateTime(e))/DateUtils.MS_PER_SECOND);this.hudunbloodBar.maximum!=t&&(this.hudunbloodBar.maximum=t),this.hudunbloodBar.value=t-i}else TimerMgr.ins().remove(this.onRepeatHuDun,this),this.hudun.visible=!1},e.prototype.setHpShieldChange=function(){if(MapControl.copyId==bossControl.curShieldFbID&&bossControl.curShield&&bossControl.curShield>0){this.hudun.visible=!0;var t=Math.ceil(bossControl.curShield/bossControl.totalShield*100);this.hudunbloodBar.value=t}else this.hudun.visible=!1},e.prototype.setTimeShieldChange=function(){this.hudunbloodBar.value=bossControl.curShield,this.hudunbloodBar.maximum=bossControl.totalShield,bossControl.curShield>0?this.hudun.visible=!0:(TimerMgr.ins().remove(this.setTimeShieldChange,this),this.hudun.visible=!1),bossControl.curShield--},e.prototype.onTap=function(t){switch(t.target){case this.tipBtn0:toseongControl.isToseong?UIMgr.ins().open(ToseongBossRewardTipsView):29==MapControl.copyType?UIMgr.ins().open(GuardRewardView):devildomFinalControl.inCopy?UIMgr.ins().open(DevildomFinalAwardView):devildomControl.isDevildomBattle?UIMgr.ins().open(DevildomBossAwardView):totemBossControl.inCopy?UIMgr.ins().open(TotemBossShowAwardView):UIMgr.ins().open(PublicBossRewardTipView)}},e.prototype.checkIsShowFbInfo=function(){switch(MapControl.copyType){case 9:case 38:UIMgr.ins().open(ChallengeInfoView)}},e.prototype.closeShowInfoPanel=function(){UIMgr.ins().isShow(ChallengeInfoView)&&UIMgr.ins().close(ChallengeInfoView)},e.prototype.showCurRewards=function(){if(9!=MapControl.copyType&&38!=MapControl.copyType)return void(this.currewards.visible=!1);
this.currewards.visible=!0;var t={rewards:[]};if(38==MapControl.copyType){var e=soulBoneControl.dunPassID>=Object.keys(DataCenter.ins().SoulBoneCopyConfig).length?soulBoneControl.dunPassID:soulBoneControl.dunPassID+1,i=DataCenter.ins().SoulBoneCopyConfig[e];t.rewards=i.award}else{var n=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel];n&&(t.rewards=n.clearReward)}this.currewards.data=t},e.prototype.resetPosSize=function(){totemBossControl.inCopy&&(this.barGroup.y=10,this.barGroup.horizontalCenter=-18,this.barGroup.scaleX=this.barGroup.scaleY=.8)},e.GRAYIMG_WIDTH=0,e}(BaseEuiView);__reflect(BossBloodView.prototype,"BossBloodView");var BossEndView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossEndViewSkin",e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(306,this.worldBossEnd),this.worldBossEnd()},e.prototype.close=function(){TimerMgr.ins().removeAll(this)},e.prototype.worldBossEnd=function(){var t=this;this.winnerName.text=LangMgr.getValueByKey("bossWinner",bossControl.winner);var e=Math.ceil((bossControl.worldBossEndTime-egret.getTimer())/1e3);this.leftTime.text=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_4),TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(1e3,e,function(){e--,t.leftTime.text=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_4),0==e&&copyControl.upExitFb()},this)},e}(BaseEuiView);__reflect(BossEndView.prototype,"BossEndView");var BossHomePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStartTime=!1,e.type=0,e.restoreTime=0,e.lastIndex=-1,e.isClickItem=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=BossHomeItemRenderer,this.titleList.itemRenderer=BossHomeTitleItemRenderer,this.setting.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.setting.text+"</u></a>"),this.setting.touchEnabled=!0,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData;var t=[];for(var e in DataCenter.ins().BossHomeConfig)t.push(e);this.titleList.dataProvider=new eui.ArrayCollection(t),this.setLoginView()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setGroupVis(!0),this.type=3,this.lastIndex=-1,this.titleList.selectedIndex=0,this.addCustomEvent(296,this.setData),this.addEventTouchTap(this.bosshome0,this.onTap),this.addEventTouchTap(this.bosshome1,this.onTap),this.addEventTouchTap(this.bosshome2,this.onTap),this.addEventTextLink(this.setting,this.onLink),this.addEventItemTap(this.titleList,this.onClickMenu),this.addEventItemTap(this.rewardList0,this.onTap),this.addEventItemTap(this.rewardList1,this.onTap),this.addEventItemTap(this.rewardList2,this.onTap),this.setData()},e.prototype.close=function(){this.removeEventTouchTap(this.bosshome0,this.onTap),this.removeEventTouchTap(this.bosshome1,this.onTap),this.removeEventTouchTap(this.bosshome2,this.onTap),this.removeEventTextLink(this.setting,this.onLink),this.removeEventItemTap(this.titleList,this.onClickMenu),this.removeEventItemTap(this.rewardList0,this.onTap),this.removeEventItemTap(this.rewardList1,this.onTap),this.removeEventItemTap(this.rewardList2,this.onTap),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bosshome0:this.onRukouClick(0);break;case this.bosshome1:this.onRukouClick(1);break;case this.bosshome2:this.onRukouClick(2);break;case this.rewardList0:case this.rewardList1:case this.rewardList2:this.isClickItem=!0}},e.prototype.onRukouClick=function(t){if(this.isClickItem)return void(this.isClickItem=!1);var e=DataCenter.ins().BossHomeConfig[t+1];return vipControl.lv<e.vip?void tipsControl.showTips(LangMgr.getValueByKey("open1",vipControl.getVipStr(e.vip))):(this.titleList.selectedIndex=t,this.setGroupVis(!1),void this.setData())},e.prototype.setGroupVis=function(t){this.rukou.visible=t,this.mainGroup.visible=!t},e.prototype.onClickMenu=function(t){this.setData()},e.prototype.setLoginView=function(){for(var t=0;3>t;t++){var e=DataCenter.ins().BossHomeConfig[t+1];this["rewardList"+t].itemRenderer=ItemBase,this["rewardList"+t].dataProvider=new eui.ArrayCollection(e.icon),this["vipImg"+t].source="vip_v"+e.vip+"_png"}},e.prototype.setData=function(){if(this.lastIndex!=this.titleList.selectedIndex){this.lastIndex=this.titleList.selectedIndex;var t=this.list.parent;t.stopAnimation(),this.list.scrollV=0;var e=bossControl.worldInfoList[this.type].slice(),i=[],n=[],o=[],s=[],r=[],a=[],l=1e3*reincarnateControl.lv+ActorControl.level,h=this.titleList.selectedIndex+1,u=DataCenter.ins().BossHomeConfig[h],p=u.boss;this.titleText.text=LangMgr.getValueByKey("bossHomeLayer",h),this.vipTipTxt.text=LangMgr.getValueByKey("bossVipFightMore",vipControl.getVipStr(u.vip));for(var c=0;c<e.length;c++)if(-1!=p.indexOf(e[c].id)){var d=2==e[c].bossState,g=DataCenter.ins().WorldBossConfig[e[c].id],m=1e3*g.zsLevel+g.level;if(m>l)a.push(e[c]);else{var f=bossControl.getBossRemindByIndex(e[c].id);f?d?o.push(e[c]):n.push(e[c]):d?r.push(e[c]):s.push(e[c])}}n.sort(this.compareFn),o.sort(this.compareFn),s.sort(this.compareFn),r.sort(this.compareFn),a.sort(this.compareFn),i=n.concat(o,s,r,a),this.listData.replaceAll(i),this.currData=i[0],this.isStartTime||(TimerMgr.ins().doTimer(1e3,0,this.updateTime,this),this.restoreTime=bossControl.worldBossrestoreTime[this.type],this.isStartTime=!0,this.updateTime())}},e.prototype.updateTime=function(){if(void 0!=this.timeTxt){var t=this.currData,e=t.relieveTime-egret.getTimer();0>=e?(TimerMgr.ins().remove(this.updateTime,this),this.isStartTime=!1,this.timeTxt.visible=!1,bossControl.upWorldBossInfo(3)):(this.timeTxt.visible||(this.timeTxt.visible=!0),this.timeTxt.text=LangMgr.getValueByKey("osaAfteUpdate",DateUtils.getFormatBySecond(Math.floor(e/1e3),1)))}},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return i.zsLevel!=n.zsLevel?n.zsLevel-i.zsLevel:n.level-i.level},e.prototype.onLink=function(){UIMgr.ins().open(PublicBossRemindView,3)},e}(BasePanel);__reflect(BossHomePanel.prototype,"BossHomePanel");var BossView=function(t){function e(){var e=t.call(this)||this;return e.lastIndex=0,e.isTopLevel=!0,e.skinName="BossViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){if(t.prototype.initUI.call(this),this.hisParent=this.redPoint0.parent,this.redPoint2.visible=!1,bossControl.checkHolyAreaOpen()){for(var e=0;5>e;e++)this.hisParent.addChildAt(this["redPoint"+e],e);this.holyAreaBossPanel.parent||this.viewStack.addChildAt(this.holyAreaBossPanel,3)}else{for(var e=0;5>e;e++)3==e&&this.addChildAt(this["redPoint"+e],0);this.holyAreaBossPanel.parent&&this.viewStack.removeChild(this.holyAreaBossPanel)}this.validateNow()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(bossControl.init(),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this,this.onTap),this.addEventTouchTap(this.seeRule,this.onTap),this.addEventChange(this.tab,this.setSelectedIndex),this.addEventChanging(this.tab,this.checkIsOpen),this.addCustomEvent(296,this.updateRedPoint),this.addCustomEvent(369,this.updatePanel),this.addCustomEvent(369,this.updateRedPoint),void 0==t[0]){var i=bossControl.getPersonalListData()[0];0==i.length&&(t[0]=1)}this.lastSelect=t.length?t[0]:0,this.lastSelect>this.viewStack.numChildren-1&&(this.lastSelect=this.viewStack.numChildren-1),this.viewStack.selectedIndex=this.lastSelect,this.tab.selectedIndex=this.lastSelect,this.viewStack.getElementAt(this.lastSelect).open(t[1]),this.updateRedPoint(),UIMgr.ins().close(UnionMapView),UIMgr.ins().close(TreasureHuntView),this.checkHelpBtn()},e.prototype.updatePanel=function(){this.viewStack.getElementAt(this.lastSelect).close(),this.lastSelect=this.viewStack.selectedIndex,this.viewStack.getElementAt(this.lastSelect).open(),this.checkHelpBtn()},e.prototype.setSelectedIndex=function(t){this.viewStack.getElementAt(this.lastSelect).close(),this.lastSelect=this.viewStack.selectedIndex,this.viewStack.getElementAt(this.lastSelect).open(),this.checkHelpBtn()},e.prototype.checkHelpBtn=function(){bossControl.checkHolyAreaOpen()?this.seeRule.visible=3!=this.lastSelect:this.seeRule.visible=!0},e.prototype.updateRedPoint=function(){this.redPoint0.visible=CopyControl.isCanChallenge(),this.redPoint1.visible=bossControl.checkWorldBossRedPoint(2),this.redPoint2.visible=bossControl.checkWorldBossRedPoint(1)||bossControl.checkWorldBossRedPoint(7),this.redPoint3.visible=bossControl.checkWorldBossRedPoint(4),this.redPoint4.visible=bossControl.checkWorldBossRedPoint(3)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.getElementAt(this.lastSelect).close(),this.removeCustomEvents()},e.prototype.onLink=function(t){var e=this,i=DataCenter.ins().WorldBossBaseConfig.clearCdCost[bossControl.currBossSubType-1];warnControl.show(LangMgr.getValueByKey("bossCleanCD",i),function(){UIMgr.ins().close(e),bossControl.clearCD()},this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:4==this.viewStack.selectedIndex?HelpControl.openHelpWin(12):3!=this.viewStack.selectedIndex||bossControl.checkHolyAreaOpen()?HelpControl.openHelpWin(this.viewStack.selectedIndex+1):HelpControl.openHelpWin(12);break;default:if(t.target instanceof eui.Button){var e=t.target.parent.config;switch(t.target.name){case"publicChallenge":return;case"homeChallenge":if(copyControl.checkInFB())return;if(e.zsLevel<=reincarnateControl.lv&&e.level<=ActorControl.level)if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{var i=Math.ceil((bossControl.worldBossCd[3]-egret.getTimer())/1e3);if(i>0)return void tipsControl.showTips(LangMgr.getValueByKey("bossfightTime",i));t.target.parent&&bossControl.challengWorldBoss(t.target.parent.data.id,3),UIMgr.ins().close(this)}else tipsControl.showTips(LangMgr.getValueByKey("personNoLevelFight"));break;case"ZsBoss":}UIMgr.ins().close(LimitTaskView)}}},e.prototype.checkIsOpen=function(t){var e=t.target,i=1;return UIMgr.ins().close(LimitTaskView),2==e.selectedIndex&&reincarnateControl.lv<i?(tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",i)),t.$cancelable=!0,void t.preventDefault()):void 0},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!crossArenaControl.checkIsMatching())return!1;if(!bossControl.worldInfoList[1]&&!bossControl.worldInfoList[2])return tipsControl.showTips(LangMgr.getValueByKey("bossErrorTips")),!1;if(t&&t.length){if(2==t[0]){var i=1;return reincarnateControl.lv<i?(tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",i)),!1):!0}if(4==t[0]&&!bossControl.checkHolyAreaOpen())return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().WorldBossBaseConfig.shenyuOpenDay)),!1}return SwitchMgr.ins().checkOpen(11,!0)?(CopyView.isClose||UIMgr.ins().close(ExperienceView),CopyView.isClose=!1,!0):!1},e}(BaseEuiView);__reflect(BossView.prototype,"BossView");var HideBossBtnView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HideBossBtnViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.eff_dragon.touchEnabled=!1,this.eff_dragon.touchChildren=!1,this.hideBossBtn.visible=!1,this.eff_dragon.visible=!1},e.prototype.initUI=function(){this.hideBossBtn.visible=!1,this.eff_dragon.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]?this.playDragonEff():this.showBtn()},e.prototype.onTap=function(){return MapControl.sceneInHook()?confrontControl.isEncounter()?void tipsControl.showCenterTips(LangMgr.getValueByKey("atkPlayerIng")):void UIMgr.ins().open(HideBossView):void tipsControl.showCenterTips(LangMgr.getValueByKey("bossTips13"))},e.prototype.playDragonEff=function(){var t=this,e=ObjectPool.pop("GameMovieClip");e.addEventListener(egret.Event.CHANGE,this.onloadComp,this),e.playFile(PATH_EFF+"luckyboss_dragon_down",1,function(){e.removeEventListener(egret.Event.CHANGE,t.onloadComp,t),e.destroy()}),this.eff_dragon.visible=!0,this.eff_dragon.addChild(e)},e.prototype.onloadComp=function(){TimerMgr.ins().doTimer(400,1,this.showBtn,this)},e.prototype.showBtn=function(){if(Assert(bossControl.hideBossData.id,"hideBossData id:"+bossControl.hideBossData.id))return void UIMgr.ins().close(this);this.hideBossBtn.visible=!0,this.addEventTouchTap(this.hideBossBtn,this.onTap);var t=DataCenter.ins().MonstersConfig[DataCenter.ins().HideBossConfig[bossControl.hideBossData.id].bossId];this.hideBossBtn.headImg.source="monhead"+t.head+"_png",this._sec=Math.floor((DateUtils.formatMiniDateTime(bossControl.hideBossData.endTime)-GameServer.serverTime)/1e3),this.lbTime.text=DateUtils.getFormatBySecond(this._sec,DateUtils.TIME_FORMAT_1),TimerMgr.ins().remove(this.setTime,this),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.mcBtn||(this.mcBtn=ObjectPool.pop("GameMovieClip"),this.mcBtn.playFile(PATH_EFF+"luckyboss_hint",-1)),this.mcBtn.parent||this.hideBossBtn.eff_btn.addChild(this.mcBtn)},e.prototype.setTime=function(){this._sec>0?(this._sec-=1,this.lbTime.text=DateUtils.getFormatBySecond(this._sec,DateUtils.TIME_FORMAT_1)):(bossControl.hideBossData.id=0,bossControl.hideBossData.endTime=0,UIMgr.ins().close(this))},e.prototype.close=function(){this.mcBtn&&this.mcBtn.destroy(),this.mcBtn=null},e}(BaseEuiView);__reflect(HideBossBtnView.prototype,"HideBossBtnView");var HideBossView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HideBossViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.boss.touchEnabled=!1,this.boss.touchChildren=!1,this.dropRewardList.itemRenderer=ItemBase},e.prototype.open=function(){this.addEventTouchTap(this.challengeBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.showBoss(),this.showAward()},e.prototype.close=function(){this.bossMc&&this.bossMc.destroy(),this.bossMc=null},e.prototype.showAward=function(){var t=bossControl.hideBossData.id,e=DataCenter.ins().HideBossConfig[t].rewardShow;this.dropRewardList.dataProvider=new eui.ArrayCollection(e.concat())},e.prototype.showBoss=function(){if(!this.bossMc){var t=ObjectPool.pop("GameMovieClip");this.bossMc=t,t.scaleX=-1,t.scaleY=1,t.x=78,t.y=50,this.boss.addChild(t)}var e=bossControl.hideBossData.id,i=DataCenter.ins().HideBossConfig[e].bossId,n=DataCenter.ins().MonstersConfig[i];this.bossMc.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(n.avatar+"_3s"),-1)},e.prototype.onTap=function(t){var e=t.currentTarget;e==this.bgClose?UIMgr.ins().close(this):e==this.challengeBtn&&(confrontControl.isEncounter()?tipsControl.showCenterTips(LangMgr.getValueByKey("atkPlayerIng")):MapControl.sceneInHook()?(bossControl.hideBossData.lastId=bossControl.hideBossData.id,bossControl.upChallengeHideBoss(),UIMgr.ins().close(this)):tipsControl.showCenterTips(LangMgr.getValueByKey("bossTips13")))},e}(BaseEuiView);__reflect(HideBossView.prototype,"HideBossView");var HolyAreaBossPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStartTime=!1,e.type=0,e.restoreTime=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=BossItemRenderer,this.setting.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.setting.text+"</u></a>"),this.setting.touchEnabled=!0,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=4,this.addCustomEvent(296,this.setData),this.addCustomEvent(296,this.calljoinPulbicChallenge),this.addCustomEvent(269,this.UseToItem),this.addEventTextLink(this.setting,this.onLink),this.addEventTouchTap(this.buyBtn,this.onTap),this.addEventTouchTap(this,this.onTap),this.setData(),this.showBossId=t[0]},e.prototype.close=function(){this.removeEventTextLink(this.setting,this.onLink),this.removeEventTouchTap(this.buyBtn,this.onTap),this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents(),TimerMgr.ins().remove(this.updateTime,this),this.isStartTime=!1},e.prototype.showTips=function(){var t=bossControl.worldBossLeftTime[this.type];return t>0?!0:(tipsControl.showTips(LangMgr.getValueByKey("bossTips6")),!1)},e.prototype.UseToItem=function(){this.isUse&&(this.isUse=!1,bossControl.upWorldBossInfo(this.type))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.buyBtn:if(!this.showTips())return;break;default:if(t.target instanceof eui.Button){var e=t.target.parent.config;switch(t.target.name){case"holyAreaBossChallenge":if(this.isJoin=!0,this.config=e,!t.target.parent)return;if(this.eId=t.target.parent.data.id,!this.showTips())return;if(!this.joinPulbicChallenge(e))return}UIMgr.ins().close(LimitTaskView)}}},e.prototype.calljoinPulbicChallenge=function(){this.joinPulbicChallenge(this.config)&&UIMgr.ins().close(LimitTaskView)},e.prototype.joinPulbicChallenge=function(t){if(!t)return!1;if(!this.isJoin)return!1;if(this.isJoin=!1,copyControl.checkInFB())return!1;if(bossControl.worldBossLeftTime[this.type]<=0)tipsControl.showTips(LangMgr.getValueByKey("bossTips9"));else if(t.zsLevel<=reincarnateControl.lv&&t.level<=ActorControl.level)if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{var e=Math.ceil((bossControl.worldBossCd[this.type]-egret.getTimer())/1e3);if(e>0)return tipsControl.showTips(LangMgr.getValueByKey("bossfightTime",e)),!1;UIMgr.ins().close(BossView),bossControl.challengWorldBoss(this.eId,this.type)}else tipsControl.showTips(LangMgr.getValueByKey("personNoLevelFight"));return!0},e.prototype.updateTime=function(){if(void 0!=this.timeTxt){var t=this.restoreTime-egret.getTimer();0>=t?(TimerMgr.ins().remove(this.updateTime,this),this.isStartTime=!1,bossControl.worldBossLeftTime[this.type]>=DataCenter.ins().WorldBossBaseConfig.dayCount[this.type-1]?this.timeTxt.visible=!1:bossControl.upWorldBossInfo(this.type)):this.timeTxt.visible||(this.timeTxt.visible=!0);var e=DateUtils.getFormatBySecond(Math.floor(t/1e3),DateUtils.TIME_FORMAT_12);this.timeTxt.text=LangMgr.getValueByKey("bossStr",e)}},e.prototype.showItem=function(t){return t?(this.juan.visible=!0,this.jicon.source=t.itemConfig.icon+"_png",void(this.jcount.text=t.count+"")):void(this.juan.visible=!1)},e.prototype.setData=function(){var t=bossControl.worldBossLeftTime[this.type];this.buyBtn.visible=!1;var e=backpackControl.getBagItemById(200995);this.showItem(e),this.challengeCountTxt.text=t+"/"+DataCenter.ins().WorldBossBaseConfig.dayCount[this.type-1];for(var i=bossControl.worldInfoList[this.type].slice(),n=[],o=[],s=[],r=[],a=[],l=[],h=1e3*reincarnateControl.lv+ActorControl.level,u=0;u<i.length;u++){var p=(i[u].relieveTime-egret.getTimer())/1e3>0||i[u].hp<=0,c=bossControl.getBossRemindByIndex(i[u].id),d=DataCenter.ins().WorldBossConfig[i[u].id],g=1e3*d.zsLevel+d.level;h>=g?c?p?s.push(i[u]):o.push(i[u]):p?a.push(i[u]):r.push(i[u]):l.push(i[u])}o.sort(this.compareFn),s.sort(this.compareFn),r.sort(this.compareFn),a.sort(this.compareFn),l.sort(this.compareFn),n=o.concat(s,r,l,a),this.listData.replaceAll(n),this.isStartTime||(TimerMgr.ins().doTimer(1e3,0,this.updateTime,this),this.restoreTime=bossControl.worldBossrestoreTime[this.type],this.isStartTime=!0,this.updateTime()),this.refushBarList(n)},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return i.zsLevel!=n.zsLevel?n.zsLevel-i.zsLevel:n.level-i.level},e.prototype.onLink=function(){UIMgr.ins().open(PublicBossRemindView,this.type)},e.prototype.refushBarList=function(t){if(!this.showBossId)return void(this.bossScroller.viewport.scrollV=0);for(var e=0;e<t.length;e++){var i=DataCenter.ins().WorldBossConfig[t[e].id];if(i&&this.showBossId==i.bossId){this.bossScroller.viewport.validateNow(),this.bossScroller.viewport.scrollV=138*e,this.bossScroller.viewport.contentHeight-this.bossScroller.viewport.scrollV<this.bossScroller.viewport.height&&(this.bossScroller.viewport.scrollV=this.bossScroller.viewport.contentHeight-this.bossScroller.height);break}}},e}(BasePanel);__reflect(HolyAreaBossPanel.prototype,"HolyAreaBossPanel");var NewBossRewardTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="NewBossRewardTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.giveUp,this.onTap),this.initView()},e.prototype.initView=function(){var t=DataCenter.ins().NewWorldBossBaseConfig.showDrows;this.endItem0.data=t[0],this.endItem1.data=t[1],this.belongItem.data=DataCenter.ins().NewWorldBossRankConfig[1][1].reward[0],this.joinItem.data=DataCenter.ins().NewWorldBossRankConfig[1][4].reward[0],this.endItem0.isShowName(!1),this.endItem1.isShowName(!1),this.belongItem.isShowName(!1),this.joinItem.isShowName(!1)},e.prototype.onTap=function(t){var e=t.currentTarget;(e==this.closeBtn||e==this.giveUp)&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(NewBossRewardTipView.prototype,"NewBossRewardTipView");var NewWorldBossUIView=function(t){function e(){var e=t.call(this)||this;return e.leftTime=0,e._curMonsterID=0,e.GRAYIMG_WIDTH=0,e.curValue=1,e.skinName="NewWorldBossUIViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.bossBloodGroup.visible=!1,this.leftTimeGroup.visible=!1,this.dropDown.visible=!1,this.dropDown.setEnabled(!1),this.attList.visible=!1,this.attList0.visible=!1,this.grayImg.source="bosshp2",this.grayImgMask=new egret.Rectangle(0,0,this.grayImg.width,this.grayImg.height),this.grayImg.mask=this.grayImgMask,this.GRAYIMG_WIDTH=this.grayImg.width},e.prototype.open=function(){this.addCustomEvent(444,this.reflashBlood),this.addCustomEvent(300,this.reflashBlood),this.addCustomEvent(309,this.updateReliveTime),this.addCustomEvent(310,this.updateTime),this.addCustomEvent(312,this.updateRank),this.addCustomEvent(311,this.updateAttr),this.addEventTouchTap(this.guwu,this.onTap),this.addEventTouchTap(this.tipBtn0,this.onTap),this.initView()},e.prototype.initView=function(){this.updateTime(),this.updateReliveTime(),this.updateAttr(),this.dropDown.currentState="down",this.bossConfig=DataCenter.ins().MonstersConfig[bossControl.monsterID],this.bossConfig&&(this.updateBaseInfo(),this.reflashBlood())},e.prototype.updateTime=function(){var t=bossControl.newWorldBossData.startTime,e=bossControl.newWorldBossData.isOpen;if(!e||!t)return void(this.leftTimeGroup.visible=!1);var i=Math.floor((GameServer.serverTime-t)/1e3);return 0>=i||i>=DataCenter.ins().NewWorldBossBaseConfig.bossTime?void(this.leftTimeGroup.visible=!1):(this.leftTimeGroup.visible=!0,this.leftTime=DataCenter.ins().NewWorldBossBaseConfig.bossTime-i,TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),void this.setTime())},e.prototype.setTime=function(){this.lastTime.text=DateUtils.getFormatBySecond(this.leftTime,DateUtils.TIME_FORMAT_10),this.leftTime>0&&(this.leftTime-=1)},e.prototype.updateReliveTime=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.updateBaseInfo=function(){this.bossConfig=DataCenter.ins().MonstersConfig[bossControl.monsterID],this.bossConfig&&(this._curMonsterID=bossControl.monsterID,this.nameTxt.text=this.bossConfig.name,this.head.source="monhead"+this.bossConfig.head+"_png",this.lvTxt.text="Lv."+this.bossConfig.level)},e.prototype.reflashBlood=function(){if(this._curMonsterID!=bossControl.monsterID&&this.updateBaseInfo(),this.bossConfig=DataCenter.ins().MonstersConfig[bossControl.monsterID],!this.bossConfig)return this.bossBloodGroup.visible=!1,void(this.leftTimeGroup.visible=!1);var t=UnitMgr.ins().getEntityByHandle(bossControl.bossHandler);if(!t||!t.infoModel||t.infoModel.getAtt(0)<=0)return this.bossBloodGroup.visible=!1,void(this.leftTimeGroup.visible=!1);var e=t?t.infoModel:null;e?(this.bloodBar.maximum=e.getAtt(2),this.bloodBar.value=e.getAtt(0),this.bossBloodGroup.visible=this.bloodBar.value>0):(this.bloodBar.maximum=this.bossConfig.hp,this.bloodBar.value=this.bossConfig.hp,this.bossBloodGroup.visible=this.bloodBar.value>0),this.bossBloodGroup.visible||(this.leftTimeGroup.visible=!1),this.dropDown.visible=!0,this.updateRank(),this.curValue=Math.floor(this.bloodBar.value/this.bloodBar.maximum*100),this.tweenBlood()},e.prototype.tweenBlood=function(){var t=this,e=this.curValue*this.GRAYIMG_WIDTH/100,i=this;if(egret.Tween.removeTweens(this.grayImgMask),!(3>e)){var n=egret.Tween.get(this.grayImgMask,{onChange:function(){i.grayImg&&(i.grayImg.mask=t.grayImgMask)}},i);n.to({width:e-3},1e3).call(function(){0>=e&&(i.grayImgMask.width=this.GRAYIMG_WIDTH,egret.Tween.removeTweens(this.grayImgMask))},i)}},e.prototype.updateRank=function(){var t=bossControl.newWorldBossData.rankList?bossControl.newWorldBossData.rankList.concat():[],e=t.length;if(e){e>10&&(e=10);var i=t.slice(1,e);this.dropDown.setData(i),this.dropDown.setLabel(t[0].roleName+":"+CommonUtils.overLength(t[0].value))}else this.dropDown.setData([]),this.dropDown.setLabel("");for(var n=0;n<t.length;n++)if(t[n].id==ActorControl.actorID){var o=CommonUtils.overLength(t[n].value);this.myTxt.text=""+LangMgr.getValueByKey("bossSelf")+o;break}},e.prototype.updateAttr=function(){var t=bossControl.newWorldBossData.addAttrNum||0,e=DataCenter.ins().NewWorldBossAttrConfig[t],i=DataCenter.ins().NewWorldBossAttrConfig[t+1],n="",o={type:0,value:0},s={type:0,value:0};if(i){for(var r=0;r<i.attr.length;r++)r>0&&(n+="\n"),s.type=i.attr[r].type,s.value=i.attr[r].value,o.type=s.type,o.value=0,e&&e.attr[r]&&(o.value=e.attr[r].value),n+=AttributeData.getAttStrByType(o,0,":",!1),s.value-=o.value,n+=AttributeData.getAttStrByType(s,0,"+",!1,!1);this.costGroup.parent||this.timeGroup.addChildAt(this.costGroup,0)}else{for(var r=0;r<e.attr.length;r++)r>0&&(n+="\n"),n+=AttributeData.getAttStrByType(e.attr[r],0,":",!1);this.costGroup.parent&&this.costGroup.parent.removeChild(this.costGroup)}this.guwuNum.text=n,this.guwutime.text=t+"/"+Object.keys(DataCenter.ins().NewWorldBossAttrConfig).length;var a=i||e;1==a.type?this.typeImg.source="szjinbi":2==a.type&&(this.typeImg.source="szyuanbao"),this.cost.text=a.count+""},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.guwu){if(bossControl.newWorldBossData.addAttrNum==Object.keys(DataCenter.ins().NewWorldBossAttrConfig).length)return void tipsControl.showTips(LangMgr.getValueByKey("bossAttrFinsh"));var i=bossControl.newWorldBossData.addAttrNum||0,n=DataCenter.ins().NewWorldBossAttrConfig[i+1];if(n){if(1==n.type&&ActorControl.gold<n.count)return void tipsControl.showTips(LangMgr.getValueByKey("bossMoneyEnought"));if(2==n.type&&ActorControl.yb<n.count)return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))}bossControl.upBuyAddAttrNum()}else e==this.tipBtn0&&UIMgr.ins().open(NewBossRewardTipView)},e.prototype.close=function(){TimerMgr.ins().removeAll(this),WatcherUtil.removeFromArray(bossControl.newWorldBossData.rankList),this._curMonsterID=0},e}(BaseEuiView);__reflect(NewWorldBossUIView.prototype,"NewWorldBossUIView");var NewWorldBossView=function(t){function e(){var e=t.call(this)||this;return e.skinName="NewWorldBossViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.bossMc=new GameMovieClip,this.bossMc.scaleX=-1,this.bossMc.scaleY=1,this.bossMc.x=0,this.bossMc.y=215,this.boss.addChild(this.bossMc),this.list.itemRenderer=ItemBaseNoName,bossControl.upGetNewBossInfo()},e.prototype.open=function(){this.addCustomEvent(308,this.update),this.addEventTouchTap(this.enter,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.update()},e.prototype.update=function(){var t=bossControl.newWorldBossData.bossID,e=DataCenter.ins().MonstersConfig[t];e&&(this.nameTxt.text=e.name+"("+e.level+")",this.bossMc.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(e.avatar+"_3s"),-1),this.list.dataProvider=new eui.ArrayCollection(DataCenter.ins().NewWorldBossBaseConfig.showAwards),this.bar.maximum=e.hp,this.bar.value=bossControl.newWorldBossData.curHp)},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.enter){if(bossControl.newWorldBossData.startTime>GameServer.serverTime){var i=new Date(bossControl.newWorldBossData.startTime),n=""+i.getHours()+LangMgr.getValueByKey("bossPoint")+(i.getMinutes()?i.getMinutes()+LangMgr.getValueByKey("activitMine",""):"");return void tipsControl.showTips(LangMgr.getValueByKey("bossOpenEveryDay",n))}if(!bossControl.checkNewWorldBossOpen())return void tipsControl.showTips(LangMgr.getValueByKey("bossJoinLimit",DataCenter.ins().NewWorldBossBaseConfig.openLv));bossControl.upIntoNewBoss(),UIMgr.ins().close(this)}else e==this.help?HelpControl.openHelpWin(15):e==this.bgClose&&UIMgr.ins().close(this)},e.prototype.close=function(){this.removeCustomEvents()},e}(BaseEuiView);__reflect(NewWorldBossView.prototype,"NewWorldBossView");var PersonalBossPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=PersonalBossItemRenderer,this.rewardList.itemRenderer=ItemBase,this.bossMc=new GameMovieClip,this.bossMc.scaleX=-1,this.bossMc.scaleY=1,this.bossMc.x=78,this.bossMc.y=165,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.bossGroup.addChild(this.bossMc),this.tempArrData=[];var i=bossControl.getPersonalListData(),n=i[0],o=i[1],s=i[2];this.tempArrData=n.concat(o,s),this.listData.replaceAll(this.tempArrData),this.list.scrollV=0,this.list.selectedIndex=0;var r=0;t[0]&&(r=this.getIdFromBossId(t[0],n)),this.currData=this.list.dataProvider.getItemAt(r),this.addEventTouchTap(this.challengeBtn,this.onTap),this.addEventItemTap(this.list,this.onClickMenu),this.updateView()},e.prototype.getIdFromBossId=function(t,e){for(var i=0;i<e.length;i++)if(e[i].bossId==t)return this.list.selectedIndex=i,i;return 0},e.prototype.onClickMenu=function(t){this.currData=this.list.dataProvider.getItemAt(t.itemIndex),this.updateView()},e.prototype.updateView=function(){var t,e=DataCenter.ins().MonstersConfig[this.currData.bossId];t=this.currData.levelLimit||this.currData.zsLevel?this.currData.zsLevel>0?LangMgr.getValueByKey("numberRotation",this.currData.zsLevel):LangMgr.getValueByKey("numberLevel",this.currData.levelLimit):LangMgr.getValueByKey("numberLevel",e.level),this.nameTxt.text=e.name+"("+t+")",this.rewardList.dataProvider=new eui.ArrayCollection(this.currData.showItem),this.dropDesc.text="";var i=copyControl.getFbDataById(this.currData.id);if(!i||!i.isPass){var n=DataCenter.ins().ItemConfig[this.currData.dropDesc];n&&(this.dropDesc.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("bossPassRewardTip1",n.zsLevel?LangMgr.getValueByKey("numberRotation",n.zsLevel):LangMgr.getValueByKey("numberLevel",n.level))))}this.currData.monthcard&&!payControl.monthDay?this.stateImage.source="":this.currData.specialCard&&!payControl.franchise?this.stateImage.source="":this.currData.zsLevel<=reincarnateControl.lv&&this.currData.levelLimit<=ActorControl.level?copyControl.getFbDataById(this.currData.id).getCount()>0?this.stateImage.source="zdbosskejisha":this.stateImage.source="zdbossyijisha":this.stateImage.source="";var o=1e3*reincarnateControl.lv+ActorControl.level,s=1e3*this.currData.zsLevel+this.currData.levelLimit,r=!0;this.canChallengeTxt.text="",this.currData.monthcard?payControl.monthDay<=0&&(this.canChallengeTxt.text=LangMgr.getValueByKey("personMonthCards"),r=!1):this.currData.specialCard?payControl.franchise||(this.canChallengeTxt.text=LangMgr.getValueByKey("personZZQuan"),r=!1):this.currData.privilege?payControl.getIsForeve()||(this.canChallengeTxt.text=LangMgr.getValueByKey("personGZQUan"),r=!1):(r=o>=s,this.canChallengeTxt.text=this.currData.zsLevel>0?LangMgr.getValueByKey("personRotationFight",this.currData.zsLevel):LangMgr.getValueByKey("personLevelFight",this.currData.levelLimit)),this.challengeBtn.visible=r,this.canChallengeTxt.visible=!r,this.bossMc.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(e.avatar+"_3s"),-1),this.btnLabel()
},e.prototype.onTap=function(t){switch(t.currentTarget){case this.challengeBtn:if(copyControl.checkInFB())return;if(this.currData.zsLevel<=reincarnateControl.lv&&this.currData.levelLimit<=ActorControl.level){if(copyControl.getFbDataById(this.currData.id).getCount()<=0)return void tipsControl.showTips(LangMgr.getValueByKey("personNoFight"));var e=copyControl.fbModel[this.currData.id].isPass;payControl.franchise&&e?(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView):copyControl.upChallenge(this.currData.id),UIMgr.ins().close(LimitTaskView)):(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView):(reincarnateControl.lv>=this.currData.sweepLevel&&e||UIMgr.ins().close(BossView),copyControl.upChallenge(this.currData.id)),UIMgr.ins().close(LimitTaskView))}else tipsControl.showTips(LangMgr.getValueByKey("personNoLevelFight"))}},e.prototype.close=function(){this.tempArrData=null,this.removeEventTouchTap(this.challengeBtn,this.onTap),this.removeEventItemTap(this.list,this.onClickMenu)},e.prototype.btnLabel=function(){var t=copyControl.fbModel[this.currData.id].isPass;payControl.franchise&&t?this.challengeBtn.label=LangMgr.getValueByKey("personFastFight"):reincarnateControl.lv>=this.currData.sweepLevel&&t?this.challengeBtn.label=LangMgr.getValueByKey("personFastFight"):this.challengeBtn.label=LangMgr.getValueByKey("personFight")},e}(BasePanel);__reflect(PersonalBossPanel.prototype,"PersonalBossPanel");var PublicBossPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStartTime=!1,e.type=0,e.restoreTime=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=BossItemRenderer,this.setting.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.setting.text+"</u></a>"),this.setting.touchEnabled=!0,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData,this.vipGroup.touchEnabled=this.tipTxt.touchEnabled=!1,this.tipTxt.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("bossTips2"))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=2,this.addCustomEvent(269,this.UseToItem),this.addCustomEvent(296,this.updateList),this.addCustomEvent(296,this.calljoinPulbicChallenge),this.addCustomEvent(296,this.setData),this.addEventTextLink(this.setting,this.onLink),this.addEventTouchTap(this.buyBtn,this.onTap),this.addEventTouchTap(this,this.onTap),this.setData(),this.initList(),this.showBossId=t[0],TimerMgr.ins().doTimer(2e3,0,this.getNewInfo,this)},e.prototype.close=function(){this.removeEventTextLink(this.setting,this.onLink),egret.Tween.removeTweens(this.vipGroup),this.removeCustomEvents(),TimerMgr.ins().removeAll(this),this.isStartTime=!1},e.prototype.getNewInfo=function(){bossControl.upWorldBossInfo(this.type)},e.prototype.showTips=function(){var t=bossControl.worldBossLeftTime[this.type];if(t>0)return!0;var e="",i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,200156);if(i)e=LangMgr.getValueByKey("bossTips3"),warnControl.show(e,function(){this.isUse=!0,backpackControl.upUseItem(i.configID,1)},this);else{var n=DataCenter.ins().VipConfig[vipControl.lv];if(!n)return tipsControl.showTips(LangMgr.getValueByKey("bossTips4")),!1;if(!n.boss1buy)return tipsControl.showTips(LangMgr.getValueByKey("bossTips5")),!1;var o=bossControl.worldChallengeTime[this.type];if(0>=t&&o>=n.boss1buy)return void tipsControl.showTips(LangMgr.getValueByKey("bossTips6"));if(ActorControl.yb<DataCenter.ins().WorldBossBaseConfig.buyCountPrice[this.type-1])return tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),!1;e=LangMgr.getValueByKey("bossTips7",DataCenter.ins().WorldBossBaseConfig.buyCountPrice[this.type-1])+LangMgr.getValueByKey("bossTodayBuy",o,n.boss1buy),warnControl.show(e,function(){bossControl.upBuyChallengeTimes(this.type)},this)}return!1},e.prototype.UseToItem=function(){this.isUse&&(this.isUse=!1,bossControl.upWorldBossInfo(this.type))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.buyBtn:if(!this.showTips())return;break;default:if(t.target instanceof eui.Button){var e=t.target.parent.config;switch(t.target.name){case"publicChallenge":if(!this.showTips())return;if(this.isJoin=!0,this.config=e,!t.target.parent)return;if(this.eId=t.target.parent.data.id,!this.joinPulbicChallenge(e))return}UIMgr.ins().close(LimitTaskView)}}},e.prototype.calljoinPulbicChallenge=function(){this.joinPulbicChallenge(this.config)&&UIMgr.ins().close(LimitTaskView)},e.prototype.joinPulbicChallenge=function(t){if(!t)return!1;if(!this.isJoin)return!1;if(this.isJoin=!1,copyControl.checkInFB())return!1;if(t.zsLevel<=reincarnateControl.lv&&t.level<=ActorControl.level)if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{var e=Math.ceil((bossControl.worldBossCd[this.type]-egret.getTimer())/1e3);if(e>0)return tipsControl.showTips(LangMgr.getValueByKey("bossfightTime",e)),!1;bossControl.challengWorldBoss(this.eId,this.type),UIMgr.ins().close(BossView)}else tipsControl.showTips(LangMgr.getValueByKey("personNoLevelFight"));return!0},e.prototype.updateTime=function(){if(void 0!=this.timeTxt){var t=this.restoreTime-egret.getTimer();0>=t?(TimerMgr.ins().remove(this.updateTime,this),this.isStartTime=!1,bossControl.worldBossLeftTime[this.type]>=DataCenter.ins().WorldBossBaseConfig.dayCount[this.type-1]&&(this.timeTxt.visible=!1)):this.timeTxt.visible||(this.timeTxt.visible=!0);var e=DateUtils.getFormatBySecond(Math.floor(t/1e3),DateUtils.TIME_FORMAT_12);this.timeTxt.text=LangMgr.getValueByKey("bossStr",e)}},e.prototype.setData=function(){var t=bossControl.worldBossLeftTime[this.type],e=backpackControl.getBagItemById(200156);if(this.buyBtn.visible=t>0||e?!1:!0,this.showItem(e),this.challengeCountTxt.text=t+"/"+DataCenter.ins().WorldBossBaseConfig.dayCount[this.type-1],0>=t&&vipControl.lv<=0){this.vipGroup.visible=!0,egret.Tween.removeTweens(this.vipGroup);egret.Tween.get(this.vipGroup,{loop:!0}).to({alpha:0},1e3).to({alpha:1},1e3)}else this.vipGroup.visible=!1,egret.Tween.removeTweens(this.vipGroup);this.isStartTime||(TimerMgr.ins().doTimer(1e3,0,this.updateTime,this),this.restoreTime=bossControl.worldBossrestoreTime[this.type],this.isStartTime=!0,this.updateTime())},e.prototype.showItem=function(t){return t?(this.juan.visible=!0,this.jicon.source=t.itemConfig.icon+"_png",void(this.jcount.text=t.count+"")):void(this.juan.visible=!1)},e.prototype.initList=function(){for(var t=bossControl.worldInfoList[this.type].slice(),e=[],i=[],n=[],o=[],s=[],r=[],a=1e3*reincarnateControl.lv+ActorControl.level,l=0;l<t.length;l++){var h=(t[l].relieveTime-egret.getTimer())/1e3>0||t[l].hp<=0,u=bossControl.getBossRemindByIndex(t[l].id),p=DataCenter.ins().WorldBossConfig[t[l].id];if(p){var c=1e3*p.zsLevel+p.level,d=void 0;if(p.samsaraLv){if(d=ActorControl.samsaraLv>=p.samsaraLv,!reincarnationControl.isOpen())continue}else d=a>=c;d?u?h?n.push(t[l]):i.push(t[l]):h?s.push(t[l]):o.push(t[l]):r.push(t[l])}}i.sort(this.compareFn),n.sort(this.compareFn),o.sort(this.compareFn),s.sort(this.compareFn),r.sort(this.compareFn),e=i.concat(n,o,r,s),this.listData.replaceAll(e),this.refushBarList(e)},e.prototype.updateList=function(){for(var t=0;t<this.listData.length;t++)this.listData.itemUpdated(this.listData.getItemAt(t))},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return n.zsLevel!=i.zsLevel?n.zsLevel-i.zsLevel:n.level-i.level},e.prototype.onLink=function(){UIMgr.ins().open(PublicBossRemindView,this.type)},e.prototype.refushBarList=function(t){if(!this.showBossId)return void(this.bossScroller.viewport.scrollV=0);for(var e=0;e<t.length;e++){var i=DataCenter.ins().WorldBossConfig[t[e].id];if(i&&this.showBossId==i.bossId){this.bossScroller.viewport.validateNow(),this.bossScroller.viewport.scrollV=138*e,this.bossScroller.viewport.contentHeight-this.bossScroller.viewport.scrollV<this.bossScroller.viewport.height&&(this.bossScroller.viewport.scrollV=this.bossScroller.viewport.contentHeight-this.bossScroller.height);break}}},e}(BasePanel);__reflect(PublicBossPanel.prototype,"PublicBossPanel");var PublicBossRemindView=function(t){function e(){var e=t.call(this)||this;return e.isSetting=!1,e.skinName="PublicBossRemindViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listDatas=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.isSetting=!1,this.autoChallenge.visible=payControl.franchise?!0:!1;var i=bossControl.worldInfoList[this.type].slice();if(2==this.type?(this.list0.itemRenderer=PublicBossRemindItemRenderer,this.autoChallenge.selected=bossAutoChallengeControl.autoPublicBoss):3==this.type?(this.list0.itemRenderer=HomeBossRemindItemRenderer,this.autoChallenge.visible=!1):7==this.type||11==this.type||12==this.type?(this.list0.itemRenderer=PublicBossRemindItemRenderer,this.autoChallenge.visible=!1,this.titleInfoLabel.text=LangMgr.getValueByKey("belongCondition")):5==this.type?(i=bossControl.getGwBossList(),this.list0.itemRenderer=GodWeaponBossRemindItemRenderer,this.autoChallenge.visible=!1):4==this.type?(this.list0.itemRenderer=PublicBossRemindItemRenderer,this.autoChallenge.selected=bossAutoChallengeControl.autoHolyAreaBoss):8==this.type&&(this.list0.itemRenderer=DarkBossRemindItemRenderer,this.autoChallenge.selected=!1,this.autoChallenge.visible=!1,this.titleInfoLabel.text=LangMgr.getValueByKey("dropEquip")),this.addEventTouchTap(this.autoChallenge,this.onChallenge),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),2==this.type)if(reincarnationControl.isOpen()){var n=[];for(var o in i){var s=DataCenter.ins().WorldBossConfig[i[o].id];(!s.openTime||GameServer.serverOpenDay>=s.openTime)&&n.push(i[o])}i=n}else{var n=[];for(var o in i){var s=DataCenter.ins().WorldBossConfig[i[o].id];s.samsaraLv||n.push(i[o])}i=n}else if(8==this.type||10==this.type){var n=[];for(var o in i){var s=DataCenter.ins().WorldBossConfig[i[o].id];s.openTime<=GameServer.serverOpenDay&&n.push(i[o])}var r=this.getMaxStar(n);n=n.map(function(t){return t.maxStart=r,t}),i=n}this.listDatas.source=i.sort(this.compareFn),this.list0.dataProvider=this.listDatas,this.addEventTouchTap(this,this.onTap)},e.prototype.getMaxStar=function(t){var e=0;return t.map(function(t,i){for(var n=DataCenter.ins().WorldBossConfig[t.id],o=n.showReward.map(function(t){return DataCenter.ins().DarkEquipConfig[t]}),s=0,r=0;r<o.length;r++){var a=o[r];a&&(s=a.star>s?a.star:s)}var l=BossControl.isCanChallenge(n);n.darkforce&&(l=t.canInto),s>e&&l&&(e=s)}),e},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];bossAutoChallengeControl.checkEnter(),this.isSetting&&(DarkHallBossRedPoint.ins().dispatchRedPoint(),DominateBossRedpoint.ins().dispatchRedPoint(),ReincarnateStarRedPoint.ins().dispatchBossRedpoint(),TotemBossRedpoint.ins().dispatchRedPoint(),bossControl.upBossSetting(),bossControl.upWorldBossInfo(this.type))},e.prototype.onChallenge=function(t){backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?(UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH),this.autoChallenge.selected=!1):4==this.type?bossAutoChallengeControl.autoHolyAreaBoss=this.autoChallenge.selected:2==this.type&&(bossAutoChallengeControl.autoPublicBoss=this.autoChallenge.selected)},e.prototype.onTap=function(t){if(t.target instanceof eui.CheckBox)this.isSetting=!0;else switch(t.currentTarget){case this.bgClose:case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id],o=BossControl.isCanChallenge(i),s=BossControl.isCanChallenge(n);return o&&!s?-1:!o&&s?1:i.samsaraLv>n.samsaraLv?1:i.samsaraLv<n.samsaraLv?-1:i.samsaraLv==n.samsaraLv&&i.samsaraLv?i.level>n.level?1:i.level<n.level?-1:void 0:i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:i.level>n.level?1:i.level<n.level?-1:t.id>e.id?1:t.id<e.id?-1:0},e}(BaseEuiView);__reflect(PublicBossRemindView.prototype,"PublicBossRemindView");var PublicBossRewardTipView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PublicBossRewardTipViewSkin",this.isTopLevel=!0,this.belongList.itemRenderer=ItemBase,this.joinList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addEventTouchTap(this,this.otherClose),godWeaponBossControl.isGwBoss?this.currentState="gwboss":crossBossControl.isKFBossBattle?this.currentState="kfboss":godWeaponBossControl.isGwTopBoss?this.currentState="tower":37==MapControl.copyType?this.currentState="hideboss":darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss||reincarnateStarBossControl.isInFb?this.currentState="andianboss":crazybtplayCopyControl.isShenwujindi||totemBossControl.inCopy?this.currentState="shenqiboss":this.currentState="normal",this.validateNow(),crossBossControl.isKFBossBattle){this.proWordGroup1.visible=!1,this.proWordGroup.visible=!1;for(var i in DataCenter.ins().CrossBossConfig){var n=DataCenter.ins().CrossBossConfig[i];if(n.fbid==MapControl.copyId){var o=RewardVo.getRewardsByOpenDay(n.belongRewardshow);o&&(this.belongItem.data=o.shift()),this.belongList.dataProvider=new eui.ArrayCollection(o);break}}}else if(37==MapControl.copyType){var s=bossControl.hideBossData.lastId,r=DataCenter.ins().HideBossConfig[s].rewardShow.concat();this.belongItem.data=r.shift(),this.belongList.dataProvider=new eui.ArrayCollection(r)}else if(44==MapControl.copyType||50==MapControl.copyType||reincarnateStarBossControl.isInFb){var a=DataCenter.ins().WorldBossConfig[bossControl.currBossConfigID];this.belongList.dataProvider=new eui.ArrayCollection(a.belongRewardshow)}else if(47==MapControl.copyType){var l=crazybtplayCopyControl.getDpByBossId(crazybtplayCopyControl.curViewBossId),h=CommonFun.dataToDropTag(l.carryAwards.concat(),DataCenter.ins().CrazybtplayBossBaseConfig.dropTags);this.belongList.dataProvider=new eui.ArrayCollection(h),this.shenqiForce.text=""+l.addStrength}else{var u=DataCenter.ins().WorldBossConfig[bossControl.currBossConfigID];this.belongItem.data=u.belongRewardshow[0],this.belongList.dataProvider=new eui.ArrayCollection(u.belongRewardshow[1]),u.canRewardshow&&(this.joinItem.data=u.canRewardshow[0],this.joinList.dataProvider=new eui.ArrayCollection(u.canRewardshow[1]))}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.openCheck=function(){return!!bossControl.currBossConfigID},e}(BaseEuiView);__reflect(PublicBossRewardTipView.prototype,"PublicBossRewardTipView");var ShieldView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ShieldViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.shieldBtn,this.onTap),this.touchEnabled=!1,this.shieldBtn.selected=!UnitHideMgr.ins().isShow,toseongControl.isToseong?this.shieldBtn.bottom=208:this.shieldBtn.bottom=200},e.prototype.onTap=function(t){UnitHideMgr.ins().setShowState(!this.shieldBtn.selected)},e}(BaseEuiView);__reflect(ShieldView.prototype,"ShieldView");var SpokesPersonBossFightView=function(t){function e(){var e=t.call(this)||this;return e.GRAYIMG_WIDTH=0,e._curMonsterID=0,e.curValue=1,e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SpokesPersonBossFightViewSkin",this.clickEffc=new GameMovieClip,this.clickEffc.x=630,this.clickEffc.y=269,this.pointEff=new GameMovieClip,this.pointEff.x=110,this.pointEff.y=510,this.attEffectGroup.visible=!1,this.attEffectGroup.touchEnabled=!1,this.bloodBar.slideDuration=0,this.bloodBar0.labelFunction=function(t,e){return""},this.grayImg.source="bosshp2",this.grayImgMask=new egret.Rectangle(0,0,this.grayImg.width,this.grayImg.height),this.grayImg.mask=this.grayImgMask,this.GRAYIMG_WIDTH=this.grayImg.width,this.addCustomEvent(304,this.refushcanPlayList),this.addCustomEvent(444,this.reflashBlood),this.addCustomEvent(363,this.refushcanPlayList),this.addCustomEvent(375,this.bossResult),this.addEventTouchTap(this.attackBoss,this.onTap),this.addEventTouchTap(this.belongGroup,this.onTap),this.addEventTouchTap(this.tipBtn,this.onTap),TimerMgr.ins().remove(this.reflashAtkInfo,this),TimerMgr.ins().doTimer(200,0,this.reflashAtkInfo,this)},e.prototype.open=function(){this.visible=!0,this.showtype=spokesPersonTaskControl.getType(),this.updateBaseInfo(),this.reflashAtkInfo(),this.refushcanPlayList(),this.reflashBlood()},e.prototype.updateBaseInfo=function(){2!=this.showtype&&(this.bossConfig=DataCenter.ins().MonstersConfig[bossControl.monsterID],this.bossConfig&&(this._curMonsterID=bossControl.monsterID,this.nameTxt.text=this.bossConfig.name,this.head.source="monhead"+this.bossConfig.head+"_png",this.lvTxt.text="Lv."+this.bossConfig.level))},e.prototype.close=function(){DisplayUtils.removeFromParent(this.clickEffc),DisplayUtils.removeFromParent(this.pointEff),this._curMonsterID=0},e.prototype.reflashAtkInfo=function(){if(this.belongGroup.visible=!1,2!=this.showtype){var t=spokesPersonTaskControl.getCfg().param;if(t){var e=UnitMgr.ins().getEntityByMonsterId(t);if(e&&e.length>0){var i=e[0];if(!i||!i.infoModel)return void(this.belongGroup.visible=!1);var n=i.infoModel.getAtt(0)||0,o=i.infoModel.getAtt(2)||0,s=i.infoModel.getAtt(25)||0,r=i.infoModel.getAtt(26)||0;this.belongGroup.visible=n>0;var a=ColorUtils.GREEN,l=DataCenter.ins().MonstersConfig[t];if(!this.bossConfig)return;var h=l.name;h=StringUtils.replaceStr(h,"0xffffff",a+""),this.belongNameTxt.textFlow=TextUtils.generateTextFlow("|C:"+a+"&T:"+h),this.bloodBar0.maximum=o,this.bloodBar0.value=n,this.neigongBar0.maximum=r,this.neigongBar0.value=s}}}},e.prototype.refushcanPlayList=function(){this.reflashAtkInfo(),this.checkListVis()},e.prototype.checkListVis=function(){if(2==this.showtype||3==this.showtype)return void(this.attackBtnGroup.visible=!1);var t=UnitMgr.ins().getNoDieRole(),e=t&&t.infoModel.getAtt(0)>0&&""==bossControl.winner;this.attackBoss.currentState=e?"attbossing":"attbossup"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.attackBoss:if(0==gameControl.currAttackHandle)return;gameControl.dispatchChangeAttrPoint(0);break;case this.belongGroup:break;case this.tipBtn:UIMgr.ins().open(PublicBossRewardTipView)}},e.prototype.reflashBlood=function(){if(2==this.showtype)return void(this.bossBloodGroup.visible=!1);var t=UnitMgr.ins().getEntityByHandle(bossControl.bossHandler);if(!t||!t.infoModel)return this.bossBloodGroup.visible=!1,void this.checkListVis();var e=t?t.infoModel:null;e?(this.bloodBar.maximum=e.getAtt(2),this.bloodBar.value=e.getAtt(0),this.bossBloodGroup.visible=this.bloodBar.value>0):(this.bloodBar.maximum=this.bossConfig.hp,this.bloodBar.value=this.bossConfig.hp,this.bossBloodGroup.visible=this.bloodBar.value>0),this.curValue=Math.floor(this.bloodBar.value/this.bloodBar.maximum*100),this.tweenBlood()},e.prototype.bossResult=function(t){var e=t.fbType;77==e&&(TimerMgr.ins().remove(this.reflashAtkInfo,this),this.belongGroup.visible=!1,this.attackBtnGroup.visible=this.attackBoss.visible=!1)},e.prototype.tweenBlood=function(){var t=this,e=this,i=this.curValue*this.GRAYIMG_WIDTH/100;if(egret.Tween.removeTweens(this.grayImgMask),i>=3){var n=egret.Tween.get(this.grayImgMask,{onChange:function(){e.grayImg&&(e.grayImg.mask=e.grayImgMask)}},e);n.to({width:i-3},1e3).call(function(){0>=i&&(e.grayImgMask.width=t.GRAYIMG_WIDTH,egret.Tween.removeTweens(t.grayImgMask))},e)}},e}(BaseEuiView);__reflect(SpokesPersonBossFightView.prototype,"SpokesPersonBossFightView");var WorldBossBeKillView=function(t){function e(){var e=t.call(this)||this;return e.remainM=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossBeKillViewSkin",this.aliveNum=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.reliveBtn,this.onTap),this.addEventTouchTap(this.exitBtn,this.onTap),this.setWin()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.reliveBtn,this.onTap),this.removeEventTouchTap(this.exitBtn,this.onTap),UIMgr.ins().close(WorldBossCdView)},e.prototype.setWin=function(){if(bossControl.killerHandler>0){var t=UnitMgr.ins().getEntityByHandle(bossControl.killerHandler),e="";if(t)if(t instanceof UnitRole)e=t.infoModel.name;else if(t.infoModel.masterHandle){var i=UnitMgr.ins().getMasterList(UnitMgr.ins().getRootMasterHandle(t.infoModel.masterHandle));if(i&&i.length)for(var n=0,o=i;n<o.length;n++){var s=o[n];if(s instanceof UnitRole){e=""+s.infoModel.name;break}}e||(e=""+t.infoModel.name)}else e="Boss"+t.infoModel.name;this.killTips.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("bossFinghtLoss",StringUtils.addColor(""+e,LangMgr.getColor("color74")))),this.aliveNum=this.getAliveItem(),this.alive.visible=this.aliveNum?!0:!1,this.alive.visible&&(this.alive.text=LangMgr.getValueByKey("bossReshProp",this.aliveNum))}this.reliveBtn.label=LangMgr.getValueByKey("bossReshLocal",bossControl.checkWorldBossNeed()),35==MapControl.copyType?(this.reliveBtn.visible=!1,this.moneyIcon.visible=!1):(this.reliveBtn.visible=!0,this.moneyIcon.visible=!0),this.reliveTimesTxt.text=bossControl.reliveTime+LangMgr.getValueByKey("activitSS"),TimerMgr.ins().remove(this.refushLabel,this),this.remainM=bossControl.reliveTime,TimerMgr.ins().doTimer(1e3,this.remainM,this.refushLabel,this,this.overTime,this),DieGuide.ins().dispatchdieGuide(0)},e.prototype.getAliveItem=function(){if(campWarControl.isCampWar()||blisterControl.isPaoDian)return 0;var t=toseongControl.isToseong?DataCenter.ins().ToseongBaseConfig.rebornItem:DataCenter.ins().WorldBossBaseConfig.rebornItem,e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,t);return e?e.count:0},e.prototype.refushLabel=function(){this.remainM--,this.reliveTimesTxt.text=this.remainM+LangMgr.getValueByKey("activitSS")},e.prototype.overTime=function(){UIMgr.ins().close(this),UIMgr.ins().close(WorldBossCdView)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.reliveBtn:if(this.aliveNum)return void bossControl.clearCD();bossControl.checkWorldBossMoney()?bossControl.clearCD():tipsControl.showTips(LangMgr.getValueByKey("customBossNoYB"));break;case this.exitBtn:copyControl.upExitFb()}},e}(BaseEuiView);__reflect(WorldBossBeKillView.prototype,"WorldBossBeKillView");var WorldBossCdView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossCdViewSkin",this.isTopLevel=!0,this.uilayer=GameLayer.POPUP},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.sure,this.onTap),this.addEventTouchTap(this.giveUp,this.onTap),this.addEventChange(this.check,this.selectChange);var i=bossControl.checkWorldBossNeed();this.tipsTxt.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("bossReshPayYB",StringUtils.addColor(LangMgr.getValueByKey("charItemYB",i),LangMgr.getColor("color74"))))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.sure,this.onTap),this.removeEventTouchTap(this.giveUp,this.onTap),this.removeEventChange(this.check,this.selectChange)},e.prototype.selectChange=function(t){bossControl.showTip=!this.check.selected},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return bossControl.showTip},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sure:bossControl.checkRelive()&&(bossControl.clearCD(),UIMgr.ins().close(this),UIMgr.ins().close(WorldBossBeKillView));break;case this.giveUp:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(WorldBossCdView.prototype,"WorldBossCdView");var WorldBossPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.endTime=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=WorldBossMainItemRenderer,this.dropRewardList.itemRenderer=ItemBase,this.bossMc=new GameMovieClip,this.bossMc.scaleX=-1,this.bossMc.scaleY=1,this.bossMc.x=78,this.bossMc.y=165,this.bossGroup.touchEnabled=this.bossGroup.touchChildren=!1,this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.getItemTxt.text+"</u>"),this.remindTpis.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.remindTpis.text+"</u></a>"),this.remindTpis.touchEnabled=!0,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData},e.prototype.open=function(){var t=[],e=1,i=bossControl.worldBossPlayList[e].slice();i.length||(bossControl.updateBossPlayList(e),i=bossControl.worldBossPlayList[e].slice()),i.sort(this.sortList),t.push({type:e,arr:i,selectIndex:0,clickCall:this.onClickList.bind(this)}),reincarnateControl.lv>=5&&GameServer.serverOpenDay>=DataCenter.ins().WorldBossBaseConfig.canSeeDarkBossDay-1&&(e=7,i=bossControl.worldBossPlayList[e].slice(),i.length||(bossControl.updateBossPlayList(e),i=bossControl.worldBossPlayList[e].slice()),i.sort(this.sortList),t.push({type:e,arr:i,selectIndex:t[0].arr.length>0?-1:0,clickCall:this.onClickList.bind(this)})),this.bossMc&&!this.bossMc.parent&&this.bossGroup.addChild(this.bossMc),this.addCustomEvent(296,this.setWin),this.addCustomEvent(296,this.joinWorldBoss),this.addCustomEvent(269,this.useToItem),this.addEventTouchTap(this.challengeBtn,this.onTap),this.addEventTouchTap(this.getItemTxt,this.onTap),this.addEventTextLink(this.remindTpis,this.onLink),this.addEventItemTap(this.list,this.onClickMenu),this.listData.source=t,this.list.scrollV=0,this.list.selectedIndex=0,t[0].arr.length>0?this.currData=t[0].arr[0]:t[1].arr.length>0&&(this.currData=t[1].arr[0]),this.setWin()},e.prototype.sortList=function(t,e){return t.id-e.id},e.prototype.onClickMenu=function(t){var e=this.list.dataProvider.getItemAt(t.itemIndex);7==e.type&&0==e.arr.length&&tipsControl.showTips(LangMgr.getValueByKey("bossTips10"))},e.prototype.onClickList=function(t){this.currData=t;for(var e=DataCenter.ins().WorldBossConfig[this.currData.id],i=0;i<this.listData.length;i++){var n=this.listData.getItemAt(i);e.type==n.type?n.selectIndex=n.arr.indexOf(t):(n.selectIndex=-1,this.listData.itemUpdated(n))}this.setWin()},e.prototype.setWin=function(){if(this.currData){var t=DataCenter.ins().WorldBossConfig[this.currData.id],e=DataCenter.ins().MonstersConfig[t.bossId];this.nameTxt.text=e.name+"("+t.zslook[0]+LangMgr.getValueByKey("numberRotation","")+"-"+t.zslook[t.zslook.length-1]+LangMgr.getValueByKey("numberRotation","")+")";var i=LangMgr.getValueByKey("persontNone");""!=this.currData.roleName&&(i=this.currData.roleName,""!=this.currData.guildName&&(i=i+"("+this.currData.guildName+")")),this.playerNameTxt.text=i,2==this.currData.bossState?this.stateImage.source="zdbossyijisha":1==this.currData.bossState?this.stateImage.source="zdbosskejisha":this.stateImage.source="",this.dropRewardList.dataProvider?this.dropRewardList.dataProvider.source=t.showReward.concat():this.dropRewardList.dataProvider=new eui.ArrayCollection(t.showReward.concat());var n=bossControl.worldBossLeftTime[t.type],o=1==t.type?LangMgr.getValueByKey("bossName2"):LangMgr.getValueByKey("bossName1");if(this.leftText.text=LangMgr.getValueByKey("bossHaveTimes",o,n),this.getItemTxt.visible=n>0||7==t.type?!1:!0,this.endTime=Math.floor((bossControl.worldBossCd[t.type]-egret.getTimer())/1e3),this.endTime>0?(this.challengeBtn.visible=!1,this.updateTime(),TimerMgr.ins().doTimer(100,0,this.updateTime,this),i=DateUtils.getFormatBySecond(this.endTime,5,3),this.leftCDText.text=LangMgr.getValueByKey("bossFightCD",i)):this.leftCDText.text="",this.bossMc.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(e.avatar+"_3s"),-1),1==t.type){var s=backpackControl.getBagItemById(200157);this.showItem(s)}else this.showItem(null)}},e.prototype.showItem=function(t){return t?(this.juan.visible=!0,this.jicon.source=t.itemConfig.icon+"_png",void(this.jcount.text=t.count+"")):void(this.juan.visible=!1)},e.prototype.updateTime=function(){if(this.currData){var t=DataCenter.ins().WorldBossConfig[this.currData.id],e=Math.floor((bossControl.worldBossCd[t.type]-egret.getTimer())/1e3);this.leftCDText.text=LangMgr.getValueByKey("bossFightCD",DateUtils.getFormatBySecond(e,5,3)),0>=e&&(TimerMgr.ins().remove(this.updateTime,this),this.leftCDText.text="",this.challengeBtn.visible=!0)}},e.prototype.showTips=function(){if(!this.currData)return!1;var t=DataCenter.ins().WorldBossConfig[this.currData.id],e=bossControl.worldBossLeftTime[t.type];if(e>0)return!0;if(7==t.type)return tipsControl.showTips(LangMgr.getValueByKey("bossTips11")),!1;var i="",n=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,200157);if(n)i=LangMgr.getValueByKey("bossTips12"),warnControl.show(i,function(){this.isUse=!0,backpackControl.upUseItem(n.configID,1)},this);else{var o=DataCenter.ins().VipConfig[vipControl.lv];if(!o)return tipsControl.showTips(LangMgr.getValueByKey("bossTips4")),!1;if(!o.boss2buy)return tipsControl.showTips(LangMgr.getValueByKey("bossTips5")),!1;var s=bossControl.worldChallengeTime[t.type];if(0>=e&&s>=o.boss2buy)return tipsControl.showTips(LangMgr.getValueByKey("bossTips6")),!1;if(ActorControl.yb<DataCenter.ins().WorldBossBaseConfig.buyCountPrice[t.type-1])return tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),!1;i=LangMgr.getValueByKey("bossTips7",DataCenter.ins().WorldBossBaseConfig.buyCountPrice[t.type-1])+LangMgr.getValueByKey("bossTodayBuy",s,o.boss2buy),warnControl.show(i,function(){bossControl.upBuyChallengeTimes(t.type)},this)}return!1},e.prototype.useToItem=function(){if(this.currData){var t=DataCenter.ins().WorldBossConfig[this.currData.id];this.isUse&&(this.isUse=!1,bossControl.upWorldBossInfo(t.type))}},e.prototype.joinWorldBoss=function(){if(this.isJoin&&this.currData){var t=DataCenter.ins().WorldBossConfig[this.currData.id];if(this.isJoin=!1,!copyControl.checkInFB()){if(Math.floor((bossControl.worldBossCd[t.type]-egret.getTimer())/1e3)>0)return void tipsControl.showTips(LangMgr.getValueByKey("bossFighting"));var e=1e3*reincarnateControl.lv+ActorControl.level,i=(DataCenter.ins().MonstersConfig[t.bossId],1e3*t.zsLevel+t.level);if(i>e){var n=t.zsLevel>0?LangMgr.getValueByKey("numberRotation",t.zsLevel):LangMgr.getValueByKey("numberLevel",t.level);return void tipsControl.showTips(LangMgr.getValueByKey("bossCanFight",n))}backpackControl.getSurplusCount()<BossControl.WB_BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView,BossControl.WB_BAG_ENOUGH):(UIMgr.ins().close(BossView),bossControl.challengWorldBoss(this.currData.id,t.type)),UIMgr.ins().close(LimitTaskView)}}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.challengeBtn:if(this.isJoin=!0,!this.showTips())return;this.joinWorldBoss();break;case this.getItemTxt:if(!this.showTips())return}},e.prototype.onLink=function(){UIMgr.ins().open(PublicBossRemindView,7)},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this.challengeBtn,this.onTap),this.removeEventTouchTap(this.getItemTxt,this.onTap),this.removeEventTextLink(this.remindTpis,this.onLink),this.removeEventItemTap(this.list,this.onClickMenu),TimerMgr.ins().remove(this.updateTime,this)},e}(BasePanel);__reflect(WorldBossPanel.prototype,"WorldBossPanel");var WorldBossRewardTipView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossRewardTipViewSkin",this.belongList.itemRenderer=ItemBase,this.joinList.itemRenderer=ItemBase
},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.otherClose);var i=DataCenter.ins().WorldBossConfig[bossControl.currBossConfigID];this.belongList.dataProvider=new eui.ArrayCollection(i.belongRewardshow[1]),this.joinList.dataProvider=new eui.ArrayCollection(i.canRewardshow[1])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(e)},e.openCheck=function(){if(!bossControl.currBossConfigID)return!1;var t=DataCenter.ins().WorldBossConfig[bossControl.currBossConfigID];return Assert(t,"DataCenter.ins().WorldBossConfig["+bossControl.currBossConfigID+"]"+LangMgr.getValueByKey("bossIsEmpty"))?!1:!0},e}(BaseEuiView);__reflect(WorldBossRewardTipView.prototype,"WorldBossRewardTipView");var WorldBossRewardView=function(t){function e(){var e=t.call(this)||this;return e.configTimes=0,e.type=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossRewardViewSkin",this.bar.labelDisplay.visible=!1,this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.playGroup.visible=!0,this.maxPointGroup.visible=!1,this.myPointGroup.visible=!1,this.addEventTouchTap(this.play,this.onTap),this.addEventTouchTap(this.giveUp,this.onTap),this.addCustomEvent(298,this.getMyPoint),this.addCustomEvent(299,this.getMaxPoint),this.addCustomEvent(504,this.getMyPoint),this.addCustomEvent(431,this.getMaxPoint),this.type=0,t[0]?(this.configTimes=DataCenter.ins().WorldBossBaseConfig.lotteryTime>0?DataCenter.ins().WorldBossBaseConfig.lotteryTime:10,this.type=t[0]):(this.configTimes=10,this.type=0),this.bar.maximum=10*this.configTimes,this.refushInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.play,this.onTap),this.removeEventTouchTap(this.giveUp,this.onTap),TimerMgr.ins().remove(this.refushBar,this),this.removeCustomEvents()},e.prototype.refushInfo=function(){this.times=0,0==this.type?this.goods.data={type:1,id:bossControl.worldPrize,count:1}:1==this.type&&(this.goods.data={type:1,id:bossControl.worldPrize,count:1}),TimerMgr.ins().doTimer(100,10*this.configTimes,this.refushBar,this,this.TimeOver,this),this.timeLabel.text=""+this.configTimes+LangMgr.getValueByKey("activitSS")},e.prototype.refushBar=function(){this.times++;var t=10*this.configTimes-this.times;this.bar.value=t,this.timeLabel.text=Math.floor(this.configTimes-this.times/10)+LangMgr.getValueByKey("activitSS"),0>=t&&UIMgr.ins().close(e)},e.prototype.TimeOver=function(){UIMgr.ins().close(e)},e.prototype.getMyPoint=function(t){this.play.touchEnabled=!1,this.myPoint.text=t+"",this.myPointGroup.visible=!0},e.prototype.getMaxPoint=function(t){this.maxPoint.text=t[1],this.playerName.text=t[0],this.maxPointGroup.visible=!0},e.prototype.onTap=function(t){switch(t.currentTarget){case this.play:0==this.type?bossControl.upJoinLottery():1==this.type&&unionWarControl.upPlayLotteryInfo(),this.playGroup.visible=!1;break;case this.giveUp:0==this.type?UIMgr.ins().close(e):1==this.type&&UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(WorldBossRewardView.prototype,"WorldBossRewardView");var WorldBossUiInfoView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GRAYIMG_WIDTH=0,e._curMonsterID=0,e.lastWeixieList=[],e.isDelayUpdate=!1,e.curValue=1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossUiInfoViewSkin",this.clickEffc=new GameMovieClip,this.clickEffc.x=630,this.clickEffc.y=269,this.pointEff=new GameMovieClip,this.pointEff.x=110,this.pointEff.y=510,this.attEffectGroup.visible=!1,this.attEffectGroup.touchEnabled=!1,this.bloodBar.slideDuration=0,this.bloodBar0.labelFunction=function(t,e){return""},this.grayImg.source="bosshp2",this.grayImgMask=new egret.Rectangle(0,0,this.grayImg.width,this.grayImg.height),this.grayImg.mask=this.grayImgMask,this.GRAYIMG_WIDTH=this.grayImg.width,this.addCustomEvent(505,this.updateBeAttackList),this.addCustomEvent(303,this.refushActList),this.addCustomEvent(304,this.refushcanPlayList),this.addCustomEvent(444,this.reflashBlood),this.addCustomEvent(297,this.huDunChange),this.addCustomEvent(305,this.reliveInfoChange),this.addCustomEvent(306,this.worldBossEnd),this.addCustomEvent(363,this.refushcanPlayList),this.addCustomEvent(375,this.bossResult),this.addEventTouchTap(this.attackBoss,this.onTap),this.addEventTouchTap(this.attackPlayer,this.onTap),this.addEventTouchTap(this.belongGroup,this.onTap),this.addEventTouchTap(this.tipBtn,this.onTap),this.addEventTouchTap(this.attguishu,this.onTap),TimerMgr.ins().remove(this.reflashAtkInfo,this),TimerMgr.ins().doTimer(200,0,this.reflashAtkInfo,this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.hudun.visible=!1,this.visible=!0,this.attackBtnGroup.visible=""==bossControl.winner,this.updateBaseInfo(),this.refushShowInfo(),this.reflashAtkInfo(),this.refushActList(),this.refushcanPlayList(),this.reflashBlood()},e.prototype.updateBaseInfo=function(){this.bossConfig=DataCenter.ins().MonstersConfig[bossControl.monsterID],this.bossConfig&&(this._curMonsterID=bossControl.monsterID,this.nameTxt.text=this.bossConfig.name,this.head.source="monhead"+this.bossConfig.head+"_png",this.lvTxt.text="Lv."+this.bossConfig.level)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.clickEffc),DisplayUtils.removeFromParent(this.nextEff),DisplayUtils.removeFromParent(this.pointEff),this._curMonsterID=0},e.prototype.refushShowInfo=function(){this.leftTimeGroup.visible=!1,this.lastTime.text=DateUtils.getFormatTimeByStyle(unionWarControl.getModel().acEndTime,DateUtils.STYLE_4),TimerMgr.ins().isExists(this.showInfoTime,this)||TimerMgr.ins().doTimer(1e3,unionWarControl.getModel().acEndTime,this.showInfoTime,this)},e.prototype.showInfoTime=function(){this.lastTime.text=DateUtils.getFormatTimeByStyle(unionWarControl.getModel().acEndTime,DateUtils.STYLE_4)},e.prototype.reflashAtkInfo=function(){var t=UnitMgr.ins().getMasterList(bossControl.attHandle);if(t&&t.length>0){for(var e=t.length,i=0,n=0,o=0,s=0,r=void 0,a=0;e>a;a++){var l=t[a];if(l instanceof UnitRole){var h=l.infoModel.getAtt(0)||0,u=l.infoModel.getAtt(2)||0;i+=h,n+=u;var p=l.infoModel.getAtt(25)||0,c=l.infoModel.getAtt(26)||0;o+=p,s+=c,r||(r=l.infoModel)}}if(!r)return void(this.belongGroup.visible=!1);this.belongGroup.visible=i>0&&""==bossControl.winner;var d=!unionControl.guildID&&ActorControl.handle!=r.masterHandle||unionControl.guildID!=r.guildID?ColorUtils.YELLOW:ColorUtils.GREEN,g=r.name;if(r.isMy)g=LangMgr.getValueByKey("babelme"),d=ColorUtils.GREEN;else{var m=g.split("\n");g=m[1]?m[1]:m[0]}g=StringUtils.replaceStr(g,LangMgr.getValueByKey("color39"),d+""),this.belongNameTxt.textFlow=TextUtils.generateTextFlow("|C:"+d+"&T:"+g),this.roleHead.source="yuanhead"+r.job+r.sex,this.bloodBar0.maximum=n,this.bloodBar0.value=i,this.neigongBar0.maximum=s,this.neigongBar0.value=o}else this.belongGroup.visible=!1},e.prototype.refushActList=function(){this.isDelayUpdate||(this.isDelayUpdate=!0,TimerMgr.ins().doTimer(500,1,this.updateActList,this))},e.prototype.updateActList=function(){if(this.isDelayUpdate=!1,this.checkListVis(),UIMgr.ins().isShow(TargetListView)){var t=UIMgr.ins().getView(TargetListView);t.showTarget(!0)}},e.prototype.updateBeAttackList=function(){targetListControl.attackMeHandles.length>this.lastWeixieList.length&&this.showAttGroupEff(),this.lastWeixieList=targetListControl.attackMeHandles.slice(),targetListControl.attackMeHandles.length&&this.checkGuide()},e.prototype.showAttGroupEff=function(){var t=this;if(!this.attEffectGroup.visible){this.attEffectGroup.touchEnabled=!1,this.attEffectGroup.visible=!0;var e=egret.Tween.get(this.attEffectGroup);e.to({alpha:1},500).to({alpha:0},500).to({alpha:1},500).to({alpha:0},500).call(function(){t.attEffectGroup.visible=!1},this)}},e.prototype.refushcanPlayList=function(){this.reflashAtkInfo(),this.checkListVis(),this.refushActList()},e.prototype.checkListVis=function(){var t=UnitMgr.ins().getNoDieRole(),e=t&&t.infoModel.getAtt(0)>0&&""==bossControl.winner;this.setBtnState(e)},e.prototype.checkGuide=function(){1==copyControl.guideBossKill&&guideControl.updateByAppear()},e.prototype.setBtnState=function(t){if(this.attguishu.visible=!0,!t)return this.attackPlayer.currentState="attgsup",void(this.attackBoss.currentState="attbossup");var e=UnitMgr.ins().getEntityBymasterhHandle(gameControl.currAttackHandle)instanceof UnitRole;bossControl.attHandle==ActorControl.handle?(this.attackPlayer.currentState="attgsdis",this.attguishu.visible=!1):e?this.attackPlayer.currentState="attgsing":this.attackPlayer.currentState="attgsup",e||"attgsing"==this.attackPlayer.currentState?this.attackBoss.currentState="attbossup":this.attackBoss.currentState="attbossing"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.attackBoss:if(0==gameControl.currAttackHandle)return;gameControl.dispatchChangeAttrPoint(0);break;case this.attackPlayer:case this.belongGroup:if(bossControl.attHandle==ActorControl.handle||bossControl.attHandle==gameControl.currAttackHandle)return;if(!bossControl.canClick)return;18==MapControl.copyType?copyControl.upGuideFbAttacker():gameControl.dispatchChangeAttrPoint(bossControl.attHandle);break;case this.tipBtn:10==MapControl.copyType?UIMgr.ins().open(WorldBossRewardTipView):UIMgr.ins().open(PublicBossRewardTipView);break;case this.attguishu:tipsControl.showTips(LangMgr.getValueByKey("bossAttack"))}},e.prototype.reflashBlood=function(){if(this._curMonsterID!=bossControl.monsterID&&this.updateBaseInfo(),this.bossConfig=DataCenter.ins().MonstersConfig[bossControl.monsterID],!this.bossConfig)return this.bossBloodGroup.visible=!1,void this.checkListVis();var t=UnitMgr.ins().getEntityByHandle(bossControl.bossHandler);if(!t||!t.infoModel)return this.bossBloodGroup.visible=!1,void this.checkListVis();var e=t?t.infoModel:null;e?(this.bloodBar.maximum=e.getAtt(2),this.bloodBar.value=e.getAtt(0),this.bossBloodGroup.visible=this.bloodBar.value>0):(this.bloodBar.maximum=this.bossConfig.hp,this.bloodBar.value=this.bossConfig.hp,this.bossBloodGroup.visible=this.bloodBar.value>0),this.curValue=Math.floor(this.bloodBar.value/this.bloodBar.maximum*100),this.tweenBlood()},e.prototype.huDunChange=function(){bossControl.shieldType?bossControl.curShield>0&&(TimerMgr.ins().isExists(this.setTimeShieldChange,this)||TimerMgr.ins().doTimer(1e3,0,this.setTimeShieldChange,this),this.setTimeShieldChange()):this.setHpShieldChange()},e.prototype.setHpShieldChange=function(){if(bossControl.curShield&&bossControl.curShield>0){this.hudun.visible=!0;var t=Math.ceil(bossControl.curShield/bossControl.totalShield*100);this.hudunbloodBar.value=t}else this.hudun.visible=!1},e.prototype.setTimeShieldChange=function(){this.hudunbloodBar.value=bossControl.curShield,this.hudunbloodBar.maximum=bossControl.totalShield,bossControl.curShield>0?this.hudun.visible=!0:(TimerMgr.ins().remove(this.setTimeShieldChange,this),this.hudun.visible=!1),bossControl.curShield--},e.prototype.bossResult=function(t){18==t.fbType&&(this.attackBtnGroup.visible=this.attackPlayer.visible=this.attackBoss.visible=!1)},e.prototype.worldBossEnd=function(){var t=this;if(TimerMgr.ins().remove(this.reflashAtkInfo,this),10==MapControl.copyType){this.endGroup.visible=!0,this.winnerName.text=LangMgr.getValueByKey("bossWinner",bossControl.winner);var e=Math.ceil((bossControl.worldBossEndTime-egret.getTimer())/1e3);this.leftTime.text=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_4),TimerMgr.ins().doTimer(1e3,e,function(){e--,t.leftTime.text=DateUtils.getFormatTimeByStyle(e,DateUtils.STYLE_4),0==e&&copyControl.upExitFb()},this)}this.belongGroup.visible=this.attackBtnGroup.visible=this.attackPlayer.visible=this.attackBoss.visible=!1},e.prototype.reliveInfoChange=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView),this.refushActList()},e.prototype.tweenBlood=function(){var t=this,e=this.curValue*this.GRAYIMG_WIDTH/100,i=this;if(egret.Tween.removeTweens(this.grayImgMask),!(3>e)){var n=egret.Tween.get(this.grayImgMask,{onChange:function(){i.grayImg&&(i.grayImg.mask=t.grayImgMask)}},i);n.to({width:e-3},1e3).call(function(){0>=e&&(i.grayImgMask.width=this.GRAYIMG_WIDTH,egret.Tween.removeTweens(this.grayImgMask))},i)}},e}(BaseEuiView);__reflect(WorldBossUiInfoView.prototype,"WorldBossUiInfoView");var BossHomeItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t,e,i="",n=this.data,o=DataCenter.ins().WorldBossConfig[n.id];this.list.itemRenderer=ItemBase,this.config=o,this.list.dataProvider=new eui.ArrayCollection(o.showReward);var s=2==n.bossState;this.addEventTouchTap(this.boxBtn,this.onTap),this.infoTxt0.touchEnabled=!0;var r;for(var a in DataCenter.ins().BossHomeConfig)if(-1!=DataCenter.ins().BossHomeConfig[a].boss.lastIndexOf(n.id)){r=DataCenter.ins().BossHomeConfig[a];break}if(vipControl.lv>=r.vip?o.zsLevel>0?(t=reincarnateControl.lv>=o.zsLevel,i=LangMgr.getValueByKey("fbRotationOpen",o.zsLevel)):(t=ActorControl.level>=o.level,i=LangMgr.getValueByKey("tipsOpenLevel",o.level)):(t=!1,i=LangMgr.getValueByKey("bossVipOpen",vipControl.getVipStr(r.vip))),s&&(i=LangMgr.getValueByKey("bossKillPlayer")),this.levelRequire.text=i,this.bar.value=n.hp,this.bar.maximum=100,e=DataCenter.ins().MonstersConfig[o.bossId],this.challengeBtn.visible=!s,this.challengeBtn.name="homeChallenge",this.challengeBtn.visible){var l=(bossControl.cdTime-egret.getTimer())/1e3;n.challengeing&&l>0?(this.challengeBtn.enabled=!1,this.challengeBtn.touchEnabled=!1,this.updateCDTime(),TimerMgr.ins().doTimer(100,0,this.updateCDTime,this)):(this.challengeBtn.label=LangMgr.getValueByKey("personFight"),this.challengeBtn.enabled=!0,this.challengeBtn.touchEnabled=!0,TimerMgr.ins().remove(this.updateCDTime,this))}if(this.barBg.visible=this.bar.visible=!0,e){this.head.source="monhead"+e.head+"_png";var h=o.zsLevel>0?LangMgr.getValueByKey("numberRotation",o.zsLevel):LangMgr.getValueByKey("numberLevel",o.level);this.nameTxt0.text=h,this.nameTxt.text=""+e.name}this.challengeBtn.visible=this.challengeBtn.visible&&t,this.needLv.visible=!this.challengeBtn.visible},e.prototype.updateCDTime=function(){var t=(bossControl.cdTime-egret.getTimer())/1e3;this.challengeBtn.label=LangMgr.getValueByKey("bossClood")+"（"+t.toFixed(0)+"）",0>=t&&(this.challengeBtn.label=LangMgr.getValueByKey("personFight"),this.challengeBtn.enabled=!0,this.challengeBtn.touchEnabled=!0,TimerMgr.ins().remove(this.updateCDTime,this))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.boxBtn:warnControl.show(this.config.rewardsDesc,null,this,null,null,"sure")}},e}(BaseItemRender);__reflect(BossHomeItemRenderer.prototype,"BossHomeItemRenderer");var BossHomeTitleItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.itemIndex+1;DataCenter.ins().BossHomeConfig[t];this.bg.source="vipbossb"+t}},e}(BaseItemRender);__reflect(BossHomeTitleItemRenderer.prototype,"BossHomeTitleItemRenderer");var BossItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t,e,i="",n=this.data,o=DataCenter.ins().WorldBossConfig[n.id];if(this.list.itemRenderer=this.list.itemRenderer||ItemBase,this.config=o,this.list.dataProvider){var s=this.list.dataProvider;s.source=o.showReward.concat()}else this.list.dataProvider=new eui.ArrayCollection(o.showReward.concat());var r=n.isDie;if(this.addEventTouchTap(this.boxBtn,this.onTap),this.addEventRemovedFromStage(this,this.onRemove),this.infoTxt0.touchEnabled=!0,t=BossControl.isCanChallenge(o),i=o.samsaraLv>0?""+o.showName+LangMgr.getValueByKey("open",""):o.zsLevel>0?LangMgr.getValueByKey("fbRotationOpen",o.zsLevel):LangMgr.getValueByKey("tipsOpenLevel",o.level),this.levelRequire.text=i,this.bar.value=n.hp,this.bar.maximum=100,e=DataCenter.ins().MonstersConfig[o.bossId],this.timeTxt.visible=r,this.timeTxt.visible&&(this.updateTime(),TimerMgr.ins().doTimer(100,0,this.updateTime,this)),this.challengeBtn.visible=!r,2==o.type?this.challengeBtn.name="publicChallenge":4==o.type&&(this.challengeBtn.name="holyAreaBossChallenge"),this.challengeBtn.visible){var a=(bossControl.cdTime-egret.getTimer())/1e3;n.challengeing&&a>0?(this.challengeBtn.enabled=!1,this.challengeBtn.touchEnabled=!1,this.updateCDTime(),TimerMgr.ins().doTimer(100,0,this.updateCDTime,this)):(this.challengeBtn.label=LangMgr.getValueByKey("personFight"),this.challengeBtn.enabled=!0,this.challengeBtn.touchEnabled=!0,TimerMgr.ins().remove(this.updateCDTime,this))}if(this.barBg.visible=this.bar.visible=!0,e){this.head.source="monhead"+e.head+"_png";var l=void 0;l=o.samsaraLv>0?o.showName:o.zsLevel>0?LangMgr.getValueByKey("numberRotation",o.zsLevel):LangMgr.getValueByKey("numberLevel",o.level),this.nameTxt0.text=l,this.nameTxt.text=""+e.name}this.needLv.visible=!t,this.challengeBtn.visible=this.challengeBtn.visible&&t},e.prototype.updateCDTime=function(){var t=(bossControl.cdTime-egret.getTimer())/1e3;this.challengeBtn.label=LangMgr.getValueByKey("bossClood")+"（"+t.toFixed(0)+"）",0>=t&&(this.challengeBtn.label=LangMgr.getValueByKey("personFight"),this.challengeBtn.enabled=!0,this.challengeBtn.touchEnabled=!0,TimerMgr.ins().remove(this.updateCDTime,this))},e.prototype.updateTime=function(){var t=this.data,e=t.relieveTime-egret.getTimer();this.timeTxt.text=LangMgr.getValueByKey("bossPlayRefush",DateUtils.getFormatBySecond(Math.floor(e/1e3),1)),0>=e&&(this.timeTxt.visible=!1,bossControl.upWorldBossInfo(2),TimerMgr.ins().remove(this.updateTime,this))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.boxBtn:warnControl.show(this.config.rewardsDesc,null,this,null,null,"sure")}},e.prototype.onRemove=function(){this.removeEventTouchTap(this.boxBtn,this.onTap),this.removeEventRemovedFromStage(this,this.onRemove),TimerMgr.ins().removeAll(this)},e}(BaseItemRender);__reflect(BossItemRenderer.prototype,"BossItemRenderer");var BossRewardsItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.rewards;this.experience.data=t[0],this.randomRune.data=t[1],this.runeCream.data=t[2];var e=copyBabelControl.getNextOpenLevel();if(e){this.target.data||(this.target.data=e.showIcon);var i=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel],n=DataCenter.ins().ItemConfig[e.showIcon],o=ItemUtils.getQuality(n),s=LangMgr.getValueByKey("bossLayerLock");o==CopyBabelPanel.RunType&&(s=LangMgr.getValueByKey("bossLayerGet")),i.group==e.group?this.leftlabel.text=""+e.layer+s:this.leftlabel.text=LangMgr.getValueByKey("bossMorePass",e.id-i.id)+s}this.labelGroup.visible=this.target.visible=e&&38!=MapControl.copyType},e}(BaseItemRender);__reflect(BossRewardsItemRenderer.prototype,"BossRewardsItemRenderer");var DarkBossRemindItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.star=0,e.canChallenge=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);for(var e=DataCenter.ins().WorldBossConfig[this.data.id],i=e.showReward.map(function(t){return DataCenter.ins().DarkEquipConfig[t]}),n=0,o=0;o<i.length;o++){var s=i[o];s&&(n=s.star>n?s.star:n)}this.star=n,this.levelShow.text=LangMgr.getValueByKey("stageNumberTxt",n);var r=this.data,a=DataCenter.ins().WorldBossConfig[r.id];this.canChallenge=BossControl.isCanChallenge(a),a.darkforce&&(this.canChallenge=r.canInto),this.redpoint&&(this.redpoint.visible=this.canChallenge&&!this.checkBoxs.selected&&this.star==this.data.maxStart),this.addEventRemovedFromStage(this,this.onRmove),this.addEventTouchTap(this.checkBoxs,this.onTap)},e.prototype.onTap=function(t){this.redpoint.visible=this.canChallenge&&!this.checkBoxs.selected&&this.star==this.data.maxStart},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this.checkBoxs,this.onTap)},e}(PublicBossRemindItemRenderer);__reflect(DarkBossRemindItemRenderer.prototype,"DarkBossRemindItemRenderer");var GodWeaponBossRemindItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._move=!1,e._lastX=0,e._lastY=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventChange(this.checkBoxs,this.onChange),this.addEventTouchBegin(this.checkBoxs,this.onTouchBegin1)},e.prototype.onChange=function(){this.setting()},e.prototype.setting=function(){var t=this;egret.callLater(function(){bossControl.setBossSetting(t.data.id,t.checkBoxs.selected)},this)},e.prototype.onTouchBegin1=function(t){this._lastX=t.stageX,this._lastY=t.stageY,this._lastSelect=this.checkBoxs.selected,this._move=!1,this.$stage&&(this.addEventTouchMove(this.$stage,this.onTouchMove1),this.addEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.onTouchMove1=function(t){MathUtils.getDistance(this._lastX,this._lastY,t.stageX,t.stageY)>20&&(this._move=!0)},e.prototype.onTouchEnd1=function(){this._move&&(this.checkBoxs.selected=this._lastSelect,this._move=!1),this.$stage&&(this.removeEventTouchMove(this.$stage,this.onTouchMove1),this.removeEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.dataChanged=function(){var t,e=this.data,i=DataCenter.ins().WorldBossConfig[e.id],n=1e3*reincarnateControl.lv+ActorControl.level,o=1e3*i.zsLevel[0]+i.level,s=n>=o;t=i.samsaraLv>0?i.showName:i.zsLevel[0]>0?""+i.zsLevel[0]+LangMgr.getValueByKey("numberRotation","")+"-"+i.zsLevel[1]+LangMgr.getValueByKey("numberRotation",""):""+i.level+LangMgr.getValueByKey("numberLevel",""),this.checkBoxs.visible=s,s&&(this.checkBoxs.selected=bossControl.getBossRemindByIndex(e.id)),this.txt.visible=!s,this.checkBoxs.name=e.id+"";var r=DataCenter.ins().MonstersConfig[i.bossId];this.bossName.text=r.name,this.levelShow.text=t},e}(BaseItemRender);__reflect(GodWeaponBossRemindItemRenderer.prototype,"GodWeaponBossRemindItemRenderer");var HomeBossRemindItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._move=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchBegin(this.checkBoxs,this.onTouchBegin1),this.addEventChange(this.checkBoxs,this.onChange)},e.prototype.onChange=function(){this.setting()},e.prototype.setting=function(){var t=this;egret.callLater(function(){bossControl.setBossSetting(t.data.id,t.checkBoxs.selected)},this)},e.prototype.onTouchBegin1=function(t){this._lastSelect=this.checkBoxs.selected,this._move=!1,this.$stage&&(this.addEventTouchMove(this.$stage,this.onTouchMove1),this.addEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.onTouchMove1=function(){this._move=!0},e.prototype.onTouchEnd1=function(){this._move&&(this.checkBoxs.selected=this._lastSelect,this._move=!1),this.$stage&&(this.removeEventTouchMove(this.$stage,this.onTouchMove1),this.removeEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.dataChanged=function(){var t,e=this.data,i=DataCenter.ins().WorldBossConfig[e.id];for(var n in DataCenter.ins().BossHomeConfig)if(-1!=DataCenter.ins().BossHomeConfig[n].boss.lastIndexOf(e.id)){t=DataCenter.ins().BossHomeConfig[n];break}var o=!1;t&&vipControl.lv>=t.vip?(o=i.zsLevel>0?reincarnateControl.lv>=i.zsLevel:ActorControl.level>=i.level,o||(this.txt.text=LangMgr.getValueByKey("homeNoFight")),this.levelShow.text=i.zsLevel>0?LangMgr.getValueByKey("numberRotation",i.zsLevel):LangMgr.getValueByKey("numberLevel",i.level)):(o=!1,this.levelShow.text="",this.txt.text=LangMgr.getValueByKey("homeNOVip")),this.checkBoxs.visible=o,o&&(this.checkBoxs.selected=bossControl.getBossRemindByIndex(e.id)),this.txt.visible=!this.checkBoxs.visible,this.checkBoxs.name=e.id+"";var s=DataCenter.ins().MonstersConfig[i.bossId];this.bossName.text=s.name},e}(BaseItemRender);__reflect(HomeBossRemindItemRenderer.prototype,"HomeBossRemindItemRenderer");var PersonalBossItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="PersonalBossItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().MonstersConfig[t.bossId],i="";i=t.monthcard?LangMgr.getValueByKey("bossVipLeve1"):t.specialCard?LangMgr.getValueByKey("bossVipLeve2"):t.privilege?LangMgr.getValueByKey("bossVipLeve3"):t.zsLevel>0?LangMgr.getValueByKey("numberRotation",t.zsLevel):LangMgr.getValueByKey("numberLevel",t.levelLimit),this.nameTxt.text=e.name+"·"+i;var n=copyControl.getFbDataById(this.data.id),o=n.getPlayCount()<=0;if(o)this.enabled=!1,this.currentState="disabled",this.notOpenImg.visible=!1;else if(this.enabled=!0,t.monthcard)this.notOpenImg.visible=payControl.monthDay?!1:!0;else if(t.privilege)this.notOpenImg.visible=2!=payControl.forevetCard;else if(t.specialCard)this.notOpenImg.visible=payControl.franchise?!1:!0;else{var s=1e3*reincarnateControl.lv+ActorControl.level,r=1e3*this.data.zsLevel+this.data.levelLimit;this.notOpenImg.visible=r>s}},e}(BaseItemRender);__reflect(PersonalBossItemRenderer.prototype,"PersonalBossItemRenderer");var AmusementType21DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getleftTime=function(){if(!this.isOpenActivity())return 0;var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t},e.prototype.checkRedPoint=function(){return!1},e}(AmusementBaseDataVo);__reflect(AmusementType21DataVo.prototype,"AmusementType21DataVo");var AmusementType22DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._refreshTime=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.tScore=t[0],this.refreshFree=1==t[1],this._refreshTime=t[2],this._oldTimer=egret.getTimer(),this.shopItems=[],this.shopItems.length=t[3].length;for(var e=0;e<t[3].length;e++){var i=new SpringBeginShopVo;i.id=t[3][e][0],i.itemID=t[3][e][1],i.itemCount=t[3][e][2],i.materialNum=i.price=t[3][e][3],i.zhekou=t[3][e][4],i.state=t[3][e][5],this.shopItems[e]=i}this.scoreItems=[],this.scoreItems.length=t[4].length;for(var e=0;e<t[4].length;e++){var i=new SpringBeginShopVo;i.id=t[4][e][0],i.itemID=t[4][e][1],i.itemCount=t[4][e][2],i.score=t[4][e][3],this.scoreItems[e]=i}},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getleftTime=function(){if(!this.isOpenActivity())return 0;var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t},e.prototype.checkRedPoint=function(){if(this.refreshFree)return!0;var t=amusementControl.getConfig22_3(this.id);if(t&&this.tScore>=t.score)return!0;var e=backpackControl.getBagItemById(DataCenter.ins().Amusement22_1Config[this.id][1].freshItem);return e&&e.count>0},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e.prototype.getRefreshTime=function(){return this._refreshTime-(egret.getTimer()-this._oldTimer)/1e3},e}(AmusementBaseDataVo);__reflect(AmusementType22DataVo.prototype,"AmusementType22DataVo");var WorldBossItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.onRemove)},e.prototype.dataChanged=function(){if(this.data){var t=DataCenter.ins().WorldBossConfig[this.data.id];if(t){var e=DataCenter.ins().MonstersConfig[t.bossId];TimerMgr.ins().remove(this.updateTime,this),this.titleText.text=e.name,2==this.data.bossState||0==this.data.bossState?(this.killImg.visible=!1,this.updateTime(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)):1==this.data.bossState?(this.timeTxt.text=LangMgr.getValueByKey("bossUpdate"),this.killImg.visible=!0):this.killImg.visible=!1}}},e.prototype.updateTime=function(){var t=this.data.relieveTime-egret.getTimer();this.timeTxt.text=""+DateUtils.getFormatBySecond(Math.floor(t/1e3),1),0>=t&&(TimerMgr.ins().remove(this.updateTime,this),this.timeTxt.text="")},e.prototype.onRemove=function(t){this.removeEventRemovedFromStage(this,this.onRemove),TimerMgr.ins().remove(this.updateTime,this)},e}(BaseItemRender);__reflect(WorldBossItemRenderer.prototype,"WorldBossItemRenderer");var WorldBossMainItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=WorldBossItemRenderer,this.addEventItemTap(this.list,this.onTap),this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData},e.prototype.onTap=function(t){var e=this.listData.getItemAt(t.itemIndex);this.data.clickCall(e)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.listData.source=e.arr,this.list.selectedIndex=e.selectIndex,1==e.type?this.title.source="title_mijingboss":7==e.type&&(this.title.source="title_anzhimijingboss");var i=!1;bossControl.worldBossLeftTime[e.type]&&(i=bossControl.checkWorldBossRedPoint(e.type)),this.redPoint.visible=i},e}(BaseItemRender);__reflect(WorldBossMainItemRenderer.prototype,"WorldBossMainItemRenderer");var CalcForceControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isActList={},e.ngList={},e.neiGongList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downDataChange=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.neiGongList[t]||(this.neiGongList[t]=new CalcForceVo);var n=this.neiGongList[t];n.roleId=t,n.init(e.slice(0,-1));var o=e[e.length-1];this.isActList[t]||(this.isActList[t]={}),this.isActList[t].act=o?1:0,this.ngList[t]=o?1:0,EventMgr.ins().dispatch(218)},e.prototype.downAct=function(t,e){this.ngList[t]=e,this.isActList[t].isShow=!1,0==this.isActList[t].act&&1==e&&(this.isActList[t].isShow=!0),this.isActList[t].act=e,EventMgr.ins().dispatch(219)},e.prototype.upUpLevel=function(t){return[t]},e.prototype.upUpStage=function(t){return[t]},e.prototype.upAct=function(t){return[t]},e.prototype.canUp=function(){if(copyControl.guanqiaID<DataCenter.ins().CalcForceBaseConfig.openGuanqia)return!1;for(var t=Math.min(heroControl.subRolesLen,this.neiGongList.length),e=0;t>e;e++)if(this.canUpById(e))return!0;return!1},e.prototype.canUpById=function(t){if(this.neiGongList[t]){if(copyControl.guanqiaID<=DataCenter.ins().CalcForceBaseConfig.openGuanqia)return!1;if(this.neiGongList[t].stage>=DataCenter.ins().CalcForceBaseConfig.maxStage)return!1;if(this.neiGongList[t].canMix||this.neiGongList[t].getCanLevelUp())return!0}return!1},__decorate([down(1,[2].concat(ByteConst.CalcForceVos,[0]))],e.prototype,"downDataChange",null),__decorate([down(3,[2,3])],e.prototype,"downAct",null),__decorate([up(1,[2])],e.prototype,"upUpLevel",null),__decorate([up(2,[2])],e.prototype,"upUpStage",null),__decorate([up(3,[2])],e.prototype,"upAct",null),e=__decorate([protocolsId(51)],e)}(BaseSystem);__reflect(CalcForceControl.prototype,"CalcForceControl");var CalcForceVo=function(){function t(){this.roleId=0,this.level=0,this.stage=0,this.exp=0}return t.prototype.init=function(t){this.level=t[0],this.stage=t[1],this.exp=t[2];DataCenter.ins().CalcForceStageConfig[this.stage][this.level];
this.canMix=this.level>0&&this.level%DataCenter.ins().CalcForceBaseConfig.levelPerStage==0},t.prototype.getCanLevelUp=function(){var t=DataCenter.ins().CalcForceStageConfig[this.stage][this.level];if(!t)return!1;var e=t.totalExp-this.exp,i=Math.ceil(e/t.addExp);return ActorControl.gold>=i*t.costMoney&&ActorControl.gold>=1e6},t}();__reflect(CalcForceVo.prototype,"CalcForceVo");var CalcForcePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLights=[],e.effs={},e.starPoint=[],e.isNext=!1,e.isAutoUp=!1,e.signLevel=0,e.mcPos=[[52,77,0],[47,55,18],[55,30,36],[75,12,54],[110,0,72],[75,15,108],[100,30,126],[110,60,144],[100,90,162],[85,120,180]],e.curRole=0,e.canUp=!1,e.mcWidth=160,e.mcHeight=160,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.upLevelMc=new GameMovieClip,this.stageImg=BitmapNumber.ins().createNumPic(0,"ng0"),this.stageImg.x=25,this.stageImg.y=12,this.stageGroup.addChild(this.stageImg),this._shap=new egret.Shape,this.lineGroup.addChild(this._shap),this.lineBg.mask=this._shap,this._shap.x=this._shap.y=this.lineGroup.width>>1,this._shap.rotation=-196,this.circleMc=new GameMovieClip,this.circleMc.mask=new egret.Rectangle(-this.mcWidth>>1,-this.mcHeight>>1,this.mcWidth,this.mcHeight),this.circleMc.x=80,this.circleMc.y=75,this.mcGroup.addChild(this.circleMc),this.moveInMc=new GameMovieClip,this.moveInMc.x=70,this.moveInMc.y=65,this.ball.addChild(this.moveInMc),this.stageMc=new GameMovieClip,this.stageMc.x=52,this.stageMc.y=32,this.stageGroup.addChild(this.stageMc);for(var t=calcForceControl.neiGongList[this.curRole],e=t?t.level:0,i=0;10>i;i++){var n=new egret.Point(this["eff_"+i].x,this["eff_"+i].y);this.starPoint[i]=n,this.isLights[i]=e>i}this.eff=new GameMovieClip,this.eff.x=this.UplevelBtn0.x+this.UplevelBtn0.width/2,this.eff.y=this.UplevelBtn0.y+this.UplevelBtn0.height/2,this.eff.scaleX=1,this.eff.scaleY=1,this.eff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.updateUIState(),this.curRole=t[0],this.lastLevel=-1,this.circleMc.playFile(PATH_EFF+"neigongzhongjianeff",-1),this.moveInMc.parent||this.ball.addChild(this.moveInMc),this.addEventTouchTap(this.upBtn,this.onClick),this.addEventTouchTap(this.mixBtn,this.onClick),this.addEventTouchTap(this.oneKeyUp,this.onClick),this.addEventTouchTap(this.UplevelBtn0,this.onClick),this.addCustomEvent(218,this.refushPanelInfo),this.addCustomEvent(461,this.setBtnStatuBarinfo),this.addCustomEvent(219,this.showActPanel),this.addCustomEvent(181,this.updateUIState),this.refushPanelInfo(!0),this.showActPanel()},e.prototype.updateUIState=function(){this.currentState=payControl.franchise?"card":"nor"},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchTap(this.upBtn,this.onClick),this.removeEventTouchTap(this.mixBtn,this.onClick),this.removeEventTouchTap(this.oneKeyUp,this.onClick),this.seteffectPost();for(var i in this.effs)DisplayUtils.removeFromParent(this.effs[i]),this.effs[i]&&egret.Tween.removeTweens(this.effs[i]);DisplayUtils.removeFromParent(this.eff),this.stopAutoUp()},e.openCheck=function(){var t=DataCenter.ins().CalcForceBaseConfig.openLevel;return ActorControl.level<t?(tipsControl.showTips(LangMgr.getValueByKey("ngOpen",t)),!1):!0},e.prototype.showActPanel=function(){if(calcForceControl.isActList[this.curRole].isShow){calcForceControl.isActList[this.curRole].isShow=!1,CommonFun.show(0,LangMgr.getValueByKey("equipment15"),"jneigong_png");var t=UnitMgr.ins().getMainRole(this.curRole);t&&t.updateNeiGong()}this.showAct.visible=calcForceControl.ngList[this.curRole]>0,this.showAct.visible?(this.Activation.visible=!1,DisplayUtils.removeFromParent(this.eff)):(this.Activation.visible=!0,this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||this.UplevelBtn0.parent.addChild(this.eff));var e=DataCenter.ins().CalcForceBaseConfig.openGuanqia;copyControl.guanqiaID<=e&&(this.redPointAct0.visible=!1),this.activeTipsTxt0.text=LangMgr.getValueByKey("ngTips1",e+1)},e.prototype.onChange=function(){this.stopAutoUp(),this.refushPanelInfo()},e.prototype.refushPanelInfo=function(t){this.data=calcForceControl.neiGongList[this.curRole],this.data&&(this.cruLevelCfg=DataCenter.ins().CalcForceStageConfig[this.data.stage][this.data.level],this.cruLevelCfg&&(this.lastLevel!=this.data.level&&this.effectShow(t),this.lastLevel=this.data.level,this.setAttrCost(),this.setPowerShow(),this.setBtnStatuBarinfo(),this.seteffectPost()))},e.prototype.setPowerShow=function(){this._totalPower=BackpackControl.getAttrPower(this.cruLevelCfg.attribute),this.powerPanel.setPower(this._totalPower)},e.prototype.setAttrCost=function(){this.stageImg.x=this.data.stage<10?40:25,BitmapNumber.ins().changeNum(this.stageImg,this.data.stage,"ng0");var t=0,e=DataCenter.ins().MonthCardConfig.neiGongGoldPrecent/100,i=payControl.getIsForeve()?1-e:1;this.data.canMix||(t=Math.floor(this.cruLevelCfg.costMoney*i));var n="";n=ActorControl.gold>=t?"|C:"+ColorUtils.GREEN+"&T:":"|C:"+ColorUtils.RED+"&T:",this.canUp=ActorControl.gold>=t,this.costlable.textFlow=TextUtils.generateTextFlow(n+t);var o=this.cruLevelCfg.attribute;o.sort(AttributeData.sortAttribute);for(var s=o.length,r=0;3>r;r++)this["attr"+r].text=s>r?AttributeData.getAttStrByType(o[r],1):"";var a=0,l=0;this.data.level==DataCenter.ins().CalcForceBaseConfig.levelPerStage?(a=this.data.stage+1,l=0):(a=this.data.stage,l=this.data.level+1);var h=DataCenter.ins().CalcForceStageConfig[a],u=h?h[l]:null;if(u){var p="",c=u.attribute;c.sort(AttributeData.sortAttribute);for(var r=0;3>r;r++){if(s>r){var d=o[r];p=this.getAttrByType(c,d)}this["addAttr"+r].text=p,this["arrow"+r].visible=""!=p}this.isNext=!0}else{for(var r=0;3>r;r++)this["addAttr"+r].text="",this["arrow"+r].visible=!1;this.isNext=!1}},e.prototype.effectShow=function(t){for(var e=this.data.level,i=0;10>i;i++)this["point_"+i].source=i>=e?"neigongzhuzi2":"neigongzhuzi1";e>0?DisplayUtils.drawCir(this._shap,(this.lineGroup.width>>1)+2,212*(e-1)/9):this._shap.graphics.clear();for(var i in this.effs)DisplayUtils.removeFromParent(this.effs[i]),this.effs[i]=null;if(t)for(var n=calcForceControl.neiGongList[this.curRole],o=n?n.level:0,i=0;10>i;i++)this.isLights[i]=o>i;for(var i=0;e>i;i++){var s=this.effs[i]||new GameMovieClip;s.x=1,s.y=30,s.scaleX=1,s.scaleY=1,this.effs[i]=s,this["eff_"+i].addChild(s),this.isLights[i]?s.playFile(PATH_EFF+"feishengfire",-1):(this.isLights[i]=!0,this.moveEffectOut(i))}},e.prototype.setBtnStatuBarinfo=function(){var t=this.data.canMix;payControl.franchise?this.oneKeyUp.visible=!t&&this.isNext:(this.upBtn.visible=!t&&this.isNext,this.oneKeyUp.visible=!t&&this.isNext),this.mixBtn.visible=t,this.costInfo.visible=!t&&this.isNext,this.maxDesc.visible=!this.isNext,t?(this.expLabel.text="",this.upDataExpMcBall(this.cruLevelCfg.totalExp,this.cruLevelCfg.totalExp)):this.cruLevelCfg&&(this.upDataExpMcBall(this.data.exp,this.cruLevelCfg.totalExp),this.expLabel.text=this.data.exp+"/"+this.cruLevelCfg.totalExp)},e.prototype.onClick=function(t){var e=this;if(!this.isNext)return void tipsControl.showTips(LangMgr.getValueByKey("magicalrfull"));switch(t.target){case this.upBtn:this.canUp?(calcForceControl.upUpLevel(this.curRole),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE)):storeControl.openBuyGoldWin(!1)||tipsControl.showTips(LangMgr.getValueByKey("bossMoneyEnought"));break;case this.mixBtn:this.moveEffectIn(),TimerMgr.ins().doTimer(400,1,function(){calcForceControl.upUpStage(e.curRole),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE)},this);break;case this.oneKeyUp:if(payControl.franchise)if(this.isAutoUp)this.stopAutoUp();else{if(!this.canUp)return void tipsControl.showTips(LangMgr.getValueByKey("bossMoneyEnought"));this.isAutoUp=!0,this.oneKeyUp.label=LangMgr.getValueByKey("wingStop"),TimerMgr.ins().doTimer(300,0,this.autoUpStar,this)}else{var i=warnControl.show(LangMgr.getValueByKey("ngTips2"),null,null,function(){UIMgr.ins().open(WelfareView,3)});i.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("smeltActivity"))}break;case this.UplevelBtn0:calcForceControl.upAct(this.curRole)}},e.prototype.stopAutoUp=function(){this.isAutoUp=!1,this.oneKeyUp&&(this.oneKeyUp.label=LangMgr.getValueByKey("ngTips3")),TimerMgr.ins().remove(this.autoUpStar,this)},e.prototype.autoUpStar=function(){this.canUp&&0==this.data.canMix&&this.isNext?(calcForceControl.upUpLevel(this.curRole),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE)):this.stopAutoUp()},e.prototype.moveEffectOut=function(t){var e=this,i=egret.Tween.get(this.eff_9);i.call(function(){e.moveInMc.playFile(PATH_EFF+"neigongbaozhaeff",1,null,!1)},this).wait(100).call(function(){DisplayUtils.removeFromParent(e.upLevelMc),e.ball.addChild(e.upLevelMc),e.upLevelMc.x=e.mcPos[t][0],e.upLevelMc.y=e.mcPos[t][1],e.upLevelMc.rotation=e.mcPos[t][2],e.upLevelMc.playFile(PATH_EFF+"piaodongqipaohuang",1,function(){e.effs[t]&&e.effs[t].playFile(PATH_EFF+"feishengfire",-1);for(var i=e.data.level,n=0;10>n;n++)e["point_"+n].source=n>=i?"neigongzhuzi2":"neigongzhuzi1";i>0?DisplayUtils.drawCir(e._shap,(e.lineGroup.width>>1)+2,212*(i-1)/9):e._shap.graphics.clear()},!0)},this)},e.prototype.moveEffectIn=function(){var t=this;for(var e in this.effs){var i=egret.Tween.get(this["eff_"+e]);i.to({x:280,y:320,scaleX:1,scaleY:1},390).to({alpha:0},10)}for(var e=0;10>e;e++)this.isLights[e]=!1;var n=egret.Tween.get(this.eff_9);n.wait(400).call(function(){t.moveInMc.playFile(PATH_EFF+"neigongbaozhaeff",1,null,!1)},this).call(function(){t.stageMc.parent||t.stageGroup.addChild(t.stageMc),t.stageMc.playFile(PATH_EFF+"neigongshengjieff",1,function(){DisplayUtils.removeFromParent(t.stageMc)})},this);for(var e=0;10>e;e++)this["point_"+e].source="neigongzhuzi2"},e.prototype.getAttrByType=function(t,e){for(var i=t.length,n=0;i>n;n++)if(t[n].type==e.type&&t[n].value!=e.value)return" "+AttributeData.getAttStrByType(t[n],1,"",!1,!1);return""},e.prototype.seteffectPost=function(){for(var t=this.data?this.data.level:0,e=0;10>e;e++){var i=this.starPoint[e];i&&(this["eff_"+e].x=t>e?i.x:280,this["eff_"+e].y=t>e?i.y:320,this["eff_"+e].scaleX=1,this["eff_"+e].scaleY=1,this["eff_"+e].alpha=1)}},e.prototype.upDataExpMcBall=function(t,e){var i=this,n=this.circleMc.mask,o=this.mcHeight*(t/e),s=(o>=this.mcHeight?this.mcHeight:o,(this.mcHeight>>1)-o),r=egret.Tween.get(n,{onChange:function(){i.circleMc.mask=n},onChangeObj:this});r.to({y:s},200).call(function(){},this)},e.prototype.destoryView=function(){},e}(BasePanel);__reflect(CalcForcePanel.prototype,"CalcForcePanel");var CampWarControl=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e.battleRanks=[],e.myRank=0,e.myScore=0,e.awardID=0,e._openLeftTime=0,e._openTimer=0,e._enterCD=0,e._enterCDTimer=0,e._changeTime=0,e._changeLittle=0,e.addCustomEvent(353,e.mapChange),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.mapChange=function(){MapControl.copyId==DataCenter.ins().CampWarConfig.fbId&&this.enterBattle(),this._isCampWar&&MapControl.copyId!=DataCenter.ins().CampWarConfig.fbId&&this.escBattle(),this.gotoNpc&&20==MapControl.copyType&&(this.gotoNpc=!1,MapControl.myMoveTo(DataCenter.ins().CampWarConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().CampWarConfig.npcPos[1]*MapControl.CELL_SIZE,this.findComplete),MapControl.moveTo(DataCenter.ins().CampWarConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().CampWarConfig.npcPos[1]*MapControl.CELL_SIZE))},e.prototype.findComplete=function(){UIMgr.ins().open(CampWarNpcTipView)},e.prototype.isCampWar=function(){return this._isCampWar},e.prototype.upJoinBattle=function(){},e.prototype.downJoinResult=function(t,e){this.camp=t,this._leftTime=DateUtils.formatMiniDateTime(e),this.dispatchEnterSuccess()},e.prototype.dispatchEnterSuccess=function(){EventMgr.ins().dispatch(275)},e.prototype.downRank=function(t){this.battleRanks.length=t.length;for(var e,i=0;i<t.length;i++)e=this.battleRanks[i],e||(e=new CampWarRankVo,this.battleRanks[i]=e),e.init(t[i]);EventMgr.ins().dispatch(276)},e.prototype.downOpen=function(t,e){this.isOpen=t,this._openLeftTime=e,this._openTimer=egret.getTimer(),EventMgr.ins().dispatch(277)},e.prototype.downRelive=function(t,e){bossControl.reliveTime=t,bossControl.killerHandler=e,UIMgr.ins().close(TargetPlayerBigBloodView),bossControl.reliveTime>0?(bossControl.clearWorldBossList(),UIMgr.ins().open(WorldBossBeKillView)):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.getOpenLeftTime=function(){return this._openLeftTime-(egret.getTimer()-this._openTimer)/1e3},e.prototype.getRankTop=function(t){return void 0===t&&(t=3),this.battleRanks?this.battleRanks.slice(0,t):null},e.prototype.getLeftTime=function(){return Math.floor((this._leftTime-GameServer.serverTime)/1e3)},e.prototype.enterBattle=function(){this._isCampWar=!0,UIMgr.ins().isShow(CampWarView)||UIMgr.ins().open(CampWarView),UIMgr.ins().close(CampWarNpcTipView)},e.prototype.escBattle=function(){this._isCampWar=!1,UIMgr.ins().close(CampWarView);var t=UnitMgr.ins().getEntitysBymasterhHandle(ActorControl.handle,1);if(t&&t.length>0)for(var e=t.length,i=void 0,n=0;e>n;n++)i=t[n],i&&i.infoModel&&(i.setCharName(i.infoModel.guildAndName),i.updateNameColor())},e.prototype.upReLive=function(){},e.prototype.upGetMyAward=function(){},e.prototype.downGetAwardResult=function(){},e.prototype.downAwardInfo=function(t){this.awardID=t,EventMgr.ins().dispatch(278)},e.prototype.downMyScore=function(t,e,i,n){this.myScore=t;var o;switch(n){case 1:o=LangMgr.getValueByKey("battleState1",i,e);break;case 2:o=LangMgr.getValueByKey("battleState2",i,e);break;case 3:o=LangMgr.getValueByKey("battleState3",i,e);break;case 4:o=LangMgr.getValueByKey("battleState4",e);break;case 5:o=LangMgr.getValueByKey("battleState5",e)}o&&tipsControl.showCenterTips3(o),this.dispatchScoreChange()},e.prototype.downMyRank=function(t,e){this.myRank=t,this.myScore=e,this.dispatchScoreChange()},e.prototype.dispatchScoreChange=function(){EventMgr.ins().dispatch(279)},e.prototype.downEnterCD=function(t){this._enterCD=t,this._enterCDTimer=egret.getTimer()},e.prototype.downGameOver=function(){UIMgr.ins().open(CampWarResultView)},e.prototype.downLittleChange=function(t){this._changeLittle=DateUtils.formatMiniDateTime(t),EventMgr.ins().dispatch(280)},e.prototype.getChangeLittleTime=function(){return Math.floor((this._changeLittle-GameServer.serverTime)/1e3)},e.prototype.canMove=function(){return this.getChangeLittleTime()<=0},e.prototype.downChangeTime=function(t){this._changeTime=DateUtils.formatMiniDateTime(t),EventMgr.ins().dispatch(281)},e.prototype.downKilled=function(t){EventMgr.ins().dispatch(282,t)},e.prototype.getChangeTime=function(){return Math.floor((this._changeTime-GameServer.serverTime)/1e3)},e.prototype.getEnterCD=function(){return Math.ceil(this._enterCD-(egret.getTimer()-this._enterCDTimer)/1e3)},e.prototype.checkRedPoint=function(){return this.isOpen&&ActorControl.level>=DataCenter.ins().CampWarConfig.openLevel},__decorate([up(1)],e.prototype,"upJoinBattle",null),__decorate([down(1,[2,3])],e.prototype,"downJoinResult",null),__decorate([down(2,[ByteConst.CampWarRankVos])],e.prototype,"downRank",null),__decorate([down(3,[0,3])],e.prototype,"downOpen",null),__decorate([down(4,[3,10])],e.prototype,"downRelive",null),__decorate([up(4)],e.prototype,"upReLive",null),__decorate([up(5)],e.prototype,"upGetMyAward",null),__decorate([down(5)],e.prototype,"downGetAwardResult",null),__decorate([down(6,[3])],e.prototype,"downAwardInfo",null),__decorate([down(7,[3,3,8,4])],e.prototype,"downMyScore",null),__decorate([down(10,[3,3])],e.prototype,"downMyRank",null),__decorate([down(11,[3])],e.prototype,"downEnterCD",null),__decorate([down(12)],e.prototype,"downGameOver",null),__decorate([down(13,[3])],e.prototype,"downLittleChange",null),__decorate([down(14,[3])],e.prototype,"downChangeTime",null),__decorate([down(15,[2])],e.prototype,"downKilled",null),e=__decorate([protocolsId(61)],e)}(BaseSystem);__reflect(CampWarControl.prototype,"CampWarControl");var CampWarNpcTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CampWarNpcTipViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onGoto),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this.goTo,this.onGoto)},e.prototype.update=function(){this.desc.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().CampWarConfig.desc),this.rule.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().HelpInfoConfig[17].text),this.redPoint.visible=campWarControl.isOpen},e.prototype.onGoto=function(t){if(t.target==this.goTo){if(ActorControl.level<DataCenter.ins().CampWarConfig.openLevel)return void tipsControl.showTips(LangMgr.getValueByKey("battleJoinCity",DataCenter.ins().CampWarConfig.openLevel));if(!campWarControl.isOpen)return void tipsControl.showTips(DataCenter.ins().CampWarConfig.openTips);var e=campWarControl.getEnterCD();if(e>0)return void tipsControl.showTips(LangMgr.getValueByKey("battleJoinFB",e));campWarControl.upJoinBattle()}else t.target==this.bgClose&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CampWarNpcTipView.prototype,"CampWarNpcTipView");var CampWarRankPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=CampWarRankItemRenderer,this._arrayCllect=new eui.ArrayCollection,this.list.dataProvider=this._arrayCllect},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(276,this.update),this.addCustomEvent(279,this.updateMyScore),this.update(),this.updateMyScore()},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.update=function(){this._arrayCllect.source=campWarControl.battleRanks},e.prototype.updateMyScore=function(){this.myScore.text=campWarControl.myScore+"",this.myRank.text=LangMgr.getValueByKey("battleMyRank",campWarControl.myRank)},e}(BasePanel);__reflect(CampWarRankPanel.prototype,"CampWarRankPanel");var CampWarRankView=function(t){function e(){var e=t.call(this)||this;return e._selectedIndex=0,e.skinName="CampWarRankViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this._panels=[this.campWarRank,this.campWarReward],this._panels[this._selectedIndex].open(),this.viewStack.selectedIndex=this._selectedIndex},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addEventChange(this.tab,this.onTabTouch)},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeEventChange(this.tab,this.onTabTouch)},e.prototype.onTabTouch=function(t){this._panels[this._selectedIndex].close(),this._selectedIndex=t.currentTarget.selectedIndex,this._panels[this._selectedIndex].open(),this.viewStack._selectedIndex=this._selectedIndex},e.prototype.onTap=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CampWarRankView.prototype,"CampWarRankView");var CampWarResultView=function(t){function e(){var e=t.call(this)||this;return e._time=5,e.skinName="CampWarResultViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rankList.itemRenderer=CampWarResultItemRenderer,this.myRewarrd.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addCustomEvent(276,this.updateRank),this.addCustomEvent(279,this.updateMyScore),this.timerGroup.visible=!0,this.info.text=this._time+"",TimerMgr.ins().doTimer(1e3,5,this.repeat,this),this.updateMyScore(),this.updateRank()},e.prototype.updateRank=function(){this.rankList.dataProvider=new eui.ArrayCollection(campWarControl.getRankTop(5))},e.prototype.updateMyScore=function(){var t=campWarControl.myRank;this.myScore.text=campWarControl.myScore+"",this.myRanking.text=t+"";var e=Object.keys(DataCenter.ins().CampWarPersonalRankAwardConfig).length,i=DataCenter.ins().CampWarPersonalRankAwardConfig[t>0&&e>=t?t:e];this.myRewarrd.dataProvider=new eui.ArrayCollection(i.award)},e.prototype.repeat=function(){this._time--,this._time>0?this.info.text=this._time+"":this.timerGroup.visible=!1},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){switch(t.target){case this.closeBtn:copyControl.upExitFb(),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(CampWarResultView.prototype,"CampWarResultView");var CampWarRewardPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list0.itemRenderer=CampWarRewardItemRenderer;var e=0,i=[];for(var n in DataCenter.ins().CampWarPersonalRankAwardConfig)i[e]=DataCenter.ins().CampWarPersonalRankAwardConfig[n],e++;this.list0.dataProvider=new eui.ArrayCollection(i),this._collect=new eui.ArrayCollection,this.list1.itemRenderer=CampWarTargetItemRenderer,this.list1.dataProvider=this._collect},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(278,this.update),this.update()},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.update=function(){var t=Object.keys(DataCenter.ins().CampWarPersonalAwardConfig).length,e=[],i=campWarControl.awardID;e.length=t;for(var n=1;t>=n;n++)e[n-1]=[DataCenter.ins().CampWarPersonalAwardConfig[n],i>=n];this._collect.source=e},e}(BasePanel);__reflect(CampWarRewardPanel.prototype,"CampWarRewardPanel");var CampWarView=function(t){function e(){var e=t.call(this)||this;return e._leftTime=0,e._changeTime=-1,e._littleChangeTime=-1,e.skinName="CampWarViewSkin",e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.jump.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("battleLookRank")),this.bigTimeGroup.visible=!1,this.assignPer.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addCustomEvent(276,this.updateRank),this.addCustomEvent(279,this.updateMyScore),this.addCustomEvent(278,this.updateGift),this.addCustomEvent(275,this.update),this.addCustomEvent(281,this.update),this.addCustomEvent(280,this.update),this.addCustomEvent(282,this.onKill),this.updateRank(),this.updateGift(),this.updateMyScore(),this.update()},e.prototype.update=function(){TimerMgr.ins().remove(this.repeat,this),this._leftTime=campWarControl.getLeftTime();var t;this._leftTime>0?t=!0:this.wholeLeftTime.text="",this._changeTime=campWarControl.getChangeTime(),this._changeTime>0?t=!0:this.assignPer.visible=!1,this._littleChangeTime=campWarControl.getChangeLittleTime(),this._littleChangeTime>0?t=!0:this.bigTimeGroup.visible=!1,t&&(TimerMgr.ins().doTimer(1e3,0,this.repeat,this),this.repeat()),this.skillGroup0.visible=!1},e.prototype.onKill=function(t){if(egret.Tween.removeTweens(this.lzlabel0),egret.Tween.removeTweens(this.skillGroup0),!t)return void(this.skillGroup0.visible=!1);this.skillGroup0.visible=!0,this.skillGroup0.alpha=1,this.lzlabel0.scaleX=this.lzlabel0.scaleY=1,this.lzlabel0.text=t+"";var e=this;egret.Tween.get(this.lzlabel0).to({scaleX:2,scaleY:2},200).to({scaleX:1,scaleY:1},100).call(function(){egret.Tween.get(e.skillGroup0).wait(1e3).to({alpha:0},1e3).call(function(){egret.Tween.removeTweens(e.lzlabel0),egret.Tween.removeTweens(e.skillGroup0),e.skillGroup0.visible=!1})})},e.prototype.repeat=function(){this._leftTime<=0?""!=this.wholeLeftTime.text&&(this.wholeLeftTime.text=""):this.wholeLeftTime.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,4),this._leftTime--,this._changeTime<=0?this.assignPer.visible&&(this.assignPer.visible=!1):(this.assignPer.visible||(this.assignPer.visible=!0),this.campLeftTime0.text=DateUtils.getFormatBySecond(this._changeTime,DateUtils.TIME_FORMAT_5,4)),this._changeTime--,this._littleChangeTime<=0?this.bigTimeGroup.visible&&(this.bigTimeGroup.visible=!1):(this.countDown.text=Math.floor(this._littleChangeTime)+"",this.bigTimeGroup.visible||(this.bigTimeGroup.visible=!0)),this._littleChangeTime--},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents(),TimerMgr.ins().removeAll(this),this._giftMax=!1,this._canGetGift=!1,egret.Tween.removeTweens(this.lzlabel0),egret.Tween.removeTweens(this.skillGroup0)},e.prototype.updateRank=function(){for(var t,e=campWarControl.getRankTop(),i=e?e.length:0,n=0;3>n;n++)t=i>n?e[n]:null,this["name"+n].text=t?t.roleName:"",this["num"+n].text=t?t.score+"":""},e.prototype.updateMyScore=function(){this.num3.text=campWarControl.myScore+"",this.rank3.text=campWarControl.myRank+"",this.updateGift()},e.prototype.updateGift=function(){if(!this._giftMax){var t=campWarControl.awardID,e=Object.keys(DataCenter.ins().CampWarPersonalAwardConfig).length;if(this._canGetGift=!1,t>=e)this._giftMax=!0,this.giftGroup.visible=!1;else{this.giftGroup.visible=!0;var i=DataCenter.ins().CampWarPersonalAwardConfig[t+1];this._canGetGift=campWarControl.myScore>=i.integral,this.redPoint.visible=this._canGetGift,this.scoreTxt.text=LangMgr.getValueByKey("battleScore",campWarControl.myScore);var n=this._canGetGift?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.scoreTxt2.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+campWarControl.myScore+"|/"+i.integral)}}},e.prototype.onTap=function(t){switch(t.target){case this.jump:UIMgr.ins().open(CampWarRankView);break;case this.giftBtn:this._canGetGift&&campWarControl.upGetMyAward()}},e}(BaseEuiView);__reflect(CampWarView.prototype,"CampWarView");var CampWarRankItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="CampWarRankItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.rank<=3;this.rankImg.source=e?"paihang"+t.rank:null,this.rank.text=e?"":t.rank+"",this.nameLabel.text=t.roleName,this.nameGuild.text=t.unionName,this.score.text=t.score+""},e}(BaseItemRender);__reflect(CampWarRankItemRenderer.prototype,"CampWarRankItemRenderer");var CampWarResultItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="CampWarResultItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.ranking.text=t.rank+"",this.roleName.text=t.roleName,this.guild.text=t.unionName,this.score.text=t.score+""},e}(BaseItemRender);__reflect(CampWarResultItemRenderer.prototype,"CampWarResultItemRenderer");var CampWarRewardItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="CampWarRewardItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.awards.itemRenderer=ItemBase,this._arrayCollect=new eui.ArrayCollection,this.awards.dataProvider=this._arrayCollect},e.prototype.dataChanged=function(){var t=this.data;this.rank.text=LangMgr.getValueByKey("ranking",t.rank),this._arrayCollect.source=t.award},e}(BaseItemRender);__reflect(CampWarRewardItemRenderer.prototype,"CampWarRewardItemRenderer");var CampWarTargetItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="CampWarTargetItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data[0];this.rank.text=t.integral+"\n"+LangMgr.getValueByKey("activitScore"),this.award.data=t.award[0],this.already.visible=this.data[1]},e}(BaseItemRender);__reflect(CampWarTargetItemRenderer.prototype,"CampWarTargetItemRenderer");var CampWarRankVo=function(){function t(){}return t.prototype.init=function(t){this.rank=t[0],this.camp=t[1],this.roleName=t[2],this.unionName=t[3],this.score=t[4]},t}();__reflect(CampWarRankVo.prototype,"CampWarRankVo");var ConfrontControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.encounterModel=[],e.wildModel={},e.isGuiding=!1,e.wildPersonList={},e.isFindDrop=!1,e.buyAndFight=!1,e.encounterRank=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downLastRefreshTime=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ConfrontModelVo.lastTime=t[0],ConfrontModelVo.refreshTimes=t[3],ConfrontModelVo.redName=t[4],this.dispatchEncounterDataChange()},e.prototype.upRefresh=function(){},e.prototype.upFightResult=function(t){return crossFieldControl.isCrossServer?(debug.log("Cross-service playing"),!1):void 0==confrontFightControl.encounterIndex||crossFieldControl.isCross?!1:(1==t&&tipsControl.showTips(LangMgr.getValueByKey("fightPK",DataCenter.ins().SkirmishBaseConfig.onesPkval)),[confrontFightControl.encounterIndex,t])},e.prototype.dispatchFightResult=function(t){EventMgr.ins().dispatch(510,t)},e.prototype.isEncounter=function(){return void 0!=confrontFightControl.encounterIndex&&confrontFightControl.encounterIndex>=0||this.isFindDrop},e.prototype.isHasRed=function(){for(var t=0,e=0;e<confrontControl.encounterModel.length;e++)confrontControl.getEncounterModel(e)&&t++;return t>0&&ConfrontModelVo.redName<DataCenter.ins().SkirmishBaseConfig.maxPkval?t:0},e.prototype.downEncounterData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.encounterModel[i]=this.encounterModel[i]||new ConfrontModelVo,this.encounterModel[i].init(t),this.dispatchEncounterDataChange()},e.prototype.dispatchEncounterDataChange=function(){EventMgr.ins().dispatch(130)},e.prototype.upGetreward=function(){},e.prototype.downResult=function(t,e,i,n,o,s,r){for(var a,l=this,h=[],u=[0,1,4,3],p=[i,n,o,s],c=u.length,d=0;c>d;d++)a=new RewardVo,a.type=0,a.id=u[d],a.count=p[d],a.count&&h.push(a);c=r.length;for(var d=0;c>d;d++)a=new RewardVo,a.init(r[d]),this.dispatchCreateDrop(DropControl.tempDropPoint.x,DropControl.tempDropPoint.y,a),h.push(a);if(this.encounterModel[t-1]=null,e&&c){var g=function(){confrontControl.isFindDrop=!1,l.upGetreward(),confrontFightControl.win()};this.isFindDrop=!0,DropControl.addCompleteFunc(g,this),DropControl.start()}else e||confrontFightControl.lose();this.dispatchEncounterDataChange()},e.prototype.getEncounterLength=function(){for(var t=0,e=0;e<confrontControl.encounterModel.length;e++){var i=confrontControl.getEncounterModel(e);i&&(t+=1)}return t},e.prototype.downDataUpdate=function(t,e){this.encounterRank=e,EventMgr.ins().dispatch(133,[t,e])},e.prototype.upInquirePrestige=function(){},e.prototype.downZaoYuRecord=function(t){EventMgr.ins().dispatch(132,t)},e.prototype.upInquireRecord=function(){},e.prototype.downUpdateWildBoss=function(t){this.willBossID=t,portalControl.upDataWillBoss(t)},e.prototype.downWildBossResult=function(t,e){if(t)for(var i=0;i<e.length;i++){var n=new RewardVo;n.init(e[i]),this.dispatchCreateDrop(DropControl.tempDropPoint.x,DropControl.tempDropPoint.y,n)}var o=function(){this.sendGetAward(),gameControl.createGuanqiaMonster()};DropControl.addCompleteFunc(o,this),DropControl.start()},e.prototype.dispatchCreateDrop=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return DropControl.getItemCount()<5?(DropControl.addDrop(t),!1):void EventMgr.ins().dispatch(131,t)},e.prototype.upResult=function(t){return[t]},e.prototype.upGetAward=function(){},e.prototype.getEncounterModel=function(t){return this.encounterModel[t]},e.prototype.clearEncounterModel=function(){this.encounterModel.length=0},e.prototype.upCleanRedName=function(){},e.prototype.downAddWildPlayer=function(t,e,i,n,o,s,r,a,l,h,u,p,c){var d=new WildPlayerDataVo;d.index=t,d.actionType=s,d.attackEnable=0!=r,d.killNum=a,d.backX=l,d.backY=h;for(var g,m=0;m<p.length;m++){var f=new RoleModel;f.init(p[m]),f.x=e,f.y=i,f.name=u,f.type=1,f.killNum=0,gameControl.createEntityByModel(f,5),0==m&&(g=f.handle),f.masterHandle=g
}d.fireRing=new OtherFireRingDataVo,d.fireRing.init(c[0]),this.wildPersonList[g]=d},e.prototype.canRunAwary=function(t){var e=this.wildPersonList[t];return e.backCount--,0==e.backCount},e.prototype.RunAwary=function(t){this.wildPersonList[t];delete this.wildPersonList[t]},e.prototype.upWildPeopleResult=function(t,e){return[t,e]},e.prototype.downWildPlayerResult=function(t,e,i){for(var n,o=[],s=0;s<i.length;s++)n=new RewardVo,n.init(i[s]),this.dispatchCreateDrop(DropControl.tempDropPoint.x,DropControl.tempDropPoint.y,n),o.push(n);if(e){var r=function(){this.sendGetWildPeopleReward(),gameControl.createGuanqiaMonster()};DropControl.addCompleteFunc(r,this),DropControl.start()}else TimerMgr.ins().doTimer(800,1,function(){resultControl.create(MapControl.copyType,e,o,"",!1),gameControl.createGuanqiaMonster(),confrontControl.wildPersonList={}},this)},e.prototype.upCleanWildPeople=function(t){return[t]},e.prototype.upGetWildPeopleReward=function(){},e.prototype.downRedNameResult=function(){tipsControl.showTips(LangMgr.getValueByKey("fightPKsubtruct",DataCenter.ins().SkirmishBaseConfig.subPkval))},e.prototype.checkIsEncounter=function(t,e){var i=this.encounterModel[t];if(!i)return!1;for(var n=i.subRole,o=0;o<n.length;o++){var s=n[o];if(s&&s.handle==e.handle)return!0}return!1},e.prototype.countKillNumByMarster=function(t){var e=0,i=UnitMgr.ins().getMasterList(t);for(var n in i){var o=i[n];o.parent&&o.infoModel&&(e+=o.infoModel.killNum)}return e},__decorate([down(1,[3,3,3,3,3])],e.prototype,"downLastRefreshTime",null),__decorate([up(1)],e.prototype,"upRefresh",null),__decorate([up(2,[3,3])],e.prototype,"upFightResult",null),__decorate([down(2,ByteConst.ConfrontModelVos.slice())],e.prototype,"downEncounterData",null),__decorate([up(3)],e.prototype,"upGetreward",null),__decorate([down(3,[3,3,3,3,3,3,ByteConst.RewardVos])],e.prototype,"downResult",null),__decorate([down(7,[3,2])],e.prototype,"downDataUpdate",null),__decorate([up(7)],e.prototype,"upInquirePrestige",null),__decorate([down(4,[[3,0,8,3,3,3,3]])],e.prototype,"downZaoYuRecord",null),__decorate([up(4)],e.prototype,"upInquireRecord",null),__decorate([down(5,[3])],e.prototype,"downUpdateWildBoss",null),__decorate([down(6,[0,ByteConst.RewardVos])],e.prototype,"downWildBossResult",null),__decorate([up(5,[0])],e.prototype,"upResult",null),__decorate([up(6)],e.prototype,"upGetAward",null),__decorate([up(8)],e.prototype,"upCleanRedName",null),__decorate([down(8,ByteConst.WildPlayers.slice())],e.prototype,"downAddWildPlayer",null),__decorate([up(9,[3,3])],e.prototype,"upWildPeopleResult",null),__decorate([down(9,[3,3,ByteConst.RewardVos])],e.prototype,"downWildPlayerResult",null),__decorate([up(10,[3])],e.prototype,"upCleanWildPeople",null),__decorate([up(11)],e.prototype,"upGetWildPeopleReward",null),__decorate([down(10)],e.prototype,"downRedNameResult",null),e=__decorate([protocolsId(5)],e)}(BaseSystem);__reflect(ConfrontControl.prototype,"ConfrontControl");var ConfrontFightControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aiList={},e.encounterList={},e.willEntityFightTeam=1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.start=function(t){var e=this;if(confrontControl.isEncounter()||UnitMgr.ins().getTeamCount(3)>0)return void tipsControl.showTips(LangMgr.getValueByKey("atkPlayerIng"));if(!copyControl.checkInFB()&&confrontControl.encounterModel[t]){this.encounterIndex=t,this.rolePositions={},titleControl.refNewTitle(ActorControl.handle),this.removeAllEncounter(),HookControl.ins().stop(),DropControl.clearDrop(),skillControl.setHejiCD(6e3),focusAttackControl.register(this),this.addCheckResult();for(var i=UnitMgr.ins().getEntityByTeam(0),n=0,o=i;n<o.length;n++){var s=o[n];if(s.stopMove(),s.playAction(UnitAction.STAND),s instanceof UnitRole){this.rolePositions[s.infoModel.handle]={x:s.x,y:s.y,dir:s.dir};var r=new GameMovieClip;r.playFile(PATH_SKILLEFF+"skill208",1),s.addChild(r),s.playAction(UnitAction.ATTACK)}else UnitMgr.ins().removeByHandle(s.infoModel.handle)}TimerMgr.ins().doTimer(800,1,function(){DropControl.clearDrop(),e.addRole()},this),this.clearOldAI(),this.createEncounterAndMonster(),SoundUtils.ins().playEffect(SoundUtils.TRANSFER),TimerMgr.ins().loop(800,this.updateHpMp,this)}},e.prototype.updateHpMp=function(){gameControl.dispatchUpdateHpMp()},e.prototype.addCheckResult=function(){TimerMgr.ins().doTimer(1e3,0,this.checkResult,this)},e.prototype.checkResult=function(){confrontControl.isFindDrop||(0==UnitMgr.ins().getTeamCount(0)||0==UnitMgr.ins().getTeamCount(2))&&(0==UnitMgr.ins().getTeamCount(2)?this.sendFightResult(1):this.sendFightResult(0))},e.prototype.sendFightResult=function(t){t?confrontControl.upFightResult(t):TimerMgr.ins().doTimer(2e3,1,function(){confrontControl.upFightResult(t)},this),confrontControl.dispatchFightResult(t),TimerMgr.ins().remove(this.checkResult,this)},e.prototype.win=function(){for(var t=this,e=UnitMgr.ins().getEntityByTeam(0),i=0,n=e;i<n.length;i++){var o=n[i];if(o.stopMove(),o instanceof UnitRole){var s=new GameMovieClip;s.playFile(PATH_SKILLEFF+"skill208",1),o.addChild(s),o.playAction(UnitAction.ATTACK)}else UnitMgr.ins().removeByHandle(o.infoModel.handle)}SoundUtils.ins().playEffect(SoundUtils.TRANSFER),TimerMgr.ins().doTimer(800,1,function(){for(var e=UnitMgr.ins().getEntityByTeam(0),i=0,n=e;i<n.length;i++){var o=n[i];UnitMgr.ins().removeByHandle(o.infoModel.handle)}t.stop(),t.fightEnd(),MapControl.sceneInHook()&&(t.resetPos(),HookControl.ins().start())},this)},e.prototype.lose=function(){SoundUtils.ins().playEffect(SoundUtils.TRANSFER),this.stop(),this.fightEnd()},e.prototype.fightEnd=function(){ConfrontModelVo.redName<DataCenter.ins().SkirmishBaseConfig.maxPkval&&confrontControl.getEncounterLength()&&UIMgr.ins().open(LadderView)},e.prototype.stop=function(){if(void 0!=this.encounterIndex){focusAttackControl.unregister(this),this.updateHpMp(),TimerMgr.ins().removeAll(this),UnitMgr.ins().resetRole(),this.encounterIndex=void 0,this.willEntityFightTeam=1,this.removeAllEncounter(),titleControl.refNewTitle(ActorControl.handle);for(var t in this.aiList){var e=UnitMgr.ins().getEntityByHandle(t);e&&3!=e.AI_STATE&&HookControl.ins().add(e)}this.aiList={},gameControl.dispatchMoveCamera()}},e.prototype.resetPos=function(){var t=UnitMgr.ins().getEntityByTeam(0);for(var e in t){var i=t[e],n=this.rolePositions[i.infoModel.handle];n&&(i.x=n.x,i.y=n.y);var o=new GameMovieClip;o.playFile(PATH_SKILLEFF+"skill208",1),i.addChild(o)}this.rolePositions={},gameControl.dispatchMoveCamera()},e.prototype.removeAllEncounter=function(){for(var t in this.encounterList)UnitMgr.ins().removeByHandle(t),delete this.encounterList[t]},e.prototype.addRole=function(){for(var t=UnitMgr.ins().getEntityByTeam(0),e=0,i=t;e<i.length;e++){var n=i[e];UnitMgr.ins().removeByHandle(n.infoModel.handle)}UnitMgr.ins().resetRole();var o=UnitMgr.ins().getNoDieRole(),s=this.getRolePos();o.x=s[0]*MapControl.CELL_SIZE,o.y=s[1]*MapControl.CELL_SIZE;var r=UnitMgr.ins().screeningTargetByPos(o);if(r[0])o.dir=DirUtils.get8DirBy2Point(o,r[0]);else{var a=confrontControl.encounterModel[this.encounterIndex];if(a){var l=a.subRole.length;Assert(!1,LangMgr.getValueByKey("fightNoEnemy",l))}}var h=UnitMgr.ins().getMyOtherRolePos();t=UnitMgr.ins().getEntityByTeam(0);for(var u in t){if(t[u].playAction(UnitAction.STAND),HookControl.ins().add(t[u]),t[u]!=o){var p=t[u].infoModel.handle;t[u].dir=o.dir,t[u].x=Math.floor(h[p].x),t[u].y=Math.floor(h[p].y)}var c=new GameMovieClip;c.playFile(PATH_SKILLEFF+"skill208",1),t[u].addChild(c)}gameControl.dispatchMoveCamera()},e.prototype.getRoles=function(){var t=confrontControl.encounterModel[this.encounterIndex];return t&&t.subRole},e.prototype.getSkillLvl=function(){var t=confrontControl.encounterModel[this.encounterIndex];return t&&t.hejiLvl||0},e.prototype.getIsWeiShe=function(t){var e=confrontControl.encounterModel[this.encounterIndex];return e?t?ActorControl.prestige>e.weiWang:ActorControl.prestige<e.weiWang:!1},e.prototype.getWeiSheHurt=function(t){if(!this.getIsWeiShe(t))return 0;var e=rankControl.getRankModel(22),i="";if(t)i=ActorControl.myName;else{var n=confrontControl.encounterModel[this.encounterIndex];i=n.subRole[0].name}var o=0;if(e)for(var s=0;3>s;s++){var r=e.getDataList(s);if(r&&r.player==i){o=r.pos;break}}return DataCenter.ins().PrestigeBaseConfig.rankDeterDam[o-1]||DataCenter.ins().PrestigeBaseConfig.normalDeterDam},e.prototype.getRolePos=function(){var t=DataCenter.ins().SkirmishBaseConfig.range;return MapControl.getPosRange(this.zyRolePos[0],this.zyRolePos[1],t)},e.prototype.clearOldAI=function(){this.aiList=HookControl.ins().getAIList(),HookControl.ins().clearAIList()},e.prototype.createEncounterAndMonster=function(){var t=copyControl.zyPos,e=Math.floor(Math.random()*t.length),i=t[e],n=i[0];this.zyRolePos=n;var o=copyControl.waveMonsterId[0],s=i[1];Assert(s,LangMgr.getValueByKey("fightError",copyControl.guanqiaID))&&(s=[]);for(var r=0;r<s.length;r++){var a=copyControl.createMonster(o);a.x=s[r][0]*MapControl.CELL_SIZE,a.y=s[r][1]*MapControl.CELL_SIZE;var l=gameControl.createEntityByModel(a);l.AI_STATE=4,this.encounterList[l.infoModel.handle]=l}for(var h=confrontControl.encounterModel[this.encounterIndex],u=h.subRole.length,r=0;u>r;r++){var p=h.subRole[r];if(p){p.setAtt(0,p.getAtt(2)),p.setAtt(1,p.getAtt(3)),p.type=1,p.x=n[0]*MapControl.CELL_SIZE+Math.floor(40*r*Math.random()),p.y=n[1]*MapControl.CELL_SIZE+Math.floor(40*r*Math.random());var c=gameControl.createEntityByModel(p,2);c.AI_STATE=0,c.updateNeiGong(),this.encounterList[p.handle]=c}}HookControl.ins().start()},e}(SingleClass);__reflect(ConfrontFightControl.prototype,"ConfrontFightControl",["FocusAttackUseVo"]);var ConfrontModelVo=function(){function t(){this.subRole=[],this.hejiLvl=0,this.weiWang=0}return t.prototype.init=function(t){this.index=t[0],this.lv=t[1],this.zsLv=t[2],this.name=t[3],this.subRole=[];for(var e=0;e<t[4].length;e++){var i=this.subRole[e]=new RoleModel;i.init(t[4][e]),i.name=this.name}this.fireRing=this.fireRing||new OtherFireRingDataVo,this.fireRing.init(t[5][0]),this.firstData=0!=t[6],this.hejiLvl=t[7],this.weiWang=t[8]},t.redName=0,t}();__reflect(ConfrontModelVo.prototype,"ConfrontModelVo");var WildPlayerDataVo=function(){function t(){}return t}();__reflect(WildPlayerDataVo.prototype,"WildPlayerDataVo");var BuyRedNameView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BuyRedNameViewSkin",e.uilayer=GameLayer.POPUP,e.horizontalCenter=0,e.verticalCenter=0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btnBuy,this.onTap),this.addEventTouchTap(this.btnClose,this.onTap),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTap),this.updateText()},e.prototype.updateText=function(){this.pkNow.text=""+ConfrontModelVo.redName,this.ybNum.text=""+(ConfrontModelVo.redName-DataCenter.ins().SkirmishBaseConfig.maxPkval+1)*DataCenter.ins().SkirmishBaseConfig.subPkvalCost,this.pkValue.text=""+(ConfrontModelVo.redName-DataCenter.ins().SkirmishBaseConfig.maxPkval+1)},e.prototype.close=function(){this.removeEventTouchTap(this.btnBuy,this.onTap),this.removeEventTouchTap(this.btnClose,this.onTap)},e.prototype.onTap=function(t){switch(t.target){case this.btnBuy:if(!(ActorControl.yb>=(ConfrontModelVo.redName-DataCenter.ins().SkirmishBaseConfig.maxPkval+1)*DataCenter.ins().SkirmishBaseConfig.subPkvalCost)){tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),UIMgr.ins().close(this);break}confrontControl.upCleanRedName(),confrontControl.buyAndFight=!0}UIMgr.ins().close(e)},e}(BaseEuiView);__reflect(BuyRedNameView.prototype,"BuyRedNameView");var ConfrontPlayerInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.curIndex=-1,e.name=LangMgr.getValueByKey("encounterPeople"),e}return __extends(e,t),e.prototype.childrenCreated=function(){var t=heroControl.getSubRoleByIndex(0);this.myFace.source="head_"+t.job+t.sex,this.list.itemRenderer=ConfrontInfoItemRender,this.scroller.scrollPolicyH=eui.ScrollPolicy.OFF},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.labelRed.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("encounterTips")),confrontControl.upInquireRecord(),confrontControl.upInquirePrestige(),this.setData(),this.addEventTouchTap(this,this.onTap),this.addEventTouchTap(this.rewardBtn,this.onTap),this.addCustomEvent(130,this.setData),this.addCustomEvent(133,this.updatePrestigeRank)},e.prototype.$onClose=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.$onClose.call(this),TimerMgr.ins().removeAll(this)},e.prototype.updatePrestigeRank=function(t){var e=t[0],i=t[1];this.dayPrestige.text=e+"",0==i?this.rank.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("encounterTips1")):this.rank.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("encounterRank",i))},e.prototype.setData=function(){var t=[];this.curIndex>-1&&confrontControl.buyAndFight&&this.sendFight(this.curIndex),confrontControl.buyAndFight=!1,this.curIndex=-1,this.labelRedPoint.text=""+ConfrontModelVo.redName,this.labelRedPoint.textColor=ConfrontModelVo.redName>=DataCenter.ins().SkirmishBaseConfig.maxPkval?LangMgr.getColor("color22"):ColorUtils.GREEN,this.labelRed.visible=!1,ConfrontModelVo.redName>=DataCenter.ins().SkirmishBaseConfig.maxPkval?(this.time.text=LangMgr.getValueByKey("encounterFight",ConfrontModelVo.redName-DataCenter.ins().SkirmishBaseConfig.maxPkval+1),this.time.textColor=LangMgr.getColor("color22")):this.removeTime();for(var e=0;e<confrontControl.encounterModel.length;e++){var i=confrontControl.getEncounterModel(e);if(i){if(i.firstData){t=[i];break}t.push(i)}}0==t.length&&t.push(null),this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.addTime=function(){this.removeTime(),this.timeGap=60*(ConfrontModelVo.redName-DataCenter.ins().SkirmishBaseConfig.maxPkval+1),this.time.text=LangMgr.getValueByKey("encounterFight1",DateUtils.getFormatBySecond(this.timeGap,3)),TimerMgr.ins().doTimer(1e3,0,this.timeHandler,this)},e.prototype.timeHandler=function(){this.timeGap>0?(this.timeGap-=1,this.time.text=LangMgr.getValueByKey("encounterFight1",DateUtils.getFormatBySecond(this.timeGap,3))):this.time.text=""},e.prototype.removeTime=function(){this.time.text="",TimerMgr.ins().remove(this.timeHandler,this)},e.prototype.onTap=function(t){if(t.target instanceof eui.Button&&t.target.parent instanceof ConfrontInfoItemRender){if(toseongControl.isToseong)return void tipsControl.showTips(LangMgr.getValueByKey("encounterTips2"));if(t.target.label==LangMgr.getValueByKey("personFight1")||t.target.label==LangMgr.getValueByKey("encounterFighting")){if(copyControl.checkInFB())return;var e=t.target.parent.data.index;if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);if(ConfrontModelVo.redName>=DataCenter.ins().SkirmishBaseConfig.maxPkval)return this.curIndex=e,void UIMgr.ins().open(BuyRedNameView);this.sendFight(e)}}else switch(t.target){case this.rankBtn:UIMgr.ins().open(RankingView,2);break;case this.recordBtn:UIMgr.ins().open(ConfrontRecordView);break;case this.labelRed:ConfrontModelVo.redName>0?UIMgr.ins().open(BuyRedNameView):tipsControl.showTips(LangMgr.getValueByKey("encounterTips3"));break;case this.rank:UIMgr.ins().open(RankingView,2);break;case this.rewardBtn:UIMgr.ins().open(ConfrontRewardView)}},e.prototype.sendFight=function(t){copyControl.checkInFB()||(UIMgr.ins().close(BackpackFullTipsView),UIMgr.ins().closeTopLevel(),TimerMgr.ins().doTimer(100,1,function(){confrontFightControl.start(t)},this))},e}(BasePanel);__reflect(ConfrontPlayerInfoPanel.prototype,"ConfrontPlayerInfoPanel");var ConfrontRecordView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ConfrontRecordViewSkin",e.list.itemRenderer=ConfrontRecordItemRender,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addCustomEvent(132,this.updateData),confrontControl.upInquireRecord()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeCustomEvents()},e.prototype.updateData=function(t){function e(t,e){return t[0]<e[0]?1:t[0]>e[0]?-1:0}t&&(t.sort(e),this.list.dataProvider=new eui.ArrayCollection(t))},e.prototype.onTap=function(t){switch(t.target){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ConfrontRecordView.prototype,"ConfrontRecordView");var ConfrontRewardView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="ConfrontRewardViewSkin",e}return __extends(e,t),e.prototype.createChildren=function(){this.list0.itemRenderer=ConfrontRewardItemRender,this.rewardList=[];for(var t in DataCenter.ins().SkirmishRankConfig)this.rewardList.push(DataCenter.ins().SkirmishRankConfig[t])},e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.setPanelInfo()},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(e)}},e.prototype.setPanelInfo=function(){this.list0.dataProvider=new eui.ArrayCollection(this.rewardList);var t=confrontControl.encounterRank;0==t?this.myRankText.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("encounterMyRank")):this.myRankText.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("encounterMyRank1",t))},e}(BaseEuiView);__reflect(ConfrontRewardView.prototype,"ConfrontRewardView");var ConfrontInfoItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="ConfrontInfoItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.nameTxt.text="",this.moneyTxt.text="",this.expTxt.text="",this.soulTxt.text="",this.challengeBtn.touchChildren=!1},e.prototype.updateTime=function(){},e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.currentState="have";var e=t.zsLv>0?1e3*t.zsLv:Math.min(t.lv,80),i=DataCenter.ins().SkirmishRewardConfig[e];this.nameTxt.text=""+t.name,this.nameTxt0.text=t.zsLv?LangMgr.getValueByKey("numberRotation",t.zsLv):LangMgr.getValueByKey("numberLevel",t.lv),this.moneyTxt.text=i.rewards.gold+"",this.expTxt.text=i.rewards.exp+"",this.soulTxt.text=i.rewards.essence+"",this.face.source="head_"+t.subRole[0].job+t.subRole[0].sex,this.headBG.source="touxiangkuang"+t.subRole[0].sex,confrontFightControl.encounterIndex!=t.index?this.challengeBtn.label=LangMgr.getValueByKey("personFight1"):this.challengeBtn.label=LangMgr.getValueByKey("encounterFighting")}else this.currentState="none",this.nameTxt0.text=LangMgr.getValueByKey("attriTips1")},e}(BaseItemRender);__reflect(ConfrontInfoItemRender.prototype,"ConfrontInfoItemRender");var ConfrontRecordItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="ConfrontInfoItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.time.text=DateUtils.getFormatBySecond(DateUtils.formatMiniDateTime(t[0])/1e3,2),this.playerName.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("ecnounterMeetPlayer",t[2])),this.exp.text=""+t[3],this.money.text=""+t[4],this.prestige.text=""+t[5],this.lingpo.text=t[6]||"0",t[1]?this.currentState="win":this.currentState="lose"},e}(BaseItemRender);__reflect(ConfrontRecordItemRender.prototype,"ConfrontRecordItemRender");var ConfrontRewardItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data.maxRank==this.data.minRank?this.rank.text=LangMgr.getValueByKey("ranking",this.data.minRank):this.rank.text=LangMgr.getValueByKey("ranking",this.data.minRank)+"~"+LangMgr.getValueByKey("ranking",this.data.maxRank),this.item0.data=this.data.rewards[0],this.item1.data=this.data.rewards[1]},e}(BaseItemRender);__reflect(ConfrontRewardItemRender.prototype,"ConfrontRewardItemRender");var ChallengeCopyControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upChallenge=function(){},e.prototype.uprequestDayReward=function(){},e.prototype.downUpDataInfo=function(t,e,i,n){copyBabelControl.setCurLevelInfo(t),copyBabelControl.dayReward=e,copyBabelControl.lotteryIndexs=i,copyBabelControl.lotteryUseTimes=n,EventMgr.ins().dispatch(506)},e.prototype.downRewardStatu=function(t){copyBabelControl.dayRewardList=[];for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1],o=t[e][2];copyBabelControl.dayRewardList[e]=[i,n,o]}copyBabelControl.rewardTimes=Math.ceil((t.length-12)/12),EventMgr.ins().dispatch(507)},e.prototype.downGetFbTime=function(t){copyBabelControl.setLimtTimeDown(t)},e.prototype.upGetDayReward=function(){},e.prototype.upBeginLottery=function(){},e.prototype.upGetReward=function(){},e.prototype.downLotteryReward=function(t,e){copyBabelControl.lotteryUseTimes=t,copyBabelControl.lotteryAwardIndex=e,EventMgr.ins().dispatch(509)},e.prototype.downGetReward=function(){EventMgr.ins().dispatch(508)},__decorate([up(1)],e.prototype,"upChallenge",null),__decorate([up(2)],e.prototype,"uprequestDayReward",null),__decorate([down(1,[3,2,3,3])],e.prototype,"downUpDataInfo",null),__decorate([down(2,[[3,3,3]])],e.prototype,"downRewardStatu",null),__decorate([down(3,[2])],e.prototype,"downGetFbTime",null),__decorate([up(4)],e.prototype,"upGetDayReward",null),__decorate([up(5)],e.prototype,"upBeginLottery",null),__decorate([up(6)],e.prototype,"upGetReward",null),__decorate([down(5,[3,3])],e.prototype,"downLotteryReward",null),__decorate([down(4)],e.prototype,"downGetReward",null),e=__decorate([protocolsId(24)],e)}(BaseSystem);__reflect(ChallengeCopyControl.prototype,"ChallengeCopyControl");var CopyBabelControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curLevel=1,e.lastPass=!1,e.stageLevel=1,e.dayReward=1,e.limitTime=180,e.rewardTimes=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"lotteryRemainTimes",{get:function(){var t,e=0;if(0!=this.curLevel){if(t=DataCenter.ins().BabelLotteryConfig[this.curLevel-1],this.curLevel-1<DataCenter.ins().BabelLotteryChallBaseConfig.LotteryOpenLevel)return 0}else{var i=Object.keys(DataCenter.ins().BabelLotteryConfig).length;t=DataCenter.ins().BabelLotteryConfig[i]}return t?e=t.lotteryCount-this.lotteryUseTimes:0},enumerable:!0,configurable:!0}),e.prototype.isGetLotteryAward=function(t){return 1==(this.lotteryIndexs>>t&1)},e.prototype.getNextOpenLevel=function(){var t=DataCenter.ins().BabelLotteryConfig;for(var e in t)if(t[e].id>=this.curLevel&&t[e].showIcon)return t[e];return null},e.prototype.getIsopenNext=function(){var t=DataCenter.ins().BabelLotteryConfig,e=t[this.curLevel];return ActorControl.level>=e.levelLimit?!0:!1},e.prototype.getSkyLevelList=function(t){var e=[],i=DataCenter.ins().BabelLotteryConfig,n=i[this.curLevel],o=this.getStageList(),s=CommonUtils.getObjectLength(o),r=n.layer,a=r+t-1;a>s&&(a=s,r=a-t+1,0>r&&(r=1));for(var l=0,h=o;l<h.length;l++){var u=h[l];if(u.layer>=r&&u.layer<=a&&(e.push(u),e.length>=t))break}return e},e.prototype.setLimtTimeDown=function(t){this.limitTime=t,TimerMgr.ins().remove(this.timeDown,this),TimerMgr.ins().doTimer(1e3,t,this.timeDown,this)},e.prototype.timeDown=function(){this.limitTime--,this.limitTime<0&&(this.limitTime=0,TimerMgr.ins().remove(this.timeDown,this))},e.prototype.getStageList=function(){var t=DataCenter.ins().BabelLotteryConfig,e=t[this.curLevel];this.stageLevel=e.group;var i=[];if(!e)return i;for(var n in t){var o=t[n];o.group==e.group&&i.push(o)}return i},e.prototype.setCurLevelInfo=function(t){t>0?(this.curLevel=t,this.lastPass=!1):(this.curLevel=CommonUtils.getObjectLength(DataCenter.ins().BabelLotteryConfig),this.lastPass=!0)},e}(BaseSystem);__reflect(CopyBabelControl.prototype,"CopyBabelControl");var CopyControl=function(t){function e(){var e=t.call(this)||this;return e.fbModel={},e._groupID=1,e._guanqiaID=-1,e.rewards=[],e.eliteRewards=[],e.maxLen=0,e.guanqiaReward=0,e.worldReward=0,e.worldGuanQias=[],e.worldGuanQiaHasReceive=[],e.currentEnergy=0,e.canChallengGuanQia=!0,e.encounterPos=[],e.goldMonterCount=0,e.goldMonterCountKill=0,e.expMonterCount=0,e.expMonterCountKill=0,e.isQuite=!0,e.guideBossKill=0,e.showAni=!0,e.showAutoPk=-1,e.showAutoPk2=-1,e.firstAutoGuilder=!1,e.fbGoldTotal=0,e.fbExpTotal=0,e.tfRoomID=0,e.tfPassID=0,e._tfInviteTime=0,e._friendInvateCD=0,e.showTfRed=!0,e.fbRings={buyTime:0,challengeTime:0,canTakeAward:!1,ispass:!1},e.guanqiaMonster=[],e.fbConfig={},e.mijingFingfen=4,e.mijingUseTime=0,e.failNotRedPoint={},e.pkGqboss=!1,e.exp=0,e.fbDataList=[],e.initPos=!0,e.addCustomEvent(353,e.onChangeScene),e.addCustomEvent(355,e.recordKill),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"rCount",{get:function(){return this.fbConfig.rCount||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"goldEff",{get:function(){return this.fbConfig.goldEff||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"expEff",{get:function(){return this.fbConfig.expEff||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zyPos",{get:function(){return this.fbConfig.zyPos},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"energy",{get:function(){return this.fbConfig.energy||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"waveEnergy",{get:function(){return this.fbConfig.waveEnergy||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"waveMonsterCount",{get:function(){return this.fbConfig.waveMonsterCount||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"waveMonsterId",{get:function(){return this.fbConfig.waveMonsterId||[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outPos",{get:function(){return this.fbConfig.outPos||{x:0,y:0,a:0}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rPos",{get:function(){return this.fbConfig.rPos||[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eliteMonsterId",{get:function(){return this.fbConfig.eliteMonsterId||0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wanderpercent",{get:function(){return void 0==this.fbConfig.wanderpercent?5e3:this.fbConfig.wanderpercent},enumerable:!0,configurable:!0}),e.prototype.upGetBossDrop=function(t,e){return[t,e]},e.prototype.downBossDrop=function(t,e,i){for(var n=this,o=0;o<i.length;o++){var s=new RewardVo;s.type=i[o][0],s.id=i[o][1],s.count=i[o][2],0==s.type&&1!=s.id&&2!=s.id&&9!=s.id||DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(UnitMgr.ins().getNoDieRole().x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(UnitMgr.ins().getNoDieRole().y/MapControl.CELL_SIZE),s])}DropControl.start(),TimerMgr.ins().doTimerDelay(500,100,1,function(){n.upGetBossDrop(t,e)},this)},e.prototype.downGuardLeftTime=function(t){guardControl.leftTime=t,EventMgr.ins().dispatch(377)},e.prototype.upChallengeGuard=function(){},e.prototype.upCallGuardBoss=function(){},e.prototype.upGuardUseSkill=function(t){return[t]},e.prototype.downGuardInfo=function(t,e){guardControl.challengeTimes=t,guardControl.isShowSweep=1==e,EventMgr.ins().dispatch(378)},e.prototype.downGuardUseSkill=function(t){EventMgr.ins().dispatch(379,t)},e.prototype.downGuardCopyInfo=function(t,e,i,n,o,s){guardControl.guardCopyInfo.parser(t,e,i,n,o,s),EventMgr.ins().dispatch(380)},e.prototype.recordKill=function(t){var e=t[0],i=t[1];e instanceof UnitRole||(0>=i&&(this.goldMonterCountKill+=1),0>=i&&(this.expMonterCountKill+=1))},e.prototype.initLogin=function(){var t=this,e=[];if(DataCenter.ins().DailyCopyConfig){this.fbDataList.length=0;for(var i in DataCenter.ins().DailyCopyConfig){var n=DataCenter.ins().DailyCopyConfig[i];n.bossId||e.push(n)}}e.sort(function(t,e){return t.sort<e.sort?-1:1}),e.map(function(e){t.fbDataList.push(e.id)})},e.prototype.onChangeScene=function(){this.rewards=[],this.eliteRewards=[],this.goldMonterCount=0,this.goldMonterCountKill=0,this.expMonterCountKill=0,this.expMonterCount=0,this.chatCampDtList||(this.chatCampDtList=new eui.ArrayCollection),(0==MapControl.copyType||20==MapControl.copyType)&&rambleControl.removeAllChatByType(8),this.tfRoomID||UIMgr.ins().close(TeamCopyRoomView),UIMgr.ins().close(TeamResultView),35==MapControl.copyType?UIMgr.ins().open(TeamCopyFightView):UIMgr.ins().close(TeamCopyFightView)},e.prototype.getFbDataById=function(t){return this.fbModel[t]},e.prototype.autoPk=function(){var t=this;if(MapControl.sceneInHook()){if(confrontControl.isEncounter())return void tipsControl.showTips(LangMgr.getValueByKey("atkPlayerIng"));var e=DataCenter.ins().ChaptersConfig[copyControl.guanqiaID].zsLevelLimit,i=ReincarnateControl.ins()?reincarnateControl.lv:0;if(e>i)return void tipsControl.showCenterTips(LangMgr.getValueByKey("kfTips74",e));var n=UnitMgr.ins().getNoDieRole();n&&(HookControl.ins().stop(),HookControl.ins().clearAIList(),this.dispatchPlayWarm(1),TimerMgr.ins().doTimer(500,1,function(){t.upPKBoss(n)},this),this.pkGqboss=!0)}},e.prototype.dispatchAddEnergy=function(){this.currentEnergy+=Math.ceil(this.waveEnergy/this.waveMonsterCount),this.currentEnergy>this.energy&&(this.currentEnergy=this.energy),EventMgr.ins().dispatch(493)},e.prototype.dispatchPlayWarm=function(t){EventMgr.ins().dispatch(639,t)},e.prototype.hasCount=function(){if(DataCenter.ins().DailyCopyConfig)for(var t in DataCenter.ins().DailyCopyConfig){var e=DataCenter.ins().DailyCopyConfig[t],i=this.fbModel[e.id];if(i&&!e.bossId&&!(e.id==DataCenter.ins().AshtarteConfig.fbIndex&&DataCenter.ins().AshtarteConfig.openserverday>GameServer.serverOpenDay+1)){var n=this.fbModel[i.fbID].getCount();if(n>0)return!0;if(DieGuide.ins().dieFbRedPoint(this.fbModel[i.fbID].getResetCount(),e.id))return!0}}return!1},e.prototype.downRoleAllDie=function(){resultControl.create(MapControl.copyType,0)},e.prototype.downFbInfoInit=function(t){for(var e,i=0;i<t.length;i++)e=new CopyModelVo,e.init(t[i]),this.fbModel[e.fbID]=e;EventMgr.ins().dispatch(368)},e.prototype.upCallBossPlay=function(t){return[t]},e.prototype.upChallenge=function(t){return[t]},e.prototype.downUpDataInfo=function(t,e,i,n,o){this.getFbDataById(t).init([t,e,i,n,o]),EventMgr.ins().dispatch(369)},e.prototype.upAddCount=function(t,e){return void 0===e&&(e=0),[t,e]},e.prototype.downFbTime=function(t,e){this.curFbID=t,this.curFbLeftTime=e,EventMgr.ins().dispatch(370,[this.curFbID,this.curFbLeftTime])},e.prototype.downBossBoxNum=function(t){this.bossCallNum=t},e.prototype.downFbExpInfo=function(t,e,i,n,o){this.fbExp=this.fbExp||{},this.fbExp.useTime=t,this.fbExp.sdTime=e,this.fbExp.cid=i,this.fbExp.sid=n,this.fbExp.isFirst=o,EventMgr.ins().dispatch(371,this.fbExp)},e.prototype.downFbExpTotal=function(t){this.fbExpTotal=t,EventMgr.ins().dispatch(372,this.fbExpTotal)},e.prototype.fbExpRed=function(){return ActorControl.level>=DataCenter.ins().CopyExpBaseConfig.openLv&&(this.fbExp.useTime<DataCenter.ins().CopyExpBaseConfig.freeCount+(DataCenter.ins().CopyExpBaseConfig.vipCount[vipControl.lv]||0)||this.fbExp.cid||this.fbExp.sid)?!0:!1},e.prototype.upIntoGuideFb=function(t){return[t]},e.prototype.upGuideFbAttacker=function(){},e.prototype.upGuideFbAlive=function(){},e.prototype.downGuideFbAliveTime=function(t,e){bossControl.downRemainTime(t,e)},e.prototype.downFbRingInfo=function(t,e,i){this.fbRings.buyTime=t,this.fbRings.challengeTime=e,this.fbRings.canTakeAward=i,EventMgr.ins().dispatch(373)},e.prototype.upRingSweep=function(t){return[t]
},e.prototype.upShSweep=function(t){return[t]},e.prototype.parser=function(t){this.guanqiaID=t,this.firstAutoGuilder&&this.guanqiaID==GameConst.AUTO_GUANQIA&&(this.firstAutoGuilder=!1,copyControl.setAutoPk2())},Object.defineProperty(e.prototype,"guanqiaID",{get:function(){return this._guanqiaID},set:function(t){if(this._guanqiaID!=t){this._guanqiaID=t,this.bossIsChallenged=!1;for(var e in DataCenter.ins().WorldRewardConfig)if(this._guanqiaID<=DataCenter.ins().WorldRewardConfig[e].needLevel){this._groupID=DataCenter.ins().WorldRewardConfig[e].groupId;break}this.dispatchGuanKaIdChange()}this.encounterPos=[];for(var i in this.zyPos)this.encounterPos.push(parseInt(i))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"groupID",{get:function(){return this._groupID},enumerable:!0,configurable:!0}),e.prototype.isReceiveBox=function(t){return-1!=this.worldGuanQias.indexOf(t)},e.prototype.isGetReceiveBox=function(t){return-1!=this.worldGuanQiaHasReceive.indexOf(t)},e.prototype.isShowBossPK=function(){return-1!=this.guanqiaID},e.prototype.getRewardsPop=function(){return this.rewards},e.prototype.getMapReward=function(){for(var t=1;DataCenter.ins().WorldRewardConfig[t];){if(!this.isGetReceiveBox(t)&&DataCenter.ins().WorldRewardConfig[t].needLevel<copyControl.guanqiaID)return void this.upGuanqiaWroldReward(t);t++}},e.prototype.getCurrentReward=function(){for(var t=1;DataCenter.ins().WorldRewardConfig[t];){var e=DataCenter.ins().WorldRewardConfig[t];this.isGetReceiveBox(t),copyControl.guanqiaID;if(!this.isGetReceiveBox(t)&&copyControl.guanqiaID>e.needLevel)return e.rewards;t++}return null},e.prototype.getNextReward=function(){for(var t=1;DataCenter.ins().WorldRewardConfig[t];){var e=DataCenter.ins().WorldRewardConfig[t];if(copyControl.guanqiaID<=e.needLevel)return e.rewards;t++}return null},e.prototype.getNextNeedChapter=function(){for(var t=1;DataCenter.ins().WorldRewardConfig[t];){var e=DataCenter.ins().WorldRewardConfig[t];if(copyControl.guanqiaID<=e.needLevel)return e.needLevel-copyControl.guanqiaID+1;t++}return 0},e.prototype.getDiffChapter=function(){for(var t=1;DataCenter.ins().WorldRewardConfig[t];){var e=DataCenter.ins().WorldRewardConfig[t];if(copyControl.guanqiaID<=e.needLevel){var i=DataCenter.ins().WorldRewardConfig[t-1];return i?e.needLevel-i.needLevel:e.needLevel+1}t++}return 0},e.prototype.getNewChapter=function(){for(var t=1;DataCenter.ins().WorldRewardConfig[t];){var e=DataCenter.ins().WorldRewardConfig[t];if(copyControl.guanqiaID<=e.needLevel){var i=t-1;return i=i?i:1,DataCenter.ins().WorldRewardConfig[i]}t++}return null},e.prototype.getChipByGuanQia=function(){for(var t in DataCenter.ins().WorldRewardConfig){var e=DataCenter.ins().WorldRewardConfig[t];if(this.guanqiaID<=e.needLevel)return e.rewards[0].id}return 0},e.prototype.downGuanqiaInfo=function(t,e,i,n,o){var s=this.guanqiaID;this.parser(t),this.goldEffLast=e,this.expEffLast=i,this.fbConfig=JSON.parse(n),-1!=s&&this.guanqiaID!=s&&(this.currentEnergy=0,UIMgr.ins().open(HookRewardTipsView)),this.guanqiaMonster=JSON.parse(o),0==MapControl.copyId&&gameControl.createGuanqiaMonster(),EventMgr.ins().dispatch(374)},e.prototype.dispatchGuanKaIdChange=function(){EventMgr.ins().dispatch(376)},e.prototype.upGetReward=function(t){return[t?1:0]},e.prototype.upPKBoss=function(t){return t?[Math.floor(t.x),Math.floor(t.y)]:!1},e.prototype.downWaveData=function(t,e,i){this.exp=t;for(var n=[],o=0;o<e.length;o++){var s=new WaveDropDataVo;s.init(e[o]),n.push(s)}i>0?(this.eliteRewards.push(n),this.eliteRewards.length>5&&this.eliteRewards.shift(),gameControl.createGuanqiaMonster(!1,!0)):this.rewards=this.rewards.concat(n)},e.prototype.downBossResult=function(t,e,i){for(var n,o=this,s=[],r=0;r<i.length;r++)n=new RewardVo,n.init(i[r]),s.push(n);if(90==e)resultControl.create(e,t,s);else if(t){for(var a=heroControl.subRolesLen,l=void 0,h=0;a>h;h++)l=UnitMgr.ins().getMainRole(h),l&&l.resetStand();for(var u=0;u<s.length;u++)if(n=s[u],0==n.type&&1!=n.id&&2!=n.id&&9!=n.id||29==e||DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(UnitMgr.ins().getNoDieRole().x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(UnitMgr.ins().getNoDieRole().y/MapControl.CELL_SIZE),n]),1==n.type){var p=DataCenter.ins().ItemConfig[n.id],c=ItemUtils.getType(p);if(7==c){var d=new ItemData;d.configID=n.id,tipsControl.showGoodEquipTips(d)}}DropControl.addCompleteFunc(function(){o.dropFunc(e,s)},this),DropControl.start()}else copyControl.pkGqboss=!1,1==MapControl.copyType&&portalControl.closeAuto(),resultControl.create(e,0);1==MapControl.copyType&&promptControl.dispatchKillBossEx(copyControl.guanqiaID),EventMgr.ins().dispatch(375,{fbType:e,result:t})},e.prototype.dropFunc=function(t,e){16!=t&&60!=t&&this.upGetBossReward();var i=null;if((9==t&&copyBabelControl.getIsopenNext()||6==t)&&(i=function(){if(copyControl.pkGqboss=!1,6==MapControl.copyType){if(copyControl.personalNoOpen)return void(copyControl.personalNoOpen=!1);UIMgr.ins().open(BossView,0)}else copyControl.isQuite&&UIMgr.ins().open(CopyView,2)}),18==t&&4e4==MapControl.copyId){var n=copyControl.guideBossKill,o=void 0,s=void 0,r=void 0,a=void 0;n?(o=ActorControl.myName,s=heroControl.roles[0].job,r=heroControl.roles[0].sex):(o=copyControl.guideBossPlayerName,s=copyControl.guideBossPlayerJob,r=copyControl.guideBossPlayerSex),a="yuanhead"+s+r,resultControl.create(t,!0,e,"",null,[n,o,a])}else if(16==MapControl.copyType)TimerMgr.ins().doTimer(800,1,function(){UIMgr.ins().open(ExpResultView)},this);else if(23==MapControl.copyType)TimerMgr.ins().doTimer(800,1,function(){UIMgr.ins().open(FireResultView)},this);else if(41==MapControl.copyType)TimerMgr.ins().doTimer(800,1,function(){UIMgr.ins().open(DemonCircleResultView,1,e)},this);else if(21==MapControl.copyType||31==MapControl.copyType);else if(77==t);else if(60==t)resultControl.create(t,1);else if(1!=t)e.length?TimerMgr.ins().doTimer(800,1,function(){resultControl.create(t,1,e,LangMgr.getValueByKey("userGitAward"),i)},this):(copyControl.pkGqboss=!1,copyControl.upExitFb());else if(this.outPos.x&&this.outPos.y){var l=this.outPos.x*MapControl.CELL_SIZE,h=this.outPos.y*MapControl.CELL_SIZE;this.outPos.hasOwnProperty("a")&&1==this.outPos.a&&gameControl.addOutEff(l,h);for(var u=heroControl.subRolesLen,p=void 0,c=0;u>c;c++)p=UnitMgr.ins().getMainRole(c),p&&MapControl.moveEntity(p,l,h);TimerMgr.ins().isExists(this.tempFunc,this)||TimerMgr.ins().doTimer(1e3,0,this.tempFunc,this)}else this.initPos=!0,copyControl.pkGqboss=!1,copyControl.upExitFb()},e.prototype.tempFunc=function(){var t=UnitMgr.ins().getNoDieRole();if(!t)return void TimerMgr.ins().remove(this.tempFunc,this);var e=Math.floor(t.x/MapControl.CELL_SIZE),i=Math.floor(t.y/MapControl.CELL_SIZE),n=this.outPos.x,o=this.outPos.y;e==n&&i==o&&(TimerMgr.ins().remove(this.tempFunc,this),gameControl.removeOutEff(),this.initPos=!1,this.pkGqboss=!1,this.upExitFb(),promptControl.enterMap())},e.prototype.upGetBossReward=function(){},e.prototype.upExitFb=function(){},e.prototype.upGetAward=function(){},e.prototype.downGuanqiaReward=function(t){this.guanqiaReward=t+1,this.dispatchGuanKaIdChange()},e.prototype.upGuanqiaWroldReward=function(t){return[t]},e.prototype.downGuanqiaWroldReward=function(t){var e=0,i=0;this.worldGuanQias=[],this.worldGuanQiaHasReceive=[];for(var n=0;n<t.length;n++)e=t[n],i=n+1,0==e?this.worldGuanQias.push(i):1==e&&this.worldGuanQiaHasReceive.push(i),(0==e||1==e)&&(this.worldReward=i)},e.prototype.downOfflineReward=function(t,e,i,n,o,s,r){var a=[];a[0]=t,a[1]=e,a[2]=i,a[3]=n,a[4]=o;for(var l=[],h=0;h<s.length;h++){var u={};u.type=s[h][0],u.exp=s[h][1],u.gold=s[h][2],l.push(u)}a[5]=l;for(var p=[],h=0;h<r.length;h++){var c={};c.id=r[h][0],c.count=r[h][1],p.push(c)}UIMgr.ins().open(OfflineRewardView,a,p)},e.prototype.getWorldGuanQia=function(){return this.worldGuanQias.length>0?this.worldGuanQias[this.worldGuanQias.length-1]:0},e.prototype.getWorldGuanQiaBox=function(){var t=this.worldGuanQias.length;if(t>0)for(var e=void 0,i=0;t>i;i++)if(e=this.worldGuanQias[i],copyControl.isReceiveBox(e))return e;return this.worldReward+1},e.prototype.upKillMonster=function(t){return[t]},e.prototype.upChallengeExpFb=function(){},e.prototype.upSaodang=function(){},e.prototype.upGetAwardMul=function(t,e){return[t,e]},e.prototype.upChallengeFbRing=function(){},e.prototype.upFbRingTakeAward=function(t){return[t]},e.prototype.checkGuanqiaIconShow=function(){return SwitchMgr.ins().checkOpen(14)},e.prototype.dispatchExpFly=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=10),EventMgr.ins().dispatch(594,[t,e,i])},e.prototype.getGoldFbId=function(){var t=DataCenter.ins().CopyGoldConfig,e=0;for(var i in t){var n=Math.floor(t[i].slv/1e3),o=t[i].slv%1e3;if(n>reincarnateControl.lv||o>ActorControl.level)break;e=+i}return e},e.prototype.getExpFbId=function(){var t=DataCenter.ins().CopyExpConfig,e=ActorControl.level,i=0;for(var n in t){if(t[n].slv>e)break;i=+n}return i},e.prototype.checkInFB=function(){return 1==MapControl.copyType||copyControl.pkGqboss?(tipsControl.showCenterTips(LangMgr.getValueByKey("atkLevelIng")),!0):mineControl.inCopy?(tipsControl.showCenterTips(LangMgr.getValueByKey("InTheMineIng")),!0):0==MapControl.copyId||toseongControl.isToseong?confrontControl.isEncounter()?(tipsControl.showTips(LangMgr.getValueByKey("atkPlayerIng")),!0):!1:(tipsControl.showCenterTips(LangMgr.getValueByKey("atkCopyIng")),!0)},e.prototype.createMonster=function(t){var e=this.guanqiaMonster[t],i=this.createModel(e);return i.name=e.name,i._avatar=+e.avatar,i._scale=e.scale,i.wanderrange=e.wanderrange,i.wandertime=e.wandertime,i.effect=e.effect,i._dirNum=void 0==e.dirNum?2:e.dirNum,i},e.prototype.createModel=function(t){var e=new UnitModel;return e.type=2,e.configID=t.id,e.setAtt(0,t.hp),e.setAtt(2,t.hp),e.setAtt(4,t.atk),e.setAtt(5,t.def),e.setAtt(6,t.res),e.setAtt(7,t.crit),e.setAtt(8,t.tough),e.setAtt(9,t.ms||1e3),e.setAtt(10,t.as||1e3),e.setAtt(20,t.penetRate||0),e},e.getPersonalBossFbIds=function(){var t=[];for(var e in DataCenter.ins().DailyCopyConfig){var i=DataCenter.ins().DailyCopyConfig[e];i&&i.bossId&&t.push(i),i&&i.judgeParam&&isNaN(copyControl.failNotRedPoint[i.fbId])&&(copyControl.failNotRedPoint[i.fbId]=0)}return t.sort(function(t,e){return t.sort<e.sort?-1:1}),t},e.prototype.IsExistNotShowRedPoint=function(t){return isNaN(t.judgeParam)?1:this.failNotRedPoint[t.fbId]?0:1},e.isCanChallengeEx=function(){for(var t=i.getPersonalBossFbIds(),e=0;e<t.length;e++)if(i.isCanChallenge(t[e].id)&&copyControl.IsExistNotShowRedPoint(t[e]))return!0;return!1},e.isCanChallenge=function(t){for(var e,i,n=this.getPersonalBossFbIds(),o=n.length,s=0;o>s;s++)if(e=n[s],(isNaN(t)||e.id==t)&&copyControl.getFbDataById(e.id)&&(i=copyControl.getFbDataById(e.id).getCount(),i>0))if(e.monthcard){if(payControl.monthDay>0)return!0}else if(e.privilege){if(payControl.getIsForeve())return!0}else if(e.specialCard){if(payControl.franchise)return!0}else if(e.zsLevel>0){if(reincarnateControl.lv>=e.zsLevel)return!0}else if(ActorControl.level>=e.levelLimit)return!0;return!1},e.prototype.setAutoPk=function(){-1==this.showAutoPk&&(this.showAutoPk=0,this.dispatchAutoPk())},e.prototype.dispatchAutoPk=function(){EventMgr.ins().dispatch(640)},e.prototype.setAutoPk2=function(){-1==this.showAutoPk2&&(this.showAutoPk2=0,this.dispatchAutoPk2())},e.prototype.dispatchAutoPk2=function(){EventMgr.ins().dispatch(641)},e.prototype.upCreateTFRoom=function(){},e.prototype.downCreateTFRoomSuccess=function(t,e){this.tfRoomID=t,this.tfRoomID?UIMgr.ins().open(TeamCopyRoomView,1,e,this.tfRoomID):UIMgr.ins().close(TeamCopyRoomView),EventMgr.ins().dispatch(381)},e.prototype.upEnterTFRoom=function(t){return[t]},e.prototype.downEnterTFRoomSuccess=function(t,e,i){switch(t){case 0:this.tfRoomID=i,UIMgr.ins().open(TeamCopyRoomView,1,e,this.tfRoomID);break;case 1:tipsControl.showTips(LangMgr.getValueByKey("babelFightLimitWeek",LangMgr.getValueByKey("weeksDay"+DataCenter.ins().AsTeamCopyBaseConfig.closeTime[0]),DataCenter.ins().AsTeamCopyBaseConfig.closeTime[1]));break;case 2:tipsControl.showTips(LangMgr.getValueByKey("inCopyNoEnter"));break;case 3:tipsControl.showTips(LangMgr.getValueByKey("alrInOtherRoom"));break;case 4:tipsControl.showTips(LangMgr.getValueByKey("roomNoExist"));break;case 5:tipsControl.showTips(LangMgr.getValueByKey("curPassLevelNoMeet"));break;case 6:tipsControl.showTips(LangMgr.getValueByKey("errorNoExistRoomConf"));break;case 7:tipsControl.showTips(LangMgr.getValueByKey("roomAlrMeet"));break;case 8:tipsControl.showTips(LangMgr.getValueByKey("fbShow3",DataCenter.ins().AsTeamCopyBaseConfig.openDay,CommonFun.convertLevel(DataCenter.ins().AsTeamCopyBaseConfig.needZsLv)))}},e.prototype.upExitTFRoom=function(){},e.prototype.downExitTFRoom=function(t){switch(t){case 1:break;case 2:tipsControl.showTips(LangMgr.getValueByKey("kickedOutRoom"));break;case 3:tipsControl.showTips(LangMgr.getValueByKey("dismissedRoom"))}UIMgr.ins().close(TeamCopyRoomView),this.tfRoomID=0},e.prototype.upBeginTF=function(){},e.prototype.downFTRoomChange=function(t,e){this.tfRoomID=t,this.tfMembers||(this.tfMembers=[]),this.tfMembers.length=e.length,this.isTFCaptain=!1;for(var i,n=0;n<e.length;n++)i=this.tfMembers[n],i||(i=new TeamCopyRoleVo,this.tfMembers[n]=i),i.parse(e[n]),i.roleID==ActorControl.actorID&&1==i.position&&(this.isTFCaptain=!0);EventMgr.ins().dispatch(382)},e.prototype.upOutTFRoom=function(t){return[t]},e.prototype.upExitTFFb=function(t){return[t]},e.prototype.downFTRoomPassInfo=function(t,e){this.tfPassID=t,this._tfInviteTime=e,EventMgr.ins().dispatch(383)},e.prototype.getTfInviteCD=function(){return Math.floor((this._tfInviteTime-GameServer.serverTime)/1e3)},e.prototype.getTfFriendInviteCD=function(){return Math.floor((this._friendInvateCD-GameServer.serverTime)/1e3)},e.prototype.isTeamFBOpen=function(){return reincarnateControl.lv>=DataCenter.ins().AsTeamCopyBaseConfig.needZsLv&&GameServer.serverOpenDay+1>=DataCenter.ins().AsTeamCopyBaseConfig.openDay},e.prototype.downTeamFuBenEnd=function(t,e,i){var n=[];n.length=i.length;for(var o,s=0;s<i.length;s++)o=new TeamCopyRoleVo,n[s]=o,o.roleID=i[s][0],o.position=i[s][1],o.roleName=i[s][2],o.job=i[s][3],o.sex=i[s][4];UIMgr.ins().open(TeamResultView,t,e,n)},e.prototype.downTeamFuBenRelive=function(t,e){bossControl.killerHandler=t,bossControl.reliveTime=e,bossControl.reliveTime>0?(bossControl.clearWorldBossList(),UIMgr.ins().open(WorldBossBeKillView)):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.upTFRank=function(){},e.prototype.downTeamFuBenRank=function(t){this.tfPassRanks=[];for(var e,i=0;i<t.length;i++){e={configID:t[i][0],members:[]};for(var n=t[i][1],o=0;o<n.length;o++)e.members.push({position:n[o][0],roleName:n[o][1]});this.tfPassRanks.push(e)}},e.prototype.upTfFlower=function(t,e){return[t,e]},e.prototype.downTeamFbFlowarRecords=function(t){this.tfFlowerRecords||(this.tfFlowerRecords=[]);for(var e=0;e<t.length;e++)this.tfFlowerRecords.push({roleName:t[e][0],count:t[e][1]});for(;this.tfFlowerRecords.length>10;)this.tfFlowerRecords.shift();EventMgr.ins().dispatch(384)},e.prototype.clearTfFlowerRecords=function(){this.tfFlowerRecords=[]},e.prototype.upTfSysInvite=function(t){return[t]},e.prototype.downTeamFbSysInviteInfo=function(t){rambleControl.dispatchSysChatMsg(new RambleSystemVo(3,t))},e.prototype.checkTFRed=function(){return this.isTeamFBOpen()?this.showTfRed:!1},e.prototype.dispatchShowRedChange=function(t){this.showTfRed=t,EventMgr.ins().dispatch(681)},e.prototype.upGuardWeaponLogs=function(){},e.prototype.downGuardWeaponLogs=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i][0],o=t[i][1],s=t[i][2],r=t[i][3];e.push({noticeId:n,roleName:o,monsterName:s,itemName:r})}EventMgr.ins().dispatch(385,e)},e.prototype.downFbChat=function(t,e,i,n,o){var s=new RambleCampVo;s.initData(t,e,i,n,o),this.insertFbChat(s),EventMgr.ins().dispatch(386)},e.prototype.insertFbChat=function(t){(0==t.campType||t.campType==ActorControl.camp)&&(rambleControl.addCampChat(t),rambleControl.dispatchNewChatMsg(t)),t.name==ActorControl.myName&&rambleControl.startInterval()},e.prototype.downKillNetwork=function(t,e,i,n,o,s,r,a,l,h){var u=[t,e,i,n,o],p=[s,r,a,l,h];this.killNetworkList||(this.killNetworkList=[]),this.killNetworkList.push({kill:u,dead:p}),EventMgr.ins().dispatch(387)},e.prototype.upFbChat=function(t,e){return rambleControl.checkCanSpeak()?[t,e]:(rambleControl.chatLimit(8,e,t),!1)},e.prototype.isFBChatChannle=function(){return crossArenaControl.isKFArena},e.prototype.LegendTempleReplaceHunShow=function(){return!1},e.prototype.upChallengeGoldFb=function(){},e.prototype.downFbGoldInfo=function(t,e){this.fbGold=this.fbGold||{},this.fbGold.useTime=t,this.fbGold.cid=e,EventMgr.ins().dispatch(389,this.fbGold)},e.prototype.downFbGoldTotal=function(t){this.fbGoldTotal=t,EventMgr.ins().dispatch(390,this.fbGoldTotal)},e.prototype.downAddDropGold=function(t){for(var e=0,i=0;i<t.length;i++){var n=new RewardVo;n.type=t[i][0],n.id=t[i][1],n.count=t[i][2],e+=n.count,DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(UnitMgr.ins().getNoDieRole().x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(UnitMgr.ins().getNoDieRole().y/MapControl.CELL_SIZE),n])}t.length>0&&DropControl.start(),EventMgr.ins().dispatch(391,e)},e.prototype.fbGoldRed=function(){return SwitchMgr.ins().checkOpen(1013)&&ActorControl.level>=DataCenter.ins().CopyGoldBaseConfig.openLv&&this.fbGold.useTime<DataCenter.ins().CopyGoldBaseConfig.freeCount+(DataCenter.ins().CopyGoldBaseConfig.vipCount[vipControl.lv]||0)?!0:!1},e.prototype.downExpLuckyAct=function(t,e,i){this.expFbLuckyDt={endTime:t,exp:e,isBuy:i},EventMgr.ins().dispatch(388,this.expFbLuckyDt)},e.prototype.upExpLuckyAct=function(){},e.prototype.upBuyExpLuckyAct=function(){},e.prototype.checkExpLuckyAct=function(){if(this.expFbLuckyDt){var t=(DateUtils.formatMiniDateTime(this.expFbLuckyDt.endTime)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0;if(!this.expFbLuckyDt.isBuy&&t>0)return!0}return!1},e.TF_SIMLPE_HEIGHT=149,e.TF_EXPAND_HEIGHT=298,__decorate([up(29,[1,10])],e.prototype,"upGetBossDrop",null),__decorate([down(29,[1,10,[3,3,3]])],e.prototype,"downBossDrop",null),__decorate([down(24,[6])],e.prototype,"downGuardLeftTime",null),__decorate([up(24)],e.prototype,"upChallengeGuard",null),__decorate([up(26)],e.prototype,"upCallGuardBoss",null),__decorate([up(27,[1])],e.prototype,"upGuardUseSkill",null),__decorate([down(25,[1,1])],e.prototype,"downGuardInfo",null),__decorate([down(27,[1])],e.prototype,"downGuardUseSkill",null),__decorate([down(28,[1,3,1,3,1,3])],e.prototype,"downGuardCopyInfo",null),__decorate([down(4)],e.prototype,"downRoleAllDie",null),__decorate([down(10,[[3,2,2,2,0]])],e.prototype,"downFbInfoInit",null),__decorate([up(12,[3])],e.prototype,"upCallBossPlay",null),__decorate([up(10,[3])],e.prototype,"upChallenge",null),__decorate([down(11,[3,2,2,2,0])],e.prototype,"downUpDataInfo",null),__decorate([up(11,[3,1])],e.prototype,"upAddCount",null),__decorate([down(13,[3,3])],e.prototype,"downFbTime",null),__decorate([down(14,[2])],e.prototype,"downBossBoxNum",null),__decorate([down(16,[4,4,4,4,4])],e.prototype,"downFbExpInfo",null),__decorate([down(17,[3])],e.prototype,"downFbExpTotal",null),__decorate([up(18,[3])],e.prototype,"upIntoGuideFb",null),__decorate([up(19)],e.prototype,"upGuideFbAttacker",null),__decorate([up(20)],e.prototype,"upGuideFbAlive",null),__decorate([down(18,[2,10])],e.prototype,"downGuideFbAliveTime",null),__decorate([down(21,[2,2,0])],e.prototype,"downFbRingInfo",null),__decorate([up(41,[2])],e.prototype,"upRingSweep",null),__decorate([up(42,[1])],e.prototype,"upShSweep",null),__decorate([down(1,[3,3,3,8,8])],e.prototype,"downGuanqiaInfo",null),__decorate([up(1,[1])],e.prototype,"upGetReward",null),__decorate([up(2,[3,3])],e.prototype,"upPKBoss",null),__decorate([down(2,[3,ByteConst.RewardVos,1])],e.prototype,"downWaveData",null),__decorate([down(3,[0,2,ByteConst.RewardVos])],e.prototype,"downBossResult",null),__decorate([up(3)],e.prototype,"upGetBossReward",null),__decorate([up(4)],e.prototype,"upExitFb",null),__decorate([up(5)],e.prototype,"upGetAward",null),__decorate([down(5,[2])],e.prototype,"downGuanqiaReward",null),__decorate([up(6,[3])],e.prototype,"upGuanqiaWroldReward",null),__decorate([down(6,[[3]])],e.prototype,"downGuanqiaWroldReward",null),__decorate([down(12,[3,3,3,3,3,[3,3,3],[1,3]])],e.prototype,"downOfflineReward",null),__decorate([up(13,[3])],e.prototype,"upKillMonster",null),__decorate([up(14)],e.prototype,"upChallengeExpFb",null),__decorate([up(15)],e.prototype,"upSaodang",null),__decorate([up(16,[1,1])],e.prototype,"upGetAwardMul",null),__decorate([up(22)],e.prototype,"upChallengeFbRing",null),__decorate([up(23,[2])],e.prototype,"upFbRingTakeAward",null),__decorate([up(30)],e.prototype,"upCreateTFRoom",null),__decorate([down(30,[3,3])],e.prototype,"downCreateTFRoomSuccess",null),__decorate([up(31,[3])],e.prototype,"upEnterTFRoom",null),__decorate([down(31,[1,3,3])],e.prototype,"downEnterTFRoomSuccess",null),__decorate([up(32)],e.prototype,"upExitTFRoom",null),__decorate([down(32,[1])],e.prototype,"downExitTFRoom",null),__decorate([up(33)],e.prototype,"upBeginTF",null),__decorate([down(33,[3,[3,1,8,1,1,3,3,3,1,3,3,3,3,3,1,1,3,1,3]])],e.prototype,"downFTRoomChange",null),__decorate([up(34,[3])],e.prototype,"upOutTFRoom",null),__decorate([up(35,[1])],e.prototype,"upExitTFFb",null),__decorate([down(34,[3,3])],e.prototype,"downFTRoomPassInfo",null),__decorate([down(35,[3,1,[3,1,8,1,1]])],e.prototype,"downTeamFuBenEnd",null),__decorate([down(36,[10,3])],e.prototype,"downTeamFuBenRelive",null),__decorate([up(36)],e.prototype,"upTFRank",null),__decorate([down(37,[[3,[1,8]]])],e.prototype,"downTeamFuBenRank",null),__decorate([up(37,[3,3])],e.prototype,"upTfFlower",null),__decorate([down(38,[[8,3]])],e.prototype,"downTeamFbFlowarRecords",null),__decorate([up(38,[8])],e.prototype,"upTfSysInvite",null),__decorate([down(39,[8])],e.prototype,"downTeamFbSysInviteInfo",null),__decorate([up(40)],e.prototype,"upGuardWeaponLogs",null),__decorate([down(40,[[3,8,8,8]])],e.prototype,"downGuardWeaponLogs",null),__decorate([down(43,[3,3,8,8,6])],e.prototype,"downFbChat",null),__decorate([down(45,[3,3,8,3,3,3,3,8,3,3])],e.prototype,"downKillNetwork",null),__decorate([up(43,[2,8])],e.prototype,"upFbChat",null),__decorate([up(100)],e.prototype,"upChallengeGoldFb",null),__decorate([down(101,[1,1])],e.prototype,"downFbGoldInfo",null),__decorate([down(102,[3])],e.prototype,"downFbGoldTotal",null),__decorate([down(103,[[3,3,3]])],e.prototype,"downAddDropGold",null),__decorate([down(50,[3,3,0])],e.prototype,"downExpLuckyAct",null),__decorate([up(50)],e.prototype,"upExpLuckyAct",null),__decorate([up(47)],e.prototype,"upBuyExpLuckyAct",null),e=i=__decorate([protocolsId(1)],e);var i}(BaseSystem);__reflect(CopyControl.prototype,"CopyControl");var CopyHelpControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cd=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.canHelp=function(){return MapControl.canHelp()},e.prototype.upFbHelp=function(t,e){var i=heroControl.getSubRoleByIndex(0),n=MapControl.copyName;if(crossBossControl.isKFBossBattle){var o=MapControl.copyId;for(var s in DataCenter.ins().CrossBossConfig)if(o==DataCenter.ins().CrossBossConfig[s].fbid){var r=DataCenter.ins().CrossBossConfig[s],a=crossBossControl.fbInfo[r.id];1==r.type&&a.serverId&&(n="S."+a.serverId+MapControl.copyName);break}}return[ActorControl.actorID,i.job,i.sex,unionControl.myOffice,vipControl.lv,reincarnateControl.lv,ActorControl.level,t,4,n,e||[]]},e.prototype.downFbHelpInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.copyHelpVo=this.copyHelpVo||new CopyHelpVo,(i=this.copyHelpVo).parser.apply(i,t),this.addGuildChatMsg(this.copyHelpVo);var i},e.prototype.addGuildChatMsg=function(t){var e=t.fbType+"+"+t.extData[0];t.extData[1]&&t.extData[2]&&(e+="+"+t.extData[1]+"%"+t.extData[2]);var i=DataCenter.ins().RambleConstConfig.helpInfo;i=i.replace("%s","|C:0x00ff00&T:"+t.fbName+"|"),i+=" |E:"+t.fbHelpType+","+e+",&U:&C:65280&T:"+LangMgr.getValueByKey("xiezhustr")+"|";var n=new UnionMessageInfoVo;n.type=1,n.roleId=t.actorId,n.name=t.playerName,n.job=t.job,n.sex=t.sex,n.office=t.office,n.vipLevel=t.vipLv,n.monthCard=0,n.zsLevel=t.zsLv,n.lv=t.level,n.guildName=unionControl.guildName,n.str=i,n.setTime(t.timeTick),n.analyzeE(),unionControl.addChatMsg(n)},e.prototype.seekHelp=function(){if(32==MapControl.copyType){for(var t in DataCenter.ins().CrossBossConfig)if(MapControl.copyId==DataCenter.ins().CrossBossConfig[t].fbid){this.toHelp(MapControl.copyType,t);break}}else if(62==MapControl.copyType){for(var t in DataCenter.ins().TotemBossFbConfig)if(MapControl.copyId==DataCenter.ins().TotemBossFbConfig[t].fbId){var e=UnitMgr.ins().getNoDieRole();e||(e=UnitMgr.ins().getMainRole(0)),e&&this.toHelp(MapControl.copyType,t,{x:e.x>>0,y:e.y>>0});break}}else if(26==MapControl.copyType){var i=bossControl.worldInfoList[5].concat();i.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"id")});for(var t in i)if(i[t].id==bossControl.currBossConfigID){this.toHelp(MapControl.copyType,t);break}}else this.toHelp(MapControl.copyType,bossControl.currBossConfigID)},e.prototype.toHelp=function(t,e,i){if(0==MapControl.copyId||toseongControl.isToseong)return void tipsControl.showTips(LangMgr.getValueByKey("copyaskforhelp"));var n=DataCenter.ins().RambleConstConfig.helpCdTime;if(GameServer.serverTime-this.cd<1e3*n){var o=(1e3*n-(GameServer.serverTime-this.cd))/1e3>>0;return void tipsControl.showTips(LangMgr.getValueByKey("askforhelplengque",o))}this.cd=GameServer.serverTime;var s=[e];i&&(s=s.concat([i.x,i.y])),this.upFbHelp(t,s),tipsControl.showCenterTips(LangMgr.getValueByKey("zhiyansendok"))},e.prototype.checkEnterToHelp=function(t,e){if(0!=MapControl.copyId&&!toseongControl.isToseong&&!totemBossControl.inCopy)return void tipsControl.showCenterTips(LangMgr.getValueByKey("atkCopyIng"));var i=t.split("+"),n=+i[0],o=+i[1],s=i[2]?i[2].split("%"):[];if(!e||e+1e3*DataCenter.ins().RambleConstConfig.helpTime<GameServer.serverTime)return void tipsControl.showTips(LangMgr.getValueByKey("textLinkTips5"));switch(n){case 32:crossBossControl.enterFb(o);break;case 50:dominateBossControl.enterFb(o);break;case 44:darkHallBossControl.enterFb(o);break;case 26:godWeaponControl.enterFb(o);break;case 57:reincarnateStarBossControl.enterFb(o);break;case 62:totemBossControl.inCopy?s&&s.length>0&&MapControl.moveTo(+s[0],+s[1]):s&&s.length>0?totemBossControl.enterFb(o,+s[0],+s[1]):totemBossControl.enterFb(o)}},__decorate([up(44,[3,1,1,1,1,1,2,2,2,8,[3]])],e.prototype,"upFbHelp",null),__decorate([down(44,[3,8,3,3,1,1,1,1,1,2,2,2,8,[3]])],e.prototype,"downFbHelpInfo",null),e=__decorate([protocolsId(1)],e)}(BaseSystem);__reflect(CopyHelpControl.prototype,"CopyHelpControl");var AmusementType25DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initAmusement=function(t){this.record=t[0]},e.prototype.updateAmusement=function(t){this.record=t[1]},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getConfig=function(){return DataCenter.ins().Amusement25Config},e.prototype.getIns=function(){return PAmusementControl.ins()},e.prototype.getRewardStateById=function(t){var e=this.getConfig()[this.id][t],i=Math.floor(this.record/Math.pow(2,e.index))%2;return i?AmusementControl.Geted:AmusementControl.CanGet},e.prototype.checkRedPoint=function(){var t=this.getConfig()[this.id];for(var e in t){var i=t[e],n=this.getRewardStateById(i.index);switch(n){case AmusementControl.CanGet:return!0;case AmusementControl.Geted:}}return!1},e.prototype.getHide=function(){if(this.isHide)return this.isHide;var t=this.record>>1,e=this.getConfig()[this.id];if(!e)return this.isHide=!1,this.isHide;var i=Object.keys(e);return t>=Math.pow(2,i.length)-1?(this.isHide=!0,this.isHide):(this.isHide=!1,this.isHide)},e}(AmusementBaseDataVo);__reflect(AmusementType25DataVo.prototype,"AmusementType25DataVo");var AmusementType26DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shopList=[],e}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.shopList.length=t[0].length;for(var e=0;t[0].length>e;e++)this.shopList[e]?(this.shopList[e].id=t[0][e][0],this.shopList[e].buyCount=t[0][e][1],this.shopList[e].canGet=t[0][e][2]):this.shopList[e]={id:t[0][e][0],buyCount:t[0][e][1],canGet:t[0][e][2]}},e.prototype.getShopData=function(t){for(var e=0;e<this.shopList.length;e++){var i=this.shopList[e];if(i.id==t)return i}return{id:t,buyCount:0,canGet:!1}},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getHide=function(){var t=DataCenter.ins().Amusement26Config[this.id];if(Object.keys(t).length!=this.shopList.length)return!1;for(var e=0;e<this.shopList.length;e++){var i=this.shopList[e],n=DataCenter.ins().Amusement26Config[this.id][i.id];if(n.buyCount>i.buyCount||i.canGet)return!1}return!0},e.prototype.checkRedPoint=function(){for(var t=0;t<this.shopList.length;t++){var e=this.shopList[t];if(e.canGet)return!0}return!1},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e}(AmusementBaseDataVo);__reflect(AmusementType26DataVo.prototype,"AmusementType26DataVo");var GuardControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShowSweep=!1,e.guardCopyInfo=new GuardCopyInfoVo,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.canChallenge=function(){return this.isOpen()&&DataCenter.ins().GuardWeaponGuardConfig.dailyCount>this.challengeTimes},e.prototype.isOpen=function(){var t=DataCenter.ins().GuardWeaponGuardConfig.opencondition,e=t[0],i=t[1];return reincarnateControl.lv>=e&&GameServer.serverOpenDay+1>=i},e.prototype.getCanSee=function(){var t=DataCenter.ins().GuardWeaponGuardConfig.opencondition,e=t[1];return GameServer.serverOpenDay+1>=e},e.prototype.getDesc=function(){var t=DataCenter.ins().GuardWeaponGuardConfig.opencondition,e=t[0],i=t[1];return LangMgr.getValueByKey("guarTips1",e,i)},e.prototype.getMaxWaves=function(){var t=DataCenter.ins().GuardWeaponWaveConfig[reincarnateControl.lv]||{};return Object.keys(t).length},e.prototype.getWaveTime=function(t){return 0==t?DataCenter.ins().GuardWeaponGuardConfig.starDelayRsf:DataCenter.ins().GuardWeaponWaveConfig[reincarnateControl.lv][t].time},e.prototype.isCanCallBoss=function(){return this.getCallBossTimes()>0},e.prototype.getCallBossTimes=function(){var t=this.guardCopyInfo.wave,e=0;for(var i in DataCenter.ins().GuardWeaponGuardConfig.sSummonLimit)t>=+i&&(e+=DataCenter.ins().GuardWeaponGuardConfig.sSummonLimit[i]);return e-this.guardCopyInfo.callBossNum},e.prototype.callBossMoney=function(){var t=this.getCallBossTimes();return DataCenter.ins().GuardWeaponGuardConfig.sSummonCost[t-1]},e.prototype.getKillWave=function(){return this.guardCopyInfo.wave},e}(SingleClass);__reflect(GuardControl.prototype,"GuardControl");var MonsterSpeakControl=function(t){function e(){var e=t.call(this)||this;return e.speakDic={},e.addCustomEvent(355,function(t){var i=t[0],n=t[1];40001==MapControl.copyId&&(i instanceof UnitRole||e.trigger(i.infoModel.configID,n>0?2:3))}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.clear=function(){this.speakDic={}},e.prototype.trigger=function(t,e){if((!this.speakDic[t]||!this.speakDic[t][e])&&DataCenter.ins().MonsterSpeakConfig){var i=DataCenter.ins().MonsterSpeakConfig[t];i&&i[e]&&(this.dispatchMonsterSpeak(i[e].speak),this.speakDic[t]=this.speakDic[t]||{},this.speakDic[t][e]=1)
}},e.prototype.dispatchMonsterSpeak=function(t){EventMgr.ins().dispatch(593,t)},e}(BaseSystem);__reflect(MonsterSpeakControl.prototype,"MonsterSpeakControl");var GuardCopyInfoVo=function(){function t(){this.wave=0,this.score=0,this.callBossNum=0,this.monsterNum=0,this.minMonsterWave=0,this.minMonsteNums=0}return t.prototype.parser=function(t,e,i,n,o,s){this.wave=t,this.score=e,this.callBossNum=i,this.monsterNum=n,this.minMonsterWave=o,this.minMonsteNums=s},t}();__reflect(GuardCopyInfoVo.prototype,"GuardCopyInfoVo");var GuardCallBossView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuardCallBossViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){var t=guardControl.getCallBossTimes(),e=guardControl.callBossMoney();this.callTimesLable.text=""+t,0==t&&(e=0),this.zb0.text=""+e,this.time=t,this.money=e,this.addEventTouchTap(this.closeBtn,this.closeWin),this.addEventTouchTap(this.up,this.callBoss)},e.prototype.callBoss=function(){this.time>0?ActorControl.yb<this.money?tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):copyControl.upCallGuardBoss():tipsControl.showTips(LangMgr.getValueByKey("guarNoCallBossTimes")),this.closeWin()},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GuardCallBossView.prototype,"GuardCallBossView");var GuardMainUIView=function(t){function e(){var e=t.call(this)||this;return e.skillCd1=0,e.skillCd2=0,e.skillCd3=0,e.isDelayUpdateInfo=!1,e.isDelayBuff=!1,e.skinName="GuardMainUIViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.help,this.onHelp),this.addEventTouchTap(this.luckyBossBtn,this.onLuckBoss),this.addEventTouchTap(this.skillBtn1,this.useSkill),this.addEventTouchTap(this.skillBtn2,this.useSkill),this.addEventTouchTap(this.skillBtn3,this.useSkill),this.addCustomEvent(355,this.updateHead),this.addCustomEvent(380,this.delayUpdateInfo),this.addCustomEvent(80,this.doBuff),this.addCustomEvent(81,this.doBuff),this.addCustomEvent(379,this.useSkillHandler),void 0!=guardControl.leftTime?this.beginTime():this.addCustomEvent(377,this.beginTime),this.updateHeadIcon(),this.initHp(),this.updateInfo(),this.skillBtn1.icon=""+DataCenter.ins().GuardWeaponGuardConfig.sSkillIcon[0],this.skillBtn2.icon=""+DataCenter.ins().GuardWeaponGuardConfig.sSkillIcon[1],this.skillBtn3.icon=""+DataCenter.ins().GuardWeaponGuardConfig.sSkillIcon[2],this.skillcostnum1.text=""+DataCenter.ins().GuardWeaponGuardConfig.sSkillCost[0],this.skillcostnum2.text=""+DataCenter.ins().GuardWeaponGuardConfig.sSkillCost[1],this.skillcostnum3.text=""+DataCenter.ins().GuardWeaponGuardConfig.sSkillCost[2],this.shortcutCD1=new ShortcutCD(40),this.cdGroup1.addChild(this.shortcutCD1),this.shortcutCD2=new ShortcutCD(40),this.cdGroup2.addChild(this.shortcutCD2),this.shortcutCD3=new ShortcutCD(40),this.cdGroup3.addChild(this.shortcutCD3)},e.prototype.updateHeadIcon=function(){for(var t=0;5>t;t++){var e=this["player"+(t+1)],i=this["player"+(t+1)+"touxiang"],n=heroControl.getSubRoleByIndex(t);n?i.source="yuanhead"+n.job+n.sex:e.visible=!1}},e.prototype.onHelp=function(){HelpControl.openHelpWin(29)},e.prototype.updateBuffInfo=function(){this.isDelayBuff=!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)this.setBuff(e)},e.prototype.doBuff=function(){this.isDelayBuff||(this.isDelayBuff=!0,TimerMgr.ins().doTimer(80,1,this.updateBuffInfo,this))},e.prototype.setBuff=function(t){var e=UnitMgr.ins().getMainRole(t);e&&(this["littleBuff"+(t+1)].visible=e.hasBuff(59100))},e.prototype.useSkill=function(t){var e=t.target,i=1;switch(e){case this.skillBtn1:i=1;break;case this.skillBtn2:i=2;break;case this.skillBtn3:if(i=3,skillControl.hejiEnable)return void tipsControl.showTips(LangMgr.getValueByKey("clanAngerFull"))}var n=guardControl.guardCopyInfo,o=this["skillCd"+i];o>0?tipsControl.showTips(LangMgr.getValueByKey("clanSkillCD",o)):n.score<DataCenter.ins().GuardWeaponGuardConfig.sSkillCost[i-1]?tipsControl.showTips(LangMgr.getValueByKey("clanEnoughtScore")):copyControl.upGuardUseSkill(i)},e.prototype.useSkillHandler=function(t){this["shortcutCD"+t].play(DataCenter.ins().GuardWeaponGuardConfig.sSkillCd[t-1]),this["skillCd"+t]=DataCenter.ins().GuardWeaponGuardConfig.sSkillCd[t-1];var e="|C:"+LangMgr.getColor("color43")+"&T:"+DataCenter.ins().GuardWeaponGuardConfig.sSkillUseText[t-1]+"|";tipsControl.showTips(e)},e.prototype.delayUpdateInfo=function(){this.isDelayUpdateInfo||(this.isDelayUpdateInfo=!0,TimerMgr.ins().doTimer(200,1,this.updateInfo,this))},e.prototype.updateInfo=function(){this.isDelayUpdateInfo=!1;var t=guardControl.guardCopyInfo;this.refreshHints0.text="（"+t.wave+"/"+guardControl.getMaxWaves()+"）";var e;this.lastWave!=t.wave&&(e=guardControl.getWaveTime(t.wave),this.refreshHints1.text=""+e),this.lastWave=t.wave,this.dangqianbo1.text=""+t.minMonsterWave,this.dangqianbo2.text=""+t.minMonsteNums,this.zongshu2.text=""+t.monsterNum,this.zongshu0.text=""+t.score,this.redPoint.visible=guardControl.isCanCallBoss();var i;if(i=void 0==this.lastScore?t.score:t.score-this.lastScore,this.lastScore=t.score,i>0){var n=LangMgr.getValueByKey("clanScore",i);tipsControl.showTips(n)}},e.prototype.initHp=function(){for(var t=0;t<GlobalModel.roleNum;t++){var e=this["bloodBar"+t],i=heroControl.getSubRoleByIndex(t);if(i){var n=i.getAtt(0),o=i.getAtt(2);e.maximum=100,e.value=Math.floor(100*n/o)}}},e.prototype.updateHead=function(t){var e=t[0],i=t[1],n=t[2];if(e instanceof UnitRole&&i!=n){var o=e.infoModel,s=this["bloodBar"+o.index],r=o.getAtt(0),a=o.getAtt(2);s.maximum=100,s.value=100*r/a;var l=this["player"+(o.index+1)+"touxiang"];0==r?(l.filters=FilterUtils.ARRAY_GRAY_FILTER,this["time"+(o.index+1)]=DataCenter.ins().GuardWeaponGuardConfig.recoverCD):(l.filters=null,this["time"+(o.index+1)]=0,this["CountDown"+(o.index+1)].visible=!1)}},e.prototype.setTimeLabel=function(t){this["time"+t]--,this["time"+t]>0?(this["CountDown"+t].visible=!0,this["CountDown"+t].text=this["time"+t].toString()):this["CountDown"+t].visible=!1},e.prototype.onLuckBoss=function(){UIMgr.ins().open(GuardCallBossView)},e.prototype.beginTime=function(){this.isBegin||(this.time=guardControl.leftTime,this.isBegin=!0,TimerMgr.ins().doTimer(1e3,0,this.runTime,this))},e.prototype.runTime=function(){if(this.time-=1,this.time>0?this.lastTime&&(this.lastTime.text=DateUtils.getFormatBySecond(this.time,DateUtils.TIME_FORMAT_12)):(this.lastTime&&(this.lastTime.text=""),TimerMgr.ins().remove(this.runTime,this)),this.refreshHints1){var t=this.refreshHints1.text,e=+t;e>0&&(e--,this.refreshHints1.text=""+e)}for(var i=1;3>=i;i++)this["time"+i]>0&&this.setTimeLabel(i),this.setSkillCd(i)},e.prototype.setSkillCd=function(t){this["skillCd"+t]>0&&this["skillCd"+t]--},e}(BaseEuiView);__reflect(GuardMainUIView.prototype,"GuardMainUIView");var GuardQuitTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuardQuitTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.closeWin),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.closeWin),this.addEventTouchTap(this.BG,this.closeWin),this.addEventTouchTap(this.up,this.onQuit)},e.prototype.onQuit=function(){copyControl.upExitFb(),this.closeWin()},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GuardQuitTipsView.prototype,"GuardQuitTipsView");var GuardRewardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuardRewardViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.closeWin),this.addEventTouchTap(this.giveUp,this.closeWin)},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GuardRewardView.prototype,"GuardRewardView");var GuardWeaponPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemList.itemRenderer=ItemBase,this.noticeList.itemRenderer=GuardLogsListItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btnChallenge,this.challenge),this.addCustomEvent(385,this.updateLogs),this.addCustomEvent(378,this.updateChallgeTimes),this.updateChallgeTimes(),this.itemList.dataProvider=new eui.ArrayCollection(DataCenter.ins().GuardWeaponGuardConfig.showReward[reincarnateControl.lv]),copyControl.upGuardWeaponLogs(),this.btnChallenge.label=guardControl.isShowSweep?LangMgr.getValueByKey("personSweap"):LangMgr.getValueByKey("personFight1")},e.prototype.updateChallgeTimes=function(){this.lbTime.text=(DataCenter.ins().GuardWeaponGuardConfig.dailyCount-guardControl.challengeTimes).toString()},e.prototype.challenge=function(){if(guardControl.isShowSweep){if(DataCenter.ins().GuardWeaponGuardConfig.dailyCount-guardControl.challengeTimes<=0)return void tipsControl.showCenterTips(LangMgr.getValueByKey("guarNoTimes"));UIMgr.ins().open(StoreSpecialView)}else copyControl.upChallengeGuard()},e.prototype.updateLogs=function(t){this.noticeList.dataProvider=new eui.ArrayCollection(t)},e.prototype.close=function(){this.removeCustomEvents()},e}(BasePanel);__reflect(GuardWeaponPanel.prototype,"GuardWeaponPanel");var ShortcutCD=function(t){function e(e){var i=t.call(this)||this;return i.setSize(e),i}return __extends(e,t),e.prototype.setSize=function(t){this.radius=t,this.graphics.clear(),this.graphics.beginFill(0,.9),this.graphics.drawCircle(0,0,t),this.graphics.endFill(),this.maskShape=new egret.Shape,this.maskShape.graphics.clear(),this.maskShape.graphics.beginFill(0,.7),this.maskShape.graphics.drawCircle(0,0,t),this.maskShape.graphics.endFill(),this.addChild(this.maskShape),this.mask=this.maskShape,this.visible=!1},e.prototype.play=function(t){t*=1e3,t>0&&(this.visible=!0,this.duration=t,this.startTime=egret.getTimer(),egret.startTick(this.onUpdate,this))},e.prototype.onUpdate=function(){var t=egret.getTimer(),e=t-this.startTime;return e>=this.duration?(this.stop(),!1):(this.maskShape.graphics.clear(),this.maskShape.graphics.beginFill(0,.7),this.maskShape.graphics.moveTo(0,0),this.maskShape.graphics.lineTo(this.radius,0),this.maskShape.graphics.drawArc(0,0,this.radius,e/this.duration*2*Math.PI-Math.PI/2,2*Math.PI-Math.PI/2),this.maskShape.graphics.lineTo(0,0),this.maskShape.graphics.endFill(),!1)},e.prototype.stop=function(){this.visible=!1,egret.stopTick(this.onUpdate,this),this.maskShape.graphics.clear()},e}(egret.Sprite);__reflect(ShortcutCD.prototype,"ShortcutCD");var GuardLogsListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuardLogsListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=DataCenter.ins().GuardWeaponGuardConfig.UIshowDrop[this.data.noticeId];t=t?t:LangMgr.getColor("color39");var e=DataCenter.ins().GuardWeaponGuardConfig.UIshowDropNotice;e=StringUtils.replace(e,this.data.roleName,this.data.monsterName,"|C:"+t+"&T:"+this.data.itemName),this.showText.textFlow=TextUtils.generateTextFlow1(e)}},e}(BaseItemRender);__reflect(GuardLogsListItemRender.prototype,"GuardLogsListItemRender");var CopyHelpVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fbHelpType=4,e}return __extends(e,t),e.prototype.parser=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.timeTick=t[0],this.playerName=t[1],this.fbId=t[2],this.actorId=t[3],this.job=t[4],this.sex=t[5],this.office=t[6],this.vipLv=t[7],this.zsLv=t[8],this.level=t[9],this.fbType=t[10],this.fbHelpType=t[11],this.fbName=t[12],this.extData=t[13]},e}(egret.HashObject);__reflect(CopyHelpVo.prototype,"CopyHelpVo");var CopyModelVo=function(){function t(){}return t.prototype.init=function(t){this.fbID=t[0],this.useCount=t[1],this.vipBuyCount=t[2],this.vipHoldCount=t[3],this.isPass=t[4]},t.prototype.getCount=function(){if(Assert(!isNaN(this.fbID),"fbid is undefined"))return 0;var t=DataCenter.ins().DailyCopyConfig[this.fbID];if(Assert(t,"DailyFubenConfig is null"))return 0;if(t.zsLevel>0){if(reincarnateControl.lv<t.zsLevel)return 0}else if(ActorControl.level<t.levelLimit)return 0;return t.freeCount+this.vipBuyCount+this.vipHoldCount-this.useCount},t.prototype.getPlayCount=function(){if(Assert(!isNaN(this.fbID),"fbid is undefined"))return 0;var t=DataCenter.ins().DailyCopyConfig[this.fbID];return Assert(t,"DailyFubenConfig is null")?0:t.freeCount+this.vipBuyCount+this.vipHoldCount-this.useCount},t.prototype.getNextVip=function(){if(Assert(!isNaN(this.fbID),"fbid is undefined"))return-1;var t=DataCenter.ins().DailyCopyConfig[this.fbID];if(Assert(t,"DailyFubenConfig is null"))return-1;for(var e in t.vipBuyCount)if(this.useCount-t.freeCount-t.vipBuyCount[e]<0)return parseInt(e);return-1},t.prototype.getResetCount=function(){var t=vipControl.lv,e=DataCenter.ins().DailyCopyConfig[this.fbID];return e.vipBuyCount[t]-(this.useCount-e.freeCount)},t}();__reflect(CopyModelVo.prototype,"CopyModelVo");var WaveDropDataVo=function(){function t(){this.drops=[]}return t.prototype.init=function(t){this.drops.length=1,this.drops[0]=this.drops[0]||new RewardVo,this.drops[0].init(t)},t}();__reflect(WaveDropDataVo.prototype,"WaveDropDataVo");var TeamCopyRoleVo=function(){function t(){this.thirteenEquipLv=0,this.weaponViewId=0,this.clothesViewId=0}return t.prototype.parse=function(t){this.roleID=t[0],this.position=t[1],this.roleName=t[2],this.job=t[3],this.sex=t[4],this.cloth=t[5],this.weapon=t[6],this.wingLv=t[7],this.wingState=t[8],this.pos1=t[9],this.pos2=t[10],this.pos3=t[11],this.zs=t[12],this.lv=t[13],this.thirteenEquipLv=t[14],this.weaponViewType=t[15],this.weaponViewId=t[16],this.clothesViewType=t[17],this.clothesViewId=t[18]},t.prototype.toSubRole=function(){var t=new RankSubRoleVo;return t.job=this.job,t.sex=this.sex,t.clothID=this.cloth,t.swordID=this.weapon,t.pos1=this.pos1,t.pos2=this.pos2,t.pos3=this.pos3,t.wingLevel=this.wingLv,t.thirteenEquipLv=this.thirteenEquipLv,t.weaponViewType=this.weaponViewType,t.weaponViewId=this.weaponViewId,t.clothesViewType=this.clothesViewType,t.clothesViewId=this.clothesViewId,t},t}();__reflect(TeamCopyRoleVo.prototype,"TeamCopyRoleVo");var FriendListView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FriendListViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=FriendItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._des=t[0],this.addEventTouchTap(this,this.onTouch),this.addEventTouchTap(this.list,this.onListTap),this.addCustomEvent(212,this.update),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeEventTouchTap(this.list,this.onListTap),this.removeCustomEvents()},e.prototype.update=function(){this._collect||(this._collect=new ArrayCollection,this.list.dataProvider=this._collect),this._collect.source=partnerControl.friendsList.source},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onListTap=function(t){var e=this.list.selectedItem;e&&partnerControl.upChat(e.id,this._des,1)},e}(BaseEuiView);__reflect(FriendListView.prototype,"FriendListView");var MemberInfoView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MemberInfoViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._data=t[0],this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(478,this.openOtherPlayerView),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents()},e.prototype.update=function(){this.imgBg.source=RambleListItemRenderer.HEAD_BG[this._data.sex],this.imgHead.source="head_"+this._data.job+this._data.sex,this.labelName.text=this._data.roleName,this.labelLv.text=(this._data.zs?this._data.zs+LangMgr.getValueByKey("numberLevel",""):"")+this._data.lv+LangMgr.getValueByKey("numberLevel",""),this.btnRemove.visible=copyControl.isTFCaptain},e.prototype.onTouch=function(t){switch(t.target){case this.btnInfo:rankOtherUserControl.upFindPlayer(this._data.roleID);break;case this.btnRemove:copyControl.upOutTFRoom(this._data.roleID),UIMgr.ins().close(this);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.openOtherPlayerView=function(t){UIMgr.ins().open(TeamCopyCheckRoleView,t)},e}(BaseEuiView);__reflect(MemberInfoView.prototype,"MemberInfoView");var TeamCopyCheckRoleView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyCheckRoleViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.selectedIndex=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.otherPlayerData=t[0],this.roleSelect.otherPlayerData=this.otherPlayerData,this.nameTxt.text=this.otherPlayerData.name,this.roleSelect.open(),this.addEventTouchTap(this,this.onClick),this.addEventChange(this.roleSelect,this.onChange),this.roleSelect.setCurRole(0),this.setRoleInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onClick),this.roleInfoPanel.clear()},e.prototype.destoryView=function(){t.prototype.destoryView.call(this),this.roleSelect.close(),this.roleInfoPanel.close()},e.prototype.setRoleInfo=function(){var t=this.otherPlayerData.roleData[0],e="[S"+this.otherPlayerData.serverId+"]";this.otherPlayerData.serverId&&this.otherPlayerData.serverId!=GlobalModel.srvid||(e=""),this.nameTxt.text=this.otherPlayerData.name+e,this.guildNameText.x=this.nameTxt.x+this.nameTxt.textWidth+10,this.guildNameText.text=this.otherPlayerData.guildName?LangMgr.getValueByKey("auctionPart")+"："+this.otherPlayerData.guildName:"";var i=this.otherPlayerData.zhuan?LangMgr.getValueByKey("numberRotation",this.otherPlayerData.zhuan):"";this.levelText.text=""+i+this.otherPlayerData.level+LangMgr.getValueByKey("numberLevel",""),this.headIcon.source="head_"+t.job+t.sex;var n=this.otherPlayerData.lilianLv,o=DataCenter.ins().ExperienceKingLevelConfig[n];this.jueweiIcon.source="juewei_1_"+o.type+"_png"},e.prototype.onChange=function(t){this.setView(this.roleSelect.getCurRole())},e.prototype.setView=function(t){void 0===t&&(t=0),this.roleInfoPanel.curRole=this.roleSelect.getCurRole(),this.roleInfoPanel.open(this.otherPlayerData)},e.prototype.onClick=function(t){switch(t.target){case this.closeBtn1:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(TeamCopyCheckRoleView.prototype,"TeamCopyCheckRoleView");var TeamCopyDescentPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._index=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.Fblist.itemRenderer=TeamCopyItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(383,this.update),this.addCustomEvent(11,this.listFresh),this._firstOpen=!0,this.update(),copyControl.dispatchShowRedChange(!1)},e.prototype.listFresh=function(t,e){if(this._collect&&t.itemIndex==this._collect.length-1){var i=CopyControl.TF_EXPAND_HEIGHT-CopyControl.TF_SIMLPE_HEIGHT;1==e?this.Fblist.scrollV=this.Fblist.contentHeight-this.Fblist.height+i:this.Fblist.scrollV=this.Fblist.contentHeight-this.Fblist.height-i,this.Fblist.validateNow()}},e.prototype.update=function(){this._collect||(this._collect=new ArrayCollection,this.Fblist.dataProvider=this._collect);for(var t,e=Object.keys(DataCenter.ins().AsTeamCopyConfig).length,i=[],n=0;e>n;n++)t=DataCenter.ins().AsTeamCopyConfig[n+1].id==copyControl.tfPassID+1,t&&(this._index=n),i.push({config:DataCenter.ins().AsTeamCopyConfig[n+1],passID:copyControl.tfPassID,open:t});this._collect.source=i,this.Fblist.validateNow(),this._firstOpen&&(this._firstOpen=!1,TimerMgr.ins().doTimer(50,1,this.selectCanChallege,this),this.selectCanChallege())},e.prototype.selectCanChallege=function(){var t=(this._index+1)*CopyControl.TF_SIMLPE_HEIGHT-this.Fblist.height+CopyControl.TF_EXPAND_HEIGHT-CopyControl.TF_SIMLPE_HEIGHT;this.Fblist.scrollV=t>0?t:0,this.Fblist.validateNow()},e}(BaseEuiView);__reflect(TeamCopyDescentPanel.prototype,"TeamCopyDescentPanel");var TeamCopyFightView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyFightViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.teamFbMember.touchEnabled=!1,this.teamFbMember.touchChildren=!1,this.gonglveTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.gonglveTxt.text)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(370,this.setTime),TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(1e3,0,this.update,this),this.setTime([copyControl.curFbID,copyControl.curFbLeftTime]),this.updateFbName(),this.update()},e.prototype.close=function(){},e.prototype.updateFbName=function(){var t;for(var e in DataCenter.ins().AsTeamCopyConfig)if(t=DataCenter.ins().AsTeamCopyConfig[e],t.fbid==MapControl.copyId){this.teamFbName.source=t.nameImg,this._roomID=t.id;break}},e.prototype.setTime=function(t){TimerMgr.ins().remove(this.updateLeftTime,this),35==MapControl.copyType&&(this._leftTime=t[1],this.updateLeftTime(),TimerMgr.ins().doTimer(1e3,0,this.updateLeftTime,this))},e.prototype.updateLeftTime=function(){return this.leftTimeTxt.text=DateUtils.getFormatBySecond(this._leftTime,DateUtils.TIME_FORMAT_5,4),this._leftTime<=0?void TimerMgr.ins().remove(this.updateLeftTime,this):void this._leftTime--},e.prototype.onTouch=function(t){switch(t.target){case this.target1:case this.target2:case this.target3:case this.target4:case this.boss:t.target.data&&t.target.data.infoModel&&(ClientStorage.ins().setValue("mapClickTx",0),ClientStorage.ins().setValue("mapClickTy",0),gameControl.dispatchChangeAttrPoint(t.target.data.infoModel.handle));break;case this.gonglveTxt:UIMgr.ins().open(TeamCopyGuideView,this._roomID)}},e.prototype.update=function(){var t,e,i,n,o=UnitMgr.ins().getAllEntity(),s=[],r=[],a=[];for(var l in o)if(t=o[l],i=t.infoModel)if(1==i.type){if(e=i,e.masterHandle!=ActorControl.handle){var h=s.indexOf(e.masterHandle);-1==h?(s.push(e.masterHandle),r[r.length]=[t]):r[h].push(t)}}else if(2==i.type&&i.getAtt(0)>0){var u=DataCenter.ins().MonstersConfig[i.configID];if(!u)continue;if(4==u.type||3==u.type)continue;var p=1==u.type;!p&&!i.masterHandle&&a.length<4&&a.push(t),p&&(n=t)}this.teamFbMember.visible=r.length>0;for(var c,d=r.length,l=0;2>l;l++)c=this["member"+(l+1)],d>=l+1?(c.visible=!0,c.data=r[l]):c.visible=!1;for(var g,m=a.length,l=1;5>l;l++)g=this["target"+l],m>=l?(this.teamFbTarget.addChild(g),g.data=a[l-1]):DisplayUtils.removeFromParent(g);n?(this.boss.data=n,this.teamFbTarget.addChildAt(this.boss,Math.ceil(this.teamFbTarget.numChildren/2))):DisplayUtils.removeFromParent(this.boss)},e}(BaseEuiView);__reflect(TeamCopyFightView.prototype,"TeamCopyFightView");var TeamCopyGuideView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyGuideViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=TeamCopyGuideItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roomId=t[0],this.addEventTouchTap(this.bgClose,this.onTouch),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTouch),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTouch)},e.prototype.update=function(){this.fbName.text=DataCenter.ins().AsTeamCopyConfig[this._roomId].name,this._collect||(this._collect=new ArrayCollection,this.list.dataProvider=this._collect);for(var t=Object.keys(DataCenter.ins().AsTeamCopyGuideConfig[this._roomId]).length,e=[],i=1;t>=i;i++)e.push(DataCenter.ins().AsTeamCopyGuideConfig[this._roomId][i]);this._collect.source=e},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TeamCopyGuideView.prototype,"TeamCopyGuideView");var TeamCopyInviteView=function(t){function e(){var e=t.call(this)||this;return e._deDes="",e.skinName="TeamCopyInviteViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._deDes=t[0],this._room=t[1],t.length>2?this._type=t[2]:this._type=1,this.input.text=this._deDes,this.input.maxChars=40,this.addEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.worldInviteBtn:var e=copyControl.getTfInviteCD();if(e>0)return void tipsControl.showTips(LangMgr.getValueByKey("babelWorld",e));copyControl.upTfSysInvite(this.getDes()+("|E:"+this._type+","+copyControl.tfRoomID+",&U:&C:"+LangMgr.getColor("color43")+"&T:"+LangMgr.getValueByKey("babelFastJoin"))),UIMgr.ins().close(this);break;case this.friendInviteBtn:UIMgr.ins().open(FriendListView,this.getDes()+("|E:"+this._type+","+copyControl.tfRoomID+",&U:&C:"+LangMgr.getColor("color43")+"&T:"+LangMgr.getValueByKey("babelFastJoin"))),UIMgr.ins().close(this)}},e.prototype.getDes=function(){var t=this.input.text?this.input.text:this._deDes,e="[|C:"+LangMgr.getColor("color59")+"&T:"+ActorControl.myName+"|]";return t=t==this._deDes?t.replace(LangMgr.getValueByKey("babelme"),e):e+t},e}(BaseEuiView);__reflect(TeamCopyInviteView.prototype,"TeamCopyInviteView");var TeamCopyRoomView=function(t){function e(){var e=t.call(this)||this;return e._state=0,e._room=0,e.skinName="TeamCopyRoomViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._state=t[0],this._config=DataCenter.ins().AsTeamCopyConfig[t[1]],this._room=t[2],this.addCustomEvent(382,this.onRoomInfoChange),this.addCustomEvent(381,this.createSuccess),this.addEventTouchTap(this,this.onTouch),this.update(),this.onRoomInfoChange(),UIMgr.ins().open(RambleMainView)},e.prototype.close=function(){UIMgr.ins().close(RambleMainView)},e.prototype.createSuccess=function(){this._room=copyControl.tfRoomID,this.onRoomInfoChange()},e.prototype.update=function(){if(this._collect||(this._collect=new ArrayCollection,this.itemList.dataProvider=this._collect),this._collect.source=this._config.rewardShow,this.fbName.text=this._config.name,this.passTxt.visible=!1,this.infoText.visible=!1,this.roleGroup.visible=!0,this.challengeBtn.visible=!1,this.leader.visible=this.member1.visible=this.member2.visible=!1,0==this._state)this.roleGroup.visible=!1,this.infoText.visible=!0,this.infoText.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("babelPassFight",DataCenter.ins().AsTeamCopyConfig[this._config.id-1].name));else if(2==this._state){this.passTxt.visible=!0,this.member1.visible=this.member2.visible=!1;var t=new TeamCopyRoleVo,e=heroControl.getSubRoleByIndex(0);t.roleID=ActorControl.actorID,t.position=1,t.roleName=ActorControl.myName,t.job=e.job,t.sex=e.sex,t.cloth=e.getEquipByIndex(2).item.configID,t.weapon=e.getEquipByIndex(0).item.configID,t.wingLv=e.wingsData.lv,t.wingState=e.wingsData.openStatus,t.pos1=e.zhuangbei[0],t.pos2=e.zhuangbei[1],t.pos3=e.zhuangbei[2],t.zs=reincarnateControl.lv,t.lv=e.lv,this.leader.data={vo:t,configID:this._config.id},this.leader.visible=!0}else this.challengeBtn.visible=!0,this._room<=0&&copyControl.upCreateTFRoom()},e.prototype.onRoomInfoChange=function(){if(this._room){for(var t,e=copyControl.tfMembers?copyControl.tfMembers.length:0,i=[this.member1,this.member2],n=0;e>n;n++)1==copyControl.tfMembers[n].position?this.leader.data={vo:copyControl.tfMembers[n],configID:this._config.id}:(t=i.shift(),t.data={vo:copyControl.tfMembers[n],configID:this._config.id});e=i.length;for(var n=0;e>n;n++)i[n].data={vo:null,configID:this._config.id};i.length=0,i=null,this.member1.visible=null!=this.member1.data,this.member2.visible=null!=this.member2.data,this.leader.visible=null!=this.leader.data}},e.prototype.onTouch=function(t){switch(t.target){case this.challengeBtn:var i=new Date(GameServer.serverTime);if(i.getDay()==DataCenter.ins().AsTeamCopyBaseConfig.closeTime[0]&&i.getHours()>=DataCenter.ins().AsTeamCopyBaseConfig.closeTime[1])return tipsControl.showTips(LangMgr.getValueByKey("babelFightLimitWeek",LangMgr.getValueByKey("weeksDay"+DataCenter.ins().AsTeamCopyBaseConfig.closeTime[0]),DataCenter.ins().AsTeamCopyBaseConfig.closeTime[1])),void UIMgr.ins().close(this);if(!copyControl.isTFCaptain)return void tipsControl.showTips(LangMgr.getValueByKey("babelFightCaptain"));copyControl.upBeginTF(),UIMgr.ins().close(e);break;case this.closeBtn0:1==this._state?warnControl.show(LangMgr.getValueByKey("babelExitRoom"),function(){copyControl.upExitTFRoom(),UIMgr.ins().close(e)},this):UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(TeamCopyRoomView.prototype,"TeamCopyRoomView");var AssistantHeadItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="AssistantHeadItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.Name.text=this.data.vo.roleName,this.imgBg.source=RambleListItemRenderer.HEAD_BG[this.data.vo.sex],this.imgHead.source="head_"+this.data.vo.job+this.data.vo.sex,this.charm.text=LangMgr.getValueByKey("rankCharmValue",DataCenter.ins().AsTeamCopyConfig[this.data.id].chiv)},e}(BaseItemRender);__reflect(AssistantHeadItemRender.prototype,"AssistantHeadItemRender");var ChallengerHeadItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="ChallengerHeadItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.Name.text=this.data.roleName,this.imgBg.source=RambleListItemRenderer.HEAD_BG[this.data.sex],this.imgHead.source="head_"+this.data.job+this.data.sex},e}(BaseItemRender);__reflect(ChallengerHeadItemRender.prototype,"ChallengerHeadItemRender");var FriendItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="FriendsItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.labelName.text=this.data.name,this.imgBg.source=RambleListItemRenderer.HEAD_BG[this.data.sex],this.imgHead.source="head_"+this.data.job+this.data.sex,this.labelGuild.text=this.data.guildName?this.data.guildName:"",this.labelLv.text=(this.data.zs?this.data.zs+LangMgr.getValueByKey("numberLevel",""):"")+this.data.lv+LangMgr.getValueByKey("numberLevel","")},e}(BaseItemRender);__reflect(FriendItemRender.prototype,"FriendItemRender");var TeamCopyGuideItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.monHeadImg.source=t.monHead,this.nameTxt.text=t.monName,this.dangerLvTxt.textFlow=TextUtils.generateTextFlow(t.dangerLv),this.guideTxt.textFlow=TextUtils.generateTextFlow(t.guideText)},e}(BaseItemRender);__reflect(TeamCopyGuideItemRender.prototype,"TeamCopyGuideItemRender");var TeamCopyItemRender=function(t){function e(){var e=t.call(this)||this;return e._isShow=!1,e.skinName="TeamCopyItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.Rewardlist.itemRenderer=ItemBase,this.gonglveTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.gonglveTxt.text)},e.prototype.dataChanged=function(){this.data.open&&(this._isShow=!0,this.currentState="zhankai",this.validateNow()),this.nameImg.source=this.data.config.nameImg,this.fbDesc.textFlow=TextUtils.generateTextFlow(this.data.config.infoText),this.head.source=this.data.config.bossImg,this.Rewardlist.dataProvider=new ArrayCollection(this.data.config.rewardShow),this.nameTxt.text=this.data.config.bossName,this.fbImg.source=this.data.config.guanqiaImg,this.addEventRemovedFromStage(this,this.onRemove),this.addEventTouchTap(this,this.onTap),this.updateStates()
},e.prototype.updateStates=function(){this.lock.visible=this.data.config.id>this.data.passID+1,this.unlock.visible=!this.lock.visible,this.redPoint.visible=this.data.config.id==this.data.passID+1,this.createRoomBtn.visible=this.data.config.id>this.data.passID,this.done.visible=this.data.config.id<=this.data.passID},e.prototype.onTap=function(t){if(t.target==this.fbImg)this._isShow=!this._isShow,this.currentState=this._isShow?"zhankai":"normal",this.validateNow(),this.dataChanged(),EventMgr.ins().dispatch(11,this,this._isShow);else if(t.target==this.createRoomBtn){if(0!=MapControl.copyType)return void tipsControl.showTips(LangMgr.getValueByKey("babelCanNotFight"));UIMgr.ins().open(TeamCopyRoomView,this.state,this.data.config.id,0)}else t.target==this.gonglveTxt&&UIMgr.ins().open(TeamCopyGuideView,this.data.config.id)},Object.defineProperty(e.prototype,"state",{get:function(){return this.data.passID>=this.data.config.id?2:this.data.config.id==this.data.passID+1?1:0},enumerable:!0,configurable:!0}),e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.removeEventTouchTap(this,this.onTap)},e}(BaseItemRender);__reflect(TeamCopyItemRender.prototype,"TeamCopyItemRender");var TeamCopyMemberItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyMemberItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.fuhuoImg.visible=!1;for(var e,i=t.length,n=0;i>n;n++)if(t[n].infoModel.getAtt(0)>0){e=!0,this.updateRole(t[n]);break}e||(this.updateRole(t[0]),this.fuhuoImg.visible=!0)},e.prototype.updateRole=function(t){var e=t.infoModel;this.roleName.text=e.name,this.roleHead.source="yuanhead"+e.job+e.sex},e}(BaseItemRender);__reflect(TeamCopyMemberItemRender.prototype,"TeamCopyMemberItemRender");var TeamCopyRankItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyRankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.member.visible=!0,this.noteam.visible=!1,this.fubenName.text=DataCenter.ins().AsTeamCopyConfig[this.data.configID].name;for(var t=void 0,e=void 0,i=this.data.members.length,n=0;3>n;n++)t=this["img"+n],e=this["nameTxt"+n],i>=n+1?(t.source=1==this.data.members[n].position?"tfb_leader":2==this.data.members[0].position?"tfb_assistant":"",e.text=this.data.members[n].roleName):(t.source="",e.text="")}else this.member.visible=!1,this.noteam.visible=!0},e}(BaseItemRender);__reflect(TeamCopyRankItemRender.prototype,"TeamCopyRankItemRender");var TeamCopyRoleItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyRoleItemSkin",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.touchEnabled=!1,this.role.touchEnabled=!1,this.addEventTouchTap(this.invite,this.onTouch),this.addEventTouchTap(this.nomember,this.onTouch),this.addEventTouchTap(this.role.touch,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.invite:case this.nomember:if(!copyControl.isTFCaptain)return void tipsControl.showTips(LangMgr.getValueByKey("babelNeedPlayer"));UIMgr.ins().open(TeamCopyInviteView,DataCenter.ins().AsTeamCopyBaseConfig.inviteText.replace("{0}",DataCenter.ins().AsTeamCopyConfig[copyControl.tfPassID+1].name),copyControl.tfRoomID);break;case this.role.touch:this.data.vo.roleID!=ActorControl.actorID&&UIMgr.ins().open(MemberInfoView,this.data.vo,copyControl.isTFCaptain,this.onOutTFRoom,this)}},e.prototype.onOutTFRoom=function(t){copyControl.upOutTFRoom(t)},e.prototype.dataChanged=function(){if(this.data.vo){this.nomember.visible=this.invite.visible=!1,this.role.visible=this.position.visible=!0;var t=this.data.vo;this.roleName.text=t.roleName,3!=t.position?this.position.source=1==t.position?"tfb_leader":"tfb_assistant":this.position.source=null,this.role.data=t.toSubRole()}else this.nomember.visible=this.invite.visible=!0,this.role.data=null,this.role.visible=this.position.visible=!1,this.roleName.text=LangMgr.getValueByKey("clanEmptyJob")},e.prototype.destruct=function(){this.removeEventTouchTap(this.invite,this.onTouch),this.removeEventTouchTap(this.nomember,this.onTouch),this.removeEventTouchTap(this.role.touch,this.onTouch)},e}(BaseItemRender);__reflect(TeamCopyRoleItemRender.prototype,"TeamCopyRoleItemRender");var TeamCopyTargetItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyTargetItemSkin",e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().MonstersConfig[t.infoModel.configID];this.roleName.text=e.name,this.checkMonHead(e)&&(this.roleHead.source="monhead"+e.head+"_png"),gameControl.currAttackHandle&&gameControl.currAttackHandle==t.infoModel.handle?(this.addAttEffect(),this.targetName.visible=!0,this.targetSelect.visible=!0):(this.removeAttEffect(),this.targetName.visible=!1,this.targetSelect.visible=!1)},e.prototype.checkMonHead=function(t){return!Assert(t.head,LangMgr.getValueByKey("babelError1",t.id,t.name))},e.prototype.addAttEffect=function(){this.attEffect||(this.attEffect=new GameMovieClip,this.attEffect.x=49,this.attEffect.y=28,this.attEffect.playFile(PATH_EFF+"FightingEff",-1),this.addChild(this.attEffect))},e.prototype.removeAttEffect=function(){this.attEffect&&(this.attEffect.destroy(),this.attEffect=null)},e}(BaseItemRender);__reflect(TeamCopyTargetItemRender.prototype,"TeamCopyTargetItemRender");var d_launchX=180,d_launchY=500,d_firstX=0,d_firstY=0,d_distantX=77,d_distantY=93,d_depotX=320,d_depotY=620,d_waitTime=50,ChallengeDayRewardView=function(t){function e(){var e=t.call(this)||this;return e.arr=[],e.items=[],e.maxCount=12,e.isTopLevel=!0,e.skinName="ChallengeDayRewardViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.GetRewardBtn0,this.challenge),this.addEventTouchTap(this.bgClose,this.closeCB),this.addCustomEvent(507,this.setBtnStatu),challengeCopyControl.uprequestDayReward()},e.prototype.challenge=function(){var t=function(){challengeCopyControl.upGetDayReward()};this.playGet(t),this.canClicck=!1},e.prototype.setBtnStatu=function(){copyBabelControl.rewardTimes>=1?this.GetRewardBtn0.label=LangMgr.getValueByKey("babelReward",copyBabelControl.rewardTimes):this.GetRewardBtn0.label=LangMgr.getValueByKey("babelEnter"),this.arr=copyBabelControl.dayRewardList.slice(),this.playResult()},e.prototype.playResult=function(t){for(var e=this,i=this.arr.length>this.maxCount?this.maxCount:this.arr.length,n=0;i>n;n++){this.items[n]=this.createItem(this.arr[n]);var o=egret.Tween.get(this.items[n]);this.items[n].x=n%4*d_distantX+d_firstX,this.items[n].y=Math.floor(n/4)*d_distantY+d_firstY,this.items[n].alpha=0,o.wait(n*d_waitTime).to({alpha:1},200).call(function(){i--,0==i&&(void 0!=t&&t(),e.canClicck=!0)})}},e.prototype.playGet=function(t){for(var e=this,i=this.arr.length>this.maxCount?this.maxCount:this.arr.length,n=0;i>n;n++)if(this.items[n]){var o=egret.Tween.get(this.items[n]);o.to({y:d_depotY,x:d_depotX,scaleX:0,scaleY:0},300-50*Math.floor(n/4)).call(function(){i--,0==i&&(void 0!=t&&t(),e.releaseAllItem())})}},e.prototype.createItem=function(t){var e=new ItemBase;return this.listCon.addChild(e),e.data={type:t[0],count:t[2],id:t[1]},e.x=d_launchX,e.y=d_launchY,e},e.prototype.releaseAllItem=function(){for(var t in this.items)this.items[t].destruct(),this.listCon.removeChild(this.items[t]);this.items=[],0==copyBabelControl.rewardTimes&&UIMgr.ins().close(e)},e.prototype.closeCB=function(t){var e=this;if(this.canClicck){this.canClicck=!1;var i=function(){UIMgr.ins().close(e)};this.playGet(i)}},e}(BaseEuiView);__reflect(ChallengeDayRewardView.prototype,"ChallengeDayRewardView");var ChallengeInfoView=function(t){function e(){var e=t.call(this)||this;return e.isShowLog=!1,e.uilayer=GameLayer.SCENE2,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ChallengeInfoViewSkin",this.list.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=38==MapControl.copyType?soulBoneControl.getHunShouDunLeftTime():copyBabelControl.limitTime;this.time.text=DateUtils.getFormatBySecond(i,3),TimerMgr.ins().doTimer(1e3,i,this.setTimeLimit,this),this.refushInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.refushInfo=function(){var t=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel+1];t&&(this.levelLimit.text=t.zsLevelLimit>0?LangMgr.getValueByKey("numberRotation",t.zsLevelLimit):LangMgr.getValueByKey("personLevelFight",t.levelLimit),this.setTimeLimit())},e.prototype.setTimeLimit=function(){var t=38==MapControl.copyType?soulBoneControl.getHunShouDunLeftTime():copyBabelControl.limitTime;this.time.text=DateUtils.getFormatBySecond(t,3)},e}(BaseEuiView);__reflect(ChallengeInfoView.prototype,"ChallengeInfoView");var CopyBabelLotteryView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="CopyBabelLotteryViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addViewEvent(),this.updateView()},e.prototype.addViewEvent=function(){this.addEventTouchTap(this.choujiangBtn,this.getLottery),this.addEventTouchTap(this.closeBtn,this.close),this.addCustomEvent(509,this.onGetRewards),this.addCustomEvent(506,this.refreshView)},e.prototype.getLottery=function(){0==copyBabelControl.lotteryRemainTimes?tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes")):this.rolling?tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1")):challengeCopyControl.upBeginLottery()},e.prototype.onGetRewards=function(){this.beginLottery(copyBabelControl.lotteryAwardIndex)},e.prototype.refreshView=function(){var t=this;copyBabelControl.lotteryUseTimes%10==0?setTimeout(function(){t.updateView()},2e3):this.updateView()},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0,n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){challengeCopyControl.upGetReward(),e.flyItem(e["item"+(t-1)]),setTimeout(function(){e.rolling=!1,e.refreshView()},2e3)},this)},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.itemIcon.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.updateView=function(){this.num.text=copyBabelControl.lotteryRemainTimes.toString();for(var t=copyBabelControl.lotteryUseTimes,e=10*parseInt((t/10).toString())+10,i=DataCenter.ins().BabelLotteryChallConfig[e],n=i.group.length,o=0;n>o;o++){var s=this["item"+o];s.itemIcon.data=i.group[o];var r=copyBabelControl.isGetLotteryAward(o+1);s.rewardState(r)}},e}(BaseEuiView);__reflect(CopyBabelLotteryView.prototype,"CopyBabelLotteryView");var CopyBabelPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("towerName"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=SkyItemRender,this.iconList.itemRenderer=ItemBase,this.iconList0.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.challengeBtn,this.challenge),this.addEventTouchTap(this.challengeBtn0,this.getDayRewward),this.addEventTouchTap(this.jump,this.onClick),this.addEventTouchTap(this.choujiang,this.lotto),this.refushPanelInfo(),this.addCustomEvent(524,this.updateRedPoint),this.addCustomEvent(508,this.updateReward),this.addCustomEvent(220,this.initRanking),this.addCustomEvent(506,this.updateRedPointStyle),rankControl.upGetRankingData(4),this.updateRedPoint(),this.showRewwardLabel()},e.prototype.updateRedPointStyle=function(){this.redPoint0.visible=copyBabelControl.curLevel>1&&1==copyBabelControl.dayReward,this.redPoint1.visible=copyBabelControl.lotteryRemainTimes>0,this.updateTowerState()},e.prototype.lotto=function(t){0==copyBabelControl.curLevel&&0==copyBabelControl.rewardTimes?tipsControl.showTips(LangMgr.getValueByKey("babelAllPass")):UIMgr.ins().open(CopyBabelLotteryView)},e.prototype.destructor=function(){this.removeCustomEvents(),this.removeEventTouchTap(this.challengeBtn,this.challenge),this.removeEventTouchTap(this.challengeBtn0,this.getDayRewward),this.removeEventTouchTap(this.jump,this.onClick)},e.prototype.updateReward=function(){this.showRewwardLabel()},e.prototype.initRanking=function(t){if(4==t.type){this.rankModel=t;for(var e=t.getDataList(),i=1;3>=i;i++){var n=e[i-1];if(n){this["name"+(i-1)].text=n.player;var o=DataCenter.ins().BabelLotteryConfig[n.count];Assert(o,LangMgr.getValueByKey("babelError",n.count))?this["num"+(i-1)].text="":this["num"+(i-1)].text=LangMgr.getValueByKey("babelLayer",o.group,o.layer)}else this["rankImg"+(i-1)].visible=this["name"+(i-1)].visible=this["num"+(i-1)].visible=!1}var s=this.jump.text;this.jump.textFlow=TextUtils.generateTextFlow1("|U:&T:"+s)}},e.prototype.refushPanelInfo=function(){var t=this.list.layout&&this.list.layout.verticalGap?this.list.layout.verticalGap:0,i=Math.floor((this.rollbar.height+t)/83),n=copyBabelControl.getSkyLevelList(i);this.list.dataProvider=new eui.ArrayCollection(n);var o=DataCenter.ins().BabelLotteryNameConfig[copyBabelControl.stageLevel];this.nameLabel.text=o?o.name:"";var s=copyBabelControl.getNextOpenLevel();if(s){var r=DataCenter.ins().BabelLotteryNameConfig[s.group],a=LangMgr.getValueByKey("babelPassLayer",r.name,s.layer),l="";if(s.equipPos)l=LangMgr.getValueByKey("babelZWIndex",s.equipPos),this.noOpenTF.text=l,this.unlock.text=LangMgr.getValueByKey("babelZWOpen"),this.itemicon.runeName=l,this.itemicon.desc2=LangMgr.getValueByKey("babelLayer1",r.name,s.layer),this.itemicon.data=s.showIcon;else{this.itemicon.desc=LangMgr.getValueByKey("babelPassLayerLock",r.name,s.layer),this.itemicon.data=s.showIcon;var h=DataCenter.ins().ItemConfig[s.showIcon],u=ItemUtils.getQuality(h),p=LangMgr.getValueByKey("babelPassNew");u==e.RunType&&(p=LangMgr.getValueByKey("bagGet1")),this.unlock.text=p}this.openDesc.text=a}else this.topGroup.visible=!1,this.buttomGroup.verticalCenter=0;var c=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel];if(c){this.nowrawed.text=LangMgr.getValueByKey("babelPassLayerGet",c.layer);var d="";c.zsLevelLimit&&(d=LangMgr.getValueByKey("numberRotation",c.zsLevelLimit)),this.limit.text=LangMgr.getValueByKey("babelLevelFight",d,c.levelLimit),this.iconList.dataProvider=new eui.ArrayCollection([c.clearReward[0]]),this.iconList0.dataProvider=new eui.ArrayCollection([c.clearReward[1]]),this.expText.text=c.clearReward[2]?""+c.clearReward[2].count:"";var g=ActorControl.level>=c.levelLimit&&reincarnateControl.lv>=c.zsLevelLimit;this.limit.visible=!g,this.challengeBtn.visible=g}},e.prototype.updateRedPoint=function(){this.redPoint0.visible=copyBabelControl.curLevel>1&&1==copyBabelControl.dayReward,this.redPoint1.visible=copyBabelControl.lotteryRemainTimes>0,this.updateTowerState()},e.prototype.updateTowerState=function(){var t=!0;0!=copyBabelControl.curLevel&&copyBabelControl.curLevel-1<DataCenter.ins().BabelLotteryChallBaseConfig.LotteryOpenLevel&&(t=!1),this.dailyGift0.visible=t,this.choujiang.visible=t},e.prototype.challenge=function(){if(!copyControl.checkInFB()){if(copyBabelControl.lastPass)return void tipsControl.showTips(LangMgr.getValueByKey("babelTips1"));challengeCopyControl.upChallenge(),UIMgr.ins().closeTopLevel()}},e.prototype.getDayRewward=function(){return copyBabelControl.curLevel<=1?void tipsControl.showTips(LangMgr.getValueByKey("babelTips2")):copyBabelControl.dayReward<1?void tipsControl.showTips(LangMgr.getValueByKey("babelTips3")):2==copyBabelControl.dayReward?void tipsControl.showTips(LangMgr.getValueByKey("babelTips4")):void UIMgr.ins().open(ChallengeDayRewardView)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.jump:this.rankModel&&UIMgr.ins().open(CopyChallengeRankView,this.rankModel)}},e.prototype.showRewwardLabel=function(){var t="";t=1==copyBabelControl.dayReward?LangMgr.getValueByKey("babelCanGet"):LangMgr.getValueByKey("babelTommorwGet"),this.dailyGift.text=t},e.RunType=3,__decorate([callLater],e.prototype,"refushPanelInfo",null),e}(BasePanel);__reflect(CopyBabelPanel.prototype,"CopyBabelPanel");var CopyChallengeRankView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CopyChallengeRankViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.onClick),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onClick),this.rankModel=t[0],this.list0.itemRenderer=CopyChallengeRankItemRender,this.init()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e.prototype.init=function(){var t=this.rankModel.getDataList(),e=[];for(var i in t){if(!t[i].count)break;e.push(t[i])}this.list0.dataProvider=new eui.ArrayCollection(e);var n,o,s=e[this.rankModel.selfPos-1];s?(n=DataCenter.ins().BabelLotteryConfig[s.count],o=DataCenter.ins().BabelLotteryNameConfig[n.group],this.myRank.text=LangMgr.getValueByKey("babelMyRank",this.rankModel.selfPos)):(n=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel],o=DataCenter.ins().BabelLotteryNameConfig[n.group],this.myRank.text=LangMgr.getValueByKey("babelMyRank1")),n&&o&&(this.myNum.text=LangMgr.getValueByKey("babelLayer1",o.name,n.layer))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(CopyChallengeRankView.prototype,"CopyChallengeRankView");var CopyCountDownView=function(t){function e(){var e=t.call(this)||this;return e._count=1,e.skinName="CopyCountDownViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(MapControl.copyType){case 30:t[0]&&(this._count=t[0]),this.bgImg.source="peakness_start_fight";break;default:return}TimerMgr.ins().doTimer(1e3,this._count+1,this.upFun,this),this.upFun()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this)},e.prototype.upFun=function(){this.countDown.text=this._count+"",this._count--,this._count<0&&UIMgr.ins().close(e)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(MapControl.copyType){case 30:break;default:return!1}return!0},e}(BaseEuiView);__reflect(CopyCountDownView.prototype,"CopyCountDownView");var CopyExpPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("towerExp"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.btnEffMC=this.btnEffMC||ObjectPool.pop("GameMovieClip"),this.btnEffMC.playFile(PATH_EFF+"chargeff1",-1),this.btnGetEff.addChild(this.btnEffMC)},e.prototype.open=function(){this.addEventTouchTap(this,this.onTap),this.addCustomEvent(371,this.onUpdate),this.addCustomEvent(388,this.onLimitAct),this.onUpdate();var t;this.doubleImg1.visible=this.doubleImg2.visible=this.doubleImg0.visible=t,this.doubleImg.visible=this.doubleImg1.visible,this.onLimitAct()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.eff),this.eff=null,this.arrowEff&&(this.arrowEff.hide(),this.arrowEff=null),TimerMgr.ins().remove(this.onActTime,this)},e.prototype.onLimitAct=function(){var t=this;copyControl.checkExpLuckyAct()?(this.luckyActivity.visible=!0,this.actExp.text=copyControl.expFbLuckyDt.exp+"",this.actRedPoint.visible=ActorControl.yb>=DataCenter.ins().CopyExpBaseConfig.luckyPrice,this.actGold.setPrice(DataCenter.ins().CopyExpBaseConfig.luckyPrice),this.actEffMC=this.actEffMC||ObjectPool.pop("GameMovieClip"),this.actEffMC.playFile(PATH_EFF+"yanhuaeff",1),this.fireworkEff.addChild(this.actEffMC),this.luckyActGroup.scaleX=0,this.luckyActGroup.scaleY=0,egret.Tween.get(this.luckyActGroup).to({scaleX:1,scaleY:1},200,egret.Ease.backInOut).call(function(){t.actBtnEffMC=t.actBtnEffMC||ObjectPool.pop("GameMovieClip"),t.actBtnEffMC.playFile(PATH_EFF+"chargeff1",-1),t.actBtnEff.addChild(t.actBtnEffMC)}),TimerMgr.ins().isExists(this.onActTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onActTime,this),this.onActTime()):(this.luckyActivity.visible=!1,this.actEffMC&&this.actEffMC.destroy(),this.actBtnEffMC&&this.actBtnEffMC.destroy(),TimerMgr.ins().remove(this.onActTime,this))},e.prototype.onActTime=function(){if(copyControl.expFbLuckyDt){var t=(DateUtils.formatMiniDateTime(copyControl.expFbLuckyDt.endTime)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0;0>t&&(this.onLimitAct(),TimerMgr.ins().remove(this.onActTime,this)),this.actTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3)}},e.prototype.onUpdate=function(){var t=copyControl.fbExp;if(t){var e=0,i=["challenge","free","sdfb","sdget"];e=t.cid||t.sid?t.cid?1:3:t.useTime<=this.getChangeNum()?0:2,this.currentState=i[e],this.validateNow(),this.onInitIndex(e)}},e.prototype.getChangeNum=function(t){void 0==t&&(t=vipControl.lv);var e=DataCenter.ins().CopyExpBaseConfig.freeCount;return(DataCenter.ins().CopyExpBaseConfig.vipCount[t]||0)+e},e.prototype.getSdNum=function(t){return DataCenter.ins().CopyExpBaseConfig.buyCount+DataCenter.ins().CopyExpBaseConfig.vipBuyCount[t]},e.prototype.checkCanSD=function(){var t=DataCenter.ins().CopyExpBaseConfig.burden;return t.day<=GameServer.serverOpenDay+1&&t.zslv<=reincarnateControl.lv},e.prototype.onInitIndex=function(t){var e=copyControl.fbExp,i=copyControl.getExpFbId(),n=DataCenter.ins().MonthCardConfig.expFubenPrecent/100,o=payControl.getIsForeve()?1+n:1,s=Math.floor(DataCenter.ins().CopyExpConfig[i].exp*o);if(0==t){var r="";if(this.checkCanSD()?(r=LangMgr.getValueByKey("personSweap1"),this.btnChallenge.label=LangMgr.getValueByKey("personSweap")):(r=LangMgr.getValueByKey("personFight"),this.btnChallenge.label=LangMgr.getValueByKey("personFight1")),this.lbExp.text=""+s,this.lbTime.text=LangMgr.getValueByKey("everydaycancs",r)+(this.getChangeNum()-e.useTime),this.getChangeNum()>e.useTime)this.btnChallenge.enabled=!0;else{this.btnChallenge.enabled=!1;for(var a=vipControl.lv+1,l=this.getChangeNum(a);void 0!=l&&l<=e.useTime&&(a+=1,l=this.getChangeNum(a),void 0!=DataCenter.ins().CopyExpBaseConfig.vipCount[a]););l-e.useTime>0&&(this.lbTime.text=vipControl.getVipStr(a)+LangMgr.getValueByKey("cantimeadd",r)+(l-e.useTime))}}else if(2==t){this.barGroup.visible=!1,this.btnSD.visible=!0,this.bar.value=0,this.lbExp.text=""+s;var h=this.getSdNum(vipControl.lv);if(e.sdTime>=(h||0)){for(var a=vipControl.lv+1,l=this.getSdNum(a);void 0!=l&&h>=l;)a+=1,l=this.getSdNum(a);this.lbVip0.visible=!1,l&&l>h?(this.lbVip.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("babelSaod",vipControl.getVipStr(a),l-h)),this.lbVip.visible=!0,this.btnSD.enabled=!1):void 0==l?(this.lbVip.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("babelSaodEnd")),this.lbVip.visible=!0,this.btnSD.enabled=!1):(this.lbVip.visible=!1,this.btnSD.enabled=!0)}else this.lbVip.visible=!1,this.lbVip0.visible=!0,this.lbVip0.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("babelSaodTimes",h-e.sdTime)),this.btnSD.enabled=!0}else if(1==t||3==t){for(var u=DataCenter.ins().CopyExpConfig[e.cid||e.sid].exp*o,p=0;3>p;p++){this["lbExp"+p].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("bookExp1",u*(p+1)));var c=0;c=1==t?DataCenter.ins().CopyExpBaseConfig.recPrice[p]:DataCenter.ins().CopyExpBaseConfig.buyPrice[p],this["gold"+p].setPrice(c)}this.g1.visible=this.g2.visible=!0,this.g0.horizontalCenter=-182,0==e.isFirst?(this.firstfree.visible=!0,this.redPoint.visible=!0,null==this.arrowEff&&(this.arrowEff=new ArrowEffect),this.arrowEff.show(LangMgr.getValueByKey("firstFeelGet"),this.btnGet2)):(this.gold2.visible=!0,this.firstfree.visible=!1,this.redPoint.visible=!1,this.arrowEff&&(this.arrowEff.hide(),this.arrowEff=null));var d=this.checkCanSD()?LangMgr.getValueByKey("babelSaodTimes",this.getChangeNum()-e.useTime+1):"";this.lbTime.text=d}},e.prototype.getCost=function(t){return 2==t&&0==copyControl.fbExp.isFirst?0:DataCenter.ins().CopyExpBaseConfig.recPrice[t]},e.prototype.onTap=function(t){var e=t.target;if(this.checkBtnGet(e));else if(e==this.btnChallenge){if(LangMgr.getValueByKey("personSweap")!=this.btnChallenge.label&&!crossArenaControl.checkIsMatching())return;if(copyControl.checkInFB())return;copyControl.upChallengeExpFb()}else e==this.btnSD?0==this.barGroup.visible&&(this.barGroup.visible=!0,this.btnSD.visible=!1,this.lbVip.visible=!1,this.lbVip0.visible=!1,this.bar.maximum=100,this.bar.value=0,egret.Tween.get(this.bar).to({value:100},1500).call(function(){copyControl.upSaodang()})):e==this.actBtnGet&&CommonFun.checkCurrency(DataCenter.ins().CopyExpBaseConfig.luckyPrice)&&(TimerMgr.ins().doTimer(15,40,function(){copyControl.dispatchExpFly(e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2)),copyControl.dispatchExpFly(e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2),2),copyControl.dispatchExpFly(e.parent.localToGlobal(e.x+e.width/2,e.y+e.height/2))},this),copyControl.upBuyExpLuckyAct())},e.prototype.checkBtnGet=function(t){var e=this,i=copyControl.fbExp;if(i){var n=0;if(t==this.btnGet0?n=1:t==this.btnGet1?n=2:t==this.btnGet2&&(n=3),n>0){var o=i.cid?0:1,s=this.getCost(n-1);if(ActorControl.yb<s)return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));if(3!=n&&0==i.isFirst){var r=LangMgr.getValueByKey("firstFreeOneGet"),a=warnControl.show(r,function(){e.arrowEff&&e.arrowEff.showTapOutEff()},this,null,null,"sure");return void a.setBtnLabel(LangMgr.getValueByKey("get3oddsAw"))}this.sendGetAward(o,n,t)}return n>0}},e.prototype.sendGetAward=function(t,e,i){var n=copyControl.fbExp;if(n){var o=DataCenter.ins().CopyExpConfig[n.cid||n.sid];if(o){var s=o.exp,r=this.getFlyTime(s*e),a=Math.floor(r/15);TimerMgr.ins().doTimer(15,a,function(){copyControl.dispatchExpFly(i.parent.localToGlobal(i.x+i.width/2,i.y+i.height/2)),e>1&&copyControl.dispatchExpFly(i.parent.localToGlobal(i.x+i.width/2,i.y+i.height/2)),e>2&&copyControl.dispatchExpFly(i.parent.localToGlobal(i.x+i.width/2,i.y+i.height/2))},this),egret.Tween.get(i).wait(1100).call(function(){copyControl.upGetAwardMul(t,e)})}}},e.prototype.getFlyTime=function(t){for(var e=0,i=ActorControl.level,n=ActorControl.exp,o=DataCenter.ins().RoleExpConfig[i].exp,s=CommonUtils.getObjectLength(DataCenter.ins().RoleExpConfig);s>i&&t>0&&t>o-n;)e+=1,i+=1,t-=o-n,o=DataCenter.ins().RoleExpConfig[i].exp,n=0;return 0==e?400:400*(e+1)-200},e}(BasePanel);__reflect(CopyExpPanel.prototype,"CopyExpPanel");var CopyGoldPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this,this.onTap),this.addCustomEvent(389,this.onUpdate),this.onUpdate()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents()},e.prototype.onUpdate=function(){this.validateNow(),this.onInitIndex()},e.prototype.getChangeNum=function(t){void 0==t&&(t=vipControl.lv);var e=DataCenter.ins().CopyGoldBaseConfig.freeCount;return(DataCenter.ins().CopyGoldBaseConfig.vipCount[t]||0)+e},e.prototype.onInitIndex=function(){var t=copyControl.fbGold,e=copyControl.getGoldFbId(),i=DataCenter.ins().CopyGoldConfig[e].yuanbao;if(this.lbTime.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("babelTodayTimes",this.getChangeNum()-t.useTime)),this.lbExp.text=""+i,this.getChangeNum()>t.useTime)this.btnChallenge.enabled=!0;else{this.btnChallenge.enabled=!1;for(var n=vipControl.lv+1,o=this.getChangeNum(n);void 0!=o&&o<=t.useTime&&(n+=1,o=this.getChangeNum(n),void 0!=DataCenter.ins().CopyGoldBaseConfig.vipCount[n]););o-t.useTime>0&&(this.lbTime.text=LangMgr.getValueByKey("babelVipGet",vipControl.getVipStr(n),o-t.useTime))}},e.prototype.onTap=function(t){var e=t.target;if(e==this.btnChallenge){if(copyControl.checkInFB())return;copyControl.upChallengeGoldFb()}},e}(BasePanel);__reflect(CopyGoldPanel.prototype,"CopyGoldPanel");var CopyView=function(t){function e(){var e=t.call(this)||this;return e.fbDataList=[],e.lastSelectIndex=-1,e.skinName="CopyViewSkin",e.isTopLevel=!0,e.canVis=!0,e.fbList.itemRenderer=CopyItemRender,e.fbDataList=copyControl.fbDataList.slice(),e.fbList.dataProvider=new eui.ArrayCollection(e.fbDataList),e}return __extends(e,t),e.openCheck=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(!crossArenaControl.checkIsMatching())return!1;var n=void 0==t[0]?0:t[0],o=void 0==t[1]?0:t[1];switch(copyControl.LegendTempleReplaceHunShow()?(e.FB_HUNSHOU=-1,e.FB_LEGENDTEMPLE=4):(e.FB_HUNSHOU=4,e.FB_LEGENDTEMPLE=-1),n){case e.FB_HUNSHOU:if(!soulBoneControl.isHunShouDunOpen())return tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().SoulBoneConfig.fbOpenDay,DataCenter.ins().SoulBoneConfig.needZsLv)),!1;break;case e.FB_LEGENDTEMPLE:break;case e.FB_TEAM:if(!copyControl.isTeamFBOpen())return tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().AsTeamCopyBaseConfig.openDay,DataCenter.ins().AsTeamCopyBaseConfig.needZsLv)),!1;break;case e.FB_CHALLENGE:var s=DataCenter.ins().BabelLotteryConfig[1];if(ActorControl.level<s.levelLimit)return tipsControl.showTips(LangMgr.getValueByKey("personLevelFight",s.levelLimit)),!1;break;case e.FB_DAILY:var r=EveryDayCopyView.checkIndexOpen(o);if(!r)return r;break;case e.FB_MATERIAL:if(ActorControl.level<10)return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel","10")),!1;if(0==Object.keys(copyControl.fbModel).length)return tipsControl.showTips(LangMgr.getValueByKey("getServerData")),!1}return e.isClose||UIMgr.ins().close(ExperienceView),e.isClose=!1,!0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.viewStack.numChildren;i++){var n=this.viewStack.getChildAt(i);n.close&&n.close()}this._openedIndex&&(this._openedIndex.length=0,this._openedIndex=null)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.fbList,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addCustomEvent(368,this.updateFbList),this.addCustomEvent(369,this.updateFbList),this.addCustomEvent(521,this.updateRedPoint),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.checkIsOpen),this.updateTabs(),this.resetTabs(),this.updateFbList();var i=void 0==t[0]?0:t[0],n=t[1];i=this._openedIndex.indexOf(i),-1==i&&(i=0),this.viewStack.selectedIndex=i,this.tab.selectedIndex=i,this.setOpenIndex(i,n),this.updateRedPoint()},e.prototype.updateTabs=function(){-1==e.FB_HUNSHOU&&this.viewStack.removeChild(this.soulBoneDunPanel)},e.prototype.resetTabs=function(){this._openedIndex=[];for(var t=0;5>t;t++){var e=this.hidePage(t);e?(this.viewStack.removeChild(e),DisplayUtils.removeFromParent(this["redPoint"+t])):this._openedIndex.push(t)}},e.prototype.hidePage=function(t){switch(t){case e.FB_HUNSHOU:return!soulBoneControl.showHunShouDun()||soulBoneControl.showHunShouDunInDaily()?this.soulBoneDunPanel:null}return null},e.prototype.updateRedPoint=function(){this.redPoint0.visible=CopyRedPoint.ins().redPoint0,this.redPoint1.visible=CopyRedPoint.ins().redPoint1,this.redPoint2.visible=CopyRedPoint.ins().redPoint2,this.redPoint3.visible=CopyRedPoint.ins().redPoint3,this.redPoint4.visible=CopyRedPoint.ins().redPoint4},e.prototype.updateFbList=function(){var t=this.fbDataList.indexOf(DataCenter.ins().AshtarteConfig.fbIndex);t>=0&&DataCenter.ins().AshtarteConfig.openserverday>GameServer.serverOpenDay+1&&this.fbDataList.splice(t,1),this.fbList.dataProvider.replaceAll(this.fbDataList)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.help:4==this.tab.selectedIndex?HelpControl.openHelpWin(37):3==this.tab.selectedIndex&&HelpControl.openHelpWin(44);
break;case this.closeBtn:UIMgr.ins().close(this);break;default:if(t.target instanceof eui.Button&&t.target.parent){WarriorModel.ins().flagFromTaskWinBattle=!1;var e=t.target.parent.data,i=DataCenter.ins().DailyCopyConfig[e];if("add"==t.target.name)this.Sweep(e);else if("double"==t.target.name)this.DoubleSweep(e);else{if(!crossArenaControl.checkIsMatching())return;var n=copyControl.getFbDataById(e);if(n.getCount()<=0)tipsControl.showTips(LangMgr.getValueByKey("babelTips5"));else if(i.levelLimit>ActorControl.level)tipsControl.showTips(LangMgr.getValueByKey("babelTips6"));else{var o=copyControl.fbModel[e].isPass;if(payControl.franchise&&o)copyControl.upChallenge(e);else{if(copyControl.checkInFB())return;copyControl.upChallenge(i.id),reincarnateControl.lv>=i.sweepLevel&&n.isPass||UIMgr.ins().closeTopLevel()}}}UIMgr.ins().close(LimitTaskView)}}},e.prototype.Sweep=function(t){var e=DataCenter.ins().DailyCopyConfig[t],i=DataCenter.ins().MonthCardConfig.sweepPrecent/100,n=payControl.monthDay>0?1-i:1,o=e.buyPrice[copyControl.getFbDataById(t).vipBuyCount]*n;if(!(ActorControl.yb>=o))return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"));DieGuide.ins().setClick(t);var s=this.fbDataList.lastIndexOf(t),r=this.fbList.getChildAt(s);r&&r.starSaoDang(0)},e.prototype.DoubleSweep=function(t){var e=DataCenter.ins().DailyCopyConfig[t],i=DataCenter.ins().MonthCardConfig.sweepPrecent/100,n=payControl.monthDay>0?1-i:1,o=e.buyDoublePrice[copyControl.getFbDataById(t).vipBuyCount]*n;if(!(ActorControl.yb>=o))return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"));DieGuide.ins().setClick(t);var s=this.fbDataList.lastIndexOf(t),r=this.fbList.getChildAt(s);r&&r.starSaoDang(1)},e.prototype.setOpenIndex=function(t,i){if(this._openedIndex){var n=this._openedIndex[t];if(!e.openCheck(n))return this.setOpenIndex(this.lastSelectIndex),void(this.tab.selectedIndex=this.lastSelectIndex);if(this.lastSelectIndex>-1){var o=this._openedIndex[this.lastSelectIndex];switch(o){case 0:break;default:this.viewStack.getChildAt(this.lastSelectIndex).close&&this.viewStack.getChildAt(this.lastSelectIndex).close()}}switch(this.lastSelectIndex=t,this.help.visible=!1,n){case 0:this.updateFbList();break;default:this.viewStack.getChildAt(t).open(i),this.help.visible=4==n||3==n,4==e.FB_LEGENDTEMPLE&&n==e.FB_LEGENDTEMPLE&&(this.help.visible=!1)}}},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.checkIsOpen=function(t){var i=t.target,n=this._openedIndex[i.selectedIndex];return e.openCheck(n)?(UIMgr.ins().close(ExperienceView),void UIMgr.ins().close(LimitTaskView)):void t.preventDefault()},e.FB_MATERIAL=0,e.FB_DAILY=1,e.FB_CHALLENGE=2,e.FB_TEAM=3,e.FB_LEGENDTEMPLE=-1,e.FB_HUNSHOU=4,__decorate([callLater],e.prototype,"setOpenIndex",null),e}(BaseEuiView);__reflect(CopyView.prototype,"CopyView");var DemonCircleCopyPanel=function(t){function e(){var e=t.call(this)||this;return e.selLayer=1,e.name=LangMgr.getValueByKey("demonCopy"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.rewardList.itemRenderer=ItemBaseTimes,this.dataArr||(this.dataArr=new eui.ArrayCollection,this.rewardList.dataProvider=this.dataArr),this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.getItemTxt.text+"</u>"),this.monArr=[this.monCom0,this.monCom1,this.monCom2]},e.prototype.open=function(){this.addEventTouchTap(this.challengeBtn,this.onTap),this.addEventTouchTap(this.getItemTxt,this.onTap),this.addEventTouchTap(this.monCom0,this.onMonster),this.addEventTouchTap(this.monCom1,this.onMonster),this.addEventTouchTap(this.monCom2,this.onMonster),this.addEventTouchTap(this.seeRule,this.onTap),this.addCustomEvent(59,this.onUpdate),this.onUpdate(),magicCircleControl.isFrist&&(magicCircleControl.isFrist=!1,DailyCopyRedPoint.ins().dispatchMagicCircle())},e.prototype.onTap=function(t){switch(t.currentTarget){case this.challengeBtn:var e=DataCenter.ins().MagicCirFbConfig,i=magicCircleControl.layerData[this.selLayer-1];if(0==i)return void tipsControl.showCenterTips("|C:"+LangMgr.getColor("color22")+"&T:"+LangMgr.getValueByKey("pleaseKill")+e[this.selLayer-1].bossName+"|");var n=e[this.selLayer],o=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId);if(o<n.itemCount)return void TreasureHuntWarnBuyView.showBuyWarn("DemonCircleCopyPanel",this.huntWarnFun.bind(this),LangMgr.getValueByKey("demonScrollNoMeet",DataCenter.ins().MagicCirConfig.enterMoney*(n.itemCount-o)));magicCircleControl.upEnterFb(),UIMgr.ins().close(CopyView);break;case this.getItemTxt:UIMgr.ins().open(ShopWarnView).setData(DataCenter.ins().MagicCirConfig.enterItemId);break;case this.seeRule:HelpControl.openHelpWin(45)}},e.prototype.huntWarnFun=function(){var t=DataCenter.ins().MagicCirFbConfig[this.selLayer],e=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId),i=DataCenter.ins().MagicCirConfig.enterMoney*(t.itemCount-e);return ActorControl.yb<i?void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):(magicCircleControl.upEnterFb(),void UIMgr.ins().close(CopyView))},e.prototype.onMonster=function(t){switch(t.currentTarget){case this.monCom0:this.selLayer=1;break;case this.monCom1:this.selLayer=2;break;case this.monCom2:this.selLayer=3}this.selectLayer()},e.prototype.close=function(){},e.prototype.onUpdate=function(){this.updateBossInfo(),this.selectLayer()},e.prototype.updateBossInfo=function(){for(var t=CommonUtils.arraySort(CommonUtils.objectToArrayShallow(DataCenter.ins().MagicCirFbConfig),"id"),e=0;e<this.monArr.length;e++)this.monArr[e].data=t[e];this.selLayer=magicCircleControl.curLayerId},e.prototype.selectLayer=function(){for(var t=0;t<this.monArr.length;t++)this.monArr[t].setSelected(!1);this.monArr[this.selLayer-1].setSelected(!0);var e=DataCenter.ins().MagicCirFbConfig[this.selLayer];this.nameLabel.text=LangMgr.getValueByKey("whatlevel",e.id)+"  "+e.fbName,this.dataArr.source=e.showAward;var i=magicCircleControl.layerData[this.selLayer-1];this.challengeBtn.visible=!0,this.alreadyTxt.visible=!1,2==i&&(this.alreadyTxt.visible=!0,this.challengeBtn.visible=!1);var n=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId);this.num.text=""+n,this.needNum.text="/"+e.itemCount},e}(BasePanel);__reflect(DemonCircleCopyPanel.prototype,"DemonCircleCopyPanel");var DemonCircleResultView=function(t){function e(){var e=t.call(this)||this;return e.winResult=0,e.repeatTimes=20,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="DemonCircleResultViewSkin",this.rewardList.itemRenderer=ItemBase},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this._fbType=MapControl.copyType;var n=e[0];this.winResult=n,this.bg.source=n?"resultWin_png":"resultLost_png",this.title.source=n?"win_02":"lost_02",this.cdTime=this.repeatTimes,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this);var o=e[1];this.addEventTouchTap(this.quitBtn,this.onTap),this.addEventTouchTap(this.endBtn,this.onTap),this.addEventTouchTap(this.carryOnBtn,this.onTap),o&&this.setRewardList(o);var s=DataCenter.ins().MagicCirFbConfig[magicCircleControl.curLayerId],r=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId);this.costTxt.text=r+"/"+s.itemCount,this.quitBtn.visible=!0,this.carryOnBtn.visible=!0,this.endBtn.visible=!1,this.costGroup.visible=!0,magicCircleControl.isLastLayer()&&(this.quitBtn.visible=!1,this.carryOnBtn.visible=!1,this.endBtn.visible=!0,this.costGroup.visible=!1)},e.prototype.setRewardList=function(t){this.rewardList.dataProvider=new eui.ArrayCollection(t||[])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateCloseBtnLabel,this),UIMgr.ins().isShow(TreasureHuntWarnBuyView)&&UIMgr.ins().close(TreasureHuntWarnBuyView)},e.prototype.updateCloseBtnLabel=function(){this.cdTime--,this.cdTime<=0&&(UIMgr.ins().close(this),copyControl.upExitFb()),this.quitBtn.visible&&(this.quitBtn.label=LangMgr.getValueByKey("babelExit",this.cdTime)),this.endBtn.visible&&(this.endBtn.label=LangMgr.getValueByKey("tongGetGift")+"("+this.cdTime+"s)")},e.prototype.onTap=function(t){switch(t.currentTarget){case this.quitBtn:var i=DataCenter.ins().MagicCirFbConfig[magicCircleControl.curLayerId];warnControl.show(i.quitHint,function(){UIMgr.ins().close(e),copyControl.upExitFb()},this);break;case this.endBtn:UIMgr.ins().close(e),copyControl.upExitFb();break;case this.carryOnBtn:var i=DataCenter.ins().MagicCirFbConfig[magicCircleControl.curLayerId],n=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId);if(n<i.itemCount)return void TreasureHuntWarnBuyView.showBuyWarn("DemonCircleCopyPanel",this.huntWarnFun.bind(this),LangMgr.getValueByKey("demonScrollNoMeet",DataCenter.ins().MagicCirConfig.enterMoney*(i.itemCount-n)));magicCircleControl.upEnterFb(),UIMgr.ins().close(e)}},e.prototype.huntWarnFun=function(){var t=DataCenter.ins().MagicCirFbConfig[magicCircleControl.curLayerId],i=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId),n=DataCenter.ins().MagicCirConfig.enterMoney*(t.itemCount-i);return ActorControl.yb<n?void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):(magicCircleControl.upEnterFb(),void UIMgr.ins().close(e))},e}(BaseEuiView);__reflect(DemonCircleResultView.prototype,"DemonCircleResultView");var DemonSceneView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DemonSceneViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().MagicCirFbConfig[magicCircleControl.curLayerId];this.nameTxt.text=""+i.fbName},e}(BaseEuiView);__reflect(DemonSceneView.prototype,"DemonSceneView");var EveryDayCopyView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastSelect=-1,e.tabConstArr=[{index:0,bg:"tab_dailyfb_0_png"},{index:1,bg:"tab_dailyfb_1_png"},{index:2,bg:"tab_dailyfb_2_png"},{index:3,bg:"tab_dailyfb_3_png"}],e}return __extends(e,t),e.prototype.childrenCreated=function(){this.tabData=new eui.ArrayCollection,this.tab.itemRenderer=DailyCopyTabBtnItemRender,this.tab.dataProvider=this.tabData},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.checkIsOpen),this.addCustomEvent(528,this.updateRedPoint),this.addCustomEvent(539,this.updateRedPoint),this.addCustomEvent(540,this.updateRedPoint),this.addCustomEvent(541,this.updateRedPoint);var i=[this.tabConstArr[1]];this.redPoints=[DailyCopyRedPoint.ins().expRed],SwitchMgr.ins().checkOpen(1013)?(this.copyGoldPanel.parent||(this.viewStack.addChildAt(this.copyGoldPanel,0),this.redPointGroup.addChildAt(this.redPoint0,0)),i.unshift(this.tabConstArr[0]),this.redPoints.unshift(DailyCopyRedPoint.ins().goldRed)):this.copyGoldPanel.parent&&(this.viewStack.removeChild(this.copyGoldPanel),this.redPointGroup.removeChild(this.redPoint0)),guardControl.getCanSee()?(this.guardWeaponPanel.parent||(this.viewStack.addChildAt(this.guardWeaponPanel,2),this.redPointGroup.addChildAt(this.redPoint2,2)),i.push(this.tabConstArr[2]),this.redPoints.push(DailyCopyRedPoint.ins().guardRed)):this.guardWeaponPanel.parent&&(this.viewStack.removeChild(this.guardWeaponPanel),this.redPointGroup.removeChild(this.redPoint2)),magicCircleControl.getCanSee()?(this.demonCircleCopyPanel.parent||(this.viewStack.addChildAt(this.demonCircleCopyPanel,3),this.redPointGroup.addChildAt(this.redPoint3,3)),i.push(this.tabConstArr[3]),this.redPoints.push(DailyCopyRedPoint.ins().magicCircleRed)):this.demonCircleCopyPanel.parent&&(this.viewStack.removeChild(this.demonCircleCopyPanel),this.redPointGroup.removeChild(this.redPoint3)),this.tabData.replaceAll(i),this.tab.validateNow(),this.setDefaultIndex(t[0]),this.updateRedPoint()},e.prototype.setDefaultIndex=function(t){for(var e=0,i=0;i<this.tabData.source.length;i++){var n=this.tabData.source[i];if(n.index==t){e=i;break}if(null==t&&this.hasRed(n.index)){e=i;break}}this.setOpenIndex(e)},e.prototype.hasRed=function(t){return this.redPoints[t]},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.setOpenIndex=function(t){if(this.lastSelect>-1){var e=this.viewStack.getChildAt(this.lastSelect);e.close&&e.close()}this.lastSelect=t,this.tab.selectedIndex=this.lastSelect,this.viewStack.selectedIndex=this.lastSelect,this.viewStack.getChildAt(this.lastSelect).open()},e.prototype.checkIsOpen=function(t){var i=this.tabData.getItemAt(this.tab.selectedIndex).index;return e.checkIndexOpen(i)?void 0:void t.preventDefault()},e.checkIndexOpen=function(t){if(0==t){if(ActorControl.level<DataCenter.ins().CopyGoldBaseConfig.openLv)return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().CopyGoldBaseConfig.openLv)),!1}else if(1==t){if(ActorControl.level<DataCenter.ins().CopyExpBaseConfig.openLv)return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().CopyExpBaseConfig.openLv)),!1}else if(2==t){if(!guardControl.isOpen())return tipsControl.showTips(guardControl.getDesc()),!1}else if(3==t){var e=DataCenter.ins().MagicCirConfig.openzhuanshenglv;if(reincarnateControl.lv<e)return tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().MagicCirConfig.fbopenserverday,e)),!1}return!0},e.prototype.updateRedPoint=function(){this.redPoint0.visible=DailyCopyRedPoint.ins().goldRed,this.redPoint1.visible=DailyCopyRedPoint.ins().expRed,this.redPoint2.visible=DailyCopyRedPoint.ins().guardRed,this.redPoint3.visible=DailyCopyRedPoint.ins().magicCircleRed},e.prototype.close=function(){var t=this.viewStack.getChildAt(this.lastSelect);t.close&&t.close()},e}(BasePanel);__reflect(EveryDayCopyView.prototype,"EveryDayCopyView");var PlayWayPanel=function(t){function e(){var e=t.call(this)||this;return e.isFirst=!0,e.name=LangMgr.getValueByKey("babelPlayWay"),e}return __extends(e,t),e.prototype.updateView=function(){var t=this.time1.text;if(GameServer.serverOpenDay){var e=t.split(LangMgr.getValueByKey("babelPlayEveryDay"));this.time1.textFlow=TextUtils.generateTextFlow1(""+LangMgr.getValueByKey("babelPlayEveryDay")+e[1])}else;if(this.isFirst){this.isFirst=!1,this.time4.text=DataCenter.ins().BlisterConfig.openTips;for(var i=1;4>=i;i++)this["info"+i].textFlow=TextUtils.generateTextFlow1("|U:&T:"+this["info"+i].text)}},e.prototype.open=function(){this.addEventTouchTap(this,this.onTap),this.addCustomEvent(134,this.callbackMillionaireInfo),this.addCustomEvent(135,this.callbackRedPoint),this.addCustomEvent(136,this.callbackRedPoint),this.addCustomEvent(138,this.callbackRedPoint),this.addCustomEvent(277,this.updateBattleRed),this.addCustomEvent(461,this.updateBattleRed),this.addCustomEvent(461,this.updatePaoDianRed),this.addCustomEvent(240,this.updatePaoDianRed),this.redPoint2.visible=daifugControl.getRedPoint(),this.updateView(),this.updateBattleRed(),this.updatePaoDianRed()},e.prototype.updateBattleRed=function(){this.redPoint3.visible=campWarControl.checkRedPoint()},e.prototype.updatePaoDianRed=function(){this.redPoint0.visible=blisterControl.checkRedPoint()},e.prototype.onTap=function(t){switch(t.target){case this.btn1:if(!bossControl.newWorldBossData.isOpen)return void tipsControl.showTips(LangMgr.getValueByKey("babelBossNoOpen"));if(bossControl.newWorldBossData.startTime>GameServer.serverTime){var e=new Date(bossControl.newWorldBossData.startTime),i=""+e.getHours()+LangMgr.getValueByKey("bossPoint")+(e.getMinutes()?e.getMinutes()+LangMgr.getValueByKey("activitMine",""):"");return void tipsControl.showTips(LangMgr.getValueByKey("bossOpenEveryDay",i))}if(!bossControl.checkNewWorldBossOpen())return void tipsControl.showTips(LangMgr.getValueByKey("bossJoinLimit",DataCenter.ins().NewWorldBossBaseConfig.openLv));bossControl.upIntoNewBoss();break;case this.btn2:daifugControl.upMillionaireInfo();break;case this.btn3:if(ActorControl.level<=DataCenter.ins().CampWarConfig.openLevel)return void tipsControl.showTips(LangMgr.getValueByKey("battleJoinCity",DataCenter.ins().CampWarConfig.openLevel));if(!crossArenaControl.checkIsMatching())return;if(!campWarControl.isOpen)return void tipsControl.showTips(DataCenter.ins().CampWarConfig.openTips);toseongControl.enterCD<1?toseongControl.isToseong?(MapControl.myMoveTo(DataCenter.ins().CampWarConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().CampWarConfig.npcPos[1]*MapControl.CELL_SIZE,campWarControl.findComplete),MapControl.moveTo(DataCenter.ins().CampWarConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().CampWarConfig.npcPos[1]*MapControl.CELL_SIZE)):(campWarControl.gotoNpc=!0,toseongControl.upEnter()):tipsControl.showTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD));break;case this.btn4:if(!blisterControl.isOpen)return void tipsControl.showTips(DataCenter.ins().BlisterConfig.openTips);if(!crossArenaControl.checkIsMatching())return;var n=DataCenter.ins().BlisterConfig.openLv;if(ActorControl.level+1e3*reincarnateControl.lv<n)return void tipsControl.showTips((1e3>n?n+LangMgr.getValueByKey("numberLevel",""):n%1e3==0?n/1e3+LangMgr.getValueByKey("numberRotation",""):n/1e3+LangMgr.getValueByKey("numberRotation","")+n%1e3+LangMgr.getValueByKey("numberLevel",""))+LangMgr.getValueByKey("babelCanJoin"));toseongControl.enterCD<1?toseongControl.isToseong?(MapControl.myMoveTo(DataCenter.ins().BlisterConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().BlisterConfig.npcPos[1]*MapControl.CELL_SIZE,blisterControl.findComplete),MapControl.moveTo(DataCenter.ins().BlisterConfig.npcPos[0]*MapControl.CELL_SIZE,DataCenter.ins().BlisterConfig.npcPos[1]*MapControl.CELL_SIZE)):(blisterControl.gotoNpc=!0,toseongControl.upEnter()):tipsControl.showTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD));break;case this.info1:HelpControl.openHelpWin(18);break;case this.info2:HelpControl.openHelpWin(19);break;case this.info3:HelpControl.openHelpWin(17);break;case this.info4:HelpControl.openHelpWin(20)}},e.prototype.callbackMillionaireInfo=function(){var t=UIMgr.ins().getView(DaifugEnterView);t||UIMgr.ins().open(DaifugEnterView),this.redPoint2.visible=daifugControl.getRedPoint()},e.prototype.callbackRedPoint=function(){this.redPoint2.visible=daifugControl.getRedPoint()},e}(BasePanel);__reflect(PlayWayPanel.prototype,"PlayWayPanel");var CopyChallengeRankItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="CopyChallengeRankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&(this.data.pos>3?(this.rankImg.visible=!1,this.rank.visible=!this.rankImg.visible,this.rank.text=this.data.pos+""):(this.rankImg.visible=!0,this.rank.visible=!this.rankImg.visible,this.rankImg.source="paihang"+this.data.pos),this.vip.visible=this.data.vip,this.nameLabel.text=this.data.player,this.data.count)){var t=DataCenter.ins().BabelLotteryConfig[this.data.count],e=DataCenter.ins().BabelLotteryNameConfig[t.group];this.cengNum.text=LangMgr.getValueByKey("babelLayer1",e.name,t.layer)}},e.prototype.destruct=function(){},e}(BaseItemRender);__reflect(CopyChallengeRankItemRender.prototype,"CopyChallengeRankItemRender");var CopyDialPropItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.rewardState=function(t){t?this.currentState="yilingqu":this.currentState="weilingqu"},e}(BaseItemRender);__reflect(CopyDialPropItemRender.prototype,"CopyDialPropItemRender");var CopyItemRender=function(t){function e(){var e=t.call(this)||this;return e.isDouble=0,e.skinName="CopyItemSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.item.isShowName(!1),this.starValue=0},e.prototype.starSaoDang=function(t){void 0===t&&(t=0),this.isDouble=t,TimerMgr.ins().doTimer(50,20,this.refushBar,this,this.overPlay,this),this.barGaroup.visible=!0,this.isDouble?(this.doublePrice.visible=!1,this.barGaroup.x=this.doublePrice.x):(this.price.visible=!1,this.barGaroup.x=this.price.x),this.bar.labelFunction=function(){return LangMgr.getValueByKey("fbSweep")}},e.prototype.refushBar=function(){this.isDouble?this.doubleChallengeBtn.enabled=!1:this.challengeBtn.enabled=!1,this.starValue+=7,this.bar.value=this.starValue},e.prototype.overPlay=function(){0!=this.starValue&&(this.barGaroup.visible=!1,this.isDouble?(this.doublePrice.visible=!0,this.doubleChallengeBtn.enabled=!0):(this.price.visible=!0,this.challengeBtn.enabled=!0),this.starValue=0,copyControl.upAddCount(this.data,this.isDouble))},e.prototype.dataChanged=function(){this.bg.source=this.data+"bg";var t=DataCenter.ins().DailyCopyConfig[this.data];if(this.item.data=t.showItem,t.zsLevel>0){var e=LangMgr.getValueByKey("fbRotationOpen",t.zsLevel),i=reincarnateControl.lv>=t.zsLevel;t.id==DataCenter.ins().AshtarteConfig.fbIndex&&(e=LangMgr.getValueByKey("fbShow1",DataCenter.ins().AshtarteConfig.openserverday,t.zsLevel),i=reincarnateControl.lv>=t.zsLevel&&GameServer.serverOpenDay+1>=DataCenter.ins().AshtarteConfig.openserverday),this.currentState=i?"canChallenge":"noChallenge",this.levelRequire.text=i?"":e}else this.currentState=ActorControl.level>=t.levelLimit?"canChallenge":"noChallenge",this.levelRequire.text=ActorControl.level>=t.levelLimit?"":LangMgr.getValueByKey("tipsOpenLevel",t.levelLimit);this.levelRequire.visible=!0;var n=copyControl.getFbDataById(this.data),o=n.getCount(),s=o>0?"#40D016":"#DFD1B5";this.redPoint.visible=o>0;var r=n.getResetCount();o>0?this.count.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("fbTodayFight",s,1)):(this.count.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("fbTodayFight",s,r)),this.redPoint.visible=DieGuide.ins().dieFbRedPoint(r,this.data)),this.price.visible=0==o&&"canChallenge"==this.currentState,payControl.franchise&&n.isPass?this.challengeBtn.label=o?LangMgr.getValueByKey("personFastFight"):LangMgr.getValueByKey("personSweap"):reincarnateControl.lv>=t.sweepLevel&&n.isPass?this.challengeBtn.label=o?LangMgr.getValueByKey("personFastFight"):LangMgr.getValueByKey("personSweap"):this.challengeBtn.label=o?LangMgr.getValueByKey("personFight"):LangMgr.getValueByKey("personSweap"),this.challengeBtn.name=o?"":"add",this.challengeBtn.enabled=!0,this.doublePrice.visible=this.doubleChallengeBtn.visible=!1,this.doubleChallengeBtn.name="double";var a=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];this.challengeBtn.filters=[];var l=n.getNextVip(),h=0,u=0,p=DataCenter.ins().MonthCardConfig.sweepPrecent/100,c=payControl.monthDay>0?1-p:1;if(0==o){if(0>=r)switch(l){case-1:this.count.text=LangMgr.getValueByKey("fbTodaySweepEnd"),this.count.verticalCenter=0,this.challengeBtn.visible=!1,this.price.visible=!1,this.doublePrice.visible=!1,this.levelRequire.visible=!1;break;default:vipControl.lv<l?(this.count.textFlow=(new egret.HtmlTextParser).parser(StringUtils.addColor(""+vipControl.getVipStr(l),LangMgr.getColor("color26"))+LangMgr.getValueByKey("fbMoreOneSweep")),this.challengeBtn.filters=[new egret.ColorMatrixFilter(a)],this.doubleChallengeBtn.enabled=this.challengeBtn.enabled=!1):(this.count.text=""+vipControl.getVipStr(l)+LangMgr.getValueByKey("fbMoreOneSweep"),this.doubleChallengeBtn.enabled=this.challengeBtn.enabled=!0)}h=Math.floor(t.buyPrice[n.vipBuyCount]*c),this.price.setPrice(h),r>0&&t.buyDoublePrice&&(ActorControl.level>=t.levelLimit&&(this.doublePrice.visible=this.doubleChallengeBtn.visible=!0),t.buyDoublePrice&&(u=t.buyDoublePrice[n.vipBuyCount]*c,this.doublePrice.setPrice(u)))}else"canChallenge"==this.currentState&&(this.challengeBtn.visible=!0)},e}(BaseItemRender);__reflect(CopyItemRender.prototype,"CopyItemRender");var DailyCopyTabBtnItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.bg.source=this.data.bg},e}(BaseItemRender);__reflect(DailyCopyTabBtnItemRender.prototype,"DailyCopyTabBtnItemRender");var DemonCircleMonsterItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DemonCircleMonsterItemSkin",e.bossImage=new GameMovieClip,e.bossImage.x=20,e.bossImage.y=70,e.monsterGroup.addChild(e.bossImage),e}return __extends(e,t),e.prototype.dataChanged=function(){this.bossImage.scaleX=this.bossImage.scaleY=this.data.scaleValue,this.monsterNameImg.source=this.data.bosNameImg,this.stateImg.visible=this.noChallge.visible=!1,this.bossImage.playFile(PATH_GUAIWU+(""+this.data.bossModel),-1),this.monsterGroup.filters=null,0==magicCircleControl.layerData[this.data.id-1]?this.noChallge.visible=!0:2==magicCircleControl.layerData[this.data.id-1]&&(this.stateImg.visible=!0,this.monsterGroup.filters=FilterUtils.ARRAY_GRAY_FILTER)},e.prototype.setSelected=function(t){this.selectedImg.visible=t},e}(BaseItemRender);__reflect(DemonCircleMonsterItemRender.prototype,"DemonCircleMonsterItemRender");var SkyItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.skinName="SkyItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t&&(this.passAllTip0.text=LangMgr.getValueByKey("babelLayer1",t.layer,""),this.currentState=t.id==copyBabelControl.curLevel?"down":"up")},e}(BaseItemRender);__reflect(SkyItemRender.prototype,"SkyItemRender");var CrazyDogControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dogDatas={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downSummonerInfo=function(t,e){for(var i=0;i<t.length;i++){var n=new CrazyDogVo;n.init(t[i]),this.dogDatas[n.id]=n}this.skinId=e},e.prototype.upActivation=function(t){return[t]},e.prototype.downActivation=function(t){var e=this.getSummonerDataById(t);e||(this.dogDatas[t]=new CrazyDogVo,this.dogDatas[t].id=t),EventMgr.ins().dispatch(283)},e.prototype.upIllusion=function(t){return[t]},e.prototype.downIllusion=function(t){this.skinId=t,EventMgr.ins().dispatch(284)},e.prototype.upUpgradeExp=function(t,e){return void 0===e&&(e=0),[t,e]},e.prototype.downSummonerUpExp=function(t,e,i){var n=this.getSummonerDataById(t);if(n){var o=n.level;n.level=e,n.exp=i,e>o&&EventMgr.ins().dispatch(286)}EventMgr.ins().dispatch(285)},e.prototype.upUpStar=function(t){return[t]},e.prototype.downUpStar=function(t,e){var i=this.getSummonerDataById(t);i.star=e,EventMgr.ins().dispatch(287)},e.prototype.getSummonerDataById=function(t){return this.dogDatas[t]},e.prototype.getLevelById=function(t){var e=this.getSummonerDataById(t);return e?e.level:0},e.prototype.getStageById=function(t){var e=this.getSummonerDataById(t);if(!e||!e.level)return 1;var i=Math.floor(e.level/10),n=Math.floor(e.level%10);return i+=1,n||(i-=1),i||(i=1),i},e.prototype.getStarById=function(t){var e=this.getSummonerDataById(t);return e?e.star:0},e.prototype.getSkillsById=function(t){var e=[];return this.dogDatas[t]?DataCenter.ins().CrazyDogConfig[t].skill:e},e.prototype.getSummonerPower=function(t){var e=this.getLevelById(t),i=0,n=DataCenter.ins().CrazyDogLevelConfig[t][e];if(!n)return[i,[],[]];var o=this.getSummonerDataById(t);if(!o)return[i,[],[]];var s=DataCenter.ins().CrazyDogLevelConfig[t][e+1],r=0,a=0,l=[],h=[],u=DataCenter.ins().CrazyDogBaseConfig.addjob;r+=BackpackControl.getAttrPower(n.attrs)*u.length;for(var p=0;p<u.length;p++){var c=heroControl.getSubRoleByJob(u[p]);if(c)for(var d in n.attrs)r+=ItemUtils.relatePower(n.attrs[d],c)}l=this.addAttrs(l,n.attrs),s&&(h=this.addAttrs(h,s.attrs));for(var g=DataCenter.ins().CrazyDogConfig[t],p=0;p<g.skill.length;p++)if(e>=g.skill[p].open){var m=DataCenter.ins().CrazyDogSkillConfig[g.skill[p].id];if(!m.attrs)continue;var f=DataCenter.ins().CrazyDogBaseConfig.addjob;a+=BackpackControl.getAttrPower(m.attrs)*f.length;for(var v=0;v<f.length;v++){var c=heroControl.getSubRoleByJob(f[p]);if(c)for(var y=0;y<m.attrs.length;y++)a+=ItemUtils.relatePower(m.attrs[y],c)}}return i=r+a,[i,l,h]},e.prototype.addAttrs=function(t,e,i){void 0===i&&(i=!0);var n=i?[]:t;if(i)for(var o=0;o<t.length;o++)-1!=AttributeData.showTypeList.indexOf(t[o].type)&&n.push(new AttributeData(t[o].type,t[o].value));for(var o=0;o<e.length;o++){var s=!1;if(-1!=AttributeData.showTypeList.indexOf(e[o].type)){for(var r=0;r<t.length;r++)if(t[r].type==e[o].type){n[r].value+=e[o].value,s=!0;break}s||n.push(new AttributeData(e[o].type,e[o].value))}}return n},e.prototype.isActivation=function(t){var e=this.getSummonerDataById(t);if(!e){var i=DataCenter.ins().CrazyDogConfig[t],n=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.mat),o=DataCenter.ins().CrazyDogStarConfig[t][0].count;return n>=o}return!1},e.prototype.isUpLevel=function(t){var e=this.getSummonerDataById(t);if(!e)return!1;var i=DataCenter.ins().CrazyDogLevelConfig[t][e.level];if(!i||!i.exp)return!1;var n=i.exp-e.exp;n=n>0?n:0;var o=Math.ceil(n/DataCenter.ins().CrazyDogBaseConfig.stageitemexp),s=backpackControl.getBagItemById(DataCenter.ins().CrazyDogBaseConfig.stageitemid),r=s?s.count:0;return r>=o},e.prototype.isHintNum=function(t){var e=this.getSummonerDataById(t);if(!e)return!1;var i=DataCenter.ins().CrazyDogLevelConfig[t][e.level];if(!i||!i.exp)return!1;var n=backpackControl.getBagItemById(DataCenter.ins().CrazyDogBaseConfig.stageitemid),o=n?n.count:0;return o>=DataCenter.ins().CrazyDogBaseConfig.hintNum},e.prototype.isUpStar=function(t){var e=this.getSummonerDataById(t);if(!e)return!1;if(this.isMaxUpStar(t))return!1;var i=DataCenter.ins().CrazyDogConfig[t],n=DataCenter.ins().CrazyDogStarConfig[t][e.star].count,o=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.mat);return o>=n},e.prototype.isMaxUpStar=function(t){var e=this.getSummonerDataById(t),i=DataCenter.ins().CrazyDogStarConfig[t][e.star+1];return i?!1:!0},e.prototype.getStarAttrs=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n,o=this.getSummonerDataById(t),s=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],r=0,a=o&&e?1:0;if(o)n=DataCenter.ins().CrazyDogStarConfig[t][o.star+a],n||(n=DataCenter.ins().CrazyDogStarConfig[t][o.star]);else{if(!i)return[s,r];n=DataCenter.ins().CrazyDogStarConfig[t][a]}n&&n.attrs&&(s=AttributeData.AttrAddition(s,n.attrs),r+=BackpackControl.getAttrPower(s));for(var l=DataCenter.ins().CrazyDogBaseConfig.addjob,h=0;h<s.length;h++)s[h].value*=l.length;return r*=l.length,[s,r]},e.prototype.getStageLv=function(t){var e=Math.floor(t/10),i=Math.floor(t%10);return i?e+=1:t&&t%10==0?i=10:e+=1,[e,i]},e.prototype.getLinkSkillReviseCfg=function(t){var e,i=DataCenter.ins().CrazyDogConfig[this.skinId],n=t/1e3>>0;if(i){var o=DataCenter.ins().SkillsCommonReviseConfig[i.skillrevise];o.skill==n&&(e=o)}return e},e.prototype.getSummonerSkill=function(t){var e=0;return 1==t?e=80010+this.skinId:2==t&&(e=80040+this.skinId),e},e.prototype.isSummonerSkill=function(t){return t>=80011&&80020>=t||t>=80041&&80050>=t?!0:!1},__decorate([down(1,[ByteConst.CrazyDogVos,3])],e.prototype,"downSummonerInfo",null),__decorate([up(2,[3])],e.prototype,"upActivation",null),__decorate([down(2,[3])],e.prototype,"downActivation",null),__decorate([up(3,[3])],e.prototype,"upIllusion",null),__decorate([down(3,[3])],e.prototype,"downIllusion",null),__decorate([up(4,[3,1])],e.prototype,"upUpgradeExp",null),__decorate([down(4,[3,2,3])],e.prototype,"downSummonerUpExp",null),__decorate([up(5,[3])],e.prototype,"upUpStar",null),__decorate([down(5,[3,2])],e.prototype,"downUpStar",null),e=__decorate([protocolsId(77)],e)}(BaseSystem);__reflect(CrazyDogControl.prototype,"CrazyDogControl");var AmusementType2DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.buyData=[],e.serverBuyData=[],e.areaBuyData=[],e.areabuyReward=[],e}return __extends(e,t),e.prototype.initAmusement=function(t){for(var e=0;e<t[0].length;e++){var i=e+1;this.buyData[i]=t[0][e][0],this.serverBuyData[i]=t[0][e][1],this.areaBuyData[i]=t[0][e][2],this.areabuyReward[i]=t[0][e][3]
}for(var n=0;n<=t[0].length;n++)this.areaBuyData[n]=Math.max(this.areaBuyData[n],this.buyData[n]);this.sumRMB=t[1]},e.prototype.updateAmusement=function(t){var e=t[0],i=t[1];this.buyData[e]=i,this.serverBuyData[e]=t[2],this.areaBuyData[e]=t[3],this.areabuyReward[e]=t[4];for(var n=0;i>=n;n++)this.areaBuyData[n]=Math.max(this.areaBuyData[n],this.buyData[n])},e.prototype.canReward=function(){if(ActorControl.level<e.LimitLevel)return!1;var t=amusementControl.getAmusementDataById(this.id),i=DataCenter.ins().Amusement2Config[this.id],n=!1;for(var o in i){var s=i[o],r=t.buyData[s.index]>=s.count?!0:!1;if(n=this.serverBuyData[s.index]>=s.scount?!0:!1,!r&&t.sumRMB>=s.needRecharge&&ActorControl.yb>=s.price&&vipControl.lv>=s.vip&&!n)return!0;if(r&&s.countReward)for(var a in s.countReward)if(this.getAreaReward(s.index,Number(a)+1))return!0}return!1},e.prototype.isSpecialOpen=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3),i=DataCenter.ins().Amusement2Config[this.id][1];if(!i.limitTime)return!1;var n=Number(i.limitTime[0]),o=Number(i.limitTime[1]);return 0>t+3600*n+60*o&&e>0},e.prototype.getSpecialStrikeTimes=function(){var t=DataCenter.ins().Amusement2Config[this.id][1],e=Number(t.limitTime[0]),i=Number(t.limitTime[1]),n=(GameServer.serverTime-DateUtils.formatMiniDateTime(this.startTime)-36e5*e-6e4*i)/1e3/240;return n>0?n:0},e.prototype.getHide=function(){var t=[this.id],e=DataCenter.ins().AmusementBtnConfig[this.id];e.relyOn&&(t=t.concat(e.relyOn));for(var i=0;i<t.length;i++){var n=DataCenter.ins().Amusement2Config[t[i]],o=amusementControl.activityData[t[i]];if(o&&o.buyData)for(var s=o.buyData,r=1;r<s.length;r++){var a=n[r];if(s[r]<a.count)return this.isHide=!1,this.isHide}}return this.isHide=!0,this.isHide},e.prototype.getLeftTime=function(){if(this.endTime){var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return 0>t&&(t=0),t}var e=DataCenter.ins().AmusementConfig[this.id],i=0,n=0;if(0==e.timeType){var o=+e.startTime.split("-")[0];n=+e.endTime.split("-")[0]-o,i=GameServer.serverOpenDay-o}else if(1==e.timeType){var o=GameServer.serverTime,s=new Date(e.startTime).getTime(),r=new Date(e.endTime).getTime();i=Math.floor((o-s)/1e3/3600/24),n=Math.round((r-s)/1e3/3600/24)}else if(2==e.timeType){var o=+e.startTime.split("-")[0];n=+e.endTime.split("-")[0]-o;var a=Math.floor((GameServer.serverTime-DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime))/1e3/3600/24);i=a-o}var l=new Date(GameServer.serverTime),h=n-i;if(0>=h)return 0;var u=new Date(GameServer.serverTime);return u.setDate(l.getDate()+h),u.setHours(0,0,0,0),Math.floor((u.getTime()-GameServer.serverTime)/1e3)},e.prototype.getSpecialOpenLeftTime=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3),i=DataCenter.ins().Amusement2Config[this.id][1];if(!i.limitTime)return 0;var n=Number(i.limitTime[0]),o=Number(i.limitTime[1]);return t+=3600*n+60*o,0>t&&e>0?t:0},e.prototype.getAreaReward=function(t,e){var i=DataCenter.ins().Amusement2Config[this.id][t];if(this.buyData[t]&&this.buyData[t]>=i.count){if((this.areabuyReward[t]>>e&1)>0)return AmusementControl.Geted;if(this.areaBuyData[t]>=i.countReward[e-1].count)return AmusementControl.CanGet}return AmusementControl.NotReached},e.LimitLevel=50,e}(AmusementBaseDataVo);__reflect(AmusementType2DataVo.prototype,"AmusementType2DataVo");var CrazyDogVo=function(){function t(){this.level=0,this.exp=0,this.star=0}return t.prototype.init=function(t){this.id=t[0],this.level=t[1],this.exp=t[2],this.star=t[3]},t}();__reflect(CrazyDogVo.prototype,"CrazyDogVo");var CrazyDogSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.id=t[0]||0,this.skillid=t[1],this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.bgClose,this.otherClose);var i={name:"",desc:"",lock:""},n={name:"",desc:"",lock:""},o="";if(this.skillid){o="unactive";for(var s=DataCenter.ins().CrazyDogConfig[this.id],r=crazyDogControl.getSummonerDataById(this.id),a=(crazyDogControl.getSkillsById(this.id),0);a<s.skill.length;a++)if(s.skill[a].id==this.skillid){var l=DataCenter.ins().CrazyDogSkillConfig[s.skill[a].id];if(!r||r.level<s.skill[a].open){var h=Math.floor(s.skill[a].open/10),u=Math.floor(s.skill[a].open%10);u?h+=1:s.skill[a].open&&s.skill[a].open%10==0?u=10:h+=1,i.lock=LangMgr.getValueByKey("wingTips4",h,u)}else o="max";l.desc&&l.desc.name&&(i.name=l.desc.name),l.desc&&l.desc.desc&&(i.desc=l.desc.desc),l.attrs&&(i.desc&&(i.desc+="\n"),i.desc+="|C:"+LangMgr.getColor("color79")+"&T:"+AttributeData.getAttStr(l.attrs,0,1,"：")+"|");break}}this.currentState=o,this.validateNow(),this.lblUnlock.visible="unactive"!=this.currentState,this.skillName0.textFlow=TextUtils.generateTextFlow1(i.name),this.skillDesc0.textFlow=TextUtils.generateTextFlow1(i.desc),i.lock?this.condition0.textFlow=TextUtils.generateTextFlow1(i.lock):DisplayUtils.removeFromParent(this.condition0.parent),n.name&&("active"==o?(this.skillName1.textFlow=TextUtils.generateTextFlow1(n.name),this.skillDesc1.textFlow=TextUtils.generateTextFlow1(n.desc),n.lock?this.condition1.textFlow=TextUtils.generateTextFlow1(n.lock):DisplayUtils.removeFromParent(this.condition1.parent)):DisplayUtils.removeFromParent(this.nextGroup))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.otherClose),this.removeEventTouchTap(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CrazyDogSkillTipsView.prototype,"CrazyDogSkillTipsView");var CrazyDogStarView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazyDogStarViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.summonerId=t[0],this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.soulBtn,this.onClick),this.addEventTouchTap(this.getItemTxt,this.onClick),this.addCustomEvent(266,this.updateCost),this.addCustomEvent(268,this.updateCost),this.addCustomEvent(269,this.updateCost),this.addCustomEvent(287,this.updateUI),this.updateUI()},e.prototype.updateUI=function(){this.updateStar(),this.updateModel(),this.updateAttrs(),this.updateCost()},e.prototype.updateStar=function(){for(var t=crazyDogControl.getStarById(this.summonerId),e=0;e<this.starGroup.numElements;e++)this["starImg"+e]&&(this["starImg"+e].source=t>e?"shenqi_star":"shenqi_star_empty");for(var i=DataCenter.ins().CrazyDogStarConfig[this.summonerId],e=0;t>e;e++){var n=e-6*(e/6>>0);this["starImg"+n]&&i&&i[e+1].showIcon&&(this["starImg"+n].source=i[e+1].showIcon)}},e.prototype.updateModel=function(){var t=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][0];this.nameImg.source=t.zlName,this.summonerMc||(this.summonerMc=new GameMovieClip),this.summonerMc.parent||this.effGroup.addChild(this.summonerMc),this.summonerMc.name!=PATH_EFF+t.innerAppearance&&this.summonerMc.playFile(PATH_EFF+t.innerAppearance,-1)},e.prototype.updateAttrs=function(){this.attrGroup2.visible=crazyDogControl.isMaxUpStar(this.summonerId),this.attrGroup0.visible=this.attrGroup1.visible=this.arrow0.visible=!this.attrGroup2.visible;var t=crazyDogControl.getStarAttrs(this.summonerId),e=crazyDogControl.getStarAttrs(this.summonerId,!0);this.attrGroup2.visible?(this.attr2.text=AttributeData.getAttStr(t[0],0,1,"："),this.powerPanel2.setPower(t[1])):(this.attr0.text=AttributeData.getAttStr(t[0],0,1,"："),this.attr1.text=AttributeData.getAttStr(e[0],0,1,"："),this.powerPanel0.setPower(t[1]),this.powerPanel1.setPower(e[1]))},e.prototype.updateCost=function(){if(this.maxLevel.visible=crazyDogControl.isMaxUpStar(this.summonerId),this.upGroup.visible=!this.maxLevel.visible,!this.maxLevel.visible){var t=crazyDogControl.getStarById(this.summonerId),e=DataCenter.ins().CrazyDogConfig[this.summonerId],i=DataCenter.ins().ItemConfig[e.mat];this.costImg.source=i.icon+"_png",this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.visible=crazyDogControl.isMaxUpStar(this.summonerId)?!1:!0;var n=DataCenter.ins().CrazyDogStarConfig[this.summonerId][t],o=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e.mat),s=ColorUtils.NORMAL_COLOR;crazyDogControl.isUpStar(this.summonerId)?(s=ColorUtils.GREEN,this.redPoint.visible=!0):(s=ColorUtils.RED,this.redPoint.visible=!1),this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+o),this.needNum.text="/"+n.count,this.costId=e.mat,this.costCount=n.count}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.soulBtn:crazyDogControl.isUpStar(this.summonerId)?crazyDogControl.upUpStar(this.summonerId):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));break;case this.getItemTxt:warnControl.setBuyGoodsWarn(DataCenter.ins().CrazyDogConfig[this.summonerId].mat);break;case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(CrazyDogStarView.prototype,"CrazyDogStarView");var CrazyDogView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazyDogViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.starBtn,this.onClick),this.addEventTouchTap(this.huanhua,this.onClick),this.addEventTouchTap(this.help,this.onClick),this.addEventTouchTap(this.btn0,this.onClick),this.addEventTouchTap(this.btn1,this.onClick),this.addEventTouchTap(this.upBtn,this.onClick),this.addEventTouchTap(this.upBtnEx,this.onClick),this.addEventTouchTap(this.checkBoxs,this.onClick),this.addEventTouchTap(this.icon,this.showIconTips),this.addCustomEvent(266,this.updateItemPost),this.addCustomEvent(268,this.updateItemPost),this.addCustomEvent(269,this.updateItemPost),this.addCustomEvent(283,this.updateDataPost),this.addCustomEvent(284,this.updateDataPost),this.addCustomEvent(285,this.updateDataPost),this.addCustomEvent(286,this.stopUpGrade),this.addCustomEvent(287,this.updateUpStarPost),this.addCustomEvent(457,this.updateCost),this.addEventItemTap(this.list,this.onSummonerClick),this.list.itemRenderer=CrazyDogIconItemRenderer,this.list.useVirtualLayout=!1,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData,this.addEventChangeEnd(this.listScroller,this.onChange);for(var i=1;4>=i;i++)this.addEventTouchTap(this["skillIcon"+i],this.onSkillEvent);this.updateUI()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.starBtn:UIMgr.ins().open(CrazyDogStarView,this.summonerId);break;case this.upBtn:this.sendUpGrade();break;case this.upBtnEx:this.upRedPoint.visible?crazyDogControl.upActivation(this.summonerId):tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"));break;case this.huanhua:if(!crazyDogControl.getSummonerDataById(this.summonerId))return void tipsControl.showTips(LangMgr.getValueByKey("wingTips8"));var e=this.summonerId;crazyDogControl.skinId==this.summonerId&&(e=0),crazyDogControl.upIllusion(e);break;case this.help:HelpControl.openHelpWin(200);break;case this.btn0:var i=this.list.scrollV-this.list.height;0>i&&(i=0),this.list.scrollV=i,this.onChange();break;case this.btn1:var i=this.list.scrollV+this.list.height;i>this.list.contentHeight-this.listScroller.height&&(i=this.list.contentHeight-this.listScroller.height),this.list.scrollV=i,this.onChange();break;case this.checkBoxs:this.updateCost();break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onSummonerClick=function(t){if(t&&t.itemRenderer&&t.item){var e=t.item;this.summonerId=e.id,this.updateUI()}},e.prototype.updateDataPost=function(){this.updateState(),this.updateTop(),this.updateSkill(),this.updateValue(),this.updateDown()},e.prototype.updateItemPost=function(){this.updateCost(),this.updateRedPoint(),this.updateUpStar()},e.prototype.updateUI=function(){this.updateState(),this.updateTop(),this.updateSkill(),this.updateValue(),this.updateDown(),this.updateCost(),this.updateRedPoint(),this.updateUpStar()},e.prototype.updateState=function(){var t=[];for(var e in DataCenter.ins().CrazyDogConfig){var i=DataCenter.ins().CrazyDogConfig[e];(0==i.show||crazyDogControl.isActivation(i.id)||crazyDogControl.getSummonerDataById(i.id))&&t.push(i)}t.sort(function(t,e){var i=crazyDogControl.isActivation(t.id)?1:0,n=crazyDogControl.isActivation(e.id)?1:0;if(i>n)return-1;if(n>i)return 1;var o=crazyDogControl.isUpLevel(t.id)||crazyDogControl.isHintNum(t.id)||crazyDogControl.isUpStar(t.id)?1:0,s=crazyDogControl.isUpLevel(e.id)||crazyDogControl.isHintNum(e.id)||crazyDogControl.isUpStar(e.id)?1:0;if(o>s)return-1;if(s>o)return 1;var r=crazyDogControl.getSummonerDataById(t.id)?1:0,a=crazyDogControl.getSummonerDataById(e.id)?1:0;return r>a?-1:a>r?1:t.id<e.id?-1:1}),this.listData.replaceAll(t),this.summonerId||(this.summonerId=t[0].id);var n=crazyDogControl.getLevelById(this.summonerId),o=CommonUtils.getObjectLength(DataCenter.ins().CrazyDogLevelConfig[this.summonerId])-1;n>=o?"skin_max"!=this.currentState&&(this.currentState="skin_max",this.validateNow()):"skin_up"!=this.currentState&&(this.currentState="skin_up",this.validateNow())},e.prototype.updateTop=function(){if(this.summonerId)for(var t=0;t<this.list.numElements;t++){var e=this.list.getVirtualElementAt(t),i=e.data;if(i.id==this.summonerId){e!=this.selectItem&&(this.selectItem&&this.selectItem.setSelect(!1),this.selectItem=e),e.setSelect(!0),this.listScroller.stopAnimation();var n=t*(e.height-6),o=n+e.height;if(n<this.list.scrollV)this.list.scrollV=n;else if(o>this.list.scrollV+this.listScroller.height){var s=o-this.listScroller.height;o>this.list.contentHeight&&(s=this.list.contentHeight-this.listScroller.height),this.list.scrollV=s}break}}this.onChange();var r=crazyDogControl.getSummonerDataById(this.summonerId);this.huanhua.visible=!!r,this.huanhua.icon=crazyDogControl.skinId==this.summonerId?"zl_quxiao_btn":"zl_huanhua_btn";var a=crazyDogControl.getLevelById(this.summonerId);this.lv.data=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][a].stageDesc,this.summonerMc||(this.summonerMc=new GameMovieClip),this.summonerMc.parent||this.zhanling.addChild(this.summonerMc),this.updateModel()},e.prototype.updateModel=function(){var t,e=crazyDogControl.getLevelById(this.summonerId);if(this.isAutoUp){var i=crazyDogControl.getStageById(this.summonerId),n=10*i+1;t=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][n],t?e=n:t=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][e]}else t=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][e];this.zhanlingName.source=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][e].zlName,this.summonerMc.name!=PATH_EFF+t.innerAppearance&&this.summonerMc.playFile(PATH_EFF+t.innerAppearance,-1)},e.prototype.onChange=function(){this.list.scrollV<39?(this.btn0.visible=!1,this.btn1.visible=!0):this.list.scrollV>=this.list.contentHeight-this.list.height-39?(this.btn0.visible=!0,this.btn1.visible=!1):(this.btn0.visible=!0,this.btn1.visible=!0),this.list.numElements<=4&&(this.btn0.visible=this.btn1.visible=!1)},e.prototype.updateSkill=function(){for(var t=DataCenter.ins().CrazyDogConfig[this.summonerId],e=0;e<t.skill.length;e++){var i=t.skill[e].id,n=DataCenter.ins().CrazyDogSkillConfig[i];n.desc&&n.desc.icon&&(this["skillIcon"+(e+1)].source=n.desc.icon)}for(var o=crazyDogControl.getLevelById(this.summonerId),e=0;e<DataCenter.ins().CrazyDogConfig[this.summonerId].skill.length;e++){var s=DataCenter.ins().CrazyDogConfig[this.summonerId].skill[e];this["blackImg"+(e+1)].visible=s.open>o?!0:!1}},e.prototype.updateValue=function(){var t=crazyDogControl.getLevelById(this.summonerId),e=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][t];if(e){var i=crazyDogControl.getSummonerPower(this.summonerId),n=i[0]?i[0]:0,o=crazyDogControl.getStarAttrs(this.summonerId);this.powerPanel.setPower(n+o[1]),i[1].length||(i[1]=this.getEmptyAttrs(this.summonerId)),i[2].length||(i[2]=this.getEmptyAttrs(this.summonerId,!0));var s=AttributeData.getAttStr(i[1],0,1,"：")+"\n",r=AttributeData.getAttStr(i[2],0,1,"：")+"\n";this.curAtt.text=s,this.nextAtt.text=r}},e.prototype.getEmptyAttrs=function(t,e){var i=[],n=DataCenter.ins().CrazyDogLevelConfig[t][0];if(i=crazyDogControl.addAttrs(i,n.attrs),!e)for(var o=0;o<i.length;o++)i[o].value=0;return i},e.prototype.updateDown=function(t){void 0===t&&(t=0);var e=crazyDogControl.getSummonerDataById(this.summonerId);if(!this.summonerId||(this.starGroup.visible=this.barGroup.visible=e?!0:!1,e)){this.starList||(this.starList=new StarList(10),this.starList.horizontalCenter=0),this.starList.parent||this.starGroup.addChild(this.starList);var i=crazyDogControl.getLevelById(this.summonerId),n=Math.floor(i%10);if(i){var o=n;o||(n=10)}this.starList.setStarNum(n,t),this.barbc||(this.barbc=new ProgressBarEff,this.barbc.setWidth(525)),this.barbc.parent||this.barGroup.addChild(this.barbc);var s=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][e.level];s&&(this.barbc.reset(),this.barbc.setData(e.exp,s.exp))}},e.prototype.updateCost=function(){var t=this.getCostValue(),e=t[0],i=t[1],n=e>=i?LangMgr.getColor("color43"):LangMgr.getColor("color22");this.countLabel.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:"+e+"|/"+i);var o=crazyDogControl.getSummonerDataById(this.summonerId);this.upBtn.visible=o?!0:!1,this.upBtnEx.visible=!this.upBtn.visible},e.prototype.getCostValue=function(){var t=crazyDogControl.getSummonerDataById(this.summonerId),e=DataCenter.ins().CrazyDogConfig[this.summonerId];if(this.checkBoxs.visible=!0,this.costType=1,t||!e.mat){var i=0,n=0,o=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][t.level],s=DataCenter.ins().ItemConfig[DataCenter.ins().CrazyDogBaseConfig.stageitemid];this.icon.source=s.icon+"_png";var r=backpackControl.getBagItemById(DataCenter.ins().CrazyDogBaseConfig.stageitemid);return i=r?r.count:0,n=o.count,this.checkBoxs.selected&&n>i&&(i=ActorControl.yb,this.icon.source="szyuanbao",n=DataCenter.ins().CrazyDogBaseConfig.unitPrice*o.count,this.costType=2),this.costCount=n,[i,n]}var a=DataCenter.ins().ItemConfig[e.mat];this.icon.source=a.icon+"_png";var l=backpackControl.getBagItemById(e.mat),h=l?l.count:0,u=DataCenter.ins().CrazyDogStarConfig[this.summonerId][0].count;return this.checkBoxs.visible=!1,this.costType=97,this.costCount=u,[h,u]},e.prototype.updateRedPoint=function(){this.upRedPoint.visible=crazyDogControl.isActivation(this.summonerId)||crazyDogControl.isUpLevel(this.summonerId)||crazyDogControl.isHintNum(this.summonerId)},e.prototype.onSkillEvent=function(t){for(var e=0;e<DataCenter.ins().CrazyDogConfig[this.summonerId].skill.length;e++)if(t.currentTarget==this["skillIcon"+(e+1)]){var i=DataCenter.ins().CrazyDogConfig[this.summonerId].skill[e];UIMgr.ins().open(CrazyDogSkillTipsView,this.summonerId,i.id);break}},e.prototype.sendUpGrade=function(){if(this.isAutoUp=!this.isAutoUp,this.isAutoUp){if(!this.checkUpLevel())return void(this.isAutoUp=!1);this.updateModel(),TimerMgr.ins().doTimer(DataCenter.ins().CrazyDogBaseConfig.unitTime,0,this.autoUpLevel,this)}else TimerMgr.ins().remove(this.autoUpLevel,this);this.upBtn.label=this.isAutoUp?LangMgr.getValueByKey("cancel1"):LangMgr.getValueByKey("skillOnkeyUpdate")},e.prototype.stopUpGrade=function(){this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpLevel,this),this.upBtn.label=this.isAutoUp?LangMgr.getValueByKey("cancel1"):LangMgr.getValueByKey("skillOnkeyUpdate"),this.updateDown(1),this.updateModel();var t=crazyDogControl.getLevelById(this.summonerId),e=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][t];e.activeLv&&this.isTopLevel&&CommonFun.show(0,e.zlNameLabel,null,e.innerAppearance,!0)},e.prototype.autoUpLevel=function(){if(this.isAutoUp){var t=this.checkBoxs.selected?1:0;if(!this.checkUpLevel())return this.isAutoUp=!1,void TimerMgr.ins().remove(this.autoUpLevel,this);crazyDogControl.upUpgradeExp(this.summonerId,t)}},e.prototype.checkUpLevel=function(){if("skin_max"==this.currentState)return tipsControl.showTips(LangMgr.getValueByKey("hijiTips6")),this.upBtn.label=LangMgr.getValueByKey("skillOnkeyUpdate"),!1;if(!crazyDogControl.getSummonerDataById(this.summonerId))return tipsControl.showTips(LangMgr.getValueByKey("wingTips8")),this.upBtn.label=LangMgr.getValueByKey("skillOnkeyUpdate"),!1;var t=this.checkBoxs.selected?1:0,e=this.getCostValue(),i=e[0],n=e[1];if(!i||n>i){if(!t)return tipsControl.showTips(LangMgr.getValueByKey("wingTips10")),this.upBtn.label=LangMgr.getValueByKey("skillOnkeyUpdate"),!1;if(i=ActorControl.yb,n=DataCenter.ins().CrazyDogBaseConfig.unitPrice*n,!i||n>i)return tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),this.upBtn.label=LangMgr.getValueByKey("skillOnkeyUpdate"),!1}return this.upBtn.label=LangMgr.getValueByKey("cancel1"),!0},e.prototype.updateUpStarPost=function(){this.updateUpStar(),this.updateValue()},e.prototype.updateUpStar=function(){var t=crazyDogControl.getSummonerDataById(this.summonerId);this.starBtn.visible=!!t,this.starBtn.data=t?this.summonerId:null},e.prototype.showIconTips=function(){var t=2;switch(this.costType){case 2:UIMgr.ins().open(CurrencyTipsView,t,this.costCount);break;case 1:t=DataCenter.ins().CrazyDogBaseConfig.stageitemid,UIMgr.ins().open(ItemTipsView,0,t,this.costCount);break;case 97:t=DataCenter.ins().CrazyDogConfig[this.summonerId].mat,UIMgr.ins().open(CrazyDogTipsView,t)}},__decorate([callDelay(200)],e.prototype,"updateDataPost",null),__decorate([callDelay(200)],e.prototype,"updateItemPost",null),e}(BaseEuiView);__reflect(CrazyDogView.prototype,"CrazyDogView");var CrazyDogIconItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteIconItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=crazyDogControl.getSummonerDataById(t.id),i=crazyDogControl.getLevelById(t.id);this.icon.source=t.icon,this.state.visible=!e,this.select.visible=!1,this.label.text=""+i,this.label.visible=!this.state.visible,this.redPoint.visible=crazyDogControl.isActivation(t.id)||crazyDogControl.isUpLevel(t.id)||crazyDogControl.isHintNum(t.id)||crazyDogControl.isUpStar(t.id)},e.prototype.setSelect=function(t){this.select.visible=t},e}(BaseItemRender);__reflect(CrazyDogIconItemRenderer.prototype,"CrazyDogIconItemRenderer");var CrazyDogStarBtnItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){for(var t=this.data,e=crazyDogControl.getStarById(t),i=this.starGroup.numElements,n=0;i>n;n++)this["star"+n].source=e>n?"shenqi_star":"shenqi_star_empty";for(var o=DataCenter.ins().CrazyDogStarConfig[t],n=0;e>n;n++){var s=n-6*(n/6>>0);this["star"+s]&&o&&o[n+1].showIcon&&(this["star"+s].source=o[n+1].showIcon)}this.redPoint.visible=crazyDogControl.isUpStar(t)}},e}(BaseItemRender);__reflect(CrazyDogStarBtnItemRenderer.prototype,"CrazyDogStarBtnItemRenderer");var CrossArenaControl=function(t){function e(){var e=t.call(this)||this;return e.lastKFArena=!1,e.times=0,e.duanLevel=0,e.score=0,e.leaderID=0,e.inviteDataList=[],e.worldTimeCd=0,e.flagHandle=10011010110,e.flagCD=0,e.duanName=[],e.dflCount=0,e._openLeftTime=0,e._openTimer=0,e.isStartIng=0,e.ownScore=0,e.ownBattleRank=0,e.isServerOpen=!1,e.addCustomEvent(353,e.changeScene),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.upCreateTeam=function(){},e.prototype.downPlayerInfo=function(t,e,n,o,s,r,a,l,h,u){this.times=t,this.duanLevel=e,this.score=n,this.curMouth||(this.curMouth=new CrossArenaMarkVo),this.curMouth.init([o,s,r]),this.history||(this.history=new CrossArenaMarkVo),this.history.init([a,l,h]),this.isServerOpen=1==u,TimerMgr.ins().doTimer(1e3,1,function(){40==i.lastCopyTyp&&crossArenaControl.times>0&&crossArenaControl.isEasyOpen()&&(UIMgr.ins().open(CrossArenaView,0),i.lastCopyTyp=0)},this),EventMgr.ins().dispatch(315)},e.prototype.upPersonalMatch=function(){},e.prototype.downTeamInfo=function(t,e,i){this.leaderID=t,this.macthState=e,this.tfMembers=[];for(var n=0;n<i.length;n++){var o=new CrossArenaRoleVo;this.tfMembers[n]=o,o.init(i[n])}this.isTFCaptain=ActorControl.actorID==this.leaderID,EventMgr.ins().dispatch(316)},e.prototype.upLeaveTeam=function(){},e.prototype.upStartMacth=function(){},e.prototype.upCancelMacth=function(){},e.prototype.upGuilds=function(t){return[t]},e.prototype.upInvite=function(t){return this.dispatchKfArenaDelID(t),[t]},e.prototype.dispatchKfArenaDelID=function(t){return t},e.prototype.downReceiveInvitation=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new CrossArenaInviteVo;i.init(t),this.checkInviteByID(i.roleId)||this.inviteDataList.push(i),this.inviteDataList.length>0&&UIMgr.ins().open(CrossArenaReceiveInviteView,0)},e.prototype.checkInviteByID=function(t){for(var e=0;e<this.inviteDataList.length;e++)if(this.inviteDataList[e].roleId==t)return!0;return!1},e.prototype.upWorldInvite=function(){},e.prototype.upRespondInvite=function(t,e){return[t,e]},e.prototype.downBack=function(t){switch(t){case 1:UIMgr.ins().open(CrossArenaView,0)}},e.prototype.downMacthState=function(t){this.macthState=t,EventMgr.ins().dispatch(318)},e.prototype.downKfArenaGuilds=function(t,e){if(1==t){this.guildDataList=[];for(var i=0;i<e.length;i++){var n=new UnionMemberInfoVo;n.init(e[i]),this.guildDataList.push(n)}}else if(0==t){this.friendsDataList=[];for(var i=0;i<e.length;i++){var n=new UnionMemberInfoVo;n.init(e[i]),this.friendsDataList.push(n)}}EventMgr.ins().dispatch(321,t)},e.prototype.getDataList=function(t){var e,i=[];if(e=0==t?this.friendsDataList:this.guildDataList,!e)return i;for(var n=0;n<e.length;n++)if(e[n].roleID!=ActorControl.actorID){var o=new UnionMemberInfoVo;o.copyData(e[n]),i.push(o)}return i},e.prototype.upJoinTeam=function(t){return[t]},e.prototype.upOutTeam=function(t){return[t]},e.prototype.downRefFlag=function(t,e){this.flagCD=1e3*e+egret.getTimer(),this.flagHandle=10011010110,EventMgr.ins().dispatch(317)},e.prototype.downCollectFlag=function(t,e,i,n){this.firstCollect=i,this.collectCamp=n,e||(this.collectCamp=0),t&&t==ActorControl.handle&&e?(UIMgr.ins().open(CrossCollectView,e),gameControl.currAttackHandle=0):UIMgr.ins().close(CrossCollectView)},e.prototype.upCollectFlag=function(){},e.prototype.downRelive=function(t,e){var i=UnitMgr.ins().getEntityByHandle(e),n="";if(i){var o=UnitMgr.ins().getEntityByHandle(i.infoModel.masterHandle);n=i instanceof UnitRole?i.infoModel.name:i.infoModel.masterHandle&&o?""+o.infoModel.name:"Boss"+i.infoModel.name}UIMgr.ins().open(CrossReliveView,t,n)},e.prototype.downFbInfo=function(t,e,i,n,o,s){this.startTime=t,this.myCampId=i,this.scoreA=n,this.scoreB=o,this.readyIndex=s,UIMgr.ins().open(CrossArenaFightView,(DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0,e)},e.prototype.downResult=function(t,e,i,n,o){this.winCamp=i;for(var s=[],r=0;r<n.length;r++){var a=new CrossArenaVo;a.initData(n[r]),a.rank=r+1,s.push(a)}for(var l=[],r=0;r<o.length;r++){var h=new RewardVo;h.init(o[r]),l.push(h)}UIMgr.ins().open(CrossArenaResultView,this.winCamp,t,e,s,l),this.firstCollect=!1},e.prototype.upEnterBattle=function(){},e.prototype.downChangeScore=function(t,e){this.scoreA=t,this.scoreB=e,EventMgr.ins().dispatch(319)},e.prototype.downDataInfo=function(t){this.dataList=[];for(var e=0;e<t.length;e++){var i=new CrossArenaVo;i.initRankData(t[e]),i.rank=e+1,this.dataList.push(i)}EventMgr.ins().dispatch(320,this.dataList)},e.prototype.upDataInfo=function(){},e.prototype.downNotice=function(t){MarqueeView.show(t)},e.prototype.downMyBattleInfo=function(t,e){this.ownScore=t,this.ownBattleRank=e,EventMgr.ins().dispatch(322)},e.prototype.downRank=function(t,e){this.rankDataList=[];for(var i=0;i<t.length;i++){var n=new CrossArenaRankVo;n.init(t[i]),this.rankDataList.push(n)}this.ownRank=e,EventMgr.ins().dispatch(325)},e.prototype.upRank=function(){},e.prototype.upDailyRewards=function(){},e.prototype.upJoinRewards=function(t){return[t]},e.prototype.downJoinRewards=function(t,e,i,n,o){this.yesterdayDuan=t,this.dailyState=e,this.dflCount=i,this.dflState=n,this.awardDuan=o,EventMgr.ins().dispatch(323)},e.prototype.downOpenKfArena=function(t,e){this.isStartIng=t,this._openLeftTime=e,this._openTimer=egret.getTimer(),EventMgr.ins().dispatch(324)},e.prototype.upReceiveAwardDuan=function(){},e.prototype.downReConnection=function(t){t?i.takeExitFb?this.upCancelReConnect():UIMgr.ins().open(CrossArenaReConnectView,this.upReConnect.bind(this),this.upCancelReConnect.bind(this)):UIMgr.ins().close(CrossArenaReConnectView)},e.prototype.upReConnect=function(){},e.prototype.upCancelReConnect=function(){},e.prototype.getOpenLeftTime=function(){return this._openLeftTime-(egret.getTimer()-this._openTimer)/1e3},e.prototype.getIsNoOnline=function(){for(var t="",e=0;e<this.tfMembers.length;e++){var i=this.tfMembers[e];i.isonline||(t+=""==t?i.roleName:"、"+i.roleName)}return t},e.prototype.getWinRate=function(){var t=this.curMouth.win/(this.curMouth.win+this.curMouth.fail+this.curMouth.ping)*100;return(t>>0)+"%"},e.prototype.checkIsMatching=function(){return 1==crossArenaControl.macthState?(tipsControl.showTips(LangMgr.getValueByKey("kfArenaMatching")),!1):!0},e.prototype.checkFBOperat=function(t){void 0==t&&(t=!1),t&&this.collectCamp&&this.collectCamp==this.myCampId&&tipsControl.showCenterTips(LangMgr.getValueByKey("kfArenaCollecting"));var e=(DateUtils.formatMiniDateTime(crossArenaControl.startTime)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0;return e>0&&tipsControl.showTips(LangMgr.getValueByKey("kfArenaFightStartTime",ColorUtils.RED,e)),0>=e},e.prototype.getIsJoinTeam=function(){return 0!=this.leaderID},Object.defineProperty(e.prototype,"isKFArena",{get:function(){return 40==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.changeScene=function(){this.isKFArena?(this.lastKFArena=!0,this.updataModel()):this.lastKFArena&&(this.lastKFArena=!1,this.flagHandle=0,this.ownScore=0,this.ownBattleRank=0,UIMgr.ins().close(CrossArenaFightView),this.updataModel(),i.lastCopyTyp=MapControl.lastCopyTyp)},e.prototype.updataModel=function(){var t=UnitMgr.ins().getAllEntity();for(var e in t){var i=t[e];i.updateModel()}},e.prototype.getDuanAwards=function(){var t=DataCenter.ins().CrossArenaBaseConfig.everyDayAward;for(var e in t)if(t[e].metal==this.yesterdayDuan)return t[e].award;return null},e.prototype.getDuanName=function(t){return void 0===t&&(t=0),t?DataCenter.ins().CrossArenaBaseConfig.scoreMetalName[t-1]:DataCenter.ins().CrossArenaBaseConfig.scoreMetalName[this.duanLevel-1]},e.prototype.getActorIdByName=function(t){for(var e=this.dataList,i=0;i<e.length;i++){var n=e[i];if(n.playerName==t)return n.actorid}return 0},e.prototype.isEasyOpen=function(){return this.isServerOpen?DataCenter.ins().CrossArenaBaseConfig.openDay<=GameServer.serverOpenDay+1&&reincarnateControl.lv>=DataCenter.ins().CrossArenaBaseConfig.zhuanshengLevel:!1},e.prototype.isOpen=function(){if(!this.isServerOpen)return!1;var t=DataCenter.ins().CrossArenaBaseConfig.openDay<=GameServer.serverOpenDay+1&&reincarnateControl.lv>=DataCenter.ins().CrossArenaBaseConfig.zhuanshengLevel;return t&&(1==this.isStartIng||0==this.isStartIng&&this._openLeftTime>0)?!0:!1},e.takeExitFb=!1,e.lastCopyTyp=0,__decorate([up(1)],e.prototype,"upCreateTeam",null),__decorate([down(1,[3,3,3].concat(ByteConst.CrossArenaMarkVos,ByteConst.CrossArenaMarkVos,[3]))],e.prototype,"downPlayerInfo",null),__decorate([up(2)],e.prototype,"upPersonalMatch",null),__decorate([down(2,[3,3,ByteConst.CrossArenaRoleVos])],e.prototype,"downTeamInfo",null),__decorate([up(3)],e.prototype,"upLeaveTeam",null),__decorate([up(4)],e.prototype,"upStartMacth",null),__decorate([up(16)],e.prototype,"upCancelMacth",null),__decorate([up(20,[3])],e.prototype,"upGuilds",null),__decorate([up(5,[3])],e.prototype,"upInvite",null),__decorate([down(5,ByteConst.CrossArenaInviteVos.slice())],e.prototype,"downReceiveInvitation",null),__decorate([up(6)],e.prototype,"upWorldInvite",null),__decorate([up(7,[3,3])],e.prototype,"upRespondInvite",null),__decorate([down(7,[3])],e.prototype,"downBack",null),__decorate([down(16,[3])],e.prototype,"downMacthState",null),__decorate([down(20,[3,ByteConst.UnionMemberInfoVos])],e.prototype,"downKfArenaGuilds",null),__decorate([up(18,[3])],e.prototype,"upJoinTeam",null),__decorate([up(8,[3])],e.prototype,"upOutTeam",null),__decorate([down(9,[10,3])],e.prototype,"downRefFlag",null),__decorate([down(10,[10,3,0,1])],e.prototype,"downCollectFlag",null),__decorate([up(10)],e.prototype,"upCollectFlag",null),__decorate([down(11,[3,10])],e.prototype,"downRelive",null),__decorate([down(13,[3,3,1,3,3,1])],e.prototype,"downFbInfo",null),__decorate([down(14,[3,3,2,ByteConst.CrossArenaBaseVos,ByteConst.RewardVos])],e.prototype,"downResult",null),__decorate([up(15)],e.prototype,"upEnterBattle",null),__decorate([down(17,[3,3])],e.prototype,"downChangeScore",null),__decorate([down(19,[ByteConst.CrossArenaVos])],e.prototype,"downDataInfo",null),__decorate([up(19)],e.prototype,"upDataInfo",null),__decorate([down(21,[8])],e.prototype,"downNotice",null),__decorate([down(22,[2,2])],e.prototype,"downMyBattleInfo",null),__decorate([down(25,[ByteConst.CrossArenaRankVos,3])],e.prototype,"downRank",null),__decorate([up(25)],e.prototype,"upRank",null),__decorate([up(23)],e.prototype,"upDailyRewards",null),__decorate([up(24,[3])],e.prototype,"upJoinRewards",null),__decorate([down(23,[3,3,3,3,3])],e.prototype,"downJoinRewards",null),__decorate([down(26,[3,3])],e.prototype,"downOpenKfArena",null),__decorate([up(26)],e.prototype,"upReceiveAwardDuan",null),__decorate([down(27,[0])],e.prototype,"downReConnection",null),__decorate([up(27)],e.prototype,"upReConnect",null),__decorate([up(28)],e.prototype,"upCancelReConnect",null),e=i=__decorate([protocolsId(65)],e);
var i}(BaseSystem);__reflect(CrossArenaControl.prototype,"CrossArenaControl");var AmusementType3DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dabiao=[],e.chongzhiNum=0,e.chongzhiTotal=0,e.btn1=!1,e.btn2=!1,e.image1=!1,e.image2=!1,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.dabiao=[];for(var e=0;e<t[0].length;e++)this.dabiao.push(t[0][e]);this.chongzhiNum=t[1],this.chongzhiTotal=t[2],this.recrod=t[3]},e.prototype.updateAmusement=function(t){this.recrod=t[1]},e.prototype.openDay=function(){var t=DataCenter.ins().Amusement3Config[this.id];return t&&t[0]?t[0].day:7},e.prototype.canReward=function(){var t=DataCenter.ins().Amusement3Config[this.id],e=this.recrod,i=-1,n=0;for(var o in t){var s=e>>t[o].index&1;if(1==t[o].type){if(this.dabiao[n]>=t[o].day&&0==s)return!0}else if(2==t[o].type&&t[o].val<=this.chongzhiTotal){if(0==s)return!0}else if(3==t[o].type&&t[o].val<=this.chongzhiNum&&(-1==i&&(i=this.getCurIndex(3)),i==t[o].index&&0==s))return!0;n++}return this.canRewardEx()},e.prototype.updateAmusementExt=function(t){this.dabiao=[];for(var e=0;e<t[0].length;e++)this.dabiao.push(t[0][e]);this.chongzhiNum=t[1],this.chongzhiTotal=t[2]},Object.defineProperty(e.prototype,"day7text",{get:function(){var t=DataCenter.ins().Amusement3Config[this.id];for(var e in t)1==t[e].type&&(this.rewards1=t[e].rewards,this._day7text=LangMgr.getValueByKey("activitShow1","<font color='#ffff00'>"+t[e].day+"</font>","<font color='#ffff00'>"+t[e].val+"</font>"));return this._day7text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totaltext",{get:function(){var t=DataCenter.ins().Amusement3Config[this.id];for(var e in t)2==t[e].type&&(this.maxTotal=t[e].val,this.rewards2=t[e].rewards,this._totaltext=LangMgr.getValueByKey("activitShow1","<font color='#ffff00'>"+t[e].val+"</font>"));return this._totaltext},enumerable:!0,configurable:!0}),e.prototype.canOnlyReward=function(){var t=DataCenter.ins().Amusement3Config[this.id],e=this.recrod;this.btn1=!1,this.btn2=!1,this.image1=!1,this.image2=!1;for(var i in t){var n=e>>t[i].index&1;1==t[i].type&&this.dabiao&&this.dabiao[0]>=t[i].day&&(0==n&&(this.btn1=!0),1==n&&(this.image1=!0)),2==t[i].type&&t[i].val<=this.chongzhiTotal&&(0==n&&(this.btn2=!0),1==n&&(this.image2=!0))}},e.prototype.getDateTime=function(t){var e=t.split(/[-,.,:]/g),i=new Date(+e[0],+e[1]-1,+e[2],+e[3]||0,+e[4]||0);return i.getTime()},e.prototype.isOverTimer=function(t){var e=this.curOpenDay(),i=DataCenter.ins().Amusement3Config[this.id][t],n=this.recrod>>i.index&1;return e+1>i.day&&n!=AmusementControl.Geted},e.prototype.curOpenDay=function(){var t=DataCenter.ins().AmusementConfig[this.id],e=0;if(0==t.timeType){var i=+t.startTime.split("-")[0];e=GameServer.serverOpenDay-i}else if(1==t.timeType){var i=GameServer.serverTime,n=this.getDateTime(t.startTime);this.getDateTime(t.endTime);e=Math.floor((i-n)/1e3/3600/24)}else if(2==t.timeType){var i=+t.startTime.split("-")[0],n=Math.floor((GameServer.serverTime-DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime))/1e3/3600/24);e=n-i}return e},e.prototype.getCurIndex=function(t){var e=(DataCenter.ins().AmusementConfig[this.id],DataCenter.ins().Amusement3Config[this.id]),i=this.curOpenDay(),n={};for(var o in e)n[e[o].type]=1;var s=Object.keys(n);(1==s.length||void 0==t)&&(t=+s[0]);var r,a=[];for(r in e)e[r].type==t&&a.push(e[r]);a.sort(function(t,e){return t.day<e.day?-1:1});for(var l=0,h=a;l<h.length;l++){var u=h[l];if(r=u.index,1==t||2==t){if(i<u.day)return+r}else if(3==t&&i<u.day)return+r}return+r},e.prototype.getLeftTime=function(){if(this.endTime){var t=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return 0>t&&(t=0),t}return 0},e.prototype.getRewardStateById=function(t){var e=DataCenter.ins().Amusement3Config[this.id][t];switch(e.showType){case 6:case 8:case 9:if(this.chongzhiTotal<e.val)return AmusementControl.NotReached;break;case 7:if(this.dabiao[t-1]<e.day)return AmusementControl.NotReached}var i=this.recrod>>e.index&1;return i?AmusementControl.Geted:AmusementControl.CanGet},e.prototype.canRewardEx=function(){var t=DataCenter.ins().Amusement3Config[this.id];if(t&&t[1]&&t[1].activityID)for(var e=0;e<t[1].activityID.length;e++){var i=amusementControl.getAmusementDataById(t[1].activityID[e]);if(i&&i.canReward())return!0}return!1},e}(AmusementBaseDataVo);__reflect(AmusementType3DataVo.prototype,"AmusementType3DataVo");var CrossArenaInviteVo=function(){function t(){}return t.prototype.init=function(t){this.roleId=t[0],this.name=t[1],this.power=t[2],this.score=t[3],this.winRate=t[4]/100},t}();__reflect(CrossArenaInviteVo.prototype,"CrossArenaInviteVo");var WelfareControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isOpen=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e}(BaseSystem);__reflect(WelfareControl.prototype,"WelfareControl");var CrossArenaRankVo=function(){function t(){}return t.prototype.init=function(t){this.rank=t[0],this.playerId=t[1],this.score=t[2],this.vip=t[3],this.playerName=t[4],this.dan=t[5],this.servId=t[6]},t}();__reflect(CrossArenaRankVo.prototype,"CrossArenaRankVo");var CrossArenaRoleVo=function(){function t(){this.curMonth=new CrossArenaMarkVo,this.history=new CrossArenaMarkVo,this.power=0,this.winRate=0,this.thirteenEquipLv=0}return t.prototype.init=function(t){this.roleID=t[0],this.serverId=t[1],this.isonline=0!=t[2],this.duanLevel=t[3],this.score=t[4],this.curMonth.init([t[5],t[6],t[7]]),this.history.init([t[8],t[9],t[10]]),this.power=t[11],this.winRate=t[12]/100,this.roleName=t[13],this.job=t[14],this.sex=t[15],this.cloth=t[16],this.weapon=t[17],this.wingLv=t[18],this.wingState=t[19],this.pos1=t[20],this.pos2=t[21],this.pos3=t[22],this.zs=t[23],this.lv=t[24],this.thirteenEquipLv=t[25],this.weaponViewType=t[26],this.weaponViewId=t[27],this.clothesViewType=t[28],this.clothesViewId=t[29]},t.prototype.toSubRole=function(){var t=new RankSubRoleVo;return t.job=this.job,t.sex=this.sex,t.clothID=this.cloth,t.swordID=this.weapon,t.pos1=this.pos1,t.pos2=this.pos2,t.pos3=this.pos3,t.wingLevel=this.wingLv,t.thirteenEquipLv=this.thirteenEquipLv,t.weaponViewType=this.weaponViewType,t.weaponViewId=this.weaponViewId,t.clothesViewType=this.clothesViewType,t.clothesViewId=this.clothesViewId,t},t.prototype.isLeader=function(){return crossArenaControl.leaderID==this.roleID},t}();__reflect(CrossArenaRoleVo.prototype,"CrossArenaRoleVo");var CrossArenaMarkVo=function(){function t(){}return t.prototype.init=function(t){this.win=t[0],this.ping=t[1],this.fail=t[2]},t}();__reflect(CrossArenaMarkVo.prototype,"CrossArenaMarkVo");var CrossArenaPeakAwards=function(){function t(){}return t}();__reflect(CrossArenaPeakAwards.prototype,"CrossArenaPeakAwards");var CrossArenaEveryDayAwards=function(){function t(){}return t}();__reflect(CrossArenaEveryDayAwards.prototype,"CrossArenaEveryDayAwards");var CrossArenaFinalAwards=function(){function t(){}return t}();__reflect(CrossArenaFinalAwards.prototype,"CrossArenaFinalAwards");var CrossArenaMailData=function(){function t(){}return t}();__reflect(CrossArenaMailData.prototype,"CrossArenaMailData");var CrossArenaPeakInfo=function(){function t(){}return t}();__reflect(CrossArenaPeakInfo.prototype,"CrossArenaPeakInfo");var CrossArenaRankAwardInfo=function(){function t(){}return t}();__reflect(CrossArenaRankAwardInfo.prototype,"CrossArenaRankAwardInfo");var CrossArenaVo=function(){function t(){this.killNum=0,this.aidNum=0,this.collectNum=0,this.curScore=0,this.curGetScore=0,this.totalScore=0,this.arenaScore=0}return t.prototype.initData=function(t){this.servId=t[0],this.campId=t[1],this.actorid=t[2],this.playerName=t[3],this.killNum=t[4],this.aidNum=t[5],this.collectNum=t[6],this.curScore=t[7],this.curGetScore=t[8],this.totalScore=t[9],this.arenaScore=t[10],this.isFirstKiller=t[11],this.isFirstCollect=t[12],this.isMvp=t[13],this.isOnWin=t[14],this.isDeserter=t[15]},t.prototype.initRankData=function(t){this.servId=t[0],this.campId=t[1],this.actorid=t[2],this.playerName=t[3],this.killNum=t[4],this.aidNum=t[5],this.collectNum=t[6],this.curScore=t[7],this.totalScore=t[8]},t}();__reflect(CrossArenaVo.prototype,"CrossArenaVo");var CrossArenaCheckView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossArenaCheckViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.outBtn,this.onTouch),this.addEventTouchTap(this.checkBtn,this.onTouch),this.data=t[0],this.update()},e.prototype.update=function(){this.currentState=crossArenaControl.isTFCaptain?"normal":"check",this.nameLab.text=this.data.roleName,this.powerLab.text=LangMgr.getValueByKey("kfTips12",CommonUtils.overLength(this.data.power)),this.scoreLab.text=LangMgr.getValueByKey("kfTips13",this.data.score),this.winRateLab.text=LangMgr.getValueByKey("kfTips14",this.data.winRate),this.face.source="head_"+this.data.job+this.data.sex},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:break;case this.outBtn:crossArenaControl.upOutTeam(this.data.roleID);break;case this.checkBtn:rankOtherUserControl.upFindPlayer(this.data.roleID,this.data.serverId)}UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CrossArenaCheckView.prototype,"CrossArenaCheckView");var CrossArenaFightView=function(t){function e(){var e=t.call(this)||this;return e.lastTips=!1,e.lastAScoreTip=!1,e.lastBScoreTip=!1,e.skinName="CrossArenaFightViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.bigTimeGroup.visible=!0,this.showCollectTip(!1),this.teamList.itemRenderer=CrossArenaTeamItemRenderer,this.teamDt=new eui.ArrayCollection,this.teamList.dataProvider=this.teamDt,this.canAttackList.itemRenderer=CrossArenaTeamItemRenderer,this.bookList.itemRenderer=TargetMemberHeadItemRender,this.list2Dt=new eui.ArrayCollection,this.list2Dt.source=targetListControl.canAttackHandles,this.canAttackList.dataProvider=this.list2Dt,this.bookDt=new eui.ArrayCollection,this.bookList.dataProvider=this.bookDt},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.modeSys=CrossArenaControl.ins(),this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventTouchTap(this.infoBtn,this.onTouch),this.addCustomEvent(319,this.upScore),this.addCustomEvent(322,this.updata),this.addCustomEvent(317,this.refBook),this.addCustomEvent(354,this.upTeam),this.addCustomEvent(474,this.upTeam),this.addCustomEvent(356,this.onRemove),this.addCustomEvent(355,this.onHpchange),this.addCustomEvent(9,this.transferFun),this.addCustomEvent(478,this.openOtherPlayerView),this.addCustomEvent(542,this.updateCanAttackList),this.startTime=t[0],this.endTimeStamp=t[1],this.startCountDown(this.startTime),this.upScore(),this.updata(),this.upTeam()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.teamList.numElements;i++){var n=this.teamList.getElementAt(i);n&&n.close()}for(var i=0;i<this.canAttackList.numElements;i++){var n=this.canAttackList.getElementAt(i);n&&n.close()}TimerMgr.ins().removeAll(this)},e.prototype.refBook=function(){var t=this,e=crossArenaControl.flagCD-egret.getTimer()/1e3>>0;e>0?TimerMgr.ins().doTimer(1e3,e+1,function(){t.bookDt.replaceAll([crossArenaControl.flagHandle])},this):this.bookDt.replaceAll([crossArenaControl.flagHandle])},e.prototype.openOtherPlayerView=function(t){var e=UIMgr.ins().open(RankRoleView,t);e.hideEx(2)},e.prototype.upTeam=function(){var t=UnitMgr.ins().getAllEntity(),e=[],i={};for(var n in t){var o=t[n].infoModel;o.camp!=crossArenaControl.myCampId||o.isMy||(i[o.masterHandle]=o,e[Object.keys(i).length-1]=i[o.masterHandle])}this.teamDt.length||this.modeSys.upDataInfo(),this.teamDt.replaceAll(e)},e.prototype.onRemove=function(t){var e=(t[0],t[1]);e instanceof UnitRole&&e.infoModel.camp==crossArenaControl.myCampId&&this.upTeam()},e.prototype.updata=function(){this.score.text=this.modeSys.ownScore+"",this.rank.text=this.modeSys.ownBattleRank+""},e.prototype.onHpchange=function(t){var e=t[0];if(!e.isMy){for(var i=0;i<this.teamList.numElements;i++){var n=this.teamList.getElementAt(i);if(n&&e.infoModel==n.data){n.upHp();break}}for(var i=0;i<this.canAttackList.numElements;i++){var n=this.canAttackList.getElementAt(i);if(n&&e.infoModel.masterHandle==n.data){n.upHp();break}}}},e.prototype.upScore=function(){1==this.modeSys.myCampId?(this.blueScore.text=this.modeSys.scoreA+"",this.redScore.text=this.modeSys.scoreB+""):(this.blueScore.text=this.modeSys.scoreB+"",this.redScore.text=this.modeSys.scoreA+""),DataCenter.ins().CrossArenaBaseConfig.tipScore||(DataCenter.ins().CrossArenaBaseConfig.tipScore=800),!this.lastAScoreTip&&this.modeSys.scoreA>=DataCenter.ins().CrossArenaBaseConfig.tipScore?(this.showScoreTip(1==this.modeSys.myCampId?1:2,this.modeSys.scoreA),this.lastAScoreTip=!0):!this.lastBScoreTip&&this.modeSys.scoreB>=DataCenter.ins().CrossArenaBaseConfig.tipScore&&(this.showScoreTip(1==this.modeSys.myCampId?2:1,this.modeSys.scoreB),this.lastBScoreTip=!0)},e.prototype.showScoreTip=function(t,e){this.hintImg.source=1==t?"kfarena_words_win_friend":"kfarena_words_win_enemy",this.bigTimeGroup.visible=!0,this.countDown.text=e+"",TimerMgr.ins().doTimer(5e3,1,this.hideEnd,this)},e.prototype.onTouch=function(t){switch(t.target){case this.seeRule:HelpControl.openHelpWin(42);break;case this.infoBtn:UIMgr.ins().open(CrossArenaInfoView)}},e.prototype.startCountDown=function(t){this.txtPrepare.visible=!0,this.leftTime.visible=!1,this.startTime=egret.getTimer()+1e3*t,this.hintImg.source="kfarena_words_start",this.timeGo(),t>0&&(TimerMgr.ins().isExists(this.timeGo,this)||(this.bigTimeGroup.visible=!0,TimerMgr.ins().doTimer(1e3,0,this.timeGo,this)))},e.prototype.timeGo=function(){var t=(this.startTime-egret.getTimer())/1e3>>0;if(t>0)this.countDown.text=t+"";else{TimerMgr.ins().remove(this.timeGo,this),this.bigTimeGroup.visible=!1,this.showCollectTip(!0),this.txtPrepare.visible=!1,this.leftTime.visible=!0;var e=(DateUtils.formatMiniDateTime(this.endTimeStamp)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0;e>0&&!TimerMgr.ins().isExists(this.lefttimeFun,this)&&TimerMgr.ins().doTimer(1e3,0,this.lefttimeFun,this)}},e.prototype.lefttimeFun=function(){var t=(DateUtils.formatMiniDateTime(this.endTimeStamp)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0;0>t?TimerMgr.ins().removeAll(this):(this.leftTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3),!this.lastTips&&10>=t&&(this.lastTips=!0,this.countDown.text=t+"",this.hintImg.source="kfarena_words_end",this.bigTimeGroup.visible=!0,TimerMgr.ins().doTimer(5e3,1,this.hideEnd,this)))},e.prototype.hideEnd=function(){this.bigTimeGroup.visible=!1},e.prototype.transferFun=function(){this.showCollectTip(!1)},e.prototype.showCollectTip=function(t){this.collectBookTip.visible=t},e.prototype.updateCanAttackList=function(){var t=targetListControl.canAttackHandles;this.canAttackBar.visible=t.length>0,this.canAttackBar.visible&&this.list2Dt.replaceAll(targetListControl.canAttackHandles)},e}(BaseEuiView);__reflect(CrossArenaFightView.prototype,"CrossArenaFightView");var CrossArenaInfoView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossArenaInfoViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=CrossArenaInfoItemRenderer,this.itemDt=new eui.ArrayCollection,this.list.dataProvider=this.itemDt},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.sureBtn,this.onTouch),this.addCustomEvent(320,this.updata),crossArenaControl.upDataInfo()},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:case this.sureBtn:UIMgr.ins().close(this)}},e.prototype.updata=function(t){var e=CrossArenaControl.ins();1==e.myCampId?(this.blueScore.text=e.scoreA+"",this.redScore.text=e.scoreB+""):(this.blueScore.text=e.scoreB+"",this.redScore.text=e.scoreA+""),this.itemDt.replaceAll(t)},e}(BaseEuiView);__reflect(CrossArenaInfoView.prototype,"CrossArenaInfoView");var CrossArenaInviteView=function(t){function e(){var e=t.call(this)||this;return e.friendList=[],e.guildList=[],e.type=0,e.cdTime=30,e.skinName="CrossArenaInviteViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.listView.itemRenderer=CrossArenaMemberItemRenderer,this.worldInvite.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.worldInvite.text+"</u>"),this.listArray=new eui.ArrayCollection,this.listView.dataProvider=this.listArray,this.tab.itemRenderer=CrossArenaTabItemRenderer,this.tipsShow.text=LangMgr.getValueByKey("crossAreTips",DataCenter.ins().CrossArenaBaseConfig.teamScoreRange),this.updateTabRedPt(),this.tab.selectedIndex=0,this.addEventTouchTap(this.closeBtn0,this.onTouch),this.addEventTouchTap(this.worldInvite,this.onTouch),this.addEventTouchTap(this.tab,this.onTabClick),this.addCustomEvent(321,this.updateGuild),this.type=0,crossArenaControl.upGuilds(0),crossArenaControl.upGuilds(1)},e.prototype.updateGuild=function(t){switch(t){case 0:this.friendList=crossArenaControl.getDataList(t);break;case 1:this.guildList=crossArenaControl.getDataList(t)}this.setType(this.type)},e.prototype.onTabClick=function(t){void 0===t&&(t=null),this.setType(this.tab.selectedIndex)},e.prototype.updateTabRedPt=function(){this.tab.dataProvider=new ArrayCollection([LangMgr.getValueByKey("kfTips15"),LangMgr.getValueByKey("kfTips16")])},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn0:UIMgr.ins().close(this);break;case this.worldInvite:var e=egret.getTimer(),i=(crossArenaControl.worldTimeCd-e)/1e3>>0;i>0?tipsControl.showTips(LangMgr.getValueByKey("kfTips17",i)):(crossArenaControl.worldTimeCd=e+1e3*this.cdTime,crossArenaControl.upWorldInvite(),tipsControl.showTips(LangMgr.getValueByKey("kfTips18")))}},e.prototype.setType=function(t){switch(this.type=t,t){case 0:this.listArray.source=this.friendList,this.noPlayer.visible=0==this.friendList.length;break;case 1:this.listArray.source=this.guildList,this.noPlayer.visible=0==this.guildList.length}},e}(BaseEuiView);__reflect(CrossArenaInviteView.prototype,"CrossArenaInviteView");var CrossArenaJoinPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("kfTips19"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){this.listArray=new eui.ArrayCollection,this.list.itemRenderer=CrossArenaJoinItemRenderer,this.list.dataProvider=this.listArray},e.prototype.open=function(){this.addCustomEvent(323,this.update),this.update()},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.update=function(){var t=DataCenter.ins().CrossArenaBaseConfig.peakAwards,e=[],i=1;for(var n in t)t[n].id=i,t[n].sortIndex=1,1==(crossArenaControl.dflState>>i&1)?t[n].sortIndex=0:CrossArenaRedPoint.ins().JoinRedPoint.length>0&&CrossArenaRedPoint.ins().JoinRedPoint[i]>0&&(t[n].sortIndex=2),e.push(t[n]),i++;e.sort(this.sort),this.listArray.source=e,this.myRecord.text=crossArenaControl.dflCount.toString()},e.prototype.sort=function(t,e){var i=SortUtils.sortDescByKey(t.sortIndex,e.sortIndex);return 0==i&&(i=SortUtils.sortAscByKey(t.id,e.id)),i},e}(BasePanel);__reflect(CrossArenaJoinPanel.prototype,"CrossArenaJoinPanel");var CrossArenaMacthPanel=function(t){function e(){var e=t.call(this)||this;return e.radius=0,e.isSingleMatch=0,e.name=LangMgr.getValueByKey("kfTips20"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.rewards=new eui.ArrayCollection,this.rewardList.itemRenderer=ItemBase,this.rewardList.dataProvider=this.rewards,this.initUI()},e.prototype.initUI=function(){this.memberArr=[this.leader,this.member1,this.member2],this.cirleMask=new egret.Shape,this.radius=this.cirleGroup.width>>1,this.cirleMask.x=this.cirleMask.y=this.radius,this.cirleMask.rotation=120,this.cirleGroup.addChild(this.cirleMask),this.progressImg.mask=this.cirleMask,this.showAwardLabel.textFlow=(new egret.HtmlTextParser).parser("<a href='event:' ><u>"+this.showAwardLabel.text+"</u></a>")},e.prototype.open=function(){this.addEventTouchTap(this.rewardList,this.receiveAwardFun),this.addEventTouchTap(this.disBtn,this.onTouch),this.addEventTouchTap(this.macthBtn,this.onTouch),this.addEventTouchTap(this.showAwardLabel,this.onTouch),this.addCustomEvent(315,this.updateInfo),this.addCustomEvent(316,this.update),this.addCustomEvent(318,this.update),this.addCustomEvent(323,this.refAward),this.update(),this.refAward()},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.receiveAwardFun=function(){crossArenaControl.upReceiveAwardDuan()},e.prototype.refAward=function(){var t=this,e=2,i=crossArenaControl.awardDuan>=e?crossArenaControl.awardDuan+1:e;DataCenter.ins().CrossArenaMetReachAwardConfig[i]?this.rewards.replaceAll(DataCenter.ins().CrossArenaMetReachAwardConfig[i].award):this.rewards.replaceAll(DataCenter.ins().CrossArenaMetReachAwardConfig[--i].award),TimerMgr.ins().doTimer(100,1,function(){if(crossArenaControl.duanLevel>crossArenaControl.awardDuan&&crossArenaControl.duanLevel>=e){for(var i=0;i<t.rewardList.numChildren;i++){var n=t.rewardList.getChildAt(i);n.redPoint.visible=!0}t.rewardList.touchChildren=!1}else t.rewardList.touchChildren=!0},this)},e.prototype.update=function(){this.updateMember(),this.updateInfo(),this.updateBtnState()},e.prototype.updateMember=function(){this.roleGroup.visible=crossArenaControl.getIsJoinTeam();for(var t=0,e=this.memberArr;t<e.length;t++){var i=e[t];i.data=null}var n=crossArenaControl.tfMembers,o=1;if(n&&n.length)for(var s=0;s<n.length;s++){var r=n[s],a=r.isLeader();a?this.leader.data=r:(this.memberArr[o].data=r,o++)}},e.prototype.updateInfo=function(){this.curMonthLabel.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("kfArenaWinInfo",crossArenaControl.curMouth.win,crossArenaControl.curMouth.ping,crossArenaControl.curMouth.fail)),this.winRateLbl.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("kfArenaWinRate",crossArenaControl.getWinRate())),this.countLabel.text=""+crossArenaControl.times,this.macthingLabel.visible=1==crossArenaControl.macthState,this.duanTxt.text=crossArenaControl.getDuanName(),this.duanImg.source="kfarena_rank_img_"+((crossArenaControl.duanLevel-1)/3>>0);var t=Math.max(crossArenaControl.awardDuan,crossArenaControl.duanLevel),e=DataCenter.ins().CrossArenaBaseConfig.scoreMetal[t];if(e){this.scoreProgressTxt.text=crossArenaControl.score+"/"+e;var i=LangMgr.getValueByKey("kfArenaScoreTip",e-crossArenaControl.score,crossArenaControl.getDuanName(t+1));this.nextDuanTxt.textFlow=TextUtils.generateTextFlow1(i)}else e=DataCenter.ins().CrossArenaBaseConfig.scoreMetal[crossArenaControl.duanLevel-1],this.scoreProgressTxt.text=crossArenaControl.score+"/"+e,this.nextDuanTxt.text=LangMgr.getValueByKey("kfArenaDuanMax");this.setScorePro(crossArenaControl.score/e*300>>0)},e.prototype.setScorePro=function(t){t=t>300?300:t,DisplayUtils.drawCir(this.cirleMask,this.radius,t)},e.prototype.updateBtnState=function(){var t=crossArenaControl.getIsJoinTeam();this.waitGroup.visible=!t,this.matchGroup.visible=t,t?(this.currentState="player"+DataCenter.ins().CrossArenaBaseConfig.maxJoinPerson,crossArenaControl.isTFCaptain?this.disBtn.label=LangMgr.getValueByKey("kfTips26"):this.disBtn.label=LangMgr.getValueByKey("kfTips27"),1==crossArenaControl.macthState?this.macthBtn.label=LangMgr.getValueByKey("kfTips28"):this.macthBtn.label=LangMgr.getValueByKey("kfTips29")):(this.isSingleMatch=0,this.disBtn.label=LangMgr.getValueByKey("kfTips24"),this.macthBtn.label=LangMgr.getValueByKey("kfTips25"))},e.prototype.onTouch=function(t){switch(t.target){case this.disBtn:if(0==crossArenaControl.isStartIng)return void tipsControl.showCenterTips(DataCenter.ins().CrossArenaBaseConfig.hintTxt);if(!crossArenaControl.getIsJoinTeam())return this.isSingleMatch=0,void crossArenaControl.upCreateTeam();crossArenaControl.upLeaveTeam();break;case this.showAwardLabel:UIMgr.ins().open(CrossArenaMetalRankView);break;case this.macthBtn:if(1==crossArenaControl.macthState)return crossArenaControl.isTFCaptain?void crossArenaControl.upCancelMacth():void tipsControl.showCenterTips(LangMgr.getValueByKey("kfTips31"));if(0==crossArenaControl.isStartIng)return void tipsControl.showCenterTips(DataCenter.ins().CrossArenaBaseConfig.hintTxt);if(!crossArenaControl.getIsJoinTeam())return this.isSingleMatch=1,void crossArenaControl.upPersonalMatch();if(!crossArenaControl.isTFCaptain)return void tipsControl.showCenterTips(LangMgr.getValueByKey("kfTips97"));var e=crossArenaControl.getIsNoOnline();if(""!=e)return void tipsControl.showCenterTips(e+LangMgr.getValueByKey("kfArenaOffLine"));var i=crossArenaControl.tfMembers;1==this.isSingleMatch&&1==i.length||i&&i.length==DataCenter.ins().CrossArenaBaseConfig.maxJoinPerson?crossArenaControl.upStartMacth():tipsControl.showCenterTips(LangMgr.getValueByKey("kfplayernumtips"))}},e}(BasePanel);__reflect(CrossArenaMacthPanel.prototype,"CrossArenaMacthPanel");var CrossArenaMetalRankView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossArenaMetalRankViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.rewards=new eui.ArrayCollection,this.awardList.itemRenderer=CrossArenaMetalRankItemRenderer,this.awardList.dataProvider=this.rewards},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch);var i=CommonUtils.objectToArrayShallow(DataCenter.ins().CrossArenaMetReachAwardConfig);i.reverse(),this.rewards.source=i},e.prototype.onTouch=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CrossArenaMetalRankView.prototype,"CrossArenaMetalRankView");var CrossArenaRankPanel=function(t){function e(){var e=t.call(this)||this;return e.fristView=!1,e.name=LangMgr.getValueByKey("kfTips32"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=CrossArenaRankItemRenderer,this.rankDatas=new eui.ArrayCollection,this.list.dataProvider=this.rankDatas,this.rank0.index=0,this.rank1.index=1,this.rank2.index=2,this.firstGroup.visible=!1,this.firstGroup.touchChildren=!1,this.state.visible=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(325,this.upData),this.addCustomEvent(478,this.openOtherPlayer),this.addEventTouchTap(this.list,this.onViewPlayer),this.addEventTouchTap(this.firstGroup,this.onViewPlayer),crossArenaControl.upRank()},e.prototype.close=function(){this.removeCustomEvents(),this.rank0.data=null,this.rank1.data=null,this.rank2.data=null,this.firstGroup.visible=!1,this.firstGroup.touchChildren=!1,this.state.visible=!0,this.fristView=!1},e.prototype.upData=function(){this.firstData=crossArenaControl.rankDataList.shift(),this.rankDatas.replaceAll(crossArenaControl.rankDataList),this.selfPos0.text=crossArenaControl.ownRank>0?crossArenaControl.ownRank.toString():LangMgr.getValueByKey("guanNoRank"),this.firstData&&(this.firstGroup.visible=!0,this.state.visible=!1,this.serverId0.text="S"+this.firstData.servId,this.firstNameTxt0.text=this.firstData.playerName,this.score0.text=this.firstData.score+"",this.seasonTitle0.text=DataCenter.ins().CrossArenaBaseConfig.scoreMetalName[this.firstData.dan-1],rankOtherUserControl.upFindPlayer(this.firstData.playerId,this.firstData.servId))},e.prototype.onViewPlayer=function(t){if(t.target==this.firstGroup&&this.firstData)rankOtherUserControl.upFindPlayer(this.firstData.playerId,this.firstData.servId);else if(t.target instanceof CrossArenaRankItemRenderer){var e=this.list.selectedItem;e&&rankOtherUserControl.upFindPlayer(e.playerId,e.servId)}},e.prototype.openOtherPlayer=function(t){if(this.fristView){var e=UIMgr.ins().open(RankRoleView,t);e.hideEx(2)}else this.rank0.data={otherPlayerData:t},this.rank1.data={otherPlayerData:t},this.rank2.data={otherPlayerData:t},this.fristView=!0},e}(BasePanel);__reflect(CrossArenaRankPanel.prototype,"CrossArenaRankPanel");var CrossArenaReceiveInviteView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossArenaReceiveInviteViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],this.inviteData=crossArenaControl.inviteDataList[this.index],this.addEventTouchTap(this.notBtn,this.onTouch),this.addEventTouchTap(this.sureBtn,this.onTouch),this.update()},e.prototype.update=function(){this.nameLabel.text=this.inviteData.name,this.powerLabel.text=LangMgr.getValueByKey("kfTips12",CommonUtils.overLengthNo(this.inviteData.power)),this.scoreLabel.text=LangMgr.getValueByKey("kfTips13",this.inviteData.score),this.winRateLabel.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("KfArenaWinRate1",this.inviteData.winRate))},e.prototype.onTouch=function(t){switch(t.target){case this.notBtn:crossArenaControl.upRespondInvite(this.inviteData.roleId,0),crossArenaControl.inviteDataList.slice(this.index,1),UIMgr.ins().close(this);break;case this.sureBtn:crossArenaControl.upRespondInvite(this.inviteData.roleId,1),crossArenaControl.inviteDataList.slice(this.index,1),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(CrossArenaReceiveInviteView.prototype,"CrossArenaReceiveInviteView");var CrossArenaReConnectView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="CrossArenaReConnectViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.fun1=t[0],this.fun2=t[1],this.addEventTouchTap(this.closeBg,this.onTouch),this.addEventTouchTap(this.yesBtn,this.onTouch),this.addEventTouchTap(this.noBtn,this.onTouch),this.time=11,this.enterTime.visible=!0,this.yesBtn.enabled=!1,TimerMgr.ins().doTimer(1e3,this.time,this.onTime,this),this.onTime()},e.prototype.onTime=function(){this.time--,this.time<=0&&(this.enterTime.visible=!1,this.yesBtn.enabled=!0),this.enterTime.text=LangMgr.getValueByKey("crossArenaReConnect2",this.time)},e.prototype.onTouch=function(t){var e=this;switch(t.target){case this.closeBg:break;case this.yesBtn:this.fun1&&this.fun1(),UIMgr.ins().close(this);break;case this.noBtn:this.time>0?warnControl.show(LangMgr.getValueByKey("crossArenaReConnect1",this.time),function(){e.fun2&&e.fun2(),UIMgr.ins().close(e)},this,function(){},this):(this.fun2&&this.fun2(),UIMgr.ins().close(this))}},e}(BaseEuiView);__reflect(CrossArenaReConnectView.prototype,"CrossArenaReConnectView");var CrossArenaResultView=function(t){function e(){var e=t.call(this)||this;return e.QUIT_T=30,e.skinName="CrossArenaResultViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.extrReward.itemRenderer=ItemBase,this.list.itemRenderer=CrossArenaResultDataItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.sureBtn,this.onTouch);var i=t[0],n=t[1],o=t[2],s=t[3],r=t[4];3==i?(this.blueResult.source="tag_draw",this.redResult.source="tag_draw",this.loseMask0.visible=!1,this.loseMask1.visible=!1):crossArenaControl.myCampId==i?(this.blueResult.source="tag_win",this.redResult.source="tag_lose",this.loseMask0.visible=!1,this.loseMask1.visible=!0):(this.blueResult.source="tag_lose",this.redResult.source="tag_win",this.loseMask0.visible=!0,this.loseMask1.visible=!1),1==crossArenaControl.myCampId?(this.blueScore.text=n+"",this.redScore.text=o+""):(this.blueScore.text=o+"",this.redScore.text=n+""),this.list.dataProvider=new eui.ArrayCollection(s),this.extrReward.dataProvider=new eui.ArrayCollection(r),this.quitTime=egret.getTimer()+1e3*this.QUIT_T,TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this);
var a=Math.max(crossArenaControl.awardDuan,crossArenaControl.duanLevel),l=DataCenter.ins().CrossArenaBaseConfig.scoreMetal[a];if(l){var h=LangMgr.getValueByKey("kfArenaScoreTip",l-crossArenaControl.score,crossArenaControl.getDuanName(a+1));this.nextMetalLabel.textFlow=TextUtils.generateTextFlow1(h)}else this.nextMetalLabel.visible=!1},e.prototype.onTouch=function(t){switch(t.target){case this.sureBtn:this.onExit()}},e.prototype.onTime=function(){var t=(this.quitTime-egret.getTimer())/1e3>>0;t>0?this.leaveInfo.text=LangMgr.getValueByKey("kfTips33",t):(this.onExit(),TimerMgr.ins().remove(this.onTime,this))},e.prototype.onExit=function(){copyControl.upExitFb(),UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CrossArenaResultView.prototype,"CrossArenaResultView");var CrossArenaRewardPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("loadderDan"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listArray=new eui.ArrayCollection,this.list.itemRenderer=CrossArenaRewardItemRenderer,this.rewardList.touchChildren=!1,this.list.dataProvider=this.listArray,this.rewardList.itemRenderer=ItemBaseNoName,this.degree.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.degree.text+"</u>")},e.prototype.open=function(){this.addEventTouchTap(this.rewardList,this.onTouch),this.addEventTouchTap(this.degree,this.onTouch),this.addCustomEvent(545,this.update),this.update()},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.update=function(){var t=crossArenaControl.getDuanAwards();for(var e in t)t[e].isRedPoint=CrossArenaRedPoint.ins().joinState;var i=CommonUtils.objectToArray(DataCenter.ins().CrossArenaRankAwardConfig),n=CommonUtils.objectToArray(DataCenter.ins().CrossArenaMetalAwardConfig);n.sort(this.sort);for(var o=0;o<n.length;o++)i.push(n[o]);this.listArray.source=i,this.rewardList.dataProvider=new eui.ArrayCollection(t),this.dw.text=crossArenaControl.getDuanName()},e.prototype.onTouch=function(t){switch(t.target){case this.rewardList:crossArenaControl.upDailyRewards();break;case this.degree:UIMgr.ins().open(DegreeTipsView,DataCenter.ins().CrossArenaBaseConfig.degreeTpis)}},e.prototype.sort=function(t,e){return SortUtils.sortDescByKey(t.metal,e.metal)},e}(BaseEuiView);__reflect(CrossArenaRewardPanel.prototype,"CrossArenaRewardPanel");var CrossArenaView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossArenaViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.viewStack.selectedIndex=0,this.tab.dataProvider=this.viewStack},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.tab.selectedIndex=this.viewStack.selectedIndex=isNaN(t[0])?0:t[0],this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addCustomEvent(543,this.redPointEx),this.addCustomEvent(316,this.updateChat),this.redPointEx(),this.setOpenIndex(this.tab.selectedIndex)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(RambleMainView)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return DataCenter.ins().CrossArenaBaseConfig.openDay>GameServer.serverOpenDay+1?(tipsControl.showTips("|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().CrossArenaBaseConfig.openDay)+"|"),!1):reincarnateControl.lv<DataCenter.ins().CrossArenaBaseConfig.zhuanshengLevel?(tipsControl.showTips("|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("darkHallBossTip2",DataCenter.ins().CrossArenaBaseConfig.zhuanshengLevel)+"|"),!1):GameServer.isOpenLF?devildomControl.isHfTerm()?!0:(tipsControl.showTips(LangMgr.getValueByKey("kfTips10")),!1):(tipsControl.showTips("|C:0xf3311e&T:"+LangMgr.getValueByKey("darkHallBossTip3")),!1)},e.prototype.onTabTouching=function(t){this.checkIsOpen(t.currentTarget.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:HelpControl.openHelpWin(42)}},e.prototype.onTabTouch=function(t){this.redPointEx(),this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.setOpenIndex=function(t){this.isOpenChatUI(t),!isNaN(this.oldIndex)&&this.viewStack.getElementAt(this.oldIndex).close&&this.viewStack.getElementAt(this.oldIndex).close(),this.oldIndex=t,this.viewStack.getElementAt(t).open()},e.prototype.redPointEx=function(){this.redPoint0.visible=CrossArenaRedPoint.ins().redpoint_1>0,this.redPoint1.visible=!1,this.redPoint2.visible=CrossArenaRedPoint.ins().redpoint_2>0,this.redPoint3.visible=CrossArenaRedPoint.ins().redpoint_3>0},e.prototype.updateChat=function(){this.isOpenChatUI(this.tab.selectedIndex)},e.prototype.isOpenChatUI=function(t){var e=crossArenaControl.getIsJoinTeam();0==t&&e?(UIMgr.ins().isShow(RambleMainView)||UIMgr.ins().open(RambleMainView),this.tab.bottom=154,this.redPointGroup.bottom=188,this.viewStack.bottom=190):(UIMgr.ins().isShow(RambleMainView)&&UIMgr.ins().close(RambleMainView),this.tab.bottom=112,this.redPointGroup.bottom=147,this.viewStack.bottom=166)},__decorate([callDelay(50)],e.prototype,"isOpenChatUI",null),e}(BaseEuiView);__reflect(CrossArenaView.prototype,"CrossArenaView");var CrossArenaInfoItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data.actorid==ActorControl.actorID?this.currentState="oneself":this.data.campId==crossArenaControl.myCampId?this.currentState="own":this.currentState="enemy",this.data.rank<=3?(this.rankImg.source="paihangs"+this.data.rank,this.rankImg.visible=!0,this.rankTxt.visible=!1):(this.rankTxt.text=this.data.rank+"",this.rankImg.visible=!1,this.rankTxt.visible=!0),this.nameTxt.text=this.data.playerName+"S"+this.data.servId,this.kaTxt.text=this.data.killNum+"/"+this.data.aidNum,this.collectionTxt.text=this.data.collectNum+"",this.scoreTxt.text=this.data.curScore+"",this.arenaPointTxt.text=this.data.curGetScore+"",this.arenaScoreTxt.text=this.data.totalScore+"",this.mvp.visible=this.data.isMvp,this.firstBloodImg.visible=this.data.isFirstKiller,this.firstCollectionImg.visible=this.data.isFirstCollect},e}(BaseItemRender);__reflect(CrossArenaInfoItemRenderer.prototype,"CrossArenaInfoItemRenderer");var CrossArenaJoinItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isGet=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rewardList.itemRenderer=ItemBase,this.addEventTouchTap(this.btnGroup,this.onTap)},e.prototype.dataChanged=function(){if(this.data){this.isGet=!1,this.stateImg.source="tag_weidacheng",this.btnGroup.visible=!1,this.target.text=""+this.data.count;var t=crossArenaControl.dflState;1==(t>>this.data.id&1)?(this.stateImg.source="yilingqu",this.btnGroup.visible=!1):CrossArenaRedPoint.ins().JoinRedPoint.length>0&&CrossArenaRedPoint.ins().JoinRedPoint[this.data.id]>0&&(this.isGet=!0,this.stateImg.source=null,this.btnGroup.visible=!0),this.rewardList.dataProvider=new eui.ArrayCollection(this.data.award)}},e.prototype.onTap=function(t){this.isGet&&crossArenaControl.upJoinRewards(this.data.id)},e.prototype.destruct=function(){this.removeEventTouchTap(this.btnGroup,this.onTap)},e}(BaseItemRender);__reflect(CrossArenaJoinItemRenderer.prototype,"CrossArenaJoinItemRenderer");var CrossArenaMemberItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.inviteBtn,this.onTap)},e.prototype.dataChanged=function(){this.data instanceof UnionMemberInfoVo&&(this.itemData=this.data),this.itemData&&(this.nameLab.text=this.itemData.name,this.powerLab.text=LangMgr.getValueByKey("kfTips12",CommonUtils.overLength(this.itemData.attack)),this.scoreLab.text=LangMgr.getValueByKey("kfTips13",this.itemData.score),this.winRateLab.text=LangMgr.getValueByKey("kfTips14",this.itemData.winRate),this.face.source="head_"+this.itemData.job+this.itemData.sex,this.vipTitle.visible=0!=this.itemData.vipLevel)},e.prototype.onTap=function(t){crossArenaControl.upInvite(this.itemData.roleID)},e.prototype.destruct=function(){this.removeEventTouchTap(this.inviteBtn,this.onTap)},e}(BaseItemRender);__reflect(CrossArenaMemberItemRenderer.prototype,"CrossArenaMemberItemRenderer");var CrossArenaMetalRankItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.reward.itemRenderer=ItemBase},e.prototype.dataChanged=function(){this.data&&(this.dwName.text=crossArenaControl.getDuanName(this.data.metal),this.reward.dataProvider=new eui.ArrayCollection(this.data.award),this.background.source=DataCenter.ins().CrossArenaMetalAwardConfig[this.data.metal].background,this.background.visible=!0)},e}(BaseItemRender);__reflect(CrossArenaMetalRankItemRenderer.prototype,"CrossArenaMetalRankItemRenderer");var CrossArenaRankItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof CrossArenaRankVo&&(this.data.rank<=3?(this.rankImg.source="paihang"+this.data.rank,this.rankTxt.visible=!1,this.rankImg.visible=!0):(this.rankTxt.text=this.data.rank+"",this.rankTxt.visible=!0,this.rankImg.visible=!1),this.player.text=this.data.playerName,this.score.text=this.data.score+"",this.seasonTitle.text=DataCenter.ins().CrossArenaBaseConfig.scoreMetalName[this.data.dan-1],this.serverId.text="S"+this.data.servId)},e}(BaseItemRender);__reflect(CrossArenaRankItemRenderer.prototype,"CrossArenaRankItemRenderer");var CrossArenaResultDataItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this;this.data instanceof CrossArenaVo&&(this.data.actorid==ActorControl.actorID?this.currentState="oneself":this.data.campId==crossArenaControl.myCampId?this.currentState="own":this.currentState="enemy"),egret.callLater(function(){t.data.rank<=3?(t.rankImg.source="paihangs"+t.data.rank,t.rankImg.visible=!0,t.rankTxt.visible=!1):(t.rankTxt.text=t.data.rank+"",t.rankImg.visible=!1,t.rankTxt.visible=!0),t.nameTxt.text=t.data.playerName+"S"+t.data.servId,t.kaTxt.text=t.data.killNum+"/"+t.data.aidNum,t.collectionTxt.text=t.data.collectNum+"",t.scoreTxt.text=t.data.curScore+"",t.arenaPointTxt.text=t.data.curGetScore+"",0==t.data.arenaScore?t.arenaScoreTxt.text=t.data.totalScore+" "+(crossArenaControl.winCamp==t.data.campId||3==crossArenaControl.winCamp?"+":"-")+t.data.arenaScore:t.arenaScoreTxt.text=t.data.totalScore+" "+(t.data.arenaScore>0?"+":"")+t.data.arenaScore,t.mvp.visible=t.data.isMvp,t.firstBloodImg.visible=t.data.isFirstKiller,t.firstCollectionImg.visible=t.data.isFirstCollect,t.data.isOnWin?(t.tags.visible=!0,t.tags.source="kfarena_straight_win_tag"):t.data.isDeserter?(t.tags.visible=!0,t.tags.source="kfarena_deserter_tag"):t.tags.visible=!1},this)},e}(BaseItemRender);__reflect(CrossArenaResultDataItemRenderer.prototype,"CrossArenaResultDataItemRenderer");var CrossArenaRewardItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.dwImg.source=""+t.icon,this.dwName.text=""+t.name,this.background.source=""+t.background,this.reward.dataProvider=new eui.ArrayCollection(t.award)}},e}(BaseItemRender);__reflect(CrossArenaRewardItemRenderer.prototype,"CrossArenaRewardItemRenderer");var CrossArenaRoleItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="TeamCopyRoleItemSkin",e.touchEnabled=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.role.touchEnabled=!1,this.addEventTouchTap(this.role.touch,this.onTouch),this.addEventTouchTap(this.invite,this.onTouch),this.addEventTouchTap(this.nomember,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.invite:case this.nomember:if(!crossArenaControl.checkIsMatching())return;UIMgr.ins().open(CrossArenaInviteView);break;case this.role.touch:this.data.roleID!=ActorControl.actorID&&UIMgr.ins().open(CrossArenaCheckView,this.data)}},e.prototype.dataChanged=function(){if(this.data){this.nomember.visible=this.invite.visible=!1,this.role.visible=this.position.visible=!0;var t=this.data;this.offLineImg.visible=!t.isonline,this.roleName.text=t.roleName,this.position.source=t.isLeader()?"tfb_leader":null,this.role.data=t.toSubRole()}else this.nomember.visible=this.invite.visible=!0,this.offLineImg.visible=this.role.visible=this.position.visible=!1,this.role.data=null,this.roleName.text=LangMgr.getValueByKey("clanEmptyJob")},e.prototype.destruct=function(){this.removeEventTouchTap(this.role.touch,this.onTouch),this.removeEventTouchTap(this.invite,this.onTouch),this.removeEventTouchTap(this.nomember,this.onTouch)},e}(BaseItemRender);__reflect(CrossArenaRoleItemRenderer.prototype,"CrossArenaRoleItemRenderer");var CrossArenaTabItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="BtnTab0Skin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.labelDisplay.text=this.data},e}(BaseItemRender);__reflect(CrossArenaTabItemRenderer.prototype,"CrossArenaTabItemRenderer");var CrossArenaTeamItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isMirror=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.bloodBar.slideDuration=0,this.touchChildren=!1,this.addEventTouchTap(this,this.onTap),this.clickEffc=new GameMovieClip,this.clickEffc.x=32,this.clickEffc.y=31,this.clickEffc.scaleX=this.clickEffc.scaleY=.85,this.bloodBar.value=0,this.bloodBar.maximum=0},e.prototype.dataChanged=function(){if(isNaN(this.data))this.data instanceof RoleModel&&this.setData(this.data);else if(this.data){var t=UnitMgr.ins().getEntityByHandle(this.data)||UnitMgr.ins().getEntityBymasterhHandle(this.data);t&&t.infoModel&&(this.setData(t.infoModel),this.roleName.textColor=16711680,this.bloodBar.thumb.source="ttred2",t instanceof UnitRole&&(this.reliveWordImg.visible=t.infoModel.getAtt(0)>0&&t.isSafety()))}},e.prototype.setData=function(t){this.roleDt=t,t&&(t.job&&!this.roleHead.source&&(this.roleHead.source="yuanhead"+t.job+t.sex),this.roleName.text=t.getNameWithServer(),this.upHp())},e.prototype.startRelive=function(){this.countDown.visible||(this.relCD=egret.getTimer()+1e3*DataCenter.ins().CrossArenaBaseConfig.rebornCd,TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,20,this.onTime,this),this.onTime())},e.prototype.onTime=function(){var t=Math.ceil((this.relCD-egret.getTimer())/1e3);t>0?(this.countDown.text=t+"",this.countDown.visible=!0,this.deadMask.visible=!0):(this.onRelive(),TimerMgr.ins().remove(this.onTime,this))},e.prototype.onRelive=function(){this.countDown.visible=!1,this.deadMask.visible=!1,this.dead.visible=!1},e.prototype.upHp=function(){if(this.data){var t=void 0;if(isNaN(this.data)?this.data instanceof RoleModel&&(t=UnitMgr.ins().getMasterList(this.data.masterHandle)):t=UnitMgr.ins().getMasterList(this.data),!t||0==t.length)return this.deadFun();void 0==this.bloodBar.value&&(this.bloodBar.value=0);var e=t.length,i=0,n=0;this.isMirror=!1;for(var o=0;e>o;o++){var s=t[o];this.isMirror||(this.isMirror=4==s.infoModel.type);var r=s.infoModel.getAtt(0)||0,a=s.infoModel.getAtt(2)||0;i+=r,n+=a}this.bloodBar.value=i,this.bloodBar.maximum!=n&&(this.bloodBar.maximum=n),this.hpLabel&&(this.bloodBar.labelDisplay.visible=!1,this.hpLabel.text=CommonUtils.overLength(i)+"/"+CommonUtils.overLength(n)),0>=i?this.deadFun():(this.onRelive(),TimerMgr.ins().remove(this.onTime,this))}},e.prototype.deadFun=function(){this.startRelive()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this),this.removeEventTouchTap(this,this.onTap),this.data=null,this.bloodBar.value=0,this.roleHead.source=null},e.prototype.onTap=function(t){if(isNaN(this.data))this.data instanceof RoleModel&&rankOtherUserControl.upFindPlayer(crossArenaControl.getActorIdByName(this.data.name),0);else{if(ClientStorage.ins().setValue("mapClickTx",0),ClientStorage.ins().setValue("mapClickTy",0),this.showEffect(),!crossArenaControl.checkFBOperat(crossArenaControl.flagHandle==parseInt(this.data)))return;var e=UnitMgr.ins().getEntityByHandle(this.data)||UnitMgr.ins().getEntityBymasterhHandle(this.data);if(e&&e instanceof UnitRole&&e.isSafety())return void tipsControl.showTips(LangMgr.getValueByKey("kfArenaCantAttack",ColorUtils.RED));var i=UnitMgr.ins().getNoDieRole();if(i&&i.isSafety()){var n=DataCenter.ins().CrossArenaBaseConfig.readyPos[crossArenaControl.readyIndex-1].tranferPoint;return MapControl.moveTo((n.x+.5)*MapControl.CELL_SIZE>>0,n.y*MapControl.CELL_SIZE>>0),void EntrustMgr.ins().regEntrusTask(0,this.touchDo,this)}this.touchDo()}},e.prototype.touchDo=function(){if(crossArenaControl.flagHandle==parseInt(this.data)){if(crossArenaControl.flagCD-egret.getTimer()>0)return void tipsControl.showTips(LangMgr.getValueByKey("kfArenaFlagNoRef",ColorUtils.RED));crossArenaControl.upCollectFlag()}else{if(this.isMirror){var t=UnitMgr.ins().getMasterList(this.data);if(t)for(var e=0;e<t.length;e++){var i=t[e];if(i&&i.infoModel.getAtt(0)>0)return debug.log(LangMgr.getValueByKey("kfArenaAttackInfo",i.name,i.infoModel.handle,i.infoModel.masterHandle)),void gameControl.dispatchChangeAttrPoint(i.infoModel.handle)}}gameControl.dispatchChangeAttrPoint(this.data)}},e.prototype.showEffect=function(){this.clickEffc.playFile(PATH_EFF+"tapCircle",1),this.addChild(this.clickEffc)},__decorate([callLater],e.prototype,"upHp",null),e}(BaseItemRender);__reflect(CrossArenaTeamItemRenderer.prototype,"CrossArenaTeamItemRenderer");var CrossBossControl=function(t){function e(){var e=t.call(this)||this;return e.fbInfo=[],e.lastKFBoss=!1,e.dropRecordDataList=[],e.dropBestRecordDataList=[],e.addCustomEvent(300,function(){e.isKFBossBattle&&UIMgr.ins().open(BossBelongView)}),e.addCustomEvent(301,function(){e.isKFBossBattle&&UIMgr.ins().close(BossBelongView)}),e.addCustomEvent(353,function(){e.isKFBossBattle?e.dispatchEnterKFBossFb():e.lastKFBoss&&e.dispatchQuiKFBossFb()}),e}return __extends(e,t),Object.defineProperty(e.prototype,"isKFBossBattle",{get:function(){return 32==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.downBossInfo=function(t){this.fbInfo=[];for(var e=0;e<t.length;e++){var i=new CrossBossInfoVo;i.init(t[e]),this.fbInfo[i.dpId]=i}EventMgr.ins().dispatch(326)},e.prototype.downAscriptionChange=function(t,e){var i="";if(t>0){var n=UnitMgr.ins().getMasterList(t);n&&n[0]&&n[0].infoModel&&(i=n[0].infoModel.name)}bossControl.dispatchBelongChange(e,t,i)},e.prototype.downRevive=function(t,e){t>0?UIMgr.ins().open(CrossBossReliveView,t,e):UIMgr.ins().close(CrossBossReliveView),EventMgr.ins().dispatch(327)},e.prototype.downBossRevive=function(t,e){this.fbInfo[e]&&(1==t?this.fbInfo[e].flagRefTimer=egret.getTimer():2==t&&(this.fbInfo[e].bossRefTimer=egret.getTimer())),EventMgr.ins().dispatch(328)},e.prototype.downRefFlag=function(t,e){this.flagHandle=t,this.flagCD=1e3*e+egret.getTimer();for(var i in DataCenter.ins().CrossBossConfig){var n=DataCenter.ins().CrossBossConfig[i];if(n.fbid==MapControl.copyId&&2==n.type)return}this.flagHandle&&MapControl.copyId!=DataCenter.ins().CrossBossConfig[DataCenter.ins().CrossBossBaseConfig.cydDpId].fbid?this.flagHandle=100010100101:this.flagHandle=0},e.prototype.downCollectFlag=function(t,e){t&&t==ActorControl.handle&&e?(UIMgr.ins().open(CrossCollectView,e),gameControl.currAttackHandle=0):UIMgr.ins().close(CrossCollectView)},e.prototype.downInfo=function(t,e,i,n,o){this.flagTimes=t,this.bossTimes=e,this.assistTimes=i,this.enterCD=1e3*n+egret.getTimer(),this.isDoubleCollect=o,EventMgr.ins().dispatch(329)},e.prototype.downResult=function(t,e){for(var i=[],n=1==t,o=0;o<e.length;o++){var s=new RewardVo;s.init(e[o]),i.push(s),0==s.type&&1!=s.id&&2!=s.id&&9!=s.id||n||DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(UnitMgr.ins().getNoDieRole().x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(UnitMgr.ins().getNoDieRole().y/MapControl.CELL_SIZE),s])}if(n)resultControl.create(MapControl.copyType,i,n);else{var r=function(){resultControl.create(MapControl.copyType,i,n)};DropControl.start(),DropControl.addCompleteFunc(r,this)}},e.prototype.downDropList=function(t,e,i){this.dropRecordDataList=[],this.dropBestRecordDataList=[];for(var n=0;n<t.length;n++){var o=new CrossDropRecordVo;o.init(t[n]),this.dropRecordDataList.push(o)}this.dropRecordDataList.sort(function(t,e){return SortUtils.sortDescByKey(t,e,"time")});for(var n=0;n<e.length;n++){var o=new CrossDropRecordVo;o.init(e[n]),this.dropBestRecordDataList.push(o)}this.dropBestRecordDataList.sort(function(t,e){return SortUtils.sortDescByKey(t,e,"time")});for(var s=[],n=0;i.length>n;n++){var o=new CrossDropRecordVo;o.init(i[n]),s.push(o)}s.sort(function(t,e){return SortUtils.sortDescByKey(t,e,"time")}),this.dropBestRecordDataList=s.concat(this.dropBestRecordDataList),EventMgr.ins().dispatch(330)},e.prototype.downBroadcastResult=function(t,e,i){var n=UnitMgr.ins().getEntityByHandle(i);n&&n.action!=UnitAction.DIE&&n!=UnitMgr.ins().getNoDieRole()&&EventMgr.ins().dispatch(331,"S"+t+e),EventMgr.ins().dispatch(331,"S"+t+e)},e.prototype.downEffigyInfo=function(t,e,i,n){n=n?n+"\n":"";var o="|C:0x3DBDFF&T:"+n+"|"+i;this.statueData={},this.statueData.job=t,this.statueData.sex=e,this.statueData.playName=o,32==MapControl.copyType&&this.creatEffigy(o,t,e)},e.prototype.creatEffigy=function(t,e,i){for(var n in DataCenter.ins().CrossBossConfig){var o=DataCenter.ins().CrossBossConfig[n];if(o.fbid==MapControl.copyId&&2==o.type)return}var s=UIMgr.gameScene.map,r=this.getStatuePos();if(r){var a=DataCenter.ins().CrossBossConfig[DataCenter.ins().CrossBossBaseConfig.cydDpId].fbid==MapControl.copyId?"kf_chenghaodfbz":"kf_chenghaodfxx",l=DataCenter.ins().CrossBossConfig[DataCenter.ins().CrossBossBaseConfig.cydDpId].fbid==MapControl.copyId?"kf0_statue"+e+"_"+i:"kf1_statue"+e+"_"+i;this.statue&&s.removeEntity(this.statue),this.statue=new UnitStatue(a,t||LangMgr.getValueByKey("clanEmptyJob"),l),this.statue.x=r.x,this.statue.y=r.y,s.addEntity(this.statue)}},e.prototype.getStatuePos=function(){for(var t in DataCenter.ins().CrossBossConfig)if(DataCenter.ins().CrossBossConfig[t].fbid==MapControl.copyId)return DataCenter.ins().CrossBossConfig[t].statuePos},e.prototype.downHudun=function(t,e){null!=t&&null!=e&&(this.hudun=t,this.hudunMax=e),this.hudun>0?TimerMgr.ins().isExists(this.dispatchHudun,this)||TimerMgr.ins().doTimer(1e3,this.hudun,this.dispatchHudun,this):TimerMgr.ins().isExists(this.dispatchHudun,this)&&TimerMgr.ins().remove(this.dispatchHudun,this)},e.prototype.dispatchHudun=function(){this.hudun--,EventMgr.ins().dispatch(503)},e.prototype.dispatchEnterKFBossFb=function(){this.lastKFBoss=!0,UIMgr.ins().isShow(BossBloodView)&&UIMgr.ins().open(BossBloodView),UIMgr.ins().close(CrossBossShowView),UIMgr.ins().open(CrossBossSceneView);var t=heroControl.getSubRoleByIndex(0);t&&(this.statueData?this.creatEffigy(this.statueData.playName,this.statueData.job,this.statueData.sex):this.creatEffigy(null,t.job,t.sex))},e.prototype.dispatchQuiKFBossFb=function(){UIMgr.ins().close(BossBelongView),this.lastKFBoss=!1,this.flagHandle=0,this.statueData=null,UIMgr.ins().close(CrossBossReliveView),UIMgr.ins().close(CrossBossSceneView)},e.prototype.upClearReliveCD=function(){},e.prototype.upCleanBelong=function(){},e.prototype.enterCopy=function(t){var e=this;warnControl.showDangerWarn(function(){e.upEnter(t)})},e.prototype.upEnter=function(t){return[t]},e.prototype.upCollectFlag=function(){},e.prototype.upDropList=function(){},e.prototype.upIsDoubel=function(t){return[t]},e.ins=function(){return t.ins.call(this)},e.prototype.isOpen=function(){return DataCenter.ins().CrossBossBaseConfig.limitZsLv||(DataCenter.ins().CrossBossBaseConfig.limitZsLv=5),DataCenter.ins().CrossBossBaseConfig.openDay<=GameServer.serverOpenDay+1&&reincarnateControl.lv>=DataCenter.ins().CrossBossBaseConfig.limitZsLv},e.prototype.byBossIsOpen=function(){if(!this.fbInfo)return!1;for(var t=0;t<this.fbInfo.length;t++){var e=this.fbInfo[t];if(e){var i=DataCenter.ins().CrossBossConfig[e.dpId];if(2==i.type&&i.crossOpenDay<=GameServer.serverOpenDay+1)return!0}}return!1},e.prototype.isLenify=function(){var t=DataCenter.ins().CrossBossBaseConfig.gatherDoubleContidion;return t[0]<=GameServer.serverOpenDay-1&&t[1]<=reincarnateControl.lv},e.prototype.enterFb=function(t){if(this.isOpen()&&!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()){var e=(crossBossControl.enterCD-egret.getTimer())/1e3>>0;if(e>0)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips4",e));var i=DataCenter.ins().CrossBossConfig[t];Assert(i,LangMgr.getValueByKey("kfBossEnterError")+t)||(reincarnateControl.lv<i.levelLimit[0]/1e3||reincarnateControl.lv>i.levelLimit[1]/1e3?tipsControl.showTips(LangMgr.getValueByKey("kfTips40",i.levelLimit[0]/1e3>>0)):crossBossControl.enterCopy(t))}},__decorate([down(1,[ByteConst.CrossBossInfoVos])],e.prototype,"downBossInfo",null),__decorate([down(2,[10,10])],e.prototype,"downAscriptionChange",null),__decorate([down(3,[3,10])],e.prototype,"downRevive",null),__decorate([down(5,[2,2])],e.prototype,"downBossRevive",null),__decorate([down(7,[10,3])],e.prototype,"downRefFlag",null),__decorate([down(8,[10,3])],e.prototype,"downCollectFlag",null),__decorate([down(9,[2,2,2,2,0])],e.prototype,"downInfo",null),__decorate([down(10,[2,ByteConst.RewardVos])],e.prototype,"downResult",null),__decorate([down(11,[ByteConst.CrossDropRecordVos,ByteConst.CrossDropRecordVos,ByteConst.CrossDropRecordVos])],e.prototype,"downDropList",null),__decorate([down(12,[3,8,10])],e.prototype,"downBroadcastResult",null),__decorate([down(13,[1,1,8,8])],e.prototype,"downEffigyInfo",null),__decorate([down(14,[3,3])],e.prototype,"downHudun",null),__decorate([up(3)],e.prototype,"upClearReliveCD",null),__decorate([up(4)],e.prototype,"upCleanBelong",null),__decorate([up(6,[3])],e.prototype,"upEnter",null),__decorate([up(8)],e.prototype,"upCollectFlag",null),__decorate([up(11)],e.prototype,"upDropList",null),__decorate([up(15,[1])],e.prototype,"upIsDoubel",null),e=__decorate([protocolsId(72)],e)}(BaseSystem);__reflect(CrossBossControl.prototype,"CrossBossControl");var AmusementType4DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.getCostRank=function(t,e){if(!t)return 0;for(var i=0,n=t.numType,o=DataCenter.ins().Amusement4Config[this.id];o[e.idx];){if(n>=o[e.idx].value){i=o[e.idx].ranking,e.idx++,t.rankIndex==amusementControl.myPaiming&&(this.myPaiming=i);break}e.idx++}return i},e}(AmusementBaseDataVo);__reflect(AmusementType4DataVo.prototype,"AmusementType4DataVo");var CrossBossInfoVo=function(){function t(){}return t.prototype.init=function(t){this.dpId=t[0],this.serverId=t[1],this.bossRefTimer=1e3*t[2]+egret.getTimer(),this.flagRefTimer=1e3*t[3]+egret.getTimer(),8==this.dpId&&(this.flagRefTimer=Number.MAX_VALUE+egret.getTimer())},t}();__reflect(CrossBossInfoVo.prototype,"CrossBossInfoVo");var CrossBossReliveView=function(t){function e(){var e=t.call(this)||this;return e.remainM=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossBeKillViewSkin",this.aliveNum=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.reliveBtn,this.onRelive),this.addEventTouchTap(this.exitBtn,this.onTap),this.setWin(t[0],t[1]),t[2]&&DisplayUtils.removeFromParent(this.reliveGroup)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(WorldBossCdView),TimerMgr.ins().removeAll(this)},e.prototype.setWin=function(t,e){if(e>0){var i=UnitMgr.ins().getEntityByHandle(e),n="";if(i){var o=UnitMgr.ins().getEntityByHandle(i.infoModel.masterHandle);n=i instanceof UnitRole?i.infoModel.name:i.infoModel.masterHandle&&o?""+o.infoModel.name:"Boss"+i.infoModel.name}this.killTips.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips1",LangMgr.getColor("color74"),n)),this.alive.visible=!1,this.alive.visible&&(this.alive.text=LangMgr.getValueByKey("bossReshProp",this.aliveNum))}this.reliveBtn.label=LangMgr.getValueByKey("bossReshLocal",DataCenter.ins().CrossBossBaseConfig.rebornCost),this.reliveTimesTxt.text=LangMgr.getValueByKey("activitSS1",t),TimerMgr.ins().remove(this.refushLabel,this),this.remainM=t,TimerMgr.ins().doTimer(1e3,this.remainM,this.refushLabel,this,this.overTime,this)},e.prototype.refushLabel=function(){this.remainM--,this.reliveTimesTxt.text=LangMgr.getValueByKey("activitSS1",this.remainM)},e.prototype.overTime=function(){UIMgr.ins().close(this),UIMgr.ins().close(WorldBossCdView)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.onTap=function(t){switch(t.currentTarget){case this.exitBtn:copyControl.upExitFb()}},e.prototype.onRelive=function(t){this.aliveNum?crossBossControl.upClearReliveCD():crazybtplayCopyControl.isShenwujindi?CommonFun.checkCurrency(DataCenter.ins().CrazybtplayBossBaseConfig.rebornCost,2,LangMgr.getValueByKey("customBossNoYB"))&&crazybtplayCopyControl.upBuyReliveCd():totemBossControl.inCopy?CommonFun.checkCurrency(DataCenter.ins().TotemBossBaseConfig.rebornCost,2,LangMgr.getValueByKey("customBossNoYB"))&&totemBossControl.upBuyRevive():CommonFun.checkCurrency(DataCenter.ins().CrossBossBaseConfig.rebornCost,2,LangMgr.getValueByKey("customBossNoYB"))&&crossBossControl.upClearReliveCD()},e}(BaseEuiView);__reflect(CrossBossReliveView.prototype,"CrossBossReliveView");var CrossBossResultView=function(t){function e(){var e=t.call(this)||this;return e._quitTime=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ToseongBossResultViewSkin",this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.winnerEff=new GameMovieClip,this.winnerEff.x=41,this.winnerEff.y=41,this.winnerEff.touchEnabled=!1},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this.addEventTouchTap(this.closeBtn,this.onTap),this.bg.source="resultWin_png",this.closeBtn.label=LangMgr.getValueByKey("babelEnter"),this.title.source="win_02",this.roleTitleLabel.text=e[1]?LangMgr.getValueByKey("kfTips34"):LangMgr.getValueByKey("kfTips35"),this.winnerEff.parent||this.effGroup.addChild(this.winnerEff),this.winnerEff.playFile(PATH_EFF+"yanhuaeff",1);var n=ActorControl.myName;n=StringUtils.replaceStr(n,LangMgr.getValueByKey("color39"),ColorUtils.GREEN+""),this.belongTxt.textFlow=TextUtils.generateTextFlow1(n),this.labelItem.text=LangMgr.getValueByKey("kfTips36");var o=heroControl.getSubRoleByIndex(0);o&&(this.roleIcon.icon="yuanhead"+o.job+o.sex),this.roleIcon.jobImg.visible=!1;var s=e[0];s&&this.setRewardList(s),this._quitTime=6,TimerMgr.ins().doTimer(1e3,this._quitTime+1,this.onTimer,this),this.onTimer()},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);for(var e=[],i=[],n=[],o=[],s=[],r=0;r<t.length;r++){var a=DataCenter.ins().ItemConfig[t[r].id];if(1!=ItemUtils.getType(a))0==t[r].type?4==t[r].id?o.push(t[r]):e.push(t[r]):n.push(t[r]);else if(i.length){for(var l=!1,h=0;h<i.length;h++)if(i[h].id==t[r].id){i[h].count+=t[r].count,l=!0;
break}l||i.push(t[r])}else i.push(t[r])}n.sort(this.ruleSortByItem),s=o.concat(e,i,n),this.listItem.dataProvider=new eui.ArrayCollection(s)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),TimerMgr.ins().removeAll(this)},e.prototype.onTimer=function(){this.closeBtn.label=LangMgr.getValueByKey("kfTips3",--this._quitTime),this._quitTime<=0&&UIMgr.ins().close(this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.ruleSortByItem=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],n=DataCenter.ins().ItemConfig[e.id],o=ItemUtils.getQuality(i),s=ItemUtils.getQuality(n);return s-o},e}(BaseEuiView);__reflect(CrossBossResultView.prototype,"CrossBossResultView");var CrossBossSceneView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossBossSceneViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(331,this.bossEnd),this.addCustomEvent(326,this.checkBossRelive),this.addCustomEvent(356,this.onRemove),this.endGroup.visible=!1;var i=MapControl.copyId;for(var n in DataCenter.ins().CrossBossConfig)if(i==DataCenter.ins().CrossBossConfig[n].fbid){var o=DataCenter.ins().CrossBossConfig[n],s=crossBossControl.fbInfo[o.id];2==o.type?this.nameTxt.text=o.sceneName:this.nameTxt.text=LangMgr.getValueByKey("kfTips37")==o.sceneName?"S."+s.serverId+LangMgr.getValueByKey("kfTips37"):LangMgr.getValueByKey("kfTips38"),this.curInfo=s;break}this.checkBossRelive()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this),Tween.removeTweens(this.endGroup)},e.prototype.onRemove=function(t){var e=(t[0],t[1]);if(!(e instanceof UnitRole)&&DataCenter.ins().MonstersConfig[e.infoModel.configID]&&1==DataCenter.ins().MonstersConfig[e.infoModel.configID].type){var i=DataCenter.ins().CrossBossConfig[this.curInfo.dpId].refreshTime;this.curInfo.bossRefTimer=1e3*i+egret.getTimer(),this.checkBossRelive()}},e.prototype.checkBossRelive=function(){if(this.curInfo&&!TimerMgr.ins().isExists(this.onBossRelive,this)){var t=(this.curInfo.bossRefTimer-egret.getTimer())/1e3>>0;TimerMgr.ins().doTimer(1e3,t+2,this.onBossRelive,this),this.onBossRelive()}},e.prototype.onBossRelive=function(){if(this.curInfo){var t=(this.curInfo.bossRefTimer-egret.getTimer())/1e3>>0;t>0?(this.bossRefTimeLabel.text=LangMgr.getValueByKey("kfBossRefTime",DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3)),this.nameTxt.y=8):(TimerMgr.ins().remove(this.onBossRelive,this),this.bossRefTimeLabel.text="",this.nameTxt.y=18)}},e.prototype.bossEnd=function(t){var e=this;32==MapControl.copyType&&(this.endGroup.visible=!0,this.endGroup.alpha=1,this.winnerName.text=LangMgr.getValueByKey("bossWinner",t),TimerMgr.ins().doTimer(1e4,1,function(){Tween.get(e.endGroup).to({alpha:0},300).call(function(){e.endGroup.visible=!1})},this))},e}(BaseEuiView);__reflect(CrossBossSceneView.prototype,"CrossBossSceneView");var CrossBossShowView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossBossShowViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.boss.touchEnabled=!1,this.boss.touchChildren=!1,this.dropRewardList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.challengeBtn,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.fbId=t[0],this.dp=DataCenter.ins().CrossBossConfig[this.fbId],this.showAward(),this.showBoss(),this.bossName.source="kf_name_"+this.dp.bossId},e.prototype.close=function(){this.bossMc.dispose(),ObjectPool.push(this.bossMc)},e.prototype.showAward=function(){var t=this.dp.belongRewardshow,e=RewardVo.getRewardsByOpenDay(t);this.dropRewardList.dataProvider=new eui.ArrayCollection(e)},e.prototype.showBoss=function(){this.bossMc||(this.bossMc=ObjectPool.pop("GameMovieClip"),this.bossMc.scaleX=-1,this.bossMc.scaleY=1,this.bossMc.x=78,this.bossMc.y=50,this.boss.addChild(this.bossMc),this.addEventTouchTap(this.bossMc,this.onTouch));var t=this.dp.bossId,e=DataCenter.ins().MonstersConfig[t];88141==t||88144==t?this.bossMc.playFile(PATH_GUAIWU+(GUAIWU_PREFIX+e.avatar+"_4s"),-1):this.bossMc.playFile(PATH_GUAIWU+(GUAIWU_PREFIX+e.avatar+"_3s"),-1)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:case this.bossMc:UIMgr.ins().close(this);break;case this.challengeBtn:crossBossControl.enterFb(this.fbId)}},e}(BaseEuiView);__reflect(CrossBossShowView.prototype,"CrossBossShowView");var CrossBossView=function(t){function e(){var e=t.call(this)||this;return e.oldIndex=0,e.isTopLevel=!0,e.skinName="CrossBossViewSkin",e.canVis=!0,e.remind.textFlow=TextUtils.generateTextFlow1("|U:&T:"+e.remind.text),e.remind1.textFlow=TextUtils.generateTextFlow1("|U:&T:"+e.remind1.text),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.PANEL_TYPE_ZH=3,crossBossControl.byBossIsOpen()||(this.tab.visible=!1,DisplayUtils.removeFromParent(this.redPoint1),DisplayUtils.removeFromParent(this.redPoint0)),e.PANEL_TYPE_ZH=-1,isNaN(t[0])?this.setOpenIndex(0):this.setOpenIndex(t[0]),this.addCustomEvent(329,this.refData),this.addCustomEvent(546,this.reRedpoint),this.addEventTouchTap(this.doubleCollect,this.onTouch),this.addEventTouchTap(this.remind,this.onTouch),this.addEventTouchTap(this.remind1,this.onTouch),this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventTouchTap(this.extraBtn,this.onTouch),this.reRedpoint(),this.refData(),crossBossControl.isLenify()||DisplayUtils.removeFromParent(this.doubleCollect),this.doubleCollect.selected=crossBossControl.isDoubleCollect,TimerMgr.ins().isExists(this.onTimer,this)||TimerMgr.ins().doTimer(1e3,0,this.onTimer,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.getElementAt(this.oldIndex).close()},e.prototype.onTabTouch=function(t){this.setOpenIndex(this.tab.selectedIndex)},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.setOpenIndex=function(t){switch(t){case e.PANEL_TYPE_ZH:this.zhBossBar.visible=!0,this.kfBossBar.visible=!1;break;default:this.zhBossBar.visible=!1,this.kfBossBar.visible=!0}this.viewStack.getElementAt(t).open(),this.viewStack.getElementAt(this.oldIndex).close(),this.oldIndex=t,this.tab.selectedIndex=this.viewStack.selectedIndex=t},e.prototype.onTimer=function(){this.viewStack.getElementAt(this.tab.selectedIndex).onTimer&&this.viewStack.getElementAt(this.tab.selectedIndex).onTimer()},e.prototype.onTouch=function(t){switch(t.target){case this.doubleCollect:crossBossControl.upIsDoubel(this.doubleCollect.selected?1:0);break;case this.seeRule:this.tab.selectedIndex==e.PANEL_TYPE_ZH?HelpControl.openHelpWin(110):HelpControl.openHelpWin(34);break;case this.closeBtn:UIMgr.ins().close(this);break;case this.extraBtn:var i=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,204246);if(i>0){var n=DataCenter.ins().ItemConfig[204246];warnControl.show(LangMgr.getValueByKey("expJuanZhouBuyCount",ItemUtils.getQualityColor(n),n.name),function(){backpackControl.upUseItem(204246,1)},this)}}},e.prototype.refData=function(){this.flagTimes.text=crossBossControl.flagTimes+"",this.bossTimes.text=crossBossControl.bossTimes+"",this.assistTimes.text=crossBossControl.assistTimes+"",this.assistTimes1.text=crossBossControl.assistTimes+"";var t=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,204246);this.extraBtn.visible=0==crossBossControl.bossTimes&&t>0},e.prototype.reRedpoint=function(){this.redPoint0.visible=CrossBossRedpoint.ins().redpoint1,this.redPoint1.visible=CrossBossRedpoint.ins().redpoint2},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=!1,n=t[0]||0;switch(n){case 0:i=crossBossControl.isOpen(),i||tipsControl.showTips(LangMgr.getValueByKey("kfTips45"));break;case 1:if(i=crossBossControl.byBossIsOpen(),!i){var o=0;for(var s in DataCenter.ins().CrossBossConfig){var r=DataCenter.ins().CrossBossConfig[s];if(2==r.type){o=r.crossOpenDay;break}}tipsControl.showTips(LangMgr.getValueByKey("kfByBossOpenDayTip",o))}}return i},e.PANEL_TYPE_ZH=3,e}(BaseEuiView);__reflect(CrossBossView.prototype,"CrossBossView");var CrossMutationBossPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.award7.itemRenderer=ItemBase,this.award8.itemRenderer=ItemBase,this.award9.itemRenderer=ItemBase,this.lastPos1=new egret.Point,this.lastPos1.x=this.bossGroup1.x,this.lastPos1.y=this.bossGroup1.y,this.lastPos2=new egret.Point,this.lastPos2.x=this.bossGroup2.x,this.lastPos2.y=this.bossGroup2.y,this.lastPos3=new egret.Point,this.lastPos3.x=this.bossGroup3.x,this.lastPos3.y=this.bossGroup3.y;for(var e in DataCenter.ins().CrossBossConfig){var i=DataCenter.ins().CrossBossConfig[e];if(2==i.type){var n=RewardVo.getRewardsByOpenDay(i.belongRewardshow);this["award"+i.id]&&(this["award"+i.id].itemRenderer=ItemBase,this["award"+i.id].dataProvider=new eui.ArrayCollection(n),this["bossBtn"+i.id].name=i.id)}}},e.prototype.open=function(){this.addEventTouchTap(this.bossBtn7,this.onTouch),this.addEventTouchTap(this.bossBtn8,this.onTouch),this.addEventTouchTap(this.bossBtn9,this.onTouch),this.startTween(),this.onTimer()},e.prototype.onTouch=function(t){switch(t.target){case this.bossBtn7:case this.bossBtn8:case this.bossBtn9:var e=parseInt(t.target.name);if(!e)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips44"));UIMgr.ins().open(CrossBossShowView,e)}},e.prototype.startTween=function(){this.bossGroup1.x=2,this.bossGroup1.y=-323,this.bossGroup1.alpha=0,this.bossGroup2.x=-188,this.bossGroup2.y=300,this.bossGroup2.alpha=0,this.bossGroup3.x=482,this.bossGroup3.y=300,this.bossGroup3.alpha=0;var t=110,e=200;egret.Tween.get(this.bossGroup1).wait(t).to({x:this.lastPos1.x,y:this.lastPos1.y,alpha:1},e,egret.Ease.quadIn),egret.Tween.get(this.bossGroup2).wait(t).to({x:this.lastPos2.x,y:this.lastPos2.y,alpha:1},e,egret.Ease.quadIn),egret.Tween.get(this.bossGroup3).wait(t).to({x:this.lastPos3.x,y:this.lastPos3.y,alpha:1},e,egret.Ease.quadIn),this.decoImg.scaleX=this.decoImg.scaleY=this.decoImg.alpha=1,egret.Tween.get(this.decoImg).wait(t+e).to({scaleX:2.5,scaleY:2.5,alpha:0},500,egret.Ease.quadOut)},e.prototype.onTimer=function(){if(this.skinName)for(var t=crossBossControl.fbInfo,e=0;e<t.length;e++){var i=t[e];if(i&&0!=i.bossRefTimer){var n=DataCenter.ins().CrossBossConfig[i.dpId];if(2==n.type){var o=(i.bossRefTimer-egret.getTimer())/1e3>>0,s="";o>0&&(s=DateUtils.getFormatBySecond(o)),this["countdown"+i.dpId]&&(s?this["countdown"+i.dpId].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfByBossRef",s)):this["countdown"+i.dpId].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("bossUpdate")))}}}},e}(BasePanel);__reflect(CrossMutationBossPanel.prototype,"CrossMutationBossPanel");var CrossNormalBossPanel=function(t){function e(){var e=t.call(this)||this;return e.MAX=8,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.MAX=CommonUtils.getObjectLength(DataCenter.ins().CrossBossConfig);for(var e=1,i=1;i<=this.MAX;i++){var n=DataCenter.ins().CrossBossConfig[i];if(1==n.type){var o=this["island"+e];n.id==DataCenter.ins().CrossBossBaseConfig.cydDpId?(o=this.islandCYD,o.island.source="kf_boss_area8"):o.island.source="kf_boss_area"+e,o.touchChildren=!1,o.filters=FilterUtils.ARRAY_GRAY_FILTER;var s=[n.levelLimit[0]/1e3>>0,n.levelLimit[1]/1e3>>0];o.info.text=LangMgr.getValueByKey("kfTips41",s[0],s[1]),o.info.textColor=s[0]<=reincarnateControl.lv&&reincarnateControl.lv<=s[1]?ColorUtils.GREEN:ColorUtils.RED,o.serverInfo.visible=!1,e++}}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(326,this.refData),this.addCustomEvent(328,this.refData),this.addCustomEvent(546,this.refRedpoint),this.upCurState()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this)},e.prototype.upCurState=function(){var t=0;for(var e in crossBossControl.fbInfo){var i=DataCenter.ins().CrossBossConfig[e];1==i.type&&DataCenter.ins().CrossBossBaseConfig.cydDpId!=+e&&t++}this.currentState=""+t,this.validateNow(),this.refData(),this.refRedpoint()},e.prototype.refData=function(){for(var t=crossBossControl.fbInfo,e=0;e<t.length;e++){var i=t[e];if(i){var n=this["island"+i.dpId];if(i.dpId==DataCenter.ins().CrossBossBaseConfig.cydDpId&&(n=this.islandCYD),n)if(DataCenter.ins().CrossBossConfig[i.dpId],n.headGroup.visible=!1,n.head.source="",n.name=i.dpId,n.filters=[],i.serverId)if(n.serverInfo.visible=!0,n.serverName.text=""+(i.serverId==GlobalModel.srvid?LangMgr.getValueByKey("kfTips42"):LangMgr.getValueByKey("kfTips43",i.serverId)),i.serverId==GlobalModel.srvid){n.headGroup.visible=!0;var o=heroControl.getSubRoleByIndex(0);n.head.source="yuanhead"+o.job+o.sex}else n.serverName.x=13;else n.serverInfo.visible=!1}}this.onTimer()},e.prototype.onTimer=function(){if(this.skinName)for(var t=crossBossControl.fbInfo,e=0;e<t.length;e++){var i=t[e];if(i&&0!=i.bossRefTimer){var n=DataCenter.ins().CrossBossConfig[i.dpId];if(1==n.type){var o=(i.bossRefTimer-egret.getTimer())/1e3>>0,s="";o>0&&(s="\n"+DateUtils.getFormatBySecond(o)),i.dpId==DataCenter.ins().CrossBossBaseConfig.cydDpId?this.islandCYD.info.text=LangMgr.getValueByKey("kfTips41",n.levelLimit[0]/1e3>>0,n.levelLimit[1]/1e3>>0)+s:this["island"+i.dpId]&&(this["island"+i.dpId].info.text=LangMgr.getValueByKey("kfTips41",n.levelLimit[0]/1e3>>0,n.levelLimit[1]/1e3>>0)+s)}}}},e.prototype.refRedpoint=function(){for(var t=crossBossControl.fbInfo,e=0;e<t.length;e++){var i=t[e];i&&(this["island"+i.dpId]?this["island"+i.dpId].redPoint.visible=CrossBossRedpoint.ins().redpoints[i.dpId]:i.dpId==DataCenter.ins().CrossBossBaseConfig.cydDpId&&(this.islandCYD.redPoint.visible=CrossBossRedpoint.ins().redpoints[i.dpId]))}},e.prototype.onTouch=function(t){switch(t.target){default:if(t.target instanceof eui.Component){var e=parseInt(t.target.name);if(!e)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips44"));UIMgr.ins().open(CrossBossShowView,e)}}},__decorate([callLater],e.prototype,"refRedpoint",null),e}(BasePanel);__reflect(CrossNormalBossPanel.prototype,"CrossNormalBossPanel");var CrossCollectView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossCollectViewSkin",e.uilayer=GameLayer.POPUP,e.progressBar.labelFunction=function(t,e){return""},e}return __extends(e,t),e.prototype.childrenCreated=function(){this.progressBar.value=0,this.progressBar.visible=!1,this.bgmc=new GameMovieClip,this.bgmc.playFile(PATH_EFF+"jindutiaoeff1",-1),this.bgmc.scaleY=2,this.bgmc.scaleX=1.25,this.effGroup.height=50,this.effGroup.scrollEnabled=!0,this.effGroup.addChild(this.bgmc)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.state.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips91",t[1]?t[1]:ActorControl.myName)),Tween.removeTweens(this.effGroup),this.effGroup.scaleX=0,Tween.get(this.effGroup).to({scaleX:1},1e3*t[0]).call(function(){t[2]&&t[2](),UIMgr.ins().close(CrossReliveView)},this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Tween.removeTweens(this.effGroup)},e.prototype.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!isNaN(t[0])&&t[0]>0},e}(BaseEuiView);__reflect(CrossCollectView.prototype,"CrossCollectView");var CrossReliveView=function(t){function e(){var e=t.call(this)||this;return e.remainM=0,e.skinName="CrossReliveViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.remainM=t[0];var i=t[1];i&&(this.killTips.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("bossFinghtLoss",StringUtils.addColor(i,"#23C42A")))),this.reliveTimesTxt.text=LangMgr.getValueByKey("activitSS1",this.remainM),TimerMgr.ins().doTimer(1e3,this.remainM,this.refushLabel,this,this.overTime,this)},e.prototype.refushLabel=function(){this.remainM--,this.reliveTimesTxt.text=LangMgr.getValueByKey("activitSS1",this.remainM),this.remainM<=0&&this.overTime()},e.prototype.overTime=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CrossReliveView.prototype,"CrossReliveView");var CrossSmallMapView=function(t){function e(e,i){void 0===e&&(e=400);var n=t.call(this)||this;return n._limit_width=200,n._limit_height=0,n.R_Scale=.58,n.MOVE_DELAY=100,n.skinName="CrossSmallMapViewSkin",n.uilayer=GameLayer.SCENE3,e&&(n._limit_width=e),i&&(n._limit_height=i),n.left=n.right=n.top=n.bottom=0,n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.mapBg=new eui.Image,this.mapBg.mask=this.maskImg,this.mapGroup.addChildAt(this.mapBg,0),this.playerImg.visible=!1},e.prototype.onMapComplete=function(){this._limit_width?this.R_Scale=this._limit_width/this.mapBg.width:this._limit_height&&(this.R_Scale=this._limit_height/this.mapBg.height),this.mapBg.width*=this.R_Scale,this.mapBg.height*=this.R_Scale,this.playerImg.visible=!0},e.prototype.open=function(t,e){this._curSceneType=t,this.endTimestamp=e,this.addCustomEvent(353,this.initMap),this.addEventTouchTap(this,this.onTouch),this.getMainRole(),this.addEvent(egret.Event.COMPLETE,this.mapBg,this.onMapComplete),this.initMap(),TimerMgr.ins().isExists(this.refreshCoordinate,this)||TimerMgr.ins().doTimer(this.MOVE_DELAY,0,this.refreshCoordinate,this),this.refreshCoordinate()},e.prototype.close=function(){this.removeEvent(egret.Event.COMPLETE,this.mapBg,this.onMapComplete)},e.prototype.getMainRole=function(){this.mainRole=UnitMgr.ins().getNoDieRole(),this.mainRole||(this.mainRole=UnitMgr.ins().getMainRole(0))},e.prototype.initMap=function(){this.mapBg.x=0,this.mapBg.y=0,this.mapBg.source=PATH_MAP+MapControl.getFileName()+"/small.jpg",this.fbName.text=MapControl.copyName||LangMgr.getValueByKey("unknownto")},e.prototype.onTouch=function(t){switch(t.target){case this.seeRule:switch(this._curSceneType){case 0:HelpControl.openHelpWin(66)}break;default:switch(this._curSceneType){case 0:UIMgr.ins().open(TotemBossSceneMapView)}}},e.prototype.refreshCoordinate=function(){if(isNaN(this.endTimestamp))this.timeGroup.visible=!1;else{this.timeGroup.visible=!0;var t=(this.endTimestamp-GameServer.serverTime)/1e3;t>=0?this.leftTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3):this.timeGroup.visible=!1}if(!this.mainRole)return void this.getMainRole();var e=85,i=30,n=140,o=this.mainRole.x/10*this.R_Scale-e;-i>o||o>this.mapBg.width-n?-i>o?this.playerImg.x=o+e+i:o>this.mapBg.width-n&&(this.playerImg.x=e+(o-this.mapBg.width+n)):(this.mapBg.x=-this.mainRole.x/10*this.R_Scale+e,this.playerImg.x=e);var s=this.mainRole.y/10*this.R_Scale-e;s>this.mapBg.height-n||-i>s?-i>s?this.playerImg.y=s+e+i:s>this.mapBg.height-n&&(this.playerImg.y=e+(s-this.mapBg.height+n)):(this.mapBg.y=-s,this.playerImg.y=e)},e}(BaseEuiView);__reflect(CrossSmallMapView.prototype,"CrossSmallMapView");var DarkHallBossControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(353,function(){e.isDarkHallBoss?e.dispatchEnterFb():e.lastDarkHallBoss&&e.dispatchQuiKFb()}),e.addCustomEvent(300,function(){e.isDarkHallBoss&&UIMgr.ins().open(BossBelongView)}),e.addCustomEvent(306,e.onBossDisappear),e.addCustomEvent(301,function(){e.isDarkHallBoss&&UIMgr.ins().close(BossBelongView)}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.onBossDisappear=function(){this.isDarkHallBoss&&UIMgr.ins().open(BossEndView)},e.prototype.dispatchEnterFb=function(){this.lastDarkHallBoss=!0,EventMgr.addListener(305,this.reliveInfoChange,this)},e.prototype.reliveInfoChange=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.dispatchQuiKFb=function(){this.lastDarkHallBoss=!1,UIMgr.ins().close(BossBelongView),EventMgr.removeListener(305,this.reliveInfoChange,this),UIMgr.ins().close(BossEndView)},Object.defineProperty(e.prototype,"isDarkHallBoss",{get:function(){return 44==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.getListByTab=function(t){var e=bossControl.worldInfoList[8],i=[];if(!i[t]){i[t]=[];var n=DataCenter.ins().DarkEquipBaConfig.bossDivide[t];if(n)for(var o in e){var s=e[o];n.indexOf(s.id)>-1&&i[t].push(s)}}return i[t]},e.prototype.checkOpen=function(t){var e="";return GameServer.serverOpenDay<DataCenter.ins().DarkEquipBaConfig.openDay-1?e+=LangMgr.getValueByKey("darkHallBossTip1",DataCenter.ins().DarkEquipBaConfig.openDay):reincarnateControl.lv<DataCenter.ins().DarkEquipBaConfig.openLevel?e+=LangMgr.getValueByKey("darkHallBossTip2",DataCenter.ins().DarkEquipBaConfig.openLevel):bossControl.worldInfoList[8]&&GameServer.isOpenLF?devildomControl.isHfTerm()||(e+=LangMgr.getValueByKey("kfTips10")):e+=LangMgr.getValueByKey("darkHallBossTip3"),e&&t&&tipsControl.showTips("|C:0xf3311e&T:"+e),""==e},e.prototype.checkNetTip=function(){return bossControl.worldInfoList[8]?!0:(tipsControl.showTips(LangMgr.getValueByKey("darkHallBossTip4")),!1)},e.prototype.enterFb=function(t){if(this.checkOpen(!0)&&!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()&&this.checkNetTip()){var e=DataCenter.ins().WorldBossConfig[t];if(e.darkforce)for(var i=darkEquipControl.getDarkForceToTal(darkEquipControl.darkEquips),n=e.darkforce,o=0;o<n.length;o++){var s=n[o];if(i[s.type-1]<s.value)return void tipsControl.showTips(LangMgr.getValueByKey("darkHallBossTip5"))}if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{if(!bossControl.worldBossBelongTime[8])return void this.buyCount();bossControl.challengWorldBoss(t,8)}}},e.prototype.buyCount=function(){var t=8,e=DataCenter.ins().WorldBossBaseConfig.challengeItem[t-1],i=bossControl.worldBossBelongBuyTime[t],n=DataCenter.ins().WorldBossBaseConfig.belongbuycount[t-1][vipControl.lv],o=bossControl.worldBossBelongTime[t];if(o>0)return void tipsControl.warnTips(LangMgr.getValueByKey("warriorBossTimeTip",i,n));var s=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e);if(s>0){var r=DataCenter.ins().ItemConfig[e];return void warnControl.show(LangMgr.getValueByKey("expJuanZhouBuyCount",ItemUtils.getQualityColor(r),r.name),function(){backpackControl.upUseItem(e,1),bossControl.upWorldBossInfo(8)},this)}if(!n)return void tipsControl.showTips(LangMgr.getValueByKey("bossTips5"));if(0>=o&&i>=n)return void tipsControl.showTips(LangMgr.getValueByKey("ascriptionArlLimil"));if(ActorControl.yb<DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[t-1])return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));var a=LangMgr.getValueByKey("warriorBelongTimeTip1",DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[t-1],i,n);warnControl.show(a,function(){bossControl.upBuyBelongNum(t)},this)},e}(BaseSystem);__reflect(DarkHallBossControl.prototype,"DarkHallBossControl");var AmusementType5DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.recrod=0,e.logTime=0,e}return __extends(e,t),e.prototype.initAmusement=function(t){this.recrod=t[0]},e.prototype.updateAmusement=function(t){this.recrod=t[1]},e.prototype.updateAmusementExt=function(t){this.logTime=t[0]},e.prototype.canReward=function(t){void 0===t&&(t=0);var e=DataCenter.ins().Amusement5Config[this.id];for(var i in e){var n=this.recrod>>e[i].index&1;if(0==n&&e[i].day<=this.logTime)return!0}return!1},e.prototype.checkOneDayStatu=function(t){void 0===t&&(t=0),0==t&&(t=this.logTime);var e=(DataCenter.ins().Amusement5Config[this.id],this.recrod>>t&1);return 0==e},e.prototype.getCurDay=function(){return this.logTime},e}(AmusementBaseDataVo);__reflect(AmusementType5DataVo.prototype,"AmusementType5DataVo");var DarkHallBossView=function(t){function e(){var e=t.call(this)||this;return e.type=8,e.curIndex=0,e.darkforceColors=[13746831,16776960,39423,16711935,39236,16750848],e.skinName="DarkHallBossViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.titleDt=new eui.ArrayCollection,this.titleList.itemRenderer=DarkHallBossHeadItemRenderer;var e=[];for(var i in DataCenter.ins().DarkEquipBaConfig.bossDivide)for(var n=DataCenter.ins().DarkEquipBaConfig.bossDivide[i],o=0;o<n.length;o++){var s=n[o],r=DataCenter.ins().WorldBossConfig[s];r&&r.openTime<=GameServer.serverOpenDay&&(e[i]||(e[i]=[]),e[i].push(s))}this.titleDt.source=e,this.titleList.dataProvider=this.titleDt,this.titleList.selectedIndex=0,this.listDt=new eui.ArrayCollection,this.list.itemRenderer=DarkHallBossItemRenderer,this.list.dataProvider=this.listDt,this.list.selectedIndex=0,this.dropItemDt=new eui.ArrayCollection,this.dropShow.itemRenderer=ItemBase,this.dropShow.dataProvider=this.dropItemDt,this.bossMc=new GameMovieClip,this.bossMc.scaleX=-1,this.bossMc.scaleY=1,this.bossShow.addChild(this.bossMc),this.titleScroller.horizontalScrollBar=null,this.setting.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.setting.text+"</u></a>"),this.buyLabel.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.buyLabel.text+"</u></a>")},e.prototype.open=function(){this.addCustomEvent(296,this.upData),this.addCustomEvent(547,this.upRedPoint),this.addCustomEvent(547,this.getRedState),this.addEventChange(this.titleList,this.onChange),this.addEventChange(this.list,this.onViewBoss),this.addEventTouchTap(this.buyLabel,this.onTouch),this.addEventTouchTap(this.setting,this.onTouch),this.addEventTouchTap(this.challengeBtn,this.onTouch),this.addEventTouchTap(this.help,this.onTouch),this.leftTimes0.visible=bossControl.checkShowAsist(44),this.leftTimes0.visible&&(this.leftTimes0.textFlow=TextUtils.generateTextFlow1(bossControl.getAsistText())),this.choseTab(),this.onChange(),this.onViewBoss(),bossControl.upWorldBossInfo(8),this.upRedPoint(),this.reChangeRemindEff(),this.getRedState()},e.prototype.getRedState=function(){var t=bossControl.worldInfoList[this.type].slice(),e=[];for(var i in t){var n=DataCenter.ins().WorldBossConfig[t[i].id];n.openTime<=GameServer.serverOpenDay&&e.push(t[i])}var o=[],s=0;e.map(function(t,e){for(var i=DataCenter.ins().WorldBossConfig[t.id],n=i.showReward.map(function(t){return DataCenter.ins().DarkEquipConfig[t]}),r=0,a=0;a<n.length;a++){var l=n[a];l&&(r=l.star>r?l.star:r)}var h=BossControl.isCanChallenge(i);i.darkforce&&(h=t.canInto),r>s&&h&&(s=r);var u=!1;h&&(u=bossControl.getBossRemindByIndex(t.id)),o.push([r,u,h])});var r=!1;o.map(function(t,e){t[0]!=s||r||!t[2]||t[1]||(r=t[2])});this.settingRedPoint&&(this.settingRedPoint.visible=r)},e.prototype.reChangeRemindEff=function(){bossControl.getBossRemindByIndex(9991)?(this.eff||(this.effGroup=new eui.Group,this.effGroup.touchEnabled=!1,this.effGroup.horizontalCenter=this.setting.horizontalCenter,this.effGroup.verticalCenter=this.setting.verticalCenter,this.addChild(this.effGroup),this.eff=new GameMovieClip,this.eff.x=0,this.eff.y=0,this.eff.scaleX=this.eff.scaleY=.7,this.effGroup.addChild(this.eff)),this.eff.playFile(PATH_EFF+"chargeff1",-1)):this.eff&&this.eff.dispose()},e.prototype.choseTab=function(){var t=this;this.titleList.selectedIndex=0;for(var e,i=bossControl.worldInfoList[8].slice(),n=DataCenter.ins().DarkEquipBaConfig.bossDivide,o=Object.keys(n).length-1,s=o;s>=0;s--){for(var r=0;r<i.length;r++){var a=i[r];if(n[s].indexOf(a.id)>-1&&a.canInto){e=s;break}}if(!isNaN(e))break}this.titleList.selectedIndex=e,this.titleList.selectedIndex>2&&TimerMgr.ins().doTimer(200,1,function(){var e=196,i=(t.curIndex-2)*e;t.titleScroller.viewport.scrollH=i},this)},e.prototype.upRedPoint=function(){this.upList(),this.titleDt.replaceAll(this.titleDt.source)},e.prototype.upList=function(){for(var t=darkHallBossControl.getListByTab(this.curIndex),e=[],i=[],n=[],o=[],s=[],r=[],a=0;a<t.length;a++){var l=bossControl.getBossRemindByIndex(t[a].id),h=DataCenter.ins().WorldBossConfig[t[a].id];h&&(t[a].canInto?l?t[a].isDie?n.push(t[a]):i.push(t[a]):t[a].isDie?s.push(t[a]):o.push(t[a]):r.push(t[a]))}i.sort(this.compareFn),n.sort(this.compareFn),r.sort(this.compareFn2),o.sort(this.compareFn),s.sort(this.compareFn),e=i.concat(n,r,o,s),this.listDt.replaceAll(e)},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return i.zsLevel>n.zsLevel?-1:i.zsLevel<n.zsLevel?1:t.id>e.id?-1:t.id<e.id?1:0},e.prototype.compareFn2=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:t.id>e.id?1:t.id<e.id?-1:0},e.prototype.upData=function(){var t=bossControl.worldBossBelongTime[this.type],e=t>0?ColorUtils.GREEN:ColorUtils.RED,i=LangMgr.getValueByKey("darkHallBossBelongTip",e,t);this.leftTimes.textFlow=TextUtils.generateTextFlow1(i),this.upList()},e.prototype.onChange=function(){this.curIndex=this.titleList.selectedIndex,this.titleText.text=LangMgr.getValueByKey("darkBoss")+(this.curIndex+1)+LangMgr.getValueByKey("babelLayer1","",""),this.titleTextImg.source="AndianBoss"+(this.curIndex+1)+"lab",this.upList(),this.listScroller.viewport.scrollV=0,this.list.selectedIndex=0,this.onViewBoss()},e.prototype.onViewBoss=function(){var t=this.list.selectedItem;if(t){this.selectBossData=t;var e=DataCenter.ins().WorldBossConfig[t.id],i=DataCenter.ins().MonstersConfig[e.bossId],n=81108==e.bossId?"4":"3";this.bossMc.playFile(PATH_GUAIWU+(GUAIWU_PREFIX+i.avatar+"_"+n+"s"),-1);var o,s=!1;e.samsaraLv>0?o="":e.zsLevel>0?(o="("+LangMgr.getValueByKey("numberRotation",e.zsLevel)+")",s=reincarnateControl.lv>=e.zsLevel):(o="("+LangMgr.getValueByKey("numberLevel",e.level)+")",s=ActorControl.level>=e.level),this.nameTxt.text=""+i.name+o;var r=s?this.nameTxt0.textColor:ColorUtils.RED;this.nameTxt0.textFlow=TextUtils.generateTextFlow1(i.name+"|C:"+r+"&T:"+o+"|"),this.bossName.visible=t.canInto,this.bossName0.visible=!this.bossName.visible,this.challengeBtn.visible=t.canInto,this.stateImage.visible=t.canInto,this.stateImage.source=t.isDie?"zdbossyijisha":"zdbosskejisha",this.dropItemDt.replaceAll(e.showReward.concat());var a="";if(e.darkforce){for(var l=darkEquipControl.getDarkForceToTal(darkEquipControl.darkEquips),h=!0,u=e.darkforce,p=0;p<u.length;p++){var c=u[p],d=l[c.type-1],g="|C:"+this.darkforceColors[c.type]+"&T:"+d+"/"+c.value+"|";d<c.value&&(g="|C:"+ColorUtils.RED+"&T:"+d+"/"+c.value+"|",h=!1),a+="|C:"+this.darkforceColors[c.type]+"&T:"+darkEquipControl.getDarkTypeName(c.type)+"：|"+g+"\n"}h&&(a="")}this.andianattr.textFlow=TextUtils.generateTextFlow1(a),this.needGroup.visible=""!=a}},e.prototype.onTouch=function(t){switch(t.target){case this.buyLabel:darkHallBossControl.buyCount();break;case this.setting:UIMgr.ins().open(PublicBossRemindView,this.type),bossControl.setBossSetting(9991,!1),this.reChangeRemindEff();break;case this.help:HelpControl.openHelpWin(51);break;case this.challengeBtn:darkHallBossControl.enterFb(this.selectBossData.id)}},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return darkHallBossControl.checkOpen(!0)},e.prototype.close=function(){for(var t=0;t<this.list.numElements;t++)this.list.getElementAt(t)&&this.list.getElementAt(t).destruct()},e}(BaseEuiView);__reflect(DarkHallBossView.prototype,"DarkHallBossView");var DarkHallBossHeadItemRenderer=function(t){function e(){var e=t.call(this)||this;
return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.itemIndex+1;this.bgImg.source="AndianBoss"+t+"Img",DarkHallBossRedPoint.ins().redpoints[t]?this.redPoint1.visible=DarkHallBossRedPoint.ins().redpoints[t].indexOf(1)>-1:this.redPoint1.visible=!1},e}(BaseItemRender);__reflect(DarkHallBossHeadItemRenderer.prototype,"DarkHallBossHeadItemRenderer");var DarkHallBossItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof WorldBossItemVo){var t=DataCenter.ins().WorldBossConfig[this.data.id],e=DataCenter.ins().MonstersConfig[t.bossId];this.head.source="monhead"+e.head+"_png";for(var i=t.showReward.map(function(t){return DataCenter.ins().DarkEquipConfig[t]}),n=0,o=0;o<i.length;o++){var s=i[o];s&&(n=s.star>n?s.star:n)}this.nameTxt0.text=LangMgr.getValueByKey("stageNumberTxt",n),this.nameTxt.text=""+e.name,this.open.visible=!this.data.canInto,this.deadMask.visible=this.data.isDie&&!this.open.visible,this.reliveTime.visible=this.data.isDie&&!this.open.visible,this.data.isDie&&!this.open.visible&&(this.updateTime(),TimerMgr.ins().isExists(this.updateTime,this)||TimerMgr.ins().doTimer(500,0,this.updateTime,this)),this.redPoint.visible=DarkHallBossRedPoint.ins().redById(this.data.id)}},e.prototype.updateTime=function(){var t=this.data.relieveTime-egret.getTimer();0>=t&&(this.reliveTime.visible=!1,bossControl.upWorldBossInfo(8),TimerMgr.ins().remove(this.updateTime,this)),this.reliveTime.text=""+DateUtils.getFormatBySecond(Math.floor(t/1e3),1)},e.prototype.destruct=function(){TimerMgr.ins().remove(this.updateTime,this)},e}(BaseItemRender);__reflect(DarkHallBossItemRenderer.prototype,"DarkHallBossItemRenderer");var DevildomControl=function(t){function e(){var e=t.call(this)||this;return e.refTime=[],e.dropRecordDataList=[],e.isNewRed=!0,e.addCustomEvent(353,function(){e.isDevildomBattle?e.dispatchEnterFb():e.lastDevildom&&e.dispatchQuiKFb()}),e.addCustomEvent(300,function(){e.isDevildomBattle&&UIMgr.ins().open(BossBelongView)}),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"isDevildomBattle",{get:function(){return 39==MapControl.copyType||devildomFinalControl.inCopy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inCopy",{get:function(){return 39==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.downBossInfo=function(t){this.killedState=[];for(var e=[],i=0;i<t.length;i++){var n=t[i][0],o=t[i][1],s=t[i][2];this.killedState[n]=s,e[n]=o}this.historyId&&this.refTime[this.historyId]&&e[this.historyId]!=this.refTime[this.historyId]&&(this.historyId=0),this.refTime=e.concat(),EventMgr.ins().dispatch(332)},e.prototype.downAscriptionChange=function(t,e){var i="";if(t>0){var n=UnitMgr.ins().getMasterList(t);n&&n[0]&&n[0].infoModel&&(i=n[0].infoModel.name)}bossControl.dispatchBelongChange(e,t,i)},e.prototype.downRevive=function(t,e){if(t>0)UIMgr.ins().open(DevildomReliveView,t,e);else if(UIMgr.ins().close(DevildomReliveView),crossFieldControl.isCross){var i=ActorControl.yb-DataCenter.ins().CrossBossBaseConfig.rebornCost;actorControl.dispatchYbChange(i)}EventMgr.ins().dispatch(333)},e.prototype.downResult=function(t,e,i,n,o){for(var s=[],r=0;r<n.length;r++){var a=new RewardVo;a.init(n[r]),s.push(a)}for(var l=[],r=0;r<o.length;r++){var h=o[r];l.push(DataCenter.ins().BargainItemConfig[h].item)}o.length>0&&CommonFun.regKFBackFun(function(){UIMgr.ins().open(BargainView,BargainControl.TYPE_UNION)}),UIMgr.ins().open(DevildomResultView,e,t,i,l,s)},e.prototype.downInfo=function(t,e){this.historyId=t,this.enterCD=1e3*e+egret.getTimer(),EventMgr.ins().dispatch(334)},e.prototype.downHudun=function(t,e){null!=t&&null!=e&&(this.hudun=t,this.hudunMax=e),this.hudun>0&&(this.hudun--,TimerMgr.ins().doTimer(1e3,1,this.downHudun,this)),EventMgr.ins().dispatch(335)},e.prototype.downFenAward=function(t){this.fenAward=[];for(var e=0;t.length>e;e++){var i=new RewardVo;i.init(t[e]),i.count>0&&this.fenAward.push(i)}EventMgr.ins().dispatch(336)},e.prototype.upClearReliveCD=function(){},e.prototype.upCleanBelong=function(){},e.prototype.enterCopy=function(t){var e=this;warnControl.showDangerWarn(function(){e.upEnter(t)})},e.prototype.upEnter=function(t){return[t]},e.prototype.dispatchEnterFb=function(){this.lastDevildom=!0,UIMgr.ins().open(DevildomFightInfoView)},e.prototype.dispatchQuiKFb=function(){this.lastDevildom=!1,UIMgr.ins().close(BossBelongView),UIMgr.ins().close(DevildomFightInfoView)},e.prototype.isOpen=function(){return GameServer.isOpenLF&&GameServer.serverOpenDay+1>=DataCenter.ins().DevildomBossBsConfig.openDay&&this.isHfTerm()},e.prototype.isHfTerm=function(){var t=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime)+DataCenter.ins().DevildomBossBsConfig.hefuTimeLimit*DateUtils.MS_PER_DAY;return GameServer.serverTime-t>0},e.prototype.getDevildomOpenLeftTime=function(){var t=DataCenter.ins().DevildomBossBsConfig.startTime,e=new Date(GameServer.serverTime);e.setHours(t[0],t[1],0,0);var i=new Date(GameServer.serverTime);return i.setDate(i.getDate()+1),i.setHours(t[0],t[1],0,0),e.getTime()>=GameServer.serverTime?Math.floor((e.getTime()-GameServer.serverTime)/1e3):Math.floor((i.getTime()-GameServer.serverTime)/1e3)},e.prototype.hasDevildomFenAward=function(){return this.fenAward&&this.fenAward.length?!0:!1},e.prototype.getDevildomFenAwardRed=function(){return this.hasDevildomFenAward()&&(unionControl.myOffice>=5||this.isNewRed)?!0:!1},e.prototype.getCurBossIdByIndex=function(t){var e=DataCenter.ins().DevildomBossConfig[t].openBossList;return e[0]||e[1]},e.prototype.getCurFbIndex=function(){var t=i.ins();if(t.historyId)return t.historyId-1;var e=[];for(var n in t.killedState)t.killedState[n]||e.push(n);return e.length>0?e[MathUtils.limit(0,e.length)>>0]-1:MathUtils.limit(0,3)>>0},__decorate([down(1,[[2,3,0]])],e.prototype,"downBossInfo",null),__decorate([down(2,[10,10])],e.prototype,"downAscriptionChange",null),__decorate([down(3,[3,10])],e.prototype,"downRevive",null),__decorate([down(7,[8,10,0,ByteConst.RewardVos,[3]])],e.prototype,"downResult",null),__decorate([down(8,[2,2])],e.prototype,"downInfo",null),__decorate([down(9,[2,2])],e.prototype,"downHudun",null),__decorate([down(10,[ByteConst.RewardVos])],e.prototype,"downFenAward",null),__decorate([up(3)],e.prototype,"upClearReliveCD",null),__decorate([up(4)],e.prototype,"upCleanBelong",null),__decorate([up(5,[3])],e.prototype,"upEnter",null),e=i=__decorate([protocolsId(75)],e);var i}(BaseSystem);__reflect(DevildomControl.prototype,"DevildomControl");var DevildomFinalControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startTimestamp=0,e.endTimestamp=0,e.enterCd=0,e.myGuildRank=-1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.isReadyOpen=function(){return this.sTime>0||this.eTime>0},e.prototype.isStart=function(){return this.sTime<0&&this.eTime>0},Object.defineProperty(e.prototype,"sTime",{get:function(){return(DateUtils.formatMiniDateTime(this.startTimestamp)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eTime",{get:function(){return(DateUtils.formatMiniDateTime(this.endTimestamp)-GameServer.serverTime)/DateUtils.MS_PER_SECOND>>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inCopy",{get:function(){return 58==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.downInfo=function(t,e,i,n,o){this.startTimestamp=t,this.endTimestamp=e,this.enterCd=1e3*i+egret.getTimer(),this.isOver=n,this.guildList=[];for(var s=0;o.length>s;s++){var r=o[s][0],a=o[s][1];this.guildList.push("S"+r+" "+a)}this.isReadyOpen()&&!TimerMgr.ins().isExists(this.onTime,this)&&TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.isReadyOpen()&&this.upGuildBelong(),this.dispatchUpStatus(),EventMgr.ins().dispatch(512)},e.prototype.onTime=function(){(0==this.sTime||0==this.eTime)&&this.dispatchUpStatus(),this.eTime<0&&(TimerMgr.ins().remove(this.onTime,this),devildomFinalControl.upLastInfo())},e.prototype.dispatchUpStatus=function(){this.isReadyOpen()&&(this.lastInfoS=null),EventMgr.ins().dispatch(697)},e.prototype.upGuildBelong=function(){},e.prototype.downGuildBelong=function(t){this.belongGuildList=[];for(var e=0;t.length>e;e++){var i=new DevildomGuildVo;i.init(t[e]),this.belongGuildList[e]=i}this.belongGuildList.sort(function(t,e){return SortUtils.sortDescByKey(t,e,"belongNum")});for(var n=this.belongGuildList.length,e=0;n>e;e++){var i=this.belongGuildList[e];i.rank=e+1,i.guildId==unionControl.guildID&&(this.myGuildRank=i.rank)}EventMgr.ins().dispatch(513)},e.prototype.upEnter=function(){},e.prototype.downChangeBelong=function(t,e){var i="";if(t>0){var n=UnitMgr.ins().getMasterList(t);n&&n[0]&&n[0].infoModel&&(i=n[0].infoModel.name)}bossControl.dispatchBelongChange(e,t,i)},e.prototype.upCancelBelong=function(){},e.prototype.downRelive=function(t,e){var i=Math.floor((DateUtils.formatMiniDateTime(t)-GameServer.serverTime)/DateUtils.MS_PER_SECOND);i>0?UIMgr.ins().open(DevildomReliveView,i,e):UIMgr.ins().close(DevildomReliveView)},e.prototype.upBuyReliveCd=function(){},e.prototype.downResult=function(t,e,i,n,o){for(var s=[],r=0;n.length>r;r++)s.push(DataCenter.ins().BargainItemConfig[n[r]].item);for(var a=[],r=0;o.length>r;r++){var l=new RewardVo;l.init(o[r]),a.push(l)}var h=UnitMgr.ins().getNoDieEntityBymasterhHandle(e);h?CommonFun.dropEff(a,h,function(){UIMgr.ins().open(DevildomFinalResultView,t,h,i,s,a)}):UIMgr.ins().open(DevildomFinalResultView,t,e,i,s,a),CommonFun.regKFBackFun(function(){UIMgr.ins().open(BargainView,BargainControl.TYPE_KF)})},e.prototype.downLastInfo=function(t,e,i){!e||!i||this.isReadyOpen()&&!this.isOver?this.lastInfoS=null:(this.lastInfoS=[],this.lastInfoS[0]=LangMgr.getValueByKey("kfDevilFinalInfoTip"),this.lastInfoS[1]=LangMgr.getValueByKey("kfDevilFinalInfoTip1",e),this.lastInfoS[2]=LangMgr.getValueByKey("kfDevilFinalInfoTip2"),this.lastInfoS[3]="S"+t+" "+i),EventMgr.ins().dispatch(514)},e.prototype.upLastInfo=function(){},e.prototype.isOpen=function(){return this.isOpenView()&&reincarnateControl.lv>=DataCenter.ins().DevildomBigBossBsConfig.zsLevelLimit},e.prototype.isOpenView=function(){return GameServer.serverOpenDay+1>=DataCenter.ins().DevildomBigBossBsConfig.openDay},__decorate([down(1,[3,3,3,0,[3,8]])],e.prototype,"downInfo",null),__decorate([up(2)],e.prototype,"upGuildBelong",null),__decorate([down(2,[ByteConst.DevildomGuildVos])],e.prototype,"downGuildBelong",null),__decorate([up(3)],e.prototype,"upEnter",null),__decorate([down(4,[10,10])],e.prototype,"downChangeBelong",null),__decorate([up(5)],e.prototype,"upCancelBelong",null),__decorate([down(6,[3,10])],e.prototype,"downRelive",null),__decorate([up(7)],e.prototype,"upBuyReliveCd",null),__decorate([down(8,[8,10,0,[3],ByteConst.RewardVos])],e.prototype,"downResult",null),__decorate([down(9,[3,8,8])],e.prototype,"downLastInfo",null),__decorate([up(9)],e.prototype,"upLastInfo",null),e=__decorate([protocolsId(32)],e)}(BaseSystem);__reflect(DevildomFinalControl.prototype,"DevildomFinalControl");var AmusementType6DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardsBossSum=[],e}return __extends(e,t),e.prototype.initAmusement=function(t){this.record=t[0];for(var e=0;e<t[1].length;e++)this.rewardsBossSum[e+1]=t[1][e]},e.prototype.updateAmusement=function(t){this.record=t[1]},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.getBossGroup=function(t,e){for(var i=this.getBossGroupIndex(t,e),n=0;n<i.length;n++)if(!i[n])return AmusementControl.NOKILL;return AmusementControl.KILL},e.prototype.getBossGroupIndex=function(t,e){for(var i=[],n=t<<1,o=1;3>=o;o++){var s=Math.floor(n/Math.pow(2,o))%2;i.push(s)}return i},e.prototype.getBossGroupGiftIndex=function(t){var e=Math.floor(this.record/Math.pow(2,t.index))%2;return e?AmusementControl.Geted:AmusementControl.CanGet},e.prototype.checkRedPoint=function(){var t=DataCenter.ins().Amusement6Config[this.id],e=1;for(var i in t){var n=this.getBossGroupGiftIndex(t[i]),o=this.getBossGroup(this.rewardsBossSum[e],t[i]);if(o==AmusementControl.KILL&&n==AmusementControl.CanGet)return!0;e++}return!1},e.prototype.getHide=function(){if(this.isHide)return this.isHide;var t=this.record>>1,e=DataCenter.ins().Amusement6Config[this.id],i=Object.keys(e);return t>=Math.pow(2,i.length)-1?(this.isHide=!0,this.isHide):(this.isHide=!1,this.isHide)},e}(AmusementBaseDataVo);__reflect(AmusementType6DataVo.prototype,"AmusementType6DataVo");var DevildomGuildVo=function(){function t(){}return t.prototype.init=function(t){this.sevrId=t[0],this.name=t[1],this.belongNum=t[2],this.guildId=t[3]},t}();__reflect(DevildomGuildVo.prototype,"DevildomGuildVo");var DevildomBelongAwardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomBelongAwardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.saleReward0.itemRenderer=ItemBase,this.belongReward0.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.BG,this.onCloseWin),this.addEventTouchTap(this.tipGroup1,this.onCloseWin),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onCloseWin),this.belongReward0.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.belongAwards)),this.saleReward0.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.belongSaleAwards))},e.prototype.onCloseWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DevildomBelongAwardView.prototype,"DevildomBelongAwardView");var DevildomBossAwardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomBossAwardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.belongReward1.itemRenderer=ItemBase,this.saleReward1.itemRenderer=ItemBase,this.belongReward0.itemRenderer=ItemBase,this.saleReward0.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onCloseWin),this.addEventTouchTap(this.giveUp,this.onCloseWin),this.belongReward1.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.belongAwards)),this.saleReward1.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.belongSaleAwards)),this.belongReward0.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.partAwards)),this.saleReward0.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.partSaleAwards))},e.prototype.onCloseWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DevildomBossAwardView.prototype,"DevildomBossAwardView");var DevildomFightInfoView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomFightInfoViewSkin",e.uilayer=GameLayer.POPUP,e.datalist=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){devildomFinalControl.inCopy||DisplayUtils.removeFromParent(this.leftTimeLabel),this.addEventTouchTap(this.detailLabel,this.onTouch),this.addCustomEvent(356,this.onRemove),this.addCustomEvent(370,this.onFbTime),this.onFbTime(),this.detailLabel.textFlow=TextUtils.formatUnderLineStr(this.detailLabel.text),this.upTeam(),TimerMgr.ins().isExists(this.upTeam,this)||TimerMgr.ins().doTimer(1e3,0,this.upTeam,this)},e.prototype.onTouch=function(t){switch(t.target){case this.detailLabel:UIMgr.ins().open(DevildomGuildMembersView,this.datalist)}},e.prototype.onRemove=function(t){var e=(t[0],t[1]);e instanceof UnitRole&&this.upTeam()},e.prototype.onFbTime=function(){this.curFBTime=1e3*copyControl.curFbLeftTime+egret.getTimer()},e.prototype.upTeam=function(){if(devildomFinalControl.inCopy){var t=(this.curFBTime-egret.getTimer())/1e3>>0;if(t>0){var e=LangMgr.getValueByKey("expHaveTime","|C:"+LangMgr.getColor("color43")+"&T:"+DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3)+"|");this.leftTimeLabel.textFlow=TextUtils.generateTextFlow1(e),this.leftTimeLabel.visible=!0}else this.leftTimeLabel.visible=!1}var i=UnitMgr.ins().getNoDieRole();if(i){var n=UnitMgr.ins().getAllEntity(),o=[],s={};for(var r in n){var a=n[r].infoModel;a.guildID==unionControl.guildID&&!a.isMy&&n[r]instanceof UnitRole&&(s[a.masterHandle]=a,o[Object.keys(s).length-1]=s[a.masterHandle])}this.datalist.replaceAll(o),this.myGuildNumLabel.text=LangMgr.getValueByKey("kfDevildomGuildNum",o.length)}},e}(BaseEuiView);__reflect(DevildomFightInfoView.prototype,"DevildomFightInfoView");var DevildomFinalAwardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomFinalAwardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.auctionReward.itemRenderer=ItemBase,this.belongReward.itemRenderer=ItemBase,this.partReward.itemRenderer=ItemBase},e.prototype.open=function(){this.addEventTouchTap(this.BG,this.onTouch);var t=RewardVo.getRewardsByOpenDay(DataCenter.ins().DevildomBigBossBsConfig.showGoodsReward),e=RewardVo.getRewardsByOpenDay(DataCenter.ins().DevildomBigBossBsConfig.showBelongReward),i=RewardVo.getRewardsByOpenDay(DataCenter.ins().DevildomBigBossBsConfig.showJoinReward);this.auctionReward.dataProvider=new eui.ArrayCollection(t),this.belongReward.dataProvider=new eui.ArrayCollection(e),this.partReward.dataProvider=new eui.ArrayCollection(i)},e.prototype.onTouch=function(t){switch(t.target){case this.BG:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DevildomFinalAwardView.prototype,"DevildomFinalAwardView");var DevildomFinalPanel=function(t){function e(){var e=t.call(this)||this;return e.comPos=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.bossBody=new GameMovieClip,this.bossBody.x=0,this.bossBody.y=0,this.bossGroup.addChild(this.bossBody),this.detailLabel.textFlow=TextUtils.formatUnderLineStr(this.detailLabel.text),this.bitReward.itemRenderer=ItemBase,this.comPos[0]=this.timeGroup.top,this.comPos[1]=this.bossName.y,this.comPos[2]=this.guildGroup.left,this.comPos[3]=this.timeTips.top,this.guildGroup.mask=this.maskImg,DataCenter.ins().DevildomBigBossBsConfig.open&&(this.comeTimeLabel.text=StringUtils.getChineseWeek(DataCenter.ins().DevildomBigBossBsConfig.open))},e.prototype.hideCom=function(){this.rewardGroup.visible=!1,this.timeGroup.top=-100,this.bossName.y=-280,this.guildGroup.left=-230,this.timeTips.top=-100},e.prototype.playComAnima=function(){var t=500,e=egret.Ease.backOut;egret.Tween.get(this.timeGroup).to({top:this.comPos[0]},t,e),egret.Tween.get(this.bossName).to({y:this.comPos[1]},t,e),egret.Tween.get(this.guildGroup).to({left:this.comPos[2]},t,e),egret.Tween.get(this.timeTips).to({top:this.comPos[3]},t,e),this.rewardGroup.visible=!0},e.prototype.playBossMc=function(){var t=this,e=DataCenter.ins().DevildomBigBossBsConfig.monInfo;e||(e=GUAIWU_PREFIX+"110020_3");var i=function(){t.bossBody.playFile(PATH_GUAIWU+e+UnitAction.STAND,-1,null,!1)},n=function(){TimerMgr.ins().doTimer(300,1,t.showAward,t),t.bossBody.playFile(PATH_GUAIWU+e+UnitAction.ATTACK,1,function(){i()},!1)};this.bossBody.playFile(PATH_GUAIWU+e+UnitAction.RUN,2,function(){n()},!1),this.bossBody.scaleX=.2,this.bossBody.scaleY=.2,this.bossBody.x=-300,this.bossBody.y=-400,this.bossBody.alpha=0,egret.Tween.get(this.bossBody).to({scaleX:.4,scaleY:.4,x:-200,y:-280,alpha:1},400).to({scaleX:1,scaleY:1,x:0,y:0},700)},e.prototype.open=function(){this.addEventTouchTap(this.detailLabel,this.onTouch),this.addEventTouchTap(this.challengeBtn,this.onTouch),this.addCustomEvent(512,this.upData),this.addCustomEvent(514,this.upData),this.addCustomEvent(516,this.refRedpoint),this.upData(),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime(),devildomFinalControl.upGuildBelong(),devildomFinalControl.upLastInfo(),this.bitReward.visible=!1,this.playBossMc(),this.hideCom(),ServerStorage.ins().getValue(21)||(ServerStorage.ins().setValue(21,1),DevildomRedPoint.ins().dispatchBigRedPoint()),this.refRedpoint()},e.prototype.close=function(){this.$onClose(),TimerMgr.ins().removeAll(this),egret.Tween.removeTweens(this.bossBody),egret.Tween.removeTweens(this.timeGroup),egret.Tween.removeTweens(this.timeTips),egret.Tween.removeTweens(this.bossName),egret.Tween.removeTweens(this.guildGroup),this.bossBody.clearComFun()},e.prototype.showAward=function(){this.bitReward.visible=!0,this.bitReward.dataProvider=new eui.ArrayCollection(RewardVo.getRewardsByOpenDay(DataCenter.ins().DevildomBigBossBsConfig.showBigReward)),TweenUtil.ListAnimation(this.bitReward,3,100,0),this.playComAnima()},e.prototype.onTime=function(){var t=DevildomFinalControl.ins();this.timeGroup.visible=!0,this.timeTips.visible=!1,t.sTime>0?(this.timeTitle.source="kf_mzjl_time0",this.timeBitmapLabel.text=DateUtils.getFormatBySecond(t.sTime,DateUtils.TIME_FORMAT_3),this.challengeBtn.enabled=!1):t.isOver||t.eTime<0?(this.challengeBtn.enabled=!1,this.timeGroup.visible=!1,this.timeTips.visible=!0):(this.timeTitle.source="kf_mzjl_time1",this.timeBitmapLabel.text=DateUtils.getFormatBySecond(t.eTime,DateUtils.TIME_FORMAT_3),this.challengeBtn.enabled=!0)},e.prototype.onTouch=function(t){switch(t.target){case this.detailLabel:UIMgr.ins().open(DevildomFinalAwardView);break;case this.challengeBtn:var e=(devildomFinalControl.enterCd-egret.getTimer())/1e3>>0;if(e>0)return void tipsControl.showTips(LangMgr.getValueByKey("waitSecondEnter",e));if(!unionControl.guildID)return void tipsControl.showTips(LangMgr.getValueByKey("kfDevilFinalNoGuild"));if(-1==devildomFinalControl.myGuildRank||devildomFinalControl.myGuildRank>4)return void tipsControl.showTips(LangMgr.getValueByKey("kfDevilFinalGuildWinTip"));if(reincarnateControl.lv<DataCenter.ins().DevildomBigBossBsConfig.zsLevelLimit)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips40",DataCenter.ins().DevildomBigBossBsConfig.zsLevelLimit));warnControl.showDangerWarn(function(){devildomFinalControl.upEnter()})}},e.prototype.upData=function(){var t=DevildomFinalControl.ins(),e=t.lastInfoS?t.lastInfoS:t.guildList;this.hint.visible=!0,this.infoTitle.text=t.lastInfoS?LangMgr.getValueByKey("kfDevilFinalInfoTip3"):LangMgr.getValueByKey("kfDevilFinalInfoTip4");for(var i=0;4>i;i++)e&&e[i]?(this["guildLabel"+i].textFlow=TextUtils.generateTextFlow1(e[i]),this["guildLabel"+i].visible=!0,this.hint.visible=!1):this["guildLabel"+i].visible=!1},e.prototype.refRedpoint=function(){this.redPoint.visible=DevildomRedPoint.ins().redPoint2},e}(BasePanel);__reflect(DevildomFinalPanel.prototype,"DevildomFinalPanel");var DevildomFinalResultView=function(t){function e(){var e=t.call(this)||this;return e.closeTime=10,e.skinName="DevildomFinalResultViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.createChildren=function(){this.saleList.itemRenderer=ItemBase,this.rewardList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTonch);var i=t[0],n=t[1],o=t[2],s=t[3],r=t[4],a=n instanceof UnitRole?n:UnitMgr.ins().getEntityBymasterhHandle(n);a?(this.roleIcon.icon="yuanhead"+a.infoModel.job+a.infoModel.sex,this.roleIcon.jobImg.source="job"+a.infoModel.job+"Item",this.belongTxt.text=i):(this.roleIcon.icon=null,this.roleIcon.jobImg.source=null,this.belongTxt.text=LangMgr.getValueByKey("kfDevilFinalNoBelong")),this.saleList.dataProvider=new eui.ArrayCollection(s),this.rewardList.dataProvider=new eui.ArrayCollection(r),o||(this.rewardLabel.text=LangMgr.getValueByKey("kfDevilFinalPartReward")),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,20,this.onTime,this)},e.prototype.onTonch=function(t){switch(t.target){case this.bg:case this.closeBtn:this.onClose()}},e.prototype.onTime=function(){this.closeTime<0?this.onClose():(this.closeBtn.label=LangMgr.getValueByKey("kfDevilFinalGetReward",this.closeTime),this.closeTime--)},e.prototype.onClose=function(){UIMgr.ins().close(this),copyControl.upExitFb()},e}(BaseEuiView);__reflect(DevildomFinalResultView.prototype,"DevildomFinalResultView");var DevildomGuildMembersView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomGuildMembersViewSkin",e.uilayer=GameLayer.POPUP,e.list.itemRenderer=DevildomGuildMembersItemRenderer,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.dataProvider=t[0],this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.list,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;default:if(t.target instanceof DevildomGuildMembersItemRenderer){var e=t.target.data;rankOtherUserControl.upFindPlayer(e.configID,0)}}},e}(BaseEuiView);__reflect(DevildomGuildMembersView.prototype,"DevildomGuildMembersView");var DevildomPanel=function(t){function e(){var e=t.call(this)||this;return e.MAX_LEN=4,e.TAB_W=92,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=Object.keys(DataCenter.ins().DevildomBossConfig).length;this.leftGroup.visible=e>this.MAX_LEN,this.rightGroup.visible=e>this.MAX_LEN,this.refreshTime.text=DataCenter.ins().DevildomBossBsConfig.startTime[0]+":"+DataCenter.ins().DevildomBossBsConfig.startTime[1],this.showRank.textFlow=TextUtils.formatUnderLineStr(this.showRank.text),this.bossBody=new GameMovieClip,this.bossBody.x=0,this.bossBody.y=0,this.bossGroup.addChild(this.bossBody),this.menuList.itemRenderer=DevildomBossItemRenderer,this.menuData=new eui.ArrayCollection,this.menuList.dataProvider=this.menuData},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.challengeBtn,this.onTouch),this.addEventTouchTap(this.belongBtn,this.onTouch),this.addEventTouchTap(this.partBtn,this.onTouch),this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchTap(this.showRank,this.onTouch),this.addEventChange(this.menuList,this.onChoose),this.addEventChangeEnd(this.menuScroller,this.onChange),this.addCustomEvent(332,this.initData),this.control=DevildomControl.ins(),this.initData();var i=isNaN(t[0])?0:t[0];this.menuList.selectedIndex=i,this.selectBoss(i)},e.prototype.close=function(){this.$onClose()},e.prototype.initData=function(){this.menuData.replaceAll(CommonUtils.objectToArrayShallow(DataCenter.ins().DevildomBossConfig))},e.prototype.onChange=function(){this.menuList.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.menuList.scrollH>88*(this.menuList.dataProvider.length-this.MAX_LEN)+2?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.menuList.dataProvider.length<=5&&(this.leftBtn.visible=!1,this.rightBtn.visible=!1)},e.prototype.onTouch=function(t){var e=this;switch(t.target){case this.challengeBtn:if(!crossArenaControl.checkIsMatching())return;var i=(this.control.enterCD-egret.getTimer())/1e3>>0;if(i>0)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips4",i));var n=DataCenter.ins().DevildomBossConfig[this.menuList.selectedItem.id],o=n.levelLimit/1e3>>0;if(o>reincarnateControl.lv)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips5",o));var s=n.levelLimit%1e3;if(s>ActorControl.level)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips6",s));if(this.control.historyId){if(this.control.historyId!=this.menuList.selectedItem.id)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips8",DataCenter.ins().DevildomBossConfig[this.control.historyId].bossName));this.control.enterCopy(this.menuList.selectedItem.id)}else warnControl.show(LangMgr.getValueByKey("kfTips7"),function(){e.control.enterCopy(e.menuList.selectedItem.id)},this);break;case this.belongBtn:UIMgr.ins().open(DevildomBelongAwardView);break;case this.showRank:UIMgr.ins().open(DevildomRankView);break;case this.partBtn:UIMgr.ins().open(DevildomPartAwardView);break;case this.leftBtn:var r=this.TAB_W*this.MAX_LEN,a=this.menuList.scrollH-r;a=Math.round(a/this.TAB_W)*this.TAB_W,0>a&&(a=0),this.menuList.scrollH=a;break;case this.rightBtn:var l=this.TAB_W*this.MAX_LEN,h=this.menuList.scrollH+l;h=Math.round(h/this.TAB_W)*this.TAB_W,h>this.menuList.contentWidth-this.menuScroller.width&&(h=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=h}},e.prototype.onChoose=function(t){this.selectBoss(this.menuList.selectedIndex)},e.prototype.selectBoss=function(t){if(this.menuList.selectedItem){var e=this.menuList.selectedItem.id,i=devildomControl.getCurBossIdByIndex(e),n=DataCenter.ins().MonstersConfig[i],o=GUAIWU_PREFIX+n.avatar+"_3s";this.bossBody.playFile(PATH_GUAIWU+o,-1),this.bossName.source="invasion_boss_name"+t,this.challengeBtn.enabled=this.control.killedState.length>0&&!this.control.killedState[e]}},e}(BasePanel);__reflect(DevildomPanel.prototype,"DevildomPanel");var DevildomPartAwardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomPartAwardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.saleReward.itemRenderer=ItemBase,this.belongReward.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.BG,this.onCloseWin),this.addEventTouchTap(this.tipGroup0,this.onCloseWin),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onCloseWin),this.belongReward.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.partAwards)),this.saleReward.dataProvider=new eui.ArrayCollection(CommonUtils.objectToArray(DataCenter.ins().DevildomBossBsConfig.partSaleAwards))},e.prototype.onCloseWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DevildomPartAwardView.prototype,"DevildomPartAwardView");var DevildomRankView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevildomRankViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.createChildren=function(){this.list.itemRenderer=DevildomRankItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];-1==devildomFinalControl.myGuildRank?this.myGuildInfo.text=unionControl.guildID?LangMgr.getValueByKey("kfDevildomRankTip1"):LangMgr.getValueByKey("kfDevildomRankTip2"):this.myGuildInfo.text=LangMgr.getValueByKey("kfDevildomRankTip3")+devildomFinalControl.myGuildRank,this.addEventTouchTap(this.bgClose,this.onTouch),this.addCustomEvent(513,this.onList),this.onList(),devildomFinalControl.upGuildBelong()},e.prototype.onList=function(){var t=devildomFinalControl.belongGuildList;this.list.dataProvider=new eui.ArrayCollection(t||[]),this.hint.visible=!t||!t.length},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DevildomRankView.prototype,"DevildomRankView");var DevildomReliveView=function(t){function e(){var e=t.call(this)||this;return e.remainM=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossBeKillViewSkin",this.aliveNum=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.reliveBtn,this.onRelive),this.addEventTouchTap(this.exitBtn,this.onTap),this.setWin(t[0],t[1])},e.prototype.setWin=function(t,e){if(e>0){var i=UnitMgr.ins().getEntityByHandle(e),n="";if(i){var o=UnitMgr.ins().getEntityByHandle(i.infoModel.masterHandle);n=i instanceof UnitRole?i.infoModel.name:i.infoModel.masterHandle&&o?""+o.infoModel.name:"Boss"+i.infoModel.name}this.killTips.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips1",LangMgr.getColor("color74"),n)),this.alive.visible=!1,this.alive.visible&&(this.alive.text=LangMgr.getValueByKey("bossReshProp",this.aliveNum))
}this.reliveBtn.label=LangMgr.getValueByKey("bossReshLocal",DataCenter.ins().DevildomBossBsConfig.rebornCost),this.reliveTimesTxt.text=t+LangMgr.getValueByKey("activitSS"),this.remainM=t,TimerMgr.ins().doTimer(1e3,this.remainM,this.refushLabel,this,this.overTime,this)},e.prototype.refushLabel=function(){this.remainM--,this.reliveTimesTxt.text=this.remainM+LangMgr.getValueByKey("activitSS")},e.prototype.overTime=function(){UIMgr.ins().close(this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.exitBtn:copyControl.upExitFb()}},e.prototype.onRelive=function(t){devildomFinalControl.inCopy?CommonFun.checkCurrency(DataCenter.ins().DevildomBigBossBsConfig.rebornCost,2,LangMgr.getValueByKey("customBossNoYB"))&&devildomFinalControl.upBuyReliveCd():this.aliveNum?devildomControl.upClearReliveCD():CommonFun.checkCurrency(DataCenter.ins().DevildomBossBsConfig.rebornCost,2,LangMgr.getValueByKey("customBossNoYB"))&&devildomControl.upClearReliveCD()},e}(BaseEuiView);__reflect(DevildomReliveView.prototype,"DevildomReliveView");var DevildomResultView=function(t){function e(){var e=t.call(this)||this;return e.quitTime=30,e.skinName="DevildomResultViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.saleList.itemRenderer=ItemBase,this.rewardList.itemRenderer=ItemBase,this.allocateList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onCloseWin);var i=UnitMgr.ins().getEntityByHandle(t[0]);if(i){var n=i.infoModel,o=n.name;o=StringUtils.replaceStr(o,LangMgr.getValueByKey("color39"),ColorUtils.GREEN+""),this.belongTxt.textFlow=TextUtils.generateTextFlow1(o+"【"+n.guildName+"】"),this.roleIcon.icon="yuanhead"+n.job+n.sex}else this.belongTxt.textFlow=TextUtils.generateTextFlow1(""+t[1]);this.roleIcon.jobImg.visible=!1,t[2]||(this.rewardLabel.text=LangMgr.getValueByKey("tongJoinAwards"));var s=t[3];this.saleList.dataProvider=new eui.ArrayCollection(s),0==s.length&&(this.saleLabel.text=LangMgr.getValueByKey("kfTips2"));var r=t[4];this.rewardList.dataProvider=new eui.ArrayCollection(r);var a=devildomControl.fenAward;a&&a.length?this.allocateList.dataProvider=new eui.ArrayCollection(a):(DisplayUtils.removeFromParent(this.allocateLabel),DisplayUtils.removeFromParent(this.allocateScroller)),TimerMgr.ins().doTimer(1e3,this.quitTime+1,this.onTimer,this),this.onTimer()},e.prototype.onCloseWin=function(){UIMgr.ins().close(this),copyControl.upExitFb()},e.prototype.onTimer=function(){this.closeBtn.label=LangMgr.getValueByKey("kfTips3",--this.quitTime),this.quitTime<=0&&this.onCloseWin()},e}(BaseEuiView);__reflect(DevildomResultView.prototype,"DevildomResultView");var DevildomView=function(t){function e(){var e=t.call(this)||this;return e.oldIndex=0,e.skinName="DevildomViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addCustomEvent(517,this.refRedpoint),this.checkStatus(),this.refRedpoint()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.getElementAt(this.oldIndex).close()},e.prototype.checkStatus=function(){devildomFinalControl.isOpenView()?this.setOpenIndex(devildomFinalControl.isReadyOpen()?1:0):(this.tab.visible=!1,this.setOpenIndex(0))},e.prototype.onTabTouch=function(t){this.setOpenIndex(this.tab.selectedIndex)},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.setOpenIndex=function(t){switch(this.viewStack.getElementAt(this.oldIndex).close(),t){case 0:this.devildomPanel.open(devildomControl.getCurFbIndex());break;case 1:this.devildomFinalPanel.open()}this.oldIndex=t,this.tab.selectedIndex=this.viewStack.selectedIndex=t},e.prototype.onTouch=function(t){switch(t.target){case this.seeRule:0==this.tab.selectedIndex?HelpControl.openHelpWin(38):1==this.tab.selectedIndex&&HelpControl.openHelpWin(63);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.refRedpoint=function(){this.redPoint0.visible=DevildomRedPoint.ins().redPoint1&&this.tab.visible,this.redPoint1.visible=DevildomRedPoint.ins().redPoint2&&this.tab.visible},e.openCheck=function(){var t=devildomControl.isOpen();return GameServer.isOpenLF?devildomControl.isHfTerm()?GameServer.serverOpenDay+1<DataCenter.ins().DevildomBossBsConfig.openDay&&tipsControl.showTips(LangMgr.getValueByKey("kfTips11",DataCenter.ins().DevildomBossBsConfig.openDay)):tipsControl.showTips(LangMgr.getValueByKey("kfTips10")):tipsControl.showTips(LangMgr.getValueByKey("kfTips9")),t},e}(BaseEuiView);__reflect(DevildomView.prototype,"DevildomView");var DevildomBossItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data.id){var t=DevildomControl.ins();this.itemIcon.source="invasion_boss_head"+(this.data.id-1),this.nameLabel.text=DataCenter.ins().DevildomBossConfig[this.data.id].bossName,this.redPoint.visible=DevildomRedPoint.ins().redPoint1s[this.data.id],this.state.visible=t.killedState[this.data.id]}},e}(BaseItemRender);__reflect(DevildomBossItemRenderer.prototype,"DevildomBossItemRenderer");var DevildomGuildMembersItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof RoleModel){this.face.source="head_"+this.data.job+this.data.sex;var t=unionControl.getGuildInfoByName(this.data.name),e=t?t.office:0;this.nameLab.text="["+LangMgr.getValueByKey("officeName"+e)+"]",this.nameLab0.text=this.data.name,this.attack.text=(t&&t.attack||0)+""}},e}(BaseItemRender);__reflect(DevildomGuildMembersItemRenderer.prototype,"DevildomGuildMembersItemRenderer");var DevildomRankItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof DevildomGuildVo&&(this.belongTxt.text=this.data.belongNum+"",this.servIdTxt.text="S"+this.data.sevrId,this.nameTxt.text=this.data.name,this.rankLabel.text=this.data.rank+"",this.bg1.visible=this.data.rank<=4,this.bg0.visible=!this.bg1.visible)},e}(BaseItemRender);__reflect(DevildomRankItemRenderer.prototype,"DevildomRankItemRenderer");var DominateBossControl=function(t){function e(){var e=t.call(this)||this;return e.canRemindBossIdList=[],e.addCustomEvent(353,function(){e.isZhuzaiBoss?e.dispatchEnterFb():e.lastZhuzaiBoss&&e.dispatchQuiKFb()}),e.addCustomEvent(300,function(){e.isZhuzaiBoss&&UIMgr.ins().open(BossBelongView)}),e.addCustomEvent(306,e.onBossDisappear),e.addCustomEvent(301,function(){e.isZhuzaiBoss&&UIMgr.ins().close(BossBelongView)}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.onBossDisappear=function(){this.isZhuzaiBoss&&UIMgr.ins().open(BossEndView)},e.prototype.dispatchEnterFb=function(){this.lastZhuzaiBoss=!0,EventMgr.addListener(305,this.reliveInfoChange,this)},e.prototype.reliveInfoChange=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.dispatchQuiKFb=function(){this.lastZhuzaiBoss=!1,UIMgr.ins().close(BossBelongView),EventMgr.removeListener(305,this.reliveInfoChange,this),UIMgr.ins().close(BossEndView)},Object.defineProperty(e.prototype,"isZhuzaiBoss",{get:function(){return 50==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.checkOpen=function(t){var e="";return GameServer.serverOpenDay<DataCenter.ins().DominateEquipBaConfig.openDay-1&&(e+=LangMgr.getValueByKey("darkHallBossTip1",DataCenter.ins().DominateEquipBaConfig.openDay)),reincarnateControl.lv<DataCenter.ins().DominateEquipBaConfig.openZsLevel&&(e+=LangMgr.getValueByKey("darkHallBossTip2",DataCenter.ins().DominateEquipBaConfig.openZsLevel)),bossControl.worldInfoList[10]||(e+=LangMgr.getValueByKey("darkHallBossTip3")),e&&t&&tipsControl.showTips("|C:0xf3311e&T:"+e),""==e},e.prototype.checkNetTip=function(){return bossControl.worldInfoList[10]?!0:(tipsControl.showTips(LangMgr.getValueByKey("darkHallBossTip4")),!1)},e.prototype.enterFb=function(t){if(this.checkOpen(!0)&&!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()&&this.checkNetTip()){var e=DataCenter.ins().WorldBossConfig[t];if(!Assert(e,LangMgr.getValueByKey("dominateBossError")+t)){if(dominateEquipControl.getTotalScore()<e.zhuzaiScore)return void tipsControl.showTips(LangMgr.getValueByKey("dominateScoreLimit"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{if(!bossControl.worldBossBelongTime[10])return void this.buyCount();bossControl.challengWorldBoss(t,10)}}}},e.prototype.buyCount=function(){var t=10,e=DataCenter.ins().WorldBossBaseConfig.challengeItem[t-1],i=bossControl.worldBossBelongBuyTime[t],n=DataCenter.ins().WorldBossBaseConfig.belongbuycount[t-1][vipControl.lv],o=bossControl.worldBossBelongTime[t];if(o>0)return void tipsControl.warnTips(LangMgr.getValueByKey("warriorBossTimeTip",i,n));var s=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e);if(s>0){var r=DataCenter.ins().ItemConfig[e];return void warnControl.show(LangMgr.getValueByKey("warriorBelongItemUse",ItemUtils.getQualityColor(r),r.name),function(){backpackControl.upUseItem(e,1),bossControl.upWorldBossInfo(t)},this)}if(!n)return void tipsControl.warnTips(LangMgr.getValueByKey("bossTips5"));if(0>=o&&i>=n)return void tipsControl.showTips(LangMgr.getValueByKey("ascriptionArlLimil"));if(ActorControl.yb<DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[t-1])return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));var a=LangMgr.getValueByKey("warriorBelongTimeTip1",DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[t-1],i,n);warnControl.show(a,function(){bossControl.upBuyBelongNum(t)},this)},e}(BaseSystem);__reflect(DominateBossControl.prototype,"DominateBossControl");var AmusementType7DataVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.personalRewardsSum=[],e.worldRewardsSum=[],e.exchange=[],e}return __extends(e,t),e.prototype.initAmusement=function(t){for(var e=0;e<t[0].length;e++){var i=e+1;this.personalRewardsSum[i]=t[0][e][0],this.worldRewardsSum[i]=t[0][e][1],this.exchange[i]=t[0][e][2]}this.bossScore=t[1]},e.prototype.updateAmusement=function(t){var e=t[0],i=t[1];this.personalRewardsSum[e]=i,this.worldRewardsSum[e]=t[2],this.exchange[e]=t[3]},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){return amusementControl.getType7RedPoint(this.id)},e.prototype.getAwardState=function(t){var e=DataCenter.ins().Amusement7Config[this.id][t],i=this.personalRewardsSum[e.index]>=e.count;return i?AmusementControl.Geted:this.bossScore>=e.score?AmusementControl.CanGet:AmusementControl.NotReached},e.prototype.getExchange=function(t){var e=amusementControl.getAmusementDataById(this.id),i=DataCenter.ins().Amusement7Config[this.id][t];if(!i.items)return AmusementControl.NotReached;var n=AmusementControl.CanGet,o=e.worldRewardsSum[t],s=e.exchange[t],r=e.personalRewardsSum[t];for(var a in i.items){var l=backpackControl.getBagItemById(i.items[a].id),h=l?l.count:0;if(h<i.items[a].count){n=AmusementControl.NotReached;break}}return n!=AmusementControl.NotReached&&(i.scount&&o>=i.scount&&(n=AmusementControl.Geted),i.count&&r>=i.count&&(n=AmusementControl.Geted),i.dailyCount&&s>=i.dailyCount&&(n=AmusementControl.Geted)),n},e.TYPE_RING=1,e.TYPE_HEFUBOSS=2,e.TYPE_LABA=5,e.TYPE_CELEBREATE=6,e}(AmusementBaseDataVo);__reflect(AmusementType7DataVo.prototype,"AmusementType7DataVo");var DominateBossRemindView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateBossRemindViewSkin",e.isTopLevel=!0,e.list0.itemRenderer=DominateBossRemindItemRenderer,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTouch);var t=bossControl.worldInfoList[10].slice();if(t)for(var e=t.length-1;e>-1;e--){var i=DataCenter.ins().WorldBossConfig[t[e].id];(-1==dominateBossControl.canRemindBossIdList.indexOf(t[e].id)||i.openTime>GameServer.serverOpenDay)&&t.splice(e,1)}var n=this.getMaxStar(t);t=t.map(function(t){return t.maxStart=n,t}),this.list0.dataProvider=new eui.ArrayCollection(t.sort(this.compareFn))},e.prototype.close=function(){bossControl.upBossSetting(),DominateBossRedpoint.ins().dispatchRedPoint()},e.prototype.onTouch=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e.prototype.getMaxStar=function(t){var e=0;return t.map(function(t,i){var n=DataCenter.ins().WorldBossConfig[t.id],o=DataCenter.ins().DominateEquipBaConfig.bossStar&&DataCenter.ins().DominateEquipBaConfig.bossStar[n.bossId],s=DataCenter.ins().WorldBossConfig[t.id],r=BossControl.isCanChallenge(s);s.darkforce&&(r=t.canInto),o>e&&r&&(e=o)}),e},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id],o=BossControl.isCanChallenge(i),s=BossControl.isCanChallenge(n);return o&&!s?-1:!o&&s?1:i.samsaraLv>n.samsaraLv?1:i.samsaraLv<n.samsaraLv?-1:i.samsaraLv!=n.samsaraLv||0==i.samsaraLv?i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:i.level>n.level?1:i.level<n.level?-1:t.id>e.id?1:t.id<e.id?-1:0:i.level>n.level?1:i.level<n.level?-1:0},e}(BaseEuiView);__reflect(DominateBossRemindView.prototype,"DominateBossRemindView");var DominateBossView=function(t){function e(){var e=t.call(this)||this;return e.type=10,e.skinName="DominateBossViewSkin",e.isTopLevel=!0,e.awardDt=new eui.ArrayCollection,e.awardList.itemRenderer=ItemBase,e.awardList.dataProvider=e.awardDt,e.listDt=new eui.ArrayCollection,e.list.itemRenderer=DominateBossItemRenderer,e.list.dataProvider=e.listDt,e.remind.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+e.remind.text+"</u></a>"),e.getItemTxt.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+e.getItemTxt.text+"</u></a>"),e.list.selectedIndex=0,e.seeRule.visible=!0,e.bossItemId=DataCenter.ins().WorldBossBaseConfig.challengeItem[e.type-1],e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.getItemTxt,this.onTouch),this.addEventTouchTap(this.remind,this.onTouch),this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.challengeBtn,this.onTouch),this.addEventTouchTap(this.trebleCheckbox,this.onTouch),this.addEventChange(this.list,this.onChange),this.addCustomEvent(268,this.itemUpData),this.addCustomEvent(266,this.itemUpData),this.addCustomEvent(269,this.itemUpData),this.addCustomEvent(296,this.upData),this.addCustomEvent(548,this.getRedState),this.upData(),this.onChange(),this.itemUpData(),bossControl.upWorldBossInfo(this.type),this.getRedState(),TimerMgr.ins().doTimer(1e3,0,this.onTimer,this)},e.prototype.onTimer=function(){for(var t=0;t<this.list.numElements;t++){var e=this.list.getElementAt(t);e&&e.upTimer()}},e.prototype.getRedState=function(){var t=bossControl.worldInfoList[10].slice();if(t)for(var e=t.length-1;e>-1;e--){var i=DataCenter.ins().WorldBossConfig[t[e].id];(-1==dominateBossControl.canRemindBossIdList.indexOf(t[e].id)||i.openTime>GameServer.serverOpenDay)&&t.splice(e,1)}var n=[],o=0;t.map(function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],s=DataCenter.ins().DominateEquipBaConfig.bossStar&&DataCenter.ins().DominateEquipBaConfig.bossStar[i.bossId],r=DataCenter.ins().WorldBossConfig[t.id],a=BossControl.isCanChallenge(r);r.darkforce&&(a=t.canInto),s>o&&a&&(o=s);var l=!1;a&&(l=bossControl.getBossRemindByIndex(t.id)),n.push([s,l,a,dominateEquipControl.getTotalScore()>=i.zhuzaiScore])});var s=!1;n.map(function(t,e){t[0]==o&&!s&&t[2]&&!t[1]&&t[3]&&(s=t[2])}),this.settingRedPoint&&(this.settingRedPoint.visible=s)},e.prototype.onChange=function(){if(this.list.selectedItem){var t=DataCenter.ins().WorldBossConfig[this.list.selectedItem.id];this.awardDt.source=t.belongRewardshow,TweenUtil.ListAnimation(this.awardList,3,80,.4,"tweenGroup",{x:50,y:50});var e=DataCenter.ins().WorldBossConfig[this.list.selectedItem.id].zhuzaiScore;this.challengeBtn.visible=dominateEquipControl.getTotalScore()>=e&&this.list.selectedItem.canInto,this.tips1.visible=!this.challengeBtn.visible}},e.prototype.itemUpData=function(){this.numberLabel.text=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,this.bossItemId)},e.prototype.upData=function(){var t=bossControl.worldBossBelongTime[this.type];this.bossTimes.textColor=t>0?ColorUtils.GREEN:ColorUtils.RED,this.bossTimes.textFlow=TextUtils.generateTextFlow1(t+""),this.myScore.text=dominateEquipControl.getTotalScore()+"",this.asistTime.parent.visible=bossControl.checkShowAsist(50),this.asistTime.parent.visible&&(this.asistTime.textFlow=TextUtils.generateTextFlow1(bossControl.getAsistCountText())),this.upList(),this.updateMultInfo()},e.prototype.updateMultInfo=function(){var t=CommonFun.getWorldBossMultNum(this.type);if(this.trebleCheckbox.visible=t>1,t>1){this.trebleCheckbox.label=LangMgr.getValueByKey("dominateBossMult",t),this.trebleCheckbox.selected=!!ServerStorage.ins().getBitValue(ClientSetBit.worldBossMult10);var e=!ServerStorage.ins().getBitValue(ClientSetBit.worldBossMultEff10);e?(this.trebleMc=this.trebleMc||new GameMovieClip,this.trebleMc.playFile(PATH_EFF+"chargeff1",-1),this.mcGroup.addChild(this.trebleMc)):DisplayUtils.removeFromParent(this.trebleMc)}else DisplayUtils.removeFromParent(this.trebleMc)},e.prototype.onTouch=function(t){switch(t.target){case this.getItemTxt:dominateBossControl.buyCount();break;case this.remind:UIMgr.ins().open(DominateBossRemindView);break;case this.seeRule:HelpControl.openHelpWin(81);break;case this.closeBtn:UIMgr.ins().close(this);break;case this.challengeBtn:this.list.selectedItem&&dominateBossControl.enterFb(this.list.selectedItem.id);break;case this.trebleCheckbox:ServerStorage.ins().setBitValue(ClientSetBit.worldBossMult10,this.trebleCheckbox.selected?1:0),ServerStorage.ins().setBitValue(ClientSetBit.worldBossMultEff10,1),this.updateMultInfo()}},e.prototype.upList=function(){for(var t=bossControl.worldInfoList[this.type].slice(),e=[],i=[],n=[],o=[],s=[],r=[],a=dominateEquipControl.getTotalScore(),l=0;l<t.length;l++){var h=bossControl.getBossRemindByIndex(t[l].id),u=DataCenter.ins().WorldBossConfig[t[l].id];u&&(t[l].canInto&&u.zhuzaiScore<=a?h?t[l].isDie?n.push(t[l]):i.push(t[l]):t[l].isDie?s.push(t[l]):o.push(t[l]):r.push(t[l]))}i.sort(this.compareFn),n.sort(this.compareFn),r.sort(this.compareFn2),o.sort(this.compareFn),s.sort(this.compareFn),r=r.slice(0,3),e=i.concat(n,r,o,s),e.map(function(t){return dominateBossControl.canRemindBossIdList.push(t.id),t}),this.listDt.replaceAll(e)},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return i.zsLevel>n.zsLevel?-1:i.zsLevel<n.zsLevel?1:t.id>e.id?-1:t.id<e.id?1:0},e.prototype.compareFn2=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id];return i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:t.id>e.id?1:t.id<e.id?-1:0},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return dominateBossControl.checkOpen(!0)},e}(BaseEuiView);__reflect(DominateBossView.prototype,"DominateBossView");var DominateBossItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof WorldBossItemVo){var t=DataCenter.ins().WorldBossConfig[this.data.id],e=DataCenter.ins().MonstersConfig[t.bossId];this.typeBgImg.source="dominateboss_item_bg"+e.avatar+"_png",this.bossName.text=e.name,this.scoreLabel.text=t.zhuzaiScore+"",this.starNumber.text=DataCenter.ins().DominateEquipBaConfig.bossStar&&DataCenter.ins().DominateEquipBaConfig.bossStar[t.bossId]+""||"1",this.refreshTime.text="";var i=t.zhuzaiScore;dominateEquipControl.getTotalScore()<i?(this.scoreLabel.text=CommonUtils.overLengthChange(i),this.scoreNeed.visible=!0):this.scoreNeed.visible=!1,this.upTimer()}},e.prototype.upTimer=function(){var t=this.data.relieveTime-egret.getTimer();t>0?(this.refreshTime.text=""+DateUtils.getFormatBySecond(Math.floor(t/1e3),1),this.maskRect.visible=!0):(this.refreshTime.text="",this.maskRect.visible=!1)},e}(BaseItemRender);__reflect(DominateBossItemRenderer.prototype,"DominateBossItemRenderer");var DominateBossRemindItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.canChallenge=!1,e.star=0,e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=DataCenter.ins().WorldBossConfig[this.data.id];this.demandScore.text=CommonUtils.overLengthChange(e.zhuzaiScore),this.star=DataCenter.ins().DominateEquipBaConfig.bossStar&&DataCenter.ins().DominateEquipBaConfig.bossStar[e.bossId],this.demandScore0.text=LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(this.star)+""||LangMgr.getValueByKey("chinese1")),this.canChallenge=BossControl.isCanChallenge(e),this.redpoint&&(this.redpoint.visible=this.canChallenge&&!this.checkBoxs.selected&&this.star==this.data.maxStart&&dominateEquipControl.getTotalScore()>=e.zhuzaiScore),this.addEventRemovedFromStage(this,this.onRmove),this.addEventTouchTap(this.checkBoxs,this.onTap)},e.prototype.onTap=function(t){var e=DataCenter.ins().WorldBossConfig[this.data.id];this.redpoint.visible=this.canChallenge&&!this.checkBoxs.selected&&this.star==this.data.maxStart&&dominateEquipControl.getTotalScore()>=e.zhuzaiScore},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this.checkBoxs,this.onTap)},e}(PublicBossRemindItemRenderer);__reflect(DominateBossRemindItemRenderer.prototype,"DominateBossRemindItemRenderer");var CrossFieldControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isLinkingCross=!1,e.curServerType=0,e.hasSwitchCross=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.linkingKFState=function(t){this.isLinkingCross=t,t?UIMgr.ins().open(CrossServerSwitchView):CrossServerSwitchView.readyClose()},e.prototype.upKFLogin=function(){return[ActorControl.actorID,this.crossLoginKey,GlobalModel.pf]},e.prototype.downSwitchServer=function(t,e,i,n,o){this.crossSrvid=t,this.crossIp=e,this.crossPort=i,this.crossLoginKey=n,this.curServerType=o,this.hasSwitchCross=!0,debug.log("Connect to cross-server！ip:"+this.crossIp+" port:"+this.crossPort+" type:"+this.curServerType),this.linkingKFState(!0),TimerMgr.ins().doTimer(2e3,1,this.connectKFServer,this)},Object.defineProperty(e.prototype,"isCross",{get:function(){return this.isCrossServer||crossBossControl.isKFBossBattle||crossArenaControl.isKFArena||devildomControl.isDevildomBattle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossServer",{get:function(){return this.curServerType>0},enumerable:!0,configurable:!0}),e.prototype.connectKFServer=function(){SocketConnection.ins().close(),SocketConnection.ins().newSocket(),SocketConnection.ins().getSocket().connected?(console.log("Start logging in to cross-server！ip:"+this.crossIp+" port:"+this.crossPort),this.upKFLogin()):(debug.log("kf connect to "+this.crossIp+" ,port: "+this.crossPort),console.log("Reconnect to the cross-server！ip:"+this.crossIp+" port:"+this.crossPort),SocketConnection.ins().connect(this.crossIp,this.crossPort))},e.prototype.closeSocket=function(){this.curServerType=0,this.crossSrvid=GlobalModel.srvid,UIMgr.ins().close(CrossServerSwitchView),CrossArenaControl.takeExitFb=!1},e.prototype.checkIsKFBattle=function(t){return this.isCross&&t&&tipsControl.showTips(t),this.isCross},__decorate([up(9,[3,8,8])],e.prototype,"upKFLogin",null),__decorate([down(9,[3,8,3,8,3])],e.prototype,"downSwitchServer",null),e=__decorate([protocolsId(0)],e)}(BaseSystem);__reflect(CrossFieldControl.prototype,"CrossFieldControl");var AmusementType8DataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initAmusement=function(t){this.updateAmusement(t)},e.prototype.updateAmusement=function(t){this.record=t[0]},e.prototype.canReward=function(){return this.checkRedPoint()},e.prototype.checkRedPoint=function(){return amusementControl.getType8RedPoint(this.id)},e.prototype.getRemainTime=function(){var t,e=Math.floor((DateUtils.formatMiniDateTime(this.startTime)-GameServer.serverTime)/1e3),i=Math.floor((DateUtils.formatMiniDateTime(this.endTime)-GameServer.serverTime)/1e3);return t=e>=0?LangMgr.getValueByKey("doubleNoActivity"):0>=i?LangMgr.getValueByKey("doubleEndActivity"):DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3)},e.TYPE_RING=1,e.TYPE_SEALPVE=101,e}(AmusementBaseDataVo);__reflect(AmusementType8DataVo.prototype,"AmusementType8DataVo");var CrossDropRecordVo=function(){function t(){}return t.prototype.init=function(t){if(this.type=t[0],this.bestType=t[1],this.time=t[2],this.roleId=t[3],this.servId=t[4],this.nick=t[5],this.sceneName=t[6],this.bossName=t[7],this.goodsId=t[8],this.guildName=t[9],this.bossId=t[10],3==this.type){var e=DataCenter.ins().WorldBossConfig[this.bossId];Assert(e,"Jumper drops log：bossId:"+(this.bossId+","+this.servId+","+this.goodsId+","+this.nick)+",Configuration not found！");var i=DataCenter.ins().MonstersConfig[e.bossId],n=0;if(10==e.type)this.bossName=DataCenter.ins().DominateEquipBaConfig.bossStar[e.bossId]+LangMgr.getValueByKey("roleStart")+i.name;else if(11==e.type)this.bossName=""+i.name;else{for(var o=e.showReward.map(function(t){return DataCenter.ins().DarkEquipConfig[t]}),s=0;s<o.length;s++){var r=o[s];r&&(n=r.star>n?r.star:n)}this.bossName=LangMgr.getValueByKey("stageNumberTxt",n)+i.name}}this.time&&(this.time=Math.floor(DateUtils.formatMiniDateTime(this.time)/DateUtils.MS_PER_SECOND))},t}();__reflect(CrossDropRecordVo.prototype,"CrossDropRecordVo");var CrossFieldPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(550,this.refRedPoint),this.hatred.visible=hatredControl.isOpen(),this.initData(),this.refRedPoint()},e.prototype.close=function(){this.$onClose(),DisplayUtils.removeFromParent(this.kfBossMc),DisplayUtils.removeFromParent(this.island3TitleMc)},e.prototype.onTouch=function(t){switch(t.target){case this.island0:if(!crossArenaControl.checkIsMatching())break;UIMgr.ins().open(CrossBossView);break;case this.island1:UIMgr.ins().open(CrossArenaView);break;case this.island2:if(!crossArenaControl.checkIsMatching())break;UIMgr.ins().open(DarkHallBossView);break;case this.island3:if(!crossArenaControl.checkIsMatching())break;UIMgr.ins().open(DevildomView);break;case this.island4:if(!crossArenaControl.checkIsMatching())break;UIMgr.ins().open(DominateBossView);break;case this.island5:if(!crossArenaControl.checkIsMatching())break;UIMgr.ins().open(WarriorBossView);break;case this.hatred:UIMgr.ins().open(HatredView)}},e.prototype.initData=function(){if(DataCenter.ins().CrossBossBaseConfig.openDay<=GameServer.serverOpenDay+1){this.island0.currentState="unlock",this.island0.validateNow(),this.island0.title.source="kf_function_boss",this.island0.island.alpha=.01,this.kfBossMc||(this.kfBossMc=new GameMovieClip,this.kfBossMc.scaleX=this.kfBossMc.scaleY=.45,this.kfBossMc.x=0,this.kfBossMc.y=35),this.island0.boossGroup.visible=!0,this.island0.boossGroup.addChild(this.kfBossMc);var t=DataCenter.ins().CrossBossBaseConfig.showBoss?DataCenter.ins().CrossBossBaseConfig.showBoss:GUAIWU_PREFIX+"10041_3s";this.kfBossMc.playFile(PATH_GUAIWU+t,-1)}else this.island0.currentState="unlock",this.island0.validateNow(),this.island0.title.source="kf_function_boss",this.island0.island.source="";DataCenter.ins().CrossArenaBaseConfig.openDay<=GameServer.serverOpenDay+1?(this.island1.currentState="unlock",this.island1.validateNow(),this.island1.title.source="kf_function_ladder",this.island1.island.source="kf_field_ladder"):(this.island1.currentState="unlock",this.island1.validateNow(),this.island1.title.source="kf_function_ladder",this.island1.island.source="kf_field_ladder"),DataCenter.ins().DarkEquipBaConfig.openDay<=GameServer.serverOpenDay+1?(this.island2.currentState="unlock",this.island2.validateNow(),this.island2.title.source="kf_function_andianboss",this.island2.island.source="kf_field_andianboss"):(this.island2.currentState="unlock",this.island2.validateNow(),this.island2.title.source="kf_function_andianboss",this.island2.island.source="kf_field_andianboss"),DataCenter.ins().DevildomBossBsConfig.openDay<=GameServer.serverOpenDay+1?(this.island3.currentState="unlock",this.island3.validateNow(),devildomFinalControl.isOpenView()?(this.island3.title.source="kf_function_infinal",this.island3.island.source="kf_field_invasion"):(this.island3.title.source="kf_function_invasion",this.island3.island.source="kf_field_invasion")):(this.island3.currentState="unlock",this.island3.validateNow(),this.island3.title.source="kf_function_invasion",this.island3.island.source="kf_field_invasion"),DataCenter.ins().DominateEquipBaConfig.openDay<=GameServer.serverOpenDay+1?(this.island4.currentState="unlock",this.island4.validateNow(),this.island4.title.source="kf_function_zhuzaishenyuan",this.island4.island.source="kf_field_zhuzaishenyuan"):(this.island4.currentState="unlock",this.island4.validateNow(),this.island4.title.source="kf_function_zhuzaishenyuan",this.island4.island.source="kf_field_zhuzaishenyuan");var e=WarriorConfigMgr.ins().getBaseConfig();e.BossOpenDay<=GameServer.serverOpenDay+1?(this.island5.currentState="unlock",this.island5.validateNow(),this.island5.title.source="kf_function_zhanjiangboss",this.island5.island.source="kf_field_zhanjiangboss",this.island5.visible=!0):(this.island5.currentState="unlock",this.island5.validateNow(),this.island5.title.source="kf_function_zhanjiangboss",this.island5.island.source="kf_field_zhanjiangboss",this.island5.visible=!1)},e.prototype.refRedPoint=function(){this.island0.redPoint.visible=CrossFieldRedPoint.ins().redPoint2>0,this.island1.redPoint.visible=CrossArenaRedPoint.ins().redpoint>0,this.island2.redPoint.visible=DarkHallBossRedPoint.ins().redpoint>0,this.island3.redPoint.visible=DevildomRedPoint.ins().redPoint,this.island4.redPoint.visible=DominateBossRedpoint.ins().redpoint>0,this.island5.redPoint.visible=CrossFieldRedPoint.ins().redPoint6>0,this.redPoint.visible=HatredRedpoint.ins().redpoint},e}(BasePanel);__reflect(CrossFieldPanel.prototype,"CrossFieldPanel");var CrossFieldRecordPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.listDt=new eui.ArrayCollection,this.list.itemRenderer=CrossFieldRecordItemRederer,this.list.dataProvider=this.listDt},e.prototype.open=function(){this.addCustomEvent(330,this.upList),this.addCustomEvent(478,this.openOtherPlayerView),this.upList(),crossBossControl.upDropList()},e.prototype.openOtherPlayerView=function(t){var e=UIMgr.ins().open(RankRoleView,t);e.hideEx(2)},e.prototype.upList=function(){var t=crossBossControl.dropBestRecordDataList;t=t.concat(crossBossControl.dropRecordDataList),this.listDt.replaceAll(t)},e}(BasePanel);__reflect(CrossFieldRecordPanel.prototype,"CrossFieldRecordPanel");var CrossFieldView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="CrossFieldViewSkin",e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.oldIndex=this.tab.selectedIndex=this.viewStack.selectedIndex=t[0]?t[0]:0,this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.setOpenIndex(this.oldIndex),this.addCustomEvent(550,this.refRedpoint),this.addCustomEvent(557,this.refRedpoint),this.refRedpoint(),totemBossControl.isOpen()||(this.viewStack.removeChildAt(3),DisplayUtils.removeFromParent(this.redPoint3))
},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.getElementAt(this.oldIndex)&&this.viewStack.getElementAt(this.oldIndex).close&&this.viewStack.getElementAt(this.oldIndex).close()},e.prototype.onTabTouch=function(t){var e=this.tab.selectedIndex;this.setOpenIndex(e)},e.prototype.setOpenIndex=function(t){switch(this.seeRule.visible=!1,this.titleImg.source="biaoti_kuafuzhanchang",t){case 0:this.crossFieldPanel.open(),this.seeRule.visible=!0;break;case 1:this.crossFieldRecordPanel.open();break;case 2:this.crossArenaRankPanel.open();break;case 3:this.totemBossPanel.open(),this.seeRule.visible=!0,this.titleImg.source="biaoti_tutenglingyu_png"}this.oldIndex!=t?(this.viewStack.getElementAt(this.oldIndex).close&&this.viewStack.getElementAt(this.oldIndex).close(),this.oldIndex=t):this.tab.selectedIndex=this.viewStack.selectedIndex=t},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:0==this.tab.selectedIndex?HelpControl.openHelpWin(34):3==this.tab.selectedIndex&&HelpControl.openHelpWin(66)}},e.prototype.refRedpoint=function(){this.redPoint0.visible=!!CrossFieldRedPoint.ins().redPoint,this.redPoint1.visible=!1,this.redPoint2.visible=!1,this.redPoint3&&(this.redPoint3.visible=!!TotemBossRedpoint.ins().redpoint)},e}(BaseEuiView);__reflect(CrossFieldView.prototype,"CrossFieldView");var CrossFieldRecordItemRederer=function(t){function e(){var e=t.call(this)||this;return e.bestRes=["","dropTop","superDropTop"],e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof CrossDropRecordVo){switch(this.dropTime.text=DateUtils.getFormatBySecond(this.data.time,DateUtils.TIME_FORMAT_15),this.data.type){case 1:case 4:case 5:var t="|C:39423&T:"+this.data.nick+"|",e=DataCenter.ins().ItemConfig[this.data.goodsId],i=ItemUtils.getQualityColor(e),n="|C:"+i+"&T:["+e.name+"]|",o=LangMgr.getValueByKey("kfTips46",t,this.data.sceneName,this.data.bossName,n),s=TextUtils.generateTextFlow1(o);s[0].style.href="event:"+this.data.roleId+"_"+this.data.servId,s[0].style.underline=!0,s[4].style.href="event:"+this.data.goodsId,s[4].style.underline=!0,this.record.textFlow=s;break;case 2:var t=LangMgr.getValueByKey("kfTips48",LangMgr.getValueByKey("color43"),this.data.servId,this.data.guildName),r=DataCenter.ins().BargainItemConfig[this.data.goodsId].item.id,e=DataCenter.ins().ItemConfig[r],i=ItemUtils.getQualityColor(e),n="|C:"+i+"&T:["+e.name+"]|",o=LangMgr.getValueByKey("kfTips47",t,this.data.bossName?this.data.bossName:LangMgr.getValueByKey("devildomDefaultName"),n),s=TextUtils.generateTextFlow1(o);s[6].style.href="event:"+r,s[6].style.underline=!0,this.record.textFlow=s;break;case 3:var t="|C:39423&T:"+this.data.nick+"|",e=DataCenter.ins().ItemConfig[this.data.goodsId],i=ItemUtils.getQualityColor(e),n="|C:"+i+"&T:["+e.name+"]|",o=LangMgr.getValueByKey("crossDarkHallKillGet",t,this.data.bossName,n),s=TextUtils.generateTextFlow1(o);s[0].style.href="event:"+this.data.roleId+"_"+this.data.servId,s[0].style.underline=!0,s[4].style.href="event:"+this.data.goodsId,s[4].style.underline=!0,this.record.textFlow=s;break;case 6:var t="|C:39423&T:"+this.data.nick+"|",e=DataCenter.ins().ItemConfig[this.data.goodsId],i=ItemUtils.getQualityColor(e),n="|C:"+i+"&T:["+e.name+"]|",o=LangMgr.getValueByKey("crossTowerKillGet",t,this.data.bossName,n),s=TextUtils.generateTextFlow1(o);s[0].style.href="event:"+this.data.roleId+"_"+this.data.servId,s[0].style.underline=!0,s[4].style.href="event:"+this.data.goodsId,s[4].style.underline=!0,this.record.textFlow=s}this.bestRes[this.data.bestType]?(this.best.source=this.bestRes[this.data.bestType],this.best.visible=!0):this.best.visible=!1,this.record.width=this.best.visible?380:418,this.addEventTextLink(this.record,this.onLink),this.addEventRemovedFromStage(this,this.removeFromStage)}},e.prototype.onLink=function(t){var e=t.text.split("_");e.length>1?rankOtherUserControl.upFindPlayer(parseInt(e[0]),parseInt(e[1])):CommonFun.viewItemTips(+t.text)},e.prototype.removeFromStage=function(){this.removeEventTextLink(this.record,this.onLink),this.removeEventRemovedFromStage(this,this.removeFromStage)},e}(BaseItemRender);__reflect(CrossFieldRecordItemRederer.prototype,"CrossFieldRecordItemRederer");var HatredControl=function(t){function e(){var e=t.call(this)||this;return e.enemyListDt=new eui.ArrayCollection,e.voicemailListDt=new eui.ArrayCollection,e.helpMsgList=[],e.isMyEnemy=!0,e.addCustomEvent(353,function(){e.inCopy?e.dispatchEnterFb():e.lastFb&&e.dispatchQuiFb()}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.sortList=function(){var t=function(t,e){return t.avenge&&!e.avenge?-1:!t.avenge&&e.avenge?1:0};this.enemyListDt.source.sort(t),this.enemyListDt.replaceAll(this.enemyListDt.source)},Object.defineProperty(e.prototype,"inCopy",{get:function(){return 59==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.dispatchEnterFb=function(){this.lastFb=!0,this.isMyEnemy=!0},e.prototype.dispatchQuiFb=function(){this.lastFb=!1,this.isMyEnemy&&!CrossServerSwitchView.backCloseFun&&CommonFun.regKFBackFun(function(){UIMgr.ins().open(HatredView)})},e.prototype.downInfo=function(t,e){this.revengeNum=t,this.assistNum=e,EventMgr.ins().dispatch(518)},e.prototype.downEnemyList=function(t){this.enemyListDt.removeAll();for(var e=0;t.length>e;e++){var i=new HatredVo;i.init(t[e]),this.enemyListDt.addItem(i)}this.sortList(),EventMgr.ins().dispatch(519)},e.prototype.downRepInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new HatredVo;i.init(t);for(var n=0;n<this.enemyListDt.length;n++){var o=this.enemyListDt.getItemAt(n);if(o.actorId==i.actorId){i.isDel?(this.delItem(i.actorId),this.enemyListDt.removeItemAt(n)):(this.enemyListDt.replaceItemAt(i,n),DataCenter.ins().ServerEenemyBaseConfig.enemyAwardCount-this.revengeNum>0&&1==i.avenge&&i.assistId&&UIMgr.ins().open(HatredThankView,i));break}}this.sortList(),EventMgr.ins().dispatch(520)},e.prototype.downAssistInfo=function(t,e,i,n,o,s,r,a,l){var h=a+"+"+e+"+"+t,u=DataCenter.ins().ServerEenemyBaseConfig.helpInfo;u=u.replace("%s","|C:0xff0000&T:S"+r+l+"|"),u+=" |E:5,"+h+",&U:&C:65280&T:"+LangMgr.getValueByKey("xiezhufuchoustr")+"|";var p=new UnionMessageInfoVo;p.type=1,p.str=u,p.roleId=t,p.name=i,p.vipLevel=n,p.office=o,p.setTime(s),p.analyzeE(),unionControl.addChatMsg(p),this.helpMsgList[t]||(this.helpMsgList[t]=[]),this.helpMsgList[t][e]=p,t==ActorControl.actorID&&tipsControl.showCenterTips(LangMgr.getValueByKey("xiezhufucsendok"))},e.prototype.downResult=function(t,e,i,n,o,s,r,a,l){e&&(this.isMyEnemy=!1),UIMgr.ins().open(HatredResultView,t,e,i,n,o,s,r,a,l)},e.prototype.downVoicemailList=function(t){this.voicemailListDt.removeAll();for(var e=0;t.length>e;e++){var i=new HatredMessageVo;i.init(t[e]),-1!=i.msgIdx&&this.voicemailListDt.addItem(i)}},e.prototype.downRefVoicemail=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new HatredMessageVo;i.init(t),-1!=i.msgIdx&&this.voicemailListDt.addItem(i)},e.prototype.downDelHelpMsg=function(t,e){if(this.helpMsgList[t]&&this.helpMsgList[t][e]){var i=this.helpMsgList[t][e];i.survivalTime=1,unionControl.refTimeOutList(i)}},e.prototype.clearHelpMsg=function(){for(var t in this.helpMsgList)for(var e in this.helpMsgList[t]){var i=this.helpMsgList[t][e];i.survivalTime=1,unionControl.refTimeOutList(i)}},e.prototype.upHelp=function(t){return[t]},e.prototype.upAssist=function(t,e){return[t,e]},e.prototype.upReceiveAward=function(t){return[t]},e.prototype.upRevenge=function(t){return[t]},e.prototype.upProvoke=function(t){return[t]},e.prototype.upThanksAssist=function(t,e){return[t,e]},e.prototype.isOpen=function(){var t=DataCenter.ins().ServerEenemyBaseConfig,e=t.openZsLevel/1e3>>0,i=t.openZsLevel%1e3;return!!GameServer.kfServerIDSmall&&t.openDay<=GameServer.smallKFServOpenDay&&e<=reincarnateControl.lv&&i<=ActorControl.level},e.prototype.getVoicemailsByType=function(t){void 0===t&&(t=0);var e=[],i=DataCenter.ins().ServerEenemyBaseConfig;for(var n in i.msgInfo){var o=i.msgInfo[n];o.index=+n,t==o.type&&e.push(o)}return e},e.prototype.getAwards=function(){for(var t=DataCenter.ins().ServerEenemyBaseConfig.enemyAward,e=t.length-1;e>-1;e--){var i=t[e];if(GameServer.serverOpenDay+1>=i.openDay)return i.awards}return[]},e.prototype.setSeting=function(t,e){ClientStorage.ins().setBool(t,e,SetValueType.special)},e.prototype.getSeting=function(t){return!ClientStorage.ins().getBool(t,SetValueType.special)},e.prototype.delItem=function(t){ClientStorage.ins().delItem(t,SetValueType.special)},__decorate([down(2,[3,3])],e.prototype,"downInfo",null),__decorate([down(3,[ByteConst.HatredVos])],e.prototype,"downEnemyList",null),__decorate([down(4,ByteConst.HatredVos.slice())],e.prototype,"downRepInfo",null),__decorate([down(5,[3,3,8,3,3,3,3,3,8])],e.prototype,"downAssistInfo",null),__decorate([down(11,[3,3,3,3,3,8,8,3,3])],e.prototype,"downResult",null),__decorate([down(14,[ByteConst.HatredMessageVos])],e.prototype,"downVoicemailList",null),__decorate([down(15,ByteConst.HatredMessageVos.slice())],e.prototype,"downRefVoicemail",null),__decorate([down(16,[3,3])],e.prototype,"downDelHelpMsg",null),__decorate([up(7,[3])],e.prototype,"upHelp",null),__decorate([up(8,[3,3])],e.prototype,"upAssist",null),__decorate([up(9,[3])],e.prototype,"upReceiveAward",null),__decorate([up(10,[3])],e.prototype,"upRevenge",null),__decorate([up(12,[3])],e.prototype,"upProvoke",null),__decorate([up(13,[3,3])],e.prototype,"upThanksAssist",null),e=__decorate([protocolsId(78)],e)}(BaseSystem);__reflect(HatredControl.prototype,"HatredControl");var Launcher=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.map_load_count=0,e.app_is_loaded=!1,e.startTime=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.loadConfig=function(){UIMgr.ins().close(StartGameView),UIMgr.ins().close(ServerListView),GameLoadingUI.GetInstance().show(),GameLoadingUI.GetInstance().showProgress(),this.app_is_loaded?(GlobalModel.setLoadProgress(100,LangMgr.getValueByKey("loadProgressTips1")),SocketConnection.ins().reLogin()):(GlobalModel.setLoadProgress(10,LangMgr.getValueByKey("loadProgressTips2")),this.onConfigComplete())},e.prototype.onConfigComplete=function(){GlobalModel.setLoadProgress(20,LangMgr.getValueByKey("loadProgressTips2"));var t;t=DeviceUtils.IsWxMiniGame?new eui.Theme(PATH_ROOT+"default.thm_wxgame.json",Main.ins().stage):new eui.Theme(PATH_ROOT+"default.thm.json",Main.ins().stage),t.addEventListener(eui.UIEvent.COMPLETE,this.onThemeLoadComplete,this),this.startTime=Date.now()},e.prototype.onThemeLoadComplete=function(){var t=this;LoadUtils.ins().loadGroup("dataConfig",function(){return __awaiter(t,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:t=1,i.label=1;case 1:return 6>=t?(e=RES.getRes("cnf_"+t+"_json"),[4,DataCenter.addData(e)]):[3,4];case 2:i.sent(),i.label=3;case 3:return t++,[3,1];case 4:return this.initSystem(),[2]}})})},function(t,e){GlobalModel.setLoadProgress(20+t/e*60,LangMgr.getValueByKey("loadProgressTips3"))},this)},e.prototype.initSystem=function(){RES.destroyRes("dataConfig");for(var t in GameSystem)GameSystem[t]();eui.Label.default_fontFamily="Arial",LoadUtils.ins().loadGroup(GlobalModel.isCreateRole?GlobalModel.createRolePreload:"preload",this.complete,this.progress,this)},e.prototype.complete=function(){var t=this;LangMgr.initData("language_json"),RES.getResByUrl(PATH_ROOT+"cfg/color.json",function(t){LangMgr.addValue(t)},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(PATH_MAP+"maps.data",function(e){return t.map_load_count+=1,Assert(e,LangMgr.getValueByKey("loseMapConfig",t.map_load_count))?void(t.map_load_count<3?t.complete():alert(LangMgr.getValueByKey("loseMapTips"))):(Assert(1==t.map_load_count,LangMgr.getValueByKey("loadMapSuccess",t.map_load_count)),MapControl.init(e),HookControl.ins().init(),t.app_is_loaded=!0,GlobalModel.getUrlParamValue("isDebug")&&(SocketConnection.ins().showLog=!0),SocketConnection.ins().start(),void ReportData.getIns().reportIntervalPoint(Date.now()-t.startTime,5,GlobalModel.serverNumberPlyer<=1))},this,RES.ResourceItem.TYPE_JSON)},e.prototype.progress=function(t,e){GlobalModel.setLoadProgress(80+t/e*20,LangMgr.getValueByKey("loadProgressTips1"))},e.prototype.perLoadProgress=function(t,e){EventMgr.ins().dispatch(1,[t,e])},e.prototype.perLoadComplete=function(){EventMgr.ins().dispatch(2)},e}(SingleClass);__reflect(Launcher.prototype,"Launcher");var HatredMessageVo=function(){function t(){}return t.prototype.init=function(t){this.timetamp=t[0],this.type=t[1],this.servId=t[2],this.actorId=t[3],this.actorName=t[4],this.msgIdx=t[5]},t}();__reflect(HatredMessageVo.prototype,"HatredMessageVo");var HatredVo=function(){function t(){}return t.prototype.init=function(t){this.actorId=t[0],this.isDel=t[1],this.isDel||(this.servId=t[2],this.sex=t[3],this.job=t[4],this.actorName=t[5],this.killedNum=t[6],this.placeDeath=t[7],this.guildName=t[8],this.avenge=t[9],this.assistId=t[10],this.assistName=t[11],this.assistJob=t[12],this.assistSex=t[13],this.helpCdTimetamp=t[14])},t}();__reflect(HatredVo.prototype,"HatredVo");var HatredMessagePanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.list0.itemRenderer=HatredMessageItemRenderer},e.prototype.open=function(){this.addEventTouchTap(this.list0,this.onTouchList),this.list0.dataProvider=hatredControl.voicemailListDt},e.prototype.close=function(){WatcherUtil.removeFromArrayCollection(this.list0.dataProvider),this.list0.dataProvider=null},e.prototype.onTouchList=function(t){if(t.target instanceof HatredMessageItemRenderer){var e=t.target.data;rankOtherUserControl.upFindPlayer(e.actorId,e.servId)}},e}(BasePanel);__reflect(HatredMessagePanel.prototype,"HatredMessagePanel");var HatredPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.list0.itemRenderer=HatredItemRenderer,this.reminder.textFlow=TextUtils.formatUnderLineStr(this.reminder.text)},e.prototype.open=function(){this.addEventTouchTap(this.list0,this.onTouchList),this.addEventTouchTap(this.reminder,this.onTouch),this.addCustomEvent(518,this.initData),this.addCustomEvent(519,this.refList),this.initData(),this.list0.dataProvider=hatredControl.enemyListDt,this.refList()},e.prototype.close=function(){WatcherUtil.removeFromArrayCollection(this.list0.dataProvider),this.list0.dataProvider=null},e.prototype.onTouch=function(t){switch(t.target){case this.reminder:UIMgr.ins().open(HatredReminView)}},e.prototype.initData=function(){var t=DataCenter.ins().ServerEenemyBaseConfig;this.enemyCount=t.enemyAwardCount-hatredControl.revengeNum,this.assistCount=t.assistAwardCount-hatredControl.assistNum,this.office.text=this.enemyCount+"",this.totalCon.text=this.assistCount+"",this.assistCount<=0&&(this.totalCon.textColor=ColorUtils.RED),this.enemyCount<=0&&(this.office.textColor=ColorUtils.RED)},e.prototype.refList=function(){this.noLabel.visible=0==hatredControl.enemyListDt.length},e.prototype.onTouchList=function(t){var e;if(t.target.parent instanceof HatredItemRenderer?e=t.target.parent:t.target.parent.parent instanceof HatredItemRenderer&&(e=t.target.parent.parent),e){var i=e.data;if(t.target instanceof eui.Button){if(this.enemyCount<=0)return void tipsControl.showTips(LangMgr.getValueByKey("fucoucsywstr"));if("revenge"==t.target.name){if(copyControl.checkInFB())return;if(!crossArenaControl.checkIsMatching())return;hatredControl.upRevenge(i.actorId)}else if("help"==t.target.name){if(!unionControl.guildID)return void tipsControl.showTips(LangMgr.getValueByKey("xianaddunion"));var n=Math.floor((DateUtils.formatMiniDateTime(i.helpCdTimetamp)-GameServer.serverTime)/1e3);if(n>0)return void tipsControl.showTips(LangMgr.getValueByKey("askforhelplengque",n));hatredControl.upHelp(i.actorId)}else"getAward"==t.target.name&&(i.assistId?UIMgr.ins().open(HatredThankView,i,!0):hatredControl.upReceiveAward(i.actorId))}else t.target instanceof eui.Image&&"head"==t.target.name&&rankOtherUserControl.upFindPlayer(i.actorId,i.servId)}},e}(BasePanel);__reflect(HatredPanel.prototype,"HatredPanel");var HatredReminView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="HatredReminViewSkin",e.list0.itemRenderer=HatredReminItemRenderer,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTouch),this.list0.dataProvider=new eui.ArrayCollection(hatredControl.enemyListDt.source)},e.prototype.onTouch=function(){UIMgr.ins().close(this)},e.prototype.close=function(){HatredRedpoint.ins().dispatchRedPoint()},e}(BaseEuiView);__reflect(HatredReminView.prototype,"HatredReminView");var HatredResultView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="HatredResultViewSkin",e.listItem.itemRenderer=ItemBase,e.list0.itemRenderer=ResultFailItemRenderer,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTouch);var i=t[0],n=t[1],o=t[2],s=t[3],r=t[5],a=t[6],l=t[7],h=t[8];if(i){var u=heroControl.getSubRoleByIndex(0);this.roleIcon.icon="yuanhead"+u.job+u.sex,this.roleIcon.jobImg.visible=!1;var p="|C:0xffee00&T:"+unionControl.guildName+"|\nS"+GlobalModel.srvid+"\n"+ActorControl.myName;this.player1.textFlow=TextUtils.generateTextFlow1(p),p="|C:0xffee00&T:"+a+"|\n|C:0xff0000&T:S"+s+"\n"+r+"|",this.player2.textFlow=TextUtils.generateTextFlow1(p),this.roleIcon0.icon="yuanhead"+l+h,this.roleIcon0.jobImg.visible=!1,n?(this.dropDownList.visible=!1,this.listItem.visible=DataCenter.ins().ServerEenemyBaseConfig.assistAwardCount-hatredControl.assistNum>0):(this.dropDownList.visible=!0,this.dropDownList.setLabel(LangMgr.getValueByKey("buliuyanstr")),this.dropDownList.setData(hatredControl.getVoicemailsByType()))}else this.winnerGroup.visible=!1,this.listGroup.visible=!1,this.dropDownList.visible=!1,this.title.source="lost_02",this.bg.source="resultLost_png",this.numGroup.visible=!1,this.defeat.visible=!0,this.updateDefeatList();var c=n?LangMgr.getValueByKey("xiezhustr"):LangMgr.getValueByKey("fuchoustr");this.player1title.text=c+LangMgr.getValueByKey("zhestr"),this.overCountTxt.text=o?LangMgr.getValueByKey("syawcsstr",c,+o):LangMgr.getValueByKey("todayHasbeenfinished",c),n?this.listItem.dataProvider=new eui.ArrayCollection(DataCenter.ins().ServerEenemyBaseConfig.assistAward.tAwardList):this.listItem.dataProvider=new eui.ArrayCollection(hatredControl.getAwards()),this.tick=25,TimerMgr.ins().doTimer(1e3,0,this.onTime,this)},e.prototype.close=function(){WatcherUtil.removeFromArrayCollection(this.listItem.dataProvider),this.listItem.dataProvider=null,this.dropDownList.destructor()},e.prototype.onTime=function(){this.tick--,this.closeBtn.label=LangMgr.getValueByKey("querennmaio",this.tick),this.tick<0&&this.quitFb()},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:this.quitFb()}},e.prototype.quitFb=function(){this.dropDownList.getSelectedIndex()>-1&&hatredControl.upProvoke(this.dropDownList.getSelectedItemData().index),UIMgr.ins().close(this),copyControl.upExitFb()},e.prototype.updateDefeatList=function(){var t=[];for(var e in DataCenter.ins().DeathGuideConfig){var i=DataCenter.ins().DeathGuideConfig[e];if(reincarnateControl.lv<=i.zslv||ActorControl.level<=i.lv){for(var n in i.gainWay){if(14==i.gainWay[n][0]){if(vipControl.lv>=Object.keys(DataCenter.ins().VipConfig).length)continue}else if(16==i.gainWay[n][0]){var o=DieGuide.ins().getOpenRoles();if(o){var s=DataCenter.ins().DeathgainWayConfig[i.gainWay[n][0]];s.itemId=o,t.push(i.gainWay[n][0])}continue}t.push(i.gainWay[n][0])}break}}this.list0.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(HatredResultView.prototype,"HatredResultView");var HatredThankView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="HatredThankViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.Btn,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.roleIcon0,this.onTouch),this.addEventTouchTap(this.desc,this.onTouch);var i=hatredControl.getVoicemailsByType(1);this.dropDownList.setData(i),this.data=t[0],this.roleIcon0.icon="yuanhead"+this.data.assistJob+this.data.assistSex,this.desc.textFlow=TextUtils.generateTextFlow1("|U:&C:0x2CC2F8&T:S"+this.data.servId+this.data.assistName+LangMgr.getValueByKey("receiveandthank"));var n=i.length*Math.random()>>0;this.dropDownList.setSelectedIndex(n),this.dropDownList.setLabel(i[n].name),this.canGetAward=t[1],this.canGetAward&&(this.Btn.label=LangMgr.getValueByKey("receiveandthank"))},e.prototype.close=function(){this.dropDownList.destructor()},e.prototype.onTouch=function(t){switch(t.target){case this.Btn:this.dropDownList.getSelectedIndex()>-1&&hatredControl.upThanksAssist(this.data.actorId,this.dropDownList.getSelectedItemData().index),hatredControl.upReceiveAward(this.data.actorId),UIMgr.ins().close(this);break;case this.closeBtn:UIMgr.ins().close(this);break;case this.roleIcon0:case this.desc:rankOtherUserControl.upFindPlayer(this.data.assistId)}},e}(BaseEuiView);__reflect(HatredThankView.prototype,"HatredThankView");var HatredView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HatredViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.oldIndex=this.tab.selectedIndex=this.viewStack.selectedIndex=t[0]?t[0]:0,this.seeRule&&this.addEventTouchTap(this.seeRule,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.setOpenIndex(this.oldIndex),this.addCustomEvent(478,this.viewPlayer)},e.prototype.close=function(){this.viewStack.getElementAt(this.oldIndex)&&this.viewStack.getElementAt(this.oldIndex).close&&this.viewStack.getElementAt(this.oldIndex).close()},e.prototype.viewPlayer=function(t){var e=UIMgr.ins().open(RankRoleView,t);e.hideEx(2)},e.prototype.onTouch=function(t){switch(t.target){case this.seeRule:HelpControl.openHelpWin(65)}},e.prototype.onTabTouch=function(t){var e=this.tab.selectedIndex;this.setOpenIndex(e)},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.hatredPanel.open();break;case 1:this.hatredMessagePanel.open()}this.oldIndex!=t?(this.viewStack.getElementAt(this.oldIndex).close&&this.viewStack.getElementAt(this.oldIndex).close(),this.oldIndex=t):this.tab.selectedIndex=this.viewStack.selectedIndex=t},e.openCheck=function(){return hatredControl.isOpen()},e}(BaseEuiView);__reflect(HatredView.prototype,"HatredView");var HatredItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){this.list0.itemRenderer=ItemBase,this.list0.dataProvider=new eui.ArrayCollection(hatredControl.getAwards()),this.revengeBtn.name="revenge",this.helpBtn.name="help",this.getAward.name="getAward",this.img_userIcon.name="head",this.headBg.touchEnabled=!1},e.prototype.dataChanged=function(){this.data instanceof HatredVo&&(this.img_userIcon.source="head_"+this.data.job+this.data.sex,this.label_name.text="S."+this.data.servId+" "+this.data.actorName,this.labelGuild.text=this.data.guildName,this.place.text=this.data.placeDeath,this.hatred.text=LangMgr.getValueByKey("beijibaics")+this.data.killedNum,this.getAward.visible=!!this.data.avenge,this.helpBtn.parent.visible=!this.data.avenge)},e}(BaseItemRender);__reflect(HatredItemRenderer.prototype,"HatredItemRenderer");var HatredMessageItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof HatredMessageVo){this.massageTime.text=DateUtils.getFormatBySecond(DateUtils.formatMiniDateTime(this.data.timetamp)/1e3,DateUtils.TIME_FORMAT_15),this.tags.source=1==this.data.type?"enemy_provoke_tags":"enemy_thank_tags",this.bg.source=1==this.data.type?"enemy_provoke_bg":"enemy_thank_bg";var t=1==this.data.type?LangMgr.getValueByKey("fuchouokandspeak"):LangMgr.getValueByKey("ganjitilingspeak"),e=DataCenter.ins().ServerEenemyBaseConfig.msgInfo,i=e[this.data.msgIdx]?e[this.data.msgIdx].name:e[1==this.data.type?5:1],n="|C:0x00ff00&T:"+i+"|",o="|U:&C:0x2CC2F8&T:S"+this.data.servId+this.data.actorName+"| ";n=o+t+n,this.record.textFlow=TextUtils.generateTextFlow(n)}},e}(BaseItemRender);__reflect(HatredMessageItemRenderer.prototype,"HatredMessageItemRenderer");var HatredReminItemRenderer=function(t){function e(){var e=t.call(this)||this;return e._move=!1,e._lastX=0,e._lastY=0,e.addEventAddedFromStage(e,e.addToStage),e.addEventRemovedFromStage(e,e.removeToStage),e}return __extends(e,t),e.prototype.addToStage=function(){this.addEventTouchBegin(this.checkBoxs,this.onTouchBegin1),this.addEventChange(this.checkBoxs,this.onChange)},e.prototype.removeToStage=function(){this.removeEventTouchBegin(this.checkBoxs,this.onTouchBegin1),this.removeEventChange(this.checkBoxs,this.onChange)},e.prototype.setting=function(){var t=this;egret.callLater(function(){t.setSetting(!t.checkBoxs.selected)},this)},e.prototype.setSetting=function(t){hatredControl.setSeting(this.data.actorId,t)},e.prototype.getSetting=function(){return hatredControl.getSeting(this.data.actorId)},e.prototype.onChange=function(){this.setting()},e.prototype.onTouchBegin1=function(t){this._lastX=t.stageX,this._lastY=t.stageY,this._lastSelect=this.checkBoxs.selected,this._move=!1,this.$stage&&(this.addEventTouchMove(this.$stage,this.onTouchMove1),this.addEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.onTouchMove1=function(t){MathUtils.getDistance(this._lastX,this._lastY,t.stageX,t.stageY)>20&&(this._move=!0)},e.prototype.onTouchEnd1=function(){this._move&&(this.checkBoxs.selected=this._lastSelect,this._move=!1),this.$stage&&(this.removeEventTouchMove(this.$stage,this.onTouchMove1),this.removeEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.checkMoveEvent=function(){this._move&&this.$stage&&(this.removeEventTouchMove(this.$stage,this.onTouchMove1),this.removeEventTouchEnd(this.$stage,this.onTouchEnd1))},e.prototype.dataChanged=function(){this.checkMoveEvent(),this.data instanceof HatredVo&&(this.serverId.text="s"+this.data.servId,this.enemyName.text=this.data.actorName,this.power.text=""+this.data.killedNum,this.checkBoxs.selected=this.getSetting())},e}(BaseItemRender);__reflect(HatredReminItemRenderer.prototype,"HatredReminItemRenderer");var PeakedControl=function(t){function e(){var e=t.call(this)||this;return e.player16List=[],e.player8List=[],e.player4List=[],e.topRankInfoList=[],e.betInfo=[],e.myBattleReportList=[],e.bfStatus=0,e.kfStatus=0,e.bfStatusIsEnd=0,e.kfStatusIsEnd=0,e.isSignUp=0,e.kideNum=0,e.bfKonckRound=0,e.bfKonckNextTimer=0,e.bfKonckSurplusNum=0,e.bfKonckReportList=[],e.curStateTime=0,e.worshipNum=0,e.kfPlayer64List=[],e.kfPlayer32List=[],e.kfPlayer16List=[],e.kfPlayer8List=[],e.kfPlayer4List=[],e.kfKonckRound=0,e.kfKonckNextTimer=0,e.kfKonckSurplusNum=0,e.kfKonckReportList=[],e.kfTopRankInfoList=[],e.kfBetInfo=[],e.myKFBattleReportList=[],e.crossScene=1e4,e.addCustomEvent(353,function(){e.isCrossScene()}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downState=function(t,e,i,n){var o=this;if(this.bfStatus=t,this.bfStatusIsEnd=e,this.kfStatus=i,this.kfStatusIsEnd=n,0==this.bfStatus&&(this.isSignUp=0),PeakedHelp.calcTimerNode(),6==this.bfStatus&&this.bfStatusIsEnd){var s=PeakedHelp.bfStatusTimer[7]*DateUtils.MS_PER_SECOND-GameServer.serverTime;this.kfStatus>0&&(s=0),0>=s?this.bfStatus=7:TimerMgr.ins().doTimer(s,1,function(){o.bfStatus=7,PeakedHelp.calcTimerNode(),o.downState(null)},this)}peakedControl.isCross()&&peakedControl.upKFBetInfo(),EventMgr.ins().dispatch(337)},e.prototype.downSignUp=function(t,e,i,n,o){return this.isSignUp=t,this.kideNum=e,actorControl.dispatchChip(i),this.curStateTime=n,this.worshipNum=o,PeakedHelp.calcTimerNode(),EventMgr.ins().dispatch(338,this.isSignUp),this.isSignUp},e.prototype.downPKResult=function(t,e){UIMgr.ins().open(PeakedDunResultView,t,e)},e.prototype.downEliminateReportData=function(t,e,i,n){this.bfKonckRound=t,this.bfKonckNextTimer=e,this.bfKonckSurplusNum=i,this.bfKonckReportList=[];for(var o=0;o<n.length;o++){var s=new PeakedKonckReportVo;s.initBFData(n[o]),s.round=o+1,this.bfKonckReportList.push(s)}EventMgr.ins().dispatch(339)},e.prototype.downBFInfoList=function(t,e,i){for(var n=[],o=3;o<arguments.length;o++)n[o-3]=arguments[o];var s;this.player16List=[];for(var r=0;r<t.length;++r)s=new PeakedPlayerVo,s.initBaseData(t[r]),this.player16List.push(s);this.player8List=[];for(var r=0;r<e.length;++r)s=new PeakedPlayerVo,s.playerList=[],PeakedHelp.pushPlayerList(this.player16List,this.player16List,s.playerList,r),s.initData(e[r]),this.player8List.push(s);this.player4List=[];for(var r=0;r<i.length;++r)s=new PeakedPlayerVo,s.playerList=[],PeakedHelp.pushPlayerList(this.player8List,this.player16List,s.playerList,r),s.initData(i[r]),this.player4List.push(s);this.player2Data=new PeakedPlayerVo,this.player2Data.playerList=[],PeakedHelp.pushPlayerList(this.player4List,this.player16List,this.player2Data.playerList,0),this.player2Data.initData(n),this.myBattleReportList=PeakedHelp.countMyRecordData(),EventMgr.ins().dispatch(340)},e.prototype.downTopRank=function(t){this.topRankInfoList=[];for(var e=0;e<t.length;e++){var i=new PeakedTopRankVo;i.initData(t[e]),i.rank=e+1,this.topRankInfoList.push(i)}EventMgr.ins().dispatch(341)},e.prototype.downBetInfo=function(t){this.betInfo=[];for(var e=0;e<t.length;e++){var i=new PeakedBetVo;i.initData(t[e]),this.betInfo.push(i)}UIMgr.ins().isShow(PeakedBetView)&&tipsControl.showTips(LangMgr.getValueByKey("kfTips89")),UIMgr.ins().close(PeakedBetView),EventMgr.ins().dispatch(342)},e.prototype.downKFEliminateReportData=function(t,e,i,n){this.kfKonckRound=t,this.kfKonckNextTimer=e,this.kfKonckSurplusNum=i,this.kfKonckReportList=[];for(var o=0;o<n.length;o++){var s=new PeakedKonckReportVo;s.initKFData(n[o]),s.round=o+1,this.kfKonckReportList.push(s)}EventMgr.ins().dispatch(343)},e.prototype.downKFInfoList=function(t,e,i,n,o){for(var s=[],r=5;r<arguments.length;r++)s[r-5]=arguments[r];var a;this.kfPlayer64List=[];for(var l=0;l<t.length;l++)a=new PeakedPlayerVo,a.initBaseData(t[l],!0),this.kfPlayer64List.push(a);this.kfPlayer32List=[];for(var l=0;l<e.length;l++)a=new PeakedPlayerVo,a.playerList=[],PeakedHelp.pushPlayerList(this.kfPlayer64List,this.kfPlayer64List,a.playerList,l),a.initData(e[l]),this.kfPlayer32List.push(a);this.kfPlayer16List=[];for(var l=0;l<i.length;l++)a=new PeakedPlayerVo,a.playerList=[],PeakedHelp.pushPlayerList(this.kfPlayer32List,this.kfPlayer64List,a.playerList,l),a.initData(i[l]),this.kfPlayer16List.push(a);this.kfPlayer8List=[];for(var l=0;l<n.length;l++)a=new PeakedPlayerVo,a.playerList=[],PeakedHelp.pushPlayerList(this.kfPlayer16List,this.kfPlayer64List,a.playerList,l),a.initData(n[l]),this.kfPlayer8List.push(a);this.kfPlayer4List=[];for(var l=0;l<o.length;l++)a=new PeakedPlayerVo,a.playerList=[],PeakedHelp.pushPlayerList(this.kfPlayer8List,this.kfPlayer64List,a.playerList,l),a.initData(o[l]),this.kfPlayer4List.push(a);this.kfPlayer2Data=new PeakedPlayerVo,this.kfPlayer2Data.playerList=[],PeakedHelp.pushPlayerList(this.kfPlayer4List,this.kfPlayer64List,this.kfPlayer2Data.playerList,0),this.kfPlayer2Data.initData(s),this.myKFBattleReportList=PeakedHelp.countKFMyRecordData(),EventMgr.ins().dispatch(344)},e.prototype.downKFTopRank=function(t){this.kfTopRankInfoList=[];for(var e=0;e<t.length;e++){var i=new PeakedTopRankVo;i.initData(t[e]),i.rank=e+1,this.kfTopRankInfoList.push(i)
}EventMgr.ins().dispatch(345)},e.prototype.downKFBetInfo=function(t){this.kfBetInfo=[];for(var e=0;e<t.length;e++){var i=new PeakedBetVo;i.initData(t[e]),this.kfBetInfo.push(i)}UIMgr.ins().isShow(PeakedBetView)&&tipsControl.showTips(LangMgr.getValueByKey("kfTips89")),UIMgr.ins().close(PeakedBetView),EventMgr.ins().dispatch(346)},e.prototype.downFbCountDown=function(t){var e=Math.floor((DateUtils.formatMiniDateTime(t)-GameServer.serverTime)/1e3);e>0&&UIMgr.ins().open(CopyCountDownView,e)},e.prototype.downWorship=function(t){this.worshipNum=t,DataCenter.ins().PeakRaceBaseConfig.mobaiChips||(DataCenter.ins().PeakRaceBaseConfig.mobaiChips=1e3),tipsControl.showCenterTips(LangMgr.getValueByKey("kfTips90",DataCenter.ins().PeakRaceBaseConfig.mobaiChips)),EventMgr.ins().dispatch(347)},e.prototype.downIsOpen=function(t){this.isServerOpen=t},e.prototype.upSignUp=function(){},e.prototype.upEliminateReport=function(){},e.prototype.upBFInfoList=function(){},e.prototype.upTopRank=function(){},e.prototype.upToLikes=function(t){return[t]},e.prototype.upBet=function(t,e){return[t,e]},e.prototype.upKFEliminateReport=function(){},e.prototype.upKFInfoList=function(){},e.prototype.upKFTopRank=function(){},e.prototype.upKFToLikes=function(t){return[t]},e.prototype.upKFBet=function(t,e){return[t,e]},e.prototype.upKFBetInfo=function(){},e.prototype.upWorship=function(){},e.prototype.isOpen=function(){var t=SwitchMgr.ins().checkOpen(9),e=Object.keys(DataCenter.ins().FireRingRoleConfig).length,i=superRingControl.ringActiNum<e;return GameServer.serverOpenDay>=DataCenter.ins().PeakRaceBaseConfig.openDay&&t&&!i&&1==this.isServerOpen?!0:!1},e.prototype.isCross=function(){return 7==this.bfStatus&&0!=this.bfStatusIsEnd},e.prototype.canSignUp=function(){return PeakedHelp.bfStatusTimer[1]*DateUtils.MS_PER_SECOND<GameServer.serverTime&&GameServer.serverTime<PeakedHelp.bfStatusTimer[2]*DateUtils.MS_PER_SECOND},e.prototype.isKFSixteen=function(){return this.kfStatus>3||3==this.kfStatus&&0!=this.kfStatusIsEnd},e.prototype.isCrossScene=function(){2==this.crossScene&&UIMgr.ins().open(PeakedMainView),this.crossScene++},__decorate([down(0,[1,1,1,1])],e.prototype,"downState",null),__decorate([down(1,[1,3,7,3,1])],e.prototype,"downSignUp",null),__decorate([down(2,[1,8])],e.prototype,"downPKResult",null),__decorate([down(3,[2,3,2,ByteConst.PeakedKonckReportVos])],e.prototype,"downEliminateReportData",null),__decorate([down(4,[ByteConst.PeakedPlayerBaseDataVos,ByteConst.PeakedPlayerDataVos,ByteConst.PeakedPlayerDataVos].concat(ByteConst.PeakedPlayerDataVos))],e.prototype,"downBFInfoList",null),__decorate([down(5,[ByteConst.PeakedTopRankVos])],e.prototype,"downTopRank",null),__decorate([down(7,[ByteConst.PeakedBetVos])],e.prototype,"downBetInfo",null),__decorate([down(8,[2,3,2,ByteConst.PeakedKonckReportKfVos])],e.prototype,"downKFEliminateReportData",null),__decorate([down(9,[ByteConst.PeakedPlayerBaseDataKfVos,ByteConst.PeakedPlayerDataVos,ByteConst.PeakedPlayerDataVos,ByteConst.PeakedPlayerDataVos,ByteConst.PeakedPlayerDataVos].concat(ByteConst.PeakedPlayerDataVos))],e.prototype,"downKFInfoList",null),__decorate([down(10,[ByteConst.PeakedTopRankVos])],e.prototype,"downKFTopRank",null),__decorate([down(12,[ByteConst.PeakedBetVos])],e.prototype,"downKFBetInfo",null),__decorate([down(13,[3])],e.prototype,"downFbCountDown",null),__decorate([down(14,[1])],e.prototype,"downWorship",null),__decorate([down(15,[1])],e.prototype,"downIsOpen",null),__decorate([up(1)],e.prototype,"upSignUp",null),__decorate([up(3)],e.prototype,"upEliminateReport",null),__decorate([up(4)],e.prototype,"upBFInfoList",null),__decorate([up(5)],e.prototype,"upTopRank",null),__decorate([up(6,[3])],e.prototype,"upToLikes",null),__decorate([up(7,[3,3])],e.prototype,"upBet",null),__decorate([up(8)],e.prototype,"upKFEliminateReport",null),__decorate([up(9)],e.prototype,"upKFInfoList",null),__decorate([up(10)],e.prototype,"upKFTopRank",null),__decorate([up(11,[3])],e.prototype,"upKFToLikes",null),__decorate([up(12,[3,3])],e.prototype,"upKFBet",null),__decorate([up(13)],e.prototype,"upKFBetInfo",null),__decorate([up(14)],e.prototype,"upWorship",null),e=__decorate([protocolsId(67)],e)}(BaseSystem);__reflect(PeakedControl.prototype,"PeakedControl");var AmusementTypeExDataVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.specialState=function(){var t,e,i,n,o=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime);if(10006==this.id){for(var s=[0,1,3,5],r=0;r<s.length;r++)if(t=o+s[r]*DateUtils.MS_PER_DAY,e=new Date(t),e.setHours(20,30,0),i=o+(s[r]+1)*DateUtils.MS_PER_DAY,n=new Date(i),GameServer.serverTime>=e.getTime()&&GameServer.serverTime<n.getTime()){var a=DataCenter.ins().ToseongBossConfig[r+1];if(!a)return!1;var l=a.killBossId,h=toseongControl.bossKillNumData;if(h&&void 0!=h[l]&&1!=h[l][1])return!0}return!1}if(10007==this.id){var s=DataCenter.ins().UnionBattleConstConfig.hefuOpen;return s?unionWarControl.getModel().isWatStart:!1}return!0},e.prototype.canReward=function(){if(10002==this.id)return payControl.rechargeTotal.hasGetDays.length<payControl.rechargeTotal.totalDay;if(10018==this.id)return payControl.rechargeTotal.hasGetDays1[0].length<payControl.rechargeTotal.rechDay[0];if(10003==this.id){var t=payControl.getRechargeData(0),e=payControl.getCurRechargeConfig();for(var i in e){var n=e[i];if(t.curDayPay>=n.pay){var o=t.isAwards>>n.index&1;if(!o)return!0}}}else{if(10004==this.id)return threeHeroesControl.awardState==ThreeHeroesControl.CanGet;if(10007==this.id||10006==this.id)return!0;if(10017==this.id){var s=DataCenter.ins().RechargeMultiDayConfig;for(var r in s){var a=s[r];if(payControl.mDayNum==parseInt(r)&&payControl.mRecNum>=a.num&&0==payControl.mReward)return!0}}}var l=DataCenter.ins().AmusementBtnConfig[this.id];if(l&&l.jump&&2==l.jump[0]&&flameMarkControl.checkOpen()&&!flameMarkControl.isMax){var h=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv],u=backpackControl.getBagItemById(h.costItem),p=u?u.count:0;return p>=h.costCount}return!1},e.prototype.getHide=function(){if(this.isHide)return this.isHide;if(10002==this.id)payControl.rechargeTotal.hasGetDays.length>=CommonUtils.getObjectLength(DataCenter.ins().RechargeDaysAwardsConfig)&&(this.isHide=!1);else if(10018==this.id)payControl.rechargeTotal.hasGetDays1[0].length>=CommonUtils.getObjectLength(DataCenter.ins().RechargeDaysAwardssConfig)&&(this.isHide=!1);else if(10004==this.id)this.isHide=!this.isOpenActivity();else if(10006==this.id){var t=[0,1,3,5],e=DataCenter.ins().ToseongBossConfig[t.length];if(e){var i=e.killBossId,n=toseongControl.bossKillNumData;n&&void 0!=n[i]&&n[i][1]>=1&&(this.isHide=!0)}}else if(10007==this.id){var o=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime),t=DataCenter.ins().UnionBattleConstConfig.hefuOpen,s=t.length-1,r=o+t[s].day*DateUtils.MS_PER_DAY,a=new Date(r);if(a.setHours(0,0,0),GameServer.serverTime>a.getTime())return!0}return this.isHide},e.prototype.isOpenActivity=function(){if(10017==this.id)return!1;var t=Math.floor((this.startTime-GameServer.serverTime)/1e3),e=Math.floor((this.endTime-GameServer.serverTime)/1e3);return 0>t&&e>0?!0:10004==this.id?threeHeroesControl.showIcon3DaysLater:!1},e}(AmusementBaseDataVo);__reflect(AmusementTypeExDataVo.prototype,"AmusementTypeExDataVo");var PeakedHelp=function(){function t(){}return t.calcTimerNode=function(){var t=DataCenter.ins().PeakRaceBaseConfig,e=DataCenter.ins().PeakRaceTimeConfig;this.bfStatusTimer=[],this.kfStatusTimer=[];var i=Math.floor(DateUtils.formatMiniDateTime(peakedControl.curStateTime)/DateUtils.MS_PER_SECOND);peakedControl.bfStatus>=6&&peakedControl.bfStatusIsEnd&&(i-=DataCenter.ins().PeakRaceBaseConfig.interval*DateUtils.MS_PER_DAY/DateUtils.MS_PER_SECOND),this.bfStatusTimer[0]=i,this.bfStatusTimer[7]=i+t.crossRelTime;for(var n=1;6>=n;n++)this.bfStatusTimer[n]=i+e[n].relTime;e=DataCenter.ins().PeakRaceCrossTimeConfig,this.kfStatusTimer[0]=i;for(var o=1;7>=o;o++)this.kfStatusTimer[o]=i+e[o].relTime},t.getTimerRuleStr=function(){var t=DataCenter.ins().PeakRaceBaseConfig,e="|C:"+ColorUtils.GREEN+"&T:",i=LangMgr.getValueByKey("kfTips49",e,t.needZsLv),n=DateUtils.TIME_FORMAT_13,o=DateUtils.getFormatBySecond(this.bfStatusTimer[1],n),s=DateUtils.getFormatBySecond(this.bfStatusTimer[2],n);return i+=LangMgr.getValueByKey("kfTips50",e,o,e,s),o=DateUtils.getFormatBySecond(this.bfStatusTimer[2],n),i+=LangMgr.getValueByKey("kfTips51",e,o),o=DateUtils.getFormatBySecond(this.bfStatusTimer[3],n),i+=LangMgr.getValueByKey("kfTips52",e,o),o=DateUtils.getFormatBySecond(this.bfStatusTimer[4],n),i+=LangMgr.getValueByKey("kfTips53",e,o),o=DateUtils.getFormatBySecond(this.bfStatusTimer[5],n),i+=LangMgr.getValueByKey("kfTips54",e,o),o=DateUtils.getFormatBySecond(this.bfStatusTimer[6],n),i+=LangMgr.getValueByKey("kfTips55",e,o)},t.getKFTimerRuleStr=function(){var t="|C:"+ColorUtils.GREEN+"&T:",e=LangMgr.getValueByKey("kfTips56"),i=DateUtils.TIME_FORMAT_13,n=DateUtils.getFormatBySecond(this.kfStatusTimer[1],i);return e+=LangMgr.getValueByKey("kfTips57",t,n),n=DateUtils.getFormatBySecond(this.kfStatusTimer[2],i),e+=LangMgr.getValueByKey("kfTips58",t,n),n=DateUtils.getFormatBySecond(this.kfStatusTimer[3],i),e+=LangMgr.getValueByKey("kfTips59",t,n),n=DateUtils.getFormatBySecond(this.kfStatusTimer[4],i),e+=LangMgr.getValueByKey("kfTips52",t,n),n=DateUtils.getFormatBySecond(this.kfStatusTimer[5],i),e+=LangMgr.getValueByKey("kfTips53",t,n),n=DateUtils.getFormatBySecond(this.kfStatusTimer[6],i),e+=LangMgr.getValueByKey("kfTips54",t,n),n=DateUtils.getFormatBySecond(this.kfStatusTimer[7],i),e+=LangMgr.getValueByKey("kfTips55",t,n)},t.calcEliminateWinNum=function(){var t=0;if(peakedControl.isCross())for(var e=0,i=peakedControl.kfKonckReportList;e<i.length;e++){var n=i[e];n.result&&t++}else for(var o=0,s=peakedControl.bfKonckReportList;o<s.length;o++){var n=s[o];n.result&&t++}return t},t.getPlayerData=function(t,e){var i=PeakedControl.ins();return t==this.PK_GROUP_1?i.player16List[e-1]:t==this.PK_GROUP_2?i.player8List[e-1]?i.player8List[e-1]:this.findLastDt(e,i.player16List):t==this.PK_GROUP_3?i.player4List[e-1]?i.player4List[e-1]:this.findLastDt(e,i.player8List):i.player2Data?i.player2Data:this.findLastDt(e,i.player4List)},t.getKFPlayerData=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=!1);var o=PeakedControl.ins();return t==this.PK_GROUP_1?n?o.kfPlayer16List[e-1]?o.kfPlayer16List[e-1]:this.findLastDt(e,o.kfPlayer64List):o.kfPlayer64List.slice(8*i,8*i+8)[e-1]:t==this.PK_GROUP_2?n?o.kfPlayer8List[e-1]?o.kfPlayer8List[e-1]:this.findLastDt(e,o.kfPlayer16List):o.kfPlayer32List.slice(4*i,4*i+4)[e-1]?o.kfPlayer32List.slice(4*i,4*i+4)[e-1]:this.findLastDt(e,o.kfPlayer64List.slice(8*i,8*i+8)):t==this.PK_GROUP_3?n?o.kfPlayer4List[e-1]?o.kfPlayer4List[e-1]:this.findLastDt(e,o.kfPlayer8List):o.kfPlayer16List.slice(2*i,2*i+2)[e-1]?o.kfPlayer16List.slice(2*i,2*i+2)[e-1]:this.findLastDt(e,o.kfPlayer32List.slice(4*i,4*i+4)):o.kfPlayer2Data?o.kfPlayer2Data:this.findLastDt(e,o.kfPlayer4List)},t.findLastDt=function(t,e){if(e&&e[2*(t-1)+1]){var i=e[2*(t-1)>>0].winId,n=e[2*(t-1)+1>>0].winId,o=new PeakedPlayerVo;return o.playerList=[],o.playerList.push(this.findPlayerDtById(i)),o.playerList.push(this.findPlayerDtById(n)),o.reportList=[],o}return null},t.findPlayerDtById=function(t,e){e||(e=peakedControl.isCross()?peakedControl.kfPlayer64List:peakedControl.player16List);for(var i=0,n=e;i<n.length;i++)for(var o=n[i],s=0,r=o.playerList;s<r.length;s++){var a=r[s];if(t==a.roleId)return a}},t.checkIsWinById=function(e,i,n){n||(n=t.getPlayerListByStage(i));for(var o=0,s=n;o<s.length;o++){var r=s[o];if(e==r.winId)return!0}return!1},t.getPlayerListByStage=function(t){if(peakedControl.isCross())switch(t){case 1:case 2:return peakedControl.kfPlayer64List;case 3:return peakedControl.kfPlayer32List;case 4:return peakedControl.kfPlayer16List;case 5:return peakedControl.kfPlayer8List;case 6:return peakedControl.kfPlayer4List;case 7:return[peakedControl.kfPlayer2Data]}else switch(t){case 3:case 2:return peakedControl.player16List;case 4:return peakedControl.player8List;case 5:return peakedControl.player4List;case 6:return[peakedControl.player2Data]}},t.countMyRecordData=function(){for(var t=peakedControl.player16List,e=peakedControl.player8List,i=peakedControl.player4List,n=peakedControl.player2Data,o=function(t,e,i){for(var n=t.playerList.length,o=0;n>o;o++){var s=t.playerList[o];if(s.roleId==ActorControl.actorID){var r=n>1?t.playerList[0==o?1:0].playerName:LangMgr.getValueByKey("tipsEmpty");if(0==t.reportList.length&&!t.playerList[1]&&i<peakedControl.bfStatus){var a=new PeakedBattleReportVo;a.stateType=i,a.playerName=r,a.result=1,a.round=0,e.push(a)}else for(var l=0,h=0,u=t.reportList;h<u.length;h++){var p=u[h],a=new PeakedBattleReportVo;a.stateType=i,a.playerName=r,a.result=p==ActorControl.actorID?1:0,a.round=++l,e.push(a)}break}}},s=[],r=0,a=t;r<a.length;r++){var l=a[r];o(l,s,3)}for(var h=0,u=e;h<u.length;h++){var l=u[h];o(l,s,4)}for(var p=0,c=i;p<c.length;p++){var l=c[p];o(l,s,5)}return o(n,s,6),s},t.countKFMyRecordData=function(){for(var t=peakedControl.kfPlayer64List,e=peakedControl.kfPlayer32List,i=peakedControl.kfPlayer16List,n=peakedControl.kfPlayer8List,o=peakedControl.kfPlayer4List,s=peakedControl.kfPlayer2Data,r=function(t,e,i){for(var n=t.playerList.length,o=0;n>o;o++){var s=t.playerList[o];if(s.roleId==ActorControl.actorID){var r=n>1?t.playerList[0==o?1:0].playerName:LangMgr.getValueByKey("tipsEmpty");if(0==t.reportList.length&&!t.playerList[1]&&i<peakedControl.kfStatus){var a=new PeakedBattleReportVo;a.stateType=i,a.playerName=r,a.result=1,a.round=0,e.push(a)}else for(var l=0,h=0,u=t.reportList;h<u.length;h++){var p=u[h],a=new PeakedBattleReportVo;a.stateType=i,a.playerName=r,a.result=p==ActorControl.actorID?1:0,a.round=++l,e.push(a)}break}}},a=[],l=0,h=t;l<h.length;l++){var u=h[l];r(u,a,2)}for(var p=0,c=e;p<c.length;p++){var u=c[p];r(u,a,3)}for(var d=0,g=i;d<g.length;d++){var u=g[d];r(u,a,4)}for(var m=0,f=n;m<f.length;m++){var u=f[m];r(u,a,5)}for(var v=0,y=o;v<y.length;v++){var u=y[v];r(u,a,6)}return r(s,a,7),a},t.findBetInfoById=function(t,e,i){if(!i){var n=peakedControl.isCross();i=n?peakedControl.kfBetInfo:peakedControl.betInfo}if(!i)return null;for(var o=0,s=i;o<s.length;o++){var r=s[o];if(r.playerId==t&&r.status==e)return r}return null},t.getStatusByGroup=function(t){if(peakedControl.isCross())if(peakedControl.isKFSixteen())switch(t){case this.PK_GROUP_1:return 4;case this.PK_GROUP_2:return 5;case this.PK_GROUP_3:return 6;case this.PK_GROUP_4:return 7}else switch(t){case this.PK_GROUP_1:return 2;case this.PK_GROUP_2:return 3}else switch(t){case this.PK_GROUP_1:return 3;case this.PK_GROUP_2:return 4;case this.PK_GROUP_3:return 5;case this.PK_GROUP_4:return 6}},t.checkIsBet=function(t,e){for(var i=parseInt(e),n=peakedControl.isCross(),o=0,s=t;o<s.length;o++){var r=s[o];if(r){var a=this.findBetInfoById(r.roleId,this.getStatusByGroup(parseInt(e)));if(a)if(n)if(peakedControl.isKFSixteen()){if(i==this.PK_GROUP_1&&4==a.status)return!0;if(i==this.PK_GROUP_2&&5==a.status)return!0;if(i==this.PK_GROUP_3&&6==a.status)return!0;if(i==this.PK_GROUP_4&&7==a.status)return!0}else{if(i==this.PK_GROUP_1&&2==a.status)return!0;if(i==this.PK_GROUP_2&&3==a.status)return!0}else{if(i==this.PK_GROUP_1&&3==a.status)return!0;if(i==this.PK_GROUP_2&&4==a.status)return!0;if(i==this.PK_GROUP_3&&5==a.status)return!0;if(i==this.PK_GROUP_4&&6==a.status)return!0}}}return!1},t.findPlayerIndexById=function(t,e){for(var i=0;i<e.length;i++)if(e[i].roleId==t)return i;return-1},t.setImgGroupSource=function(t,e){for(var i=0;i<t.numChildren;i++){var n=t.getChildAt(i);n&&(n.source=e)}},t.statusIsOver=function(t,e){return e?peakedControl.kfStatus>t||peakedControl.kfStatus==t&&0!=peakedControl.kfStatusIsEnd:peakedControl.bfStatus>t||peakedControl.bfStatus==t&&0!=peakedControl.bfStatusIsEnd},t.statusIsOverByGroup=function(e){var i=!1;return peakedControl.isCross()?peakedControl.isKFSixteen()?i=e==this.PK_GROUP_1?t.statusIsOver(4,!1):e==this.PK_GROUP_2?t.statusIsOver(5,!1):e==this.PK_GROUP_3?t.statusIsOver(6,!1):t.statusIsOver(7,!1):e==this.PK_GROUP_1?i=t.statusIsOver(2,!1):e==this.PK_GROUP_2&&(i=t.statusIsOver(3,!1)):i=e==this.PK_GROUP_1?t.statusIsOver(3,!1):e==this.PK_GROUP_2?t.statusIsOver(4,!1):e==this.PK_GROUP_3?t.statusIsOver(5,!1):t.statusIsOver(6,!1),i},t.pushPlayerList=function(e,i,n,o){if(e[2*o]){var s=t.findPlayerDtById(e[2*o].winId,i);if(s){var r=CommonUtils.copyDataHandler(s);r.pos=0,n.push(r)}}if(e[2*o+1]){var s=t.findPlayerDtById(e[2*o+1].winId,i);if(s){var r=CommonUtils.copyDataHandler(s);r.pos=1,n.push(r)}}},t.isSixteenById=function(t){for(var e=0,i=peakedControl.player16List;e<i.length;e++){var n=i[e];if(n)for(var o=0,s=n.playerList;o<s.length;o++){var r=s[o];if(r.roleId==t)return!0}}return!1},t.sortBetFun=function(t,e){return t.status-e.status},t.findKFGroupById=function(t){for(var e=0,i=0,n=peakedControl.kfPlayer64List;i<n.length;i++)for(var o=n[i],s=0,r=o.playerList;s<r.length;s++){var a=r[s];if(a.roleId==t)return e/16>>0;e++}return-1},t.findBetKFGroup=function(){for(var t=peakedControl.kfStatus,e=0,i=peakedControl.kfBetInfo;e<i.length;e++){var n=i[e];if(2==n.status&&1==t||3==n.status&&2==t)return this.findKFGroupById(n.playerId)}return-1},t.canSupport=function(){var t=this.kfStatusTimer[0]+DateUtils.DAYS_PER_WEEK*DateUtils.SECOND_PER_DAY;return GameServer.serverTime/DateUtils.MS_PER_SECOND>t&&peakedControl.kfStatus>=7&&peakedControl.kfStatusIsEnd?!1:!0},t.PK_GROUP_1=1,t.PK_GROUP_2=2,t.PK_GROUP_3=3,t.PK_GROUP_4=4,t.bfStatusTimer=[],t.kfStatusTimer=[],t}();__reflect(PeakedHelp.prototype,"PeakedHelp");var PeakedBattleReportVo=function(){function t(){}return t}();__reflect(PeakedBattleReportVo.prototype,"PeakedBattleReportVo");var PeakedBetVo=function(){function t(){}return t.prototype.initData=function(t){this.status=t[0],this.playerId=t[1],this.batNum=t[2]},t}();__reflect(PeakedBetVo.prototype,"PeakedBetVo");var PeakedKonckReportVo=function(){function t(){}return t.prototype.initBFData=function(t){this.id=t[0],this.player=t[1],this.result=t[2]},t.prototype.initKFData=function(t){this.id=t[0],this.player=t[1],this.servId=t[2],this.result=t[3]},t}();__reflect(PeakedKonckReportVo.prototype,"PeakedKonckReportVo");var PeakedPlayerInfoVo=function(){function t(){this.serverId=0}return t.prototype.initData=function(t){this.roleId=t[0],this.playerName=t[1],this.job=t[2],this.sex=t[3],this.pos=t[4]},t.prototype.initKFData=function(t){this.roleId=t[0],this.serverId=t[1],this.playerName=t[2],this.job=t[3],this.sex=t[4],this.pos=t[5]},t}();__reflect(PeakedPlayerInfoVo.prototype,"PeakedPlayerInfoVo");var PeakedPlayerVo=function(){function t(){}return t.prototype.initBaseData=function(t,e){void 0===e&&(e=!1),this.playerList=[];for(var i=0;i<t[0].length;++i){var n=new PeakedPlayerInfoVo;e?n.initKFData(t[0][i]):n.initData(t[0][i]),this.playerList.push(n)}this.winId=t[1],this.reportList=[];for(var i=0;i<t[2].length;++i)this.reportList.push(t[2][i])},t.prototype.initData=function(t){this.winId=t[0],this.reportList=[];for(var e=0;e<t[1].length;++e)this.reportList.push(t[1][e])},t}();__reflect(PeakedPlayerVo.prototype,"PeakedPlayerVo");var PeakedTopRankVo=function(){function t(){}return t.prototype.initData=function(t){this.playerId=t[0],this.playerName=t[1],this.servId=t[2],this.likeNum=t[3]},t}();__reflect(PeakedTopRankVo.prototype,"PeakedTopRankVo");var PeakedVo=function(){function t(){}return Object.defineProperty(t,"STATE_TYPE_CN",{get:function(){return this.state_type_cn||(this.state_type_cn=["","","",LangMgr.getValueByKey("kfType7"),LangMgr.getValueByKey("kfType8"),LangMgr.getValueByKey("kfType9"),LangMgr.getValueByKey("kfType10"),""]),this.state_type_cn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STATE_TYPE_AWARD_CN",{get:function(){return this.state_type_award_cn||(this.state_type_award_cn=["","",LangMgr.getValueByKey("kfType11"),LangMgr.getValueByKey("kfType12"),LangMgr.getValueByKey("kfType13"),LangMgr.getValueByKey("kfType14"),LangMgr.getValueByKey("kfType15"),LangMgr.getValueByKey("kfType16")]),this.state_type_award_cn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STATE_ICON_CN",{get:function(){return this.state_icon_cn||(this.state_icon_cn=["",LangMgr.getValueByKey("kfType17"),LangMgr.getValueByKey("kfType18"),LangMgr.getValueByKey("kfType13"),LangMgr.getValueByKey("kfType14"),LangMgr.getValueByKey("kfType9"),LangMgr.getValueByKey("kfType10"),LangMgr.getValueByKey("kfType23")]),this.state_icon_cn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STATE_KF_TYPE_CN",{get:function(){return this.state_kf_type_cn||(this.state_kf_type_cn=["","",LangMgr.getValueByKey("kfType24"),LangMgr.getValueByKey("kfType25"),LangMgr.getValueByKey("kfType7"),LangMgr.getValueByKey("kfType8"),LangMgr.getValueByKey("kfType9"),LangMgr.getValueByKey("kfType10"),""]),this.state_kf_type_cn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STATE_KF_TYPE_AWARD_CN",{get:function(){return this.state_kf_type_award_cn||(this.state_kf_type_award_cn=["",LangMgr.getValueByKey("kfType11"),LangMgr.getValueByKey("kfType21"),LangMgr.getValueByKey("kfType22"),LangMgr.getValueByKey("kfType12"),LangMgr.getValueByKey("kfType13"),LangMgr.getValueByKey("kfType14"),LangMgr.getValueByKey("kfType15"),LangMgr.getValueByKey("kfType16")]),this.state_kf_type_award_cn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STATE_KF_ICON_CN",{get:function(){return this.state_kf_icon_cn||(this.state_kf_icon_cn=[LangMgr.getValueByKey("kfType23"),LangMgr.getValueByKey("kfType18"),LangMgr.getValueByKey("kfType30"),LangMgr.getValueByKey("kfType31"),LangMgr.getValueByKey("kfType19"),LangMgr.getValueByKey("kfType20"),LangMgr.getValueByKey("kfType9"),LangMgr.getValueByKey("kfType10")]),this.state_kf_icon_cn},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SERV_CN",{get:function(){return this.serv_cn||(this.serv_cn=[LangMgr.getValueByKey("kfType32"),LangMgr.getValueByKey("kfType23")]),this.serv_cn},enumerable:!0,configurable:!0}),t}();__reflect(PeakedVo.prototype,"PeakedVo");var PeakedAwardPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.curServList.itemRenderer=PeakedAwardItemRenderer,this.kfServList.itemRenderer=PeakedAwardItemRenderer,this._listDt1=new eui.ArrayCollection,this._listDt2=new eui.ArrayCollection,this.curServList.dataProvider=this._listDt1,this.kfServList.dataProvider=this._listDt2},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=[];for(var n in DataCenter.ins().PeakRaceTimeConfig){var o=DataCenter.ins().PeakRaceTimeConfig[n];o.loseMail&&i.push(o)}var s={};s.loseMail=DataCenter.ins().PeakRaceBaseConfig.winMail,s.status=7,i.push(s),i.reverse(),this._listDt1.replaceAll(i),i=[];for(var n in DataCenter.ins().PeakRaceCrossTimeConfig){var o=DataCenter.ins().PeakRaceCrossTimeConfig[n];o.isCross=!0,o.loseMail&&i.push(o)}var r={};r.isCross=!0,r.loseMail=DataCenter.ins().PeakRaceBaseConfig.crossWinMail,r.status=8,i.push(r),i.reverse(),this._listDt2.replaceAll(i)},e}(BasePanel);__reflect(PeakedAwardPanel.prototype,"PeakedAwardPanel");var PeakedBetView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PeakedBetViewSkin",e.uilayer=GameLayer.POPUP,e.numLabel.restrict="0-9",e.numLabel.maxChars=8,e.arrow0.visible=!1,e.arrow1.visible=!1,e.aPlayerGroup=e.face0.parent,e.aPlayerGroup.touchChildren=!1,e.bPlayerGroup=e.face1.parent,e.bPlayerGroup.touchChildren=!1,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.tipGroup,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.betBtn,this.onTouch),this.addEventTouchTap(this.maxBtn,this.onTouch),this.addEventTouchTap(this.aPlayerGroup,this.onTouch),this.addEventTouchTap(this.bPlayerGroup,this.onTouch),this.addEventChange(this.numLabel,this.changeInput),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTouch);var i=t[0],n=t[1],o=peakedControl.isKFSixteen(),s=peakedControl.isCross()?PeakedHelp.getKFPlayerData(i,n,t[2],o):PeakedHelp.getPlayerData(i,n);if(s)for(var r=0;2>r;r++){var a=s.playerList[r];this["face"+r].source=a?"yuanhead"+a.job+a.sex:"",this["name"+r].text=a?a.playerName:"---",this["select"+r].name=a?a.roleId+"":""}this.select0.visible=this.select1.visible=!1;var l=ActorControl.chip,h=peakedControl.isCross()?DataCenter.ins().PeakRaceCrossTimeConfig[peakedControl.kfStatus+1].maxBett:DataCenter.ins().PeakRaceTimeConfig[peakedControl.bfStatus+1].maxBett;this._maxNum=l>h?h:l,this.changeInput(null)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.tipGroup,this.onTouch),this.removeEventTouchTap(this.bgClose,this.onTouch),this.removeEventTouchTap(this.betBtn,this.onTouch),this.removeEventTouchTap(this.maxBtn,this.onTouch),this.addEventChanging(this.numLabel,this.changeInput)},e.prototype.changeInput=function(t){var e=parseInt(this.numLabel.text);null==t&&(e=this._maxNum),0>e?e=0:e>this._maxNum&&(e=this._maxNum),this.numLabel.text=e+""},e.prototype.onTouch=function(t){switch(t.target){case this.fgClose:case this.tipGroup:case this.bgClose:UIMgr.ins().close(this);break;case this.betBtn:var e=parseInt(this.numLabel.text);if(this._curId){if(0>=e)return void tipsControl.showTips(LangMgr.getValueByKey("tipsChipEnought"));peakedControl.isCross()?peakedControl.upKFBet(this._curId,e):peakedControl.upBet(this._curId,e)}else tipsControl.showTips(LangMgr.getValueByKey("tipsChoose"));break;case this.maxBtn:this.changeInput(null);break;case this.aPlayerGroup:this.select0.name&&(this.select0.visible=!0,this.select1.visible=!1,this.arrow0.visible=!0,this.arrow1.visible=!1,this._curId=parseInt(this.select0.name));break;case this.bPlayerGroup:this.select1.name&&(this.select1.visible=!0,this.select0.visible=!1,this.arrow0.visible=!1,this.arrow1.visible=!0,this._curId=parseInt(this.select1.name))}},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1],o=peakedControl.isKFSixteen(),s=peakedControl.isCross()?PeakedHelp.getKFPlayerData(i,n,t[2],o):PeakedHelp.getPlayerData(i,n);return s&&s.playerList.length>1?!0:s&&1==s.playerList.length?(tipsControl.showTips(LangMgr.getValueByKey("tipsPlayerEnought")),!1):(tipsControl.showTips(LangMgr.getValueByKey("tipsNotBet")),!1)},e}(BaseEuiView);__reflect(PeakedBetView.prototype,"PeakedBetView");var PeakedChipMallPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.listView.itemRenderer=StoreHonorItemRenderer,this.dataArr=new eui.ArrayCollection,this.listView.dataProvider=this.dataArr},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(201,this.updateData),this.addCustomEvent(465,this.callback),this.addCustomEvent(202,this.callback),storeControl.upMedalMessage()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$onClose()},e.prototype.callback=function(){storeControl.upMedalMessage()},e.prototype.updateData=function(){var t=[],e=DataCenter.ins().StoreConfig;for(var i in e)if(2!=e[i].shopType){var n=!0;if(3==e[i].buyType&&storeControl.medalData)for(var o in storeControl.medalData.exchangeCount)if(e[i].index==Number(o)&&e[i].daycount){storeControl.medalData.exchangeCount[o]>=e[i].daycount&&(n=!1);break}n&&t.push(e[i])}this.dataArr.replaceAll(t),this.myLabel.text=ActorControl.chip+"";var s=this.getWay.text;this.getWay.textFlow=TextUtils.generateTextFlow1("|U:&T:"+s)},e}(BasePanel);__reflect(PeakedChipMallPanel.prototype,"PeakedChipMallPanel");var PeakedDunResultView=function(t){function e(){var e=t.call(this)||this;return e.AUTO_QUIT_TIME=5,e._curTime=0,e.skinName="PeakedDunResultViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.quitBtn,this.onQuit);var i=t[1];t[0]?(this.bg.source="resultWin_png",this.result.source="win_02",this.resultImg.source="peakness_win",this.win.visible=!0,this.lose.visible=!1,this.winPlayer.text=i):(this.bg.source="resultLost_png",this.result.source="lost_02",this.resultImg.source="peakness_lose",this.win.visible=!1,this.lose.visible=!0,this.losePlayer.text=i),TimerMgr.ins().doTimer(1e3,this.AUTO_QUIT_TIME,this.onTick,this),this._curTime=this.AUTO_QUIT_TIME,this.onTick()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.onTick,this)},e.prototype.onTick=function(){this.quitBtn.label=LangMgr.getValueByKey("tongExit2",--this._curTime),this._curTime<0&&this.onQuit()},e.prototype.onQuit=function(){copyControl.upExitFb(),UIMgr.ins().close(e),peakedControl.isCross()?peakedControl.crossScene=1:TimerMgr.ins().doTimer(300,1,function(){UIMgr.ins().open(PeakedMainView)},this)},e}(BaseEuiView);__reflect(PeakedDunResultView.prototype,"PeakedDunResultView");var PeakedEnterPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(337,this.upCurState),this.upCurState()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$onClose(),this._curPanel&&(this._curPanel.close(),DisplayUtils.removeFromParent(this._curPanel))},e.prototype.upCurState=function(){if(this._curPanel&&(this._curPanel.close(),DisplayUtils.removeFromParent(this._curPanel)),peakedControl.isCross()){var t=peakedControl.kfStatus;switch(1==t&&peakedControl.kfStatusIsEnd&&(t=2),t){case 0:case 1:this.signupPanel||(this.signupPanel=new PeakedSignUpPanel),this._curPanel=this.signupPanel;break;case 2:case 3:case 4:case 5:case 6:case 7:this.sixteenPanel||(this.sixteenPanel=new PeakedSixteenPanel),this._curPanel=this.sixteenPanel}}else{var t=peakedControl.bfStatus;switch(2==t&&(peakedControl.bfStatusIsEnd?t=3:peakedControl.isSignUp||(tipsControl.showTips(LangMgr.getValueByKey("kfTips71")),t=1)),t){case 0:case 1:case 2:this.signupPanel||(this.signupPanel=new PeakedSignUpPanel),this._curPanel=this.signupPanel;break;case 3:case 4:case 5:case 6:case 7:this.sixteenPanel||(this.sixteenPanel=new PeakedSixteenPanel),this._curPanel=this.sixteenPanel}}this._curPanel&&(this.addChild(this._curPanel),this._curPanel.open())},e}(BasePanel);__reflect(PeakedEnterPanel.prototype,"PeakedEnterPanel");var PeakedMainView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="PeakedMainViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.oldIndex=this.tab.selectedIndex=this.viewStack.selectedIndex=t[0]?t[0]:0,this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventTouchTap(this.help,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.setOpenIndex(this.oldIndex),this.addCustomEvent(478,this.openOtherPlayerView),this.addCustomEvent(558,this.refRedpoint)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.getElementAt(this.oldIndex)&&this.viewStack.getElementAt(this.oldIndex).close()},e.prototype.openOtherPlayerView=function(t){if(4!=this.oldIndex){var e=UIMgr.ins().isShow(PeakedTopRankView);e&&UIMgr.ins().close(PeakedTopRankView);var i=UIMgr.ins().open(RankRoleView,t);i.hideEx(1),i.closeFun=function(){e&&UIMgr.ins().open(PeakedTopRankView)}}},e.prototype.onTabTouch=function(t){var e=this.tab.selectedIndex;this.setOpenIndex(e)},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.peakedEnterPanel.open();break;case 1:this.peakedAwardPanel.open();
break;case 2:this.peakedMallPanel.open();break;case 3:this.peakedChipMallPanel.open();break;case 4:this.peakedWorshipChampionPanel.open()}this.oldIndex!=t?(this.viewStack.getElementAt(this.oldIndex).close(),this.oldIndex=t):this.tab.selectedIndex=this.viewStack.selectedIndex=t},e.prototype.onTouch=function(t){switch(t.target){case this.help:var e=peakedControl.isCross()?32:31;HelpControl.openHelpWin(e);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.refRedpoint=function(){this.redPoint0.visible=PeakedRedpoint.ins().redpoint1>0,this.redPoint1.visible=!1,this.redPoint2.visible=!1,this.redPoint3.visible=!1,this.redPoint4.visible=PeakedRedpoint.ins().redpoint3>0},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return peakedControl.isOpen()?!0:(tipsControl.showTips(LangMgr.getValueByKey("shopTips25")),!1)},e}(BaseEuiView);__reflect(PeakedMainView.prototype,"PeakedMainView");var PeakedMallPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.listView.itemRenderer=StoreHonorItemRenderer,this.dataArr=new eui.ArrayCollection,this.listView.dataProvider=this.dataArr},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(201,this.updateData),this.addCustomEvent(202,this.callback),storeControl.upMedalMessage()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$onClose()},e.prototype.callback=function(){storeControl.upMedalMessage()},e.prototype.updateData=function(){var t=[],e=DataCenter.ins().StoreConfig;for(var i in e)if(1!=e[i].shopType){var n=!0;if(3==e[i].buyType&&storeControl.medalData)for(var o in storeControl.medalData.exchangeCount)if(e[i].index==Number(o)&&e[i].daycount){storeControl.medalData.exchangeCount[o]>=e[i].daycount&&(n=!1);break}n&&t.push(e[i])}this.dataArr.replaceAll(t),this.myLabel.text=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().PeakRaceBaseConfig.exchangeItems[0])+""},e}(BasePanel);__reflect(PeakedMallPanel.prototype,"PeakedMallPanel");var PeakedMyBattleRecordView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="PeakedMyBattleRecordViewSkin",this.list.itemRenderer=PeakedMyBattleRecordItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose),this.addEventTouchTap(this.tipGroup,this.onClose),this.addEventTouchTap(this.list,this.onTouchList),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onClose);var i=[];PeakedControl.ins();i=peakedControl.isCross()?PeakedHelp.countKFMyRecordData():peakedControl.myBattleReportList,this.list.dataProvider=new eui.ArrayCollection(i),DisplayUtils.scrollerToBottom(this.scrollerList)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.onTouchList=function(t){if(t.target instanceof eui.Label&&t.target.parent instanceof PeakedMyBattleRecordItemRenderer){var e=t.target.parent.data;e&&rankOtherUserControl.upFindPlayer(e.roleId)}},e}(BaseEuiView);__reflect(PeakedMyBattleRecordView.prototype,"PeakedMyBattleRecordView");var PeakedMyBetRecordView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="PeakedMyBetRecordViewSkin",this.list.itemRenderer=PeakedMyBetItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose),this.addEventTouchTap(this.tipGroup,this.onClose),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onClose),this.addCustomEvent(346,this.updata),this.updata()},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.updata=function(){var t=[],e=0,i=0,n=peakedControl.isCross()?peakedControl.kfBetInfo:peakedControl.betInfo;if(n)for(var o=0,s=n;o<s.length;o++){var r=s[o];e+=r.batNum,t.push(r),PeakedHelp.statusIsOver(r.status,peakedControl.isCross())&&(PeakedHelp.checkIsWinById(r.playerId,r.status)?i+=r.batNum:i-=r.batNum)}var a=i>0?"，|C:"+ColorUtils.GREEN+"&T:"+LangMgr.getValueByKey("profit")+"："+i+"|":"|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("damage")+"："+-i+LangMgr.getValueByKey("currency15")+"|";0==i&&(a="");var l=LangMgr.getValueByKey("tipsBetInfo",t.length,ColorUtils.GREEN,e,a);this.infoLabel.textFlow=TextUtils.generateTextFlow1(l),t.sort(PeakedHelp.sortBetFun),this.list.dataProvider=new eui.ArrayCollection(t),DisplayUtils.scrollerToBottom(this.scrollerList)},e}(BaseEuiView);__reflect(PeakedMyBetRecordView.prototype,"PeakedMyBetRecordView");var PeakedSignUpPanel=function(t){function e(){var e=t.call(this)||this;return e.curKonckRound=0,e.skinName="PeakedSignUpPanelSkin",e.left=0,e.right=0,e.top=0,e.bottom=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.eliminateInfoList.itemRenderer=PeakedKnockoutItemItemRenderer,this._eliminateInfoDt=new eui.ArrayCollection,this.eliminateInfoList.dataProvider=this._eliminateInfoDt,this.rewardList.itemRenderer=ItemBase;var t=DateUtils.getFormatBySecond(DataCenter.ins().PeakRaceBaseConfig.KnockOutTime,DateUtils.TIME_FORMAT_10);this.info.text=LangMgr.getValueByKey("kfTips72",DataCenter.ins().PeakRaceBaseConfig.signUpLose,t)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addCustomEvent(337,this.upCurState),this.addCustomEvent(338,this.upSignUpState),this.addCustomEvent(558,this.refRedPoint),this.addCustomEvent(339,this.upEliminateReport),this.addCustomEvent(343,this.upEliminateReport),this.addEventTouchTap(this.signUpBtn,this.onTouch),this.addEventTouchTap(this.eliminateInfoList,this.onTouch),PeakedRedpoint.ins().dispatchRedPoint(),peakedControl.isCross()){var i=peakedControl.kfStatus;1==i&&0==peakedControl.kfStatusIsEnd?(this.addCustomEvent(340,this.upCurState),peakedControl.upBFInfoList()):this.upCurState()}else this.upCurState()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$onClose(),this.removeEventTouchTap(this.signUpBtn,this.onTouch),this.removeEventTouchTap(this.eliminateInfoList,this.onTouch),TimerMgr.ins().remove(this.onTime,this)},e.prototype.onTouch=function(t){switch(t.target){case this.signUpBtn:PeakedRedpoint.ins().redpoint1>0?peakedControl.upSignUp():2!=peakedControl.bfStatus||peakedControl.isSignUp?reincarnateControl.lv<DataCenter.ins().PeakRaceBaseConfig.needZsLv?tipsControl.showTips(LangMgr.getValueByKey("kfTips74",DataCenter.ins().PeakRaceBaseConfig.needZsLv)):tipsControl.showTips(LangMgr.getValueByKey("kfTips75")):tipsControl.showTips(LangMgr.getValueByKey("kfTips73"));break;case this.eliminateInfoList:break;default:if(t.target instanceof eui.Label&&t.target.parent instanceof PeakedKnockoutItemItemRenderer&&t.target.name){var e=t.target.parent.data;e?rankOtherUserControl.upFindPlayer(t.target.name,e.servId):rankOtherUserControl.upFindPlayer(t.target.name)}}},e.prototype.upCurState=function(){if(peakedControl.isCross()){var t=peakedControl.kfStatus;switch(1==t&&0==peakedControl.kfStatusIsEnd&&(peakedControl.isSignUp?PeakedHelp.isSixteenById(ActorControl.actorID)||(tipsControl.showTips(LangMgr.getValueByKey("kfTips77")),t=0):(tipsControl.showTips(LangMgr.getValueByKey("kfTips76")),t=0)),t){case 0:this.signGroup.visible=!0,this.knockoutGroup.visible=!1,this.signUpBtn.visible=!1,this.signed.visible=!1,this.signUpRuleTxt.textFlow=TextUtils.generateTextFlow(PeakedHelp.getKFTimerRuleStr()),this.rewardList.dataProvider=new eui.ArrayCollection(DataCenter.ins().PeakRaceBaseConfig.croosRewards);break;case 1:this.signGroup.visible=!1,this.knockoutGroup.visible=!0,this.signUpBtn.visible=!1,this.signed.visible=!1,peakedControl.upKFEliminateReport();break;case 2:case 3:case 4:case 5:case 6:case 7:}}else{var t=peakedControl.bfStatus;switch(2!=t||peakedControl.isSignUp||(t=1),t){case 0:case 1:this.signGroup.visible=!0,this.knockoutGroup.visible=!1,peakedControl.isSignUp?(this.signed.visible=!0,this.signUpBtn.visible=!1):(this.signUpBtn.label=LangMgr.getValueByKey("kfType17"),this.signed.visible=!1),this.signUpRuleTxt.textFlow=TextUtils.generateTextFlow(PeakedHelp.getTimerRuleStr()),this.rewardList.dataProvider=new eui.ArrayCollection(DataCenter.ins().PeakRaceBaseConfig.singleRewards);break;case 2:this.signGroup.visible=!1,this.knockoutGroup.visible=!0,peakedControl.upEliminateReport();break;case 3:case 4:case 5:case 6:}}},e.prototype.upSignUpState=function(t){void 0===t&&(t=-1),peakedControl.isSignUp&&(this.signed.visible=!0,this.signUpBtn.visible=!1,-1!=t&&tipsControl.showTips(LangMgr.getValueByKey("kfTips78")))},e.prototype.upEliminateReport=function(){var t=PeakedControl.ins(),e=t.isCross()?t.kfKonckReportList:t.bfKonckReportList;this.curKonckRound=t.isCross()?t.kfKonckRound:t.bfKonckRound;var i=t.isCross()?t.kfKonckSurplusNum:t.bfKonckSurplusNum;this._eliminateInfoDt.replaceAll(e),DisplayUtils.scrollerToBottom(this.eliminateListScroller);var n=LangMgr.getValueByKey("kfTips79"),o=PeakedHelp.calcEliminateWinNum();if(e.length-o>=DataCenter.ins().PeakRaceBaseConfig.signUpLose)n=LangMgr.getValueByKey("kfTips80",ColorUtils.RED),this.nextStartCountdownLabel.visible=!1,this.state2.visible=!1;else{var s=this.curKonckRound-o<0?0:this.curKonckRound-o;n+=LangMgr.getValueByKey("kfTips81",o,s),TimerMgr.ins().remove(this.onTime,this),TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime(!0),this.state2.visible=!0}this.eliminateInfoLabel.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips82",this.curKonckRound,i,n))},e.prototype.onTime=function(t){void 0===t&&(t=!1);var e=peakedControl.isCross()?peakedControl.kfKonckNextTimer:peakedControl.bfKonckNextTimer,i=Math.floor((DateUtils.formatMiniDateTime(e)-GameServer.serverTime)/1e3);i>0?this.nextStartCountdownLabel.text=DateUtils.getFormatBySecond(i):(TimerMgr.ins().remove(this.onTime,this),this.nextStartCountdownLabel.text="")},e.prototype.refRedPoint=function(){this.redPoint.visible=PeakedRedpoint.ins().redpoint1>0},__decorate([callLater],e.prototype,"upCurState",null),e}(BasePanel);__reflect(PeakedSignUpPanel.prototype,"PeakedSignUpPanel");var PeakedSixteenPanel=function(t){function e(){var e=t.call(this)||this;return e._curGroup=0,e.MAX=16,e.PK_GROUP_0=0,e.PK_GROUP_1=1,e.PK_GROUP_2=2,e.PK_GROUP_3=3,e.hasBed=!1,e.lastStatus=0,e.skinName="PeakedSixteenPanelSkin",e.left=0,e.right=0,e.top=0,e.bottom=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this._linkGroupList=[],this._linkGroupList[this.PK_GROUP_0]=[],this._linkGroupList[this.PK_GROUP_1]=[],this._linkGroupList[this.PK_GROUP_2]=[],this._linkGroupList[this.PK_GROUP_3]=[],this._vsBtnList=[],this._vsBtnList[this.PK_GROUP_1]=[],this._vsBtnList[this.PK_GROUP_2]=[],this._vsBtnList[this.PK_GROUP_3]=[],this._playerLabelList=[];for(var t=1;t<=this.MAX;t++){var e=this["actState_1_"+t],i=this["actState_2_"+t],n=this["actState_3_"+t];e&&(e.name=this.PK_GROUP_1+"_"+t,e.currentState="view",this._vsBtnList[this.PK_GROUP_1].push(e),e.visible=!1),i&&(i.name=this.PK_GROUP_2+"_"+t,i.currentState="view",this._vsBtnList[this.PK_GROUP_2].push(i),i.visible=!1),n&&(n.name=this.PK_GROUP_3+"_"+t,n.currentState="view",this._vsBtnList[this.PK_GROUP_3].push(n),n.visible=!1),this["player"+(t-1)].text="---",this["player"+(t-1)].name="",this._playerLabelList.push(this["player"+(t-1)]);var o=this["link_0_"+t],s=this["link_1_"+t],r=this["link_2_"+t],a=this["link_3_"+t];o&&this._linkGroupList[this.PK_GROUP_0].push(o),s&&this._linkGroupList[this.PK_GROUP_1].push(s),r&&this._linkGroupList[this.PK_GROUP_2].push(r),a&&this._linkGroupList[this.PK_GROUP_3].push(a),this.finals.touchChildren=!1}this.groupBtnSelect0.touchEnabled=!1,this.groupBtnSelect1.touchEnabled=!1,this.groupBtnSelect2.touchEnabled=!1,this.groupBtnSelect3.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(337,this.upCurState),this.addCustomEvent(342,this.refBetState),this.addCustomEvent(346,this.refBetState),this.addCustomEvent(340,this.upSixteenData),this.addCustomEvent(344,this.upSixteenData),this.addCustomEvent(558,this.refRedpoint);for(var i=0,n=this._vsBtnList;i<n.length;i++){var o=n[i];if(o)for(var s=0,r=o;s<r.length;s++){var a=r[s];this.addEventTouchTap(a,this.onTouchBtn)}}for(var l=0,h=this._playerLabelList;l<h.length;l++){var u=h[l];this.addEventTouchTap(u,this.onTouchPlayer)}this.addEventTouchTap(this.myRecord,this.onTouch),this.addEventTouchTap(this.myBet,this.onTouch),this.addEventTouchTap(this.topRank,this.onTouch),this.addEventTouchTap(this.groupBtn1,this.onChargeTab),this.addEventTouchTap(this.groupBtn2,this.onChargeTab),this.addEventTouchTap(this.groupBtn3,this.onChargeTab),this.addEventTouchTap(this.groupBtn0,this.onChargeTab),this.addEventTouchTap(this.finals,this.onTouch),this.addEventTouchTap(this.vewChampScore,this.onTouch),this.clearGroupSelect(),PeakedRedpoint.ins().dispatchRedPoint(),this.upCurState()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,n=this._vsBtnList;i<n.length;i++){var o=n[i];if(o)for(var s=0,r=o;s<r.length;s++){var a=r[s];this.removeEventTouchTap(a,this.onTouchBtn)}}for(var l=0,h=this._playerLabelList;l<h.length;l++){var u=h[l];this.removeEventTouchTap(u,this.onTouchPlayer)}this.removeEventTouchTap(this.myRecord,this.onTouch),this.removeEventTouchTap(this.myBet,this.onTouch),this.removeEventTouchTap(this.topRank,this.onTouch),this.removeEventTouchTap(this.groupBtn1,this.onChargeTab),this.removeEventTouchTap(this.groupBtn2,this.onChargeTab),this.removeEventTouchTap(this.groupBtn3,this.onChargeTab),this.removeEventTouchTap(this.groupBtn0,this.onChargeTab),this.removeEventTouchTap(this.finals,this.onTouch),this.removeEventTouchTap(this.vewChampScore,this.onTouch),this.$onClose(),this.peakEff.stop(),DisplayUtils.removeFromParent(this.peakEff)},e.prototype.upCurState=function(){this.peakEff||(this.peakEff=new GameMovieClip,this.peakEff.x=83,this.peakEff.y=283,this.peakEff.touchEnabled=!1),this.peakEff.playFile(PATH_EFF+"dianfengjuesai",-1),this.competion.addChild(this.peakEff),this.peakEff.visible=!0,peakedControl.isCross()?(peakedControl.isKFSixteen()?this.currentState="kf":(this.currentState="kf_four",this.peakEff.stop(),DisplayUtils.removeFromParent(this.peakEff)),this.upKf16Data()):this.currentState="bf",this.upStateData()},e.prototype.upStateData=function(){var t=0;if(peakedControl.isCross()){var e=peakedControl.kfStatus;7==e&&0!=peakedControl.kfStatusIsEnd?(this.singleTimeInfoLabel.text="",this.timerGroup.visible=!1):(peakedControl.kfStatusIsEnd&&e++,t=PeakedHelp.kfStatusTimer[e],this.singleTimeInfoLabel.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_13)+" "+PeakedVo.STATE_KF_TYPE_CN[e]),peakedControl.upKFInfoList()}else{var e=peakedControl.bfStatus;if(0==e)return;6==e&&0!=peakedControl.bfStatusIsEnd?(this.singleTimeInfoLabel.text="",this.timerGroup.visible=!1):(peakedControl.bfStatusIsEnd&&e++,t=PeakedHelp.bfStatusTimer[e],this.singleTimeInfoLabel.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_13)+" "+PeakedVo.STATE_TYPE_CN[e]),peakedControl.upBFInfoList()}if(this.timerGroup.visible)for(var i=1;5>=i;i++)this["gameTime"+i+"Txt"].text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_14),t+=DataCenter.ins().PeakRaceBaseConfig.promInterval},e.prototype.refBetState=function(){var t=peakedControl.bfStatus,e=peakedControl.kfStatus,i=peakedControl.isCross();if(i?(e!=this.lastStatus&&(this.hasBed=!1),this.lastStatus=e):(t!=this.lastStatus&&(this.hasBed=!1),this.lastStatus=t),t=peakedControl.bfStatusIsEnd?t+1:t,e=peakedControl.kfStatusIsEnd?e+1:e,peakedControl.bfStatus+1!=6&&peakedControl.kfStatus+1!=7||!peakedControl.bfStatusIsEnd)this.vewChampScore.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips85"));else{var n=void 0;n=i?PeakedHelp.getKFPlayerData(4,1,this._curGroup,peakedControl.isKFSixteen()):PeakedHelp.getPlayerData(4,1),n&&PeakedHelp.checkIsBet(n.playerList,"4")?this.vewChampScore.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips83")):this.vewChampScore.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips84"))}i?this.vewChampScore.visible=e>6:this.vewChampScore.visible=t>5;for(var o in this._vsBtnList){var s=!1;if(i)if(peakedControl.isKFSixteen()){s=o==this.PK_GROUP_1+""&&4==e||o==this.PK_GROUP_2+""&&5==e||o==this.PK_GROUP_3+""&&6==e;for(var r=0,a=this._vsBtnList[o];r<a.length;r++){var l=a[r];l.visible=o==this.PK_GROUP_1+""&&e>=4||o==this.PK_GROUP_2+""&&e>=5||o==this.PK_GROUP_3+""&&e>=6}}else{s=o==this.PK_GROUP_1+""&&2==e||o==this.PK_GROUP_2+""&&3==e;for(var h=0,u=this._vsBtnList[o];h<u.length;h++){var l=u[h];l.visible=o==this.PK_GROUP_1+""&&e>=2||o==this.PK_GROUP_2+""&&e>=3}}else{s=o==this.PK_GROUP_1+""&&3==t||o==this.PK_GROUP_2+""&&4==t||o==this.PK_GROUP_3+""&&5==t;for(var p=0,c=this._vsBtnList[o];p<c.length;p++){var l=c[p];l.visible=o==this.PK_GROUP_1+""&&t>=3||o==this.PK_GROUP_2+""&&t>=4||o==this.PK_GROUP_3+""&&t>=5}}s=i?s&&0!=peakedControl.kfStatusIsEnd:s&&0!=peakedControl.bfStatusIsEnd;for(var d=0,g=this._vsBtnList[o];d<g.length;d++){var l=g[d];if(l)if(s){var m=l.name.split("_"),n=void 0;if(n=i?PeakedHelp.getKFPlayerData(+m[0],+m[1],this._curGroup,peakedControl.isKFSixteen()):PeakedHelp.getPlayerData(+m[0],+m[1]),n&&PeakedHelp.checkIsBet(n.playerList,o)){l.currentState="beted",this.hasBed=!0;break}l.currentState="bet"}else l.currentState="view"}if(s&&this.hasBed)for(var f=0,v=this._vsBtnList[o];f<v.length;f++){var l=v[f];"bet"==l.currentState&&(l.currentState="view")}}},e.prototype.upSixteenData=function(){if(peakedControl.isCross()){if("kf_four"==this.currentState){var t=PeakedHelp.findBetKFGroup();t>-1?this._curGroup=t:this._curGroup=PeakedHelp.findKFGroupById(ActorControl.actorID),this._curGroup=this._curGroup<0?0:this._curGroup,this["groupBtnSelect"+this._curGroup]&&(this["groupBtnSelect"+this._curGroup].visible=!0)}this.upKf16Data()}else this.up16Data(peakedControl.player16List)},e.prototype.upKf16Data=function(){peakedControl.isKFSixteen()?this.up16Data(peakedControl.kfPlayer16List):peakedControl.kfPlayer64List&&this.up16Data(peakedControl.kfPlayer64List.slice(this._curGroup*this.MAX>>1,this._curGroup*this.MAX+this.MAX>>1))},e.prototype.up16Data=function(t){if(this.clearPlayer(),t)for(var e=0;e<this.MAX;e++)if(e%2==0)for(var i=t[e/2],n=0;2>n;n++)if(i&&i.playerList[n]){var o=this["player"+(e+i.playerList[n].pos)];o.text=""+i.playerList[n].playerName,o.name=i.playerList[n].playerName+"_"+i.playerList[n].roleId,i.playerList[n].roleId==ActorControl.actorID?o.textColor=ColorUtils.GREEN:o.textColor=LangMgr.getColor("color27")}var s;if(peakedControl.isCross()){if(peakedControl.isKFSixteen()){var r=peakedControl.kfPlayer2Data;r&&(s=PeakedHelp.findPlayerDtById(r.winId,peakedControl.kfPlayer64List))}}else{var r=peakedControl.player2Data;r&&(s=PeakedHelp.findPlayerDtById(r.winId,peakedControl.player16List))}s&&s.serverId>0?(this.championFace.source="yuanhead"+s.job+s.sex,this.championNameLabel.text=s.playerName,this.championNameLabel.name=s.playerName+"_"+s.roleId,this.competion.visible=!1,this.finals.visible=!0):(this.championFace.source="",this.championNameLabel.text="",this.championNameLabel.name="",this.competion.visible=!0,this.finals.visible=!1),this.upLink(),this.refBetState()},e.prototype.upLink=function(){this.clearLink();var t=PeakedControl.ins(),e=[];e=t.isCross()?peakedControl.isKFSixteen()?[t.kfPlayer16List,t.kfPlayer8List,t.kfPlayer4List,[t.kfPlayer2Data]]:[t.kfPlayer64List.slice(this._curGroup*this.MAX>>1,this._curGroup*this.MAX+this.MAX>>1),t.kfPlayer32List.slice(this._curGroup*this.MAX>>2,this._curGroup*this.MAX+this.MAX>>2),t.kfPlayer16List.slice(this._curGroup*this.MAX>>3,this._curGroup*this.MAX+this.MAX>>3),t.kfPlayer8List.slice(this._curGroup*this.MAX>>4,this._curGroup*this.MAX+this.MAX>>4)]:[t.player16List,t.player8List,t.player4List,[t.player2Data]];for(var i=0,n=0,o=e;n<o.length;n++){var s=o[n];if(s&&this._linkGroupList[i].length>0)for(var r=0,a=0,l=s;a<l.length;a++){var h=l[a];h&&(0==PeakedHelp.findPlayerIndexById(h.winId,h.playerList)?PeakedHelp.setImgGroupSource(this._linkGroupList[i][2*r+h.playerList[0].pos],"line_light"):1==PeakedHelp.findPlayerIndexById(h.winId,h.playerList)&&PeakedHelp.setImgGroupSource(this._linkGroupList[i][2*r+h.playerList[1].pos],"line_light"),r++)}i++}},e.prototype.onTouchPlayer=function(t){var e=t.target;if(e.name){var i=e.name.split("_");if(ActorControl.myName==i[0])return void UIMgr.ins().open(RoleView);var n=PeakedHelp.findPlayerDtById(+i[1]);n?rankOtherUserControl.upFindPlayer(i[1],n.serverId):rankOtherUserControl.upFindPlayer(i[1])}},e.prototype.onTouchBtn=function(t){var e=t.target.parent,i=e.name,n=i.split("_");switch(e.currentState){case"view":UIMgr.ins().open(PeakViewBattleReportView,+n[0],+n[1],this._curGroup);break;case"bet":UIMgr.ins().open(PeakedBetView,+n[0],+n[1],this._curGroup);break;case"beted":}},e.prototype.onTouch=function(t){switch(t.target){case this.finals:var e=this.championNameLabel.name.split("_");if(ActorControl.myName==e[0])return void UIMgr.ins().open(RoleView);var i=PeakedHelp.findPlayerDtById(+e[1]);i?rankOtherUserControl.upFindPlayer(e[1],i.serverId):rankOtherUserControl.upFindPlayer(e[1]);break;case this.vewChampScore:this.vewChampScore.text==LangMgr.getValueByKey("kfType36")?UIMgr.ins().open(PeakViewBattleReportView,4,1,this._curGroup):this.vewChampScore.text==LangMgr.getValueByKey("kfType37")&&UIMgr.ins().open(PeakedBetView,4,1,this._curGroup);break;case this.myRecord:UIMgr.ins().open(PeakedMyBattleRecordView,this._curGroup);break;case this.myBet:UIMgr.ins().open(PeakedMyBetRecordView);break;case this.topRank:UIMgr.ins().open(PeakedTopRankView)}},e.prototype.onChargeTab=function(t){switch(this.clearGroupSelect(),t.target){case this.groupBtn0:this._curGroup=0,this.groupBtnSelect0.visible=!0,this.upKf16Data();break;case this.groupBtn1:this._curGroup=1,this.groupBtnSelect1.visible=!0,this.upKf16Data();break;case this.groupBtn2:this._curGroup=2,this.groupBtnSelect2.visible=!0,this.upKf16Data();break;case this.groupBtn3:this._curGroup=3,this.groupBtnSelect3.visible=!0,this.upKf16Data()}},e.prototype.refRedpoint=function(){this.topRankRedpoint.visible=PeakedRedpoint.ins().redpoint2>0},e.prototype.clearLink=function(){for(var t=0;t<this.MAX;t++)this._linkGroupList[this.PK_GROUP_0][t]&&PeakedHelp.setImgGroupSource(this._linkGroupList[this.PK_GROUP_0][t],"line_black"),this._linkGroupList[this.PK_GROUP_1][t]&&PeakedHelp.setImgGroupSource(this._linkGroupList[this.PK_GROUP_1][t],"line_black"),this._linkGroupList[this.PK_GROUP_2][t]&&PeakedHelp.setImgGroupSource(this._linkGroupList[this.PK_GROUP_2][t],"line_black"),this._linkGroupList[this.PK_GROUP_3][t]&&PeakedHelp.setImgGroupSource(this._linkGroupList[this.PK_GROUP_3][t],"line_black")},e.prototype.clearPlayer=function(){for(var t=1;t<=this.MAX;t++)this["player"+(t-1)].text="",this["player"+(t-1)].name=""},e.prototype.clearGroupSelect=function(){this.groupBtnSelect0.visible=!1,this.groupBtnSelect1.visible=!1,this.groupBtnSelect2.visible=!1,this.groupBtnSelect3.visible=!1},__decorate([callLater],e.prototype,"upStateData",null),__decorate([callLater],e.prototype,"upKf16Data",null),e}(BasePanel);__reflect(PeakedSixteenPanel.prototype,"PeakedSixteenPanel");var PeakedTopRankView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PeakedTopRankViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.list.itemRenderer=PeakedTopRankItemRenderer,this._listDt=new eui.ArrayCollection,this.list.dataProvider=this._listDt},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(338,this.onSingUp),this.addCustomEvent(341,this.upList),this.addCustomEvent(345,this.upList),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.tipGroup,this.onTouch),this.addEventTouchTap(this.list,this.onTouch),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTouch),this.onSingUp()},e.prototype.onSingUp=function(){peakedControl.isCross()?peakedControl.upKFTopRank():peakedControl.upTopRank()},e.prototype.upList=function(){peakedControl.isCross()?this._listDt.replaceAll(peakedControl.kfTopRankInfoList):this._listDt.replaceAll(peakedControl.topRankInfoList)},e.prototype.onTouch=function(t){switch(t.target){case this.fgClose:case this.bgClose:case this.tipGroup:UIMgr.ins().close(this);break;default:if(t.target.parent instanceof PeakedTopRankItemRenderer){var e=t.target.parent.data;t.target instanceof eui.Button?peakedControl.isCross()?peakedControl.upKFToLikes(e.playerId):peakedControl.upToLikes(e.playerId):t.target instanceof eui.Label&&rankOtherUserControl.upFindPlayer(e.playerId,e.servId)}}},e}(BaseEuiView);__reflect(PeakedTopRankView.prototype,"PeakedTopRankView");var PeakedWorshipChampionPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.role1.touchChildren=!1,this.role2.touchChildren=!1,this.role3.touchChildren=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(465,this.upData),this.addCustomEvent(347,this.upData),this.addCustomEvent(478,this.openOtherPlayerView),this.addEventTouchTap(this.shipBtn,this.onTouch),this.addEventTouchTap(this.role1,this.onTouch),this.addEventTouchTap(this.role2,this.onTouch),this.addEventTouchTap(this.role3,this.onTouch),this.isEff=!1,this.initData(),this.upData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._openOtherWin=!1,this.titleMc&&(this.titleMc.destroy(),this.titleMc=null),this.$onClose(),TimerMgr.ins().removeAll(this),this.yanHuaMc&&(this.yanHuaMc.destroy(),this.yanHuaMc=null)},e.prototype.initData=function(){if(peakedControl.kfPlayer2Data&&peakedControl.kfPlayer2Data.winId&&peakedControl.kfStatus>=1&&peakedControl.kfStatusIsEnd){var t=PeakedHelp.findPlayerDtById(peakedControl.kfPlayer2Data.winId);t&&rankOtherUserControl.upFindPlayer(t.roleId,t.serverId)}this.shipBtn.enabled=!1,this.chipLabel.visible=!1,this.countLabel.visible=!1;for(var e=0;3>e;e++)this["role"+(e+1)].visible=!1;this.name0.text=LangMgr.getValueByKey("notAvailable"),this.chipLabel.text=LangMgr.getValueByKey("zsTypeadd",DataCenter.ins().PeakRaceBaseConfig.mobaiChips),this.titleMc||(this.titleMc=ObjectPool.pop("GameMovieClip"),this.titleMc.x=this.titleMcGroup.x,this.titleMc.y=this.titleMcGroup.y),this.titleGroup.addChild(this.titleMc);var i=PATH_EFF+"chenghao1qiang";this.titleMc.playFile(i,-1)},e.prototype.upData=function(){var t=DataCenter.ins().PeakRaceBaseConfig;t.mobaiNum||(t.mobaiNum=10);var e=peakedControl.worshipNum<t.mobaiNum?ColorUtils.GREEN:ColorUtils.RED,i=LangMgr.getValueByKey("kfTips86",e,peakedControl.worshipNum,t.mobaiNum);this.countLabel.textFlow=TextUtils.generateTextFlow1(i),this.isEff&&this.playYHEff()},e.prototype.playYHEff=function(){this.yanHuaMc&&(this.yanHuaMc.destroy(),this.yanHuaMc=null),this.yanHuaMc=new GameMovieClip,this.yanHuaMc.x=270,this.yanHuaMc.y=335,this.addChildAt(this.yanHuaMc,this.numChildren+1),this.yanHuaMc.playFile(PATH_EFF+"yanhuaeff",2),this.isEff=!1},e.prototype.onTouch=function(t){switch(t.target){case this.shipBtn:if(peakedControl.worshipNum>=DataCenter.ins().PeakRaceBaseConfig.mobaiNum)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips87"));if(!peakedControl.kfPlayer2Data.winId)return void tipsControl.showTips(LangMgr.getValueByKey("kfTips88"));this.isEff=!0,peakedControl.upWorship();break;case this.role1:case this.role2:case this.role3:var e=PeakedHelp.findPlayerDtById(peakedControl.kfPlayer2Data.winId);e&&rankOtherUserControl.upFindPlayer(e.roleId,e.serverId)}},e.prototype.openOtherPlayerView=function(t){if(this.otherPlayerData=t,this._openOtherWin){var e=UIMgr.ins().open(RankRoleView,t);e.hideEx(1),this._openOtherWin=!1}else{this._openOtherWin=!0;for(var i=0;i<t.roleData.length;i++){this.getRole(i+1).visible=!0;var n=t.roleData[i];this.getRole(i+1).setRole(n)}this.guild0.text=t.guildName,this.name0.text=t.name+"S"+t.serverId,this.shipBtn.enabled=!0,this.chipLabel.visible=!0,this.countLabel.visible=!0}},e.prototype.getRole=function(t){return this["role"+t]},e}(BasePanel);__reflect(PeakedWorshipChampionPanel.prototype,"PeakedWorshipChampionPanel");var PeakViewBattleReportView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="PeakViewBattleReportViewSkin",this.list.itemRenderer=PeakedViewBattleReportItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onClose);var i=t[0],n=t[1],o=peakedControl.isKFSixteen(),s=peakedControl.isCross()?PeakedHelp.getKFPlayerData(i,n,t[2],o):PeakedHelp.getPlayerData(i,n),r=[],a=0,l=0,h=DataCenter.ins().PeakRaceBaseConfig.promWin;if(h||(h=3),s)if(0==s.playerList.length)this.AnameTxt.text=LangMgr.getValueByKey("tipsNoPlayer"),this.BnameTxt.text=LangMgr.getValueByKey("tipsNoPlayer");else{this.AnameTxt.text=LangMgr.getValueByKey("tipsEmpty"),this.BnameTxt.text=LangMgr.getValueByKey("tipsEmpty"),s.playerList[0]&&(0==s.playerList[0].pos?this.AnameTxt.text=s.playerList[0].playerName:this.BnameTxt.text=s.playerList[0].playerName),s.playerList[1]&&(0==s.playerList[1].pos?this.AnameTxt.text=s.playerList[1].playerName:this.BnameTxt.text=s.playerList[1].playerName);for(var u=PeakedHelp.statusIsOverByGroup(i),p=0;5>p;p++){var c=void 0;if(s.reportList[p])c={},c.winer=PeakedHelp.findPlayerDtById(s.reportList[p]).playerName,c.round=p+1,s.reportList[p]==s.playerList[0].roleId&&0==s.playerList[0].pos||s.reportList[p]==s.playerList[1].roleId&&0==s.playerList[1].pos?a++:l++;else if(u)continue;if(r[p]=c,a>=h||l>=h)break}}else this.AnameTxt.text=LangMgr.getValueByKey("tipsNoPlayer"),this.BnameTxt.text=LangMgr.getValueByKey("tipsNoPlayer");s&&0==s.reportList.length&&s.playerList[0]&&(0==s.playerList[0].pos?a=h:l=h),this.score.text=a+"."+l,this.list.dataProvider=new eui.ArrayCollection(r)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(PeakViewBattleReportView.prototype,"PeakViewBattleReportView");var PeakedAwardItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.awardslist.itemRenderer=ItemBase},e.prototype.dataChanged=function(){this.data.isCross?this.typeLabel.text=PeakedVo.STATE_KF_TYPE_AWARD_CN[this.data.status]:this.typeLabel.text=PeakedVo.STATE_TYPE_AWARD_CN[this.data.status];var t=DataCenter.ins().EmailIdConfig[this.data.loseMail];this.awardslist.dataProvider=new eui.ArrayCollection(t.attachment)},e}(BaseItemRender);__reflect(PeakedAwardItemRenderer.prototype,"PeakedAwardItemRenderer");var PeakedKnockoutItemItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.infoLabel.text=""+(this.data.servId?LangMgr.getValueByKey("chatMenu2"):LangMgr.getValueByKey("kfType33"))+LangMgr.getValueByKey("kfTips64",this.data.round),this.playerName.text=this.data.player?this.data.player:LangMgr.getValueByKey("tipsEmpty"),this.playerName.name=this.data.id,this.data.result?(this.result.textColor=ColorUtils.GREEN,this.result.text=LangMgr.getValueByKey("kfType34")):(this.result.textColor=ColorUtils.RED,this.result.text=LangMgr.getValueByKey("kfType35")))},e}(BaseItemRender);__reflect(PeakedKnockoutItemItemRenderer.prototype,"PeakedKnockoutItemItemRenderer");var PeakedMyBattleRecordItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data.playerName){var t=this.data.round?LangMgr.getValueByKey("kfTips65",this.data.round):"";
peakedControl.isCross()?this.roundInfo.text=""+PeakedVo.SERV_CN[1]+PeakedVo.STATE_KF_TYPE_CN[this.data.stateType]+" "+t:this.roundInfo.text=""+PeakedVo.SERV_CN[0]+PeakedVo.STATE_TYPE_CN[this.data.stateType]+" "+t,this.enemyLabel.text=this.data.playerName,this.result.text=this.data.result?LangMgr.getValueByKey("kfType34"):LangMgr.getValueByKey("kfType35"),this.result.textColor=this.data.result?ColorUtils.GREEN:ColorUtils.RED}},e}(BaseItemRender);__reflect(PeakedMyBattleRecordItemRenderer.prototype,"PeakedMyBattleRecordItemRenderer");var PeakedMyBetItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof PeakedBetVo){peakedControl.isCross()?this.round.text=PeakedVo.SERV_CN[1]+PeakedVo.STATE_KF_TYPE_CN[this.data.status]:this.round.text=PeakedVo.SERV_CN[0]+PeakedVo.STATE_TYPE_CN[this.data.status];var t=PeakedHelp.findPlayerDtById(this.data.playerId),e="";e=PeakedHelp.statusIsOver(this.data.status,peakedControl.isCross())?PeakedHelp.checkIsWinById(this.data.playerId,this.data.status)?LangMgr.getValueByKey("kfTips66",ColorUtils.GREEN,this.data.batNum):LangMgr.getValueByKey("kfTips67",ColorUtils.RED,this.data.batNum):PeakedHelp.checkIsWinById(this.data.playerId,this.data.status)?LangMgr.getValueByKey("kfTips66",ColorUtils.GREEN,this.data.batNum):LangMgr.getValueByKey("kfTips68"),this.infoLabel.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("kfTips69",t.playerName,this.data.batNum,e))}},e}(BaseItemRender);__reflect(PeakedMyBetItemRenderer.prototype,"PeakedMyBetItemRenderer");var PeakedTopRankItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof PeakedTopRankVo&&(this.nameLabel.text=this.data.playerName,this.score.text=this.data.likeNum*DataCenter.ins().PeakRaceBaseConfig.likeScore+"",this.supportBtn.visible=PeakedHelp.canSupport(),peakedControl.kideNum>=DataCenter.ins().PeakRaceBaseConfig.likeCount&&(this.supportBtn.enabled=!1),this.data.rank<=3?(this.rankImg.source="paihang"+this.data.rank,this.rank.text=""):(this.rank.text=this.data.rank+"",this.rankImg.source=""))},e}(BaseItemRender);__reflect(PeakedTopRankItemRenderer.prototype,"PeakedTopRankItemRenderer");var PeakedViewBattleReportItemRender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data?(this.roundTxt.text=LangMgr.getValueByKey("kfTips70",this.data.round),this.player.text=this.data.winer,this.noOpen.visible=!1,this.infoGroup.visible=!0):(this.noOpen.visible=!0,this.infoGroup.visible=!1)},e}(BaseItemRender);__reflect(PeakedViewBattleReportItemRender.prototype,"PeakedViewBattleReportItemRender");var FindPathMgr=function(t){function e(i,n,o,s,r){void 0===s&&(s=0),void 0===r&&(r=0);var a=t.call(this)||this;return a.POINT_DIS=23,a.isShowPath=!0,a.touchTick=0,a.pathingTick=0,a.targetDis=i,a.playerIcon=n,a.mMap=o,a.mMap.touchEnabled=!0,a.s_x=MapControl.MAX_WIDTH/a.mMap.width,a.s_y=MapControl.MAX_HEIGHT/a.mMap.height,a.offX=s,a.offY=r,a.pathList=[],a.mainRole=UnitMgr.ins().getNoDieRole(),a.mainRole||(a.mainRole=UnitMgr.ins().getMainRole(0)),a.mainRole&&(e.targetXY={x:a.mainRole.x,y:a.mainRole.y}),TimerMgr.ins().isExists(a.onTime,a)||TimerMgr.ins().doTimer(100,0,a.onTime,a),a.onTime(),a.targetDis.addEventListener(egret.TouchEvent.TOUCH_TAP,a.onFind,a),a}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.onTouchEX=function(){this.touchTick=egret.getTimer()+200},e.prototype.dispose=function(){TimerMgr.ins().removeAll(this),this.targetDis.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onFind,this)},e.prototype.onTime=function(){this.mainRole&&e.targetXY&&(this.playerIcon.x=this.offX+this.mainRole.x/this.s_x,this.playerIcon.y=this.offY+this.mainRole.y/this.s_y,MathUtils.getDistanceByObject({x:e.targetXY.x/this.s_x,y:e.targetXY.y/this.s_y},this.playerIcon)<=this.POINT_DIS&&this.mainRole.action==UnitAction.STAND&&this.cleanPath(),this.isShowPath&&this.pathingTick%10==0&&e.targetXY&&(MathUtils.getDistanceByObject({x:e.targetXY.x/this.s_x,y:e.targetXY.y/this.s_y},this.playerIcon)<=this.POINT_DIS&&this.mainRole.action==UnitAction.STAND?(this.cleanPath(),e.targetXY=null):this.mainRole.action==UnitAction.RUN&&this.creatPath(e.targetXY.x/MapControl.CELL_SIZE>>0,e.targetXY.y/MapControl.CELL_SIZE>>0)),this.pathingTick++)},e.prototype.onFind=function(t){this.clickEff||(this.clickEff=new GameMovieClip,this.clickEff.scaleX=this.clickEff.scaleY=.4);var i=this.mMap.globalToLocal(t.stageX,t.stageY);this.clickEff.playFile(PATH_EFF+"tapCircle",1),this.clickEff.x=this.offX+i.x,this.clickEff.y=this.offY+i.y,this.targetDis.addChild(this.clickEff),e.targetXY={x:i.x*this.s_x,y:i.y*this.s_y},this.touchTick-egret.getTimer()<0?(gameControl.upStopAI(),MapControl.moveTo(e.targetXY.x,e.targetXY.y)?this.isShowPath&&this.creatPath(e.targetXY.x/MapControl.CELL_SIZE>>0,e.targetXY.y/MapControl.CELL_SIZE>>0):tipsControl.warnTips(LangMgr.getValueByKey("targetPointNot"))):this.isShowPath&&this.creatPath(e.targetXY.x/MapControl.CELL_SIZE>>0,e.targetXY.y/MapControl.CELL_SIZE>>0)},e.prototype.cleanPath=function(){for(var t=0;t<this.pathList.length;t++){var e=this.pathList[t];ObjectPool.push(e),DisplayUtils.removeFromParent(e)}},e.prototype.creatPath=function(t,e){var i=UnitMgr.ins().getNoDieRole();if(i){var n=Math.floor(i.x/MapControl.CELL_SIZE),o=Math.floor(i.y/MapControl.CELL_SIZE),s=MapControl.getPatch(n,o,t,e);if(s&&0!=s.length){this.cleanPath();for(var r=s.length-1;r>-1;r--){var a=s[r],l=void 0,h=void 0,u=void 0,p=void 0;r==s.length-1?(l=this.offX+i.x/this.s_x,h=this.offY+i.y/this.s_y):(l=this.offX+s[r+1].x*MapControl.CELL_SIZE/this.s_x,h=this.offY+s[r+1].y*MapControl.CELL_SIZE/this.s_y),u=this.offX+a.x*MapControl.CELL_SIZE/this.s_x,p=this.offX+a.y*MapControl.CELL_SIZE/this.s_y,this.creatPathPoint(l,h,u,p);var c=this.targetDis.getChildAt(this.targetDis.numChildren-1),d=this.getPointImg();d.x=u,d.y=p,MathUtils.getDistanceByObject(c,d)>=10&&(this.targetDis.addChild(d),this.pathList.push(d))}this.isShowPath&&this.targetDis.addChild(this.playerIcon)}}},e.prototype.creatPathPoint=function(t,e,i,n){for(var o=Math.atan2(n-e,i-t),s=MathUtils.getDistance(t,e,i,n),r=t,a=e;;){var l=this.targetDis.getChildAt(this.targetDis.numChildren-1),h=t+this.POINT_DIS*Math.cos(o),u=e+this.POINT_DIS*Math.sin(o);if(MathUtils.getDistanceByObject(l,{x:h,y:u})<10)t=h,e=u;else{var p=MathUtils.getDistance(r,a,h,u);if(p>s)break;var c=this.getPointImg();c.x=h,c.y=u,this.targetDis.addChild(c),this.pathList.push(c),t=h,e=u}}},e.prototype.getPointImg=function(){var t=ObjectPool.pop("eui.Image");return t.anchorOffsetX=4,t.anchorOffsetY=4,t.source="wj_blue_point",t},e}(SingleClass);__reflect(FindPathMgr.prototype,"FindPathMgr");var TotemBossControl=function(t){function e(){var e=t.call(this)||this;return e.bossReliveCd={},e.lastOnFb=!1,e.addCustomEvent(353,e.changeScene),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"inCopy",{get:function(){return 62==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.changeScene=function(){var t=this;this.inCopy?(this.lastOnFb=!0,TotemBossSceneControl.ins().open(),this.tPos&&MapControl.moveTo(this.tPos.x,this.tPos.y),this.tId&&TimerMgr.ins().once(1e3,function(){var e=TotemBossSceneControl.ins().bossHandelDic[t.tId];e&&gameControl.dispatchChangeAttrPoint(e)},this)):this.lastOnFb&&(this.tPos=null,this.lastOnFb=!1,UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView),UIMgr.ins().close(CrossBossReliveView),TotemBossSceneControl.ins().close())},e.prototype.isOpen=function(t){var e="";return GameServer.serverOpenDay+1<DataCenter.ins().TotemBossBaseConfig.openDay&&(e+=LangMgr.getValueByKey("darkHallBossTip1",DataCenter.ins().TotemBossBaseConfig.openDay)),e&&t&&tipsControl.showTips("|C:0xf3311e&T:"+e),""==e},e.prototype.canKill=function(t){if(!this.bossReliveCd)return!1;var e=Math.floor((DateUtils.formatMiniDateTime(this.bossReliveCd[t])-GameServer.serverTime)/DateUtils.MS_PER_SECOND),i=this.canChallenge(t);return 0>=e&&i},e.hasBelong=function(t){if(!t)return!0;for(var e=heroControl.roles.length,i=0;i<t.length;i++){for(var n=t[i],o=0,s=0;e>s;s++){var r=totemControl.getTuTengEquipInfo(s,n.totemId),a=0;for(var l in r)+l>=n.quality&&(a+=r[l]);o+=a}if(o<n.count)return!1}return!0},e.getTutenDpByBossId=function(t){for(var e in DataCenter.ins().TotemBossConfig){var i=DataCenter.ins().TotemBossConfig[e];if(t==i.bossId)return i}return null},e.prototype.canChallenge=function(t){var e=0;for(var i in DataCenter.ins().TotemBossFbConfig){var n=DataCenter.ins().TotemBossFbConfig[i];if(n.bossIdList.indexOf(t)>-1){e=n.lvLimit;break}}return CommonFun.checkLevel(e,!1)},e.prototype.enterFb=function(t,e,n,o){var s=this;isNaN(e)||isNaN(n)?this.tPos=null:this.tPos={x:e,y:n},isNaN(o)?this.tId=0:this.tId=o;var r=(DateUtils.formatMiniDateTime(this.enterCd)-GameServer.serverTime)/1e3>>0;if(r>0)return void tipsControl.warnTips(LangMgr.getValueByKey("kfTips4",r));var a=DataCenter.ins().TotemBossFbConfig[t];Assert(a,"TotembossErrorID="+t)||(CommonFun.checkLevel(a.lvLimit)&&i.hasBelong(a.totemCondition)?this.isOpen(!0)&&!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()&&warnControl.showDangerWarn(function(){s.upEnterFb(t)}):tipsControl.warnTips(LangMgr.getValueByKey("AtkConditionNoMeet")))},e.prototype.buyCount=function(){var t=DataCenter.ins().TotemBossBaseConfig.buyBelongCount;if(this.lefttime>0)return void tipsControl.warnTips(LangMgr.getValueByKey("useFinishBuy1",this.lefttime+"/"+t));if(this.buyTime>=t)return void tipsControl.warnTips(LangMgr.getValueByKey("ascriptionBuyAlrUpLimil"));if(CommonFun.checkCurrency(DataCenter.ins().TotemBossBaseConfig.buyCost)){var e=LangMgr.getValueByKey("warriorBelongTimeTip1",DataCenter.ins().TotemBossBaseConfig.buyCost,this.buyTime,t);warnControl.show(e,function(){this.upBuyBelong()}.bind(this),this)}},e.prototype.sendBossRemind=function(t){var e=ServerStorage.ins().getValue(29);this.getBossRemind(t)?e+=1<<t-1:e-=1<<t-1,ServerStorage.ins().setValue(29,e)},e.prototype.getBossRemind=function(t){var e=ServerStorage.ins().getValue(29);return e>>t-1&1?!1:!0},e.prototype.downInfo=function(t,e,i){this.lefttime=t,this.buyTime=e,this.enterCd=i,EventMgr.ins().dispatch(349)},e.prototype.upBossInfo=function(){},e.prototype.downBossInfo=function(t){this.bossReliveCd={};for(var e=0;t.length>e;e++){var i=t[e][0],n=t[e][1];this.bossReliveCd[i]=n;var o=DateUtils.formatMiniDateTime(this.bossReliveCd[i])-GameServer.serverTime;o>0&&!TimerMgr.ins().isExists(TotemBossRedpoint.ins().dispatchRedPoint,i)&&TimerMgr.ins().doTimer(o,1,TotemBossRedpoint.ins().dispatchRedPoint,i)}},e.prototype.upEnterFb=function(t){return[t]},e.prototype.upBuyBelong=function(){},e.prototype.downBelong=function(t){this.belongList={};for(var e,i=0,n=0,o=0;t.length>o;o++){var s=t[o][0],r=t[o][1],a=DataCenter.ins().TotemBossConfig[s];this.belongList[a.bossId]&&(i=this.belongList[a.bossId]),this.belongList[a.bossId]=r,this.curViewBossId==a.bossId&&(n=r,e=a)}var l="";if(e){var h=DataCenter.ins().MonstersConfig[e.bossId];l=h.name}bossControl.dispatchBelongChange(n,i,l)},e.prototype.downResult=function(t,e){var i=t==ActorControl.handle;i&&this.lefttime--;var n=UnitMgr.ins().getNoDieRole(),o=UnitMgr.ins().getEntityBymasterhHandle(t);if(!(n&&o&&MathUtils.getDistanceByObject(n,o)>DataCenter.ins().TotemBossBaseConfig.viewRange)){for(var s=o.infoModel,r="yuanhead"+s.job+s.sex,a=s.name,l=[],h=0;e.length>h;h++){var u=new RewardVo;u.init(e[h].slice(0,-1)),u.dropType=e[h][e[h].length-1],l.push(u),0==u.type&&1!=u.id&&2!=u.id&&9!=u.id||DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(UnitMgr.ins().getNoDieRole().x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(UnitMgr.ins().getNoDieRole().y/MapControl.CELL_SIZE),u])}var p=function(){resultControl.create(MapControl.copyType,!0,l,"",null,[i,a,r,o])};DropControl.start(),DropControl.addCompleteFunc(p,this)}},e.prototype.upCancelBelong=function(){},e.prototype.upBuyRevive=function(){},e.prototype.downReviveInfo=function(t,e){t=Math.floor((DateUtils.formatMiniDateTime(t)-GameServer.serverTime)/DateUtils.MS_PER_SECOND),t>0?UIMgr.ins().open(CrossBossReliveView,t,e):UIMgr.ins().close(CrossBossReliveView)},e.prototype.downBossDie=function(t,e){this.bossReliveCd[t]=e;var i=DateUtils.formatMiniDateTime(this.bossReliveCd[t])-GameServer.serverTime;i>0&&!TimerMgr.ins().isExists(TotemBossRedpoint.ins().dispatchRedPoint,t)&&TimerMgr.ins().doTimer(i,1,TotemBossRedpoint.ins().dispatchRedPoint,t)},__decorate([down(1,[2,2,3])],e.prototype,"downInfo",null),__decorate([up(2)],e.prototype,"upBossInfo",null),__decorate([down(2,[[2,3]])],e.prototype,"downBossInfo",null),__decorate([up(3,[1])],e.prototype,"upEnterFb",null),__decorate([up(4)],e.prototype,"upBuyBelong",null),__decorate([down(5,[[2,10]])],e.prototype,"downBelong",null),__decorate([down(6,[10,ByteConst.RewardVos.concat([1])])],e.prototype,"downResult",null),__decorate([up(7)],e.prototype,"upCancelBelong",null),__decorate([up(8)],e.prototype,"upBuyRevive",null),__decorate([down(8,[3,10])],e.prototype,"downReviveInfo",null),__decorate([down(9,[2,3])],e.prototype,"downBossDie",null),e=i=__decorate([protocolsId(28)],e);var i}(BaseSystem);__reflect(TotemBossControl.prototype,"TotemBossControl");var RedPacketRecordVo=function(){function t(){}return t.prototype.init=function(t){this.time=t[0],this.serverId=t[1],this.roleID=t[2],this.roleName=t[3],this.rewardType=t[4],this.rewardID=t[5],this.rewardCount=t[6],this.isPrecious=1==t[7]},t}();__reflect(RedPacketRecordVo.prototype,"RedPacketRecordVo");var TotemBossSceneControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bossHandelDic={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.open=function(){this.addCustomEvent(355,this.onChangeHp),this.addCustomEvent(354,this.onCreateEntity),this.addCustomEvent(356,this.onRemoveEntity),this.addCustomEvent(357,this.moveCamera),this.addCustomEvent(9,this.moveCamera),this.addCustomEvent(559,this.updateHandle),this.addCustomEvent(542,this.onCheckEnemy),TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.moveCamera(),UIMgr.ins().open(CrossSmallMapView,0)},e.prototype.close=function(){UIMgr.ins().close(CrossSmallMapView),TimerMgr.ins().removeAll(this),this.removeCustomEvents(),this.bossHandelDic={}},e.prototype.updateHandle=function(t){var e=t[0],i=t[1];this.tHandle=i,this.sHandle=e},e.prototype.onCheckEnemy=function(){var t=function(t){for(var e=targetListControl.canAttackHandles.length-1;e>-1;e--){var i=targetListControl.canAttackHandles[e],n=UnitMgr.ins().getEntityBymasterhHandle(i);n&&MathUtils.getDistanceByObject(t,n)>DataCenter.ins().TotemBossBaseConfig.viewRange&&targetListControl.canAttackHandles.splice(e,1)}},e=UnitMgr.ins().getNoDieRole();e?t(e):(e=UnitMgr.ins().getMainRole(0),e&&t(e))},e.prototype.onRemoveEntity=function(t){var e=(t[0],t[1]),i=e.infoModel;this.bossHandelDic[i.configID]&&delete this.bossHandelDic[i.configID],totemBossControl.curViewBossId==i.configID&&this.moveCamera()},e.prototype.onCreateEntity=function(t){2!=t.type||t.masterHandle||(this.bossHandelDic[t.configID]=t.handle,this.moveCamera(),totemBossControl.curViewBossId==t.configID&&monsterSpeakControl.dispatchMonsterSpeak("bosstishi"))},e.prototype.onChangeHp=function(t){var e=t[0],i=t[1],n=(t[2],e.infoModel);totemBossControl.curViewBossId&&totemBossControl.curViewBossId==n.configID&&(0>=i?this.closeBossPanel():this.openBossPanel(n))},e.prototype.onTime=function(){var t=this,e=function(e){if(t.tHandle){var i=UnitMgr.ins().getEntityByHandle(t.tHandle)||UnitMgr.ins().getEntityBymasterhHandle(t.tHandle);i&&MathUtils.getDistanceByObject(e,i)<=DataCenter.ins().TotemBossBaseConfig.viewRange&&(targetListControl.dispatchTargetList(t.sHandle,t.tHandle),t.tHandle=0)}},i=UnitMgr.ins().getNoDieRole();i&&(i.action!=UnitAction.STAND&&this.moveCamera(),e(i));var n=UIMgr.ins().getView(BossBloodView);n&&n.huDunChange(),totemBossControl.curViewBossId&&this.appearBossId!=totemBossControl.curViewBossId?(this.appearBossId=totemBossControl.curViewBossId,monsterSpeakControl.dispatchMonsterSpeak("bosstishi")):totemBossControl.curViewBossId||(this.appearBossId=0)},e.prototype.moveCamera=function(){var t=UnitMgr.ins().getNoDieRole();if(t){totemBossControl.curViewBossId=0;for(var e in DataCenter.ins().TotemBossConfig){var i=DataCenter.ins().TotemBossConfig[e];if(this.bossHandelDic[i.bossId]){var n=this.bossHandelDic[i.bossId],o=UnitMgr.ins().getEntityByHandle(n);if(o&&o.infoModel.configID==i.bossId){var s={x:MapControl.point2Grip(t.x),y:MapControl.point2Grip(t.y)};if(MapControl.checkAreaById(s,i.areaId)){totemBossControl.curViewBossId=i.bossId;break}}}}if(totemBossControl.curViewBossId){if(bossControl.monsterID=totemBossControl.curViewBossId,totemBossControl.belongList&&totemBossControl.belongList[totemBossControl.curViewBossId]&&(bossControl.attHandle=totemBossControl.belongList[totemBossControl.curViewBossId]),this.bossHandelDic[totemBossControl.curViewBossId]){var o=UnitMgr.ins().getEntityByHandle(this.bossHandelDic[totemBossControl.curViewBossId]);if(o){var r=o.infoModel;this.openBossPanel(r)}}}else this.closeBossPanel(),bossControl.attHandle=0}},e.prototype.openBossPanel=function(t){bossControl.monsterID=t.configID,bossControl.hp=t.getAtt(0),bossControl.bossHandler=t.handle,bossControl.hp>0&&(UIMgr.ins().open(BossBloodView),UIMgr.ins().open(BossBelongView))},e.prototype.closeBossPanel=function(){UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView)},e}(BaseSystem);__reflect(TotemBossSceneControl.prototype,"TotemBossSceneControl");var TotemBossPanel=function(t){function e(){var e=t.call(this)||this;return e.threshold=5,e.left=0,e.right=0,e.bottom=0,e.top=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reminder.textFlow=TextUtils.formatUnderLineStr(this.reminder.text),this.buyTimeCount.textFlow=TextUtils.formatUnderLineStr(this.buyTimeCount.text),this.suitList.itemRenderer=TotemBossTabItemRender,this.tabListDt=new eui.ArrayCollection(CommonUtils.objectToArrayShallow(DataCenter.ins().TotemBossFbConfig)),this.suitList.dataProvider=this.tabListDt,this.tabScroller.horizontalScrollBar=null},e.prototype.open=function(){this.addEventChange(this.suitList,this.onTab),this.addEventTouchTap(this.enterBtn,this.onTouch),this.addEventTouchTap(this.buyTimeCount,this.onTouch),this.addEventTouchTap(this.reminder,this.onTouch);for(var t=0;5>t;t++)this["bossItem"+t].addUiEvent();this.addCustomEvent(349,this.upData),this.addCustomEvent(557,this.refRedpoint),this.addEventTouchBegin(this.suitList,this.onStartTouch),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime();for(var e=0,i=CommonUtils.objectToArrayShallow(DataCenter.ins().TotemBossFbConfig),t=i.length-1;t>-1;t--){for(var n=i[t].bossIdList,o=0;o<n.length;o++){var s=n[o],r=DataCenter.ins().TotemBossConfig[s];if(totemBossControl.canChallenge(s)&&TotemBossControl.hasBelong(r.belongTotemCondition)&&totemBossControl.getBossRemind(s)){e=t;break}}if(e)break}this.suitList.selectedIndex=e,this.onChange(this.suitList.selectedIndex+1),this.upData()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.$onClose();for(var t=0;5>t;t++)this["bossItem"+t].removeUiEvent()},e.prototype.refRedpoint=function(){if(this.curDp)for(var t=0,e=this.curDp.bossIdList,i=0;i<e.length;i++){var n=this["bossItem"+t];n&&(n.refRed(),t++)}},e.prototype.onTime=function(){if(this.curDp)for(var t=0,e=this.curDp.bossIdList,i=0;i<e.length;i++){var n=this["bossItem"+t];n&&(n.onTime(),t++)}},e.prototype.tabMoveTw=function(){var t=158,e=(this.suitList.selectedIndex-1)*t;egret.Tween.get(this.tabScroller.viewport).to({scrollH:e},200)},e.prototype.onStartTouch=function(t){this.sTpos=t.stageX,this.addEventTouchMove(this.suitList,this.onEndTouch)},e.prototype.onEndTouch=function(t){if(Math.abs(t.stageX-this.sTpos)>this.threshold){this.removeEventTouchMove(this.suitList,this.onEndTouch),this.tabScroller.stopAnimation();var e=t.stageX>this.sTpos?-1:1,i=this.suitList.selectedIndex+e;0>i&&(i=0),i>this.tabListDt.length-1&&(i=this.tabListDt.length-1),this.suitList.selectedIndex=i,this.onChange(this.suitList.selectedIndex+1)}},e.prototype.onTouch=function(t){switch(t.target){case this.enterBtn:totemBossControl.enterFb(this.curDp.id);break;case this.buyTimeCount:totemBossControl.buyCount();break;case this.reminder:UIMgr.ins().open(TotemBossRemindView)}},e.prototype.onTab=function(t){this.onChange(this.suitList.selectedIndex+1)},e.prototype.onChange=function(t){if(this.tabMoveTw(),this.curDp=DataCenter.ins().TotemBossFbConfig[t],this.curDp){this.bg.source=this.curDp.uiBg;for(var e=0,i=this.curDp.bossIdList,n=0;n<i.length;n++){var o=i[n],s=this["bossItem"+e];if(s){var r=DataCenter.ins().TotemBossConfig[o];s.setData(r),s.x=r.uiPos.x,s.y=r.uiPos.y,s.headImg.name=r.pos.posX+"_"+r.pos.posY+"_"+r.bossId,e++,r=DataCenter.ins().TotemBossConfig[o]}}var a=void 0;if(this.curDp.totemCondition)for(var l in this.curDp.totemCondition)(!a||this.curDp.totemCondition[l].quality<a.quality)&&(a=this.curDp.totemCondition[l]);if(a){var h=totemControl.getTotemDpById(a.totemId),u=h.nameTxt,p=LangMgr.getValueByKey("threeRoleApparel",a.count,DataCenter.ins().TotemCornerConfig[a.quality].equipQualityCN,u);this.demandDesc.textFlow=TextUtils.generateTextFlow1(p)}else this.demandDesc.text=LangMgr.getValueByKey("noAffiliationCond");this.enterBtn.enabled=TotemBossControl.hasBelong(this.curDp.totemCondition),this.demandDesc.textColor=TotemBossControl.hasBelong(this.curDp.totemCondition)?ColorUtils.GREEN:ColorUtils.RED,this.leftEnd.visible=0==this.suitList.selectedIndex,this.rightEnd.visible=this.suitList.selectedIndex==this.tabListDt.length-1;for(var n=0;5>n;n++)this["bossItem"+n].fbId=this.curDp.id;egret.TouchEvent.dispatchTouchEvent(this.tabScroller.viewport,egret.TouchEvent.TOUCH_END,!0)}},e.prototype.upData=function(){var t=totemBossControl.lefttime||0,e=t>0?ColorUtils.GREEN:ColorUtils.RED,i=LangMgr.getValueByKey("surplusAffiliationNum","|C:"+e+"&T:"+t+"|");this.timeCount.textFlow=TextUtils.generateTextFlow1(i),this.timeCount0.visible=bossControl.checkShowAsist(62),this.timeCount0.visible&&(this.timeCount0.textFlow=TextUtils.generateTextFlow1(bossControl.getAsistText()))},e}(BasePanel);__reflect(TotemBossPanel.prototype,"TotemBossPanel");var TotemBossRemindView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemBossRemindViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listDatas=new eui.ArrayCollection,this.list0.itemRenderer=TotemBossRemindItemRender,this.list0.dataProvider=this.listDatas},e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTouch),this.listDatas.replaceAll(CommonUtils.objectToArrayShallow(DataCenter.ins().TotemBossConfig))},e.prototype.close=function(){TotemBossRedpoint.ins().dispatchRedPoint()},e.prototype.onTouch=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TotemBossRemindView.prototype,"TotemBossRemindView");var TotemBossSceneMapView=function(t){function e(){var e=t.call(this)||this;e.skinName="TotemBossSceneMapViewSkin",e.uilayer=GameLayer.POPUP;for(var i=0;5>i;i++)e["bossItem"+i].startEvent();return e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEvent(egret.Event.COMPLETE,this.smallMap,this.onMapComplete),this.smallMap.source=PATH_MAP+MapControl.getFileName()+"/small.jpg",TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this);var t=totemBossControl.lefttime,e=t>0?ColorUtils.GREEN:ColorUtils.RED;this.belongTime.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("surplusCount","|C:"+e+"&T:"+t+"|"))},e.prototype.close=function(){this.findPathMgr&&this.findPathMgr.dispose(),TimerMgr.ins().removeAll(this);for(var t=0;5>t;t++)this["bossItem"+t].endEvent()},e.prototype.onTime=function(){for(var t=0;5>t;t++)this["bossItem"+t].onTime()},e.prototype.onMapComplete=function(){this.findPathMgr=new FindPathMgr(this.anigroup,this.playerImg,this.smallMap)},e.prototype.initUI=function(){var t;for(var e in DataCenter.ins().TotemBossFbConfig){var i=DataCenter.ins().TotemBossFbConfig[e];if(i.fbId==MapControl.copyId){t=i;break}}if(t)for(var n=0,o=t.bossIdList,s=0;s<o.length;s++){var r=o[s],a=this["bossItem"+n];if(a){var l=DataCenter.ins().TotemBossConfig[r];a.setData(l),a.x=l.pos.posX*MapControl.CELL_SIZE/10,a.y=l.pos.posY*MapControl.CELL_SIZE/10,n++}}},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(TotemBossSceneMapView.prototype,"TotemBossSceneMapView");var TotemBossShowAwardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemBossShowAwardViewSkin",e.uilayer=GameLayer.POPUP,e.awardListt.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTouch);var i;for(var n in DataCenter.ins().TotemBossConfig){var o=DataCenter.ins().TotemBossConfig[n];if(o.bossId==totemBossControl.curViewBossId){i=o;break}}if(i){var s;if(i.belongTotemCondition)for(var n in i.belongTotemCondition)(!s||i.belongTotemCondition[n].quality<s.quality)&&(s=i.belongTotemCondition[n]);var r="";if(s){var a=totemControl.getTotemDpById(s.totemId),l=a.nameTxt;r=LangMgr.getValueByKey("threeRoleApparel1",s.count,DataCenter.ins().TotemCornerConfig[s.quality].equipQualityCN,l)}else r="";this.awardListt.dataProvider=new eui.ArrayCollection(i.showRewards),this.condition.textFlow=TextUtils.generateTextFlow1(r)}},e.prototype.onTouch=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TotemBossShowAwardView.prototype,"TotemBossShowAwardView");var TotemBossItemRender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.awardList.itemRenderer=ItemBaseNoName,this.redPoint.visible=!1},e.prototype.addUiEvent=function(){this.addEventTouchTap(this,this.onTouch)},e.prototype.removeUiEvent=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){if(!(t.target instanceof ItemBaseNoName)){var e=this.dp.pos.posX*MapControl.CELL_SIZE,i=this.dp.pos.posY*MapControl.CELL_SIZE;totemBossControl.enterFb(this.fbId,e,i,this.dp.bossId),egret.Tween.get(this.bossGroup).to({top:10},80).to({top:0},80)}},e.prototype.setData=function(t){this.dp=t;var e=DataCenter.ins().MonstersConfig[t.bossId];this.nameTxt.text=e.name,this.headImg.source="monhead"+e.head+"_png",this.reliveTimeTxt.text="";var i;if(this.dp.belongTotemCondition)for(var n in this.dp.belongTotemCondition)(!i||this.dp.belongTotemCondition[n].quality<i.quality)&&(i=this.dp.belongTotemCondition[n]);if(i){for(var o=totemControl.getTotemDpById(i.totemId),s=o.nameTxt,r=0,a=heroControl.roles.length,l=0;a>l;l++){var h=totemControl.getTuTengEquipInfo(l,this.dp.belongTotemCondition[0].totemId),u=0;for(var n in h)+n>=this.dp.belongTotemCondition[0].quality&&(u+=h[n]);r+=u}var p=LangMgr.getValueByKey("threeRoleApparel","\n("+r+"/"+i.count+")",DataCenter.ins().TotemCornerConfig[i.quality].equipQualityCN,s);this.termTxt.textFlow=TextUtils.generateTextFlow1(p)}else this.termTxt.text=LangMgr.getValueByKey("noAffiliationCond");TotemBossControl.hasBelong(this.dp.belongTotemCondition)?this.termTxt.textColor=totemBossControl.getBossRemind(this.dp.id)?ColorUtils.GREEN:13746831:this.termTxt.textColor=ColorUtils.RED,this.awardList.dataProvider=new eui.ArrayCollection(this.dp.showRewards),this.nonBelong.visible=!TotemBossControl.hasBelong(this.dp.belongTotemCondition),this.onTime()},e.prototype.onTime=function(){if(this.dp){var t=totemBossControl.bossReliveCd;if(t[this.dp.id]){var e=Math.floor((DateUtils.formatMiniDateTime(t[this.dp.id])-GameServer.serverTime)/DateUtils.MS_PER_SECOND);e>0?(this.deadMask.visible=!0,this.headImg.filters=FilterUtils.ARRAY_GRAY_FILTER,this.reliveTimeTxt.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3)):(this.reliveTimeTxt.text="",this.deadMask.visible=!1,this.headImg.filters=[])}else this.reliveTimeTxt.text="",this.deadMask.visible=!1,this.headImg.filters=[]}},e.prototype.refRed=function(){this.termTxt.textColor!=ColorUtils.RED&&(this.termTxt.textColor=totemBossControl.getBossRemind(this.dp.id)?ColorUtils.GREEN:13746831)},e}(BasePanel);__reflect(TotemBossItemRender.prototype,"TotemBossItemRender");var TotemBossMapItemRender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.nonBelong.visible=!1,this.reliveTimeTxt0.visible=!0},e.prototype.startEvent=function(){this.addEventTouchTap(this.headGroup,this.onKill)},e.prototype.endEvent=function(){this.removeEventTouchTap(this.headGroup,this.onKill)},e.prototype.onKill=function(){var t=TotemBossSceneControl.ins().bossHandelDic[this.dp.bossId];t&&gameControl.dispatchChangeAttrPoint(t),egret.Tween.get(this.headGroup).to({scaleX:.4,scaleY:.4},90).to({scaleX:.6,scaleY:.6},150)},e.prototype.setData=function(t){this.dp=t;var e=DataCenter.ins().MonstersConfig[t.bossId];this.nameTxt0.text=e.name,this.headImg0.source="monhead"+e.head+"_png",this.nonBelong.visible=!TotemBossControl.hasBelong(this.dp.belongTotemCondition),this.reliveTimeTxt0.text="",this.onTime()},e.prototype.onTime=function(){if(this.dp){var t=totemBossControl.bossReliveCd;if(t[this.dp.id]){var e=Math.floor((DateUtils.formatMiniDateTime(t[this.dp.id])-GameServer.serverTime)/DateUtils.MS_PER_SECOND);e>0?(this.deadMask0.visible=!0,this.headImg0.filters=FilterUtils.ARRAY_GRAY_FILTER,this.reliveTimeTxt0.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3)):(this.reliveTimeTxt0.text="",this.deadMask0.visible=!1,this.headImg0.filters=[])}else this.reliveTimeTxt0.text="",this.deadMask0.visible=!1,this.headImg0.filters=[]}},__decorate([callLater],e.prototype,"onKill",null),e}(BasePanel);__reflect(TotemBossMapItemRender.prototype,"TotemBossMapItemRender");var TotemBossRemindItemRender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSetting=function(t,e){totemBossControl.sendBossRemind(t)},e.prototype.getSetting=function(t){return totemBossControl.getBossRemind(t)},e.prototype.dataChanged=function(){this.checkMoveEvent();var t=this.data,e=DataCenter.ins().MonstersConfig[t.bossId];this.bossName.text=e.name;var i=totemControl.getTotemDpById(t.dropId);this.demandScore.text=i.nameTxt;for(var n,o=t.showRewards,s=0;s<o.length;s++){var r=o[s];if(0!=r.type){var a=DataCenter.ins().ItemConfig[r.id];a.level==t.dropQuality&&(n=a)}}n||(n=DataCenter.ins().ItemConfig[t.showRewards[0].id]),this.demandScore0.text=DataCenter.ins().TotemCornerConfig[t.dropQuality].equipQualityCN,this.demandScore0.textColor=ItemUtils.getQualityColor(n);var l=totemBossControl.canChallenge(t.id)&&TotemBossControl.hasBelong(t.belongTotemCondition);this.checkBoxs.selected=this.getSetting(t.id),this.txt.visible=!l,this.checkBoxs.visible=l},e}(PublicBossRemindItemRenderer);__reflect(TotemBossRemindItemRender.prototype,"TotemBossRemindItemRender");var TotemBossTabItemRender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.sceneName.source=this.data.sceneNameRes,this.redPoint.visible=TotemBossRedpoint.ins().redpointTab[this.data.id])},e}(BaseItemRender);__reflect(TotemBossTabItemRender.prototype,"TotemBossTabItemRender");var DaifugControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dice=0,e.gridId=0,e.round=0,e.roundReward=0,e.randomGridById=0,e.randomGridByRewardId=0,e.rewardIdByGrids=[],e.isStrideStart=0,e.dicePoint=0,e.autoTurnDice=0,e.autoTurnDice2=0,e.isAutoGo=!1,e
}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downMillionaireInfo=function(t,e,i,n,o,s,r){this.dice=t,this.gridId=e,this.round=i,this.roundReward=n,this.randomGridById=o,this.randomGridByRewardId=s;for(var a=0;a<r.length;a++){var l=r[a];this.rewardIdByGrids[a+1]=l}EventMgr.ins().dispatch(134)},e.prototype.downTurnDice=function(t,e,i){this.isStrideStart=t,this.gridId=e,this.dicePoint=i,EventMgr.ins().dispatch(135)},e.prototype.downRoundReward=function(t,e){this.roundReward=e,EventMgr.ins().dispatch(136)},e.prototype.downOverAllReward=function(t,e){this.randomGridById=t,this.randomGridByRewardId=e,EventMgr.ins().dispatch(137)},e.prototype.downMillionaireUpdate=function(t,e,i){this.dice=t,this.round=e,this.roundReward=i,EventMgr.ins().dispatch(138)},e.prototype.upMillionaireInfo=function(){},e.prototype.upTurnDice=function(){},e.prototype.upRoundReward=function(t){return[t]},e.prototype.getRedPoint=function(){if(!DaifugEnterView.isOpen())return!1;if(this.dice>0)return!0;for(var t in DataCenter.ins().DaifugRoundAwardConfig)if(!(this.roundReward>>Number(t)&1)&&this.round>=DataCenter.ins().DaifugRoundAwardConfig[t].round)return!0;return!1},__decorate([down(1,[2,2,2,3,2,4,[2]])],e.prototype,"downMillionaireInfo",null),__decorate([down(2,[4,2,4])],e.prototype,"downTurnDice",null),__decorate([down(3,[4,3])],e.prototype,"downRoundReward",null),__decorate([down(4,[2,4])],e.prototype,"downOverAllReward",null),__decorate([down(5,[2,2,3])],e.prototype,"downMillionaireUpdate",null),__decorate([up(1)],e.prototype,"upMillionaireInfo",null),__decorate([up(2)],e.prototype,"upTurnDice",null),__decorate([up(3,[3])],e.prototype,"upRoundReward",null),e=__decorate([protocolsId(57)],e)}(BaseSystem);__reflect(DaifugControl.prototype,"DaifugControl");var CDKeyControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upCdkey=function(t){return t.length<=0?(tipsControl.showTips(LangMgr.getValueByKey("customCodeActive")),!1):[t]},e.prototype.downChangeResult=function(t){tipsControl.showTips(LangMgr.getValueByKey("cdKeyTips"+t))},__decorate([up(1,[8])],e.prototype,"upCdkey",null),__decorate([down(1,[1])],e.prototype,"downChangeResult",null),e=__decorate([protocolsId(29)],e)}(BaseSystem);__reflect(CDKeyControl.prototype,"CDKeyControl");var DaifugEnterView=function(t){function e(){var e=t.call(this)||this;return e.isShowDice=!1,e.isTopLevel=!0,e.skinName="DaifugEnterViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.isOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().DaifugBaseConfig.openday-1?!1:!0},e.openCheck=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.isOpen();return n||tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().DaifugBaseConfig.openday)),n},e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.addEventTouchTap(this.go,this.onClick),this.addEventTouchTap(this.autoGo,this.onClick),this.addEventTouchTap(this.arrowleft,this.onClick),this.addEventTouchTap(this.arrowright,this.onClick),this.addCustomEvent(134,this.callbackInfo),this.addCustomEvent(135,this.callbackTurnDice),this.addCustomEvent(136,this.callbackRoundReward),this.addCustomEvent(138,this.callbackMillionaireUpdate),this.touchGroup.touchEnabled=!1,this.reward.touchEnabled=!1,this.paycount.touchEnabled=!1,this.y1.touchEnabled=!1,this.y2.touchEnabled=!1,this.touchMoving=!1,this.dice.visible=!1;for(var n=1;8>=n;n++)this.addEventTouchTap(this["box"+n],this.onTab);var o=Object.keys(DataCenter.ins().DaifugRoundAwardConfig).length;if(e.MaxBoxGroup=Math.floor(o/4),daifugControl.isAutoGo=!1,this.startBoxId=0,this.beginPoint=0,this.touchMoving=!1,this.ewtime=300,this.actCircle=[],this.dicenum=1,this.isShowDice=!1,!this.masksp){this.masksp=new egret.Sprite;var s=new egret.Shape;s.graphics.beginFill(LangMgr.getColor("color42")),s.graphics.drawRect(this.group1.x,this.group1.y,this.group1.width,this.group1.height),s.graphics.endFill(),this.masksp.addChild(s),this.reward.addChild(this.masksp),this.reward.mask=this.masksp}this.init(),this.daifugPanel.open(),TimerMgr.ins().remove(this.updateMillionaire,this),TimerMgr.ins().doTimer(100,0,this.updateMillionaire,this)},e.prototype.updateMillionaire=function(){return this.daifugPanel.diceimg?(this.dice.visible=!0,void(this.isShowDice&&this.daifugPanel.countDown<=DataCenter.ins().DaifugBaseConfig.diceTime/2?this.dice.source="richman_dice"+daifugControl.dicePoint:(this.dice.source="richman_dice"+this.dicenum,this.dicenum++,this.dicenum>6&&(this.dicenum=1)))):(this.isShowDice=!1,this.dice.visible=!1,this.dicenum=1,void(daifugControl.isAutoGo&&this.turnDice()))},e.prototype.callbackMillionaireUpdate=function(){this.init()},e.prototype.callbackInfo=function(){this.init()},e.prototype.callbackTurnDice=function(){this.isShowDice=!0,this.init()},e.prototype.callbackRoundReward=function(){tipsControl.showTips(LangMgr.getValueByKey("millionTips5")),this.init()},e.prototype.init=function(){this.checkStartIndex(),this.startBoxId=this.startBoxId?this.startBoxId:1,this.dicecount.text=daifugControl.dice+"",this.count.text=LangMgr.getValueByKey("millionTips6",daifugControl.round+1),this.paycount.text=DataCenter.ins().DaifugBaseConfig.dicePrice+"",this.setBoxPos()},e.prototype.setProgressBar=function(){for(var t=daifugControl.round,e=(DataCenter.ins().DaifugRoundAwardConfig[Object.keys(DataCenter.ins().DaifugRoundAwardConfig).length].round,0),i=4*(this.startBoxId-1),n=100,o=i,s=0;i+4>o;o++,s++){var r=o+1;if(s)if(this["bar"+(s-1)]&&this["bar"+(s-1)].value<100)this["bar"+s].value=0,this["bar"+s].labelFunction=function(){return""};else{var a=DataCenter.ins().DaifugRoundAwardConfig[r],l=DataCenter.ins().DaifugRoundAwardConfig[r-1],h=a.round-l.round,u=t-l.round;u=u>0?u:0;var p=u/h;e=p>=1?n:Math.floor(n*p);var c=this["bar"+s];c.value=Math.floor(e>=100?100:e),this["bar"+s].labelFunction=function(){return""}}}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.go:this.turnDice();break;case this.autoGo:daifugControl.isAutoGo=!daifugControl.isAutoGo,this.autoGo.label=daifugControl.isAutoGo?LangMgr.getValueByKey("wingStop1"):LangMgr.getValueByKey("millionTips7");break;case this.arrowleft:this.MoveLeft();break;case this.arrowright:this.MoveRight()}},e.prototype.turnDice=function(){var t=this;if(!this.daifugPanel.effing&&!this.daifugPanel.btnUp)if(daifugControl.dice>0)daifugControl.upTurnDice(),this.daifugPanel.btnUp=!0,daifugControl.isAutoGo||(this.daifugPanel.diceimg=!0);else if(daifugControl.autoTurnDice)this.cost();else{if(daifugControl.isAutoGo)return void this.cost();warnControl.show(LangMgr.getValueByKey("millionTips8",DataCenter.ins().DaifugBaseConfig.dicePrice),function(){t.cost()},this,function(){ServerStorage.ins().setBitBool(ClientSetBit.dice,!1),daifugControl.autoTurnDice=0},this,"check")}},e.prototype.cost=function(){ActorControl.yb>=DataCenter.ins().DaifugBaseConfig.dicePrice?(daifugControl.upTurnDice(),this.daifugPanel.btnUp=!0,daifugControl.isAutoGo||(this.daifugPanel.diceimg=!0),this.flyRMB(DataCenter.ins().DaifugBaseConfig.dicePrice)):(tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),daifugControl.isAutoGo=!1,this.daifugPanel.btnUp=!1,this.autoGo.label=LangMgr.getValueByKey("millionTips7"))},e.prototype.onTab=function(t){for(var e=1;8>=e;e++)if(t.currentTarget==this["box"+e]){this.getReward(e);break}},e.prototype.getReward=function(t){UIMgr.ins().open(DaifugTipsView,t)},e.prototype.onBegin=function(t){this.touchMoving||(this.beginPoint=t.stageX)},e.prototype.onEnd=function(t){if(!this.touchMoving&&0!=this.beginPoint){var e=t.stageX-this.beginPoint;Math.abs(e)<5||this.Moving(e)}},e.prototype.Moving=function(t){0>t?this.MoveRight():this.MoveLeft()},e.prototype.MoveRight=function(){var t=this;this.touchMoving=!0;var i=this;if(this.startBoxId>=e.MaxBoxGroup)return this.touchMoving=!1,this.arrowright.visible=!1,void(this.arrowleft.visible=!this.arrowright.visible);this.startBoxId++,this.startBoxId>=e.MaxBoxGroup&&(this.startBoxId=e.MaxBoxGroup,this.arrowright.visible=!1,this.arrowleft.visible=!this.arrowright.visible);for(var n=function(n){egret.Tween.get(o["group"+n]).to({x:o["group"+n].x-o["group"+n].width},o.ewtime).call(function(){egret.Tween.removeTweens(i["group"+n]),n==e.MaxBoxGroup&&(i.setBoxPos(),i.touchMoving=!1,t.arrowleft.visible=!0)})},o=this,s=1;s<=e.MaxBoxGroup;s++)n(s)},e.prototype.MoveLeft=function(){var t=this;this.touchMoving=!0;var i=this;if(this.startBoxId<=1){this.touchMoving=!1,this.arrowleft.visible=!1,this.arrowright.visible=!this.arrowleft.visible;var n=Object.keys(DataCenter.ins().DaifugRoundAwardConfig).length;return void(1==Math.floor(n/4)&&(this.arrowright.visible=!1))}if(this.startBoxId--,this.startBoxId<=1){this.startBoxId=1,this.arrowleft.visible=!1,this.arrowright.visible=!this.arrowleft.visible;var n=Object.keys(DataCenter.ins().DaifugRoundAwardConfig).length;1==Math.floor(n/4)&&(this.arrowright.visible=!1)}for(var o=function(n){egret.Tween.get(s["group"+n]).to({x:s["group"+n].x+s["group"+n].width},s.ewtime).call(function(){egret.Tween.removeTweens(i["group"+n]),n==e.MaxBoxGroup&&(i.setBoxPos(),i.touchMoving=!1,t.arrowright.visible=!0)})},s=this,r=1;r<=e.MaxBoxGroup;r++)o(r)},e.prototype.setBoxPos=function(){for(var t=1;t<=e.MaxBoxGroup;t++)if(1!=t){var i=t-this.startBoxId;this["group"+t].x=this["group"+(t-1)].x+this["group"+t].width*i}else this["group"+t].x=48;for(var t=1;t<=e.MaxBoxGroup;t++)if(t==this.startBoxId)this["group"+t].x=48;else if(t<this.startBoxId){var i=this.startBoxId-t,n=t-1>0?t-1:1;this["group"+t].x=this["group"+n].x-this["group"+t].width*i}else{var i=t-this.startBoxId;this["group"+t].x=this["group"+(t-1)].x+this["group"+t].width*i}this.updateRewardUI()},e.prototype.updateRewardUI=function(){for(var t=4*(this.startBoxId-1),e=0,i=t;t+4>i;i++){var n=i+1;if(daifugControl.roundReward>>n&1)this["box"+e+"desc"].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("activitAlreadingGet")),this.clearEff(e);else{var o=DataCenter.ins().DaifugRoundAwardConfig[n].round;this["box"+e+"desc"].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips9",o)),this.updateEff(e,o)}e++}this.setProgressBar()},e.prototype.updateEff=function(t,e){daifugControl.round>=e?(this.actCircle[t]||(this.actCircle[t]=new GameMovieClip),this.actCircle[t].parent||this.reward.addChild(this.actCircle[t]),this.actCircle[t].x=this["box"+t+"under"].x+40,this.actCircle[t].y=this["box"+t+"under"].y+50,this.actCircle[t].playFile(PATH_EFF+"actIconCircle",-1)):DisplayUtils.removeFromParent(this.actCircle[t])},e.prototype.clearEff=function(t){DisplayUtils.removeFromParent(this.actCircle[t])},e.prototype.checkStartIndex=function(){for(var t=1;t<=Object.keys(DataCenter.ins().DaifugRoundAwardConfig).length;t++){var i=DataCenter.ins().DaifugRoundAwardConfig[t];if(i&&!(daifugControl.roundReward>>t&1)){this.startBoxId=Math.floor(t/5)+1;break}}if(this.startBoxId<=1){this.arrowleft.visible=!1,this.arrowright.visible=!this.arrowleft.visible;var n=Object.keys(DataCenter.ins().DaifugRoundAwardConfig).length;1==Math.floor(n/4)&&(this.arrowright.visible=!1)}else this.startBoxId>=e.MaxBoxGroup?(this.arrowleft.visible=!0,this.arrowright.visible=!this.arrowleft.visible):(this.arrowleft.visible=!0,this.arrowright.visible=!0)},e.prototype.flyRMB=function(t){var e=new eui.BitmapLabel;e.font="num_2_fnt",e.y=this.roleSelect.y+10,e.x=this.roleSelect.x+490,e.scaleX=e.scaleY=1.5,e.text="-"+t,this.roleSelect.parent.addChild(e),egret.Tween.get(e).to({y:e.y+50},1e3).call(function(){DisplayUtils.removeFromParent(e)})},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.go,this.onClick),this.removeEventTouchTap(this.autoGo,this.onClick),this.daifugPanel.close();for(var i=1;8>=i;i++)this.removeEventTouchTap(this["box"+i],this.onTab);TimerMgr.ins().remove(this.updateMillionaire,this);for(var i=0;i<this.actCircle.length;i++)this.actCircle[i]&&DisplayUtils.removeFromParent(this.actCircle[i]);DisplayUtils.removeFromParent(this.masksp),this.masksp=null,this.removeCustomEvents()},e.MaxBoxGroup=2,e}(BaseEuiView);__reflect(DaifugEnterView.prototype,"DaifugEnterView");var DaifugPanel=function(t){function e(){var e=t.call(this)||this;return e.step=3,e.count=0,e.gridList=[],e.curGridId=daifugControl.gridId?daifugControl.gridId:1,e.nextPos=e.curGridId,e.cameraWidth=DataCenter.ins().DaifugBaseConfig.cameraWidth,e.cameraHeight=DataCenter.ins().DaifugBaseConfig.cameraHeight,e.updateStop=!0,e.countDown=0,e.aniTime=0,e.dictime=10,e.count=0,e.effing=!1,e.btnUp=!1,e.stepNum=0,e.isUpdateRandom=!1,e.step=DataCenter.ins().DaifugBaseConfig.speed,e.diceimg=!1,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateMillionaire,this),this.gridList=[],this.roleModel.destory(),DisplayUtils.removeFromParent(this.masksp)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(134,this.callbackMillionaireInfo),this.addCustomEvent(135,this.callbackTurnDice),this.addCustomEvent(137,this.callbackOverAllReward),this.createMap(),this.createRole(),this.initPos(),TimerMgr.ins().remove(this.updateMillionaire,this),TimerMgr.ins().doTimer(this.dictime,0,this.updateMillionaire,this)},e.prototype.callbackMillionaireInfo=function(){},e.prototype.callbackTurnDice=function(){daifugControl.isStrideStart?(this.nextPos=1,this.stepNum=daifugControl.dicePoint-(this.gridList.length-this.curGridId)):this.nextPos=this.curGridId+daifugControl.dicePoint;var t=DataCenter.ins().DaifugGridConfig[this.nextPos];t&&3==t.action||1!=this.nextPos&&(this.nextPos=daifugControl.gridId),daifugControl.isAutoGo?this.countDown=0:this.countDown=DataCenter.ins().DaifugBaseConfig.diceTime,this.updateStop=!1},e.prototype.callbackOverAllReward=function(){this.isUpdateRandom=!0},e.prototype.updateMapEx=function(){var t=this;this.updateEff(function(){t.updateMap()})},e.prototype.updateMapOnly=function(){var t=this.curGridId;this.gridList[t].setHideEff(),daifugControl.rewardIdByGrids[t]=-1},e.prototype.updateEff=function(t){this.aniTime=.5,this.effing=!0;var e=this;this.arrEff=[];for(var i=function(t){var i=n.gridList[t];if(3==DataCenter.ins().DaifugGridConfig[t].action||4==DataCenter.ins().DaifugGridConfig[t].action)return n.arrEff[t]=!0,"continue";if(n.arrEff[t]=!1,i){if(i.isEffing)return e.arrEff[t]=!0,"continue";egret.Tween.get(i.itemicon).to({scaleX:0,scaleY:0},1e3*n.aniTime).call(function(){egret.Tween.removeTweens(i.itemicon),e.arrEff[t]=!0})}},n=this,o=1;o<=this.gridList.length-1;o++)i(o);this.callfunc=t},e.prototype.getDirection=function(){if(this.mapGroup.width<=this.cameraWidth&&this.mapGroup.height<=this.cameraHeight)return 1;var t=new egret.Point;t.x=this.gridList[this.curGridId].x,t.y=this.gridList[this.curGridId].y;var e=Math.floor(t.x+this.gridList[this.curGridId].width/2),i=Math.floor(t.y+this.gridList[this.curGridId].height/2);return e>=Math.floor(this.cameraWidth/2)&&i>=Math.floor(this.cameraHeight/2)&&e<=Math.floor(this.mapGroup.width-this.cameraWidth/2)&&i<=Math.floor(this.mapGroup.height-this.cameraHeight/2)?9:e<=Math.floor(this.cameraWidth/2)&&i<=Math.floor(this.cameraHeight/2)?1:e>=Math.floor(this.cameraWidth/2)&&e<=Math.floor(this.mapGroup.width-this.cameraWidth/2)&&i<=Math.floor(this.cameraHeight/2)?2:e>=Math.floor(this.mapGroup.width-this.cameraWidth/2)&&i<=Math.floor(this.cameraHeight/2)?3:e<=Math.floor(this.cameraWidth/2)&&i>=Math.floor(this.cameraHeight/2)&&i<=Math.floor(this.mapGroup.height-this.cameraHeight/2)?4:e>=Math.floor(this.mapGroup.width-this.cameraWidth/2)&&i>=Math.floor(this.cameraHeight/2)&&i<=Math.floor(this.mapGroup.height-this.cameraHeight/2)?5:e<=Math.floor(this.cameraWidth/2)&&i>=Math.floor(this.mapGroup.height-this.cameraHeight/2)?6:e>=Math.floor(this.cameraWidth/2)&&e<=Math.floor(this.mapGroup.width-this.cameraWidth/2)&&i>=Math.floor(this.mapGroup.height-this.cameraHeight/2)?7:e>=Math.floor(this.mapGroup.width-this.cameraWidth/2)&&i>=Math.floor(this.mapGroup.height-this.cameraHeight/2)?8:0},e.prototype.initPos=function(){this.mapGroup.x=0,this.mapGroup.y=0;var t=this.gridList[this.curGridId].localToGlobal();this.globalToLocal(t.x,t.y,t);var e=this.getDirection();9==e?(this.mapGroup.x=this.cameraWidth/2-t.x-this.gridList[this.curGridId].width/2,this.mapGroup.y=this.cameraHeight/2-t.y-this.gridList[this.curGridId].height/2):1==e?(this.mapGroup.x=0,this.mapGroup.y=0):2==e?(this.mapGroup.x=-t.x+this.cameraWidth/2-this.gridList[this.curGridId].width/2,this.mapGroup.y=0):3==e?(this.mapGroup.x=this.cameraWidth-this.mapGroup.width-this.gridList[this.curGridId].width/2,this.mapGroup.y=0):4==e?(this.mapGroup.x=0,this.mapGroup.y=-t.y+this.cameraHeight/2-this.gridList[this.curGridId].height/2):5==e?(this.mapGroup.x=this.cameraWidth-this.mapGroup.width-this.gridList[this.curGridId].width/2,this.mapGroup.y=-t.y+this.cameraHeight/2-this.gridList[this.curGridId].height/2):6==e?(this.mapGroup.x=0,this.mapGroup.y=this.cameraHeight-this.mapGroup.height-this.gridList[this.curGridId].height/2):7==e?(this.mapGroup.x=-t.x+this.cameraWidth/2-this.gridList[this.curGridId].width/2,this.mapGroup.y=this.cameraHeight-this.mapGroup.height-this.gridList[this.curGridId].height/2):8==e&&(this.mapGroup.x=this.cameraWidth-this.mapGroup.width-this.gridList[this.curGridId].width/2,this.mapGroup.y=this.cameraHeight-this.mapGroup.height-this.gridList[this.curGridId].height/2),t=this.gridList[this.curGridId].localToGlobal(),this.globalToLocal(t.x,t.y,t),this.roleModel.x=t.x+this.roleModel.width/2,this.roleModel.y=t.y+this.roleModel.height/2},e.prototype.createRole=function(){var t=heroControl.getSubRoleByIndex(0);this.roleModel=new DaifugRole(t.sex);var e=DataCenter.ins().DaifugGridConfig[this.curGridId];e&&(this.roleModel.state=e.dir),this.roleModel.width=53,this.roleModel.height=91,this.roleModel.x=this.roleModel.x+this.roleModel.width/2,this.roleModel.y=this.roleModel.y+this.roleModel.height/2,this.roleModel.updateModel(),this.addChild(this.roleModel)},e.prototype.createMap=function(){this.mapGroup||(this.mapGroup=new eui.Group,this.mapGroup.x=0,this.mapGroup.y=0,this.addChild(this.mapGroup));for(var t=1;t<=daifugControl.rewardIdByGrids.length-1;t++){var e=DataCenter.ins().DaifugGridConfig[t];if(e){if(1==t){var i=new DaifugItemRender;i.x=0,i.y=0,i.data={rewardId:daifugControl.rewardIdByGrids[t],index:t},this.mapGroup.addChild(i),this.gridList[t]=i;continue}var n=DataCenter.ins().DaifugGridConfig[t-1];if(!n)continue;var o=new DaifugItemRender;switch(o.data={rewardId:daifugControl.rewardIdByGrids[t],index:t},this.gridList[t]=o,this.mapGroup.addChild(o),n.dir){case 1:o.x=this.gridList[t-1].x,o.y=this.gridList[t-1].y-this.gridList[t-1].height;break;case 2:o.x=this.gridList[t-1].x+this.gridList[t-1].width,o.y=this.gridList[t-1].y;break;case 3:o.x=this.gridList[t-1].x,o.y=this.gridList[t-1].y+this.gridList[t-1].height;break;case 4:o.x=this.gridList[t-1].x-this.gridList[t-1].width,o.y=this.gridList[t-1].y}}}if(this.sortGrid(),!this.masksp){this.masksp=new egret.Sprite;var s=new egret.Shape;s.graphics.beginFill(LangMgr.getColor("color42")),s.graphics.drawRect(this.mapGroup.x,this.mapGroup.y-70,this.cameraWidth,this.cameraHeight+70),s.graphics.endFill(),this.masksp.addChild(s),this.addChild(this.masksp),this.mapGroup.mask=this.masksp}},e.prototype.updateMap=function(){for(var t=1;t<=this.gridList.length-1;t++)this.gridList[t].data={rewardId:daifugControl.rewardIdByGrids[t],index:t},this.gridList[t].itemicon.scaleX=1,this.gridList[t].itemicon.scaleY=1},e.prototype.sortGrid=function(){this.mapGroup.$children.sort(this.sortF)},e.prototype.sortF=function(t,e){return t.y>e.y?1:t.y<e.y?-1:0},e.prototype.updateMillionaire=function(){if(this.countDown)return this.count+=this.dictime/100,this.count>=1&&(this.countDown-=.1,this.count=0),void(this.countDown<=0&&(this.countDown=0,this.count=0,this.diceimg=!1));if(this.effing){for(var t=!0,e=1;e<=this.arrEff.length-1;e++)if(!this.arrEff[e]){t=!1;break}return void(t&&(this.callfunc&&"function"==typeof this.callfunc&&this.callfunc(),this.effing=!1,this.callfunc=null,this.stepNum>0&&(this.nextPos+=this.stepNum,this.stepNum=0),this.curGridId==this.nextPos&&(this.btnUp=!1)))}this.updateStop||this.roleModel&&(this.checkRoleType(),this.roleModel.roleType==DaifugRole.ACTION?this.Action():this.Stop())},e.prototype.checkRoleType=function(){this.curGridId!=this.nextPos&&(this.roleModel.roleType=DaifugRole.ACTION)},e.prototype.getMoveGridId=function(){if(this.curGridId!=this.nextPos){var t=this.gridList[this.curGridId].localToGlobal();if(this.globalToLocal(t.x,t.y,t),t.x+this.roleModel.width/2==this.roleModel.x&&t.y+this.roleModel.height/2==this.roleModel.y){this.curGridId+=1,this.curGridId>this.gridList.length-1&&(this.curGridId=1);var e=DataCenter.ins().DaifugGridConfig[this.curGridId-1];e&&(this.roleModel.state=e.dir)}}return this.roleModel.updateModel(),this.curGridId},e.prototype.Stop=function(){this.updateStop=!0,this.roleModel.updateModel()},e.prototype.Action=function(){this.updateStop=!1;var t=this.getMoveGridId(),e=this.gridList[t].localToGlobal();this.globalToLocal(e.x,e.y,e);var i=0,n=0;switch(this.roleModel.state){case 4:case 2:this.roleModel.x!=e.x+this.roleModel.width/2&&(i=e.x-this.roleModel.x+this.roleModel.width/2);break;case 1:case 3:this.roleModel.y!=e.y+this.roleModel.height/2&&(n=e.y-this.roleModel.y+this.roleModel.height/2)}Math.abs(i)>this.step&&(i=this.getStepPixel(this.roleModel.state)),Math.abs(n)>this.step&&(n=this.getStepPixel(this.roleModel.state));var o,s,r=this.getDirection();1!=r&&4!=r&&6!=r&&3!=r&&5!=r&&8!=r&&2!=r&&7!=r||!((1==r||4==r||6==r)&&(2==this.roleModel.state||4==this.roleModel.state)&&this.mapGroup.x>=0||(3==r||5==r||8==r)&&(4==this.roleModel.state||2==this.roleModel.state)&&this.mapGroup.x<=-this.mapGroup.width+this.cameraWidth||(2==r||7==r)&&2==this.roleModel.state&&this.roleModel.x+this.roleModel.width/2<this.cameraWidth/2||(2==r||7==r)&&4==this.roleModel.state&&this.roleModel.x+this.roleModel.width/2>this.cameraWidth/2)?(o=this.mapGroup,i=-i,s=!1):(o=this.roleModel,s=!0);var a,l=o.x+i;1!=r&&2!=r&&3!=r&&6!=r&&7!=r&&8!=r&&4!=r&&5!=r||!((1==r||2==r||3==r)&&(3==this.roleModel.state||1==this.roleModel.state)&&this.mapGroup.y>=0||(6==r||7==r||8==r)&&(1==this.roleModel.state||3==this.roleModel.state)&&this.mapGroup.y<=-this.mapGroup.height+this.cameraHeight||(4==r||5==r)&&3==this.roleModel.state&&this.roleModel.y+this.roleModel.height/2<this.cameraHeight/2||(4==r||5==r)&&1==this.roleModel.state&&this.roleModel.y+this.roleModel.height/2>this.cameraHeight/2)?(o=this.mapGroup,n=-n,a=!1):(o=this.roleModel,a=!0);var h=o.y+n;return i||n?(this.roleModel.roleType=DaifugRole.ACTION,s?this.roleModel.x+this.roleModel.width/2<this.cameraWidth/2&&l+this.roleModel.width/2>this.cameraWidth/2||this.roleModel.x+this.roleModel.width/2>this.cameraWidth/2&&l+this.roleModel.width/2<this.cameraWidth/2?this.roleModel.x=this.cameraWidth/2-this.roleModel.width/2:this.roleModel.x=l:this.mapGroup.x=l,void(a?this.roleModel.y+this.roleModel.height/2<this.cameraHeight/2&&h+this.roleModel.height/2>this.cameraHeight/2||this.roleModel.y+this.roleModel.height/2>this.cameraHeight/2&&h+this.roleModel.height/2<this.cameraHeight/2?this.roleModel.y=this.cameraHeight/2-this.roleModel.height/2:this.roleModel.y=h:this.mapGroup.y=h)):(this.roleModel.roleType=DaifugRole.STOP,this.doSometing(),void this.roleModel.updateModel())},e.prototype.doSometing=function(){var t=DataCenter.ins().DaifugGridConfig[this.curGridId];if(t){if(1==this.curGridId)return this.updateMapOnly(),void this.updateMapEx();if(1==t.action)this.updateMapOnly();else if(2==t.action){if(daifugControl.randomGridById<=0)return void tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips3"));if(this.isUpdateRandom)this.isUpdateRandom=!1,this.updateMapEx();else{if(-1==daifugControl.rewardIdByGrids[this.curGridId])return void(this.btnUp=!1);this.updateMapOnly()}}else 3==t.action?(this.nextPos=daifugControl.gridId,this.curGridId=this.nextPos,this.initPos()):4==t.action&&this.updateMapOnly();this.btnUp=!1}},e.prototype.getStepPixel=function(t){switch(t){case 1:return-this.step;case 3:return this.step;case 2:return this.step;case 4:return-this.step}},e.prototype.checkCamera=function(t,e){if(9==e)return!0;switch(t){case 1:if(this.roleModel.y+this.roleModel.height/2>this.cameraHeight/2)return!1;break;case 3:if(this.roleModel.y+this.roleModel.height/2<this.cameraHeight/2)return!1;break;case 2:if(this.roleModel.x+this.roleModel.width/2<this.cameraWidth/2)return!1;break;case 4:if(this.roleModel.x+this.roleModel.width/2>this.cameraWidth/2)return!1}return!0},e}(BasePanel);__reflect(DaifugPanel.prototype,"DaifugPanel");var DaifugRole=function(t){function e(i){var n=t.call(this)||this;return n.preName="",n.shadow=new eui.Image("richman_shadow"),n.shadow.x=n.x-18,n.shadow.y=n.y-5,n.addChild(n.shadow),n.state=1,n.roleType=e.STOP,n.sex=i?i:0,n.initModel(),n}return __extends(e,t),e.prototype.initModel=function(){this.model=new GameMovieClip,this.addChild(this.model),this.prefix=RENWU_PREFIX+"100",this.model1=new GameMovieClip,this.addChild(this.model1),this.prefix1="",this.model2=new GameMovieClip,this.addChild(this.model2),this.prefix2="",this.model3=new GameMovieClip,this.addChild(this.model3),this.prefix3="",this.model4=new GameMovieClip,this.addChild(this.model4),this.prefix4="",this.weightLayers=[],this.weightLayers[1]=UnitEffect.FRAME_ODER[0],this.weightLayers[2]=UnitEffect.FRAME_ODER[2],this.weightLayers[4]=UnitEffect.FRAME_ODER[6],this.weightLayers[3]=UnitEffect.FRAME_ODER[4],this.setMovieFromWeight();var t=UnitMgr.ins().getMainRole(0);if(t){var e=t.infoModel,i=e.equipsData[2].item.configID;if(e.zhuangbei[0]>0){var n=DataCenter.ins().FashionIdConfig[e.zhuangbei[0]].res;this.prefix=n}else if(i>0){if(DataCenter.ins().EquipConfig[i]){var n=DataCenter.ins().EquipConfig[i].appearance;this.prefix=n}}else this.prefix=RENWU_PREFIX+"000";if(i=e.getEquipByIndex(0).item.configID,e.zhuangbei[1]>0){var n=DataCenter.ins().FashionIdConfig[e.zhuangbei[1]].res;this.prefix1=n}else if(i>0&&DataCenter.ins().EquipConfig[i]){var n=DataCenter.ins().EquipConfig[i].appearance;this.prefix1=n}if(e.zhuangbei[2]>0){var n=DataCenter.ins().FashionIdConfig[e.zhuangbei[2]].res;this.prefix2=n}else e.wingsData.openStatus&&DataCenter.ins().FeatherLevelConfig[e.wingsData.lv]&&(this.prefix2=DataCenter.ins().FeatherLevelConfig[e.wingsData.lv].appearance);if(e.heirloom){var o=e.heirloom.getSuitConfig(e);o&&o.weff&&(this.prefix3=o.weff)}if(e.weapons&&e.weapons.weaponsId>0){var n=DataCenter.ins().WeaponSoulConfig[e.weapons.weaponsId].outside[e.job-1];this.prefix4=n}}},e.prototype.setMovieFromWeight=function(){this.setWeight(this.state)},e.prototype.setWeight=function(t){for(var e=this.weightLayers[t],i=0;i<e.length;i++){var n=this.getMoviceByWeight(e[i]);n&&this.setChildIndex(n,i)}},e.prototype.getMoviceByWeight=function(t){var e;switch(t){case 1:e=this.model;break;case 2:e=this.model1;break;case 3:e=this.model2;break;case 7:e=this.model4}return e},e.prototype.destory=function(){DisplayUtils.removeFromParent(this.model),DisplayUtils.removeFromParent(this.model1),DisplayUtils.removeFromParent(this.model2),DisplayUtils.removeFromParent(this.model3),DisplayUtils.removeFromParent(this.model4)},Object.defineProperty(e.prototype,"stateName",{get:function(){this.model.scaleX=1;var t="";switch(this.state){case 1:t=this.roleType?"0r":"0s";break;case 2:t=this.roleType?"2r":"2s";break;case 3:t=this.roleType?"4r":"4s";break;case 4:this.model.scaleX=-1,t=this.roleType?"2r":"2s"}return this.model1.scaleX=this.model.scaleX,this.model2.scaleX=this.model.scaleX,this.model4.scaleX=this.model.scaleX,t},enumerable:!0,configurable:!0}),e.prototype.updateModel=function(){this.preName!=this.stateName&&(this.preName=this.stateName,this.prefix&&this.model.playFile(PATH_RENWU+this.prefix+"_"+this.sex+"_"+this.stateName,-1),this.prefix1&&this.model1.playFile(PATH_WUQI+this.prefix1+"_"+this.sex+"_"+this.stateName,-1),this.prefix2&&this.model2.playFile(PATH_CHIBANG+this.prefix2+"_"+this.stateName,-1),this.prefix3&&this.model3.playFile(PATH_EFF+this.prefix3,-1),this.prefix4&&this.model4.playFile(PATH_WUQI+this.prefix4+"_"+this.stateName,-1),this.setMovieFromWeight())},e.STOP=0,e.ACTION=1,e}(egret.DisplayObjectContainer);__reflect(DaifugRole.prototype,"DaifugRole");var DaifugTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaifugTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(136,this.callbackRoundReward),this.addEventTouchEnd(this.bgClose,this.onClick),this.addEventTouchEnd(this.getreward,this.onClick),this.pos=t[0],this.getlabel.touchEnabled=!1,this.init()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.removeEventTouchEnd(this.bgClose,this.onClick),this.removeEventTouchEnd(this.getreward,this.onClick)},e.prototype.callbackRoundReward=function(){this.init()},e.prototype.init=function(){var t=DataCenter.ins().DaifugRoundAwardConfig[this.pos];t&&(daifugControl.roundReward>>this.pos&1?(this.counttext.visible=!1,this.getreward.visible=!0,this.getreward.touchEnabled=!1,this.getlabel.visible=this.getreward.visible,this.getlabel.text=LangMgr.getValueByKey("activitAlreadingGet"),this.getreward.source="btn42"):(this.getreward.touchEnabled=!0,this.getlabel.text=LangMgr.getValueByKey("activitGet"),this.getreward.source="btn40",daifugControl.round>=t.round?(this.counttext.visible=!1,this.getreward.visible=!this.counttext.visible,this.getlabel.visible=this.getreward.visible):(this.counttext.visible=!0,this.getreward.visible=!this.counttext.visible,this.getlabel.visible=this.getreward.visible)),this.count.text=""+(t.round-daifugControl.round),this.partname.text=LangMgr.getValueByKey("millionAwards",t.round),this.itemIcon.data={type:t.award[0].type,id:t.award[0].id,count:t.award[0].count})},e.prototype.onClick=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.getreward:var e=DataCenter.ins().DaifugRoundAwardConfig[this.pos];e&&(daifugControl.roundReward>>this.pos&1?tipsControl.showTips(LangMgr.getValueByKey("millionTips1")):daifugControl.round>=e.round?daifugControl.upRoundReward(this.pos):tipsControl.showTips(LangMgr.getValueByKey("millionTips2",e.round)))}},e}(BaseEuiView);__reflect(DaifugTipsView.prototype,"DaifugTipsView");var DaifugItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DaifugItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.isEffing=!1,this.startX=this.itemicon.x,this.startY=this.itemicon.y},e.prototype.setHide=function(){this.itemicon.alpha=1,this.itemicon.source="",this.shadow.visible=!1,this.itemicon.x=this.startX,this.itemicon.y=this.startY},e.prototype.setHideEff=function(){var t=new eui.Image(this.itemicon.source);t.x=this.startX,t.y=this.startY,t.width=this.itemicon.width,t.height=this.itemicon.height,this.itemicon.parent.addChild(t),gameControl.dispatchFlyItemEx(t),this.setHide()},e.prototype.dataChanged=function(){this.shadow.visible=!0;var t=this.data.index;if(-1==this.data.rewardId)return this.itemicon.source="",void(this.shadow.visible=!1);var e=this.data.rewardId-1,i=DataCenter.ins().DaifugGridConfig[t];if(i){var n;if(i.exparam)for(var o in i.exparam)if(Number(o)==daifugControl.round){n=i.exparam[o];break}return n?void this.setImgSouce(n):void(1==i.action?(t=daifugControl.randomGridById,t&&(i=DataCenter.ins().DaifugGridConfig[t],e=daifugControl.randomGridByRewardId-1),n=i.param[e],this.setImgSouce(n)):2==i.action?(t=daifugControl.randomGridById,t?(i=DataCenter.ins().DaifugGridConfig[t],e=daifugControl.randomGridByRewardId-1,n=i.param[e],this.setImgSouce(n)):this.itemicon.source="richiman_random"):3==i.action?this.itemicon.source="richiman_teleport":4==i.action&&(this.itemicon.source="richman_dice6"))
}},e.prototype.setImgSouce=function(t){var e=0;if(t.type){var i=DataCenter.ins().ItemConfig[t.id];i&&(this.itemicon.source=i.icon+"_png")}else switch(this.itemicon.source=Currency.getCurrencyRes(t.id),t.id){case 2:e=5;break;case 1:e=0;break;case 4:e=2;break;case 10:e=2,this.itemicon.source=Currency.getCurrencyRes(t.id)}},e.prototype.destruct=function(){},e.prototype.clear=function(){},e}(BaseItemRender);__reflect(DaifugItemRender.prototype,"DaifugItemRender");var DarkEquipControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.darkDrug=[],e.darkSuits=[],e.darkEquips=[],e.darkEquipsPoints=0,e.darkForceColor=[16776960,39423,16711935,39236,16750848],e.SumNum_REPLACE=[],e.SumLv_REPLACE=[],e.SumNum_UPLEVEL=[],e.SumLv_UPLEVEL=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.updateGloConfig()},e.prototype.updateGloConfig=function(){if(!this.SumNum_REPLACE.length||!this.SumLv_REPLACE.length){var t=this.getSuitData(1);this.SumNum_REPLACE=t[0],this.SumLv_REPLACE=t[1],this.SumNum_REPLACE.sort(SortUtils.sortDescByKey),this.SumLv_REPLACE.sort(SortUtils.sortDescByKey)}if(!this.SumNum_UPLEVEL.length||!this.SumLv_UPLEVEL.length){var t=this.getSuitData(0);this.SumNum_UPLEVEL=t[0],this.SumLv_UPLEVEL=t[1],this.SumNum_UPLEVEL.sort(SortUtils.sortDescByKey),this.SumLv_UPLEVEL.sort(SortUtils.sortDescByKey)}},e.prototype.checkSysOpen=function(){return GameServer.serverOpenDay>=DataCenter.ins().DarkEquipBaConfig.openDay-1&&reincarnateControl.lv>=DataCenter.ins().DarkEquipBaConfig.openLevel},e.prototype.checkLookOtherCanSee=function(){return GameServer.serverOpenDay>=DataCenter.ins().DarkEquipBaConfig.openDay-1?!0:!1},e.prototype.getRedPoint=function(t){return this.checkSysOpen()&&this.darkEquips.length?DarkEquipRedPoint.ins().redPoint:!1},e.prototype.getRedPoint00=function(t){for(var e=DataCenter.ins().DarkEquipBaConfig.AItemId,i=DataCenter.ins().DarkEquipBaConfig.BItemId,n=0;n<heroControl.subRolesLen;n++)if((isNaN(t)||t==n)&&(this.IsUseDrug(n,e)||this.IsUseDrug(n,i)))return!0;return!1},e.prototype.getRedPoint0=function(t,e){for(var i=0;i<this.darkEquips.length;i++)if(this.darkEquips[i]&&(isNaN(t)||t==i))for(var n in this.darkEquips[i]){var o=this.darkEquips[i][n];if(o.itemId&&(isNaN(e)||e==o.itemId)&&this.getIsStrengthSlot(i,o.slot))return!0}var s=this.getSmeltItems();if(s.length)for(var r=this.calcUpLevelBySmeltList(s),i=0;i<this.darkEquips.length;i++)if(this.darkEquips[i])for(var n in this.darkEquips[i]){var o=this.darkEquips[i][n];if(o&&(isNaN(e)||e==o.itemId)&&DataCenter.ins().DarkEquipLvUpConfig[o.slot]){var a=DataCenter.ins().DarkEquipLvUpConfig[o.slot][o.level+1];if(a&&r>=a.exp)return!0}}return!1},e.prototype.getRedPoint1=function(t,e){for(var i=this.getReplaceItems(t,e),n=0;n<heroControl.subRolesLen;n++)if(isNaN(t)||t==n)for(var o=0;13>o;o++)if((isNaN(e)||e==o)&&darkEquipControl.darkEquips[n]){var s=darkEquipControl.darkEquips[n][o];if((!s||!s.itemId)&&i.length)return!0;for(var r=0;r<i.length;r++){var a=i[r],l=DataCenter.ins().DarkEquipConfig[a.configID];if(l){var h=BackpackControl.getAttrPower(l.attr);if(l=DataCenter.ins().DarkEquipConfig[s.itemId]){var u=BackpackControl.getAttrPower(l.attr);if(h>u)return!0}}}}return!1},e.prototype.getRedPoint2=function(t){for(var e=DataCenter.ins().DarkEquipConfig,i=0;i<heroControl.subRolesLen;i++)if(isNaN(t)||t==i)for(var n in e){var o=this.getComposeItem(i,e[n].itemId);if(o)return!0}return!1},e.prototype.getReplaceItems=function(t,e){for(var i=[],n=heroControl.subRolesLen,o=backpackControl.getBagGoodsByType(28),s=0;13>s;s++)if(isNaN(e)||e==s)for(var r=0;n>r;r++)if(this.darkEquips[r]&&(isNaN(t)||t==r))for(var a in this.darkEquips[r]){var l=this.darkEquips[r][a];if(l.slot==s)for(var h=l&&l.itemId?DataCenter.ins().DarkEquipConfig[l.itemId]:null,u=h?BackpackControl.getAttrPower(h.attr):0,p=0;p<o.length;p++){var c=o[p];if(DataCenter.ins().DarkEquipConfig[c.configID].slot==s&&!(DataCenter.ins().DarkEquipConfig[c.configID].level>reincarnateControl.lv)){var d=BackpackControl.getAttrPower(DataCenter.ins().DarkEquipConfig[c.configID].attr);d>u&&i.push(c)}}}return i},e.prototype.getSmeltItems=function(){for(var t=[],e=[],i=heroControl.subRolesLen,n=[],o=backpackControl.getBagGoodsByType(28),s=0;13>s;s++)if(8!=s)for(var r=0;r<o.length;r++){var a=o[r];if(1==darkEquipControl.getDarkTypeBySlot(a.configID)&&DataCenter.ins().DarkEquipConfig[a.configID].slot==s&&!(reincarnateControl.lv<DataCenter.ins().DarkEquipConfig[a.configID].level)){for(var l=CommonUtils.copyDataHandler(a),h=BackpackControl.getAttrPower(DataCenter.ins().DarkEquipConfig[l._configID].attr),u=!1,p=0;i>p;p++){var c=darkEquipControl.darkEquips[p][s];if(c&&c.itemId){var d=BackpackControl.getAttrPower(DataCenter.ins().DarkEquipConfig[c.itemId].attr);if(h>d){u=!0;break}}else n[p]||(n[p]=[]),n[p][s]||(n[p][s]=0),n[p][s]||(n[p][s]+=1)}u||(e[s]||(e[s]=[]),e[s].push(l))}}for(var r=0;r<e.length;r++)e[r]&&e[r].sort(function(t,e){var i=DataCenter.ins().DarkEquipConfig[t._configID],n=DataCenter.ins().DarkEquipConfig[e._configID],o=BackpackControl.getAttrPower(i.attr),s=BackpackControl.getAttrPower(n.attr);return o>s?-1:1});for(var r=0;r<n.length;r++)if(n[r])for(var p=0;p<n[r].length;p++){var g=n[r][p];e[p]&&e[p].length&&(e[p][0].count>=g&&(e[p][0].count-=g),e[p][0].count<=0&&e[p].shift())}if(3>i)for(var m=3-i,r=0;r<e.length;r++)if(e[r]&&e[r].length)for(var p=m;p>0;p--)e[r].length&&(e[r][0].count>=1&&(e[r][0].count-=1),e[r][0].count<=0&&e[r].shift());for(var r=0;r<e.length;r++)e[r]&&(t=t.concat(e[r]));return t},e.prototype.calcUpLevelBySmeltList=function(t){for(var e=0,i=0;i<t.length;i++){var n=t[i];e+=DataCenter.ins().DarkEquipConfig[n._configID].totalExp}return e+=this.darkEquipsPoints},e.prototype.getIsStrengthSlot=function(t,e){if(!this.darkEquips[t])return!1;if(!this.darkEquips[t][e])return!1;var i=this.darkEquips[t][e];if(!DataCenter.ins().DarkEquipLvUpConfig[e])return!1;var n=DataCenter.ins().DarkEquipLvUpConfig[e][i.level+1];return n?this.darkEquipsPoints>=n.exp:!1},e.prototype.updateDarkSuits=function(t,e,i){void 0===e&&(e=this.darkEquips),void 0===i&&(i=this.darkSuits),this.updateGloConfig(),i=[];for(var n=0;n<e.length;n++)if((isNaN(t)||t==n)&&e[n]){var o={};for(var s in e[n]){var r=e[n][s];if(r.itemId){var a=this.getDarkTypeBySlot(r.itemId);o[a]||(o[a]=[]);var l=DataCenter.ins().DarkEquipConfig[r.itemId].star;o[a].push(l)}}o[1]&&o[1].sort(SortUtils.sortDescByKey),o[0]&&o[0].sort(SortUtils.sortDescByKey);for(var h in o){var u=[],p=[];1==Number(h)?(u=this.SumNum_REPLACE,p=this.SumLv_REPLACE):0==Number(h)&&(u=this.SumNum_UPLEVEL,p=this.SumLv_UPLEVEL);for(var c=0;c<u.length;c++){var d=0,g=Number(u[c]);if(o[h].length>=g){for(var m=0;g>m;m++)d||(d=o[h][m]),d>o[h][m]&&(d=o[h][m]);for(var f=0;f<p.length;f++)if(d>=p[f]){d=p[f];break}}i[n]||(i[n]={}),i[n][h]||(i[n][h]={}),d&&(i[n][h][g]?(i[n][h][g].type=Number(h),i[n][h][g].num=g,i[n][h][g].level=d):i[n][h][g]=new DarkSuitDataVo(Number(h),g,d))}}}return i},e.prototype.getDarkTypeBySlot=function(t){var e=DataCenter.ins().DarkEquipConfig[t];return 1==e.isReplace?1:0},e.prototype.getSuitData=function(t){var e=[],i=[],n=DataCenter.ins().DarkSuitLvConfig[t];for(var o in n)if(e.push(o),!i.length)for(var s in n[o])i.push(n[o][s].level);return[e,i]},e.prototype.getDrugAttrs=function(t,e,i,n){if(void 0===e&&(e=this.darkEquips),void 0===i&&(i=this.darkDrug),i[t]&&e[t]){var o=i[t][DataCenter.ins().DarkEquipBaConfig.AItemId],s=i[t][DataCenter.ins().DarkEquipBaConfig.BItemId],r=[],a=[];if(o)for(var l=0;o>l;l++)r=AttributeData.AttrAddition(r,DataCenter.ins().DarkEquipBaConfig.replaceAttr);if(s)for(var l=0;s>l;l++)a=AttributeData.AttrAddition(a,DataCenter.ins().DarkEquipBaConfig.addAttr);return AttributeData.AttrAddition(r,a)}},e.prototype.IsUseDrug=function(t,e){var i=!1;this.darkDrug[t]||(this.darkDrug[t]={});var n=this.darkDrug[t][e];n=n?n:0;var o;o=e==DataCenter.ins().DarkEquipBaConfig.AItemId?DataCenter.ins().DarkEquipBaConfig.ADrugLimit:DataCenter.ins().DarkEquipBaConfig.BDrugLimit;var s=0;for(var r in o)reincarnateControl.lv>=Number(r)&&(s=o[r]);if(!s)return i;if(n>=s)return i;var a=backpackControl.getBagItemById(e);return i=a&&a.count?!0:!1},e.prototype.getDarkForceDesc=function(t){for(var e=DataCenter.ins().DarkEquipConfig[t],i="",n=0;n<e.darkforce.length;n++){var o=this.getDarkTypeName(e.darkforce[n].type);i+="|C:"+this.getForceColor(e.darkforce[n].type)+"&T:"+o+": "+e.darkforce[n].value+"|",n!=e.darkforce.length-1&&(i+="\n")}return i},e.prototype.getForceColor=function(t){for(var e=0;e<this.darkForceColor.length;e++)if(e==t-1)return this.darkForceColor[e];return 16777215},e.prototype.getDarkForceToTal=function(t,e){for(var i=[0,0,0,0,0],n=0;n<t.length;n++)if(t[n]&&(isNaN(e)||e==n))for(var o in t[n]){var s=t[n][o];if(s.itemId)for(var r=DataCenter.ins().DarkEquipConfig[s.itemId].darkforce,a=0;a<r.length;a++)i[r[a].type-1]+=r[a].value}return i},e.prototype.getDarkTypeName=function(t){return LangMgr.getValueByKey("darkForceType"+t)},e.prototype.getDarkEquipPower=function(t,e,i,n){void 0===t&&(t=this.darkEquips),void 0===e&&(e=this.darkSuits),void 0===i&&(i=this.darkDrug);for(var o=0,s=[],r=[],a=[],l=[],h=[],u=[],p=0;p<t.length;p++)if(t[p]&&(isNaN(n)||p==n)){for(var c in t[p]){var d=t[p][c];if(d.itemId){var g=DataCenter.ins().DarkEquipConfig[d.itemId];r=AttributeData.AttrAddition(r,g.attr),o+=g.exPower?g.exPower:0;var m=DataCenter.ins().DarkEquipLvUpConfig[d.slot][d.level];m&&(l=AttributeData.AttrAddition(l,m.strengthenAttr));var f=darkEquipControl.AddDrugPercent(g.attr,p,i,d.itemId);a=AttributeData.AttrAddition(a,f)}}h=this.getDrugAttrs(p,t,i)}s=AttributeData.AttrAddition(s,r),s=AttributeData.AttrAddition(s,l),s=AttributeData.AttrAddition(s,h),s=AttributeData.AttrAddition(s,a);for(var p=0;p<e.length;p++)if(isNaN(n)||n==p)for(var v in e[p])for(var y in e[p][v]){var C=e[p][v][y],T=DataCenter.ins().DarkSuitLvConfig[C.type][C.num][C.level];T&&(u=AttributeData.AttrAddition(u,T.attrs),o+=T.ex_power?T.ex_power:0)}return s=AttributeData.AttrAddition(s,u),o+=BackpackControl.getAttrPower(s),[o,s]},e.prototype.getRelatePower=function(t,e){var i=0;return i+=ItemUtils.relatePower(t,e)},e.prototype.AddDrugPercent=function(t,e,i,n){void 0===i&&(i=this.darkDrug);var o=i[e][DataCenter.ins().DarkEquipBaConfig.AItemId],s=i[e][DataCenter.ins().DarkEquipBaConfig.BItemId],r=0;if(o&&n){var a=darkEquipControl.getDarkTypeBySlot(n);1==a&&(r+=DataCenter.ins().DarkEquipBaConfig.replacePre*o/1e4)}s&&(r+=DataCenter.ins().DarkEquipBaConfig.replacePre*s/1e4);for(var l=[],h=0;h<t.length;h++){var u=new AttributeData(t[h].type,t[h].value);l.push(u)}return darkEquipControl.AddDarkPercent(l,r,!1),l},e.prototype.AddDarkPercent=function(t,e,i){void 0===i&&(i=!0);for(var n=0;n<t.length;n++)2==t[n].type||4==t[n].type||5==t[n].type||6==t[n].type?(i?t[n].value*=1+e:t[n].value*=e,t[n].value=Math.floor(t[n].value)):t[n].value=0},e.prototype.getAttrValueDesc=function(t){return 2==t.type||4==t.type||5==t.type||6==t.type?""+t.value:""+Math.floor(t.value/100)},e.prototype.getDarkEquipsBySlot=function(t){for(var e=[],i=backpackControl.getBagGoodsByType(28),n=0;n<i.length;n++){var o=i[n];DataCenter.ins().DarkEquipConfig[o.configID].slot==t&&DataCenter.ins().DarkEquipConfig[o.configID].level<=reincarnateControl.lv&&e.push(o)}return e.sort(function(t,e){var i=DataCenter.ins().DarkEquipConfig[t.configID],n=DataCenter.ins().DarkEquipConfig[e.configID],o=BackpackControl.getAttrPower(i.attr),s=BackpackControl.getAttrPower(n.attr);return o>s?-1:1}),e},e.prototype.getDarkEquipsDataByPreview=function(t,e,i,n){var o=DataCenter.ins().DarkEquipConfig,s=o[e],r=s?this.getDarkTypeBySlot(e):i,a=s?s.star:n,l=[];l[t]={};for(var h in o){var u=o[h].slot,p=1==o[h].isReplace?1:0;if(p==r&&o[h].star==a){var c=o[h].itemId,d=new DarkEquipDataVo(u,0,c);l[t][u]=d}}for(var g=0;13>g;g++)l[t][g]||(l[t][g]=new DarkEquipDataVo(g,0,0));return l},e.prototype.getDarkDrugDataByPreview=function(t){var e=[];return e[t]={},e[t][DataCenter.ins().DarkEquipBaConfig.AItemId]=0,e[t][DataCenter.ins().DarkEquipBaConfig.BItemId]=0,e},e.prototype.getComposeItem=function(t,e){var i=!1,n=DataCenter.ins().DarkEquipConfig[e];return n&&n.composeItem&&reincarnateControl.lv>=DataCenter.ins().DarkEquipConfig[e].level&&(i=this.getIsMaterial(t,n.composeItem)),i},e.prototype.getIsMaterial=function(t,e,i){if(!e)return!1;if(!darkEquipControl.darkEquips[t])return!1;for(var n=0;n<e.length;n++)if(isNaN(i)||i==n){var o=0;if(n)o=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e[n].id);else{var s=DataCenter.ins().DarkEquipConfig[e[n].id],r=darkEquipControl.darkEquips[t][s.slot];r&&r.itemId&&r.itemId==e[n].id&&(o=1)}if(o<e[n].count)return!1}return!0},e.prototype.getDarkSlotType=function(t){for(var e in DataCenter.ins().DarkEquipBaConfig.darkSlotType)if(-1!=DataCenter.ins().DarkEquipBaConfig.darkSlotType[e].indexOf(t))return Number(e);return-1},e.prototype.getOpenIndex=function(t,e){for(var i=DataCenter.ins().DarkEquipConfig[e],n=0;n<t.length;n++)for(var o in t[n])if(t[n][o].star==i.star)return n;return 0},e.getAttStr=function(t,e,i,n,o,s,r,a,l){void 0===e&&(e=4),void 0===i&&(i=1),void 0===n&&(n="+"),void 0===o&&(o=!1),void 0===s&&(s=!0);var h="",u=0;if(t instanceof AttributeData)return AttributeData.getAttStrByType(t,e,n,o,s,l);if(!(t instanceof Array)){var p=[];for(var c in AttributeData.translate)if(!isNaN(t[c])){var d=new AttributeData;d.type=parseInt(AttributeData.translate[c]),d.value=t[c],p.push(d)}return AttributeData.getAttStr(p,e,i,n,o)}for(var g=t,m=g.length-1,f=0;f<g.length;f++)if(0!=g[f].type&&(h+=AttributeData.getAttStrByType(g[f],e,n,o,s,l),r&&r.attr_add&&(h+="+"+Math.floor(g[f].value*(r.attr_add/100))),a&&(h+=a),m+u>f))for(var v=0;i>v;v++)h+="\n";if(0>u){var y=h.lastIndexOf("\n");h=h.substring(0,y)}return h},e.prototype.getMinLvBySuitNum=function(t,e){var i=DataCenter.ins().DarkSuitLvConfig[t][e],n=[];for(var o in i)n.push(i[o].level);return n.sort(SortUtils.sortAscByKey),n[0]},e.prototype.getMySuitSum=function(t,e,i,n){void 0===i&&(i=this.darkEquips),void 0===n&&(n=this.darkSuits);var o,s=0;for(var r in n[t][e]){var a=n[t][e][r],l=this.getMinLvBySuitNum(a.type,a.num);a.level>=l&&s<Number(a.num)&&(s=Number(a.num),o=a)}if(o){var h=0;for(var u in i[t]){var p=i[t][u].itemId;p&&e==DataCenter.ins().DarkEquipConfig[p].isReplace&&DataCenter.ins().DarkEquipConfig[p].star>=o.level&&h++}s=h}return s},e.prototype.upUpLevel=function(t,e){return[t,e]},e.prototype.downDarkEquipUpLevel=function(t,e,i){this.darkEquips[t][e]?this.darkEquips[t][e].level=i:this.darkEquips[t][e]=new DarkEquipDataVo(e,i),EventMgr.ins().dispatch(228)},e.prototype.upSmelt=function(t){return[t]},e.prototype.downDarkEquipSmelt=function(t){EventMgr.ins().dispatch(229,t)},e.prototype.upWear=function(t,e,i){return[t,e,i]},e.prototype.dispatchDarkEquipWearSuccess=function(t){EventMgr.ins().dispatch(561,t)},e.prototype.upCompose=function(t,e){return[t,e]},e.prototype.downDarkEquipCompose=function(t){EventMgr.ins().dispatch(230,t)},e.prototype.downDarkEquipInfo=function(t,e,i,n){if(this.darkDrug[t]||(this.darkDrug[t]={}),this.darkDrug[t][DataCenter.ins().DarkEquipBaConfig.AItemId]=e,this.darkDrug[t][DataCenter.ins().DarkEquipBaConfig.BItemId]=i,this.darkEquips[t]||(this.darkEquips[t]={}),!CommonUtils.getObjectLength(this.darkEquips[t]))for(var o=0;13>o;o++)this.darkEquips[t][o]||(this.darkEquips[t][o]=new DarkEquipDataVo(o,0,0));for(var s=0;n.length>s;s++){var r=n[s][0],a=n[s][1],l=n[s][2];this.darkEquips[t][r]?(this.darkEquips[t][r].level=a,this.darkEquips[t][r].itemId=l):this.darkEquips[t][r]=new DarkEquipDataVo(r,a,l)}this.darkSuits=this.updateDarkSuits(),EventMgr.ins().dispatch(231)},e.prototype.downDarkEquipPoint=function(t){this.darkEquipsPoints=t,EventMgr.ins().dispatch(232)},e.prototype.upUseDrug=function(t,e){return[t,e]},e.prototype.dispatchDarkEquipUpListEvent=function(t){var e=UIMgr.ins().getView(DarkEquipView);e&&(e.darkEquipComposePanel.isTriggerSec=!0),EventMgr.ins().dispatch(560,t)},__decorate([up(9,[1,1])],e.prototype,"upUpLevel",null),__decorate([down(9,[4,4,2])],e.prototype,"downDarkEquipUpLevel",null),__decorate([up(10,[[3]])],e.prototype,"upSmelt",null),__decorate([down(10,[0])],e.prototype,"downDarkEquipSmelt",null),__decorate([up(11,[1,1,3])],e.prototype,"upWear",null),__decorate([up(12,[1,3])],e.prototype,"upCompose",null),__decorate([down(12,[0])],e.prototype,"downDarkEquipCompose",null),__decorate([down(13,[4,2,2,[4,2,3]])],e.prototype,"downDarkEquipInfo",null),__decorate([down(14,[3])],e.prototype,"downDarkEquipPoint",null),__decorate([up(15,[1,1])],e.prototype,"upUseDrug",null),e=__decorate([protocolsId(4)],e)}(BaseSystem);__reflect(DarkEquipControl.prototype,"DarkEquipControl");var RedPacketVo=function(){function t(){this.id=0}return t.prototype.init=function(t){this.id=t[0],this.serverID=t[1],this.roleID=t[2],this.roleName=t[3],this.guildName=t[4],this.job=t[5],this.sex=t[6]},t}();__reflect(RedPacketVo.prototype,"RedPacketVo");var WeaponSoulSkillItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulSkillItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.skillIcon.source=this.data.icon+"_png")},e.prototype.destruct=function(){},e.prototype.clear=function(){},e}(BaseItemRender);__reflect(WeaponSoulSkillItemRender.prototype,"WeaponSoulSkillItemRender");var DarkEquipDataVo=function(){function t(t,e,i){this.slot=t,this.level=e?e:0,this.itemId=i?i:0}return t}();__reflect(DarkEquipDataVo.prototype,"DarkEquipDataVo");var DarkListMenuItemVo=function(){function t(t){this.itemId=t}return Object.defineProperty(t.prototype,"itemId",{get:function(){return this._itemId},set:function(t){var e=DataCenter.ins().DarkEquipConfig[t];this._itemId=t,this.star=e.star,this.slot=e.slot},enumerable:!0,configurable:!0}),t}();__reflect(DarkListMenuItemVo.prototype,"DarkListMenuItemVo");var DarkSuitDataVo=function(){function t(t,e,i){this.type=t,this.num=e,this.level=i}return t}();__reflect(DarkSuitDataVo.prototype,"DarkSuitDataVo");var SuitItemVo=function(){function t(t,e){this.darkSuitType=t,this.star=e}return t}();__reflect(SuitItemVo.prototype,"SuitItemVo");var DarkEquipAttrTipView=function(t){function e(){var e=t.call(this)||this;return e._lastX=0,e.proShowList=[2,4,5,6,57,65,56,11,86],e.darkDrug=[],e.darkEquips=[],e.darkSuits=[],e.skinName="DarkEquipAttrTipViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.updateDarkData=function(t){this.darkEquips=this.otherPlayerData?this.otherPlayerData.darkEquips:darkEquipControl.darkEquips,this.darkDrug=this.otherPlayerData?this.otherPlayerData.darkDrug:darkEquipControl.darkDrug,this.otherPlayerData?this.darkSuits=darkEquipControl.updateDarkSuits(t,this.darkEquips,this.darkSuits):this.darkSuits=darkEquipControl.updateDarkSuits(void 0,this.darkEquips)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.otherPlayerData=t[1],this.setRoleAttr(this.curRole);var i=heroControl.subRolesLen;i>1&&(this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchBegin(this.bg,this.onMove),this.addEventTouchEnd(this.bg,this.onMove)),this.addEventTouchEnd(this,this.otherClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=heroControl.subRolesLen;i>1&&(this.removeEventTouchTap(this.leftBtn,this.onTouch),this.removeEventTouchTap(this.rightBtn,this.onTouch),this.removeEventTouchBegin(this.bg,this.onMove),this.removeEventTouchEnd(this.bg,this.onMove)),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200)):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200))}},e.prototype.moveAttr=function(t){var e,i=egret.Tween.get(this.attrGroup);e=t>0?0:242,i.to({x:this.attrGroup.x+t,alpha:0},200).to({x:e},200).to({x:80,alpha:1},200)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.leftBtn:this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200));break;case this.rightBtn:this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200))}},e.prototype.setDarkForceDesc=function(t){for(var e=darkEquipControl.getDarkForceToTal(this.darkEquips,t),i=0;i<e.length;i++)this["andianattr"+(i+1)]&&(this["andianattr"+(i+1)].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("darkComposeTips4",darkEquipControl.darkForceColor[i],darkEquipControl.getDarkTypeName(i+1),e[i])))},e.prototype.setRoleAttr=function(t){var e=this.otherPlayerData?this.otherPlayerData.roleData[t]:heroControl.getSubRoleByIndex(t);this.updateDarkData(t),this.setDarkForceDesc(),this.job.source="op_"+e.job;for(var i="",n=darkEquipControl.getDarkEquipPower(this.darkEquips,this.darkSuits,this.darkDrug,t),o=n[1],s=[],r=0;r<this.proShowList.length;r++){for(var a=!1,l=0;l<o.length;l++)if(o[l].type==this.proShowList[r]){s.push(o[l]),a=!0;break}if(!a){var h=new AttributeData(this.proShowList[r],0);s.push(h)}}for(var r=0;r<s.length;r++){var u=s[r].type,p=s[r].value;if(26==u&&(p=e.getExAtt(26)),57==u)i+=p;else if(u>1&&9>u)i+=7==u||8==u?p/100+"%":p;else if(u>12&&15>u||u>15)19==u&&(p?(p+=e.getAtt(65),p+=1e4):p=0),i+=p/100+"%";else{if(11!=u)continue;i+=p/100+"%"}r<this.proShowList.length-1&&(i+="\n")}this.attr.text=i,this.setBtn()},e.prototype.setBtn=function(){var t=heroControl.subRolesLen;1==t?(this.leftBtn.visible=!1,this.rightBtn.visible=!1):t>1&&(0==this.curRole?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):1==this.curRole?(this.leftBtn.visible=!0,3>t?this.rightBtn.visible=!1:this.rightBtn.visible=!0):2==this.curRole&&(this.leftBtn.visible=!0,this.rightBtn.visible=!1))},e}(BaseEuiView);__reflect(DarkEquipAttrTipView.prototype,"DarkEquipAttrTipView");var DarkEquipComposePanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cleanMovieClipAni()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.help,this.onClick),this.addEventTouchTap(this.update,this.onClick),this.addCustomEvent(266,this.CallBackUpdate),this.addCustomEvent(268,this.CallBackUpdate),this.addCustomEvent(267,this.CallBackUpdate),this.addCustomEvent(228,this.CallBackUpdate),this.addCustomEvent(231,this.CallBackUpdate),this.addCustomEvent(560,this.SecListEvent),this.addEventItemTap(this.list,this.onListChange),this.list.itemRenderer=DarkEquipUpListItemRenderer,this.list.useVirtualLayout=!1,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData,this.listOpen=[],this.roleId=t[0],this.curSelect=this.getRuleMenuItem(),this.updateView(),this.fixListPos(),this.playEff()},e.prototype.SecListEvent=function(t){this.cleanMovieClipAni(),this.playEff();var e=t.itemId;this.curSelect.itemId=e,this.upteDefaultItems();var i=darkEquipControl.getOpenIndex(this.showlist,e);this.listOpen[i]=!0,this.updateView()},e.prototype.upteDefaultItems=function(){for(var t=0;t<this.listOpen.length;t++)this.listOpen[t]=!1},e.prototype.CallBackUpdate=function(){TimerMgr.ins().remove(this.updateView,this),TimerMgr.ins().doTimer(100,1,this.updateView,this)},e.prototype.switchRole=function(t,e){this.roleId=t,this.updateView()},e.prototype.onListChange=function(t){this.isTriggerSec?this.isTriggerSec=!1:(this.cleanMovieClipAni(),this.playEff(),this.upteDefaultItems(),this.listOpen[t.itemIndex]=!this.listOpen[t.itemIndex],this.updateView())},e.prototype.fixListPos=function(){for(var t,e=-1,i=0;i<this.list.numElements;i++){var n=this.list.getVirtualElementAt(i);if(n&&this.listOpen[i]){e=i,t=this.list.dataProvider.getItemAt(i);break}}if(e>=0&&t){for(var o=58,s=40,r=e*o,a=0,i=0;i<t.length;i++)t[i]&&a++;a*=s;var l=this.list.scrollV+r+a;l>=this.list.height&&(this.list.scrollV=r)}},e.prototype.getRuleMenuItem=function(){if(!this.showlist){this.showlist=[];var t=[],e=DataCenter.ins().DarkEquipConfig;for(var i in e)0==e[i].isReplace&&e[i].composeItem&&t.push(e[i]);for(var n=0;n<t.length;n++){var o=t[n].star;this.showlist[o-1]||(this.showlist[o-1]=[]);var s=t[n].slot;this.showlist[o-1][s]||(this.showlist[o-1][s]=t[n])}for(var r=[],n=0;n<this.showlist.length;n++)this.showlist[n]&&r.push(this.showlist[n]);this.showlist=r}var a=0;for(var i in darkEquipControl.darkEquips[this.roleId]){var l=darkEquipControl.darkEquips[this.roleId][i];l&&l.itemId&&(a||(a=l.itemId),DataCenter.ins().DarkEquipConfig[a].star>DataCenter.ins().DarkEquipConfig[l.itemId].star&&(a=l.itemId))}var h,u,p,c=0;for(var i in this.showlist){var d=this.showlist[i];for(var s in d){var g=!0;p||(p=new DarkListMenuItemVo(d[s].itemId));for(var n=0;n<d[s].composeItem.length;n++){var m=0;if(n)m=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,d[s].composeItem[n].id);else{var l=darkEquipControl.darkEquips[this.roleId][s];l&&l.itemId&&l.itemId==d[s].composeItem[n].id&&(m=1)}if(!u&&a&&a==d[s].composeItem[n].id&&(u=new DarkListMenuItemVo(d[s].itemId),this.listOpen[c]=!0),m<d[s].composeItem[n].count){g=!1;break}}if(g){h=new DarkListMenuItemVo(d[s].itemId),this.listOpen[c]=!0;break}}if(h)break;c++}return h||(u?h=u:(h=p,this.listOpen[0]=!0)),h},e.prototype.updateView=function(){this.updateList(),this.updateEquips(),this.updateBtn()},e.prototype.updateList=function(){this.listData.replaceAll(this.showlist),this.list.validateNow();for(var t=0;t<this.list.numElements;t++){var e=this.list.getVirtualElementAt(t);e&&(this.listOpen[t]?e.updateSecList():e.cleanSecList())}},e.prototype.updateEquips=function(){for(var t=DataCenter.ins().DarkEquipConfig[this.curSelect.itemId],e=0;4>e;e++)if(this["mom"+e])if(t.composeItem[e]){this["mom"+e].roleId=this.roleId,e?this["mom"+e].notBody=!0:this["mom"+e].notBody=!1,this["mom"+e].data=t.composeItem[e].id;var i=darkEquipControl.getIsMaterial(this.roleId,t.composeItem,e),n=i?"0x00ff00":"0xff0000",o=0;if(e)o=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t.composeItem[e].id);else{var s=darkEquipControl.darkEquips[this.roleId][t.slot];s&&s.itemId&&s.itemId==t.composeItem[e].id&&(o=1)}this["mom"+e].setCountEx("|C:"+n+"&T:"+o+"|/"+t.composeItem[e].count)}else this["mom"+e].setItemImg("suo_01"),this["mom"+e].showNum(!1),this["mom"+e].hideName(),this["mom"+e].isShowJob(!1);this.target.data=this.curSelect.itemId,this.target.showNum(!1)},e.prototype.updateBtn=function(){this.upRed.visible=darkEquipControl.getComposeItem(this.roleId,this.curSelect.itemId)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.help:HelpControl.openHelpWin(49);break;case this.update:if(reincarnateControl.lv<DataCenter.ins().DarkEquipConfig[this.curSelect.itemId].level)return void tipsControl.showCenterTips(LangMgr.getValueByKey("darkComposeTips1"));if(!darkEquipControl.getComposeItem(this.roleId,this.curSelect.itemId))return void tipsControl.showCenterTips(LangMgr.getValueByKey("materialEnought1"));darkEquipControl.upCompose(this.roleId,this.curSelect.itemId)}},e.prototype.playEff=function(){var t=this,e=500;this.trimc0=this.AniMovieClip(this.trieffDat0,this.trieff0),this.trimc0.x=-this.trieff0.width,this.trit0=egret.Tween.get(this.trimc0),this.trit0.to({x:0},e).call(function(){egret.Tween.removeTweens(t.trit0)}),this.trimc1=this.AniMovieClip(this.trieffDat1,this.trieff1),this.trimc1.x=-this.trieff1.width,this.trit1=egret.Tween.get(this.trimc1),this.trit1.to({x:0},e).call(function(){egret.Tween.removeTweens(t.trit1)}),this.trimc2=this.AniMovieClip(this.trieffDat2,this.trieff2),this.trimc2.x=-this.trieff2.width,this.trit2=egret.Tween.get(this.trimc2),this.trit2.to({x:0},e).call(function(){egret.Tween.removeTweens(t.trit2)})},e.prototype.AniMovieClip=function(t,e){var i="jljdt",n=new GameMovieClip;n.playFile(PATH_EFF+i,-1),e.addChild(n),n.scaleX=t.scaleX,n.scaleY=t.scaleY;var o=new egret.Sprite,s=new egret.Shape;s.graphics.beginFill(16777215),s.graphics.drawRect(t.x,t.y,e.width,e.height),s.graphics.endFill();var r=o.localToGlobal();return r.x=t.x,r.y=e.height,o.globalToLocal(r.x,r.y,r),o.addChild(s),e.addChild(o),n.mask=o,n},e.prototype.cleanMovieClipAni=function(){for(var t=0;3>t;t++)this["trit"+t]&&egret.Tween.removeTweens(this["trit"+t]),this["trimc"+t]&&DisplayUtils.removeFromParent(this["trimc"+t])},e}(BasePanel);__reflect(DarkEquipComposePanel.prototype,"DarkEquipComposePanel");var DarkEquipDrugTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipDrugTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.otherClose),this.addEventTouchEnd(this,this.otherClose),this.roleId=t[0],this.itemId=t[1],this.updateView()},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(){var t=DataCenter.ins().ItemConfig[this.itemId],e=ItemUtils.getQualityColor(t);this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+t.name),this.itemIcon.setData(t);var i,n,o;this.itemId==DataCenter.ins().DarkEquipBaConfig.AItemId?(n=DataCenter.ins().DarkEquipBaConfig.replaceAttr,i=DataCenter.ins().DarkEquipBaConfig.ADrugLimit,o=LangMgr.getValueByKey("darkComposeTips2",DataCenter.ins().DarkEquipBaConfig.replacePre/100)):(n=DataCenter.ins().DarkEquipBaConfig.addAttr,i=DataCenter.ins().DarkEquipBaConfig.BDrugLimit,o=LangMgr.getValueByKey("darkComposeTips3",DataCenter.ins().DarkEquipBaConfig.addPre/100));var s=[],r=0;for(var a in i)s.push({zslv:Number(a),value:i[a]});s.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"zslv")});var l=s[s.length-1].zslv;for(var h in s)if(s[h].zslv>=reincarnateControl.lv){r=s[h].zslv;break}this.attr.text=AttributeData.getAttStr(n,0,1,"+"),this.attr.text+="\n"+o;var u=darkEquipControl.darkDrug[this.roleId][this.itemId];this.use.text=u+"/"+i[r],l>r?(this.num0.text=""+(r+1),this.info.visible=!0):this.info.visible=!1},e}(BaseEuiView);__reflect(DarkEquipDrugTipsView.prototype,"DarkEquipDrugTipsView");var DarkEquipForceTipView=function(t){function e(){var e=t.call(this)||this;return e.darkDrug=[],e.darkEquips=[],e.darkSuits=[],e.skinName="DarkEquipForceTipViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.otherPlayerData=t[0],this.addEventTouchEnd(this,this.otherClose),this.updateDarkData(),this.updateView()},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.updateDarkData=function(t){this.darkEquips=this.otherPlayerData?this.otherPlayerData.darkEquips:darkEquipControl.darkEquips,this.darkDrug=this.otherPlayerData?this.otherPlayerData.darkDrug:darkEquipControl.darkDrug,this.otherPlayerData?this.darkSuits=darkEquipControl.updateDarkSuits(t,this.darkEquips,this.darkSuits):this.darkSuits=darkEquipControl.updateDarkSuits(void 0,this.darkEquips)},e.prototype.updateView=function(){this.setDarkForceDesc()},e.prototype.setDarkForceDesc=function(t){for(var e=darkEquipControl.getDarkForceToTal(this.darkEquips,t),i=0;i<e.length;i++)this["andianattr"+(i+1)]&&(this["andianattr"+(i+1)].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("darkComposeTips4",darkEquipControl.darkForceColor[i],darkEquipControl.getDarkTypeName(i+1),e[i])))},e}(BaseEuiView);__reflect(DarkEquipForceTipView.prototype,"DarkEquipForceTipView");
var DarkEquipForgeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipForgeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=DarkEquipSmeltItemRenderer,this.listDt=new eui.ArrayCollection,this.list.dataProvider=this.listDt,this.nowList=[],this.exp.value=0,this.exp.labelFunction=function(t,e){return darkEquipControl.darkEquipsPoints+"/"+e}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.roleId=t[0],this.slot=t[1],this.filterList=[],this.addEventTouchTap(this.departBtn,this.onTouch),this.addEventTouchTap(this.lvUpBtn,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.list,this.onList),this.addCustomEvent(228,this.onUpEquip),this.addCustomEvent(229,this.onDecompose),this.addCustomEvent(228,this.refRedpoint),this.refRedpoint(),this.refUIData(),this.refList()},e.prototype.onUpExp=function(){var t=darkEquipControl.darkEquips[this.roleId][this.slot],e=DataCenter.ins().DarkEquipLvUpConfig[this.slot][t.level+1];this.exp.maximum=e?e.exp:DataCenter.ins().DarkEquipLvUpConfig[this.slot][t.level].exp,this.exp.value=darkEquipControl.darkEquipsPoints,this.exp.labelDisplay.text=darkEquipControl.darkEquipsPoints+"/"+this.exp.maximum},e.prototype.onUpEquip=function(){this.refUIData(),this.forgetMC||(this.forgetMC=new GameMovieClip,this.forgetMC.x=62,this.forgetMC.y=62),this.forgetMC.playFile(PATH_EFF+"forgeSuccess",1),this.iconGroup.addChild(this.forgetMC)},e.prototype.refUIData=function(){var t=darkEquipControl.darkEquips[this.roleId][this.slot],e=t&&t.level?t.level:0,i=DataCenter.ins().DarkEquipLvUpConfig[this.slot][e],n=0;i&&(n+=BackpackControl.getAttrPower(i.strengthenAttr)),this.powerPanel.setPower(n),this.maxExpImg.visible=!1,this.maxExpTxt.visible=!1;var o=DataCenter.ins().DarkEquipLvUpConfig[this.slot][e+1];if(o||(this.lvUpBtn.enabled=!1,this.attrPanel.currentState="max",this.exp.visible=!1,this.maxExpImg.visible=!0,this.maxExpTxt.visible=!0),i)this.attrPanel.Now.text=AttributeData.getAttStr(i.strengthenAttr,0,1,"："),this.attrPanel.NowLv.text="Lv."+i.level;else if(this.attrPanel.NowLv.text="Lv.0",o){for(var s=[],r=0;r<o.strengthenAttr.length;r++){var a=new AttributeData;a.type=o.strengthenAttr[r].type,a.value=0,s.push(a)}this.attrPanel.Now.text=AttributeData.getAttStr(s,0,1,"：")}o&&(this.attrPanel.Next.text=AttributeData.getAttStr(o.strengthenAttr,0,1,"："),this.attrPanel.nextLv.text="Lv."+o.level),this.onUpExp(),this.updateSlotData()},e.prototype.updateSlotData=function(){var t=darkEquipControl.darkEquips[this.roleId][this.slot];if(!t||!t.itemId)return void tipsControl.showCenterTips(LangMgr.getValueByKey("darkComposeTips5",this.slot));var e=DataCenter.ins().ItemConfig[t.itemId];this.itemIcon.setData(e);var i=ItemUtils.getQualityColor(e);this.equipName.textFlow=TextUtils.generateTextFlow1("|C:"+i+"&T:"+DataCenter.ins().DarkEquipBaConfig.darkSlotName[this.slot])},e.prototype.onDecompose=function(t){if(!t)return void tipsControl.showTips(LangMgr.getValueByKey("darkComposeTips6"));for(var e=0;e<this.list.numChildren;e++){var i=this.list.getChildAt(e);i&&i.playDepartMc()}this.onUpExp(),TimerMgr.ins().doTimer(500,1,this.refList,this)},e.prototype.refList=function(){var t=darkEquipControl.getSmeltItems();this.nowList=[];for(var e=12,i=++e;--i>=0;)if(t[i]&&t[i].count>=1)for(var n=0;n<t[i].count;n++)if(-1==this.filterList.indexOf(t[i]._configID)){if(this.nowList.length>=e-1)break;this.nowList.push(t[i]._configID)}this.listDt.replaceAll(this.nowList)},e.prototype.onList=function(t){t.target instanceof DarkEquipSmeltItemRenderer&&-1==this.filterList.indexOf(t.target.data)&&this.filterList.push(t.target.data),this.refList()},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;case this.lvUpBtn:if(darkEquipControl.darkEquipsPoints<this.exp.maximum)return void tipsControl.showCenterTips(LangMgr.getValueByKey("darkComposeTips7"));darkEquipControl.upUpLevel(this.roleId,this.slot);break;case this.departBtn:if(!this.nowList.length)return void tipsControl.showCenterTips(LangMgr.getValueByKey("shenTips4"));darkEquipControl.upSmelt(this.nowList)}},e.prototype.refRedpoint=function(){this.rightRed.visible=darkEquipControl.getIsStrengthSlot(this.roleId,this.slot)},__decorate([callLater],e.prototype,"onUpExp",null),__decorate([callLater],e.prototype,"refRedpoint",null),e}(BaseEuiView);__reflect(DarkEquipForgeView.prototype,"DarkEquipForgeView");var DarkEquipOtherView=function(t){function e(){var e=t.call(this)||this;return e.panelArr=[],e.skinName="DarkEquipOtherViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.panelArr=[this.AndianInfoPanel],this.curSelectIndex=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.roleSelect,this.onRoleChange),this.addEventTouchTap(this.normalBtn,this.onClick),this.curSelectIndex=t[0]?t[0]:0;var i=t[1];this._otherPlayerData=t[2],this.roleSelect.otherPlayerData=this._otherPlayerData,this.roleSelect.open(),this.roleSelect.setCurRole(i),this.panelArr[this.curSelectIndex].open(this.roleSelect.getCurRole(),this._otherPlayerData,crossFieldControl.isCross)},e.prototype.onRoleChange=function(){this.panelArr[this.curSelectIndex].switchRole(this.roleSelect.getCurRole(),this._otherPlayerData,crossFieldControl.isCross)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.normalBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DarkEquipOtherView.prototype,"DarkEquipOtherView");var DarkEquipPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.darkEquips=[],e.darkSuits=[],e.darkDrug=[],e.flyItem=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){this.darkEquips=[],this.darkSuits=[]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cleanEff()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.juesexiangxi,this.onTap),this.addEventTouchTap(this.AndianBtn,this.onTap),this.addCustomEvent(228,this.CallBackUpdate),this.addCustomEvent(229,this.CallBackUpdate),this.addCustomEvent(231,this.CallBackUpdate),this.addCustomEvent(232,this.CallBackUpdate),this.addCustomEvent(561,this.palyEff),this.roleId=t[0],this.otherPlayerData=t[1],this.iskf=t[2];for(var i=0;13>i;i++)this["andianItem"+i]&&(this["andianItem"+i].name=i);this.updateDarkData(),this.updateView()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.juesexiangxi:UIMgr.ins().open(DarkEquipAttrTipView,this.roleId,this.otherPlayerData);break;case this.AndianBtn:UIMgr.ins().open(DarkEquipForceTipView,this.otherPlayerData)}},e.prototype.switchRole=function(t,e){this.roleId!=t&&(this.cleanEff(),this.roleId=t,this.otherPlayerData=e,this.updateDarkData(),this.updateView())},e.prototype.CallBackUpdate=function(){this.otherPlayerData||(this.updateDarkData(),TimerMgr.ins().remove(this.updateView,this),TimerMgr.ins().doTimer(100,1,this.updateView,this))},e.prototype.updateView=function(){this.updateEquips(),this.updateDrugs(),this.updateAttrs(),this.iskf&&(this.hideGroup.visible=!1)},e.prototype.updateOther=function(){this.otherPlayerData?this.AndianBtn.visible=this.andianUp0.visible=this.andianUp1.visible=!1:(this.andianUp0.data={darkDrug:this.darkDrug,roleId:this.roleId,itemId:DataCenter.ins().DarkEquipBaConfig.AItemId},this.andianUp1.data={darkDrug:this.darkDrug,roleId:this.roleId,itemId:DataCenter.ins().DarkEquipBaConfig.BItemId})},e.prototype.updateEquips=function(){for(var t=0;13>t;t++)if(this["andianItem"+t]){var e=this.otherPlayerData?!0:!1;if(this["andianItem"+t].data={itemId:this.darkEquips[this.roleId][t].itemId,roleId:this.roleId,other:e,otherPlayerData:this.otherPlayerData,preview:void 0},this["redPoint"+t]){var i=Number(this["andianItem"+t].name);if(this["replace"+t].visible=this["redPoint"+t].visible=!1,!this.otherPlayerData&&!e){var n=!1,o=!1;if(this.darkEquips[this.roleId][t].itemId&&(n=darkEquipControl.getRedPoint0(this.roleId,this.darkEquips[this.roleId][t].itemId)),o=darkEquipControl.getRedPoint1(this.roleId,i),this["redPoint"+t].visible=n||o,this.darkEquips[this.roleId][t].itemId&&(this["replace"+t].visible=o,this["replace"+t].visible)){var s=egret.Tween.get(this["replace"+t],{loop:!0});s.to({y:this["replace"+t].y-3},250).to({y:this["replace"+t].y+3},250)}}}this["level"+t]&&(this["level"+t].visible=this.darkEquips[this.roleId][t].level?!0:!1,this["level"+t].text="+"+this.darkEquips[this.roleId][t].level)}},e.prototype.updateDrugs=function(){this.updateOther()},e.prototype.updateAttrs=function(){var t=darkEquipControl.getDarkEquipPower(this.darkEquips,this.darkSuits,this.darkDrug,this.roleId),e=Number(t[0]),i=t[1];if(this.otherPlayerData)for(var n=0;n<i.length;n++)e+=darkEquipControl.getRelatePower(i[n],this.otherPlayerData.roleData[this.roleId]);else for(var n=0;n<i.length;n++)e+=darkEquipControl.getRelatePower(i[n],heroControl.getSubRoleByIndex(this.roleId));this.powerPanel.setPower(e)},e.prototype.updateDarkData=function(){this.otherPlayerData?(this.darkEquips=this.otherPlayerData.darkEquips,this.darkSuits=darkEquipControl.updateDarkSuits(this.roleId,this.darkEquips,this.darkSuits),this.darkDrug=this.otherPlayerData.darkDrug):(this.darkEquips=darkEquipControl.darkEquips,this.darkDrug=darkEquipControl.darkDrug,this.darkSuits=darkEquipControl.updateDarkSuits(void 0,this.darkEquips))},e.prototype.palyEff=function(t){if(t){var e=DataCenter.ins().DarkEquipConfig[t].slot,i="andianEff"+DataCenter.ins().DarkEquipBaConfig.darkSlotQuality[e],n=new GameMovieClip;this["andianItem"+e].eff.addChild(n),n.playFile(PATH_EFF+i,1,function(){DisplayUtils.removeFromParent(n)})}},e.prototype.cleanEff=function(){for(var t=0;13>t;t++)this["andianItem"+t]&&this["andianItem"+t].eff.removeChildren(),this["replace"+t]&&egret.Tween.removeTweens(this["replace"+t])},e.prototype.playFlyItem=function(t){var e=this;if(t){var i=DataCenter.ins().DarkEquipConfig[t].slot,n="darkpos"+DataCenter.ins().DarkEquipConfig[t].star+"_"+i+"_png",o=new eui.Image(n);this["andianItem"+i].imgIcon.visible=!1,o.x=this["andianItem"+i].imgIcon.x,o.y=this["andianItem"+i].imgIcon.y,o.width=this["andianItem"+i].imgIcon.width,o.height=this["andianItem"+i].imgIcon.height,this["andianItem"+i].addChild(o),gameControl.dispatchFlyBagToItem(o,this,function(){e["andianItem"+i].imgIcon.visible=!0}),this.flyItem[i]=o}},e.prototype.cleanFlyItem=function(){for(var t=0;t<this.flyItem.length;t++){var e=this.flyItem[t];e&&egret.Tween.removeTweens(e),DisplayUtils.removeFromParent(e)}for(var i=0;13>i;i++)this["andianItem"+i]&&(this["andianItem"+i].imgIcon.visible=!0)},e.prototype.addSp=function(){this.sp||(this.sp=new eui.Group,this.sp.x=StageUtils.ins().getStage().x,this.sp.y=StageUtils.ins().getStage().y,this.sp.width=StageUtils.ins().getStage().width,this.sp.height=StageUtils.ins().getStage().height,this.sp.touchEnabled=!0),this.sp.parent||(StageUtils.ins().getStage().addChild(this.sp),this.addEventTouchTap(this.sp,this.onTap))},e.prototype.cleanSp=function(){this.removeEventTouchTap(this.sp,this.onTap),DisplayUtils.removeFromParent(this.sp)},e}(BaseEuiView);__reflect(DarkEquipPanel.prototype,"DarkEquipPanel");var DarkEquipSuitPreView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.darkEquips=[],e.darkSuits=[],e.darkDrug=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){this.darkEquips=[],this.darkSuits=[],this.darkDrug=[]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.leftBtn,this.onLeft),this.addEventTouchTap(this.rightBtn,this.onRight),this.addEventTouchTap(this.getEquipBtn,this.onClick),this.addEventItemTap(this.menuList,this.onListChange),this.addEventChange(this.menuScroller,this.onChange),this.menuList.itemRenderer=DarkEquipSuitItemRenderer,this.menuListData=new eui.ArrayCollection,this.menuList.dataProvider=this.menuListData,this.menuList.selectedIndex=0,this.roleId=t[0],this.otherPlayerData=t[1],this.curSelect=new SuitItemVo(1,darkEquipControl.SumLv_REPLACE[darkEquipControl.SumLv_REPLACE.length-1]),this.updateDarkData();for(var i=0;13>i;i++)this["andianItem"+i]&&(this["andianItem"+i].name=i,this["andianItem"+i].data={roleId:this.roleId,itemId:this.darkEquips[this.roleId][i].itemId,other:!0,otherPlayerData:this.otherPlayerData,preview:!0});this.updateSuitTypeList(),this.updateView(),this.onChange(),this.selectList()},e.prototype.switchRole=function(t,e){this.roleId=t,this.otherPlayerData=e,this.updateDarkData(),this.updateView()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.getEquipBtn:UIMgr.ins().close(this),UIMgr.ins().open(DarkHallBossView)}},e.prototype.onListChange=function(){var t=this.menuList.selectedItem;this.curSelect.star=t.star,this.curSelect.darkSuitType=t.darkSuitType,this.updateDarkData(),this.updateView(),this.selectList()},e.prototype.onRight=function(){var t=470,e=this.menuList.scrollH+t;e=94*Math.round(e/94),e>this.menuList.contentWidth-this.menuScroller.width&&(e=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=e,this.onChange()},e.prototype.onChange=function(){this.menuList.scrollH<53?(this.leftGroup.visible=!1,this.rightGroup.visible=!0):this.menuList.scrollH>=this.menuList.contentWidth-this.menuList.width-53?(this.leftGroup.visible=!0,this.rightGroup.visible=!1):(this.leftGroup.visible=!0,this.rightGroup.visible=!0)},e.prototype.onLeft=function(){var t=470,e=this.menuList.scrollH-t;e=94*Math.round(e/94),0>e&&(e=0),this.menuList.scrollH=e,this.onChange()},e.prototype.CallBackUpdate=function(){this.otherPlayerData||(TimerMgr.ins().remove(this.updateView,this),TimerMgr.ins().doTimer(100,1,this.updateView,this))},e.prototype.updateView=function(){this.updateEquips(),this.updateAttrs()},e.prototype.updateEquips=function(){for(var t=0;13>t;t++)this["andianItem"+t]&&(this["andianItem"+t].data={itemId:this.darkEquips[this.roleId][t].itemId,roleId:this.roleId,other:!0,otherPlayerData:this.otherPlayerData,preview:!0})},e.prototype.updateAttrs=function(){var t=0,e=this.curSelect.star,i=LangMgr.getValueByKey("darkSuit"+(1==this.curSelect.darkSuitType?4:5));this.suitName.text=LangMgr.getValueByArr(["stageNumberTxt","samTips9"],[[StringUtils.NumberToChinese(e)],[i]]);var n=this.darkSuits[this.roleId][this.curSelect.darkSuitType],o=[];for(var s in n)o.push(n[s]);o.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"num")});for(var r=1==this.curSelect.darkSuitType?darkEquipControl.SumNum_REPLACE:darkEquipControl.SumNum_UPLEVEL,a=0;a<r.length;a++)this["attr"+r[a]]&&DisplayUtils.removeFromParent(this["suit"+r[a]]);for(var a=0;a<o.length;a++)if(this["attr"+o[a].num]){var l=DataCenter.ins().DarkSuitLvConfig[o[a].type][o[a].num][o[a].level];l?(this["suit"+o[a].num].parent||this.suitAttrGroup.addChild(this["suit"+o[a].num]),this["attr"+o[a].num].text=DarkEquipControl.getAttStr(l.attrs,0,1,"："),this["attr"+o[a].num].text?(t+=BackpackControl.getAttrPower(l.attrs),t+=l.ex_power?l.ex_power:0):DisplayUtils.removeFromParent(this["suit"+o[a].num])):DisplayUtils.removeFromParent(this["suit"+o[a].num])}var h=this.otherPlayerData?this.otherPlayerData.roleData[this.roleId]:heroControl.getSubRoleByIndex(this.roleId);for(var u in this.darkEquips[this.roleId]){var p=this.darkEquips[this.roleId][u];if(p.itemId){var c=DataCenter.ins().DarkEquipConfig[p.itemId];t+=BackpackControl.getAttrPower(c.attr),t+=c.exPower?c.exPower:0;for(var a=0;a<c.attr.length;a++)t+=darkEquipControl.getRelatePower(c.attr[a],h)}}this.powerPanel.setPower(t)},e.prototype.updateSuitTypeList=function(){var t=DataCenter.ins().DarkSuitLvConfig,e=[],i=[];for(var n in t)for(var o in t[n])for(var s in t[n][o])1==Number(n)?-1==e.indexOf(t[n][o][s].level)&&(!t[n][o][s].openDay||GameServer.serverOpenDay+1>=t[n][o][s].openDay)&&e.push(t[n][o][s].level):-1==i.indexOf(t[n][o][s].level)&&(!t[n][o][s].openDay||GameServer.serverOpenDay+1>=t[n][o][s].openDay)&&i.push(t[n][o][s].level);e.sort(SortUtils.sortAscByKey),i.sort(SortUtils.sortAscByKey);for(var r=[],a=Math.max(darkEquipControl.SumLv_REPLACE.length,darkEquipControl.SumLv_UPLEVEL.length),l=0,h=0,u=0;a>u;u++){var o=u+1;e[l]&&e[l]<=o&&(r.push(new SuitItemVo(1,e[l])),l++),i[h]&&i[h]<=o&&(r.push(new SuitItemVo(0,i[h])),h++)}this.menuListData.replaceAll(r),this.menuList.validateNow()},e.prototype.selectList=function(){for(var t=this.menuList.dataProvider.length,e=0;t>e;e++){var i=this.menuList.getElementAt(e);i&&i.setSelect(this.menuList.selectedIndex==e)}},e.prototype.updateDarkData=function(){this.otherPlayerData?(this.darkEquips=this.otherPlayerData.darkEquips,this.darkSuits=darkEquipControl.updateDarkSuits(this.roleId,this.darkEquips,this.darkSuits),this.darkDrug=this.otherPlayerData.darkDrug):(this.darkDrug=darkEquipControl.getDarkDrugDataByPreview(this.roleId),this.darkEquips=darkEquipControl.getDarkEquipsDataByPreview(this.roleId,0,this.curSelect.darkSuitType,this.curSelect.star),this.darkSuits=darkEquipControl.updateDarkSuits(this.roleId,this.darkEquips,this.darkSuits))},e}(BaseEuiView);__reflect(DarkEquipSuitPreView.prototype,"DarkEquipSuitPreView");var DarkEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.darkEquips=[],e.darkSuits=[],e.darkDrug=[],e.skinName="DarkEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.downBtn,this.onTap),this.addEventTouchTap(this.changeBtn,this.onTap),this.addEventTouchTap(this.upBtn,this.onTap),this.addCustomEvent(228,this.CallBackUpdate),this.addCustomEvent(229,this.CallBackUpdate),this.addCustomEvent(231,this.CallBackUpdate),this.addCustomEvent(232,this.CallBackUpdate),this.notBody=!0,this.itemId=t[0],this.roleId=t[1],this.other=t[2]?!0:!1,this.otherPlayerData=t[3],this.preview=t[4],this.notBody=t[5],this.updateDarkData(),this.updateView()},e.prototype.CallBackUpdate=function(){var t=this;TimerMgr.ins().isExists(this.updateView,this)||TimerMgr.ins().doTimer(100,1,this.updateView,this,function(){TimerMgr.ins().remove(t.updateView,t)},this)},e.prototype.updateDarkData=function(){isNaN(this.roleId)||(this.preview||this.notBody?(this.darkEquips=darkEquipControl.getDarkEquipsDataByPreview(this.roleId,this.itemId),this.darkDrug=darkEquipControl.getDarkDrugDataByPreview(this.roleId),this.darkSuits=darkEquipControl.updateDarkSuits(this.roleId,this.darkEquips,this.darkSuits)):(this.darkEquips=this.otherPlayerData?this.otherPlayerData.darkEquips:darkEquipControl.darkEquips,this.darkDrug=this.otherPlayerData?this.otherPlayerData.darkDrug:darkEquipControl.darkDrug,this.otherPlayerData?this.darkSuits=darkEquipControl.updateDarkSuits(this.roleId,this.darkEquips,this.darkSuits):this.darkSuits=darkEquipControl.updateDarkSuits(void 0,this.darkEquips)))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.downBtn:darkEquipControl.upWear(this.roleId,DataCenter.ins().DarkEquipConfig[this.itemId].slot,0),UIMgr.ins().close(this);break;case this.changeBtn:UIMgr.ins().open(DarkEquipWearEquipView,this.roleId,DataCenter.ins().DarkEquipConfig[this.itemId].slot),UIMgr.ins().close(this);break;case this.upBtn:UIMgr.ins().open(DarkEquipForgeView,this.roleId,DataCenter.ins().DarkEquipConfig[this.itemId].slot),UIMgr.ins().close(this)}},e.prototype.updateView=function(){this.updateTop(),this.updateAttrs(),this.updateRedPoint(),this.updateBtnGroup()},e.prototype.updateTop=function(){var t=DataCenter.ins().ItemConfig[this.itemId],e=ItemUtils.getQuality(t),i=ItemUtils.getQualityColor(t);this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+i+"&T:"+t.name),this.quali.source=e>0?"quali"+e:"";var n=DataCenter.ins().DarkEquipConfig[this.itemId];this.type.text=DataCenter.ins().DarkEquipBaConfig.darkSlotName[n.slot],this.career.text=RoleModel.getJobNameByJob(ItemUtils.getJob(t));var o=t.zsLevel?t.zsLevel:0,s=reincarnateControl.lv>=o?"0x00FF00":"0xFF0000";this.lv.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+o),this.itemIcon.setData(t)},e.prototype.updateBtnGroup=function(){this.other&&DisplayUtils.removeFromParent(this.btnGroup)},e.prototype.updateAttrs=function(){var t=0,e=[],i=[],n=[],o=[],s=[],r=[],a=DataCenter.ins().DarkEquipConfig[this.itemId];if(i=AttributeData.AttrAddition(i,a.attr),t+=a.exPower?a.exPower:0,this.score.text=LangMgr.getValueByKey("wingPingfen",t+BackpackControl.getAttrPower(i)),!this.other||this.roleId&&this.notBody){var l=a.slot,h=this.darkEquips[this.roleId][l],u=DataCenter.ins().DarkEquipLvUpConfig[l][h.level];u&&(o=AttributeData.AttrAddition(o,u.strengthenAttr)),s=darkEquipControl.getDrugAttrs(this.roleId,this.darkEquips,this.darkDrug,l),n=darkEquipControl.AddDrugPercent(n,this.roleId,this.darkDrug,this.itemId)}e=AttributeData.AttrAddition(e,i),e=AttributeData.AttrAddition(e,n),e=AttributeData.AttrAddition(e,o),e=AttributeData.AttrAddition(e,s),this.baseAttr.text=DarkEquipControl.getAttStr(e,0,1,"：");var p=darkEquipControl.getDarkForceDesc(this.itemId);p?(this.spiritGroup.parent||this.baseGroup.parent.addChild(this.spiritGroup),this.andianAttr.textFlow=TextUtils.generateTextFlow1(p)):DisplayUtils.removeFromParent(this.spiritGroup);for(var c=darkEquipControl.getDarkTypeBySlot(this.itemId),d=1==c?darkEquipControl.SumNum_REPLACE:darkEquipControl.SumNum_UPLEVEL,g=0;g<d.length;g++){var m=Number(d[g]);this["num"+m]&&(this["num"+m].visible=!1)}var f=!1;if(isNaN(this.roleId))f=!0;else{var v=this.darkSuits[this.roleId];if(!this.darkSuits[this.roleId]){this.darkSuits=[],this.darkSuits[this.roleId]={};for(var g=0;g<d.length;g++){var m=d[g],y=DataCenter.ins().DarkSuitLvConfig[c][m][a.star];if(y){var C=new DarkSuitDataVo(c,y.num,y.level);this.darkSuits[this.roleId][c]||(this.darkSuits[this.roleId][c]={}),this.darkSuits[this.roleId][c][y.num]=C}}v=this.darkSuits[this.roleId]}var T=v[c];if(T&&CommonUtils.getObjectLength(T)){var w=[];for(var m in T)w.push(T[m]);w.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"num")});for(var I=darkEquipControl.getMySuitSum(this.roleId,c,this.darkEquips,this.darkSuits),g=0;g<w.length;g++){var C=w[g],y=DataCenter.ins().DarkSuitLvConfig[c][C.num][C.level];if(y){this["num"+C.num].visible=!0;var b=StringUtils.NumberToChinese(y.level);this["suitState"+C.num].text=LangMgr.getValueByKey("darkSuit7",y.num,b),this["suitState"+C.num].textColor=I>=y.num?65280:8618883,this["suitAttr"+C.num].text=DarkEquipControl.getAttStr(y.attrs,0,1,"："),this["suitAttr"+C.num].textColor=I>=y.num?65280:8618883,r=AttributeData.AttrAddition(r,y.attrs),t+=y.ex_power?y.ex_power:0}this.other&&this.notBody&&(this["suitState"+C.num].textColor=8618883,this["suitAttr"+C.num].textColor=8618883)}var D=d[0],B=16711680;if(I>=D&&(B=65280),this.other&&!this.otherPlayerData&&this.notBody&&(I=1,B=16711680,this.preview))for(var g=0;g<w.length;g++){var C=w[g];this["suitState"+C.num].textColor=65280,this["suitAttr"+C.num].textColor=65280}this.suitNum.textFlow=TextUtils.generateTextFlow1("|C:"+B+"&T:("+I+"/"+D+")")}else f=!0}if(f){for(var k=a.star,g=0;g<d.length;g++){var x=darkEquipControl.getMinLvBySuitNum(c,d[g]),R=k>=x?k:x,y=DataCenter.ins().DarkSuitLvConfig[c][d[g]][R];if(y){this["num"+y.num].visible=!0;var E=StringUtils.NumberToChinese(y.level);this["suitState"+y.num].text=LangMgr.getValueByKey("darkSuit7",y.num,E),this["suitState"+y.num].textColor=8618883,this["suitAttr"+y.num].text=DarkEquipControl.getAttStr(y.attrs,0,1,"："),this["suitAttr"+y.num].textColor=8618883}}var D=1,_=d[0],B=16711680;this.suitNum.textFlow=TextUtils.generateTextFlow1("|C:"+B+"&T:("+D+"/"+_+")")}var S=LangMgr.getValueByKey("darkSuit"+(1==c?1:2));this.suitName.text=LangMgr.getValueByKey("darkSuit8",S);for(var M=!1,g=0;g<d.length;g++){var m=Number(d[g]);if(this["num"+m].visible){M=!0;break}}if(M)for(var g=0;g<d.length;g++){var m=Number(d[g]),x=darkEquipControl.getMinLvBySuitNum(c,m);if(!this["num"+m].visible)if(this["num"+m].visible=!0,DataCenter.ins().DarkSuitLvConfig[c][m][x]){var E=StringUtils.NumberToChinese(x);this["suitState"+m].textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("darkSuit7",m,E)),this["suitAttr"+m].text=DarkEquipControl.getAttStr(DataCenter.ins().DarkSuitLvConfig[c][m][x].attrs,0,1,"：")}else this["num"+m].visible=!1}else DisplayUtils.removeFromParent(this.suitGroup);if(e=AttributeData.AttrAddition(e,r),t+=BackpackControl.getAttrPower(e),!this.other&&!isNaN(this.roleId))for(var g=0;g<e.length;g++){var P=heroControl.getSubRoleByIndex(this.roleId);t+=ItemUtils.relatePower(e[g],P)}this.powerPanel.setPower(t)},e.prototype.updateRedPoint=function(){this.other||isNaN(this.roleId)||(this.redPoint1.visible=darkEquipControl.getRedPoint1(this.roleId,DataCenter.ins().DarkEquipConfig[this.itemId].slot),this.redPoint2.visible=darkEquipControl.getRedPoint0(this.roleId,this.itemId))},e}(BaseEuiView);__reflect(DarkEquipTipsView.prototype,"DarkEquipTipsView");var DarkEquipView=function(t){function e(){var e=t.call(this)||this;return e.curSelectIndex=0,e.skinName="DarkEquipViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.panelArr)for(var i=0;i<this.panelArr.length;i++){var n=this.panelArr[i];n.close()}},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.panelArr=[this.darkEquipPanel,this.darkEquipComposePanel,this.darkEquipSuitPreView],this.viewStack.selectedIndex=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addCustomEvent(231,this.setRedPoint),this.addCustomEvent(228,this.setRedPoint),this.curSelectIndex=t[0]?t[0]:0,this.roleSelect.setCurRole(0),this.addEventChange(this.roleSelect,this.switchRole),this.isNotMove=!0,this.updateView()},e.prototype.onTabTouch=function(t){this.panelArr[this.curSelectIndex].close();var e=t.currentTarget.selectedIndex;this.setSelectedIndex(e),this.setRedPoint()},e.prototype.setSelectedIndex=function(t){this.curSelectIndex=t,this.panelArr[t].open(this.roleSelect.getCurRole()),this.viewStack.selectedIndex=t},e.prototype.switchRole=function(){this.panelArr[this.curSelectIndex].switchRole(this.roleSelect.getCurRole())},e.prototype.updateView=function(){this.setSelectedIndex(this.curSelectIndex),this.setRedPoint()},e.prototype.setRedPoint=function(){this.redPoint0.visible=!1,this.redPoint1.visible=!1,this.redPoint2.visible=!1;for(var t=[!1,!1,!1],e=0;e<heroControl.subRolesLen;e++){var i=darkEquipControl.getRedPoint00(e)||darkEquipControl.getRedPoint0(e)||darkEquipControl.getRedPoint1(e),n=darkEquipControl.getRedPoint2(e),o=i||n;t[e]||(t[e]=o),i&&(this.redPoint0.visible=i),n&&(this.redPoint1.visible=n)}for(var e=0;e<t.length;e++)this.roleSelect.showRedPoint(e,t[e])},e}(BaseEuiView);__reflect(DarkEquipView.prototype,"DarkEquipView");var DarkEquipWearEquipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipWearEquipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.callback=function(){darkEquipControl.dispatchDarkEquipWearSuccess(this.flyItemId),UIMgr.ins().close(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.list,this.onTouch),this.addCustomEvent(231,this.callback),this.list.itemRenderer=DarkEquipWearItemRenderer,this.listDt=new eui.ArrayCollection,this.list.dataProvider=this.listDt,this.roleId=t[0],this.slot=t[1];var i=darkEquipControl.getDarkEquipsBySlot(this.slot);if(i.length){var n=[],o=darkEquipControl.darkEquips[this.roleId][this.slot],s=new ItemData;if(o.itemId){s.configID=o.itemId,s.count=1,i.unshift(s);var r=BackpackControl.getAttrPower(DataCenter.ins().DarkEquipConfig[o.itemId].attr),a=BackpackControl.getAttrPower(DataCenter.ins().DarkEquipConfig[i[1].configID].attr);i[1].canbeUsed=a>r}else i[0].canbeUsed=!0;for(var l=0;l<i.length;l++)n.push({myitem:s,item:i[l],roleId:this.roleId});this.listDt.replaceAll(n),this.tipLabel2.visible=!1}else this.tipLabel2.visible=!0},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;default:if(t.target instanceof eui.Button&&t.target.parent instanceof DarkEquipWearItemRenderer){var e=t.target.parent.data;this.flyItemId=e.item.configID,darkEquipControl.upWear(this.roleId,this.slot,e.item.configID)}}},e}(BaseEuiView);__reflect(DarkEquipWearEquipView.prototype,"DarkEquipWearEquipView");var DarkDrugItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkDrugItemRendererSkin",e.addEventTouchEnd(e,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.darkDrug[this.data.roleId][this.data.itemId];this.up2.icon=DataCenter.ins().ItemConfig[this.data.itemId].icon+"_png",this.used2.text=""+t,this.redPoint2.visible=darkEquipControl.IsUseDrug(this.data.roleId,this.data.itemId)}},e.prototype.onClick=function(){if(this.redPoint2.visible){var t=this.data.itemId==DataCenter.ins().DarkEquipBaConfig.AItemId?1:2;darkEquipControl.upUseDrug(this.data.roleId,t)}else UIMgr.ins().open(DarkEquipDrugTipsView,this.data.roleId,this.data.itemId)},e}(BaseItemRender);__reflect(DarkDrugItemRenderer.prototype,"DarkDrugItemRenderer");var DarkEquipItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipItemRendererSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEventTouchEnd(this,this.onClick)},e.prototype.dataChanged=function(){this.data&&(this.slot=Number(this.name),this.itemId=this.data.itemId,this.roleId=this.data.roleId,this.data.level,this.preview=this.data.preview,this.other=this.data.other,this.otherPlayerData=this.data.otherPlayerData,this.quality.source="",this.itemId?(this.imgIcon.source="darkpos"+DataCenter.ins().DarkEquipConfig[this.itemId].star+"_"+this.slot+"_png",this.quality.source="andiankuang"+ItemUtils.getQuality(DataCenter.ins().ItemConfig[this.itemId])+"_"+DataCenter.ins().DarkEquipBaConfig.darkSlotQuality[this.slot]):this.imgIcon.source="darkpos0_"+this.slot+"_png")},e.prototype.onClick=function(){if(this.otherPlayerData){if(!this.itemId)return;UIMgr.ins().open(DarkEquipTipsView,this.itemId,this.roleId,this.other,this.otherPlayerData)}else{if(this.other)return void(this.itemId&&UIMgr.ins().open(DarkEquipTipsView,this.itemId,this.roleId,!0,void 0,this.preview,!0));this.itemId?UIMgr.ins().open(DarkEquipTipsView,this.itemId,this.roleId,this.other,this.otherPlayerData,void 0,!1):UIMgr.ins().open(DarkEquipWearEquipView,this.roleId,this.slot)}},e}(BaseItemRender);__reflect(DarkEquipItemRenderer.prototype,"DarkEquipItemRenderer");var DarkEquipSmeltItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipSmeltItemRendererSkin",e.touchChildren=!1,e}return __extends(e,t),e.prototype.playDepartMc=function(){this.mc||(this.mc=new GameMovieClip),this.mc.x=43,this.mc.y=44,this.mc.scaleX=1.5,this.mc.scaleY=1.5,this.mc.parent||this.addChild(this.mc),this.mc.playFile(PATH_EFF+"litboom",1)},e.prototype.dataChanged=function(){if(!isNaN(this.data)&&this.data){this.itemConfig=DataCenter.ins().ItemConfig[this.data],this.nameTxt.text=this.itemConfig.name,this.nameTxt.textColor=ItemUtils.getQualityColor(this.itemConfig),this.imgBg.source="quality"+ItemUtils.getQuality(this.itemConfig),this.imgIcon.source=this.itemConfig.icon+"_png";var t=DataCenter.ins().DarkEquipConfig[this.itemConfig.id].star;this.equipLv.text=t>0?"+"+t:""}},e}(BaseItemRender);__reflect(DarkEquipSmeltItemRenderer.prototype,"DarkEquipSmeltItemRenderer");var DarkEquipSuitItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipSuitItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof SuitItemVo){var t=this.getName(this.data);
this.nameBitmap.text=t,this.selectIcon.visible=!1,this.itemIcon.source="andiansuitIcon"+this.data.darkSuitType}},e.prototype.getName=function(t){var e=LangMgr.getValueByArr(["stageNumberTxt","darkSuit"+(1==t.darkSuitType?1:2)],[[StringUtils.NumberToChinese(t.star)],[]]);return t.star<=10&&(e+=LangMgr.getValueByKey("darkSuit3")),e},e.prototype.setSelect=function(t){this.selectIcon.visible=t},e}(BaseItemRender);__reflect(DarkEquipSuitItemRenderer.prototype,"DarkEquipSuitItemRenderer");var DarkEquipUpList2ItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipUpList2ItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.lv.text=LangMgr.getValueByKey("darkSuit9",this.data.star,this.getName(this.data.slot));var t=UIMgr.ins().getView(DarkEquipView);if(t){var e=t.roleSelect.getCurRole();this.redPoint.visible=reincarnateControl.lv>=DataCenter.ins().DarkEquipConfig[this.data.itemId].level&&darkEquipControl.getIsMaterial(e,this.data.composeItem),this.setSelect(t.darkEquipComposePanel.curSelect.itemId==this.data.itemId),this.child_btn.currentState=this.chosen.visible?"down":"up"}}},e.prototype.setSelect=function(t){this.chosen.visible=t,this.child_btn.currentState=this.chosen.visible?"down":"up"},e.prototype.getName=function(t){var e="";switch(t){case 0:case 2:case 9:case 10:case 11:case 12:e=LangMgr.getValueByKey("darkUpItem"+t);break;default:e=LangMgr.getValueByKey("darkUpItemNo",t)}return e},e}(BaseItemRender);__reflect(DarkEquipUpList2ItemRenderer.prototype,"DarkEquipUpList2ItemRenderer");var DarkEquipUpListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.config=[],e.skinName="DarkEquipUpListItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=DarkEquipUpList2ItemRenderer,this.list.useVirtualLayout=!1,this.addEventItemTap(this.list,this.onListChange)},e.prototype.onListChange=function(t){darkEquipControl.dispatchDarkEquipUpListEvent(t.item)},e.prototype.selectList=function(t){this.list.selectedIndex=t;var e=this.list.getVirtualElementAt(this.list.selectedIndex);e.selected=!0,e.setSelect(!0)},e.prototype.dataChanged=function(){if(this.data){this.config=[];for(var t in this.data)this.data[t]&&this.config.push(this.data[t]);for(var t in this.config)this.equipNum.text=""+this.config[t].star;this.redPoint.visible=!1;var e=UIMgr.ins().getView(DarkEquipView);if(e){var i=e.roleSelect.getCurRole();for(var t in this.config){var n=darkEquipControl.getComposeItem(i,this.config[t].itemId);if(n){this.redPoint.visible=!0;break}}}}},e.prototype.updateSecList=function(){this.list.dataProvider=new ArrayCollection(this.config),this.list.validateNow()},e.prototype.cleanSecList=function(){this.list.dataProvider=new ArrayCollection([]),this.list.validateNow()},e}(BaseItemRender);__reflect(DarkEquipUpListItemRenderer.prototype,"DarkEquipUpListItemRenderer");var DarkEquipWearItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DarkEquipWearItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.item instanceof ItemData){this.roleId=this.data.roleId,this.itemIcon.data=this.data.item.configID;var t=DataCenter.ins().ItemConfig[this.data.item.configID],e=DataCenter.ins().DarkEquipConfig[t.id];this.quality.text=StringUtils.NumberToChinese(e.star)+LangMgr.getValueByKey("osaLevelJ"),this.quality.textColor=ItemUtils.getQualityColor(t),this.now.visible=!1,this.best.visible=!1,this.changeBtn.visible=!0,this.data.item.handle||(this.now.visible=!0,this.changeBtn.visible=!1),this.data.item.canbeUsed&&(this.best.visible=!0);for(var i=0;5>i;i++)if(this["attrGroup"+i])if(e.attr[i]){this["attr"+i].text=AttributeData.getAttrNameByAttrbute(e.attr[i],!0);var n=this.data.myitem?this.data.myitem._configID:0,o=DataCenter.ins().DarkEquipConfig[n];if(this["betterArrow"+i].visible=!0,o&&o.itemId){for(var s=0;s<o.attr.length;s++)if(e.attr[i].type==o.attr[s].type){if(e.attr[i].value>o.attr[s].value){var r=new AttributeData(e.attr[i].type,e.attr[i].value-o.attr[s].value);this["forgeAttr"+i].text="+"+darkEquipControl.getAttrValueDesc(r)}else this["betterArrow"+i].visible=this["forgeAttr"+i].visible=!1;break}}else this["forgeAttr"+i].text="+"+darkEquipControl.getAttrValueDesc(e.attr[i])}else DisplayUtils.removeFromParent(this["attrGroup"+i]);this.power.text=LangMgr.getValueByKey("wingPingfen",BackpackControl.getAttrPower(e.attr))}},e}(BaseItemRender);__reflect(DarkEquipWearItemRenderer.prototype,"DarkEquipWearItemRenderer");var WeaponSoulListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.showId){var t=this.data.id,e=this.data.isuse,i=this.data.isRedPoint,n=this.data.level,o=(this.data.isSelect,DataCenter.ins().WeaponSoulConfig[t]),s=this.data.showId,r=this.data.job;if(!o){o=DataCenter.ins().WeaponSoulConfig[s],this.setEff(o,r);var a=DataCenter.ins().WeaponSoulSuitConfig[o.id],l=void 0;for(var h in a){l=a[h];break}return this.timelabel.text=o.name,this.huanhuaImage.visible=!1,this.redPoint0.visible=i,this.levellabel.text=l.level+LangMgr.getValueByKey("osaLevelJ"),void this.setGray(this.mc)}this.setEff(o,r),this.timelabel.text=o.name,this.huanhuaImage.visible=e,this.redPoint0.visible=i,this.levellabel.text=n+LangMgr.getValueByKey("osaLevelJ")}},e.prototype.setEff=function(t,e){if(t){this.mc||(this.mc=new GameMovieClip),this.mc.parent||(this.effpos.parent.addChild(this.mc),this.mc.x=this.effpos.x,this.mc.y=this.effpos.y,this.mc.rotation=this.effpos.rotation);var i=t.inside[e-1];this.mc.playFile(PATH_EFF+i,-1),this.touchEnabled=!1,this.mc.touchEnabled=!1,this.effpos.parent.touchEnabled=!1,this.cleanFilters(this.mc)}},e.prototype.setGray=function(t){if(this.mc&&this.cleanFilters(this.mc),t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];t.filters=[new egret.ColorMatrixFilter(e)]}},e.prototype.cleanFilters=function(t){t&&(t.filters=[])},e.prototype.clear=function(){this.cleanFilters(this.mc)},e.prototype.destruct=function(){this.clear()},e}(BaseItemRender);__reflect(WeaponSoulListItemRender.prototype,"WeaponSoulListItemRender");var DeityBreakDownView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="DeityBreakDownViewSkin",this.isTopLevel=!0,this.equipList.itemRenderer=DeityBreakDownItemRenderer,this.listData=new eui.ArrayCollection,this.equipList.dataProvider=this.listData,this.gainList.itemRenderer=GainGoodsItem,this.goList=new eui.ArrayCollection,this.gainList.dataProvider=this.goList},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(268,this.updateData),this.addEventTouchTap(this,this.onTap),this.addEventItemTap(this.gainList,this.onGo),this.quality=t[0],this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this,this.onTap),this.removeEventItemTap(this.gainList,this.onGo),this.removeCustomEvents()},e.prototype.updateData=function(){var t=backpackControl.getBagEquipsByQuality(this.quality);t.sort(function(t,e){var i=DataCenter.ins().ItemConfig[t.configID],n=DataCenter.ins().ItemConfig[e.configID];return i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:i.level>n.level?1:i.level<n.level?-1:0}),this.listData.source=t;var e=this.itemList[this.quality],i=e.length;this.goList.removeAll();for(var n=0;n<e.length;n++)this.goList.addItem(e[n]);this.refushPos(i)},e.prototype.refushPos=function(t){this.contrain.height=60*t,this.equipScroller.height=310+60*(3-t)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn0:case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;default:if(t.target instanceof eui.Button)switch(t.target.name){case"breakDown":equipControl.upSmeltEquip(1,[t.target.parent.data])}}},e.prototype.onGo=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&(GuideControl.guidance(e[1],e[2]),UIMgr.ins().close(this))}},e}(BaseEuiView);__reflect(DeityBreakDownView.prototype,"DeityBreakDownView");var DeityEquipPanel=function(t){function e(){var e=t.call(this)||this;return e._roleId=0,e.name=LangMgr.getValueByKey("titleTips10"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.curIndex=0,this.getTreasureBtn.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.getTreasureBtn.text+"</u></a>"),this.getTreasureBtn.touchEnabled=!0,this.chargeEff1=new GameMovieClip,this.chargeEff1.x=this.getTreasureBtn.x+this.getTreasureBtn.width/2,this.chargeEff1.y=this.getTreasureBtn.y+this.getTreasureBtn.height/2,this.chargeEff1.touchEnabled=!1,this.chargeEff1.scaleY=.7,this.chargeEff1.scaleX=.9},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.getTreasureBtn,this.openSmeltView);for(var i=0;8>i;i++){var n=this["equip"+i];this.addEventTouchTap(n,this.onSelect),this.addEventTouchTap(n.mixBtn,this.onSelect)}this.addEventTouchTap(this.executeBtn,this.executeCB),this.addCustomEvent(118,this.mixCB),this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.addCustomEvent(267,this.updateView),this.effArr=[],this.curIndex=t[0],this.setRoleId(t[0]),this.upBtn.open(DataCenter.ins().LittleSystemBaseConfig.equipUpItem)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.getTreasureBtn,this.openSmeltView);for(var i=0;8>i;i++){var n=this["equip"+i];this.removeEventTouchTap(n,this.onSelect),this.removeEventTouchTap(n.mixBtn,this.onSelect)}DisplayUtils.removeFromParent(this.chargeEff1),this.removeEventTouchTap(this.executeBtn,this.executeCB),this.removeCustomEvents(),this.cleanEff(),this.upBtn.close()},e.prototype.onSelect=function(t){ActorControl.level;switch(t.currentTarget){case this.equip0:case this.equip0.mixBtn:this.curIndex=0;break;case this.equip1:case this.equip1.mixBtn:this.curIndex=1;break;case this.equip2:case this.equip2.mixBtn:this.curIndex=2;break;case this.equip3:case this.equip3.mixBtn:this.curIndex=3;break;case this.equip4:case this.equip4.mixBtn:this.curIndex=4;break;case this.equip5:case this.equip5.mixBtn:this.curIndex=5;break;case this.equip6:case this.equip6.mixBtn:this.curIndex=6;break;case this.equip7:case this.equip7.mixBtn:this.curIndex=7}this.updateView()},e.prototype.executeCB=function(t){var e=this;if(parseInt(this.cur.text)<parseInt(this.need.text.substr(1)))return void tipsControl.showTips(LangMgr.getValueByKey("titleTips11"));if(this.executeBtn.label==LangMgr.getValueByKey("dressUpdate1"))this.grewup();else if(this.executeBtn.label==LangMgr.getValueByKey("titleTips9")){var i=heroControl.getSubRoleByIndex(this._roleId).getEquipByIndex(this.curIndex),n=i.item.configID,o=DataCenter.ins().ItemConfig[n];if(void 0!=o&&5==ItemUtils.getQuality(o)){var s=DataCenter.ins().ItemConfig[i.item.configID],r=s.zsLevel>0?LangMgr.getValueByKey("numberRotation",s.zsLevel):LangMgr.getValueByKey("numberLevel",s.level),a=ItemUtils.getQualityColor(s).toString(16);warnControl.show(LangMgr.getValueByKey("titleTips12",a,r),function(){e.mix()},this)}else this.mix()}},e.prototype.grewup=function(){var t=DataCenter.ins().ItemConfig[this.curEquipConfigId+1];return t.level>ActorControl.level||t.zsLevel>reincarnateControl.lv?void tipsControl.showTips(LangMgr.getValueByKey("titleTips3")):void equipControl.upGrewupEquip(this._roleId,this.curIndex)},e.prototype.grewupCB=function(t,e,i){return 0==e?void tipsControl.showTips(LangMgr.getValueByKey("titleTips4")):(tipsControl.showTips(LangMgr.getValueByKey("clanUpdata")),void this.updateView())},e.prototype.mix=function(){equipControl.upMixEquip(this._roleId,this.curEquipConfigId,this.curIndex)},e.prototype.mixCB=function(t,e,i){return 0==e?void tipsControl.showTips(LangMgr.getValueByKey("titleTips7")):(tipsControl.showTips(LangMgr.getValueByKey("titleTips8")),void this.updateView())},e.prototype.openSmeltView=function(t){UIMgr.ins().open(BreakDownView,1,4)},e.prototype.updateView=function(){this.updateAllEquipItem(),this.updateDetailPanel(),backpackControl.getLegendHasResolve()?(this.chargeEff1.visible=!0,this.chargeEff1.playFile(PATH_EFF+"chargeff1",-1),this.chargeEff1.parent||this.btnGroup.addChild(this.chargeEff1)):(this.chargeEff1.visible=!1,DisplayUtils.removeFromParent(this.chargeEff1)),this.setItemRedPoint()},e.prototype.updateDetailPanel=function(){var t=heroControl.getSubRoleByIndex(this._roleId).getEquipByIndex(this.curIndex);if(null!=t){var e=DataCenter.ins().ItemConfig[t.item.configID+1],i=0,n=0;this.costNum.visible=!0;var o=ItemUtils.getQuality(t.item.itemConfig);if(void 0==e&&0!=t.item.handle&&4==o)this.mixPanel.visible=!0,this.labelMax.visible=!0,this.grewupPanel.visible=!1,this.curEquipConfigId=this.updateMixPanel(),this.executeBtn.visible=!1,this.need.text="",this.cur.text="",this.costNum.visible=!1;else{if(void 0!=e&&0!=t.item.handle&&4==o&&1!=t.item.itemConfig.level&&-1==BackpackControl.fitleEquip.indexOf(t.item.configID)){this.mixPanel.visible=!1,this.grewupPanel.visible=!0,this.curEquipConfigId=this.updateGrewupPanel(),this.executeBtn.label=LangMgr.getValueByKey("dressUpdate1");var s=DataCenter.ins().DeityEquipLevelupConfig[this.curEquipConfigId];i=s.count,n=s.itemId}else{this.mixPanel.visible=!0,this.grewupPanel.visible=!1,this.curEquipConfigId=this.updateMixPanel(),this.executeBtn.label=LangMgr.getValueByKey("titleTips9");var r=DataCenter.ins().DeityEquipComposeConfig[this.curEquipConfigId];i=r.count,n=r.itemId}var a=backpackControl.getBagGoodsCountById(0,n);this.need.text="/"+i,this.cur.text=a+"",a>=i?this.cur.textColor=ColorUtils.GREEN:this.cur.textColor=ColorUtils.RED,this.executeBtn.visible=!0,this.labelMax.visible=!1}}},e.prototype.updateMixPanel=function(){var t,e,i=ActorControl.level;if(i>=1){var n=this.curIndex,o=heroControl.getSubRoleByIndex(this._roleId);e=equipControl.getEquipConfigIDByPosAndQualityByGod(o,n,4,heroControl.getSubRoleByIndex(this._roleId).job,!0),t=DataCenter.ins().ItemConfig[e]}void 0!=t&&(t.zsLevel>0?this.mixPanel.level.text=t.zsLevel+LangMgr.getValueByKey("numberRotation",""):this.mixPanel.level.text=t.level?"Lv."+t.level:"Lv.1",this.mixPanel.equipName.text=t.name,this.mixPanel.itemIcon.imgJob.visible=!1,this.mixPanel.itemIcon.setData(t));var s=[],r=[],a=[],l=DataCenter.ins().EquipConfig[e];for(var h in AttributeData.translate)!l[h]||l[h]<=0||(r.push(l[h]+""),s.push(AttributeData.getAttrStrByType(AttributeData.translate[h])),a.push(" +"+Math.floor(ItemBase.ADDITION_RANGE*l[h]/100)));return this.mixPanel.attributes.baseAttr.text=ItemData.getStringByNextList(r,a),this.mixPanel.attributes.randAttr.text="",this.mixPanel.attributes.nameAttr.text=ItemData.getStringByList(s),this.mixPanel.attributes.score.text=ItemUtils.pointCalNumber(t),e},e.prototype.updateGrewupPanel=function(){var t=heroControl.getSubRoleByIndex(this._roleId).getEquipByIndex(this.curIndex),e=t.item.configID,i=DataCenter.ins().ItemConfig[e],n=DataCenter.ins().ItemConfig[e+1];if(void 0==n);else{this.grewupPanel.curName.text=i.name+"",this.grewupPanel.nextName.text=n.name+"",i.zsLevel>0?this.grewupPanel.curLevel.text=i.zsLevel+LangMgr.getValueByKey("numberRotation",""):this.grewupPanel.curLevel.text=i.level?"Lv."+i.level:"Lv.1",n.zsLevel>0?this.grewupPanel.nextLevel.text=n.zsLevel+LangMgr.getValueByKey("numberRotation",""):this.grewupPanel.nextLevel.text=n.level?"Lv."+n.level:"Lv.1",this.grewupPanel.curItemIcon.imgJob.visible=!1,this.grewupPanel.nextItemIcon.imgJob.visible=!1,this.grewupPanel.curItemIcon.setData(i),this.grewupPanel.nextItemIcon.setData(n);for(var o=1;4>=o;o++)this.grewupPanel.attributes["arrow"+o].visible=!1;var s=[],r=[],a=[],l=[],h=[],u=DataCenter.ins().EquipConfig[e],p=DataCenter.ins().EquipConfig[e+1],c=t.item,d=1;for(var g in AttributeData.translate)if(u[g]&&!(u[g]<=0)){if(void 0!=c)for(var m=c.att,f=0;f<m.length;f++)if(m[f].type==AttributeData.translate[g]){a.push(" +"+m[f].value);break}this.grewupPanel.attributes["arrow"+d].visible=!0,d++,r.push(u[g]+""),l.push(p[g]+""),h.push(" +"+Math.floor(ItemBase.ADDITION_RANGE*p[g]/100)),s.push(AttributeData.getAttrStrByType(AttributeData.translate[g]))}this.grewupPanel.attributes.curBaseAttr.text=ItemData.getStringByNextList(r,a),this.grewupPanel.attributes.nextBaseAttr.text=ItemData.getStringByNextList(l,h),this.grewupPanel.attributes.nameAttr.text=ItemData.getStringByList(s),this.grewupPanel.attributes.curScore.text=LangMgr.getValueByKey("wingPingfen",ItemUtils.pointCalNumber(i)),this.grewupPanel.attributes.nextScore.text=LangMgr.getValueByKey("wingPingfen",ItemUtils.pointCalNumber(n))}return e},e.prototype.updateAllEquipItem=function(){for(var t=0;8>t;t++)this.updateEquipItem(t)},e.prototype.updateEquipItem=function(t){var i=this["equip"+t];if(null!=i){var n=heroControl.getSubRoleByIndex(this._roleId).getEquipByIndex(t),o=i.itemIcon;o.imgJob.visible=!1,-1!=BackpackControl.fitleEquip.indexOf(n.item.configID)||0==n.item.handle||ItemUtils.getQuality(n.item.itemConfig)<4||1==n.item.itemConfig.level&&!n.item.itemConfig.zsLevel?(o.setData(null),o.imgIcon.source=e.defaultEquipIcon[t],i.level.text="",i.mixBtn.visible=!1,this.cleanEffOnly(t)):(i.mixBtn.visible=!1,n.item.itemConfig.zsLevel>0?i.level.text=n.item.itemConfig.zsLevel+LangMgr.getValueByKey("numberRotation",""):i.level.text=n.item.itemConfig.level?"Lv."+n.item.itemConfig.level:"Lv.1",o.setData(n.item.itemConfig),this.playEff(t)),this.curIndex==t?i.select.visible=!0:i.select.visible=!1}},e.prototype.playEff=function(t){if(!(0>t||t>7)){var e=t;this["effArr"+e]||(this["effArr"+e]=new GameMovieClip,this["effArr"+e].x+=this["equip"+e].width/2,this["effArr"+e].y+=this["equip"+e].height/2-20.5,this["equip"+e].addChild(this["effArr"+e]),this["effArr"+e].playFile(PATH_EFF+"quality_05",-1))}},e.prototype.cleanEffOnly=function(t){if(!(0>t||t>7)){var e=t;this["effArr"+e]&&(DisplayUtils.removeFromParent(this["effArr"+e]),this["effArr"+e]=null)}},e.prototype.cleanEff=function(){for(var t=0;8>t;t++)this["effArr"+t]&&(DisplayUtils.removeFromParent(this["effArr"+t]),this["effArr"+t]=null)},e.prototype.setItemRedPoint=function(){for(var t=0;8>t;t++){var e=this["equip"+t],i=heroControl.getSubRoleByIndex(this._roleId);if(e.redPoint.visible=equipControl.setOrangeEquipItemState(t,i),e.redPoint.visible){var n=backpackControl.checkEqRedPoint(t,i,!0);e.redPoint.visible=null!=n?n:e.redPoint.visible}}},e.prototype.setRoleId=function(t){this._roleId=t,this.updateView()},e.defaultEquipIcon=["xb_10","xb_11","xb_12","xb_13","xb_14","xb_15","xb_16","xb_17"],e}(BasePanel);__reflect(DeityEquipPanel.prototype,"DeityEquipPanel");var DeityEquipView=function(t){function e(){var e=t.call(this)||this;return e.curSelectIndex=0,e.skinName="DeityEquipViewSkin",e.isTopLevel=!0,e.canVis=!0,e.winTabIndexs=[0,1,2,3,4],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.selectedIndex=0,this.tab.dataProvider=this.viewStack},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.help,this.onClick),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addCustomEvent(267,this.setRedPoint),this.addCustomEvent(266,this.setRedPoint),this.addCustomEvent(268,this.setRedPoint),this.addCustomEvent(352,this.setRedPoint),this.addCustomEvent(562,this.setRedPoint),this.addCustomEvent(569,this.setRedPoint),this.checkPanel();var i=t[0]?t[0]:0,n=t[1]?t[1]:0;this.roleSelect.setCurRole(n),this.addEventChange(this.roleSelect,this.switchRole),this.setSelectedIndex(i),this.setRedPoint()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;2>i;i++)this.viewStack.getElementAt(i).close()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.switchRole=function(){var t=this.roleSelect.getCurRole();this.viewStack.getElementAt(this.viewStack.selectedIndex).setRoleId(t)},e.prototype.onTabTouching=function(t){var i=t.currentTarget.selectedIndex,n=this.winTabIndexs[i];return 4==n?(darkEquipControl.checkSysOpen()?UIMgr.ins().open(DarkEquipView):UIMgr.ins().open(TreasureHuntView,0),void t.preventDefault()):e.checkIsOpen(n,!0)?void(3==n?(UIMgr.ins().open(ThunderView,0),t.preventDefault()):mythEquipControl.checkLegendForgeIsOpen()&&1==i&&(UIMgr.ins().open(MythEquipView),t.preventDefault())):void t.preventDefault()},e.checkIsOpen=function(t,e){switch(void 0===e&&(e=!1),t){case 0:break;case 1:break;case 2:if(!SwitchMgr.ins().checkOpen(44,e))return!1;break;case 3:if(!thunderControl.checkSysOpen()){var i="",n=DataCenter.ins().ThunderQuenBaseConfig.openLevel/1e3>>0,o=DataCenter.ins().ThunderQuenBaseConfig.openLevel%1e3>>0;return i+=n?LangMgr.getValueByKey("numberRotation",n):"",i+=o?LangMgr.getValueByKey("numberLevel",o):"",tipsControl.showTips(LangMgr.getValueByKey("fbShow3",DataCenter.ins().ThunderQuenBaseConfig.openDay,i)),!1}}return!0},e.prototype.onTabTouch=function(t){this.viewStack.getElementAt(this.viewStack.selectedIndex)&&this.viewStack.getElementAt(this.viewStack.selectedIndex).close();var e=t.currentTarget.selectedIndex;this.setSelectedIndex(e),this.setRedPoint(),UIMgr.ins().close(LimitTaskView)},e.prototype.setSelectedIndex=function(t){var e=this.winTabIndexs[t];if(3==e)return void UIMgr.ins().open(ThunderView,0);if(1==e&&mythEquipControl.checkLegendForgeIsOpen())return void UIMgr.ins().open(MythEquipView);this.curSelectIndex=t;var i=this.roleSelect.getCurRole();this.viewStack.getElementAt(this.viewStack.selectedIndex).open(i)},e.openCheck=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return ActorControl.level<10?(LangMgr.getValueByKey("tipsOpenLevel",10),!1):e.checkIsOpen(t[0],!0)},e.prototype.setRedPoint=function(){this.checkPanel(),this.redPoint4.visible=this.redPoint3.visible=this.redPoint2.visible=this.redPoint0.visible=this.redPoint1.visible=!1;for(var t=!1,e=heroControl.subRolesLen,i=0;e>i;i++){for(var n=0;8>n&&!(t=equipControl.setOrangeEquipItemState(n,heroControl.getSubRoleByIndex(i)));n++);this.roleSelect.showRedPoint(i,t),t&&(this.redPoint0.visible=t)}if(t=!1,this.redPoint1.visible=MythEquipRedPoint.ins().redPoint,!mythEquipControl.checkLegendForgeIsOpen()&&1==this.viewStack.selectedIndex)for(var o=0;e>o;o++)this.roleSelect.showRedPoint(o,MythEquipRedPoint.ins().getRoleRed(o));if(darkEquipControl.checkSysOpen()?this.redPoint4.visible=DarkEquipRedPoint.ins().redPoint:this.redPoint4.visible=Boolean(backpackControl.getHuntGoods(0).length),2==this.viewStack.selectedIndex){this.roleSelect.clearRedPoint();for(var s=0;e>s;s++){var r=heroControl.getSubRoleByIndex(s),i=uitrasoneEquipControl.getRedPointByJob(r.job);i&&this.roleSelect.showRedPoint(s,i)}}if(3==this.viewStack.selectedIndex){this.roleSelect.clearRedPoint();for(var a=0;e>a;a++){var l=heroControl.getSubRoleByIndex(a).thunderForgeVos;if(l)for(var s=0;13>s;s++)if(l[s]&&DataCenter.ins().ThunderQuenBaseConfig.equipKong[s])for(var h=0;h<DataCenter.ins().ThunderQuenBaseConfig.equipKong[s].length;h++){var u=thunderControl.getConditionByKong(a,s,h);if(u){var p=thunderControl.getStrengthenEquipLevelConfig(a,s,h);if(p){var i=thunderControl.getCostByKong(p);i&&this.roleSelect.showRedPoint(a,i)}}}}}this.redPoint2.visible=SwitchMgr.ins().checkOpen(44)&&uitrasoneEquipControl.getRedPoint(),this.redPoint3.visible=thunderControl.checkSysOpen()&&thunderControl.getRedPoint()},e.prototype.getWinTabIndex=function(t){for(var e=0;e<this.winTabIndexs.length;e++)if(t==this.winTabIndexs[e])return e;return-1},e.prototype.delWinTabIndex=function(t){var e=this.getWinTabIndex(t);e>=0&&this.winTabIndexs.splice(e,1)},e.prototype.addWinTabIndex=function(t){var e=this.getWinTabIndex(t);return-1==e&&(this.winTabIndexs.push(t),this.winTabIndexs.sort(function(t,e){return t>e?1:-1}),e=this.getWinTabIndex(t)),e},e.prototype.checkPanel=function(){if(uitrasoneEquipControl.checkOpen()){if(!this.uitrasoneEquipPanel.parent){var t=this.addWinTabIndex(2);this.viewStack.addChildAt(this.uitrasoneEquipPanel,t),this.redGroup.addChildAt(this.redPoint2,t)}}else DisplayUtils.removeFromParent(this.uitrasoneEquipPanel),DisplayUtils.removeFromParent(this.redPoint2),this.delWinTabIndex(2);if(thunderControl.checkSysShow()){if(!this.equipUpPanel.parent){var t=this.addWinTabIndex(3);this.viewStack.addChildAt(this.equipUpPanel,t),this.redGroup.addChildAt(this.redPoint3,t)}}else DisplayUtils.removeFromParent(this.equipUpPanel),DisplayUtils.removeFromParent(this.redPoint3),this.delWinTabIndex(3);this.xunbaoPanel.name=LangMgr.getValueByKey("treasure"+(darkEquipControl.checkSysOpen()?3:4)),this.help&&(this.help.visible=!1)},e}(BaseEuiView);__reflect(DeityEquipView.prototype,"DeityEquipView");var ZealEquipPanel=function(t){function e(){var e=t.call(this)||this;return e._roleId=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.curIndex=0,this.getTreasureBtn.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.getTreasureBtn.text+"</u></a>"),this.getTreasureBtn.touchEnabled=!0,this.legendMc=new GameMovieClip,this.legendMc1=new GameMovieClip,this.legendMc2=new GameMovieClip,this.chargeEff1=new GameMovieClip,this.chargeEff1.x=this.getTreasureBtn.x+this.getTreasureBtn.width/2,this.chargeEff1.y=this.getTreasureBtn.y+this.getTreasureBtn.height/2,this.chargeEff1.touchEnabled=!1,this.chargeEff1.scaleY=.7,this.chargeEff1.scaleX=.9,this._weaponEffect=new GameMovieClip,this._bodyEffect=new GameMovieClip},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.legendMc.playFile(PATH_EFF+"artifacteff",-1),this.addChild(this.legendMc),this.legendMc1.playFile(PATH_EFF+"chuanqizbeff",-1),this.weaponEff.addChild(this.legendMc1),this.legendMc2.playFile(PATH_EFF+"chuanqizbeff",-1),this.armorEff.addChild(this.legendMc2),this.addEventTouchTap(this.getTreasureBtn,this.openSmeltView),this.addEventTouchTap(this.mixSwordBtn,this.onSelect),this.addEventTouchTap(this.mixArmorBtn,this.onSelect),this.addEventTouchTap(this.armorIcon,this.onSelect),this.addEventTouchTap(this.swordIcon,this.onSelect),this.addEventTouchTap(this.executeBtn,this.executeCB),this.addCustomEvent(119,this.mixCB),this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(352,this.updateSubRoleChange),TimerMgr.ins().doTimer(2e3,0,this.mcChange,this),this.setRoleId(t[0])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.getTreasureBtn,this.openSmeltView),this.removeEventTouchTap(this.mixSwordBtn,this.onSelect),this.removeEventTouchTap(this.mixArmorBtn,this.onSelect),this.removeEventTouchTap(this.armorIcon,this.onSelect),this.removeEventTouchTap(this.swordIcon,this.onSelect),this.removeEventTouchTap(this.executeBtn,this.executeCB),TimerMgr.ins().remove(this.mcChange,this),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.legendMc),DisplayUtils.removeFromParent(this.legendMc1),DisplayUtils.removeFromParent(this.legendMc2),DisplayUtils.removeFromParent(this._weaponEffect),DisplayUtils.removeFromParent(this._bodyEffect)},e.prototype.mcChange=function(){egret.Tween.removeTweens(this.bgMc);var t=egret.Tween.get(this.bgMc);t.to({alpha:0},1e3).to({alpha:1},1e3)},e.prototype.executeCB=function(t){return parseInt(this.cur.text)<parseInt(this.need.text.substr(1))?void tipsControl.showTips(LangMgr.getValueByKey("titleTips2")):void(this.executeBtn.label==LangMgr.getValueByKey("dressUpdate1")?this.grewup():this.executeBtn.label==LangMgr.getValueByKey("titleTips9")&&this.mix())},e.prototype.grewup=function(){var t=DataCenter.ins().ItemConfig[this.curEquipConfigId+1];return t.level>ActorControl.level||t.zsLevel>reincarnateControl.lv?void tipsControl.showTips(LangMgr.getValueByKey("titleTips3")):void equipControl.upGrewupEquip(this._roleId,this.curIndex)},e.prototype.grewupCB=function(t,e,i){return 0==e?void tipsControl.showTips(LangMgr.getValueByKey("titleTips4")):(tipsControl.showTips(LangMgr.getValueByKey("clanUpdata")),void this.updateView())},e.prototype.mix=function(){var t=equipControl.getEquipConfigIDByPosAndQualityByLegend(this._roleId,this.curIndex,5),e=DataCenter.ins().ItemConfig[t];e.level<=ActorControl.level&&e.zsLevel<=reincarnateControl.lv?equipControl.upMixEquip(this._roleId,this.curEquipConfigId,this.curIndex):tipsControl.showTips(LangMgr.getValueByKey("titleTips6"))},e.prototype.mixCB=function(t,e,i){return 0==e?void tipsControl.showTips(LangMgr.getValueByKey("titleTips7")):(tipsControl.showTips(LangMgr.getValueByKey("titleTips8")),void this.updateView())},e.prototype.openSmeltView=function(t){UIMgr.ins().open(BreakDownView,1,5)},e.prototype.onSelect=function(t){ActorControl.level;switch(t.currentTarget){case this.mixSwordBtn:case this.swordIcon:this.curIndex=0;break;case this.mixArmorBtn:case this.armorIcon:this.curIndex=2}this.updateView()},e.prototype.setRoleId=function(t){this._roleId=t;var e=heroControl.getSubRoleByIndex(this._roleId),i=e.getEquipByIndex(0),n=e.getEquipByIndex(2);i&&this.checkQuality(i)?this.curIndex=0:n&&this.checkQuality(n)&&(this.curIndex=2),this.updateView()},e.prototype.updateView=function(){this.updateAttrPanel(),this.updateIconAndDesc();var t=this.setRedPoint();t&&this.setEff()},e.prototype.setEff=function(){var t=backpackControl.getLegendOutEquips();t.length?(this.chargeEff1.playFile(PATH_EFF+"chargeff1",-1),this.chargeEff1.parent||this.getTreasureBtn.parent.addChild(this.chargeEff1)):DisplayUtils.removeFromParent(this.chargeEff1)},e.prototype.updateSubRoleChange=function(){var t=this.setRedPoint();t&&this.setEff()},e.prototype.checkQuality=function(t){var e=!1;return t&&t.item&&t.item.itemConfig&&(e=5==ItemUtils.getQuality(t.item.itemConfig)),e},e.prototype.updateAttrPanel=function(){var t=heroControl.getSubRoleByIndex(this._roleId).getEquipByIndex(this.curIndex),e=DataCenter.ins().ItemConfig[t.item.configID+1],i=0,n=0,o=ItemUtils.getQuality(t.item.itemConfig);if(void 0==e&&0!=t.item.handle&&5==o)this.mixAttributes.visible=!0,this.grewupAttributes.visible=!1,this.curEquipConfigId=this.updateMixPanel(),this.topLevel.visible=!0,this.costGroup.visible=!1,this.executeBtn.visible=!1,this.need.text="",this.cur.text="";else{if(void 0!=e&&0!=t.item.handle&&5==o){this.mixAttributes.visible=!1,this.grewupAttributes.visible=!0,this.curEquipConfigId=this.updateGrewupPanel(),this.executeBtn.label=LangMgr.getValueByKey("dressUpdate1");var s=DataCenter.ins().DeityEquipLevelupConfig[this.curEquipConfigId];i=s.count,n=s.itemId}else{if(this.mixAttributes.visible=!0,this.grewupAttributes.visible=!1,this.curEquipConfigId=this.updateMixPanel(),null==this.curEquipConfigId)return;this.executeBtn.label=LangMgr.getValueByKey("titleTips9");var r=DataCenter.ins().DeityEquipComposeConfig[this.curEquipConfigId];i=r.count,n=r.itemId}this.executeBtn.visible=!0,this.topLevel.visible=!1,this.costGroup.visible=!0;var a=backpackControl.getBagGoodsCountById(0,n);this.need.text="/"+i,this.cur.text=a+"",a>=i?this.cur.textColor=ColorUtils.GREEN:this.cur.textColor=ColorUtils.RED}},e.prototype.updateMixPanel=function(){var t=ActorControl.level;if(10>t)return void debug.log("error: 10 lv open");var e=equipControl.getEquipConfigIDByPosAndQualityByLegend(this._roleId,this.curIndex,5,1,!0),i=DataCenter.ins().EquipConfig[e];if(i){var n=[],o=[],s=[];for(var r in AttributeData.translate)!i[r]||i[r]<=0||(o.push(i[r]+""),n.push(AttributeData.getAttrStrByType(AttributeData.translate[r])),s.push(" +"+Math.floor(ItemBase.ADDITION_RANGE/100*i[r])));
return this.mixAttributes.baseAttr.text=ItemData.getStringByNextList(o,s),this.mixAttributes.nameAttr.text=ItemData.getStringByList(n),this.mixAttributes.randAttr.text="",this.mixAttributes.score.text=ItemUtils.pointCalNumber(DataCenter.ins().ItemConfig[e]),e}},e.prototype.updateGrewupPanel=function(){var t=heroControl.getSubRoleByIndex(this._roleId).getEquipByIndex(this.curIndex),e=t.item.configID,i=DataCenter.ins().ItemConfig[e],n=DataCenter.ins().ItemConfig[e+1];if(void 0==n);else{for(var o=1;4>=o;o++)this.grewupAttributes["arrow"+o].visible=!1;var s=[],r=[],a=[],l=[],h=[],u=DataCenter.ins().EquipConfig[e],p=DataCenter.ins().EquipConfig[e+1],c=t.item,d=1;for(var g in AttributeData.translate)if(u[g]&&!(u[g]<=0)){if(void 0!=c)for(var m=c.att,f=0;f<m.length;f++)if(m[f].type==AttributeData.translate[g]){a.push(" +"+m[f].value);break}this.grewupAttributes["arrow"+d].visible=!0,d++,r.push(u[g]+""),l.push(p[g]+""),h.push(" +"+Math.floor(ItemBase.ADDITION_RANGE/100*p[g])),s.push(AttributeData.getAttrStrByType(AttributeData.translate[g]))}this.grewupAttributes.curBaseAttr.text=ItemData.getStringByNextList(r,a),this.grewupAttributes.nextBaseAttr.text=ItemData.getStringByNextList(l,h),this.grewupAttributes.nameAttr.text=ItemData.getStringByList(s),this.grewupAttributes.curScore.text=LangMgr.getValueByKey("wingPingfen",ItemUtils.pointCalNumber(i)),this.grewupAttributes.nextScore.text=LangMgr.getValueByKey("wingPingfen",ItemUtils.pointCalNumber(n))}return e},e.prototype.updateIconAndDesc=function(){var t=heroControl.getSubRoleByIndex(this._roleId),i=t.getEquipByIndex(0),n=t.getEquipByIndex(2);0==this.curIndex?(this.swordSelect.visible=!0,this.armorSelect.visible=!1,this.zhanshi.source=null,this.currentState="jian",this.setWeaponEffect(i.item.configID,"wPos",t.sex,this.weaponEffect,this._weaponEffect),this._bodyEffect.parent&&this._bodyEffect.parent.removeChild(this._bodyEffect)):(this.swordSelect.visible=!1,this.armorSelect.visible=!0,this.zhanshi.source=e.armorImg[0],this.currentState="jia",this.setWeaponEffect(n.item.configID,"bPos",t.sex,this.bodyEffect,this._bodyEffect,2),this._weaponEffect.parent&&this._weaponEffect.parent.removeChild(this._weaponEffect)),this.updateItem(i,this.swordIcon,this.swordLevel,this.mixSwordBtn),this.updateItem(n,this.armorIcon,this.armorLevel,this.mixArmorBtn,2)},e.prototype.updateItem=function(t,e,i,n,o){var s=o?o:this.curIndex,r=DataCenter.ins().ItemConfig[equipControl.getEquipConfigIDByPosAndQualityByLegend(this._roleId,s,5)].name;if(0!=t.item.handle&&5==ItemUtils.getQuality(t.item.itemConfig)){var a=DataCenter.ins().ItemConfig[t.item.configID];n.visible=!1,i.text=a.name;for(var l=void 0,h=this.curEquipConfigId;h%100!=99&&(l=DataCenter.ins().ItemConfig[this.curEquipConfigId+1],void 0==l);h++);s==ItemUtils.getSubType(t.item.itemConfig)&&void 0!=l?i.x=n.x+15-i.width/2:i.x=n.x+15}else n.visible=!1,i.text=r,i.x=n.x+15},e.prototype.setRedPoint=function(){for(var t=!1,e=!1,i=0;2>i;i++)if(e=equipControl.setLegendEquipItemUpState(i>0?2:0,heroControl.getSubRoleByIndex(this._roleId)),e=equipControl.setLegendEquipItemState(i>0?2:0,heroControl.getSubRoleByIndex(this._roleId))||e,this["redPoint"+i]&&(this["redPoint"+i].visible=e),t||(t=e),!t){var n=backpackControl.getLegendOutEquips();t=n.length>0}return t},e.prototype.setWeaponEffect=function(t,i,n,o,s,r){void 0===r&&(r=0);var a=DataCenter.ins().EquipWithEffConfig[t+"_"+n],l=!1;a||(a=DataCenter.ins().EquipWithEffConfig[(0==r?e.swrodImg[1]:e.armorImg[1])+"_"+n],l=!0),s.scaleX=s.scaleY=a.scaling,s.x=this[i+n].x,s.y=this[i+n].y,s.parent||o.addChild(s),s.playFile(PATH_EFF+(l?a.inShowEff:a.nextShowEff),-1)},e.swrodImg=["chuanqi_0_png","101501"],e.armorImg=["chuanqi_1_png","121501"],e}(BasePanel);__reflect(ZealEquipPanel.prototype,"ZealEquipPanel");var DeityBreakDownItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.configID=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemIcon.imgJob.visible=!1},e.prototype.dataChanged=function(){var t=this.data.itemConfig;if(t.zsLevel>0?this.level.text=LangMgr.getValueByKey("numberRotation",t.zsLevel):this.level.text=t.level?"Lv."+t.level:"Lv.1",this.itemIcon.setData(t),this.equipName.text=""+t.name,this.equipName.textColor=ItemUtils.getQualityColor(t),9==ItemUtils.getType(t)){var e=bookControl.getDecomposeConfigByItemId(t.id),i=0;if(e)i=e.value;else{var n=DataCenter.ins().BookDecomposeConfig[67];n&&(i=n.value)}this.desc.text=LangMgr.getValueByKey("titleType10",i),this.tip.visible=!0,this.tip.x=this.equipName.x+this.equipName.width,this.level.text=""}else{var o=DataCenter.ins().EquipConfig[t.id];if(!o)return;var s=DataCenter.ins().ItemConfig[o.stoneId];if(!s)return;this.desc.text=s.name+" x "+o.stoneNum,this.desc.textColor=this.equipName.textColor;var r=ItemUtils.getSubType(t),a=equipControl.getEquipConfigIDByPosAndQuality(r,ItemUtils.getQuality(t)),l=DataCenter.ins().ItemConfig[a],h=t.zsLevel?t.zsLevel:0,u=l.zsLevel?l.zsLevel:0,p=t.level?t.level:0,c=l.level?l.level:0,d=1e4*h+p,g=1e4*u+c;g>d?reincarnateControl.lv>=u&&ActorControl.level>=c?this.tip.visible=!1:(this.tip.visible=!0,this.tip.x=this.equipName.x+this.equipName.width):this.tip.visible=!1}this.configID=this.data.handle},e}(BaseItemRender);__reflect(DeityBreakDownItemRenderer.prototype,"DeityBreakDownItemRenderer");var SpringBeginShopVo=function(){function t(){this.discount=0}return t}();__reflect(SpringBeginShopVo.prototype,"SpringBeginShopVo");var AmusementControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activityData={},e.doubleTwelveIDAry=[221,222,223,224],e.doubleTwelveData={},e.doubleTwelveRechargeIDAry=[225,226,227],e.doubleTwelveRechargeData={},e.palyEffList=[],e.rankInfoList=[],e.indexCurrDabiao=0,e.nextDayState=0,e.isSuccee=!1,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initZero=function(){if(this.activityData)for(var t in this.activityData){var e=+t;if(1e4>e){var i=DataCenter.ins().AmusementConfig[t];i&&this.upChangePage(e)}}},e.prototype.getAmusementDataById=function(t){return this.activityData[t]},e.prototype.getPalyEffListById=function(t){return this.palyEffList[t]},e.prototype.setPalyEffListById=function(t,e){this.palyEffList[t]=e},e.prototype.getrankInfoListByIndex=function(t){return this.rankInfoList[t]},e.prototype.dispatchFirstRedPoint=function(){},e.prototype.downActivityData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.activityData={};for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var o=AmusementDataFactory.init(t[i][n]);if(o){var s=o.id;-1!=this.doubleTwelveIDAry.indexOf(s)?this.doubleTwelveData[s]=o:-1!=this.doubleTwelveRechargeIDAry.indexOf(s)?this.doubleTwelveRechargeData[s]=o:this.activityData[s]=o}}this.dispatchActivityIsGetAwards(),AmusementDataFactory.createEx(),this.checkSpecials(),this.checkActivityTimer()},e.prototype.checkSpecials=function(){TimerMgr.ins().isExists(this.checkSpecials,this)&&TimerMgr.ins().remove(this.checkSpecials,this),this.dispatchSpecials();var t;for(var e in this.activityData)if(this.activityData[e]instanceof AmusementType2DataVo&&(t=this.activityData[e],!t.isSpecialOpen()&&t.getSpecialOpenLeftTime()))return void TimerMgr.ins().doTimer(1e3*t.getSpecialOpenLeftTime(),1,this.checkSpecials,this)},e.prototype.dispatchSpecials=function(){EventMgr.ins().dispatch(680)},e.prototype.dispatchActivityIsGetAwards=function(){EventMgr.ins().dispatch(392)},e.prototype.dispatchSetUserLzInfo=function(t){this.userLzInfo=t},e.prototype.downRewardResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var o=t[i][n];this.isSuccee=o[0];var s=o[1],r=null;return r=-1!=this.doubleTwelveRechargeIDAry.indexOf(s)?this.doubleTwelveRechargeData[s]:-1!=this.doubleTwelveIDAry.indexOf(s)?this.doubleTwelveData[s]:this.getAmusementDataById(s),r&&r.updateAmusement(o.slice(2)),this.dispatchActivityPanel(s),this.dispatchActivityIsGetAwards(),void EventMgr.ins().dispatch(393,s)}},e.prototype.dispatchActivityPanel=function(t){EventMgr.ins().dispatch(403,t)},e.prototype.dispatchHuntResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().dispatch(405,t)},e.prototype.upReward=function(t,e,i,n){if(!CommonFun.checkBackpackCount(1,1))return!1;var o=[t,e],s=DataCenter.ins().AmusementConfig[t];if(s)switch(s.activityType){case 2:o.push(i||0);break;case 9:e||o.push(i);break;case 11:o.push(i);break;case 12:1==i?(o.push(i),n&&o.push(n.toString())):2==i&&o.push(i);break;case 13:case 22:o.push(i),o.push(n.toString())}return o},e.prototype.downLianxuData=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getAmusementDataById(t);n.updateAmusementExt(e),this.dispatchActivityIsGetAwards()},e.prototype.upLianxuReward=function(t){return[t]},e.prototype.downRewardStatu=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.getAmusementDataById(t);n||(n=new AmusementType5DataVo,this.activityData[t]=n),n.updateAmusementExt(e),this.dispatchActivityIsGetAwards()},e.prototype.downChangePage=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i++)for(var n=0;n<t[i].length;n++){var o=AmusementDataFactory.init(t[i][n]);return o&&(-1!=this.doubleTwelveRechargeIDAry.indexOf(o.id)?this.doubleTwelveRechargeData[o.id]=o:-1!=this.doubleTwelveIDAry.indexOf(o.id)?this.doubleTwelveData[o.id]=o:this.activityData[o.id]=o),this.dispatchActivityIsGetAwards(),void EventMgr.ins().dispatch(395,o?o.id:0)}},e.prototype.upChangePage=function(t){return[t]},e.prototype.downDaBiaoInfo=function(t,e,i,n,o){this.isDaBiao=t,this.indexCurrDabiao=Math.max(e-1,0),13==i?this.myDabiaoInfo=[n[0],n[1]]:21==i?(this.myDabiaoInfo=n[0],this.myPaiming=n[1]):24==i?(this.myDabiaoInfo=n[0],this.myPaiming=n[1]):this.myDabiaoInfo=n[0],this.rankInfoList=[];for(var s=0;s<o.length;s++){var r=this.rankInfoList[s];r||(r=new AmusementRankData,this.rankInfoList.push(r)),r.init(o[s],i)}EventMgr.ins().dispatch(394)},e.prototype.downNextDayLoginData=function(t){this.nextDayState=t},e.prototype.downNextDayLoginReward=function(t){t&&(this.nextDayState=2,tipsControl.showTips(StringUtils.addColor(LangMgr.getValueByKey("pactivityGetGif"),15937822)))},e.prototype.upNextDayReward=function(){},e.prototype.upDabiaoInfo=function(t){return[t]},e.prototype.upGetSevenDayAwards=function(t){return[t]},e.prototype.downSevenDayData=function(t,e){this.dayNum=t,this.isAwards=e,this.dispatchSevendayIsAwards()},e.prototype.downChangeSevenDayData=function(t,e,i){t?(this.isAwards=i,this.dispatchSevendayAwardCallback()):tipsControl.showTips(LangMgr.getValueByKey("pactivityBag")),this.dispatchSevendayIsAwards()},e.prototype.dispatchSevendayAwardCallback=function(){EventMgr.ins().dispatch(404)},e.prototype.dispatchSevendayIsAwards=function(){EventMgr.ins().dispatch(396)},e.prototype.getSevenDayStast=function(){var t=DateUtils.DAYS_PER_WEEK;t=this.dayNum>14?14:this.dayNum;for(var e=1;t>=e;e++){var i=DataCenter.ins().SevenDayConfig[e];if(i&&this.dayNum>=i.day&&0==(this.isAwards>>i.day&1))return!0}return!1},e.prototype.checkNoticeRed=function(){var t=DataCenter.ins().WelfareConfig[4],e=amusementControl.getAmusementDataById(t.activityId?t.activityId:0);return e&&e.canReward()},e.prototype.getSevenDayLogIsVisible=function(){return 0==(this.isAwards>>14&1)},e.prototype.getbtnInfo=function(t){var e=DataCenter.ins().AmusementBtnConfig;return e[t]?e[t]:null},e.prototype.isShowRedPointByBtnInfo=function(t){var e=!1;return e=this.checkAcCanGet(t.id+"")},e.prototype.checkAcCanGet=function(t){var e=this.activityData;for(var i in e)if(i==t&&e[i]instanceof AmusementType2DataVo){var n=DataCenter.ins().Amusement2Config[i][1];if(n.limitTime){if(e[i].isSpecialOpen()&&e[i].canReward())return!0}else if(e[i].isOpenActivity()&&e[i].canReward())return!0;return!1}if(-1!=this.doubleTwelveIDAry.indexOf(Number(t)))for(var o in this.doubleTwelveData){if(o==t&&this.doubleTwelveData[o].isOpenActivity()&&9==this.doubleTwelveData[o].type)for(var s=0;3>s;s++)if(amusementControl.isGetRollReward(this.doubleTwelveData[o].id,s))return!0;return!1}for(var i in e)if(i==t&&e[i].isOpenActivity()&&e[i].canReward()&&e[i].specialState())return!0;return!1},e.prototype.checkOtherCharge2CanGet=function(){var t=payControl.getRechargeData(1),e=DataCenter.ins().Recharge2Config[t.day/7>=1?2:1][t.day%7];for(var i in e)if(0==(t.isAwards>>e[i].index&1)&&t.num>=e[i].pay)return!0;return!1},e.prototype.getisCangetDabiao3=function(t){var e=amusementControl.getAmusementDataById(t);return e.canOnlyReward?(e.canOnlyReward(),e.btn1||e.btn2):this.checkAcCanGet(t+"")},e.prototype.getisCanBuyXianGou=function(t){var e=!1,i=DataCenter.ins().Amusement2Config[t];if(i)for(var n=0;n<i.length&&!(e=this.getisCanBuyXianGouItem(t,n));n++);return e},e.prototype.getisCanBuyXianGouItem=function(t,e){var i=!1,n=amusementControl.activityData[t],o=DataCenter.ins().Amusement2Config[t];if(n&&o){var s=o[e],r=n.buyData[e]||0;if(s&&r){var a=1==s.currencyType?ActorControl.gold:ActorControl.yb,l=1==s.currencyType,h=parseInt(a+"")>=s.price,u=s.count-r>0;i=l&&h&&u}}return i},e.prototype.isDoubleElevenCanGet=function(){var t=this.activityData;for(var e in t)if(t[e]instanceof AmusementType2DataVo&&t[e].isSpecialOpen()&&t[e].canReward())return!0;return!1},e.prototype.IsHefuXunBaoTimer=function(){if(!GameServer._serverHeZeroTime)return!1;var t=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime),e=t+24*DataCenter.ins().TreasureEquipConfig.hefuDay*60*60*1e3,i=GameServer.serverTime;return i>=t&&e>=i},e.prototype.IsBossScoreTitle=function(t,e){var i=DataCenter.ins().Amusement7Config[t],n=amusementControl.getAmusementDataById(t);for(var o in i){var s=i[o];if(s.title==e&&this.getIsBuy(s)&&n.bossScore>=s.score)return!0}return!1},e.prototype.getIsBuy=function(t){if(t){var e=amusementControl.getAmusementDataById(t.Id);return t.count&&e.personalRewardsSum[t.index]>=t.count?!1:t.scount&&e.worldRewardsSum[t.index]>=t.scount?!1:!0}},e.prototype.getType7RedPoint=function(t){var e,n=DataCenter.ins().Amusement7Config[t],o=amusementControl.getAmusementDataById(t);if(n[1].showType==AmusementType7DataVo.TYPE_LABA)for(var s in n){var r=o.getExchange(n[s].index);if(r==i.CanGet)return!0}else for(var s in n)if(amusementControl.getIsBuy(n[s]))if(n[s].itemId){if(e=backpackControl.getBagItemById(n[s].itemId),e&&e.count>=n[s].itemCount)return!0}else if(o.bossScore>=n[s].score)return!0;return!1},e.prototype.getCurrentRingAwardIndex=function(t){var e=1;if(t>0)for(;0!=(t>>e&1);)e++;return e},e.prototype.getRingAward=function(t){for(var e in DataCenter.ins().Amusement8Config){var i=DataCenter.ins().Amusement8Config[e][1];if(i.showType==AmusementType8DataVo.TYPE_RING)for(var n in DataCenter.ins().Amusement8Config[e])if(n==t.toString())return DataCenter.ins().Amusement8Config[e][n]}return null},e.prototype.getLastRingAward=function(){var t;for(var e in DataCenter.ins().Amusement8Config){var i=DataCenter.ins().Amusement8Config[e][1];if(i.showType==AmusementType8DataVo.TYPE_RING)for(var n in DataCenter.ins().Amusement8Config[e])t=DataCenter.ins().Amusement8Config[e][n]}return t},e.prototype.addEvents=function(){EventMgr.addListener(353,this.openRingActivity,this)},e.prototype.removeEvent=function(){EventMgr.removeListener(353,this.openRingActivity,this)},e.prototype.openRingActivity=function(){0==MapControl.copyType&&(EventMgr.removeListener(353,this.openRingActivity,this),UIMgr.ins().open(AmusementTotalEnterView,201),amusementControl.upChangePage(201),amusementControl.upChangePage(204))},e.prototype.getType8RedPoint=function(t){var e=!1,i=amusementControl.activityData[t];return i&&0==i.record&&(e=!0),e},e.prototype.getType9RedPoint=function(t){var e=!1;amusementControl.activityData[t];if(this.getRollSum(t))e=!0;else{var i=DataCenter.ins().Amusement9Config[t];if(Assert(i,"ActivityType9Config is null!! activityId:"+t))return!1;for(var n in i[0].reward)if(this.isGetRollReward(t,+n)){e=!0;break}}return e},e.prototype.getType10RedPoint=function(t){var e=amusementControl.activityData[t],i=DataCenter.ins().Amusement10Config[t][e.getLevel()];return i?e.yb>=i.recharge&&ActorControl.yb>=i.yuanBao:!1},e.prototype.isGetRollReward=function(t,e){var i=amusementControl.activityData[t];i||(i=amusementControl.doubleTwelveData[t]);var n=DataCenter.ins().Amusement9Config[t];return n&&n[0]&&n[0].reward[e].times&&i.count>=n[0].reward[e].times&&!(i.record>>e+1&1)?!0:!1},e.prototype.getRollSum=function(t){var e=DataCenter.ins().Amusement9Config[t];if(e&&e[0]){var i=backpackControl.getBagItemById(e[0].item);if(i)return!0}return!1},e.prototype.getIsRollTen=function(t){var e=DataCenter.ins().Amusement9Config[t][0];if(e){var i=0;if(e.item){var n=backpackControl.getBagItemById(e.item);if(n&&(i+=n.count),i>=10)return!0}if(i=10-i,e.yb&&ActorControl.yb>=e.yb*i)return!0}return!1},e.prototype.downKuaFuRank=function(t,e,i){var n=amusementControl.getAmusementDataById(t);n&&n.CleanRandData();for(var o=0;o<e.length;o++){var s=new StrideServerDataVo;s.init(e[o]),n&&n.SetRankData(s)}n&&(n.mycost=i),EventMgr.ins().dispatch(397)},e.prototype.upKuaFuRank=function(t){return[t]},e.prototype.checkLabaBossData=function(){for(var t in amusementControl.activityData)if(7==amusementControl.activityData[t].pageType&&20==amusementControl.activityData[t].type&&amusementControl.getAmusementDataById(+t).isOpenActivity()){var e=amusementControl.activityData[t].id,i=amusementControl.getAmusementDataById(e);return i}return null},e.prototype.getConfig22_3=function(t){var e,i=DataCenter.ins().Amusement22_3Config[t];for(var n in i){e=i[n];for(var o in e)if(e[o].low<=reincarnateControl.lv&&reincarnateControl.lv<=e[o].high)return e[o]}return null},e.prototype.upEnvelopeData=function(t,e){return[t,e]},e.prototype.downEnvelopeData=function(t,e,i,n,o,s,r,a,l){if(e){var h=new EnvelopeData;return h.id=t,h.eId=i,h.job=n,h.sex=o,h.index=s,h.serverId=r,h.name=a,h.desc=l,void this.dispatchEnvelopeDataCall(h)}this.dispatchEnvelopeDataCall(null)},e.prototype.dispatchEnvelopeDataCall=function(t){EventMgr.ins().dispatch(398,t)},e.prototype.downRedEnvelopeData=function(t,e,i){if(this.activityData[t]&&this.activityData[t]instanceof AmusementType12DataVo){var n=this.activityData[t];if(1==e){if(i.length){var o=new RedEnvelope;o.init(i[0]),n.envelopeData.push(o)}}else{for(var s=[],r=0;r<i.length;r++){var o=new RedEnvelope;o.init(i[r]),s.push(o)}n.envelopeData=s}}EventMgr.ins().dispatch(399)},e.prototype.checkActivityTimer=function(){for(var t in this.activityData)if(this.activityData[t]instanceof AmusementType12DataVo){TimerMgr.ins().isExists(this.ActivityTimerSecond1,this)||TimerMgr.ins().doTimer(1e3,0,this.ActivityTimerSecond1,this);break}},e.prototype.dispatchGetRedEnvelope=function(t,e,i,n,o){EventMgr.ins().dispatch(402,[t,e,i,n,o])},e.prototype.ActivityTimerSecond1=function(){for(var t=0;t<this._actTimeSecond1.length;){var e=this._actTimeSecond1[t];if(this.activityData[e]){if(!this.activityData[e].isOpenActivity()){if(this.activityData[e]instanceof AmusementType12DataVo){var i=this.activityData[e];i.clearAll()}this._actTimeSecond1.splice(t,1);continue}if(this.activityData[e]instanceof AmusementType12DataVo){var i=this.activityData[e];i.checkClear()}}t++}},Object.defineProperty(e.prototype,"activityTimers",{get:function(){return this._actTimeSecond1=this._actTimeSecond1?this._actTimeSecond1:[],this._actTimeSecond1},enumerable:!0,configurable:!0}),e.prototype.downRedPackets=function(t,e){this._redPackets||(this._redPackets={}),this._redPackets[t]=[];for(var i=0;e.length>i;i++){var n=new RedPacketVo;n.init(e[i]),this._redPackets[t][n.id-1]=n}EventMgr.ins().dispatch(400,t)},e.prototype.downRoleRedPacket=function(t,e){this._roleRedPacket||(this._roleRedPacket={}),this._roleRedPacket[t]=e,EventMgr.ins().dispatch(401,t)},e.prototype.upRedPacketRecord=function(t,e){return[t,e]},e.prototype.downRedPacketRecord=function(t,e,i,n,o,s){for(var r={type:i,id:n,count:o},a=[],l=0;s.length>l;l++){var h=new RedPacketRecordVo;h.init(s[l]),a.push(h)}a.sort(this.sortRecord),this._isOpenRedPacket||(this._isOpenRedPacket={},this._isOpenRedPacket[t]=!1),UIMgr.ins().open(RedPacketDetailView,{actID:t,idx:e,myInfo:r,records:a},this._isOpenRedPacket[t]),this._isOpenRedPacket[t]=!1},e.prototype.sortRecord=function(t,e){return t.isPrecious?-1:e.isPrecious?1:t.isPrecious&&e.isPrecious?0:t.time>e.time?-1:e.time>t.time?1:0},e.prototype.upOpenRedPacket=function(t){return this._isOpenRedPacket||(this._isOpenRedPacket={}),this._isOpenRedPacket[t]=!0,[t]},e.prototype.getRedPacket=function(t,e){if(!this._redPackets||!this._redPackets[t])return null;var i=this._redPackets[t];return e>i[i.length-1].id?null:i[e-1]},e.prototype.checkRedPacketRed=function(t){if(!this._redPackets||!this._redPackets[t]||!this._roleRedPacket)return!1;var e=this._redPackets[t].length,i=this._roleRedPacket[t];return e>0&&(void 0==i||i<this._redPackets[t][e-1].id)?!0:!1},e.prototype.getRedPacketsByID=function(t){return this._redPackets&&this._redPackets[t]?this._redPackets[t].concat():null},e.prototype.getOpenedNum=function(t){return this._roleRedPacket?this._roleRedPacket[t]:0},e.prototype.dispatchActivityTips=function(){if(MapControl.sceneInHook()||toseongControl.isToseong){var t=DataCenter.ins().ClientGlobalConfig.activityTips;if(t)for(var e=0;e<t.length;e++)if(SwitchMgr.ins().checkOpen(t[e].openId)&&!ClientStorage.ins().getBool(t[e].skinName))for(var i=0;i<t[e].id.length;i++){var n=t[e].id[i],o=amusementControl.getAmusementDataById(n);if(o&&o.isOpenActivity())return UIMgr.ins().open(AmusementTipsView,t[e].skinName,t[e].ruleId),void ClientStorage.ins().setBool(t[e].skinName,!0)}}},e.prototype.resetActivityTips=function(){var t=DataCenter.ins().ClientGlobalConfig.activityTips;if(t)for(var e=0;e<t.length;e++)ClientStorage.ins().setBool(t[e].skinName,!1)},e.prototype.getNeedRecharge=function(t){var e=this.doubleTwelveRechargeData[t],i=DataCenter.ins().Amusement3Config[t][1];return Math.max(0,i.val-e.chongzhiTotal)},e.NotReached=0,e.CanGet=1,e.Geted=2,e.NOKILL=0,e.KILL=1,__decorate([down(1,[ByteConst.AmusementType1Inits,ByteConst.AmusementType2Inits,ByteConst.AmusementType3Inits,ByteConst.AmusementType4Inits,ByteConst.AmusementType5Inits,ByteConst.AmusementType6Inits,ByteConst.AmusementType7Inits,ByteConst.AmusementType8Inits,ByteConst.AmusementType9Inits,ByteConst.AmusementType10Inits,ByteConst.AmusementType11Inits,ByteConst.AmusementType12Inits,ByteConst.AmusementType13Inits,[],[],ByteConst.AmusementType16Inits,[],ByteConst.AmusementType18Inits,ByteConst.AmusementType19Inits,ByteConst.AmusementType20Inits,ByteConst.AmusementType21Inits,ByteConst.AmusementType22Inits,[],[],ByteConst.AmusementType25Inits,ByteConst.AmusementType26Inits].concat(ByteConst.AmusementCovers,[ByteConst.AmusementType100Inits,[],ByteConst.AmusementType102Inits,ByteConst.AmusementType103Inits]))],e.prototype,"downActivityData",null),__decorate([down(2,[ByteConst.AmusementType1Updates,ByteConst.AmusementType2Updates,ByteConst.AmusementType3Updates,ByteConst.AmusementType4Updates,ByteConst.AmusementType5Updates,ByteConst.AmusementType6Updates,ByteConst.AmusementType7Updates,ByteConst.AmusementType8Updates,ByteConst.AmusementType9Updates,ByteConst.AmusementType10Updates,ByteConst.AmusementType11Updates,ByteConst.AmusementType12Updates,ByteConst.AmusementType13Updates,[],[],ByteConst.AmusementType16Updates,[],ByteConst.AmusementType18Updates,ByteConst.AmusementType19Updates,ByteConst.AmusementType20Updates,ByteConst.AmusementType21Updates,ByteConst.AmusementType22Updates,[],[],ByteConst.AmusementType25Updates,ByteConst.AmusementType26Updates].concat(ByteConst.AmusementCovers,[ByteConst.AmusementType100Updates,[],ByteConst.AmusementType102Updates,ByteConst.AmusementType103Updates]))],e.prototype,"downRewardResult",null),__decorate([up(2,[3,2,2,8])],e.prototype,"upReward",null),__decorate([down(13,[3,[2],3,3])],e.prototype,"downLianxuData",null),__decorate([up(13,[3])],e.prototype,"upLianxuReward",null),__decorate([down(5,[3,3])],e.prototype,"downRewardStatu",null),__decorate([down(7,[ByteConst.AmusementType1Inits,ByteConst.AmusementType2Inits,ByteConst.AmusementType3Inits,ByteConst.AmusementType4Inits,ByteConst.AmusementType5Inits,ByteConst.AmusementType6Inits,ByteConst.AmusementType7Inits,ByteConst.AmusementType8Inits,ByteConst.AmusementType9Inits,ByteConst.AmusementType10Inits,ByteConst.AmusementType11Inits,ByteConst.AmusementType12Inits,ByteConst.AmusementType13Inits,[],[],ByteConst.AmusementType16Inits,[],ByteConst.AmusementType18Inits,ByteConst.AmusementType19Inits,ByteConst.AmusementType20Inits,ByteConst.AmusementType21Inits,ByteConst.AmusementType22Inits,[],[],ByteConst.AmusementType25Inits,ByteConst.AmusementType26Inits].concat(ByteConst.AmusementCovers,[ByteConst.AmusementType100Inits,[],ByteConst.AmusementType102Inits,ByteConst.AmusementType103Inits]))],e.prototype,"downChangePage",null),__decorate([up(7,[3])],e.prototype,"upChangePage",null),__decorate([down(3,[0,3,2,[10],ByteConst.RankDataCommons])],e.prototype,"downDaBiaoInfo",null),__decorate([down(21,[2])],e.prototype,"downNextDayLoginData",null),__decorate([down(20,[2])],e.prototype,"downNextDayLoginReward",null),__decorate([up(20)],e.prototype,"upNextDayReward",null),__decorate([up(3,[3])],e.prototype,"upDabiaoInfo",null),__decorate([up(12,[2])],e.prototype,"upGetSevenDayAwards",null),__decorate([down(11,[2,3])],e.prototype,"downSevenDayData",null),__decorate([down(12,[0,2,3])],e.prototype,"downChangeSevenDayData",null),__decorate([down(22,[3,ByteConst.StrideServerDataVos,3])],e.prototype,"downKuaFuRank",null),__decorate([up(22,[3])],e.prototype,"upKuaFuRank",null),__decorate([up(6,[3,5])],e.prototype,"upEnvelopeData",null),__decorate([down(6,[3,1,5,2,2,2,3,8,8])],e.prototype,"downEnvelopeData",null),__decorate([down(8,[3,2,ByteConst.RedEnvelopes])],e.prototype,"downRedEnvelopeData",null),__decorate([down(23,[3,ByteConst.RedPacketVos])],e.prototype,"downRedPackets",null),__decorate([down(24,[3,3])],e.prototype,"downRoleRedPacket",null),__decorate([up(25,[3,3])],e.prototype,"upRedPacketRecord",null),__decorate([down(25,[3,3,1,3,3,ByteConst.RedPacketRecordVos])],e.prototype,"downRedPacketRecord",null),__decorate([up(26,[3])],e.prototype,"upOpenRedPacket",null),e=i=__decorate([protocolsId(25)],e);var i}(BaseSystem);__reflect(AmusementControl.prototype,"AmusementControl");var AmusementRankData=function(){function t(){}return t.prototype.init=function(t,e){this.rankIndex=t[0],this.id=t[1],this.name=t[2],this.level=t[3],this.zsLevel=t[4],this.vipLv=t[5],this.monthCard=t[6];var i=t[7];i.length>0&&(13==e?this.numType=[i[0],i[1]]:this.numType=i[0])},t}();__reflect(AmusementRankData.prototype,"AmusementRankData");var WeaponSoulItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.slot=0},e.prototype.dataChanged=function(){if(this.data){var t;this.black.visible=!1,this.data instanceof WeaponsSoulInfoVo?(t=this.data,this.itemIcon.setActived(!0)):(t=this.data,this.black.visible=!0),this.slot=t.id;var e=DataCenter.ins().WeaponSoulPosConfig[t.id][0];this.itemIcon.imgIcon.source=e.icon+"_png",this.lv.text=(isNaN(t.level)?e.level:t.level)+"",this.nameTxt.text=e.name;var i=DataCenter.ins().WeaponSoulPosConfig[t.id][Number(this.lv.text)+1];if(t.costNum&&i){var n=backpackControl.getBagItemById(t.costItem),o=n?n.count:0;this.redPoint.visible=o>=t.costNum?!0:!1}else this.redPoint.visible=!1}},e.prototype.destruct=function(){},e.prototype.clear=function(){},e}(BaseItemRender);__reflect(WeaponSoulItemRender.prototype,"WeaponSoulItemRender");var DevourEquipInfoVo=function(){function t(){this.pos=0,this.lv=0,this.soul=0,this.stone=0,this.maxsoule=0}return t.prototype.setInfo=function(t,e,i){this.lv=t,this.soul=e,this.stone=i,this.maxsoule=DataCenter.ins().DevourEquipLevelConfig[this.pos][this.lv].soulMax+DataCenter.ins().DevourEquipDataConfig.stoneAddSoul*this.stone},t}();__reflect(DevourEquipInfoVo.prototype,"DevourEquipInfoVo");var DevourEquipItemDataVo=function(){function t(){this.items={},this.roledata=[],this.thirteenequips=[]}return t.prototype.getDevourInfo=function(t,e){return this.items[t]&&this.items[t][e]?this.items[t][e]:null},t}();__reflect(DevourEquipItemDataVo.prototype,"DevourEquipItemDataVo");var DevourEquipSoulInfoVo=function(){function t(){this.bossid=0,this.role=0,this.pos=0,this.time=0}return t.prototype.setInfo=function(t){this.bossid=t[0],this.role=t[1],this.pos=t[2],this.time=t[3]},t}();__reflect(DevourEquipSoulInfoVo.prototype,"DevourEquipSoulInfoVo");var DevourEquipAttrTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipAttrTipsViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t,e){this.addEventTouchTap(this,this.onTap),this.updateView(t,e)},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(t,e){var i=DevourEquipContorl.ins(),n=i.getRoleDevourInfo(t,e),o=n.lv?n.lv:1,s=DataCenter.ins().DevourEquipLevelConfig[e][o],r=[],a=[],l=[],h=0,u=0;if(n.lv){r=s.attr,a=s.specialAttr;for(var p in s.attr){var c=s.attr[p],d=i.getSoulValue(e,n.soul,parseInt(p));d&&l.push({type:c.type,value:d})}h=n.soul,u=n.maxsoule}else{for(var p in s.attr){var c=s.attr[p];r[p]={type:c.type,value:0}}for(var g in s.specialAttr){var m=s.specialAttr[g];a[g]={type:m.pos,prop:0}}u=s.soulMax}for(var f=0;f<DevourEquipPanel.EQUIPORI;f++)DisplayUtils.removeFromParent(this["basicAttr"+f]),r[f]&&(this.basicAttr.addChild(this["basicAttr"+f]),this["basicAttr"+f].text=AttributeData.getAttrStrByType(r[f].type)+"+"+r[f].value);for(var v=-1,f=DevourEquipPanel.EQUIPORI;7>f;f++)if(v++,DisplayUtils.removeFromParent(this["basicAttr"+f]),a[v]){this.basicAttr.addChild(this["basicAttr"+f]);var y=LangMgr.getValueByKey("equipPosName"+e);switch(v){case 0:this["basicAttr"+f].text=LangMgr.getValueByKey("tunshizhizhunEquipAtt",y);break;case 1:this["basicAttr"+f].text=LangMgr.getValueByKey("tunshileitingEquipAtt",y);break;case 2:this["basicAttr"+f].text=LangMgr.getValueByKey("tunshichuanqiEquipAtt",y)}this["basicAttr"+f].text+="+"+a[v].prop/100+"%"}for(var f=0;4>f;f++)DisplayUtils.removeFromParent(this["growthAttr"+f]),l[f]&&(this.growthAttrGroup.addChild(this["growthAttr"+f]),this["growthAttr"+f].text=AttributeData.getAttrStrByType(l[f].type)+"+"+l[f].value);if(this.devourMc||(this.devourMc=new GameMovieClip),this.devourMc.parent||this.devourEff.addChild(this.devourMc),this.devourMc.playFile(PATH_EFF+s.devourRes,-1),n.lv){var C=AttributeData.AttrAddition(l,s.attr),T=Math.floor(BackpackControl.getAttrPower(C));T+=i.calAttrPower(heroControl.getSubRoleByIndex(t),reincarnateStarEquipControl.getZhuHunlvById(t),e,o),this.powerPanel.setPower(T)}else this.powerPanel.setPower(0);this.progress.updatePro(h,u);var w=DataCenter.ins().DevourEquipDataConfig;this.equipName.text=w.equipIconInfo[e][0],this.equiplvl.text=w.leevel[o]},e}(BaseEuiView);__reflect(DevourEquipAttrTipsView.prototype,"DevourEquipAttrTipsView");var DevourEquipFusionView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipFusionViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t,e){this.addEventTouchTap(this,this.onTap),this.updateView(t,e)},e.prototype.onTap=function(t){switch(t.target){case this.itemImg:UIMgr.ins().close(this),UIMgr.ins().open(ItemTipsView,0,DataCenter.ins().DevourEquipDataConfig.stoneId,0);break;default:UIMgr.ins().close(this)}},e.prototype.updateView=function(t,e){var i=DevourEquipContorl.ins(),n=i.getRoleDevourInfo(t,e),o=DataCenter.ins().DevourEquipLevelConfig[e][n.lv],s=n.stone,r=n.stone+1,a=s*DataCenter.ins().DevourEquipDataConfig.stoneAddSoul,l=r*DataCenter.ins().DevourEquipDataConfig.stoneAddSoul,h=DataCenter.ins().DevourEquipDataConfig.stoneMax[e];this.maxNext.text=""+l,this.upVal.text=""+DataCenter.ins().DevourEquipDataConfig.stoneAddSoul;
var u=[],p=DataCenter.ins().DevourEquipDataConfig.stoneAttr;for(var c in p)u.push({type:p[c].type,value:p[c].value*s});if(this.attrs.text=AttributeData.getAttStr(u,0,1,"："),s){h>s?this.max.visible=!1:(this.max.visible=!0,this.maxNext.text="MAX",this.upVal.text=""),this.lvl.text=""+s;var d=Math.floor(BackpackControl.getAttrPower(u));this.powerPanel.setPower(d)}else this.max.visible=!1,this.lvl.text="0",this.maxNext.text=""+l,this.powerPanel.setPower(0);this.cost.visible=!this.max.visible,this.maxlvl.text=""+h,this.maxNow.text=""+a,this.itemImg.source=DataCenter.ins().DevourEquipDataConfig.stoneId+"_png",this.devourMc||(this.devourMc=new GameMovieClip),this.devourMc.parent||this.effGroup.addChild(this.devourMc),this.devourMc.playFile(PATH_EFF+o.devourRes,-1)},e}(BaseEuiView);__reflect(DevourEquipFusionView.prototype,"DevourEquipFusionView");var DevourEquipPanel=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e._curPos=0,e.pos=[],e.listWidth=0,e.costid=0,e.oriscale=0,e.skinName="DevourEquipPanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.effY=this.equipEff.verticalCenter,this.effMoveY=this.effY-10,this.equipEff.touchEnabled=!1},e.prototype.open=function(t,e,i){this._curRole=t,this._curPos=e?e:this._curPos,this.addEventTouchTap(this.suitBtn,this.onTouch),this.addEventTouchTap(this.checkBoxs,this.onTouch),this.addEventTouchTap(this.skillBtn,this.onTouch),this.addEventTouchTap(this.updateBtn,this.onTouch),this.addEventTouchTap(this.touch,this.onTouch),this.addEventTouchTap(this.icon0,this.onTouch),this.addEventTouchTap(this.fusion,this.onTouch);for(var n=0;8>n;n++)this["devourEquip"+n]&&this.addEventTouchTap(this["devourEquip"+n],this.onTouch);this.addCustomEvent(713,this.updataView),this.addCustomEvent(711,this.updataCheck),this.listWidth=726,this.updataView(),this.playUpTween(),i&&this.showRotation()},e.prototype.close=function(){this.stopTween(),this.stopRotation()},e.prototype.updataView=function(){DevourEquipContorl.ins().selectRole=this._curRole,this.updatePos();for(var t=0;7>=t;t++)if(this["devourEquip"+t]){var e=DevourEquipContorl.ins().getRoleDevourInfo(this._curRole,t);this["devourEquip"+t].data={equip:e,rp:DevourEquipContorl.ins().canActPosNotips(this._curRole,t,e.lv+1)||DevourEquipContorl.ins().canSendStone(e)}}this.update(this._curRole,this._curPos)},e.prototype.updatePos=function(){var t=DevourEquipContorl.ins().getRoleDevourInfo(this._curRole,this._curPos),e=DevourEquipContorl.ins().canActPosNotips(this._curRole,this._curPos,t.lv+1);if(!e)for(var i=DevourEquipContorl.ins().positions,n=0;n<i.length;n++)if(t=DevourEquipContorl.ins().getRoleDevourInfo(this._curRole,n),e=DevourEquipContorl.ins().canActPosNotips(this._curRole,n,t.lv+1)){this._curPos=n;break}},e.prototype.update=function(t,i){if(t==this._curRole){var n=DevourEquipContorl.ins(),o=n.getRoleDevourInfo(t,i),s=o.lv?o.lv:1,r=1,a=DataCenter.ins().DevourEquipLevelConfig[i][s],l=DataCenter.ins().DevourEquipLevelConfig[i][s+1],h=[],u=[],p=[],c=[],d=[],g=[],m=0,f=0,v=a.soulMax;if(o.lv)if(l){this.updateBtn.label=LangMgr.getValueByKey("tunshiEquipUpLv"),this.costGroup.visible=this.attr.visible=this.updateBtn.visible=!0,this.fusionGroup.visible=0!=DataCenter.ins().DevourEquipDataConfig.maxUp,f=o.soul,v=o.maxsoule,h=a.attr,u=l.attr,p=a.specialAttr,c=l.specialAttr;for(var y in a.attr){var C=a.attr[y],T=n.getSoulValue(i,o.soul,parseInt(y));d[y]={type:C.type,value:T}}for(var y in l.attr){var C=l.attr[y],T=n.getSoulValue(i,o.soul,parseInt(y));g[y]={type:C.type,value:T}}this.costid=l.ItemId,m=l.value,r=l.level}else{this.costGroup.visible=this.updateBtn.visible=!1,this.fusionGroup.visible=0!=DataCenter.ins().DevourEquipDataConfig.maxUp,f=o.soul,v=o.maxsoule,h=a.attr,p=a.specialAttr;for(var w in a.attr){var C=a.attr[w],T=n.getSoulValue(i,o.soul,parseInt(w));d[w]={type:C.type,value:T}}this.costid=a.ItemId,m=a.value,r=a.level}else{this.updateBtn.label=LangMgr.getValueByKey("tunshiEquipJihuo"),this.costGroup.visible=this.attr.visible=this.updateBtn.visible=!0,this.fusionGroup.visible=!1;for(var w in a.attr){var C=a.attr[w];h[w]={type:C.type,value:0},d[w]={type:C.type,value:0};var T=n.getSoulValue(i,0,parseInt(w));g[w]={type:C.type,value:T}}for(var w in a.specialAttr){var C=a.specialAttr[w];p[w]={type:C.pos,prop:0}}u=a.attr,c=a.specialAttr,this.costid=a.ItemId,m=a.value}this.lvlmax.visible=!this.updateBtn.visible,this.redPoint.visible=this.updateBtn.visible&&n.canActPosNotips(t,i,l.level);for(var w=0;w<e.EQUIPORI;w++)DisplayUtils.removeFromParent(this["attrGroup"+w]),h[w]&&(this.attr0.addChild(this["attrGroup"+w]),this["attr"+w+"Name"].text=AttributeData.getAttrStrByType(h[w].type),this["attr"+w+"Basic"].text=h[w].value+"",this["attr"+w+"Extra"].text="+"+d[w].value,u.length>0?(this["arrow"+w]&&(this["arrow"+w].visible=!0),this["addAttr"+w+"Basic"]&&(this["addAttr"+w+"Basic"].visible=!0,this["addAttr"+w+"Basic"].text=u[w].value+"")):(this["arrow"+w].visible=!1,this["addAttr"+w+"Basic"].visible=!1));for(var I=-1,w=e.EQUIPORI;7>w;w++)if(I++,DisplayUtils.removeFromParent(this["attrGroup"+w]),p[I]){this.attr1.addChild(this["attrGroup"+w]);var b=LangMgr.getValueByKey("equipPosName"+i);0==I?this["attr"+w+"Name"].text=LangMgr.getValueByKey("tunshizhizhunEquipAtt",b):1==I?this["attr"+w+"Name"].text=LangMgr.getValueByKey("tunshileitingEquipAtt",b):2==I&&(this["attr"+w+"Name"].text=LangMgr.getValueByKey("tunshichuanqiEquipAtt",b)),this["attr"+w+"Basic"].text="+"+p[I].prop/100+"%",c[I]?(this["arrow"+w].visible=!0,this["addAttr"+w+"Basic"].visible=!0,this["addAttr"+w+"Basic"].text="+"+c[I].prop/100+"%"):(this["arrow"+w].visible=!1,this["addAttr"+w+"Basic"].visible=!1)}for(var w=DevourEquipPosType.zhizun;w<=DevourEquipPosType.chuanqi;w++){DisplayUtils.removeFromParent(this["equip"+w]);var D=n.getEquipLV(t,i,w);this.upItem1.addChild(this["equip"+w]),this["equip"+w].data={type:w,role:t,pos:i,curlv:r,lv:D}}if(this.costGroup.visible){var B=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,this.costid);B||(B=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_EQUIP,this.costid));var k=DataCenter.ins().ItemConfig[this.costid];this.icon0.source=k.icon+"_png",this.countLabel0.textFlow=TextUtils.generateTextFlow1("|C:"+(B>=m?3205133:16195081)+"&T:"+B+"/"+m+"|")}if(this.equipMc||(this.equipMc=new GameMovieClip),this.equipMc.parent||this.equipEff.addChild(this.equipMc),this.equipMc.playFile(PATH_EFF+a.devourRes,-1),o.lv){var x=AttributeData.AttrAddition(d,a.attr);if(o.stone){var R=[],E=DataCenter.ins().DevourEquipDataConfig.stoneAttr;for(var w in E)R.push({type:E[w].type,value:E[w].value*o.stone});x=AttributeData.AttrAddition(x,R)}var _=Math.floor(BackpackControl.getAttrPower(x));_+=n.calAttrPower(heroControl.getSubRoleByIndex(t),reincarnateStarEquipControl.getZhuHunlvById(t),i,s),this.powerPanel.setPower(_)}else this.powerPanel.setPower(0);this.updateEquipUps();var S=DataCenter.ins().DevourEquipDataConfig.canHuanhuaPos;if(this.checkImg.visible=this.checkBoxs.visible=S.indexOf(this._curPos)>-1,this.progress.updatePro(f,v),this.updataCheck(),this.fusionGroup.visible){var M=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().DevourEquipDataConfig.stoneId);this.redPoint1.visible=o.stone<DataCenter.ins().DevourEquipDataConfig.stoneMax[i]&&!!M,this.fusionlvl.visible=!!o.stone,this.fusionlvl.text=""+o.stone}}},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.updateBtn:DevourEquipContorl.ins().sendToUpgrade(this._curRole,this._curPos);break;case this.suitBtn:UIMgr.ins().open(DevourEquipSuitSkillView,DevourEquipContorl.ins().getRoleDevourAllInfo(this._curRole),DevourEquipContorl.ins().getRoleBase());break;case this.skillBtn:UIMgr.ins().open(DevourEquipSkillView);break;case this.touch:UIMgr.ins().open(DevourEquipAttrTipsView,this._curRole,this._curPos);break;case this.icon0:this.costid&&UIMgr.ins().open(DevourEquipTipsView,this.costid);break;case this.checkBoxs:if(LangMgr.getValueByKey("tunshiEquipJihuo")==this.updateBtn.label&&!this.lvlmax.visible)return tipsControl.showTips(LangMgr.getValueByKey("tunshiEquipnoJihuo")),this.checkBoxs.selected=!1;DevourEquipContorl.ins().upWearSuit(this.checkBoxs.selected?1:0,this._curRole,this._curPos);break;case this.fusion:this.redPoint1.visible?DevourEquipContorl.ins().upStone(this._curRole,this._curPos):UIMgr.ins().open(DevourEquipFusionView,this._curRole,this._curPos);break;default:for(var e=0;7>=e;e++)this["devourEquip"+e]&&t.currentTarget==this["devourEquip"+e]&&(this._curPos=e,this.update(this._curRole,this._curPos))}},e.prototype.updateEquipUps=function(){for(var t=DevourEquipContorl.ins().positions,e=0;e<t.length;e++){var i=this["devourEquip"+e];i&&(this._curPos==e?i.setSelect():i.setUnSelect())}},e.prototype.updataCheck=function(){if(this.checkBoxs.visible){var t=heroControl.getSubRoleByIndex(this._curRole),e=this._curPos==DevourEquipHuanHuaPos.weapon?6==t.weaponViewType:6==t.clothesViewType;this.checkBoxs.selected=e}},e.prototype.playUpTween=function(){this.equipEff&&(this.equipEff.verticalCenter=this.effY,egret.Tween.removeTweens(this.equipEff),egret.Tween.get(this.equipEff,{loop:!0}).to({verticalCenter:this.effMoveY},1e3).to({verticalCenter:this.effY},1e3))},e.prototype.stopTween=function(){egret.Tween.removeTweens(this.equipEff)},e.prototype.showRotation=function(){var t=this;this.showBg();for(var e=0;8>e;e++){var i=this["devourEquip"+e];i&&(this.pos.push({x:i.x,y:i.y}),i.x=200,i.y=150,i.scaleX=i.scaleY=0)}this.equipEff.visible=!1,this.oriscale=this.bg.scaleX,this.bg.scaleX=this.bg.scaleY=0,egret.Tween.get(this.bg).to({rotation:720,scaleX:this.oriscale,scaleY:this.oriscale},1500,egret.Ease.cubicInOut).call(function(){for(var e=0;8>e;e++)t["devourEquip"+e]&&egret.Tween.get(t["devourEquip"+e]).to({x:t.pos[e].x,y:t.pos[e].y,scaleX:1,scaleY:1},300);t.equipEff.visible=!0})},e.prototype.stopRotation=function(){egret.Tween.removeTweens(this.bg);for(var t=0;8>t;t++){var e=this["devourEquip"+t];e&&this.pos[t]&&(e.x=this.pos[t].x,e.y=this.pos[t].y,e.scaleX=1,e.scaleY=1,egret.Tween.removeTweens(e))}this.equipEff.visible=!0,this.bg.scaleX=this.bg.scaleY=this.oriscale?this.oriscale:this.bg.scaleX,this.pos=[],this.oriscale=0,this.bg.rotation=0},e.prototype.showBg=function(){this.bgMc||(this.bgMc=new GameMovieClip,this.bg.addChild(this.bgMc)),this.bgMc.playFile(PATH_EFF+"tunshi_bg",-1)},e.EQUIPORI=4,e}(BasePanel);__reflect(DevourEquipPanel.prototype,"DevourEquipPanel");var DevourEquipRefiningPanel=function(t){function e(){var e=t.call(this)||this;return e._isOpen=!1,e._curSelected=0,e.proadd=0,e.procount=0,e.skinName="DevourEquipRefiningPanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this._isOpen=!0,this.bossList.itemRenderer=DevourEquipBossItemRender,this.bossCol=new eui.ArrayCollection,this.bossList.dataProvider=this.bossCol,this.effY=this.equipEff.verticalCenter,this.effMoveY=this.effY-10,this.addCustomEvent(714,this.checkShowEff),this.addCustomEvent(712,this.update),this.addEventTouchTap(this.btnFinish,this.onTouch),this.addEventTouchTap(this.devourDoubleBtn,this.onTouch),this.addEventTouchTap(this.devourSigleBtn,this.onTouch),this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchTap(this.btnNoBoss,this.onTouch),this.addEventTouchTap(this.instrunction,this.onTouch),this.addEventTouchTap(this.touch,this.onTouch),this.bossList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onListChange,this),this.addEventChange(this.boss,this.onChange),this._curSelected=t?t:0,this.update(),this.playUpTween(),this.bgMc||(this.bgMc=new GameMovieClip,this.bgEff.addChild(this.bgMc),this.bgMc.playFile(PATH_EFF+"tunshi_bg_eff",-1)),DevourEquipContorl.ins().setNewTs(!1)},e.prototype.close=function(){this._isOpen=!1,TimerMgr.ins().removeAll(this),this.stopTween(),this.equipMc&&(this.equipMc.destroy(),this.equipMc=null),this.xihunMc&&(this.xihunMc.destroy(),this.xihunMc=null),this.btnMc&&(this.btnMc.destroy(),this.btnMc=null)},e.prototype.checkShowEff=function(t){var e=this;if(t){this.lianjieEff.visible=!1;var i=this.devoringBoss.getBossMc();if(!i||!i.movieClipData)return void this.update();var n=this.equipEff.localToGlobal(),o=this.bossGroup.globalToLocal(n.x,n.y);this.devoringBoss.data=null,ImgChipsUtils.playImgChips(i.movieClipData.getTextureByFrame(i.currentFrame),this.bossGroup,10,10,ChipsTweenType.MV_BROKEN,{x:o.x/Math.abs(this.bossGroup.scaleX),y:o.y/Math.abs(this.bossGroup.scaleY),onFinish:function(){e._isOpen&&(e.xihunMc||(e.xihunMc=new GameMovieClip,e.xihunEff.addChild(e.xihunMc)),e.xihunMc.playFile(PATH_EFF+"tunshixihun",1,function(){var t=parseInt(e.devourValue.text);e.proadd=t/10,e.procount=10,TimerMgr.ins().doTimer(30,9,e.updatePro,e,e.update,e),e.updatePro()}))},finishObj:this})}else this.update()},e.prototype.update=function(){this.lianjieEff.visible=!0,this.xihunMc&&(this.xihunMc.destroy(),this.xihunMc=null);var t=DevourEquipContorl.ins().devourEquipSouls,e=[];if(t.length>0&&t.length<3)for(var i=t.length;3>i;i++)e.push(new DevourEquipSoulInfoVo);this.bossCol.replaceAll(t.concat(e)),this._curSelected>t.length-1&&(this._curSelected=0),this.validateNow(),this.bossList.selectedIndex=this._curSelected,this._curData=t[this._curSelected],this.updateView(),this.selectList(),this.onChange()},e.prototype.onListChange=function(){this._curData=this.bossList.selectedItem,this._curSelected=this.bossList.selectedIndex,this.updateView(),this.selectList(),this.onChange()},e.prototype.updateView=function(){TimerMgr.ins().remove(this.updateLeftTime,this);var t=DevourEquipContorl.ins();if(this._curData){this.leftGroup.visible=this.rightGroup.visible=this.boss.visible=!0,this.noBoss.visible=!1,this.devourDoubleBtn.enabled=this.devourSigleBtn.enabled=!0;var e=["0",LangMgr.getValueByKey("job2"),LangMgr.getValueByKey("job3"),LangMgr.getValueByKey("job4")],i=heroControl.getSubRoleByIndex(this._curData.role);this.equipName.text=e[i.job]+"-"+DataCenter.ins().DevourEquipDataConfig.equipIconInfo[this._curData.pos][0];var n=DevourEquipContorl.ins().getRoleDevourInfo(this._curData.role,this._curData.pos),o=DataCenter.ins().DevourSoulBossConfig[this._curData.bossid];if(this.devourValue.text=o.addsoul+"",this.notStartTips.visible=this.timeGroup.visible=!1,this._curSelected)this.time.text="",this.devour.visible=!1,this.notStartTips.visible=!0;else{var s=DateUtils.formatMiniDateTime(this._curData.time>0?this._curData.time:0)-GameServer.serverTime;1e3>s?this.time.text="":(this.time.text="",this.timeGroup.visible=!0,TimerMgr.ins().doTimer(1e3,0,this.updateLeftTime,this),this.updateLeftTime()),this.devour.visible=!this.timeGroup.visible}this.devourCostMoney.text=o.doubleCost+"";var r=n.soul+o.addsoul,a=[],l=DataCenter.ins().DevourEquipLevelConfig[n.pos][n.lv];for(var h in l.attr){var u=t.getSoulValue(n.pos,r,parseInt(h));a.push({type:l.attr[h].type,value:u})}for(var p=0;4>p;p++)a[p]?(this["attr"+p].parent||this.attr.addChildAt(this["attr"+p].parent,4),this["attr"+p]&&(this["attr"+p].text=AttributeData.getAttrStrByType(a[p].type)),this["addAttr"+p]&&(this["addAttr"+p].text="+"+a[p].value)):DisplayUtils.removeFromParent(this["attr"+p].parent);var c=Math.floor(BackpackControl.getAttrPower(a));this.powerPanel3.setPower(c),this.devoringBoss.data=this._curData,this.devoringBoss.setSelect(!1),this.equipMc||(this.equipMc=new GameMovieClip,this.equipEff.addChild(this.equipMc)),this.equipMc.playFile(PATH_EFF+l.devourRes,-1),this.progress.updatePro(n.soul,n.maxsoule),this.lianjieMc||(this.lianjieMc=new GameMovieClip,this.lianjieEff.addChild(this.lianjieMc)),this.lianjieMc.playFile(PATH_EFF+"tunshilianjie",-1),this.devour.visible&&(this.btnMc||(this.btnMc=new GameMovieClip,this.btnEff.addChild(this.btnMc)),this.btnMc.playFile(PATH_EFF+"chargeff1",-1))}else{this.leftGroup.visible=this.rightGroup.visible=this.boss.visible=!1,this.noBoss.visible=!0;var d=DevourEquipContorl.ins().checkAllRoleAllDevourEquip(),g=DevourEquipContorl.ins().getAllDevourEquipMax();this.noBoss1.visible=this.maxTips.visible=this.noActivate.visible=!1,d?(this.btnNoBoss.label=LangMgr.getValueByKey("notAvailable"),this.noActivate.visible=!0):g?(this.btnNoBoss.label=LangMgr.getValueByKey("tunshiupliml"),this.maxTips.visible=!0):(this.btnNoBoss.label=LangMgr.getValueByKey("tunshigotojisha"),this.noBoss1.visible=!0),this.equipName.text=LangMgr.getValueByKey("notAvailable"),this.devourValue.text="0",this.time.text="",this.timeGroup.visible=this.notStartTips.visible=this.devour.visible=!1;for(var a=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],p=0;4>p;p++)a[p]&&(this["attr"+p].parent||this.attr.addChildAt(this["attr"+p].parent,4)),this["attr"+p]&&(this["attr"+p].text=AttributeData.getAttrStrByType(a[p].type)),this["addAttr"+p]&&(this["addAttr"+p].text="+"+a[p].value);this.powerPanel3.setPower(0),this.equipMc&&(this.equipMc.destroy(),this.equipMc=null),this.progress.updatePro(0,0),this.devoringBoss.data=null,this.devoringBoss.setSelect(!1),this.lianjieMc&&(this.lianjieMc.destroy(),this.lianjieMc=null),this.btnMc&&(this.btnMc.destroy(),this.btnMc=null)}},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.devourSigleBtn:if(!this.devour.visible)return void tipsControl.showTips(LangMgr.getValueByKey("tunshinofinish"));if(this._curData&&this._curSelected)return void tipsControl.showTips(LangMgr.getValueByKey("tunshinostart"));DevourEquipContorl.ins().upSoulValue(DevourEquipRewardType.one);break;case this.devourDoubleBtn:if(!this.devour.visible)return void tipsControl.showTips(LangMgr.getValueByKey("tunshinofinish"));if(this._curData&&this._curSelected)return void tipsControl.showTips(LangMgr.getValueByKey("tunshinostart"));var e=DataCenter.ins().DevourSoulBossConfig[this._curData.bossid];warnControl.show(LangMgr.getValueByKey("tunshixiaohaoybshouhun",e.doubleCost),function(){ActorControl.yb>=e.doubleCost?DevourEquipContorl.ins().upSoulValue(DevourEquipRewardType["double"]):setTimeout(function(){tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},100)},this);break;case this.btnFinish:var i=DataCenter.ins().DevourSoulBossConfig[this._curData.bossid],n=DevourEquipContorl.ins().calSoulTime(this._curData.time)*i.oneKeyCost;warnControl.show(LangMgr.getValueByKey("tunshixiaohaoybfinish",n),function(){ActorControl.yb>=n?DevourEquipContorl.ins().upSoulValue(DevourEquipRewardType.finish):setTimeout(function(){tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},100)},this);break;case this.rightBtn:this.onRight();break;case this.leftBtn:this.onLeft();break;case this.btnNoBoss:if(LangMgr.getValueByKey("tunshiupliml")==this.btnNoBoss.label||LangMgr.getValueByKey("tunshigotoJiHuo")==this.btnNoBoss.label)return UIMgr.ins().open(DevourEquipView,0);UIMgr.ins().open(CrossFieldView);break;case this.instrunction:HelpControl.openHelpWin(153);break;case this.touch:this._curData&&UIMgr.ins().open(DevourEquipAttrTipsView,this._curData.role,this._curData.pos)}},e.prototype.selectList=function(){for(var t=this.bossList.dataProvider.length,e=0;t>e;e++){var i=this.bossList.getElementAt(e);i&&(e!=this.bossList.selectedIndex?i.setSelect(!1):i.setSelect(!0))}},e.prototype.onLeft=function(){var t=this.bossList.scrollH-462;t=154*Math.round(t/154),0>t&&(t=0),this.bossList.scrollH=t,this.onChange()},e.prototype.onRight=function(){var t=this.bossList.scrollH+462;t=154*Math.round(t/154),t>this.bossList.contentWidth-this.boss.width&&(t=this.bossList.contentWidth-this.boss.width),this.bossList.scrollH=t,this.onChange()},e.prototype.onChange=function(){this._curData&&(this.bossList.scrollH<77?(this.leftGroup.visible=!1,this.rightGroup.visible=!0):this.bossList.scrollH>=this.bossList.contentWidth-this.bossList.width-77?(this.leftGroup.visible=!0,this.rightGroup.visible=!1):(this.leftGroup.visible=!0,this.rightGroup.visible=!0),this.bossList.numElements<=3&&(this.leftGroup.visible=!1,this.rightGroup.visible=!1))},e.prototype.updateLeftTime=function(){var t=DateUtils.formatMiniDateTime(this._curData.time>0?this._curData.time:0)-GameServer.serverTime,e=t>=DateUtils.SECOND_PER_HOUR?DateUtils.TIME_FORMAT_1:DateUtils.TIME_FORMAT_3;if(1e3>=t)return void this.update();var i=DateUtils.getFormatBySecond(t/1e3,e);this.time.text=i},e.prototype.playUpTween=function(){this.equipEff&&(this.equipEff.verticalCenter=this.effY,egret.Tween.removeTweens(this.equipEff),egret.Tween.get(this.equipEff,{loop:!0}).to({verticalCenter:this.effMoveY},1e3).to({verticalCenter:this.effY},1e3))},e.prototype.stopTween=function(){egret.Tween.removeTweens(this.equipEff)},e.prototype.updatePro=function(){this.progress.setaddPro(this.proadd)},e}(BasePanel);__reflect(DevourEquipRefiningPanel.prototype,"DevourEquipRefiningPanel");var DevourEquipSkillView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipSkillViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this,this.onTap),this.effMc||(this.effMc=new GameMovieClip,this.eff.addChild(this.effMc)),this.effMc.playFile(PATH_EFF+"tunshilianjie",-1)},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DevourEquipSkillView.prototype,"DevourEquipSkillView");var DevourEquipSuitSkillView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipSuitSkillViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t,e){this.addEventTouchTap(this,this.onTap),this.devourdata=t,this.rolebase=e,this.suits=DevourEquipContorl.ins().getSuitDataByData(null,this.devourdata),this.suits&&(this.updateActive(),this.updateView())},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.updateActive=function(){if(this.suits.length){var t=DataCenter.ins().DevourSoulSuitConfig,e=[];for(var i in t)-1==e.indexOf(+i)&&e.push(+i);for(var i=0;i<e.length;i++){for(var n=!1,o=0;o<this.suits.length;o++)if(e[i]==this.suits[o].count){n=!0;var s=CommonUtils.getObjectLength(DataCenter.ins().DevourSoulSuitConfig[this.suits[o].count]);if(this.suits[o].lv<s){n=!1;break}}if(!n){this.currentState="active";break}}this.currentState||(this.currentState="max")}else this.currentState="unactive";this.validateNow()},e.prototype.updateView=function(){this.setCurDesc(),this.setNextDesc();var t=DataCenter.ins().DevourEquipDataConfig.skillDisplayID;t&&!this.skillShow&&(this.skillShow=new SkillShowComponent(t),this.show.addChild(this.skillShow))},e.prototype.setCurDesc=function(){for(var t=0,e=0;8>e;e++){var i=this.devourdata[e];i&&i.lv&&t++}this.numLabel1.text="("+t+"/8)";var n=[2,4,6,8],o=DataCenter.ins().DevourEquipDataConfig.suitNameHead,s="";if("unactive"==this.currentState)for(var e=0;e<n.length;e++){this["attrName"+n[e]].text=o[0]+"·"+n[e]+LangMgr.getValueByKey("thunderSuitTips1");var r=DataCenter.ins().DevourSoulSuitConfig[n[e]][1];if(this["attr"+n[e]].text="",r.desc){var a=r.desc;if(8==n[e]){var l=DevourEquipContorl.ins().suitEffSkillData1(1,this.rolebase);for(var h in l)a=a.replace("d%",""+l[h])}this["attr"+n[e]].text+=""+a}}else if("active"==this.currentState)for(var e=0;e<n.length;e++){DisplayUtils.removeFromParent(this["attrGroup"+n[e]]);for(var u=0;u<this.suits.length;u++)if(this.suits[u].count==n[e]){this.attrGroup.addChild(this["attrGroup"+n[e]]),this["attrName"+this.suits[u].count].text=o[this.suits[u].lv-1]+"·"+n[e]+LangMgr.getValueByKey("thunderSuitTips1");var r=DataCenter.ins().DevourSoulSuitConfig[n[e]][this.suits[u].lv];if(this["attr"+n[e]].text="",r.desc){var a=r.desc;if(8==this.suits[u].count){var l=DevourEquipContorl.ins().suitEffSkillData1(this.suits[u].lv,this.rolebase);for(var h in l)a=a.replace("d%",""+l[h])}this["attr"+n[e]].text+=""+a}break}}else for(var p=CommonUtils.getObjectLength(DataCenter.ins().DevourSoulSuitConfig[2]),e=0;e<n.length;e++)for(var u=0;u<this.suits.length;u++){if(this.suits[u].count==n[e]){this["attrName"+this.suits[u].count].text=o[p-1]+"·"+n[e]+LangMgr.getValueByKey("thunderSuitTips1");var r=DataCenter.ins().DevourSoulSuitConfig[n[e]][p];if(this["attr"+n[e]].text="",r.desc){var a=r.desc;if(8==this.suits[u].count){var c=DevourEquipContorl.ins().suitEffSkillData1(p,this.rolebase);for(var h in c)a=a.replace("d%",""+c[h])}this["attr"+n[e]].text+=""+a}break}s="";for(var d=0;8>d;d++){var i=this.devourdata[d],g=i&&i.lv?65280:9144715;s+="|C:"+g+"&T:"+LangMgr.getValueByKey("equipPosName"+d)+"   |"}}this.informationname0.textFlow=TextUtils.generateTextFlow1(s)},e.prototype.setNextDesc=function(){if("active"==this.currentState)for(var t=[8,6,4,2],e=DataCenter.ins().DevourEquipDataConfig.suitNameHead,i=0;i<t.length;i++){for(var n=!1,o=0;o<this.suits.length;o++)if(this.suits[o].count==t[i]){n=!0;var s=DataCenter.ins().DevourSoulSuitConfig[t[i]];if(s&&s[this.suits[o].lv+1]){this["nattrName"+this.suits[o].count].text=e[this.suits[o].lv]+"·"+t[i]+LangMgr.getValueByKey("thunderSuitTips1");var r=DataCenter.ins().DevourSoulSuitConfig[t[i]][this.suits[o].lv+1];if(this["nattr"+t[i]].text="",r.desc){var a=r.desc;if(8==this.suits[o].count){var l=DevourEquipContorl.ins().suitEffSkillData1(this.suits[o].lv+1,this.rolebase);for(var h in l)a=a.replace("d%",""+l[h])}this["nattr"+t[i]].text+=""+a}}else DisplayUtils.removeFromParent(this["nattrGroup"+t[i]]);break}if(!n){var s=DataCenter.ins().DevourSoulSuitConfig[t[i]][1];if(this["nattrName"+t[i]].text=e[0]+"·"+t[i]+LangMgr.getValueByKey("thunderSuitTips1"),this["nattr"+t[i]].text="",s.desc){var u=s.desc;if(8==t[i]){var l=DevourEquipContorl.ins().suitEffSkillData1(1,this.rolebase);for(var p in l)u=u.replace("d%",""+l[p])}this["nattr"+t[i]].text+=""+u}}}},e}(BaseEuiView);__reflect(DevourEquipSuitSkillView.prototype,"DevourEquipSuitSkillView");var DevourEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipTipsViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.bgClose,this.onTap),this.itemId=t,this.updateView()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateView=function(){var t=DataCenter.ins().ItemConfig[this.itemId],e=ItemUtils.getSubType(t),i=DataCenter.ins().DevourEquipLevelConfig[e][1],n=BackpackControl.getAttrPower(i.attr);n+=DevourEquipContorl.ins().calAttrPower(heroControl.getSubRoleByIndex(0),reincarnateStarEquipControl.getZhuHunlvById(0),e,1),n+=BackpackControl.getAttPowerContainRelate(DataCenter.ins().DevourSoulSuitConfig[2][1].attr,0),this.powerPanel.setPower(n),this.equipName.text=t.name,this.itemname.text=t.name,this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.thunderEff.addChild(this.mc),this.mc.playFile(PATH_EFF+DataCenter.ins().DevourEquipDataConfig.equipTipsInfo[e],-1),this.content0.textFlow=TextUtils.generateTextFlow1(t.desc)},e}(BaseEuiView);__reflect(DevourEquipTipsView.prototype,"DevourEquipTipsView");var DevourEquipView=function(t){function e(){var e=t.call(this)||this;return e._openIndexs=[],e._isshow=0,e._curRole=0,e.panelArr=[],e._curSelectIndex=-1,e.skinName="DevourEquipViewSkin",e._openIndexs=[],e._isshow=0,e._curRole=0,e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(t,e){this._curRole=e?e:0,this.panelArr=[this.devourEquipPanel,this.devourEquipTrainPanel],this.viewStack.selectedIndex=0,this.addEventChange(this.tab,this.onTabTouch),this.addEventChange(this.roleSelect,this.onChange),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.help,this.onTouch),this.addCustomEvent(716,this.setRedPoint),this.addCustomEvent(717,this.setRedPoint);var i=t?t>DevourEquipViewType.LIANHUN?DevourEquipViewType.YANGCHENG:t:DevourEquipViewType.YANGCHENG;this._openIndexs=[DevourEquipViewType.YANGCHENG,DevourEquipViewType.LIANHUN],t=this._openIndexs.indexOf(i),0>t&&(t=0),this._isshow=1,this.setSelectedIndex(t)},e.prototype.close=function(){this.viewStack.getChildAt(this._curSelectIndex).close(),this._curSelectIndex=-1},e.prototype.onTouch=function(t){switch(t.target){case this.help:HelpControl.openHelpWin(152);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onTabTouch=function(t){this.setSelectedIndex(t.currentTarget.selectedIndex)},e.prototype.setSelectedIndex=function(t){-1!=this._curSelectIndex&&this.viewStack.getChildAt(this._curSelectIndex).close(),this._curSelectIndex=t;var e=this._openIndexs[this._curSelectIndex],i=this.viewStack.getChildAt(t);switch(this.tab.selectedIndex=this.viewStack.selectedIndex=t,e){case DevourEquipViewType.YANGCHENG:this.roleSelect.openRole(),i.open(this._curRole,0,this._isshow);break;case DevourEquipViewType.LIANHUN:this.roleSelect.hideRole(),i.open()}this._isshow&&(this._isshow=0),this.setRedPoint()},e.prototype.onChange=function(){this.setRoleId(this.roleSelect.getCurRole())},e.prototype.setRoleId=function(t){this._curRole=t,this.setSelectedIndex(this.viewStack.selectedIndex)},e.prototype.setRedPoint=function(){for(var t=DevourEquipRedPoint.ins().roleTabPoint,e=0;e<t.length;e++)this.roleSelect.showRedPoint(e,t[e]);this.redPoint0.visible=DevourEquipRedPoint.ins().equipPoint,this.redPoint1.visible=DevourEquipRedPoint.ins().soulPoint},e}(BaseEuiView);__reflect(DevourEquipView.prototype,"DevourEquipView");var DevourFinishView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourFinishViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t,e){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.goBtn,this.onTap);var i=DataCenter.ins().DevourEquipDataConfig.equipIconInfo[t],n=DataCenter.ins().MonstersConfig[e];this.equipName.text=""+i[0],this.bossName.text=""+n.name,this.bossMc||(this.bossMc=ObjectPool.pop("GameMovieClip"),this.equipEff.addChild(this.bossMc)),this.bossMc.playFile(PATH_GUAIWU+("guaiwu"+n.avatar+"_3s"),-1)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.goBtn:UIMgr.ins().open(DevourEquipView,1),UIMgr.ins().close(this);break;case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DevourFinishView.prototype,"DevourFinishView");var DevourSkillNoticeView=function(t){function e(){var e=t.call(this)||this;return e.actorid=0,e.curpos=0,e.curbossid=0,e.skinName="DevourSkillNoticeViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t,e,i,n,o){this.curpos=i,this.curbossid=n,this.actorid=o,this.addEventTouchTap(this,this.onTap);var s=DataCenter.ins().DevourEquipDataConfig.equipIconInfo[this.curpos],r=DataCenter.ins().MonstersConfig[this.curbossid];this.playerName.text=LangMgr.getValueByKey("kfTips43",t)+"·"+e,this.equipName.text=""+s[0],this.bossName.text=""+r.name,this.equipMc||(this.equipMc=ObjectPool.pop("GameMovieClip"),this.equipEff.addChild(this.equipMc)),this.equipMc.playFile(PATH_GUAIWU+("guaiwu"+r.avatar+"_3s"),-1)},e.prototype.close=function(){ActorControl.actorID==this.actorid&&UIMgr.ins().open(DevourWarnView,this.curpos,this.curbossid)},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DevourSkillNoticeView.prototype,"DevourSkillNoticeView");var DevourWarnView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourWarnViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t,e){this.addEventTouchTap(this,this.onTap);var i=DataCenter.ins().DevourEquipDataConfig.equipIconInfo[t],n=DataCenter.ins().MonstersConfig[e];this.equipName.text=""+i[0],this.bossName.text=""+n.name,this.bossMc||(this.bossMc=ObjectPool.pop("GameMovieClip"),this.equipEff.addChild(this.bossMc)),this.bossMc.playFile(PATH_GUAIWU+("guaiwu"+n.avatar+"_3s"),-1)},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DevourWarnView.prototype,"DevourWarnView");var ImgChipsUtils=function(){function t(){}return t.playImgChips=function(t,e,i,n,o,s){switch(this.removeImgChips(t.hashCode),this.imgToChips(t,i,n,e),o){case ChipsTweenType.MV_BROKEN:this.chipNum=this.chipListDic[t.hashCode].length,this.brokenChipMc(this.chipListDic[t.hashCode],s);break;case ChipsTweenType.MV_LINE:this.lineChipMc(this.chipListDic[t.hashCode],s)
}},t.removeImgChips=function(t){if(this.chipListDic[t]){var e=this,i=egret.Tween,n=function(t){for(var n=0;n<t.length;n++)i.removeTweens(t[n]),e.chipPool.push(t[n]),DisplayUtils.removeFromParent(t[n])};for(var o in this.chipListDic){var s=this.chipListDic[o];t?o==t&&n(s):n(s)}TimerMgr.ins().removeAll(this)}},t.imgToChips=function(t,e,i,n){this.chipListDic[t.hashCode]=[];for(var o=t.textureWidth,s=t.textureHeight,r=o/e,a=s/i,l=0;e>l;l++)for(var h=0;i>h;h++){var u=l*r,p=h*a;if(!(u+r>o||p+a>s)){var c=this.chipPool.pop()||new eui.Image;c.width=r,c.height=a,c.x=u,c.y=p,n&&n.addChild(c),this.chipListDic[t.hashCode].push(c),c.source=null;var d=new egret.Texture,g=t.bitmapData;d.$bitmapData=g,d.$initData(t.$bitmapX+u,t.$bitmapY+p,r,a,0,0,r,a,g.width,g.height),c.source=d}}return this.chipListDic[t.hashCode]},t.lineChipMc=function(t,e){var i=this,n=t.pop();if(n){if(!e)return void console.warn("chip need target ");egret.Tween.get(n).to({x:e.x,y:e.y},MathUtils.limit(500,1e3)).call(function(){DisplayUtils.removeFromParent(n),i.chipPool.push(n)}),this.lineChipMc(t,e)}},t.brokenChipMc=function(t,e){var i=this,n=t.pop();if(n){if(!e)return void console.warn("chip need target ");var o=n.x+MathUtils.limit(-80,80),s=n.y+MathUtils.limit(-80,80);egret.Tween.get(n).to({x:o,y:s},200).to({x:e.x,y:e.y},MathUtils.limit(500,1e3)).call(function(){DisplayUtils.removeFromParent(n),i.chipPool.push(n),i.chipNum--,i.chipNum<=0&&e.onFinish&&e.finishObj&&e.onFinish.apply(e.finishObj)}),egret.callLater(function(){for(var n=40;n-->0;)i.brokenChipMc(t,e)},this)}},t.chipPool=[],t.chipListDic={},t.chipNum=0,t}();__reflect(ImgChipsUtils.prototype,"ImgChipsUtils");var SkillShowComponent=function(t){function e(e){var i=t.call(this)||this;return i.sEntityPos={},i.sEntityAlpha={},i.effList=[],i.wordList=[],i.zhanlingTime=0,i.zhanlingData={},i.hasZhanling=!1,i.maxH=400,i.maxW=400,i.isStop=!1,i.bottomEffLayer=new egret.DisplayObjectContainer,i.entityLayer=new egret.DisplayObjectContainer,i.topEffLayer=new egret.DisplayObjectContainer,e&&i.setShowId(e),i}return __extends(e,t),e.prototype.$onRemoveFromStage=function(){this.dispose()},e.prototype.setMask=function(t){var e=new egret.Shape;e.graphics.beginFill(0),e.graphics.drawRect(0,0,t.width,t.height),e.graphics.endFill(),t.addChild(e),this.maxH=t.width,this.maxW=t.height,this.mask=e},e.prototype.setShowId=function(t){this.showDp=DataCenter.ins().SkillShowConfig[t],Assert(this.showDp,"SkillShowComponent configError：id="+t)||(this.showDp.bg&&(this.bg||(this.bg=new eui.Image(this.showDp.bg)),this.addChild(this.bg)),this.addChild(this.bottomEffLayer),this.addChild(this.entityLayer),this.addChild(this.topEffLayer),this.initEntity(),this.initSkillEffPlay(),this.startPlay(),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.sortEntity())},e.prototype.sortEntity=function(){for(var t=this.entityLayer.$children,e=0;e<t.length;e++){var i=t[e];i._layerWeigth=i.weight>>0}t.sort(this.sortDesc)},e.prototype.sortDesc=function(t,e){return t>e?-1:e>t?1:0},e.prototype.onTime=function(){if(!this.isStop){var t=function(t){for(var e in t.buffList){if(3==t.AI_STATE)break;var i=t.buffList[e];i&&i.canRemove()&&t.removeBuff(i)}};for(var e in this.entityList)t(this.entityList[e]);if(this.summonerList)for(var e in this.summonerList){var i=this.summonerList[e];if(i)for(var n in i)t(i[n])}this.hasZhanling&&(this.zhanlingTime||(this.zhanlingTime=egret.getTimer()),this.checkZhanLing())}},e.prototype.checkZhanLing=function(){this.zhanlingTime&&egret.getTimer()-this.zhanlingTime>1e4&&(this.zhanlingTime=0,this.showZhanling())},e.prototype.showZhanling=function(){for(var t in this.entityList){var e=this.zhanlingData[t];if(e){var i=this.entityList[t];i instanceof UnitRole&&i.showZhanling(e[0],e[1],!0)}}},e.prototype.initSkillEffPlay=function(){var t=this;SkillEffPlayShow.bottomLayer=this.bottomEffLayer,SkillEffPlayShow.topLayer=this.topEffLayer,SkillEffPlayShow.setTimeout=function(t,e,i){TimerMgr.ins().doTimer(t,1,e,i)},SkillEffPlayShow.shake=function(e,i,n,o,s){s=s||1,Math.random()<s&&DisplayUtils.shakeIt(t,i,n,o)}},e.prototype.initEntity=function(){if(this.summonerList={},this.sSummonerPos={},this.summerPos={},!this.entityList){this.entityList={};var t=this,e=function(e){var i,n=t.showDp.entitys[e];if(n.monsterId)i=ObjectPool.pop("UnitMonster"),i.reset(),i.infoModel=copyControl.createModel(DataCenter.ins().MonstersConfig[n.monsterId]),i.updateModel();else if(n.zhanling){var o=DataCenter.ins().AshtarteLevelConfig[n.zhanling[0]][n.zhanling[1]],s=o.appearance;i=new GameMovieClip;var r=isNaN(n.dir)?1:n.dir;i.playFile(PATH_GUAIWU+s+"_"+r+UnitAction.STAND,-1),i.scaleX=r>4?-1:1,t.zhanlingData[n.index]=n.zhanling.concat([r])}else if(n.role){i=ObjectPool.pop("UnitRole"),i.reset();var a=heroControl.getSubRoleByJob(n.role.job);a||(a=heroControl.getSubRoleByIndex(0),a.job=n.role.job),i.infoModel=a,n.role.body?i.addMc(1,PATH_RENWU+n.role.body):i.updateModel(),n.role.weapon&&i.addMc(2,PATH_WUQI+n.role.weapon),n.role.wing&&i.addMc(3,PATH_CHIBANG+n.role.wing),n.role.zhanling&&(t.hasZhanling=!0,t.zhanlingData[n.index]=n.role.zhanling,TimerMgr.ins().once(DataCenter.ins().AshtarteConfig.delayTime,function(){i.showZhanling(n.role.zhanling[0],n.role.zhanling[1],!0)},t))}return i?(i.x=n.x?n.x:0,i.y=n.y?n.y:0,i.alpha=isNaN(n.alpha)?1:n.alpha,i instanceof GameMovieClip||(i.showName(!1),i.showBlood(!1),i.titleCantainer.visible=!1,i.playAction(UnitAction.STAND),i.dir=isNaN(n.dir)?1:n.dir),isNaN(n.scale)||(i.scaleX=i.scaleY=n.scale,SkillEffPlayShow.effScale=n.scale),t.sEntityPos[n.index]={x:i.x,y:i.y},t.sEntityAlpha[n.index]=i.alpha,t.entityLayer.addChild(i),void(t.entityList[n.index]=i)):"continue"};for(var i in this.showDp.entitys)e(i)}},e.prototype.startPlay=function(){this.playAction(),this.playWords(),this.playDialogs(),this.playEffs(),this.showDp.interval&&TimerMgr.ins().once(this.showDp.interval,this.nextPlay,this)},e.prototype.nextPlay=function(){this.reset(),this.startPlay()},e.prototype.playAction=function(){var t=this,e=function(e){var i=t.showDp.actions[e],n=function(){if(!i.sIdxs)return void console.warn("config no fire，id=",t.showDp.id);for(var e=function(e){var n=t.entityList[e];if(!n)return console.warn("index error actions["+i.id+"].sIdxs["+e+"]!  ",e),"continue";var o=function(n,o){if(o.length||(o=[n]),i.skillId){if(n instanceof GameMovieClip)return void console.warn("zhanlin no skill！");t.playUserSkill(i.skillId,n,o,e)}else if(i.actEff){if(i.actEff.action){if(n instanceof GameMovieClip){var s=t.zhanlingData[e],r=DataCenter.ins().AshtarteLevelConfig[s[0]][s[1]],a=PATH_GUAIWU+r.appearance+"_"+s[2]+i.actEff.action;return void n.playFile(a,1,function(){var t=PATH_GUAIWU+r.appearance+"_"+s[2]+UnitAction.STAND;n.playFile(t,-1,null,!1)},!1)}n.playAction(i.actEff.action)}if(i.actEff.skillEff){if(n instanceof GameMovieClip)return void console.warn("zhanlin no eff！");var l=i.actEff.delay||0;TimerMgr.ins().once(l,function(){SkillEffPlayShow.play(i.actEff.skillEff,n,o)},t)}if(i.actEff.eff){var h=ObjectPool.pop("GameMovieClip");h.visible=!0,h.alpha=1,h.x=n.x,h.y=n.y,h.playFile(PATH_EFF+i.actEff.eff,1),h.scaleX=h.scaleY=n.scaleY,t.addChild(h)}i.actEff.buffId&&t.checkAddBuff(n,BuffModel.createBuff(i.actEff.buffId,n),e),i.actEff.dir&&(n.dir=i.actEff.dir)}if(i.moveDt){var u=i.moveDt.delay||2,p=i.moveDt;p.action&&n.playAction(p.action);var c=isNaN(p.tx)?n.x:p.tx,d=isNaN(p.ty)?n.y:p.ty,g=isNaN(p.alpha)?1:p.alpha,m=isNaN(p.duration)?0:p.duration;i.moveDt.dir&&(n.dir=i.moveDt.dir);var f=function(e){e.resetStand&&e.resetStand(),t.sortEntity()};TimerMgr.ins().once(u,function(){var e=egret.Tween.get(n);e.to({x:c,y:d,alpha:g},m).call(f,t,[n])},t)}},s=[];i.tIdxs=i.tIdxs||[];for(var r=0,a=i.tIdxs;r<a.length;r++){var l=a[r];s.push(t.entityList[l])}t.summerPos||(t.summerPos={}),t.summerPos[e]=i.summerPos,i.isSummer&&t.summonerList[e]?t.summonerList[e][i.isSummer-1]?o(t.summonerList[e][i.isSummer-1],s):Assert(!1,"act is zhaohuan guaiwu idx="+e+" id="+t.showDp.id):o(n,s)},n=0;n<i.sIdxs.length;n++){var o=i.sIdxs[n];e(o)}},o=i.delay||5;TimerMgr.ins().once(o,n,t)};for(var i in t.showDp.actions)e(i)},e.prototype.playDialogs=function(){var t=this,e=function(e){var i=t.showDp.dialogs[e],n=t.entityList[i.idx];if(!n)return console.warn("check dialogs["+e+"].idx!  ",i.idx),"continue";var o=function(){t.talkPao||(t.talkPao=new TalkPanel,t.talkPao.setDefSkin(),t.addChildAt(t.talkPao,100),t.talkPao.open()),t.talkPao.msgTxt.size=16,t.talkPao.anchorOffsetY=140*n.scaleY,t.talkPao.anchorOffsetX=100*n.scaleX,t.talkPao.setSpeak(i.content,i.duration||2e3);var e=n.dir>4?-1:1;t.talkPao.setScale(e),t.talkPao.x=n.x+t.talkPao.width/2*e*n.scaleX,t.talkPao.y=n.y},s=i.delay||0;TimerMgr.ins().once(s,o,t)};for(var i in t.showDp.dialogs)e(i)},e.prototype.playWords=function(){var t=this,e=function(e){var i=t.showDp.upWords[e],n=t.entityList[i.idx];if(!n)return console.warn("check dialogs["+e+"].idx!  ",i.idx),"continue";var o=function(){isNaN(i.sx)&&(i.sx=0),isNaN(i.sy)&&(i.sy=-100);var e;if(i.wordRes)e=new eui.Image(i.wordRes),e.x=n.x+i.sx,e.y=n.y+i.sy,e.scaleX=e.scaleY=i.scale,t.topEffLayer.addChild(e);else if(i.word){e=new eui.Label,e.x=n.x+i.sx,e.y=n.y+i.sy,e.scaleX=e.scaleY=i.scale||1,e.size=16,e.stroke=1,e.strokeColor=0,e.textColor=15589033;var o=i.word;e.textFlow=TextUtils.generateTextFlow1(o.replace("%name%",ActorControl.myName)),t.topEffLayer.addChild(e)}if(i.arrowRes){var s=new eui.Image(i.arrowRes);if(e){var r=s.width?s.width:20;s.x=e.x-r-10,s.y=e.y}else s.x=n.x+i.sx,s.y=n.y+i.sy;s.scaleX=s.scaleY=i.scale||1,t.topEffLayer.addChild(s),i.noTween?t.wordList.push(s):t.wordTween(s,i.tweenDt)}i.noTween?t.wordList.push(e):t.wordTween(e,i.tweenDt)},s=i.delay||1;TimerMgr.ins().once(s,o,t)};for(var i in t.showDp.upWords)e(i)},e.prototype.playEffs=function(){var t=this;if(this.showDp.effs){var e=function(e){var i=t.showDp.effs[e],n=function(){var e=i.playCount||1;if(i.idxs)for(var n=0;n<i.idxs.length;n++){var o=i.idxs[n],s=t.entityList[o];if(s){var r=ObjectPool.pop("GameMovieClip");r.visible=!0,r.alpha=1,r.x=s.x+(i.x||0),r.y=s.y+(i.y||0),r.playFile(PATH_RES+"/"+i.url,e),r.scaleX=r.scaleY=i.scale||1,1!=e&&t.effList.push(r),i.isBottom?t.bottomEffLayer.addChild(r):t.topEffLayer.addChild(r)}}else{var r=ObjectPool.pop("GameMovieClip");r.visible=!0,r.alpha=1,r.x=i.x||0,r.y=i.y||0,r.playFile(PATH_RES+"/"+i.url,e),r.scaleX=r.scaleY=i.scale||1,1!=e&&t.effList.push(r),i.isBottom?t.bottomEffLayer.addChild(r):t.topEffLayer.addChild(r)}},o=i.delay||0;TimerMgr.ins().once(o,n,t)};for(var i in t.showDp.effs)e(i)}},e.prototype.playUserSkill=function(t,e,i,n){var o=this,s=new SkillVo(t);if(e){s.actionType?e.playAction(s.actionType):e.playAction(UnitAction.ATTACK);var r=SkillVo.reviseDp(s.id+s.lv,e.infoModel.index),a=function(){for(var t in i){var a=i[t],l=s.tarEff;1==a.infoModel.type&&(l=s.otarEff||l);for(var h=0;l&&h<l.length;h++){var u=HookControl.ins().getArgs(l[h],null,null,r),p=BuffModel.createBuff(l[h],e,u);o.checkAddBuff(a,p,n)}o.repel(e,a,s)}};if(s.effectId?SkillEffPlayShow.play(s.effectId,e,i,a):a(),s.selfEff)for(var l=0;l<s.selfEff.length;l++){var h=HookControl.ins().getArgs(s.selfEff[l],null,null,r),u=BuffModel.createBuff(s.selfEff[l],e,h);this.checkAddBuff(e,u,n)}s.die_summoner&&s.die_summoner.length&&(e.playAction(UnitAction.DIE),TimerMgr.ins().once(1e3,function(){e.visible=!1,o.trySummoner(e,s.die_summoner,n)},this)),s.config.ex_summoner&&s.config.ex_summoner.length?this.trySummoner(e,s.config.ex_summoner,n):s.config.random_summoner&&s.config.random_summoner.id.length&&this.trySummoner(e,s.config.random_summoner.id,n)}},e.prototype.trySummoner=function(t,e,i){this.sSummonerPos[i]||(this.sSummonerPos[i]={}),this.summonerList[i]||(this.summonerList[i]={});for(var n=0;n<e.length;n++){var o=DataCenter.ins().MonstersConfig[e[n]];if(!this.summonerList[i][n]){var s=new UnitMonster;s.reset(),s.infoModel=copyControl.createModel(o),s.updateModel(),s.x=this.summerPos[i]&&this.summerPos[i][n]?this.summerPos[i][n]:t.x,s.y=this.summerPos[i]&&this.summerPos[i][n+1]?this.summerPos[i][n+1]:t.y,s.dir=t.dir,s.scaleX=s.scaleY=t.scaleY,s.showName(!1),this.summonerList[i][n]=s,this.sSummonerPos[i][n]={x:s.x,y:s.y}}if(this.summonerList[i][n].alpha=1,this.entityLayer.addChild(this.summonerList[i][n]),this.summonerList[i][n].visible=!0,o.createEff)for(var r in o.createEff){var a=o.createEff[r];if(2==a.type)SkillEffPlayShow.play(a.res,this.summonerList[i][n],[this.summonerList[i][n]]);else{var l=ObjectPool.pop("GameMovieClip");l.visible=!0,l.alpha=1,l.x=this.summonerList[i][n].x,l.y=this.summonerList[i][n].y,l.playFile(SkillEffPlayShow.urlSkillEff+a.res,1),l.scaleX=l.scaleY=t.scaleY,this.bottomEffLayer.addChild(l)}}}this.sortEntity()},e.prototype.repel=function(t,e,i){if(i&&i.repelDistance){e.stopMove(),e.playAction(UnitAction.STAND),e.dir=DirUtils.get8DirBy2Point(e,t);var n=MathUtils.getAngle(MathUtils.getRadian2(t.x,t.y,e.x,e.y)),o=MathUtils.getDirMove(n,i.repelDistance*SkillEffPlayShow.effScale);o.x=e.x+o.x,o.y=e.y+o.y,o.x=Math.max(Math.min(o.x,this.maxW),0),o.y=Math.max(Math.min(o.y,this.maxH),0);var s=o.x-e.x,r=o.y-e.y,a=Math.sqrt(s*s+r*r)/(t.moveSpeed/1e3);if(e.addHardStraight(a),a>0){var l=egret.Tween.get(e.moveTweenObj);l.to({x:o.x,y:o.y},a)}if(1==i.teleport&&(i&&""!=i.actionType&&t.playAction(i.actionType),t.stopMove(),a>0)){var l=egret.Tween.get(t.moveTweenObj);l.to({x:t.x-(e.x-o.x),y:t.y-(e.y-o.y)},a).call(function(){t.stopMove(),t.resetStand()}),t.addHardStraight(a)}}},e.prototype.wordTween=function(t,e){if(t){var i=egret.Tween.get(t),n=e?e.type:0,o=e?e.dir:"up";switch(n){case 1:break;case 0:default:t.alpha=0;var s=t.x,r=t.y,a=t.x,l=t.y,h=t.x,u=t.y;switch(o){case"down":r=t.y+3,l=t.y+10,u=t.y+20;break;case"left":s=t.x-3,a=t.x-10,h=t.x-20;break;case"right":s=t.x+3,a=t.x+10,h=t.x+20;break;case"up":r=t.y-3,l=t.y-10,u=t.y-20}i.to({y:r,x:s,alpha:1},200).to({y:l,x:a},800).to({y:u,x:h,alpha:0},400).call(function(){DisplayUtils.removeFromParent(t)})}}},e.prototype.checkAddBuff=function(t,e,i){if(t){t.addBuff(e);var n=e.effConfig;switch(n.type){case 5:var o=DataCenter.ins().MonstersConfig[n.args.a],s=this.getIdx(t);if(this.summonerList[s]||(this.summonerList[s]={}),!this.summonerList[s][0]){var r=ObjectPool.pop("UnitMonster");r.reset(),r.infoModel=copyControl.createModel(o),r.updateModel(),r.x=this.summerPos[i]?this.summerPos[i][0]:t.x,r.y=this.summerPos[i]?this.summerPos[i][1]:t.y,r.dir=t.dir,r.scaleX=r.scaleY=t.scaleY,r.showName(!1),this.summonerList[s][0]=r}var a=this.summonerList[s][0];if(this.entityLayer.addChild(a),a.visible=!1,TimerMgr.ins().once(500,function(){a.visible=!0},this),this.sortEntity(),s&&(this.sSummonerPos[s]||(this.sSummonerPos[s]={}),this.sSummonerPos[s][0]={x:a.x,y:a.y}),o.createEff)for(var l in o.createEff){var h=o.createEff[l];if(2==h.type)SkillEffPlayShow.play(h.res,a,[a]);else{var u=ObjectPool.pop("GameMovieClip");u.visible=!0,u.alpha=1,u.x=a.x,u.y=a.y,u.playFile(SkillEffPlayShow.urlSkillEff+h.res,1),u.scaleX=u.scaleY=a.scaleY,this.bottomEffLayer.addChild(u)}}}}},e.prototype.getIdx=function(t){for(var e in this.entityList){var i=this.entityList[e];if(i==t)return e}return 0},e.prototype.reset=function(){var t=function(t){if(t instanceof GameMovieClip);else{t.playAction(UnitAction.STAND),t.visible=!0,t.filters=[];var e=t.buffList;for(var i in e)t.removeBuff(e[i])}};for(var e in this.entityList){var i=this.entityList[e];i.x=this.sEntityPos[e].x,i.y=this.sEntityPos[e].y,i.alpha=this.sEntityAlpha[e],t(i)}for(var n in this.summonerList)if(this.summonerList[n])for(var o in this.summonerList[n]){var s=this.summonerList[n][o];s.x=this.sSummonerPos[n][o].x,s.y=this.sSummonerPos[n][o].y,t(s),s.visible=!1}for(var r=function(t){egret.Tween.get(t).to({alpha:0},150).call(function(){DisplayUtils.removeFromParent(t)})},a=0;a<this.wordList.length;a++){var l=this.wordList[a];r(l)}this.wordList.length=0,this.destroyEff()},e.prototype.destroyEff=function(){for(var t=0;t<this.effList.length;t++)this.effList[t].destroy();this.effList.length=0},e.prototype.dispose=function(){if(TimerMgr.ins().removeAll(this),SkillEffPlayShow.clean(),this.entityList){for(var t in this.entityList)this.entityList[t]&&this.entityList[t].destroy();for(var e in this.summonerList)for(var i in this.summonerList[e])this.summonerList[e][i].destroy();this.destroyEff()}},e.prototype.setIsFreeze=function(t){this.isStop=t;var e=function(i){for(var n=0;n<i.numChildren;n++){var o=i.getChildAt(n);o instanceof GameMovieClip?t?o.stop():o.play():o instanceof egret.DisplayObjectContainer&&e(o)}};e(this),SkillEffPlayShow.bottomLayer&&e(SkillEffPlayShow.bottomLayer),SkillEffPlayShow.topLayer&&e(SkillEffPlayShow.topLayer),this.isStop?TimerMgr.ins().remove(this.nextPlay,this):this.showDp&&this.nextPlay()},e}(BaseComponent);__reflect(SkillShowComponent.prototype,"SkillShowComponent");var DevourEquipBarItemRender=function(t){function e(){var e=t.call(this)||this;return e.curpro=0,e.maxpro=0,e.skinName="DevourEquipBarItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.effGroup.scrollEnabled=!0,this.progressBar.visible=!1,this.effGroup.touchEnabled=!1},e.prototype.updatePro=function(t,e){this.effMc||(this.effMc=ObjectPool.pop("GameMovieClip"),this.effGroup.addChild(this.effMc)),this.effMc.playFile(PATH_EFF+"jindutiaoeff1",-1),this.effMc.scaleY=2,this.effMc.scaleX=1.25,this.effGroup.scaleX=t/e,this.curpro=t,this.maxpro=e,this.hunVal.text=t+"/",this.maxVal.text=e+""},e.prototype.setWidth=function(t){this.progressGroup.width=t},e.prototype.setaddPro=function(t){this.curpro=this.curpro+t,this.effGroup.scaleX=this.curpro/this.maxpro,this.hunVal.text=this.curpro+"/"},e}(BaseItemRender);__reflect(DevourEquipBarItemRender.prototype,"DevourEquipBarItemRender");var DevourEquipBossItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipBossItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(this.quan.visible=!1,!t||!t.bossid)return this.selectIcon.visible=!1,this.nameLabel.text=LangMgr.getValueByKey("tunshinoboss"),this.bossMc&&(this.bossMc.destroy(),this.bossMc=null),void(this.touchChildren=this.touchEnabled=!1);this.touchChildren=this.touchEnabled=!0;var e=DataCenter.ins().MonstersConfig[t.bossid];this.nameLabel.text=e.name,this.selectIcon.visible=!1,this.bossMc||(this.bossMc=ObjectPool.pop("GameMovieClip"),this.equipEff.addChild(this.bossMc)),this.bossMc.playFile(PATH_GUAIWU+("guaiwu"+e.avatar+"_3s"),-1)},e.prototype.setSelect=function(t){this.selectIcon.visible=t},e.prototype.getBossMc=function(){return this.bossMc},e}(BaseItemRender);__reflect(DevourEquipBossItemRender.prototype,"DevourEquipBossItemRender");var DevourEquipItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.equip,i=t.rp,n=e.lv;n?(this.lvNum.visible=!0,this.lvNum.text=n+""):this.lvNum.visible=!1;var o=DataCenter.ins().DevourEquipDataConfig.equipIconInfo[e.pos];this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+(n?16711680:8618883)+"&T:"+o[0]+"|"),this.redPoint.visible=i,this.equipMc||(this.equipMc=new GameMovieClip,this.equip.addChild(this.equipMc)),this.equipMc.playFile(PATH_EFF+DataCenter.ins().DevourEquipDataConfig.equipTipsInfo[e.pos],-1)},e.prototype.setSelect=function(){this.effMc||(this.effMc=new GameMovieClip,this.eff.addChild(this.effMc)),this.effMc.playFile(PATH_EFF+"yuanbg",-1)},e.prototype.setUnSelect=function(){this.effMc&&(this.effMc.destroy(),this.effMc=null)},e}(BaseItemRender);__reflect(DevourEquipItemRender.prototype,"DevourEquipItemRender");var DevourEquipUpItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DevourEquipUpItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.lv;this.visible=!0;var i,n=DataCenter.ins().DevourEquipLevelConfig[t.pos][t.curlv],o=DataCenter.ins().DevourEquipDataConfig.leevel;if(!n.cond[t.type])return void(this.visible=!1);switch(t.type){case DevourEquipPosType.chuanqi:i=DataCenter.ins().DevourEquipDataConfig.chuanQiEquipEnum[t.pos];break;case DevourEquipPosType.zhizun:i=DataCenter.ins().DevourEquipDataConfig.zhiZunEquipEnum[t.pos];break;case DevourEquipPosType.leiting:i=DataCenter.ins().DevourEquipDataConfig.thunderEquipEnum[t.pos]}var s=n.cond[t.type]?n.cond[t.type].lv:0;this.icon0.source=i[1],this.itemName.textFlow=TextUtils.generateTextFlow1("|C:"+(e>=s?3532333:15937822)+"&T:"+i[0]+o[s]+"|")},e}(BaseItemRender);__reflect(DevourEquipUpItemRender.prototype,"DevourEquipUpItemRender");var DominateControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.trinketDatas=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downInfo=function(t){for(var e=0;t.length>e;e++){var i=new DominateVo;i.init(t[e]),this.trinketDatas[i.roleId]=i}EventMgr.ins().dispatch(290)},e.prototype.downUpgrade=function(t,e,i){this.trinketDatas[t]||(this.trinketDatas[t]=new DominateVo,this.trinketDatas[t].levels=[],this.trinketDatas[t].roleId=t),this.trinketDatas[t].levels[e]=i;for(var n=1;4>=n;n++)this.trinketDatas[t].levels[n]||(this.trinketDatas[t].levels[n]=0);EventMgr.ins().dispatch(291)},e.prototype.downCompose=function(){EventMgr.ins().dispatch(292)},e.prototype.sendUpgrade=function(t,e){return[t,e]},e.prototype.sendCompose=function(t,e,i){return[t,e,i]},e.prototype.isOpen=function(){return dominateEquipControl.checkOpen()},e.getLevelInfo=function(){var t=0,e=0;return{grade:t,star:e}},e.getPosName=function(t){var e=DataCenter.ins().DominateEquipMasterSlotConfig[t];return e.name},e.getMinLvByRoleId=function(t){var e=dominateControl.trinketDatas[t];if(!e)return 0;var i=1;for(var n in e.levels)e.levels[n]<e.levels[i]&&(i=+n);return e.levels[i]},e.getEquipListInBag=function(t){for(var e=backpackControl.getBagEquipByType(33),i=e.length,n=i-1;n>-1;n--)(e[n].itemConfig.level<t.minlv||ItemUtils.getSubType(e[n].itemConfig)!=t.slot)&&e.splice(n,1);return e},e.getSuitPre=function(t){var e=this.getMinLvByRoleId(t),i=DataCenter.ins().DominateEquipBaConfig.suitAttr[e];return i||0},e.getTotalPower=function(t){if(!this.ins().trinketDatas[t])return 0;var e=this.ins().trinketDatas[t].levels,i=0;for(var n in e){var o=DataCenter.ins().DominateEquipMastLvConfig[n][e[n]];o&&(i+=BackpackControl.getAttrPower(o.attr),i+=ItemUtils.calculateRelatePower(o.attr,heroControl.getSubRoleByIndex(t)))}return i},e.getTotalPoint=function(t){if(!this.ins().trinketDatas[t])return 0;var e=this.ins().trinketDatas[t].levels,i=0;for(var n in e){var o=DataCenter.ins().DominateEquipMastLvConfig[n][e[n]];o&&(i+=o.point)}return i},e.prototype.isTrinketById=function(t){for(var e in DataCenter.ins().DominateEquipMastComConfig){var i=DataCenter.ins().DominateEquipMastComConfig[e];if(t==i.id)return!0}return!1},e.getPosById=function(t){for(var e in DataCenter.ins().DominateEquipMastComConfig){var i=DataCenter.ins().DominateEquipMastComConfig[e];if(t==i.id)return+e}return 0},e.checkHasInBag=function(t){var e=DataCenter.ins().DominateEquipMastComConfig[t].id,i=backpackControl.getBagItemById(e);return i},e.getSuitLv=function(t){var e=DataCenter.ins().DominateEquipBaConfig.suitShow;for(var i in e)if(t>=e[i][0]&&t<=e[i][1])return+i;return 1},e.getNextSuitLv=function(t){var e=DataCenter.ins().DominateEquipBaConfig.suitAttr[t];for(var i in DataCenter.ins().DominateEquipBaConfig.suitAttr)if(DataCenter.ins().DominateEquipBaConfig.suitAttr[i]>e)return+i;return t},__decorate([down(1,[ByteConst.DominateVos])],e.prototype,"downInfo",null),__decorate([down(2,[1,1,3])],e.prototype,"downUpgrade",null),__decorate([down(3)],e.prototype,"downCompose",null),__decorate([up(2,[1,1])],e.prototype,"sendUpgrade",null),__decorate([up(3,[1,1,[10]])],e.prototype,"sendCompose",null),e=__decorate([protocolsId(36)],e)}(BaseSystem);__reflect(DominateControl.prototype,"DominateControl");var DominateEquipControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upWear=function(t,e,i){return[t,e,i]},e.prototype.downMaterEquip=function(t,e,i,n,o,s,r){var a,l=heroControl.getSubRoleByIndex(t);if(l){l.masterEquips||(l.masterEquips=[]);var h=l.masterEquips[e];h||(h=new ItemData,l.masterEquips[e]=h),h.init([i,n,o,s,r]),a={index:t,pos:e}}EventMgr.ins().dispatch(549,a)},e.prototype.upCompound=function(t,e,i){return[t,e,i]},e.prototype.upDecompose=function(t){return[t]},e.prototype.checkOpen=function(){return reincarnateControl.lv<DataCenter.ins().DominateEquipBaConfig.openZsLevel||GameServer.serverOpenDay<DataCenter.ins().DominateEquipBaConfig.openDay-1?!1:!0},e.prototype.getEquip=function(t,e){var i=heroControl.getSubRoleByIndex(t);return i&&i.masterEquips?i.masterEquips[e]:null},e.prototype.checkRedByPos=function(t,e){var i=DataCenter.ins().DominateEquipComConfig[e];if(this.hasCanReplaceEquip(t,e,i?1:0))return!0;if(i){var n=this.getEquip(t,e),o=!(!n||!n.itemConfig),s=o?DataCenter.ins().DominateEquipComConfig[n.configID]:i;if(!s)return!1;var r=backpackControl.getBagGoodsCountById(0,s.needItem.id);if(r<s.needItem.count)return!1;for(var a=s.needEquip,l=a.length,h=0;l>h;h++){var u=a[h],p=backpackControl.checkHasEquipByFilter({type:33,pos:u.slot,minLv:u.minlv});if(!p)return!1}return!0}return!1},e.prototype.hasCanReplaceEquip=function(t,e,i){void 0===i&&(i=0);var n=backpackControl.bagModel[BackpackControl.BAG_TYPE_EQUIP];if(!n||!n.length)return!1;for(var o=this.getEquip(t,e),s=!(!o||!o.itemConfig),r=s?o.itemConfig.level+i:0,a=reincarnateControl.lv,l=s?this.getMasterEquipPower(o,t):0,h=0;h<n.length;h++){var u=n[h],p=u.itemConfig;if(33==ItemUtils.getType(p)&&p.level>=r&&p.zsLevel<=a){var c=DataCenter.ins().ItemDescConfig[p.descIndex];if(c.subType==e&&this.getMasterEquipPower(u,t)>l)return!0}}return!1},e.prototype.getExchangeEquips=function(t,e,i){void 0===i&&(i=0);var n=this.getEquip(t,e),o=n&&n.itemConfig?!0:!1,s=backpackControl.getEquipByFilter({type:33,pos:e,minLv:o?n.itemConfig.level+i:0});if(s&&s.length){for(var r=o?this.getMasterEquipPower(n,t):0,a=s.length,l=[],h=0;a>h;h++){var u=s[h];this.getMasterEquipPower(u,t)>r&&l.push(u)}s=l}return s},e.prototype.checkRed=function(){if(!this.checkOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)for(var i=0;7>=i;i++)if(this.checkRedByPos(e,i))return!0;return!1},e.prototype.checkRedByRoleIndex=function(t){for(var e=0;7>=e;e++)if(this.checkRedByPos(t,e))return!0;return!1},e.prototype.getScoreByItemID=function(t){var e=DataCenter.ins().DominateEquipPointConfig[t];return e?e.point:0},e.prototype.getScoreByRoleIndex=function(t){var e=heroControl.getSubRoleByIndex(t);if(!e||!e.masterEquips)return 0;for(var i=e.masterEquips.length,n=0,o=0;i>o;o++){var s=e.masterEquips[o];s.itemConfig&&(n+=this.getScoreByItemID(s.configID))}return n},e.prototype.getTotalScore=function(){for(var t=heroControl.subRolesLen,e=0,i=0;t>i;i++)e+=this.getScoreByRoleIndex(i),e+=DominateControl.getTotalPoint(i);return e},e.prototype.addSuitPerEquipAttr=function(t,e){if(!t)return[];var i=DominateControl.getSuitPre(e);return AttributeData.getAttrStarAdd(t,1+i/100)},e.prototype.getMasterEquipPower=function(t,e){if(void 0===e&&(e=0),!t||!t.itemConfig)return 0;var i=heroControl.getSubRoleByIndex(e),n=BackpackControl.getAttrPower(this.addSuitPerEquipAttr(t.att,e),i);n+=BackpackControl.getAttrPower(this.addSuitPerEquipAttr(this.getEquipBaseAtts(t.configID),e),i);var o=DataCenter.ins().EquipConfig[t.configID],s=[];o.baseAttr1&&s.push(new AttributeData(o.baseAttr1.type,o.baseAttr1.value)),o.baseAttr2&&s.push(new AttributeData(o.baseAttr2.type,o.baseAttr2.value));for(var r=s.length,a=0;r>a;a++)n+=ItemUtils.relatePower(s[a],i);var l=ItemUtils.relatePowerEx(s,i);return l&&l.length&&(n+=BackpackControl.getAttrPower(l)),n},e.prototype.getEquipBaseAtts=function(t){var e=DataCenter.ins().EquipConfig[t],i=[];return e.hp&&i.push(new AttributeData(2,e.hp)),e.atk&&i.push(new AttributeData(4,e.atk)),e.def&&i.push(new AttributeData(5,e.def)),e.res&&i.push(new AttributeData(6,e.res)),i},e.prototype.getEquipRandomAtts=function(t){var e=DataCenter.ins().EquipConfig[t.configID],i=null==t.att,n=[];return e.hp&&n.push(i?new AttributeData(2,0):this.getRandomAtt(t,2)),e.atk&&n.push(i?new AttributeData(4,0):this.getRandomAtt(t,4)),e.def&&n.push(i?new AttributeData(5,0):this.getRandomAtt(t,5)),e.res&&n.push(i?new AttributeData(6,0):this.getRandomAtt(t,6)),n},e.prototype.getBaseAttStr=function(t,e){void 0===e&&(e=":");var i=AttributeData.getAttStr(dominateEquipControl.getEquipBaseAtts(t),0,1,e),n=DataCenter.ins().EquipConfig[t],o=[];return n.baseAttr1&&o.push(new AttributeData(n.baseAttr1.type,n.baseAttr1.value)),n.baseAttr2&&o.push(new AttributeData(n.baseAttr2.type,n.baseAttr2.value)),o.length&&(i+="\n|C:16711935&T:"+AttributeData.getAttStrEx(o,0,1,e)+"|"),i},e.prototype.getRandomAtt=function(t,e){for(var i=t.att.length,n=0;i>n;n++){var o=t.att[n];if(o.type==e)return new AttributeData(e,o.value)}return new AttributeData(0,0)},e.prototype.getPosMinLv=function(t){for(var e=heroControl.subRolesLen,i=Number.MAX_VALUE,n=0;e>n;n++){var o=this.getEquip(n,t);o&&o.itemConfig?o.itemConfig.level<i&&(i=o.itemConfig.level):i=0}return i==Number.MAX_VALUE?0:i},e.prototype.upExtract=function(t){return[t]},e.prototype.downExtract=function(t){for(var e=[],i=0;t.length>i;i++){var n=new RewardVo;n.type=t[i][0],n.id=t[i][1],n.count=t[i][2],e.push(n)}EventMgr.ins().dispatch(572,e[0])},e.prototype.getExtractEquips=function(){var t=backpackControl.getBagItemByType(33,BackpackControl.BAG_TYPE_EQUIP);if(!t||!t.length)return null;for(var e=heroControl.subRolesLen,i=[],n=0;7>=n;n++)if(0!=n&&2!=n){for(var o=Number.MAX_VALUE,s=0;e>s;s++){var r=this.getEquip(s,n);if(!r||!r.itemConfig){o=0;break}var a=this.getMasterEquipPower(r,s);o>a&&(o=a)}i[n]=o}else i[n]=0;for(var l=t.length,h=[],u=0;l>u;u++){var p=t[u],c=DataCenter.ins().ItemDescConfig[p.itemConfig.descIndex].subType;0!=c&&2!=c&&this.getMEBagItemPower(p)<=i[c]&&h.push(p)}return h.length>=3?h:null},e.prototype.getMEBagItemPower=function(t){for(var e=heroControl.subRolesLen,i=Number.MAX_VALUE,n=0;e>n;n++){var o=this.getMasterEquipPower(t,n);i>o&&(i=o)}return i==Number.MAX_VALUE?0:i},e.prototype.checkExtractRed=function(){return this.getExtractEquips()?!0:!1},__decorate([up(16,[2,10,2])],e.prototype,"upWear",null),__decorate([down(16,[2,2].concat(ByteConst.ItemDatas))],e.prototype,"downMaterEquip",null),__decorate([up(17,[2,2,[10]])],e.prototype,"upCompound",null),__decorate([up(18,[10])],e.prototype,"upDecompose",null),__decorate([up(19,[[10]])],e.prototype,"upExtract",null),__decorate([down(19,[[3,3,3]])],e.prototype,"downExtract",null),e=__decorate([protocolsId(4)],e)}(BaseSystem);__reflect(DominateEquipControl.prototype,"DominateEquipControl");var AmusementOpenServerView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementWinViewSkin",e}return __extends(e,t),e.openCheck=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return SwitchMgr.ins().checkOpen(2,!0)?(e[2]=function(t,e){return Boolean(t.pageType)||2==t.timeType||3==t.timeType},e[3]=function(t,e){return Boolean(t.pageType)},t.openCheck.apply(this,e)):!1},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.apply(this,e),this.updateView(),this.addCustomEvent(392,this.refushRedPoint),this.addCustomEvent(178,this.refushRedPoint),this.addCustomEvent(180,this.refushRedPoint),this.addCustomEvent(182,this.refushRedPoint),this.addCustomEvent(446,this.refushRedPoint),this.addCustomEvent(437,this.refushRedPoint)},e.prototype.activityFiltrate=function(t){return Boolean(t.pageType)||2==t.timeType||3==t.timeType},e.prototype.pActivityFiltrate=function(t){return t.pageType!=this.pageType},e}(AmusementBaseView);__reflect(AmusementOpenServerView.prototype,"AmusementOpenServerView");var AmusementTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t,e){this.skinName=t,this.ruleId=e,this.addEventTouchTap(this,this.onTouch)
},e.prototype.onTouch=function(){if(!this.ruleId)return void UIMgr.ins().close(this);var t=UIMgr.playFun;if(!t)return void UIMgr.ins().close(this);this.bg.visible=!1;var i=this.ruleId,n=t.getRuleById(i),o=n.tar;if(o){var s=egret.Tween.get(this.img),r=o.localToGlobal();this.img.parent.globalToLocal(r.x+o.width/2,r.y+o.height/2,r),s.to({scaleX:0,scaleY:0,x:r.x,y:r.y},500).call(function(){UIMgr.ins().close(e)})}},e}(BaseEuiView);__reflect(AmusementTipsView.prototype,"AmusementTipsView");var DominateVo=function(){function t(){}return t.prototype.init=function(t){this.roleId=t[0],this.levels=[];for(var e=0;t[1].length>e;e++)this.levels[e+1]=t[1][e]},t}();__reflect(DominateVo.prototype,"DominateVo");var DominateChooseView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipChangeViewSkin",e.uilayer=GameLayer.POPUP,e.list.itemRenderer=DominateTrinkChItemRenderer,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.list.dataProvider=new eui.ArrayCollection(i),this.chooseFun=t[1],this.titleLabel.text=LangMgr.getValueByKey("dominaTips11"),this.tipLabel.visible=0==i.length,this.tipLabel.text=LangMgr.getValueByKey("dominaTips12"),this.addEventTouchTap(this.list,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouchClose)},e.prototype.onTouch=function(t){if(t.target instanceof eui.Button){var e=t.target.parent.data;this.chooseFun&&this.chooseFun(e.itemData),UIMgr.ins().close(this)}},e.prototype.onTouchClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DominateChooseView.prototype,"DominateChooseView");var DominateComposeView=function(t){function e(){var e=t.call(this)||this;e.roleId=-1,e.itemEnough=!1,e.skinName="DominateComposeViewSkin",e.uilayer=GameLayer.POPUP;for(var i=[],n=1;4>=n;n++){var o=DataCenter.ins().DominateEquipMastComConfig[n],s=DataCenter.ins().ItemConfig[o.id];i.push(s.name)}return e.tab.dataProvider=new eui.ArrayCollection(i),e.tab.selectedIndex=0,e.target.touchChildren=!1,e.equip1.touchChildren=!1,e.equip2.touchChildren=!1,e.composeItemIds=[],TimerMgr.ins().doTimer(200,1,e.initTab,e),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.composeBtn,this.onTouch),this.addEventTouchTap(this.equip1,this.onTouch),this.addEventTouchTap(this.equip2,this.onTouch),this.addEventTouchTap(this.target,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventChange(this.tab,this.onChange),this.addCustomEvent(292,this.onCompose),this.addCustomEvent(269,this.upMaterData),this.addCustomEvent(268,this.upMaterData),this.addCustomEvent(266,this.upMaterData),this.addCustomEvent(571,this.refRedpoint),isNaN(t[0])||(this.roleId=t[0],this.tab.selectedIndex=+t[1]-1),this.onChange(),this.upMaterData(),this.initEff()},e.prototype.initTab=function(){for(var t=0;t<this.tab.numElements;t++){var e=this.tab.getElementAt(t);e&&(e.IconImg.source=DataCenter.ins().DominateEquipMasterSlotConfig[t+1].tabBg,e.IconImg.visible=!0)}this.refRedpoint()},e.prototype.initEff=function(){var t=new GameMovieClip;t.playFile(PATH_EFF+"jljdt",-1),this.trieff0.addChild(t),t.x+=5,t.scaleX=0,t.scaleY=.6,this.trieff0.visible=!0;var e=new GameMovieClip;e.playFile(PATH_EFF+"jljdt",-1),this.trieff1.addChild(e),e.scaleX=0,e.scaleY=.6,this.trieff1.visible=!0;var i=new GameMovieClip;i.playFile(PATH_EFF+"jljdt",-1),this.trieff2.addChild(i),i.scaleX=0,i.scaleY=.6,this.trieff2.visible=!0;var n=egret.Tween.get(t),o=egret.Tween.get(e),s=egret.Tween.get(i);n.to({scaleX:.1},350),o.to({scaleX:.1},350),s.to({scaleX:.1},350)},e.prototype.onChange=function(){this.dps=DataCenter.ins().DominateEquipMastComConfig[this.tab.selectedIndex+1],this.upData(),this.clearEquip(),this.refRedpoint()},e.prototype.upData=function(){this.composeItemIds[0]=0,this.target.setDataPub(DataCenter.ins().DominateEquipMastLvConfig[this.tab.selectedIndex+1][1]),this.selectEquipDt1&&(this.equip1.data={itemData:this.selectEquipDt1,showRed:!1,pos:this.dps.compose[1].slot}),this.selectEquipDt2&&(this.equip2.data={itemData:this.selectEquipDt2,showRed:!1,pos:this.dps.compose[2].slot})},e.prototype.upMaterData=function(){var t=this.dps.compose[0],e=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t.id);this.item1.data=t.id,this.item1.setCountEx(e+"/"+t.count),e<t.count?this.item1.setCountEx("|C:"+ColorUtils.RED+"&T:"+e+"|/"+t.count):this.item1.setCountEx(e+"/"+t.count),this.itemEnough=e>=t.count},e.prototype.onCompose=function(){this.clearEquip(),this.flyToBag(),tipsControl.showCenterTips(LangMgr.getValueByKey("dominaTips8"))},e.prototype.clearEquip=function(){this.equip1.data={pos:this.dps.compose[1].slot},this.equip1.equipName.textFlow=TextUtils.generateTextFlow1(this.dps.compose[1].name),this.equip2.data={pos:this.dps.compose[2].slot},this.equip2.equipName.textFlow=TextUtils.generateTextFlow1(this.dps.compose[2].name),this.selectEquipDt1=null,this.selectEquipDt2=null,this.composeRed.visible=!1},e.prototype.flyToBag=function(){var t=this;this.flyIcon||(this.flyIcon=new eui.Image);var e=this.target.itemIcon.imgIcon;this.flyIcon.source=e.source,this.flyIcon.x=this.target.x+e.width,this.flyIcon.y=this.target.y+e.height,this.flyIcon.width=e.width,this.flyIcon.height=e.height,this.addChild(this.flyIcon);var i=UIMgr.ins().getView(GameBottomView),n=i.getBagBtn(),o=n.parent.localToGlobal(n.x+n.width/2-this.flyIcon.width/4,n.y+n.height/2-this.flyIcon.width/4);egret.Tween.get(this.flyIcon).to({x:o.x,y:o.y},1700,egret.Ease.sineOut).call(function(){DisplayUtils.removeFromParent(t.flyIcon)})},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.target:CommonFun.viewItemTips(this.dps.id);break;case this.equip1:this.chooseEquip(1);break;case this.equip2:this.chooseEquip(2);break;case this.composeBtn:if(!this.itemEnough)return void tipsControl.showTips(LangMgr.getValueByKey("dominaTips9"));if(!this.selectEquipDt1||!this.selectEquipDt2)return void tipsControl.showTips(LangMgr.getValueByKey("dominaTips10"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);dominateControl.sendCompose(this.roleId,this.tab.selectedIndex+1,this.composeItemIds)}},e.prototype.chooseEquip=function(t){var e=this,i=DominateControl.getEquipListInBag(this.dps.compose[t]);i.sort(this.comparnFn);for(var n=[],o=0;o<i.length;o++)1==t&&this.selectEquipDt2&&this.selectEquipDt2.handle==i[o].handle||2==t&&this.selectEquipDt1&&this.selectEquipDt1.handle==i[o].handle||n.push({itemData:i[o],isBest:0==o});UIMgr.ins().open(DominateChooseView,n,function(i){e["selectEquipDt"+t]=i,e.composeItemIds[t]=i.handle,e.upData(),e.composeRed.visible=e.selectEquipDt1&&e.selectEquipDt2&&e.itemEnough})},e.prototype.comparnFn=function(t,e){var i=BackpackControl.getAttrPower(dominateEquipControl.getEquipRandomAtts(t)),n=BackpackControl.getAttrPower(dominateEquipControl.getEquipRandomAtts(e));return i+=BackpackControl.getAttrPower(dominateEquipControl.getEquipBaseAtts(t.configID)),n+=BackpackControl.getAttrPower(dominateEquipControl.getEquipBaseAtts(e.configID)),i>n?1:n>i?-1:0},e.prototype.refRedpoint=function(){var t=DominateRedpoint.ins();this.equip1.redPoint.visible=!this.selectEquipDt1&&DominateControl.getEquipListInBag(this.dps.compose[1]).length>0,this.equip2.redPoint.visible=!this.selectEquipDt2&&DominateControl.getEquipListInBag(this.dps.compose[2]).length>0;for(var e=0;e<this.tab.numElements;e++){var i=this.tab.getElementAt(e);i&&(i.pointRed.visible=!!t.redpoints_1[this.roleId][e+1])}},e}(BaseEuiView);__reflect(DominateComposeView.prototype,"DominateComposeView");var DominateEquipChangeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipChangeViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=DominateChangeItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleIndex=t[0],this._pos=t[1],this._itemData=t[2],this._filter={type:33,pos:this._pos,minLv:this._itemData?this._itemData.itemConfig.level:0},this.addEventTouchTap(this.list,this.onListTouch),this.addEventTouchTap(this.bgClose,this.onClose),this.update()},e.prototype.close=function(){this._filter=null,this._itemData=null},e.prototype.update=function(){var t=backpackControl.getEquipByFilter(this._filter);t&&t.length?(t.sort(this.sort),this.tipLabel.visible=!1):this.tipLabel.visible=!0;var e=[],i=0;this._itemData&&(e.push({itemData:this._itemData,isMine:!0,isBest:!1}),i=dominateEquipControl.getMasterEquipPower(this._itemData));for(var n=t?t.length:0,o=0;n>o;o++)e.push({itemData:t[o],isMine:!1,isBest:0==o&&dominateEquipControl.getMasterEquipPower(t[o])>i});this.list.dataProvider=new eui.ArrayCollection(e)},e.prototype.sort=function(t,e){var i=dominateEquipControl.getMasterEquipPower(t),n=dominateEquipControl.getMasterEquipPower(e);return i>n?-1:n>i?1:0},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=this.list.selectedItem;if(!e)return;dominateEquipControl.upWear(this._roleIndex,e.itemData.handle,this._filter.pos),UIMgr.ins().close(this)}},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DominateEquipChangeView.prototype,"DominateEquipChangeView");var DominateEquipComposeView=function(t){function e(){var e=t.call(this)||this;return e._curEquip=0,e.skinName="DominateEquipComposeViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleIndex=t[0],this._pos=t[1],this._itemData=t[2],this._showRed=t[3],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.cleanEff()},e.prototype.update=function(){this.equip0.data={pos:this._pos,itemData:this._itemData,showRed:!1},this._itemData||this.equip0.setEquipName(LangMgr.getValueByKey("dominaTips7"));var t=DataCenter.ins().DominateEquipComConfig[this._itemData?this._itemData.configID:this._pos],e=new RewardVo;e.id=t.needItem.id,e.type=t.needItem.type,e.count=t.needItem.count;var i=backpackControl.getBagGoodsCountById(0,e.id);this.item1.data=e,this.item1.setCountEx("|C:"+(i>=e.count?65280:16711680)+"&T:"+i+"|/"+e.count);var n=new ItemData;n.configID=t.itemId,this.target.data={pos:this._pos,itemData:n,showRed:!1};for(var o=t.needEquip.length,s=0;o>s;s++){var r=t.needEquip[s],a=this["equip"+(s+1)];a.data={pos:r.slot,itemData:null,showRed:this._showRed},a.name=(s+1).toString(),a.setEquipName(r.name)}this._equips=[],this.playEff()},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.composeBtn:if(!this.canCompose())return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));dominateEquipControl.upCompound(this._roleIndex,this._pos,this._equips),UIMgr.ins().close(this);break;case this.equip1:case this.equip2:case this.equip3:this._curEquip=Number(t.target.name);var e=DataCenter.ins().DominateEquipComConfig[this._itemData?this._itemData.configID:this._pos],i=e.needEquip[this._curEquip-1];UIMgr.ins().open(DominateEquipSelectView,{type:33,pos:i.slot,minLv:i.minlv},this.callBack,this);break;case this.target:var n=DataCenter.ins().DominateEquipComConfig[this._itemData?this._itemData.configID:this._pos],o=new ItemData;o.configID=n.itemId,UIMgr.ins().open(DominateEquipTakeTipsView,o,!0)}},e.prototype.canCompose=function(){if(!this._showRed)return!1;if(this._equips.length<3)return!1;for(var t=0;3>t;t++)if(0==this._equips[t])return!1;return!0},e.prototype.callBack=function(t){this._equips[this._curEquip-1]=t.handle;var e=this["equip"+this._curEquip],i=e.data;e.data={pos:i.pos,itemData:t,showRed:!1}},e.prototype.playEff=function(){var t="jljdt",e=new GameMovieClip;e.playFile(PATH_EFF+t,-1),this.leftEff.addChild(e),e.scaleX=.15,e.scaleY=.6;var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),this.rightEff.addChild(i),i.scaleX=.17,i.scaleY=.6,i.y=-1.1;var n=new GameMovieClip;n.playFile(PATH_EFF+t,-1),this.buttonEff.addChild(n),n.x=11.6,n.y=2,n.scaleX=.29,n.scaleY=.6,n.$setRotation(90);var o=new GameMovieClip;o.playFile(PATH_EFF+t,-1),this.leftEff2.addChild(o),o.scaleX=.095,o.scaleY=.4;var s=new GameMovieClip;s.playFile(PATH_EFF+t,-1),this.rightEff2.addChild(s),s.scaleX=.1,s.scaleY=.4,s.y=-2;var r=new GameMovieClip;r.playFile(PATH_EFF+t,-1),this.leftEff3.addChild(r),r.scaleX=.17,r.scaleY=.4;var a=new GameMovieClip;a.playFile(PATH_EFF+t,-1),this.rightEff3.addChild(a),a.scaleX=.17,a.scaleY=.4;var l=new GameMovieClip;l.playFile(PATH_EFF+t,-1),this.leftEff4.addChild(l),l.scaleX=.1,l.scaleY=.4;var h=new GameMovieClip;h.playFile(PATH_EFF+t,-1),this.rightEff4.addChild(h),h.scaleX=.1,h.scaleY=.4,h.y=-1.5;var u=ObjectPool.pop("GameMovieClip");u.playFile(PATH_EFF+t,-1),this.upEff1.addChild(u),u.scaleX=.1,u.scaleY=1,u.$setRotation(90),u.x=16;var p=ObjectPool.pop("GameMovieClip");p.playFile(PATH_EFF+t,-1),this.upEff2.addChild(p),p.scaleX=.1,p.scaleY=1,p.$setRotation(90),p.x=16;var c=ObjectPool.pop("GameMovieClip");c.playFile(PATH_EFF+t,-1),this.upEff3.addChild(c),c.scaleX=.1,c.scaleY=1,c.$setRotation(90),c.x=16;var d=ObjectPool.pop("GameMovieClip");d.playFile(PATH_EFF+t,-1),this.upEff4.addChild(d),d.scaleX=.1,d.scaleY=1,d.$setRotation(90),d.x=16;var g=ObjectPool.pop("GameMovieClip");g.playFile(PATH_EFF+t,-1),this.bottomRightEff.addChild(g),g.scaleX=.3,g.scaleY=.8,g.x=2,g.y=-3;var m=ObjectPool.pop("GameMovieClip");m.playFile(PATH_EFF+t,-1),this.bottomLeftEff.addChild(m),m.scaleX=.28,m.scaleY=.8,m.y=-2,m.x=1.5},e.prototype.cleanEff=function(){this.clearChildrens(this.leftEff),this.clearChildrens(this.rightEff),this.clearChildrens(this.buttonEff),this.clearChildrens(this.leftEff2),this.clearChildrens(this.rightEff2),this.clearChildrens(this.leftEff3),this.clearChildrens(this.rightEff3),this.clearChildrens(this.leftEff4),this.clearChildrens(this.rightEff4),this.clearChildrens(this.upEff1),this.clearChildrens(this.upEff2),this.clearChildrens(this.upEff3),this.clearChildrens(this.upEff4),this.clearChildrens(this.bottomRightEff),this.clearChildrens(this.bottomLeftEff)},e.prototype.clearChildrens=function(t){if(t)for(;t.numChildren>0;){var e=t.removeChildAt(0);e instanceof GameMovieClip&&e.destroy()}},e}(BaseEuiView);__reflect(DominateEquipComposeView.prototype,"DominateEquipComposeView");var DominateEquipPanel=function(t){function e(){var e=t.call(this)||this;return e.beforeIndex=-1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.touchEnabled=!1,this.touchChildren=!0,this.role0.touchChildren=this.role0.touchEnabled=!1,this.role1.touchChildren=this.role1.touchEnabled=!1,this.pos10.touchChildren=!1,this.pos11.touchChildren=!1,this.pos12.touchChildren=!1,this.pos13.touchChildren=!1,this.pos10.name="1",this.pos11.name="2",this.pos12.name="3",this.pos13.name="4",this.pos10.redPoint.visible=!1,this.pos11.redPoint.visible=!1,this.pos12.redPoint.visible=!1,this.pos13.redPoint.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.addCustomEvent(549,this.equipChange),this.addCustomEvent(65,this.setEffect),this.addCustomEvent(142,this.setEffect),this.addCustomEvent(711,this.setEffect),this.addCustomEvent(295,this.setEffect),this.addCustomEvent(266,this.updateEquips),this.addCustomEvent(267,this.updateEquips),this.addCustomEvent(268,this.updateEquips),this.addCustomEvent(291,this.upTrinketDt),this.addCustomEvent(292,this.upTrinketDt),this.addCustomEvent(571,this.upTrinketRedpoint),this.addEventTouchTap(this.base,this.onTouch),this.clearChangeEff(),-1!=this.beforeIndex?this.roleChange(this.beforeIndex,this.curRole):this.role0.data=heroControl.getSubRoleByIndex(this.curRole),this.beforeIndex=this.curRole,this.updateEquips(),this.upTrinketDt(),this.upTrinketRedpoint(),this.hideMix()},e.prototype.close=function(){this.clearTweens(),this.removeCustomEvents(),this.removeEventTouchTap(this.base,this.onTouch),this._openList=null},e.prototype.upTrinketDt=function(){for(var t=1;5>t;t++){var e=this["pos"+(9+t)];e.setData(this.curRole,t)}this.updateScore()},e.prototype.upTrinketRedpoint=function(){DominateRedpoint.ins().redpoints[this.curRole]&&(this.pos10.redPoint.visible=!!DominateRedpoint.ins().redpoints[this.curRole][1],this.pos11.redPoint.visible=!!DominateRedpoint.ins().redpoints[this.curRole][2],this.pos12.redPoint.visible=!!DominateRedpoint.ins().redpoints[this.curRole][3],this.pos13.redPoint.visible=!!DominateRedpoint.ins().redpoints[this.curRole][4])},e.prototype.equipChange=function(t){if(t&&t.index==this.curRole){var e=dominateEquipControl.getEquip(t.index,t.pos);this["pos"+t.pos].data={pos:t.pos,itemData:e,showRed:dominateEquipControl.checkRedByPos(t.index,t.pos)},this._openList||(this._openList=[]),this._openList[t.pos]=e&&e.itemConfig?e.itemConfig.level:0,this.updateSkills()}},e.prototype.updateEquips=function(){this._openList||(this._openList=[]);for(var t=0;t<e.MAX_LEN;t++){var i=dominateEquipControl.getEquip(this.curRole,t);this["pos"+t].data={pos:t,itemData:i,showRed:dominateEquipControl.checkRedByPos(this.curRole,t)},this._openList[t]=i&&i.itemConfig?i.itemConfig.level:0}this.updateSkills(),this.redPoint.visible=dominateEquipControl.checkExtractRed()},e.prototype.updateSkills=function(){for(var t=1;3>=t;t++)this["equipSkill"+t].data={id:t,openInfo:this._openList?this._openList.concat():null,maxLen:e.MAX_LEN};this.updateScore()},e.prototype.updateScore=function(){this.materPoint.text=LangMgr.getValueByKey("dominaScore",dominateEquipControl.getScoreByRoleIndex(this.curRole)+DominateControl.getTotalPoint(this.curRole));for(var t=0,i=0;i<e.MAX_LEN;i++){var n=dominateEquipControl.getEquip(this.curRole,i);t+=dominateEquipControl.getMasterEquipPower(n,this.curRole)}t+=DominateControl.getTotalPower(this.curRole);for(var o=heroControl.getSubRoleByIndex(this.curRole),s=0,i=1;3>=i;i++)this.isSkillOpen(i)&&(s=i);if(s>0){var r=DataCenter.ins().DominateEquipLvConfig[s];t+=BackpackControl.getAttrPower(r.exAttrs,o),t+=r.ex_power,t+=BackpackControl.getAttrPower(r.attrs,o)}this.powerPanel.setPower(t)},e.prototype.isSkillOpen=function(t){if(!this._openList||this._openList.length<e.MAX_LEN)return!1;for(var i=DataCenter.ins().DominateEquipLvConfig[t],n=this._openList.length,o=0;n>o;o++)if(this._openList[o]<i.level)return!1;return!0},e.prototype.clearChangeEff=function(){egret.Tween.removeTweens(this.role0),egret.Tween.removeTweens(this.role1),this.role0.x=0,this.role1.x=580,this.role0.alpha=1,this.role1.alpha=0,this.role1.visible=!1,this.role0.data=heroControl.getSubRoleByIndex(this.curRole)},e.prototype.clearTweens=function(){egret.Tween.removeTweens(this.role0),egret.Tween.removeTweens(this.role1)},e.prototype.roleChange=function(t,e){var i=this;if(t==e)return void this.clearChangeEff();this.role1.visible=!0,this.role0.data=heroControl.getSubRoleByIndex(t),this.role1.data=heroControl.getSubRoleByIndex(e);var n=egret.Tween.get(this.role0),o=egret.Tween.get(this.role1);e>t?(this.role1.x=563,n.to({x:-563,alpha:0},600),o.to({x:-19,alpha:1},600).call(function(){i.clearChangeEff(),i.setEffect()},this)):(this.role1.x=-563,n.to({x:563,alpha:0},600),o.to({x:-19,alpha:1},600).call(function(){i.clearChangeEff(),i.setEffect()},this))},e.prototype.setEffect=function(){this.role0.data=heroControl.getSubRoleByIndex(this.curRole)},e.prototype.setSuit=function(t,e,i){DisplayUtils.removeFromParent(i);var n=heroControl.getSubRoleByIndex(t),o=n.heirloom.getSuitConfig(n);if(o){i.parent||e.parent.addChildAt(i,e.parent.getChildIndex(e));var s=DataCenter.ins().HeirloomEquipSetConfig[o.lv];i.playFile(PATH_EFF+s.neff,-1)}},e.prototype.setWeaponsSuit=function(t,e,i,n){var o=heroControl.getSubRoleByIndex(t);n.x=this[e+o.job].x,n.y=this[e+o.job].y,n.rotation=this[e+o.job].rotation,DisplayUtils.removeFromParent(n);var s=o.weapons.weaponsId,r=o.hideWeapons();if(!r&&s){n.parent||i.addChild(n);var a=DataCenter.ins().WeaponSoulConfig[s];n.playFile(PATH_EFF+a.inside[o.job-1],-1)}},e.prototype.getZhuangbanById=function(t){for(var e in DataCenter.ins().FashionIdConfig)if(DataCenter.ins().FashionIdConfig[e].id==t)return DataCenter.ins().FashionIdConfig[e];return null},e.prototype.onTouch=function(t){var e=this;switch(t.target){case this.pos10:case this.pos11:case this.pos12:case this.pos13:var i=t.target.name,n=dominateControl.trinketDatas[this.curRole]&&dominateControl.trinketDatas[this.curRole].levels[i]||0;if(n>0&&t.target.itemCfg)UIMgr.ins().open(DominateTipsView,t.target.itemCfg,this.curRole,!0);else{var o=DominateControl.checkHasInBag(i);o?warnControl.show(LangMgr.getValueByKey("dominaTips5",o.itemConfig.name),function(){dominateControl.sendUpgrade(e.curRole,i)},this,function(){UIMgr.ins().open(DominateComposeView,e.curRole,i)},this):UIMgr.ins().open(DominateComposeView,this.curRole,i)}break;case this.turnMixBtn:this.base.visible=!1,this.mix.visible=!0,this.mix.open();break;default:if(t.target instanceof DominateSkillItemRenderer)UIMgr.ins().open(DominateEquipSkillTipsView,t.target.data);else if(t.target instanceof DominateEquipItemRender){var s=t.target.data,r=DataCenter.ins().DominateEquipComConfig[s.pos],o=s.itemData,a=o&&o.itemConfig?!0:!1;if(r){if(s.showRed){var l=dominateEquipControl.getExchangeEquips(this.curRole,s.pos,1);if(l&&l.length){for(var h=0,u=0,p=0;p<l.length;p++){var c=l[p].itemConfig.level;c>h&&(h=c,u=p)}var d=l[u];return void warnControl.show(LangMgr.getValueByKey("dominaTips6",d.itemConfig.name),function(){dominateEquipControl.upWear(e.curRole,d.handle,s.pos)},this)}}a?UIMgr.ins().open(DominateEquipTipsView,this.curRole,s.pos,o.copy(),s.showRed):UIMgr.ins().open(DominateEquipComposeView,this.curRole,s.pos,null,s.showRed)}else a?UIMgr.ins().open(DominateEquipTipsView,this.curRole,s.pos,o.copy(),s.showRed):UIMgr.ins().open(DominateEquipChangeView,this.curRole,s.pos,null)}}},e.prototype.hideMix=function(){this.mix.visible=!1,this.mix.close(),this.base.visible=!0},e.MAX_LEN=8,e}(BasePanel);__reflect(DominateEquipPanel.prototype,"DominateEquipPanel");var DominateEquipResolvePanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.turn.textFlow=TextUtils.generateTextFlow("|U:&T:"+this.turn.text),this.turn.touchEnabled=!0,this.list.itemRenderer=DominateEquipItemRender},e.prototype.open=function(){this.addCustomEvent(572,this.onExtractBack),this.addEventTouchTap(this.turn,this.onLink),this.addEventTouchTap(this.list,this.onList),this.addEventTouchTap(this.activityBtn,this.onExtract),this.update();var t=UIMgr.ins().getView("HeirloomView");t&&t.hideRole()},e.prototype.close=function(){this._isExtract=!1,this._playListMc=!1,this._items&&(this._items.length=0,this._items=null),this._col=null;for(var t=0;3>t;t++){var e=this["materialItem"+t];this.removeEventTouchTap(e,this.onItemTouch)}this.clearListMc(),this.clearBtnMc(),this.clearMc();var i=UIMgr.ins().getView("HeirloomView");i&&i.openRole()},e.prototype.onExtractBack=function(t){var e=new ItemData;e.configID=t.id,this.targetItem.data=e,this._rewardId=t.id,this.playMc()},e.prototype.update=function(){for(var t=0;3>t;t++){var e=this["materialItem"+t];e.data=null,e.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(e,this.onItemTouch)}this._items=dominateEquipControl.getExtractEquips(),this._items&&this._items.sort(this.sort),this._col||(this._col=new eui.ArrayCollection,this.list.dataProvider=this._col),this._col.source=this._items,this.noItemDesc.visible=!this._items,this.changeBtnState();var i=new ItemData;i.configID=DataCenter.ins().DominateEquipBaConfig.mixShowId,this.targetItem.data=i},e.prototype.playMc=function(){for(var t="jljdt",e=0;3>e;e++){var i=this["_mc"+(e+1)];i||(i=ObjectPool.pop("GameMovieClip"),this["trieff"+e].addChild(i),this["_mc"+(e+1)]=i),i.playFile(PATH_EFF+t,-1),i.scaleX=0,i.scaleY=.6;var n=egret.Tween.get(i);0==e?n.to({scaleX:.15},500).call(this.playItemMc,this):n.to({scaleX:.15},500)}},e.prototype.playItemMc=function(){this.materialItem0.playMixMc(),this.materialItem1.playMixMc(),this.materialItem2.playMixMc(),this.targetItem.playMixMc(),TimerMgr.ins().doTimer(500,1,this.flyToBag,this)},e.prototype.flyToBag=function(){var t=this,e=new ItemBase;e.data=this._rewardId;var i=this.localToGlobal(0,0),n=this.targetItem.localToGlobal(0,0);e.x=n.x-i.x,e.y=n.y-i.y,this.addChild(e),gameControl.dispatchFlyItemEx(e),TimerMgr.ins().doTimer(500,1,function(){t._isExtract=!1,t.clearMc(),t.update()},this)},e.prototype.clearMc=function(){TimerMgr.ins().removeAll(this);for(var t=1;3>=t;t++){var e=this["_mc"+t];e&&(egret.Tween.removeTweens(e),e.destroy(),e=null),this["_mc"+t]=null}},e.prototype.clearBtnMc=function(){this._btnMc&&(this._btnMc.destroy(),this._btnMc=null)},e.prototype.addBtnMc=function(){this._btnMc||(this._btnMc=ObjectPool.pop("GameMovieClip"),this.btnEffGroup.addChild(this._btnMc),this._btnMc.x=78,this._btnMc.y=29),this._btnMc.playFile(PATH_EFF+"chargeff1",-1)},e.prototype.addListMc=function(){var t=this;this._listMc||(this._listMc=ObjectPool.pop("GameMovieClip"),this.listEffGroup.addChild(this._listMc)),this._listMc.playFile(PATH_EFF+"mixhint",1,function(){t.clearListMc(),t._playListMc=!1})},e.prototype.clearListMc=function(){this._listMc&&(this._listMc.destroy(),this._listMc=null)},e.prototype.onLink=function(){this.parent.hideMix()},e.prototype.onItemTouch=function(t){if(!this._isExtract)if(t.target.data){var e=t.target.data;t.target.data=null,this._items.push(e),this._items.sort(this.sort),this._items&&this._items.length?this._col.replaceAll(this._items):this._col.source=null,this.changeBtnState()}else{if(this._playListMc)return;this._playListMc=!0,this.addListMc()}},e.prototype.changeBtnState=function(){this.activityBtn.label=LangMgr.getValueByKey("dominaTips3"),this._isEnough=!1,this._items?(this.activityBtn.enabled=!0,this.materialItem0.data&&this.materialItem1.data&&this.materialItem2.data?this._isEnough=!0:this.activityBtn.label=LangMgr.getValueByKey("dominaTips4"),this.addBtnMc()):(this.activityBtn.enabled=!1,this.clearBtnMc())},e.prototype.onList=function(){if(!this._isExtract&&!this._isEnough){var t=this.list.selectedItem;t&&(this._items.splice(this._items.indexOf(t),1),this._items&&this._items.length?this._col.replaceAll(this._items):this._col.source=null,this.materialItem0.data?this.materialItem1.data?this.materialItem2.data=t:this.materialItem1.data=t:this.materialItem0.data=t,this.changeBtnState())}},e.prototype.onExtract=function(){if(!this._isExtract)if(this._isEnough)dominateEquipControl.upExtract([this.materialItem0.data.handle,this.materialItem1.data.handle,this.materialItem2.data.handle]),this._isExtract=!0;else{for(var t=0;3>t;t++){var e=this["materialItem"+t];e.data||(e.data=this._items.shift())}this._items&&this._items.length?this._col.replaceAll(this._items):this._col.source=null,this.changeBtnState()}},e.prototype.sort=function(t,e){var i=dominateEquipControl.getMasterEquipPower(t),n=dominateEquipControl.getMasterEquipPower(e);return n>i?-1:i>n?1:0},e}(BasePanel);__reflect(DominateEquipResolvePanel.prototype,"DominateEquipResolvePanel");var DominateEquipSelectView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipSelectViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=DominateSelectItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._filter=t[0],this._callBack=t[1],this._callBackObj=t[2],this.addEventTouchTap(this.list,this.onListTouch),this.addEventTouchTap(this.bgClose,this.onClose),this.update()},e.prototype.close=function(){this._filter=null,this._callBack=null,this._callBackObj=null},e.prototype.update=function(){var t=backpackControl.getEquipByFilter(this._filter);t&&t.length?(t.sort(this.sort),this.tipLabel.visible=!1):this.tipLabel.visible=!0,this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.sort=function(t,e){if(t.itemConfig.level<e.itemConfig.level)return-1;if(e.itemConfig.level<t.itemConfig.level)return 1;var i=dominateEquipControl.getMasterEquipPower(t),n=dominateEquipControl.getMasterEquipPower(e);return n>i?-1:i>n?1:0},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=this.list.selectedItem;if(!e)return;this._callBack.call(this._callBackObj,e),UIMgr.ins().close(this)}},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DominateEquipSelectView.prototype,"DominateEquipSelectView");var DominateEquipSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipSkillTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onClose);var i=t[0].id,n=t[0].openInfo,o=t[0].maxLen;this.currentState="skill"+(i-1);var s=DataCenter.ins().DominateEquipLvConfig[i];this.nametxt.text=s.skillName,this.damageDesctxt.textFlow=TextUtils.generateTextFlow(s.descTxt);for(var r="",a=this.activited.textColor,l=65280,h=n?n.length:0,u=0;o>u;u++)r+="|C:"+(h>0&&n[u]>=s.level?l:a)+"&T:"+HeirloomVo.getEquipName(u)+"|",o-1>u&&(r+=" ");this.activited.textFlow=TextUtils.generateTextFlow(r),this._mc||(this._mc=ObjectPool.pop("GameMovieClip"),this.uieff.addChild(this._mc)),this._mc.playFile(""+PATH_EFF+s.eff,-1)},e.prototype.close=function(){this._mc&&(this._mc.destroy(),this._mc=null)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DominateEquipSkillTipsView.prototype,"DominateEquipSkillTipsView");var DominateEquipTakeTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipTakeTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._itemData=t[0],t.length>=2?this._hideBtn=t[1]:this._hideBtn=!1,this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){var t=DataCenter.ins().ItemDescConfig[this._itemData.itemConfig.descIndex],e=t.subType;this.equipIcon.data={pos:e,itemData:this._itemData,showRed:!1},this.equipIcon.hideName(),this.equipPos.text=HeirloomVo.getEquipName(e),this.equipLv.text=this._itemData.itemConfig.level+2+LangMgr.getValueByKey("roleStart"),this.equipLimit.text=this._itemData.itemConfig.zsLevel?this._itemData.itemConfig.zsLevel+LangMgr.getValueByKey("numberRotation"):LangMgr.getValueByKey("persontNone"),this.materPoint.text=LangMgr.getValueByKey("dominaScore",DataCenter.ins().DominateEquipPointConfig[this._itemData.configID].point),this.equipQuality.source="quali"+t.quality,this.equipName.text=this._itemData.itemConfig.name;var i=AttributeData.getAttStr(dominateEquipControl.getEquipRandomAtts(this._itemData),0,1,":");this._itemData.att||(i=i.replace(/0/g,"????")),this.randomAttr.textFlow=TextUtils.generateTextFlow1(i),this.baseAttr.textFlow=TextUtils.generateTextFlow1(dominateEquipControl.getBaseAttStr(this._itemData.configID)),this.powerPanel.setPower(dominateEquipControl.getMasterEquipPower(this._itemData)),this.decomposeBtn.visible=DataCenter.ins().DominateEquipDecomConfig[this._itemData.configID]&&this._itemData.itemConfig.level<=dominateEquipControl.getPosMinLv(e)&&!this._hideBtn},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.decomposeBtn:UIMgr.ins().open(DominateTakeTipsView,this._itemData.handle,this._itemData.configID)}},e}(BaseEuiView);__reflect(DominateEquipTakeTipsView.prototype,"DominateEquipTakeTipsView");
var DominateEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleIndex=t[0],this._pos=t[1],this._itemData=t[2],this._showRed=t[3],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){this.equipIcon.data={pos:this._pos,itemData:this._itemData,showRed:!1},this.equipIcon.hideName(),this.equipPos.text=HeirloomVo.getEquipName(this._pos),this.equipLv.text=this._itemData.itemConfig.level+2+LangMgr.getValueByKey("roleStart"),this.equipLimit.text=this._itemData.itemConfig.zsLevel?LangMgr.getValueByKey("numberRotation",this._itemData.itemConfig.zsLevel):LangMgr.getValueByKey("persontNone"),this.materPoint.text=LangMgr.getValueByKey("dominaScore",DataCenter.ins().DominateEquipPointConfig[this._itemData.configID].point),this.equipQuality.source="quali"+DataCenter.ins().ItemDescConfig[this._itemData.itemConfig.descIndex].quality,this.equipName.text=this._itemData.itemConfig.name,this.randomAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(dominateEquipControl.getEquipRandomAtts(this._itemData),0,1,":")),this.baseAttr.textFlow=TextUtils.generateTextFlow1(dominateEquipControl.getBaseAttStr(this._itemData.configID));var t=DataCenter.ins().DominateEquipComConfig[this._pos];t?(this.composeBtn.visible=null!=DataCenter.ins().DominateEquipComConfig[this._itemData.configID],this.composeBtn.horizontalCenter=0,this.changeBtn.visible=!1):(this.composeBtn.visible=!1,this.changeBtn.horizontalCenter=0,this.changeBtn.visible=!0),this.powerPanel.setPower(dominateEquipControl.getMasterEquipPower(this._itemData,this._roleIndex))},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.changeBtn:UIMgr.ins().open(DominateEquipChangeView,this._roleIndex,this._pos,this._itemData.copy()),UIMgr.ins().close(this);break;case this.composeBtn:UIMgr.ins().open(DominateEquipComposeView,this._roleIndex,this._pos,this._itemData.copy(),this._showRed),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DominateEquipTipsView.prototype,"DominateEquipTipsView");var DominateTakeTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateTakeTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.equip.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._handler=t[0],this._configID=t[1],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:case this.notBtn:UIMgr.ins().close(this);break;case this.sureBtn:dominateEquipControl.upDecompose(this._handler),UIMgr.ins().close(this),UIMgr.ins().close(DominateEquipTakeTipsView)}},e.prototype.update=function(){this.warnLabel.text=LangMgr.getValueByKey("dominaTips2",DataCenter.ins().ItemConfig[this._configID].name),this.equip.dataProvider=new eui.ArrayCollection(DataCenter.ins().DominateEquipDecomConfig[this._configID].splitReward.concat())},e}(BaseEuiView);__reflect(DominateTakeTipsView.prototype,"DominateTakeTipsView");var DominateTipsView=function(t){function e(){var e=t.call(this)||this;return e.suitNextBoo=!1,e.skinName="DominateTipsViewSkin",e.uilayer=GameLayer.POPUP,e.equipIcon.equipName.visible=!1,e.composeRed.visible=!1,e.enhanceRed.visible=!1,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.composeBtn,this.onTouch),this.addEventTouchTap(this.changeBtn,this.onTouch),this.itemCfg=t[0],this.roleId=t[1];var i=t[2];this.pos=DominateControl.getPosById(this.itemCfg.id),this.upData(),!isNaN(this.roleId)&&i?(TimerMgr.ins().doTimer(3e3,0,this.showSuit,this),this.showSuit(),this.refRedpoint()):this.currentState="suitTip"},e.prototype.upData=function(){var t=1;isNaN(this.roleId)||(t=dominateControl.trinketDatas[this.roleId].levels[this.pos]);var e=DataCenter.ins().DominateEquipMastLvConfig[this.pos][t];this.equipName.text=this.itemCfg.name,this.equipIcon.setDataPub(e),this.equipPos.text=DominateControl.getPosName(this.pos),this.equipRank.text=e.rankLv+"",this.equipLv.text=e.starLv+"";var i=BackpackControl.getAttrPower(e.attr);i+=isNaN(this.roleId)?ItemUtils.calculateRelatePower(e.attr,heroControl.getSubRoleByIndex(0)):ItemUtils.calculateRelatePower(e.attr,heroControl.getSubRoleByIndex(this.roleId)),this.powerPanel.setPower(i),this.materPoint.text=LangMgr.getValueByKey("dominaScore",e.point),e.attr.map(function(t){var e=new AttributeData;return e.value=t.value,e.type=t.type,e});for(var n=0;5>n;n++)e.attr[n]?(this["attr"+(n+1)].text=AttributeData.getAttStrByType(e.attr[n],1),this["attr"+(n+1)].visible=!0):this["attr"+(n+1)].visible=!1},e.prototype.showSuit=function(){var t=DominateControl.getMinLvByRoleId(this.roleId),e=Object.keys(DataCenter.ins().DominateEquipBaConfig.suitAttr).length;if(t>=e||0==t||0==DataCenter.ins().DominateEquipBaConfig.suitAttr[t]){TimerMgr.ins().remove(this.showSuit,this);var i=DominateControl.getSuitLv(t);return void this.upSuitAttr(i)}var n=DominateControl.getSuitLv(t);this.upSuitAttr(this.suitNextBoo?++n:n),this.suitNextBoo=!this.suitNextBoo},e.prototype.upSuitAttr=function(t){var e=DataCenter.ins().DominateEquipBaConfig,i=e.suitAttr;this.suitLv.text=LangMgr.getValueByKey("dominaPanter",t);var n=e.suitShow[t][0];if(1==t)for(var o=e.suitShow[t][0];o<=e.suitShow[t][1];o++)if(i[o]){n=o;break}var s=DataCenter.ins().DominateEquipMastLvConfig[this.pos][n];this.suitLv.textColor=16767295;var r=i[n]||0,a=LangMgr.getValueByKey("dominaTips1",s.rankLv,s.starLv),l=n<=dominateControl.trinketDatas[this.roleId].levels[1]?65280:9342606;a+="[|C:"+l+"&T:"+DominateControl.getPosName(1)+"|",l=n<=dominateControl.trinketDatas[this.roleId].levels[2]?65280:9342606,a+=" |C:"+l+"&T:"+DominateControl.getPosName(2)+"|",l=n<=dominateControl.trinketDatas[this.roleId].levels[3]?65280:9342606,a+=" |C:"+l+"&T:"+DominateControl.getPosName(3)+"|",l=n<=dominateControl.trinketDatas[this.roleId].levels[4]?65280:9342606,a+=" |C:"+l+"&T:"+DominateControl.getPosName(4)+"|]\n",this.suitCondition.textFlow=TextUtils.generateTextFlow1(a);var h=LangMgr.getValueByKey("domainaEquip1",r);h+=LangMgr.getValueByKey("domainaEquip2",r),h+=LangMgr.getValueByKey("domainaEquip3",r),h+=LangMgr.getValueByKey("domainaEquip4",r),h+=LangMgr.getValueByKey("domainaEquip5",r),h+=LangMgr.getValueByKey("domainaEquip6",r),h+=LangMgr.getValueByKey("domainaEquip7",r),h+=LangMgr.getValueByKey("domainaEquip8",r),this.suitDesc.textFlow=TextUtils.generateTextFlow1(h)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.composeBtn:UIMgr.ins().open(DominateComposeView,this.roleId,this.pos),UIMgr.ins().close(this);break;case this.changeBtn:UIMgr.ins().open(DominateUpgradeView,this.roleId,this.pos),UIMgr.ins().close(this)}},e.prototype.refRedpoint=function(){this.composeRed.visible=!!DominateRedpoint.ins().redpoints_1[this.roleId][this.pos],this.enhanceRed.visible=!!DominateRedpoint.ins().redpoints_2[this.roleId][this.pos]},e}(BaseEuiView);__reflect(DominateTipsView.prototype,"DominateTipsView");var DominateUpgradeView=function(t){function e(){var e=t.call(this)||this;return e.lv=1,e.skinName="DominateUpgradeViewSkin",e.uilayer=GameLayer.POPUP,e.target.touchChildren=!1,e.effList=[],e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.enhanceBtn,this.onTouch),this.addEventTouchTap(this.target,this.onTouch),this.addCustomEvent(266,this.upMateral),this.addCustomEvent(268,this.upMateral),this.addCustomEvent(269,this.upMateral),this.addCustomEvent(291,this.upData),this.roleId=t[0],this.pos=t[1],this.upData(),this.upMateral()},e.prototype.upData=function(){this.lv=dominateControl.trinketDatas[this.roleId]&&dominateControl.trinketDatas[this.roleId].levels[this.pos]||0,this.upEquipData(),this.upAttr()},e.prototype.upEquipData=function(){this.target.setData(this.roleId,this.pos);var t=DataCenter.ins().DominateEquipMastLvConfig[this.pos][this.lv].rankLv;if(this.stageLabel.text=LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(t)),(this.lv-1)%6==0)this.backEff();else for(var e=(this.lv-1)%6,i=0;e>i;i++){if(!this.effList[i]){var n=new GameMovieClip;this.effList[i]=n}this.effList[i].x=0,this.effList[i].y=20,this["eff_"+(i+1)].addChild(this.effList[i]),this.effList[i].playFile(PATH_EFF+"feishengfire",-1)}},e.prototype.backEff=function(){for(var t=0;t<this.effList.length;t++){var e=this.effList[t];e&&e.dispose()}},e.prototype.upAttr=function(){var t=DataCenter.ins().DominateEquipMastLvConfig[this.pos][this.lv];0==this.lv?(this.nowAttr.text=LangMgr.getValueByKey("commonNoActive"),this.materPoint.text=LangMgr.getValueByKey("dominaScore",0),this.powerPanel.setPower(0)):(this.nowAttr.text=AttributeData.getAttStrEx(t.attr),this.materPoint.text=LangMgr.getValueByKey("dominaScore",t.point),this.powerPanel.setPower(BackpackControl.getAttrPower(t.attr)));var e=DataCenter.ins().DominateEquipMastLvConfig[this.pos][this.lv+1];e?(this.currentState="normal",this.nextAttr.text=AttributeData.getAttStrEx(e.attr)):(this.currentState="maxlv",this.enhanceBtn.enabled=!1,this.enhanceBtn.label=LangMgr.getValueByKey("hijiTips6"),this.enhanceRed.visible=!1,this.materialGroup0.visible=!1,this.materialGroup1.visible=!1)},e.prototype.upMateral=function(){for(var t=DataCenter.ins().DominateEquipMastLvConfig[this.pos][this.lv+1],e=0;;){if(!this["materialGroup"+e])break;this["materialGroup"+e].visible=!1,e++}if(t){for(var i=t.mat.length,n=!0,o=0;i>o;o++)if(this["costImg"+o]){var s=DataCenter.ins().ItemConfig[t.mat[o].id];this["costImg"+o].source=s.icon+"_png";var r=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t.mat[o].id),a=r>=t.mat[o].count?ColorUtils.GREEN:ColorUtils.RED,l="|C:"+a+"&T:"+r+"|/"+t.mat[o].count;this["costCount"+o].textFlow=TextUtils.generateTextFlow1(l),this["materialGroup"+o].visible=!0,r<t.mat[o].count&&(n=!1)}this.enhanceBtn.enabled=n,this.enhanceRed.visible=n}},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.target:CommonFun.viewItemTips(this.target.itemCfg.id);break;case this.enhanceBtn:dominateControl.sendUpgrade(this.roleId,this.pos)}},e}(BaseEuiView);__reflect(DominateUpgradeView.prototype,"DominateUpgradeView");var DominateChangeItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.itemData;this.itemIcon.data={pos:0,itemData:t,showRed:!1},this.materPoint.text=LangMgr.getValueByKey("godFightValue",DataCenter.ins().DominateEquipPointConfig[t.configID].point),this.changeBtn.visible=!this.data.isMine,this.now.visible=this.data.isMine,this.best.visible=this.data.isBest,this.randomAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(dominateEquipControl.getEquipRandomAtts(t),0,1,"+",!1,!1)),this.baseAttr.textFlow=TextUtils.generateTextFlow1(dominateEquipControl.getBaseAttStr(t.configID,"+"))},e}(BaseItemRender);__reflect(DominateChangeItemRenderer.prototype,"DominateChangeItemRenderer");var DominateEquipItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateEquipItemRenderSkin",e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t,e,i=0;if(this.data instanceof ItemData?(i=DataCenter.ins().ItemDescConfig[this.data.itemConfig.descIndex].subType,e=this.data):(i=this.data.pos,e=this.data.itemData,t=this.data.showRed),this.imgRect.visible=!0,this.equipLvImg.source=null,this.selectIcon.visible=!1,this.equipName.text="",this.equipName.visible=!0,this.redPoint.visible=t,e&&e.itemConfig)this.imgBg.source="quality"+DataCenter.ins().ItemDescConfig[e.itemConfig.descIndex].quality,this.imgIcon.source=e.itemConfig.icon+"_png",this.imgRect.visible=!1,this.equipLvImg.source="mequip_lv"+e.itemConfig.level,this.equipName.textFlow=TextUtils.generateTextFlow(e.itemConfig.name),this._mc||(this._mc=ObjectPool.pop("GameMovieClip")),this._mc.parent||this.posEff.addChild(this._mc),this._mc.playFile(""+PATH_EFF+DataCenter.ins().DominateEquipBaConfig.posEff[i],-1);else{this.imgBg.source="quality0",this.imgIcon.source="dz_1"+i;var n=DataCenter.ins().DominateEquipComConfig[i];n&&(this.equipName.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("dominaTips14"))),this.clearEff()}this.hasEventListener(eui.UIEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRemove)},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.clearEff()},e.prototype.clearEff=function(){this._mc&&(this._mc.destroy(),this._mc=null)},e.prototype.hideName=function(){this.equipName.visible=!1},e.prototype.setEquipName=function(t){this.equipName.textFlow=TextUtils.generateTextFlow(t)},e}(BaseItemRender);__reflect(DominateEquipItemRender.prototype,"DominateEquipItemRender");var DominateMixItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="mEquipMixItem",e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){return this.data?(this._isMEquip=33==ItemUtils.getType(this.data.itemConfig),this.equipLvImg.source=this._isMEquip?"mequip_lv"+this.data.itemConfig.level:null,this.mixImg.source=this.data.itemConfig.icon+"_png",this._isMEquip&&(this.currentState="material"),this.mixName.textFlow=TextUtils.generateTextFlow("|C:"+(this._isMEquip?this.mixName.textColor:ItemUtils.getQualityColor(this.data.itemConfig))+"&T:"+this.data.itemConfig.name+"|"),void(this.hasEventListener(eui.UIEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRemove))):void(this.currentState="none")},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.clearMixMc()},e.prototype.playMixMc=function(){this._mixMc||(this._mixMc=ObjectPool.pop("GameMovieClip")),this.mixEff.addChild(this._mixMc),this._mixMc.playFile(PATH_EFF+(this._isMEquip?"litboom":"forgeSuccess"),1)},e.prototype.clearMixMc=function(){this._mixMc&&(this._mixMc.destroy(),this._mixMc=null)},e}(BaseItemRender);__reflect(DominateMixItemRenderer.prototype,"DominateMixItemRenderer");var DominateSelectItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateSelectItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.best.visible=0==this.itemIndex,this.itemIcon.data={pos:0,itemData:this.data,showRed:!1},this.fightTxt.text=LangMgr.getValueByKey("godFightValue",dominateEquipControl.getMasterEquipPower(this.data));var t=DataCenter.ins().DominateEquipPointConfig[this.data.configID];this.scoreTxt.text=LangMgr.getValueByKey("dominaScore",t?t.point:0)},e}(BaseItemRender);__reflect(DominateSelectItemRenderer.prototype,"DominateSelectItemRenderer");var DominateSkillItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DominateSkillItemRendererSkin",e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=DataCenter.ins().DominateEquipLvConfig[this.data.id];this.skillImg.source=t.iconImg;for(var e=this.data.openInfo?this.data.openInfo.length:0,i=0,n=0;e>n;n++)this.data.openInfo[n]>=t.level&&i++;if(i==this.data.maxLen)this.schedule.visible=!1,this.clearShape();else if(0==i)this.schedule.visible=!0,this.clearShape();else{var o=360*i/this.data.maxLen;this._shape||(this._shape=new egret.Shape,this.maskGroup.addChild(this._shape),this._shape.x=this.maskGroup.width>>1,this._shape.y=this.maskGroup.height>>1,this.schedule.mask=this._shape),DisplayUtils.drawCir(this._shape,48,o+270,!0,270*Math.PI/180),this.schedule.visible=!0}this.hasEventListener(eui.UIEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRemove)},e.prototype.onRemove=function(t){this.removeEventRemovedFromStage(this,this.onRemove),this.clearShape()},e.prototype.clearShape=function(){this._shape&&(this._shape.graphics.clear(),DisplayUtils.removeFromParent(this._shape),this._shape=null)},e}(BaseItemRender);__reflect(DominateSkillItemRenderer.prototype,"DominateSkillItemRenderer");var DominateTrinkChItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.itemData;this.itemIcon.data={pos:0,itemData:t,showRed:!1},this.materPoint.text=LangMgr.getValueByKey("wingPingfen",DataCenter.ins().DominateEquipPointConfig[t.configID].point),this.changeBtn.label=LangMgr.getValueByKey("dominaTips11"),this.now.visible=!1,this.best.visible=this.data.isBest,this.randomAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(dominateEquipControl.getEquipRandomAtts(t),0,1,"+",!1,!1)),this.baseAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(dominateEquipControl.getEquipBaseAtts(t.configID),0,1))},e}(BaseItemRender);__reflect(DominateTrinkChItemRenderer.prototype,"DominateTrinkChItemRenderer");var DominateTrinkItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.pos=1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemIcon.imgRect.visible=!1},e.prototype.clear=function(){this.itemCfg=null,this.equipName.text="",this.trinketShow.visible=!1,this.itemIcon.imgIcon.source=DataCenter.ins().DominateEquipMasterSlotConfig[this.pos].slotBg},e.prototype.setData=function(t,e){this.pos=e;var i=dominateControl.trinketDatas[t]&&dominateControl.trinketDatas[t].levels[e]||0;if(i>0){var n=DataCenter.ins().DominateEquipMastComConfig[e],o=DataCenter.ins().DominateEquipMastLvConfig[e][i];this.itemCfg=DataCenter.ins().ItemConfig[n.id],this.equipName.text=this.itemCfg.name,this.equipName.textColor=LangMgr.getColor("qualityColor"+o.quality),this.itemIcon.imgIcon.source=this.itemCfg.icon+"_png",this.trinketShow.visible=!!o.starIcon,this.trinketLvImg.source=o.starIcon,this.itemIcon.imgRect.visible=!1,this.eff||(this.eff=new GameMovieClip,this.posEff.addChild(this.eff)),this.itemIcon.imgBg.source="quality"+o.quality,this.eff.playFile(""+PATH_EFF+DataCenter.ins().DominateEquipBaConfig.tPosEff[e-1],-1)}else this.itemIcon.imgBg.source="quality0",this.itemIcon.imgIcon.source=DataCenter.ins().DominateEquipMasterSlotConfig[e].slotBg,this.trinketShow.visible=!1,this.itemIcon.imgRect.visible=!0,this.equipName.text=LangMgr.getValueByKey("dominaTips13"),this.equipName.textColor=ColorUtils.GREEN,this.eff&&this.eff.dispose()},e.prototype.setDataPub=function(t){this.pos=t.id;var e=DataCenter.ins().DominateEquipMastComConfig[t.id];this.itemCfg=DataCenter.ins().ItemConfig[e.id],this.equipName.text=this.itemCfg.name,this.equipName.textColor=LangMgr.getColor("qualityColor"+t.quality),this.itemIcon.imgIcon.source=this.itemCfg.icon+"_png",this.itemIcon.imgBg.source="quality"+t.quality,this.trinketShow.visible=!!t.starIcon,this.trinketLvImg.source=t.starIcon,this.eff||(this.eff=new GameMovieClip,this.posEff.addChild(this.eff)),this.itemIcon.imgBg.source="quality"+t.quality,this.eff.playFile(""+PATH_EFF+DataCenter.ins().DominateEquipBaConfig.tPosEff[t.id-1],-1)},e}(BaseItemRender);__reflect(DominateTrinkItemRenderer.prototype,"DominateTrinkItemRenderer");var DragonSoulControl=function(t){function e(){var e=t.call(this)||this;return e._proShowList=[],e.checkDanRed=function(t){var e=heroControl.getSubRoleByIndex(t);if(!e||!e.loongSoulData.state)return!1;for(var i=DataCenter.ins().DragonSoulBaseConfig.upgrateItem,n=0;n<i.length;n++){var o=i[n];if(!backpackControl.isHideDanIcon(o)){if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,o)&&e.loongSoulData.stage==DataCenter.ins().ItemConfig[o].useArg.maxLevel)return!0;break}}return!1},e.addCustomEvent(352,e.initLongHunItemsData),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.initLongHunItemsData()},e.prototype.initLongHunItemsData=function(){for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t);if(!e.longhunItemData){e.longhunItemData=[];for(var i=0;i<DataCenter.ins().DragonSoulBaseConfig.lhItemRes.length;i++)e.longhunItemData[i]||(e.longhunItemData[i]=new DragonSoulItemDataVo(i+1)),e.longhunItemData[i].itemId=0}}},e.prototype.upUpGrade=function(t,e){return[t,e]},e.prototype.downDateUpdate=function(t,e,n,o){var s=heroControl.getSubRoleByIndex(t),r=0;switch(e+1){case i.TYPE_LONG_HUN:r=s.loongSoulData.level==n?0:1,s.loongSoulData.level=n,s.loongSoulData.exp=o}EventMgr.ins().dispatch(145,r)},e.prototype.upStageUpgrade=function(t,e){return[t,e]},e.prototype.downStageUpgrade=function(t,e,n){var o=heroControl.getSubRoleByIndex(t);switch(e+1){case i.TYPE_LONG_HUN:o.loongSoulData.stage=n}EventMgr.ins().dispatch(146)},e.prototype.upStageActive=function(t,e){return[t,e]},e.prototype.downStageActive=function(t,e,n){var o=heroControl.getSubRoleByIndex(t);switch(e+1){case i.TYPE_LONG_HUN:o.loongSoulData.state=n}CommonFun.show(0,LangMgr.getValueByKey("equipment4"),"jlonghun_01_png"),EventMgr.ins().dispatch(147)},e.prototype.canShowRedPointByType=function(t,e){var n=heroControl.getSubRoleByIndex(t);if(!n)return!1;var o=0,s=null,r=null,a=null;switch(e){case i.TYPE_LONG_HUN:if(0==n.loongSoulData.state){var l=DataCenter.ins().DragonSoulBaseConfig.openlv;return ActorControl.level<l?!1:!0}s=DataCenter.ins().DragonSoulConfig[n.loongSoulData.level],r=DataCenter.ins().DragonSoulConfig[n.loongSoulData.level+1],a=DataCenter.ins().DragonSoulStageConfig[n.loongSoulData.stage],o=n.loongSoulData.exp}if(!r)return!1;if(this.assert(s&&a,"config or stageConfig is null"))return!1;var h=backpackControl.getBagGoodsCountById(0,s.itemId);return void 0==a.normalCostTip?!1:h>=a.normalCostTip},e.prototype.canShowRedPointInRole=function(t){for(var e=[i.TYPE_LONG_HUN],n=0,o=e;n<o.length;n++){var s=o[n];if(this.canShowRedPointByType(t,s))return!0}return this.getLongHunItemRedPoint(t)?!0:!1},e.prototype.canShowRedPointInAll=function(){for(var t=0;3>t;t++)if(this.canShowRedPointInRole(t))return!0;return HeartMethodRedPoint.ins().redPoint?!0:SoulBoneRedPoint.ins().redPoint?!0:!1},e.prototype.canUpgradeByType=function(t,e){var n=heroControl.getSubRoleByIndex(t);if(n){var o=null,s=null;switch(e){case i.TYPE_LONG_HUN:o=DataCenter.ins().DragonSoulConfig[n.loongSoulData.level],s=DataCenter.ins().DragonSoulStageConfig[n.loongSoulData.stage]}var r=backpackControl.getBagGoodsCountById(0,o.itemId);return r>0}return!1},e.prototype.canGradeupLoongSoul=function(t){for(var e=[!1,!1,!1],i=heroControl.subRolesLen,n=0;i>n;n++)e[n]=this.canShowRedPointInRole(n);return e},e.prototype.assert=function(t,e){return Assert(t,"["+egret.getQualifiedClassName(this)+"] "+e)},Object.defineProperty(e.prototype,"proShowList",{get:function(){return this._proShowList.length||(this._proShowList=DataCenter.ins().DragonSoulBaseConfig.proShowList),this._proShowList},enumerable:!0,configurable:!0}),e.prototype.getAttrStrByType=function(t){for(var e="",i=0;i<this.proShowList.length;i++){var n=this.proShowList[i];if(n.id==t){e=n.name;break}}return e},e.prototype.downLongHunItemInfo=function(t){for(var e=0;t.length>e;e++)for(var i=t[e][0],n=heroControl.getSubRoleByIndex(i),o=0;t[e][1].length>o;o++){var s=t[e][1][o];n&&(n.longhunItemData||(n.longhunItemData=[]),n.longhunItemData[o]||(n.longhunItemData[o]=new DragonSoulItemDataVo(o+1)),n.longhunItemData[o].itemId=s)}EventMgr.ins().dispatch(148)},e.prototype.downLongHunItemUpdate=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);n&&(n.longhunItemData||(n.longhunItemData=[]),n.longhunItemData[e-1]||(n.longhunItemData[e-1]=new DragonSoulItemDataVo(e)),n.longhunItemData[e-1].itemId=i),EventMgr.ins().dispatch(149)},e.prototype.upMeltItem=function(t){return[t]},e.prototype.downMeltItem=function(){EventMgr.ins().dispatch(150)},e.prototype.upLongHunItemUpLevel=function(t,e){return[t,e]},e.prototype.upLongHunItemWear=function(t,e,i){return[t,e,i]},e.prototype.checkLongHunItemsSysOpen=function(t){for(var e=0;e<heroControl.subRolesLen;e++)if(isNaN(t)||t==e){var i=heroControl.getSubRoleByIndex(e);if(i.loongSoulData.state&&GameServer.serverOpenDay>=DataCenter.ins().DragonSoulBaseConfig.equipOpenDay-1&&reincarnateControl.lv>=DataCenter.ins().DragonSoulBaseConfig.equipOpenZs)return!0}return!1},e.prototype.getLongHunItemRedPoint=function(t,e){if(!this.checkLongHunItemsSysOpen())return!1;for(var i=0;i<heroControl.subRolesLen;i++)if(isNaN(t)||i==t){var n=heroControl.getSubRoleByIndex(i);if(n&&n.longhunItemData)for(var o=0;o<n.longhunItemData.length;o++){var s=n.longhunItemData[o].slot;if(isNaN(e)||e==s){var r=this.calcLongHunSlotChange(i,s);if(r)return!0;var a=n.longhunItemData[o].itemId;if(dragonSoulControl.calcLongHunSlotCost(a))return!0}}}return this.getDecomposeRedPoint()?!0:!1},e.prototype.getWearRedPoint=function(t,e){for(var i=0;i<heroControl.subRolesLen;i++)if(isNaN(t)||i==t){var n=heroControl.getSubRoleByIndex(i);if(n&&n.longhunItemData)for(var o=0;o<n.longhunItemData.length;o++){var s=n.longhunItemData[o].slot;if(isNaN(e)||e==s){var r=this.calcLongHunSlotChange(i,s);if(r)return!0}}}return!1},e.prototype.getUpStarRedPoint=function(t,e){for(var i=0;i<heroControl.subRolesLen;i++)if(isNaN(t)||i==t){var n=heroControl.getSubRoleByIndex(i);if(n&&n.longhunItemData)for(var o=0;o<n.longhunItemData.length;o++){var s=n.longhunItemData[o].slot;if(isNaN(e)||e==s){var r=n.longhunItemData[o].itemId;if(dragonSoulControl.calcLongHunSlotCost(r))return!0}}}return!1},e.prototype.getDecomposeRedPoint=function(t){if(this.getUpStarRedPoint(t))return!1;if(this.getWearRedPoint(t))return!1;var e=this.getDecomposeSuggestList();if(e.length){for(var i=0,n=0;n<e.length;n++){var o=DataCenter.ins().DragonSoulStarConfig[e[n].itemConfig.id];i+=o.splitNum}for(var s=0;s<heroControl.subRolesLen;s++)if(isNaN(t)||s==t){var r=heroControl.getSubRoleByIndex(s),a=DataCenter.ins().DragonSoulConfig[r.loongSoulData.level],l=i+backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,a.itemId),h=DataCenter.ins().DragonSoulStageConfig[r.loongSoulData.stage];if(l>=h.normalCostTip)return!0}}return!1},e.prototype.getLongHunStarCfg=function(t,e){if(void 0===e&&(e=!1),Assert(DataCenter.ins().DragonSoulStarConfig,"LoongSoulStarConfig is null"))return null;var i=e?DataCenter.ins().DragonSoulStarConfig[t.configID].nextItem:DataCenter.ins().DragonSoulStarConfig[t.configID].posItem;return DataCenter.ins().DragonSoulStarConfig[i]},e.prototype.calcLongHunItemTotalValue=function(t){for(var e=[],i=0;i<this.proShowList.length;i++){var n=new AttributeData(this.proShowList[i].id,0);e.push(n)}var o=heroControl.getSubRoleByIndex(t);if(o&&o.longhunItemData)for(var s=0;s<o.longhunItemData.length;s++){var r=o.longhunItemData[s].itemId,a=DataCenter.ins().DragonSoulStarConfig[r];a||(e=AttributeData.AttrAddition(e,a.attr))}return e},e.prototype.getLongHunSlotItemId=function(t,e){var i=heroControl.getSubRoleByIndex(t);return i&&i.longhunItemData&&i.longhunItemData[e-1].itemId?i.longhunItemData[e-1].itemId:0},e.prototype.isWearBodyBySlot=function(t,e){var i=heroControl.getSubRoleByIndex(t);if(i&&i.longhunItemData)for(var n=0;n<i.longhunItemData.length;n++)if(i.longhunItemData[n].slot==e&&i.longhunItemData[n].itemId)return!0;return!1},e.prototype.calcLongHunSlotChange=function(t,e){var i=heroControl.getSubRoleByIndex(t);if(!i)return 0;if(!i.longhunItemData&&!i.longhunItemData.length)return 0;var n=i.longhunItemData[e-1].itemId,o=DataCenter.ins().DragonSoulStarConfig[n],s=backpackControl.getBagGoodsByType(30);s.sort(this.changeSort);for(var r=0;r<s.length;r++){var a=s[r];if(DataCenter.ins().DragonSoulStarConfig[a.configID].posId==e){var l=DataCenter.ins().ItemConfig[a.configID],h=l.level?l.level:0,u=l.zsLevel?l.zsLevel:0;if(!(ActorControl.level<h||reincarnateControl.lv<u)){if(!n||!o)return l.id;var p=DataCenter.ins().DragonSoulStarConfig[l.id];if(p.quality>o.quality)return l.id;if(p.quality==o.quality&&p.star>o.star)return l.id}}}return 0},e.prototype.changeSort=function(t,e){if(ItemUtils.getQuality(t.itemConfig)>ItemUtils.getQuality(e.itemConfig))return-1;if(ItemUtils.getQuality(t.itemConfig)<ItemUtils.getQuality(e.itemConfig))return 1;var i=DataCenter.ins().DragonSoulStarConfig[t.configID],n=DataCenter.ins().DragonSoulStarConfig[e.configID];return SortUtils.sortDescByKey(i.star,n.star)},e.prototype.calcLongHunSlotCost=function(t){var e=!1,i=DataCenter.ins().DragonSoulStarConfig[t];if(!i||!i.nextItem)return e;var n=backpackControl.getBagItemById(i.costItem);return n&&n.count>=i.costNum&&(e=!0),e},e.prototype.calcLongHunSkillLevel=function(t){var e=0,i=heroControl.getSubRoleByIndex(t);if(!i.longhunItemData)return e;for(var n,o=0;o<i.longhunItemData.length;o++){var s=i.longhunItemData[o].itemId;if(!s)return 0;var r=DataCenter.ins().DragonSoulStarConfig[s];if(r){var a=r.quality;(!n||n>a)&&(n=a)}}return n&&(e=n),e},e.prototype.getLongHunSuitCount=function(t,e){var i=heroControl.getSubRoleByIndex(t);if(!i||!i.longhunItemData)return 0;for(var n=0,o=0;o<i.longhunItemData.length;o++){var s=i.longhunItemData[o].itemId;if(s){var r=DataCenter.ins().DragonSoulStarConfig[s];r.quality>=e&&n++}}return n},e.prototype.getDecomposeSuggestList=function(){for(var t=[],e=[],i=heroControl.subRolesLen,n=backpackControl.getBagGoodsByType(30),o=[],s=0;s<n.length;s++){var r=n[s],a=DataCenter.ins().DragonSoulStarConfig[r.configID].posId,l=CommonUtils.copyDataHandler(r);e[a-1]||(e[a-1]=[]),e[a-1].push(l)}for(var s=0;s<e.length;s++)e[s]&&e[s].sort(function(t,e){var i=DataCenter.ins().DragonSoulStarConfig[t._configID],n=DataCenter.ins().DragonSoulStarConfig[e._configID],o=BackpackControl.getAttrPower(i.attr),s=BackpackControl.getAttrPower(n.attr);return o>s?-1:1});for(var h=0;i>h;h++){var u=heroControl.getSubRoleByIndex(h);if(u&&u.longhunItemData){o[h]||(o[h]=[]);for(var s=0;s<DataCenter.ins().DragonSoulBaseConfig.lhItemRes.length;s++){var p=0,r=void 0,c=0;o[h][s]||(o[h][s]=[]),e[s]&&e[s].length>0&&(r=e[s][0],p=BackpackControl.getAttrPower(DataCenter.ins().DragonSoulStarConfig[r.itemConfig.id].attr));var d=u.longhunItemData[s];if(d){if(d.itemId){var g=DataCenter.ins().DragonSoulStarConfig[d.itemId];c=BackpackControl.getAttrPower(g.attr)}p>c?(o[h][s]=r.configID,r.count--,r.count<=0&&e[s].shift()):o[h][s]=d.itemId}}}}for(var s=0;s<o.length;s++)for(var m=0;m<o[s].length;m++){var f=o[s][m];if(f){var g=DataCenter.ins().DragonSoulStarConfig[f],v=g.costItem,y=0,C=CommonUtils.getObjectLength(DataCenter.ins().DragonSoulPosConfig[m+1][g.quality]);if(g.star+1<C&&(y=C-(g.star+1)),y>0&&e.length>m&&e[m])for(var T=e[m].length-1;T>=0;T--){var w=e[m][T];w.configID==v&&(w.count-=y,w.count<=0&&e[m].splice(T,1))}}}for(var s=0;s<e.length;s++)e[s]&&(t=t.concat(e[s]));return t},e.prototype.getLongHunEquipPower=function(t){for(var e=0,i=[],n=[],o=[],s=[],r=0;r<heroControl.subRolesLen;r++)if(isNaN(t)||r==t){var a=heroControl.getSubRoleByIndex(r);if(a.longhunItemData){o=[];for(var l=0;l<a.longhunItemData.length;l++){var h=a.longhunItemData[l].itemId;if(h){var u=DataCenter.ins().DragonSoulStarConfig[h];o=AttributeData.AttrAddition(o,u.attr),e+=u.power?u.power:0}}var p=dragonSoulControl.calcLongHunSkillLevel(r);if(p){s=[];var c=DataCenter.ins().DragonSoulSuitConfig[p];s=AttributeData.AttrAddition(s,c.attr)}n=[],n=AttributeData.AttrAddition(n,o),n=AttributeData.AttrAddition(n,s),i=AttributeData.AttrAddition(i,n);for(var d=0;d<n.length;d++)e+=ItemUtils.relatePower(n[d],a);e+=BackpackControl.getAttrPower(n)}}return[e,i]},e.TYPE_LONG_HUN=2,__decorate([up(1,[2,2])],e.prototype,"upUpGrade",null),__decorate([down(1,[2,2,3,3])],e.prototype,"downDateUpdate",null),__decorate([up(2,[2,2])],e.prototype,"upStageUpgrade",null),__decorate([down(2,[2,2,3])],e.prototype,"downStageUpgrade",null),__decorate([up(3,[2,2])],e.prototype,"upStageActive",null),__decorate([down(3,[2,2,1])],e.prototype,"downStageActive",null),__decorate([down(4,[[1,[3]]])],e.prototype,"downLongHunItemInfo",null),__decorate([down(5,[1,1,3])],e.prototype,"downLongHunItemUpdate",null),__decorate([up(7,[[3]])],e.prototype,"upMeltItem",null),__decorate([down(7)],e.prototype,"downMeltItem",null),__decorate([up(6,[1,1])],e.prototype,"upLongHunItemUpLevel",null),__decorate([up(5,[1,1,3])],e.prototype,"upLongHunItemWear",null),e=i=__decorate([protocolsId(21)],e);
var i}(BaseSystem);__reflect(DragonSoulControl.prototype,"DragonSoulControl");var ExperienceJadeNewControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jadeData=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downJadeData=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.jadeData[t];n||(n=new JadeDataNewVo,this.jadeData[t]=n),n.init(e),EventMgr.ins().dispatch(576,t)},e.prototype.upUseDan=function(t,e){return[t,e]},e.prototype.upUpgrade=function(t,e){return[t,e]},e.prototype.getJadeDataByID=function(t){return this.jadeData&&this.jadeData.length?this.jadeData[t]:null},e.prototype.isJadeMax=function(t){var e=this.getJadeDataByID(t);return e?e.lv>=Object.keys(DataCenter.ins().ExperienceJadeNewLevelConfig).length-1:!1},e.prototype.checkRed=function(){for(var t=0;3>t;t++)if(this.checkRedByRoleID(t))return!0;return!1},e.prototype.checkOpen=function(){return ActorControl.level<DataCenter.ins().ExperienceJadeNewBaseConfig.openlv?!1:GameServer.serverOpenDay<DataCenter.ins().ExperienceJadeNewBaseConfig.openDay-1?!1:!0},e.prototype.checkShowOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().ExperienceJadeNewBaseConfig.openDay-1?!1:!0},e.prototype.checkRedByRoleID=function(t){if(!this.checkOpen())return!1;if(!heroControl.getSubRoleByIndex(t))return!1;var e=this.getJadeDataByID(t);if(!e)return!1;if(this.isJadeMax(t))return!1;var i,n=e.lv,o=0;for(var s in DataCenter.ins().ExperienceJadeNewBaseConfig.itemInfo)i=backpackControl.getBagItemById(+s),o+=+DataCenter.ins().ExperienceJadeNewBaseConfig.itemInfo[s]*(i?i.count:0);if(o+e.exp>=DataCenter.ins().ExperienceJadeNewLevelConfig[n].exp)return!0;var r,a=Math.floor(n/DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel)+1,l=0,h=0,u=0;for(var s in DataCenter.ins().ExperienceJadeNewBaseConfig.upgradeInfo)if(i=backpackControl.getBagItemById(+s),h=i?i.count:0,l=e.danDate&&e.danDate[s]?+e.danDate[s]:0,r=DataCenter.ins().ExperienceJadeNewLevelConfig[(a-1)*DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel],u=r.upgradeItemInfo&&r.upgradeItemInfo[s]?+r.upgradeItemInfo[s]:0,u>l&&h)return!0;return!1},e.prototype.getSkillsByLv=function(t){var e=Math.floor(t/DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel)+1,i=DataCenter.ins().ExperienceJadeNewLevelConfig[(e-1)*DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel],n=i.skillIdList?i.skillIdList.length:0;if(0>=n)return null;for(var o,s=DataCenter.ins().ExperienceJadeNewBaseConfig.skillUnlock.length,r=[],a=0;s>a;a++)for(var l=0;n>l;l++)o=i.skillIdList[l],o==DataCenter.ins().ExperienceJadeNewBaseConfig.skillUnlock[a].id&&o>100&&r.push(o);return r.length?r:null},__decorate([down(1,[2].concat(ByteConst.JadeDataNewVos))],e.prototype,"downJadeData",null),__decorate([up(2,[2,3])],e.prototype,"upUseDan",null),__decorate([up(3,[2,3])],e.prototype,"upUpgrade",null),e=__decorate([protocolsId(70)],e)}(BaseSystem);__reflect(ExperienceJadeNewControl.prototype,"ExperienceJadeNewControl");var WeaponSoulbreakItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulbreakItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(this.data){var t,e=this.data.sum,i=this.data.costNum,n=this.data.costItem;t=e>=i?ColorUtils.GREEN:ColorUtils.RED,this.lv.textFlow=TextUtils.generateTextFlow1("|C:"+t+"&T:"+e+"/"+i),this.itemIcon.imgJob.visible=!1;var o=DataCenter.ins().ItemConfig[n];this.nameTxt.text=o.name,this.itemIcon.imgIcon.source=o.icon+"_png"}},e.prototype.destruct=function(){},e.prototype.clear=function(){},e}(BaseItemRender);__reflect(WeaponSoulbreakItemRender.prototype,"WeaponSoulbreakItemRender");var DragonSoulDataVo=function(){function t(){this.level=0,this.stage=0,this.exp=0,this.state=0}return t.prototype.init=function(t){this.stage=t[0],this.level=t[1],this.exp=t[2],this.state=t[3]},t.getLongHunAllLevel=function(){for(var t=0,e=heroControl.subRolesLen,i=0;e>i;i++){var n=heroControl.getSubRoleByIndex(i).loongSoulData;t+=n.level}return t},t}();__reflect(DragonSoulDataVo.prototype,"DragonSoulDataVo");var DragonSoulItemDataVo=function(){function t(t){this.slot=t,this.itemId=0}return t}();__reflect(DragonSoulItemDataVo.prototype,"DragonSoulItemDataVo");var DragonSoulItemDecomposeItemDataVo=function(){function t(){this.itemData=null,this.isSelected=!1}return t}();__reflect(DragonSoulItemDecomposeItemDataVo.prototype,"DragonSoulItemDecomposeItemDataVo");var JadeDataNewVo=function(){function t(){this.lv=0,this.exp=0,this._isUpdate=!0}return t.prototype.init=function(t){this.lv=t[0],this.exp=t[1],this.danDate=new Object;for(var e=0;e<t[2].length;++e)this.danDate[t[2][e][0]]=t[2][e][1];this._isUpdate=!0},t.prototype.initOther=function(t){this.lv=t,this._isUpdate=!0},t.prototype.getSkillList=function(){if(this._isUpdate){this._isUpdate=!1,this._skillList=[];var t=experienceJadeNewControl.getSkillsByLv(this.lv);if(t)for(var e=0,i=t;e<i.length;e++){var n=i[e];this._skillList.push(new SkillVo(n))}}return this._skillList},t}();__reflect(JadeDataNewVo.prototype,"JadeDataNewVo");var CimeliaView=function(t){function e(){var e=t.call(this)||this;return e.lastSelect=0,e.isTopLevel=!0,e.skinName="CimeliaViewSkin",e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this.viewStack.numChildren,n=0;i>n;n++)this.viewStack.getChildAt(n).close();this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.tab,this.onTabTouch),this.addEventChange(this.roleSelect,this.onChange),this.addEventTouchTap(this.help,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addCustomEvent(574,this.showRoleRedPoint),this.addCustomEvent(498,this.showTabRedPoint),this.lastSelect=t[0]||0,this.curRole=t[1]||0,this.viewStack.selectedIndex=this.lastSelect,this.roleSelect.setCurRole(this.curRole),this.setOpenIndex(this.viewStack.selectedIndex),this.addCustomEvent(266,this.delayRedPoint),this.addCustomEvent(267,this.delayRedPoint),this.addCustomEvent(461,this.delayRedPoint),this.addCustomEvent(576,this.delayRedPoint),this.addCustomEvent(145,this.delayRedPoint),this.addCustomEvent(146,this.delayRedPoint),this.addCustomEvent(147,this.delayRedPoint),this.addCustomEvent(577,this.showTabRedPoint),this.checkYuPeiRed()},e.prototype.delayRedPoint=function(){TimerMgr.ins().isExists(this.checkYuPeiRed,this)||TimerMgr.ins().doTimer(60,1,this.checkYuPeiRed,this)},e.prototype.checkYuPeiRed=function(){this.redPoint0.visible=!1;for(var t=0;t<heroControl.subRolesLen;t++){var e=dragonSoulControl.canShowRedPointInRole(t);if(e){this.redPoint0.visible=e;break}}this.redPoint2.visible=experienceJadeNewControl.checkRed(),this.showRoleRedPoint()},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.onTabTouch=function(t){this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.setRoleId=function(t){this.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.help:var e=this.curPanelIndex(this.viewStack.selectedIndex);0==e||(2==e?HelpControl.openHelpWin(30):3==e?HelpControl.openHelpWin(27):1==e&&HelpControl.openHelpWin(36));break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.setOpenIndex=function(t){this.lastSelect=t,this.help.visible=!0,this.roleSelect.currentState="yhead";var e=[],i=this.curPanelIndex(this.viewStack.selectedIndex);switch(i){case 0:this.title.source="biaoti_longhun",this.help.visible=!1;break;case 2:this.title.source="biaoti_yupei";break;case 3:if(this.title.source="heartmethodName",void 0!=this.lastSelect){var n=this.viewStack.getElementAt(this.lastSelect);n&&(e[0]=n.heartId)}break;case 4:this.help.visible=!1,this.title.source="biaoti_shoushen",this.roleSelect.currentState="nohead";break;case 1:this.title.source="hunguName",e[0]=0}void 0!=this.lastSelect&&this.viewStack.getElementAt(this.lastSelect).close(),this.viewStack.getElementAt(this.lastSelect).open(this.curRole,e[0]),this.showRoleRedPoint()},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole())},e.prototype.checkIsOpen=function(t){return t=this.curPanelIndex(t),2!=t||experienceJadeNewControl.checkOpen()?3!=t||heartMethodControl.checkOpen()?4!=t||beastControl.checkOpen()?1!=t||soulBoneControl.checkOpen()?!0:(tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().SoulBoneConfig.openserverday,DataCenter.ins().SoulBoneConfig.openzhuanshenglv)),!1):(tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().BeastConfig.openserverday,DataCenter.ins().BeastConfig.openzhuanshenglv)),!1):(tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().HeartMethodBaseConfig.serverDay,DataCenter.ins().HeartMethodBaseConfig.zsLv)),!1):(tipsControl.showTips(LangMgr.getValueByKey("fbShow2",DataCenter.ins().ExperienceJadeNewBaseConfig.openDay,DataCenter.ins().ExperienceJadeNewBaseConfig.openlv)),!1)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.showTabRedPoint=function(){this.redPoint1.visible=SoulBoneRedPoint.ins().redPoint,this.redPoint3.visible=HeartMethodRedPoint.ins().redPoint,this.redPoint4.visible=BeastRedPoint.ins().redpoint},e.prototype.showRoleRedPoint=function(){var t=heroControl.subRolesLen;switch(this.curPanelIndex(this.viewStack.selectedIndex)){case 0:for(var e=0;t>e;e++)this.roleSelect.showRedPoint(e,dragonSoulControl.canShowRedPointInRole(e));break;case 2:for(var e=0;t>e;e++)this.roleSelect.showRedPoint(e,experienceJadeNewControl.checkRedByRoleID(e));break;case 3:for(var e=0;t>e;e++){var i=!1;for(var n in HeartMethodRedPoint.ins().roleTabs[e])if(HeartMethodRedPoint.ins().roleTabs[e][n]){i=!0;break}this.roleSelect.showRedPoint(e,i)}break;case 1:for(var e=0;t>e;e++){var i=SoulBoneRedPoint.ins().roleTabs[e];this.roleSelect.showRedPoint(e,i)}}this.showTabRedPoint()},e.prototype.curPanelIndex=function(t){var e=this.viewStack.getElementAt(t).data;return parseInt(e)},e}(BaseEuiView);__reflect(CimeliaView.prototype,"CimeliaView");var DragonSoulEquipPreviewTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DragonSoulEquipPreviewTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.itemId=t[0],this.updateView()},e.prototype.updateView=function(){var t=DataCenter.ins().DragonSoulStarConfig[this.itemId];if(t){this.icon.source=t.bigIcon,t.effect&&(this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effGroup.addChild(this.mc),this.mc.playFile(PATH_EFF+t.effect,-1));var e=DataCenter.ins().ItemConfig[this.itemId];this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(e)+"&T:"+e.name);var i=BackpackControl.getAttrPower(t.attr);this.powerPanel.setPower(i);for(var n=0;n<t.attr.length;n++){var o=t.attr[n],s=this.getTypeLbl(o.type);s&&(s.text="+"+o.value)}var r="";if(t.nextItem){var a=DataCenter.ins().ItemConfig[t.costItem];if(a){var l=ItemUtils.getQualityColor(a);r="|C:"+LangMgr.getColor("color73")+"&T:"+LangMgr.getValueByKey("upstarexpen")+" |C:"+l+"&T:"+a.name+("|C:"+LangMgr.getColor("color73")+"&T: X")+t.costNum,this.cost.textFlow=TextUtils.generateTextFlow1(r)}}var h=DataCenter.ins().DragonSoulPosConfig[t.posId][t.quality];if(h){var u=Object.keys(h).length-1;this.starList?this.starList.setlistLength(u,t.star):(this.starList=new StarList(u),this.starList.horizontalCenter=0,this.starList.y=0,this.starGroup.addChild(this.starList)),this.starList.setStarNum(t.star)}}},e.prototype.getTypeLbl=function(t){return this["value"+t]},e.prototype.onTap=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DragonSoulEquipPreviewTipsView.prototype,"DragonSoulEquipPreviewTipsView");var DragonSoulEquipSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DragonSoulEquipSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.addCustomEvent(149,this.updateUI),this.roleId=t[0],this.updateUI(),TimerMgr.ins().remove(this.playSkillAnmi,this),TimerMgr.ins().doTimer(3e3,0,this.playSkillAnmi,this),this.playSkillAnmi()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick)},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateUI=function(){var t,e=dragonSoulControl.calcLongHunSkillLevel(this.roleId),i=Object.keys(DataCenter.ins().DragonSoulSuitConfig).length;e?e>=i?(this.currentState="max",t=DataCenter.ins().DragonSoulSuitConfig[i]):(this.currentState="normal",t=DataCenter.ins().DragonSoulSuitConfig[e]):(this.currentState="initial",t=DataCenter.ins().DragonSoulSuitConfig[1]),this.validateNow(),t&&(this.skillName.text=t.skillname,this.skillShow.source=t.skillShowPic);var n=LangMgr.getColor("qualityColor"+t.level);this.curskillDesc0.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:【"+t.skillname+"】");var o="",s=dragonSoulControl.getLongHunSuitCount(this.roleId,t.level),r=CommonUtils.getObjectLength(DataCenter.ins().DragonSoulPosConfig);if(o="("+s+"/"+r+")","initial"==this.currentState)this.curskillDesc2.text=this.getColorDesc(t.level)+o,this.curskillDesc3.textFlow=TextUtils.generateTextFlow1(t.skilldesc);else if("normal"==this.currentState){var a=DataCenter.ins().DragonSoulSuitConfig[e+1];this.curskillDesc3.textFlow=TextUtils.generateTextFlow1(t.skilldesc),s=dragonSoulControl.getLongHunSuitCount(this.roleId,a.level),o="("+s+"/"+r+")",n=LangMgr.getColor("qualityColor"+a.level),this.nextskillTitle0.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:【"+a.skillname+"】"),this.nextskillTitle2.text=this.getColorDesc(a.level)+o,this.nextskillTitle3.textFlow=TextUtils.generateTextFlow1(a.skilldesc)}else"max"==this.currentState&&(this.nextskillTitle0.textFlow=TextUtils.generateTextFlow1("|C:"+n+"&T:【"+t.skillname+"】"),this.nextskillTitle3.textFlow=TextUtils.generateTextFlow1(t.skilldesc))},e.prototype.getColorDesc=function(t){var e=ColorUtils.getColorcChinese(t);return e&&(e=LangMgr.getValueByKey("dragonSoulColorTip",e)),e},e.prototype.playSkillAnmi=function(){var t=this,e=heroControl.getSubRoleByIndex(this.roleId),i="skill40"+e.job,n="skill"+(403+e.job);egret.Tween.removeTweens(this.eff1);var o=egret.Tween.get(this.eff1);this.HejiSkillMc1||(this.HejiSkillMc1=new GameMovieClip),this.HejiSkillMc1.parent||this.eff1.addChild(this.HejiSkillMc1),this.HejiSkillMc1.playFile(PATH_SKILLEFF+i,1,null,!0),o.wait(1500).call(function(){t.HejiSkillMc2||(t.HejiSkillMc2=new GameMovieClip),t.HejiSkillMc2.parent||t.eff2.addChild(t.HejiSkillMc2),t.HejiSkillMc2.playFile(PATH_SKILLEFF+n,1,null,!0)},this)},e}(BaseEuiView);__reflect(DragonSoulEquipSkillTipsView.prototype,"DragonSoulEquipSkillTipsView");var DragonSoulItemAttrView=function(t){function e(){var e=t.call(this)||this;return e._lastX=0,e.proShowList=[],e.skinName="HeartMethodAttrViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.proShowList=dragonSoulControl.proShowList,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.setRoleAttr(this.curRole);var i=heroControl.subRolesLen;i>1&&(this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchBegin(this.bg,this.onMove),this.addEventTouchEnd(this.bg,this.onMove)),this.addEventTouchEnd(this,this.otherClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=heroControl.subRolesLen;i>1&&(this.removeEventTouchTap(this.leftBtn,this.onTouch),this.removeEventTouchTap(this.rightBtn,this.onTouch),this.removeEventTouchBegin(this.bg,this.onMove),this.removeEventTouchEnd(this.bg,this.onMove)),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200)):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200))}},e.prototype.moveAttr=function(t){var e=egret.Tween.get(this.attrGroup),i=t>0?0:242;e.to({x:this.attrGroup.x+t,alpha:0},200).to({x:i},200).to({x:80,alpha:1},200)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.leftBtn:this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200));break;case this.rightBtn:this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200))}},e.prototype.setRoleAttr=function(t){var e=heroControl.getSubRoleByIndex(t);this.job.source="op_"+e.job;for(var i="",n="",o=0,s=0,r=dragonSoulControl.calcLongHunItemTotalValue(e.index),a=0;a<this.proShowList.length;a++)s=this.proShowList[a].id,r[a].type==s&&(o=r[a].value,o&&(i+=63==this.proShowList[a].id?o+"%":o+"",n+=dragonSoulControl.getAttrStrByType(s)+":",a<this.proShowList.length-1&&(i+="\n",n+="\n")));this.attr.text=i,this.attrName.text=n,this.setBtn()},e.prototype.setBtn=function(){var t=heroControl.subRolesLen;1==t?(this.leftBtn.visible=!1,this.rightBtn.visible=!1):t>1&&(0==this.curRole?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):1==this.curRole?(this.leftBtn.visible=!0,this.rightBtn.visible=t>=3):2==this.curRole&&(this.leftBtn.visible=!0,this.rightBtn.visible=!1))},e}(BaseEuiView);__reflect(DragonSoulItemAttrView.prototype,"DragonSoulItemAttrView");var DragonSoulItemDecomposeView=function(t){function e(){var e=t.call(this)||this;return e.cardList=null,e.cardCollection=null,e.checkBoxNum=5,e.itemListScrollV=0,e.resolveIng=!1,e._addNum=0,e._chipNum=0,e.skinName="DragonSoulItemDecomposeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemList.itemRenderer=DragonSoulItemDecomposeItemRender,this.itemList.useVirtualLayout=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.checkBoxNum;i++)this["cb"+i]&&this.addEventTouchTap(this["cb"+i],this.onCBTap);this.addEventTouchTap(this.decomposeBtn,this.onTap),this.addEventTouchTap(this.itemList,this.onListTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(150,this.onDecomposeResult),this.initCardList(),this.resetCheckBox(-1),this.updateShatter(),this.fixCardListRule()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cleanCardList()},e.prototype.onDecomposeResult=function(t){var e=this;TimerMgr.ins().doTimer(100,1,function(){e.initCardList(),e.updateShatter(),e.updateAddShatter(),e.resolveIng=!1},this)},e.prototype.playEffect=function(){for(var t=this.itemList.numChildren,e=0;t>e;e++){var i=this.itemList.getChildAt(e);i&&i.playEffect()}},e.prototype.onShatterChange=function(){this.updateShatter()},e.prototype.onListTap=function(t){if(t&&t.currentTarget){var e=this.itemList.selectedIndex;if(0>e)return;var i=this.itemList.getVirtualElementAt(e);if(i&&i instanceof DragonSoulItemDecomposeItemRender&&i.cb){var n=i.data;n&&(n.isSelected=!n.isSelected,this.cardCollection.itemUpdated(n))}this.itemList.selectedIndex=-1,this.updateAddShatter()}},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.decomposeBtn:this.decomposeLonghun();break;case this.bgClose:UIMgr.ins().close(this)}},e.prototype.decomposeLonghun=function(){if(!this.resolveIng){if(this.cardList&&this.cardList.length>0){for(var t=[],e=0;e<this.cardList.length;e++){var i=this.cardList[e];i&&i.isSelected&&i.itemData&&i.itemData.itemConfig&&t.push(i.itemData)}if(t.length>0){this.resolveIng=!0;for(var n=[],o=0;o<t.length;o++)n.push(t[o].configID);return void dragonSoulControl.upMeltItem(n)}}tipsControl.showTips(LangMgr.getValueByKey("noSeldragonSoulEquip"))}},e.prototype.onCBTap=function(t){if(t&&t.currentTarget&&t.currentTarget instanceof eui.CheckBox)for(var e=null,i=0;i<this.checkBoxNum;i++)if(e=this["cb"+i],e&&e===t.currentTarget)return void this.setQualitySelected(i+1,t.currentTarget.selected)},e.prototype.updateShatter=function(){var t=DataCenter.ins().DragonSoulBaseConfig.smeltId,e=DataCenter.ins().ItemConfig[t];this.suipianIcon.source=e.icon+"_png";var i=backpackControl.getBagItemById(e.id);this.suipianNum.text=(i?i.count:0)+""},e.prototype.updateAddShatter=function(){var t=0,e=null;if(this.cardList&&this.cardList.length>0)for(var i=0;i<this.cardList.length;i++){var n=this.cardList[i];n&&n.isSelected&&n.itemData&&n.itemData.itemConfig&&(e=dragonSoulControl.getLongHunStarCfg(n.itemData),e&&(t+=e.splitNum))}this._addNum=t,this.suipianAdd.text=t?"+"+t:""},e.prototype.setQualitySelected=function(t,e){if(0>t)for(var i=0;i<this.cardList.length;i++){var n=this.cardList[i];n.itemData&&n.itemData.itemConfig&&(n.isSelected=!1)}else for(var i=0;i<this.cardList.length;i++){var n=this.cardList[i];n.itemData&&n.itemData.itemConfig&&ItemUtils.getQuality(n.itemData.itemConfig)==t&&(n.isSelected=e)}for(var o=this.cardCollection.length,i=0;o>i;i++)this.cardCollection.itemUpdated(this.cardList[i]);this.updateAddShatter()},e.prototype.getCheckBoxSelected=function(t){var e=this["cb"+(t-1)];return e?e.selected:!1},e.prototype.resetCheckBox=function(t){void 0===t&&(t=1);for(var e=null,i=0;i<this.checkBoxNum;i++)e=this["cb"+i],e&&e instanceof eui.CheckBox&&(e.selected=i+1==t);this.setQualitySelected(t,!0)},e.prototype.initCardList=function(){this.cleanCardList(),this.cardList=[];var t=backpackControl.getBagGoodsByType(30);if(t&&t.length>0){for(var e=null,i=0;i<t.length;i++)for(var n=t[i],o=0;o<n.count;o++)e=new DragonSoulItemDecomposeItemDataVo,e.itemData=n,this.cardList.push(e);this.cardList.sort(this.sortList)}this.cardCollection=new eui.ArrayCollection(this.cardList),this.itemList.dataProvider=this.cardCollection},e.prototype.fixCardListRule=function(){for(var t=dragonSoulControl.getDecomposeSuggestList(),e=0;e<this.cardList.length;e++){this.cardList[e].isSelected=!1;for(var i=0;i<t.length;i++)if(t[i].configID==this.cardList[e].itemData.configID&&(t[i].count--,this.cardList[e].isSelected=!0,t[i].count<=0)){t.splice(i,1);break}}for(var e=0;e<this.cardCollection.length;e++)this.cardCollection.itemUpdated(this.cardList[e]);this.updateAddShatter()},e.prototype.cleanCardList=function(){this.cardList=null,this.cardCollection=null,this.itemList.dataProvider=null},e.prototype.sortList=function(t,e){var i=ItemUtils.getQuality(t.itemData.itemConfig),n=ItemUtils.getQuality(e.itemData.itemConfig);if(i>n)return-1;if(n>i)return 1;var o=dragonSoulControl.getLongHunStarCfg(t.itemData),s=dragonSoulControl.getLongHunStarCfg(e.itemData);return o.star>s.star?-1:1},e}(BaseEuiView);__reflect(DragonSoulItemDecomposeView.prototype,"DragonSoulItemDecomposeView");var DragonSoulItemTipsPreviewView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DragonSoulEquipPreviewTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.itemId=t[0],this.updateUI()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.starList),this.starList=null},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateUI=function(){var t=DataCenter.ins().DragonSoulStarConfig[this.itemId];if(t){this.icon.source=t.bigIcon,t.effect&&(this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effGroup.addChild(this.mc),this.mc.playFile(PATH_EFF+t.effect,-1));var e=DataCenter.ins().ItemConfig[this.itemId];this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(e)+"&T:"+e.name);var i=BackpackControl.getAttrPower(t.attr);this.powerPanel.setPower(i);for(var n=dragonSoulControl.proShowList,o=0;o<n.length;o++){var s=n[o];if(this["value"+s.id])for(var r=0;r<t.attr.length;r++)if(s.id==t.attr[r].type){this["value"+s.id].text="+"+t.attr[r].value;break}}var a=DataCenter.ins().DragonSoulPosConfig[t.posId][t.quality];if(a){for(var l=Object.keys(a).length-1,h=l>5?5:l,u=t.star>5?t.star-5:t.star,p=t.star<=5?-1:1,c=[],o=0;h>o;o++)c.push({star:-1==p?"star2":"startMoon"+p,fullStar:-1==p?"star1":"startMoonFull"+p});this.starList?this.starList.setlistLength(h,u):(this.starList=new StarList(h,0,50,1,0,c),this.starList.horizontalCenter=0,this.starList.y=0,this.starGroup.addChild(this.starList)),this.starList.setStarNum(u)}}},e}(BaseEuiView);__reflect(DragonSoulItemTipsPreviewView.prototype,"DragonSoulItemTipsPreviewView");var DragonSoulItemTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DragonSoulItemTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.addEventTouchTap(this.addStar,this.onClick),this.addEventTouchTap(this.replace,this.onClick),this.addEventTouchTap(this.fenjie,this.onClick),this.addCustomEvent(149,this.updateUI),this.addCustomEvent(150,this.updateRedPoint),this.roleId=t[0],this.itemId=t[1],this.updateUI()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeEventTouchTap(this.addStar,this.onClick),this.removeEventTouchTap(this.replace,this.onClick),DisplayUtils.removeFromParent(this.starList),this.starList=null},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.addStar:if(this.isMax)return void tipsControl.showTips(LangMgr.getValueByKey("bookStartMax"));if(this.isAdd){var e=DataCenter.ins().DragonSoulStarConfig[this.itemId].posId;dragonSoulControl.upLongHunItemUpLevel(this.roleId,e)}else tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"));break;case this.replace:if(!this.pId)return void tipsControl.showTips(LangMgr.getValueByKey("happyTips5",this.itemId));var i=dragonSoulControl.calcLongHunSlotChange(this.roleId,this.pId);if(!i)return void tipsControl.showTips(LangMgr.getValueByKey("happyTips4"));dragonSoulControl.upLongHunItemWear(this.roleId,this.pId,i);break;case this.fenjie:UIMgr.ins().open(DragonSoulItemDecomposeView)}},e.prototype.updateUI=function(){if(this.pId=DataCenter.ins().DragonSoulStarConfig[this.itemId].posId,this.pId){var t=heroControl.getSubRoleByIndex(this.roleId);this.itemId=t.longhunItemData[this.pId-1].itemId;var e=DataCenter.ins().DragonSoulStarConfig[this.itemId];if(e){this.icon.source=e.bigIcon,e.effect&&(this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effGroup.addChild(this.mc),this.mc.playFile(PATH_EFF+e.effect,-1));var i=DataCenter.ins().ItemConfig[this.itemId];this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(i)+"&T:"+i.name);var n=BackpackControl.getAttrPower(e.attr);this.powerPanel.setPower(n);for(var o="",s="",r=dragonSoulControl.proShowList,a=0;a<r.length;a++)for(var l=r[a],h=e.attr,u=0;u<h.length;u++){var p=h[u];if(l.id==p.type){var c=dragonSoulControl.getAttrStrByType(p.type);if(!c)continue;if(!p.value)continue;o+=c,s+="+"+p.value,o+="\n",s+="\n"}}if(o){var d=o.lastIndexOf("\n");o=o.substring(0,d)}if(s){var d=s.lastIndexOf("\n");s=s.substring(0,d)}this.attr.text=o,this.value.text=s;var g="";if(this.isMax=!1,e.nextItem){var m=DataCenter.ins().ItemConfig[e.costItem];if(m){var f=ItemUtils.getQualityColor(m);g="|C:"+LangMgr.getColor("color73")+"&T:"+LangMgr.getValueByKey("heirXH")+" |C:"+f+"&T:"+m.name+("|C:"+LangMgr.getColor("color73")+"&T: X")+e.costNum,this.cost.textFlow=TextUtils.generateTextFlow1(g)}this.isAdd=dragonSoulControl.calcLongHunSlotCost(this.itemId)}else this.isMax=!0,this.isAdd=!1;this.cost.visible=g?!0:!1;var v=DataCenter.ins().DragonSoulPosConfig[e.posId][e.quality];if(v){for(var y=Object.keys(v).length-1,C=y>5?5:y,T=e.star>5?e.star-5:e.star,w=e.star<=5?-1:1,I=[],b=0;C>b;b++)I.push({star:-1==w?"star2":"startMoon"+w,fullStar:-1==w?"star1":"startMoonFull"+w});this.starList?this.starList.setlistLength(C,T):(this.starList=new StarList(C,0,50,1,0,I),this.starList.horizontalCenter=0,this.starList.y=0,this.starGroup.addChild(this.starList)),this.starList.setStarNum(T,0,I)}this.updateRedPoint()}}},e.prototype.updateRedPoint=function(){this.redPoint0.visible=dragonSoulControl.getDecomposeRedPoint(),this.redPoint1.visible=this.isAdd,this.redPoint2.visible=dragonSoulControl.calcLongHunSlotChange(this.roleId,this.pId)?!0:!1},e}(BaseEuiView);__reflect(DragonSoulItemTipsView.prototype,"DragonSoulItemTipsView");var DragonSoulPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.starList=null,e.barbc=new ProgressBarEff,e.isAutoUp=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.barbc.setWidth(525),this.barbc.x=-15,this.barbc.y=-12,this.expGroup.addChild(this.barbc),this.starList=new StarList(10),this.starGroup.addChild(this.starList),this.iconY=this.icon.y,this.iconMoveY=this.iconY-10,this.effGroup&&(this.iconYEff=this.effGroup.y,this.iconMoveYEff=this.iconYEff-10),this.eff=new GameMovieClip,this.eff.x=this.activeBtnMc.width/2,this.eff.y=this.activeBtnMc.height/2,this.eff.scaleX=1,this.eff.touchEnabled=!1,this.activeBtnMc.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.updateUIState();var i=t&&t[0]?t[0]:0;this.curRole=i,this.index=DragonSoulControl.TYPE_LONG_HUN,this.addEventTouchTap(this.upgradeBtn,this.onTap),this.addEventTouchTap(this.upgradeBtn0,this.onTap),this.addEventTouchTap(this.activeBtn,this.onTap),this.addEventTouchTap(this.skill,this.onTap),this.addCustomEvent(266,this.roleChange),this.addCustomEvent(145,this.roleChange),this.addCustomEvent(146,this.roleChange),this.addCustomEvent(147,this.roleChange),this.addCustomEvent(149,this.roleChange),this.addCustomEvent(181,this.updateUIState);for(var n=1;4>=n;n++)this.addEventTouchTap(this["equip"+n],this.onSlot);this.barbc.reset(),this.maxShowGroup.visible=!1,this.roleChange(),this.onTabChange(),this.playIconTween(),this.playIconTweenEff(),this.upBtn.open(DataCenter.ins().DragonSoulBaseConfig.upgrateItem,this.curRole)},e.prototype.updateUIState=function(){this.currentState=payControl.franchise?"card":"nor"},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.stopIconTween(),this.stopIconTweenEff(),DisplayUtils.removeFromParent(this.eff),TimerMgr.ins().remove(this.autoUpStar,this),this.upBtn.close()},e.prototype.onSlot=function(t){for(var e=1;4>=e;e++)if(t.currentTarget==this["equip"+e]){var i=dragonSoulControl.getLongHunSlotItemId(this.curRole,e);if(i)UIMgr.ins().open(DragonSoulItemTipsView,this.curRole,i);else{var n=dragonSoulControl.calcLongHunSlotChange(this.curRole,e);if(!n)return void tipsControl.showTips(LangMgr.getValueByKey("happyTips6"));dragonSoulControl.upLongHunItemWear(this.curRole,e,n)}}},e.prototype.roleSelectChange=function(t){this.roleChange()},e.prototype.playIconTween=function(){this.icon.y=this.iconY,egret.Tween.removeTweens(this.icon),egret.Tween.get(this.icon,{loop:!0}).to({y:this.iconMoveY},1e3).to({y:this.iconY},1e3)},e.prototype.stopIconTween=function(){egret.Tween.removeTweens(this.icon)},e.prototype.playIconTweenEff=function(){this.effGroup.y=this.iconYEff,egret.Tween.removeTweens(this.effGroup),egret.Tween.get(this.effGroup,{loop:!0}).to({y:this.iconMoveYEff},1e3).to({y:this.iconYEff},1e3)
},e.prototype.stopIconTweenEff=function(){egret.Tween.removeTweens(this.effGroup)},e.prototype.onTabChange=function(t){void 0===t&&(t=null),this.roleChange()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.colorCanvas0:case this.closeBtn0:case this.closeBtn:UIMgr.ins().close(this);break;case this.upgradeBtn:this.upgradeBtn.label==LangMgr.getValueByKey("zxPanelUp")?this.sendUpgrade():this.upgradeBtn.label==LangMgr.getValueByKey("liliUpdateLeve")?this.sendStageUpgrade():this.openBuyGoods();break;case this.upgradeBtn0:if(this.upgradeBtn0.label==LangMgr.getValueByKey("loonOneKeyUp"))if(payControl.franchise)if(this.isAutoUp)this.stopAutoUp();else{var e=backpackControl.getBagGoodsCountById(0,this._config.itemId);e>0?(this.isAutoUp=!0,this.upgradeBtn0.label=LangMgr.getValueByKey("wingStop1"),TimerMgr.ins().doTimer(300,0,this.autoUpStar,this)):this.openBuyGoods()}else{var i=warnControl.show(LangMgr.getValueByKey("loonTips2"),null,null,function(){UIMgr.ins().open(WelfareView,3)});i.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("smeltActivity"))}else this.upgradeBtn0.label==LangMgr.getValueByKey("liliUpdateLeve")?this.sendStageUpgrade():this.upgradeBtn0.label==LangMgr.getValueByKey("wingStop1")?this.stopAutoUp():this.openBuyGoods();break;case this.activeBtn:var n=DataCenter.ins().DragonSoulBaseConfig.openlv;ActorControl.level>=n?this.sendStageActive():tipsControl.showTips(LangMgr.getValueByKey("loonTips3",n));break;case this.skill:UIMgr.ins().open(DragonSoulEquipSkillTipsView,this.curRole);break;case this.detail:UIMgr.ins().open(DragonSoulItemAttrView,this.curRole)}},e.prototype.stopAutoUp=function(){this.isAutoUp=!1,this.upgradeBtn0&&(this.upgradeBtn0.label=LangMgr.getValueByKey("loonOneKeyUp")),TimerMgr.ins().remove(this.autoUpStar,this),egret.Tween.removeTweens(this.upgradeBtn0)},e.prototype.autoUpStar=function(){var t=backpackControl.getBagGoodsCountById(0,this._config.itemId);t>0?dragonSoulControl.upUpGrade(this.curRole,this.index-1):(this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpStar,this),this.openBuyGoods())},e.prototype.onGetItem=function(t){warnControl.setBuyGoodsWarn(this._config.itemId,1)},e.prototype.maxControll=function(t){this.maxGroup.visible=t,this.material.visible=t,this.barbc.visible=t,this.powerPanel.visible=!0,this.maxLevel.visible=!t,this.activeGroup.visible=!1,this.lv.visible=!0,this.maxShowGroup.visible=!t,t?(this.curAtt.x=62,this.curAtt.y=408):(this.curAtt.x=170,this.curAtt.y=408)},e.prototype.sendUpgrade=function(){dragonSoulControl.upUpGrade(this.curRole,this.index-1)},e.prototype.sendStageUpgrade=function(){dragonSoulControl.upStageUpgrade(this.curRole,this.index-1)},e.prototype.openBuyGoods=function(){warnControl.setBuyGoodsWarn(this._config.itemId,1)},e.prototype.sendStageActive=function(){dragonSoulControl.upStageActive(this.curRole,this.index-1)},e.prototype.updateStageInfo=function(){var t=heroControl.getSubRoleByIndex(this.curRole);switch(this.index){case DragonSoulControl.TYPE_LONG_HUN:this._stageConfig=DataCenter.ins().DragonSoulStageConfig[t.loongSoulData.stage]}this.icon.source=this._stageConfig.icon},e.prototype.roleChange=function(t){void 0===t&&(t=0),this.updateStageInfo();var e,i=0,n=0,o=heroControl.getSubRoleByIndex(this.curRole),s=null;if(this.index==DragonSoulControl.TYPE_LONG_HUN){i=o.loongSoulData.level,n=o.loongSoulData.exp;this._config=DataCenter.ins().DragonSoulConfig[i],e=DataCenter.ins().DragonSoulConfig[i+1],this.lv.data=StringUtils.NumberToChinese(o.loongSoulData.stage+1)+LangMgr.getValueByKey("osaLevelJ"),s=AttributeData.AttrAddition(this._config.attr,this._stageConfig.attr),s=magicCircleControl.getAttrsBySysID(s,3,this.curRole);var r=magicCircleControl.getAddPerBySysID(3,this.curRole)>0?16767295:this.curAtt.textColor;this.curAtt.textFlow=TextUtils.generateTextFlow("|C:"+r+"&T:"+AttributeData.getAttStr(s,0,1,"：")+"|"),this.maxCurAtt.text=this.curAtt.text}i>0?this.starList.setStarNum(i%10==0?10:i%10,t):this.starList.setStarNum(0);var a=DataCenter.ins().DragonSoulBaseConfig.openlv;this.sysDescText.text=LangMgr.getValueByKey("loonTips4",a),this.barbc.setData(n,this._config.exp);var l=BackpackControl.getAttrPower(this._config.attr);l+=Math.floor(l*magicCircleControl.getAddPerBySysID(3,this.curRole)/1e4);var h=dragonSoulControl.getLongHunEquipPower(this.curRole);l+=h[0],this.powerPanel.setPower(l);var u=CommonUtils.getObjectLength(DataCenter.ins().DragonSoulConfig)-1;if(o.loongSoulData.state){if(i==u)return this.maxControll(!1),void this.updateLongHunItemsUI();this.maxControll(!0)}else this.maxGroup.visible=!1,this.material.visible=!1,this.barbc.visible=!1,this.maxLevel.visible=!1,this.lv.visible=!1,this.activeGroup.visible=!0,this.powerPanel.visible=!1,this.redPoint.visible=!1,ActorControl.level>=a?(this.activeBtn.enabled=!0,this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||this.activeBtnMc.addChild(this.eff),this.redPoint.visible=!0):(this.activeBtn.enabled=!1,DisplayUtils.removeFromParent(this.eff));var p=backpackControl.getBagGoodsCountById(0,this._config.itemId);DataCenter.ins().ItemConfig[this._config.itemId].name;this.getCurButton().label=1>p?LangMgr.getValueByKey("zhuzaiMaterial1"):payControl.franchise?this.isAutoUp?LangMgr.getValueByKey("wingStop1"):LangMgr.getValueByKey("loonOneKeyUp"):LangMgr.getValueByKey("zxPanelUp");var c=p>=this._stageConfig.normalCost?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR;this.material.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("loonTips5",c,p,ColorUtils.WHITE_COLOR,this._stageConfig.normalCost)),this.material.visible=!0,this.showStageUpgradeBtn(i);var d,g,m=0,f=this.getCurButton().label==LangMgr.getValueByKey("liliUpdateLeve")||this.getCurButton().label==LangMgr.getValueByKey("wingOneKeyUpdate"),v=f?this._config:e;this.index==DragonSoulControl.TYPE_LONG_HUN&&(d=v.attr,m=f?o.loongSoulData.stage+1:o.loongSoulData.stage,g=DataCenter.ins().DragonSoulStageConfig[m]),d=AttributeData.AttrAddition(d,g.attr),this.index==DragonSoulControl.TYPE_LONG_HUN&&(d=magicCircleControl.getAttrsBySysID(d,3,this.curRole)),this.nextAtt.text=AttributeData.getAttStr(d,0,1,"："),this.updateLongHunItemsUI()},e.prototype.showStageUpgradeBtn=function(t){var e=0,i=heroControl.getSubRoleByIndex(this.curRole);switch(this.index){case DragonSoulControl.TYPE_LONG_HUN:e=i.loongSoulData.stage}t>0&&t%10==0&&(t/10-1>=e?(this.stopAutoUp(),this.getCurButton().label=LangMgr.getValueByKey("liliUpdateLeve"),this.material.visible=!1,this.starList.setStarNum(10),this.barbc.visible=!1):(this.starList.setStarNum(0),this.barbc.visible=!0))},e.prototype.getCurButton=function(){var t=this.upgradeBtn;return payControl.franchise&&(t=this.upgradeBtn0),t},e.prototype.updateLongHunItemsUI=function(){if(!dragonSoulControl.checkLongHunItemsSysOpen(this.curRole))return void(this.longhunitem.visible=!1);this.longhunitem.visible=!0;var t=heroControl.getSubRoleByIndex(this.curRole),e=t.longhunItemData;if(e){for(var i=0;i<e.length;i++)if(this["equip"+(i+1)]){var n=i+1,o=e[i].itemId,s=dragonSoulControl.calcLongHunSlotChange(this.curRole,n),r=s?!0:!1;!r&&o&&(r=dragonSoulControl.calcLongHunSlotCost(o)),!r&&o&&(r=dragonSoulControl.getDecomposeRedPoint()),this["equip"+(i+1)].data={itemid:o,redPoint:r,slot:n}}var a=dragonSoulControl.calcLongHunSkillLevel(this.curRole),l=DataCenter.ins().DragonSoulSuitConfig[a];l?(this.bigEff||(this.bigEff=new GameMovieClip),this.bigEff.parent||this.effGroup.addChild(this.bigEff),this.bigEff.name!=PATH_EFF+l.inside&&this.bigEff.playFile(PATH_EFF+l.inside,-1)):DisplayUtils.removeFromParent(this.bigEff)}},e}(BasePanel);__reflect(DragonSoulPanel.prototype,"DragonSoulPanel");var DragonSoulItemDecomposeItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeartMethodDecomposeItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.cb.touchChildren=!1,this.cb.touchEnabled=!1;var t=this.data.itemData;if(t&&t instanceof ItemData){var e=dragonSoulControl.getLongHunStarCfg(t);e?this.itemIcon.data=t:this.resetView()}else this.resetView();this.cb.selected=this.data.isSelected},e.prototype.resetView=function(){this.itemIcon.data=null},e.prototype.playEffect=function(){!this.cb.selected},e}(BaseItemRender);__reflect(DragonSoulItemDecomposeItemRender.prototype,"DragonSoulItemDecomposeItemRender");var DragonSoulItemDisplayItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeartMethodDisplayItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data instanceof ItemData){var t=DataCenter.ins().ItemConfig[this.data.itemConfig.id];this.itemIcon.setData(t);var e=ItemUtils.getQualityColor(t);this.nameTF.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+t.name)}},e}(BaseItemRender);__reflect(DragonSoulItemDisplayItemRender.prototype,"DragonSoulItemDisplayItemRender");var DragonSoulItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="DragonSoulItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.data.itemid?(this.itemIcon.setData(DataCenter.ins().ItemConfig[this.data.itemid]),this.itemIcon.visible=!0,this.blank.visible=!1):(this.itemIcon.visible=!1,this.blank.source=DataCenter.ins().DragonSoulBaseConfig.lhItemRes[this.data.slot-1],this.blank.visible=!0),this.redPoint.visible=this.data.redPoint)},e}(BaseItemRender);__reflect(DragonSoulItemRender.prototype,"DragonSoulItemRender");var ExperienceJadeMainPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curRole=0,e._oldLevel=0,e._curMaterail=-1,e._oneKeyUp=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._iconY=this.yupei.y,this._iconMoveY=this.yupei.y-10,this.yupei.perLevel=DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel,this._danInfo=[];var e,i=0;for(var n in DataCenter.ins().ExperienceJadeNewBaseConfig.upgradeInfo)this["up"+i].name=i,e=DataCenter.ins().ItemConfig[n],this["up"+i].source=e.icon+"_png",this._danInfo.push({id:+n,used:0,curMax:0,jade:0,count:0}),i++;this._materialInfo=[],i=0;for(var n in DataCenter.ins().ExperienceJadeNewBaseConfig.itemInfo)this["checkBoxs"+i].name=i,e=DataCenter.ins().ItemConfig[n],this["lvImg"+i].source=e.icon+"_png",this["lvImg"+i].name=n,this._materialInfo.push({id:+n,count:0,addExp:+DataCenter.ins().ExperienceJadeNewBaseConfig.itemInfo[n]}),i++;for(i=0;5>i;i++)this["skillIcon"+i].name=i,this["skillIcon"+i].touchEnabled=!0,this["skillIcon"+i].touchChildren=!1;this._expBar=new ProgressBarEff,this._expBar.setWidth(525),this.barGroup.addChild(this._expBar),this._expBar.x=-15,this._expBar.y=-10},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&t.length&&(this._curRole=t[0]),this._jadeData=experienceJadeNewControl.getJadeDataByID(this._curRole),this._jadeData&&(this._oldLevel=this._jadeData.lv,this.addCustomEvent(576,this.jadeChange),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addEventTouchTap(this,this.onTouch),this.reset(),this.update(),this.playIconTween(),this.initCheckBoxs())},e.prototype.initCheckBoxs=function(){var t=this._materialInfo.length;this._curMaterail=0;for(var e=0;t>e;e++)if(this._materialInfo[e].count){this._curMaterail=e;break}this["checkBoxs"+this._curMaterail].selected=!0},e.prototype.reset=function(){this._curMaterail=-1,this.stopOneKyUp(),this.checkBoxs0.selected=this.checkBoxs1.selected=this.checkBoxs2.selected=!1,this.stopIconTween(),this._expBar.reset()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.yupei.close(),this._curMaterail=-1,this.stopOneKyUp()},e.prototype.jadeChange=function(t){this._curRole==t&&(this._jadeData=experienceJadeNewControl.getJadeDataByID(this._curRole),this.update())},e.prototype.playIconTween=function(){this.yupei.y=this._iconY,egret.Tween.removeTweens(this.yupei),egret.Tween.get(this.yupei,{loop:!0}).to({y:this._iconMoveY},1e3).to({y:this._iconY},1e3)},e.prototype.stopIconTween=function(){egret.Tween.removeTweens(this.yupei)},e.prototype.update=function(){var t,e=this._jadeData.lv,i=[],n=DataCenter.ins().ExperienceJadeNewLevelConfig[e];for(var o in n.attrs)t=n.attrs[o],i.push(new AttributeData(t.type,t.value));i=this.addDanAtt(i),this.powerPanel.setPower(BackpackControl.getAttrPower(i,heroControl.getSubRoleByIndex(this._curRole)));var s=Math.floor(e/DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel)+1;this.lv.text=this.getNumStr(s)+LangMgr.getValueByKey("osaLevelJ")+this.getNumStr(e%DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel)+LangMgr.getValueByKey("numberLevel","");var r,a=experienceJadeNewControl.isJadeMax(this._curRole);if(this.maxShowGroup.visible=this.maxLevel.visible=a,this.updateMaterial(),a)this.maxGroup.visible=!1,this.maxCurAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(i,0,1,"："));else{this.maxGroup.visible=!0,r=this._oldLevel!=e,this._oldLevel=e,this.curAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(i,0,1,"：")),i=[];var l=DataCenter.ins().ExperienceJadeNewLevelConfig[e+1];for(var o in l.attrs)i.push(new AttributeData(l.attrs[o].type,l.attrs[o].value));i=this.addDanAtt(i),this.nextAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(i,0,1,"："))}Math.floor(e/(9*DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel));this.yupei.setLevel(e,r&&e%DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel==10),e%DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel==10?this.barGroup.visible=!1:(this.barGroup.visible=!0,this._expBar.getMaxValue()!=n.exp?this._expBar.setData(this._jadeData.exp,n.exp):this._expBar.setValue(this._jadeData.exp)),n=DataCenter.ins().ExperienceJadeNewLevelConfig[(s-1)*DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel];for(var h=DataCenter.ins().ExperienceJadeNewBaseConfig.skillUnlock.length,u=n.skillIdList?n.skillIdList.length:0,p=0;h>p;p++){this["blackImg"+p].visible=!0;for(var c=0;u>c;c++)n.skillIdList[c]==DataCenter.ins().ExperienceJadeNewBaseConfig.skillUnlock[p].id&&(this["blackImg"+p].visible=!1)}},e.prototype.getNumStr=function(t){var e=[];if(Math.floor(t/10)){var i=Math.floor(t/10);i>1&&e.push(i),e.push(10),t%10!=0&&e.push(t%10)}else e.push(t%10);for(var n="",o=e.length,s=0;o>s;s++)n+=LangMgr.getValueByKey("chinese"+e[s]);return n},e.prototype.addDanAtt=function(t){if(this._jadeData.danDate&&Object.keys(this._jadeData.danDate).length){var e=t.concat(),i=void 0,n=void 0;for(var o in this._jadeData.danDate){if(i=DataCenter.ins().ExperienceJadeNewBaseConfig.upgradeInfo[o],i.precent)for(var s=e.length,r=0;s>r;r++)65!=e[r].type&&t.push(new AttributeData(e[r].type,Math.floor(e[r].value*+this._jadeData.danDate[o]*i.precent/1e4)));if(i.attr){n=i.attr.length;for(var a=0;n>a;a++)t.push(new AttributeData(i.attr[a].type,i.attr[a].value*+this._jadeData.danDate[o]))}}e=[],n=t.length;for(var l=new Object,h=0;n>h;h++)void 0==l[t[h].type]&&(l[t[h].type]=0),l[t[h].type]+=t[h].value;for(var o in l)e.push(new AttributeData(+o,+l[o]));return e}return t},e.prototype.updateMaterial=function(){for(var t,e,i,n=this._jadeData.lv,o=this._danInfo.length,s=Math.floor(n/DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel)+1,r=0;o>r;r++)t=this._danInfo[r],e=backpackControl.getBagItemById(t.id),t.count=e?e.count:0,t.used=this._jadeData.danDate&&this._jadeData.danDate[t.id]?+this._jadeData.danDate[t.id]:0,t.jade=s,i=DataCenter.ins().ExperienceJadeNewLevelConfig[(s-1)*DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel],t.curMax=i.upgradeItemInfo&&i.upgradeItemInfo[t.id]?+i.upgradeItemInfo[t.id]:0,this["used"+r].text=t.used,this["redPoint"+r].visible=t.used<t.curMax&&t.count;o=this._materialInfo.length;for(var a,l=0,r=0;o>r;r++)a=this._materialInfo[r],e=backpackControl.getBagItemById(a.id),a.count=e?e.count:0,this["lvNum"+r].textFlow=TextUtils.generateTextFlow1("|C:"+(a.count?LangMgr.getColor("color43"):LangMgr.getColor("color22"))+"&T:"+a.count),l+=a.addExp*a.count;this.normal.visible=n%DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel!=10,this.upLv.visible=!this.normal.visible,this.upgradeBtn0.visible=this.upgradeBtn.visible},e.prototype.onTouch=function(t){switch(t.target){case this.upgradeBtn:this.onUpgrade();break;case this.upgradeBtn0:this.onUpgrade(!0);break;case this.upgradeBtn1:this.onUpgrade();break;case this.up0:case this.up1:case this.up2:var e=this._danInfo[t.target.name];e.used<e.curMax&&e.count?experienceJadeNewControl.upUseDan(this._curRole,e.id):UIMgr.ins().open(ExperienceJadeUpTipsView,e);break;case this.checkBoxs0:case this.checkBoxs1:case this.checkBoxs2:this._oneKeyUp&&this.stopOneKyUp();var i=+t.target.name;this._curMaterail=-1;for(var n=void 0,o=0;3>o;o++)n=this["checkBoxs"+o],o==i?this._curMaterail=n.selected?i:-1:n.selected=!1;break;case this.skillIcon0:case this.skillIcon1:case this.skillIcon2:case this.skillIcon3:case this.skillIcon4:var s=DataCenter.ins().ExperienceJadeNewBaseConfig.skillUnlock[t.target.name];UIMgr.ins().open(ExperienceJadeSkillTipsView,s.name,s.desc);break;case this.lvImg0:case this.lvImg1:case this.lvImg2:UIMgr.ins().open(ItemTipsView,0,t.target.name)}},e.prototype.onUpgrade=function(t){if(void 0===t&&(t=!1),t&&this._oneKeyUp)return void this.stopOneKyUp();if(this._oneKeyUp&&this.stopOneKyUp(),this._jadeData.lv%DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel==10)experienceJadeNewControl.upUpgrade(this._curRole,this._materialInfo[0].id);else if(-1==this._curMaterail)tipsControl.showTips(LangMgr.getValueByKey("loonTips1"));else if(this._materialInfo[this._curMaterail].count<=0)tipsControl.showTips(LangMgr.getValueByKey("materialEnought1")),warnControl.setBuyGoodsWarn(this._materialInfo[this._curMaterail].id);else{var e=this._materialInfo[this._curMaterail].count;e>1&&t?(TimerMgr.ins().doTimer(150,e,this.sendUp,this,this.stopOneKyUp,this),this.upgradeBtn0.label=LangMgr.getValueByKey("wingStop"),this._oneKeyUp=!0):experienceJadeNewControl.upUpgrade(this._curRole,this._materialInfo[this._curMaterail].id)}},e.prototype.stopOneKyUp=function(){this._oneKeyUp=!1,this.upgradeBtn0.label=LangMgr.getValueByKey("skillOnkeyUpdate"),TimerMgr.ins().remove(this.sendUp,this)},e.prototype.sendUp=function(){return this._jadeData.lv%DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel==10?void this.stopOneKyUp():void experienceJadeNewControl.upUpgrade(this._curRole,this._materialInfo[this._curMaterail].id)},e}(BasePanel);__reflect(ExperienceJadeMainPanel.prototype,"ExperienceJadeMainPanel");var ExperienceJadeSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="UitrasoneSkillTipsViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.nameLabel.text=t[0],this.description.textFlow=TextUtils.generateTextFlow1(t[1]),this.addEventTouchTap(this.bgClose,this.onTouch)},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTouch)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(ExperienceJadeSkillTipsView.prototype,"ExperienceJadeSkillTipsView");var ExperienceJadeUpTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExperienceJadeUpTipsViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch);var i=t[0],n=DataCenter.ins().ItemConfig[i.id];this.itemIcon.setData(n),this.nameLabel.text=n.name,this.use.text=i.used+"/"+i.curMax,this.num.text=i.count+"",this.attr.textFlow=TextUtils.generateTextFlow1(n.desc);var o,s,r=Math.floor((Object.keys(DataCenter.ins().ExperienceJadeNewLevelConfig).length-1)/DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel)+1,a=!1;for(s=i.jade;r>=s;s++)if(o=DataCenter.ins().ExperienceJadeNewLevelConfig[(s-1)*DataCenter.ins().ExperienceJadeNewBaseConfig.perLevel],o.upgradeItemInfo&&o.upgradeItemInfo[i.id]&&+o.upgradeItemInfo[i.id]>i.curMax){a=!0;break}a?(this.info.visible=!0,this.num0.text=s+LangMgr.getValueByKey("osaLevelJ")):this.info.visible=!1},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ExperienceJadeUpTipsView.prototype,"ExperienceJadeUpTipsView");var EsotericaControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.downData=function(t){this.miji=[];for(var e=0;e<t.length;e++){this.miji[e]=[],this.grid=t[e].length;for(var i=0;i<this.grid;i++){var n=new EsotericaVo;n.id=t[e][i][0],n.isLocked=t[e][i][1],this.miji[e][i]=n}}EventMgr.ins().dispatch(234)},e.prototype.upLearn=function(t,e){return[t,e]},e.prototype.downUpDate=function(t,e,i,n){var o=e-1,s=this.miji[t][o].id;this.miji[t][o].id=i,EventMgr.ins().dispatch(235,[o,i,s,n])},e.prototype.upChange=function(t,e,i){return[t,e,i]},e.prototype.upWanCheng=function(t){return[t]},e.prototype.upAddLock=function(t,e){return[t,e]},e.prototype.upDelLock=function(t,e){return[t,e]},e.prototype.getSkillListOfRole=function(t){return this.miji&&this.miji[t]?this.miji[t]:null},e.prototype.getMijiData=function(t,e){var i=this.getSkillListOfRole(t);return i&&i[e]?i[e].id:null},e.prototype.hasSpecificSkillOfRole=function(t,e){var i=!1,n=this.getSkillListOfRole(t);if(null!=n){for(var o=!1,s=0;s<n.length;s++)n[s].id==e&&(o=!0);o&&(i=!0)}return i},e.prototype.mijiIsLock=function(t,e){var i=!1,n=this.getSkillListOfRole(t);if(null!=n){for(var o=!1,s=0;s<n.length;s++)Math.floor(n[s].id/10)==Math.floor(e/10)&&n[s].isLocked&&(o=!0);o&&(i=!0)}return i},e.prototype.hasNewSkillOfRole=function(t){var e=!1,i=this.getSkillListOfRole(t);return null!=i&&i.every(function(t){return t.id>0?(e=!0,!1):!0}),e},e.prototype.downChange=function(t){EventMgr.ins().dispatch(236,t)},e.prototype.downLockInfo=function(t,e,i){for(var n=this.miji[t],o=0;o<n.length;o++)if(n[o].id==e){n[o].isLocked=i;break}EventMgr.ins().dispatch(237)},e.prototype.getPowerByRole=function(t){for(var e=0,i=this.miji[t],n=0;n<i.length;n++)i[n].id&&(e+=DataCenter.ins().EsotericaSkillConfig[i[n].id].power);return e},e.prototype.dispatchSelectedMiji=function(t,e){EventMgr.ins().dispatch(579,[t,e])},e.prototype.dispatchBagUseMiji=function(t){EventMgr.ins().dispatch(658,t)},e.prototype.hasEquipMiji=function(t,e){void 0===e&&(e=0);var i=this.miji[e];if(!i)return!1;for(var n=0;n<i.length;n++)if(i[n]&&0!=i[n].id){var o=DataCenter.ins().EsotericaSkillConfig[i[n].id];if(o.item==t)return!0}return!1},e.prototype.isMjiSum=function(){if(reincarnateControl.lv<i.ZsLv)return!1;if(!this.miji)return!1;var t=backpackControl.getBagGoodsByType(2),e=t.length>0?!0:!1;if(!e)return!1;var n=ServerStorage.ins().getValue(11);if(n)return!1;for(var o=heroControl.subRolesLen,s=0;o>s;s++)for(var r=this.miji[s],a=0;a<r.length;a++)if(r[a].id)for(var l=DataCenter.ins().EsotericaSkillConfig[r[a].id],h=0;h<t.length;h++)if(l.item==t[h].configID)return ServerStorage.ins().setValue(11,1),!1;return!0},e.prototype.getSkillIdByItemId=function(t){var e=DataCenter.ins().EsotericaSkillConfig;for(var i in e)if(e[i].item==t)return e[i].id;return-1},e.ZsLv=1,e.BAGOPEN=5,__decorate([down(1,[[[3,3]]])],e.prototype,"downData",null),__decorate([up(2,[2,3])],e.prototype,"upLearn",null),__decorate([down(2,[2,2,3,1])],e.prototype,"downUpDate",null),__decorate([up(3,[3,3,3])],e.prototype,"upChange",null),__decorate([up(4,[2])],e.prototype,"upWanCheng",null),__decorate([up(5,[3,3])],e.prototype,"upAddLock",null),__decorate([up(6,[3,3])],e.prototype,"upDelLock",null),__decorate([down(3,[3])],e.prototype,"downChange",null),__decorate([down(6,[3,3,3])],e.prototype,"downLockInfo",null),e=i=__decorate([protocolsId(35)],e);var i}(BaseSystem);__reflect(EsotericaControl.prototype,"EsotericaControl");var EsotericaVo=function(){function t(){}return t}();__reflect(EsotericaVo.prototype,"EsotericaVo");var EsotericaExchangeView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="EsotericaExchangeViewSkin",this.itemList.itemRenderer=ItemBaseNoTap,this.itemScroller.viewport=this.itemList,this.touchChildren=!0,this.mijiItem0.touchEnabled=!0,this.mijiItem0.touchChildren=!0,this.mijiItem1.touchEnabled=!0,this.mijiItem1.touchChildren=!0,this.mijiItem2.touchEnabled=!0,this.mijiItem2.touchChildren=!0,this.mcEff1=new GameMovieClip,this.mcEff1.x=63,this.mcEff1.y=99,this.mcEff2=new GameMovieClip,this.mcEff2.x=153,this.mcEff2.y=99,this.mcEff3=new GameMovieClip,this.mcEff3.x=243,this.mcEff3.y=99,this.nameArr=[],this.isTopLevel=!0},e.prototype.onItemTap=function(t){if(!(this.mijiItem0.data&&this.mijiItem1.data&&this.mijiItem2.data)){var e=t.item.count,i=esotericaControl.getSkillIdByItemId(t.item.configID);this.mijiItem0.data==i&&e--,this.mijiItem1.data==i&&e--,this.mijiItem2.data==i&&e--;var n=LangMgr.getValueByKey("zsTips19");if(!e)return void tipsControl.showTips(n);this.mijiItem0.data?this.mijiItem1.data?this.mijiItem2.data||(this.mijiItem2.data=i,this.nameArr[2]=t.item.itemConfig.name):(this.mijiItem1.data=i,this.nameArr[1]=t.item.itemConfig.name):(this.mijiItem0.data=i,this.nameArr[0]=t.item.itemConfig.name),this.mijiItem3.data=""}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.smeltBtn,this.onTap),this.addEventTouchTap(this.mijiItem0,this.onTap),this.addEventTouchTap(this.mijiItem1,this.onTap),this.addEventTouchTap(this.mijiItem2,this.onTap),this.addEventTouchTap(this.mijiItem3,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addEventItemTap(this.itemList,this.onItemTap),this.addCustomEvent(266,this.updateItem),this.addCustomEvent(268,this.updateItem),this.addCustomEvent(267,this.updateItem),this.addCustomEvent(236,this.showResult),this.clearData(),this.updateItem()},e.prototype.sortFun=function(t,e){return t.configID<e.configID?-1:t.configID>e.configID?1:0},e.prototype.updateItem=function(){var t=backpackControl.getBagGoodsByType(2);t.sort(this.sortFun),this.itemList.dataProvider=new eui.ArrayCollection(t)},e.prototype.clearData=function(){this.itemList.selectedIndex=-1,this.mijiItem0.data="",this.mijiItem1.data="",this.mijiItem2.data="",this.mijiItem3.data=""},e.prototype.playEffect=function(){this.mcEff1.playFile(PATH_EFF+"forgeSuccess",1),this.anigroup.addChild(this.mcEff1),this.mcEff2.playFile(PATH_EFF+"forgeSuccess",1),this.anigroup.addChild(this.mcEff2),this.mcEff3.playFile(PATH_EFF+"forgeSuccess",1),this.anigroup.addChild(this.mcEff3)},e.prototype.onTap=function(t){var e=this;switch(t.currentTarget){case this.smeltBtn:if(!this.mijiItem0.data||!this.mijiItem1.data||!this.mijiItem2.data)return void tipsControl.showTips(LangMgr.getValueByKey("zsTips20"));warnControl.show(LangMgr.getValueByKey("zsTips21",this.nameArr[0],this.nameArr[1],this.nameArr[2]),function(){var t=e.mijiItem0.data,i=e.mijiItem1.data,n=e.mijiItem2.data;esotericaControl.upChange(t,i,n),e.clearData(),e.playEffect()},this);break;case this.fgClose:case this.bgClose:UIMgr.ins().close(this);break;case this.mijiItem0:case this.mijiItem1:case this.mijiItem2:t.currentTarget.data="";break;case this.mijiItem3:if(this.mijiItem3&&this.mijiItem3.data){var i=DataCenter.ins().EsotericaSkillConfig[this.mijiItem3.data];if(i){var n=backpackControl.getBagItemById(i.item);n&&UIMgr.ins().open(ItemTipsView,0,n.itemConfig.id,n.count)}}}},e.prototype.showResult=function(t){this.mijiItem3.data=esotericaControl.getSkillIdByItemId(t)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.smeltBtn,this.onTap),this.removeEventItemTap(this.itemList,this.onItemTap),this.removeEventTouchTap(this.mijiItem0,this.onTap),this.removeEventTouchTap(this.mijiItem1,this.onTap),this.removeEventTouchTap(this.mijiItem2,this.onTap),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.mcEff1),DisplayUtils.removeFromParent(this.mcEff2),DisplayUtils.removeFromParent(this.mcEff3)},e}(BaseEuiView);__reflect(EsotericaExchangeView.prototype,"EsotericaExchangeView");var EsotericaGainTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="EsotericaGainTipsViewSkin",this.itemIcon.imgJob.visible=!1,this.gainList.itemRenderer=GainGoodsNoSkinItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1],o=t[2];this.addEventItemTap(this.gainList,this.onTouchList),this.addEventTouchEnd(this,this.otherClose),this.setData(i,n,o)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventItemTap(this.gainList,this.onTouchList),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);if(i){var n=!0;if("PayDailyView"==e[1]){var o=payControl.getRechargeData(0);o&&o.num||(n=!1,UIMgr.ins().open(PayFirstView))}n&&GuideControl.guidance(e[1],e[2],e[3]),UIMgr.ins().close(ShopWarnView),UIMgr.ins().close(BookUpView),UIMgr.ins().close(WeaponSoulFacadePanel),UIMgr.ins().close(WeaponSoulBreakView),"HeirloomComposeView"!=e[1]&&UIMgr.ins().close(HeirloomComposeView),"LadderView"==e[1]&&UIMgr.ins().close(IntensifyView),"PortalView"==e[1]&&UIMgr.ins().close(StoreView)}}},e.prototype.setData=function(t,e,i){var n="";if(void 0==i){var o=backpackControl.getBagGoodsByTypeAndId(t,e);n=o?o.count+"":"0"}else n=i+"";var s=DataCenter.ins().ItemConfig[e];if(this.nameLabel.text=s.name,this.nameLabel.textColor=ItemUtils.getQualityColor(s),this.itemIcon.setData(s),this.lv.text=LangMgr.getValueByKey("numberLevel",s.level||1),this.num.text=n,this.description0.textFlow=TextUtils.generateTextFlow(s.desc),2==ItemUtils.getType(s)){var r=esotericaControl.getSkillIdByItemId(s.id);this.power.text=LangMgr.getValueByKey("wingPingfen",DataCenter.ins().EsotericaSkillConfig[r].power)}else this.power.text="";var a=DataCenter.ins().PropsGainConfig[e];a?this.gainList.dataProvider=new eui.ArrayCollection(a.gainWay):this.gainList.dataProvider=new eui.ArrayCollection([])},e}(BaseEuiView);__reflect(EsotericaGainTipsView.prototype,"EsotericaGainTipsView");var EsotericaLearnView=function(t){function e(){var e=t.call(this)||this;return e.skinName="EsotericaLearnViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.itemList.itemRenderer=EsotericaLearnItemRenderer,this.itemScroller.viewport=this.itemList,this.isTopLevel=!0,this.link.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips9"))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.roleIndex=t[0],this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventItemTap(this.itemList,this.onItemTap),this.addEventTouchTap(this.smeltBtn,this.onTap),this.addEventTouchTap(this.link,this.onTap),this.addCustomEvent(266,this.updateItem),this.addCustomEvent(268,this.updateItem),this.addCustomEvent(267,this.updateItem),this.clearData(),this.updateItem(!0)},e.prototype.sortFun=function(t,e){var i=EsotericaControl.ins(),n=esotericaControl.getSkillIdByItemId(t.configID),o=esotericaControl.getSkillIdByItemId(e.configID);return 1==i.hasSpecificSkillOfRole(this.roleIndex,n)?1:1==i.hasSpecificSkillOfRole(this.roleIndex,o)?-1:t.configID<e.configID?-1:t.configID>e.configID?1:0},e.prototype.updateItem=function(t){void 0===t&&(t=!1);var e=backpackControl.getBagGoodsByType(2);e.sort(this.sortFun.bind(this));for(var i=[],n=0;n<e.length;n++){var o=esotericaControl.getSkillIdByItemId(e[n].configID),s=new Object;s.islearn=esotericaControl.hasSpecificSkillOfRole(this.roleIndex,o),s.isLock=esotericaControl.mijiIsLock(this.roleIndex,o),s.item=e[n],i.push(s)
}this.itemList.dataProvider=new eui.ArrayCollection(i),t&&e.length&&(this.setData(e[0]),this.itemList.selectedIndex=0)},e.prototype.setData=function(t){this.mijiLearnIcon.data=esotericaControl.getSkillIdByItemId(t.configID);var e=ItemUtils.getQualityColor(t.itemConfig).toString(16);this.mijiName.textFlow=(new egret.HtmlTextParser).parser("<font color='#"+e+"'>"+t.itemConfig.name+"</font>"),this.info.textFlow=TextUtils.generateTextFlow1(t.itemConfig.desc),this.mijiLearnIcon.visible=!0;var i=esotericaControl.getSkillIdByItemId(t.configID),n=esotericaControl.hasSpecificSkillOfRole(this.roleIndex,i);this.smeltBtn.enabled=!n,esotericaControl.mijiIsLock(this.roleIndex,i)?(this.smeltBtn.label=LangMgr.getValueByKey("zsTips10"),this.smeltBtn.enabled=!1):this.smeltBtn.label=n?LangMgr.getValueByKey("zsTips11"):LangMgr.getValueByKey("zsTips12"),this.curName=t.itemConfig.name},e.prototype.clearData=function(){this.itemList.selectedIndex=-1,this.mijiLearnIcon.visible=!1,this.mijiLearnIcon.data=null,this.info.text="",this.curName="",this.mijiName.text=""},e.prototype.onItemTap=function(t){var e=this.itemList.dataProvider.getItemAt(t.itemIndex);this.setData(e.item)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.smeltBtn:if(this.mijiLearnIcon.data<=0)return void tipsControl.showTips(LangMgr.getValueByKey("zsTips13"));var e=this.mijiLearnIcon.data+1;e=this.mijiLearnIcon.data-1;DataCenter.ins().ItemConfig[DataCenter.ins().EsotericaSkillConfig[this.mijiLearnIcon.data].item].name;esotericaControl.dispatchSelectedMiji(this.mijiLearnIcon.data,this.curName),this.clearData(),UIMgr.ins().close(this);break;case this.link:UIMgr.ins().close(this),warnControl.setBuyGoodsWarn(200099,1)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventItemTap(this.itemList,this.onItemTap),this.removeEventTouchTap(this.smeltBtn,this.onTap),this.removeEventTouchTap(this.link,this.onTap),this.removeCustomEvents()},e}(BaseEuiView);__reflect(EsotericaLearnView.prototype,"EsotericaLearnView");var EsotericaLockView=function(t){function e(){var e=t.call(this)||this;return e.curRole=0,e.selItem=0,e.isFirst=!0,e.skinName="EsotericaLockViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.mijiBtns=[this.mijiBtn0,this.mijiBtn1,this.mijiBtn2,this.mijiBtn3,this.mijiBtn4,this.mijiBtn5,this.mijiBtn6,this.mijiBtn7],this.link.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips14")),this.roleSelect.hideTop()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isFirst=!0,this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.smeltBtn,this.onTap),this.addEventTouchTap(this.link,this.onTap),this.addEventChange(this.roleSelect,this.onChange),this.addEventTouchEnd(this.otherRect,this.otherClose);for(var i in this.mijiBtns)this.addEventTouchTap(this.mijiBtns[i],this.onTap);this.addCustomEvent(237,this.setData),t[0]==EsotericaControl.BAGOPEN?this.bagSelectIndex():(this.roleSelect.setCurRole(isNaN(t[0])?0:t[0]),this.selItem=this.getindex(isNaN(t[0])?0:t[0])),this.setCurRole(this.roleSelect.getCurRole())},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onChange=function(t){var e=this.roleSelect.getCurRole();this.isFirst||(this.selItem=this.getindex(e)),this.isFirst=!1,this.setCurRole(e)},e.prototype.setCurRole=function(t){this.curRole=t,this.setData()},e.prototype.onTap=function(t){var e=this;switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.smeltBtn:var i=this.mijiBtns[this.selItem].data;if(i.isLocked){var n=warnControl.show(LangMgr.getValueByKey("isunlockbrand"),null,null,function(){esotericaControl.upDelLock(e.curRole,i.id)},this);return void n.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("babelEnter"))}esotericaControl.upAddLock(this.curRole,i.id);break;case this.link:warnControl.setBuyGoodsWarn(DataCenter.ins().EsotericaBaseConfig.lockId,1);break;default:var o=this.mijiBtns.indexOf(t.target.parent),s=this.mijiBtns[o].data;if(!this.mijiBtns[o]||!s)return;if(0==s.id)return void tipsControl.showCenterTips(LangMgr.getValueByKey("zsTips15"));this.selItem=o;var r=EsotericaControl.ins();if(!r.grid||this.selItem>=r.grid)return void tipsControl.showTips(LangMgr.getValueByKey("notOpen",""));this.updateBtnState()}},e.prototype.updateBtnState=function(){for(var t=0;t<this.mijiBtns.length;t++)this.mijiBtns[t].setSelected(!1);this.labCount.text="",this.link.visible=!1;var e=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().EsotericaBaseConfig.lockId),i=e>0;if(i&&(this.labCount.text=LangMgr.getValueByKey("zsTips16",e)),this.link.visible=!i,this.selItem<0)return this.smeltBtn.label=LangMgr.getValueByKey("zsTips17"),void(this.smeltBtn.enabled=!1);this.mijiBtns[this.selItem].setSelected(!0);var n=this.mijiBtns[this.selItem].data;n.isLocked?(this.smeltBtn.label=LangMgr.getValueByKey("kongweiunlock"),this.smeltBtn.enabled=!0):(this.smeltBtn.label=LangMgr.getValueByKey("zsTips17"),this.smeltBtn.enabled=i)},e.prototype.setData=function(){for(var t=EsotericaControl.ins(),e=!0,i=0;8>i;i++)if(Assert(t.miji,"MijiPanel   data.miji is null"))this.mijiBtns[i].data=null;else{var n=t.miji[this.curRole];Assert(n,"MijiPanel   numList is null  roleId = "+this.curRole)?this.mijiBtns[i].data=null:(this.mijiBtns[i].data=n[i]?n[i]:null,n[i]&&0==n[i].id?this.mijiBtns[i].setUnlearn(!0):this.mijiBtns[i].setUnlearn(!1),n[i]||e&&(this.mijiBtns[i].setCountLabel(i),e=!1))}this.updateBtnState()},e.prototype.getindex=function(t){for(var e=esotericaControl.miji[t],i=0;i<e.length;i++)if(0!=e[i].id)return i;return-1},e.prototype.bagSelectIndex=function(){var t=0,e=!1;this.selItem=0;for(var i=heroControl.subRolesLen,n=0;i>n;n++){for(var o=esotericaControl.miji[n],s=0;s<o.length;s++)if(0!=o[s].id&&0==o[s].isLocked){t=n,this.selItem=s,e=!0;break}if(e)break}this.roleSelect.setCurRole(t)},e}(BaseEuiView);__reflect(EsotericaLockView.prototype,"EsotericaLockView");var EsotericaLookView=function(t){function e(){var e=t.call(this)||this;return e.skinName="EsotericaLookViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.list.itemRenderer=EsotericaLookItemRenderer;var i=[],n=[],o=[],s=[];for(var r in DataCenter.ins().EsotericaSkillConfig){var a=DataCenter.ins().EsotericaSkillConfig[r],l=DataCenter.ins().ItemConfig[a.item];3==ItemUtils.getQuality(l)?(i.length||i.push("middle"),o.length<5?o.push(a):(i.push(o),o=[],o.push(a))):(n.length||n.push("high"),s.length<5?s.push(a):(n.push(s),s=[],s.push(a)))}o.length&&i.push(o),s.length&&n.push(s);var h=i.concat(n);this.list.dataProvider=new eui.ArrayCollection(h)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap)},e.prototype.setData=function(){},e}(BaseEuiView);__reflect(EsotericaLookView.prototype,"EsotericaLookView");var EsotericaPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isTween=!1,e.curRole=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.change.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("mijiChange")),this.mijiBtns=[this.mijiBtn0,this.mijiBtn1,this.mijiBtn2,this.mijiBtn3,this.mijiBtn4,this.mijiBtn5,this.mijiBtn6,this.mijiBtn7,this.select],this.eff=new GameMovieClip,this.eff.playFile(PATH_EFF+"chargeff1"),this.eff.x=278,this.eff.y=500,this.eff.scaleX=.7},e.prototype.setCurRole=function(t){if(this.curRole!=t&&(this.curRole=t,this.isTween)){esotericaControl.upWanCheng(this.roleID),this.isTween=!1;for(var e=0;8>e;e++)egret.Tween.removeTweens(this["imageSmall_"+(e+1)])}},e.prototype.setData=function(){for(var t=this,e=EsotericaControl.ins(),i=!0,n=0;8>n;n++){this["imageMax_"+(n+1)].visible=!1;var o=void 0;if(Assert(e.miji,"MijiPanel   data.miji is null"))this.mijiBtns[n].data=null;else if(o=e.miji[this.curRole],Assert(o,"MijiPanel   numList is null  roleId = "+this.curRole))this.mijiBtns[n].data=null;else{var s=o[n]?0==o[n].id?!1:!0:!1;this["imageMax_"+(n+1)].visible=s,this.mijiBtns[n].data=o[n]?o[n]:null,o[n]||i&&(this.mijiBtns[n].setCountLabel(n),i=!1)}}this.learnLabel.visible=!1,this.learnImg.visible=!1,e.miji[this.curRole].forEach(function(e){e.id>0&&(t.learnLabel.visible=!0,t.learnImg.visible=!0)}),this.powerPanel.setPower(e.getPowerByRole(this.curRole))},e.prototype.updateEff=function(){this.select.addImg.visible?DisplayUtils.removeFromParent(this.mc):this.playEff()},e.prototype.playEff=function(){this.mc||(this.mc=new GameMovieClip),this.mc.parent||(this.btnAct.addChildAt(this.mc,1),this.mc.x=this.getBtn.x+this.getBtn.width/2,this.mc.y=this.getBtn.y+this.getBtn.height/2),this.mc.playFile(PATH_EFF+"chargeff1",-1)},e.prototype.playArrow=function(){this._arrow||(this._arrow=new GuideArrow2),this._arrow.parent||this.arrow.addChild(this._arrow),this._arrow.x=0,this._arrow.setTips(LangMgr.getValueByKey("mijiClickGetMiji")),this._arrow.setDirection(0)},e.prototype.stopArrow=function(){this._arrow&&this._arrow.removeTweens(),DisplayUtils.removeFromParent(this._arrow),this._arrow=null},e.prototype.setOpenDesc=function(){var t=DataCenter.ins().EsotericaGridConfig[esotericaControl.grid+1];t||(this.curZsLv.visible=!1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setOpenDesc(),this.setData(),this.addEventTouchTap(this.getBtn,this.onTap),this.addEventTouchTap(this.change,this.onTap),this.addEventTouchTap(this.mijitujian,this.onTap),this.addEventTouchTap(this.all,this.onTap),this.addEventTouchTap(this.btnLock,this.onTap);for(var i in this.mijiBtns)this.addEventTouchTap(this.mijiBtns[i],this.onTap);this.addCustomEvent(234,this.updateRedPoint),this.addCustomEvent(235,this.learnUpdate),this.addCustomEvent(579,this.selectMijiItem),this.addCustomEvent(237,this.setData),this.select.showAdd()},e.prototype.close=function(){for(var t in this.mijiBtns)this.removeEventTouchTap(this.mijiBtns[t],this.onTap);this.removeEventTouchTap(this.getBtn,this.onTap),this.removeEventTouchTap(this.change,this.onTap),this.removeEventTouchTap(this.mijitujian,this.onTap),this.removeEventTouchTap(this.all,this.onTap),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.mc),this.stopArrow()},e.prototype.selectMijiItem=function(t){this.select.data=t[0],this.curName=t[1],this.updateEff()},e.prototype.onBagUseMiji=function(t){this.playEff(),this.playArrow()},e.prototype.learnUpdate=function(t){var e=this,i=t[0],n=t[1],o=t[2],s=t[3];if(1==s)this.learnUpdateEffect(i,!1,function(){e["imageMax_"+(i+1)].visible=!0;var t=ObjectPool.pop("GameMovieClip");t.scaleX=t.scaleY=1,t.rotation=0,t.x=t.y=36,t.playFile(PATH_EFF+"faileff",1,function(){ObjectPool.push(t)}),e.mijiBtns[i].addChild(t),tipsControl.showTips(LangMgr.getValueByKey("mijiClickFaile"))});else{var r=function(){e["imageMax_"+(i+1)].visible=!0,TimerMgr.ins().doTimer(500,1,function(){var t=ObjectPool.pop("GameMovieClip");t.scaleX=t.scaleY=1,t.rotation=0,t.x=t.y=36,t.playFile(PATH_EFF+"successeff",1,function(){ObjectPool.push(t)}),e.mijiBtns[i].addChild(t),e.mijiBtns[i].showSelect(),e.setData();var n=o?",["+DataCenter.ins().ItemConfig[DataCenter.ins().EsotericaSkillConfig[o].item].name+LangMgr.getValueByKey("mijiExchange"):"";tipsControl.showTips(LangMgr.getValueByKey("mijiClickEnd")+n);var s=ServerStorage.ins().getValue(11);s||ServerStorage.ins().setValue(11,1)},e)};n-o==1?r():this.learnUpdateEffect(i,!0,r)}this.updateEff()},e.prototype.learnUpdateEffect=function(t,e,i){var n=this;this.isTween=!0;for(var o=24+t+1,s=function(t){var e=t,s=150*t,a=150;t>7&&16>t?(e=t-8,s=150*t):t>15&&24>t?(e=t-16,s=150*t+100*(t-15),a=250):t>23&&(e=t-24,s=150*t+200*(t-23)+650,a=350);var l=egret.Tween.get(r["imageSmall_"+(e+1)]);l.to({},s).call(function(){var s=egret.Tween.get(n["imageSmall_"+(e+1)]);n["imageSmall_"+(e+1)].visible=!0,t==o-1?s.to({visible:!0},150).call(function(){for(var t=0;8>t;t++)egret.Tween.removeTweens(n["imageSmall_"+(t+1)]),n.isTween=!1;esotericaControl.upWanCheng(n.roleID),i()}):s.to({visible:!1},a)})},r=this,a=0;o>a;a++)s(a)},e.prototype.updateRedPoint=function(){this.setOpenDesc(),this.setData()},e.prototype.destructor=function(){},e.prototype.onTap=function(t){var e=this,i=EsotericaControl.ins();switch(t.target){case this.getBtn:if(DisplayUtils.removeFromParent(this.mc),this.stopArrow(),!this.select.data){var n=this.mijiBtns.indexOf(this.select);return 8==n?i.grid?void UIMgr.ins().open(EsotericaLearnView,this.curRole):void tipsControl.showTips(LangMgr.getValueByKey("mijiRotationOpen",1)):void tipsControl.showTips(LangMgr.getValueByKey("mijiChooseSkill"))}var o=this.select.data+1,s=void 0;o=this.select.data-1,s=esotericaControl.hasSpecificSkillOfRole(this.curRole,o);var r="";DataCenter.ins().EsotericaSkillConfig[o]&&(r=DataCenter.ins().ItemConfig[DataCenter.ins().EsotericaSkillConfig[o].item].name),s?warnControl.show(LangMgr.getValueByKey("mijiShow1",r,r,this.curName),function(){e.roleID=e.curRole,esotericaControl.upLearn(e.curRole,e.select.data),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE),e.select.showAdd()},this):warnControl.show(LangMgr.getValueByKey("mijiShow2",this.curName,s?LangMgr.getValueByKey("mijiColor1",r):LangMgr.getValueByKey("mijiColor2",r)),function(){e.roleID=e.curRole,esotericaControl.upLearn(e.curRole,e.select.data),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE),e.select.showAdd()},this);break;case this.change:UIMgr.ins().open(EsotericaExchangeView);break;case this.mijitujian:UIMgr.ins().open(EsotericaPhotoView);break;case this.all:UIMgr.ins().open(EsotericaLookView);break;case this.btnLock:UIMgr.ins().open(EsotericaLockView,this.curRole);break;default:var a=this.mijiBtns.indexOf(t.target.parent);if(8==a)return i.grid?void UIMgr.ins().open(EsotericaLearnView,this.curRole):void tipsControl.showTips(LangMgr.getValueByKey("mijiRotationOpen",1));if(!this.mijiBtns[a]||this.mijiBtns[a].data&&!this.mijiBtns[a].data.id)return;if(!i.grid||a>=i.grid)return void tipsControl.showTips(LangMgr.getValueByKey("notOpen",""));UIMgr.ins().open(EsotericaTipView,this.mijiBtns[a].data)}},e}(BasePanel);__reflect(EsotericaPanel.prototype,"EsotericaPanel");var EsotericaPhotoView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="EsotericaPhotoViewSkin",this.mijiList.itemRenderer=ItemBaseNoTap,this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventItemTap(this.mijiList,this.onItemTap),this.addEventTouchTap(this.mijiOpen,this.onTap),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventItemTap(this.mijiList,this.onItemTap),this.removeEventTouchTap(this.mijiOpen,this.onTap)},e.prototype.updateData=function(){this.mijiOpen.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips18"));for(var t=[],e=0,i=DataCenter.ins().ItemConfig;e<i.length;e++){var n=i[e];2==ItemUtils.getType(n)&&t.push(n.id)}this.mijiList.dataProvider=new eui.ArrayCollection(t),t.length&&(this.setData(t[0]),this.mijiList.selectedIndex=0)},e.prototype.onItemTap=function(t){var e=this.mijiList.dataProvider.getItemAt(t.itemIndex);this.setData(e)},e.prototype.setData=function(t){var e=DataCenter.ins().ItemConfig[t];this.mijiIcon.setData(e);var i=ItemUtils.getQualityColor(e).toString(16);this.info.textFlow=(new egret.HtmlTextParser).parser("<font color='#"+i+"'>"+e.name+"</font>\n"+e.desc),this.mijiIcon.visible=!0;for(var n=10,o=0,s=DataCenter.ins().EsotericaSkillConfig;o<s.length;o++){var r=s[o];r.item==t&&(n=r.id)}this.power.text=LangMgr.getValueByKey("wingPingfen","")+DataCenter.ins().EsotericaSkillConfig[n].power},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.mijiOpen:UIMgr.ins().close(this),warnControl.setBuyGoodsWarn(200099,1)}},e}(BaseEuiView);__reflect(EsotericaPhotoView.prototype,"EsotericaPhotoView");var EsotericaTipView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="EsotericaTipViewSkin",this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.item.data=t[0].id;var i=DataCenter.ins().ItemConfig[DataCenter.ins().EsotericaSkillConfig[t[0].id].item];this.info.textFlow=TextUtils.generateTextFlow1(i.name+"\n\n"+i.desc),this.power.text=LangMgr.getValueByKey("wingPingfen","")+DataCenter.ins().EsotericaSkillConfig[t[0].id].power,this.addEventTouchTap(this,this.onClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onClose)},e}(BaseEuiView);__reflect(EsotericaTipView.prototype,"EsotericaTipView");var EsotericaExItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="EsotericaExItemRendererSkin",e.addEventTouchEnd(e,e.onClick),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.miji.data=this.data;var t=DataCenter.ins().EsotericaSkillConfig[this.data],e=DataCenter.ins().ItemConfig[t.item];this.nameTF.text=e.name}},e.prototype.onClick=function(){var t=DataCenter.ins().EsotericaSkillConfig[this.data];UIMgr.ins().open(EsotericaGainTipsView,0,t.item)},e}(BaseItemRender);__reflect(EsotericaExItemRenderer.prototype,"EsotericaExItemRenderer");var EsotericaItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="EsotericaItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.addImg.visible=!1,this.itemLock.visible=!1,this.unlearn.visible=!1,null==this.data)this.lock.visible=!0,this.icon.source="",this.setUnlearn(!1);else if(this.data instanceof ItemData)this.lock.visible=!1,this.icon.source=this.data.itemConfig.icon+"_png",this.count.text=this.data.count+"",this.icon.visible=!0;else if(!isNaN(this.data.id)||!isNaN(this.data)){var t=!isNaN(this.data.id);this.lock.visible=!1,this.count.text="";var e=void 0;if(t?(this.itemLock.visible=this.data.isLocked,e=this.data.id):e=this.data,DataCenter.ins().EsotericaSkillConfig[e]){var i=DataCenter.ins().EsotericaSkillConfig[e].item,n=DataCenter.ins().ItemConfig[i];n&&(this.icon.source=n.icon+"_png"),this.icon.visible=!0}else this.icon.source=""}this.select.visible=!1},e.prototype.setCountLabel=function(t){this.count.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("mijiRatationColorOpen",t+1)),this.count.visible=!0},e.prototype.showSelect=function(){this.lock.visible=!1,this.icon.source="",this.addImg.visible=!1,this.select.visible=!0},e.prototype.setSelected=function(t){this.select.visible=t},e.prototype.setUnlearn=function(t){this.unlearn.visible=t},e.prototype.showAdd=function(){this.data=null,this.lock.visible=!1,this.icon.source="",this.addImg.visible=!0,this.redPoint.visible=esotericaControl.isMjiSum()},e}(BaseItemRender);__reflect(EsotericaItemRenderer.prototype,"EsotericaItemRenderer");var EsotericaLearnItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="EsotericaLearnItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.item.data=t.item,t.isLock?(this.label.visible=!0,this.label.text=LangMgr.getValueByKey("zsTips7")):t.islearn?(this.label.visible=!0,this.label.text=LangMgr.getValueByKey("zsTips8")):this.label.visible=!1},e}(BaseItemRender);__reflect(EsotericaLearnItemRenderer.prototype,"EsotericaLearnItemRenderer");var EsotericaLookItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="EsotericaLookItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data)if("string"==typeof this.data)this.currentState="title","middle"==this.data?this.name1.text=LangMgr.getValueByKey("skillType1"):this.name1.text=LangMgr.getValueByKey("skillType2");else if("object"==typeof this.data&&this.data.length){this.currentState="miji";for(var t=5,e=0;t>e;e++){var i=this.data[e];if(this["item"+e]&&i){this["item"+e].visible=!0,this["item"+e].data=i.id;var n=DataCenter.ins().ItemConfig[i.item];this.name1.text=n.name}else this["item"+e].visible=!1}}},e}(BaseItemRender);__reflect(EsotericaLookItemRenderer.prototype,"EsotericaLookItemRenderer");var ExperienceControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.experienceReward=0,e.nobilityIsUpGrade=0,e.medalLv=0,e.experienceExpDay=0,e.experienceExpDayReward=0,e.isMedalShow=!1,e.isShow=!1,e.jadeLv=0,e.skillCfgList=[],e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.upExperienceUpgrade=function(){},e.prototype.upMedalUpgrade=function(){},e.prototype.upGetExperienceReward=function(){},e.prototype.downExperienceData=function(t,e,i,n,o){this.experienceExp=e,this.experienceReward=i,this.experienceExpDay=n,this.experienceExpDayReward=o;var s=!1;(t>this.experienceLv||this.checkKnightthoodRewardRed())&&(s=!0),this.experienceLv=t,taskControl.dispatchUpdataTaskPoint(),s&&this.upDateRole(),this.getTraining?EventMgr.ins().dispatch(32,{flag:!1}):EventMgr.ins().dispatch(32,{flag:!0})},e.prototype.upDateRole=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++){var i=UnitMgr.ins().getMainRole(e);if(i){var n=heroControl.getSubRoleByIndex(e);n.lilianLv=this.experienceLv,i.setCharName(n.guildAndName),i.setLilian(n.lilianUrl)}}},e.prototype.downMedalData=function(t){this.isMedalShow=!1;var e=this.medalLv!=t;this.medalLv=t,EventMgr.ins().dispatch(33,{refush:e})},e.prototype.downTrainsDayAward=function(t){this.getTraining=!1,EventMgr.ins().dispatch(34,t)},e.prototype.upTrainsDayAward=function(t){return[t]},e.prototype.checkKnighthoodOpen=function(){var t=DataCenter.ins().ExperienceKingBaseConfig.actImbaId,e=artifactControl.getNewArtifactBy(artifactControl.getArtifactIndexById(t));return e&&e.open},e.prototype.checkMedalOpen=function(){var t=DataCenter.ins().ExperienceMedalBasicConfig.actImbaId,e=artifactControl.getNewArtifactBy(artifactControl.getArtifactIndexById(t));return e&&e.open},e.prototype.checkBookOpen=function(t){return void 0===t&&(t=!1),SwitchMgr.ins().checkOpen(16,t)},e.prototype.checkKnightthoodRewardRed=function(){if(this.experienceReward<=0)return!1;var t=DataCenter.ins().ExperienceKingOfficeAwardConfig[this.experienceReward];return this.experienceLv>=t.level},e.prototype.getKnightthoodStast=function(){if(!this.checkKnighthoodOpen())return!1;var t=DataCenter.ins().ExperienceKingLevelConfig[this.experienceLv+1];return t&&this.experienceExp>=t.exp?!0:this.checkKnightthoodRewardRed()},e.prototype.getExperienceBtnState=function(){if(!this.checkKnighthoodOpen())return!1;var t=DataCenter.ins().ExperienceKingLevelConfig[this.experienceLv+1];return t&&this.experienceExp>=t.exp},e.prototype.getMedalIsUpGrade=function(){for(var t=DataCenter.ins().ExperienceMedalConfig[this.medalLv],e=0;e<t.achievementIds.length;e++){var i=t.achievementIds[e].taskId;if(i>0){var n=taskControl.getAchieveByTaskId(i);if(!n)return!1;var o=taskControl.getAchieveConfById(n.id);if(o.target>n.value)return!1}}return!0},e.prototype.getMedalIsMaxLevel=function(){var t=DataCenter.ins().ExperienceMedalConfig[this.medalLv+1];return null==t},e.prototype.getAllChengjiuData=function(){if(this._achievementTaskAllConfig)return this._achievementTaskAllConfig;this._achievementTaskAllConfig=[];var t=DataCenter.ins().GuideAchievementConfig;for(var e in DataCenter.ins().GuideAchievementConfig)t[e].achievementType>0&&this._achievementTaskAllConfig.push(t[e]);return this._achievementTaskAllConfig.sort(i.sort),this._achievementTaskAllConfig},e.sort=function(t,e){return t.achievementType-e.achievementType},e.prototype.chengjiuMaxData=function(){if(this._chengjiuMaxData)return this._chengjiuMaxData;this._chengjiuMaxData=[];for(var t=this.getAllChengjiuData(),e=-1,i=0,n=t;i<n.length;i++){var o=n[i];e!=o.achievementType&&(e=o.achievementType,this._chengjiuMaxData.push(e))}return this._chengjiuMaxData},e.prototype.getPower=function(){return DataCenter.ins().ExperienceKingLevelConfig[this.experienceLv].power},e.prototype.dispatchGetExperienceReward=function(t){EventMgr.ins().dispatch(36,t)},e.prototype.getTrainDayAwardConfigs=function(t){var e=Object.keys(DataCenter.ins().ExperienceKingTrainAwardConfig);e.sort(this.setSortTrainAwards);for(var i=0;i<e.length;i++)if(t>=Number(e[i]))return DataCenter.ins().ExperienceKingTrainAwardConfig[e[i]];return null},e.prototype.jadeUpgrade=function(){},e.prototype.setSortTrainAwards=function(t,e){return Number(e)-Number(t)},e.prototype.isCanGetTrainDayAward=function(t){var e=this.getTrainDayAwardConfigs(GameServer.serverOpenDay+1);return e&&e[t]?!(this.experienceExpDayReward>>t&1)&&this.experienceExpDay>=e[t].score:!1},e.prototype.isGetTrainDayAwardAll=function(){if(!this.checkKnighthoodOpen())return!1;var t=this.getTrainDayAwardConfigs(GameServer.serverOpenDay+1);if(!t)return!1;for(var e in t)if(!(this.experienceExpDayReward>>+e&1)&&this.experienceExpDay>=t[+e].score)return!0;return!1},e.prototype.downJadeLv=function(t){this.jadeLv=t,EventMgr.ins().dispatch(35)},e.prototype.isJadeMax=function(){return this.jadeLv>=Object.keys(DataCenter.ins().ExperienceJadeConfig).length-1},e.prototype.checkJadeRed=function(){return!1},__decorate([up(1)],e.prototype,"upExperienceUpgrade",null),__decorate([up(6)],e.prototype,"upMedalUpgrade",null),__decorate([up(2)],e.prototype,"upGetExperienceReward",null),__decorate([down(1,[3,3,3,3,3])],e.prototype,"downExperienceData",null),__decorate([down(5,[3])],e.prototype,"downMedalData",null),__decorate([down(3,[0])],e.prototype,"downTrainsDayAward",null),__decorate([up(3,[3])],e.prototype,"upTrainsDayAward",null),__decorate([up(10)],e.prototype,"jadeUpgrade",null),__decorate([down(10,[3])],e.prototype,"downJadeLv",null),e=i=__decorate([protocolsId(23)],e);var i}(BaseSystem);__reflect(ExperienceControl.prototype,"ExperienceControl");var WeaponSoulUplvView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulUplvViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btn1,this.onClick),this.addEventTouchTap(this.bgClose,this.onClick),this.addCustomEvent(140,this.callback),this.roleId=t[0],this.slot=t[1],this.update()},e.prototype.callback=function(){tipsControl.showTips(LangMgr.getValueByKey("clanUpdata")),this.update()},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(this.roleId),e=t.weapons.getSlotByInfo(this.slot),i=DataCenter.ins().WeaponSoulPosConfig[e.id][0],n=DataCenter.ins().WeaponSoulPosConfig[e.id][e.level+1];if(!n)return this.costgroup.visible=!1,this.btn1.visible=this.costgroup.visible,this.rightIcon0.visible=this.costgroup.visible,this.rightIcon1.visible=this.costgroup.visible,this.attr6.visible=this.costgroup.visible,this.attr4.visible=this.costgroup.visible,this.maxdesc.visible=!this.costgroup.visible,e.attr&&(this.attr5.text=e.attr[0].value+"",this.attr2.text=AttributeData.getAttrStrByType(e.attr[0].type)),this.name0.text=i.name,this.item0.imgIcon.source=i.icon+"_png",void(this.item0.imgJob.visible=!1);if(this.item0.imgIcon.source=i.icon+"_png",this.item0.imgJob.visible=!1,this.name0.text=i.name,e.attr){this.attr5.text=e.attr[0].value+"",this.attr6.text=n.attr[0].value+"",this.rightIcon0.x=this.attr5.x+this.attr5.width+this.rightIcon0.width,this.attr6.x=this.rightIcon0.x,this.attr2.text=AttributeData.getAttrStrByType(e.attr[0].type),this.attr3.text=e.attr[0].value+"",this.attr4.text=n.attr[0].value+"",this.rightIcon1.x=this.attr3.x+this.attr3.width+this.rightIcon1.width,this.attr4.x=this.rightIcon1.x;var o=backpackControl.getBagItemById(e.costItem),s=o?o.count:0,r=DataCenter.ins().ItemConfig[e.costItem];this.micon.source=r.icon+"",this.countLabel0.text=s+"/"+e.costNum,this.curSum=s,this.maxSum=e.costNum}},e.prototype.onClick=function(t){switch(t.target){case this.btn1:if(this.curSum<this.maxSum)return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));weaponsSoulControl.upWeaponsUpLevel(this.roleId,this.slot);break;case this.bgClose:UIMgr.ins().close(this)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.btn1,this.onClick),this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e}(BaseEuiView);__reflect(WeaponSoulUplvView.prototype,"WeaponSoulUplvView");var ExperienceJadePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starList=null,e._oldLevel=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._starList=new StarList(10),this._starList.x=15,this._starList.y=0,this.starGroup.addChild(this._starList),this._iconY=this.experienceJadeItemRenderer.y,this._iconMoveY=this.experienceJadeItemRenderer.y-10},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._oldLevel=experienceControl.jadeLv,this.addCustomEvent(35,this.update),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addEventTouchTap(this,this.onTouch),this.update(),this.playIconTween()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.experienceJadeItemRenderer.close(),egret.Tween.removeTweens(this.experienceJadeItemRenderer)},e.prototype.playIconTween=function(){this.experienceJadeItemRenderer.y=this._iconY,egret.Tween.removeTweens(this.experienceJadeItemRenderer),egret.Tween.get(this.experienceJadeItemRenderer,{loop:!0}).to({y:this._iconMoveY},1e3).to({y:this._iconY},1e3)},e.prototype.update=function(){for(var t=experienceControl.jadeLv,e=[],i=DataCenter.ins().ExperienceJadeConfig[t],n=0,o=0,s=i.attrs;o<s.length;o++){var r=s[o];55==r.type&&(n=Math.floor(r.value/1e4*100)),e.push(new AttributeData(r.type,r.value))}this.powerPanel.setPower(BackpackControl.getAttrPower(e));var a=Math.floor(t/DataCenter.ins().ExperienceJadeBasicConfig.perLevel)+1;this.stageItemRenderer.data=LangMgr.getValueByKey("stageNumberTxt",a);var l,h=experienceControl.isJadeMax();if(h)this.maxGroup.visible=!1,this.maxLevel.visible=this.maxShowGroup.visible=!0,this.maxCurAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(e,0,1,"："));else{this.maxGroup.visible=!0,this.maxLevel.visible=this.maxShowGroup.visible=!1,l=this._oldLevel!=t,this._starList.setStarNum(t%DataCenter.ins().ExperienceJadeBasicConfig.perLevel,l?1:0),this._oldLevel=t,this.updateMaterial(),this.curAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(e,0,1,"：")),e=[];var u=DataCenter.ins().ExperienceJadeConfig[t+1];for(var p in u.attrs)e.push(new AttributeData(u.attrs[p].type,u.attrs[p].value));this.nextAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(e,0,1,"："))}this.experienceJadeItemRenderer.setLevel(t,l&&t%DataCenter.ins().ExperienceJadeBasicConfig.perLevel==10)},e.prototype.updateMaterial=function(){var t=experienceControl.isJadeMax();if(!t){var e=experienceControl.jadeLv,i="";this._materialEn=!0;var n=DataCenter.ins().ExperienceJadeConfig[e];if(n.item_id>0){var o=DataCenter.ins().ItemConfig[n.item_id],s=backpackControl.getBagItemById(n.item_id),r=s?s.count:0;
i=LangMgr.getValueByKey("equiHave")+o.name+":|C:"+(r<n.count?LangMgr.getValueByKey("color22"):LangMgr.getValueByKey("color43"))+"&T:"+r+"|/"+n.count,this._materialEn=r>=n.count}this.material.textFlow=TextUtils.generateTextFlow1(i),this.redPoint.visible=experienceControl.checkJadeRed(),this.upgradeBtn.label=this._materialEn?e%DataCenter.ins().ExperienceJadeBasicConfig.perLevel==10?LangMgr.getValueByKey("liliUpdateLeve"):LangMgr.getValueByKey("dressUpdate"):LangMgr.getValueByKey("zhuzaiMaterial1"),this.upgradeBtn.visible=!t}},e.prototype.onTouch=function(t){switch(t.target){case this.upgradeBtn:if(!this._materialEn)return void warnControl.setBuyGoodsWarn(DataCenter.ins().ExperienceJadeConfig[experienceControl.jadeLv].item_id);experienceControl.jadeUpgrade();break;case this.closeBtn:UIMgr.ins().close(ExperienceView);break;case this.deter:UIMgr.ins().open(ExperienceJadeSkillView)}},e}(BasePanel);__reflect(ExperienceJadePanel.prototype,"ExperienceJadePanel");var ExperienceJadeSkillView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExperienceJadeSkillViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose);var i=DataCenter.ins().ExperienceJadeConfig[experienceControl.jadeLv],n="0";for(var o in i.attrs)if(55==i.attrs[o].type){n=(i.attrs[o].value/100).toFixed(1);break}this.content.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().ExperienceJadeBasicConfig.deterDesc.replace("{0}",n+"%"))},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(ExperienceJadeSkillView.prototype,"ExperienceJadeSkillView");var ExperienceKnighthoodPanel=function(t){function e(){var e=t.call(this)||this;return e.barbc=new ProgressBarEff,e.name=LangMgr.getValueByKey("equipment18"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=ExperienceItemRenderer,this.itemList.itemRenderer=ItemBase,this.barbc.setWidth(525),this.barbc.x=3,this.barbc.y=-15,this.expGroup.addChild(this.barbc),this.eff=new GameMovieClip,this.eff.touchEnabled=!1,this.item4.isShowName(!1),this.trainMc={}},e.prototype.open=function(){this.addEventTouchTap(this.list,this.onListTouch),this.addEventTouchTap(this.upgradeBtn,this.onUpgrade),this.addEventTouchTap(this.UplevelBtn0,this.onActive),this.addEventTouchTap(this.reward,this.sendGetReward),this.addCustomEvent(90,this.setWinData),this.addCustomEvent(32,this.onListChange),this.addCustomEvent(34,this.updateProgress);for(var t=1;5>=t;t++)this["isget"+t]&&this.addEventTouchTap(this["isget"+t],this.onGiftClick);this.barbc.reset(),this.setWinData(),this.showActPanel(),this.activeTipsTxt0.text=LangMgr.getValueByKey("liliTips6")},e.prototype.close=function(){this.removeEventTouchTap(this.list,this.onListTouch),this.removeEventTouchTap(this.upgradeBtn,this.onUpgrade),this.removeEventTouchTap(this.UplevelBtn0,this.onActive),this.removeEventTouchTap(this.reward,this.sendGetReward),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.eff);for(var t in this.trainMc)DisplayUtils.removeFromParent(this.trainMc[t]);for(var t=1;5>=t;t++)this["isget"+t]&&this.removeEventTouchTap(this["isget"+t],this.onGiftClick)},e.prototype.sendGetReward=function(){CommonFun.checkBackpackCount(1,1)&&experienceControl.upGetExperienceReward()},e.prototype.showActPanel=function(){this.Activation.visible=!1,this.showAct.visible=!this.Activation.visible},e.prototype.onActive=function(t){switch(t.currentTarget){case this.UplevelBtn0:experienceControl.checkKnighthoodOpen()||(tipsControl.showTips(LangMgr.getValueByKey("liliTips3")),t.$cancelable=!0,t.preventDefault())}},e.prototype.onGiftClick=function(t){for(var e=1;5>=e;e++)if(this["isget"+e]&&t.currentTarget==this["isget"+e]){var i=this["gift"+e].getItemIcon();experienceControl.getTraining=!0,this.flyItem(i),experienceControl.upTrainsDayAward(e);break}},e.prototype.flyItem=function(t){var e=new eui.Image(t.imgIcon.source);e.x=t.imgIcon.x,e.y=t.imgIcon.y,e.width=t.imgIcon.width,e.height=t.imgIcon.height,e.scaleX=t.imgIcon.scaleX,e.scaleY=t.imgIcon.scaleY,t.imgIcon.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.onUpgrade=function(t){var e=DataCenter.ins().ExperienceKingLevelConfig[experienceControl.experienceLv+1];if(e){var i=experienceControl.experienceExp;i>=e.exp?experienceControl.upExperienceUpgrade():tipsControl.showTips(LangMgr.getValueByKey("liliTips7"))}},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Label){var e=t.target.parent;e.isClose||UIMgr.ins().close(ExperienceView),CopyView.isClose=e.isClose,GuideControl.taskGuidance(e.data.id,0),UIMgr.ins().close(LimitTaskView)}},e.prototype.onListChange=function(t){var e=t.flag;if(e&&(this.experienceUpgradeSuccess(),this.setWinData()),this.showActPanel(),experienceControl.isShow){var i=DataCenter.ins().ExperienceKingLevelConfig[experienceControl.experienceLv+1];i&&CommonFun.show(0,i.trainName,"juewei_"+i.type+"_1_png")}},e.prototype.setWinData=function(){var t=experienceControl.experienceLv;this._totalPower=experienceControl.getPower(),this.powerPanel.setPower(this._totalPower);var e=DataCenter.ins().ExperienceKingLevelConfig[t];if(!Assert(e,"TrainLevelConfig  config is null  lv = "+t)){var i=e.type>14?14:e.type;this.imgMedal.source="juewei_1_"+i+"_png",this.levelImg.source=e.img?e.img:"juewei_0_"+i+"_png",this.levelLabel.text=LangMgr.getValueByKey("rankWait",e.trainlevel,""),this.attrTxt.text=AttributeData.getAttStr(e.attrAward,0,1,"：");var n=DataCenter.ins().ExperienceKingLevelConfig[t+1];if(n){for(var o="",s=0;s<n.attrAward.length;s++)o+=n.attrAward[s].value,s<n.attrAward.length-1&&(o+="\n");this.nextTxt.text=o,this.itemList.dataProvider=new eui.ArrayCollection(n.itemAward),this.currentState="nomax";var r=1==e.trainlevel?n.trainName:"";this.levelLabel0.text=LangMgr.getValueByKey("rankWait",n.trainlevel,r)}else this.currentState="max",this.itemList.dataProvider=new eui.ArrayCollection([]);this.expChange();var a=taskControl.task;this.list.dataProvider=new eui.ArrayCollection(a),this.list.validateNow(),this.addRewardRefush(),this.updateProgress()}},e.prototype.addRewardRefush=function(){if(experienceControl.experienceReward>0){this.addReward.visible=!0;var t=experienceControl.experienceReward,e=DataCenter.ins().ExperienceKingOfficeAwardConfig,i=e[t];if(Assert(i,LangMgr.getValueByKey("liliTips8")))return;var n=new ItemData;n.configID=i.award.id,this.item4.data=n,this.reward.visible=this.reward.enabled=experienceControl.checkKnightthoodRewardRed(),this.tipsGroup.visible=!this.reward.visible,this.targetLevel.text=i.level-experienceControl.experienceLv+""}else this.addReward.visible=!1,this.reward.enabled=!1,this.tipsGroup.visible=!1},e.prototype.expChange=function(){var t=!1,e=DataCenter.ins().ExperienceKingLevelConfig[experienceControl.experienceLv+1];e||(t=!0,e=DataCenter.ins().ExperienceKingLevelConfig[experienceControl.experienceLv]);var i=e.exp,n=experienceControl.experienceExp,o=n>=i;o&&!t?(this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||(this.upgradeBtn.addChild(this.eff),this.eff.x=this.upgradeBtn.width/2,this.eff.y=this.upgradeBtn.height/2)):DisplayUtils.removeFromParent(this.eff),this.barbc.setData(n,i),this.redPoint.visible=experienceControl.getExperienceBtnState(),this.redPoint0.visible=experienceControl.checkKnightthoodRewardRed()},e.prototype.experienceUpgradeSuccess=function(){for(var t=this.itemList.dataProvider.length,e=[],i=0;t>i;i++){var n=this.itemList.getVirtualElementAt(i);e.push(n.getItemSoure())}experienceControl.dispatchGetExperienceReward(e)},e.prototype.updateProgress=function(){var t=experienceControl.getTrainDayAwardConfigs(GameServer.serverOpenDay+1);if(t){this.dayExperienceExp.text=experienceControl.experienceExpDay+"";for(var e in t){var i=t[e];if(i){this["experienceLbl"+e].text=""+i.score+LangMgr.getValueByKey("liliLL");DataCenter.ins().ItemConfig[i.reward[0].id];if(this["gift"+e].data={id:i.reward[0].id,type:i.reward[0].type,count:i.reward[0].count},this["gift"+e].isShowName(!1),this["bar"+e].maximum=100,this["getedImg"+e].touchEnabled=!1,experienceControl.experienceExpDayReward>>i.id&1)this["bar"+e].value=100,this["getedImg"+e].visible=!0,this["isget"+e].touchEnabled=!1;else if(this["getedImg"+e].visible=!1,experienceControl.experienceExpDay>=i.score)this["bar"+e].value=100,this["isget"+e].touchEnabled=!0;else{var n=t[Number(e)-1],o=experienceControl.experienceExpDay,s=i.score;n&&(o=experienceControl.experienceExpDay-n.score,s=i.score-n.score),o=o>0?o:0,this["bar"+e].value=Math.floor(o/s*100),this["isget"+e].touchEnabled=!1}this.updateTrainEff(i.id)}}}},e.prototype.updateTrainEff=function(t){this.trainMc[t]||(this.trainMc[t]=new GameMovieClip);var e=experienceControl.isCanGetTrainDayAward(t);this["redPoint"+t].visible=e,e?this.trainMc[t].parent||(this["eff"+t].parent.addChild(this.trainMc[t]),this.trainMc[t].playFile(PATH_EFF+"openRole1",-1),this.trainMc[t].x=this["eff"+t].x,this.trainMc[t].y=this["eff"+t].y):DisplayUtils.removeFromParent(this.trainMc[t])},e}(BasePanel);__reflect(ExperienceKnighthoodPanel.prototype,"ExperienceKnighthoodPanel");var ExperienceMedalPanel=function(t){function e(){var e=t.call(this)||this;return e.lastEffId=0,e.name=LangMgr.getValueByKey("equipment20"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){this.starList=new StarList(10,0,60),this.starList.horizontalCenter=0,this.starList.y=-55,this.starList.scaleX=.7,this.starList.scaleY=.7,this.eff=new GameMovieClip,this.eff.x=this.btn.width/2,this.eff.y=this.btn.height/2,this.eff.scaleX=1,this.eff.scaleY=1,this.eff.touchEnabled=!1,this.taskList.itemRenderer=ExperienceMedalTaskItemRenderer,this.XunzhangEff=new GameMovieClip,this.xunzhangMcGroup.addChild(this.XunzhangEff)},e.prototype.open=function(){this.group.addChild(this.starList),this.addEventTouchTap(this.btn,this.onTab),this.addEventTouchTap(this.UplevelBtn1,this.onTab),this.addEventTouchTap(this.taskList,this.onListTouch),this.addCustomEvent(33,this.update),this.addCustomEvent(90,this.setTaskList),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this.btn,this.onTab),this.removeEventTouchTap(this.UplevelBtn1,this.onTab),this.removeEventTouchTap(this.taskList,this.onListTouch),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.eff)},e.prototype.onListTouch=function(t){var e=t.target.parent;e.data&&GuideControl.taskGuidance(e.data.id,1)},e.prototype.onTab=function(t){switch(t.currentTarget){case this.btn:this.onBtnDeal()}},e.prototype.onBtnDeal=function(){experienceControl.getMedalIsUpGrade()?experienceControl.upMedalUpgrade():tipsControl.showTips(LangMgr.getValueByKey("liliTips10"))},e.prototype.setTaskList=function(){var t=experienceControl.medalLv,e=DataCenter.ins().ExperienceMedalConfig[t];if(this.nameTF.text=e.type,this.lastEffId!=e.effid){if(!DataCenter.ins().DefineEffConfig[e.effid])return void debug.log(e.effid+" DefineEff ID error");var i=DataCenter.ins().DefineEffConfig[e.effid].souce;this.XunzhangEff.playFile(PATH_EFF+i,-1),this.lastEffId=e.effid,this.stageImg.source="jieji"+e.effid%100+"_png"}for(var n=[],o=0;o<e.achievementIds.length;o++){var s=e.achievementIds[o].taskId;s>0&&n.push(taskControl.getAchieveByTaskId(s))}this.taskList.dataProvider=new eui.ArrayCollection(n)},e.prototype.showActPanel=function(){this.Activation.visible=!1,this.showAct.visible=!this.Activation.visible},e.prototype.update=function(t){var e=!1;e=t?t.refush:!1,this.showActPanel();var i=experienceControl.medalLv,n=DataCenter.ins().ExperienceMedalConfig[i];if(experienceControl.isMedalShow){var o=n.effid;CommonFun.show(0,n.desc,"j"+o+"_png"),experienceControl.isMedalShow=!1}if(!experienceControl.checkMedalOpen())return this.com1.visible=!1,this.com2.visible=!1,void(this.group.visible=!1);this.com1.visible=!0,this.com2.visible=!0,this.group.visible=!0,this.nameTF.text=n.type;var s=DataCenter.ins().ExperienceMedalBasicConfig.perLevel,r=Math.ceil((i+1)/(s+1)),a=i-(r-1)*(s+1);if(this.starList.setStarNum(a,Number(e)),this.btn.label=LangMgr.getValueByKey("liliUpLevel"),i>0&&(i-s)%(s+1)==0&&(this.btn.label=LangMgr.getValueByKey("liliUpdateLeve")),this.com1.updateInfo1(n,this.starList.starNum),n=DataCenter.ins().ExperienceMedalConfig[i+1],this.btn.visible=!0,this.maxLvTF.visible=!1,this.com2.visible=!0,this.arrow.visible=!0,n?(this.com1.x=10,this.com2.updateInfo2(n,this.starList.starNum)):(this.btn.visible=!1,this.maxLvTF.visible=!0,this.com2.visible=!1,this.arrow.visible=!1,this.com1.x=137),this.setTaskList(),DisplayUtils.removeFromParent(this.eff),0==i){for(var l=this.taskList.numChildren>0,h=0;h<this.taskList.numChildren;h++){var u=this.taskList.getChildAt(h);if("goon"==u.currentState){l=!1;break}}l?(this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||this.btn.addChild(this.eff)):DisplayUtils.removeFromParent(this.eff)}},e}(BasePanel);__reflect(ExperienceMedalPanel.prototype,"ExperienceMedalPanel");var ExperienceView=function(t){function e(){var e=t.call(this)||this;return e.oldIndex=0,e.isTopLevel=!0,e.skinName="ExperienceViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this);var e=0;experienceControl.checkKnighthoodOpen()||(e=1),this.viewStack.selectedIndex=e,this.tab.dataProvider=this.viewStack,this.tab.validateNow()},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=void 0==t[0]?1:t[0];switch(i){case 1:break;case 0:if(!experienceControl.checkKnighthoodOpen())return tipsControl.showTips(LangMgr.getValueByKey("liliTips3")),!1;break;case 2:if(!experienceControl.checkMedalOpen())return tipsControl.showTips(LangMgr.getValueByKey("liliTips4")),!1;break;case 3:if(!experienceControl.checkBookOpen(!0))return!1;break;case 4:if(!prestigeControl.isOpen)return tipsControl.showTips(LangMgr.getValueByKey("liliTips5",DataCenter.ins().PrestigeBaseConfig.openDay,DataCenter.ins().PrestigeBaseConfig.openLevel)),!1}return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTapTouching),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.help,this.onTouch),this.addCustomEvent(32,this.delayRedPoint),this.addCustomEvent(33,this.delayRedPoint),this.addCustomEvent(90,this.delayRedPoint),this.addCustomEvent(46,this.delayRedPoint),this.addCustomEvent(45,this.delayRedPoint),this.addCustomEvent(499,this.delayRedPoint),this.addCustomEvent(704,this.delayRedPoint),this.addCustomEvent(35,this.delayRedPoint),this.addCustomEvent(266,this.delayRedPoint),this.addCustomEvent(267,this.delayRedPoint);var i=0;experienceControl.checkKnighthoodOpen()||(i=1),t[0]&&(i=t[0]),this._ext=t[1],this.help.visible=!1,this.setOpenTabIndex(i)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this.viewStack.numChildren,n=0;i>n;n++)this.viewStack.getChildAt(n).close();var o=UIMgr.ins().getView(GameBottomView);o&&o.closeNav(GameBottomView.NAV_LILIAN)},e.prototype.setOpenTabIndex=function(t){this.tab.selectedIndex=this.viewStack.selectedIndex=t,this.setOpenIndex(t),this.setRedPoint()},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.help:}},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.setOpenIndex=function(t){switch(t){case 1:this.artifactPanel.open();break;case 0:experienceControl.checkKnighthoodOpen()?this.experienceKnighthoodPanel.open():(tipsControl.showTips(LangMgr.getValueByKey("liliTips3")),this.tab.selectedIndex=this.oldIndex);break;case 2:experienceControl.checkMedalOpen()?this.experienceMedalPanel.open():(tipsControl.showTips(LangMgr.getValueByKey("liliTips4")),this.tab.selectedIndex=this.oldIndex);break;case 3:experienceControl.checkBookOpen(!0)?this._ext?(this.bookPanel.open(this._ext),this._ext=null):this.bookPanel.open():this.tab.selectedIndex=this.oldIndex;break;case 5:ActorControl.level>=DataCenter.ins().ExperienceJadeBasicConfig.openLv?this.experienceJadePanel.open():(tipsControl.showTips(LangMgr.getValueByKey("experienceJadeOpen",DataCenter.ins().ExperienceJadeBasicConfig.openLv)),this.tab.selectedIndex=this.oldIndex);break;case 4:prestigeControl.isOpen?this.prestigePanel.open():(tipsControl.showTips(LangMgr.getValueByKey("liliTips5",DataCenter.ins().PrestigeBaseConfig.openDay,DataCenter.ins().PrestigeBaseConfig.openLevel)),this.tab.selectedIndex=this.oldIndex)}this.oldIndex=this.tab.selectedIndex},e.prototype.delayRedPoint=function(){TimerMgr.ins().isExists(this.setRedPoint,this)||TimerMgr.ins().doTimer(60,1,this.setRedPoint,this)},e.prototype.setRedPoint=function(){var t=ExperienceControl.ins();this.redPoint0.visible=artifactControl.showRedPoint(),this.redPoint1.visible=t.getKnightthoodStast()||t.isGetTrainDayAwardAll();var e=experienceControl.getMedalIsMaxLevel();this.redPoint2.visible=t.checkMedalOpen()&&t.getMedalIsUpGrade()&&!e,this.redPoint3.visible=BookRedPoint.ins().redPoint,this.redPoint4.visible=!1},e.prototype.onTapTouching=function(t){return e.openCheck(t.currentTarget.selectedIndex)?void UIMgr.ins().close(LimitTaskView):void t.preventDefault()},e}(BaseEuiView);__reflect(ExperienceView.prototype,"ExperienceView");var ExperienceItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExperienceItemRendererSkin",e.isClose=!1,e.goOnTxt.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+e.goOnTxt.text+"</u></a>"),e.goOnTxt.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){var e=DataCenter.ins().GuideBasicConfig[t.id];this.nameTxt.text=e.name,this.descTxt.textFlow=TextUtils.generateTextFlow("|C:"+ColorUtils.GREEN+"&T:"+t.value+"/"+e.target+"|"),this.experienceNumTxt.text=e.trainExp+LangMgr.getValueByKey("liliLL");var i=!1;t.state>0?(this.sureImg.visible=!0,this.goOnTxt.visible=!1):(this.sureImg.visible=!1,this.goOnTxt.visible=!0,e.redpoint&&CommonFun.checkLevel(e.level||0,!1,!0)&&0==t.value&&(i=!0)),i?this.addRedPointMc():this.removeRedPointMc(),(1==t.id||3==t.id||4==t.id||5==t.id||6==t.id||7==t.id||8==t.id||9==t.id||10==t.id)&&(this.isClose=!0)}},e.prototype.addRedPointMc=function(){this.eff||(this.eff=new GameMovieClip),this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||this.effGroup&&this.effGroup.addChild(this.eff)},e.prototype.removeRedPointMc=function(){this.eff&&(DisplayUtils.removeFromParent(this.eff),this.eff=null)},e}(BaseItemRender);__reflect(ExperienceItemRenderer.prototype,"ExperienceItemRenderer");var ExperienceJadeItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.perLevel=11,e._oldLevel=-1,e._oldJade=0,e}return __extends(e,t),e.prototype.setLevel=function(t,e){var i=this;if(t!=this._oldLevel){this._mcList=this._mcList||[],this._oldLevel=t;var n=Math.floor(t/(9*this.perLevel)),o=(Math.floor(t/this.perLevel)+1)%9;this.skinName="ExperienceJadeItemRendererSkin"+n,0==o&&(o=9),this._nexMc&&this._nexMc.parent&&this._nexMc.parent.removeChild(this._nexMc);for(var s,r,a=1;9>=a;a++){if(s=this._mcList[a-1],s&&s.parent&&s.parent.removeChild(s),this._oldJade!=n&&s&&s.stop(),a>1&&(this["line"+(a-2)].visible=!1),r=!1,o>=a)if(o>a||t%this.perLevel==10){if(s||(s=new GameMovieClip,this._mcList[a-1]=s),this["processEff"+(a-1)].addChild(s),a==o&&e){if(!s.isPlaying){var l=egret.Tween.get(this);s.playFile(PATH_EFF+"bally3",1,null,!1),l.wait(800).call(function(){i._mcList[o-1]&&i._mcList[o-1].playFile(PATH_EFF+"ballb2",-1)})}}else s.isPlaying||s.playFile(PATH_EFF+"ballb2",-1);a>1&&(this["line"+(a-2)].visible=!0)}else r=!0;else r=!this._nexMc||!this._nexMc.parent;r&&(this._nexMc||(this._nexMc=new GameMovieClip),this["processEff"+(a-1)].addChild(this._nexMc),this._nexMc.isPlaying||this._nexMc.playFile(PATH_EFF+"ballb1",-1),a>1&&(this["line"+(a-2)].visible=!0))}this._oldJade=n}},e.prototype.close=function(){if(Tween.removeTweens(this),this._mcList){for(var t=this._mcList.length,e=0;t>e;e++)this._mcList[e].dispose(),this._mcList[e]=null;this._mcList.length=0,this._mcList=null}this._nexMc&&(this._nexMc.dispose(),this._nexMc=null)},e}(BaseItemRender);__reflect(ExperienceJadeItemRenderer.prototype,"ExperienceJadeItemRenderer");var ExperienceMedalAttrItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateInfo1=function(t,e,i){void 0===i&&(i=!1),this.updateInfo(t,e+1,i,AttributeFormat.FORMAT_1())},e.prototype.updateInfo2=function(t,e,i){void 0===i&&(i=!1),this.updateInfo(t,e+1,i,AttributeFormat.FORMAT_2(),ColorUtils.GREEN)},e.prototype.updateInfo=function(t,e,i,n,o){void 0===i&&(i=!1);var s=t.attrs,r=AttributeData.getAttStr1(s,n);if(t.exattrs&&t.exattrs.length>0){r+="\n";for(var a=0;a<t.exattrs.length;a++)r+=AttributeData.getExAttrNameByAttrbute(t.exattrs[a],!0,"：",o)+"\n"}this.attrTxt.textFlow=TextUtils.generateTextFlow(r),this.addNameTF(this.nameTF,t,e,i)},e.prototype.addNameTF=function(t,e,i,n){void 0===n&&(n=!1),t&&(t.text=e.desc)},e}(BaseItemRender);__reflect(ExperienceMedalAttrItemRenderer.prototype,"ExperienceMedalAttrItemRenderer");var ExperienceMedalTaskItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ExperienceMedalTaskItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){var e=taskControl.getAchieveConfById(t.id);this.nameTF.textFlow=TextUtils.generateTextFlow(e.name);var i=Math.min(t.value,e.target);this.expLabel.text=i+"/"+e.target,this.expBar.maximum=e.target,this.expBar.value=i,this.taskIcon.source="xunzhang"+t.achievementId+"_png",t.value>=e.target?this.currentState="done":this.currentState="goon"}},e}(BaseItemRender);__reflect(ExperienceMedalTaskItemRenderer.prototype,"ExperienceMedalTaskItemRenderer");var FashionControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeInfo={},e.posInfo=[],e.careerDic={},e.itemIdDic={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upDressInfoReq=function(){},e.prototype.downDressInfo=function(t,e){this.timeInfo={};for(var i=0;i<t.length;i++){var n=new FashionTimeVo;n.dressId=t[i][0],n.invalidtime=t[i][1],n.lv=t[i][2],this.timeInfo[n.dressId]=n}this.posInfo=[];for(var i=0;i<e.length;i++){for(var o=new FashionPosVo,s=0;s<e[i].length;s++)o.posAry[s]=e[i][s];this.posInfo.push(o)}this.dispatchDressInfo()},e.prototype.upDressActivationReq=function(t){return[t]},e.prototype.downDressActivationRes=function(t,e,i){var n=new FashionTimeVo;n.dressId=t,n.invalidtime=e,n.lv=i,this.timeInfo[n.dressId]=n,EventMgr.ins().dispatch(294),tipsControl.showTips(LangMgr.getValueByKey("dressActive"))},e.prototype.upDressUserReq=function(t,e){return[t,e]},e.prototype.downDressUserRes=function(t,e,i){this.parserDress(t,e,i),this.dispatchDressInfo(),tipsControl.showTips(LangMgr.getValueByKey("dressDream"))},e.prototype.upUnDressUserReq=function(t,e){return[t,e]},e.prototype.downUnDressUserRes=function(t,e,i){this.parserDress(t,e,i),this.dispatchDressInfo(),tipsControl.showTips(LangMgr.getValueByKey("dressCancelDream"))},e.prototype.downDressTimeEnd=function(t){delete this.timeInfo[t];for(var e=0;e<this.posInfo.length;e++)for(var i=this.posInfo[e],n=0;3>n;n++)if(i.posAry[n]==t){i.posAry[n]=0;var o=heroControl.getSubRoleByIndex(e);o.zhuangbei[n]=0,0==n||1==n?equipControl.dispatchEquipChange():this.dispatchChangeWing();var s=UnitMgr.ins().getEntityByHandle(o.handle);s&&s.updateModel();break}this.dispatchDressInfo()},e.prototype.parserDress=function(t,e,i){var n=this.posInfo[t];n&&(n.posAry[e-1]=i);var o=heroControl.getSubRoleByIndex(t);o.zhuangbei[e-1]=i,1==e||2==e?equipControl.dispatchEquipChange():this.dispatchChangeWing();var s=UnitMgr.ins().getEntityByHandle(o.handle);s&&s.updateModel()},e.prototype.getModelPosId=function(t){return this.posInfo[t]},e.prototype.redPoint=function(){return this.careerRedPoint()},e.prototype.careerRedPoint=function(){for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t).job,i=this.getIdByCareer(e);for(var n in i)for(var o=i[n],s=0,r=o;s<r.length;s++){var a=r[s];if(this.redPointDress(a.id))return!0}}return!1},e.prototype.curRoleRedPoint=function(t){return this.roleRedPoint()[t]},e.prototype.roleRedPoint=function(){for(var t=[!1,!1,!1],e=heroControl.subRolesLen,i=0;e>i;i++){var n=heroControl.getSubRoleByIndex(i).job,o=this.getIdByCareer(n);for(var s in o){for(var r=o[s],a=0,l=r;a<l.length;a++){var h=l[a];if(this.redPointDress(h.id)){t[i]=!0;break}}if(t[i])break}}return t},e.prototype.canDress=function(t,e){if(3==e&&ActorControl.level<=16)return!1;var i=this.getIdByCareer(t)[e];for(var n in i)if(this.redPointDress(i[n].id))return!0;return!1},e.prototype.posRedPoint=function(){for(var t=[!1,!1,!1],e=heroControl.subRolesLen,i=0;e>i;i++)for(var n=heroControl.getSubRoleByIndex(i).job,o=this.getIdByCareer(n),s=0;3>s;s++)if(!t[s])for(var r=o[s+1],a=0,l=r;a<l.length;a++){var h=l[a];if(this.redPointDress(h.id)){t[s]=!0;break}}return t},e.prototype.getIdByCareer=function(t){return this.careerDic[t]?this.careerDic[t]:(this.initConfig(),this.careerDic[t])},e.prototype.getIdByItemId=function(t){return this.itemIdDic[t]?this.itemIdDic[t]:(this.initConfig(),this.itemIdDic[t])},e.prototype.initConfig=function(){if(!Object.keys(this.itemIdDic).length){var t=DataCenter.ins().FashionIdConfig;for(var e in t){var i=t[e],n=i.roletype,o=i.pos;this.careerDic[n]=this.careerDic[n]||{},this.careerDic[n][o]=this.careerDic[n][o]||[],this.careerDic[n][o].push(i);var s=i.cost.itemId;this.itemIdDic[s]=this.itemIdDic[s]||[],this.itemIdDic[s].push(i)}}},e.prototype.redPointDress=function(t){var e=DataCenter.ins().FashionIdConfig[t];if(3==e.pos&&ActorControl.level<=16)return!1;var i=e.cost.itemId,n=backpackControl.getBagGoodsCountById(0,i);if(0==n)return!1;if(this.timeInfo[t]){for(var o=this.getIdByItemId(i),s=0,r=o;s<r.length;s++){var a=r[s];if(a.id!=t&&!this.timeInfo[a.id])return!1}var l=this.timeInfo[t].lv+1,h=DataCenter.ins().FashionLvUpConfig[t];if(h&&h[l]&&h[l].cost.num<=n)return!0}else if(n>=e.cost.num)return!0;return!1},e.prototype.getIdZhuangBanId=function(t){var e=DataCenter.ins().FashionIdConfig;for(var i in e){var n=e[i];if(n.cost.itemId==t)return t}return 0},e.prototype.getZhuangBanEffId=function(t,e,i){var n=0,o=-1;switch(t){case 0:o=1;break;case 2:o=0}var s=i[o];if(s){var r=DataCenter.ins().FashionIdConfig[s].cost.itemId;n=DataCenter.ins().EquipWithEffConfig[r+"_"+e]?r:n}return n},e.prototype.checkActiveSuit=function(t){t instanceof RoleModel&&(t=t.zhuangbei);for(var e={},i=t,n=0;n<i.length;n++){var o=i[n],s=DataCenter.ins().FashionIdConfig[o];s&&s.suitid&&(e[s.suitid]=(e[s.suitid]||0)+1)}for(var r in e){var a=DataCenter.ins().FashionSuitConfig[r];if(a&&e[r]>=a.activeNum)return+r}return 0},e.prototype.getApproachEff=function(t){var e=this.checkActiveSuit(t);if(e){if(!t.zhuangbei[0])return null;if(DataCenter.ins().FashionIdConfig[t.zhuangbei[0]].suitid!=e)return null;var i=DataCenter.ins().FashionSuitConfig[e];if(i.isShowApproachEff)return i.approachEff[t.sex]}return null},e.prototype.dispatchoZbPos=function(t){switch(t){case 0:t=2;break;case 2:t=1;break;default:t=-1}return t},e.prototype.ZbPosToPos=function(t){switch(t){case 1:t=2;break;case 2:t=0;break;default:t=-1}return t},e.prototype.upLevelUp=function(t){return[t]},e.prototype.downLevelUp=function(t,e,i){var n=this.timeInfo[t];n.invalidtime=e,n.lv=i,this.dispatchDressInfo()},e.prototype.upAddTime=function(t){return[t]},e.prototype.downAddTime=function(t,e,i){var n=this.timeInfo[t]||new FashionTimeVo;n.invalidtime=e,n.lv=i,n.dressId=t,this.timeInfo[t]=n},e.prototype.dispatchDressInfo=function(){EventMgr.ins().dispatch(293)},e.prototype.dispatchChangeWing=function(){EventMgr.ins().dispatch(295)},__decorate([up(1)],e.prototype,"upDressInfoReq",null),__decorate([down(1,[[3,3,3],[[3]]])],e.prototype,"downDressInfo",null),__decorate([up(2,[3])],e.prototype,"upDressActivationReq",null),__decorate([down(2,[3,3,3])],e.prototype,"downDressActivationRes",null),__decorate([up(3,[1,3])],e.prototype,"upDressUserReq",null),__decorate([down(3,[1,1,3])],e.prototype,"downDressUserRes",null),__decorate([up(4,[1,3])],e.prototype,"upUnDressUserReq",null),__decorate([down(4,[1,1,3])],e.prototype,"downUnDressUserRes",null),__decorate([down(5,[3])],e.prototype,"downDressTimeEnd",null),__decorate([up(6,[3])],e.prototype,"upLevelUp",null),__decorate([down(6,[3,3,3])],e.prototype,"downLevelUp",null),__decorate([up(7,[3])],e.prototype,"upAddTime",null),__decorate([down(7,[3,3,3])],e.prototype,"downAddTime",null),e=__decorate([protocolsId(44)],e)}(BaseSystem);__reflect(FashionControl.prototype,"FashionControl");var FashionItemVo=function(){function t(){this.isDress=!1,this.lv=0}return t}();__reflect(FashionItemVo.prototype,"FashionItemVo");var FashionPosVo=function(){function t(){this.posAry=[]}return t}();__reflect(FashionPosVo.prototype,"FashionPosVo");var FashionTimeVo=function(){function t(){}return t}();__reflect(FashionTimeVo.prototype,"FashionTimeVo");var FashionView=function(t){function e(){var e=t.call(this)||this;return e.lastRole=0,e.lastIndex=-1,e.skinName="FashionViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.listInfo=[],this.arry=new eui.ArrayCollection(this.listInfo),this.list.itemRenderer=FashionItemRenderer,this.list.dataProvider=this.arry,this.titleList.itemRenderer=TitleItemRenderer;var t=CommonUtils.copyDataHandler(DataCenter.ins().FashionConfig.zhuangbanpos);t.push(LangMgr.getValueByKey("equipment7")),this.tab.dataProvider=new eui.ArrayCollection(t),this.titleListData=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.lastRole=this.curRole=t[0]||0,void 0!=t[1]&&(this.lastIndex=this.selectIndex=parseInt(t[1]+""),this.tab.selectedIndex=this.selectIndex),this.listId=t[2]||-1,this.list.selectedIndex=-1,this.roleSelect.setCurRole(this.curRole),this.roleSelect0.setCurRole(this.curRole),this.addCustomEvent(10,this.onTitle),this.addCustomEvent(293,this.update),this.addCustomEvent(294,this.onJihuo),this.addCustomEvent(352,this.getDressInfo),this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.help,this.onClick),this.addEventTouchTap(this.itemName,this.onClick),this.addEventChange(this.list,this.onChange),this.addEventChange(this.tab,this.onTabTouch),this.addEventChange(this.roleSelect,this.onChange),this.addEventChange(this.roleSelect0,this.onChange),this.addEventTouchTap(this.dressBtn,this.onClick),this.addEventTouchTap(this.dressBtn2,this.onClick),this.addCustomEvent(98,this.updateList),this.addCustomEvent(100,this.updateShow),this.addCustomEvent(99,this.useTitle),this.addCustomEvent(711,this.update),this.addEventTouchEnd(this.list,this.onTouch),this.addEventTouchBegin(this.list,this.onTouch),this.addEvent(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.list,this.onTouch),this.addEventTouchEnd(this.titleList,this.onTouch),this.addEventTouchBegin(this.titleList,this.onTouch),this.addEvent(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.titleList,this.onTouch),this.titleGroup.visible=!1,this.dressGroup.visible=!0,this.changeRole(),this.getDressInfo(),this.lastIndex>=0&&this.setSelectedIndex(this.lastIndex)},e.prototype.onTitle=function(t,e){if(t.itemIndex==this.titleListData.length-1){var i=TitleControl.EXPAND_HEIGHT-TitleControl.SIMLPE_HEIGHT;"expand"==e?this.titleList.scrollV=this.titleList.contentHeight-this.titleList.height+i:this.titleList.scrollV=this.titleList.contentHeight-this.titleList.height-i,this.titleList.validateNow()}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.lastWeapon=0,this.lastBody=0,WatcherUtil.removeFromArrayCollection(this.titleList.dataProvider),this.titleList.dataProvider=null
},e.prototype.listSelectIndex=function(t){if(-1==t)return-1;var e=0;for(var i in this.listInfo){if(this.listInfo.hasOwnProperty(i)){var n=this.listInfo[i];if(n.zhuanban.id==t)break}e++}return e},e.prototype.onTouch=function(t){t.type==egret.TouchEvent.TOUCH_BEGIN?(this.roleSelect.parent.touchEnabled=!1,this.roleSelect0.parent.touchEnabled=!1):(this.roleSelect.parent.touchEnabled=!0,this.roleSelect0.parent.touchEnabled=!0)},e.prototype.getDressInfo=function(){fashionControl.upDressInfoReq()},e.prototype.onChange=function(t){switch(t.target){case this.roleSelect:if(this.curRole==this.roleSelect.getCurRole())return;this.changeRole();break;case this.roleSelect0:if(this.lastRole==this.roleSelect0.getCurRole())return;titleControl.curSelectRole=this.lastRole=this.roleSelect0.getCurRole(),null==titleControl.list?titleControl.upGetList():this.updateList();break;case this.list:this.onInfoUpdate(t.target.data)}},e.prototype.changeRole=function(){this.curRole=this.roleSelect.getCurRole(),this.lastWeapon=0,this.lastWing=0,this.update()},e.prototype.careerRedPoint=function(){for(var t=fashionControl.posRedPoint(),e=0;3>e;e++)this["redPoint"+e].visible=t[e]},e.prototype.onTabTouch=function(t){var e=this.list.parent;e.stopAnimation(),this.list.scrollH=0,this.listId=-1,this.selectIndex=t.currentTarget.selectedIndex,this.setSelectedIndex(this.selectIndex)},e.prototype.setSelectedIndex=function(t){this.lastIndex=this.selectIndex,this.selectIndex<this.tab.dataProvider.length-1?(this.dressGroup.visible=!0,this.roleSelect.openRole(),this.titleGroup.visible=!1,this.update()):(this.dressGroup.visible=!1,this.titleGroup.visible=!0,titleControl.curSelectRole=this.roleSelect0.getCurRole(),this.roleSelect.hideRole(),null==titleControl.list?titleControl.upGetList():this.updateList())},e.prototype.update=function(){null==this.curRole&&(this.curRole=0),null==this.selectIndex&&(this.selectIndex=0);var t=FashionControl.ins();this.listInfo=[];for(var e in DataCenter.ins().FashionIdConfig)if((heroControl.getSubRoleByIndex(this.curRole).job==DataCenter.ins().FashionIdConfig[e].roletype||!DataCenter.ins().FashionIdConfig[e].roletype)&&this.selectIndex+1==DataCenter.ins().FashionIdConfig[e].pos){if(!t.timeInfo[DataCenter.ins().FashionIdConfig[e].id]&&-1==DataCenter.ins().FashionConfig.defaultShow.indexOf(DataCenter.ins().FashionIdConfig[e].id)&&!backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().FashionIdConfig[e].cost.itemId))continue;var i=new FashionItemVo;i.zhuanban=DataCenter.ins().FashionIdConfig[e],i.lv=0;var n=i.zhuanban.id;t.timeInfo[n]&&(i.timer=t.timeInfo[n].invalidtime,i.lv=t.timeInfo[n].lv),t.posInfo.length>this.curRole&&n==t.posInfo[this.curRole].posAry[this.selectIndex]&&(i.isDress=!0),this.listInfo.push(i)}if(this.listInfo.sort(this.sortList),this.arry.replaceAll(this.listInfo),this.list.dataProvider=this.arry,this.onInfoUpdate(),this.redPoint(),this.careerRedPoint(),-1!=this.listId){var o=this.listSelectIndex(this.listId);this.list.selectedIndex=o,this.list.numElements>5&&o>this.list.numElements-5?this.list.scrollH=110*(this.list.numElements-5):this.list.numElements<5&&5>o?this.list.scrollH=0:this.list.scrollH=110*o}},e.prototype.sortList=function(t,e){return t.zhuanban.sort<e.zhuanban.sort?-1:t.zhuanban.sort>e.zhuanban.sort?1:0},e.prototype.redPoint=function(){for(var t=0;t<heroControl.subRolesLen;t++){var e=fashionControl.canDress(heroControl.getSubRoleByIndex(t).job,this.tab.selectedIndex+1);this.roleSelect.showRedPoint(t,e)}},e.prototype.onInfoUpdate=function(t){if(void 0===t&&(t=null),null==t?(-1==this.list.selectedIndex&&(this.list.selectedIndex=0),this.fashion=this.list.selectedItem,this.powerPanel.setPower(0)):this.fashion=t,this.attrLv.visible=!0,this.attrLv.text="",this.fashion){this.selectGroup.visible=!0,this.unSelectGroup.visible=!1;var e=this.fashion.zhuanban.attr;if(this.fashion.lv>1){var i=DataCenter.ins().FashionLvUpConfig[this.fashion.zhuanban.id][this.fashion.lv];e=AttributeData.AttrAddition(e,i.attr)}this.attrLabel.text=AttributeData.getAttStr(AttributeData.transformAttr(e),0,1,":");var n=this.getSlotDesc(this.fashion.zhuanban.id);if(this.attrLabel.text+=n?"\n"+n:"",this.fashion.zhuanban.wing_attr_per>0){this.attrLabel.text+="\n"+LangMgr.getValueByKey("dressWingBasic")+Math.floor(this.fashion.zhuanban.wing_attr_per/100)+"%";var o=[],s=heroControl.getSubRoleByIndex(this.curRole).wingsData,r=s?s.lv:0;r=r>=0?r:0;for(var a=DataCenter.ins().FeatherLevelConfig[r].attr,l=a.length,h=0;l>h;h++)o.push(new AttributeData(a[h].type,Math.floor(a[h].value*this.fashion.zhuanban.wing_attr_per/1e4)));e=AttributeData.AttrAddition(e,o)}if(this.isCanLevelUp(this.fashion)&&!this.isMaxLevel(this.fashion)){var u=this.fashion.lv+1,p=DataCenter.ins().FashionLvUpConfig[this.fashion.zhuanban.id],c=p[u].attr;p[this.fashion.lv]&&(c=AttributeData.AttrDel(c,p[this.fashion.lv].attr));for(var d="",h=0;h<c.length;h++)d+=LangMgr.getValueByKey("dressUpdate")+"+"+c[h].value+"\n";var g=d.lastIndexOf("\n");d=d.substring(0,g),this.attrLv.text=d}var m=BackpackControl.getAttrPower(AttributeData.transformAttr(e));m+=this.fashion.zhuanban.exPower?this.fashion.zhuanban.exPower:0;for(var h=0;h<e.length;h++)m+=ItemUtils.relatePower(e[h],heroControl.getSubRoleByIndex(this.curRole));if(this.powerPanel.setPower(m),this.namelabel.visible=!1,this.itemName.visible=!1,this.dressName.text=LangMgr.getValueByKey("dressProp")+this.fashion.zhuanban.name,this.dressBtn.enabled=!0,this.fashion.lv)if(this.isCanLevelUp(this.fashion)){if(this.dressBtn.visible=!0,this.dressBtn2.visible=!0,this.isMaxLevel(this.fashion))this.namelabel.visible=!1,this.itemName.visible=!1,this.dressBtn.label=LangMgr.getValueByKey("maxLevel"),this.dressBtn.enabled=!1;else{this.namelabel.visible=!0,this.itemName.visible=!0,this.dressBtn.label=LangMgr.getValueByKey("dressUpdate1");var u=this.fashion.lv+1,i=DataCenter.ins().FashionLvUpConfig[this.fashion.zhuanban.id][u];this.id=i.cost.itemId,this.num=i.cost.num;var d=void 0;d=backpackControl.getBagGoodsCountById(0,this.id)>=this.num?"<font color = '#23C42A'><u>"+DataCenter.ins().ItemConfig[this.id].name+"×"+this.num+"</u></font>":"<font color = '#f3311e'><u>"+DataCenter.ins().ItemConfig[this.id].name+"×"+this.num+"</u></font>",this.itemName.textFlow=(new egret.HtmlTextParser).parser(d)}this.fashion.isDress?this.dressBtn2.label=LangMgr.getValueByKey("dressTuoxia"):this.dressBtn2.label=LangMgr.getValueByKey("dressHH")}else this.namelabel.visible=!1,this.itemName.visible=!1,this.dressBtn.visible=!0,this.dressBtn2.visible=!1,this.fashion.isDress?this.dressBtn.label=LangMgr.getValueByKey("dressTuoxia"):this.dressBtn.label=LangMgr.getValueByKey("dressHH");else{this.dressBtn.label=LangMgr.getValueByKey("zhuzaiActivty"),this.namelabel.visible=!0,this.itemName.visible=!0,this.dressBtn.visible=!0,this.dressBtn2.visible=!1,this.id=this.fashion.zhuanban.cost.itemId,this.num=this.fashion.zhuanban.cost.num;var d=void 0;d=backpackControl.getBagGoodsCountById(0,this.id)>=this.num?"<font color = '#23C42A'><u>"+DataCenter.ins().ItemConfig[this.id].name+"×"+this.num+"</u></font>":"<font color = '#f3311e'><u>"+DataCenter.ins().ItemConfig[this.id].name+"×"+this.num+"</u></font>",this.itemName.textFlow=(new egret.HtmlTextParser).parser(d)}this.onupdateEquip(!1)}else this.selectGroup.visible=!1,this.unSelectGroup.visible=!0,this.onupdateEquip(!0)},e.prototype.isCanLevelUp=function(t){var e=t.zhuanban.id;return DataCenter.ins().FashionLvUpConfig[e]?!0:!1},e.prototype.isMaxLevel=function(t){var e=t.lv+1,i=t.zhuanban.id;return DataCenter.ins().FashionLvUpConfig[i]&&DataCenter.ins().FashionLvUpConfig[i][e]?!1:!0},e.prototype.onupdateEquip=function(t){void 0===t&&(t=!1);var e=heroControl.getSubRoleByIndex(this.curRole),i=CommonUtils.copyDataDepth(e);i.clothesViewId=0,i.weaponViewId=0,i.thirteenEquipLv=0,i.weaponViewType=i.clothesViewType=0;var n=fashionControl.getModelPosId(this.curRole);if(!n||!n.posAry||n.posAry.length<=0){var o=this.listInfo[0];1==o.zhuanban.pos?(this.setEquip(i,o.zhuanban.id,this.lastWeapon),this.lastBody=o.zhuanban.id):2==o.zhuanban.pos?(this.setEquip(i,this.lastBody,o.zhuanban.id),this.lastWeapon=o.zhuanban.id):(this.setWing(i,o.zhuanban.id),this.lastWing=o.zhuanban.id)}else this.fashion&&(t?(this.setWing(i,n.posAry[2]),this.setEquip(i,n.posAry[0],n.posAry[1])):3==this.fashion.zhuanban.pos?(this.setWing(i,this.fashion.zhuanban.id),this.setEquip(i,this.lastBody||n.posAry[0],this.lastWeapon||n.posAry[1]),this.lastWing=this.fashion.zhuanban.id):1==this.fashion.zhuanban.pos?(this.setEquip(i,this.fashion.zhuanban.id,this.lastWeapon||n.posAry[1]),this.lastBody=this.fashion.zhuanban.id):(this.setEquip(i,this.lastBody||n.posAry[0],this.fashion.zhuanban.id),this.lastWeapon=this.fashion.zhuanban.id))},e.prototype.setWing=function(t,e){t.zhuangbei[2]=e,this.dressRole.setRole(t,!1,!0)},e.prototype.setEquip=function(t,e,i){t.zhuangbei[0]=e,t.zhuangbei[1]=i,this.dressRole.setRole(t,!1,!0)},e.prototype.onJihuo=function(){fashionControl.upDressUserReq(this.curRole,this.fashion.zhuanban.id)},e.prototype.onClick=function(t){var e=this;switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.help:HelpControl.openHelpWin(9);break;case this.itemName:var i=DataCenter.ins().ItemConfig[this.id],n=ItemUtils.getType(i);void 0!=i&&i&&void 0!=n&&(0==n||4==n?UIMgr.ins().open(EquipTipsView,1,void 0,i.id):UIMgr.ins().open(FashionTipsView,i,!0));break;case this.dressBtn2:this.dressBtn2.label==LangMgr.getValueByKey("dressHH")?fashionControl.upDressUserReq(this.curRole,this.fashion.zhuanban.id):fashionControl.upUnDressUserReq(this.curRole,this.fashion.zhuanban.id);break;case this.dressBtn:if(!this.fashion||!this.fashion.zhuanban)return;if(this.dressBtn.label==LangMgr.getValueByKey("zhuzaiActivty")){if(backpackControl.getBagGoodsCountById(0,this.id)<this.num)return void tipsControl.showTips(LangMgr.getValueByKey("dressTips3"));if(3==this.fashion.zhuanban.pos&&ActorControl.level<16)return void tipsControl.showTips(LangMgr.getValueByKey("dressCanActivity",16));var o=DataCenter.ins().FashionConfig.zhuangbanpos;warnControl.show(LangMgr.getValueByKey("dressEnterActivity")+("<font color='#35e62d'>"+(LangMgr.getValueByKey("job"+(this.fashion.zhuanban.roletype+1))+o[this.fashion.zhuanban.pos-1])+"</font>")+LangMgr.getValueByKey("equipment6")+(this.fashion.zhuanban.name+"?"),function(){fashionControl.upDressActivationReq(e.fashion.zhuanban.id)},this)}else if(this.dressBtn.label==LangMgr.getValueByKey("dressHH"))fashionControl.upDressUserReq(this.curRole,this.fashion.zhuanban.id);else if(this.dressBtn.label==LangMgr.getValueByKey("dressUpdate1")){if(backpackControl.getBagGoodsCountById(0,this.id)<this.num)return void tipsControl.showTips(LangMgr.getValueByKey("dressTips1"));fashionControl.upLevelUp(this.fashion.zhuanban.id)}else this.dressBtn.label==LangMgr.getValueByKey("dressTuoxia")&&fashionControl.upUnDressUserReq(this.curRole,this.fashion.zhuanban.id)}},e.prototype.useTitle=function(t){if(t.config.Id!=titleControl.showTitleDic[titleControl.curSelectRole]){if(titleControl.filterTitleRule(t.config.Id,!0))return;t.config.job&&t.config.job!=heroControl.getSubRoleByIndex(this.roleSelect0.getCurRole()).job?tipsControl.showTips(LangMgr.getValueByKey("dressTips2")):titleControl.setTitle(this.roleSelect0.getCurRole(),t.config.Id)}else titleControl.setTitle(titleControl.curSelectRole,0)},e.prototype.updateList=function(){this.updateShowList(),this.titleList.dataProvider=this.titleListData,titleControl.list.refresh(),this.titleListData.refresh()},e.prototype.updateShowList=function(){this.titleListData.source=[];for(var t=heroControl.getSubRoleByIndex(this.lastRole),e=0;e<titleControl.list.length;e++){var i=titleControl.list.source[e];i.config.job&&i.config.job!=t.job||!(i.endTime>=0||i.config.defaultShow||backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,i.config.activeItemId?i.config.activeItemId:0))||127==i.config.Id||this.titleListData.source.push(i)}},e.prototype.updateShow=function(t){var e,i,n;if(e=t[0],i=t[1],n=t[2],i>0==n>0)this.updateItemByID(n),this.updateItemByID(i);else for(var o in titleControl.timeDict)this.updateItemByID(Number(o))},e.prototype.updateItemByID=function(t){if(t in titleControl.infoDict){var e=titleControl.infoDict[t];titleControl.list.itemUpdated(e),this.updateShowList()}},e.prototype.getSlotDesc=function(t){var e=DataCenter.ins().FashionIdConfig[t];if(!e||!e.attr_precent)return"";for(var i="",n=0;n<e.attr_precent.length;n++)i=LangMgr.getValueByKey("equipPosName"+e.attr_precent[n].pos),i+=LangMgr.getValueByKey("hijiBasic")+"+"+Math.floor(e.attr_precent[n].pre/100)+"%\n";if(i){var o=i.lastIndexOf("\n");i=i.substring(0,o)}return i},e}(BaseEuiView);__reflect(FashionView.prototype,"FashionView");var FashionItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(null!=t){this.redPoint0.visible=!1;var e=t.zhuanban.cost.itemId;t.lv?(this.timelabel.visible=!0,this.imgIcon.source=e+"_png"):(this.timelabel.visible=!1,this.imgIcon.source=e+"_png"),this.redPoint0.visible=fashionControl.redPointDress(t.zhuanban.id),this.imageName.text=t.zhuanban.name,t.isDress?this.huanhuaImage.visible=!0:this.huanhuaImage.visible=!1,0==t.timer?this.timelabel.textFlow=(new egret.HtmlTextParser).parser(StringUtils.addColor(LangMgr.getValueByKey("dressForevery"),ColorUtils.GREEN)):t.timer>0?this.timelabel.text=this.updateTimer(t.timer):this.timelabel.visible=!1,t.lv>1?this.levellabel.text=LangMgr.getValueByKey("numberLevel",t.lv):this.levellabel.text=LangMgr.getValueByKey("numberLevel",1)}},e.prototype.updateTimer=function(t){var e="",i=(DateUtils.formatMiniDateTime(t)-GameServer.serverTime)/1e3;return i>=0&&(e=DateUtils.getFormatBySecond(i,5,2)),e},Object.defineProperty(e.prototype,"selected",{set:function(t){this.selectImage.visible=t},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(FashionItemRenderer.prototype,"FashionItemRenderer");var FocusAttackControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.register=function(t){this.root=t,this.reset(),this.root.getSkillLvl()&&this.start()},e.prototype.unregister=function(t){this.root=null,this.reset(),this.stop()},e.prototype.start=function(){this.stop(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.stop=function(){TimerMgr.ins().remove(this.updateTime,this)},e.prototype.updateTime=function(){this.cool>0&&(this.cool-=1)},e.prototype.getSkillData=function(){if(!this.root.getSkillLvl())return null;var t=DataCenter.ins().FocusAttackConfig[this.root.getSkillLvl()],e=this.getRoles()[0];if(!e)return null;if(!Assert(t,LangMgr.getValueByKey("hijiTips1",this.root.getSkillLvl()))){var i=DataCenter.ins().SkillsConfig[t.skill_id[e.job-1]];return new SkillVo(i.id)}},e.prototype.getRoles=function(){return this.root.getRoles()||[]},e.prototype.getMaster=function(){for(var t=this.getRoles(),e=0;e<t.length;e++)if(t[e].getAtt(0)>0)return UnitMgr.ins().getEntityByHandle(t[e].handle);return null},e.prototype.canUse=function(){return this.cool<=0},e.prototype.useSuccess=function(){this.cool=60},e.prototype.reset=function(){this.cool=7},e}(SingleClass);__reflect(FocusAttackControl.prototype,"FocusAttackControl");var FocusAwakeRedPoint=function(t){function e(){var e=t.call(this)||this;return e.addCustomEventMany(e.postAwakeRed,705,706,267,266,268,651,466,45,46),e.addCustomEventMany(e.postHeJiRed,267,266,268,85,86,87,84),e}return __extends(e,t),e.prototype.postAwakeRed=function(){if(!skillControl.checkAwakeOpen())return!1;var t=this.awakeRed;return this.awakeRed=skillControl.getPunchAwakeRed(),EventMgr.ins().dispatch(707),t!=this.awakeRed},e.prototype.postHeJiRed=function(){var t=this.hejiRed;return this.hejiRed=skillControl.canHejiEquip()||skillControl.canExchange()||skillControl.canSolve()||skillControl.canAcitve()||skillControl.getPunchForge().getRedPoint(),EventMgr.ins().dispatch(708),t!=this.hejiRed},e}(BaseSystem);__reflect(FocusAwakeRedPoint.prototype,"FocusAwakeRedPoint");var GameSystem;!function(t){t.punchRedPoint=FocusAwakeRedPoint.ins.bind(FocusAwakeRedPoint)}(GameSystem||(GameSystem={}));var FocusAttackProgressVo=function(){function t(){this.id=0,this.progress=0}return t.prototype.parser=function(t){this.id=t[0],this.progress=t[1]},t}();__reflect(FocusAttackProgressVo.prototype,"FocusAttackProgressVo");var WeaponSoulSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.roleId=t[0],this.weaponId=t[1];var i=heroControl.getSubRoleByIndex(this.roleId);this.head(i),this.curSkill(i),this.nextSkill(i)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick)},e.prototype.head=function(t){var e=t.weapons.getSuitConfig(this.weaponId);e||(e=DataCenter.ins().WeaponSoulSuitConfig[this.weaponId][0]),this.skillicon.data={icon:e.skillicon},this.skillname.text=e.skillname},e.prototype.curSkill=function(t){var e=t.weapons.getSuitConfig(this.weaponId);e||(e=DataCenter.ins().WeaponSoulSuitConfig[this.weaponId][0]);for(var i=DataCenter.ins().WeaponSoulConfig[this.weaponId],n="",o=0,s=0;s<i.actcond.length;s++){var r=i.actcond[s],a=t.weapons.getInfoLevel(r),l=DataCenter.ins().WeaponSoulPosConfig[r][0].name;a&&a>=e.level?(n+="|C:"+ColorUtils.NORMAL_COLOR+"&T:"+l+"| ",o++):n+="|C:"+ColorUtils.GRAY+"&T:"+l+"| "}this.num0.text="（"+o+"/"+i.actcond.length+"）",this.informationname0.textFlow=TextUtils.generateTextFlow1(n),this.desc0.text=this.ShowSkillDesc(e)},e.prototype.nextSkill=function(t){var e=t.weapons.getNextSuitConfig(this.weaponId);if(!e)return this.name1.text=LangMgr.getValueByKey("maxLevel"),this.num1.visible=!1,this.nextdesc1.visible=!1,this.informationname1.visible=!1,void(this.ndesc0.visible=!1);for(var i=DataCenter.ins().WeaponSoulConfig[this.weaponId],n="",o=0,s=0;s<i.actcond.length;s++){var r=i.actcond[s],a=t.weapons.getInfoLevel(r),l=DataCenter.ins().WeaponSoulPosConfig[r][0].name;a>=e.level?(n+="|C:"+ColorUtils.NORMAL_COLOR+"&T:"+l+"| ",o++):n+="|C:"+ColorUtils.GRAY+"&T:"+l+"| "}this.num1.text="（"+o+"/"+i.actcond.length+"）",this.informationname1.textFlow=TextUtils.generateTextFlow1(n),this.ndesc0.text=this.ShowSkillDesc(e);var h=this.nextdesc1.text,u=h.split("X"),p=u[0],c=u[1],d=p+(""+e.level)+c;this.nextdesc1.text=d},e.prototype.ShowSkillDesc=function(t){return t.skilldesc},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(WeaponSoulSkillTipsView.prototype,"WeaponSoulSkillTipsView");var FocusAttackAttrView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="FocusAttackAttrViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.setView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.setView=function(){for(var t=[],e=[],i=0;8>i;i++){var n=skillControl.equipListData[i];for(var o in n.att)if(0!=n.att[o].type&&0!=n.att[o].value){var s=n.att[o];t[s.type]?t[s.type]+=s.value:t[s.type]=s.value}if(n.configID){var r=DataCenter.ins().EquipConfig[n.configID];for(var a in AttributeData.translate)if(r[a]&&!(r[a]<=0)){var l=RoleModel.getAttrTypeByName(a);t[l]?t[l]+=r[a]:t[l]=r[a]}r.baseAttr1&&(t[r.baseAttr1.type]?t[r.baseAttr1.type]+=r.baseAttr1.value:t[r.baseAttr1.type]=r.baseAttr1.value),r.baseAttr2&&(t[r.baseAttr2.type]?t[r.baseAttr2.type]+=r.baseAttr2.value:t[r.baseAttr2.type]=r.baseAttr2.value),r.exAttr1&&(e[r.exAttr1.type]?e[r.exAttr1.type]+=r.exAttr1.value:e[r.exAttr1.type]=r.exAttr1.value),r.exAttr2&&(e[r.exAttr2.type]?e[r.exAttr2.type]+=r.exAttr2.value:e[r.exAttr2.type]=r.exAttr2.value)}}var h="",u="",p=0,c=0;for(var d in t){if(c=Number(d),p=t[d],u=AttributeData.getAttrStrByType(c),u.length<3&&(u=AttributeData.inserteBlank(u,4)),c>1&&9>c)h+=7==c||8==c?u+"："+p/100+"%":u+"："+p;else{if(!(c>12&&15>c||c>15))continue;h+=19==c?u+"："+(p/100+150)+"%":u+"："+p/100+"%"}h+="\n"}for(var d in e)c=Number(d),p=e[d],u=AttributeData.getExtAttrStrByType(c),h+=u+"："+p/100+"%",h+="\n";""==h&&(h=LangMgr.getValueByKey("persontNone")),this.baseAttr.text=h,this.anigroup.height=this.baseAttr.height+150,this.anigroup.height=this.anigroup.height<537?537:this.anigroup.height},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(FocusAttackAttrView.prototype,"FocusAttackAttrView");var FocusAttackChooseView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemList=[],e.pos=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="FocusAttackChooseViewSkin",this.list.itemRenderer=FocusAttackListItemRenderer,this.wearItem=new FocusAttackListItemRenderer,this.itemGroup.addChild(this.wearItem)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.pos=t[0];var i=t[1],n=skillControl.equipListData[this.pos];this.wearItem.data=n,this.wearItem.setBtnStatu(),this.itemList=backpackControl.getHejiEquipsByType(this.pos),this.list.dataProvider=new eui.ArrayCollection(this.itemList),this.addEventItemTap(this.list,this.itemTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(86,this.changeEquipSuccess),1==i?(this.scroll.y=232,this.scroll.height=410,this.wearItem.visible=!0):(this.scroll.y=50,this.scroll.height=590,this.wearItem.visible=!1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventItemTap(this.list,this.itemTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.changeEquipSuccess=function(){UIMgr.ins().close(e)},e.prototype.itemTap=function(t){var e=skillControl.equipListData[this.pos],i=t.item;if(e){if(e.itemConfig&&i.itemConfig.useCond!=e.itemConfig.id){var n=DataCenter.ins().ItemConfig[e.itemConfig.id+10];return void tipsControl.showTips(LangMgr.getValueByKey("hijiTips2",n.name))}}else if(i.itemConfig.useCond){var n=DataCenter.ins().ItemConfig[91e4+this.pos+1];return void tipsControl.showTips(LangMgr.getValueByKey("hijiTips3"))}var o=i.itemConfig.level?i.itemConfig.level:0,s=i.itemConfig.zsLevel?i.itemConfig.zsLevel:0;return s>reincarnateControl.lv||o>ActorControl.level?void tipsControl.showTips(LangMgr.getValueByKey("hijiTips4",s,o)):void skillControl.upDressHejiEquip(i.handle,this.pos)},e.prototype.onTap=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(FocusAttackChooseView.prototype,"FocusAttackChooseView");var FocusAttackDetailView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offY=150,e.data=null,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="FocusAttackDetailViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.forgeGroup.visible=t[1],this.addEventTouchTap(this.forgeGroup,this.onTap),this.addCustomEvent(86,this.refushInfo),this.refushInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.forgeGroup,this.onTap),this.removeCustomEvents()},e.prototype.refushInfo=function(){var t,e="",i="";t=this.data.itemConfig;var n=0;n=this.data.point,this.score.text=LangMgr.getValueByKey("wingPingfen",n);var o=0;this.powerPanel.setPower(Math.floor(n*(100+o)/100));for(var s=this.data.att,r=0;r<s.length;r++)if(0!=s[r].type){var a=AttributeData.getAttrNameByAttrbute(s[r],!0);e+=a+"\n"}for(var l=this.data.extAtt,h=!1,u=0;u<l.length;u++)if(0!=l[u].type){h=!0;var a=AttributeData.getAttrNameByAttrbute(l[u],!0);i+=a+"\n"}h?(this.tupoDesc.visible=!0,this.group.height=600,this.forgeGroup.y=530):(this.tupoDesc.visible=!1,this.group.height=600-this.offY,this.forgeGroup.y=530-this.offY),this.desc1.text=LangMgr.getValueByKey("hijiBasic"),this.nameLabel.text=t.name,this.nameLabel.textColor=ItemUtils.getQualityColor(t),this.itemIcon.setData(t);t.level%3;this.lv.text=t.zsLevel>0?LangMgr.getValueByKey("hijiLevelRo",t.zsLevel):LangMgr.getValueByKey("hijiLevelVo",t.level),this.attr1.text=e,this.attr0.text=i},e.prototype.onTap=function(t){switch(t.target){case this.forgeGroup:UIMgr.ins().close(e),UIMgr.ins().open(FocusAttackChooseView,this.data.itemConfig.subType,1);break;default:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(FocusAttackDetailView.prototype,"FocusAttackDetailView");var FocusAttackExchangeView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentSelect=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="FocusAttackExchangeViewSkin",this.goturn.textFlow=[{text:LangMgr.getValueByKey("hijiExchange"),style:{underline:!0}}],this.exchangelist.itemRenderer=FocusAttackExchangeItemRenderer,this.equiplist.itemRenderer=FocusAttackExchangeBtnItemRenderer,this.initMenu()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.addEventChange(this.equiplist,this.checkIsOpen),this.addCustomEvent(460,this.onListChange),this.addEventTouchTap(this.goturn,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.equiplist.selectedIndex=this.currentSelect,this.refushInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventChange(this.equiplist,this.checkIsOpen),this.removeEventTouchTap(this.goturn,this.onTap),this.removeCustomEvents()},e.prototype.onListChange=function(t){this.currentSelect=this.equiplist.selectedIndex,this.refushInfo()},e.prototype.initMenu=function(){this.menuArr=[],this.exchangeArr=[];var t=DataCenter.ins().FocusAttackPageConfig,e=0,i=skillControl.getMaxzLv();for(var n in t){var o=t[n].id[0],s=DataCenter.ins().FocusAttackExchangeConfig[o];if(s.zsLevel>i[0]||s.level>i[1])break;this.menuArr.push({config:t[n],index:+n}),this.exchangeArr[e]=[];for(var r in t[n].id){var a=DataCenter.ins().FocusAttackExchangeConfig[t[n].id[r]];this.exchangeArr[e].push(a)}e++}},e.prototype.refushInfo=function(){this.suipian.text=""+ActorControl.togeatter1,this.suipian1.text=""+ActorControl.togeatter2,this.equiplist.dataProvider=new eui.ArrayCollection(this.menuArr);var t=this.exchangeArr[this.currentSelect];this.exchangelist.dataProvider=new eui.ArrayCollection(t)},e.prototype.onTap=function(t){var e=t.currentTarget;e==this.goturn?UIMgr.ins().open(FocusAttackTransformView):e==this.fgClose&&UIMgr.ins().close(this)},e.prototype.checkIsOpen=function(t){var e=t.target,i=this.exchangeArr[e.selectedIndex][0],n=i.zsLevel||0,o=i.level,s=!0;if(!s){var r=ActorControl.level>=o?LangMgr.getValueByKey("fbRotationOpen",n):LangMgr.getValueByKey("tipsOpenLevel",o);return tipsControl.showTips(LangMgr.getValueByKey("open1",r)),t.$cancelable=!0,void t.preventDefault()}this.onListChange(null)},__decorate([callLater],e.prototype,"onListChange",null),e}(BaseEuiView);__reflect(FocusAttackExchangeView.prototype,"FocusAttackExchangeView");var FocusAttackForgePanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){var t=this.getItemTxt.text;this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+t),this.maxPos=8,this.mcs=[]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.getItemTxt,this.onClick),this.addEventTouchTap(this.btn,this.onClick),this.addCustomEvent(87,this.UpgradeForgeCallback),this.addCustomEvent(117,this.callback),this.updateDate()},e.prototype.callback=function(){this.updateDate()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.getItemTxt,this.onClick),this.removeEventTouchTap(this.btn,this.onClick),DisplayUtils.removeFromParent(this.mc);for(var i=0;i<this.mcs.length;i++)DisplayUtils.removeFromParent(this.mcs[i])},e.prototype.onClick=function(t){switch(t.currentTarget){case this.getItemTxt:warnControl.setBuyGoodsWarn(909998);break;case this.btn:var e=skillControl.getPunchForge().calcSelectPos(),i=skillControl.getPunchForge().isUpgradePunchForge(e);if(0==i)return void tipsControl.showTips(LangMgr.getValueByKey("hijiTips5"));if(2==i)return void tipsControl.showTips(LangMgr.getValueByKey("hijiTips6"));skillControl.upUpgradeForge(e)}},e.prototype.UpgradeForgeCallback=function(){this.updateDate(!0)},e.prototype.updateDate=function(t){for(var e=skillControl.getPunchForge().calcSelectPos(),i=0,n=2,o=0;o<this.maxPos;o++){var s=skillControl.getPunchForge().isUpgradePunchForge(e);if(2!=s){n=0;break}}2==n?this.currentState="full":(this.currentState="normal",i=skillControl.getPunchForge().getPunchLevel(e)),this.validateNow(),this.setSelect(e),this.setEff(),this.updateAttrDesc(e,i),this.updateCost(e,i),this.setPower(),t&&this.setPosEff(e)},e.prototype.setPosEff=function(t){var e=t-1;0>e&&(e=this.maxPos-1),this.mcs[e]||(this.mcs[e]=new GameMovieClip),this.mcs[e].parent||this["eff"+e].addChild(this.mcs[e]),this.mcs[e].playFile(PATH_EFF+"forgeSuccess",1)},e.prototype.setSelect=function(t){for(var e=0;e<this.maxPos;e++)this["pEquip"+e].visible=!1,this["pELv"+e].text="+"+skillControl.getPunchForge().getPunchLevel(e);"normal"==this.currentState&&(this["pEquip"+t].visible=!0)},e.prototype.setEff=function(){return"normal"!=this.currentState?void DisplayUtils.removeFromParent(this.mc):skillControl.canSolve()?(this.mc||(this.mc=new GameMovieClip),this.mc.parent||(this.getItemTxt.parent.addChild(this.mc),this.mc.playFile(PATH_EFF+"chargeff1",-1),this.mc.touchEnabled=!1,this.mc.scaleY=.5,this.mc.scaleX=.6),this.mc.x=0,void(this.mc.y=0)):void DisplayUtils.removeFromParent(this.mc)},e.prototype.updateAttrDesc=function(t,e){if("full"==this.currentState){for(var i=skillControl.getPunchForge().getSuitlevel(),n=DataCenter.ins().FocusAttackPunchMasterConfig[i],o=skillControl.getPunchForge().getAttributeData(),s=0;s<o.length;s++)if(this["attr"+s]){for(var r="",a=0,l=0;l<o.length;l++)if(o[l].type==o[s].type){a=o[l].value;break}a+=n.attr&&n.attr[s]?n.attr[s].value:0,r=AttributeData.getAttrStrByType(o[s].type),r+="+",r+=a,this["attr"+s].text=r}var h="";return h=LangMgr.getValueByKey("hijiTips7"),h+=n.exattr[0].value/100,void(this.exattr0.text=h+"%")}var u=DataCenter.ins().FocusAttackPunchConfig[t][e];if(u){var i=skillControl.getPunchForge().getSuitlevel(),n=DataCenter.ins().FocusAttackPunchMasterConfig[i],p=!0;if(!n){p=!1;for(var c in DataCenter.ins().FocusAttackPunchMasterConfig){n=DataCenter.ins().FocusAttackPunchMasterConfig[c];break}}for(var d=skillControl.getPunchForge().getPosNextLevelConfig(t),o=skillControl.getPunchForge().getAttributeData(),s=0;s<u.attr.length;s++)if(this["attr"+s]){for(var r="",a=0,l=0;l<o.length;l++)if(o[l].type==u.attr[s].type){a=o[l].value;break}if(a+=n.attr&&n.attr[s]?n.attr[s].value:0,r=AttributeData.getAttrStrByType(u.attr[s].type),r+="+",r+=a,this["attr"+s].text=r,d&&this["arrow"+s]&&this["addAttr"+s]&&d.attr[s].value){this["addAttr"+s].visible=this["arrow"+s].visible=!0;var g="";g+=a+(d.attr[s].value-u.attr[s].value),this["addAttr"+s].text=g,this["arrow"+s].x=this["attr"+s].x+this["attr"+s].width,this["addAttr"+s].x=this["arrow"+s].x+this["arrow"+s].width}else this["addAttr"+s].visible=this["arrow"+s].visible=!1
}var m=void 0,f=void 0,h="";if(h=LangMgr.getValueByKey("hijiTips7"),p?(h+=n.exattr[0].value/100,m=skillControl.getPunchForge().getNextSuitlevel(),f=DataCenter.ins().FocusAttackPunchMasterConfig[m]):(h+=0,f=n,m=i),this.exattr0.text=h+"%",this.arrow4.x=this.exattr0.x+this.exattr0.width+this.arrow4.width,this.exattr1.x=this.arrow4.x+this.arrow4.width,f){this.exattr1.text=f.exattr[0].value/100+"%",this.exattr2.x=this.exattr1.x+this.exattr1.width;var v=Math.floor(skillControl.getPunchForge().level/this.maxPos);this.exattr2.text=LangMgr.getValueByKey("hijiTips8",v,m)}}else{var o=skillControl.getPunchForge().getAttributeData();u=DataCenter.ins().FocusAttackPunchConfig[t][1];for(var s=0;s<u.attr.length;s++)if(this["attr"+s]){for(var r="",a=0,l=0;l<o.length;l++)if(o[l].type==u.attr[s].type){a=o[l].value;break}if(r=AttributeData.getAttrStrByType(u.attr[s].type),r+="+",r+=a,this["attr"+s].text=r,this["arrow"+s]&&this["addAttr"+s]&&u.attr[s].value){this["addAttr"+s].visible=this["arrow"+s].visible=!0;var g="";g+=u.attr[s].value,this["addAttr"+s].text=g,this["arrow"+s].x=this["attr"+s].x+this["attr"+s].width,this["addAttr"+s].x=this["arrow"+s].x+this["arrow"+s].width}else this["addAttr"+s].visible=this["arrow"+s].visible=!1}var n=void 0;for(var c in DataCenter.ins().FocusAttackPunchMasterConfig){n=DataCenter.ins().FocusAttackPunchMasterConfig[c];break}var h="";h=LangMgr.getValueByKey("hijiTips7"),h+=0,this.exattr0.text=h+"%",this.arrow4.x=this.exattr0.x+this.exattr0.width+this.arrow4.width,this.exattr1.x=this.arrow4.x+this.arrow4.width,n&&(this.exattr1.text=n.exattr[0].value/100+"%",this.exattr2.x=this.exattr1.x+this.exattr1.width,this.exattr2.text=LangMgr.getValueByKey("hijiTips8",0,n.level))}},e.prototype.updateCost=function(t,e){var i;i=t||e?skillControl.getPunchForge().getPosNextLevelConfig(t):DataCenter.ins().FocusAttackPunchConfig[0][1],i||(i=DataCenter.ins().FocusAttackPunchConfig[t][1]),this.costicon.source=Currency.getCurrencyRes(i.cost.id);var n="",o=skillControl.getPunchForge().isUpgradePunchForge(t);1==o?(n=ColorUtils.GREEN_COLOR,this.redPoint.visible=!0):(this.redPoint.visible=!1,n=ColorUtils.RED_COLOR);var s=0;11==i.cost.id?s=ActorControl.togeatter1:12==i.cost.id&&(s=ActorControl.togeatter2),this.costcount.textFlow=TextUtils.generateTextFlow("<font color="+n+">"+s+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+i.cost.count+"</font> ")},e.prototype.setPower=function(){var t=skillControl.getPunchForge().getAttributeData(),e=BackpackControl.getAttrPower(t),i=skillControl.getPunchForge().getSuitlevel(),n=DataCenter.ins().FocusAttackPunchMasterConfig[i];n&&n.attr&&(e+=BackpackControl.getAttrPower(n.attr),e+=n.exPower),e*=heroControl.subRolesLen,this.powerPanel.setPower(e)},e}(BasePanel);__reflect(FocusAttackForgePanel.prototype,"FocusAttackForgePanel");var FocusAttackPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.jobId=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.HejiSkillMc1=new GameMovieClip,this.HejiSkillMc1.x=207,this.HejiSkillMc1.y=316,this.Punchpre.addChild(this.HejiSkillMc1),this.HejiSkillMc2=new GameMovieClip,this.HejiSkillMc2.x=434,this.HejiSkillMc2.y=425,this.Punchpre.addChild(this.HejiSkillMc2),this.preViewText.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.preViewText.text+"</u>"),this.effArr=[];for(var t=0;8>t;t++)this["itemEff"+t]=new GameMovieClip,this["itemEff"+t].x=177,this["itemEff"+t].y=174,this["itemEff"+t].rotation=45*t,this["itemEff"+t].touchEnabled=!1,this.effArr.push(this["itemEff"+t]);this.jobId=heroControl.getSubRoleByIndex(0).job,this.mcSkillID="skill40"+this.jobId;var e=403+this.jobId;this.targetSkillID="skill"+e},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.UplevelBtn1,this.onClick),this.addEventTouchTap(this.AttrBtn,this.onClick),this.addEventTouchTap(this.punchtogether1,this.onClick),this.addEventTouchTap(this.preViewText,this.onClick),this.addEventTouchTap(this.skillitem,this.onClick),this.addEventTouchTap(this.clickGroup,this.onClick),this.addEventTouchTap(this.fenjieBtn,this.onClick),this.addEventTouchTap(this.turnPunchForge,this.onClick),this.addCustomEvent(85,this.setData),this.addCustomEvent(86,this.setData),this.addCustomEvent(460,this.setData),this.addCustomEvent(460,this.setRedPoint),this.addCustomEvent(376,this.setRedPoint),this.addCustomEvent(266,this.addItem),this.addCustomEvent(268,this.setRedPoint),this.resetData(),this.setData(),this.setRedPoint()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.UplevelBtn1,this.onClick),this.removeEventTouchTap(this.AttrBtn,this.onClick),this.removeEventTouchTap(this.punchtogether1,this.onClick),this.removeEventTouchTap(this.skillitem,this.onClick),this.removeEventTouchTap(this.preViewText,this.onClick),this.removeEventTouchTap(this.fenjieBtn,this.onClick),this.removeEventTouchTap(this.turnPunchForge,this.onClick),this.removeAllEffect(),this.removeCustomEvents(),TimerMgr.ins().removeAll(this),this.PunchForge.visible=!1,this.PunchForge.close()},e.prototype.resetData=function(){this.validateNow();for(var t=1;9>t;t++)this["item"+t].data=null},e.prototype.addItem=function(){this.refushPanelInfo(),this.setRedPoint()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.UplevelBtn1:copyControl.guanqiaID<SkillControl.ACTIVE_LEVEL?tipsControl.showTips(LangMgr.getValueByKey("tipsPass",SkillControl.ACTIVE_LEVEL)):(this.Activation.visible=skillControl.hejiLevel>0?!1:!0,skillControl.upGrewUpHejiSkill());break;case this.AttrBtn:UIMgr.ins().open(FocusAttackAttrView);break;case this.punchtogether1:UIMgr.ins().open(FocusAttackExchangeView);break;case this.skillitem:UIMgr.ins().open(FocusAttackSkillTipsView);break;case this.preViewText:UIMgr.ins().open(FocusAttackShowView);break;case this.fenjieBtn:UIMgr.ins().open(FocusAttackResView);break;case this.turnPunchForge:this.Activation.visible=!1,this.Punchpre.visible=!1,this.Punch.visible=!1,this.PunchForge.visible=!0,this.PunchForge.open()}},e.prototype.showActive=function(t){var e=t.isAct;if(e){var i=DataCenter.ins().FocusAttackConfig[skillControl.hejiLevel],n=i.skill_id,o=n[0].toString();CommonFun.show(0,LangMgr.getValueByKey("equipment8"),"j"+o+"_png")}},e.prototype.setRedPoint=function(){this.redPointEx.visible=skillControl.canExchange(),this.redPointSo.visible=skillControl.canSolve(),this.redPointAct.visible=!1,this.redPointPf.visible=skillControl.getPunchForge().getRedPoint()},e.prototype.playSkillAnmi=function(){var t=this,e=egret.Tween.get(this.Punchpre);this.HejiSkillMc1.parent||this.Punchpre.addChild(this.HejiSkillMc1),this.HejiSkillMc1.playFile(""+PATH_SKILLEFF+this.mcSkillID,1,null,!0),e.wait(1500).call(function(){t.HejiSkillMc2.parent||t.Punchpre.addChild(t.HejiSkillMc2),t.HejiSkillMc2.playFile(""+PATH_SKILLEFF+t.targetSkillID,1,null,!0)},this)},e.prototype.setData=function(){heroControl.subRolesLen;return skillControl.hejiLevel<=0?(this.Activation.visible=!0,this.Punchpre.visible=!1,this.Punch.visible=!1,this.PunchForge.visible=!1,void(this.activeTipsTxt.text=LangMgr.getValueByKey("hejiNeedLevel",SkillControl.ACTIVE_LEVEL))):void(ActorControl.level>=SkillControl.HEJI_SHOW_LEVEL?(this.PunchForge.visible?this.Punch.visible=!1:(this.Punch.visible=!0,this.PunchForge.visible=!1),this.Activation.visible=!1,this.Punchpre.visible=!1,this.setPunchView(),this.setPunch2View(),this.refushPanelInfo(),this.checkShowEff()):this.setPunchpreView())},e.prototype.setPunchpreView=function(){TimerMgr.ins().remove(this.playSkillAnmi,this),this.Activation.visible=!1,this.Punch.visible=!1,this.Punchpre.visible=!0,this.PunchForge.visible=!1,this.skillName.source="8000"+this.jobId+"_png";var t=DataCenter.ins().FocusAttackConfig[skillControl.hejiLevel],e=new SkillVo(t.skill_id[this.jobId-1]);this.skillIcon.source=e.id+"_png",TimerMgr.ins().doTimer(3e3,0,this.playSkillAnmi,this),this.playSkillAnmi()},e.prototype.checkShowEff=function(){var t=skillControl.equipListData,e=-1,i=t.length;if(!t||8==t.length){for(var n=0;i>n;n++){var o=t[n];if(!o||!o.itemConfig)return;if(-1==e)e=1e4*(o.itemConfig.zsLevel||0)+o.itemConfig.level;else{var s=1e4*(o.itemConfig.zsLevel||0)+o.itemConfig.level;if(e!=s)return void this.removeAllEffect()}}this.playAllEffect()}},e.prototype.setPunch2View=function(){var t=DataCenter.ins().FocusAttackConfig[skillControl.hejiLevel],e=new SkillVo(t.skill_id[this.jobId-1]);this.skillitem.setData(e)},e.prototype.destructor=function(){},e.prototype.updateRedPoint=function(t){},e.prototype.refushPanelInfo=function(){for(var t=[],e=1;9>e;e++){this["item"+e].data=e-1;var i=skillControl.equipListData[e-1];t=0==t.length?i.att:AttributeData.AttrAddition(t,i.att)}this.powerPanel.setPower(this.countAllAttNum()),this.validateNow(),this.updateForge()},e.prototype.refushOne=function(t){this["item"+(t+1)].data=t,UIMgr.ins().isShow(FocusAttackChooseView)&&UIMgr.ins().close(FocusAttackChooseView),this.powerPanel.setPower(this.countAllAttNum())},e.prototype.countAllAttNum=function(){var t=skillControl.equipListData,e=0,i=t.length;if(t&&t.length<=0)return 0;for(var n=0;i>n;n++){var o=t[n];o&&o.configID&&(e+=o.point)}return e*heroControl.subRolesLen},e.prototype.playAllEffect=function(){for(var t=0;t<this.effArr.length;t++)this.effArr[t].parent||(this.effArr[t].playFile(PATH_EFF+"hejizbjihuoeff",-1),this.EffectGroup.addChild(this["itemEff"+t]))},e.prototype.removeAllEffect=function(){for(var t=0;t<this.effArr.length;t++)this.effArr[t].parent&&DisplayUtils.removeFromParent(this["itemEff"+t])},e.prototype.setPunchView=function(){var t,e=skillControl.qimingAttrDic,i=0,n=0,o=0,s=0,r="",a="",l="";this.currText3.text="",this.currText5.text="",this.currText8.text="",this.nextText1.text="",this.nextText2.text="",this.nextText3.text="";var h=0,u=0;if(e&&CommonUtils.getObjectLength(e)>0){for(var p in e)for(var c in e[p])i=e[p][c].zslv,n=e[p][c].lv;o=i+1,s=80,t=DataCenter.ins().FocusAttackQmConfig[i][n],this.paserText("currText",t,e[1e4*i+n])}else this.currTitleText.text=LangMgr.getValueByKey("persontNone"),this.currText0.text="",this.currText3.text="",this.currText5.text="",this.currText8.text="",i=0,n=60,o=1,s=80,t=DataCenter.ins().FocusAttackQmConfig[i][n],this.paserText("currText",t);for(var d=0;d<skillControl.equipListData.length;d++){var g=skillControl.equipListData[d].itemConfig;if(g){var m=g.zsLevel?g.zsLevel:0,f=g.level?g.level:1;m>=i&&f>=n?(a=LangMgr.getValueByKey("color101"),h++):a=LangMgr.getValueByKey("color100"),m>=o&&f>=s?(l=LangMgr.getValueByKey("color101"),u++):l=LangMgr.getValueByKey("color100")}else a=l=LangMgr.getValueByKey("color100");r+="<font color="+a+">"+LangMgr.getValueByKey("roleBG"+(d+1))+"  </font>"}this.currTitleText.text=i>0?LangMgr.getValueByKey("hejiTaoZhuang",i,h):LangMgr.getValueByKey("hejiTaoLevel",n,h),this.currText0.textFlow=(new egret.HtmlTextParser).parser(r),this.preViewText.x=this.currTitleText.x+this.currTitleText.textWidth+10},e.prototype.paserText=function(t,e,i){void 0===i&&(i=null);var n={},o=skillControl.equipListData,s=0,r={};for(var a in o)if(0!=o[a].configID){var l=o[a].itemConfig,h=1e4*(l.zsLevel||0)+l.level;n[h]||(n[h]=0),n[h]+=1,s++,r[h]=ItemUtils.getQualityColor(l)}var u=0;for(var p in n)u=n[p],n[p]=s,s-=u;var c={},d=DataCenter.ins().FocusAttackQmConfig;for(var g in d)for(var h in d[g]){for(var m in n)if(Number(m)==1e4*Number(g)+Number(h)){var f=void 0;for(var v in d[g][h]){var y="";if(n[m]>=Number(v))y=Number(g)?"|C:"+r[m]+"&T:"+g+LangMgr.getValueByKey("numberRotation","")+v+LangMgr.getValueByKey("numberJT")+ColorUtils.NORMAL_COLOR+"&T:"+d[g][h][v].desc:"|C:"+r[m]+"&T:"+h+LangMgr.getValueByKey("numberLevel","")+v+LangMgr.getValueByKey("numberJT")+ColorUtils.NORMAL_COLOR+"&T:"+d[g][h][v].desc,c[v]=y,f=TextUtils.generateTextFlow1(y);else if(!c[v]){var C=DataCenter.ins().FocusAttackQmConfig;for(var T in C){for(var w in C[T]){y="|C:"+r[m]+"&T:"+w+LangMgr.getValueByKey("numberLevel","")+v+LangMgr.getValueByKey("numberJT")+ColorUtils.NORMAL_COLOR+"&T:"+d[T][w][v].desc,f=TextUtils.generateTextFlow1(y);for(var I=0,b=f;I<b.length;I++){var D=b[I];D.style&&delete D.style.textColor}this[""+t+v].textColor=LangMgr.getColor("color28");break}break}}y&&(this[""+t+v].textFlow=f)}break}break}},e.prototype.updateForge=function(){this.turnPunchForge.visible=skillControl.getPunchForge().isShowPunchEquipForge()},e}(BasePanel);__reflect(FocusAttackPanel.prototype,"FocusAttackPanel");var FocusAttackResView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="FocusAttackResViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.smeltEquips=[],this.smeltEquips.length=9,this.itemList.itemRenderer=SmeltItemRenderer,this.dataInfo=new eui.ArrayCollection(this.smeltEquips),this.itemList.dataProvider=this.dataInfo},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.smeltBtn,this.onTap),this.addEventTouchTap(this.itemList,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addCustomEvent(117,this.smeltComplete),this.addCustomEvent(585,this.setItemList),this.setItemData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.smeltBtn,this.onTap),this.removeEventTouchTap(this.itemList,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.removeEventTouchTap(this.fgClose,this.onTap),this.removeCustomEvents()},e.prototype.smeltComplete=function(){for(var t=this.itemList.numChildren;t--;)this.itemList.getChildAt(t).playEff();this.setItemData()},e.prototype.setItemData=function(){this.smeltEquips=backpackControl.getHejiOutEquips(),this.dataInfo.replaceAll(this.smeltEquips)},e.prototype.setItemList=function(t){this.dataInfo.replaceAll(t),this.itemList.dataProvider=this.dataInfo},e.prototype.onTap=function(t){switch(t.currentTarget){case this.smeltBtn:equipControl.upSmeltEquip(0,this.smeltEquips);break;case this.itemList:var i=t.target;if(i&&i.data){var n=this.smeltEquips.indexOf(i.data);n>=0&&(this.smeltEquips.splice(n,1),i.data=null)}break;case this.fgClose:case this.bgClose:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(FocusAttackResView.prototype,"FocusAttackResView");var FocusAttackShowView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.colorWhite=LangMgr.getValueByKey("color101"),e.colorGray=LangMgr.getValueByKey("color100"),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="FocusAttackShowViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.setView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.setView=function(){var t="",e=DataCenter.ins().FocusAttackQmConfig,i=skillControl.qimingAttrDic,n=new Object,o=0;for(var s in i)n=i[s],o=Number(s);var r=n?CommonUtils.getObjectLength(n):0,a=this.colorWhite,l=!1;for(var h in e)for(var u in e[h]){var p=e[h][u];t+=0!=Number(h)?LangMgr.getValueByKey("hijiTips10",this.colorWhite,h):LangMgr.getValueByKey("hijiTips10",this.colorWhite,u);var s=0,c=1e4*Number(h)+Number(u);for(var d in p){p[d].exAttr;c>o?(a=this.colorGray,l=!0):c==o&&s+1>r&&(a=this.colorGray,l=!0),t+="<font color="+a+">"+p[d].num+LangMgr.getValueByKey("numberJT1")+"："+this.getDescTextFlow(p[d].desc,!l)+"</font>\n",s++,3==s&&(t+="\n")}}this.baseAttr.textFlow=(new egret.HtmlTextParser).parser(t)},e.prototype.getDescTextFlow=function(t,e){for(var i=TextUtils.generateTextFlow1(t),n="",o=0,s=i;o<s.length;o++){var r=s[o];n+=e&&r.style&&void 0!=r.style.textColor?"<font color="+r.style.textColor+">"+r.text+"</font>":r.text}return n},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(FocusAttackShowView.prototype,"FocusAttackShowView");var FocusAttackSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="FocusAttackSkillTipsViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.setView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.setView=function(){var t=DataCenter.ins().FocusAttackConfig[skillControl.hejiLevel],e=heroControl.getSubRoleByIndex(0),i=new SkillVo(t.skill_id[e.job-1]);this.skillitem.setData(i),this.nameLabel0.text=i.name,this.desc0.text=i.desc;var n=skillControl.qimingValueDic,o=0;for(var s in n){var r=n[s].value/100,a=void 0;a=2>o?StringUtils.substitute(LangMgr.getValueByKey("userType"+(o+1)),"|C:"+LangMgr.getColor("color43")+"&T:"+3*r+"%|"):StringUtils.substitute(LangMgr.getValueByKey("userType"+(o+1)),"|C:"+LangMgr.getColor("color43")+"&T:"+r+"%|"),this["desc"+s].textFlow=TextUtils.generateTextFlow1(a),o++}0==o&&(this.desc3.text=LangMgr.getValueByKey("persontNone"))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(FocusAttackSkillTipsView.prototype,"FocusAttackSkillTipsView");var FocusAttackTransformView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FocusAttackTransformViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTouch),this.addCustomEvent(460,this.checkChange),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents()},e.prototype.checkChange=function(t){t&&2==t.type&&this.update()},e.prototype.update=function(){this.count0.text=ActorControl.togeatter2+"",this.count1.text="0",this.changeBar.value=0,this.changeBar.maximum=ActorControl.togeatter2,this.transformBtn.enabled=ActorControl.togeatter2>0,this.quicklytransformBtn.enabled=!1},e.prototype.onTouch=function(t){switch(t.target){case this.fgClose:case this.bgClose:UIMgr.ins().close(this);break;case this.transformBtn:skillControl.upChangeTogeatterHigh(ActorControl.togeatter2);break;case this.quicklytransformBtn:skillControl.upChangeTogeatterHigh(this.changeBar.value);break;case this.add:this.changeBar.value<ActorControl.togeatter2?(this.changeBar.value++,this.count1.text=this.changeBar.value*DataCenter.ins().FocusAttackBaseConfig.TogExgRate+"",this.quicklytransformBtn.enabled=!0):0==ActorControl.togeatter2?tipsControl.showTips(LangMgr.getValueByKey("hijiTips11")):tipsControl.showTips(LangMgr.getValueByKey("hijiTips12"));break;case this.minus:this.changeBar.value>0&&(this.changeBar.value--,this.count1.text=this.changeBar.value*DataCenter.ins().FocusAttackBaseConfig.TogExgRate+""),this.changeBar.value<=0&&(this.quicklytransformBtn.enabled=!1)}},e}(BaseEuiView);__reflect(FocusAttackTransformView.prototype,"FocusAttackTransformView");var FocusAwakeAttsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="FocusAwakeAttsViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onClose),this.update()},e.prototype.close=function(){},e.prototype.update=function(){var t,e=[],i=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length;for(t=0;i>t;t++){var n=skillControl.getPuchAwakeLvByPos(t);if(n){var o=DataCenter.ins().FocusAwakeHitLvConfig[t][n];o.attr&&(e=e.concat(o.attr.concat()))}}e=AttributeData.combineAtts(e);var s=DataCenter.ins().FocusAttackBaseConfig.awakeAttrs,r=s?s.length:0,a="";for(t=0;4>t;t++)if(r>t){var l=s[t],h=skillControl.getAttrByType(l,e);h||(h=new AttributeData(l,0));var u=AttributeData.getAttStrEx(h,4,1,"："),p=AttributeData.getAttrStrByType(h.type),c=p.length<3?AttributeData.inserteBlank(p,4):p;u=u.replace(p,c),a+=u,r-1>t&&(a+="\n")}this.baseAttr.text=a},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(FocusAwakeAttsView.prototype,"FocusAwakeAttsView");var FocusAwakeMaterialTips2View=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="FocusAwakeMaterialTips2ViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose),this._itemID=t[0],this._pos=DataCenter.ins().FocusAttackBaseConfig.itemId.indexOf(this._itemID),this._pos<0?UIMgr.ins().close(this):this.update()},e.prototype.close=function(){},e.prototype.update=function(){var t=DataCenter.ins().ItemConfig[this._itemID];this.nameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t)+"&T:"+t.name+"|"),this.typeValue.text=DataCenter.ins().FocusAttackBaseConfig.awakeNames[this._pos];var e=ItemUtils.getQuality(t);this.quali.source=e?"quali"+e:"",this.itemIcon.setData(t),this.levelKey.text=LangMgr.getValueByKey("focusTips"+(t.level?5:6)),this.lv.text=""+(t.level?t.level:t.zsLevel);var i=skillControl.getPunchAwakeSuitInfo(),n="";for(var o in DataCenter.ins().FocusAwakeHitSuitConfig){var s=+o,r=i&&i[s]?i[s]:0,a=DataCenter.ins().FocusAwakeHitSuitConfig[o][r?r:1],l=LangMgr.getValueByKey("focusTips7",r?65280:9144715,StringUtils.NumberToChinese(a.level),o,a.skillDes.replace(/C:.*&T/g,"C:"+(r?65280:9144715)+"&T")+a.skillValue);n+=l,n+="\n"}this.awakeTxt.textFlow=TextUtils.generateTextFlow2(n);for(var h=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length,u="",p=0;h>p;p++){var c=9144715;skillControl.getPuchAwakeLvByPos(p)&&(c=65280),u+="|C:"+c+"&T:"+DataCenter.ins().FocusAttackBaseConfig.awakeNames[p]+"  |"}this.posTxt.textFlow=TextUtils.generateTextFlow(u)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(FocusAwakeMaterialTips2View.prototype,"FocusAwakeMaterialTips2View");var FocusAwakeMaterialTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="FocusAwakeMaterialTipsViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose),this._itemID=t[0],this._pos=DataCenter.ins().FocusAttackBaseConfig.itemId.indexOf(this._itemID),this._pos<0?UIMgr.ins().close(this):this.update()},e.prototype.update=function(){var t=DataCenter.ins().ItemConfig[this._itemID];this.nameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t)+"&T:"+t.name+"|"),this.typeValue.text=DataCenter.ins().FocusAttackBaseConfig.awakeNames[this._pos];var e=ItemUtils.getQuality(t);this.quali.source=e?"quali"+e:"",this.itemIcon.setData(t),this.levelKey.text=LangMgr.getValueByKey("focusTips"+(t.level?5:6)),this.lv.text=""+(t.level?t.level:t.zsLevel);var i=skillControl.getPuchAwakeLvByPos(this._pos),n=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig[0]).length,o=i==n;this.equip.data={pos:this._pos,lv:o?i:i+1,showRed:!1};for(var s=0,r=o?null:DataCenter.ins().FocusAwakeHitLvConfig[this._pos][i+1],a=i?DataCenter.ins().FocusAwakeHitLvConfig[this._pos][i]:null,l=o?a.attr:a?AttributeData.getBetweenAttrs(a.attr,r.attr):r.attr,h=l?l.length:0,u="",p=0;h>p;p++){var c=l[p];c.value&&(u+=AttributeData.getAttStrEx(new AttributeData(c.type,c.value),4,1,"："),u+="\n")}this.attTxt.text=u,s=BackpackControl.getAttPowerContainRelate(l),s*=heroControl.subRolesLen;var d=skillControl.getPunchAwakeSuitInfo(),g=o?d:skillControl.getPunchAwakeSuitInfo(this._pos),m="",f=[],v=[];for(var y in DataCenter.ins().FocusAwakeHitSuitConfig){var C=+y,T=d&&d[C]?d[C]:0,w=g&&g[C]?g[C]:0,I=DataCenter.ins().FocusAwakeHitSuitConfig[y][T?T:1],b=DataCenter.ins().FocusAwakeHitSuitConfig[y][w?w:1];m+=LangMgr.getValueByKey("focusTips7",w?T!=w?16776960:this.awakeTxt.textColor:9144715,StringUtils.NumberToChinese(b.level),y,b.skillDes+b.skillValue),T&&(f=f.concat(I.attrs.concat())),w&&(v=v.concat(b.attrs.concat())),m+="\n"}f=AttributeData.combineAtts(f),o?s+=this.getPower(f):(v=AttributeData.combineAtts(v),s+=this.getPower(v)-this.getPower(f)),this.awakeTxt.textFlow=TextUtils.generateTextFlow(m),this.powerPanel.setPower(s);for(var D=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length,B="",p=0;D>p;p++){var k=9144715,x=skillControl.getPuchAwakeLvByPos(p);p!=this._pos||o||x++,x&&(k=65280),B+="|C:"+k+"&T:"+DataCenter.ins().FocusAttackBaseConfig.awakeNames[p]+"  |"}this.posTxt.textFlow=TextUtils.generateTextFlow(B)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.getPower=function(t){if(!t||!t.length)return 0;for(var e=0,i=heroControl.subRolesLen,n=0;i>n;n++)e+=BackpackControl.getAttPowerContainRelate(t,n);return e},e}(BaseEuiView);__reflect(FocusAwakeMaterialTipsView.prototype,"FocusAwakeMaterialTipsView");var FocusAwakePanel=function(t){function e(){var e=t.call(this)||this;return e._curPos=-1,e._maxLen=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._pos=[],this.initPoses()},e.prototype.open=function(){this.addCustomEvent(705,this.update),this.addCustomEvent(706,this.update),this.addCustomEvent(267,this.update),this.addCustomEvent(266,this.update),this.addCustomEvent(268,this.update),this.addEventTouchTap(this,this.onTouch),this.update(),this.initPoses(),this.playFlyMc(),this.playBossMc1()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this._curPos=-1;for(var t=0;t<this._maxLen;t++){var e=this._pos?this._pos[t]:null,i=this["equip"+t];egret.Tween.removeTweens(i),e&&(i.x=e.x,i.y=e.y)}this._pos&&(this._pos.length=0,this._pos=null),this._lvUpMC&&(this._lvUpMC.destroy(),this._lvUpMC=null),this._suitMc&&(this._suitMc.destroy(),this._suitMc=null),egret.Tween.removeTweens(this.monsterImg),this.monsterImg.scaleX=this.monsterImg.scaleY=1,this._isPlaying=!1,this._suitsLv&&(this._suitsLv.length=0,this._suitsLv=null),this._suitPoses&&(this._suitPoses.length=0,this._suitPoses=null)},e.prototype.update=function(){this._maxLen||(this._maxLen=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length);var t,e,i,n=[],o=0,s=-1;for(t=0;t<this._maxLen;t++){var r=skillControl.getPuchAwakeLvByPos(t),a=this["equip"+t];if(e=skillControl.getPunchAwakeRedByPos(t),a.name=""+t,a.data={pos:t,lv:r,showRed:e},e&&(-1==s?(s=t,i=r):i>r&&(s=t,i=r)),r){var l=DataCenter.ins().FocusAwakeHitLvConfig[t][r];l.attr&&(n=n.concat(l.attr.concat()))}}n=AttributeData.combineAtts(n);var h=DataCenter.ins().FocusAttackBaseConfig.awakeAttrs,u=h?h.length:0;for(t=0;4>t;t++){var p=this["attrTxt"+t];if(u>t){var c=h[t],d=skillControl.getAttrByType(c,n);d||(d=new AttributeData(c,0)),p.text=AttributeData.getAttStrEx(d)}else p.visible=!1}var g=heroControl.subRolesLen;o=BackpackControl.getAttPowerContainRelate(n),o*=g;var m=skillControl.getPunchAwakeSuitInfo();this._suitPoses=[],this._suitsLv||(this._suitsLv=[]),t=0;var f=[];for(var v in DataCenter.ins().FocusAwakeHitSuitConfig){var y=+v,r=m&&m[y]?m[y]:0,C=DataCenter.ins().FocusAwakeHitSuitConfig[v][r?r:1];if(this["suitTxt"+t].textFlow=TextUtils.generateTextFlow2(LangMgr.getValueByKey("focusTips3",r?10458221:9144715,StringUtils.NumberToChinese(C.level),v,C.skillDes,C.skillValue)),r){f=f.concat(C.attrs.concat());var T=this._suitsLv[y];void 0==T?this._suitsLv[y]=r:r>T&&(this._suitsLv[y]=r,this._suitPoses=skillControl.getPosesBySuitLv(r),this._suitTxtIndex=t,this._suitPoses&&this._suitPoses.length&&this.playSuitMc())}else this._suitsLv[y]=0;var w=this["taozhuang"+t];w.source="suit_"+v,w.filters=r?null:FilterUtils.ARRAY_GRAY_FILTER,t++}if(f=AttributeData.combineAtts(f),f&&f.length)for(t=0;g>t;t++)o+=BackpackControl.getAttPowerContainRelate(f,t);this.powerPanel.setPower(o),-1==this._curPos&&(this._curPos=-1!=s?s:0),this.updateCurPos(),this.monsterImg.source="focusAwake_mon"+this.getBossSourceIndex()+"_png"},e.prototype.updateCurPos=function(){for(var t=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig[0]).length,e=0,i=0;i<this._maxLen;i++)if(this["equip"+i].selected=i==this._curPos,i==this._curPos){for(var n=skillControl.getPuchAwakeLvByPos(i),o=n==t,s=DataCenter.ins().FocusAttackBaseConfig.awakeAttrs,r=s?s.length:0,a=o?null:DataCenter.ins().FocusAwakeHitLvConfig[i][n+1],l=0;4>l;l++){var h=this["addAttTxt"+l],u=this["arrowImg"+l];if(r>l)if(o)h.visible=u.visible=!1;else{var p=s[l],c=skillControl.getAttrByType(p,a.attr);c?(h.text=AttributeData.getAttStrEx(new AttributeData(c.type,c.value),4,1,"",!1,!1),h.visible=u.visible=!0):h.visible=u.visible=!1}else h.visible=u.visible=!1}if(o||((e+=n)?BackpackControl.getAttPowerContainRelate(AttributeData.getBetweenAttrs(DataCenter.ins().FocusAwakeHitLvConfig[i][n].attr,a.attr)):BackpackControl.getAttPowerContainRelate(a.attr)),e?(this.powerTxt.text=""+e,this.arrow.visible=this.powerTxt.visible=!0):this.arrow.visible=this.powerTxt.visible=!1,this.upInfo.visible=!o,this.maxlv.visible=o,!o){var d=BackpackControl.ins().getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,a.cost.id);this.icon.source=DataCenter.ins().ItemConfig[a.cost.id].icon+"_png",this.countLabel.textFlow=TextUtils.generateTextFlow("|C:"+(d>=a.cost.count?65280:16711680)+"&T:"+d+"|/"+a.cost.count),this.redPoint0.visible=this.upGradeBtn.enabled=d>=a.cost.count;var g=skillControl.getWearEquipsData(this._curPos);g&&g.configID||(this.redPoint0.visible=!1),this.costGroup.name=""+a.cost.id}}},e.prototype.onTouch=function(t){switch(t.target){case this.skillBtn:UIMgr.ins().open(FocusAwakeSuitTipsView);break;case this.upGradeBtn:if(this._isPlaying)return;var e=skillControl.getWearEquipsData(this._curPos);e&&e.configID?(skillControl.upPunchAwake(this._curPos),this.playLvUpMc()):tipsControl.showTips(LangMgr.getValueByKey("focusTips4"));break;case this.equip0:case this.equip1:case this.equip2:case this.equip3:case this.equip4:case this.equip5:case this.equip6:case this.equip7:var i=Number(t.target.name);i!=this._curPos&&(this._curPos=i,this.updateCurPos());break;case this.costGroup:UIMgr.ins().open(FocusAwakeMaterialTips2View,+t.target.name);break;case this.AttrBtn:UIMgr.ins().open(FocusAwakeAttsView)}},e.prototype.getBossSourceIndex=function(){var t=skillControl.getCurSuitLv();if(0>=t)return 0;var e=0;for(var i in DataCenter.ins().FocusAttackQmConfig){var n=+i,o=0;for(var s in DataCenter.ins().FocusAttackQmConfig[i])if(o!=+s&&(o=+s,e++,1e4*n+o==t))return e}return 0},e.prototype.playFlyMc=function(){this._isPlaying=!0;for(var t=0;t<this._maxLen;t++){var e=this["equip"+t];egret.Tween.removeTweens(e),e.x=250,e.y=200;var i=this._pos[t];egret.Tween.get(e).to({x:i.x,y:i.y},500,egret.Ease.backOut).call(this.stopPlaying,this)}},e.prototype.playBossMc1=function(){egret.Tween.removeTweens(this.monsterImg),this.monsterImg.scaleX=this.monsterImg.scaleY=2.5,egret.Tween.get(this.monsterImg).to({scaleX:1,scaleY:1},500,egret.Ease.backOut)},e.prototype.playLvUpMc=function(){this._lvUpMC||(this._lvUpMC=ObjectPool.pop("GameMovieClip"));var t=this["equip"+this._curPos];this._lvUpMC.x=t.x,this._lvUpMC.y=t.y,this.equipUps.addChild(this._lvUpMC),this._lvUpMC.playFile(PATH_EFF+"star_enhance_success_1")},e.prototype.initPoses=function(){if(!this._pos||!this._pos.length){this._pos=[],this._maxLen=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length;for(var t=0;t<this._maxLen;t++){var e=this["equip"+t];this._pos.push({x:e.x,y:e.y})}}},e.prototype.playSuitMc=function(){if(!this._isPlaying){this._isPlaying=!0;for(var t=this._suitPoses.length,e=0;t>e;e++){var i=this._suitPoses[e],n=this["equip"+i];egret.Tween.removeTweens(n),n.scaleX=n.scaleY=1,egret.Tween.get(n).to({scaleX:1.2,scaleY:1.2},200).to({scaleX:1,scaleY:1},300).call(this.playSuitMc2,this)
}}},e.prototype.playSuitMc2=function(){this._suitMc||(this._suitMc=ObjectPool.pop("GameMovieClip")),this["exAttr"+this._suitTxtIndex].addChild(this._suitMc),this._suitMc.playFile(PATH_EFF+"refine_attr_eff"),this._suitMc.x=200,this.stopPlaying()},e.prototype.stopPlaying=function(){this._isPlaying=!1},e}(BaseEuiView);__reflect(FocusAwakePanel.prototype,"FocusAwakePanel");var FocusAwakeSuitTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="FocusAwakeSuitTipsViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onClose);var t=skillControl.getPunchAwakeSuitInfo(),e="",i="";for(var n in DataCenter.ins().FocusAwakeHitSuitConfig){var o=+n,s=t&&t[o]?t[o]:0,r=s>=Object.keys(DataCenter.ins().FocusAwakeHitSuitConfig[n]).length,a=void 0;if(s){var l=DataCenter.ins().FocusAwakeHitSuitConfig[n][s];e+=LangMgr.getValueByKey("focusTips2",StringUtils.NumberToChinese(l.level),n,l.skillDes,l.skillValue),r||(a=DataCenter.ins().FocusAwakeHitSuitConfig[n][s+1])}else a=DataCenter.ins().FocusAwakeHitSuitConfig[n][s+1];a&&(i+=LangMgr.getValueByKey("focusTips2",StringUtils.NumberToChinese(a.level),n,a.skillDes,a.skillValue))}""==e?(this.currentState="unactive",this.curTxt.textFlow=TextUtils.generateTextFlow2(i)):""==i?(this.currentState="max",this.curTxt.textFlow=TextUtils.generateTextFlow2(e)):(this.currentState="active",this.curTxt.textFlow=TextUtils.generateTextFlow2(e),this.nextTxt.textFlow=TextUtils.generateTextFlow2(i));for(var h=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length,u="",p=0,c=0;h>c;c++){var d=9144715;skillControl.getPuchAwakeLvByPos(c)&&(d=65280,p++),u+="|C:"+d+"&T:"+DataCenter.ins().FocusAttackBaseConfig.awakeNames[c]+"  |"}this.numLabel0.text="（"+p+"/"+h+"）",this.informationname0.textFlow=TextUtils.generateTextFlow(u)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(FocusAwakeSuitTipsView.prototype,"FocusAwakeSuitTipsView");var FocusAwakeView=function(t){function e(){var e=t.call(this)||this;return e._lastTab=-1,e.skinName="FocusAwakeViewSkin",e.uilayer=GameLayer.MAIN1,e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(707,this.updateRed),this.addCustomEvent(708,this.updateRed),this.addEventChange(this.tab,this.onTab),this.addEventChanging(this.tab,this.onTabing),this.addEventTouchTap(this.closeBtn,this.onClose),this.roleSelect.hideRole(),this.resetTabs(),this.tab.selectedIndex=this.viewStack.selectedIndex=0,this.updateCurTab(),this.updateRed()},e.prototype.close=function(){this.viewStack.selectedChild.close(),this._openedIndex&&(this._openedIndex.length=0,this._openedIndex=null)},e.prototype.resetTabs=function(){this.viewStack.removeChildren(),this._openedIndex=[];for(var t=0;2>t;t++){var e=this.showPage(t);e?(e.name=LangMgr.getValueByKey("focusTab"+t),this.viewStack.addChild(e),this._openedIndex.push(t)):DisplayUtils.removeFromParent(this["redPoint"+t])}},e.prototype.showPage=function(t){switch(t){case e.HEJI:return this.hejiPanel;case e.AWAKE:return this.awakePanel}return null},e.prototype.onTabing=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.onTab=function(){this.updateCurTab()},e.prototype.checkIsOpen=function(t){var i=this._openedIndex[t];switch(i){case e.HEJI:return!0;case e.AWAKE:return reincarnateControl.lv>=DataCenter.ins().FocusAttackBaseConfig.openAwakeZsLv?!0:(tipsControl.showTips(LangMgr.getValueByKey("focusTips1",DataCenter.ins().FocusAttackBaseConfig.openAwakeZsLv)),!1)}return!0},e.prototype.updateCurTab=function(){-1!=this._lastTab&&this.viewStack.getChildAt(this._lastTab).close(),this.viewStack.selectedChild.open(),this._lastTab=this.tab.selectedIndex},e.prototype.updateRed=function(){this.redPoint0.visible=FocusAwakeRedPoint.ins().hejiRed,this.redPoint1.visible=FocusAwakeRedPoint.ins().awakeRed},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.HEJI=0,e.AWAKE=1,e}(BaseEuiView);__reflect(FocusAwakeView.prototype,"FocusAwakeView");var FocusAttackBaseItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FocusAttackBaseItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.validateNow(),this.addEventTouchTap(this,this.onTap);var t=this.data,e=this.wearData=new ItemData;e.configID=t.id,this.addBtn.visible=!1,this.redPoint.visible=!1,this.img.source="",e&&e.itemConfig?this.img.source=""+(e.itemConfig.zsLevel||0)+e.itemConfig.level+"_"+(ItemUtils.getSubType(e.itemConfig)+1)+"_png":this.img.source=""},e.prototype.destruct=function(){this.removeEventTouchTap(this,this.onTap)},e.prototype.onTap=function(){this.wearData&&0!=this.wearData.configID?UIMgr.ins().open(PunchEquipTipsView,this.wearData,!0):UIMgr.ins().open(FocusAttackChooseView,this.data,0)},e}(BaseItemRender);__reflect(FocusAttackBaseItemRenderer.prototype,"FocusAttackBaseItemRenderer");var FocusAttackExchangeBtnItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FocusAttackExchangeBtnItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.btnText.text=this.data.config.name,this.redPoint.visible=skillControl.getPunchExchangePageRedPoint(this.data.index)},e}(BaseItemRender);__reflect(FocusAttackExchangeBtnItemRenderer.prototype,"FocusAttackExchangeBtnItemRenderer");var FocusAttackExchangeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.count=0,e.exchangeNum=0,e.skinName="FocusAttackExchangeItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.goBtn,function(){return e.count<e.exchangeNum?(tipsControl.showTips(LangMgr.getValueByKey("materialEnought1")),void UIMgr.ins().open(ShopWarnView).setData(11==e.data.exchangeMaterial[0].id?909998:909999)):backpackControl.getSurplusCount()<1?void tipsControl.showTips(LangMgr.getValueByKey("osaBackNoSpace")):void skillControl.upExchangeHejiEquip(e.data.id)}),this.addEventTouchTap(this.itemIcon0,this.onClick)},e.prototype.dataChanged=function(){var t=DataCenter.ins().ItemConfig[this.data.getItem.id],e=this.data.exchangeMaterial[0];this.exchangeNum=e.count,11==e.id?this.count=ActorControl.togeatter1:this.count=ActorControl.togeatter2,this.icon.source=Currency.getCurrencyRes(e.id),this.redPoint.visible=skillControl.getPunchExchangeItemRedPoint(this.data.id);this.data.zsLevel>0?LangMgr.getValueByKey("numberRotation",this.data.zsLevel):LangMgr.getValueByKey("numberLevel",this.data.level);this.nameLab.text=t.name;var i=this.count<this.exchangeNum?ColorUtils.RED_COLOR:ColorUtils.GREEN_COLOR;this.descLab.textFlow=(new egret.HtmlTextParser).parser("<font color = '"+i+"'>"+this.count+"</font><font color = '"+LangMgr.getValueByKey("color108")+"'>/"+this.exchangeNum+"</font>"),this.itemConfig=t,this.itemIcon0.setData(t),this.data.zsLevel>0?this.goBtn.visible=reincarnateControl.lv>=this.data.zsLevel:this.goBtn.visible=ActorControl.level>=this.data.level},e.prototype.onClick=function(){if(this.itemConfig)switch(ItemUtils.getType(this.itemConfig)){case 5:UIMgr.ins().open(PunchEquipTipsView,{id:this.itemConfig.id},!1,!0);break;default:tipsControl.showTips(LangMgr.getValueByKey("hijiTips9"))}},e}(BaseItemRender);__reflect(FocusAttackExchangeItemRenderer.prototype,"FocusAttackExchangeItemRenderer");var FocusAttackItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.wearData=null,e.skinName="FocusAttackBaseItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.addEventTouchTap(this,this.onTap),this.addEventTouchTap(this.img,this.onTap),this.addEventTouchTap(this.addBtn,this.onTap);var t=skillControl.equipListData[this.data];if(this.wearData=skillControl.getWearEquipsData(this.data),this.img.source="",this.addBtn.visible=!0,t&&t.itemConfig){var e=ItemUtils.getSubType(t.itemConfig);this.img.source=""+(t.itemConfig.zsLevel||0)+(t.itemConfig.level||1)+"_"+(e+1)+"_png",this.redPoint.visible=skillControl.checkIsHaveBestEquip(e)}else this.img.source="",this.redPoint.visible=skillControl.checkIsHaveBestEquip(this.data)},e.prototype.destruct=function(){this.removeEventTouchTap(this,this.onTap),this.removeEventTouchTap(this.img,this.onTap),this.removeEventTouchTap(this.addBtn,this.onTap)},e.prototype.onTap=function(){UIMgr.ins().open(PunchEquipTipsView,this.wearData&&0!=this.wearData.configID?this.wearData:this.data,!0)},e}(BaseItemRender);__reflect(FocusAttackItemRenderer.prototype,"FocusAttackItemRenderer");var FocusAttackListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FocusAttackListItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.itemConfig){var t=this.data,e=(t.att,DataCenter.ins().EquipConfig[t.configID]),i="",n="";this.now.visible=!1;var o=0;for(var s in AttributeData.translate)if(e[s]&&!(e[s]<=0)){var r=new AttributeData(AttributeData.translate[s],e[s]),a="";a=AttributeData.getAttStrByType(r,0,"  "),i+=o%2==0?StringUtils.complementByChar(a,32):a+"\n",o++}this.attr1.textFlow=(new egret.HtmlTextParser).parser(i),n=e.baseAttr1?AttributeData.getAttStrByType(e.baseAttr1,1,""):AttributeData.getExtAttStrByType(e.exAttr1,1,""),this.attr2.text=n,this.changeBtn.visible=!0,this.nameTxt.text=t.itemConfig.name}},e.prototype.setBtnStatu=function(){this.changeBtn.visible=!1,this.now.visible=!0},e}(BaseItemRender);__reflect(FocusAttackListItemRenderer.prototype,"FocusAttackListItemRenderer");var FocusAttackSkillItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FocusAttackSkillItemRendererSkin",e}return __extends(e,t),e.prototype.setData=function(t){this.iconBG.source=t.id+"_png"},e}(BaseItemRender);__reflect(FocusAttackSkillItemRenderer.prototype,"FocusAttackSkillItemRenderer");var FocusAwakeEquipItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.redPoint.visible=this.data.showRed,this.lvNum.text=this.data.lv,this.awake_names.source="awake_names"+this.data.pos,this.dizuo.source=this.data.lv?"dizuo":"dizuo_hui",this.jieji.source=this.data.lv?"jieji":"jieji_hui",this.num0.visible=!this.data.lv,this.lvNum.visible=!this.num0.visible,this._mc||(this._mc=ObjectPool.pop("GameMovieClip"),this.fuwenEff.addChild(this._mc));var t=PATH_EFF+"punch_awake_eff"+this.data.lv;this._mc.name!=t&&this._mc.playFile(t,-1)},Object.defineProperty(e.prototype,"selected",{set:function(t){this.selectedImg.visible=t},enumerable:!0,configurable:!0}),e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this._mc&&(this._mc.destroy(),this._mc=null)},e}(BaseItemRender);__reflect(FocusAwakeEquipItemRenderer.prototype,"FocusAwakeEquipItemRenderer");var MainScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this,!0),this.addLayer(GameLayer.SCENE1),SDKManager.ins().isHideRechargeShow()||(this.addLayer(GameLayer.SCENE2),this.addLayer(GameLayer.SCENE3),this.addLayer(GameLayer.MAIN1),this.addLayer(GameLayer.MAIN2),this.addLayer(GameLayer.POPUP),this.addLayer(GameLayer.TIPS)),UIMgr.ins().open(GameSceneView),UIMgr.ins().open(RambleMainView),UIMgr.ins().open(GameBottomView),UIMgr.ins().open(TipsView),SoundUtils.ins().stopBg(),EventMgr.ins().dispatch(3),DeviceUtils.IsMobile&&egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPlaySound,this)},e.prototype.onTouchPlaySound=function(){egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onTouchPlaySound,this),SoundUtils.ins().playEffect(SoundUtils.VIEW)},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(MainScene.prototype,"MainScene");var TargetListControl=function(t){function e(){var e=t.call(this)||this;return e.attackMeHandles=[],e.canAttackHandles=[],e.tipsCD=!1,e.masterAtkTarget={},e.addCustomEvent(472,e.attackAndShowTip),e.addCustomEvent(275,e.campChange),e.addCustomEvent(365,e.updateAtkTarget),e.addCustomEvent(353,e.onEnterMap),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.onEnterMap=function(){this.masterAtkTarget={},this.attackMeHandles.length=0,this.canAttackHandles.length=0,this.checkTargetPanel(),TimerMgr.ins().removeAll(this),UIMgr.ins().close(this.targetClass),this.isShow&&(TimerMgr.ins().doTimer(1e3,0,this.update,this),this.update(),UIMgr.ins().open(this.targetClass))},Object.defineProperty(e.prototype,"isShow",{get:function(){return toseongControl.isToseong||campWarControl.isCampWar()||blisterControl.isPaoDian||godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss||darkMysteryBossControl.isDarkBoss||crossBossControl.isKFBossBattle||devildomControl.isDevildomBattle||crossArenaControl.isKFArena||darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss||warriorControl.isWarriorBoss||totemBossControl.inCopy||crazybtplayCopyControl.isShenwujindi||reincarnateStarBossControl.isInFb||BossControl.isBossFb()},enumerable:!0,configurable:!0}),e.prototype.checkTargetPanel=function(){this.targetClass=TargetListView},e.prototype.update=function(){this.isShow?(this.dispatchChangeCanAttackHandle(),this.updateAttackMe()):(TimerMgr.ins().removeAll(this),UIMgr.ins().close(this.targetClass))},e.prototype.campChange=function(){if(campWarControl.isCampWar()){var t=void 0,e=UnitMgr.ins().getAllEntity();for(var i in e)t=e[i],t&&t.infoModel&&1==t.infoModel.type&&(t.setCharName(t.infoModel.guildAndName),t.updateNameColor())}},e.prototype.dispatchChangeCanAttackHandle=function(){var t,e=UnitMgr.ins().getAllEntity();this.canAttackHandles.length=0;var i,n=!1,o=toseongControl.isToseong||godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss||crossBossControl.isKFBossBattle||darkMysteryBossControl.isDarkBoss||devildomControl.isDevildomBattle||crossArenaControl.isKFArena||darkHallBossControl.isDarkHallBoss||crazybtplayCopyControl.isShenwujindi||dominateBossControl.isZhuzaiBoss||reincarnateStarBossControl.isInFb||totemBossControl.inCopy;for(var s in e)if(t=e[s],i=t.infoModel)if(1==i.type)crossArenaControl.isKFArena?i.camp>0&&i.camp!=crossArenaControl.myCampId&&this.updateCanAttackHandle(i.masterHandle,!0):0==t.isSafety()&&i.getAtt(0)>0&&(campWarControl.isCampWar()?i.camp>0&&i.camp!=campWarControl.camp&&this.updateCanAttackHandle(i.masterHandle,!0):devildomControl.isDevildomBattle?(!i.guildID||i.guildID&&i.guildID!=unionControl.guildID)&&this.updateCanAttackHandle(t.infoModel.masterHandle,!0):this.updateCanAttackHandle(i.masterHandle,!0));else if(2==i.type&&i.getAtt(0)>0&&!n){if(o)continue;var r=DataCenter.ins().MonstersConfig[i.configID];if(!r)continue;if(4==r.type||3==r.type||5==r.type)continue;var a=UnitMgr.ins().getRootMasterHandle(i.handle);if(a==ActorControl.handle||!this.checkMonHead(r))continue;-1==DataCenter.ins().CampWarConfig.noAttack.indexOf(i.configID)&&(n=!0,this.updateCanAttackHandle(i.handle,!0,!0))}crossBossControl.isKFBossBattle&&crossBossControl.flagHandle&&crossBossControl.flagTimes>0&&this.updateCanAttackHandle(crossBossControl.flagHandle,!0,!0),EventMgr.ins().dispatch(542)},e.prototype.checkMonHead=function(t){return!Assert(t.head,LangMgr.getValueByKey("babelError1",t.id,t.name))},e.prototype.updateAttackMe=function(){if(RoleModel.isAllDie())return this.dispatchTargetList(0,0),void(this.attackMeHandles.length=0);for(var t=0,e=this.attackMeHandles;t<e.length;t++){var i=e[t],n=UnitMgr.ins().getMasterList(i);if(n&&0!=n.length){for(var o=!0,s=0,r=n;s<r.length;s++){var a=r[s];if(a&&a.infoModel&&a.infoModel.getAtt(0)>0){o=!1;break}}o&&this.dispatchTargetList(i,0)}else this.dispatchTargetList(i,0)}},e.prototype.clear=function(){this.attackMeHandles.length=0,this.canAttackHandles.length=0,gameControl.currAttackHandle=0,bossControl.monsterID=0},e.prototype.updateCanAttackHandle=function(t,e,i){void 0===i&&(i=!1);var n=UnitMgr.ins().getRootMasterHandle(t);if(0!=n&&n!=ActorControl.handle){var o=this.canAttackHandles.indexOf(n);e&&-1==o?i?this.canAttackHandles.unshift(n):this.canAttackHandles.push(n):e||-1==o||this.canAttackHandles.splice(o,1)}},e.prototype.dispatchTargetListEX=function(t,e){if(0!=e){var i=UnitMgr.ins().getEntityByHandle(e)||UnitMgr.ins().getEntityBymasterhHandle(e),n=UnitMgr.ins().getNoDieRole();if(n&&i&&MathUtils.getDistanceByObject(n,i)>(DataCenter.ins().CrazybtplayBossBaseConfig.viewRange||900))return void EventMgr.ins().dispatch(559,[t,e])}this.dispatchTargetList(t,e),EventMgr.ins().dispatch(559,[t,0])},e.prototype.dispatchTargetList=function(t,e){if(0!=t||0!=e){var i=UnitMgr.ins().getRootMasterHandle(t),n=UnitMgr.ins().getRootMasterHandle(e);if(i!=n)if(i==ActorControl.handle){var o=UnitMgr.ins().getEntityByHandle(e);if(o&&o.infoModel&&5==o.infoModel.type);else{if(o&&o.infoModel&&o.infoModel.getAtt(0)>0)if(2==o.infoModel.type){var s=DataCenter.ins().MonstersConfig[o.infoModel.configID];if(s&&(4==s.type||3==s.type||5==s.type?gameControl.dispatchChangeTarget(o.infoModel.masterHandle):gameControl.dispatchChangeTarget(o.infoModel.handle),this.checkShowTargetBlood(n,i),!s.head)){var r="";toseongControl.isToseong&&(r+="isCity = true"),blisterControl.isPaoDian&&(r+="|isPaoDian = true"),campWarControl.isCampWar()&&(r+="|isBattle = true"),godWeaponBossControl.isGwBoss&&(r+="|isGwBoss = true"),godWeaponBossControl.isGwTopBoss&&(r+="|isGwTopBoss = true"),crossBossControl.isKFBossBattle&&(r+="|isKFBossBattle = true"),devildomControl.isDevildomBattle&&(r+="|isDevildomBattle = true"),crossArenaControl.isKFArena&&(r+="|isKFArena = true"),darkMysteryBossControl.isDarkBoss&&(r+="|isDarkBoss = true"),Assert(s.head,"dispatchTargetList The monster head does not exist，id:"+s.id+",name:"+s.name+",fbType:"+MapControl.copyType+",fbId:"+MapControl.copyId+",ms:"+o.infoModel.masterHandle+" "+r)}}else gameControl.dispatchChangeTarget(o.infoModel.masterHandle),this.checkShowTargetBlood(n,i);else gameControl.dispatchChangeTarget(0),UIMgr.ins().close(TargetPlayerBigBloodView);UIMgr.ins().isShow(this.targetClass)&&UIMgr.ins().getView(this.targetClass).showTarget(0!=e)}}else if(0==n){var a=this.attackMeHandles.indexOf(i);-1!=a&&this.attackMeHandles.splice(a,1)}}EventMgr.ins().dispatch(505)},e.prototype.checkShowTargetBlood=function(t,e){t!=ActorControl.handle&&e==ActorControl.handle&&(0==gameControl.currAttackHandle||UIMgr.ins().isShow(TargetPlayerBigBloodView))&&(campWarControl.isCampWar()||blisterControl.isPaoDian?UIMgr.ins().open(TargetPlayerBigBloodView):toseongControl.isToseong&&0==toseongControl.cityBossId&&UIMgr.ins().open(TargetPlayerBigBloodView))},e.prototype.attackAndShowTip=function(t){var e=t[0],i=t[1],n=(t[2],t[3]);if(this.isShow&&e&&i&&!(0>=n)&&(e.isMy||i.isMy)){var o=UnitMgr.ins().getRootMasterHandle(i.infoModel.handle),s=UnitMgr.ins().getRootMasterHandle(e.infoModel.handle);if(s!=ActorControl.handle&&o==ActorControl.handle)return void(0==gameControl.currAttackHandle||UIMgr.ins().isShow(TargetPlayerBigBloodView)||(campWarControl.isCampWar()||blisterControl.isPaoDian?UIMgr.ins().open(TargetPlayerBigBloodView):toseongControl.isToseong&&0==toseongControl.cityBossId&&UIMgr.ins().open(TargetPlayerBigBloodView)));var r=this.attackMeHandles.indexOf(o);-1==r&&s==ActorControl.handle&&o!=ActorControl.handle&&this.masterAtkTarget[o]==s&&(1==i.infoModel.type||4==i.infoModel.type)&&(this.attackMeHandles.push(o),this.attackMeHandles.length>0&&(UIMgr.ins().isShow(this.targetClass)||(UIMgr.ins().open(this.targetClass),toseongControl.dispatchChangeAttStatue(1))),this.dispatchTargetList(0,0)),e.infoModel.isMy&&e.infoModel.getAtt(0)<=0&&!UnitMgr.ins().getNoDieRole()&&UIMgr.ins().isShow(this.targetClass)&&UIMgr.ins().getView(this.targetClass).showTarget(!1)}},e.prototype.updateAtkTarget=function(t){var e=t[0],i=t[1],n=UnitMgr.ins().getRootMasterHandle(e),o=UnitMgr.ins().getRootMasterHandle(i);this.masterAtkTarget[n]=o},e}(BaseSystem);__reflect(TargetListControl.prototype,"TargetListControl");var TargetListView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.SCENE3,e.initSkin(),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list1.name="tar.list1",this.list2.name="tar.list2",this.list3.name="tar.list3",this.list2Dt=new eui.ArrayCollection,this.list2Dt.source=targetListControl.canAttackHandles,this.list2.dataProvider=this.list2Dt},e.prototype.initSkin=function(){this.skinName="TargetListViewSkin",this.list1.itemRenderer=TargetActHeadItemRender,this.list2.itemRenderer=TargetCanActHeadItemRender,this.list3.itemRenderer=TargetActedHeadItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(363,this.updateTarget),this.addCustomEvent(505,this.updateBeAttackList),this.addCustomEvent(542,this.updateCanAttackList),this.update(),this.attackGroup0.visible=!1,this.canAttackGroup0.visible=!1},e.prototype.update=function(){this.updateTarget(),this.updateBeAttackList(),this.updateCanAttackList()},e.prototype.showTarget=function(t){this.attackGroup0.visible=t,this.updateTarget()},e.prototype.updateTarget=function(){if(this.attackGroup0.visible){var t=gameControl.currAttackHandle;if(t)if(this.list1.dataProvider){var e=this.list1.dataProvider;e.replaceAll([t])}else this.list1.dataProvider=new eui.ArrayCollection([t]);else this.attackGroup0.visible=!1}},e.prototype.updateBeAttackList=function(){var t=targetListControl.attackMeHandles;if(this.beAttackGroup0.visible=t.length>0,this.beAttackGroup0.visible)if(this.list3.dataProvider){var e=this.list3.dataProvider;e.replaceAll(t)}else this.list3.dataProvider=new eui.ArrayCollection(t)},e.prototype.updateCanAttackList=function(){if(!crossArenaControl.isKFArena&&!BossControl.isBossFb()){var t=targetListControl.canAttackHandles;this.canAttackGroup0.visible=t.length>0,this.canAttackGroup0.visible&&this.list2Dt.replaceAll(targetListControl.canAttackHandles)}},__decorate([callLater],e.prototype,"updateTarget",null),__decorate([callLater],e.prototype,"updateBeAttackList",null),__decorate([callLater],e.prototype,"updateCanAttackList",null),e}(BaseEuiView);__reflect(TargetListView.prototype,"TargetListView");var TargetPlayerBigBloodView=function(t){function e(){var e=t.call(this)||this;return e.curValue=1,e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TargetPlayerBigBloodViewSkin",this.bloodBar.slideDuration=0,this.grayImg.source="bosshp2",this.grayImgMask=new egret.Rectangle(0,0,this.grayImg.width,this.grayImg.height),this.grayImg.mask=this.grayImgMask,e.GRAYIMG_WIDTH=this.grayImg.width,this.bloodBar.labelDisplay.visible=!1,this.playerBloodGroup.top=campWarControl.isCampWar()||blisterControl.isPaoDian?this.playerBloodGroup.top:60},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(472,this.updateHP),this.addCustomEvent(363,this.updateTarget),this.addCustomEvent(361,this.updateAtt),this.updateTarget()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.grayImgMask&&egret.Tween.removeTweens(this.grayImgMask),this.currAttackHandle=0},e.prototype.changeHp=function(){var t=UnitMgr.ins().getEntitysBymasterhHandle(this.currAttackHandle,1);if(t&&t.length>0){for(var e=t.length,i=0,n=0,o=0,s=0,r=0;e>r;r++){var a=t[r];if(a){var l=a.infoModel.getAtt(0)||0,h=a.infoModel.getAtt(2)||0;i+=l,n+=h;var u=a.infoModel.getAtt(25)||0,p=a.infoModel.getAtt(26)||0;o+=u,s+=p}}campWarControl.isCampWar()&&(i=i/n*100,n=100),this.hudunbloodBar0.maximum=s,this.hudunbloodBar0.value=o,this.bloodBar.maximum=n,this.bloodBar.value=i,this.curValue=Math.floor(i/n*100),this.tweenBlood()}else{var c=UnitMgr.ins().getEntityByHandle(this.currAttackHandle);c&&c.infoModel&&2==c.infoModel.type&&(this.hudunbloodBar0.maximum=c.infoModel.getAtt(26)||0,this.hudunbloodBar0.value=c.infoModel.getAtt(25)||0,this.bloodBar.maximum=c.infoModel.getAtt(2)||0,this.bloodBar.value=c.infoModel.getAtt(0)||0,this.curValue=Math.floor(this.bloodBar.value/this.bloodBar.maximum*100),this.tweenBlood())}},e.prototype.updateTarget=function(){if(0==gameControl.currAttackHandle&&UIMgr.ins().close(this),0!=this.currAttackHandle&&this.currAttackHandle!=gameControl.currAttackHandle&&(this.currAttackHandle=gameControl.currAttackHandle,0!=this.currAttackHandle)){var t=void 0,e=UnitMgr.ins().getEntitysBymasterhHandle(this.currAttackHandle,1);if(e&&e.length>0){t=e[0].infoModel;var i=t.name,n=i.split("\n");i=n[1]?n[1]:n[0],this.nameTxt.textFlow=TextUtils.generateTextFlow(i),this.head.source="yuanhead"+t.job+t.sex,this.changeHp()}else{var o=UnitMgr.ins().getEntityByHandle(this.currAttackHandle);if(o&&o.infoModel&&2==o.infoModel.type){var s=DataCenter.ins().MonstersConfig[o.infoModel.configID];this.nameTxt.textFlow=(new egret.HtmlTextParser).parser(s.name),this.head.source="monhead"+s.head+"_png",this.changeHp()}}}},e.prototype.updateHP=function(t){if(toseongControl.isToseong||campWarControl.isCampWar()||blisterControl.isPaoDian||godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss){var e=t[0];t[1],t[2],t[3];!e||e.infoModel.masterHandle!=this.currAttackHandle&&e.infoModel.handle!=this.currAttackHandle||this.changeHp()}},e.prototype.updateAtt=function(t){t&&t.infoModel&&(toseongControl.isToseong||campWarControl.isCampWar()||blisterControl.isPaoDian)&&(t.infoModel.masterHandle==this.currAttackHandle||t.infoModel.handle==this.currAttackHandle)&&this.changeHp()},e.prototype.tweenBlood=function(){var t=this,i=this.curValue*e.GRAYIMG_WIDTH/100,n=this;if(egret.Tween.removeTweens(this.grayImgMask),!(3>i)){var o=egret.Tween.get(this.grayImgMask,{onChange:function(){n.grayImg&&(n.grayImg.mask=t.grayImgMask)}},n);o.to({width:i-3},1e3).call(function(){0>=i&&(n.grayImgMask.width=0,egret.Tween.removeTweens(this.grayImgMask),UIMgr.ins().close(this))},n)}},e.GRAYIMG_WIDTH=0,e}(BaseEuiView);__reflect(TargetPlayerBigBloodView.prototype,"TargetPlayerBigBloodView");var TargetActedHeadItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateChar=function(e){t.prototype.updateChar.call(this,e),this.roleName.textColor=16711680},e}(TargetMemberHeadItemRender);__reflect(TargetActedHeadItemRender.prototype,"TargetActedHeadItemRender");var TargetActHeadItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateChar=function(e){t.prototype.updateChar.call(this,e),this.roleName.textColor=16711680},e}(WorldBossHeadItemRender);__reflect(TargetActHeadItemRender.prototype,"TargetActHeadItemRender");var TargetCanActHeadItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateChar=function(e){if(t.prototype.updateChar.call(this,e),e instanceof UnitRole){var i=e.infoModel;this.roleName.textColor=i.guildID&&i.guildID==unionControl.guildID?65280:13746831}},e}(TargetMemberHeadItemRender);__reflect(TargetCanActHeadItemRender.prototype,"TargetCanActHeadItemRender");var AmusementUniversalView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[1],n=AmusementControl.ins(),o=PAmusementControl.ins(),s=n.activityData;for(var r in s)if(s[r]&&s[r].pageType==i&&n.getAmusementDataById(+r).isOpenActivity())return!0;s=o.activityData;for(var r in s)if(s[r]&&s[r].pageType==i&&o.getAmusementDataById(+r).isOpenActivity())return!0;return tipsControl.showTips(LangMgr.getValueByKey("activitShow3")),!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.actId=t[0]||0,null!=t[1]&&(this.pageType=t[1]),null!=t[2]&&(this.skinName=t[2]),null!=t[3]&&(this.title.source=t[3]),this.updateView(this.pageType),this.menuList.itemRenderer=AmusementBtnItemRender,this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventChange(this.menuList,this.onClickMenu),this.addEventTouchTap(this.leftBtn,this.onTouchBtn),this.addEventTouchTap(this.rightBtn,this.onTouchBtn),this.addEventTouchTap(this.seeRule,this.onClick),this.addEventChange(this.menuScroller,this.onChange),this.addCustomEvent(4,this.zeroUpdate),this.addCustomEvent(395,this.ChangePageCallBack),this.addCustomEvent(403,this.updatePanel),this.addCustomEvent(440,this.updatePanel),this.addCustomEvent(439,this.ChangePageCallBack),this.addCustomEvent(392,this.refushRedPoint),this.addCustomEvent(437,this.refushRedPoint),this.addCustomEvent(178,this.refushRedPoint),this.addCustomEvent(180,this.refushRedPoint),this.addCustomEvent(446,this.refushRedPoint),this.addCustomEvent(182,this.refushRedPoint),this.addCustomEvent(400,this.refushRedPoint),this.addCustomEvent(401,this.refushRedPoint),this.addCustomEvent(266,this.refushRedPoint),this.addCustomEvent(267,this.refushRedPoint),this.addCustomEvent(268,this.refushRedPoint)},e.prototype.refushRedPoint=function(){this.dataArr.replaceAll(this.BtnArr),this.menuList.dataProvider=this.dataArr},e.prototype.getDataUpdataView=function(){var t=AmusementControl.ins(),e=PAmusementControl.ins();for(var i in t.activityData)if(t.activityData[i]&&t.activityData[i].pageType==this.pageType&&t.getAmusementDataById(+i).isOpenActivity()){var n=t.getbtnInfo(i);if(!n||n.activityType&&2==n.activityType)continue;Assert(n,"AmusementControl  data   "+i)||this._datas.push(n)}for(var i in e.activityData)if(e.activityData[i]&&e.activityData[i].pageType==this.pageType&&e.getAmusementDataById(+i).isOpenActivity()){var n=e.getbtnInfo(i);if(!n||n.activityType&&2==n.activityType)continue;Assert(n,"PAmusementControl  data   "+i)||this._datas.push(n)}},__decorate([callDelay(100)],e.prototype,"refushRedPoint",null),e}(AmusementBaseView);__reflect(AmusementUniversalView.prototype,"AmusementUniversalView");var GameBlackView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.SCENE2,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.black=new eui.Rect,this.black.fillColor=LangMgr.getColor("color67"),this.black.left=0,this.black.right=0,this.black.top=0,this.black.bottom=0,this.addChild(this.black)},e}(BaseEuiView);__reflect(GameBlackView.prototype,"GameBlackView");var GameBottomView=function(t){function e(){var e=t.call(this)||this;return e.lastLevel=0,e.flyExpLevel=[],e.canClick=!0,e._shap=new egret.Shape,e.radius=0,e._curAngle=0,e._toAngle=0,e._oldAngle=360,e.ignoreLeak=!0,e.touchEnabled=!1,e.isPlayAnima=!1,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GameBottomViewSkin",this.resident=!0,this.touchEnabled=!1,this.hPGroup.touchEnabled=!0,this.expBar.slideDuration=0,this.navBtn=[this.roleBtn,this.furnaceBtn,this.taskBtn,this.forgingBtn,this.bagBtn,this.hanghui];for(var e=0;e<this.navBtn.length;e++)this.navBtn[e]&&(this.navBtn[e].redPoint.visible=!1);this.navBind=[RoleView,SkillView,ExperienceView,IntensifyView,BackpackView],this.hpBall=new GameMovieClip,this.hpBall.mask=new egret.Rectangle(-52.5,-53,80,106),this.hpBall.x=69,this.hpBall.y=45,this.mpBall=new GameMovieClip,this.mpBall.mask=new egret.Rectangle(-32.5,-53,88,106),this.mpBall.x=51,this.mpBall.y=45,this.hpLineMc=new GameMovieClip,this.hpLineMc.x=50,this.hpLineMc.y=0,this.hpLineMc.mask=this.hpMask,this.mpLineMc=new GameMovieClip,this.mpLineMc.x=80,this.mpLineMc.y=0,this.mpLineMc.mask=this.mpMask,this.hjMc=new GameMovieClip,this.hjMc.x=41,this.hjMc.y=41,this.hjMc.touchEnabled=!1,this.circleImg=new GameMovieClip,this.circleImg.x=41,this.circleImg.y=41,this.circleImg.touchEnabled=!1,this.taskItemImg=new eui.Image,this.taskItemImg.x=250,this.taskItemImg.y=730,this.taskItemImg.visible=!1,this.flyItemGroup.addChild(this.taskItemImg),this.backMc=new GameMovieClip,this.backMc.x=50,this.backMc.y=50,this.isExitUsedItem=!1,this.isItemCountChange=!1,this.backBtnGroup.visible=!1,this.powerGroup.visible=!0,this.circleImg.touchEnabled=!1,this.backBtnGroup.touchEnabled=this.backMc.touchEnabled=!1
},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this.lastLevel=ActorControl.level||0;for(var n=0;n<this.navBtn.length;n++)this.navBtn[n]&&this.addEventTouchTap(this.navBtn[n],this.onClick);this.shopBtn&&this.addEventTouchTap(this.shopBtn,function(){UIMgr.ins().open(StoreView)}),this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.powerGroup,this.onClick),this.addEventTouchTap(this.lockImg,this.onClick),this.addCustomEvent(453,this.expChange),this.addCustomEvent(454,this.expChange),this.addCustomEvent(586,this.showRoleBtnRedPoint),this.addCustomEvent(358,this.updateHuShen),this.addCustomEvent(354,this.updateHuShen),this.addCustomEvent(355,this.readyUpdateHp),this.addCustomEvent(355,this.flyGQBossExpToBar),this.addCustomEvent(354,this.readyUpdateHp),this.addCustomEvent(95,this.runItem),this.addCustomEvent(269,this.showBagBtnRedPoint),this.addCustomEvent(587,this.showForgingBtnRedPoint),this.addCustomEvent(270,this.setBagTips),this.addCustomEvent(272,this.setIsExitUsedItem),this.addCustomEvent(300,this.onBossAppear),this.addCustomEvent(593,this.onMonsterSpeak),this.addCustomEvent(594,this.flyExpToBar),this.addCustomEvent(510,this.onFightResult),this.addCustomEvent(218,this.startUpdateRedPoint),this.addCustomEvent(233,this.startUpdateRedPoint),this.addCustomEvent(266,this.startUpdateRedPoint),this.addCustomEvent(112,this.startUpdateRedPoint),this.addCustomEvent(461,this.startUpdateRedPoint),this.addCustomEvent(456,this.startUpdateRedPoint),this.addCustomEvent(83,this.startUpdateRedPoint),this.addCustomEvent(262,this.startUpdateRedPoint),this.addCustomEvent(258,this.startUpdateRedPoint),this.addCustomEvent(259,this.startUpdateRedPoint),this.addCustomEvent(260,this.startUpdateRedPoint),this.addCustomEvent(261,this.startUpdateRedPoint),this.addCustomEvent(473,this.checkViewOpen),this.addCustomEvent(266,this.setLilianRedPoint),this.addCustomEvent(32,this.setLilianRedPoint),this.addCustomEvent(33,this.setLilianRedPoint),this.addCustomEvent(90,this.setLilianRedPoint),this.addCustomEvent(46,this.setLilianRedPoint),this.addCustomEvent(45,this.setLilianRedPoint),this.addCustomEvent(499,this.setLilianRedPoint),this.addCustomEvent(461,this.setLilianRedPoint),this.addCustomEvent(35,this.setLilianRedPoint),this.addCustomEvent(267,this.setLilianRedPoint),this.addCustomEvent(704,this.setLilianRedPoint),this.addCustomEvent(595,this.resetHejiCd),this.addCustomEvent(596,this.resetHejiCd),this.addCustomEvent(85,this.checkHejiOpen),this.addCustomEvent(36,this.lilianRewardFlash),this.addCustomEvent(17,this.setRedPiont),this.addCustomEvent(20,this.setRedPiont),this.addCustomEvent(475,this.flyItemToBag),this.addCustomEvent(476,this.flyItemToBagEx),this.addCustomEvent(177,this.setRedPiont),this.addCustomEvent(266,this.setRedPiont),this.addCustomEvent(268,this.setRedPiont),this.addCustomEvent(267,this.setRedPiont),this.addCustomEvent(353,this.cleanPowerGuilderEff),this.hpBall.playFile(PATH_EFF+"hpeff",-1),this.mpBall.playFile(PATH_EFF+"mpeff",-1),this.hPGroup.addChildAt(this.hpBall,0),this.hPGroup.addChildAt(this.mpBall,0),this.hpLineMc.playFile(PATH_EFF+"hpsxeff",-1),this.mpLineMc.playFile(PATH_EFF+"mpsxeff",-1),this.hPGroup.addChildAt(this.hpLineMc,0),this.hPGroup.addChildAt(this.mpLineMc,0),this.powerGroup.addChildAt(this.circleImg,1),this.powerGroup.addChild(this._shap),this.circleImg.mask=this._shap,this.checkHejiOpen(),skillControl.hejiLevel>0&&skillControl.dispatchHejiStartCD(),this.startUpdateRedPoint(),this.showForgingBtnRedPoint()},e.prototype.checkHejiOpen=function(){skillControl.hejiLevel>0?(this.powerGroup.touchEnabled=!0,this.circleImg.playFile(PATH_EFF+"hejianniueff",-1),this.powerImg.visible=!0,this.lockImg.visible=!1,this.powerImg.source=skillControl.getHejiSkillIdIcon(),this.powerImg.scaleX=.55,this.powerImg.scaleY=.55):(this.powerGroup.touchEnabled=!1,this.powerImg.visible=!1,this.lockImg.visible=!0)},e.prototype.checkViewOpen=function(t){void 0===t&&(t=0),1==t?(this.backBtnGroup.visible=!0,this.powerGroup.visible=!1,this.backMc.parent||(this.backMc.playFile(PATH_EFF+"fanhuibtneff",-1),this.backBtnGroup.addChild(this.backMc))):(this.backBtnGroup.visible=!1,this.powerGroup.visible=!0,DisplayUtils.removeFromParent(this.backMc)),this.checkShowHejiIcon(t)},e.prototype.checkShowHejiIcon=function(t){2==artifactControl.openHeji&&(0==t?TimerMgr.ins().doTimer(50,1,this.showHejiIcon,this):TimerMgr.ins().remove(this.showHejiIcon,this))},e.prototype.showHejiIcon=function(){if(2==artifactControl.openHeji&&skillControl.hejiLevel>0){var t=heroControl.getSubRoleByIndex(0);if(!t)return;artifactControl.openHeji=-1;var e=t.job,i=DataCenter.ins().FocusAttackConfig[skillControl.hejiLevel],n=new SkillVo(i.skill_id[e-1]),o=new eui.Image(n.id+"_png");o.anchorOffsetX=32,o.anchorOffsetY=32,o.scaleX=4,o.scaleY=4,o.x=this.width/2,o.y=this.height/2,this.addChild(o);var s=this.powerGroup.x+this.powerGroup.width/2,r=this.powerGroup.y+this.powerGroup.height/2;egret.Tween.get(o).to({scaleX:1,scaleY:1},200).to({x:s,y:r},600).to({scaleX:0,scaleY:0},200).call(function(){o.parent.removeChild(o)})}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];egret.Tween.removeTweens(this),TimerMgr.ins().removeAll(this)},e.prototype.showRoleBtnRedPoint=function(t){this.roleBtn.redPoint.visible=t>0},e.prototype.showBagBtnRedPoint=function(t){this.isItemCountChange=t>0,this.setRedPiont()},e.prototype.showForgingBtnRedPoint=function(){this.forgingBtn.redPoint.visible=IntensifyRedPoint.ins().redPoint},e.prototype.setLilianRedPoint=function(){var t=ExperienceControl.ins(),e=experienceControl.getMedalIsMaxLevel(),i=t.getKnightthoodStast()||artifactControl.showRedPoint()||t.checkMedalOpen()&&t.getMedalIsUpGrade()&&!e||artifactControl.showRedPoint()||BookRedPoint.ins().redPoint||t.checkJadeRed()||BookRedPoint.ins().danRed;this.taskBtn.redPoint.visible=i},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:SoundUtils.ins().playEffect(SoundUtils.VIEW);var e=UIMgr.ins().getView(RoleView);e&&e.getWingPanelInfo()?e.doOpenHintWin(2):UIMgr.ins().closeLastTopView();break;case this.lockImg:tipsControl.showTips(LangMgr.getValueByKey("sceneTips2",SkillControl.ACTIVE_LEVEL));break;case this.powerImg:case this.powerGroup:if(skillControl.hejiLevel<=0)return;if(!this.hjMc||!this.hjMc.parent)return void tipsControl.showTips(LangMgr.getValueByKey("sceneTips3"));this.cleanPowerGuilderEff();var i=this.useHejiSkill();-1==i?tipsControl.showTips(LangMgr.getValueByKey("sceneTips4")):-2==i?tipsControl.showTips(LangMgr.getValueByKey("sceneTips5")):-3==i&&tipsControl.showTips(LangMgr.getValueByKey("sceneTips6"));break;case this.hanghui:ActorControl.level>=DataCenter.ins().UnionConfig.openLevel?void 0==unionControl.guildID||0==unionControl.guildID?UIMgr.ins().open(UnionApplyView):UIMgr.ins().open(UnionMapView):(this.hanghui.selected=!1,tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().UnionConfig.openLevel)));break;default:var n=this.navBtn.indexOf(t.currentTarget);if(this.navBtn[n].selected){var o=this.openWindow(n);o||(this.navBtn[n].selected=!1)}else this.closeWindow(n);for(var s=0;s<this.navBtn.length;s++)n!=s&&this.navBtn[s]&&this.closeWindow(s)}},e.prototype.useHejiSkill=function(){if(skillControl.hejiEnable&&this.canClick){var t=skillControl.getHejiSkillId(),e=UnitMgr.ins().getNoDieRole();if(!e)return;var i=UnitMgr.ins().screeningTargetByPos(e,!1,t.affectCount,t.castRange);if(!i||0==i.length)return-1;if(14==MapControl.copyType||10==MapControl.copyType||7==MapControl.copyType||105==MapControl.copyType||17==MapControl.copyType||toseongControl.isToseong||godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss||campWarControl.isCampWar()||blisterControl.isPaoDian||crossArenaControl.isKFArena||crossBossControl.isKFBossBattle||darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss||crazybtplayCopyControl.isShenwujindi||totemBossControl.inCopy||reincarnateStarBossControl.isInFb){var n=gameControl.currHandle,o=UnitMgr.ins().getEntityByHandle(n);if(!n||!o||o.infoModel.getAtt(0)<=0)return-2}if(this.canClick=!1,TimerMgr.ins().doTimer(50,1,this.setClickDelay,this),0==MapControl.copyId||mineControl.inCopy)skillControl.fieldUse=!0;else{for(var s=heroControl.subRolesLen,r=void 0,a=!1,l=0;s>l&&(r=UnitMgr.ins().getMainRole(l),!(r&&r.infoModel&&r.infoModel.getAtt(0)>0));l++);if(r.hasEffById(1)&&(a=!0),a||r.hasBuff(51001)||r.hasBuff(14001)||r.hasBuff(70001))return-3;skillControl.upUseHejiSkill()}}},e.prototype.setClickDelay=function(){this.canClick=!0},e.prototype.openWindow=function(t){return crossFieldControl.checkIsKFBattle(LangMgr.getValueByKey("sceneTips7"))?void 0:UIMgr.ins().open(this.navBind[t])},e.prototype.closeWindow=function(t){UIMgr.ins().isShow(this.navBind[t])&&UIMgr.ins().close(this.navBind[t])},e.prototype.expChange=function(t,e){var i=this;if(void 0===e&&(e=!1),e||1!=MapControl.copyType&&9!=MapControl.copyType){this.lastLevel||(this.lastLevel=ActorControl.level);var n=0==this.flyExpLevel.length;this.flyExpLevel.length?(this.flyExpLevel[this.flyExpLevel.length-1][0]=ActorControl.level,this.flyExpLevel[this.flyExpLevel.length-1][1]=ActorControl.exp):this.flyExpLevel.push([ActorControl.level,ActorControl.exp]);var o=this.flyExpLevel[0][0],s=this.flyExpLevel[0][1];if(this.lastLevel<o){if(!this.expBar.tween_count||n){var r=DataCenter.ins().RoleExpConfig[this.lastLevel].exp;egret.Tween.removeTweens(this.expBar);var a=egret.Tween.get(this.expBar);a.to({value:this.expBar.maximum},300).wait(100).call(function(){i.expBar.maximum=r,i.expBar.value=0,i.lastLevel+=1,gameControl.dispatchLevelBarChange(i.lastLevel),SoundUtils.ins().playEffect(SoundUtils.UPGRADE),i.expChange()},this)}}else{egret.Tween.removeTweens(this.expBar);var l=DataCenter.ins().RoleExpConfig[o].exp;this.expBar.maximum!=l&&(this.expBar.maximum=l);var a=egret.Tween.get(this.expBar);a.to({value:s},400),this.flyExpLevel.shift()}}},e.prototype.closeNav=function(t){this.navBtn[t]&&(this.navBtn[t].selected=!1)},e.prototype.updateHuShen=function(t){if(!t||0==t.team){for(var e,i=heroControl.subRolesLen,n=0,o=0,s=0;i>s;s++)e=heroControl.getSubRoleByIndex(s),n+=e.getAtt(1),o+=e.getAtt(3);var r=this.mpBall.mask;n>o&&(n=o),r.y=-53+106*(1-n/o),this.mpBall.mask=r,this.mpLineMc.y=r.y+35}},e.prototype.onBossAppear=function(){38!=MapControl.copyType&&this.showEffectTips("bosstishi")},e.prototype.onMonsterSpeak=function(t){this.showEffectTips(t)},e.prototype.onFightResult=function(t){t?this.showEffectTips("pktishi_png"):this.showEffectTips("pktishi1_png")},e.prototype.showEffectTips=function(t){var e=this;this.tips.source=t,egret.Tween.removeTweens(this.tips),this.tips.visible=!0,this.tips.alpha=1,egret.Tween.get(this.tips).wait(4e3).to({alpha:0},1e3).call(function(){e.tips.visible=!1})},e.prototype.readyUpdateHp=function(t){if(t){if(t instanceof UnitModel){if(!t.isMy)return}else if(!t[0].isMy)return;this.updateHp()}},e.prototype.updateHp=function(){for(var t=heroControl.subRolesLen,e=0,i=0,n=0;t>n;n++){var o=heroControl.getSubRoleByIndex(n);if(o){var s=o.getAtt(0)||0,r=o.getAtt(2)||0;e+=s,i+=r}}var a=this.hpBall.mask;e>i&&(e=i),a.y=-53+106*(1-e/i),this.hpBall.mask=a,this.hpLineMc.y=a.y+35},e.prototype.lilianUpgradeSuccess=function(t){for(var e=this,i=function(i){var n=new eui.Image;n.source=t[i],n.x=261+63*i,n.y=200,e.addChild(n),n.visible=!1;var o=egret.Tween.get(n);o.wait(130*i).to({visible:!0},1).to({x:326,y:730},900).call(function(){e.removeChild(n)})},n=0;3>n;n++)i(n)},e.prototype.lilianGetRankSuccess=function(t){var e=this,i=new eui.Image;i.source=t,i.x=260,i.y=100,this.addChild(i);var n=egret.Tween.get(i);n.to({x:326,y:730},1e3).call(function(){e.removeChild(i)})},e.prototype.runItem=function(){var t=taskControl.taskTrace,e=taskControl.getAchieveConfById(t.id).awardList;this.runStrat(e,0)},e.prototype.runStrat=function(t,e){var i=this,n="";if(0==t[e].type)switch(t[e].id){case 0:n="";break;case 1:n="icgoods117_png";break;case 2:n="icgoods121_png"}else n=t[e].id+"_png";this.taskItemImg.visible=!0,this.taskItemImg.source=n;var o=this;this.tweenTaskObj||(this.tweenTaskObj={get factor(){return 0},set factor(t){o.taskItemImg.x=(1-t)*(1-t)*250+2*t*(1-t)*380+t*t*426,o.taskItemImg.y=(1-t)*(1-t)*730+2*t*(1-t)*630+t*t*820}}),egret.Tween.removeTweens(this.tweenTaskObj);var s=egret.Tween.get(this.tweenTaskObj);s.to({factor:1},400).call(function(){if(i.taskItemImg.visible=!1,t.length>++e){var n=heroControl.getSubRoleByIndex(0);t[e].job?t[e].job==n.job&&i.runStrat(t,e):i.runStrat(t,e)}},this)},e.prototype.setBagTips=function(t){return this.bagBtn.visible?(this.groupBagTips.visible=t>0,void(t&&(2==t?this.tipsText.text=LangMgr.getValueByKey("sceneTips9"):this.tipsText.text=LangMgr.getValueByKey("sceneTips8")))):void(this.groupBagTips.visible=!1)},e.prototype.setIsExitUsedItem=function(t){this.isExitUsedItem=backpackControl.getIsExitUsedItem(),this.setRedPiont()},e.prototype.setRedPiont=function(t){return t?void(this.bagBtn.redPoint.visible=t):void(this.isExitUsedItem||this.isItemCountChange||backpackControl.getBagGoodsCountByType(8)||backpackControl.getBagGoodsCountByType(12)||backpackControl.getRuneBagGoodsCountByType(8)||pieceControl.isOpen()&&pieceControl.redPoint()||backpackControl.getDamageBagGoodsCountByType()?this.bagBtn.redPoint.visible=!0:this.bagBtn.redPoint.visible=!1)},e.prototype.resetHejiCd=function(){this.reset(),DisplayUtils.removeFromParent(this.hjMc),this._shap.graphics.clear(),TimerMgr.ins().isExists(this.showAni,this)||TimerMgr.ins().doTimer(500,0,this.showAni,this),this.drawProgress(0)},e.prototype.reset=function(){this._curAngle=0,this._toAngle=0,this._oldAngle=360,skillControl.hejiEnable=!1,skillControl.fieldUse=!1,this.radius=this.powerGroup.width>>1},e.prototype.showAni=function(){var t=skillControl.getHejiSkillId(),e=1-(skillControl.hejiCD-GameServer.serverTime)/(t.cd-skillControl.reduceCD),i=360*e;this.drawProgress(i)},e.prototype.drawProgress=function(t,e){return void 0===e&&(e=!0),t>360&&(t=360),0>t&&(t=0),0==t||360==this.curAngle?(360==this.curAngle&&(skillControl.hejiEnable=!0,this.addAutoUse(),this.addPowerEff()),void egret.Tween.removeTweens(this)):(this.removeAutoUse(),this._toAngle=t,this._shap.x=this._shap.y=this.radius,this._shap.rotation=-90,egret.Tween.removeTweens(this),void egret.Tween.get(this).to({curAngle:this._toAngle},500).call(function(){360==this.curAngle&&(skillControl.hejiEnable=!0,this.addAutoUse())},this))},e.prototype.addPowerEff=function(){this.hjMc.playFile(PATH_EFF+"hejibtn",-1),this.hjMc&&this.hjMc.parent||(this.powerGroup.addChild(this.hjMc),this.powerGuilderEff())},e.prototype.powerGuilderEff=function(){if(copyControl.guanqiaID>16)return void this.cleanPowerGuilderEff();if(!copyControl.pkGqboss)return void this.cleanPowerGuilderEff();if(!this.arrow){this.arrow=new GuideArrow,this.arrow.touchEnabled=!1,this.arrow.lab.text=LangMgr.getValueByKey("scentPlaySkill"),this.powerGroup.addChild(this.arrow),this.arrow.x=0,this.arrow.y=this.powerGroup.height/2,this.eff||(this.eff=new GameMovieClip,this.eff.playFile(PATH_EFF+"guideff",-1),this.powerGroup.addChild(this.eff),this.eff.x=this.powerGroup.width/2,this.eff.y=this.powerGroup.height/2);var t=this;egret.Tween.get(this.arrow,{loop:!0}).to({x:this.arrow.x+40},1e3).to({x:this.arrow.x},1e3),egret.Tween.get(this.powerGroup,{loop:!1}).wait(5e3).call(function(){t.cleanPowerGuilderEff()})}},e.prototype.cleanPowerGuilderEff=function(){this.arrow&&egret.Tween.removeTweens(this.arrow),this.eff&&egret.Tween.removeTweens(this.eff),DisplayUtils.removeFromParent(this.arrow),DisplayUtils.removeFromParent(this.eff),this.removeAutoUse(),this.arrow=null,this.eff=null},e.prototype.addAutoUse=function(){skillControl.hejiEnable&&this.checkIsAutoUse()&&(TimerMgr.ins().isExists(this.autoUseHeji,this)||TimerMgr.ins().doTimer(400,0,this.autoUseHeji,this))},e.prototype.checkIsAutoUse=function(){if(MapControl.autoPunch()){var t=gameControl.currHandle,e=UnitMgr.ins().getEntityByHandle(t),i=e&&5!=e.infoModel.type&&ServerStorage.ins().getValue(15);if(i)return i}return ServerStorage.ins().getBitBool(ClientSetBit.auto_heji)&&17!=MapControl.copyType&&19!=MapControl.copyType&&7!=MapControl.copyType&&105!=MapControl.copyType&&10!=MapControl.copyType&&14!=MapControl.copyType&&30!=MapControl.copyType&&32!=MapControl.copyType&&57!=MapControl.copyType&&56!=MapControl.copyType&&!toseongControl.isToseong&&!campWarControl.isCampWar()&&!blisterControl.isPaoDian&&!godWeaponBossControl.isGwBoss&&!godWeaponBossControl.isGwTopBoss&&!darkMysteryBossControl.isDarkBoss&&!darkHallBossControl.isDarkHallBoss&&!dominateBossControl.isZhuzaiBoss},e.prototype.removeAutoUse=function(){TimerMgr.ins().remove(this.autoUseHeji,this)},e.prototype.autoUseHeji=function(){this.useHejiSkill()},Object.defineProperty(e.prototype,"curAngle",{get:function(){return this._curAngle},set:function(t){this._curAngle=t,DisplayUtils.drawCir(this._shap,this.radius,this._curAngle)},enumerable:!0,configurable:!0}),e.prototype.jingMaiCanUp=function(){var t;for(var e in heroControl.roles)if(t=heroControl.roles[e].jingMaiData,t.jingMaiCanUp()){var i=DataCenter.ins().MeridiansCommonConfig.openLevel;if(ActorControl.level>=i)return!0}return!1},e.prototype.getToggleBtn=function(t){return this.validateNow(),this.navBtn[t]},e.prototype.lilianRewardFlash=function(t){for(var e=this,i=t.length,n=function(i){var n=new eui.Image;n.source=t[i],n.x=74+91*i,n.y=260,e.addChild(n),n.visible=!1,n.scaleX=n.scaleY=1;var o=egret.Tween.get(n);o.wait(130*i).to({visible:!0},1).to({x:441,y:872,scaleX:.6,scaleY:.6},900).call(function(){e.removeChild(n)})},o=0;i>o;o++)n(o)},e.prototype.startUpdateRedPoint=function(){TimerMgr.ins().isExists(this.updateRedPoint,this)||TimerMgr.ins().doTimer(50,1,this.updateRedPoint,this)},e.prototype.updateRedPoint=function(){var t=!1;copyControl.guanqiaID>2&&(CommonFun.andState(skillControl.canGrewupSkill())||calcForceControl.canUp()||this.jingMaiCanUp())&&(t=!0),t||(t=esotericaControl.isMjiSum()),t||(t=ashtarteControl.checkRedPoint()),this.furnaceBtn.redPoint.visible=t,this.hanghui&&(this.hanghui.redPoint.visible=UnionRedPoint.ins().hanghui&&ActorControl.level>=DataCenter.ins().UnionConfig.openLevel)},e.prototype.getBagBtn=function(){return this.bagBtn},e.prototype.flyGQBossExpToBar=function(t){var e=this,i=(t[0],t[1]);if(!(MapControl.copyType||i>0)){var n=new eui.Image;n.source="point2",n.anchorOffsetX=20,n.anchorOffsetY=20,n.x=100,n.y=100,this.addChild(n);var o=Math.ceil(StageUtils.ins().getWidth()/2),s=Math.ceil(StageUtils.ins().getHeight())+60,r=egret.Tween.get(n);r.to({x:o,y:s,alpha:.5},800).call(function(){e.removeChild(n),egret.Tween.removeTweens(n)},this);var a=egret.Tween.get(n,{loop:!0});a.to({rotation:n.rotation+360},800)}},e.prototype.flyExpToBar=function(t){for(var e=this,i=t[0],n=t[1],o=t[2],s=this.globalToLocal(i.x,i.y),r=this.expBar.x+this.expBar.width/2,a=this.expBar.y,l=new egret.Point(r,a),h=function(t){var i=egret.Point.interpolate(s,l,MathUtils.limit(.2,.8));i.x+=MathUtils.limitInteger(-100,100),i.y+=MathUtils.limitInteger(-100,100);var n=new eui.Image;n.source="point2",n.anchorOffsetX=20,n.anchorOffsetY=20,n.x=s.x,n.y=s.y,u.addChild(n);var r=BezierWarp.pop(s,l);r.display=n,r.centerPoint=i,r.start(1e3,function(){BezierWarp.push(r),e.removeChild(n),egret.Tween.removeTweens(n),t||e.expChange(0,!0)},u,t*o),egret.Tween.get(n).to({alpha:.5},1e3);var a=egret.Tween.get(n,{loop:!0});a.to({rotation:n.rotation+360},500)},u=this,p=0;n>p;p++)h(p)},e.prototype.flyItemToBag=function(t){var e=t.item,i=t.point;if(!UIMgr.ins().hasTopView()){var n=this.bagBtn.parent.localToGlobal(this.bagBtn.x+this.bagBtn.width/2,this.bagBtn.y+this.bagBtn.height/2);e.reset(),e.setItemParent(this),e.x=i.x,e.y=i.y,egret.Tween.get(e).to({x:n.x,y:n.y},1700,egret.Ease.sineOut).call(function(){DisplayUtils.removeFromParent(e),e.destruct(),ObjectPool.push(e)})}},e.prototype.flyItemToBagEx=function(t){if(t.parent){var e=t.parent.localToGlobal(t.x,t.y),i=this.bagBtn.parent.localToGlobal(this.bagBtn.x+this.bagBtn.width/2-t.width/4,this.bagBtn.y+this.bagBtn.height/2-t.width/4);DisplayUtils.removeFromParent(t),t.x=e.x,t.y=e.y,this.addChild(t),egret.Tween.get(t).to({x:i.x,y:i.y},1700,egret.Ease.sineOut).call(function(){DisplayUtils.removeFromParent(t)})}else DisplayUtils.removeFromParent(t)},e.prototype.isHideNavBtn=function(t){for(var e=0,i=this.navBtn;e<i.length;e++){var n=i[e];n&&(n.visible=t)}this.expBar.visible=t},e.NAV_ROLE=0,e.NAV_SKILL=1,e.NAV_LILIAN=2,e.NAV_SMITH=3,e.NAV_BAG=4,__decorate([callLater],e.prototype,"setLilianRedPoint",null),__decorate([callLater],e.prototype,"updateHp",null),e}(BaseEuiView);__reflect(GameBottomView.prototype,"GameBottomView");var GameKillInfoView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GameKillInfoViewSkin",e.uilayer=GameLayer.MAIN2,e.touchEnabled=!1,e.evenKillGroup.visible=!1,e.evenKillGroup.touchEnabled=!1,e.killGroup.visible=!1,e.killGroup.touchEnabled=!1,e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(597,this.doMultiKill),this.addCustomEvent(387,this.doFbKill)},e.prototype.doMultiKill=function(t){var e=this;if(egret.Tween.removeTweens(this.lzlabel),egret.Tween.removeTweens(this.evenKillGroup),!t)return void(this.evenKillGroup.visible=!1);this.evenKillGroup.visible=!0,this.evenKillGroup.alpha=1,this.lzlabel.scaleX=this.lzlabel.scaleY=1,this.lzlabel.text=""+t;var i=1e3;egret.Tween.get(this.lzlabel).to({scaleX:2,scaleY:2},200).to({scaleX:1,scaleY:1},100).call(function(){egret.Tween.get(e.evenKillGroup).wait(i).to({alpha:0},1e3).call(function(){egret.Tween.removeTweens(e.lzlabel),egret.Tween.removeTweens(e.evenKillGroup),e.evenKillGroup.visible=!1})})},e.prototype.doFbKill=function(){var t=this;if(!this.killGroup.visible){var e=function(){var i=copyControl.killNetworkList.pop();if(i){t.killGroup.visible=!0,t.killGroup.scaleY=1,egret.Tween.removeTweens(t.killGroup),egret.Tween.removeTweens(t.killTags);var n=copyControl.killNetworkList.length>0?3e3:5e3;egret.Tween.get(t.killGroup).wait(n).to({scaleY:0},300).call(function(){t.killGroup.visible=!1,e()}),t.killTags.scaleX=0,egret.Tween.get(t.killTags).wait(1e3).to({scaleX:1},300),t.killerTxt.text="S."+i.kill[0]+" \n"+i.kill[2],t.deadTxt.text="S."+i.dead[0]+" \n"+i.dead[2],t.roleIcon0.icon="head_"+i.dead[3]+i.dead[4],t.roleIcon1.icon="head_"+i.kill[3]+i.kill[4]}};e()}},e}(BaseEuiView);__reflect(GameKillInfoView.prototype,"GameKillInfoView");var GameSceneView=function(t){function e(){var e=t.call(this)||this;return e._shap=new egret.Shape,e.skillWordList=[],e.mijingpassTime=0,e.gwStartTimes=0,e.leftTimeMj=0,e._miCurFloor=0,e.leftTime=0,e.isStartTime=!1,e.leftFlyExp=0,e.curAddExp=0,e.curExp=0,e.ignoreLeak=!0,e.isShowLog=!1,e.resident=!0,e.uilayer=GameLayer.SCENE1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GameSceneViewSkin",this.touchEnabled=!1,this.map=new MapDisplay,this.map.initMap(),this.addChildAt(this.map,0),this.input=new eui.TextInput,this.input.visible=!1,this.input.text=LangMgr.getValueByKey("scentInputOrder"),this.input.x=100,this.input.y=300,this.addChild(this.input),this.escBtn.visible=!1,this.skillWordImg=new eui.Image,this.skillWordImg.x=100,this.skillWordImg.visible=!1,this.skillWordImg.touchEnabled=!1,this.addChild(this.skillWordImg),this.leftTimePic=BitmapNumber.ins().createNumPic(0,"r0",5),this.leftTimePic.x=90,this.leftTimePic.y=38,this.guildBossGroup.addChild(this.leftTimePic),this.GwRankGroup.addChild(this._shap),this._shap.rotation=-90,this._shap.x=48,this._shap.y=50,this.schedule.mask=this._shap,this.riseupBtn.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(366,this.upDataGuajiState),this.addCustomEvent(391,this.updateGoldGroup),this.addCustomEvent(355,this.updateExpGroup),this.addCustomEvent(598,this.showSkillWord),this.addCustomEvent(390,this.updateGoldKill),this.addCustomEvent(372,this.updateKill),this.addCustomEvent(353,this.onEnterMap),this.addCustomEvent(370,this.onSetTime),this.addCustomEvent(473,this.onViewOpen),this.addCustomEvent(50,this.updateMijingAdd),this.addCustomEvent(453,this.expChange),this.addEventTouchTap(this.escBtn,this.onTap),this.addEventTouchTap(this.riseup,this.onTap),this.addEventTouchTap(this.punchBtn,this.onTap),this.addEventTouchTap(this.helpBtn,this.onTap)},e.prototype.close=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.close.call(this,e),this.skillWordList=[],egret.Tween.removeTweens(this.skillWordImg),this.skillWordImg.visible=!1,TimerMgr.ins().remove(this.updateTime,this),TimerMgr.ins().remove(this.updateMijingTime,this),this.mijingpassTime=0},e.prototype.expChange=function(t){if((1==MapControl.copyType||9==MapControl.copyType)&&t){var e=UnitMgr.ins().getNoDieRole();if(e){var i=new egret.DisplayObjectContainer;BitmapNumber.ins().changeNum(i,"j+"+t,"g3",3.5,0),i.anchorOffsetX=i.width/2,i.y=e.y-e.typeface-30,i.x=e.x,i.scaleX=i.scaleY=1,this.map.addChild(i),egret.Tween.get(i).to({y:i.y-80,scaleX:2,scaleY:2},200).to({scaleX:1.2,scaleY:1.2},100).wait(1e3).to({alpha:0,y:i.y-140},1e3).call(function(){DisplayUtils.removeFromParent(i)})}}},e.prototype.onViewOpen=function(t){1==t?this.map.parent&&(UIMgr.ins().open(GameBlackView),this.removeChild(this.map)):this.map.parent||(this.addChildAt(this.map,0),UIMgr.ins().close(GameBlackView))},e.prototype.onEnterMap=function(){TimerMgr.ins().remove(this.updateTime,this),UIMgr.ins().close(GodWeaponDunRiseUpView),TimerMgr.ins().remove(this.updateMijingTime,this),this.mijingpassTime=0,this.isStartTime=!1,16==MapControl.copyType?(this.curExp=0,this.expTxt||(this.expTxt=BitmapNumber.ins().createNumPic(0,"r0",5),this.expTxt.x=this.flyExpGroup.width/2,this.expTxt.y=65,this.flyExpGroup.addChild(this.expTxt)),this.updateKill(),this.setExp(this.curExp),this.leftFlyExp=0,this.totleExp.source="fbljjy",this.killNumImg.source="fbjsgw",this.flyExpGroup.visible=!0,this.flyExpGroup1.visible=!0):100==MapControl.copyType?(this.curExp=0,this.expTxt||(this.expTxt=BitmapNumber.ins().createNumPic(0,"r0",5),this.expTxt.x=this.flyExpGroup.width/2,this.expTxt.y=65,this.flyExpGroup.addChild(this.expTxt)),this.updateGoldKill(),this.setExp(this.curExp),this.leftFlyExp=0,this.totleExp.source="fbljyb",this.killNumImg.source="fbjsgw",this.flyExpGroup.visible=!0,this.flyExpGroup1.visible=!0):(this.flyExpGroup.visible=!1,this.flyExpGroup1.visible=!1),this.guildBossGroup.visible=!1,this.escBtn.visible=this.checkShowEscBtn(),skillControl.hejiLevel>=0&&this.checkPunchState(),this.helpBtn.visible=copyHelpControl.canHelp(),21==MapControl.copyType?(this.GwRankGroup.visible=!1,this.showMijing()):this.GwRankGroup.visible=!1,29==MapControl.copyType?UIMgr.ins().open(GuardMainUIView):(UIMgr.ins().close(GuardMainUIView),UIMgr.ins().close(GuardCallBossView)),MapControl.copyId>0?UIMgr.ins().open(GameKillInfoView):UIMgr.ins().close(GameKillInfoView)},e.prototype.checkShowEscBtn=function(){return MapControl.copyId&&1!=MapControl.copyType&&20!=MapControl.copyType&&24!=MapControl.copyType&&73!=MapControl.copyType&&72!=MapControl.copyType},e.prototype.checkPunchState=function(){if(MapControl.autoPunch()){this.punchBtn.visible=!0,this.punchBtn.top=2,blisterControl.isPaoDian?this.punchBtn.top=200:crazybtplayCopyControl.isShenwujindi?this.punchBtn.top=100:crossArenaControl.isKFArena&&(this.punchBtn.top=50);var t=ServerStorage.ins().getValue(15);this.punchBtn.icon=t?"heji_png":"noheji_png"}else this.punchBtn.visible=!1},e.prototype.updateMijingAdd=function(){if(21==MapControl.copyType)for(var t=godWeaponControl.dunInfoData,e=t.listData,i=0;i<e.length;i++)if(e[i].config.fbId==MapControl.copyId){copyControl.oldMijingPoint=e[i].curPoint;break}},e.prototype.showMijing=function(){var t,e=(DataCenter.ins().GodWeaponBaseConfig,1);for(var i in DataCenter.ins().GodWeaponFubenConfig)if(DataCenter.ins().GodWeaponFubenConfig[i].fbId==MapControl.copyId){e=parseInt(i),t=DataCenter.ins().GodWeaponFubenConfig[i];break}this._miCurFloor=e;var n=godWeaponControl.dunInfoData;if(n){for(var o=n.listData,s=0;s<o.length;s++)if(o[s].config.fbId==MapControl.copyId){copyControl.oldMijingPoint=o[s].curPoint;break}}else godWeaponControl.upDunInfo()},e.prototype.removeMiingTimeFun=function(){TimerMgr.ins().remove(this.updateMijingTime,this)},e.prototype.updateMijingTime=function(){if(this.leftTimeMj<=0)return UIMgr.ins().close(GodWeaponDunRiseUpView),this.mijingpassTime=0,copyControl.upExitFb(),UIMgr.ins().open(GodWeaponResultView,MapControl.copyId,4),void TimerMgr.ins().remove(this.updateMijingTime,this);for(var t=360-this.leftTimeMj,e=void 0,i=0;i<DataCenter.ins().GodWeaponBaseConfig.fbGrade.length;i++)if(t<=DataCenter.ins().GodWeaponBaseConfig.fbGrade[i]){this.mijingpassTime=DataCenter.ins().GodWeaponBaseConfig.fbGrade[i]-t,e=godWeaponControl.getScoreTime(i),copyControl.mijingFingfen=i+1,copyControl.mijingUseTime=t,this.updateMijingTimeView(e,i);break}this.leftTimeMj=360-(Math.floor((new Date).getTime()/1e3)-this.gwStartTimes)},e.prototype.updateMijingTimeView=function(t,e){this.GwRankGroup.visible||(this.GwRankGroup.visible=!0,this.schedule.source="godweapon_rankschedule",this.rankbg.source="GodWeapon_rankball");var i=360*this.mijingpassTime/t;360==i?i=0:0==i&&(i=360),DisplayUtils.drawCir(this._shap,this.schedule.width/2,360-i,!0),this.rank.source="godweapon_rank"+(e+1),this.time.text=DateUtils.getFormatBySecond(this.mijingpassTime,DateUtils.TIME_FORMAT_1);var n=DataCenter.ins().GodWeaponBaseConfig.fbGrade[e]+LangMgr.getValueByKey("activitSS"),o="";switch(e+1){case 1:o="S";break;case 2:o="A";break;case 3:o="B";break;case 4:o="C"}this.requireTime.textFlow=(new egret.HtmlTextParser).parser(n+('<font color="#FFFFFF">'+LangMgr.getValueByKey("scentPassState")+"</font>")+o+'<font color="#FFFFFF">'+LangMgr.getValueByKey("pingjiastr")+"</font>");var s=DataCenter.ins().GodWeaponFubenConfig[this._miCurFloor];if(s){var r=s.award[e+1];r?this.rewardExp.text=""+r[0].count:this.rewardExp.text=""}else this.rewardExp.text=""},e.prototype.setMJPingfen=function(t){var e="godweapon_rank"+t;this.rank.source!=e&&(this.rank.source=e)},e.prototype.upDataGuajiState=function(t){0!=MapControl.copyId&&1==t&&(t=0),this.stateImg.source=t?"zy_20":""},e.prototype.onSetTime=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];15==MapControl.copyType?t&&t[0]&&(this.leftTime=t[0][1],this.leftTimeImg.source="lastcount",this.guildBossGroup.visible=!0,this.isStartTime||(TimerMgr.ins().doTimer(1e3,0,this.updateTime,this),this.isStartTime=!0,this.updateTime())):21==MapControl.copyType&&t&&t[0]&&(this.leftTimeMj=t[0][1],this.leftTimeMj>=2&&(this.leftTimeMj=this.leftTimeMj-2),this.gwStartTimes=Math.floor((new Date).getTime()/1e3)-(360-this.leftTimeMj),TimerMgr.ins().doTimer(1e3,0,this.updateMijingTime,this),this.updateMijingTime())},e.prototype.updateTime=function(){return this.leftTime<0?(TimerMgr.ins().remove(this.updateTime,this),this.isStartTime=!1,this.guildBossGroup.visible=!1,BitmapNumber.ins().changeNum(this.leftTimePic,0,"r0",5),void copyControl.upExitFb()):(BitmapNumber.ins().changeNum(this.leftTimePic,this.leftTime,"r0",5),void this.leftTime--)},e.prototype.updateGoldKill=function(){this.lbNum.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color62")+"&T:"+copyControl.goldMonterCountKill+"||C:"+LangMgr.getColor("color27")+"&T:/"+copyControl.fbGoldTotal+"|")},e.prototype.updateKill=function(){this.lbNum.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color62")+"&T:"+copyControl.expMonterCountKill+"||C:"+LangMgr.getColor("color27")+"&T:/"+copyControl.fbExpTotal+"|")},e.prototype.flyExp=function(t,e){var i=this,n=new eui.Image;n.source="point2",n.anchorOffsetX=20,n.anchorOffsetY=20,n.x=t.x,n.y=t.y,this.addChild(n);var o=this.flyExpGroup.x+this.expTxt.x,s=this.flyExpGroup.y+this.expTxt.y+this.expTxt.height/2,r=egret.Tween.get(n);r.to({x:o,y:s,alpha:.5},800).call(function(){i.addExp(e),i.removeChild(n),egret.Tween.removeTweens(n)},this);
var a=egret.Tween.get(n,{loop:!0});a.to({rotation:n.rotation+360},800)},e.prototype.setExp=function(t){BitmapNumber.ins().changeNum(this.expTxt,t,"r0",5),this.expTxt.anchorOffsetX=this.expTxt.width/2},e.prototype.addExp=function(t){this.leftFlyExp+=t,this.curAddExp=Math.floor(this.leftFlyExp/10),TimerMgr.ins().isExists(this.rollExp,this)||TimerMgr.ins().doTimer(30,0,this.rollExp,this)},e.prototype.rollExp=function(){var t=this.leftFlyExp>this.curAddExp?this.curAddExp:this.leftFlyExp;this.leftFlyExp=this.leftFlyExp-t,this.curExp+=t,this.setExp(this.curExp),this.leftFlyExp<=0&&TimerMgr.ins().remove(this.rollExp,this)},e.prototype.updateExpGroup=function(t){var e=t[0],i=t[1];if(!(i>0||16!=MapControl.copyType)){var n=e.infoModel.configID,o=DataCenter.ins().CopyExpMonsterConfig[n];if(o){var s=e.parent;if(!s){var r=UnitMgr.ins().getNoDieRole();r&&(s=r.parent)}if(s){var a=DataCenter.ins().MonthCardConfig.expFubenPrecent/100,l=payControl.getIsForeve()?1+a:1,h=s.localToGlobal(e.x,e.y);this.flyExp(h,Math.ceil(o.exp*l))}this.updateKill()}}},e.prototype.updateGoldGroup=function(t){0>=t||100!=MapControl.copyType||(this.addExp(t),this.updateGoldKill())},e.prototype.onTap=function(t){switch(t.currentTarget){case this.punchBtn:var e=ServerStorage.ins().getValue(15)>0?0:1;this.punchBtn.icon=e?"heji_png":"noheji_png",ServerStorage.ins().setValue(15,e);break;case this.escBtn:if(29==MapControl.copyType)return void UIMgr.ins().open(GuardQuitTipsView);if(1==MapControl.copyType&&portalControl.closeAuto(),unionWarControl.getModel().checkinAppoint())return void UIMgr.ins().open(UnionWarReliveView,3);if(mineControl.hadMine&&mineControl.canShowOnceTips&&mineControl.inCopy)return mineControl.canShowOnceTips=!1,void warnControl.show(LangMgr.getValueByKey("exitkuangdongtips"),function(){copyControl.upExitFb()},this);if(campWarControl.isCampWar())return void warnControl.show(LangMgr.getValueByKey("sceneTips10"),function(){copyControl.upExitFb()},this);if(blisterControl.isPaoDian)return void warnControl.show(LangMgr.getValueByKey("sceneTips11"),function(){copyControl.upExitFb()},this);if(crossArenaControl.isKFArena)return void warnControl.show(LangMgr.getValueByKey("sceneTips12"),function(){copyControl.upExitFb()},this);if(crazybtplayCopyControl.isShenwujindi&&crazybtplayCopyControl.angerNum<DataCenter.ins().CrazybtplayBossBaseConfig.totalShenWuStrength)return void warnControl.show(LangMgr.getValueByKey("artifactNoFull",DataCenter.ins().CrazybtplayBossBaseConfig.totalShenWuStrength),function(){copyControl.upExitFb()},this);copyControl.upExitFb(),TimerMgr.ins().remove(this.updateMijingTime,this),this.mijingpassTime=0;break;case this.riseup:UIMgr.ins().open(GodWeaponDunRiseUpView);break;case this.helpBtn:if(!unionControl.guildID)return void tipsControl.showCenterTips(LangMgr.getValueByKey("tipsexithoucanadd"));copyHelpControl.seekHelp()}},e.prototype.showSkillWord=function(t){if(t){egret.Tween.removeTweens(this.skillWordImg);var e=egret.Tween.get(this.skillWordImg);this.skillWordImg.source=null,this.skillWordImg.source=t,this.skillWordImg.visible=!0,this.skillWordImg.scaleX=3,this.skillWordImg.scaleY=3,this.skillWordImg.alpha=1,this.skillWordImg.y=250,e.to({y:250,scaleX:1,scaleY:1},200).wait(600).to({alpha:0},350)}},e.prototype.destoryView=function(){},e}(BaseEuiView);__reflect(GameSceneView.prototype,"GameSceneView");var GodWeaponControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curExp=0,e._firstExp=!0,e.weaponDataAry=[],e._isFirst=!1,e.gwTask=new GodWeaponTaskVo,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.createData=function(){0==this._isFirst&&(this.initData(),this._isFirst=!0)},e.prototype.initData=function(){this.maxSkillIdAry=[],this.weaponDataAry=[],this.allSkillData={},this.allSkillData2={},this.allRelicItemData={};for(var t in DataCenter.ins().GodWeaponLineConfig){var e={},i={},n=DataCenter.ins().GodWeaponLineConfig[t];this.allSkillData[t]=e,this.allSkillData2[t]=i;var o=0;for(var s in n){var r=new GodWeaponSkillVo;r.skillId=parseInt(s),r.skillLv=0,r.config=n[s],r.weaponId=parseInt(t),i[r.skillId]=r,e[r.config.skinId]=r,o++}this.maxSkillIdAry.push(o);for(var a=[],l=0;l<DataCenter.ins().GodWeaponBaseConfig.weaponItemCount;l++){var h=new GodWeaponRelicItemVo;h.pos=l+1,h.itemId=void 0,h.config=null,h.weaponId=parseInt(t),a.push(h)}this.allRelicItemData[t]=a}this.gwSkillConfig={};for(var t in DataCenter.ins().SkillsGWReviseConfig){var n=DataCenter.ins().SkillsGWReviseConfig[t];this.gwSkillConfig[n.skill]||(this.gwSkillConfig[n.skill]={}),this.gwSkillConfig[n.skill][n.gwIndex]=n}},e.prototype.godWeaponIsOpen=function(){return reincarnateControl.lv>=DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel&&GameServer.serverOpenDay>=DataCenter.ins().GodWeaponBaseConfig.openDay-1},e.prototype.getReviseBySkill=function(t){if(!this.allSkillData2)return null;var e=(""+t).charAt(0),i=this.allSkillData2[e];if(!i)return null;var n=Math.floor(t/1e3),o=[];for(var s in i){var r=i[s];if(r.config.skill==n){if(0==r.skillLv)continue;var a=r.skillLv+r.addLv,l=1e3*r.skillId+a;this.gwSkillConfig[n]&&this.gwSkillConfig[n][l]&&o.push(this.gwSkillConfig[n][l])}}return o},e.prototype.getJobGWNewSkill=function(t){if(!this.allSkillData2)return null;var e=this.allSkillData2[t];if(!e)return null;var i=heroControl.getSubRoleByJob(t);if(!i)return null;i.godWeaponSkills||(i.godWeaponSkills=[]);var n=0;for(var o in e){var s=e[o];if(s.config.newskill||s.config.passiveskill){var r=s.config.newskill||s.config.passiveskill,a=1e3*r+(s.skillLv+s.addLv);i.godWeaponSkills[n]=i.godWeaponSkills[n]||new SkillVo(a),i.godWeaponSkills[n].configID=a,n+=1}}return i.godWeaponSkills},e.prototype.getAllWeaponSkills=function(t){return this.allSkillData&&this.allSkillData[t]},e.prototype.getWeaponSkinIdData=function(t,e){return this.allSkillData[t][e]},e.prototype.getWeaponSkillidData=function(t,e){return this.allSkillData2[t][e]},e.prototype.getRelicItemData=function(t,e){return this.allRelicItemData[t][e-1]},e.prototype.downUpdateExp=function(t){var e=this.curExp;this.curExp=t,this._firstExp||this.curExp-e>0&&tipsControl.showTips(LangMgr.getValueByKey("godWeaponExp",this.curExp-e)),this._firstExp=!1,EventMgr.ins().dispatch(48)},e.prototype.downUpdateInfo=function(t){this.createData();for(var e,i=0;i<t.length;i++)this.weaponDataAry[i]?(e=this.weaponDataAry[i],e.init(t[i])):(e=new GodWeaponVo,e.init(t[i]),this.weaponDataAry.push(e));this.weaponDataAry.sort(function(t,e){return t.weaponId<e.weaponId?-1:1}),EventMgr.ins().dispatch(49)},e.prototype.getWeaponData=function(t){if(this.weaponDataAry)for(var e=0,i=this.weaponDataAry;e<i.length;e++){var n=i[e];if(n.weaponId==t)return n}return null},e.prototype.upUpSkill=function(t,e){return[t,e]},e.prototype.upInlayItem=function(t,e,i){return[t,e,i]},e.prototype.upUpWeapon=function(t){return[t]},e.prototype.maxLvRedPoint=function(){if(!this.weaponDataAry)return!1;var t=this.weaponDataAry.concat();t.sort(function(t,e){return t.curLv-e.curLv});var e=t[t.length-1];return e&&e.config&&this.curExp>=2*e.config.everyExp},e.prototype.dunHadRedPoint=function(){return this.godWeaponIsOpen()&&this.dunInfoData&&this.dunInfoData.leftChallengeNum>0},e.prototype.getRelicRedPoint=function(t){for(var e,i=this.allRelicItemData[t],n=0;n<i.length;n++)if(e=i[n],e.isOpen&&!e.itemId&&GodWeaponRelicChooseView.getGwItemType(e).length>0)return!0;return!1},e.prototype.gwAddAttr=function(t){var e=this.getWeaponData(t+1);if(!e)return[];var i,n=e.addAttr.concat(),o=0,s=0;for(o=0;o<this.maxSkillIdAry[t];o++)if(i=this.getWeaponSkillidData(t+1,o+1),i.skillLv+i.addLv>0&&i.config.attr)for(s=0;s<i.config.attr.length;s++){var r={value:0,type:0};r.value=i.config.attr[s].value*(i.skillLv+i.addLv),r.type=i.config.attr[s].type,n.push(r)}var a=this.allRelicItemData[t+1];for(o=0;o<a.length;o++)if(a[o].itemId)for(s=0;s<a[o].config.attr.length;s++){var r={value:0,type:0};r.value=a[o].config.attr[s].value,r.type=a[o].config.attr[s].type,n.push(r)}return AttributeData.combineAtts(n)},e.prototype.downDunInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.dunInfoData||(this.dunInfoData=new GodWeaponDunVo),this.dunInfoData.init(t),EventMgr.ins().dispatch(50)},e.prototype.downRankInfo=function(t){this.rankInfoDataAry||(this.rankInfoDataAry=[]);for(var e,i=0;i<t.length;i++)e=this.rankInfoDataAry[i],e||(e=new GodWeaponRankInfoVo,this.rankInfoDataAry[i]=e),e.init(t[i]);this.rankInfoDataAry.sort(this.sortFun),EventMgr.ins().dispatch(51)},e.prototype.sortFun=function(t,e){return t.rank-e.rank},e.prototype.downGwTask=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.gwTask.init(t),EventMgr.ins().dispatch(52)},e.prototype.upDunInfo=function(){},e.prototype.upJoinDun=function(t){return[t]},e.prototype.upBuybuff=function(t){return[t]},e.prototype.upRankInfo=function(){},e.prototype.downGetAward=function(t,e){var i=UIMgr.gameScene;i&&(i.removeMiingTimeFun(),i.setMJPingfen(e)),t?UIMgr.ins().open(GodWeaponResultView,MapControl.copyId,e,copyControl.mijingUseTime):UIMgr.ins().open(GodWeaponResultView,MapControl.copyId,4)},e.prototype.upGetAward=function(){},e.prototype.upReceiveTask=function(t){return[t]},e.prototype.upActiveWeapon=function(){},e.prototype.getScoreTime=function(t){var e;if(!this._timeDunAry){this._timeDunAry=[];for(var i in DataCenter.ins().GodWeaponBaseConfig.fbGrade)e?(this._timeDunAry.push(DataCenter.ins().GodWeaponBaseConfig.fbGrade[i]-e),e=DataCenter.ins().GodWeaponBaseConfig.fbGrade[i]):(e=DataCenter.ins().GodWeaponBaseConfig.fbGrade[i],this._timeDunAry.push(e))}return this._timeDunAry[t]},e.prototype.weaponIsActive=function(t){if(this.createData(),this.weaponDataAry)for(var e=0,i=this.weaponDataAry;e<i.length;e++){var n=i[e];if(n.weaponId==t)return!0}return!1},e.prototype.taskIsOpen=function(){return GameServer.serverOpenDay>=DataCenter.ins().GodWeaponBaseConfig.openDay-1},e.prototype.upReset=function(t){return[t]},e.prototype.isOpen=function(){return reincarnateControl.lv>=DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel&&GameServer.serverOpenDay>=DataCenter.ins().GodWeaponBaseConfig.openDay?!0:(reincarnateControl.lv<DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel?tipsControl.showTips(LangMgr.getValueByKey("godRoleZS",DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel)):GameServer.serverOpenDay<DataCenter.ins().GodWeaponBaseConfig.openDay&&tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().GodWeaponBaseConfig.openDay+1)),!1)},e.prototype.enterFb=function(t){if(this.isOpen()){var e=200308;if(!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()){if(!bossControl.worldInfoList[5])return void tipsControl.showTips(LangMgr.getValueByKey("noserverdata"));var i=function(t,e){return SortUtils.sortAscByKey(t.id,e.id)},n=bossControl.worldInfoList[5].concat();if(n.sort(i),!Assert(n[t],"enter index error="+t)){if(!n[t].canInto)return void tipsControl.warnTips(LangMgr.getValueByKey("tongRotationEnought"));var o=n[t],s=DataCenter.ins().WorldBossConfig[o.id];if(o.isDie)tipsControl.showTips(LangMgr.getValueByKey("godBossDied"));else if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{var r=Math.ceil((bossControl.worldBossCd[s.type]-egret.getTimer())/1e3);if(r>0)return tipsControl.showTips(LangMgr.getValueByKey("bossfightTime",r)),!1;var a=bossControl.worldBossBelongTime[s.type],l=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e);if(0==a&&l>0){var h=DataCenter.ins().ItemConfig[e];return void warnControl.show(LangMgr.getValueByKey("expJuanZhouBuyCount",ItemUtils.getQualityColor(h),h.name),function(){backpackControl.upUseItem(e,1),bossControl.challengWorldBoss(o.id,s.type)},this,function(){bossControl.challengWorldBoss(o.id,s.type)},this)}bossControl.challengWorldBoss(o.id,s.type)}}}}},e.prototype.getMaxWeaponLv=function(){for(var t=Object.keys(DataCenter.ins().GodWeaponLineConfig),e=0,i=0;i<t.length;i++){var n=Number(t[i]),o=this.getWeaponData(n);o&&o.curLv>e&&(e=o.curLv)}return e},e.prototype.getWeaponTotalLv=function(){for(var t=Object.keys(DataCenter.ins().GodWeaponLineConfig),e=0,i=0;i<t.length;i++){var n=Number(t[i]),o=this.getWeaponData(n);o&&o.curLv>0&&(e=o.curLv)}return e},e.prototype.getActWeapon=function(){for(var t=Object.keys(DataCenter.ins().GodWeaponLineConfig),e=0,i=0;i<t.length;i++){var n=Number(t[i]);this.weaponIsActive(n)&&e++}return e},e.prototype.getGodItemQuality=function(t){void 0===t&&(t=2);for(var e=Object.keys(DataCenter.ins().GodWeaponLineConfig),i=0,n=0;n<e.length;n++)for(var o=Number(e[n]),s=1;s<=DataCenter.ins().GodWeaponBaseConfig.weaponItemCount;s++){var r=this.getRelicItemData(o,s);r&&r.itemConfig&&ItemUtils.getQuality(r.itemConfig)>=t&&i++}return i},__decorate([down(1,[10])],e.prototype,"downUpdateExp",null),__decorate([down(2,[ByteConst.GodWeaponVos])],e.prototype,"downUpdateInfo",null),__decorate([up(3,[3,3])],e.prototype,"upUpSkill",null),__decorate([up(4,[3,3,3])],e.prototype,"upInlayItem",null),__decorate([up(5,[3])],e.prototype,"upUpWeapon",null),__decorate([down(6,ByteConst.GodWeaponDunVos.slice())],e.prototype,"downDunInfo",null),__decorate([down(9,[ByteConst.GodWeaponRankInfoVos])],e.prototype,"downRankInfo",null),__decorate([down(10,ByteConst.GodWeaponTaskVos.slice())],e.prototype,"downGwTask",null),__decorate([up(6)],e.prototype,"upDunInfo",null),__decorate([up(7,[3])],e.prototype,"upJoinDun",null),__decorate([up(8,[3])],e.prototype,"upBuybuff",null),__decorate([up(9)],e.prototype,"upRankInfo",null),__decorate([down(13,[1,1])],e.prototype,"downGetAward",null),__decorate([up(13)],e.prototype,"upGetAward",null),__decorate([up(11,[3])],e.prototype,"upReceiveTask",null),__decorate([up(12)],e.prototype,"upActiveWeapon",null),__decorate([up(14,[3])],e.prototype,"upReset",null),e=__decorate([protocolsId(60)],e)}(BaseSystem);__reflect(GodWeaponControl.prototype,"GodWeaponControl");var GodWeaponItemControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upCompound=function(t,e,i){return[t,e,i]},e.prototype.downCompound=function(t,e,i){EventMgr.ins().dispatch(599,{id:i,isSuccess:t})},e.prototype.upFuse=function(t,e,i){return[t,e,i]},e.prototype.downFuse=function(t,e,i){void 0===i&&(i=0),EventMgr.ins().dispatch(600,{id:i,isSuccess:t})},e.prototype.init=function(){if(!this._qualityItemMap&&!this._jobItemMap){this._qualityItemMap={},this._jobItemMap={};for(var t in DataCenter.ins().GodweaponItemConfig){var e=DataCenter.ins().GodweaponItemConfig[t],i=DataCenter.ins().ItemConfig[e.id],n=ItemUtils.getQuality(i);if(4>n)this._qualityItemMap[n]||(this._qualityItemMap[n]=[]),this._qualityItemMap[n].push(e.id);else if(4==n&&(!e.skill||e.skill.length<=1)){var o=ItemUtils.getJob(i);this._jobItemMap[o]||(this._jobItemMap[o]=[]),this._jobItemMap[o].push(e.id)}}}},Object.defineProperty(e.prototype,"qualityItemMap",{get:function(){return this._qualityItemMap||this.init(),this._qualityItemMap},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"jobItemMap",{get:function(){return this._jobItemMap||this.init(),this._jobItemMap},enumerable:!0,configurable:!0}),e.prototype.isCanCompound=function(){var t=!1,e=this.qualityItemMap;for(var i in e)if(parseInt(i)<4&&(t=this.checkNum(e[i])))return t;return t},e.prototype.checkNum=function(t){for(var e=t.length,i=0,n=0;e>n;n++)if(i+=backpackControl.getBagGoodsCountById(0,t[n]),i>=3)return!0;return!1},e.prototype.getCompoundItemList=function(){var t={},e=!1,i=this.qualityItemMap;for(var n in i)e=this.checkNum(i[n]),e&&(t[n]=this.getItemList(i[n]));return t},e.prototype.filterCompoundItemList=function(t,e){var i=[];for(var n in e){var o=new GodWeaponItemVo(e[n].id,e[n].count,e[n].quality);o.quality==t.quality&&(o.id==t.id?o.count>1&&(o.count--,i.push(o)):i.push(o))}return i},e.prototype.toList=function(t){var e=[];for(var i in t)e=e.concat(t[i]);return e},e.prototype.getItemList=function(t){for(var e=t.length,i=[],n=0;e>n;n++){var o=t[n],s=backpackControl.getBagGoodsCountById(0,o),r=ItemUtils.getQuality(DataCenter.ins().ItemConfig[o]);s>0&&i.push(new GodWeaponItemVo(o,s,r))}return i},e.prototype.isCanFuse=function(){var t=!1;for(var e in this.jobItemMap)if(t=this.checkFuseNum(this.jobItemMap[e]))return t;return t},e.prototype.checkFuseNum=function(t){for(var e=0,i=0,n=0;n<t.length;n++)if(i=backpackControl.getBagGoodsCountById(0,t[n]),i>0&&(e++,e>1))return!0;return!1},e.prototype.getFuseItemList=function(){var t={},e=!1,i=this.jobItemMap;for(var n in i)e=this.checkFuseNum(i[n]),e&&(t[n]=this.getJobFuseItemList(i[n]));return t},e.prototype.getJobFuseItemList=function(t){for(var e=t.length,i=[],n=0;e>n;n++){var o=t[n],s=ItemUtils.getQuality(DataCenter.ins().ItemConfig[o]),r=backpackControl.getBagGoodsCountById(0,t[n]);r>0&&i.push(new GodWeaponItemVo(o,r,s))}return i},e.prototype.filterFuseItemList=function(t,e){var i=[],n=ItemUtils.getJob(DataCenter.ins().ItemConfig[t.id]);for(var o in e){var s=new GodWeaponItemVo(e[o].id,e[o].count,e[o].quality),r=ItemUtils.getJob(DataCenter.ins().ItemConfig[s.id]);n==r&&t.id!=s.id&&i.push(s)}return i},e.prototype.getFuseTargetItem=function(t,e){var i=ItemUtils.getJob(DataCenter.ins().ItemConfig[t]),n=4e5+1e4*i+Math.max(t,e)-Math.min(t,e)+100*(Math.min(t,e)%20);return n},__decorate([up(1,[3,3,3])],e.prototype,"upCompound",null),__decorate([down(1,[0,2,3])],e.prototype,"downCompound",null),__decorate([up(2,[3,3,2])],e.prototype,"upFuse",null),__decorate([down(2,[0,2,3])],e.prototype,"downFuse",null),e=__decorate([protocolsId(63)],e)}(BaseSystem);__reflect(GodWeaponItemControl.prototype,"GodWeaponItemControl");var LuckyResultView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arr=[],e.items=[],e.type=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TreasureHuntResultViewSkin",this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.buyBtn,this.buy),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTouch),this.addCustomEvent(393,this.updateView),this.activityID=t[0],this.indexs=t[1],this.updateView()},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(){this.canClicck=!0,this.zwHunt.visible=!0;var t;t=DataCenter.ins().PAmusementBtnConfig[this.activityID]?DataCenter.ins().PAmusementType9Config:DataCenter.ins().Amusement9Config;var e=t[this.activityID];this.arr=[];for(var i=0;i<this.indexs.length;i++)if(this.indexs[i])for(var n=0;n<e[this.indexs[i]].reward.length;n++)this.arr.push(e[this.indexs[i]].reward[n]);this.title.text=LangMgr.getValueByKey("activitGetGoods"),this.buyBtn.labelDisplay.text=LangMgr.getValueByKey("activitCheckTen"),this.yb=10*e[0].yb,this.zw.text=this.yb+"";var o=DataCenter.ins().ItemConfig[e[0].item];this.icon.source=o?o.icon+"_png":null,this.itemId=e[0].item,this.itemId&&this.updateDesc(),this.playResult(),this.zwNum2.text="/10）",this.zwNum.visible=void 0!=o,this.zwNum1.visible=void 0!=o,this.zwNum2.visible=void 0!=o},e.prototype.updateDesc=function(){var t=backpackControl.getBagItemById(this.itemId),e=ColorUtils.WHITE_COLOR,i=0,n=10;t&&(i=t.count,e=t.count>=n?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR),this.zwNum1.textFlow=TextUtils.generateTextFlow("<font color="+e+">"+i+"</font> ")},e.prototype.playResult=function(t){var e=this;this.releaseAllItem();for(var i=this.arr.length,n=0;i>n;n++){this.items[n]=this.createItem(this.arr[n]);var o=egret.Tween.get(this.items[n]);this.items[n].x=n%5*77+0,this.items[n].y=93*Math.floor(n/5)+0,this.items[n].alpha=0,o.wait(50*n).to({alpha:1},200).call(function(){i--,0==i&&(void 0!=t&&t(),e.canClicck=!0)})}},e.prototype.playGet=function(t){for(var e=this,i=this.arr.length,n=0;i>n;n++)if(this.items[n]){var o=egret.Tween.get(this.items[n]);o.to({y:620,x:320,scaleX:0,scaleY:0},300-50*Math.floor(n/5)).call(function(){i--,0==i&&(void 0!=t&&t(),e.releaseAllItem())})}},e.prototype.createItem=function(t){var e=new ItemBase;this.listCon.addChild(e);var i=DataCenter.ins().ItemConfig[t.id];return i?(e.num=t.count,e.data=t):e.data={type:0,count:t.count,id:t.id},e.x=180,e.y=500,e},e.prototype.releaseAllItem=function(){for(var t in this.items)this.items[t].destruct(),this.listCon.removeChild(this.items[t]);this.items=[]},e.prototype.buy=function(t){this.canClicck&&(DataCenter.ins().PAmusementBtnConfig[this.activityID]?(this.ins=PAmusementControl.ins(),this.config=DataCenter.ins().PAmusementType9Config):(this.ins=AmusementControl.ins(),this.config=DataCenter.ins().Amusement9Config),this.huntWarnFun())},e.prototype.huntWarnFun=function(){var t=this.config[this.activityID][0];ActorControl.yb>=10*t.yb?this.ins.upReward(this.activityID,2):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e}(BaseEuiView);__reflect(LuckyResultView.prototype,"LuckyResultView");var GodWeaponDunFloorVo=function(){function t(){}return Object.defineProperty(t.prototype,"gridNum",{get:function(){return this._gridNum},set:function(t){this._gridNum=t,this.config=DataCenter.ins().GodWeaponFubenConfig[t]},enumerable:!0,configurable:!0}),t}();__reflect(GodWeaponDunFloorVo.prototype,"GodWeaponDunFloorVo");var GodWeaponDunShowItemVo=function(){function t(){}return t}();__reflect(GodWeaponDunShowItemVo.prototype,"GodWeaponDunShowItemVo");var GodWeaponDunVo=function(){function t(){}return t.prototype.init=function(t){this.hadBuyData=[],this.leftChallengeNum=t[0],this.vipBuyNum=t[1],this.hadPass=t[2],this.curPoint=t[3];for(var e=0;e<t[4].length;e++){var i=[];i.push(t[4][e][0]),i.push(t[4][e][1]),this.hadBuyData[e]=i}this.getList()},Object.defineProperty(t.prototype,"hadPass",{get:function(){return this._hadPass},set:function(t){this._hadPass=t},enumerable:!0,configurable:!0}),t.prototype.getList=function(){var t,e=this.getMaxGird();t=1==this.curPoint?Math.min(this._hadPass+1,e):this._hadPass,this.listData=[];for(var i,n=t;n>0;n--)i=new GodWeaponDunFloorVo,i.gridNum=n,i.gridNum>this._hadPass?i.curPoint=0:i.gridNum==this._hadPass?i.curPoint=this.curPoint:i.curPoint=1,this.listData.push(i)},t.prototype.getMaxGird=function(){if(!this._maxGird){this._maxGird=0;for(var t in DataCenter.ins().GodWeaponFubenConfig)this._maxGird++}return this._maxGird},t.prototype.buyTypeData=function(t){for(var e=0;e<this.hadBuyData.length;e++)if(this.hadBuyData[e][0]==t)return this.hadBuyData[e];return[t,0]},Object.defineProperty(t.prototype,"getBuyCount",{get:function(){for(var t=0,e=0;e<this.hadBuyData.length;e++)t+=this.hadBuyData[e][1];return t},enumerable:!0,configurable:!0}),t}();__reflect(GodWeaponDunVo.prototype,"GodWeaponDunVo");var GodWeaponItemVo=function(){function t(t,e,i){this.id=t,this.count=e,this.quality=i}return t}();__reflect(GodWeaponItemVo.prototype,"GodWeaponItemVo");var GodWeaponRankInfoVo=function(){function t(){}return t.prototype.init=function(t){this.rank=t[0],this.nameStr=t[1];var e=t[2];this.floorNum=Math.floor(e/1e4),this.timeNum=1e4-e%1e4},t.prototype.getTimeStr=function(){var t="";return t=DateUtils.getFormatBySecond(this.timeNum,DateUtils.TIME_FORMAT_3)},t}();__reflect(GodWeaponRankInfoVo.prototype,"GodWeaponRankInfoVo");var GodWeaponRelicItemVo=function(){function t(){this.isCur=!1}return Object.defineProperty(t.prototype,"itemId",{get:function(){return this._itemId},set:function(t){this._itemId=t,this.config=DataCenter.ins().GodweaponItemConfig[this.itemId],this.itemConfig=DataCenter.ins().ItemConfig[this.itemId]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openLv",{get:function(){return DataCenter.ins().GodWeaponBaseConfig.openLevel[this.pos-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOpen",{get:function(){var t=godWeaponControl.getWeaponData(this.weaponId);return t&&t.curLv>=this.openLv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addatrStr",{get:function(){if(null==this._addStr){this._addStr="";for(var t=0;t<this.config.attr.length;t++)this._addStr.length>0&&(this._addStr+="\n"),this._addStr+=AttributeData.getAttrStrByType(this.config.attr[t].type)+" +"+this.config.attr[t].value}return this._addStr},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillName",{get:function(){if(null==this._skillName){this._skillName="";for(var t=0;t<this.config.skill.length;t++)this._skillName.length>0&&(this._skillName+="、"),this._skillName+=godWeaponControl.getWeaponSkillidData(this.weaponId,this.config.skill[t]).config.skillName}return this._skillName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skillPower",{get:function(){if(!this._skillPower){this._skillPower=0;for(var t=void 0,e=0;e<this.config.skill.length;e++)if(t=godWeaponControl.getWeaponSkillidData(this.weaponId,this.config.skill[e]),t.config.exPower&&(this._skillPower+=t.config.exPower),t.config.attr){for(var i=[],n=0;n<t.config.attr.length;n++)i.push(new AttributeData(t.config.attr[n].type,t.config.attr[n].value));this._skillPower+=BackpackControl.getAttrPower(i)}}return this._skillPower},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"power",{get:function(){if(!this._power){this._power=0,this._power+=this.skillPower;for(var t=[],e=0;e<this.config.attr.length;e++)t.push(new AttributeData(this.config.attr[e].type,this.config.attr[e].value));this._power+=BackpackControl.getAttrPower(t)}return this._power},enumerable:!0,configurable:!0}),t}();__reflect(GodWeaponRelicItemVo.prototype,"GodWeaponRelicItemVo");var GodWeaponSkillVo=function(){function t(t,e){this._skillLv=0,this.addLv=0,this.skillId=t,this.skillLv=e}return Object.defineProperty(t.prototype,"skillLv",{get:function(){return this._skillLv},set:function(t){this._skillLv=t},enumerable:!0,configurable:!0}),t.prototype.lvLabel=function(t){void 0===t&&(t=!1);var e,i=this._skillLv+this.addLv;return e=this.isOpen?this.config.upLevel+this.addLv:0!=this._skillLv?this.config.upLevel+this.addLv:this.addLv,t?""+i:i+"/"+e},Object.defineProperty(t.prototype,"skillPower",{get:function(){var t=this.config.exPower||0,e=this._skillLv+this.addLv;return t*e},enumerable:!0,configurable:!0}),t.prototype.addAttrValyeType=function(t){var e="";if(this.config.attr)for(var i=0;i<this.config.attr.length;i++)e.length>0&&(e+="\n"),e+=AttributeData.getAttrStrByType(this.config.attr[i].type)+LangMgr.getValueByKey("zxPanelUp")+('<font color="#35E62D">'+this.config.attr[i].value*t+"</font>");return e},t.prototype.addExAttrstr=function(t){var e="";if(this.config.exattr)for(var i="",n="",o=0;o<this.config.exattr.length;o++){switch(e.length>0&&(e+="\n"),i=LangMgr.getValueByKey("godWeaponDes"+this.config.exattr[o].type),this.config.exattr[o].type){case 43:case 48:n='<font color="'+ColorUtils.GREEN_COLOR+'">'+this.config.exattr[o].value*t/100+"</font>";break;case 44:case 45:case 46:n='<font color="'+ColorUtils.GREEN_COLOR+'">'+(1+this.config.exattr[o].value*t/100)+"</font>";break;case 47:var s=DataCenter.ins().SkillsEffectsConfig[100400+this.config.exattr[o].value*t];s&&s.args&&(n='<font color="'+ColorUtils.GREEN_COLOR+'">'+100*s.args.a+"</font>")}i=i.replace("%s%",n),e+=i}return e},t.prototype.addatrStr=function(t){this._addStr="";var e=t+this.addLv;this._addStr+=this.addAttrValyeType(e),this._addStr+=this.addExAttrstr(e);var i,n;return this.config.newskill&&(i=1e3*this.config.newskill+e,n=new SkillVo(i),this._addStr.length>0&&(this._addStr+="\n"),this._addStr+=this.getSkillDataDes(n)),this.config.passiveskill&&(i=1e3*this.config.passiveskill+e,n=new SkillVo(i),this._addStr.length>0&&(this._addStr+="\n"),this._addStr+=this.getSkillDataDes(n)),this._addStr+=this.specialSkill(e),this._addStr},t.prototype.getSkillDataDes=function(t){var e=t.config||DataCenter.ins().SkillsConfig[t.lv1ConfigID];if(Assert(e,LangMgr.getValueByKey("godError1",t.configID)))return"";var i=DataCenter.ins().SkillsDescConfig[e.desc],n=i?i.desc:"";if(!n.length||!e.desc_ex)return n;for(var o=e.desc_ex.length,s=0;o>s;s++)n=n.replace("%s%",'<font color="'+ColorUtils.GREEN_COLOR+'">'+e.desc_ex[s]+"</font>");return n},t.prototype.specialSkill=function(t){var e=t+this.addLv,i="";if(this.config.skill){var n=void 0,o=1e3*this.skillId+e;for(var s in DataCenter.ins().SkillsGWReviseConfig)if(n=DataCenter.ins().SkillsGWReviseConfig[s],n.skill==this.config.skill&&n.gwIndex==o){i=n.desc;break}}return i},Object.defineProperty(t.prototype,"isOpen",{get:function(){var t=!0;if(this.config.condition)for(var e in this.config.condition){var i=void 0;if(i=0==parseInt(e)?godWeaponControl.getWeaponSkillidData(this.weaponId,parseInt(e)+1):godWeaponControl.getWeaponSkillidData(this.weaponId,parseInt(e)),i.skillLv<this.config.condition[e]){t=!1;break}}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"openTip",{get:function(){if(!this._openTip)if(this._openTip="",this.skillId==godWeaponControl.maxSkillIdAry[this.weaponId-1])this._openTip=LangMgr.getValueByKey("godOpenCont");else for(var t in this.config.condition){var e=void 0;e=0==parseInt(t)?godWeaponControl.getWeaponSkillidData(this.weaponId,parseInt(t)+1):godWeaponControl.getWeaponSkillidData(this.weaponId,parseInt(t)),this._openTip.length>0&&(this._openTip+="\n"),this._openTip+=e.config.skillName+LangMgr.getValueByKey("godLockTo",this.config.condition[t])}return this._openTip},enumerable:!0,configurable:!0}),t}();__reflect(GodWeaponSkillVo.prototype,"GodWeaponSkillVo");var GodWeaponTaskVo=function(){function t(){}return t.prototype.init=function(t){this.weaponIdx=t[0],this.weapon=t[1],this.taskIdx=t[2],this.progress=t[3],this.statue=t[4]},t.DOING=0,t.DONE=1,t.FINISH=2,t}();__reflect(GodWeaponTaskVo.prototype,"GodWeaponTaskVo");var GodWeaponVo=function(){function t(){}return t.prototype.init=function(t){this.weaponId=t[0],this.curLv=t[1],this.curExp=t[2],this.skillPoint=t[3],this.openCount=t[4].length,this.openSkillAry=[];var e,i;if(0==this.openCount){var n=godWeaponControl.getAllWeaponSkills(this.weaponId);if(n)for(var o in n){var s=n[o];s.skillLv=0}}for(var r=0;r<this.openCount;r++)i=t[4][r][0],e=godWeaponControl.getWeaponSkillidData(this.weaponId,i),e.addLv=0,e.skillLv=t[4][r][1],this.openSkillAry.push(e);for(var a in godWeaponControl.allSkillData2[this.weaponId])0==godWeaponControl.allSkillData2[this.weaponId][a].skillLv&&(godWeaponControl.allSkillData2[this.weaponId][a].addLv=0);this.inlayCount=t[5].length;for(var l,h,r=0;r<this.inlayCount;r++){h=t[5][r][0],l=godWeaponControl.getRelicItemData(this.weaponId,h),l.itemId=t[5][r][1];for(var u=0;u<l.config.skill.length;u++){var p=godWeaponControl.getWeaponSkillidData(this.weaponId,l.config.skill[u]);p.addLv+=1}}this.config=DataCenter.ins().GodWeaponLevelConfig[this.curLv]},Object.defineProperty(t.prototype,"hasRedPoint",{get:function(){return this.skillPoint>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"addAttr",{get:function(){return null==this.config["attr"+this.weaponId]?[]:this.config["attr"+this.weaponId]},enumerable:!0,configurable:!0}),t.prototype.getResetPoint=function(){for(var t=this.openSkillAry?this.openSkillAry.length:0,e=0,i=0;t>i;i++)e+=this.openSkillAry[i].skillLv;return e},t.prototype.getWeaponName=function(){return LangMgr.getValueByKey("godType"+this.weaponId)},t}();__reflect(GodWeaponVo.prototype,"GodWeaponVo");var GodWeaponAddAttrView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodWeaponAddAttrViewSkin",this._ary=new eui.ArrayCollection,this.list.dataProvider=this._ary,this.list.itemRenderer=GodWeaponAddAttrItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._ary.replaceAll(godWeaponControl.gwAddAttr(t[0])),this.addEventTouchTap(this.rect,this.onTap),this.gwName.text=LangMgr.getValueByKey("godType"+(t[0]+1))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.dataProvider=null,this.removeEventTouchTap(this.rect,this.onTap)
},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GodWeaponAddAttrView.prototype,"GodWeaponAddAttrView");var Main=function(t){function e(){var i=t.call(this)||this;if(e.instance=i,window.isMiniUseHttp&&(e.miniHostTest=e.miniHostTest.replace("https:","http:"),e.miniHostRelease=e.miniHostRelease.replace("https:","http:")),e.curMiniHost=e.miniHostRelease,window.isMiniHostTest&&(e.curMiniHost=e.miniHostTest),window.alert="undefined"!=typeof alert?alert:DeviceUtils.IsWxMiniGame?function(t){window.wx.showModal({content:t})}:console.log,!window.location.protocol&&DeviceUtils.IsWxMiniGame)window.location.protocol=window.isMiniUseHttp?"http:":"https:";else if(DeviceUtils.IsWxMiniGame){var n=window.wx.getSystemInfoSync();window.wxPlatform=n.platform}return DebugUtils.OpenDebug=!1,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.ins=function(){return this.instance},e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),egret.ImageLoader.crossOrigin="anonymous",DeviceUtils.IsUcMiniGame?this.hosts="":this.hosts=GlobalModel.getHosts(),null==this.hosts&&DeviceUtils.IsWxMiniGame&&(this.hosts=e.curMiniHost);var i=new egret.HttpRequest;i.open(""+this.hosts+PATH_ROOT+"pfCfg.json?v="+Date.now(),egret.HttpMethod.GET),i.send(),i.once(egret.Event.COMPLETE,this.onGetComplete,this),i.once(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this)},e.prototype.onGetComplete=function(t){GlobalModel.init(t.currentTarget.response),(DeviceUtils.IsUcMiniGame||DeviceUtils.IsWxMiniGame)&&""==GlobalModel.resAdd&&""!=this.hosts&&(GlobalModel.resAdd=this.hosts),DeviceUtils.IsUcMiniGame&&(GlobalModel.pf="UCMiniGame",""!=GlobalModel.getUrlParamValue("UCMiniGamePfid")&&(GlobalModel.pfid=GlobalModel.getUrlParamValue("UCMiniGamePfid")),""!=GlobalModel.getUrlParamValue("UCMiniGameGameId")&&(GlobalModel.gameId=GlobalModel.getUrlParamValue("UCMiniGameGameId"))),DeviceUtils.IsWxMiniGame&&(null!=window.WxMiniPf?GlobalModel.pf=window.WxMiniPf:GlobalModel.pf=GlobalModel.getUrlParamValue("WxMiniPf"),null!=window.WxMiniGameId?GlobalModel.gameId=window.WxMiniGameId:""!=GlobalModel.getUrlParamValue("WxMiniGameId")&&(GlobalModel.gameId=GlobalModel.getUrlParamValue("WxMiniGameId")),null!=window.WxMiniGamePfId?GlobalModel.pfid=window.WxMiniGamePfId:""!=GlobalModel.getUrlParamValue("WxMiniGamePfId")&&(GlobalModel.pfid=GlobalModel.getUrlParamValue("WxMiniGamePfId")),GlobalModel.setUrlParamValue("useWss",window.isMiniWss)),("Test"==GlobalModel.pf||GlobalModel.getUrlParamValue("isDebug"))&&(DebugUtils.OpenDebug=!0),this.init()},e.prototype.onGetIOError=function(t){debug.error("pfCfg.json load fail!!!")},e.prototype.init=function(){SDKManager.ins().Init(),SDKManager.ins().SDKIsNeedInit()?EventMgr.addListener(0,this.initComplete,this):this.initComplete()},e.prototype.initComplete=function(){ReportData.getIns().reportDoPoint(1),ReportData.getIns().reportIntervalPoint(Date.now()-window.bgTime,1),window.bgTime1=Date.now(),EventMgr.removeListener(0,this.initComplete,this),this.stage.registerImplementation("eui.IAssetAdapter",new AssetAdapter),this.stage.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),RES.setMaxLoadingThread(4),DeviceUtils.IsPC?GlobalModel.isWeb?StageUtils.ins().setScaleMode(egret.StageScaleMode.FIXED_NARROW):(StageUtils.ins().setScaleMode(egret.StageScaleMode.SHOW_ALL),StageUtils.ins().getStage().orientation=egret.OrientationMode.AUTO):-1!=navigator.userAgent.indexOf("iPad")&&(StageUtils.ins().getStage().orientation=egret.OrientationMode.AUTO),egret.lifecycle.onPause=function(){SoundUtils.ins().setEffectOn(!1)},egret.lifecycle.onResume=function(){SoundUtils.ins().setEffectOn(ServerStorage.ins().getBitBool(ClientSetBit.sound_effect))},EgretModify.modify();var t=""+GlobalModel.resAdd+PATH_ROOT+"version.json?v="+(GlobalModel.isAuditState?GlobalModel.auditVersion:GlobalModel.gameVersion);ResVersionMgr.ins().loadConfig(t,this.loadResVersionComplete,this)},e.prototype.loadResVersionComplete=function(){ResVersionMgr.ins().registerVersionController(GlobalModel.resAdd),debug.log("Debug mode:",!1,"Ver:",GlobalModel.gameVersion),window.removeGif&&window.removeGif(),window.closeLoadingView&&window.closeLoadingView(),egret.ExternalInterface.call("closeLoadingView","");var t=SDKManager.ins().SDKMiniAuditVer(),e="",i=window.wxMiniName;e=null!=i&&""!=i?"wx_"+i+"_"+t:"wx_"+t,DeviceUtils.IsWxMiniGame?LoadUtils.ins().addConfig(""+PATH_ROOT+e+"/default.res.json",""+PATH_ROOT):LoadUtils.ins().addConfig(PATH_ROOT+"default.res.json",""+PATH_ROOT),LoadUtils.ins().loadConfig(this.onConfigComplete,this)},e.prototype.onConfigComplete=function(){GameLoadingUI.GetInstance().show(),this.startGame()},e.prototype.startGame=function(){if(GameLoadingUI.GetInstance().hideProgress(),SDKManager.ins().SDKIsNeedLoginNative()){var t=SDKManager.ins().SDKHasLoginScene();t?SceneMgr.ins().runScene(t):SDKManager.ins().SDKLoginNative()}else SceneMgr.ins().runScene(StartGameScene)},e.shareCallback=function(){platformAmuseControl.upWeiXinInviteGift()},e.followCallback=function(){platformAmuseControl.upGuanZhuGift()},e.miniHostTest="https://publishtest.lzhygame.com/publish/zwby/",e.miniHostRelease="https://hzcdn.lzhygame.com/publish/zwby/",e.curMiniHost="",e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var GodWeaponBossPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.remindTpis.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.remindTpis.text+"</u></a>"),this.remindTpis.touchEnabled=!0},e.prototype.open=function(){this.addEventTouchTap(this.gw0,this.onTap),this.addEventTouchTap(this.gw1,this.onTap),this.addEventTouchTap(this.gw2,this.onTap),this.addEventTouchTap(this.tower,this.onTap),this.addEventTextLink(this.remindTpis,this.onLink),this.addCustomEvent(112,this.initData),this.addCustomEvent(296,this.onUpdateBoss),TimerMgr.ins().doTimer(3e3,0,this.onUpdateTime,this),TimerMgr.ins().doTimer(1e3,0,this.onUpdateDieTime,this),this.initData()},e.prototype.onUpdateTime=function(){bossControl.upWorldBossInfo(5),bossControl.upWorldBossInfo(6)},e.prototype.onUpdateDieTime=function(){this.initData()},e.prototype.initData=function(){var t=bossControl.worldInfoList[5].concat();t.sort(this.compareFn);var e=bossControl.worldInfoList[6].concat();e.sort(this.compareFn);for(var i=0,n=0;n<t.length;n++){var o=t[n],s=DataCenter.ins().WorldBossConfig[o.id],r="("+s.zsLevel[0]+LangMgr.getValueByKey("numberRotation","")+"-"+s.zsLevel[1]+LangMgr.getValueByKey("numberRotation","")+")";if(this["redPoint"+n].visible=!1,i=s.type,o.canInto)if(this.setGwState(n,2),o.isDie){var a=o.relieveTime-egret.getTimer();a=0>a?0:a,r+="\n"+DateUtils.getFormatBySecond(Math.floor(a/1e3),1)}else this["redPoint"+n].visible=this.checkCanInto1(s.type)&&bossControl.getBossRemindByIndex(o.id);else this.setGwState(n,0);this["info"+n].text=r}for(var n=0;n<e.length;n++){var o=e[n],s=DataCenter.ins().WorldBossConfig[o.id],r=""+LangMgr.getValueByKey("chinese"+(n+1))+LangMgr.getValueByKey("babelLayer1","","")+"("+s.zsLevel[0]+LangMgr.getValueByKey("numberRotation","")+"-"+s.zsLevel[1]+LangMgr.getValueByKey("numberRotation","")+")";if(this["towerRedPoint"+n].visible=!1,o.canInto)if(this.setTopState(n,2),o.isDie){var a=o.relieveTime-egret.getTimer();a=0>a?0:a,r+="\n"+DateUtils.getFormatBySecond(Math.floor(a/1e3),1)}else this["towerRedPoint"+n].visible=this.checkCanInto(s.type)&&bossControl.getBossRemindByIndex(o.id);else this.setTopState(n,0);this["towerInfo"+n].text=r}this.leftTime.text=LangMgr.getValueByKey("godBelongTimes",bossControl.worldBossBelongTime[i]),this.asistTime.visible=bossControl.checkShowAsist(26),this.asistTime.visible&&(this.asistTime.textFlow=TextUtils.generateTextFlow1(bossControl.getAsistText()))},e.prototype.checkCanInto=function(t){var e=DataCenter.ins().WorldBossBaseConfig.challengeItemYb[t-1];if(ActorControl.yb>=e)return!0;var i=DataCenter.ins().WorldBossBaseConfig.challengeItem[t-1],n=backpackControl.getBagGoodsByTypeAndId(0,i);return n&&n.count>0},e.prototype.checkCanInto1=function(t){return bossControl.worldBossBelongTime[t]>0},e.prototype.setGwState=function(t,e){var i=["locked","normal","selected"];this["img"+t].source="gw_field_"+i[e]+"_"+t,this["titleBg"+t].source="gw_title_bg_"+(0==e?1:0),this["title"+t].source="gw_title_"+(0==e?"locked_":"")+(t+1),this["info"+t].textColor=0==e?LangMgr.getColor("color68"):LangMgr.getColor("color43")},e.prototype.setTopState=function(t,e){this["tower"+t].visible=0!=e,this["towerInfo"+t].textColor=0==e?LangMgr.getColor("color68"):LangMgr.getColor("color43")},e.prototype.onUpdateBoss=function(t){(5==t||6==t)&&this.initData()},e.prototype.compareFn=function(t,e){return t.id-e.id},e.prototype.onLink=function(){UIMgr.ins().open(PublicBossRemindView,5)},e.prototype.close=function(){this.removeEventTouchTap(this.gw0,this.onTap),this.removeEventTouchTap(this.gw1,this.onTap),this.removeEventTouchTap(this.gw2,this.onTap),this.removeEventTouchTap(this.tower,this.onTap),this.removeEventTextLink(this.remindTpis,this.onLink),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){var e=t.currentTarget;if(e!=this.tower){var i=this.getClickGwIndex(e);if(i>-1){var n=bossControl.worldInfoList[5].concat();if(n.sort(this.compareFn),n[i].canInto){var o=n[i],s=DataCenter.ins().WorldBossConfig[o.id];if(o.isDie)tipsControl.showTips(LangMgr.getValueByKey("godBossDied"));else if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{var r=Math.ceil((bossControl.worldBossCd[s.type]-egret.getTimer())/1e3);if(r>0)return tipsControl.showTips(LangMgr.getValueByKey("bossfightTime",r)),!1;bossControl.challengWorldBoss(o.id,s.type)}}}else if(i=this.getClickTowerIndex(e),i>-1){var n=bossControl.worldInfoList[6].concat();n.sort(this.compareFn),n[i].canInto&&UIMgr.ins().open(GodWeaponBossChallengeView,n[i])}}else for(var n=bossControl.worldInfoList[6].concat(),a=0,l=n;a<l.length;a++){var h=l[a];if(h.canInto){UIMgr.ins().open(GodWeaponBossChallengeView,h);break}}},e.prototype.getClickTowerIndex=function(t){for(var e=0;5>e;e++)if(t==this["tower"+e])return e;return-1},e.prototype.getClickGwIndex=function(t){for(var e=0;3>e;e++)if(t==this["gw"+e])return e;return-1},e}(BasePanel);__reflect(GodWeaponBossPanel.prototype,"GodWeaponBossPanel");var GodWeaponDunPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this._ary=new eui.ArrayCollection,this.checkRank.touchEnabled=!0,this.checkRank.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guanTitle1"))},e.prototype.open=function(){this.addEventTouchTap(this.checkRank,this.touchHandler),this.addEventTouchTap(this.challenge,this.touchHandler),this.addCustomEvent(50,this.updateView),this.addCustomEvent(51,this.updateRank),this.addCustomEvent(269,this.useToItem),this.list.dataProvider=this._ary,this.list.itemRenderer=GodWeaponDunItemRenderer,this.addEventItemTap(this.list,this.onTouchList),godWeaponControl.upDunInfo()},e.prototype.updateView=function(){godWeaponControl.upRankInfo(),this._ary.replaceAll(godWeaponControl.dunInfoData.listData);var t=godWeaponControl.dunInfoData.leftChallengeNum;this.countText.text=LangMgr.getValueByKey("godTodaySY",t),this.list.selectedIndex=0,this._selectData=this.list.selectedItem,this.rpImg.visible=godWeaponControl.dunInfoData.leftChallengeNum>0},e.prototype.updateRank=function(){var t=godWeaponControl.rankInfoDataAry,e=t.length;this.rank.visible=e>0;for(var i=0;3>i;i++){var n=t[i];this["rank"+(i+1)+"Img"].visible=null!=n,this["player"+(i+1)+"Name"].visible=null!=n,this["player"+(i+1)+"Rank"].visible=null!=n,this["player"+(i+1)+"Time"].visible=null!=n,n&&(this["player"+(i+1)+"Name"].text=n.nameStr,this["player"+(i+1)+"Rank"].text=LangMgr.getValueByKey("babelLayer1",n.floorNum,""),this["player"+(i+1)+"Time"].text=n.getTimeStr())}},e.prototype.useToItem=function(){this._isUser&&(this._isUser=!1,this._selectData&&godWeaponControl.upJoinDun(this._selectData.gridNum))},e.prototype.close=function(){this._selectData=null,this.removeEventTouchTap(this.checkRank,this.touchHandler),this.removeEventTouchTap(this.challenge,this.touchHandler),this.removeEventItemTap(this.list,this.onTouchList),this.removeCustomEvents(),this.list.dataProvider=null},e.prototype.touchHandler=function(t){if(t.target==this.challenge){if(!this.showTips())return;this._selectData&&godWeaponControl.upJoinDun(this._selectData.gridNum)}else t.target==this.checkRank&&UIMgr.ins().open(GodWeaponDunRankView)},e.prototype.onTouchList=function(t){this._selectData=this.list.selectedItem},e.prototype.showTips=function(){var t=godWeaponControl.dunInfoData.leftChallengeNum;if(t>0)return!0;var e="",i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().GodWeaponBaseConfig.fubenItem);return i?(e=LangMgr.getValueByKey("godUseAddTime",i.itemConfig.name),warnControl.show(e,function(){this._isUser=!0,backpackControl.upUseItem(i.configID,1)},this)):tipsControl.showTips(LangMgr.getValueByKey("sceneTips13")),!1},e}(BasePanel);__reflect(GodWeaponDunPanel.prototype,"GodWeaponDunPanel");var GodWeaponDunRankView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GodWeaponDunRankViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.touchEnabled=!0,this.addEventTouchTap(this.bgClose,this.touchHandler),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.touchHandler),this._ary=new eui.ArrayCollection,this.list.dataProvider=this._ary,this.list.itemRenderer=GodWeaponDunRankItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._ary.replaceAll(godWeaponControl.rankInfoDataAry)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.touchHandler),this.fgClose&&this.removeEventTouchEnd(this.fgClose,this.touchHandler),this.list.dataProvider=null},e.prototype.touchHandler=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GodWeaponDunRankView.prototype,"GodWeaponDunRankView");var GodWeaponDunRiseUpView=function(t){function e(){var e=t.call(this)||this;return e.isMax1=!1,e.isMax2=!1,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="GodWeaponDunRiseUpViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.gold.selected=!0,this.addEventTouchTap(this.gold,this.onTap),this.addEventTouchTap(this.yuanbao,this.onTap),this.addEventTouchTap(this.sureBtn,this.onTap),this.addEventTouchTap(this.cancelBtn,this.onTap),this.addCustomEvent(50,this.updateView),this.updateView()},e.prototype.updateView=function(){var t=godWeaponControl.dunInfoData,e=10*t.getBuyCount;this.now.text=LangMgr.getValueByKey("godGuWu",e),this.goldCost.text=DataCenter.ins().GodWeaponBaseConfig.buyBuff[0].moneyCount+"",this.yuanbaoCost.text=DataCenter.ins().GodWeaponBaseConfig.buyBuff[1].moneyCount+"";var i=t.buyTypeData(1);i[1]>=DataCenter.ins().GodWeaponBaseConfig.buyBuff[0].maxCount&&(this.gold.visible=!1,this.goldImg.visible=!1,this.goldCost.visible=!1,this.goldText.text=LangMgr.getValueByKey("godGuWu1"),this.isMax1=!0,this.gold.selected=!1),i=t.buyTypeData(2),i[1]>=DataCenter.ins().GodWeaponBaseConfig.buyBuff[1].maxCount&&(this.yuanbao.visible=!1,this.yuanbaoCost.visible=!1,this.yuanbaoImg.visible=!1,this.yuanbaoText.text=LangMgr.getValueByKey("godGuWu2"),this.isMax2=!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.gold,this.onTap),this.removeEventTouchTap(this.yuanbao,this.onTap),this.removeEventTouchTap(this.cancelBtn,this.onTap),this.removeEventTouchTap(this.cancelBtn,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){switch(t.target){case this.gold:this.yuanbao.selected=!1,this.gold.selected=!0;break;case this.yuanbao:this.yuanbao.selected=!0,this.gold.selected=!1;break;case this.cancelBtn:UIMgr.ins().close(this);break;case this.sureBtn:if(this.isMax2&&this.isMax1)return void tipsControl.showTips(LangMgr.getValueByKey("godGuWu3"));if(!this.yuanbao.selected&&!this.gold.selected)return void tipsControl.showTips(LangMgr.getValueByKey("godGuWu4"));if(this.gold.selected){if(ActorControl.gold<DataCenter.ins().GodWeaponBaseConfig.buyBuff[0].moneyCount)return void tipsControl.showCenterTips(LangMgr.getValueByKey("bossMoneyEnought"))}else if(ActorControl.yb<DataCenter.ins().GodWeaponBaseConfig.buyBuff[1].moneyCount)return void tipsControl.showCenterTips(LangMgr.getValueByKey("osaNoMoney"));godWeaponControl.upBuybuff(this.gold.selected?1:2);var e=DataCenter.ins().GodWeaponBaseConfig.buyBuff[1].maxCount+DataCenter.ins().GodWeaponBaseConfig.buyBuff[0].maxCount;godWeaponControl.dunInfoData.getBuyCount==e-1&&UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(GodWeaponDunRiseUpView.prototype,"GodWeaponDunRiseUpView");var GodWeaponItemMixPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHintEffectPlay=!1,e.isPlay=!1,e.COMPOUND_STATE="mix",e.FUSE_STATE="ultramix",e.PAGE_SIZE=5,e}return __extends(e,t),e.prototype.open=function(){this.mix1.touchChildren=!1,this.mix2.touchChildren=!1,this.mix3.touchChildren=!1,this.targetGroup.touchChildren=!1,this.mix.enabled=!1,this.list.itemRenderer=GodWeaponMixItemRenderer,this.labelEffect=new GameMovieClip,this.labelEffect.scaleX=.6,this.labelEffect.scaleY=.5,this.labelEffect.touchEnabled=!1,this.mixMaterialImg.source=DataCenter.ins().ItemConfig[200333].icon+"_png",this.hintEffect=new GameMovieClip,this.hintEffect.touchEnabled=!1,this.descTxt.alpha=1,this.materialItemId=200333,this.addViewEvent(),this.updateView()},e.prototype.close=function(){this.cleanTween(),this.removeCustomEvents(),this.removeEventTouchTap(this.turn,this.changeState),this.removeEventTouchTap(this.leftButton,this.prevPage),this.removeEventTouchTap(this.rightButton,this.nextPage),this.removeEventTouchTap(this.mix1,this.touchMixItem),this.removeEventTouchTap(this.mix2,this.touchMixItem),this.removeEventTouchTap(this.mix3,this.touchMixItem),this.removeEventTouchTap(this.mix,this.operate),this.removeEventTouchTap(this.mixMaterial,this.onTouch),this.removeEventItemTap(this.list,this.onListChange)},e.prototype.addViewEvent=function(){this.addEventTouchTap(this.turn,this.changeState),this.addEventTouchTap(this.leftButton,this.prevPage),this.addEventTouchTap(this.rightButton,this.nextPage),this.addEventTouchTap(this.mix1,this.touchMixItem),this.addEventTouchTap(this.mix2,this.touchMixItem),this.addEventTouchTap(this.mix3,this.touchMixItem),this.addEventTouchTap(this.mix,this.operate),this.addEventTouchTap(this.mixMaterial,this.onTouch),this.addEventItemTap(this.list,this.onListChange),this.addCustomEvent(599,this.onCompound),this.addCustomEvent(600,this.onFuse)},e.prototype.operate=function(){this.mix.enabled&&(this.currentState==this.FUSE_STATE?this.mixData1&&this.mixData2&&godWeaponItemControl.upFuse(this.mixData1.id,this.mixData2.id,this.isMaterial?1:0):this.mixData1&&this.mixData2&&this.mixData3&&godWeaponItemControl.upCompound(this.mixData1.id,this.mixData2.id,this.mixData3.id))},e.prototype.onCompound=function(t){var e=this;this.mix.enabled=!1,this.isMaterial=!1,this.addEffect(),TimerMgr.ins().doTimerDelay(300,0,1,function(){e.addEffect(function(){e.updateView(),e.updateTargetItem(t.id),e.addResultEffect(t.isSuccess,t.id,!0)})},this)},e.prototype.addResultEffect=function(t,e,i){var n=this;void 0===i&&(i=!1);var o=new GameMovieClip;o.x=this.targetGroup.width/2,this.targetGroup.addChild(o);var s;t?(s=PATH_EFF+"forgeSuccess",o.y=this.targetGroup.height/2-15):(s=PATH_EFF+"litboom",o.y=this.targetGroup.height/2),o.playFile(s,1,function(){i||n.cleanEff(),e&&(i||t)&&n.flyItem(e)})},e.prototype.playEff=function(t){var e=this;if(!this.isPlay){var i=PATH_EFF+"jljdt";this.isPlay=!0;var n=1,o=new GameMovieClip;o.playFile(i,-1),this.leftEff.addChild(o),o.scaleX=0,o.scaleY=.6;var s=new GameMovieClip;s.playFile(i,-1),this.rightEff.addChild(s),s.scaleX=0,s.scaleY=.6;var r=new GameMovieClip;r.playFile(i,-1),this.buttonEff.addChild(r),r.x+=14,r.scaleX=0,r.scaleY=.6,r.$setRotation(90);var a=.23,l=egret.Tween.get(o),h=egret.Tween.get(s);h.to({scaleX:a},250*n),l.to({scaleX:a},250*n).call(function(){var i=egret.Tween.get(r);i.to({scaleX:.35},250*n).call(function(){e.isPlay=!1,t&&t.call(e)})})}},e.prototype.cleanEff=function(){this.leftEff.removeChildren(),this.rightEff.removeChildren(),this.buttonEff.removeChildren()},e.prototype.addEffect=function(t){var e=this,i=new GameMovieClip;i.scaleX=3,i.scaleY=3,i.x=this.targetGroup.width/2-4,i.y=this.targetGroup.height/2-7,this.targetGroup.addChild(i),i.playFile(PATH_EFF+"forceguildeff",1,function(){t&&t.call(e)})},e.prototype.onFuse=function(t){var e=this;this.mix.enabled=!1,this.isMaterial=!1;var i,n=t.isSuccess;!n&&this.mixData1&&(i=new GodWeaponItemVo(this.mixData1.id,this.mixData1.count,this.mixData1.quality)),this.playEff(function(){e.updateView(),e.updateTargetItem(t.id),!n&&i&&(e.updateMixItem(1,i),e.mixData1&&e.currentState==e.FUSE_STATE&&(e.page=new Page(e.updateMixData(),e.PAGE_SIZE),e.setPageData())),e.addResultEffect(n,t.id)})},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=this.targetGroup.x,e.y=this.targetGroup.y,e.data=t,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,this.targetGroup.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.touchMixItem=function(t){var e=t.target,i=1;e==this.mix1?i=1:e==this.mix2?i=2:e==this.mix3&&(i=3),this["mixData"+i]||this.addHintEffect(),this.updateMixItem(i),this.currentState!=this.FUSE_STATE?this.setCompoundState(!1):(this.updateTargetItem(),1==i&&this.updateMixItem(2)),this.page=new Page(this.updateMixData(),this.PAGE_SIZE),this.setPageData()},e.prototype.updateTargetItem=function(t){if(void 0===t&&(t=0),t){var e=DataCenter.ins().ItemConfig[t];this.targetImg.visible=!0,this.targetImg.source=e.icon+"_png",this.targetLabel.text=e.name,this.targetLabel.textColor=ItemUtils.getQualityColor(e)}else{var i=this.isCanCompound();this.setCompoundState(i),this.targetLabel.textColor=ColorUtils.NORMAL_COLOR,this.targetImg.source="",this.targetImg.visible=!1}},e.prototype.setCompoundState=function(t){var e=t?LangMgr.getValueByKey("godRandomGod"):"";this.targetLabel.text=e,this.targetRandom.visible=t,this.mixline0Effect.visible=t,this.mixline1Effect.visible=t},e.prototype.updateMixItem=function(t,e){void 0===e&&(e=null);var i=this["mix"+t+"Img"],n=this["mix"+t+"Name"];if(e){i.visible=!0;var o=DataCenter.ins().ItemConfig[e.id];i.source=o.icon+"_png",n.text=o.name,n.textColor=ItemUtils.getQualityColor(o)}else n.text="",i.visible=!1;this["mixData"+t]=e},e.prototype.addHintEffect=function(){var t=this;this.isHintEffectPlay||(DisplayUtils.removeFromParent(this.hintEffect),this.list.addChild(this.hintEffect),this.isHintEffectPlay=!0,this.hintEffect.x=241,this.hintEffect.y=49,this.hintEffect.playFile(PATH_EFF+"mixhint",1,function(){t.isHintEffectPlay=!1}))},e.prototype.onListChange=function(){var t=this.list.selectedItem,e=this.setMixData(t);if(e){var i=this.isCanFuse();i||this.updateTargetItem(),this.page=new Page(this.updateMixData(),this.PAGE_SIZE),this.setPageData()}else tipsControl.showTips(LangMgr.getValueByKey("godGoodsMan"))},e.prototype.setMixData=function(t){if(this.currentState==this.FUSE_STATE){var e=this.isCanFuse();if(e)return!1;var i=1;return this.mixData1?this.mixData2||(this.mixData2=t,i=2):(this.mixData1=t,i=1),this.updateMixItem(i,t),!0}var n=this.isCanCompound();if(n)return!1;var i=1;return this.mixData1?this.mixData2?this.mixData3||(this.mixData3=t,i=3):(this.mixData2=t,i=2):(this.mixData1=t,i=1),this.updateMixItem(i,t),!0},e.prototype.isCanCompound=function(){return this.mixData1&&this.mixData2&&this.mixData3&&this.currentState!=this.FUSE_STATE},e.prototype.isCanFuse=function(){return this.mixData1&&this.mixData2&&this.currentState==this.FUSE_STATE},e.prototype.updateMixData=function(){var t=this.dataList.concat();if(this.currentState==this.FUSE_STATE){this.mixData1&&(t=godWeaponItemControl.filterFuseItemList(this.mixData1,t)),this.mixData2&&(t=godWeaponItemControl.filterFuseItemList(this.mixData2,t));var e=this.isCanFuse();this.mix.enabled=e,e&&this.updateTargetItem(godWeaponItemControl.getFuseTargetItem(this.mixData1.id,this.mixData2.id))}else this.mixData1&&(t=godWeaponItemControl.filterCompoundItemList(this.mixData1,t)),this.mixData2&&(t=godWeaponItemControl.filterCompoundItemList(this.mixData2,t)),this.mixData3&&(t=godWeaponItemControl.filterCompoundItemList(this.mixData3,t)),this.mix.enabled=this.isCanCompound();return t},e.prototype.changeState=function(){this.currentState==this.FUSE_STATE?this.currentState=this.COMPOUND_STATE:this.currentState=this.FUSE_STATE,this.updateView()},e.prototype.prevPage=function(){this.page.prev(),this.setPageData()},e.prototype.nextPage=function(){this.page.next(),this.setPageData()},e.prototype.setPageData=function(){this.leftButton.visible=this.page.havePre(),this.rightButton.visible=this.page.haveNext(),this.list.dataProvider=new ArrayCollection(this.page.pageData)},e.prototype.clearView=function(){for(var t=1;4>t;t++)this["mixData"+t]=null,this.updateMixItem(t);this.updateTargetItem()},e.prototype.updateView=function(){var t,e,i;this.clearView(),this.currentState==this.FUSE_STATE?(t=godWeaponItemControl.getFuseItemList(),e=LangMgr.getValueByKey("godGodHC1"),i=godWeaponItemControl.isCanCompound(),this.startTween()):(t=godWeaponItemControl.getCompoundItemList(),e=LangMgr.getValueByKey("godGodHC2"),i=godWeaponItemControl.isCanFuse(),this.cleanTween()),i?this.addLabelEffect():this.removeLabelEffect(),this.turn.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+e+"</u></a>"),this.dataList=godWeaponItemControl.toList(t),this.noItemDesc.visible=0==this.dataList.length,this.page=new Page(this.dataList,this.PAGE_SIZE),this.setPageData(),this.updateRelic()},e.prototype.addLabelEffect=function(){var t=this;TimerMgr.ins().doNext(function(){DisplayUtils.removeFromParent(t.labelEffect),t.labelEffect.x=t.turn.x+37,t.labelEffect.y=t.turn.y+11,null==t.labelEffect.parent&&t.turn.parent.addChild(t.labelEffect),t.labelEffect.playFile(PATH_EFF+"chargeff1",-1)},this)},e.prototype.removeLabelEffect=function(){this.labelEffect.stop(),DisplayUtils.removeFromParent(this.labelEffect)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.mixMaterial:if(this.isMaterial)this.isMaterial=!1,this.addRelic();else{var e=backpackControl.getBagItemById(this.materialItemId);e?(this.isMaterial=!0,this.addRelic()):(this.isMaterial=!1,warnControl.setBuyGoodsWarn(this.materialItemId))}}},e.prototype.updateRelic=function(){this.descTxt.text=this.isMaterial?LangMgr.getValueByKey("godPartSucces"):LangMgr.getValueByKey("godAdd"),this.isMaterial?(this.setLight(this.mixMaterialImg),this.setLight(this.mixlabel)):(this.setGray(this.mixMaterialImg),this.setGray(this.mixlabel))},e.prototype.addRelic=function(){this.updateRelic(),this.isMaterial?this.cleanTween():this.startTween()},e.prototype.startTween=function(){this.isMaterial||(this.cleanTween(),this.descTxt.alpha=0,this.playTween())},e.prototype.playTween=function(){if(!this.tw){this.tw=egret.Tween.get(this.descTxt,{loop:!0});var t=this.descTxt.alpha?0:1;this.tw.to({alpha:t},600).to({alpha:1-t},600)}},e.prototype.cleanTween=function(){this.descTxt.alpha=1,this.tw&&egret.Tween.removeTweens(this.descTxt),this.tw=null},e.prototype.setGray=function(t){t.filters=FilterUtils.ARRAY_GRAY_FILTER,this.materialTxt.visible=this.materialTxtImg.visible=!0},e.prototype.setLight=function(t){t.filters=[],this.materialTxt.visible=this.materialTxtImg.visible=!1},e}(BasePanel);__reflect(GodWeaponItemMixPanel.prototype,"GodWeaponItemMixPanel");var GodWeaponPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectIndex=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.clickRect.touchEnabled=!0,this.expschedule.mask=this.maskRect,this.detailBtn.touchEnabled=!0,this.maskPro.touchEnabled=!1,this.progressImg.mask=this.maskPro,this.progressHeadImg=new eui.Image,this.exp.addChild(this.progressHeadImg),this.progressHeadImg.y=35,this.flameMC=new GameMovieClip,this.flameMC.x=120,this.flameMC.y=30,this.power.addChildAt(this.flameMC,0),this.powerCon=BitmapNumber.ins().createNumPic(0,"8",5),this.powerCon.scaleX=this.power.scaleY=.8,this.powerCon.x=105,this.powerCon.y=20,this.power.addChild(this.powerCon),this.reset.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.reset.text)},e.prototype.open=function(){this.addEventTouchTap(this.weapon0,this.touchHandler),this.addEventTouchTap(this.weapon1,this.touchHandler),this.addEventTouchTap(this.weapon2,this.touchHandler),this.addEventTouchTap(this.clickRect,this.touchHandler),this.addEventTouchTap(this.detailBtn,this.touchHandler),this.addEventTouchTap(this.reset,this.touchHandler),this.addCustomEvent(49,this.updateView),this.addCustomEvent(48,this.updateGwExp),this.addCustomEvent(52,this.updateView),this.addCustomEvent(603,this.showRedPoint),this.addCustomEvent(604,this.showRedPoint),this.addCustomEvent(605,this.showRedPoint);for(var t=1;5>=t;t++)this["relic"+t].touchEnabled=!0,this["relic"+t].touchChildren=!1,this.addEventTouchTap(this["relic"+t],this.touchHandler);this.selectIndex=this.getSelectedIndex(),this.flameMC.playFile(PATH_EFF+"zhanduolibeijing",-1),this.godweaponskill.open()},e.prototype.getSelectedIndex=function(){return godWeaponControl.gwTask.taskIdx?godWeaponControl.gwTask.weapon-1:0},Object.defineProperty(e.prototype,"selectIndex",{get:function(){return this._selectIndex},set:function(t){this._selectIndex=t;var e=godWeaponControl.weaponIsActive(t+1);e?this.showWeapon():this.showTask(),this.selectBtnImage(),this.showRedPoint(),this.reset.visible=e},enumerable:!0,configurable:!0}),e.prototype.showTask=function(){this.currentState="task",this.validateNow(),this.gwTask.open(this._selectIndex)},e.prototype.showWeapon=function(){this.currentState="active",this.validateNow();var t=this._selectIndex;this._curWeapon=godWeaponControl.getWeaponData(t+1),this.godweaponskill.selectIndex=t;var e=t+1;this.weaponName.source="godweapon_name"+e,this.needExp.text="("+this._curWeapon.curExp+"/"+this._curWeapon.config.exp+")",this.lvCount.text="Lv."+this._curWeapon.curLv,0==this._curWeapon.skillPoint?this.curPointLabel.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("godTips1")):this.curPointLabel.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("godTips2")+this._curWeapon.skillPoint),this.updateGwExp(),this.expschedule.visible=!0;var i,n=this._curWeapon.config.everyExp,o=2*n,s=godWeaponControl.curExp;o>s?(i=1*s/o,0>i&&(i=0)):i=1;var r=egret.Tween.get(this.maskRect);r.to({scaleY:i},200),this.updateGodItemView(),this.progressHeadImg.source="godweapon_expfront",i=1*this._curWeapon.curExp/this._curWeapon.config.exp,r=egret.Tween.get(this.maskPro,{onChange:this.funcChange,onChangeObj:this}),r.to({scaleX:i},200)},e.prototype.selectBtnImage=function(){this.selectIcon0.visible=0==this._selectIndex,this.selectIcon1.visible=1==this._selectIndex,this.selectIcon2.visible=2==this._selectIndex},e.prototype.showRedPoint=function(){var t=godWeaponControl.maxLvRedPoint();t?(this.rpImg0.visible=godWeaponControl.weaponIsActive(1),this.rpImg1.visible=godWeaponControl.weaponIsActive(2),this.rpImg2.visible=godWeaponControl.weaponIsActive(3),this.rpImgExp.visible=!0):(this.rpImg0.visible=GodWeaponRedPoint.ins().gwRed1,this.rpImg1.visible=GodWeaponRedPoint.ins().gwRed2,this.rpImg2.visible=GodWeaponRedPoint.ins().gwRed3,this.rpImgExp.visible=!1)},e.prototype.funcChange=function(){341*this.maskPro.scaleX<18?(this.progressHeadImg.x=130,this.progressHeadImg.scaleX=1*(341*this.maskPro.scaleX)/18):(this.progressHeadImg.x=130+341*this.maskPro.scaleX-18,this.progressHeadImg.scaleX=1)
},e.prototype.updateGodItemView=function(){for(var t=0;5>t;t++)this["relic"+(t+1)].updateView(godWeaponControl.getRelicItemData(this._selectIndex+1,t+1))},e.prototype.updatePower=function(){var t=godWeaponControl.gwAddAttr(this.selectIndex),e=BackpackControl.getAttrPower(t);if(godWeaponControl.weaponIsActive(this._selectIndex+1)){for(var i=0,n=void 0,o=godWeaponControl.maxSkillIdAry[this.selectIndex],s=0;o>s;s++)n=godWeaponControl.getWeaponSkinIdData(this.selectIndex+1,s),n.isOpen&&(i+=n.skillPower);e+=i}BitmapNumber.ins().changeNum(this.powerCon,e,"8",5)},e.prototype.updateView=function(){this.selectIndex=this.selectIndex},e.prototype.updateGwExp=function(){this.updatePower(),this.expcount.text=""+godWeaponControl.curExp},e.prototype.touchHandler=function(t){if(t.target instanceof eui.Button)switch(t.target){case this.weapon0:this.selectIndex=0;break;case this.weapon1:this.selectIndex=1;break;case this.weapon2:this.selectIndex=2}else if(t.target instanceof GodWeaponRelicItem){var e=void 0;switch(t.target){case this.relic1:e=1;break;case this.relic2:e=2;break;case this.relic3:e=3;break;case this.relic4:e=4;break;case this.relic5:e=5}this.inlayItem(e)}else if(t.target==this.clickRect){var i=godWeaponControl.getWeaponData(this.selectIndex+1);if(i&&i.config.everyExp>godWeaponControl.curExp)return void tipsControl.showTips(LangMgr.getValueByKey("godExpNo"));godWeaponControl.gwshowTips=!0,godWeaponControl.roleshowTips=heroControl.subRolesLen,godWeaponControl.upUpWeapon(this.selectIndex+1)}else t.target==this.detailBtn?UIMgr.ins().open(GodWeaponAddAttrView,this.selectIndex):t.target==this.reset&&UIMgr.ins().open(GodWeaponResetView,godWeaponControl.getWeaponData(this.selectIndex+1))},e.prototype.inlayItem=function(t){var e=godWeaponControl.getRelicItemData(this._selectIndex+1,t);e.isOpen?UIMgr.ins().open(GodWeaponRelicChooseView,e):tipsControl.showTips(LangMgr.getValueByKey("godOpenLevel",e.openLv))},e.prototype.close=function(){this.godweaponskill.close(),this.removeEventTouchTap(this.weapon0,this.touchHandler),this.removeEventTouchTap(this.weapon1,this.touchHandler),this.removeEventTouchTap(this.weapon2,this.touchHandler),this.removeEventTouchTap(this.clickRect,this.touchHandler),this.removeEventTouchTap(this.detailBtn,this.touchHandler);for(var t=1;5>=t;t++)this.removeEventTouchTap(this["relic"+t],this.touchHandler);this.removeCustomEvents()},e}(BasePanel);__reflect(GodWeaponPanel.prototype,"GodWeaponPanel");var GodWeaponRelicChooseView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodWeaponRelicChooseViewSkin",this._aryDate=new eui.ArrayCollection,this.list.dataProvider=this._aryDate,this.list.itemRenderer=GodWeaponChooseRelicItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._data=t[0],this.addEventTouchTap(this.bgClose,this.closeHandler),this.addEventTouchTap(this.list,this.clickHandler),this.updateView()},e.prototype.updateView=function(){var t=e.getGwItemType(this._data);if(t.sort(this.sortFun),this._data.itemId){var i=new GodWeaponRelicItemVo;i.itemId=this._data.itemId,i.weaponId=this._data.weaponId,i.isCur=!0,t.unshift(i)}this.tipLabel2.visible=0==t.length,this._aryDate.replaceAll(t)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.closeHandler),this.removeEventTouchTap(this.list,this.clickHandler),this.list.dataProvider=null},e.prototype.closeHandler=function(t){UIMgr.ins().close(this)},e.prototype.clickHandler=function(t){if(t.target instanceof eui.Button){var e=t.target.parent;godWeaponControl.upInlayItem(this._data.weaponId,this._data.pos,e.datathis.itemId),UIMgr.ins().close(this)}},e.getGwItemType=function(t){var i=[],n=backpackControl.bagModel[BackpackControl.BAG_TYPE_OTHTER],o=0;if(n)for(var s=0;s<n.length;s++){ItemUtils.getType(n[s].itemConfig),ItemUtils.getJob(n[s].itemConfig);if(15==ItemUtils.getType(n[s].itemConfig)&&ItemUtils.getJob(n[s].itemConfig)==t.weaponId)for(o=0;o<n[s].count;o++){var r=new GodWeaponRelicItemVo;r.itemId=n[s].configID,r.weaponId=t.weaponId,i.push(r)}}var a=godWeaponControl.allRelicItemData[t.weaponId];a=a.concat();var l={};for(o=0;o<a.length;o++)a[o].itemId&&(void 0==l[a[o].itemId]?l[a[o].itemId]=1:l[a[o].itemId]++);for(o=0;o<a.length;o++)if(a[o].itemId&&a[o].config.onlyOne){a[o].config.onlyOne;a[o].config.onlyOne==l[a[o].itemId]&&(e.deleteItemData(a[o].itemId,i),delete l[a[o].itemId])}return i},e.prototype.sortFun=function(t,e){return e.power-t.power},e.deleteItemData=function(t,e){for(var i=0;i<e.length;i++)e[i].itemId==t&&e.splice(i--,1)},e}(BaseEuiView);__reflect(GodWeaponRelicChooseView.prototype,"GodWeaponRelicChooseView");var GodWeaponRelicItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.updateView=function(t){this.data=t,t?t.isOpen?t.itemConfig?(this.shengwuImg.source=t.itemConfig.icon+"_png",this.shengwuImg.visible=!0,this.add.visible=!1,this.rpImgAdd.visible=!1,this.frame.source="godweapon_quality"+(ItemUtils.getQuality(t.itemConfig)+1)):(this.shengwuImg.visible=!1,this.add.visible=!0,this.frame.source="godweapon_quality1",this.rpImgAdd.visible=GodWeaponRelicChooseView.getGwItemType(t).length>0):(this.shengwuImg.visible=!1,this.add.visible=!1,this.rpImgAdd.visible=!1,this.frame.source="godweapon_quality0"):(this.frame.source="godweapon_quality0",this.add.visible=!1,this.shengwuImg.visible=!1,this.rpImgAdd.visible=!1)},e}(eui.Component);__reflect(GodWeaponRelicItem.prototype,"GodWeaponRelicItem");var GodWeaponResetView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GodWeaponResetViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.price.setType(2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgclose,this.onTouch),this.addEventTouchTap(this.resetBtn,this.onTouch),this.price.setPrice(DataCenter.ins().GodWeaponBaseConfig.skillResetCost),this._dataWeapon=t[0];var i=this._dataWeapon.getResetPoint();this.resetDesc.text=i>0?LangMgr.getValueByKey("godRestSkill",i):LangMgr.getValueByKey("godNoSkill"),this.gwName.text=this._dataWeapon.getWeaponName(),this.resetBtn.enabled=i>0&&ActorControl.yb>=DataCenter.ins().GodWeaponBaseConfig.skillResetCost},e.prototype.onTouch=function(t){switch(t.target){case this.bgclose:UIMgr.ins().close(this);break;case this.resetBtn:godWeaponControl.upReset(this._dataWeapon.weaponId),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(GodWeaponResetView.prototype,"GodWeaponResetView");var GodWeaponResultView=function(t){function e(){var e=t.call(this)||this;return e._pFNum=4,e.secNum=5,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodWeaponResultViewSkin",this.addEventTouchTap(this.closeBtn,this.touchHandler),this.addEventTouchTap(this.get,this.touchHandler),this.addEventTouchTap(this.closenoget,this.touchHandler),this._ary=new eui.ArrayCollection,this.listCoin.dataProvider=this._ary,this.listCoin.itemRenderer=GodWeaponDunRewardItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._fubenId=t[0],this._pFNum=t[1];var i,n,o=null==t[2]?-1:t[2];for(var s in DataCenter.ins().GodWeaponFubenConfig)if(DataCenter.ins().GodWeaponFubenConfig[s].fbId==this._fubenId){i=DataCenter.ins().GodWeaponFubenConfig[s],n=parseInt(s);break}var r;if(-1==o)this.time.text=LangMgr.getValueByKey("godNoKillBoss"),this.gaptime.visible=!1,this.get.visible=!0,this.closenoget.visible=!0,this.closeBtn.visible=!1,this.noget.visible=!0,r=!1;else if(this.time.text=DateUtils.getFormatBySecond(o,DateUtils.TIME_FORMAT_3),1!=this._pFNum){this.gaptime.visible=!0,this.get.visible=!0,this.closenoget.visible=!0,this.closeBtn.visible=!1;var a=Math.abs(o-DataCenter.ins().GodWeaponBaseConfig.fbGrade[0]);this.gaptime.text=LangMgr.getValueByKey("godScend",a),this.noget.visible=!0,r=!1}else this.gaptime.visible=!1,this.get.visible=!1,this.closenoget.visible=!1,this.closeBtn.visible=!0,this.noget.visible=!1,r=!0;var l=i.award[this._pFNum].concat();copyControl.oldMijingPoint;if(1!=copyControl.oldMijingPoint&&1==this._pFNum){var h=i.firstAward.concat();l=l.concat(h)}for(var u=[],p=0;p<l.length;p++){var c=new GodWeaponDunShowItemVo;c.data=l[p],c.index=p+1,c.start=i.award[1].length,c.floorNum=n,u.push(c)}if(this._ary.replaceAll(u),this.rank.source="godweapon_rank"+this._pFNum,r){this.updateCloseBtnLabel();var d=this.secNum;TimerMgr.ins().doTimer(1e3,d,this.updateCloseBtnLabel,this)}},e.prototype.updateCloseBtnLabel=function(){this.secNum--,this.secNum<=0&&(UIMgr.ins().close(this),godWeaponControl.upGetAward()),this.closeBtn.label=LangMgr.getValueByKey("babelExit",this.secNum)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.touchHandler),this.removeEventTouchTap(this.get,this.touchHandler),this.removeEventTouchTap(this.closenoget,this.touchHandler),this.listCoin.dataProvider=null,TimerMgr.ins().remove(this.updateCloseBtnLabel,this),MapControl.copyId>0&&copyControl.upExitFb(),21==MapControl.copyType&&UIMgr.ins().open(GodWeaponView,1)},e.prototype.touchHandler=function(t){t.currentTarget==this.closeBtn?(godWeaponControl.upGetAward(),UIMgr.ins().close(this)):t.currentTarget==this.get?(godWeaponControl.upGetAward(),UIMgr.ins().close(this)):t.currentTarget==this.closenoget&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GodWeaponResultView.prototype,"GodWeaponResultView");var GodWeaponSkillIcon=function(t){function e(){var e=t.call(this)||this;return e._isFirst=!1,e.imgLight=!1,e.skinName="GodWeaponSkillIconSkin",e.glowImg.visible=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=!1},e.prototype.updateView=function(t,e){if(this.dataThis=t,0==this._isFirst&&(this.validateNow(),this._isFirst=!0),t.isOpen||this.imgLight){var i=godWeaponControl.getWeaponData(e+1);if(t.skillLv<t.config.upLevel&&i&&i.skillPoint>0)switch(this._effect||(this._effect=new GameMovieClip,this.addChildAt(this._effect,3)),this._effect.name||(this._effect.playFile(PATH_EFF+"actIconCircle",-1),this._effect.x=45,this._effect.y=45),this.dataThis.skillId){case 16:case 15:case 14:case 13:this._effect.scaleX=this._effect.scaleY=1.1;break;default:this._effect.scaleX=this._effect.scaleY=.6}else this._effect&&this._effect.dispose();this.img.source=t.config.iconId+"_N"}else this.glowImg.visible=!1,this.img.source=t.config.iconId+"_L",this._effect&&this._effect.dispose();t.addLv>0||t.skillLv>0||t.isOpen?(this.lvCount.visible=!0,this.lvFrame.visible=!0,t.addLv>0&&(this.lvCount.textColor=LangMgr.getColor("color69")),16==this.dataThis.skillId?this.lvCount.text=t.lvLabel(!0):this.lvCount.text=t.lvLabel()):(this.lvCount.visible=!1,this.lvFrame.visible=!1)},e.prototype.close=function(){this.dataThis=null,this._effect&&this._effect.dispose()},e}(eui.Component);__reflect(GodWeaponSkillIcon.prototype,"GodWeaponSkillIcon");var GodWeaponSkillPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=!1},e.prototype.open=function(){this.addEventTouchTap(this,this.touchHandler)},Object.defineProperty(e.prototype,"selectIndex",{get:function(){return this._selectIndex},set:function(t){this._selectIndex=t,this.updateView(t)},enumerable:!0,configurable:!0}),e.prototype.updateView=function(t){this.skill_wp1.visible=0==t,this.skill_wp2.visible=1==t,this.skill_wp3.visible=2==t,this.updateWp(t)},e.prototype.updateWp=function(t){this.max||(this.max=godWeaponControl.maxSkillIdAry[t]);for(var e,i,n=[],o=0;o<this.max;o++)if(e=this.getWpSkill(t+1,o),i=godWeaponControl.getWeaponSkinIdData(t+1,o),e.updateView(i,t),i&&i.isOpen&&i.config.lineId)for(var s=0;s<i.config.lineId.length;s++)this["wp"+(t+1)+"_lock"+i.config.lineId[s]].visible=!1,this["wp"+(t+1)+"_unlock"+i.config.lineId[s]].visible=!0,-1==n.indexOf(i.config.lineId[s])&&n.push(i.config.lineId[s]);else-1==n.indexOf(o)&&(this["wp"+(t+1)+"_lock"+o].visible=!0,this["wp"+(t+1)+"_unlock"+o].visible=!1)},e.prototype.touchHandler=function(t){if(t.target instanceof GodWeaponSkillIcon){t.target.dataThis;UIMgr.ins().open(GodWeaponSkillTipView,t.target.dataThis)}},e.prototype.getWpSkill=function(t,e){return this["wp"+t+"_skill"+e]},e.prototype.close=function(){if(this.removeEventTouchTap(this,this.touchHandler),this.max)for(var t=0;3>t;t++)for(var e=void 0,i=0;i<this.max;i++)e=this.getWpSkill(t+1,i),e.close()},e}(BasePanel);__reflect(GodWeaponSkillPanel.prototype,"GodWeaponSkillPanel");var GodWeaponSkillTipView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodWeaponSkillTipViewSkin",this.bgClose.touchEnabled=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._dataInfo=t[0],this.addEventTouchTap(this.update,this.touchHandler),this.addEventTouchTap(this.bgClose,this.closeHandler),this.addCustomEvent(49,this.updateView),this.updateView()},e.prototype.updateView=function(){var t=godWeaponControl.getWeaponData(this._dataInfo.weaponId);16==this._dataInfo.skillId?(this.currentState="max",this._dataInfo.isOpen?(this.update.visible=!0,this.pointCount.visible=!0,this.unlockDesc.visible=!1,this.unlcokTitle.visible=!1,this.validateNow(),t&&0!=t.skillPoint?this.pointCount.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("godTips2")+t.skillPoint):this.pointCount.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("godTips1")),0==this._dataInfo.skillLv?(this.nowskillDesc.text=LangMgr.getValueByKey("godTips3",this._dataInfo.config.skillName),this.ultraskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addExAttrstr(1))):(this.nowskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addAttrValyeType(this._dataInfo.skillLv)),this.ultraskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addExAttrstr(this._dataInfo.skillLv))),this.nextskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addAttrValyeType(this._dataInfo.skillLv+1)),this.skillImg.source=this._dataInfo.config.iconId+"_N"):(this.validateNow(),this.update.visible=!1,this.pointCount.visible=!1,this.unlcokTitle.visible=!0,this.unlockDesc.visible=!0,this.unlockDesc.text=this._dataInfo.openTip,this.skillImg.source=this._dataInfo.config.iconId+"_L",this.nowskillDesc.text=LangMgr.getValueByKey("godTips3",this._dataInfo.config.skillName),this.ultraskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addExAttrstr(1)),this.nextskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addAttrValyeType(this._dataInfo.skillLv+1)))):this._dataInfo.isOpen?(this.validateNow(),this._dataInfo.skillLv<this._dataInfo.config.upLevel?(this.currentState="normal",t&&0!=t.skillPoint?this.pointCount.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("godTips2")+t.skillPoint):this.pointCount.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("godTips1"))):this.currentState="fullLv",0==this._dataInfo.skillLv?this.nowskillDesc.text=LangMgr.getValueByKey("godTips3",this._dataInfo.config.skillName):(this.nowskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addatrStr(this._dataInfo.skillLv)),this._dataInfo.config.skill&&(this.nowskillDesc.textFlow=TextUtils.generateTextFlow(this._dataInfo.specialSkill(this._dataInfo.skillLv))),this.descTextAlign(this.nowskillDesc)),this.nextskillDesc.textFlow=(new egret.HtmlTextParser).parser(this._dataInfo.addatrStr(this._dataInfo.skillLv+1)),this._dataInfo.config.skill&&(this.nextskillDesc.textFlow=TextUtils.generateTextFlow(this._dataInfo.specialSkill(this._dataInfo.skillLv+1))),this.descTextAlign(this.nextskillDesc),this.skillImg.source=this._dataInfo.config.iconId+"_N"):(this.validateNow(),this.currentState="lock",this.nowskillDesc.textFlow=TextUtils.generateTextFlow(this._dataInfo.config.lockDesc),this.descTextAlign(this.nowskillDesc),this.unlockDesc.text=this._dataInfo.openTip,this.skillImg.source=this._dataInfo.config.iconId+"_L"),this.skillName.text=this._dataInfo.config.skillName,16==this._dataInfo.skillId?this.lvCount.text=this._dataInfo.lvLabel(!0):this.lvCount.text=this._dataInfo.lvLabel();var e=godWeaponControl.getWeaponData(this._dataInfo.weaponId),i=e&&e.skillPoint||0;this.update.enabled=i>0},e.prototype.descTextAlign=function(t){this._dataInfo.config.attr?t.textAlign="center":t.numLines>=2?t.textAlign="left":t.textAlign="center"},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.update,this.touchHandler),this.removeEventTouchTap(this.bgClose,this.closeHandler),this.removeCustomEvents()},e.prototype.touchHandler=function(t){if(this._dataInfo.skillLv>=this._dataInfo.config.upLevel)return void tipsControl.showTips(LangMgr.getValueByKey("godTips4"));var e=godWeaponControl.getWeaponData(this._dataInfo.weaponId),i=e&&e.skillPoint||0;return 0>=i?void tipsControl.showTips(LangMgr.getValueByKey("godTips5")):(godWeaponControl.gwshowTips=!0,godWeaponControl.roleshowTips=heroControl.subRolesLen,void godWeaponControl.upUpSkill(this._dataInfo.weaponId,this._dataInfo.skillId))},e.prototype.closeHandler=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GodWeaponSkillTipView.prototype,"GodWeaponSkillTipView");var GodWeaponTaskPanel=function(t){function e(){var e=t.call(this)||this;return e._state=0,e._weaponId=1,e.skinName="GodWeaponTaskPanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.btn,this.onTap),this.setSelectIndex(t)},e.prototype.close=function(){this.removeEventTouchTap(this.btn,this.onTap)},e.prototype.setSelectIndex=function(t){var e=this._weaponId=t+1;this.initSkill();var i=LangMgr.getValueByKey("godActivity",LangMgr.getValueByKey("godType"+(t+1)));this.bg.source="godweapon_weaponBG"+e+"_png",this.imgJob1.visible=0==t,this.imgJob2.visible=1==t,this.imgJob3.visible=2==t,this.lblTaskInit.visible=!1,this.lblTaskContent.visible=!1,this.lblTaskDone.visible=!1;var n=godWeaponControl.gwTask;if(!godWeaponControl.weaponIsActive(e))if(n.taskIdx&&n.weapon==e){var o=DataCenter.ins().GodWeaponTaskConfig[n.weaponIdx][n.taskIdx],s=Object.keys(DataCenter.ins().GodWeaponTaskConfig[n.weaponIdx]).length;n.statue==GodWeaponTaskVo.DOING?(i+="|C:"+LangMgr.getColor("color22")+"&T:("+(n.taskIdx-1)+"/"+s+")|",this.taskLabel.textFlow=TextUtils.generateTextFlow1(i),this.lblTaskContent.visible=!0,this.lblTaskContent.textFlow=TextUtils.generateTextFlow1(n.taskIdx+"."+o.desc+(o.itemName[n.weapon-1]||"")+"|C:"+LangMgr.getColor("color22")+"&T:("+n.progress+"/"+o.target+")|"),this.btn.label=LangMgr.getValueByKey("artRenderer1"),this._state=1,this.removeTaskMc()):n.statue==GodWeaponTaskVo.DONE?(i+="|C:"+LangMgr.getColor("color22")+"&T:("+(n.taskIdx-1)+"/"+s+")|",this.taskLabel.textFlow=TextUtils.generateTextFlow1(i),this.lblTaskContent.visible=!0,this.lblTaskContent.textFlow=TextUtils.generateTextFlow1(n.taskIdx+"."+o.desc+(o.itemName[n.weapon-1]||"")+"|C:"+LangMgr.getColor("color43")+"&T:("+n.progress+"/"+o.target+")|"),this.btn.label=LangMgr.getValueByKey("godFinshOrder"),this._state=2,this.addTaskMc()):(i+="|C:"+LangMgr.getColor("color43")+"&T:("+n.taskIdx+"/"+s+")|",this.taskLabel.textFlow=TextUtils.generateTextFlow1(i),this.lblTaskDone.visible=!0,this.btn.label=LangMgr.getValueByKey("smeltActivity"),this._state=3,this.addTaskMc())}else this.taskLabel.textFlow=TextUtils.generateTextFlow1(i),this.lblTaskInit.visible=!0,this.btn.label=LangMgr.getValueByKey("godGetOrder"),this._state=0,this.removeTaskMc()},e.prototype.addTaskMc=function(){this.validateNow(),this.taskMc=this.taskMc||ObjectPool.pop("GameMovieClip"),this.taskMc.x=this.btn.width/2,this.taskMc.y=this.btn.height/2,this.taskMc.scaleX=1,this.taskMc.scaleY=.85,this.taskMc.touchEnabled=!1,this.btn.addChild(this.taskMc),this.taskMc.playFile(PATH_EFF+"chargeff1",-1)},e.prototype.removeTaskMc=function(){TimerMgr.ins().removeAll(this),this.taskMc&&this.taskMc.parent&&(this.taskMc.parent.removeChild(this.taskMc),this.taskMc.destroy(),ObjectPool.push(this.taskMc)),this.taskMc=null},e.prototype.initSkill=function(){for(var t=this._weaponId,e=DataCenter.ins().GodWeaponBaseConfig.noticeSkillId[t-1],i=DataCenter.ins().GodWeaponLineConfig[t],n=0,o=0,s=e;o<s.length;o++){var r=s[o],a=godWeaponControl.getWeaponSkinIdData(t,i[r].skinId);this["item"+n].imgLight=!0,this["item"+n].updateView(a,t-1),this["skillName"+n].text=i[r].skillName,this["skillDesc"+n].text=i[r].lockDesc,n+=1}},e.prototype.onTap=function(t){var e=this,i=t.currentTarget,n=godWeaponControl.gwTask;if(i==this.btn)if(0==this._state){var o=heroControl.getSubRoleByJob(this._weaponId);if(!o)return void tipsControl.showTips(LangMgr.getValueByKey("godGetActivit",LangMgr.getValueByKey("job"+(this._weaponId+1))));n.weapon?tipsControl.showTips(LangMgr.getValueByKey("godTips7")):warnControl.show(LangMgr.getValueByKey("godTips6",LangMgr.getValueByKey("godType"+this._weaponId)),function(){godWeaponControl.upReceiveTask(e._weaponId)},this)}else if(1==this._state){var s=DataCenter.ins().GodWeaponTaskConfig[n.weaponIdx][n.taskIdx];s.controlTarget&&UIMgr.ins().open(s.controlTarget[0],s.controlTarget[1])}else(2==this._state||3==this._state)&&(godWeaponControl.upActiveWeapon(),2==this._state&&(this.taskComMc=this.taskComMc||ObjectPool.pop("GameMovieClip"),this.taskComMc.playFile(PATH_EFF+"complete",1,function(){e.taskComMc.parent&&(e.taskComMc.parent.removeChild(e.taskComMc),e.taskComMc.destroy(),ObjectPool.push(e.taskComMc),e.taskComMc=null)}),this.taskComMc.y=this.btn.y-80,this.taskComMc.x=this.btn.x+this.btn.width/2,this.gwTask.addChild(this.taskComMc)))},e}(BasePanel);__reflect(GodWeaponTaskPanel.prototype,"GodWeaponTaskPanel");var GodWeaponView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectIndex=-1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GodWeaponViewSkin",this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(607,this.updateRedPoint),this.addCustomEvent(602,this.updateRedPoint),this.addCustomEvent(606,this.updateRedPoint),this.addCustomEvent(608,this.updateRedPoint),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addEventChange(this.tab,this.itemTouchHandler),this.addEventChanging(this.tab,this.itemTouching),this.timeBp.visible=!1,t[0]&&this.checkIsOpen(t[0])?(this.viewStack.selectedIndex=t[0],this.selectIndex=this.tab.selectedIndex=t[0]):(this.viewStack.selectedIndex=0,this.selectIndex=this.tab.selectedIndex=0),this.updateRedPoint()},e.prototype.updateRedPoint=function(){this.redPoint1.visible=GodWeaponRedPoint.ins().gwRed,this.redPoint2.visible=GodWeaponRedPoint.ins().gwDunRed,this.redPoint3.visible=GodWeaponRedPoint.ins().gwItem,this.redPoint4.visible=GodWeaponRedPoint.ins().gwBossRp},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._selectIndex>-1&&this.viewStack.getChildAt(this._selectIndex).close(),this.removeCustomEvents(),this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.help,this.onTap)},Object.defineProperty(e.prototype,"selectIndex",{set:function(t){this._selectIndex>-1&&this.viewStack.getChildAt(this._selectIndex).close(),this._selectIndex=t,this.viewStack.getChildAt(this._selectIndex).open(),this.help.visible=3==this._selectIndex},enumerable:!0,configurable:!0}),e.prototype.itemTouchHandler=function(t){this.selectIndex=this.tab.selectedIndex},e.prototype.itemTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return t>=1?reincarnateControl.lv>=DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel&&GameServer.serverOpenDay>=DataCenter.ins().GodWeaponBaseConfig.openDay-1?!0:(reincarnateControl.lv<DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel?tipsControl.showTips(LangMgr.getValueByKey("godRoleZS",DataCenter.ins().GodWeaponBaseConfig.zhuanshengLevel)):GameServer.serverOpenDay<DataCenter.ins().GodWeaponBaseConfig.openDay-1&&tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().GodWeaponBaseConfig.openDay)),!1):!0},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.closeBtn:UIMgr.ins().close(this);break;case this.help:3==this._selectIndex&&HelpControl.openHelpWin(23)}},e}(BaseEuiView);__reflect(GodWeaponView.prototype,"GodWeaponView");var GodWeaponAddAttrItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this._thisData=this.data,this.labelInfo.text=AttributeData.getAttrStrByType(this._thisData.type)+"："+this._thisData.value)},e}(BaseItemRender);__reflect(GodWeaponAddAttrItemRenderer.prototype,"GodWeaponAddAttrItemRenderer");var GodWeaponChooseRelicItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="GodWeaponChooseRelicItemRendererSkin",e.best.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){this.datathis=this.data;var e=ItemUtils.getQuality(this.datathis.itemConfig);this.nameTxt.text=this.datathis.itemConfig.name,this.nameTxt.textColor=ItemUtils.getQualityColor(this.datathis.itemConfig),this.attr.text=this.datathis.addatrStr,this.power.text=LangMgr.getValueByKey("wingPingfen",this.datathis.power),this.itemIcon.imgJob.source="job"+this.datathis.weaponId+"Item",this.itemIcon.imgIcon.source=this.datathis.itemConfig.icon+"_png",this.itemIcon.imgBg.source="quality"+e,0>e-1?this.quality.text=LangMgr.getValueByKey("godGoodType1"):this.quality.text=LangMgr.getValueByKey("godGoodType"+e),this.quality.textColor=ItemUtils.getQualityColor(this.datathis.itemConfig),this.addNameLb.text=LangMgr.getValueByKey("godHaveGod",this.datathis.skillName),this.now.visible=this.datathis.isCur,this.changeBtn.visible=!this.datathis.isCur}},e}(BaseItemRender);__reflect(GodWeaponChooseRelicItemRenderer.prototype,"GodWeaponChooseRelicItemRenderer");var GodWeaponRelicItemIcon=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(eui.Component);__reflect(GodWeaponRelicItemIcon.prototype,"GodWeaponRelicItemIcon");var GodWeaponDunItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._ary=new eui.ArrayCollection,this.list.dataProvider=this._ary,this.list.itemRenderer=GodWeaponDunShowItemRenderer},e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){this.storeyCount.text=LangMgr.getValueByKey("godIndexLayer",this.data.gridNum);var e=this.data.config.award[1].concat();e=e.concat(this.data.config.firstAward.concat());for(var i=[],n=0;n<e.length;n++){var o=new GodWeaponDunShowItemVo;o.data=e[n],o.index=n+1,o.start=this.data.config.award[1].length,o.floorNum=this.data.gridNum,i.push(o)}this._ary.replaceAll(i),this.rankImg.visible=this.rankbg.visible=0!=this.data.curPoint,this.rankImg.source=0!=this.data.curPoint?"godweapon_rank"+this.data.curPoint:"",this.choose.visible=this.selected,this.rank.visible=!this.selected}},e.prototype.invalidateState=function(){t.prototype.invalidateState.call(this),this.choose.visible=this.selected,this.rank.visible=!this.selected},e}(BaseItemRender);__reflect(GodWeaponDunItemRenderer.prototype,"GodWeaponDunItemRenderer");var GodWeaponDunRankItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&(this.playerName.text=this.data.nameStr,this.storeyCount.text=LangMgr.getValueByKey("godIndexLayer",this.data.floorNum),this.time.text=this.data.getTimeStr(),this.data.rank<=3?(this.rank.visible=!1,this.imgRank.visible=!0,this.imgRank.source="paihang"+this.data.rank):(this.rank.text=""+this.data.rank,this.rank.visible=!0,this.imgRank.visible=!1))},e}(BaseItemRender);__reflect(GodWeaponDunRankItemRender.prototype,"GodWeaponDunRankItemRender");var GodWeaponDunRewardItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.getImg.visible=!1},e}(GodWeaponDunShowItemRenderer);__reflect(GodWeaponDunRewardItemRenderer.prototype,"GodWeaponDunRewardItemRenderer");var RedPacketSysControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(402,e.showHongBaoTips),e.addCustomEvent(393,e.ActRewardResult),e.addCustomEvent(398,e.showEnvelope),e.addCustomEvent(399,e.updateRedPacket),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.updateRedPacket=function(){var t=UIMgr.playFun;if(t&&t.hongbao&&!(t.hongbao.numElements>0))for(var e=0;e<amusementControl.activityTimers.length;e++){var i=amusementControl.activityTimers[e];if(amusementControl.activityData[i]&&amusementControl.activityData[i]instanceof AmusementType12DataVo){var n=amusementControl.activityData[i];if(!n.envelopeData.length)continue;for(var o=n.envelopeData.length-1;o>=0;)if(o=n.envelopeData.length-1,n.envelopeData[o]){var s=n.envelopeData[o].id;if(!n.envelopeData[o].isOverTimer()){var r=new RedPacketShowItemRender;r.data={actId:i,eId:s},t.hongbao.addChild(r);break}n.popEnvelope(s)}else n.envelopeData.splice(e,1)}}},e.prototype.showHongBaoTips=function(t){var e=t[0],i=t[1],n=t[2],o=(t[3],t[4]),s=amusementControl.activityData[e];if(s){if(n){var r=new RewardVo;r.type=0,r.id=2,r.count=n,tipsControl.showGoodRewardTips(r)}i&&s.popEnvelope(i),this.HongBaoResultAni(o)}},e.prototype.HongBaoResultAni=function(t){var e=UIMgr.playFun;if(e&&e.hongbao){var i=e.hongbao.getChildAt(1);i&&i.playAni(t,this.updateRedPacket,this)}},e.prototype.ActRewardResult=function(t){-1!=amusementControl.activityTimers.indexOf(t)&&amusementControl.activityData[t]&&amusementControl.activityData[t]instanceof AmusementType12DataVo&&(amusementControl.isSuccee||(amusementControl.activityData[t].isOpenActivity()?tipsControl.showTips(LangMgr.getValueByKey("hbOverTime")):tipsControl.showTips(LangMgr.getValueByKey("hbActiveEnd"))))},e.prototype.showEnvelope=function(t){var e=UIMgr.playFun;if(e&&e.hongbao){if(!t)return tipsControl.showTips(LangMgr.getValueByKey("hbOverTime")),e.hongbao.removeChildren(),void this.updateRedPacket();if(amusementControl.activityData[t.id]&&amusementControl.activityData[t.id]instanceof AmusementType12DataVo){var i=new RedPacketOpenItemRender;t.desc||(t.desc=DataCenter.ins().Amusement12Config[t.id][t.index].blessWord),i.data={actId:t.id,eId:t.eId,job:t.job,sex:t.sex,name:t.name,text:t.desc,index:t.index},e.hongbao.addChildAt(i,1)}}},e}(BaseSystem);__reflect(RedPacketSysControl.prototype,"RedPacketSysControl");var GodWeaponMixItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=DataCenter.ins().ItemConfig[this.data.id];this.relicImg.source=t.icon+"_png",this.relicName.text=t.name,this.relicName.textColor=ItemUtils.getQualityColor(t),this.frame.source="godweapon_quality"+(ItemUtils.getQuality(t)+1),this.imgJob.source="job"+ItemUtils.getJob(t)+"Item",this.count.text=this.data.count>0?this.data.count:""},e}(BaseItemRender);__reflect(GodWeaponMixItemRenderer.prototype,"GodWeaponMixItemRenderer");
var HeartMethodControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._proShowList=[],e.heartMethodInfo=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"proShowList",{get:function(){return this._proShowList.length||(this._proShowList=DataCenter.ins().HeartMethodBaseConfig.proShowList),this._proShowList},enumerable:!0,configurable:!0}),e.prototype.heartOpenCondition=function(t){var e=DataCenter.ins().HeartMethodConfig[t];return e.openCondition?GameServer.serverOpenDay+1<e.openCondition.day?!1:reincarnateControl.lv<e.openCondition.zs?!1:!0:!0},e.prototype.heartUpCondition=function(t,e){var i=DataCenter.ins().HeartMethodConfig[e];if(!i.upGradeCondition)return!0;var n=this.heartMethodInfo[t];if(!n)return!1;var o=n[e];if(!o)return!1;for(var s=0,r=0;r<o.slots.length;r++)o.slots[r]&&s++;return s>=i.upGradeCondition},e.prototype.checkOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().HeartMethodBaseConfig.serverDay-1?!1:reincarnateControl.lv<DataCenter.ins().HeartMethodBaseConfig.zsLv?!1:!0},e.prototype.getHeartCfg=function(t,e){void 0===e&&(e=!1);var i=DataCenter.ins().HeartMethodStarConfig;if(Assert(i,"HeartMethodStarConfig is null"))return null;var n=e?t.configID+1:t.configID;return i[n]},e.prototype.getHeartSlotItemIdWear=function(t,e,i){var n=this.heartMethodInfo[t];if(!n)return 0;var o=n[e];if(!o)return 0;var s=backpackControl.getBagGoodsByType(18);s.sort(this.changeSort);for(var r in s){var a=DataCenter.ins().HeartMethodStarConfig[s[r].configID];if(a.heartmethodId==e){var l=s[r].itemConfig,h=l.level?l.level:0,u=l.zsLevel?l.zsLevel:0;if(!(ActorControl.level<h||reincarnateControl.lv<u)){var p=this.getSuitPosFromItemId(s[r].configID);if(i==p)return s[r].configID}}}return 0},e.prototype.getHeartSlotItemId=function(t,e,i){var n=this.heartMethodInfo[t];if(!n)return 0;var o=n[e];return o&&o.slots[i-1]?o.slots[i-1]:0},e.prototype.calcHeartSlotChange=function(t,e,i){var n=this.heartMethodInfo[t];if(!n)return 0;var o=n[e];if(!o)return 0;var s=DataCenter.ins().HeartMethodStarConfig[i];if(!s)return 0;var r=o.slots.indexOf(i);if(-1==r)return 0;var a=this.getSuitPosFromItemId(i);if(!a)return 0;var l=backpackControl.getBagGoodsByType(18);l.sort(this.changeSort);for(var h in l)if(DataCenter.ins().HeartMethodStarConfig[l[h].configID].posSort==a&&DataCenter.ins().HeartMethodStarConfig[l[h].configID].heartmethodId==e){var u=DataCenter.ins().ItemConfig[l[h].configID],p=u.level?u.level:0,c=u.zsLevel?u.zsLevel:0;if(!(ActorControl.level<p||reincarnateControl.lv<c)){var d=DataCenter.ins().HeartMethodStarConfig[u.id];if(d.quality>s.quality)return u.id;if(d.quality==s.quality&&d.star>s.star)return u.id}}return 0},e.prototype.changeSort=function(t,e){var i=ItemUtils.getQuality(t.itemConfig),n=ItemUtils.getQuality(e.itemConfig);if(i!=n)return n-i;var o=DataCenter.ins().HeartMethodStarConfig[t.configID],s=DataCenter.ins().HeartMethodStarConfig[e.configID];return s.star-o.star},e.prototype.getSuitPosFromItemId=function(t){var e=DataCenter.ins().HeartMethodStarConfig[t];return e?e.posSort:0},e.prototype.calcHeartSlotCost=function(t){var e=DataCenter.ins().HeartMethodStarConfig[t];if(!e||!e.nextItem)return!1;var i=backpackControl.getBagItemById(e.costItem);return i&&i.count>=e.costNum},e.prototype.calcHeartTotalValue=function(t,e){for(var i=this.proShowList,n=[],o=0;o<i.length;o++)n.push(0);var s=this.heartMethodInfo[t];if(!s||!s[e])return n;for(var r=this.calcHeartAttrs(t,e),o=0;o<i.length;o++)if(i[o].filter){var a=this.calcHeartSkillLevel(t,e);if(a){var l=DataCenter.ins().HeartMethodSuitConfig[e][a];l&&i[o].id==l.attr[0].type&&(n[o]+=l.attr[0].value/100)}}else{for(var h=0;h<s[e].slots.length;h++){var u=s[e].slots[h],p=DataCenter.ins().HeartMethodStarConfig[u];if(p)for(var c=0;c<p.attr.length;c++)i[o].id==p.attr[c].type&&(n[o]+=p.attr[c].value)}for(var d=0;d<r.length;d++)if(i[o].id==r[d].type){n[o]+=r[d].value;break}}return n},e.prototype.getHeartSuitCount=function(t,e,i){var n=this.heartMethodInfo[t];if(!n||!n[e])return 0;for(var o=0,s=0;s<n[e].slots.length;s++){var r=n[e].slots[s];if(r){var a=DataCenter.ins().HeartMethodStarConfig[r];a.quality>=i&&o++}}return o},e.prototype.calcHeartSkillLevel=function(t,e){var i=0,n=this.heartMethodInfo[t];if(!n||!n[e])return i;for(var o,s=0;s<n[e].slots.length;s++){var r=n[e].slots[s];if(!r)return 0;var a=DataCenter.ins().HeartMethodStarConfig[r];if(a){var l=a.quality;(!o||o>l)&&(o=l)}}return o&&(i=o),i},e.prototype.calcHeartAttrs=function(t,e){var i=this.heartMethodInfo[t],n=[];if(!i||!i[e]||!i[e].id)return n;var o=i[e],s=DataCenter.ins().HeartMethodStageConfig[o.id];s&&s[o.stage]&&(n=n.concat(s[o.stage].attr));var r=DataCenter.ins().HeartMethodLevelConfig[o.id];return r&&r[o.lv]&&(n=n.concat(r[o.lv].attr)),AttributeData.combineAtts(n)},e.prototype.calcHeartAttrsNext=function(t,e){var i=this.heartMethodInfo[t],n=[];if(!i||!i[e]||!i[e].id)return n;var o=i[e],s=DataCenter.ins().HeartMethodStageConfig[o.id],r=DataCenter.ins().HeartMethodLevelConfig[o.id],a=[],l=[];return o.isUp?(a=s[o.stage+1]?s[o.stage+1].attr:s[o.stage].attr,l=r[o.lv].attr):(a=s[o.stage].attr,l=r[o.lv+1]?r[o.lv+1].attr:r[o.lv].attr),a&&(n=n.concat(a)),l&&(n=n.concat(l)),AttributeData.combineAtts(n)},e.prototype.calcHeartCost=function(t,e){var i=null,n=this.heartMethodInfo[t];if(!n||!n[e]||!n[e].id||this.isHeartMax(t,e)||n[e].isUp)return i;var o=DataCenter.ins().HeartMethodLevelConfig[n[e].id][n[e].lv+1];return o&&(i={itemid:o.costItem,count:o.costNum}),i},e.prototype.isHeartMax=function(t,e){var i=this.heartMethodInfo[t];if(!i||!i[e]||!i[e].id)return!1;var n=DataCenter.ins().HeartMethodLevelConfig[i[e].id][i[e].lv+1];return n?!1:!0},e.prototype.getAttrStrByType=function(t){var e="";for(var i in this.proShowList)if(this.proShowList[i].id==t){e=this.proShowList[i].name;break}return e},e.prototype.upHeartUpLevel=function(t,e,i){return[t,e,i]},e.prototype.upHeartChange=function(t,e,i,n){return[t,e,i,n]},e.prototype.upOneKeyDecompose=function(t,e){for(var i=e.length,n=[],o=0;i>o;o++)n.push(e[o].configID);return[t,n]},e.prototype.downHeartInfo=function(t){for(var e=0;e<t.length;++e){var i=t[e][0];this.heartMethodInfo[i]||(this.heartMethodInfo[i]={});for(var n=0;n<t[e][1].length;++n){var o=new HeartMethodVo;o.init(t[e][1][n]),this.heartMethodInfo[i][o.id]=o}}EventMgr.ins().dispatch(62)},e.prototype.downHeartUpLevel=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];this.heartMethodInfo[t]||(this.heartMethodInfo[t]={});var n=new HeartMethodVo;n.init(e),this.heartMethodInfo[t][n.id]=n,EventMgr.ins().dispatch(63)},e.prototype.downOneKeyDecompose=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0),EventMgr.ins().dispatch(64,[t,e,i])},__decorate([up(3,[1,2,2])],e.prototype,"upHeartUpLevel",null),__decorate([up(4,[1,2,2,3])],e.prototype,"upHeartChange",null),__decorate([up(5,[2,[3]])],e.prototype,"upOneKeyDecompose",null),__decorate([down(1,[[1,ByteConst.HeatMethodVo]])],e.prototype,"downHeartInfo",null),__decorate([down(2,[4].concat(ByteConst.HeatMethodVo))],e.prototype,"downHeartUpLevel",null),__decorate([down(5,[1,2,2])],e.prototype,"downOneKeyDecompose",null),e=__decorate([protocolsId(69)],e)}(BaseSystem);__reflect(HeartMethodControl.prototype,"HeartMethodControl");var AmuseRankTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseRankTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.onClick),this.arr=t[0],this.rankType=t[1],this.record.itemRenderer=AmuseTarget4RankTipsItemRender,this.init()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e.prototype.init=function(){switch(this.rankType){case 12:this.title.text=LangMgr.getValueByKey("osaType1");break;case 14:this.title.text=LangMgr.getValueByKey("osaType2");break;case 16:this.title.text=LangMgr.getValueByKey("osaType3");break;case 17:this.title.text=LangMgr.getValueByKey("osaType4");break;case 18:this.title.text=LangMgr.getValueByKey("osaType5");break;case 19:this.title.text=LangMgr.getValueByKey("osaType6");break;case 21:this.title.text=LangMgr.getValueByKey("osaType7");break;case 24:this.title.text=LangMgr.getValueByKey("payRank");break;case 0:this.title.text=LangMgr.getValueByKey("openSvPowRank");break;case 25:this.title.text=LangMgr.getValueByKey("openSvZlRank");break;case 26:this.title.text=LangMgr.getValueByKey("opneSvTjRank")}this.record.dataProvider=new eui.ArrayCollection(this.arr)},e.prototype.onClick=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(AmuseRankTipsView.prototype,"AmuseRankTipsView");var HeartMethodDecomposeItemVo=function(){function t(){this.itemData=null,this.isSelected=!1}return t}();__reflect(HeartMethodDecomposeItemVo.prototype,"HeartMethodDecomposeItemVo");var HeartMethodVo=function(){function t(){this.id=0,this.lv=0,this.stage=0,this.slots=[]}return Object.defineProperty(t.prototype,"stage",{get:function(){return this.isUp?Math.floor(this.lv/10):Math.floor(this.lv/10)+1},set:function(t){this.isUp=t},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.id=t[0],this.lv=t[1],this.stage=t[2];for(var e=0;e<t[3].length;++e)this.slots.push(t[3][e])},t}();__reflect(HeartMethodVo.prototype,"HeartMethodVo");var HeartTypeVo=function(){function t(){}return t}();__reflect(HeartTypeVo.prototype,"HeartTypeVo");var HeartMethodAttrView=function(t){function e(){var e=t.call(this)||this;return e._lastX=0,e.proShowList=[],e.skinName="HeartMethodAttrViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.proShowList=heartMethodControl.proShowList,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.heartId=t[1],this.setRoleAttr(this.curRole);var i=heroControl.subRolesLen;i>1&&(this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchBegin(this.bg,this.onMove),this.addEventTouchEnd(this.bg,this.onMove)),this.addEventTouchEnd(this,this.otherClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=heroControl.subRolesLen;i>1&&(this.removeEventTouchTap(this.leftBtn,this.onTouch),this.removeEventTouchTap(this.rightBtn,this.onTouch),this.removeEventTouchBegin(this.bg,this.onMove),this.removeEventTouchEnd(this.bg,this.onMove)),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200)):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200))}},e.prototype.moveAttr=function(t){var e,i=egret.Tween.get(this.attrGroup);e=t>0?0:242,i.to({x:this.attrGroup.x+t,alpha:0},200).to({x:e},200).to({x:80,alpha:1},200)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.leftBtn:this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200));break;case this.rightBtn:this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200))}},e.prototype.setRoleAttr=function(t){var e=heroControl.getSubRoleByIndex(t);this.job.source="op_"+e.job;for(var i="",n="",o=0,s=0,r=heartMethodControl.calcHeartTotalValue(e.index,this.heartId),a=0;a<this.proShowList.length;a++)s=this.proShowList[a].id,o=r[a],o&&(i+=63==this.proShowList[a].id?o+"%":o+"",n+=heartMethodControl.getAttrStrByType(s)+":",a<this.proShowList.length-1&&(i+="\n",n+="\n"));this.attr.text=i,this.attrName.text=n,this.setBtn()},e.prototype.setBtn=function(){var t=heroControl.subRolesLen;this.leftBtn.visible=this.curRole>0,this.rightBtn.visible=this.curRole<t-1},e}(BaseEuiView);__reflect(HeartMethodAttrView.prototype,"HeartMethodAttrView");var HeartMethodDecomposeView=function(t){function e(){var e=t.call(this)||this;return e.cardList=null,e.cardCollection=null,e.checkBoxNum=4,e.itemListScrollV=0,e.resolveIng=!1,e._chipNum=0,e.skinName="HeartMethodDecomposeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemList.itemRenderer=HeartMethodDecomposeItemRenderer,this.itemList.useVirtualLayout=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.checkBoxNum;i++)this["cb"+i]&&this.addEventTouchTap(this["cb"+i],this.onCBTap);this.addEventTouchTap(this.decomposeBtn,this.onTap),this.addEventTouchTap(this.itemList,this.onListTap),this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addCustomEvent(64,this.onDecomposeResult),this.heartId=t[0],this.initCardList(),this.resetCheckBox(),this.updateShatter()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.cleanCardList()},e.prototype.onDecomposeResult=function(t){var e=this;t[0]?TimerMgr.ins().doTimer(500,1,function(){e.initCardList(),e.updateShatter(),e.updateAddShatter(),e.resolveIng=!1},this):tipsControl.showTips(LangMgr.getValueByKey("happyTips1"))},e.prototype.onListTap=function(t){if(t&&t.currentTarget){var e=this.itemList.selectedIndex;if(0>e)return;var i=this.itemList.getVirtualElementAt(e);if(i&&i instanceof HeartMethodDecomposeItemRenderer&&i.cb){var n=i.data;n&&(n.isSelected=!n.isSelected,this.cardCollection.itemUpdated(n))}this.itemList.selectedIndex=-1,this.updateAddShatter()}},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.decomposeBtn:this.decomposeHeart();break;case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e.prototype.decomposeHeart=function(){if(!this.resolveIng){if(this.cardList&&this.cardList.length>0){for(var t=[],e=0,i=this.cardList;e<i.length;e++){var n=i[e];n&&n.isSelected&&n.itemData&&n.itemData.itemConfig&&t.push(n.itemData)}if(t.length>0)return this.resolveIng=!0,void heartMethodControl.upOneKeyDecompose(this.heartId,t)}tipsControl.showTips(LangMgr.getValueByKey("happyTips2"))}},e.prototype.onCBTap=function(t){if(t&&t.currentTarget){var e=t.currentTarget;if(e&&e instanceof eui.CheckBox)for(var i=null,n=0;n<this.checkBoxNum;n++)if(i=this["cb"+n],i&&i===e)return void this.setQualitySelected(n+1,e.selected)}},e.prototype.updateShatter=function(){var t=DataCenter.ins().HeartMethodConfig[this.heartId].splitItem,e=DataCenter.ins().ItemConfig[t];this.suipianIcon.source=e.icon+"_png";var i=backpackControl.getBagItemById(e.id);this.suipianNum.text=(i?i.count:0)+""},e.prototype.updateAddShatter=function(){var t=0,e=null;if(this.cardList&&this.cardList.length>0)for(var i=0,n=this.cardList;i<n.length;i++){var o=n[i];o&&o.isSelected&&o.itemData&&o.itemData.itemConfig&&(e=heartMethodControl.getHeartCfg(o.itemData),e&&(t+=e.splitNum))}this.suipianAdd.text=t?"+"+t:""},e.prototype.setQualitySelected=function(t,e){if(0>t)for(var i=0,n=this.cardList;i<n.length;i++){var o=n[i];o.itemData&&o.itemData.itemConfig&&(o.isSelected=!1)}else for(var s=0,r=this.cardList;s<r.length;s++){var o=r[s];o.itemData&&o.itemData.itemConfig&&ItemUtils.getQuality(o.itemData.itemConfig)==t&&(o.isSelected=e)}for(var a=this.cardCollection.length,l=0;a>l;l++)this.cardCollection.itemUpdated(this.cardList[l]);this.updateAddShatter()},e.prototype.getCheckBoxSelected=function(t){var e=this["cb"+(t-1)];return e?e.selected:!1},e.prototype.resetCheckBox=function(t){void 0===t&&(t=1);for(var e=null,i=0;i<this.checkBoxNum;i++)e=this["cb"+i],e&&e instanceof eui.CheckBox&&(e.selected=i+1==t);this.setQualitySelected(t,!0)},e.prototype.selectHeartItem=function(t){for(var e=[],i=0;i<t.length;i++){var n=DataCenter.ins().HeartMethodStarConfig[t[i].configID];this.heartId==n.heartmethodId&&e.push(t[i])}return e},e.prototype.initCardList=function(){this.cleanCardList(),this.cardList=[];var t=backpackControl.getBagGoodsByType(18),e=this.selectHeartItem(t);if(e&&e.length>0){for(var i=null,n=0,o=e;n<o.length;n++)for(var s=o[n],r=0;r<s.count;r++)i=new HeartMethodDecomposeItemVo,i.itemData=s,this.cardList.push(i);this.cardList.sort(this.sortList)}this.cardCollection=new eui.ArrayCollection(this.cardList),this.itemList.dataProvider=this.cardCollection},e.prototype.cleanCardList=function(){this.cardList=null,this.cardCollection=null,this.itemList.dataProvider=null},e.prototype.sortList=function(t,e){var i=ItemUtils.getQuality(t.itemData.itemConfig),n=ItemUtils.getQuality(e.itemData.itemConfig);if(i!=n)return n-i;var o=heartMethodControl.getHeartCfg(t.itemData),s=heartMethodControl.getHeartCfg(e.itemData);return s.star-o.star},e}(BaseEuiView);__reflect(HeartMethodDecomposeView.prototype,"HeartMethodDecomposeView");var HeartMethodPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.heartPages=[],e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.xiangxishuxing,this.onTap),this.addEventTouchTap(this.skill,this.onTap),this.addEventTouchTap(this.fenjie,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.activeBtn0,this.onTap),this.addEventTouchTap(this.boostBtn,this.onTap),this.addEventTouchTap(this.getItemTxt0,this.onTap),this.addCustomEvent(575,this.updateUI);for(var i=0;5>i;i++)this.addEventTouchTap(this["item"+(i+1)],this.onSlot);var n=t&&t[0]?t[0]:0;this.curRole=n,this.heartId=t&&t[1]?t[1]:1,this.init(),this.updateUI()},e.prototype.onSlot=function(t){for(var e=this.getHeartId(this.heartPos),i=0;5>i;i++)if(t.currentTarget==this["item"+(i+1)]){var n=heartMethodControl.getHeartSlotItemId(this.curRole,e,i+1);if(n)UIMgr.ins().open(HeartMethodTipsView,this.curRole,e,n);else{var o=backpackControl.getBagGoodsByType(18);o.sort(heartMethodControl.changeSort);var s=!1;for(var r in o){var a=DataCenter.ins().HeartMethodStarConfig[o[r].configID];if(a.heartmethodId==e){var l=DataCenter.ins().HeartMethodConfig[e].posList.indexOf(a.posId);if(-1!=l&&l==i){s=!0,heartMethodControl.upHeartChange(this.curRole,e,i+1,a.posItem);break}}}s||tipsControl.showTips(LangMgr.getValueByKey("happyTips6"))}break}},e.prototype.onTap=function(t){var e=this.getHeartId(this.heartPos);switch(t.currentTarget){case this.boostBtn:if("narmal"==this.currentState){if(!heartMethodControl.heartUpCondition(this.curRole,e))return void tipsControl.showTips(LangMgr.getValueByKey("happyTips7"));if(!this.isHeartUp)return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"));heartMethodControl.upHeartUpLevel(this.curRole,e,0)}else"stage"==this.currentState&&heartMethodControl.upHeartUpLevel(this.curRole,e,0);break;case this.activeBtn0:this.isAct=!0,heartMethodControl.upHeartUpLevel(this.curRole,e,0);break;case this.xiangxishuxing:UIMgr.ins().open(HeartMethodAttrView,this.curRole,e);break;case this.skill:UIMgr.ins().open(HeartMethodSkillTipsView,this.curRole,e);break;case this.fenjie:UIMgr.ins().open(HeartMethodDecomposeView,e);break;case this.leftBtn:var i=this.getHeartId(this.heartPos-1),n=DataCenter.ins().HeartMethodConfig[i];n?(this.heartPos--,this.heartId=i,this.updateUI()):tipsControl.showTips(LangMgr.getValueByKey("happyTips8"));break;case this.rightBtn:var o=this.getHeartId(this.heartPos+1),s=DataCenter.ins().HeartMethodConfig[o];s?(this.heartPos++,this.heartId=o,this.updateUI()):tipsControl.showTips(LangMgr.getValueByKey("happyTips9"));break;case this.getItemTxt0:if(this.conditionDesc.visible){var r=DataCenter.ins().HeartMethodConfig[this.getHeartId(this.heartPos)];warnControl.setBuyGoodsWarn(r.posGainGuide)}else warnControl.setBuyGoodsWarn(this.costId)}},e.prototype.init=function(){this.showGroupY=this.showGroup.y,this.showGroupMoveY=this.showGroupY-10,this.heartPages=[];for(var t in DataCenter.ins().HeartMethodConfig)this.heartPages.push(DataCenter.ins().HeartMethodConfig[t]);this.heartPages.sort(function(t,e){return t.sort-e.sort}),this.heartPos=0;for(var e=0;e<this.heartPages.length;e++)if(this.heartPages[e].id==this.heartId){this.heartPos=e;break}},e.prototype.getHeartId=function(t){return this.heartPages[t]?this.heartPages[t].id:0},e.prototype.updateUI=function(){this.updateAct(),this.updateState(),this.updatePower(),this.updateHeart(),this.updateRedPoint(),this.updateBtn()},e.prototype.updateAct=function(){this.isAct&&CommonFun.show(0,DataCenter.ins().HeartMethodConfig[this.heartId].name,DataCenter.ins().HeartMethodConfig[this.heartId].pic),this.isAct=!1},e.prototype.updateBtn=function(){this.leftBtn.visible=this.rightBtn.visible=!0;var t=this.getHeartId(this.heartPos-1),e=DataCenter.ins().HeartMethodConfig[t];e?heartMethodControl.heartOpenCondition(t)||(this.redPoint2.visible=this.leftBtn.visible=!1):this.redPoint2.visible=this.leftBtn.visible=!1,t=this.getHeartId(this.heartPos+1),e=DataCenter.ins().HeartMethodConfig[t],e?heartMethodControl.heartOpenCondition(t)||(this.redPoint3.visible=this.rightBtn.visible=!1):this.redPoint3.visible=this.rightBtn.visible=!1,t=this.getHeartId(this.heartPos),e=DataCenter.ins().HeartMethodConfig[t];var i=e.openCondition?e.openCondition.zs:DataCenter.ins().HeartMethodBaseConfig.zsLv;this.sysDescText0.text=LangMgr.getValueByKey("happyTips11",e.openTips,i)},e.prototype.updateState=function(){var t=this.getHeartId(this.heartPos),e=heartMethodControl.heartMethodInfo[this.curRole];e&&e[t]&&e[t].id?heartMethodControl.isHeartMax(this.curRole,t)?this.currentState="max":e[t].isUp?this.currentState="stage":this.currentState="narmal":this.currentState="open",this.validateNow()},e.prototype.updatePower=function(){for(var t=this.getHeartId(this.heartPos),e=heartMethodControl.proShowList,i=heartMethodControl.calcHeartTotalValue(this.curRole,t),n=[],o=0;o<e.length;o++){var s=new AttributeData;s.type=e[o].id,s.value=i[o],n.push(s)}var r=BackpackControl.getAttrPower(n),a=heartMethodControl.heartMethodInfo[this.curRole];if(a){var l=a[t];if(l){var h=DataCenter.ins().HeartMethodLevelConfig[t][l.lv];if(h){var u=h.power?h.power:0;r+=u}}}var p=heartMethodControl.calcHeartSkillLevel(this.curRole,t);if(p){var c=DataCenter.ins().HeartMethodSuitConfig[t][p],d=c.power?c.power:0;r+=d}this.powerPanel.setPower(r)},e.prototype.updateHeart=function(){var t=this.getHeartId(this.heartPos),e=heartMethodControl.heartMethodInfo[this.curRole],i=DataCenter.ins().HeartMethodConfig[t];if(i){this.bigIcon.source=i.pic,this.bigEff||(this.bigEff=new GameMovieClip),this.bigEff.parent||this.effGroup.addChild(this.bigEff);var n=heartMethodControl.calcHeartSkillLevel(this.curRole,t);if(n){var o=DataCenter.ins().HeartMethodSuitConfig[t][n];this.bigEff.playFile(PATH_EFF+o.inside,-1)}else this.bigEff.playFile(PATH_EFF+i.inside,-1)}if(e&&e[t]?(this.heartmethodStage.visible=!0,this.heartmethodStage.data=LangMgr.getValueByKey("stageNumberTxt",e[t].stage),this.xinfaName.text=i?i.name:""):this.heartmethodStage.visible=!1,i&&e&&e[t]){for(var s=0;s<i.posList.length;s++){var r=i.posList[s],a=!1,l=heartMethodControl.getHeartSlotItemId(this.curRole,t,s+1);if(a=l?!0:!1,l){var h=heartMethodControl.calcHeartSlotChange(this.curRole,t,l);a=h?!0:!1,a||(a=heartMethodControl.calcHeartSlotCost(l));var u=DataCenter.ins().HeartMethodStarConfig[l];u&&u.posId==r&&(this["item"+(s+1)].data={itemid:l,redPoint:a})}else{var p=heartMethodControl.getHeartSlotItemIdWear(this.curRole,t,s+1);a=p?!0:!1,this["item"+(s+1)].data={blank:i.blankIcon[s],redPoint:a}}}var c=heartMethodControl.calcHeartAttrs(this.curRole,t),d=heartMethodControl.calcHeartAttrsNext(this.curRole,t);this.curAtt0.text=AttributeData.getAttStr(c,0,1,"："),this.nextAtt0.text=AttributeData.getAttStr(d,0,1,"：");var g=heartMethodControl.calcHeartCost(this.curRole,t);this.redPoint0.visible=!1,this.isHeartUp=!1;var m=void 0;if(g){this.costId=g.itemid;var f=this.getItemTxt0.text;this.getItemTxt0.textFlow=TextUtils.generateTextFlow1("|U:&T:"+f),this.icon0.source=DataCenter.ins().ItemConfig[g.itemid].icon+"_png",m=backpackControl.getBagItemById(g.itemid);var v="";m&&m.count>=g.count?(v="|C:"+LangMgr.getColor("color43")+"&T:",this.redPoint0.visible=m.count>=DataCenter.ins().HeartMethodStageConfig[t][e[t].stage].normalCostTip,this.isHeartUp=!0):v="|C:"+LangMgr.getColor("color22")+"&T:";var y=m?m.count:0;this.countLabel0.textFlow=TextUtils.generateTextFlow1(""+v+y+"|C:"+ColorUtils.NORMAL_COLOR+"&T:/"+g.count)}this.redPoint0.visible||(this.redPoint0.visible=e[t].isUp?!0:!1),"max"==this.currentState?this.redPoint0.visible=!1:"narmal"==this.currentState&&this.conditionDesc&&(this.costGroup0.visible=heartMethodControl.heartUpCondition(this.curRole,t),this.conditionDesc.visible=!this.costGroup0.visible,this.conditionDesc.visible&&(this.redPoint0.visible=!1,this.conditionDesc.text=LangMgr.getValueByKey("happyTips10",i.upGradeCondition))),this.starList||(this.starList=new StarList(10),this.starList.horizontalCenter=0,this.starList.y=0,this.starGroup.addChild(this.starList));var C=e[t].lv;C>0?this.starList.setStarNum(C%10==0?10:C%10):this.starList.setStarNum(0),C>0&&C%10==0&&(e[t].isUp?this.starList.setStarNum(10):this.starList.setStarNum(0))}},e.prototype.updateRedPoint=function(){var t=this.getHeartId(this.heartPos-1),e=this.getHeartId(this.heartPos+1),i=DataCenter.ins().HeartMethodConfig[t];if(i){for(var n=!1,o=t;o>0&&(heartMethodControl.heartOpenCondition(o)&&(n=HeartMethodRedPoint.ins().checkHeartRedPoint(this.curRole,o)),!n);o--);this.redPoint2.visible=n}else this.redPoint2.visible=!1;var s=DataCenter.ins().HeartMethodConfig[e];if(s){for(var n=!1,r=CommonUtils.getObjectLength(DataCenter.ins().HeartMethodConfig),o=e;r>=o&&(heartMethodControl.heartOpenCondition(o)&&(n=HeartMethodRedPoint.ins().checkHeartRedPoint(this.curRole,o)),!n);o++);this.redPoint3.visible=n}else this.redPoint3.visible=!1;var a=this.getHeartId(this.heartPos);this.redPoint.visible=!1;var l=DataCenter.ins().HeartMethodConfig[a];this.skill.source=l.skillButton},e}(BasePanel);__reflect(HeartMethodPanel.prototype,"HeartMethodPanel");var HeartMethodSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeartMethodSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.addCustomEvent(63,this.updateUI),this.roleId=t[0],this.heartId=t[1],this.updateUI()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateUI=function(){var t,e=heartMethodControl.calcHeartSkillLevel(this.roleId,this.heartId),i=DataCenter.ins().HeartMethodSuitConfig[this.heartId],n=Object.keys(i).length;e?e>=n?(this.currentState="max",t=i[n]):(this.currentState="normal",t=i[e]):(this.currentState="initial",t=i[1]),this.validateNow();var o=DataCenter.ins().HeartMethodConfig[this.heartId];o&&(this.skillName.text=o.name,this.skillShow.source=o.skillShowPic+"_png");var s=LangMgr.getColor("qualityColor"+t.level);this.curskillDesc0.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:【"+t.skillname+"】");var r="",a=heartMethodControl.getHeartSuitCount(this.roleId,this.heartId,t.level),l=DataCenter.ins().HeartMethodConfig[this.heartId].posList.length;if(r="("+a+"/"+l+")","initial"==this.currentState)this.curskillDesc2.text=this.getColorDesc(t.level)+r,this.curskillDesc3.text=t.skilldesc;else if("normal"==this.currentState){var h=i[e+1];this.curskillDesc3.text=t.skilldesc,a=heartMethodControl.getHeartSuitCount(this.roleId,this.heartId,h.level),r="("+a+"/"+l+")",s=LangMgr.getColor("qualityColor"+h.level),this.nextskillTitle0.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:【"+h.skillname+"】"),this.nextskillTitle2.text=this.getColorDesc(h.level)+r,this.nextskillTitle3.text=h.skilldesc}else"max"==this.currentState&&(this.nextskillTitle0.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:【"+t.skillname+"】"),this.nextskillTitle3.text=t.skilldesc)},e.prototype.getColorDesc=function(t){var e=ColorUtils.getColorcChinese(t);return e&&(e=LangMgr.getValueByKey("happyTips3",e)),e},e}(BaseEuiView);__reflect(HeartMethodSkillTipsView.prototype,"HeartMethodSkillTipsView");var HeartMethodTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeartMethodTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.addEventTouchTap(this.addStar,this.onClick),this.addEventTouchTap(this.replace,this.onClick),this.addCustomEvent(63,this.updateUI),this.roleId=t[0],this.heartId=t[1],this.id=t[2],this.updateUI()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeEventTouchTap(this.addStar,this.onClick),this.removeEventTouchTap(this.replace,this.onClick),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.starList),this.starList=null},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.addStar:if(this.isMax)return void tipsControl.showTips(LangMgr.getValueByKey("bookStartMax"));this.isAdd?heartMethodControl.upHeartUpLevel(this.roleId,this.heartId,this.pId):tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"));break;case this.replace:var e=heartMethodControl.calcHeartSlotChange(this.roleId,this.heartId,this.id);if(!e)return void tipsControl.showTips(LangMgr.getValueByKey("happyTips4"));if(!this.pId)return void tipsControl.showTips(LangMgr.getValueByKey("happyTips5",this.id));heartMethodControl.upHeartChange(this.roleId,this.heartId,this.pId,e)}},e.prototype.updateUI=function(){if(this.pId=heartMethodControl.getSuitPosFromItemId(this.id),this.pId){this.id=heartMethodControl.heartMethodInfo[this.roleId][this.heartId].slots[this.pId-1];var t=DataCenter.ins().HeartMethodStarConfig[this.id];if(t){this.icon.source=t.bigIcon,this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effGroup.addChild(this.mc),this.mc.playFile(PATH_EFF+t.effect,-1);var e=DataCenter.ins().ItemConfig[this.id];this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(e)+"&T:"+e.name);var i=BackpackControl.getAttrPower(t.attr);this.powerPanel.setPower(i);for(var n="",o="",s=0;s<heartMethodControl.proShowList.length;s++)for(var r=0;r<t.attr.length;r++)if(heartMethodControl.proShowList[s].id==t.attr[r].type){var a=heartMethodControl.getAttrStrByType(t.attr[r].type);if(!a)continue;if(!t.attr[r].value)continue;n+=a+(s!=heartMethodControl.proShowList.length-1?"\n":""),o+="+"+t.attr[r].value+(s!=heartMethodControl.proShowList.length-1?"\n":"")}this.attr.text=n,this.value.text=o;var l="";if(this.isMax=!1,t.nextItem){var h=DataCenter.ins().ItemConfig[t.costItem];if(h){var u=ItemUtils.getQualityColor(h);l="|C:"+LangMgr.getColor("color73")+"&T:"+LangMgr.getValueByKey("zhuzaiExpend")+" |C:"+u+"&T:"+h.name+"|C:"+LangMgr.getColor("color73")+"&T: X"+t.costNum,this.cost.textFlow=TextUtils.generateTextFlow1(l)}this.isAdd=heartMethodControl.calcHeartSlotCost(this.id)}else this.isMax=!0,this.isAdd=!1;this.cost.visible=l?!0:!1;var p=DataCenter.ins().HeartMethodPosConfig[t.posId][t.quality];if(p){var c=Object.keys(p).length-1;this.starList?this.starList.setlistLength(c,t.star):(this.starList=new StarList(c),this.starList.horizontalCenter=0,this.starList.y=0,this.starGroup.addChild(this.starList)),this.starList.setStarNum(t.star)}this.updateRedPoint()
}}},e.prototype.updateRedPoint=function(){this.redPoint1.visible=this.isAdd,this.redPoint2.visible=heartMethodControl.calcHeartSlotChange(this.roleId,this.heartId,this.id)?!0:!1},e}(BaseEuiView);__reflect(HeartMethodTipsView.prototype,"HeartMethodTipsView");var HeartMethodDecomposeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeartMethodDecomposeItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.cb.touchChildren=!1,this.cb.touchEnabled=!1;var t=this.data,e=t.itemData;if(e&&e instanceof ItemData){var i=heartMethodControl.getHeartCfg(e);i?this.itemIcon.data=e:this.itemIcon.data=null}else this.itemIcon.data=null;this.cb.selected=t.isSelected},e}(BaseItemRender);__reflect(HeartMethodDecomposeItemRenderer.prototype,"HeartMethodDecomposeItemRenderer");var HeartMethodDisplayItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeartMethodDisplayItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data instanceof ItemData){var t=this.data,e=DataCenter.ins().ItemConfig[t.itemConfig.id];this.itemIcon.setData(e);var i=ItemUtils.getQualityColor(e);this.nameTF.textFlow=TextUtils.generateTextFlow1("|C:"+i+"&T:"+e.name)}},e}(BaseItemRender);__reflect(HeartMethodDisplayItemRenderer.prototype,"HeartMethodDisplayItemRenderer");var HeartMethodItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&this.data&&(this.data.itemid?(this.itemIcon.setData(DataCenter.ins().ItemConfig[this.data.itemid]),this.itemIcon.visible=!0,this.blank.visible=!1):(this.itemIcon.visible=!1,this.blank.source=this.data.blank,this.blank.visible=!0),this.redPoint.visible=this.data.redPoint)},e}(BaseItemRender);__reflect(HeartMethodItemRenderer.prototype,"HeartMethodItemRenderer");var HeirloomControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.huntTimes=0,e.huntBoxInfo=[],e.huntHope=0,e.huntFreeTimes=0,e.huntRecords=[],e.upRequest=!1,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.IsComposeItem=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=i.heirloom.getInfoBySolt(e);if(!n.icon){var o=DataCenter.ins().HeirloomEquipItemConfig[e+1],s=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,o.expend.id);return s>=o.expend.count}return!1},e.prototype.keepEquipForRole=function(t){for(var e=[],i=0;i<t.length;i++)if(t[i]){var n=CommonUtils.copyDataDepth(t[i]);e.push(n)}for(var o=3-heroControl.subRolesLen,s=[0,0,0,0,0,0,0,0],i=0;i<heroControl.subRolesLen;i++)for(var r=heroControl.getSubRoleByIndex(i),a=0;7>=a;a++){var l=r.heirloom.getInfoBySolt(a);l&&l.lv||s[a]++}for(var i=0;i<e.length;)if(e[i]){var a=this.calcPosByItem(e[i].configID)-1;if(0>a){i++;continue}var h=e[i].count-o-s[a];h>0?(e[i].count=h,i++):e.splice(i,1)}else i++;return e},e.prototype.calcPosByItem=function(t){for(var e in DataCenter.ins().HeirloomEquipItemConfig){var i=DataCenter.ins().HeirloomEquipItemConfig[e];if(i.item==t)return i.pos}return 0},e.prototype.upHeirloomAdd=function(t){return[t]},e.prototype.upHeirloomAct=function(t,e){return[t,e]},e.prototype.upHeirloomUpLevel=function(t,e){return this.upRequest=!0,[t,e]},e.prototype.downHeirloomInfo=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);n&&n.heirloom.update(e,i),EventMgr.ins().dispatch(65)},e.prototype.upHunt=function(t){return[t]},e.prototype.upHuntRecord=function(){},e.prototype.upHuntAward=function(t){return[t]},e.prototype.upActDress=function(t,e){return[t,e]},e.prototype.upWearDress=function(t,e){return[t,e]},e.prototype.downHuntBack=function(t,e){for(var i=[],n=0;n<e.length;n++)i[n]=[e[n][0],e[n][1]];UIMgr.ins().isShow(TreasureHuntResultView)?this.dispatchHuntResult(t,i,2):(UIMgr.ins().open(TreasureHuntResultView,t,i,2),this.dispatchHuntResult(t,i,2))},e.prototype.dispatchHuntResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().dispatch(66,t)},e.prototype.downHuntRecord=function(t){this.huntRecords=[];for(var e=0;e<t.length;e++)this.huntRecords[e]=[t[e][0],t[e][1]];this.huntRecords.reverse(),EventMgr.ins().dispatch(67)},e.prototype.downHuntBoxInfo=function(t,e,n,o){this.huntTimes=e,this.huntHope=n,this.huntFreeTimes=o;var s,r=0;for(var a in DataCenter.ins().HeirloomTreasureRewardConfig)s=DataCenter.ins().HeirloomTreasureRewardConfig[a],this.huntBoxInfo[r]=t>>s.id&1?i.ISNGET:this.huntTimes>=s.needTime?i.CANGET:i.UNGET,r++;EventMgr.ins().dispatch(68)},e.prototype.downDressInfo=function(t){this.dressDatas=[];for(var e=0;t.length>e;e++){var i=new HeirloomDressVo;i.init(t[e]),this.dressDatas[i.roleId]=i;var n=UnitMgr.ins().getMainRole(i.roleId);n&&(n.infoModel.heirloomDressId=i.curIndex,n.updateModel());var o=heroControl.getSubRoleByIndex(i.roleId);o.heirloomDressId=i.curIndex}if(UIMgr.ins().isShow(RoleView)){var s=UIMgr.ins().getView(RoleView);s.roleInfoPanel.setRoleEff()}EventMgr.ins().dispatch(69)},e.prototype.getIsGetBox=function(){return-1!=this.huntBoxInfo.indexOf(i.CANGET)||this.huntFreeTimes>0},e.prototype.isHeirloomHuntOpen=function(){return reincarnateControl.lv>=DataCenter.ins().HeirloomTreasureConfig.openZSlevel&&GameServer.serverOpenDay+1>=DataCenter.ins().HeirloomTreasureConfig.openDay},e.prototype.getDressDpList=function(){for(var t=Number.MAX_VALUE,e=0;e<heroControl.subRolesLen;e++){var i=heroControl.getSubRoleByIndex(e);if(i.heirloom){var n=i.heirloom.getSuitConfig(i);if(n&&t>n.lv)t=n.lv;else if(!n){t=0;break}}}t=t==Number.MAX_VALUE?0:t;var o=[];for(var s in DataCenter.ins().HeirloomillusionConfig){var r=DataCenter.ins().HeirloomillusionConfig[s];reincarnateControl.lv>=r.zsLv&&GameServer.serverOpenDay+1>=r.openDay&&t>=r.hlLv&&o.push(r)}return o},e.prototype.canDressHuanHua=function(){for(var t=Number.MAX_VALUE,e=!0,i=0;i<heroControl.subRolesLen;i++){var n=heroControl.getSubRoleByIndex(i);if(n.heirloom){var o=n.heirloom.getSuitConfig(n);if(o&&t>o.lv)t=o.lv;else if(!o){t=0;break}}}t=t==Number.MAX_VALUE?0:t;for(var s in DataCenter.ins().HeirloomillusionConfig){var r=DataCenter.ins().HeirloomillusionConfig[s];if(t<r.changeHlLv){e=!1;break}}return e},e.prototype.getDeressHHLevel=function(){var t=0;for(var e in DataCenter.ins().HeirloomillusionConfig){var i=DataCenter.ins().HeirloomillusionConfig[e];t<i.changeHlLv&&(t=i.changeHlLv)}return t},e.prototype.getDressDpById=function(t){for(var e in DataCenter.ins().HeirloomillusionConfig){var i=DataCenter.ins().HeirloomillusionConfig[e];if(i.itemid==t)return i}return null},e.UNGET=0,e.CANGET=1,e.ISNGET=2,__decorate([up(1,[1])],e.prototype,"upHeirloomAdd",null),__decorate([up(2,[1,1])],e.prototype,"upHeirloomAct",null),__decorate([up(3,[1,1])],e.prototype,"upHeirloomUpLevel",null),__decorate([down(1,[4,4,4])],e.prototype,"downHeirloomInfo",null),__decorate([up(4,[1])],e.prototype,"upHunt",null),__decorate([up(5)],e.prototype,"upHuntRecord",null),__decorate([up(6,[3])],e.prototype,"upHuntAward",null),__decorate([up(7,[1,1])],e.prototype,"upActDress",null),__decorate([up(8,[1,1])],e.prototype,"upWearDress",null),__decorate([down(4,[4,[3,4]])],e.prototype,"downHuntBack",null),__decorate([down(5,[[8,3]])],e.prototype,"downHuntRecord",null),__decorate([down(7,[3,3,3,2])],e.prototype,"downHuntBoxInfo",null),__decorate([down(8,[ByteConst.HeirloomDressVos])],e.prototype,"downDressInfo",null),e=i=__decorate([protocolsId(55)],e);var i}(BaseSystem);__reflect(HeirloomControl.prototype,"HeirloomControl");var AmuseTarget0Panel1=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=t.call(this)||this;return n.skinName="AmuseTarget0Panel1Skin",n.effs=[],n.rewards=[{type:1,id:900007,count:1},{type:1,id:900008,count:1},{type:1,id:900009,count:1},{type:0,id:2,count:2e4}],n}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.go,this.onTap),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.go,this.onTap),this.removeCustomEvents();for(var i=0;i<this.effs.length;i++)this.effs[i]&&DisplayUtils.removeFromParent(this.effs[i]);this.effs=[]},e.prototype.onTap=function(t){switch(t.currentTarget){case this.go:0!=unionControl.guildID?(UIMgr.ins().close(AmusementTotalEnterView),unionWarControl.upWinGuildInfo(),UIMgr.ins().close(UnionMapView),UIMgr.ins().open(UnionWarMainView)):tipsControl.showTips(LangMgr.getValueByKey("osaNoJoinGuild"))}},e.prototype.getTime=function(t){var e=DataCenter.ins().UnionBattleConstConfig.openServer,i=e.filter(function(t){return t.day==GameServer.serverOpenDay+1})[0];!i&&(i=e[0]);var n=new Date(t.startTime-1e3*DateUtils.SECOND_PER_DAY);n.setDate(n.getDate()+i.day),n.setHours(i.hours,i.min||0,0,0);var o=n.getMonth()+1+LangMgr.getValueByKey("activitMonth")+n.getDate()+LangMgr.getValueByKey("activitDayTime","")+i.hours+":"+i.min+"-",s=i.hours+":"+(i.min+DataCenter.ins().UnionBattleConstConfig.continueTime/60),r=n.getDay();return o+s+LangMgr.getValueByKey("weekStr"+r)},e.prototype.updateData=function(t){void 0===t&&(t=1);var e=amusementControl.getAmusementDataById(this.activityID),i=Math.floor(e.startTime/1e3-GameServer.serverTime/1e3),n=Math.floor(e.endTime/1e3-GameServer.serverTime/1e3);i>=0?(this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"),this.over.visible=!1):0>=n?(this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"),this.over.visible=!0):(this.over.visible=!1,this.actTime.text=this.getTime(e)),this.go.visible=!this.over.visible;for(var o=1;4>=o;o++)this["reward"+o].data=this.rewards[o-1];for(var o=1;3>=o;o++){var s="chuanqizbeff";if(!this.effs[o-1]||!this.effs[o-1].parent){var r=new GameMovieClip;r.x=this["reward"+o].width/2,r.y=this["reward"+o].height/2,r.y-=16,r.playFile(PATH_EFF+s,-1),this["reward"+o].addChild(r),this.effs.push(r)}}},e}(BasePanel);__reflect(AmuseTarget0Panel1.prototype,"AmuseTarget0Panel1");var CrazybtplayControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.swData={},e.step=0,e.taskCount=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkRedPoint=function(){return this.checkSysOpen()?!0:!1},e.prototype.checkSysShow=function(){return GameServer.serverOpenDay>=DataCenter.ins().CrazybtplayConfig.openserverday-1?!0:!1},e.prototype.checkSysOpen=function(){return this.checkSysShow()&&reincarnateControl.lv>=DataCenter.ins().CrazybtplayConfig.openzhuanshenglv?!0:!1},e.prototype.OpenTips=function(){var t="";return GameServer.serverOpenDay<DataCenter.ins().CrazybtplayConfig.openserverday-1&&(t+=LangMgr.getValueByKey("openSvHowDay",DataCenter.ins().CrazybtplayConfig.openserverday)),reincarnateControl.lv<DataCenter.ins().CrazybtplayConfig.openzhuanshenglv&&(t+=LangMgr.getValueByKey("zsreachlv",DataCenter.ins().CrazybtplayConfig.openzhuanshenglv)),tipsControl.showTips(LangMgr.getValueByKey("open1",t)),t},e.prototype.IsShenWuActivation=function(t){if(!this.checkSysOpen())return!1;if(3!=this.step)return!1;if(this.swData[t])return!1;if(!this.IsCondition(t))return!1;var e=DataCenter.ins().CrazybtplayBaseConfig[t];if(!e)return!1;var i=DataCenter.ins().CrazybtplayLvConfig[t][0],n=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e.mat);return n<i.count?!1:!0},e.prototype.IsDeblocking=function(){return this.checkSysOpen()?1!=this.step?!1:!0:!1},e.prototype.IsShenWuStrengthen=function(t){return this.checkSysOpen()?3!=this.step?!1:this.isMaxStrengthenLv(t)?!1:this.IsCondition(t)&&this.IsMaterial(t)?!0:!1:!1},e.prototype.IsCondition=function(t){var e=DataCenter.ins().CrazybtplayBaseConfig[t];if(!e.cond)return!0;var i=!0;for(var n in e.cond){var o=e.cond[n].id,s=e.cond[n].cond;if(!this.swData[o]){i=!1;break}if(this.swData[o].strengthenLv<s){i=!1;break}}return i},e.prototype.IsMaterial=function(t){if(!this.swData[t])return!1;var e=DataCenter.ins().CrazybtplayBaseConfig[t];if(!e.enhance)return!1;var i=DataCenter.ins().CrazybtplayEnhanceConfig[t][this.swData[t].strengthenLv+1];if(!i)return!1;var n=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e.enhance);return n<i.count?!1:!0},e.prototype.isMaxStrengthenLv=function(t){if(!this.swData[t])return!1;var e=DataCenter.ins().CrazybtplayEnhanceConfig[t][this.swData[t].strengthenLv+1];return e?!1:!0},e.prototype.isMaxUpLv=function(t){if(!this.swData[t])return!1;var e=DataCenter.ins().CrazybtplayLvConfig[t][this.swData[t].level+1];return e?!1:!0},e.prototype.IsUpLvMaterial=function(t){if(!this.swData[t])return!1;var e=DataCenter.ins().CrazybtplayBaseConfig[t];if(!e.mat)return!1;var i=DataCenter.ins().CrazybtplayLvConfig[t][this.swData[t].level+1];if(!i)return!1;var n=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e.mat);return n<i.count?!1:!0},e.prototype.IsUpLvShenWu=function(t){return this.checkSysOpen()?3!=this.step?!1:this.swData[t]?this.isMaxUpLv(t)?!1:this.IsUpLvMaterial(t)?!0:!1:!1:!1},e.prototype.getStrengthenAttrs=function(t,e){void 0===e&&(e=!1);var i,n=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],o=0,s=crazybtplayControl.swData[t]&&e?1:0;if(this.swData[t])i=DataCenter.ins().CrazybtplayEnhanceConfig[t][this.swData[t].strengthenLv+s];else{if(!e)return[n,o];i=DataCenter.ins().CrazybtplayEnhanceConfig[t][0+s]}i&&i.attrs&&(n=AttributeData.AttrAddition(n,i.attrs),o+=BackpackControl.getAttrPower(n));for(var r=0;r<n.length;r++)n[r].value*=heroControl.subRolesLen;return o*=heroControl.subRolesLen,[n,o]},e.prototype.getStarAttrs=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var n,o=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],s=0,r=crazybtplayControl.swData[t]&&e?1:0;if(this.swData[t])n=DataCenter.ins().CrazybtplayLvConfig[t][this.swData[t].level+r],n||(n=DataCenter.ins().CrazybtplayLvConfig[t][this.swData[t].level]);else{if(!i)return[o,s];n=DataCenter.ins().CrazybtplayLvConfig[t][0+r]}n&&n.attrs&&(o=AttributeData.AttrAddition(o,n.attrs),s+=BackpackControl.getAttrPower(o));var a=0,l=0;if(n&&n.talent){s+=BackpackControl.getAttrPower(n.talent);for(var h=[],u=[],p=0;p<heroControl.subRolesLen;p++){var c=heroControl.getSubRoleByIndex(p);u.push(c);for(var d=0;d<n.talent.length;d++)a+=ItemUtils.relatePower(n.talent[d],c);var g=ItemUtils.relatePowerEx(n.talent,c);h=AttributeData.AttrAddition(h,g)}l+=BackpackControl.addSkillPower(0,u,n.talent),a+=BackpackControl.getAttrPower(h)}for(var p=0;p<o.length;p++)o[p].value*=heroControl.subRolesLen;return s*=heroControl.subRolesLen,s+=l,s+=a,[o,s]},e.prototype.getShenWuPercentAttrs=function(t,e,i){void 0===i&&(i=!1);var n=[],o=0,s=0,r=this.swData[t]?this.swData[t].strengthenLv:0;i&&r++;var a=[],l=[],h=DataCenter.ins().CrazybtplayBaseConfig[t];for(var u in crazybtplayControl.swData){var p=DataCenter.ins().CrazybtplayBaseConfig[crazybtplayControl.swData[u].id];if(p.type==h.type)for(var c=0;c<p.skill.length;c++)if(h.id==p.id&&r>=p.skill[c].open||h.id!=p.id&&crazybtplayControl.swData[u].strengthenLv>=p.skill[c].open){var d=DataCenter.ins().CrazybtplaySkillConfig[p.skill[c].id];if(d.attrUpId)for(var g=0;g<d.attrUpId.length;g++){var m=DataCenter.ins().CrazybtplayAttrUpConfig[d.attrUpId[g]];m.area||h.id!=p.id?m.area==h.type&&l.push(m.id):a.push(m.id)}if(p.id==h.id&&d.attrs){o+=BackpackControl.getAttrPower(d.attrs);for(var g=0;g<heroControl.subRolesLen;g++)for(var f=heroControl.getSubRoleByIndex(g),v=0;v<d.attrs.length;v++)s+=ItemUtils.relatePower(d.attrs[v],f)}}}for(var c=0;c<a.length;c++){var m=DataCenter.ins().CrazybtplayAttrUpConfig[a[c]],y=AttributeData.getPercentAttr(e,m.value/1e4,!1,[m.type]);n=AttributeData.AttrAddition(n,y)}for(var c=0;c<l.length;c++){var m=DataCenter.ins().CrazybtplayAttrUpConfig[l[c]],C=AttributeData.getPercentAttr(e,m.value/1e4,!1,[m.type]);n=AttributeData.AttrAddition(n,C)}o+=BackpackControl.getAttrPower(n);for(var c=0;c<n.length;c++)n[c].value*=heroControl.subRolesLen;return o*=heroControl.subRolesLen,[n,o,s]},e.prototype.getStrengthenLvAll=function(){var t=0;for(var e in this.swData)this.swData[e]&&this.swData[e].strengthenLv&&(t+=this.swData[e].strengthenLv);return t},e.prototype.upShenWuUpLv=function(t){return[t]},e.prototype.upShenWuStrengthen=function(t){return[t]},e.prototype.upShenWuTaskInfo=function(){},e.prototype.downShenWuInfo=function(t,e,i){this.step=t,this.taskCount=e;for(var n=0;i.length>n;n++){var o=i[n][0],s=i[n][1],r=i[n][2];this.swData[o]||(this.swData[o]=new CrazybtplayDataVo(o)),this.swData[o].level=s,this.swData[o].strengthenLv=r}EventMgr.ins().dispatch(153)},e.prototype.downShenWuUpLv=function(t,e){var i=!1;this.swData[t]||(this.swData[t]=new CrazybtplayDataVo(t),i=!0),this.swData[t].level=e,i&&EventMgr.ins().dispatch(155,t),EventMgr.ins().dispatch(154)},e.prototype.downShenWuStrengthen=function(t,e){this.swData[t]||(this.swData[t]=new CrazybtplayDataVo(t)),this.swData[t].strengthenLv=e,EventMgr.ins().dispatch(156)},e.prototype.downShenWuTaskInfo=function(t,e){this.step=t,this.taskCount=e,EventMgr.ins().dispatch(157)},__decorate([up(2,[1])],e.prototype,"upShenWuUpLv",null),__decorate([up(3,[1])],e.prototype,"upShenWuStrengthen",null),__decorate([up(4)],e.prototype,"upShenWuTaskInfo",null),__decorate([down(1,[1,1,[1,3,3]])],e.prototype,"downShenWuInfo",null),__decorate([down(2,[1,3])],e.prototype,"downShenWuUpLv",null),__decorate([down(3,[1,3])],e.prototype,"downShenWuStrengthen",null),__decorate([down(4,[1,1])],e.prototype,"downShenWuTaskInfo",null),e=__decorate([protocolsId(45)],e)}(BaseSystem);__reflect(CrazybtplayControl.prototype,"CrazybtplayControl");var CrazybtplayCopyControl=function(t){function e(){var e=t.call(this)||this;return e.bossStamp={},e.angerNum=0,e.leaveTimeStamp=0,e.belongTimes=0,e.buyTimes=0,e.canEnterTimeStamp=0,e.belongList={},e.hudunTimeDic={},e.hudunMaxTimeDic={},e.addCustomEvent(353,function(){e.isShenwujindi?e.dispatchEnterFb():e.lastShenwujindi&&e.dispatchQuiKFb()}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"isShenwujindi",{get:function(){return 47==MapControl.copyType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hudun",{get:function(){return this.hudunTimeDic[this.curViewBossId]?Math.floor((DateUtils.formatMiniDateTime(this.hudunTimeDic[this.curViewBossId])-GameServer.serverTime)/DateUtils.MS_PER_SECOND):0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hudunMax",{get:function(){return this.hudunMaxTimeDic[this.curViewBossId]},enumerable:!0,configurable:!0}),e.prototype.dispatchEnterFb=function(){this.lastShenwujindi=!0,UIMgr.ins().open(CrazybtplayCopyFightView)},e.prototype.dispatchQuiKFb=function(){this.lastShenwujindi=!1,UIMgr.ins().close(CrazybtplayCopyFightView),UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView),UIMgr.ins().close(CrossBossReliveView)},e.prototype.isOpen=function(t){if(GameServer.serverOpenDay+1<DataCenter.ins().CrazybtplayBossBaseConfig.openDay)return t&&tipsControl.showTips(LangMgr.getValueByKey("needopenday",DataCenter.ins().CrazybtplayBossBaseConfig.openDay)),!1;var e=DataCenter.ins().CrazybtplayBossFbConfig[1];return e?e.lvLimit>ActorControl.level?(t&&tipsControl.showTips(LangMgr.getValueByKey("reachlvopen",e.lvLimit)),!1):e.zsLvLimit>reincarnateControl.lv?(t&&tipsControl.showTips(LangMgr.getValueByKey("reachzslvopen",e.zsLvLimit)),!1):!0:!1},e.prototype.getTabIndexById=function(t){for(var e in DataCenter.ins().CrazybtplayBossFbConfig)if(DataCenter.ins().CrazybtplayBossFbConfig[e].bossIdList.indexOf(t)>-1)return+e;return 1},e.prototype.getDpByBossId=function(t){for(var e in DataCenter.ins().CrazybtplayBossConfig)if(DataCenter.ins().CrazybtplayBossConfig[e].bossId==t)return DataCenter.ins().CrazybtplayBossConfig[e];return null},e.prototype.downBossInfo=function(t){for(var e=0;t.length>e;e++){var i=t[e][0],n=t[e][1];this.bossStamp[i]=n}},e.prototype.downAnger=function(t,e){this.angerNum=t,this.leaveTimeStamp=e,EventMgr.ins().dispatch(158)},e.prototype.downResult=function(t,e){var i=t==ActorControl.handle,n=UnitMgr.ins().getNoDieRole(),o=UnitMgr.ins().getEntityBymasterhHandle(t);if(!(n&&o&&MathUtils.getDistanceByObject(n,o)>DataCenter.ins().CrazybtplayBossBaseConfig.viewRange)){for(var s=o.infoModel,r="yuanhead"+s.job+s.sex,a=s.name,l=[],h=0;e.length>h;h++){var u=new RewardVo;u.init(e[h]),l.push(u),0==u.type&&1!=u.id&&2!=u.id&&9!=u.id||DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(UnitMgr.ins().getNoDieRole().x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(UnitMgr.ins().getNoDieRole().y/MapControl.CELL_SIZE),u])}var p=function(){resultControl.create(MapControl.copyType,!0,l,"",null,[i,a,r,o])};DropControl.start(),DropControl.addCompleteFunc(p,this)}},e.prototype.downInfo=function(t,e,i){this.belongTimes=t,this.buyTimes=e,this.canEnterTimeStamp=i,EventMgr.ins().dispatch(159)},e.prototype.downChangeBelong=function(t,e,i){var n=DataCenter.ins().CrazybtplayBossConfig[t];if(i?this.belongList[n.bossId]=i:delete this.belongList[n.bossId],this.curViewBossId==n.bossId){var o=DataCenter.ins().MonstersConfig[n.bossId];bossControl.dispatchBelongChange(i,e,o.name)}},e.prototype.downBelongList=function(t){this.belongList={};for(var e=0;t.length>e;e++){var i=t[e][0],n=t[e][1];i=DataCenter.ins().CrazybtplayBossConfig[i].bossId,this.belongList[i]=n}},e.prototype.downRelive=function(t,e){t=Math.floor((DateUtils.formatMiniDateTime(t)-GameServer.serverTime)/DateUtils.MS_PER_SECOND),t>0?UIMgr.ins().open(CrossBossReliveView,t,e):UIMgr.ins().close(CrossBossReliveView)},e.prototype.downHudun=function(t){this.hudunTimeDic={},this.hudunMaxTimeDic={};for(var e=0;t.length>e;e++){var i=t[e][0],n=t[e][1],o=t[e][2],s=DataCenter.ins().CrazybtplayBossConfig[i];this.hudunTimeDic[s.bossId]=o,this.hudunMaxTimeDic[s.bossId]=o-n}EventMgr.ins().dispatch(160)},e.prototype.upEnter=function(t){return[t]},e.prototype.upBuyTimes=function(){},e.prototype.upBuyReliveCd=function(){},e.prototype.upCleanBelong=function(t){return[t]},__decorate([down(1,[[4,3]])],e.prototype,"downBossInfo",null),__decorate([down(2,[2,3])],e.prototype,"downAnger",null),__decorate([down(4,[10,ByteConst.RewardVos])],e.prototype,"downResult",null),__decorate([down(6,[4,4,3])],e.prototype,"downInfo",null),__decorate([down(7,[4,10,10])],e.prototype,"downChangeBelong",null),__decorate([down(8,[[4,10]])],e.prototype,"downBelongList",null),__decorate([down(9,[3,10])],e.prototype,"downRelive",null),__decorate([down(11,[[4,3,3]])],e.prototype,"downHudun",null),__decorate([up(3,[3])],e.prototype,"upEnter",null),__decorate([up(5)],e.prototype,"upBuyTimes",null),__decorate([up(9)],e.prototype,"upBuyReliveCd",null),__decorate([up(10,[3])],e.prototype,"upCleanBelong",null),e=__decorate([protocolsId(48)],e)}(BaseSystem);__reflect(CrazybtplayCopyControl.prototype,"CrazybtplayCopyControl");var AmuseTarget0Panel11=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget0Panel11Skin",e}return __extends(e,t),e.prototype.open=function(){this.setData(),this.addCustomEvent(182,this.setData)},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.setData=function(){var t=DataCenter.ins().RechargeMultiDayConfig,e=0;for(var i in t[1].awardList){if(e<=GameServer.serverOpenDay&&GameServer.serverOpenDay<parseInt(i))break;e=parseInt(i)}var n=0,o=payControl.mDayNum;o=payControl.mRecNum>=t[o].num?payControl.mDayNum:payControl.mDayNum-1;for(var i in t){var s=t[i];this["reward"+n].itemRenderer=ItemBase,this["reward"+n].dataProvider=new eui.ArrayCollection(s.awardList[e]);var r=StringUtils.addColor("（"+(o>n+1?i:o)+"/"+i+"）",o>=parseInt(i)?LangMgr.getColor("color43"):LangMgr.getColor("color48"));this["target"+n].textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("osaShow1",i,r,s.num)),this["redPoint"+n].visible=!1,payControl.mDayNum>parseInt(i)?(this["get"+n],this["get"+n].enabled=!1):payControl.mDayNum==parseInt(i)&&payControl.mRecNum>=s.num&&0==payControl.mReward?(this["redPoint"+n].visible=!0,this["get"+n].label=LangMgr.getValueByKey("osaQuickGet"),this["get"+n].enabled=!0,this.addEventTouchTap(this["get"+n],this.onTap)):this["get"+n].enabled=!1,n++}this.todayRecharge.text=LangMgr.getValueByKey("osaDayAllPay",payControl.mRecNum);var a=amusementControl.getbtnInfo(this.activityID);this.actInfo0.text=a.acDesc},e.prototype.onTap=function(){payControl.upMuchDayRecReward()},e}(BasePanel);__reflect(AmuseTarget0Panel11.prototype,"AmuseTarget0Panel11");var AmuseTarget0Panel18=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget0Panel2Skin",e}return __extends(e,t),e.prototype.open=function(){this.content.useVirtualLayout=!0,this.content.itemRenderer=AmuseTarget0Panel18ListItemRender,this.bigReward.itemRenderer=AmuseTarget0Penal18RewardItemRender,this.content.dataProvider?this.updateData():this.updateList(),this.addCustomEvent(180,this.updateData)},e.prototype.updateList=function(){var t=[],e=[],i=new RewardVo;i.count=0,i.id=2,i.type=0;var n={id:100,awardList:[i]};e.push(n);var o=payControl.getRechargeList(2);for(var s in o){var r=o[s];t.push(r),i.id=r.awardList[0].id,i.type=r.awardList[0].type,i.count+=r.awardList[0].count,r.awardList.length>1&&1==r.bigReward&&e.push(r)}t.sort(this.sort),e.sort(this.sort2),this.content.dataProvider=new eui.ArrayCollection(t),this.bigReward.dataProvider=new eui.ArrayCollection(e);var a=amusementControl.getbtnInfo(this.activityID);this.actDesc.text=a.acDesc},e.prototype.sort=function(t,e){var i=payControl.rechargeTotal.hasGetDays1[0];return i.indexOf(t.id)>=0&&i.indexOf(e.id)<0?1:i.indexOf(t.id)<0&&i.indexOf(e.id)>=0?-1:t.id<e.id?-1:1},e.prototype.sort2=function(t,e){return t.id<e.id?1:-1},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.updateData=function(){var t=this.content.dataProvider;t.source.sort(this.sort),t.refresh(),t=this.bigReward.dataProvider;for(var e=0;e<t.length;e++)t.itemUpdated(t.getItemAt(e))},e}(BasePanel);__reflect(AmuseTarget0Panel18.prototype,"AmuseTarget0Panel18");var CrazybtplayDataVo=function(){function t(t){this.id=t,this.level=0,this.strengthenLv=0}return t}();__reflect(CrazybtplayDataVo.prototype,"CrazybtplayDataVo");var CrazybtplayBossTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplayBossTipViewSkin",e.uilayer=GameLayer.POPUP,e.bossGroup.touchEnabled=!1,e.bossGroup.touchChildren=!1,e.dropRewardList.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.initUI=function(){this.bossBttomMc=new GameMovieClip,this.bossEffGroup.addChild(this.bossBttomMc),this.bossBttomMc.playFile(PATH_EFF+"bossunder",-1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.dp=t[0],this.addEventTouchTap(this,this.onTouch),this.showBoss();var i=LangMgr.getValueByKey("refTimeInterval",this.dp.refreshTime/DateUtils.SECOND_PER_MUNITE);this.refTimeLabel.textFlow=TextUtils.generateTextFlow1(i),this.angleLabel.text=this.dp.addStrength+"";var n=CommonFun.dataToDropTag(this.dp.carryAwards.concat(),DataCenter.ins().CrazybtplayBossBaseConfig.dropTags);this.dropRewardList.dataProvider=new eui.ArrayCollection(n),this.bossName.source="jd_"+crazybtplayCopyControl.getTabIndexById(this.dp.id)+"_"+(this.dp.id%6||6)},e.prototype.close=function(){this.bossMc.dispose(),this.bossBttomMc.dispose(),ObjectPool.push(this.bossMc)},e.prototype.onTouch=function(t){t.target.parent instanceof ItemIcon||UIMgr.ins().close(this)},e.prototype.showBoss=function(){this.bossMc||(this.bossMc=ObjectPool.pop("GameMovieClip"),this.bossMc.scaleX=-1,this.bossMc.scaleY=1,this.bossMc.x=78,this.bossMc.y=50,this.bossGroup.addChild(this.bossMc));var t=this.dp.bossId,e=DataCenter.ins().MonstersConfig[t];this.bossMc.playFile(PATH_GUAIWU+(GUAIWU_PREFIX+e.avatar+"_3s"),-1)},e}(BaseEuiView);__reflect(CrazybtplayBossTipView.prototype,"CrazybtplayBossTipView");var CrazybtplayCopyFightView=function(t){function e(){var e=t.call(this)||this;e.bossHandelDic={},e.crztyControl=CrazybtplayCopyControl.ins(),e.skinName="CrazybtplayCopyFightViewSkin",e.angleBar.maximum=DataCenter.ins().CrazybtplayBossBaseConfig.totalShenWuStrength,e.baseDp=DataCenter.ins().CrazybtplayBossBaseConfig,e.baseDp.viewRange||(e.baseDp.viewRange=900),e.bossList=[];for(var i=1;6>=i;i++)e.bossList.push(e["boss"+i]);return e}return __extends(e,t),e.prototype.updateHandle=function(t){var e=t[0],i=t[1];this.tHandle=i,this.sHandle=e},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.boss1,this.onTouch),this.addEventTouchTap(this.boss2,this.onTouch),this.addEventTouchTap(this.boss3,this.onTouch),this.addEventTouchTap(this.boss4,this.onTouch),this.addEventTouchTap(this.boss5,this.onTouch),this.addEventTouchTap(this.boss6,this.onTouch),this.addCustomEvent(158,this.upAnger),this.addCustomEvent(355,this.onChangeHp),this.addCustomEvent(354,this.onCreateEntity),this.addCustomEvent(356,this.onRemoveEntity),this.addCustomEvent(357,this.moveCamera),this.addCustomEvent(9,this.moveCamera),this.addCustomEvent(559,this.updateHandle),this.addCustomEvent(542,this.onCheckEnemy),this.upAnger(),this.outTimeGroup.visible=!1;for(var i in DataCenter.ins().CrazybtplayBossFbConfig){var n=DataCenter.ins().CrazybtplayBossFbConfig[i];if(n.fbid==MapControl.copyId){for(var o=n.bossIdList.map(function(t){return DataCenter.ins().CrazybtplayBossConfig[t]}),s=0;s<this.bossList.length;s++)this.bossList[s].data=o[s];break}}var r=UnitMgr.ins().getAllEntity();for(var i in r){var a=r[i];0==a.infoModel.masterHandle&&(this.bossHandelDic[a.infoModel.configID]=a.infoModel.handle)}TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.moveCamera()},e.prototype.onTouch=function(t){if(t.target instanceof CrazybtplayBossItemRender){t.target.onClick(),gameControl.upStopAI();var e=t.target.data;this.bossHandelDic[e.bossId]?gameControl.dispatchChangeAttrPoint(this.bossHandelDic[e.bossId]):MapControl.moveTo((e.pos.posX+.5)*MapControl.CELL_SIZE>>0,(e.pos.posY+.5)*MapControl.CELL_SIZE>>0)}},e.prototype.upAnger=function(){this.angleBar.value=this.crztyControl.angerNum,this.progressBarLight.x=this.angleBar.x+this.angleBar.width*this.angleBar.value/this.angleBar.maximum-16},e.prototype.onGoOut=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.crztyControl.leaveTimeStamp)-GameServer.serverTime)/DateUtils.MS_PER_SECOND);t>0&&(this.outTimeGroup.visible=!0,this.countDown.text=t+"")},e.prototype.onCreateEntity=function(t){2!=t.type||t.masterHandle||(this.bossHandelDic[t.configID]=t.handle,this.moveCamera(),this.crztyControl.curViewBossId==t.configID&&monsterSpeakControl.dispatchMonsterSpeak("bosstishi"))},e.prototype.onRemoveEntity=function(t){var e=(t[0],t[1]),i=e.infoModel;this.bossHandelDic[i.configID]&&delete this.bossHandelDic[i.configID],this.crztyControl.curViewBossId==i.configID&&this.moveCamera()},e.prototype.onChangeHp=function(t){var e=t[0],i=t[1],n=e.infoModel;this.crztyControl.curViewBossId&&this.crztyControl.curViewBossId==n.configID&&(i>0?this.openBossPanel(n):this.closeBossPanel())},e.prototype.onTime=function(){this.onGoOut();var t=UnitMgr.ins().getNoDieRole();if(t&&(t.action!=UnitAction.STAND&&this.moveCamera(),this.tHandle)){var e=UnitMgr.ins().getEntityByHandle(this.tHandle)||UnitMgr.ins().getEntityBymasterhHandle(this.tHandle);e&&MathUtils.getDistanceByObject(t,e)<=this.baseDp.viewRange&&(targetListControl.dispatchTargetList(this.sHandle,this.tHandle),this.tHandle=0)}var i=UIMgr.ins().getView(BossBloodView);if(i&&i.huDunChange(),this.bossList)for(var n=0;n<this.bossList.length;n++){var o=this.bossList[n];o.onTime()}this.crztyControl.curViewBossId&&this.appearBossId!=this.crztyControl.curViewBossId?(this.appearBossId=this.crztyControl.curViewBossId,monsterSpeakControl.dispatchMonsterSpeak("bosstishi")):this.crztyControl.curViewBossId||(this.appearBossId=0)},e.prototype.onCheckEnemy=function(){var t=UnitMgr.ins().getNoDieRole();if(t)for(var e=targetListControl.canAttackHandles.length-1;e>-1;e--){var i=targetListControl.canAttackHandles[e],n=UnitMgr.ins().getEntityBymasterhHandle(i);
n&&MathUtils.getDistanceByObject(t,n)>this.baseDp.viewRange&&targetListControl.canAttackHandles.splice(e,1)}},e.prototype.moveCamera=function(){var t=UnitMgr.ins().getNoDieRole();if(t){this.crztyControl.curViewBossId=0;for(var e in DataCenter.ins().CrazybtplayBossConfig){var i=DataCenter.ins().CrazybtplayBossConfig[e];if(this.bossHandelDic[i.bossId]){var n=this.bossHandelDic[i.bossId],o=UnitMgr.ins().getEntityByHandle(n);if(o&&MathUtils.getDistanceByObject(t,o)<=this.baseDp.viewRange){this.crztyControl.curViewBossId=i.bossId;break}}}if(this.crztyControl.curViewBossId){if(bossControl.monsterID=this.crztyControl.curViewBossId,bossControl.attHandle=this.crztyControl.belongList[this.crztyControl.curViewBossId],this.bossHandelDic[this.crztyControl.curViewBossId]){var o=UnitMgr.ins().getEntityByHandle(this.bossHandelDic[this.crztyControl.curViewBossId]);if(o){var s=o.infoModel;this.openBossPanel(s)}}}else this.closeBossPanel(),bossControl.attHandle=0}},e.prototype.openBossPanel=function(t){bossControl.monsterID=t.configID,bossControl.hp=t.getAtt(0),bossControl.bossHandler=t.handle;var e=UIMgr.ins().open(BossBloodView);e.barGroup.y=95,e.barGroup.scaleX=e.barGroup.scaleY=.9;var i=UIMgr.ins().open(BossBelongView);i.belongGroup.right=100,i.belongGroup.y=175},e.prototype.closeBossPanel=function(){UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView)},e}(BaseEuiView);__reflect(CrazybtplayCopyFightView.prototype,"CrazybtplayCopyFightView");var CrazybtplayForbiddenPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bossItemId=204247,e.sys=CrazybtplayCopyControl.ins(),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.dropShowList.itemRenderer=ItemBase,this.dropListDt=new eui.ArrayCollection,this.dropShowList.dataProvider=this.dropListDt,this.bossList.itemRenderer=CrazybtplayBossItemRender,this.bossListDt=new eui.ArrayCollection,this.bossList.dataProvider=this.bossListDt,this.buyTime.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.buyTime.text+"</u></a>");for(var t=Object.keys(DataCenter.ins().CrazybtplayBossFbConfig).length,e=[],i=1;t>=i;i++)e.push(LangMgr.getValueByKey("forbiddenAreaN",StringUtils.NumberToChinese(i)));this.tab.dataProvider=new eui.ArrayCollection(e)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bossList,this.onTouch),this.addEventTouchTap(this.buyTime,this.onTouch),this.addEventTouchTap(this.enterBtn,this.onTouch),this.addEventChange(this.tab,this.onChangeTab),this.addEventChanging(this.tab,this.onTapTouching),this.addCustomEvent(159,this.upData),this.upData();var i=1;for(var n in DataCenter.ins().CrazybtplayBossFbConfig){var o=DataCenter.ins().CrazybtplayBossFbConfig[n];o.openDay<=GameServer.serverOpenDay+1&&o.lvLimit<=ActorControl.level&&o.zsLvLimit<=reincarnateControl.lv&&+n>i&&(i=+n)}this.tab.selectedIndex=i-1,this.onChangeTab(),TimerMgr.ins().isExists(this.onTimer,this)||TimerMgr.ins().doTimer(1e3,0,this.onTimer,this)},e.prototype.$onClose=function(){t.prototype.$onClose.call(this),TimerMgr.ins().removeAll(this)},e.prototype.onTimer=function(){for(var t=0;t<this.bossList.numElements;t++){var e=this.bossList.getElementAt(t);e.onTime()}},e.prototype.upData=function(){this.timeCount.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("ascriptionSYCount",this.sys.belongTimes))},e.prototype.onChangeTab=function(){this.chooseTab(this.tab.selectedIndex)},e.prototype.onTapTouching=function(t){this.checkIndex(t.currentTarget.selectedIndex)||t.preventDefault()},e.prototype.checkIndex=function(t){var e=DataCenter.ins().CrazybtplayBossFbConfig[t+1];return e?e.lvLimit>ActorControl.level?(tipsControl.showTips(LangMgr.getValueByKey("reachlvopen",e.lvLimit)),!1):e.zsLvLimit>reincarnateControl.lv?(tipsControl.showTips(LangMgr.getValueByKey("reachzslvopen",e.zsLvLimit)),!1):!0:!1},e.prototype.chooseTab=function(t){var e=DataCenter.ins().CrazybtplayBossFbConfig[t+1];this.dropListDt.source=CommonFun.dataToDropTag(e.dropAwards.concat(),DataCenter.ins().CrazybtplayBossBaseConfig.dropTags),this.dropListScroller.stopAnimation(),this.dropListScroller.viewport.validateNow(),this.dropListScroller.viewport.scrollH=0;var i=e.bossIdList.map(function(t){return DataCenter.ins().CrazybtplayBossConfig[t]});this.bossListDt.replaceAll(i)},e.prototype.onTouch=function(t){var e=this;switch(t.target){case this.buyTime:if(crazybtplayCopyControl.belongTimes>0)return void tipsControl.showTips(LangMgr.getValueByKey("useFinishBuy"));this.buyBelongTime();break;case this.enterBtn:if(copyControl.checkInFB())return;var i=Math.floor((DateUtils.formatMiniDateTime(this.sys.canEnterTimeStamp)-GameServer.serverTime)/DateUtils.MS_PER_SECOND);if(i>0)return void tipsControl.showTips(LangMgr.getValueByKey("waitSecondEnter",i));if(this.sys.belongTimes<=0)return void this.buyBelongTime(!0);warnControl.showDangerWarn(function(){e.sys.upEnter(DataCenter.ins().CrazybtplayBossFbConfig[e.tab.selectedIndex+1].id)});break;default:if(t.target instanceof CrazybtplayBossItemRender){var n=t.target.data;UIMgr.ins().open(CrazybtplayBossTipView,n)}}},e.prototype.buyBelongTime=function(t){var e=this,i=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,this.bossItemId);if(i>0){var n=DataCenter.ins().ItemConfig[this.bossItemId];return void warnControl.show(LangMgr.getValueByKey("expJuanZhouBuyCount",ItemUtils.getQualityColor(n),n.name),function(){backpackControl.upUseItem(e.bossItemId,1)},this)}var o,s;for(var r in DataCenter.ins().CrazybtplayBossBaseConfig.vipBuy)o=DataCenter.ins().CrazybtplayBossBaseConfig.vipBuy[r],o.count&&!s&&(s=+r);if(o=DataCenter.ins().CrazybtplayBossBaseConfig.vipBuy[vipControl.lv],vipControl.lv>=s){if(crazybtplayCopyControl.buyTimes>=o.count)return void tipsControl.showTips(LangMgr.getValueByKey("ascriptionArlLimil"));warnControl.show(LangMgr.getValueByKey("expenYbbuyCount",o.cost),function(){egret.callLater(function(){CommonFun.checkCurrency(o.cost)&&e.sys.upBuyTimes()},e)},this)}else t?tipsControl.showTips(LangMgr.getValueByKey("ascriptionArlLimil")):tipsControl.showTips(LangMgr.getValueByKey("shopTips34",s))},e}(BasePanel);__reflect(CrazybtplayForbiddenPanel.prototype,"CrazybtplayForbiddenPanel");var CrazybtplayPanel=function(t){function e(){var e=t.call(this)||this;return e.forgeStrongTxt=LangMgr.getValueByKey("forgeStrong"),e.equiActiveTxt=LangMgr.getValueByKey("equiActive"),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(610,this.delayUpdateView),this.addCustomEvent(611,this.delayUpdateView),this.addCustomEvent(157,this.StepCallBack),this.addCustomEvent(155,this.showActivation),this.addEventTouchTap(this.goBtn,this.onClick),this.addEventTouchTap(this.upBtn,this.onLongTap),this.addEventTouchTap(this.getItemTxt,this.onClick),this.addEventTouchTap(this.crazybtplayUpBtnItem,this.onClick),this.addEventTouchTap(this.icon,this.onClick);for(var i=0;4>i;i++)this.addEventTouchTap(this["skg"+i],this.onSkillClick);this.award.itemRenderer=ItemBase,this.addEventItemTap(this.list,this.onListChange),this.list.itemRenderer=CrazybtplayListItemRender,this.list.useVirtualLayout=!1,this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData,this.addEventItemTap(this.list2,this.onListChange2),this.list2.itemRenderer=CrazybtplayListItem2Render,this.list2.useVirtualLayout=!1,this.listData2=new eui.ArrayCollection,this.list2.dataProvider=this.listData2,this.curSelect=this.getRuleMenuItem(),this.updateListItem(),this.updateView(),this.updateTaskGroup()},e.prototype.showActivation=function(t){var e=DataCenter.ins().CrazybtplayBaseConfig[t],i=DataCenter.ins().ItemConfig[e.mat];Number(e.eff[3]);CommonFun.show(1,i.name,null,e.eff[0],!0,null,0,-120)},e.prototype.onSkillClick=function(t){for(var e=DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id],i=0;i<e.skill.length;i++)if(this["skg"+i]&&this["skg"+i]==t.currentTarget){UIMgr.ins().open(CrazybtplaySkillTipsView,this.curSelect.id,DataCenter.ins().CrazybtplaySkillConfig[e.skill[i].id]);break}},e.prototype.onLongTap=function(){this.upBtn.label==this.equiActiveTxt?(this.onClick({currentTarget:this.upBtn}),LongPressUtils.ins().forceEndPress(this.upBtn)):this.onClick({currentTarget:this.upBtn})},e.prototype.onClick=function(t){switch(t.currentTarget){case this.upBtn:if(this.upBtn.label==this.forgeStrongTxt)crazybtplayControl.IsShenWuStrengthen(this.curSelect.id)?crazybtplayControl.upShenWuStrengthen(this.curSelect.id):this.showGetWay();else if(this.upBtn.label==this.equiActiveTxt)crazybtplayControl.IsShenWuActivation(this.curSelect.id)&&(this.isplayAct=!0,crazybtplayControl.upShenWuUpLv(this.curSelect.id));else{if(!crazybtplayControl.IsCondition(this.curSelect.id)){var e=DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id],i="";for(var n in e.cond){var o=e.cond[n].id,s=DataCenter.ins().CrazybtplayBaseConfig[o];i+=DataCenter.ins().ItemConfig[s.mat].name+LangMgr.getValueByKey("NeedIntensifyLv",e.cond[n].cond)}return void tipsControl.showTips(LangMgr.getValueByKey("fireTips16",i))}this.showGetWay()}break;case this.goBtn:1==crazybtplayControl.step?(this.isplayDeblock=!0,this.goBtn.touchEnabled=!1,crazybtplayControl.upShenWuTaskInfo()):UIMgr.ins().open(LadderView,4);break;case this.getItemTxt:this.showGetWay();break;case this.crazybtplayUpBtnItem:UIMgr.ins().open(CrazybtplayUpLvView,this.curSelect.id);break;case this.icon:if(this.costId&&!isNaN(this.costCount)){var r=DataCenter.ins().ItemConfig[this.costId];31==ItemUtils.getType(r)?UIMgr.ins().open(CrazybtplayTipView,this.costId):UIMgr.ins().open(ItemTipsView,0,this.costId,this.costCount)}}},e.prototype.onListChange=function(t){this.curSelect.id!=this.showlist[t.itemIndex][0].id&&(this.curSelect=this.getIdRuleBySort(this.showlist[t.itemIndex][0].type),this.updateListItem(),this.updateView())},e.prototype.onListChange2=function(t){for(var e=0;e<this.showlist.length;e++)if(this.showlist[e][0].type==this.curSelect.type){if(this.curSelect.id==this.showlist[e][t.itemIndex].id)return;this.curSelect=new ShenWuListMenuItem(this.showlist[e][t.itemIndex].id);break}this.updateSecondItem(),this.updateView()},e.prototype.updateListItem=function(){this.updateFirstItem(),this.updateSecondItem()},e.prototype.updateFirstItem=function(){if(this.curSelect){this.listData.replaceAll(this.showlist),this.list.validateNow();for(var t=0;t<this.list.numElements;t++){var e=this.list.dataProvider.getItemAt(t),i=this.list.getVirtualElementAt(t);i.setSelect(!1),e[0].type==this.curSelect.type&&i.setSelect(!0)}}},e.prototype.updateSecondItem=function(){if(this.curSelect){for(var t=0;t<this.showlist.length;t++)if(this.showlist[t][0].type==this.curSelect.type){this.listData2.replaceAll(this.showlist[t].concat());break}this.list2.validateNow();for(var t=0;t<this.list2.numElements;t++){var e=this.list2.dataProvider.getItemAt(t),i=this.list2.getVirtualElementAt(t);i.setSelect(!1),e.sort==this.curSelect.sort&&i.setSelect(!0)}}},e.prototype.StepCallBack=function(){var t=this;if(this.isplayDeblock&&3==crazybtplayControl.step){this.isplayDeblock=!1,this.shenWuGroup.visible=!0;for(var e=0;e<this.award.numElements;e++){var i=this.award.getVirtualElementAt(e),n=new ItemBase;n.data=i.data,n.data.x=i.x,n.data.y=i.y,i.parent.addChild(n),this.flyItem(n)}setTimeout(function(){t.FadeOut(t.taskGroup,{time:200,callFun:t.updateTaskGroup})},2e3)}},e.prototype.flyItem=function(t){var e=new ItemBase;e.x=t.x,e.y=t.y,e.data=t.data,e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,t.parent.addChild(e),DisplayUtils.removeFromParent(t),gameControl.dispatchFlyItemEx(e)},e.prototype.delayUpdateView=function(){this.updateListItem(),this.updateView()},e.prototype.updateView=function(){3==crazybtplayControl.step&&(this.updateModel(),this.updateSkill(),this.updateCost(),this.updateAttrs(),this.updateRedPoint(),this.updateUpStar())},e.prototype.updateModel=function(){if(this.curSelect){this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effGroup.addChild(this.mc);var t=DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id];this.mc.name!=PATH_EFF+t.eff[0]&&this.mc.playFile(PATH_EFF+t.eff[0],-1),crazybtplayControl.swData[this.curSelect.id]?this.setLight(this.effGroup):this.setGray(this.effGroup),this.nameImg.source=t.eff[1],this.effGroup.touchEnabled=!1,this.mc.touchEnabled=!1,this.mc.scaleX=this.mc.scaleY=Number(t.eff[3])}},e.prototype.updateCost=function(){this.maxlv.visible=!1,crazybtplayControl.isMaxStrengthenLv(this.curSelect.id)&&(this.maxlv.visible=!0),this.upGroup.visible=!this.maxlv.visible,this.upBtn.label=this.forgeStrongTxt,crazybtplayControl.swData[this.curSelect.id]||(this.upBtn.label=this.equiActiveTxt);var t=ColorUtils.NORMAL_COLOR;t=this.upBtn.label==this.forgeStrongTxt?crazybtplayControl.IsShenWuStrengthen(this.curSelect.id)?ColorUtils.GREEN:ColorUtils.RED:crazybtplayControl.IsShenWuActivation(this.curSelect.id)?ColorUtils.GREEN:ColorUtils.RED;var e=crazybtplayControl.swData[this.curSelect.id]?DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].enhance:DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].mat,i=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e),n=crazybtplayControl.swData[this.curSelect.id]?crazybtplayControl.swData[this.curSelect.id].strengthenLv:0,o=crazybtplayControl.swData[this.curSelect.id]?DataCenter.ins().CrazybtplayEnhanceConfig[this.curSelect.id][n+1]:DataCenter.ins().CrazybtplayLvConfig[this.curSelect.id][0];if(o){this.costId=e,this.costCount=o.count;var s=o.count;if(this.countLabel.textFlow=TextUtils.generateTextFlow1("|C:"+t+"&T:"+i+"|/"+s),this.icon.source=DataCenter.ins().ItemConfig[e].icon+"_png",this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.costGroup.visible=this.getItemTxt.visible=!0,s||(this.costGroup.visible=this.getItemTxt.visible=!1),this.condition0.visible=!1,DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].cond){var r=DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].cond[0].id,a=DataCenter.ins().CrazybtplayBaseConfig[r].mat;crazybtplayControl.IsCondition(this.curSelect.id)||(this.condition0.visible=!0,this.condition0.text=LangMgr.getValueByKey("intensifytolv",DataCenter.ins().ItemConfig[a].name,DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].cond[0].cond),this.upGroup.visible=!1)}}this.enhanceLv.text="Lv."+n},e.prototype.updateSkill=function(){for(var t=DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id],e=0;e<t.skill.length;e++){this["blackImg"+e]&&(this["blackImg"+e].visible=!0);var i=DataCenter.ins().CrazybtplaySkillConfig[t.skill[e].id];this["skillIcon"+e].source=i.skillInfo[0]}if(crazybtplayControl.swData[this.curSelect.id])for(var n=crazybtplayControl.swData[this.curSelect.id]?crazybtplayControl.swData[this.curSelect.id].strengthenLv:0,e=0;e<t.skill.length;e++)n>=t.skill[e].open&&this["blackImg"+e]&&(this["blackImg"+e].visible=!1)},e.prototype.updateAttrs=function(){for(var t=0,e=crazybtplayControl.getStrengthenAttrs(this.curSelect.id),i=crazybtplayControl.getStarAttrs(this.curSelect.id),n=AttributeData.AttrAddition(e[0],i[0]),o=crazybtplayControl.getShenWuPercentAttrs(this.curSelect.id,n),s=crazybtplayControl.getStrengthenAttrs(this.curSelect.id,!0),r=AttributeData.AttrAddition(s[0],crazybtplayControl.getStarAttrs(this.curSelect.id,!1,!0)[0]),a=crazybtplayControl.getShenWuPercentAttrs(this.curSelect.id,r,!0),l=AttributeData.AttrAddition(n,o[0]),h=AttributeData.AttrAddition(r,a[0]),u=0;u<l.length;u++)for(var p=0;p<heroControl.subRolesLen;p++){var c=heroControl.getSubRoleByIndex(p);t+=ItemUtils.relatePower(l[u],c)}t+=e[1]+i[1]+o[1]+o[2];for(var d=[],u=0;u<heroControl.subRolesLen;u++)d.push(heroControl.getSubRoleByIndex(u));t=BackpackControl.addSkillPower(t,d,l),this.powerPanel.setPower(t),crazybtplayControl.swData[this.curSelect.id]?this.setLight(this.powerPanel):this.setGray(this.powerPanel);for(var u=0;u<l.length;u++)if(this["attr"+l[u].type]&&(this["attr"+l[u].type].text=AttributeData.getAttrStrByType(l[u].type)+"+"+l[u].value),this["arrow"+l[u].type]&&this["addAttr"+l[u].type]&&(this["arrow"+l[u].type].visible=this["addAttr"+l[u].type].visible=!1,!crazybtplayControl.isMaxStrengthenLv(this.curSelect.id)))for(var p=0;p<h.length;p++)if(l[u].type==h[p].type&&h[p].value&&l[u].value!=h[p].value){this["arrow"+l[u].type].visible=this["addAttr"+l[u].type].visible=!0,this["addAttr"+l[u].type].text=h[p].value+"";break}},e.prototype.updateRedPoint=function(){this.curSelect&&(this.redPoint.visible=crazybtplayControl.IsShenWuStrengthen(this.curSelect.id)||crazybtplayControl.IsShenWuActivation(this.curSelect.id))},e.prototype.updateUpStar=function(){this.curSelect&&(this.crazybtplayUpBtnItem.visible=crazybtplayControl.swData[this.curSelect.id]?!0:!1,this.crazybtplayUpBtnItem.data=crazybtplayControl.swData[this.curSelect.id]?this.curSelect.id:null)},e.prototype.getRuleMenuItem=function(){var t={};for(var e in DataCenter.ins().CrazybtplayBaseConfig){var i=DataCenter.ins().CrazybtplayBaseConfig[e].type;t[i]||(t[i]=[]),t[i].push(new ShenWuListMenuItem(DataCenter.ins().CrazybtplayBaseConfig[e].id))}for(var n in t)t[n].sort(function(t,e){return SortUtils.sortAscByKey(t,e,"_sort")});var o=[];for(var s in t)o.push({type:t[s][0].type,data:t[s]});o.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"type")}),this.showlist=[];for(var s=0;s<o.length;s++)this.showlist.push(o[s].data);for(var r,s=0;s<this.showlist.length;s++)for(var a=0;a<this.showlist[s].length;a++)if(crazybtplayControl.isMaxStrengthenLv(this.showlist[s][a].id)&&crazybtplayControl.isMaxUpLv(this.showlist[s][a].id)||r||(r=new ShenWuListMenuItem(this.showlist[s][a].id)),CrazybtplayRedPoint.ins().IsShenWuRedPoint(this.showlist[s][a].id))return this.showlist[s][a];return r?r:this.showlist[this.showlist.length-1][0]},e.prototype.getIdRuleBySort=function(t){var e=[];for(var i in DataCenter.ins().CrazybtplayBaseConfig)DataCenter.ins().CrazybtplayBaseConfig[i].type==t&&e.push(DataCenter.ins().CrazybtplayBaseConfig[i]);if(e.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"sort")}),!CommonUtils.getObjectLength(crazybtplayControl.swData))return new ShenWuListMenuItem(e[0].id);for(var n,o,i=0;i<e.length;i++){if(CrazybtplayRedPoint.ins().IsShenWuRedPoint(e[i].id))return new ShenWuListMenuItem(e[i].id);crazybtplayControl.swData[e[i].id]?o||crazybtplayControl.isMaxStrengthenLv(e[i].id)&&crazybtplayControl.isMaxUpLv(e[i].id)||(o=new ShenWuListMenuItem(e[i].id)):n||(n=new ShenWuListMenuItem(e[i].id))}return o?o:n?n:new ShenWuListMenuItem(e[e.length-1].id)},e.prototype.setGray=function(t){t.filters=FilterUtils.ARRAY_GRAY_FILTER},e.prototype.setLight=function(t){t.filters=[]},e.prototype.FadeOut=function(t,e){TweenUtil.FadeOut(t,this,e)},e.prototype.updateTaskGroup=function(){if(0!=crazybtplayControl.step&&1!=crazybtplayControl.step)return this.taskGroup.visible=!1,void(this.shenWuGroup.visible=!this.taskGroup.visible);this.taskGroup.visible=!0,this.shenWuGroup.visible=!this.taskGroup.visible,this.goRedPoint.visible=1==crazybtplayControl.step;var t=crazybtplayControl.taskCount>=DataCenter.ins().CrazybtplayConfig.taskInfo.target?ColorUtils.GREEN:ColorUtils.RED;this.progressLabel.textFlow=TextUtils.generateTextFlow1("|C:"+t+"&T:"+crazybtplayControl.taskCount+"/"+DataCenter.ins().CrazybtplayConfig.taskInfo.target+"|"),this.award.dataProvider=new eui.ArrayCollection(DataCenter.ins().CrazybtplayConfig.taskInfo.award),this.goBtn.icon=1==crazybtplayControl.step?"shenwu_get_reward_btn":"swjd_btn"},e.prototype.showGetWay=function(){crazybtplayControl.swData[this.curSelect.id]?warnControl.setBuyGoodsWarn(DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].enhance):warnControl.setBuyGoodsWarn(DataCenter.ins().CrazybtplayBaseConfig[this.curSelect.id].mat)},__decorate([callDelay(100)],e.prototype,"delayUpdateView",null),e}(BasePanel);__reflect(CrazybtplayPanel.prototype,"CrazybtplayPanel");var ShenWuListMenuItem=function(){function t(t){this._id=t,this.updateData(t)}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},set:function(t){this._id=t,this.updateData(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sort",{get:function(){return this._sort},enumerable:!0,configurable:!0}),t.prototype.updateData=function(t){var e=DataCenter.ins().CrazybtplayBaseConfig[t];this._type=e.type,this._sort=e.sort},t}();__reflect(ShenWuListMenuItem.prototype,"ShenWuListMenuItem");var CrazybtplaySkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplaySkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.bgClose,this.otherClose);for(var i=t[0],n=t[1],o=DataCenter.ins().CrazybtplayBaseConfig[i],s=ColorUtils.RED,r=0;r<o.skill.length;r++)if(n.id==o.skill[r].id&&crazybtplayControl.swData[i]&&crazybtplayControl.swData[i].strengthenLv>=o.skill[r].open){s=ColorUtils.GREEN;break}this.skillName0.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+n.skillInfo[1]),this.skillDesc0.textFlow=TextUtils.generateTextFlow1(n.skillInfo[2]),s==ColorUtils.GREEN?DisplayUtils.removeFromParent(this.conditionGroup0):this.condition0.textFlow=TextUtils.generateTextFlow1(n.skillInfo[3])},e}(BaseEuiView);__reflect(CrazybtplaySkillTipsView.prototype,"CrazybtplaySkillTipsView");var CrazybtplayTalentTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplaySkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.bgClose,this.otherClose);var i=t[0],n=t[1],o=DataCenter.ins().CrazybtplayLvConfig[i][n],s=ColorUtils.GREEN;this.skillName0.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+o.talentDesc[1]),this.skillDesc0.textFlow=TextUtils.generateTextFlow1(o.talentDesc[2]),DisplayUtils.removeFromParent(this.conditionGroup0)},e}(BaseEuiView);__reflect(CrazybtplayTalentTipsView.prototype,"CrazybtplayTalentTipsView");var CrazybtplayTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplayTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.skillList.itemRenderer=CrazybtplayTipSkillItemRender,this.itemid=t[0];var i=t[1];for(var n in DataCenter.ins().CrazybtplayBaseConfig){var o=DataCenter.ins().CrazybtplayBaseConfig[n];if(o.mat==this.itemid){this.swId=o.id;break}}var s=DataCenter.ins().CrazybtplayBaseConfig[this.swId];this.model||(this.model=new GameMovieClip),this.model.parent||this.shenwuEff.addChild(this.model),this.model.name!=PATH_EFF+s.eff[0]&&this.model.playFile(PATH_EFF+s.eff[0],-1);var r=DataCenter.ins().ItemConfig[this.itemid];this.itemIcon.setData(r),this.lblName.text=r.name,this.itemname.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(r)+"&T:"+r.name);var a=ItemUtils.getQuality(r);this.quali.source=a>0?"quali"+a:"";var l=crazybtplayControl.isMaxUpLv(this.swId)?0:1,h=crazybtplayControl.swData[this.swId]?crazybtplayControl.swData[this.swId].level+l:0,u=DataCenter.ins().CrazybtplayLvConfig[this.swId][h];this.talentIcon.source=u.talentDesc[0],this.talentDesc.textFlow=TextUtils.generateTextFlow1(u.talentDesc[2]),this.talentName.textFlow=TextUtils.generateTextFlow1(""+u.talentDesc[1]);for(var p=[],c=0;c<s.skill.length;c++)p.push(DataCenter.ins().CrazybtplaySkillConfig[s.skill[c].id]);this.skillList.dataProvider=new eui.ArrayCollection(p);var d=0,g=crazybtplayControl.getStarAttrs(this.swId,!0,!0);d+=g[1],this.powerPanel.setPower(Math.floor(d)),i||DisplayUtils.removeFromParent(this.goBtn)},e.prototype.otherClose=function(t){t.target==this.goBtn&&(crazybtplayControl.checkSysOpen()?UIMgr.ins().open(HeirloomView,1):crazybtplayControl.OpenTips()),UIMgr.ins().close(this)},e.prototype.onTouchList=function(t){var e=t.item;null!=t.item&&e[1]&&UIMgr.ins().open(e[1],e[2])},e}(BaseEuiView);__reflect(CrazybtplayTipView.prototype,"CrazybtplayTipView");var CrazybtplayUpLvView=function(t){function e(){var e=t.call(this)||this;return e.sysControl=CrazybtplayControl.ins(),e.skinName="CrazybtplayUpLvViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(610,this.delayUpdateView),this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.soulBtn,this.onClick),this.addEventTouchTap(this.getItemTxt,this.onClick),this.addEventTouchTap(this.talentIconImg0,this.onClick),this.addEventTouchTap(this.talentIconImg1,this.onClick),this.addEventTouchTap(this.talentIconImg2,this.onClick),this.addEventTouchTap(this.costImg,this.onClick),this.id=t[0],this.roleSelect.hideRole(),this.updateView()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.soulBtn:this.sysControl.IsUpLvShenWu(this.id)?this.sysControl.upShenWuUpLv(this.id):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));break;case this.getItemTxt:warnControl.setBuyGoodsWarn(DataCenter.ins().CrazybtplayBaseConfig[this.id].mat);break;case this.talentIconImg0:case this.talentIconImg2:var e=this.sysControl.swData[this.id]?this.sysControl.swData[this.id].level:1;UIMgr.ins().open(CrazybtplayTalentTipsView,this.id,e);break;case this.talentIconImg1:UIMgr.ins().open(CrazybtplayTalentTipsView,this.id,this.sysControl.swData[this.id].level+1);break;case this.costImg:if(this.costId&&!isNaN(this.costCount)){var i=DataCenter.ins().ItemConfig[this.costId];31==ItemUtils.getType(i)?UIMgr.ins().open(CrazybtplayTipView,this.costId):UIMgr.ins().open(ItemTipsView,0,this.costId,this.costCount)}}},e.prototype.delayUpdateView=function(){this.updateView()},e.prototype.updateView=function(){this.updateStar(),this.updateModel(),this.updateAttrs(),this.updateCost()},e.prototype.updateStar=function(){for(var t=0;t<this.starGroup.numElements;t++)this["starImg"+t]&&(this["starImg"+t].source=this.sysControl.swData[this.id]&&this.sysControl.swData[this.id].level>t?"shenqi_star":"shenqi_star_empty");var e=DataCenter.ins().CrazybtplayBaseConfig[this.id];this.nameImg.source=e.eff[1];for(var i=DataCenter.ins().CrazybtplayLvConfig[this.id],t=0;t<this.sysControl.swData[this.id].level;t++){var n=t-6*(t/6>>0);this["starImg"+n]&&i&&i[t+1].showIcon&&(this["starImg"+n].source=i[t+1].showIcon)}},e.prototype.updateModel=function(){this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effGroup.addChild(this.mc);var t=DataCenter.ins().CrazybtplayBaseConfig[this.id];this.mc.name!=PATH_EFF+t.eff[0]&&this.mc.playFile(PATH_EFF+t.eff[0],-1),this.mc.scaleX=this.mc.scaleY=Number(t.eff[3])},e.prototype.updateAttrs=function(){this.attrGroup2.visible=this.sysControl.isMaxUpLv(this.id),this.attrGroup0.visible=this.attrGroup1.visible=this.arrow0.visible=!this.attrGroup2.visible;var t=this.sysControl.getStarAttrs(this.id),e=this.sysControl.getStarAttrs(this.id,!0);if(this.attrGroup2.visible){this.attr2.text=AttributeData.getAttStr(t[0],0,1,"："),this.powerPanel2.setPower(t[1]);var i=DataCenter.ins().CrazybtplayLvConfig[this.id][this.sysControl.swData[this.id].level];this.talentName2.textFlow=TextUtils.generateTextFlow1(i.talentDesc[1]),this.talentIconImg2.source=i.talentDesc[0]}else{this.attr0.text=AttributeData.getAttStr(t[0],0,1,"："),this.attr1.text=AttributeData.getAttStr(e[0],0,1,"："),this.powerPanel0.setPower(t[1]),this.powerPanel1.setPower(e[1]);var i=DataCenter.ins().CrazybtplayLvConfig[this.id][this.sysControl.swData[this.id].level];this.talentName0.textFlow=TextUtils.generateTextFlow1(i.talentDesc[1]),this.talentIconImg0.source=i.talentDesc[0];var n=DataCenter.ins().CrazybtplayLvConfig[this.id][this.sysControl.swData[this.id].level+1];this.talentName1.textFlow=TextUtils.generateTextFlow1(n.talentDesc[1]),this.talentIconImg1.source=n.talentDesc[0]}},e.prototype.updateCost=function(){if(this.maxLevel.visible=this.sysControl.isMaxUpLv(this.id),this.upGroup.visible=!this.maxLevel.visible,!this.maxLevel.visible){var t=this.sysControl.swData[this.id]?this.sysControl.swData[this.id].level:0,e=DataCenter.ins().CrazybtplayBaseConfig[this.id],i=DataCenter.ins().ItemConfig[e.mat];this.costImg.source=i.icon+"_png",this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.visible=this.sysControl.isMaxStrengthenLv(this.id)?!1:!0;var n=DataCenter.ins().CrazybtplayLvConfig[this.id][t+1],o=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e.mat),s=ColorUtils.NORMAL_COLOR;this.sysControl.IsUpLvShenWu(this.id)?(s=ColorUtils.GREEN,this.redPoint.visible=!0):(s=ColorUtils.RED,this.redPoint.visible=!1),this.num.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+o),this.needNum.text="/"+n.count,this.costId=e.mat,this.costCount=n.count}},e.prototype.updateTalent=function(){var t=this.sysControl.swData[this.id]?this.sysControl.swData[this.id].level:0,e=DataCenter.ins().CrazybtplayLvConfig[this.id][t];this.talentIconImg.source=e.talentDesc[0],this.talentName.text=e.talentDesc[1],this.talentDesc.text=e.talentDesc[2]},__decorate([callDelay(100)],e.prototype,"delayUpdateView",null),e}(BaseEuiView);__reflect(CrazybtplayUpLvView.prototype,"CrazybtplayUpLvView");var CrazybtplayBossItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().MonstersConfig[t.bossId];this.bossIcon.source="monhead"+e.head+"_png",this.bossIcon.scaleY=this.bossIcon.scaleX=1,this.bossName.source="swjd_"+crazybtplayCopyControl.getTabIndexById(t.id)+"_boss"+(t.id%6||6),this.shenqiForce&&(this.shenqiForce.text=t.addStrength+""),this.redPoint.visible=!1,this.onTime()},e.prototype.onTime=function(){var t=this.data;if(crazybtplayCopyControl.bossStamp[t.id]){this.countDownGroup.visible=!0,this.bossIcon.filters=FilterUtils.ARRAY_GRAY_FILTER;var e=Math.floor((DateUtils.formatMiniDateTime(crazybtplayCopyControl.bossStamp[t.id])-GameServer.serverTime)/DateUtils.MS_PER_SECOND);this.countDown.text=LangMgr.getValueByKey("osaAfteUpdate",DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_3))}else this.countDown.text="",this.countDownGroup.visible=!1,this.bossIcon.filters=[]},e.prototype.onClick=function(){egret.Tween.get(this.group).to({scaleX:.7,scaleY:.7},100).to({scaleX:1,scaleY:1},100)},e}(BaseItemRender);__reflect(CrazybtplayBossItemRender.prototype,"CrazybtplayBossItemRender");var CrazybtplayListItem2Render=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplayListItem2Skin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=DataCenter.ins().CrazybtplayBaseConfig[this.data.id],e=DataCenter.ins().ItemConfig[t.mat];this.nameImg.source=t.eff[2],this.iconImg.source=e.icon+"_png",this.redPoint.visible=CrazybtplayRedPoint.ins().IsShenWuRedPoint(t.id),this.lv.text=crazybtplayControl.swData[t.id]?""+crazybtplayControl.swData[t.id].strengthenLv:"0",this.iconImg.filters=crazybtplayControl.swData[t.id]?[]:FilterUtils.ARRAY_GRAY_FILTER}},e.prototype.setSelect=function(t){this.chosen.visible=t},e}(BaseItemRender);__reflect(CrazybtplayListItem2Render.prototype,"CrazybtplayListItem2Render");var CrazybtplayListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplayListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){for(var t=0;t<this.data.length;)this.redPoint.visible=CrazybtplayRedPoint.ins().IsShenWuRedPoint(this.data[t].id),t++;this.typeBgImg.source=DataCenter.ins().CrazybtplayConfig.swFirstRes[this.data[0].type-1][0];
var e=DataCenter.ins().CrazybtplayBaseConfig[this.data[0].id].enhance,i=DataCenter.ins().ItemConfig[e];this.icon.source=i.icon+"_png",this.countLabel.text=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.id)+""}},e.prototype.setSelect=function(t){this.chosen.visible=t},e}(BaseItemRender);__reflect(CrazybtplayListItemRender.prototype,"CrazybtplayListItemRender");var CrazybtplayTipSkillItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplayTipSkillItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.skillInfo[3];this.skillIcon.source=this.data.skillInfo[0],this.skillName.textFlow=TextUtils.generateTextFlow1(t+LangMgr.getValueByKey("powerfulSkill",this.data.skillInfo[1])),this.skillDesc.textFlow=TextUtils.generateTextFlow1(""+this.data.skillInfo[2])}},e}(BaseItemRender);__reflect(CrazybtplayTipSkillItemRender.prototype,"CrazybtplayTipSkillItemRender");var CrazybtplayUpBtnItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazybtplayUpBtnItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){for(var t=this.data,e=this.starGroup.numElements,i=0;e>i;i++)this["star"+i].source="shenqi_star_empty",crazybtplayControl.swData[t]&&(this["star"+i].source=crazybtplayControl.swData[t].level>i?"shenqi_star":"shenqi_star_empty");for(var n=DataCenter.ins().CrazybtplayLvConfig[t],i=0;i<crazybtplayControl.swData[t].level;i++){var o=i-6*(i/6>>0);this["star"+o]&&n&&n[i+1].showIcon&&(this["star"+o].source=n[i+1].showIcon)}this.redPoint.visible=crazybtplayControl.IsUpLvShenWu(t)}},e}(BaseItemRender);__reflect(CrazybtplayUpBtnItemRender.prototype,"CrazybtplayUpBtnItemRender");var HeirloomDressVo=function(){function t(){}return t.prototype.init=function(t){this.roleId=t[0],this.curIndex=t[1],this.actIdBit=t[2]},t.prototype.isAct=function(t){return!!(this.actIdBit>>t&1)},t}();__reflect(HeirloomDressVo.prototype,"HeirloomDressVo");var HeirloomSlotVo=function(){function t(){this.slot=0,this.lv=0,this.expend={id:0,count:0},this.attr=[],this.icon=0,this.name="",this.image="",this.model="",this.skillicon="",this.skillname="",this.skilldesc="",this.attr_add=0}return t.prototype.setInfo=function(t,e){if(t>0&&e>0){var i=DataCenter.ins().HeirloomEquipConfig[t][e];Assert(i,"HeirloomInfo setInfo error! slot:"+t+",lv:"+e),this.slot=i.slot,this.lv=i.lv,this.expend=i.expend,this.attr=i.attr,this.icon=i.icon,this.name=i.name,this.image=i.image,this.model=i.model,this.skillicon=i.skillicon,this.skillname=i.skillname,this.skilldesc=i.skilldesc,this.attr_add=i.attr_add}},t}();__reflect(HeirloomSlotVo.prototype,"HeirloomSlotVo");var HeirloomVo=function(){function t(){this.heirloomData=[]}return t.prototype.init=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.heirloomData[e]||(this.heirloomData[e]=new HeirloomSlotVo),this.heirloomData[e].setInfo(e+1,i)}},t.prototype.update=function(e,i){if(!(0>=e||e>t.MaxSlot)){var n=this.heirloomData[e-1];n&&n.setInfo(e,i)}},t.prototype.getData=function(){return this.heirloomData},t.prototype.getInfoBySolt=function(e){if(e>=0&&e<t.MaxSlot){var i=this.heirloomData[e];return i}return null},t.getInfoBySoltFirst=function(e){if(e>=0&&e<t.MaxSlot){var i=DataCenter.ins().HeirloomEquipConfig[e+1][1];return i}return null},t.getEquipName=function(t){return LangMgr.getValueByKey("equipPosName"+t)},t.prototype.getSuitConfig=function(t){for(var e=t.heirloom.getData(),i=0,n=!0,o=0;o<e.length;o++){var s=e[o];0==o&&(i=s.lv),!s.lv&&n&&(n=!1),s.lv<=i&&(i=s.lv)}var r;return n&&(r=DataCenter.ins().HeirloomEquipSetConfig[i]),r},t.prototype.getSuitLv=function(t){for(var e=t.heirloom.getData(),i=0,n=0;n<e.length;n++){var o=e[n];0==n&&(i=o.lv),o.lv<=i&&(i=o.lv)}return i},t.MaxSlot=8,t}();__reflect(HeirloomVo.prototype,"HeirloomVo");var TotemControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exp=0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.upWear=function(t,e,i,n){return[t,e,i,n]},e.prototype.upUpgrade=function(t,e,i){return[t,e,i]},e.prototype.downInfo=function(t,e,i){this._teTengInfo||(this._teTengInfo={}),this._skillInfo||(this._skillInfo=[]),this._skillInfo[t]=e>0,this._teTengInfo[t]={};for(var n=this._teTengInfo[t],o=0;i.length>o;o++){var s=new TotemVo;s.init(i[o]),n[s.id]=s}TotemSkillControl.ins().init(),EventMgr.ins().dispatch(167)},e.prototype.dispatchLineChange=function(){EventMgr.ins().dispatch(168)},e.prototype.upDeCompose=function(t){return t&&0!=t.length?[t]:!1},e.prototype.downExp=function(t){this.exp=t,EventMgr.ins().dispatch(169)},e.prototype.upLvUp=function(t,e){return[t,e]},e.prototype.upActiveSkillByYB=function(t){return[t]},e.prototype.checkOpen=function(){return reincarnateControl.lv<DataCenter.ins().TotemBaseConfig.openZs||GameServer.serverOpenDay<DataCenter.ins().TotemBaseConfig.openDay-1?!1:!0},e.prototype.checkRed=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkRedByRoleID(e))return!0;return!1},e.prototype.checkRedByRoleID=function(t){var e=heroControl.getSubRoleByIndex(t),i=DataCenter.ins().TotemPartConfig[e.job];for(var n in i)if(this.checkRedByID(t,+n))return!0;return!1},e.prototype.checkRedByID=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=DataCenter.ins().TotemPartConfig[i.job][e];for(var o in n)if(this.checkRedByPos(t,e,+o))return!0;return this.checkForgeUpGRed(t,e)?!0:this.checkSkillRed(t,e)?!0:!1},e.prototype.checkUpGradeRed=function(t,e){var i=this.getTTDataByID(t,e),n=i?i.lv:0;return n>=Object.keys(DataCenter.ins().TotemLvConfig).length?!1:this.exp>=DataCenter.ins().TotemLvConfig[n+1].needExp},e.prototype.getForgeItems=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=DataCenter.ins().TotemPartConfig[i.job][e][1];if(2==n.type)return null;var o=this.getTTDataByID(t,e);if(!o)return null;for(var s={},r=heroControl.subRolesLen,a=0;r>a;a++){i=heroControl.getSubRoleByIndex(a);var l=DataCenter.ins().TotemPartConfig[i.job][e];if(l){if(o=this.getTTDataByID(a,e),!o)return null;for(var h in l){var u=+h,p=s[u];if(-1!=p){var c=o.getValueByPos(u);if(c){if(0==p)continue;var d=l[u].equipId,g=d.indexOf(c);void 0==p?s[u]=g:p>g&&(s[u]=g)}else s[u]=-1}}}}var m=[];i=heroControl.getSubRoleByIndex(t);for(var u in s){var p=s[+u];if(-1!=p)for(var d=DataCenter.ins().TotemPartConfig[i.job][e][+u].equipId.slice(0,p+1),f=d.length,a=0;f>a;a++){var v=backpackControl.getBagItemById(d[a]);v&&v.count&&m.push(v)}}return m},e.prototype.checkForgeUpGRed=function(t,e){if(this.checkUpGradeRed(t,e))return!0;var i=heroControl.getSubRoleByIndex(t),n=DataCenter.ins().TotemPartConfig[i.job][e][1];if(2==n.type)return!1;var o=this.getTTDataByID(t,e);if(!o)return!1;for(var s={},r=heroControl.subRolesLen,a=0;r>a;a++){i=heroControl.getSubRoleByIndex(a);var l=DataCenter.ins().TotemPartConfig[i.job][e];if(l){if(o=this.getTTDataByID(a,e),!o)return!1;for(var h in l){var u=+h,p=s[u];if(-1!=p){var c=o.getValueByPos(u);if(c){if(0==p)continue;var d=l[u].equipId,g=d.indexOf(c);void 0==p?s[u]=g:p>g&&(s[u]=g)}else s[u]=-1}}}}i=heroControl.getSubRoleByIndex(t);for(var u in s){var p=s[+u];if(-1!=p)for(var d=DataCenter.ins().TotemPartConfig[i.job][e][+u].equipId.slice(0,p+1),m=d.length,a=0;m>a;a++)if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,d[a])>0)return!0}return!1},e.prototype.checkRedByPos=function(t,e,i){var n=heroControl.getSubRoleByIndex(t),o=2==DataCenter.ins().TotemPartConfig[n.job][e][1].type,s=DataCenter.ins().TotemPartConfig[n.job][e][i],r=totemControl.getTTDataByID(t,e),a=r?r.getValueByPos(i):0;if(o){var l=DataCenter.ins().TotemStageConfig[n.job][e][i],h=Object.keys(l).length;if(a>=h)return!1;var u=l[a+1];if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,u.costItem.itemId)>=u.costItem.count)return!0}else{var p=s.equipId,c=p.indexOf(a),d=[];if(-1==c)d=p.concat();else{if(c==p.length-1)return!1;d=p.slice(c+1)}for(var g=d.length,m=0;g>m;m++)if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,d[m])>0)return!0}return!1},e.prototype.getTTDataByID=function(t,e,i){if(void 0===i&&(i=!0),i){if(!this._teTengInfo)return null}else if(!this.otherPlayerData||!this.otherPlayerData.teTengInfo)return null;var n=i?this._teTengInfo[t]:this.otherPlayerData.teTengInfo[t];return n?n[e]:null},e.prototype.getSuitInfo=function(t,e,i){void 0===i&&(i=!0);var n=this.getJob(t,i),o=DataCenter.ins().TotemPartConfig[n][e],s=o[1],r=2==s.type,a=s.equipId,l=r?this.getTTMaxSuitLv(t,e,i):DataCenter.ins().ItemConfig[a[a.length-1]].level,h=r?1:DataCenter.ins().ItemConfig[a[0]].level,u=totemControl.getTTDataByID(t,e,i),p={};for(var c in o){var d=u?u.getValueByPos(+c):0;if(d)for(var g=r?d:DataCenter.ins().ItemConfig[d].level,m=g;m>=h;m--)p[m]?p[m]++:p[m]=1}for(var f=Object.keys(DataCenter.ins().TotemPartConfig[n][e]).length,v=[],y={},m=l;m>=h;m--){var C=p[m]?p[m]:0;if(0!=C){var T=r?m:m-h+1;if(C==f){this.setCountInfo(C,T,v,y,n,e);break}this.setCountInfo(C,T,v,y,n,e)}}return y},e.prototype.setCountInfo=function(t,e,i,n,o,s){var r=DataCenter.ins().TotemSuitLvConfig[o][s];for(var a in r){var l=+a;t>=l&&-1==i.indexOf(l)&&(i.push(l),n[l]=e)}},e.prototype.getPhasePowerByCfg=function(t,e,i){void 0===i&&(i=!0);var n=i?null:totemControl.getOtherRoleByIndex(e),o=0;return t.attrs&&(o+=BackpackControl.getAttPowerContainRelate(t.attrs,e,n)),t.ex_power&&(o+=t.ex_power),o},e.prototype.getLinkStr=function(t){var e=AttributeFormat.getFormat(0,0,LangMgr.getValueByKey("samTips12")),i="";return t.attrs&&(i=AttributeData.getAttStr1([t.attrs[0]],e,!1)),t.ex_attrs&&(i=AttributeData.getExAttStr([t.ex_attrs[0]],e,!1)),i},e.prototype.getTotemDpById=function(t,e){void 0===e&&(e=1);for(var i in DataCenter.ins().TotemPartConfig){var n=DataCenter.ins().TotemPartConfig[i];for(var o in n)if(n[o][e].totemId==t)return n[o][e]}return null},e.prototype.getTTMaxSuitLv=function(t,e,i){void 0===i&&(i=!0);var n=DataCenter.ins().TotemSuitLvConfig[this.getJob(t,i)][e];for(var o in n){var s=n[o];return Object.keys(s).length}return 0},e.prototype.isSkillActived=function(t,e){if(void 0===e&&(e=!0),e){if(!this._skillInfo)return!1}else if(!this.otherPlayerData||!this.otherPlayerData.ttSkillInfo)return!1;var i=e?this._skillInfo:this.otherPlayerData.ttSkillInfo;return i[t]},e.prototype.checkSkillRed=function(t,e){var i=heroControl.getSubRoleByIndex(t);return 2!=DataCenter.ins().TotemPartConfig[i.job][e][1].type?!1:!this.isSkillActived(t)&&ActorControl.yb>=DataCenter.ins().TotemBaseConfig.initialskillid[i.job-1].cost?!0:!1},e.prototype.getTuTengEquipInfo=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=DataCenter.ins().TotemPartConfig[i.job][e],o=n[1],s=2==o.type,r=totemControl.getTTDataByID(t,e),a={};for(var l in n){var h=r?r.getValueByPos(+l):0;if(h){var u=s?h:DataCenter.ins().ItemConfig[h].level;a[u]?a[u]++:a[u]=1}}return a},e.prototype.getSkillID=function(t){if(!this.isSkillActived(t))return 0;var e=heroControl.getSubRoleByIndex(t),i=DataCenter.ins().TotemBaseConfig.initialskillid[e.job-1],n=DataCenter.ins().TotemBaseConfig.specialTotemId[e.job-1],o=this.getSuitInfo(t,n),s=DataCenter.ins().TotemSuitLvConfig[e.job][n],r=i.id;for(var a in s){var l=+a,h=o[l];if(h){var u=s[a][h];if(u.skillId&&u.skillId.length){r=u.skillId[0];break}}}return r},e.prototype.getSkillReviseId=function(t,e){if(!i.isTutenSkill(e))return[];var n=heroControl.getSubRoleByIndex(t),o=DataCenter.ins().TotemBaseConfig.specialTotemId[n.job-1],s=this.getSuitInfo(t,o),r=DataCenter.ins().TotemSuitLvConfig[n.job][o],a=[];for(var l in r){var h=+l,u=s[h];if(u){var p=r[l][u];p.skillReviseId&&p.skillReviseId.length&&(a=p.skillReviseId)}}return a},e.isTutenSkill=function(t){for(var e in DataCenter.ins().TotemBaseConfig.initialskillid){var i=DataCenter.ins().TotemBaseConfig.initialskillid[e];if(1e3*(i.id/1e3>>0)==1e3*(t/1e3>>0))return!0}return!1},e.prototype.getJob=function(t,e){return void 0===e&&(e=!0),e?heroControl.getSubRoleByIndex(t).job:this.otherPlayerData.roleData[t].job},e.prototype.getOtherRoleByIndex=function(t){return!this.otherPlayerData||!this.otherPlayerData.roleData||this.otherPlayerData.roleData.length<=t?null:this.otherPlayerData.roleData[t]},e.prototype.getActivedTTInfo=function(t,e){if(void 0===e&&(e=!0),e){if(!this._teTengInfo)return null}else if(!this.otherPlayerData||!this.otherPlayerData.teTengInfo)return;var i=e?this._teTengInfo[t]:this.otherPlayerData.teTengInfo[t];if(!i)return null;var n=[],o=this.getJob(t,e);for(var s in i){var r=i[s];if(r){var a=DataCenter.ins().TotemPartConfig[o][+s],l=2==a[1].type,h=!0;for(var u in a){var p=r.getValueByPos(+u);if(!p){h=!1;break}}if(h){var c=Number.MAX_VALUE;if(l)c=6;else{var d=this.getSuitInfo(t,+s,e);for(var g in d){var m=d[g];m&&c>m&&(c=m)}}c&&c!=Number.MAX_VALUE||(c=1),n.push({job:o,id:+s,quality:c})}}}return n.length?n:null},__decorate([up(24,[1,1,1,3])],e.prototype,"upWear",null),__decorate([up(25,[1,1,1])],e.prototype,"upUpgrade",null),__decorate([down(26,[4,4,ByteConst.TotemVos])],e.prototype,"downInfo",null),__decorate([up(27,[[3]])],e.prototype,"upDeCompose",null),__decorate([down(28,[3])],e.prototype,"downExp",null),__decorate([up(29,[1,1])],e.prototype,"upLvUp",null),__decorate([up(30,[1])],e.prototype,"upActiveSkillByYB",null),e=i=__decorate([protocolsId(4)],e);var i}(BaseSystem);__reflect(TotemControl.prototype,"TotemControl");var AmuseTarget0Panel19=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget0Panel19Skin",e}return __extends(e,t),e.prototype.open=function(){this.content.useVirtualLayout=!0,this.bigReward.itemRenderer=DailyGiftAwItemRender,this.content.itemRenderer=DailysGiftItemRender,this.addCustomEvent(452,this.upData),this.addEventTouchTap(this.content,this.onTouchList),this.list=dailyGiftActControl.getConfigList();for(var t=[],e=0;e<this.list.length;e++){var i=this.list[e];i.bigReward&&t.push(i)}t.sort(this.compareFn1),this.bigReward.dataProvider=new eui.ArrayCollection(t),this.list.sort(this.compareFn);var n=this.list.concat();this.content.dataProvider=new eui.ArrayCollection(n.splice(0,3)),this.delayUpdate(n)},e.prototype.upData=function(){for(var t=0;t<this.content.numChildren;t++)this.content.getChildAt(t)&&this.content.getChildAt(t).updata();this.bigReward.dataProvider.refresh()},e.prototype.delayUpdate=function(t){var e=this.content.dataProvider;e.addItem(t.shift()),t.length&&this.delayUpdate(t)},e.prototype.compareFn=function(t,e){var i=DailyGiftActControl.ins(),n=t.id>i.buyIndex||t.id==i.buyIndex+1&&!i.isBuy,o=e.id>i.buyIndex||e.id==i.buyIndex+1&&!i.isBuy;return n&&!o?-1:!n&&o?1:SortUtils.sortAscByKey(t.id,e.id)},e.prototype.compareFn1=function(t,e){return SortUtils.sortAscByKey(t.id,e.id)},e.prototype.onTouchList=function(t){if(t.target instanceof eui.Button){var e=this.content.selectedItem;e&&CommonFun.checkCurrency(e.price)&&dailyGiftActControl.upBuyGift(e.id)}},__decorate([callLater],e.prototype,"delayUpdate",null),e}(BasePanel);__reflect(AmuseTarget0Panel19.prototype,"AmuseTarget0Panel19");var TotemVo=function(){function t(){}return t.prototype.init=function(t){this.id=t[0],this.lv=t[1],this.infos||(this.infos=[]);for(var e=0;t[2].length>e;e++){var i=t[2][e][0],n=t[2][e][1],o=t[2][e][2];this.infos[i]=n?n:o}},t.prototype.getValueByPos=function(t){return this.infos&&this.infos[t]?this.infos[t]:0},t}();__reflect(TotemVo.prototype,"TotemVo");var TotemInfoShowPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.job=t[0],this.id=t[1],this.lv=t[2],this.stageLv=t[3],this.lingLv=t[4],this.addEventTouchTap(this,this.onTouch),this.updateView()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.updateView=function(){var t=DataCenter.ins().TotemPartConfig[this.job][this.id],e=t[1],i=!0;this.skinName=e.totemSkin+"Show";var n=!0;for(var o in t){var s=this["pos"+o],r={job:this.job,id:this.id,pos:t[o].slot,isSpecail:i,showRed:!1,value:this.stageLv,showLine:n,lingLv:this.lingLv};s.data=r}},e.prototype.onTouch=function(t){if(t.target instanceof eui.Image){var e=DataCenter.ins().TotemPartConfig[this.job][this.id];for(var i in e)this["pos"+i].setShowLine(!0)}},e}(BasePanel);__reflect(TotemInfoShowPanel.prototype,"TotemInfoShowPanel");var TotemIntroTipsShowView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemIntroTipsShowViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._job=t[0],this._id=t[1],this._pos=t[2],this._ttName=t[3],this._value=t[4],this._lingLv=t[5],this.addEventTouchTap(this,this.onTouch),this.update(),this.lvupBtn.visible=!1,this.pos.visible=!1,this.posShow.visible=!this.pos.visible},e.prototype.close=function(){egret.Tween.removeTweens(this.pos),this._mc&&(this._mc.destroy(),this._mc=null)},e.prototype.update=function(){var t=DataCenter.ins().TotemPartConfig[this._job][this._id][this._pos];this.posNameImg.source=t.posNameImg;var i=this._value;this.posShow.skinName=this._ttName,this.posShow.setNoTouch(!0),this.posShow.data={job:this._job,id:this._id,pos:this._pos,isSpecail:!0,showRed:!1,value:i,showLine:!0},this.posShow.y=12,egret.Tween.get(this.posShow,{loop:!0}).to({y:32},1e3).to({y:12},1e3),this._mc=ObjectPool.pop("GameMovieClip"),this.bottomD.addChild(this._mc),this._mc.playFile(PATH_EFF+"zhanlingbottom",-1);var n=DataCenter.ins().TotemStageConfig[this._job][this._id][this._pos],o=n[i];this.powerPanel.setPower(totemControl.getPhasePowerByCfg(o));var s=AttributeFormat.getFormat(0,0,":",0,1,16777164,65280,!0),r="";o.attrs&&(r+=AttributeData.getAttStr1(o.attrs,s)),o.ex_attrs&&(r+=AttributeData.getExAttStr(o.ex_attrs,s)),this.attrTxt.textFlow=TextUtils.generateTextFlow(r),this.attrTxt.textHeight>e.ATTR_TXT_HEIGHT&&(this.anigroup.height+=this.attrTxt.textHeight-e.ATTR_TXT_HEIGHT)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this)}},e.ATTR_TXT_HEIGHT=100,e}(BaseEuiView);__reflect(TotemIntroTipsShowView.prototype,"TotemIntroTipsShowView");var TotemSkillTipsShowView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemSkillTipsShowViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.suitInfo.itemRenderer=TotemSkillTipsItemRender,this._col=new eui.ArrayCollection,this.suitInfo.dataProvider=this._col,this._selfChar=ObjectPool.pop("UnitRole"),this._selfChar.x=this.actor.x,this._selfChar.y=this.actor.y,this._selfChar.dir=3,this._selfChar.hideBar(),this.show.addChild(this._selfChar),this._targetChar=ObjectPool.pop("UnitMonster"),this._targetChar.x=this.target.x,this._targetChar.y=this.target.y,this._targetChar.hideBodyContainer(),this.show.addChild(this._targetChar)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;this._job=t[0],this._id=t[1],this._suitNum=t[2],this._suitLv=t[3],SkillEffPlayShow.bottomLayer=this.show,SkillEffPlayShow.topLayer=this.show,SkillEffPlayShow.setTimeout=function(t,e,i){TimerMgr.ins().doTimer(t,1,e,i)},SkillEffPlayShow.shake=function(t,e,n,o,s){s=s||1,t==UnitMgr.ins().getMainRole(0)&&Math.random()<s&&DisplayUtils.shakeIt(i.show,e,n,o)},this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.clearEffs(),SkillEffPlayShow.bottomLayer=null,SkillEffPlayShow.topLayer=null,SkillEffPlayShow.setTimeout=null,SkillEffPlayShow.shake=null,this._selfChar&&(this._selfChar.destroy(),this._selfChar=null),this._targetChar&&(this._targetChar.destroy(),this._targetChar=null)},e.prototype.update=function(){this.currentState="acitvited";var t=DataCenter.ins().TotemSuitLvConfig[this._job][this._id],e=t[this._suitNum][this._suitLv?this._suitLv:1],i=DataCenter.ins().SkillsDescConfig[DataCenter.ins().SkillsConfig[e.skillId[0]].desc];this.cdTxt.text=LangMgr.getValueByKey("activitSS1",Math.floor(i.cd/1e3)),this.skillDesc.textFlow=TextUtils.generateTextFlow(i.desc);var n=DataCenter.ins().TotemBaseConfig.initialskillid[this._job-1],o=[],s=0,r=[],a=[],l=0,h=0,u=!0,p=n.id;for(var c in t){var d=+c,g=this._suitLv;if(g||(g=0),s||(s=Object.keys(t[c]).length),g){var m=t[c][g];m.attrs&&(r=r.concat(m.attrs.concat())),m.ex_power&&(l+=m.ex_power),m.skill_attrs&&(a=a.concat(m.skill_attrs.concat())),m.skillId&&m.skillId.length&&(p=m.skillId[0]),u=!1}o.push({job:this._job,id:this._id,num:d,quality:g,maxSuit:s})}this._col.source=o,u?h+=BackpackControl.getAttPowerContainRelate(n.attr):(r=r.concat(a),r=AttributeData.combineAtts(r),h+=BackpackControl.getAttPowerContainRelate(r),h+=l),this.powerpanel.setPower(h),r=null,a=null,this._skillID=p,TimerMgr.ins().isExists(this.loopSkill,this)||(TimerMgr.ins().doTimer(3e3,0,this.loopSkill,this),this.loopSkill())},e.prototype.loopSkill=function(){this.clearEffs();var t=DataCenter.ins().SkillsConfig[this._skillID],e=DataCenter.ins().SkillsDescConfig[t.desc];SkillEffPlayShow.play(e.effectId,this._selfChar,[this._targetChar]),2==this._job?TimerMgr.ins().doTimer(500,1,this.funFaShi,this):3==this._job&&TimerMgr.ins().doTimer(200,1,this.funDaoShi,this)},e.prototype.funDaoShi=function(){var t=DataCenter.ins().SkillsConfig[this._skillID],e=t.ex_summoner;if(e&&e.length){this._effLists=[];for(var i=e.length,n=2*Math.PI/i,o=0;i>o;o++){var s=ObjectPool.pop("GameMovieClip");s.playFile(PATH_GUAIWU+GUAIWU_PREFIX+DataCenter.ins().MonstersConfig[e[o]].avatar+"_4s",-1),s.x=100*Math.cos(n*o)+this.target.x,s.y=50*Math.sin(n*o)+this.target.y,s.y<=this.target.y?this.show.addChildAt(s,4):this.show.addChild(s),this._effLists.push(s);var r=ObjectPool.pop("GameMovieClip");r.playFile(PATH_SKILLEFF+"skill306"),r.x=s.x,r.y=s.y,this.show.addChild(r),this._effLists.push(r)}}},e.prototype.funFaShi=function(){var t=DataCenter.ins().SkillsConfig[this._skillID],e=t.selfEff;if(e&&e.length){var i=DataCenter.ins().SkillsEffectsConfig[e[0]].args;if(i&&i.d){this._selfChar.y=this.actor.y+10,this._magicSkills=new SkillBallMgt(this._selfChar,i.d,PATH_SKILLEFF+"skill209"),this._effLists=[];var n=ObjectPool.pop("GameMovieClip");n.playFile(PATH_SKILLEFF+"skill209t"),n.x=this.target.x,n.y=this.target.y,this.show.addChild(n),this._effLists.push(n)}}},e.prototype.clearEffs=function(){if(this._effLists){for(;this._effLists.length;){var t=this._effLists.shift();t.destroy(),t=null}this._effLists=null}this._magicSkills&&(this._magicSkills.destroy(),this._magicSkills=null)},e.prototype.onTouch=function(t){switch(t.target){case this.closeRt:case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(TotemSkillTipsShowView.prototype,"TotemSkillTipsShowView");var TotemPieceShowItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.onRemove),this.addEventTouchTap(this,this.onTouch)},e.prototype.dataChanged=function(){var t=DataCenter.ins().TotemPartConfig[this.data.job][this.data.id][this.data.pos];this.redPoint.visible=this.data.showRed;for(var e=t.source.length,i=0;e>i;i++)this["img"+(i+1)].source=t.source[i]+"_jpg";for(var n=this.line.numChildren,o=DataCenter.ins().TotemBaseConfig.lineImg,i=0;n>i;i++){var s=DataCenter.ins().TotemBaseConfig.linelockImg;this.data.value&&this.data.isSpecail&&(s=o[o.length-1]),this.line.getChildAt(i).source=s}if(this.line.visible=this.data.showLine,this.corner){for(var r=DataCenter.ins().TotemBaseConfig.cornerImg,a=this.corner.numChildren,i=0;a>i;i++){var l=DataCenter.ins().TotemBaseConfig.cornerlockImg;this.data.value&&this.data.isSpecail&&(l=r[r.length-1]),this.corner.getChildAt(i).source=l}this.corner.visible=this.data.showLine}},e.prototype.onTouch=function(){!this._noTouch&&this.data.isSpecail&&UIMgr.ins().open(TotemIntroTipsShowView,this.data.job,this.data.id,this.data.pos,this.skinName,this.data.value,this.data.lingLv)},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.removeEventTouchTap(this,this.onTouch)},e.prototype.setNoTouch=function(t){t&&(this._noTouch=!0,this.redPoint.visible=!0)},e.prototype.setShowLine=function(t){this.data.showLine=t,this.line.visible=this.data.showLine},e}(BaseItemRender);__reflect(TotemPieceShowItemRender.prototype,"TotemPieceShowItemRender");var TotembagTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotembagTipsViewSkin",e.uilayer=GameLayer.POPUP,e.powerPanel.setBgVis(!1),e}return __extends(e,t),e.prototype.open=function(t){this._itemID=t,this.addEventTouchTap(this.bgClose,this.onClose),this.update()},e.prototype.close=function(){egret.Tween.removeTweens(this.pos)},e.prototype.update=function(){var t=DataCenter.ins().ItemConfig[this._itemID],e=ItemUtils.getQualityColor(t);this.itemIcon.setData(t),this.posNameLabel.textFlow=TextUtils.generateTextFlow("|C:"+e+"&T:"+t.name+"|"),this.quali.source="quali"+DataCenter.ins().ItemDescConfig[t.descIndex].quality;var i,n,o,s=[],r=0,a=DataCenter.ins().TotemEquipConfig[this._itemID];for(var l in a){var h=a[l],u=DataCenter.ins().TotemPartConfig[h.job][h.totemId][h.slot];if(2==u.type&&(i=!0),s.push({job:+l,id:h.totemId,pos:h.slot,skin:h.totemPartSkin}),n||(n=h.desc),o||(o=h.attr.concat(),h.exPower&&(r=h.exPower)),!i)break}this.powerPanel.setPower(BackpackControl.getAttPowerContainRelate(o,0)+r),this.attr0.text=AttributeData.getAttStrEx(o,0,1,":"),this.qualTxt.textFlow=TextUtils.generateTextFlow("|C:"+e+"&T:"+(i?LangMgr.getValueByKey("mythstr"):DataCenter.ins().TotemCornerConfig[t.level].equipQualityCN)+"|"),this.tipsDesc.textFlow=TextUtils.generateTextFlow(n);var p=224;if(i?this.playMc(s,i):(this.setPosInfo(s[0],i),p=this.pos.height*this.pos.scaleY),p>this.posGroup.height){var c=p-this.posGroup.height;this.posGroup.height+=c,this.anigroup.height+=c}},e.prototype.playMc=function(t,e){var i=this,n=0,o=function(){n>=t.length&&(n=0),i.setPosInfo(t[n],e),n++};o(),this.pos.alpha=0,egret.Tween.get(this.pos,{loop:!0}).to({alpha:1},500).wait(2e3).to({alpha:0},500).call(o,this)},e.prototype.setPosInfo=function(t,e){this.pos.skinName=t.skin,this.pos.setNoTouch(!0),this.pos.data={job:t.job,id:t.id,pos:t.pos,isSpecail:e,showRed:!1,value:e?-1:this._itemID,showLine:!1}},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TotembagTipsView.prototype,"TotembagTipsView");var TotemChangeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemChangeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=TotemChangeItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this._pos=t[2],this.addEventTouchTap(this.closeBtn,this.onClose),this.addEventTouchTap(this.list,this.onListTouch),this.update()},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(this._curRole),e=totemControl.getTTDataByID(this._curRole,this._id),i=e?e.getValueByPos(this._pos):0,n=i?DataCenter.ins().ItemConfig[i].level:0,o=DataCenter.ins().TotemPartConfig[t.job][this._id][this._pos].equipId,s=backpackControl.getBagItemByType(40),r=[];if(s&&s.length)for(var a=s.length,l=0;a>l;l++){var h=s[l];h&&h.itemConfig&&h.itemConfig.level>n&&-1!=o.indexOf(h.configID)&&r.push(h)}r&&r.length&&r.sort(this.sort);var u=[];if(i){var p=new ItemData;p.configID=i,u.push({itemData:p,isMine:!0,isBest:!1,roleIndex:this._curRole})}for(var c=r?r.length:0,l=0;c>l;l++)u.push({itemData:r[l],isMine:!1,isBest:0==l,roleIndex:this._curRole});this.list.dataProvider=new eui.ArrayCollection(u);var d=DataCenter.ins().TotemPartConfig[t.job][this._id];this.titleTxt.text=""+(i?LangMgr.getValueByKey("wearState2"):LangMgr.getValueByKey("smeltActivity"))+d[1].nameTxt+d[this._pos].posName},e.prototype.sort=function(t,e){return t.itemConfig.level>e.itemConfig.level?-1:t.itemConfig.level<e.itemConfig.level?1:0},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=this.list.selectedItem;if(!e)return;totemControl.upWear(this._curRole,this._id,this._pos,e.itemData.configID),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(TotemChangeView.prototype,"TotemChangeView");var TotemEquipShowTipsView=function(t){function e(){var e=t.call(this)||this;return e._isMe=!0,e.skinName="TotemEquipShowTipsViewSkin",e.uilayer=GameLayer.POPUP,e.powerPanel.setBgVis(!1),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this._pos=t[2],this._value=t[3],this._ttName=t[4],this._isMe=t[5],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){var t=DataCenter.ins().ItemConfig[this._value],e=ItemUtils.getQuality(t);this.posNameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t)+"&T:"+t.name+"|"),this.quali.source="quali"+e,this.pos.skinName=this._ttName,this.pos.setNoTouch(!0),this.pos.data={roleIndex:this._curRole,id:this._id,pos:this._pos,isSpecail:!1,showRed:!1,value:this._value,showLine:!1,isMe:this._isMe};var i=this.pos.height*this.pos.scaleY;if(i>this.posGroup.height){var n=i-this.posGroup.height;this.posGroup.height+=n,this.anigroup.height+=n,this.powerGroup.top+=n}var o=0,s="",r=totemControl.getJob(this._curRole,this._isMe),a=DataCenter.ins().TotemEquipConfig[this._value][r],l=AttributeFormat.getFormat(0,0,":",0,1,this.attr0.textColor,this.attr0.textColor);a.attr&&(o+=BackpackControl.getAttPowerContainRelate(a.attr,this._curRole,this._isMe?null:totemControl.getOtherRoleByIndex(this._curRole)),s+=AttributeData.getAttStr1(a.attr,l)),a.ex_attr&&(s+=AttributeData.getExAttStr(a.ex_attr,l)),a.exPower&&(o+=a.exPower),this.powerPanel.setPower(o),this.attr0.textFlow=TextUtils.generateTextFlow(s);var h=totemControl.getSuitInfo(this._curRole,this._id,this._isMe),u=!0;if(s="",h){var p=DataCenter.ins().TotemPartConfig[r][this._id][1].equipId,c=DataCenter.ins().ItemConfig[p[0]].level,d=DataCenter.ins().TotemSuitLvConfig[r][this._id];for(var g in d){var m=+g,f=h[m];if(f){u=!1;var v=f+c-1,y=DataCenter.ins().TotemSuitLvConfig[r][this._id][m][f],C=DataCenter.ins().TotemCornerConfig[v];s+="|C:"+y.qualityColor+"&T:"+C.equipQualityCN+m+LangMgr.getValueByKey("numberJT1")+"|\n",y.activeDesc?s+=y.activeDesc:y.attrs&&(s+=AttributeData.getAttStr1(y.attrs,l)),y.ex_attrs&&(s+=AttributeData.getExAttStr(y.ex_attrs,l)),s+="\n"}}}if(u)this.suitTxt.visible=this.suitAttrTxt.visible=!1,this.anigroup.height-=150,this.scroll.height-=150;else{this.suitTxt.visible=this.suitAttrTxt.visible=!0,this.suitTxt.y=this.attr0.y+this.attr0.textHeight+10,this.suitAttrTxt.y=this.suitTxt.y+this.suitTxt.textHeight+10,this.suitAttrTxt.textFlow=TextUtils.generateTextFlow(s);var T=this.suitAttrTxt.textHeight-140,w=this.anigroup.height;T>0&&(T+this.anigroup.height<=800?(this.anigroup.height+=T,this.scroll.height+=T):(this.anigroup.height=800,this.scroll.height+=800-w))}this.changeBtn.visible=this._isMe},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.changeBtn:UIMgr.ins().open(TotemChangeView,this._curRole,this._id,this._pos),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(TotemEquipShowTipsView.prototype,"TotemEquipShowTipsView");var TotemExhibitionTipsView=function(t){function e(){var e=t.call(this)||this;return e._isMe=!0,e.skinName="TotemIntroTipsShowViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this._pos=t[2],this._ttName=t[3],this._value=t[4],this._isMe=t[5],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){egret.Tween.removeTweens(this.pos),this._mc&&(this._mc.destroy(),this._mc=null)
},e.prototype.update=function(){var t=totemControl.getJob(this._curRole,this._isMe),i=DataCenter.ins().TotemPartConfig[t][this._id][this._pos];this.posNameImg.source=i.posNameImg;var n=totemControl.getTTDataByID(this._curRole,this._id,this._isMe),o=n?n.getValueByPos(this._pos):0;this.pos.skinName=this._ttName,this.pos.setNoTouch(!0),this.pos.data={roleIndex:this._curRole,id:this._id,pos:this._pos,isSpecail:!0,showRed:!1,value:this._value,showLine:!0,isMe:this._isMe},this.pos.verticalCenter=0,egret.Tween.get(this.pos,{loop:!0}).to({verticalCenter:-12},1e3).to({verticalCenter:0},1e3),this._mc=ObjectPool.pop("GameMovieClip"),this.bottomD.addChild(this._mc),this._mc.playFile(PATH_EFF+"zhanlingbottom",-1);var s=DataCenter.ins().TotemStageConfig[t][this._id][this._pos],r=s[o];this.powerPanel.setPower(totemControl.getPhasePowerByCfg(r,this._curRole,this._isMe));var a=AttributeFormat.getFormat(4,0,": ",0,1,16777164,65280,!0),l="";r.attrs&&(l+=AttributeData.getAttStr1(r.attrs,a)),r.ex_attrs&&(l+=AttributeData.getExAttStr(r.ex_attrs,a)),this.attrTxt.textFlow=TextUtils.generateTextFlow(l),this.attrTxt.textHeight>e.ATTR_TXT_HEIGHT&&(this.anigroup.height+=this.attrTxt.textHeight-e.ATTR_TXT_HEIGHT),this.lvupBtn.visible=this._isMe},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.lvupBtn:UIMgr.ins().open(TotemLvUpView,this._curRole,this._id,this._pos,this._ttName),UIMgr.ins().close(this)}},e.ATTR_TXT_HEIGHT=100,e}(BaseEuiView);__reflect(TotemExhibitionTipsView.prototype,"TotemExhibitionTipsView");var TotemForgeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemForgeViewSkin",e.uilayer=GameLayer.POPUP,e._expBar=new ProgressBarEff,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=TotemItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col,this._expBar.setWidth(514),this._expBar.x=-15,this._expBar.y=-10,this.expBarGroup.addChild(this._expBar)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this.addCustomEvent(169,this.expChange),this.addCustomEvent(167,this.update),this.addEventTouchTap(this.departBtn,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.list,this.onListTouch),this.addLongPress(this.lvUpBtn,this.onLongTap),this.update(),this._expBar.rePlayMc(),this.updateList()},e.prototype.close=function(){this._expBar.reset()},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(this._curRole),e=DataCenter.ins().TotemPartConfig[t.job][this._id][1];this._isSpecail=2==e.type,this.iconImg.source=e.icon,this.nameImg.source=e.nameImg;var i=totemControl.getTTDataByID(this._curRole,this._id),n=i?i.lv:0,o=totemControl.exp,s=Object.keys(DataCenter.ins().TotemLvConfig).length,r=n>=s,a=DataCenter.ins().TotemLvConfig[0>=n?1:n],l=a.attrs.concat(),h=AttributeData.getAttStrEx(l,0,1,":"),u=a.needExp;if(this.rightRed.visible=!1,r)this.curAttr.visible=this.nextAttr.visible=!1,this.lvUpBtn.enabled=!1,this.maxAttr.visible=!0,this.jiantouAttr.visible=!1,this.maxAttr.text=h,DisplayUtils.removeFromParent(this.lvUpGroup),this.forgeGroup.horizontalCenter=0;else{if(this.maxAttr.visible=!1,this.jiantouAttr.visible=!0,0>=n){for(var p=l.length,c=[],d=0;p>d;d++)c.push(new AttributeData(l[d].type,0));this.curAttr.text=AttributeData.getAttStrEx(c,0,1,":"),this.nextAttr.text=h}else{this.curAttr.text=h;var g=DataCenter.ins().TotemLvConfig[n+1];this.nextAttr.text=AttributeData.getAttStrEx(g.attrs.concat(),0,1,":"),u=g.needExp}this.rightRed.visible=this.lvUpBtn.enabled=o>=u}this._expBar.getMaxValue()!=u?this._expBar.setData(o,u):this._expBar.setValue(o),this.powerPanel.setPower(n?BackpackControl.getAttPowerContainRelate(l,this._curRole):0),this.lv.text="Lv."+n},e.prototype.updateList=function(){if(this.leftRed.visible=!1,this.departBtn.enabled=!1,this._isSpecail)this._col.source=null;else{var t=totemControl.getForgeItems(this._curRole,this._id);if(t&&t.length){this.leftRed.visible=!0,this.departBtn.enabled=!0;for(var i=[],n=0,o=t.length,s=0;o>s;s++){for(var r=t[s],a=r.count,l=0;a>l;l++){var h=r.copy();if(h.count=1,i.push(h),n++,n==e.MAX_FORGE_NUM)break}if(n==e.MAX_FORGE_NUM)break}this._col.source=i}else this._col.source=null}},e.prototype.expChange=function(){this.update(),this.updateList()},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.bgClose:case this.closeBtn:UIMgr.ins().close(this);break;case this.departBtn:var e=this._col.source,i=[];for(var n in e)i.push(e[n].configID);totemControl.upDeCompose(i)}},e.prototype.onLongTap=function(){totemControl.upLvUp(this._curRole,this._id)},e.prototype.onListTouch=function(t){if(t.target instanceof TotemItemRender&&t.target.data){var e=this._col.source;e.splice(this.list.selectedIndex,1),this.leftRed.visible=this.departBtn.enabled=e.length>0,this._col.source=e}},e.MAX_FORGE_NUM=12,e}(BaseEuiView);__reflect(TotemForgeView.prototype,"TotemForgeView");var TotemInfoPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this._isMe=t[2],this.addCustomEvent(169,this.update),this.addCustomEvent(167,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){var t=totemControl.getJob(this._curRole,this._isMe),e=DataCenter.ins().TotemPartConfig[t][this._id],i=e[1],n=2==i.type;this.skinName=i.totemSkin;var o=totemControl.getTTDataByID(this._curRole,this._id,this._isMe);this.showLine=!1;for(var s in e){var r=o?o.getValueByPos(+s):0;if(!r){this.showLine=!0;break}if(this._isMe&&totemControl.checkRedByPos(this._curRole,this._id,+s)){this.showLine=!0;break}}for(var s in e){var r=o?o.getValueByPos(+s):0,a=this["pos"+s];a.data={roleIndex:this._curRole,id:this._id,pos:s,isSpecail:n,showRed:this._isMe?totemControl.checkRedByPos(this._curRole,this._id,+s):!1,value:r,showLine:this.showLine,isMe:this._isMe},a.setNoTouch(!this.showLine)}},e.prototype.onTouch=function(t){if(t.target instanceof eui.Image){var e=totemControl.getJob(this._curRole,this._isMe),i=DataCenter.ins().TotemPartConfig[e][this._id];for(var n in i){var o=this["pos"+n];o.setShowLine(!0),o.setNoTouch(!1)}this.showLine=!0,totemControl.dispatchLineChange()}},e}(BasePanel);__reflect(TotemInfoPanel.prototype,"TotemInfoPanel");var TotemLvUpView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TotemLvUpViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this._pos=t[2],this._ttName=t[3],this.addCustomEvent(169,this.update),this.addCustomEvent(167,this.update),this.addCustomEvent(266,this.updateMatrial),this.addCustomEvent(267,this.updateMatrial),this.addCustomEvent(268,this.updateMatrial),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(this._curRole),e=DataCenter.ins().TotemPartConfig[t.job][this._id][this._pos];this.posNameImg.source=e.posNameImg;var i=totemControl.getTTDataByID(this._curRole,this._id),n=i?i.getValueByPos(this._pos):0;this.posItem.skinName=this._ttName,this.posItem.setNoTouch(!0),this.posItem.data={roleIndex:this._curRole,id:this._id,pos:this._pos,isSpecail:!0,showRed:!1,value:n?n:-1,showLine:!0},this.lv.text=n?LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(n)):"";var o=DataCenter.ins().TotemStageConfig[t.job][this._id][this._pos];this._isMax=n>=Object.keys(o).length;var s=o[n?n:1],r=AttributeFormat.FORMAT_1();if(this._isMax)this.maxAttrGroup.visible=!0,this.curAttrGroup.visible=this.nextAttrGroup.visible=!1,this.arrow.visible=!1,this.maxAttr.text=AttributeData.getAttStr1(s.attrs,r,!1),this.maxPowerPanel.setPower(totemControl.getPhasePowerByCfg(s,this._curRole));else{this.maxAttrGroup.visible=!1,this.curAttrGroup.visible=this.nextAttrGroup.visible=!0,this.arrow.visible=!0;var a=void 0;if(n)this.curAttr.text=AttributeData.getAttStr1(s.attrs,r,!1),this.curPowerPanel.setPower(totemControl.getPhasePowerByCfg(s,this._curRole)),a=o[n+1];else{this.curPowerPanel.setPower(0);for(var l=s.attrs.length,h=[],u=0;l>u;u++)h.push(new AttributeData(s.attrs[u].type,0));this.curAttr.text=AttributeData.getAttStr1(h,r,!1),a=s}this.nextAttr.text=AttributeData.getAttStr1(a.attrs,r,!1),this.nextPowerPanel.setPower(totemControl.getPhasePowerByCfg(a,this._curRole))}this.updateMatrial()},e.prototype.updateMatrial=function(){if(this._isMax)this.redPoint.visible=!1,this.soulBtn.enabled=!1,this.costGroup.visible=!1;else{this.costGroup.visible=!0;var t=heroControl.getSubRoleByIndex(this._curRole),e=totemControl.getTTDataByID(this._curRole,this._id),i=e?e.getValueByPos(this._pos):0,n=DataCenter.ins().TotemStageConfig[t.job][this._id][this._pos][i+1];if(!n)return;var o=DataCenter.ins().ItemConfig[n.costItem.itemId];this.costImg.source=o.icon+"_png",this.materialLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(o)+"&T:"+o.name+"|");var s=backpackControl.getBagGoodsCountById(0,n.costItem.itemId);this.costTxt.textFlow=TextUtils.generateTextFlow("（|C:"+(s>=n.costItem.count?65280:16711680)+"&T:"+s+"|/"+n.costItem.count+"）"),this.soulBtn.enabled=this.redPoint.visible=s>=n.costItem.count}},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.soulBtn:totemControl.upUpgrade(this._curRole,this._id,this._pos)}},e}(BaseEuiView);__reflect(TotemLvUpView.prototype,"TotemLvUpView");var TotemOtherInfoView=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e._id=0,e.skinName="TotemOtherInfoViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this.roleSelect.otherPlayerData=totemControl.otherPlayerData,this.roleSelect.open(),this.addEventChange(this.roleSelect,this.onChange),this.addEventTouchTap(this.closeBtn,this.onClose),this.roleSelect.setCurRole(this._curRole),this.update(),this._id=0},e.prototype.close=function(){this.totemPanel.close(),this.roleSelect.close()},e.prototype.onChange=function(t){this._curRole=this.roleSelect.getCurRole(),this.update()},e.prototype.update=function(){this.totemPanel.open(this._curRole,this._id,!1)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TotemOtherInfoView.prototype,"TotemOtherInfoView");var TotemPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._id=0,e._curIndex=-1,e._exPower=0,e._isMe=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=TotemNameItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],t[1]&&(this._id=t[1]),void 0!=t[2]&&(this._isMe=t[2]),this.addEventTouchTap(this,this.onTouch),this.addEventChange(this.list,this.onList),this.addCustomEvent(169,this.update),this.addCustomEvent(167,this.update),this.addCustomEvent(267,this.update),this.addCustomEvent(266,this.update),this.addCustomEvent(268,this.update),this.addCustomEvent(457,this.update),this.addCustomEvent(168,this.lineChange),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeEventChange(this.list,this.onList),this.removeCustomEvents(),this.tutengItem.close(),this.stopBeatAnimat(),this.panelCopy&&(this.panelCopy.close(),DisplayUtils.removeFromParent(this.panelCopy),this.panelCopy=null)},e.prototype.update=function(){var t=totemControl.getJob(this._curRole,this._isMe),e=DataCenter.ins().TotemPartConfig[t],i=[],n=0;for(var o in e){var s=+o;i.push({id:s,job:t,showRed:this._isMe?totemControl.checkRedByID(this._curRole,+o):!1}),this._id&&this._id==s&&(this._curIndex=n),n++}i=CommonUtils.arraySort(i,"id"),this._col.replaceAll(i),(-1==this._curIndex||this._curIndex>=i.length)&&(this._curIndex=0),this.list.selectedIndex=this._curIndex,this.updateTuTeng()},e.prototype.updateTuTeng=function(){var t=this.list.selectedItem;this.tutengItem.open(this._curRole,t.id,this._isMe),this._id=t.id;var e=DataCenter.ins().TotemPartConfig[t.job][t.id];this._isSepcial=2==e[1].type;var i=totemControl.getTTDataByID(this._curRole,t.id,this._isMe),n=[];this._exPower=0;for(var o in e){var s=i?i.getValueByPos(+o):0;if(s)if(this._isSepcial){var r=DataCenter.ins().TotemStageConfig[t.job][t.id][o][s];n=n.concat(r.attrs.concat()),r.ex_power&&(this._exPower+=r.ex_power)}else{var a=DataCenter.ins().TotemEquipConfig[s][t.job];n=n.concat(a.attr.concat()),a.exPower&&(this._exPower+=a.exPower)}}var l=this._isMe?null:totemControl.getOtherRoleByIndex(this._curRole),h=totemControl.getSuitInfo(this._curRole,this._id,this._isMe);for(var o in h){var u=h[o];if(u){var p=DataCenter.ins().TotemSuitLvConfig[t.job][t.id][+o][u];this._exPower+=BackpackControl.getAttPowerContainRelate(p.attrs,this._curRole,l),p.ex_power&&(this._exPower+=p.ex_power)}}this._isSepcial;var c=i?i.lv:0;this._exPower+=c?BackpackControl.getAttPowerContainRelate(DataCenter.ins().TotemLvConfig[c].attrs,this._curRole,l):0;var d=0;if(n&&n.length){this.attrGroup.visible=!0;for(var g=DataCenter.ins().TotemBaseConfig.attrShowType,m=g.length,f=1;m>=f;f++){for(var v=g[f-1],y=0,C=0;C<n.length;C++){var T=n[C];T.type==v&&(y+=T.value)}this["attr"+f].text=AttributeData.getAttStrEx(new AttributeData(v,y),0,1,":")}n=AttributeData.combineAtts(n),d+=BackpackControl.getAttPowerContainRelate(n,this._curRole,l),this.getItem.visible=!1}else this.attrGroup.visible=!1,this.getItem.visible=!0,this.getItem.text=this._isMe?LangMgr.getValueByKey("pleaseEqiupTotem"):LangMgr.getValueByKey("noAction");d+=this._exPower,this.powerPanel.setPower(d),this.redPoint.visible=this._isMe?totemControl.checkForgeUpGRed(this._curRole,this._id):!1,this.redPoint1.visible=this._isMe?totemControl.checkSkillRed(this._curRole,this._id):!1,this.lineChange(),this.enchanceBtn.visible=this._isMe,this.enchanceLv.text=this._isMe&&c?"Lv."+c:""},e.prototype.onTouch=function(t){switch(t.target){case this.enchanceBtn:UIMgr.ins().open(TotemForgeView,this._curRole,this._id);break;case this.skillBtn:UIMgr.ins().open(this._isSepcial?TotemSkillTipsView:TotemSuitTipsView,this._curRole,this._id,this._isMe)}},e.prototype.onList=function(t){this._curIndex!=this.list.selectedIndex&&(this._curIndex=this.list.selectedIndex,this.updateTuTeng())},e.prototype.startBeatAnimat=function(){this.panelCopy||(this.panelCopy=new TotemInfoPanel),this.panelCopy.touchEnabled=!1,this.panelCopy.touchChildren=!1,this.panelCopy.open(this._curRole,this._id,this._isMe),this.panelCopy.visible=!1,this.shenWuGroup.addChild(this.panelCopy),TimerMgr.ins().doTimer(4e3,0,this.runTween,this),TimerMgr.ins().doTimer(500,1,this.runTween,this)},e.prototype.runTween=function(){this.panelCopy.visible=!0,this.panelCopy.alpha=0,this.panelCopy.scaleX=this.panelCopy.scaleY=1,this.panelCopy.horizontalCenter=this.tutengItem.horizontalCenter,this.panelCopy.verticalCenter=this.tutengItem.verticalCenter,this.panelCopy.anchorOffsetX=this.tutengItem.anchorOffsetX,this.panelCopy.anchorOffsetY=this.tutengItem.anchorOffsetY,Tween.get(this.panelCopy).to({alpha:1},250).to({alpha:0,scaleX:1.2,scaleY:1.2},2e3,egret.Ease.cubicInOut)},e.prototype.stopBeatAnimat=function(){TimerMgr.ins().remove(this.runTween,this),this.panelCopy&&(Tween.removeTweens(this.panelCopy),this.panelCopy.visible=!1)},e.prototype.lineChange=function(){this.stopBeatAnimat(),this.tutengItem.showLine||this.startBeatAnimat(),this.infoTxt.text=this.tutengItem.showLine?LangMgr.getValueByKey("clickTotemEqiupChange"):LangMgr.getValueByKey("clickTotemShow"),this.infoTxt.visible=this._isMe},e}(BasePanel);__reflect(TotemPanel.prototype,"TotemPanel");var TotemSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e._cost=0,e._isMe=!0,e.payId=-1,e.skinName="TotemSkillTipsShowViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.suitInfo.itemRenderer=TotemSkillTipsItemRender,this._col=new eui.ArrayCollection,this.suitInfo.dataProvider=this._col,this._selfChar=ObjectPool.pop("UnitRole"),this._selfChar.x=this.actor.x,this._selfChar.y=this.actor.y,this._selfChar.dir=3,this._selfChar.hideBar(),this.show.addChild(this._selfChar),this._targetChar=ObjectPool.pop("UnitMonster"),this._targetChar.x=this.target.x,this._targetChar.y=this.target.y,this._targetChar.hideBodyContainer(),this.show.addChild(this._targetChar)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;this._curRole=t[0],this._id=t[1],this._isMe=t[2],SkillEffPlayShow.bottomLayer=this.show,SkillEffPlayShow.topLayer=this.show,SkillEffPlayShow.setTimeout=function(t,e,i){TimerMgr.ins().doTimer(t,1,e,i)},SkillEffPlayShow.shake=function(t,e,n,o,s){s=s||1,t==UnitMgr.ins().getMainRole(0)&&Math.random()<s&&DisplayUtils.shakeIt(i.show,e,n,o)},this.addCustomEvent(167,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.clearEffs(),SkillEffPlayShow.bottomLayer=null,SkillEffPlayShow.topLayer=null,SkillEffPlayShow.setTimeout=null,SkillEffPlayShow.shake=null,this._selfChar&&(this._selfChar.destroy(),this._selfChar=null),this._targetChar&&(this._targetChar.destroy(),this._targetChar=null)},e.prototype.update=function(){var t=totemControl.isSkillActived(this._curRole,this._isMe);this.currentState=t?"acitvited":"lock";var e=totemControl.getJob(this._curRole,this._isMe),i=DataCenter.ins().TotemBaseConfig.initialskillid[e-1],n=DataCenter.ins().SkillsDescConfig[DataCenter.ins().SkillsConfig[i.id].desc];this.cdTxt.text=LangMgr.getValueByKey("activitSS1",Math.floor(n.cd/1e3)),this.skillDesc.textFlow=TextUtils.generateTextFlow(n.desc),this._cost=i.cost,this.nameImg.source="tt_skillname"+e;var o=[],s=totemControl.getSuitInfo(this._curRole,this._id,this._isMe),r=DataCenter.ins().TotemSuitLvConfig[e][this._id],a=0,l=[],h=[],u=0,p=0,c=!0,d=i.id;this.acivitedBtn.label=LangMgr.getValueByKey("howMuchAction",DataCenter.ins().PayInfoConfig[i.moneyid].cash),this.payId=i.moneyid;for(var g in r){var m=+g,f=s[m];if(f||(f=0),a||(a=Object.keys(r[g]).length),f){var v=r[g][f];v.attrs&&(l=l.concat(v.attrs.concat())),v.ex_power&&(u+=v.ex_power),v.skill_attrs&&(h=h.concat(v.skill_attrs.concat())),v.skillId&&v.skillId.length&&(d=v.skillId[0]),c=!1}o.push({job:e,id:this._id,num:m,quality:f,maxSuit:a})}var y=this._isMe?null:totemControl.getOtherRoleByIndex(this._curRole);t?(this._col.source=o,c?p+=BackpackControl.getAttPowerContainRelate(i.attr,this._curRole,y):(l=l.concat(h),l=AttributeData.combineAtts(l),p+=BackpackControl.getAttPowerContainRelate(l,this._curRole,y),p+=u)):(l=l.concat(i.attr.concat()),p+=BackpackControl.getAttPowerContainRelate(l,this._curRole,y),p+=u),this.powerpanel.setPower(p),l=null,h=null,this._skillID=d,TimerMgr.ins().isExists(this.loopSkill,this)||(TimerMgr.ins().doTimer(3e3,0,this.loopSkill,this),this.loopSkill()),"lock"==this.currentState&&this._isMe||(this.acivitedBtn.visible=!1)},e.prototype.loopSkill=function(){this.clearEffs();var t=DataCenter.ins().SkillsConfig[this._skillID],e=DataCenter.ins().SkillsDescConfig[t.desc];SkillEffPlayShow.play(e.effectId,this._selfChar,[this._targetChar]);var i=totemControl.getJob(this._curRole,this._isMe);2==i?TimerMgr.ins().doTimer(500,1,this.funFaShi,this):3==i&&TimerMgr.ins().doTimer(200,1,this.funDaoShi,this)},e.prototype.funDaoShi=function(){var t=DataCenter.ins().SkillsConfig[this._skillID],e=t.ex_summoner;if(e&&e.length){this._effLists=[];for(var i=e.length,n=2*Math.PI/i,o=0;i>o;o++){var s=ObjectPool.pop("GameMovieClip");s.playFile(PATH_GUAIWU+GUAIWU_PREFIX+DataCenter.ins().MonstersConfig[e[o]].avatar+"_4s",-1),s.x=100*Math.cos(n*o)+this.target.x,s.y=50*Math.sin(n*o)+this.target.y,s.y<=this.target.y?this.show.addChildAt(s,4):this.show.addChild(s),this._effLists.push(s);var r=ObjectPool.pop("GameMovieClip");r.playFile(PATH_SKILLEFF+"skill306"),r.x=s.x,r.y=s.y,this.show.addChild(r),this._effLists.push(r)}}},e.prototype.funFaShi=function(){var t=DataCenter.ins().SkillsConfig[this._skillID],e=t.selfEff;if(e&&e.length){var i=DataCenter.ins().SkillsEffectsConfig[e[0]].args;if(i&&i.d){this._selfChar.y=this.actor.y+10,this._magicSkills=new SkillBallMgt(this._selfChar,i.d,PATH_SKILLEFF+"skill209"),this._effLists=[];var n=ObjectPool.pop("GameMovieClip");n.playFile(PATH_SKILLEFF+"skill209t"),n.x=this.target.x,n.y=this.target.y,this.show.addChild(n),this._effLists.push(n)}}},e.prototype.clearEffs=function(){if(this._effLists){for(;this._effLists.length;){var t=this._effLists.shift();t.destroy(),t=null}this._effLists=null}this._magicSkills&&(this._magicSkills.destroy(),this._magicSkills=null)},e.prototype.onTouch=function(t){switch(t.target){case this.closeRt:case this.closeBtn:UIMgr.ins().close(this);break;case this.acivitedBtn:payControl.showReCharge(this.payId)}},e}(BaseEuiView);__reflect(TotemSkillTipsView.prototype,"TotemSkillTipsView");var TotemSuitTipsView=function(t){function e(){var e=t.call(this)||this;return e._isMe=!0,e.skinName="TotemSuitTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=TotemSuitItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this._id=t[1],this._isMe=t[2],this.addEventTouchTap(this.bgClose,this.onClose),this.update()},e.prototype.update=function(){var t,e=totemControl.getJob(this._curRole,this._isMe),i=DataCenter.ins().TotemPartConfig[e][this._id],n=totemControl.getTTDataByID(this._curRole,this._id,this._isMe),o=DataCenter.ins().TotemPartConfig[e][this._id][1].equipId,s=DataCenter.ins().ItemConfig[o[0]].level,r=[];for(var a in i){var l=n?n.getValueByPos(+a):0;if(l){t=!0;var h=DataCenter.ins().ItemConfig[l];r[a]=h.level}else r[a]=0}for(var u=totemControl.getSuitInfo(this._curRole,this._id,this._isMe),p=DataCenter.ins().TotemSuitLvConfig[e][this._id],c=totemControl.getTTMaxSuitLv(this._curRole,this._id,this._isMe),d=[],g=1;c>=g;g++){var m={};m.job=e,m.id=this._id,m.minLv=s,m.posInfo=r,m.quality=g,m.numInfo=[];for(var a in p)m.numInfo.push({num:+a,tureQ:u[+a]});d.push(m)}t&&(d.reverse(),d.sort(this.sort)),this._col.source=d},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.sort=function(t,e){var i=function(t){for(var e=t.numInfo,i=e.length,n=0;i>n;n++){var o=e[n];if(t.quality==o.tureQ)return!0}return!1},n=i(t),o=i(e);return n&&!o?-1:!n&&o?1:0},e}(BaseEuiView);__reflect(TotemSuitTipsView.prototype,"TotemSuitTipsView");var TotemChangeItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=heroControl.getSubRoleByIndex(this.data.roleIndex),e=this.data.itemData;this.itemIcon.data=e,this.changeBtn.visible=!this.data.isMine,this.now.visible=this.data.isMine,this.best.visible=this.data.isBest;var i=DataCenter.ins().TotemEquipConfig[e.configID][t.job],n=0;n+=BackpackControl.getAttPowerContainRelate(i.attr,this.data.roleIndex),i.exPower&&(n+=i.exPower),this.power.text=LangMgr.getValueByKey("wingPingfen",n),this.addNameLb.text=this.data.isMine?"":LangMgr.getValueByKey("curownNum",e.count?e.count:0);var o=AttributeFormat.getFormat(0,0,"+"),s=AttributeData.getAttStr1(i.attr,o,!1);i.ex_attr&&(s+=AttributeData.getExAttStr(i.ex_attr,o,!1)),this.attr.textFlow=TextUtils.generateTextFlow1(s);var r=DataCenter.ins().TotemCornerConfig[e.itemConfig.level];this.quality.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(e.itemConfig)+"&T:"+r.equipQualityCN+"|")},e}(BaseItemRender);__reflect(TotemChangeItemRender.prototype,"TotemChangeItemRender");var TotemItemRender=function(t){function e(){var e=t.call(this)||this;return e.isShowName(!1),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=!1,this.touchEnabled=!0},e}(ItemBase);__reflect(TotemItemRender.prototype,"TotemItemRender");var TotemNameItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=DataCenter.ins().TotemPartConfig[this.data.job][this.data.id][1];this.iconImg.source=t.icon,this.nameImg.source=t.nameImg,this.redPoint.visible=this.data.showRed},Object.defineProperty(e.prototype,"selected",{set:function(t){this.chosen.visible=t},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(TotemNameItemRender.prototype,"TotemNameItemRender");var TotemPieceItemRender=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isMe=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.onRemove),this.addEventTouchTap(this,this.onTouch)},e.prototype.dataChanged=function(){this._isMe=void 0==this.data.isMe?!0:this.data.isMe;var t=this.data.job?this.data.job:totemControl.getJob(this.data.roleIndex,this._isMe),e=DataCenter.ins().TotemPartConfig[t][this.data.id][this.data.pos];this.redPoint.visible=this.data.showRed;for(var i=e.source.length,n=0;i>n;n++)this["img"+(n+1)].source=e.source[n]+((this.data.value?"":"b")+"_jpg");for(var o=this.line.numChildren,s=DataCenter.ins().TotemBaseConfig.lineImg,n=0;o>n;n++){var r=DataCenter.ins().TotemBaseConfig.linelockImg;this.data.value&&(r=this.data.isSpecail?s[s.length-1]:s[e.equipId.indexOf(this.data.value)]),this.line.getChildAt(n).source=r}if(this.line.visible=this.data.showLine,this.corner){for(var a=DataCenter.ins().TotemBaseConfig.cornerImg,l=this.corner.numChildren,n=0;l>n;n++){var h=DataCenter.ins().TotemBaseConfig.cornerlockImg;this.data.value&&(h=this.data.isSpecail?a[a.length-1]:a[e.equipId.indexOf(this.data.value)]),this.corner.getChildAt(n).source=h}this.corner.visible=this.data.showLine}if(this.data.isSpecail&&this.data.value>0&&this.leftGroup){var u=this.data.value,p=u%3;for(p||(p=3);this.leftGroup.numChildren>p;){var c=this.leftGroup.removeChildAt(0);c.source=null,c=null}for(var d=DataCenter.ins().TotemBaseConfig.lvShowImg[Math.ceil(u/3)-1],g=this.leftGroup.numChildren,n=0;p>n;n++){var c=void 0;g>n?c=this.leftGroup.getChildAt(n):(c=new eui.Image,this.leftGroup.addChild(c)),c.source=d,c.y=27*n}}this.updateLeft()},e.prototype.onTouch=function(){this._noTouch||(this.data.isSpecail?this.data.value?UIMgr.ins().open(TotemExhibitionTipsView,this.data.roleIndex,this.data.id,this.data.pos,this.skinName,this.data.value,this._isMe):this._isMe&&UIMgr.ins().open(TotemLvUpView,this.data.roleIndex,this.data.id,this.data.pos,this.skinName):this.data.value?UIMgr.ins().open(TotemEquipShowTipsView,this.data.roleIndex,this.data.id,this.data.pos,this.data.value,this.skinName,this._isMe):this._isMe&&UIMgr.ins().open(TotemChangeView,this.data.roleIndex,this.data.id,this.data.pos))},e.prototype.onRemove=function(){if(this.removeEventRemovedFromStage(this,this.onRemove),this.removeEventTouchTap(this,this.onTouch),this.leftGroup)for(;this.leftGroup.numChildren;){var t=this.leftGroup.removeChildAt(0);t.source=null,t=null}},e.prototype.setNoTouch=function(t){this._noTouch=t,this.updateLeft()},e.prototype.setShowLine=function(t){this.data.showLine=t,this.line.visible=this.data.showLine,this.updateLeft()},e.prototype.updateLeft=function(){this.leftGroup&&(this.leftGroup.visible=this.data&&this.data.showLine)},e}(BaseItemRender);__reflect(TotemPieceItemRender.prototype,"TotemPieceItemRender");var TotemShowItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){this.bg.source="tt_showbg"+this.data.quality,this.iconImg.source=DataCenter.ins().TotemPartConfig[this.data.job][this.data.id][1].icon},e}(BaseItemRender);__reflect(TotemShowItemRender.prototype,"TotemShowItemRender");var TotemSkillTipsItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.suitTitle.text=DataCenter.ins().TotemPartConfig[this.data.job][this.data.id][1].nameTxt+this.data.num+LangMgr.getValueByKey("numberJT1");var t=DataCenter.ins().TotemSuitLvConfig[this.data.job][this.data.id][this.data.num][this.data.quality?this.data.quality:1];this.suitCurTxt.textColor=this.data.quality<=0?9144715:this.suitCurTxt.textColor,this.suitCurTxt.textFlow=TextUtils.generateTextFlow(t.activeDesc),this.data.quality<=0||this.data.quality>=this.data.maxSuit?this.currentState="twoTxt":(this.currentState="oneTxt",t=DataCenter.ins().TotemSuitLvConfig[this.data.job][this.data.id][this.data.num][this.data.quality+1],this.suitNextTxt.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("equiNextLevel")+t.activeDesc))},e}(BaseItemRender);__reflect(TotemSkillTipsItemRender.prototype,"TotemSkillTipsItemRender");var TotemSuitItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){for(var t,e=DataCenter.ins().TotemSuitLvConfig[this.data.job][this.data.id],i=this.data.numInfo,n=i.length,o="",s=0;n>s;s++){var r=i[s],a=e[r.num][this.data.quality];o+="|C:"+(this.data.quality==r.tureQ?a.qualityColor:7170660)+"&T:"+LangMgr.getValueByKey("suitNum",r.num)+this.getAttrInfo(a)+"|",t=a.qualityColor}var l,h=this.data.quality+this.data.minLv-1,u="",p="";for(var c in this.data.posInfo){var d=DataCenter.ins().TotemPartConfig[this.data.job][this.data.id][+c];1==+c&&(p=d.nameTxt),u+="|C:"+(this.data.posInfo[+c]==h?65280:7170660)+"&T:"+d.posName+" |",this.data.posInfo[+c]==h&&(l=!0)}var g=DataCenter.ins().TotemCornerConfig[h];this.qualityName.textFlow=TextUtils.generateTextFlow("|C:"+t+"&T:"+LangMgr.getValueByKey("tutengtaozhuang",g.equipQualityCN+p)+"|"),this.suit0.textFlow=TextUtils.generateTextFlow(o),this.posName.textFlow=TextUtils.generateTextFlow("|C:"+(l?65280:7170660)+"&T:【|"+u+("|C:"+(l?65280:7170660)+"&T:】|"))},e.prototype.getAttrInfo=function(t){if(t.activeDesc)return t.activeDesc+"\n";if(t.attrs){for(var e="",i=t.attrs.length,n=AttributeFormat.getFormat(0,0,"+"),o=0;i>o;o++)e+=AttributeData.getAttStrByType1(t.attrs[o],n,!1)+" ";return e+"\n"}return""},e}(BaseItemRender);__reflect(TotemSuitItemRender.prototype,"TotemSuitItemRender");var HeirloomComposeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomComposeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.curIndex=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(268,this.updateData),this.addCustomEvent(269,this.updateData),this.addCustomEvent(65,this.updateData),this.addEventTouchTap(this.rect,this.onClick),this.addEventTouchTap(this.getItemTxt0,this.onClick),this.addEventTouchTap(this.jihuo0,this.onClick),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onClick);for(var i=0;8>i;i++)this.addEventTouchTap(this["item"+i],this.onTap);this.initData()},e.prototype.initData=function(){this.model.visible=!1;for(var t=0;8>t;t++){var e=HeirloomVo.getInfoBySoltFirst(t);this["item"+t].data={pos:t,info:e},this["item"+t].cleanEff()}this.item0.selectIcon.visible=!0;var i=HeirloomVo.getInfoBySoltFirst(0);this.setModel(i),this.setCost(i)},e.prototype.updateData=function(){var t=this.curIndex,e=HeirloomVo.getInfoBySoltFirst(t);this["item"+t].data={pos:t,info:e},this["item"+t].cleanEff(),this.setCost(e)
},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;8>i;i++)this.removeEventTouchTap(this["pos"+i],this.onTap);this.removeEventTouchTap(this.rect,this.onClick),this.removeEventTouchTap(this.getItemTxt0,this.onClick),this.removeEventTouchTap(this.jihuo0,this.onClick),this.removeCustomEvents(),this.removeAni()},e.prototype.removeAni=function(){DisplayUtils.removeFromParent(this.modelAni),this.modelAni=null},e.prototype.onClick=function(t){var e,i;switch(t.currentTarget){case this.fgClose:case this.rect:UIMgr.ins().close(this);break;case this.getItemTxt0:i=DataCenter.ins().HeirloomEquipItemConfig[this.curIndex+1],UIMgr.ins().open(ShopWarnView).setData(i.expend.id);break;case this.jihuo0:if(i=DataCenter.ins().HeirloomEquipItemConfig[this.curIndex+1],(this.curIndex+1==1||this.curIndex+1==3)&&(e=backpackControl.getBagItemById(i.item)))return void tipsControl.showTips(LangMgr.getValueByKey("heirTips1"));e=backpackControl.getBagItemById(i.expend.id);var n=e?e.count:0;n>=i.expend.count?heirloomControl.upHeirloomAdd(this.curIndex+1):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"))}},e.prototype.onTap=function(t){for(var e=0;8>e;e++)switch(this["item"+e].selectIcon.visible=!1,t.currentTarget){case this["item"+e]:if(this.curIndex==e){this["item"+e].selectIcon.visible=!0;break}this.curIndex=e,this["item"+e].selectIcon.visible=!0;var i=HeirloomVo.getInfoBySoltFirst(e);this.setModel(i),this.setCost(i)}},e.prototype.setModel=function(t){if(t){var e=t.model;return this.modelAni?void this.modelAni.playFile(PATH_EFF+e,-1):(this.modelAni=new GameMovieClip,this.modelAni.playFile(PATH_EFF+e,-1),this.modelAni.x=this.model.x+this.model.width/2,this.modelAni.y=this.model.y+this.model.height/2,void this.model.parent.addChildAt(this.modelAni,this.model.parent.getChildIndex(this.model)))}},e.prototype.setCost=function(t){if(t){var e=DataCenter.ins().HeirloomEquipItemConfig[t.slot],i=e.expend,n=DataCenter.ins().ItemConfig[i.id];if(n){this.icon0.source=n.icon.toString()+"_png";var o=backpackControl.getBagItemById(i.id),s=o?o.count:0,r="";r=s>=i.count?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.countLabel0.textFlow=TextUtils.generateTextFlow("<font color="+r+">"+s+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+i.count+"</font> ");var a=LangMgr.getValueByKey("heirTips2");1==t.slot?a=LangMgr.getValueByKey("heirTips3"):3==t.slot&&(a=LangMgr.getValueByKey("heirTips4")),this.getItemTxt0.textFlow=TextUtils.generateTextFlow(a)}}},e}(BaseEuiView);__reflect(HeirloomComposeView.prototype,"HeirloomComposeView");var HeirloomDownView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomDownViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listData=new eui.ArrayCollection,this.equipList.itemRenderer=HeirloomDownItemRenderer,this.equipList.dataProvider=this.listData,this.gainList.itemRenderer=GainGoodsItem,this.goList=new eui.ArrayCollection,this.gainList.dataProvider=this.goList},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(268,this.updateData),this.addCustomEvent(269,this.updateData),this.addCustomEvent(273,this.updateData),this.addEventTouchTap(this,this.onTap),this.addEventItemTap(this.gainList,this.onGo),this.curInfo=t[0],this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.getHeirloomSource=function(){for(var t=backpackControl.getBagEquipsByQuality(5,BackpackControl.BAG_DESC_TYPE_HEIR,BackpackControl.BAG_TYPE_OTHTER),e=0;e<t.length;e++){t[e].isSuggest=!0;for(var i=0;3>i;i++){var n=heroControl.getSubRoleByIndex(i);if(!n)break;var o=DataCenter.ins().HeirloomEquipItemConfig,s=!1;for(var r in o)if(o[r].item==t[e].configID){var a=o[r].pos,l=n.heirloom.getInfoBySolt(a-1);l&&l.lv>0?s=!1:(t[e].isSuggest=!1,s=!0);break}if(s)break}}return t.sort(function(t,e){var i=DataCenter.ins().ItemConfig[t.configID],n=DataCenter.ins().ItemConfig[e.configID];return 1==t.isSuggest&&0==e.isSuggest?1:0==t.isSuggest&&1==e.isSuggest?-1:n.id-i.id}),t},e.prototype.getHeirloomGoSource=function(){if(this.itemList)return this.itemList;var t,e=backpackControl.getBagItemById(200141);if(e)t=DataCenter.ins().PropsGainConfig[e.configID];else{if(!this.curInfo)return this.itemList;var i=0;i=this.curInfo.expend?this.curInfo.expend.id:DataCenter.ins().HeirloomEquipConfig[this.curInfo.slot][this.curInfo.lv-1].expend.id,t=DataCenter.ins().PropsGainConfig[i]}return t?(this.gainList.dataProvider=new eui.ArrayCollection(t.gainWay),this.itemList=t.gainWay):(this.gainList.dataProvider=new eui.ArrayCollection([]),this.itemList=[]),this.itemList},e.prototype.updateData=function(){var t,e;t=this.getHeirloomSource(),e=this.getHeirloomGoSource(),e=e?e:[],this.listData.source=t,this.goList.source=e;var i=e.length;this.refushPos(i)},e.prototype.refushPos=function(t){this.contrain.height=60*t,this.equipScroller.height=310+60*(3-t)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;default:if(t.target instanceof eui.Button)switch(t.target.name){case"breakDown":this.onHandler(t.target.parent.data)}}},e.prototype.onHandler=function(t){for(var e=[t],i=0;i<e.length&&(!e[i]||backpackControl.upUseItem(e[i].configID,e[i].count));i++);},e.prototype.onGo=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&(GuideControl.guidance(e[1],e[2]),UIMgr.ins().close(this))}},e}(BaseEuiView);__reflect(HeirloomDownView.prototype,"HeirloomDownView");var HeirloomDressView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomDressViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.initUI=function(){this.dressList.itemRenderer=HeirloomDressItemRenderer,this.dressList.dataProvider=new eui.ArrayCollection(heirloomControl.getDressDpList())},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=isNaN(t[0])?0:t[0],this.roleSelect.setCurRole(this.curRole),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.helpBtn,this.onTouch),this.addEventTouchTap(this.dressBtn2,this.onTouch),this.addEventTouchTap(this.itemName,this.onTouch),this.addEventChange(this.roleSelect,this.onChoseRole),this.addEventChange(this.dressList,this.onChangeList),this.addCustomEvent(269,this.upData),this.addCustomEvent(612,this.upData),this.addCustomEvent(69,this.upData),this.dressList.selectedIndex=0,this.onChoseRole()},e.prototype.upData=function(){this.curDp=this.dressList.selectedItem;var t=DataCenter.ins().ItemConfig[this.curDp.itemid],e=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,t.id);this.itemName.textFlow=TextUtils.formatUnderLineStr(t.name+" x1"),this.itemName.textColor=e>0?ColorUtils.GREEN:ColorUtils.RED;for(var i=0;5>i;i++){var n=this.curDp.attr[i];n&&AttributeData.getAttrStrByType(n.type)?(this["attr"+i].text=AttributeData.getAttStrByType(n,0),this["attr"+i].visible=!0):this["attr"+i].visible=!1}this.powerPanel.setPower(BackpackControl.getAttPowerContainRelate(this.curDp.attr,this.curRole));var o=heirloomControl.dressDatas?heirloomControl.dressDatas[this.curRole]:null;o?this.curDp.id==o.curIndex?this.dressBtn2.label=LangMgr.getValueByKey("dressTuoxia"):this.dressBtn2.label=o.isAct(this.curDp.id)?LangMgr.getValueByKey("dressHH"):LangMgr.getValueByKey("zhuzaiActivty"):this.dressBtn2.label=LangMgr.getValueByKey("zhuzaiActivty"),this.dressBtn2.label==LangMgr.getValueByKey("zhuzaiActivty")?(this.dressBtn2.enabled=e>0,this.redPoint.visible=e>0,this.itemGroup.visible=!0):(this.dressBtn2.enabled=!0,this.redPoint.visible=!1,this.itemGroup.visible=!1);for(var i=0;i<heroControl.subRolesLen;i++)this.roleSelect.showRedPoint(i,HeirloomRedPoint.ins().dressRedpoints[i]);heirloomControl.canDressHuanHua()?(this.dressBtn2.visible=!0,this.hhDes&&(this.hhDes.text="")):(this.dressBtn2.visible=!1,this.redPoint.visible=!1,this.itemGroup.visible=!1,this.hhDes&&(this.hhDes.text=LangMgr.getValueByKey("heirloomDressTips",heirloomControl.getDeressHHLevel()),this.hhDes.visible=!0))},e.prototype.onChangeList=function(){this.upData(),this.nMode.heirloomDressId=this.curDp.id,this.roleItem.setRole(this.nMode,!1)},e.prototype.onTouch=function(t){switch(t.target){case this.dressBtn2:switch(this.dressBtn2.label){case LangMgr.getValueByKey("dressHH"):heirloomControl.upWearDress(this.curRole,this.curDp.id);break;case LangMgr.getValueByKey("zhuzaiActivty"):heirloomControl.upActDress(this.curRole,this.curDp.id);break;case LangMgr.getValueByKey("dressTuoxia"):heirloomControl.upWearDress(this.curRole,0)}break;case this.helpBtn:HelpControl.openHelpWin(109);break;case this.itemName:UIMgr.ins().open(FashionHeirloomTipsView,DataCenter.ins().ItemConfig[this.curDp.itemid],!0,this.curRole);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onChoseRole=function(){this.curRole=this.roleSelect.getCurRole();var t=heroControl.getSubRoleByIndex(this.curRole);this.nMode=CommonUtils.copyDataDepth(t),this.upData(),this.nMode.heirloomDressId=this.curDp.id,this.roleItem.setRole(this.nMode,!1)},e.openCheck=function(){var t=heirloomControl.getDressDpList().length>0;return t||tipsControl.warnTips(LangMgr.getValueByKey("heirloomDressNoOpen")),t},e}(BaseEuiView);__reflect(HeirloomDressView.prototype,"HeirloomDressView");var HeirloomEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.index=t[1],this.curRole&&this.curRole.heirloom&&(this.info=this.curRole.heirloom.getInfoBySolt(this.index)),this.info&&this.info.lv||(this.info=DataCenter.ins().HeirloomEquipConfig[this.index+1][1]),this.addEventTouchEnd(this.bgClose,this.onClick),this.init()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e.prototype.init=function(){this.heirloomItem.data={pos:this.index,info:this.info},this.heirloomItem.setTipsVisible(),this.equipName.text=this.info.name,this.slot.text=HeirloomVo.getEquipName(this.index);var t=this.setBasicsDesc();this.setSpecialDesc(),this.setSkillDesc();var e=Math.floor(BackpackControl.getAttrPower(t));this.power.text=LangMgr.getValueByKey("heirScore",e),this.curRole&&(e=this.curRole.getHeirloomSlotPower(this.index)),this.powerPanel.setPower(e)},e.prototype.onClick=function(){UIMgr.ins().close(this)},e.prototype.setBasicsDesc=function(){for(var t=[],e=0;e<this.info.attr.length&&!(e>3);e++){var i=new AttributeData,n=this.info.attr[e],o=AttributeData.getAttrStrByType(n.type);o+="+"+n.value,this["value"+e].text=o,i.type=n.type,i.value=n.value,t.push(i)}return t},e.prototype.setSpecialDesc=function(){for(var t=4;t<this.info.attr.length;t++)if(this["value"+t]){var e=this.info.attr[t],i=AttributeData.getAttrStrByType(e.type);i+="+"+e.value,this["value"+t].text=i}var n=HeirloomVo.getEquipName(this.index);n+=LangMgr.getValueByKey("heirPartAdd",this.info.attr_add),this.value6.text=n},e.prototype.setSkillDesc=function(){var t="";t=this.info.skillname?this.info.skillname+"\n"+this.info.skilldesc:LangMgr.getValueByKey("persontNone"),this.skilldesc.textFlow=TextUtils.generateTextFlow1(t)},e}(BaseEuiView);__reflect(HeirloomEquipTipsView.prototype,"HeirloomEquipTipsView");var HeirloomPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return reincarnateControl.lv<3?(tipsControl.showTips(LangMgr.getValueByKey("heriloomEquipOpen")),!1):!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.roleId=t?t[0]:0,this.addCustomEvent(612,this.updateData);for(var i=0;8>i;i++)this.addEventTouchTap(this["pos"+i],this.onTap);this.addEventTouchTap(this.rightBtn,this.onClick),this.addEventTouchTap(this.leftBtn,this.onClick),this.addEventTouchTap(this.getItemTxt,this.onClick),this.addEventTouchTap(this.jihuo,this.onClick),this.addEventTouchTap(this.attrSet,this.onClick),this.addEventTouchTap(this.neatSet,this.onClick),this.addEventTouchTap(this.skinBtn,this.onClick),this.addEventTouchTap(this.skill,this.onSkill),this.addEventTouchTap(this.icon0.parent,this.onClick),this.icon0.visible=!1,this.curIndex=0,this.initData(),this.skinBtn.visible=heirloomControl.getDressDpList().length>0,this.upBtn.open(DataCenter.ins().LittleSystemBaseConfig.heiloomUpItem)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAni(),this.clearEff(),this.upBtn.close()},e.prototype.removeAni=function(){DisplayUtils.removeFromParent(this.modelAni)},e.prototype.onSkill=function(t){switch(t.currentTarget){case this.skill:UIMgr.ins().open(HeirloomSkillTipView,this.skill.itemIcon.imgIcon.source,this.skill.skillname,this.skill.skilldesc)}},e.prototype.onClick=function(t){switch(t.target){case this.leftBtn:this.leftBtn.visible=!1,this.rightBtn.visible=!0,this.pre();break;case this.rightBtn:this.rightBtn.visible=!1,this.leftBtn.visible=!0,this.next();break;case this.getItemTxt:var i=0;if(this.getItemTxt.text==LangMgr.getValueByKey("heirTips9")?i=1:this.getItemTxt.text==LangMgr.getValueByKey("heirTips10")&&(i=3),i){var n=DataCenter.ins().HeirloomEquipItemConfig[i];return void UIMgr.ins().open(ShopWarnView).setData(n.item)}if(this.getItemTxt.text==LangMgr.getValueByKey("heirTips11"))UIMgr.ins().open(HeirloomComposeView,this.curIndex);else{var o=heroControl.getSubRoleByIndex(this.roleId),s=o.heirloom.getInfoBySolt(this.curIndex);UIMgr.ins().open(HeirloomDownView,s)}break;case this.jihuo:var r=this.getInitInfo(),a=this.roleId,l=this.curIndex+1;if(r&&r.lv>0){var h=this.check(r);if(h==e.Heir_TIPS_1)heirloomControl.upHeirloomUpLevel(a,l);else if(h==e.Heir_TIPS_2)tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));else{var n=DataCenter.ins().HeirloomEquipItemConfig[this.curIndex+1];UIMgr.ins().open(ShopWarnView).setData(n.expend.id)}}else{var h=this.check(r);if(h==e.Heir_TIPS_1)heirloomControl.upHeirloomAct(a,l);else{var n=DataCenter.ins().HeirloomEquipItemConfig[this.curIndex+1];UIMgr.ins().open(ShopWarnView).setData(n.item)}}break;case this.attrSet:UIMgr.ins().open(RoleAttrView,this.roleId);break;case this.neatSet:UIMgr.ins().open(HeirloomSuitView,this.roleId);break;case this.skinBtn:UIMgr.ins().open(HeirloomDressView,this.roleId);break;case this.icon0.parent:var u=heroControl.getSubRoleByIndex(this.roleId);UIMgr.ins().open(HeirloomEquipTipsView,u,this.curIndex)}},e.prototype.pre=function(){var t=this.getInitInfo();this.setHeirloom(this.curIndex,e.Heir_LRBtn,t)},e.prototype.next=function(){var t=this.getInitInfo(),i=this.curIndex+1,n=t.lv?t.lv+1:t.lv+2,o=this.getSlotInfoByLv(i,n);this.setHeirloom(this.curIndex,e.Heir_LRBtn,o)},e.prototype.onTap=function(t){for(var i=this.roleId,n=heroControl.getSubRoleByIndex(i),o=0;8>o;o++)switch(this["pos"+o].setSelectIconVisible(!1),t.currentTarget){case this["pos"+o]:if(this.curIndex==o){this["pos"+o].setSelectIconVisible(!0),UIMgr.ins().open(HeirloomEquipTipsView,n,o);break}this.curIndex=o,this.setHeirloom(o,e.Heir_Select),this["pos"+o].setSelectIconVisible(!0)}},e.prototype.updateData=function(){var t=heirloomControl.upRequest;this.setHeirloom(this.curIndex,e.Heir_Select,null,t),t&&(heirloomControl.upRequest=!1),this.setSuitLvIcon(),this.setRedPoint(),this.updateRedPoint(),this.setPower();var i=UnitMgr.ins().getMainRole(this.roleId);i&&i.setHeirloomSuitEff()},e.prototype.updateRedPoint=function(){this.redPoint.visible=HeirloomRedPoint.ins().dressRedpoints.indexOf(!0)>-1},e.prototype.initData=function(){for(var t=this.getInitInfo(),i=0;8>i;i++)this.setHeirloom(i,e.Heir_Init,t);this.pos0.setSelectIconVisible(!0),this.setSuitLvIcon(),this.setRedPoint(),this.setPower(),this.updateRedPoint()},e.prototype.switchRole=function(){this.curIndex=0,this.initData()},e.prototype.setHeirloom=function(t,i,n,o){var s;if(i==e.Heir_Init)s=n;else if(i==e.Heir_Select){if(s=this.getInitInfo(t),!s.lv){var r=DataCenter.ins().HeirloomEquipConfig[t+1][1];s.skillname=r.skillname,s.skilldesc=r.skilldesc,s.skillicon=r.skillicon,s.name=r.name}}else s=n;if(s&&(this.setModel(i,t,s),this.setUI(i,t,s),this.setDesc(i,t,s),this.setCost(i,t,s)),i!=e.Heir_LRBtn){if(i==e.Heir_Init&&t>0&&(s=this.getInitInfo(t)),!s.lv){var r=DataCenter.ins().HeirloomEquipConfig[t+1][1];s.name=r.name}this["pos"+t].selectIcon.visible=!1,this["pos"+t].data={pos:t,info:s,uplevel:o}}if(i==e.Heir_Init&&0==t||i==e.Heir_LRBtn||i==e.Heir_Select){var r=DataCenter.ins().HeirloomEquipConfig[t+1][1];s.skillicon&&(r=s),r.skillicon&&(this.skill.visible=!0,this.skill.data={pos:t,info:s,icon:r.skillicon,skillname:r.skillname,skilldesc:r.skilldesc},this.skill.cleanEff())}},e.prototype.setUI=function(t,i,n){if(t==e.Heir_Init){if(i>0)return}else if(t==e.Heir_Select){if(this.curIndex!=i)return}else if(t==e.Heir_LRBtn)return void(this.itemName.text=n.name);var o;if(o=n,o.expend&&o.lv?this.rightBtn.visible=!0:this.rightBtn.visible=!1,this.leftBtn.visible=!1,t==e.Heir_LRBtn&&(o=this.getInitInfo()),o.lv>0){this.getItemTxt.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("heirTips12")),this.jihuo.label=LangMgr.getValueByKey("equiUpdate");var s=DataCenter.ins().HeirloomEquipItemConfig[this.curIndex+1],r=backpackControl.getBagItemById(s.item);r?this.setEff():this.clearEff()}else{this.clearEff();var a=LangMgr.getValueByKey("heirTips11"),s=DataCenter.ins().HeirloomEquipItemConfig[this.curIndex+1];if(1==s.pos){var r=backpackControl.getBagItemById(s.item);r&&(a=LangMgr.getValueByKey("heirTips9"))}else if(3==s.pos){var r=backpackControl.getBagItemById(s.item);r&&(a=LangMgr.getValueByKey("heirTips10"))}this.getItemTxt.textFlow=TextUtils.generateTextFlow("|U&T:"+a),this.jihuo.label=LangMgr.getValueByKey("equiActive")}o.skillicon?(this.skill.visible=!0,this.skill.data={pos:i,info:o,icon:o.skillicon,skillname:o.skillname,skilldesc:o.skilldesc},this.skill.cleanEff()):this.skill.visible=!1,this.itemName.text=o.name},e.prototype.setEff=function(){this.resolveMc||(this.resolveMc=new GameMovieClip),this.resolveMc.parent||(this.getItemTxt.parent.addChild(this.resolveMc),this.resolveMc.playFile(PATH_EFF+"chargeff1",-1),this.resolveMc.touchEnabled=!1,this.resolveMc.scaleY=.6,this.resolveMc.scaleX=.6),this.resolveMc.x=this.getItemTxt.x+38,this.resolveMc.y=this.getItemTxt.y+9},e.prototype.clearEff=function(){DisplayUtils.removeFromParent(this.resolveMc)},e.prototype.setModel=function(t,i,n){if(t==e.Heir_Init){if(i>0)return}else if(t==e.Heir_Select&&this.curIndex!=i)return;var o,s="";if(this.removeAni(),o=n,o&&o.lv>0)s=o.model;else{var r=DataCenter.ins().HeirloomEquipConfig[i+1][1];s=r.model}this.modelAni||(this.modelAni=new GameMovieClip,this.modelAni.x=this.icon0.x+this.icon0.width/2,this.modelAni.y=this.icon0.y+this.icon0.height/2),this.modelAni.parent||this.icon0.parent.addChildAt(this.modelAni,this.icon0.parent.getChildIndex(this.icon0)),this.modelAni.playFile(PATH_EFF+s,-1)},e.prototype.setDesc=function(t,i,n){if(t==e.Heir_Init){if(i>0)return}else if(t==e.Heir_Select&&this.curIndex!=i)return;var o;o=n;var s,r=[];o&&o.lv>0?r=o.attr:(s=DataCenter.ins().HeirloomEquipConfig[i+1][1],r=s.attr);for(var a=0;6>a;a++)for(var l=0;6>l;l++){var h=AttributeData.getAttrStrByType(r[l].type);switch(r[l].type){case 4:this.desc0.text=h,this.attr0.text="+"+r[l].value;break;case 2:this.desc1.text=h,this.attr1.text="+"+r[l].value;break;case 5:this.desc2.text=h,this.attr2.text="+"+r[l].value;break;case 6:this.desc3.text=h,this.attr3.text="+"+r[l].value;break;case 7:case 17:this.desc4.text=h,this.attr4.text="+"+r[l].value;break;case 25:case 26:this.desc5.text=h,this.attr5.text="+"+r[l].value}}var u=o.slot?o.slot:s.slot,p=HeirloomVo.getEquipName(u-1),c=o.attr_add?o.attr_add:s.attr_add;this.desc6.text=p+LangMgr.getValueByKey("heirPartAdd1"),this.attr6.text="+"+c+"%",this.attr6.x=this.desc6.x+this.desc6.width+20},e.prototype.setCost=function(t,i,n){var o;if(t==e.Heir_Init){if(i>0)return;o=n}else if(t==e.Heir_Select){if(this.curIndex!=i)return;o=n}else t==e.Heir_LRBtn&&(o=this.getInitInfo());var s;if(s=o.lv>0?DataCenter.ins().HeirloomEquipConfig[o.slot][o.lv]:DataCenter.ins().HeirloomEquipFireConfig[i+1]){var r=s.expend;if(this.jihuo.visible=!0,this.expendLabel.text=LangMgr.getValueByKey("heirXH"),!r)return this.expendLabel.text="",this.countLabel.text=LangMgr.getValueByKey("maxLevel"),this.jihuo.visible=!1,void(this.icon.visible=!1);var a=DataCenter.ins().ItemConfig[r.id];if(!a)return;this.icon.visible=!0,this.icon.source=a.icon.toString()+"_png";var l=backpackControl.getBagItemById(r.id),h=l?l.count:0,u="";u=h>=r.count?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.countLabel.textFlow=TextUtils.generateTextFlow("<font color="+u+">"+h+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+r.count+"</font> ")}},e.prototype.check=function(t){var i,n=0,o=0;if(i=t.lv>0?DataCenter.ins().HeirloomEquipConfig[t.slot][t.lv]:DataCenter.ins().HeirloomEquipFireConfig[this.curIndex+1]){var s=i.expend;if(!s)return e.Heir_TIPS_2;var r=DataCenter.ins().ItemConfig[s.id];if(!r)return e.Heir_TIPS_0;var a=backpackControl.getBagItemById(s.id);n=a?a.count:0,o=s.count}return n>=o?e.Heir_TIPS_1:e.Heir_TIPS_0},e.prototype.getInitInfo=function(t){var e=void 0!=t?t:this.curIndex,i=this.roleId,n=heroControl.getSubRoleByIndex(i);return n.heirloom.getInfoBySolt(e)},e.prototype.getSlotInfoByLv=function(t,e){var i=this.roleId,n=(heroControl.getSubRoleByIndex(i),DataCenter.ins().HeirloomEquipConfig[t][e]);return n},e.prototype.setSuitLvIcon=function(){for(var t=this.roleId,e=heroControl.getSubRoleByIndex(t),i=e.heirloom.getData(),n=0,o=!0,s=0;s<i.length;s++){var r=i[s];0==s&&(n=r.lv),!r.lv&&o&&(o=!1),r.lv<=n&&(n=r.lv)}this.neatSet.currentState=n.toString()},e.prototype.setRedPoint=function(){for(var t=0;8>t;t++){var e=this.getInitInfo(t),i=void 0;i=e.lv?DataCenter.ins().HeirloomEquipConfig[e.slot][e.lv]:DataCenter.ins().HeirloomEquipFireConfig[t+1];var n=0,o=0;if(i){var s=i.expend;if(!s){this["pos"+t].redPoint.visible=!1;continue}var r=backpackControl.getBagItemById(s.id);n=r?r.count:0,o=s.count}if(this["pos"+t].redPoint.visible=n>=o,!this["pos"+t].redPoint.visible){var a=DataCenter.ins().HeirloomEquipItemConfig[i.slot],r=backpackControl.getBagItemById(a.item);this["pos"+t].redPoint.visible=r?!0:!1}this["pos"+t].redPoint.visible||(this["pos"+t].redPoint.visible=heirloomControl.IsComposeItem(this.roleId,t))}},e.prototype.setPower=function(){var t=this.roleId,e=heroControl.getSubRoleByIndex(t).getAllHeirloomPower();this.powerPanel.setPower(e)},e.Heir_Init=1,e.Heir_Select=2,e.Heir_LRBtn=3,e.Heir_TIPS_0=0,e.Heir_TIPS_1=1,e.Heir_TIPS_2=2,e}(BasePanel);__reflect(HeirloomPanel.prototype,"HeirloomPanel");var HeirloomSkillTipView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="HeirloomSkillTipViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1],o=t[2];this.addEventTouchEnd(this,this.onClick),this.setData(i,n,o)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.onClick)},e.prototype.onClick=function(t){UIMgr.ins().close(this)},e.prototype.setData=function(t,e,i){this.heirloomItemIcon.setSkillData(t),this.nameLabel.textFlow=TextUtils.generateTextFlow1(e),this.description.textFlow=TextUtils.generateTextFlow1(i)},e}(BaseEuiView);__reflect(HeirloomSkillTipView.prototype,"HeirloomSkillTipView");var HeirloomSuitView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomSuitViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.model1=new GameMovieClip,this.model1.x=this.eff1.x,this.model1.y=this.eff1.y,this.eff1.parent.addChild(this.model1),this.model2=new GameMovieClip,this.model2.x=this.eff2.x,this.model2.y=this.eff2.y,this.eff2.parent.addChild(this.model2)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.onClick);var i=t[0];this.curRole=heroControl.getSubRoleByIndex(i),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.onClick),DisplayUtils.removeFromParent(this.model1),DisplayUtils.removeFromParent(this.model2),this.model1=null,this.model2=null},e.prototype.onClick=function(t){UIMgr.ins().close(this)},e.prototype.setData=function(){var t=this.curRole.heirloom.getData();if(!t)return null;var e=this.getMinEquipLv(t),i=this.getInfoMation(t,e);this.setCurSuit(e,i.str1,i.lv1),this.setNextSuit(e,i.str2,i.lv2)},e.prototype.setCurSuit=function(t,e,i){if(!t){for(var n=0;8>n;n++)this["desc"+n].visible=!1,this["attr"+n].visible=!1;return this.informationname0.visible=!1,this.num0.visible=!1,void(this.name0.text=LangMgr.getValueByKey("heirTips6"))}this.informationname0.textFlow=TextUtils.generateTextFlow(e);for(var o=t?t:1,s=DataCenter.ins().HeirloomEquipSetConfig[o],n=0;n<s.attr.length;n++){var r=s.attr[n];8>i&&(this["attr"+n].textColor=ColorUtils.GRAY,this["desc"+n].textColor=ColorUtils.GRAY),this["desc"+n].text=AttributeData.getAttrStrByType(r.type);var a=r.value;19==r.type&&(a+=15e3);var l="+"+a;n>=4&&(a/=100,l="+"+a+"%"),this["attr"+n].text=l,this["attr"+n].x=this["desc"+n].x+this["desc"+n].width}for(var n=s.attr.length;8>n;n++)this["cgroup"+n].visible=!1;this.name0.text=s.name,this.num0.text="（"+i+"/8）",this.model1.playFile(PATH_EFF+s.neff,-1)},e.prototype.setNextSuit=function(t,e,i){this.informationname1.textFlow=TextUtils.generateTextFlow(e);var n=t?t+1:1,o=DataCenter.ins().HeirloomEquipSetConfig[n];if(o){for(var s=0;s<o.attr.length;s++){var r=o.attr[s];this["ndesc"+s].text=AttributeData.getAttrStrByType(r.type);var a=r.value;19==r.type&&(a+=15e3);var l="+"+a;s>=4&&(a/=100,l="+"+a+"%"),this["nattr"+s].text=l,this["nattr"+s].x=this["ndesc"+s].x+this["ndesc"+s].width}for(var s=o.attr.length;8>s;s++)this["ngroup"+s].visible=!1;this.name1.text=o.name,this.num1.text="（"+i+"/8）",this.model2.playFile(PATH_EFF+o.neff,-1)}else{this.name1.text=LangMgr.getValueByKey("heirTips7"),this.num1.visible=!1,this.informationname1.visible=!1;for(var s=0;8>s;s++)this["ngroup"+s].visible=!1}},e.prototype.getInfoMation=function(t,e){for(var i="",n="",o=0,s=0,r=e?e+1:1,a=0;a<t.length;a++){var l=t[a],h=HeirloomVo.getEquipName(a);l.lv?(l.lv>=e?(o++,i+="|C:"+ColorUtils.NORMAL_COLOR+"&T:"+h+"|   "):i+="|C:"+ColorUtils.GRAY+"&T:"+h+"|   ",l.lv>=r?(s++,n+="|C:"+ColorUtils.NORMAL_COLOR+"&T:"+h+"|   "):n+="|C:"+ColorUtils.GRAY+"&T:"+h+"|   "):(i+="|C:"+ColorUtils.GRAY+"&T:"+h+"|   ",n+="|C:"+ColorUtils.GRAY+"&T:"+h+"|   ")}return{str1:i,str2:n,lv1:o,lv2:s}},e.prototype.getMinEquipLv=function(t){for(var e=0,i=!0,n=0;n<t.length;n++){var o=t[n];0==n&&(e=o.lv),!o.lv&&i&&(i=!1),o.lv<=e&&(e=o.lv)}if(!i)for(var n=0;8>n;n++)this["desc"+n].textColor=ColorUtils.GRAY,this["attr"+n].textColor=ColorUtils.GRAY;return e},e}(BaseEuiView);__reflect(HeirloomSuitView.prototype,"HeirloomSuitView");var HeirloomView=function(t){function e(){var e=t.call(this)||this;return e._curIndex=-1,e.skinName="HeirloomViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.viewStack.selectedIndex>=0){var i=this.viewStack.getElementAt(this.viewStack.selectedIndex);i&&i.close&&i.close()}this._openedIndexes&&(this._openedIndexes.length=0,this._openedIndexes=null),this._curIndex=-1},e.openCheck=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return e.checkIsOpen(t[0],!0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.resetViews(),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.roleSelect,this.onChange),this.addEventTouchTap(this.closeBtn,this.onClick),this.addCustomEvent(612,this.updateRedPoint),this.addCustomEvent(613,this.updateRedPoint),this.addCustomEvent(615,this.updateRedPoint),this.addCustomEvent(617,this.updateRedPoint),this.addCustomEvent(718,this.updateRedPoint);var i=t[0]||0;i=this._openedIndexes.indexOf(i),i=i>=0?i:0,this.curRole=t[1]||0,this.tab.selectedIndex=this.viewStack.selectedIndex=i,this.roleSelect.setCurRole(this.curRole),this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.onTabTouching=function(t){e.checkIsOpen(this._openedIndexes[t.currentTarget.selectedIndex],!0)?4==this._openedIndexes[t.currentTarget.selectedIndex]&&(UIMgr.ins().open(DevourEquipView),t.preventDefault()):t.preventDefault()},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole())},e.prototype.setRoleId=function(t){this.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex)},e.checkIsOpen=function(t,e){switch(t){case 0:if(reincarnateControl.lv<3)return e&&tipsControl.showTips(LangMgr.getValueByKey("heriloomEquipOpen")),!1;break;case 1:if(!crazybtplayControl.checkSysOpen())return e&&tipsControl.showTips(LangMgr.getValueByKey("equipment19")+LangMgr.getValueByKey("ladderTips16",DataCenter.ins().CrazybtplayConfig.openzhuanshenglv,DataCenter.ins().CrazybtplayConfig.openserverday)),!1;break;case 2:if(!dominateEquipControl.checkOpen())return e&&tipsControl.showTips(LangMgr.getValueByKey("dominateEquip")+LangMgr.getValueByKey("ladderTips16",DataCenter.ins().DominateEquipBaConfig.openZsLevel,DataCenter.ins().DominateEquipBaConfig.openDay)),!1;break;case 3:if(!totemControl.checkOpen())return e&&tipsControl.showTips(LangMgr.getValueByKey("totem")+LangMgr.getValueByKey("ladderTips16",DataCenter.ins().TotemBaseConfig.openZs,DataCenter.ins().TotemBaseConfig.openDay)),!1}return!0},e.prototype.setOpenIndex=function(t){-1!=this._curIndex&&this.viewStack.getElementAt(this._curIndex).close(),this._curIndex=t,this.viewStack.selectedIndex=t;var e=this._openedIndexes[this._curIndex];switch(e){case 0:this.title.source="biaoti_chuanshi",this.roleSelect.openRole(),this.viewStack.getElementAt(t).open(this.curRole);break;case 1:this.title.source="biaoti_chuanshishenwu",this.roleSelect.hideRole(),this.viewStack.getElementAt(t).open();break;case 2:this.title.source="biaoti_masterEquip",this.roleSelect.openRole(),this.viewStack.getElementAt(t).open(this.curRole);break;case 3:this.title.source="biaoti_tuteng",this.roleSelect.openRole(),this.viewStack.getElementAt(t).open(this.curRole)}this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this._openedIndexes[this.viewStack.selectedIndex];switch(t){case 0:for(var e=0;e<HeirloomRedPoint.ins().roleTab.length;e++)this.roleSelect.showRedPoint(e,HeirloomRedPoint.ins().roleTab[e]);break;case 1:break;case 2:for(var e=0;e<DominateEquipRedPoint.ins().roleTab.length;e++)this.roleSelect.showRedPoint(e,DominateEquipRedPoint.ins().roleTab[e]);break;case 3:for(var e=0;e<TotemRedPoint.ins().roleTab.length;e++)this.roleSelect.showRedPoint(e,TotemRedPoint.ins().roleTab[e])}this.redPoint0.visible=HeirloomRedPoint.ins().redPoint,this.redPoint1.visible=CrazybtplayRedPoint.ins().redPoint,this.redPoint2.visible=DominateEquipRedPoint.ins().redPoint,this.redPoint3.visible=TotemRedPoint.ins().redPoint,this.redPoint4.visible=DevourEquipRedPoint.ins().redPoint},e.prototype.openRole=function(){this.roleSelect.openRole()},e.prototype.hideRole=function(){this.roleSelect.hideRole()},e.prototype.resetViews=function(){this._openedIndexes=[],this.viewStack.removeChildren(),this.redGroup.removeChildren();
for(var t=0;5>t;t++){var e=this.getShowPage(t);e&&(e.name=this.getPanelName(t),this.viewStack.addChild(e),this.redGroup.addChild(this["redPoint"+t]),this._openedIndexes.push(t))}},e.prototype.getShowPage=function(t){switch(t){case 0:if(reincarnateControl.lv>=3)return this.heirloomPanel;break;case 1:if(GameServer.serverOpenDay>=DataCenter.ins().CrazybtplayConfig.openserverday-1)return this.crazybtplayPanel;break;case 2:if(GameServer.serverOpenDay>=DataCenter.ins().DominateEquipBaConfig.openDay-1)return this.dominateEquipPanel;break;case 3:if(GameServer.serverOpenDay>=DataCenter.ins().TotemBaseConfig.openDay-1)return this.totemPanel;break;case 4:if(DevourEquipContorl.ins().checkOpen())return this.DevourEquip}return null},e.prototype.getPanelName=function(t){switch(t){case 0:return LangMgr.getValueByKey("equipment3");case 1:return LangMgr.getValueByKey("equipment19");case 2:return LangMgr.getValueByKey("dominate");case 3:return LangMgr.getValueByKey("totem");case 4:return LangMgr.getValueByKey("tunshiName")}return""},e}(BaseEuiView);__reflect(HeirloomView.prototype,"HeirloomView");var HeirloomDownItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.configID=0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.itemConfig,e=DataCenter.ins().HeirloomEquipItemConfig;for(var i in e)if(e[i].item==t.id){var n=e[i].pos,o=DataCenter.ins().HeirloomEquipConfig[n][1];this.itemicon.data={pos:n,info:o},this.itemicon.cleanEff();var s=DataCenter.ins().ItemConfig[e[i].downitem.id],r=s.name?s.name:LangMgr.getValueByKey("heirTips5");this.desc.text=r+" x"+e[i].downitem.count;break}this.tip.visible=this.data.isSuggest,this.equipName.text=t.name,this.equipName.textColor=ItemUtils.getQualityColor(t)},e}(BaseItemRender);__reflect(HeirloomDownItemRenderer.prototype,"HeirloomDownItemRenderer");var HeirloomDressItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=DataCenter.ins().ItemConfig[this.data.itemid];this.imgIcon.source=t.icon+"_png",this.imageName.text=t.name,this.redPoint0.visible=!1,this.levellabel.text="",this.timelabel.text=""},Object.defineProperty(e.prototype,"selected",{set:function(t){this.selectImage.visible=t},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(HeirloomDressItemRenderer.prototype,"HeirloomDressItemRenderer");var HeirloomItemIconRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomItemIconRendererSkin",e.imgRect.visible=!0,e}return __extends(e,t),e.prototype.setSkillData=function(t){this.imgRect.visible=!1,this.imgIcon.source=t+"_png"},e.prototype.setData=function(t,e,i,n){if(void 0===n&&(n=!1),this.imgRect.visible=!0,null!=t&&(i?this.imgIcon.source=i+"_png":t.icon&&(this.imgIcon.source=t.icon+"_png"),t.lv>0&&!i))return this.imgRect.visible=!1,null==this.effect&&(this.effect=new GameMovieClip,this.effect.x=this.imgBg.x+this.imgBg.width/2,this.effect.y=this.imgBg.y+this.imgBg.height/2-5,this.addChildAt(this.effect,this.getChildIndex(this.imgIcon)+1)),void this.effect.playFile(PATH_EFF+"quaeff6",-1);if(i)this.imgRect.visible=t.lv<=0;else{var o=DataCenter.ins().HeirloomEquipConfig[e+1][1];this.imgIcon.source=o.icon+"_png"}},e.prototype.cleanEff=function(){DisplayUtils.removeFromParent(this.effect),this.effect=null},e}(BaseItemRender);__reflect(HeirloomItemIconRenderer.prototype,"HeirloomItemIconRenderer");var HeirloomItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="HeirloomItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){if(this.clear(),this.data){var t=this.data.info;this.itemIcon.setData(t,this.data.pos,this.data.icon,this.data.uplevel),this.lv.visible=t?!0:!1,this.data.icon?(this.lvBg.visible=this.lv.visible=!1,this.skillname=this.data.skillname,this.skilldesc=this.data.skilldesc,this.equipName.visible=!1):(t&&t.lv>0?(this.lv.visible=!0,this.lv.source="heir_0"+t.lv):this.lv.visible=!1,this.lvBg.visible=this.lv.visible),t.name&&(this.equipName.text=t.name),this.data.uplevel&&this.setUpEff()}},e.prototype.cleanEff=function(){this.itemIcon.cleanEff()},e.prototype.setTipsVisible=function(){this.itemIcon.imgRect.visible=!1,this.equipName.visible=!1},e.prototype.clear=function(){this.cleanEff()},e.prototype.setSelectIconVisible=function(t){this.selectIcon.visible=t;var e=this.itemIcon.y;this.itemIcon.imgRect.visible||(e=this.itemIcon.y),this.selectIcon.y=e},e.prototype.setUpEff=function(){null==this.upEffect&&(this.upEffect=new GameMovieClip,this.upEffect.x=this.itemIcon.x+this.itemIcon.width/2,this.upEffect.y=this.itemIcon.y+this.itemIcon.height/2,this.addChild(this.upEffect)),this.upEffect.playFile(PATH_EFF+"promoteeff",1)},e}(BaseItemRender);__reflect(HeirloomItemRenderer.prototype,"HeirloomItemRenderer");var ForgeControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downForgeUpdata=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);n.equipsData[e].zhuling=i,intensifyControl.dispatchForgeUpdate(2,e)},e.prototype.upUpGrade=function(t,e){return[t,e]},__decorate([down(2,[2,3,3])],e.prototype,"downForgeUpdata",null),__decorate([up(2,[2,2])],e.prototype,"upUpGrade",null),e=__decorate([protocolsId(14)],e)}(BaseSystem);__reflect(ForgeControl.prototype,"ForgeControl");var IntensifyControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(266,e.delaySeekItem),e.addCustomEvent(268,e.delaySeekItem),e.addCustomEvent(267,e.delaySeekItem),e.addCustomEvent(462,e.delaySeekItem),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.downForgeUpdata=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);n.equipsData[e].strengthen=i,this.dispatchForgeUpdate(0,e)},e.prototype.dispatchForgeUpdate=function(t,e){void 0===e&&(e=0),EventMgr.ins().dispatch(170,[t,e])},e.prototype.dispatchForgeTips=function(t){EventMgr.ins().dispatch(657,t?1:0)},e.prototype.upUpGrade=function(t,e){return[t,e]},e.prototype.delaySeekItem=function(){TimerMgr.ins().isExists(this.seekForgeItem,this)||TimerMgr.ins().doTimer(60,1,this.seekForgeItem,this)},e.prototype.seekForgeItem=function(){for(var t=!1,e=backpackControl.getBagItemNum(0),i=0;e>i;i++){var n=backpackControl.getBagGoodsByIndex(0,i);switch(n.itemConfig.id){case 200002:t=this.forgeHint(0,n.count);break;case 200003:t=this.forgeHint(2,n.count)}if(t)break}if(t||(t=this.forgeHint(1,ActorControl.soul)),!t)for(var o=0;o<heroControl.subRolesLen&&!(t=weaponsSoulControl.checkRedPoint(o));o++);this.dispatchForgeTips(t)},e.prototype.getForgeConfigByPos=function(t,e,i){var n=this.getForgeConfig(i);return n[t]&&n[t][e]},e.prototype.getForgeConfig=function(t){if(this.forgeConfigDic=this.forgeConfigDic||{},!this.forgeConfigDic[t]){var e=void 0;switch(t){case 0:e=DataCenter.ins().RefineAttrConfig;break;case 2:e=DataCenter.ins().ForgeAttrConfig;break;case 1:e=DataCenter.ins().IntensifyLevelConfig}var i=this.forgeConfigDic[t]={};for(var n in e){var o=e[n];i[o.posId]||(i[o.posId]={}),i[o.posId][o.level]=e[n]}}return this.forgeConfigDic[t]},e.prototype.getEnhanceCostConfigByLv=function(t){var e=DataCenter.ins().RefineCostConfig;return e[t]},e.prototype.getStoneLevelCostConfigByLv=function(t){var e,i=DataCenter.ins().IntensifyLevelCostConfig;for(e in i){var n=i[e];if(n.level==t)return n}return null},e.prototype.getZhulingCostConfigByLv=function(t){var e,i=DataCenter.ins().ForgeCostConfig;for(e in i){var n=i[e];if(n.level==t)return n}return null},e.prototype.jingLianCanUp=function(){for(var t=heroControl.subRolesLen,e=!1,i=0;t>i;i++){var n=heroControl.getSubRoleByIndex(i),o=n.getMinEquipIndexByType(1),s=n.getEquipByIndex(o).zhuling,r=intensifyControl.getZhulingCostConfigByLv(s+1).count;if(r){var a=intensifyControl.getZhulingCostConfigByLv(s+1).itemId,l=backpackControl.getBagGoodsCountById(0,a);if(l>=r){e=!0;break}}}return e},e.prototype.forgeHint=function(t,e){for(var i=heroControl.subRolesLen,n=0;i>n;n++){var o=heroControl.getSubRoleByIndex(n),s=o.getMinEquipIndexByType(t),r=this.getForgeLv(t,o,s),a=this.getForgeCount(t,r);if(a&&e>=a){if(1!=t)return intensifyControl.dispatchForgeTips(!0),!0;if(ActorControl.level>=DataCenter.ins().IntensifyOpenConfig[0].openLv)return intensifyControl.dispatchForgeTips(!0),!0}}return intensifyControl.dispatchForgeTips(!1),!1},e.prototype.getForgeLv=function(t,e,i){switch(t){case 0:return e.getEquipByIndex(i).strengthen;case 2:return e.getEquipByIndex(i).zhuling;case 1:return e.getEquipByIndex(i).gem}},e.prototype.getForgeCount=function(t,e){switch(t){case 0:var i=this.getEnhanceCostConfigByLv(e+1);if(i)return i.stoneNum;break;case 2:var n=this.getZhulingCostConfigByLv(e+1);if(n)return n.count;break;case 1:var o=this.getStoneLevelCostConfigByLv(e+1);if(o)return o.soulNum}return 0},e.prototype.countAllBoostAttr=function(t,e,n,o){void 0===n&&(n=0),void 0===o&&(o=!1);for(var s=[],r=heroControl.getSubRoleByIndex(t),a=0;a<GameConst.FORGE_MAX;a++){var l=null,h=this.getForgeLv(e,r,a);o&&n==a&&(h+=1),l=intensifyControl.getForgeConfigByPos(a,h,e),l&&l.attr&&(s=i.AttrAddition(l.attr,s))}return s},e.prototype.isMaxForge=function(t,e){for(var i=0;8>i;i++){var n=this.getForgeLv(e,t,e),o=intensifyControl.getForgeConfigByPos(e,n+1,e);if(!o)return!1}return!0},e.AttrAddition=function(t,e){for(var i,n=t.length,o=e.length,s=[],r=0;n>r;r++)i=AttributeData.copyAttrbute(t[r]),s.push(i);for(var a=0;o>a;a++){for(var l=!1,r=0;r<s.length;r++)e[a].type==s[r].type&&(s[r].value=s[r].value+e[a].value,l=!0);l||(i=AttributeData.copyAttrbute(e[a]),s.push(i))}return s},e.prototype.upMeltItem=function(t){var e=[];for(var i in t)e.push([t[i].configID,t[i].count]);return[e]},e.prototype.downMeltItem=function(){EventMgr.ins().dispatch(171)},__decorate([down(2,[2,3,3])],e.prototype,"downForgeUpdata",null),__decorate([up(2,[2,2])],e.prototype,"upUpGrade",null),__decorate([up(5,[[3,3]])],e.prototype,"upMeltItem",null),__decorate([down(5)],e.prototype,"downMeltItem",null),e=i=__decorate([protocolsId(7)],e);var i}(BaseSystem);__reflect(IntensifyControl.prototype,"IntensifyControl");var AmuseTarget0Panel2=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget0Panel2Skin",e}return __extends(e,t),e.prototype.open=function(){this.content.useVirtualLayout=!0,this.content.itemRenderer=AmuseTarget0Panel2ListItemRender,this.bigReward.itemRenderer=AmuseTarget0Penal2RewardItemRender,this.content.dataProvider?this.updateData():this.updateList(),this.addCustomEvent(180,this.updateData)},e.prototype.updateList=function(){var t=[],e=[],i=new RewardVo;i.count=0,i.id=2,i.type=0;var n={id:100,awardList:[i]};e.push(n);var o=payControl.getRechargeList(1);for(var s in o){var r=o[s];t.push(r),i.id=r.awardList[0].id,i.type=r.awardList[0].type,i.count+=r.awardList[0].count,r.awardList.length>1&&1==r.bigReward&&e.push(r)}t.sort(this.sort),e.sort(this.sort2),this.content.dataProvider=new eui.ArrayCollection(t),this.bigReward.dataProvider=new eui.ArrayCollection(e);var a=amusementControl.getbtnInfo(this.activityID);this.actDesc.text=a.acDesc},e.prototype.sort=function(t,e){var i=payControl.rechargeTotal.hasGetDays;return i.indexOf(t.id)>=0&&i.indexOf(e.id)<0?1:i.indexOf(t.id)<0&&i.indexOf(e.id)>=0?-1:t.id<e.id?-1:1},e.prototype.sort2=function(t,e){return t.id<e.id?1:-1},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.updateData=function(){var t=this.content.dataProvider;t.source.sort(this.sort),t.refresh(),t=this.bigReward.dataProvider;for(var e=0;e<t.length;e++)t.itemUpdated(t.getItemAt(e))},e}(BasePanel);__reflect(AmuseTarget0Panel2.prototype,"AmuseTarget0Panel2");var RefineControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downForgeUpdata=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);n.equipsData[e].gem=i,intensifyControl.dispatchForgeUpdate(1,e),EventMgr.ins().dispatch(172)},e.prototype.upUpGrade=function(t,e){return[t,e]},__decorate([down(2,[2,3,3])],e.prototype,"downForgeUpdata",null),__decorate([up(2,[2,2])],e.prototype,"upUpGrade",null),e=__decorate([protocolsId(11)],e)}(BaseSystem);__reflect(RefineControl.prototype,"RefineControl");var EquipUpgrateChooseView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="EquipUpgrateChooseViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._danID=t[0],this.list.itemRenderer=EquipUpgrateChooseItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col,this.addEventTouchTap(this.bgClose,this.onClose),this.addCustomEvent(47,this.update),this.addCustomEvent(466,this.checkEnd),this.update()},e.prototype.update=function(){var t=backpackControl.getEquipsByDan(this._danID);if(t&&t.length){t.sort(this.sort),this.empty.visible=!1;for(var e=[],i={},n=0;t.length>n;n++){var o=t[n];i[o.configID]||(e.push({item:o,danID:this._danID}),i[o.configID]=1)}this._col.replaceAll(e)}else this._col.source=null,this.empty.visible=!0},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.checkEnd=function(){backpackControl.isHideDanIcon(this._danID)&&UIMgr.ins().close(this)},e.prototype.sort=function(t,e){var i=ItemUtils.getQuality(DataCenter.ins().ItemConfig[t.configID]),n=ItemUtils.getQuality(DataCenter.ins().ItemConfig[e.configID]);return i!=n?n>i?-1:1:t.point>e.point?-1:1},e}(BaseEuiView);__reflect(EquipUpgrateChooseView.prototype,"EquipUpgrateChooseView");var ForgePanel=function(t){function e(){var e=t.call(this)||this;return e.isMax=!1,e.isAutoUp=!1,e.itemNum=0,e.startPos=0,e.name=LangMgr.getValueByKey("equipment24"),e.curPanel=2,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.getItemTxt.text+"</u>")},e.prototype.open=function(t,e){this.updateUIState(),this.addEventTouchTap(this.upGradeBtn,this.onTouch),this.addEventTouchTap(this.upGradeBtn0,this.onTouch),this.addEventTouchTap(this.getItemTxt,this.onGetItem),this.addCustomEvent(266,this.setCount),this.addCustomEvent(267,this.setCount),this.addCustomEvent(181,this.updateUIState),this.isMax=!1,this.createBitMapNum(),this.changeData(t,e),this.stopAutoUp(),this.upBtn.open(DataCenter.ins().LittleSystemBaseConfig.refineUpItem,this.curRole)},e.prototype.updateUIState=function(){this.currentState=payControl.franchise?"card":"nor"},e.prototype.close=function(){this.removeEventTouchTap(this.upGradeBtn,this.onTouch),this.removeEventTouchTap(this.getItemTxt,this.onGetItem),this.removeCustomEvents(),this.stopAutoUp(),this.upBtn.close()},e.prototype.onTouch=function(t){switch(t.target){case this.upGradeBtn:this.costConfig&&this.itemNum>=this.costConfig.count?(forgeControl.upUpGrade(this.curRole,this.pos),SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN)):warnControl.setBuyGoodsWarn(this.costConfig.itemId,1);break;case this.upGradeBtn0:if(payControl.franchise)this.isAutoUp?this.stopAutoUp():this.costConfig&&this.itemNum>=this.costConfig.count?(this.isAutoUp=!0,this.upGradeBtn0.label=LangMgr.getValueByKey("wingStop"),TimerMgr.ins().doTimer(300,0,this.autoUpStar,this)):this.onGetItem(null);else{var e=warnControl.show(LangMgr.getValueByKey("forgeZhuOneKey"),null,null,function(){UIMgr.ins().open(WelfareView,3)});e.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("smeltActivity"))}}},e.prototype.stopAutoUp=function(){this.isAutoUp=!1,this.upGradeBtn0&&(this.upGradeBtn0.label=LangMgr.getValueByKey("forgeZhuOneKey1")),TimerMgr.ins().remove(this.autoUpStar,this),egret.Tween.removeTweens(this.upGradeBtn0)},e.prototype.autoUpBack=function(t){if(this.isAutoUp){var e=intensifyControl.getZhulingCostConfigByLv(this.lv+1);if(!e)return;if(this.itemNum<e.count)return this.isAutoUp=!1,void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));forgeControl.upUpGrade(this.curRole,t)}},e.prototype.autoUpStar=function(){var t=intensifyControl.getZhulingCostConfigByLv(this.lv+1);t&&(this.itemNum>=t.count?(SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN),forgeControl.upUpGrade(this.curRole,this.pos)):(this.upGradeBtn0.label=LangMgr.getValueByKey("forgeZhuOneKey1"),TimerMgr.ins().remove(this.autoUpStar,this),this.onGetItem(null)))},e.prototype.onGetItem=function(t){warnControl.setBuyGoodsWarn(this.costConfig.itemId,1)},e.prototype.changeData=function(t,e,i){void 0===i&&(i=!0),this.pos=t,this.lv=e;var n=intensifyControl.countAllBoostAttr(this.curRole,this.curPanel);this.setAttrData(n),this.setPower(),this.setSlectedInfo(),this.updateLevel(),i&&this.setCount()},e.prototype.setPower=function(){var t=heroControl.getSubRoleByIndex(this.curRole);this._totalPower=t.getForgeTotalPower(this.curPanel),this._totalPower+=Math.floor(this._totalPower*magicCircleControl.getAddPerBySysID(1,this.curRole)/1e4),this.powerPanel.setPower(this._totalPower)},e.prototype.createBitMapNum=function(){for(var t=0;t<GameConst.FORGE_MAX;t++)this["level_"+t].text="0"},e.prototype.updateLevel=function(){for(var t=heroControl.getSubRoleByIndex(this.curRole),e=t.equipsData,i=0;i<GameConst.FORGE_MAX;i++){var n=e[i].zhuling;this["level_"+i].visible=n>0?!0:!1,this["level_"+i].text=n.toString()}},e.prototype.setSlectedInfo=function(){for(var t=heroControl.getSubRoleByIndex(this.curRole),e=(t.equipsData,0);e<GameConst.FORGE_MAX;e++)this["selectIcon"+e].visible=e==this.pos,0==e||(this["line"+(e-1)].source=e<=this.pos?"jinglianline1":"jinglianline0",this["jinglianed"+e].visible=e<=this.pos?!0:!1)},e.prototype.setAttrData=function(t){var e,i=t.length;t=magicCircleControl.getAttrsBySysID(t,1,this.curRole),t.sort(AttributeData.sortAttribute);for(var n=magicCircleControl.getAddPerBySysID(1,this.curRole)>0?16767295:this.attr0.textColor,o=0;4>o;o++)this["attr"+o].textFlow=TextUtils.generateTextFlow("|C:"+n+"&T:"+(i>o?AttributeData.getAttStrByType(t[o],.5):"")+"|");if(e=intensifyControl.getForgeConfigByPos(this.pos,this.lv+1,this.curPanel)){this.isMax=!1;var s=intensifyControl.countAllBoostAttr(this.curRole,this.curPanel,this.pos,!0);s=magicCircleControl.getAttrsBySysID(s,1,this.curRole),s.sort(AttributeData.sortAttribute);for(var o=0;4>o;o++){var r="";if(i>o){var a=t[o];r=this.getAttrByType(s,a)}this["arrow"+o].visible=r.length>0,this["addattr"+o].text=r}}else{this.isMax=!0;for(var o=0;4>o;o++)this["arrow"+o].visible=!1,this["addattr"+o].text=""}this.maxDesc.visible=this.isMax,this.upInfo.visible=!this.isMax},e.prototype.setCount=function(){this.costConfig=intensifyControl.getZhulingCostConfigByLv(this.lv+1);var t=0;this.costConfig&&(this.itemNum=backpackControl.getBagGoodsCountById(0,this.costConfig.itemId),t=this.costConfig.count);var e="";e=this.itemNum>=t?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.countLabel.textFlow=TextUtils.generateTextFlow("<font color="+e+">"+this.itemNum+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+t+"</font> ")},e.prototype.getAttrByType=function(t,e){for(var i=t.length,n=0;i>n;n++)if(t[n].type==e.type&&t[n].value!=e.value)return""+t[n].value;return""},e}(BasePanel);__reflect(ForgePanel.prototype,"ForgePanel");var IntensifyPanel=function(t){function e(){var e=t.call(this)||this;return e.isMax=!1,e.isAutoUp=!1,e.itemNum=0,e.name=LangMgr.getValueByKey("equipment22"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){this.upGradeBtn.label=LangMgr.getValueByKey("forgeStrong"),this.curPanel=0,this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.getItemTxt.text+"</u>"),this.eff=new GameMovieClip;var t=this.upGradeBtn;payControl.franchise&&(t=this.upGradeBtn0),this.eff.x=t.width/2,this.eff.y=t.height/2,this.eff.parent||t.addChild(this.eff),this.eff.touchEnabled=!1},e.prototype.getGuildButton=function(){this.eff.playFile(PATH_EFF+"chargeff1",-1);var t=this.upGradeBtn;return payControl.franchise&&(t=this.upGradeBtn0),this.eff.x=t.width/2,this.eff.y=t.height/2,this.eff.parent||t.addChild(this.eff),t},e.prototype.open=function(t,e){this.updateUIState(),this.addEventTouchTap(this.upGradeBtn,this.onTouch),this.addEventTouchTap(this.upGradeBtn0,this.onTouch),this.addEventTouchTap(this.getItemTxt,this.onGetItem),this.addCustomEvent(266,this.setCount),this.addCustomEvent(267,this.setCount),this.addCustomEvent(461,this.setView),this.addCustomEvent(181,this.updateUIState),this.isMax=!1,this.setView(),this.changeData(t,e),this.stopAutoUp()},e.prototype.updateUIState=function(){this.currentState=payControl.franchise?"card":"nor"},e.prototype.close=function(){this.removeEventTouchTap(this.upGradeBtn,this.onTouch),this.removeEventTouchTap(this.getItemTxt,this.onGetItem),DisplayUtils.removeFromParent(this.eff),this.stopAutoUp()},e.prototype.setView=function(){DisplayUtils.removeFromParent(this.eff)},e.prototype.onTouch=function(t){switch(t.target){case this.upGradeBtn:DisplayUtils.removeFromParent(this.eff);var e=intensifyControl.getEnhanceCostConfigByLv(this.lv+1);if(!e)return;this.itemNum>=e.stoneNum?(SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN),intensifyControl.upUpGrade(this.curRole,this.pos)):warnControl.setBuyGoodsWarn(e.stoneId,e.stoneNum-this.itemNum);break;case this.upGradeBtn0:if(payControl.franchise)if(this.isAutoUp)this.stopAutoUp();else{var i=intensifyControl.getEnhanceCostConfigByLv(this.lv+1);if(!i)return;this.itemNum>=i.stoneNum?(this.isAutoUp=!0,this.upGradeBtn0.label=LangMgr.getValueByKey("wingStop"),TimerMgr.ins().doTimer(500,0,this.autoUpStar,this)):this.onGetItem(null)}else{var n=warnControl.show(LangMgr.getValueByKey("forgeCards"),null,null,function(){UIMgr.ins().open(WelfareView,3)});n.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("smeltActivity"))}}},e.prototype.stopAutoUp=function(){this.isAutoUp=!1,this.upGradeBtn0&&(this.upGradeBtn0.label=LangMgr.getValueByKey("forgeOneKey")),TimerMgr.ins().remove(this.autoUpStar,this),egret.Tween.removeTweens(this.upGradeBtn0)},e.prototype.autoUpBack=function(t){if(this.isAutoUp){var e=intensifyControl.getEnhanceCostConfigByLv(this.lv+1);if(!e)return;if(this.itemNum<e.stoneNum)return this.isAutoUp=!1,void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));intensifyControl.upUpGrade(this.curRole,t)}},e.prototype.autoUpStar=function(){var t=intensifyControl.getEnhanceCostConfigByLv(this.lv+1);t&&(this.itemNum>=t.stoneNum?(SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN),intensifyControl.upUpGrade(this.curRole,this.pos)):(this.upGradeBtn0.label=LangMgr.getValueByKey("forgeOneKey"),TimerMgr.ins().remove(this.autoUpStar,this),this.onGetItem(null)))},e.prototype.onGetItem=function(t){warnControl.setBuyGoodsWarn(intensifyControl.getEnhanceCostConfigByLv(this.lv+1).stoneId,1)},e.prototype.changeData=function(t,e,i){void 0===i&&(i=!0),this.pos=t,this.lv=e;var n=intensifyControl.countAllBoostAttr(this.curRole,this.curPanel);this.setAttrData(n),this.setPower(),this.setSlectedInfo(),i?(this.setCount(),this.upGradeBtn.touchEnabled=!0):this.upGradeBtn.touchEnabled=!1},e.prototype.setPower=function(){var t=heroControl.getSubRoleByIndex(this.curRole);this._totalPower=t.getForgeTotalPower(this.curPanel),this._totalPower+=Math.floor(this._totalPower*magicCircleControl.getAddPerBySysID(0,this.curRole)/1e4),this.powerPanel.setPower(this._totalPower)},e.prototype.setSlectedInfo=function(){for(var t=heroControl.getSubRoleByIndex(this.curRole),e=t.equipsData,i=0;i<GameConst.FORGE_MAX;i++){var n=e[i].strengthen;this["level_"+i].text=n>0?"+"+n:"",this["show"+(i+1)].visible=i==this.pos,this["lianjiexian"+i].visible=i==this.pos}},e.prototype.setAttrData=function(t){var e,i=t.length;t=magicCircleControl.getAttrsBySysID(t,0,this.curRole),t.sort(AttributeData.sortAttribute);for(var n=magicCircleControl.getAddPerBySysID(0,this.curRole)>0?16767295:this.attr1.textColor,o=0;4>o;o++)this["attr"+o].textFlow=TextUtils.generateTextFlow("|C:"+n+"&T:"+(i>o?AttributeData.getAttStrByType(t[o],.5):"")+"|");if(e=intensifyControl.getForgeConfigByPos(this.pos,this.lv+1,this.curPanel)){this.isMax=!1;var s="",r=intensifyControl.countAllBoostAttr(this.curRole,this.curPanel,this.pos,!0);r=magicCircleControl.getAttrsBySysID(r,0,this.curRole),r.sort(AttributeData.sortAttribute);for(var o=0;4>o;o++){if(i>o){var a=t[o];s=this.getAttrByType(r,a)}this["arrow"+o].visible=s.length>0,this["addAttr"+o].text=s}}else{this.isMax=!0;for(var o=0;4>o;o++)this["arrow"+o].visible=!1,this["addAttr"+o].text=""}this.upInfo.visible=!this.isMax,this.maxDesc.visible=this.isMax},e.prototype.setCount=function(){var t=intensifyControl.getEnhanceCostConfigByLv(this.lv+1),e=0;t&&(this.itemNum=backpackControl.getBagGoodsCountById(0,t.stoneId),e=t.stoneNum);var i="";i=this.itemNum>=e?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.countLabel.textFlow=TextUtils.generateTextFlow("<font color="+i+">"+this.itemNum+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+e+"</font> ")},e.prototype.getAttrByType=function(t,e){for(var i=t.length,n=0;i>n;n++)if(t[n].type==e.type&&t[n].value!=e.value)return""+t[n].value;return""},e}(BasePanel);__reflect(IntensifyPanel.prototype,"IntensifyPanel");var IntensifyView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="IntensifyViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.selectedIndex=0,this.tab.dataProvider=this.viewStack,this.mc=new GameMovieClip,this.mc.x=240,this.mc.y=400,this.mcList=[];for(var e=0;8>e;e++){var i=new GameMovieClip;i.x=240,i.y=400,this.mcList.push(i)}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];4==i&&GameServer.serverOpenDay<DataCenter.ins().MagicCirConfig.uiShowDay-1&&(i=0),this.tab.selectedIndex=this.viewStack.selectedIndex=i,void 0!=t[1]&&this.roleSelect.setCurRole(parseInt(t[1]+"")),this.setRoleId(this.roleSelect.getCurRole()),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.closeBtn0,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.roleSelect,this.onChange),this.addCustomEvent(170,this.onEvent),this.addCustomEvent(588,this.delayRedPoint),this.addCustomEvent(589,this.delayRedPoint),this.addCustomEvent(590,this.delayRedPoint),this.addCustomEvent(591,this.delayRedPoint),this.addCustomEvent(592,this.delayRedPoint),this.addCustomEvent(54,this.updateDeTask),this.addCustomEvent(466,this.checkShowDemonCir),this.checkShowDemonCir()},e.prototype.checkShowDemonCir=function(){GameServer.serverOpenDay>=DataCenter.ins().MagicCirConfig.uiShowDay-1?(magicCircleControl.checkActived()?(this.magicCircleTaskPanel&&(DisplayUtils.removeFromParent(this.magicCircleTaskPanel),this.magicCircleTaskPanel.close(),this.magicCircleTaskPanel=null),this.magicCircleListPanel||(this.magicCircleListPanel=new MagicCircleListPanel),this.magicCircleListPanel.parent||(this.viewStack.addChild(this.magicCircleListPanel),this.viewStack.validateNow(),this.tab.dataProvider=this.viewStack,this.tab.validateNow(),TimerMgr.ins().doTimer(50,1,this.resetSelected,this))):(this.magicCircleListPanel&&(DisplayUtils.removeFromParent(this.magicCircleListPanel),this.magicCircleListPanel.close(),this.magicCircleListPanel=null),this.magicCircleTaskPanel&&this.magicCircleTaskPanel.parent||(this.magicCircleTaskPanel||(this.magicCircleTaskPanel=new MagicCircleTaskPanel,this.magicCircleTaskPanel.top=0,this.magicCircleTaskPanel.bottom=0),this.magicCircleTaskPanel.parent||(this.viewStack.addChild(this.magicCircleTaskPanel),this.viewStack.validateNow(),this.tab.dataProvider=this.viewStack,this.tab.validateNow(),TimerMgr.ins().doTimer(50,1,this.resetSelected,this)))),this.redPointGroup.addChild(this.redPoint4)):(this.magicCircleTaskPanel&&(DisplayUtils.removeFromParent(this.magicCircleTaskPanel),this.magicCircleTaskPanel.close(),this.magicCircleTaskPanel=null),this.magicCircleListPanel&&(DisplayUtils.removeFromParent(this.magicCircleListPanel),this.magicCircleListPanel.close(),this.magicCircleListPanel=null),DisplayUtils.removeFromParent(this.redPoint4))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this.viewStack.numChildren,n=0;i>n;n++)this.viewStack.getChildAt(n).close();var o=UIMgr.ins().getView(GameBottomView);o&&o.closeNav(GameBottomView.NAV_SMITH),DisplayUtils.removeFromParent(this.mc);for(var n=0;8>n;n++)DisplayUtils.removeFromParent(this.mcList[n])},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex),this.redPointEx()},e.prototype.onTabTouching=function(t){return this.checkIsOpen(t.currentTarget.selectedIndex)?void 0:void t.preventDefault()},e.prototype.setOpenIndex=function(t,e){var i=0,n=heroControl.getSubRoleByIndex(this.roleSelect.getCurRole()),o=!0;switch(this.roleSelect.openRole(),t){case 0:i=n.getMinEquipIndexByType(0),this.intensifyPanel.open(i,n.getEquipByIndex(i).strengthen);break;case 1:i=n.getMinEquipIndexByType(1),ActorControl.level>=DataCenter.ins().IntensifyOpenConfig[0].openLv?this.refinePanel.open(i,n.getEquipByIndex(i).gem):(o=!1,tipsControl.showTips(LangMgr.getValueByKey("forgeJLOpen",DataCenter.ins().IntensifyOpenConfig[0].openLv)));break;case 2:i=n.getMinEquipIndexByType(2),this.forgePanel.open(i,n.getEquipByIndex(i).zhuling);break;case 3:o=SwitchMgr.ins().checkOpen(17,!0),o&&(e&&this.weaponSoulPanel.isShowSoul()?this.weaponSoulPanel.open(this.roleSelect.getCurRole(),!1):this.weaponSoulPanel.open(this.roleSelect.getCurRole(),!0));break;case 4:if(TimerMgr.ins().remove(this.resetSelected,this),magicCircleControl.checkActived())this.roleSelect.openRole(),this.magicCircleTaskPanel&&(DisplayUtils.removeFromParent(this.magicCircleTaskPanel),this.magicCircleTaskPanel.close(),this.magicCircleTaskPanel=null),this.magicCircleListPanel||(this.magicCircleListPanel=new MagicCircleListPanel,this.magicCircleListPanel.top=0,this.magicCircleListPanel.bottom=0),this.magicCircleListPanel.parent||this.viewStack.addChild(this.magicCircleListPanel),this.magicCircleListPanel.open(n);else{if(this.roleSelect.hideRole(),this.magicCircleListPanel&&(DisplayUtils.removeFromParent(this.magicCircleListPanel),this.magicCircleListPanel.close()),this.viewStack.numChildren>=5){var s=this.viewStack.getChildAt(4);s instanceof MagicCircleTaskPanel||this.viewStack.removeChild(s)}this.magicCircleTaskPanel||(this.magicCircleTaskPanel=new MagicCircleTaskPanel,this.magicCircleTaskPanel.top=0,this.magicCircleTaskPanel.bottom=0),this.magicCircleTaskPanel.parent||(this.magicCircleTaskPanel.name=LangMgr.getValueByKey("demonCir"),this.viewStack.addChild(this.magicCircleTaskPanel),this.viewStack.validateNow(),this.tab.dataProvider=this.viewStack,this.tab.validateNow(),TimerMgr.ins().doTimer(50,1,this.resetSelected,this)),this.magicCircleTaskPanel.open()}this.viewStack.selectedIndex=4,o=!1}o||(this.tab.selectedIndex=this.viewStack.selectedIndex),this.tab.selectedIndex!=this.viewStack.selectedIndex&&this.checkAutoBtn()},e.prototype.resetSelected=function(){this.tab.selectedIndex=0,this.tab.selectedIndex=this.viewStack.selectedIndex},e.prototype.checkIsOpen=function(t){switch(t){case 0:break;case 1:if(ActorControl.level<DataCenter.ins().IntensifyOpenConfig[0].openLv)return tipsControl.showTips(LangMgr.getValueByKey("forgeJLOpen",DataCenter.ins().IntensifyOpenConfig[0].openLv)),!1;break;case 2:break;case 3:if(!SwitchMgr.ins().checkOpen(17,!0))return!1;break;case 4:if(!magicCircleControl.checkOpen())return tipsControl.showTips(LangMgr.getValueByKey("ladderTips16",DataCenter.ins().MagicCirConfig.openzhuanshenglv,DataCenter.ins().MagicCirConfig.openserverday)),!1}return!0},e.prototype.checkAutoBtn=function(){this.intensifyPanel.isAutoUp&&this.intensifyPanel.stopAutoUp(),this.forgePanel.isAutoUp&&this.forgePanel.stopAutoUp()},e.prototype.onEvent=function(t){var e=this,i=t[0],n=t[1],o=heroControl.getSubRoleByIndex(this.roleSelect.getCurRole());
switch(i){case 0:0==this.viewStack.selectedIndex&&(this.intensifyPanel.isAutoUp||(this.mcList[n].x=n%2*434+40,this.mcList[n].y=120*Math.floor(n/2)+35,this.mcList[n].playFile(PATH_EFF+"forgeSuccess",1),this.intensifyPanel.itemGroup.addChild(this.mcList[n])),n=o.getMinEquipIndexByType(0),this.intensifyPanel.changeData(n,o.getEquipByIndex(n).strengthen),this.intensifyPanel.autoUpBack(n));break;case 2:2==this.viewStack.selectedIndex&&(this.forgePanel.isAutoUp||(this.mcList[n].x=this.forgePanel["kuang"+n].x+this.forgePanel["kuang"+n].width/2,this.mcList[n].y=this.forgePanel["kuang"+n].y+this.forgePanel["kuang"+n].height/2,this.mcList[n].playFile(PATH_EFF+"forgeSuccess",1),this.forgePanel.itemGroup.addChild(this.mcList[n])),n=o.getMinEquipIndexByType(2),this.forgePanel.changeData(n,o.getEquipByIndex(n).zhuling),this.forgePanel.autoUpBack(n))}TimerMgr.ins().doTimer(200,1,function(){switch(i){case 1:1==e.viewStack.selectedIndex&&e.refinePanel.changeData(n,o.getEquipByIndex(n).gem)}},this),this.redPointEx()},e.prototype.delayRedPoint=function(){TimerMgr.ins().isExists(this.redPointEx,this)||TimerMgr.ins().doTimer(60,1,this.redPointEx,this)},e.prototype.redPointEx=function(){for(var t=[!1,!1,!1],e=0;e<t.length;e++)this.roleSelect.showRedPoint(e,t[e]);this.redPoint3.visible=!1;for(var i=0;5>i;i++){if(IntensifyRedPoint.ins().roleTabs[i]&&this.tab.selectedIndex==i)for(var n=0;n<heroControl.subRolesLen;n++)this.roleSelect.showRedPoint(n,IntensifyRedPoint.ins().roleTabs[i][n]),3==i&&this.weaponSoulPanel.isShowSoul()&&this.roleSelect.showRedPoint(n,IntensifyRedPoint.ins().getFlexibleRoleRedPoint(n));if(3==i)for(var o=0;o<heroControl.subRolesLen;o++){var s=weaponsSoulControl.checkRedPoint(o);this.redPoint3.visible||(this.redPoint3.visible=s),3==this.tab.selectedIndex&&this.roleSelect.showRedPoint(o,s)}else this["redPoint"+i].visible=!1,this["redPoint"+i].visible=IntensifyRedPoint.ins().getRedPoint(i);if(4==i)for(var r=0;r<heroControl.subRolesLen;r++)4==this.tab.selectedIndex&&this.roleSelect.showRedPoint(r,magicCircleControl.checkRedByIndex(r))}},e.prototype.redPoint=function(){for(var t=heroControl.subRolesLen,e=[!1,!1,!1],i=0;i<e.length;i++)this.roleSelect.showRedPoint(i,e[i]),this["redPoint"+i].visible=!1;this.redPoint3.visible=!1;for(var n=0;t>n;n++){for(var i=0;3>i;i++){var o=heroControl.getSubRoleByIndex(n),s=o.getMinEquipIndexByType(i),r=this.getForgeLv(i,o,s),a=this.getForgeIdOrCount(i,r,0);if(a){var l=this.getForgeIdOrCount(i,r,1),h=void 0;if(h=1==i?ActorControl.soul:backpackControl.getBagGoodsCountById(0,l),h>=a&&(this.tab.selectedIndex==i&&this.roleSelect.showRedPoint(n,!0),1!=i?this["redPoint"+i].visible=!0:ActorControl.level>=DataCenter.ins().IntensifyOpenConfig[0].openLv&&(this["redPoint"+i].visible=!0),this["redPoint"+i].visible)){var u=heroControl.getSubRoleByIndex(this.roleSelect.getCurRole());this["redPoint"+i].visible=intensifyControl.isMaxForge(u,i)}}}var p=weaponsSoulControl.checkRedPoint(n);this.redPoint3.visible||(this.redPoint3.visible=p),3==this.tab.selectedIndex&&this.roleSelect.showRedPoint(n,p)}},e.prototype.getForgeLv=function(t,e,i){switch(t){case 0:return e.getEquipByIndex(i).strengthen;case 2:return e.getEquipByIndex(i).zhuling;case 1:return e.getEquipByIndex(i).gem}},e.prototype.getForgeIdOrCount=function(t,e,i){switch(t){case 0:var n=intensifyControl.getEnhanceCostConfigByLv(e+1);if(n)return i?n.stoneId:n.stoneNum;break;case 2:var o=intensifyControl.getZhulingCostConfigByLv(e+1);if(o)return i?o.itemId:o.count;break;case 1:var s=intensifyControl.getStoneLevelCostConfigByLv(e+1);if(s)return i?s.stoneId:s.soulNum}return 0},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole(),!0)},e.prototype.setRoleId=function(t,e){this.intensifyPanel.curRole=this.refinePanel.curRole=this.forgePanel.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex,e),this.redPointEx()},e.prototype.updateDeTask=function(){4==this.tab.selectedIndex&&magicCircleControl.checkActived()&&(this.setOpenIndex(4),this.redPointEx())},e}(BaseEuiView);__reflect(IntensifyView.prototype,"IntensifyView");var ItemDirUpLvPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="UpBtnSkin",e.touchEnabled=!0,e.touchChildren=!1,e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegin,e),e}return __extends(e,t),e.prototype.open=function(t,e){return e||(e=0),t?(this.checkItem(t),this._roleID=e,this.addEvents(),void this.update()):(Assert(!1,"itemIds is null"),void this.hide())},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),TimerMgr.ins().remove(this.onRepeat,this),this.clearEff()},e.prototype.checkItem=function(t){this._itemID=0;for(var e=0;e<t.length;e++){var i=t[e];if(!backpackControl.isHideDanIcon(i)){this._itemID=i;break}}this._itemID||(this._itemID=t[0])},e.prototype.addEvents=function(){this.addEventTouchTap(this,this.onUse),this.addCustomEvent(267,this.update),this.addCustomEvent(466,this.update),this.addCustomEvent(461,this.update),this.addCustomEvent(376,this.update),this.addCustomEvent(395,this.update),this.addCustomEvent(177,this.updateEff),this.addCustomEvent(177,this.update),this.addCustomEvent(704,this.updateRed),this.addCustomEvent(146,this.updateRed),this.addCustomEvent(206,this.updateRed),this.addCustomEvent(161,this.updateRed),this.addCustomEvent(163,this.updateRed),this.addCustomEvent(366,this.updateRed),this.addCustomEvent(164,this.updateRed)},e.prototype.update=function(){if(backpackControl.isHideDanIcon(this._itemID))this.hide();else{var t=DataCenter.ins().ItemConfig[this._itemID].useArg;this.btnImg.source=t?t.icon:"",TimerMgr.ins().isExists(this.onRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.onRepeat,this),this.onRepeat(),this.updateRed(),this.updateEff(),this.visible=!0}},e.prototype.onUse=function(){var t=DataCenter.ins().ItemConfig[this._itemID],e=t.useType;if(this.isDefault(e))return UIMgr.ins().open(PayDailyGetExtraView,!0);if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,this._itemID)){var i=t.useArg,n=heroControl.getSubRoleByIndex(this._roleID);switch(e){case 22:equipControl.getMinZhuLingLvByRole(this._roleID)!=i.maxLevel?this.onWarn(LangMgr.getValueByKey("equipment24"),i,i.maxLevel):this.useDan();break;case 23:if(!n.loongSoulData.state)return void tipsControl.showTips(LangMgr.getValueByKey("noAction"));var o=n.loongSoulData.level,s=n.loongSoulData.stage;o<Object.keys(DataCenter.ins().DragonSoulConfig).length-1&&o>0&&o%10==0&&o/10-1>=s?tipsControl.showCenterTips(LangMgr.getValueByKey("qingxianshengjie")):s!=i.maxLevel?this.onWarn(LangMgr.getValueByKey("equipment4"),i,i.maxLevel+1):this.useDan();break;case 24:if(!n.wingsData.openStatus)return void tipsControl.showTips(LangMgr.getValueByKey("noAction"));n.wingsData.lv!=i.maxLevel?this.onWarn(LangMgr.getValueByKey("yuyistr"),i,i.maxLevel+1):this.useDan();break;case 25:UIMgr.ins().open(BookDanSelectView,this._itemID);break;case 26:var r=superRingControl.getSpecialRingDataById(SuperRingControl.FIRE_RING_ID);if(r.level!=i.maxLevel){var a=i.maxLevel%(SuperRingControl.perStar+1);this.onWarn(LangMgr.getValueByKey("tejiestr"),i,superRingControl.getRingStair(i.maxLevel),0==a?10:a-1)}else this.useDan();break;case 27:UIMgr.ins().open(EquipUpgrateChooseView,this._itemID)}}else payControl.hasGetedDan()?UIMgr.ins().open(PayDailyGetExtraView,!0):warnControl.show(LangMgr.getValueByKey("zhishengdanbuzu",t.name),function(){UIMgr.ins().open(PayDailyGetExtraView,!0)},this)},e.prototype.isDefault=function(t){switch(t){case 22:case 23:case 24:case 25:case 26:case 27:return!1;default:return!0}},e.prototype.onRepeat=function(){var t=backpackControl.getDanActivity(DataCenter.ins().ItemConfig[this._itemID].useArg.actId);t?this.timeTxt.text=""+DateUtils.getFormatBySecond(Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3),DateUtils.TIME_FORMAT_1):this.hide()},e.prototype.updateRed=function(){switch(this.redPoint.visible=!1,DataCenter.ins().ItemConfig[this._itemID].useType){case 22:this.redPoint.visible=!!IntensifyRedPoint.ins().danReds[this._roleID];break;case 23:this.redPoint.visible=dragonSoulControl.checkDanRed(this._roleID);break;case 24:this.redPoint.visible=featherControl.checkDanRedByIndex(this._roleID);break;case 25:this.redPoint.visible=BookRedPoint.ins().danRed;break;case 26:this.redPoint.visible=superRingControl.checkDanRed();break;case 27:this.redPoint.visible=backpackControl.checkDanRed()}},e.prototype.hide=function(){TimerMgr.ins().remove(this.onRepeat,this),this.visible=!1},e.prototype.getWarnDes=function(t,e,i,n){n||(n=-1);var o=DataCenter.ins().ItemConfig[this._itemID],s="|C:"+ItemUtils.getQualityColor(o)+"&T:"+o.name+"|",r="|C:65280&T:"+t+LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(i))+(n>-1?StringUtils.NumberToChinese(n)+LangMgr.getValueByKey("roleStart"):"")+"|",a=DataCenter.ins().ItemConfig[e.award[0].id],l=backpackControl.getDanActivity(e.actId),h="|C:65280&T:"+DateUtils.getFormatBySecond(Math.floor(DateUtils.formatMiniDateTime(l.endTime))-60,DateUtils.TIME_FORMAT_20)+"|",u=LangMgr.getValueByKey("zhishengdancomTips",s,r,s,r,ItemUtils.getQualityColor(a),a.name,e.award[0].count,h,backpackControl.getItemNameByID(e.outTimeAward[0].id),e.outTimeAward[0].count);return u},e.prototype.onWarn=function(t,e,i,n){var o=this;n||(n=-1),warnControl.show(this.getWarnDes(t,e,i,n),function(){o.useDan()},this)},e.prototype.useDan=function(){backpackControl.upUseItem(this._itemID,1,this._roleID),backpackControl.recordUseDan(this.getSetType(DataCenter.ins().ItemConfig[this._itemID].useType))},e.prototype.getSetType=function(t){switch(t){case 22:return 52;case 23:return 53;case 24:return 54;case 25:return 55;case 26:return 56;case 27:return 57;default:return 0}},e.prototype.onTouchBegin=function(t){this.$stage.addEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),this.$stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.currentState="down"},e.prototype.onStageTouchEnd=function(t){this.onEnd(t.$currentTarget)},e.prototype.onTouchCancle=function(t){this.onEnd(t.$currentTarget)},e.prototype.onEnd=function(t){t.removeEventListener(egret.TouchEvent.TOUCH_CANCEL,this.onTouchCancle,this),t.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouchEnd,this),this.currentState="up"},e.prototype.updateEff=function(){if(payControl.hasGetedDan())this.clearEff();else{this._eff||(this._eff=ObjectPool.pop("GameMovieClip")),this._eff.parent||this.effGroup.addChild(this._eff);var t=PATH_EFF+"actIconCircle";this._eff.name!=t&&this._eff.playFile(t,-1)}},e.prototype.clearEff=function(){this._eff&&(this._eff.destroy(),this._eff=null)},e}(BasePanel);__reflect(ItemDirUpLvPanel.prototype,"ItemDirUpLvPanel");var RefinePanel=function(t){function e(){var e=t.call(this)||this;return e.curPanel=3,e.isMax=!1,e.isAutoUp=!1,e.itemNum=0,e.itemArr=[],e.eqIndexItems=[],e.isPlay=!1,e.name=LangMgr.getValueByKey("equipment23"),e.curPanel=1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.getItemTxt.text+"</u>")},e.prototype.open=function(t,e){this.addEventTouchTap(this.upGradeBtn,this.onTouch),this.addEventTouchTap(this.getItemTxt,this.onGetItem);for(var i=0;i<GameConst.FORGE_MAX;i++)this.eqIndexItems.push(this["item"+i]),this["item"+i].select.visible=i==t?!0:!1,this.addEventTouchTap(this["item"+i],this.onSelectItem);this.addCustomEvent(266,this.setCount),this.addCustomEvent(267,this.setCount),this.addCustomEvent(172,this.updateCallBack),this.isMax=!1,this.changeData(t,e,!0,!0),this.stopAutoUp(),this.cleanEff(),this.playEff()},e.prototype.close=function(){this.removeEventTouchTap(this.upGradeBtn,this.onTouch),this.removeEventTouchTap(this.getItemTxt,this.onGetItem),this.removeCustomEvents(),this.stopAutoUp()},e.prototype.onTouch=function(t){switch(t.target){case this.upGradeBtn:this.costConfig&&this.itemNum>=this.costConfig.soulNum?(refineControl.upUpGrade(this.curRole,this.pos),SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN)):warnControl.setBuyGoodsWarn(this.costConfig.stoneId,this.costConfig.soulNum-this.itemNum)}},e.prototype.onItemTouch=function(t){var e=heroControl.getSubRoleByIndex(this.curRole),i=Number(t.currentTarget.name);this.changeData(i,e.getEquipByIndex(i).gem)},e.prototype.stopAutoUp=function(){this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpStar,this)},e.prototype.autoUpStar=function(){this.costConfig&&this.itemNum>=this.costConfig.soulNum?(refineControl.upUpGrade(this.curRole,this.pos),SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN)):(this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpStar,this))},e.prototype.setPower=function(){var t=heroControl.getSubRoleByIndex(this.curRole);this._totalPower=t.getForgeTotalPower(this.curPanel),this._totalPower+=Math.floor(this._totalPower*magicCircleControl.getAddPerBySysID(2,this.curRole)/1e4),this.powerPanel.setPower(this._totalPower)},e.prototype.changeData=function(t,e,i,n){void 0===i&&(i=!0),void 0===n&&(n=!1),this.pos=t,this.lv=e,this.setPower(),i&&this.setCount(),this.updateItem(n),this.setAttrData()},e.prototype.playEff=function(){var t=this;if(!this.isPlay){var e="jljdt";this.isPlay=!0;var i=1,n=new GameMovieClip;n.playFile(PATH_EFF+e,-1),this.leftEff.addChild(n),n.scaleX=0,n.scaleY=.6;var o=new GameMovieClip;o.playFile(PATH_EFF+e,-1),this.rightEff.addChild(o),o.scaleX=0,o.scaleY=.6;var s=new GameMovieClip;s.playFile(PATH_EFF+e,-1),this.buttonEff.addChild(s),s.x+=12,s.scaleX=0,s.scaleY=.6,s.$setRotation(90);var r=new GameMovieClip;r.playFile(PATH_EFF+e,-1),this.leftEff2.addChild(r),r.scaleX=0,r.scaleY=.4;var a=new GameMovieClip;a.playFile(PATH_EFF+e,-1),this.rightEff2.addChild(a),a.scaleX=0,a.scaleY=.4;var l=new GameMovieClip;l.playFile(PATH_EFF+e,-1),this.obliqueleft.addChild(l),l.scaleX=0,l.scaleY=.4;var h=new GameMovieClip;h.playFile(PATH_EFF+e,-1),this.obliqueright.addChild(h),h.scaleX=0,h.scaleY=.4;var u=new GameMovieClip;u.playFile(PATH_EFF+e,-1),this.leftEff3.addChild(u),u.scaleX=0,u.scaleY=.4;var p=new GameMovieClip;p.playFile(PATH_EFF+e,-1),this.rightEff3.addChild(p),p.scaleX=0,p.scaleY=.4;var c=new GameMovieClip;c.playFile(PATH_EFF+e,-1),this.obliqueleft2.addChild(c),c.scaleX=0,c.scaleY=.4;var d=new GameMovieClip;d.playFile(PATH_EFF+e,-1),this.obliqueright2.addChild(d),d.scaleX=0,d.scaleY=.4;var g=new GameMovieClip;g.playFile(PATH_EFF+e,-1),this.leftEff4.addChild(g),g.scaleX=0,g.scaleY=.4;var m=new GameMovieClip;m.playFile(PATH_EFF+e,-1),this.rightEff4.addChild(m),m.scaleX=0,m.scaleY=.4;var f=.19,v=.09,y=.023,C=.15,T=egret.Tween.get(n),w=egret.Tween.get(o);w.to({scaleX:f},250*i),T.to({scaleX:f},250*i).call(function(){var e=egret.Tween.get(s);e.to({scaleX:.28},250*i).call(function(){var e=egret.Tween.get(r),n=egret.Tween.get(a);n.to({scaleX:v},250*i),e.to({scaleX:v},250*i).call(function(){var e=egret.Tween.get(l),n=egret.Tween.get(h);n.to({scaleX:y},50*i),e.to({scaleX:y},50*i).call(function(){var e=egret.Tween.get(u),n=egret.Tween.get(p);n.to({scaleX:C},250*i),e.to({scaleX:C},250*i).call(function(){var e=egret.Tween.get(c),n=egret.Tween.get(d);n.to({scaleX:y},50*i),e.to({scaleX:y},50*i).call(function(){var e=egret.Tween.get(g),n=egret.Tween.get(m);n.to({scaleX:v},250*i),e.to({scaleX:v},250*i).call(function(){t.isPlay=!1})})})})})})})}},e.prototype.cleanEff=function(){this.leftEff.removeChildren(),this.rightEff.removeChildren(),this.buttonEff.removeChildren(),this.leftEff2.removeChildren(),this.rightEff2.removeChildren(),this.obliqueleft.removeChildren(),this.obliqueright.removeChildren(),this.leftEff3.removeChildren(),this.rightEff3.removeChildren(),this.obliqueleft2.removeChildren(),this.obliqueright2.removeChildren(),this.leftEff4.removeChildren(),this.rightEff4.removeChildren(),this.isPlay=!1},e.prototype.updateCallBack=function(){var t=this,e=new GameMovieClip;e.x=this["new"].x+this["new"].width/2,e.y=this["new"].y+this["new"].height/2,this.itemGroup2.addChild(e),e.playFile(PATH_EFF+"forgeSuccess",1,function(){var e=heroControl.getSubRoleByIndex(t.curRole),i=e.equipsData;t.now.updateItem(i[t.pos].item.itemConfig,t.pos,i[t.pos].gem,t.itemNum,!1),t["new"].updateItem(i[t.pos].item.itemConfig,t.pos,i[t.pos].gem+1,t.itemNum,!1)})},e.prototype.updateItem=function(t){for(var e=heroControl.getSubRoleByIndex(this.curRole),i=e.equipsData,n=0;n<GameConst.FORGE_MAX;n++){var o=i[n].gem,s=this.itemNum;if(t&&n==this.pos){var r=DataCenter.ins().IntensifyOpenConfig[n];ActorControl.level>=r.openLv&&(this.lv=i[this.pos].gem,this["item"+n].select.visible=!0,this.xjyl.visible=!1),this.now.updateItem(i[n].item.itemConfig,n,o,this.itemNum,!1),this["new"].updateItem(i[n].item.itemConfig,n,o+1,this.itemNum,!1)}if(!s){var a=i[n].gem?i[n].gem:1,l=DataCenter.ins().IntensifyLevelCostConfig[a];l&&(s=backpackControl.getBagGoodsCountById(0,l.stoneId))}this["item"+n].data={item:i[n].item.itemConfig,pos:n,lv:i[n].gem,itemNum:s}}},e.prototype.onSelectItem=function(t){var e=this.eqIndexItems.indexOf(t.currentTarget);if(-1!=e){this.isPlay&&(this.isPlay=!1,this.cleanEff());for(var i=this.pos,n=0;n<GameConst.FORGE_MAX;n++)this["item"+n].select.visible&&(i=n),this["item"+n].select.visible=!1;var o=!1,s=heroControl.getSubRoleByIndex(this.curRole),r=s.equipsData,a=DataCenter.ins().IntensifyOpenConfig[e],l="";switch(t.currentTarget){case this["item"+e]:ActorControl.level>=a.openLv?(this.cleanEff(),this.playEff(),this.pos=e,this.lv=r[this.pos].gem,o=!0,this["item"+e].select.visible=!0,this.xjyl.visible=!1,this.now.updateItem(r[e].item.itemConfig,e,r[e].gem,this.itemNum,!1),this["new"].updateItem(r[e].item.itemConfig,e,r[e].gem+1,this.itemNum,!1)):l=LangMgr.getValueByKey("tipsOpenLevel",a.openLv)}o||(this["item"+i].select.visible=!0,tipsControl.showTips(l)),this.setAttrData(),this.setCount()}},e.prototype.setAttrData=function(){var t;t=intensifyControl.getForgeConfigByPos(this.pos,this.lv,this.curPanel);var e=t.attr||[];e=magicCircleControl.getAttrsBySysID(e,2,this.curRole);var i=(magicCircleControl.getAddPerBySysID(2,this.curRole)>0?16767295:this.attr0.textColor,e.length);e.sort(AttributeData.sortAttribute);for(var n=0;4>n;n++)this["attr"+n].text=i>n?AttributeData.getAttStrByType(e[n],.5):"";var o;o=intensifyControl.getForgeConfigByPos(this.pos,this.lv+1,this.curPanel);var s="";if(o){this.isMax=!1;var r=o.attr||[];r=magicCircleControl.getAttrsBySysID(r,2,this.curRole),r.sort(AttributeData.sortAttribute);for(var n=0;4>n;n++){var a="";if(i>n){var l=e[n];a=this.getAttrByType(r,l)}this["arrow"+n].visible=a.length>0,this["addAttr"+n].text=a}}else{this.isMax=!0;for(var n=0;4>n;n++)this["arrow"+n].visible=!1,this["addAttr"+n].text=""}this.attr.text=s,this.upInfo.visible=!this.isMax,this.maxDesc.visible=this.isMax,this.maxDesc.visible&&(this.now.hideAdd(),this["new"].hideAdd())},e.prototype.onGetItem=function(t){warnControl.setBuyGoodsWarn(this.costConfig.stoneId,1)},e.prototype.setCount=function(){this.costConfig=intensifyControl.getStoneLevelCostConfigByLv(this.lv+1);var t=0;this.costConfig&&(this.itemNum=ActorControl.soul,t=this.costConfig.soulNum);var e="";e=this.itemNum>=t?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.countLabel.textFlow=TextUtils.generateTextFlow("<font color="+e+">"+this.itemNum+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+t+"</font> "),this.buyStoneUpdateItem()},e.prototype.buyStoneUpdateItem=function(){this.updateItem()},e.prototype.getAttrByType=function(t,e){if(!e)return"";for(var i=t.length,n=0;i>n;n++)if(t[n].type==e.type&&t[n].value!=e.value)return""+t[n].value;return""},e}(BasePanel);__reflect(RefinePanel.prototype,"RefinePanel");var EquipUpgrateChooseItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="EquipUpgrateChooseItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this.upgrateBtn,this.onUse)},e.prototype.dataChanged=function(){var t=this.data.item;this.itemIcon.data=t.itemConfig,this.levelText.text=CommonFun.convertLevel(CommonFun.convertCfgLvToComLv(t.itemConfig.level,t.itemConfig.zsLevel)),this.power.text=LangMgr.getValueByKey("wingPingfen",t.point),this.attr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStrEx(this.getEquipAttrsByData(t),0,1)),this.best.visible=0==ItemUtils.getSubType(t.itemConfig)},e.prototype.getEquipAttrsByData=function(t){if(!t||!t.configID)return null;var e=this.getEquipBaseAttrs(t.configID);return e?(t.att&&(e=e.concat(t.att.concat()),e=AttributeData.combineAtts(e)),e):null},e.prototype.getEquipBaseAttrs=function(t){var e=DataCenter.ins().EquipConfig[t];if(!e)return null;for(var i=[2,4,5,6],n=["hp","atk","def","res"],o=[],s=0;i.length>s;s++)e[n[s]]&&o.push(new AttributeData(i[s],e[n[s]]));return o},e.prototype.onUse=function(){var t=this;if(this.best.visible)this.sendAndClose();else{var e=DataCenter.ins().ItemConfig[this.data.danID];warnControl.show(LangMgr.getValueByKey("zhishengdanequipTips",ItemUtils.getQualityColor(e),e.name),function(){t.sendAndClose()},this)}},e.prototype.sendAndClose=function(){backpackControl.upUseItem(this.data.danID,1,this.data.item.handle),backpackControl.recordUseDan(57),UIMgr.ins().close(EquipUpgrateChooseView)},e}(BaseItemRender);__reflect(EquipUpgrateChooseItemRender.prototype,"EquipUpgrateChooseItemRender");var RefineItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="RefineItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.bitmapNum=BitmapNumber.ins().createNumPic(0,"lv_"),this.addChild(this.bitmapNum),this.bitmapNum.x=this.num0.x,this.bitmapNum.y=this.num0.y,this.lockbitmapNum=BitmapNumber.ins().createNumPic(0,"lvk_"),this.unlock1.addChild(this.lockbitmapNum),this.lockbitmapNum.anchorOffsetX=this.lockbitmapNum.width/2,this.lockbitmapNum.anchorOffsetX=this.lockbitmapNum.height/2,this.lockbitmapNum.x=this.unlock1.x,this.lockbitmapNum.y=this.unlock1.y-10,this.unlock.addChild(this.lockbitmapNum),this.itemIcon.imgJob.visible=!1},e.prototype.dataChanged=function(){this.updateItem(this.data.item,this.data.pos,this.data.lv,this.data.itemNum)},e.prototype.hideAdd=function(){this.add.visible=!1,this.bitmapNum.visible=!1},e.prototype.updateItem=function(t,e,i,n,o){void 0===o&&(o=!0),this.add.visible=i>0?!0:!1;var s=DataCenter.ins().IntensifyOpenConfig[e];if(ActorControl.level>=s.openLv){var r=intensifyControl.getStoneLevelCostConfigByLv(i+1),a=0;r&&(a=r.soulNum);var l=n>=a?!0:!1;this.state.visible=l,i>=80&&(this.state.visible=!1),BitmapNumber.ins().changeNum(this.bitmapNum,i,"lv_"),t?this.setItemImg(t.icon+"_png"):this.setItemImg("xb_"+(e+10).toString()),this.unlock.visible=!1,this.lockbitmapNum.visible=!1}else this.state.visible=!1,this.unlock.visible=!0,this.lockbitmapNum.visible=!0,this.add.visible=!1,this.setItemImg("xb_"+(e+10)),BitmapNumber.ins().changeNum(this.lockbitmapNum,s.openLv,"lvk_"),0!=Math.floor(s.openLv/100)||100==s.openLv?this.lockbitmapNum.x=this.unlock1.x-10:this.lockbitmapNum.x=this.unlock1.x-5;this.bitmapNum.visible=this.add.visible,o||(this.state.visible=!1)},e.prototype.setItemImg=function(t){this.itemIcon.imgIcon.source=t},e.prototype.setItemData=function(t){this.setItemImg(t.icon+"_png")},e}(BaseItemRender);__reflect(RefineItemRender.prototype,"RefineItemRender");var LadderControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCanReward=!1,e.upLevel=0,e.upId=0,e.upWin=0,e.todayBuyTime=0,e.upWeekRank=0,e.upRankList=[],e._actorInfo=[],e.danStarNum=[3,4,5,0],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getActorInfo=function(t){return void 0===t&&(t=-1),-1==t?this._actorInfo:this._actorInfo[t]},e.prototype.upGetSomeOne=function(){},e.prototype.upStarPlay=function(t,e){return this._actorInfo=[],[e,t]},e.prototype.upGetRankInfo=function(){},e.prototype.upBuyChallgeTime=function(){},e.prototype.downLadderInfo=function(t,e,i,n,o,s,r,a,l,h,u,p){this.isOpen=t,this.level=e,this.nowId=i,this.challgeNum=n,this.challgeCd=1e3*o+egret.getTimer(),this.winNum=s,this.continueWin=r,this.playUpTime=a,this.playUpTime&&(this.isCanReward=l,this.upLevel=h,this.upId=u,this.upWin=p),EventMgr.ins().dispatch(60)},e.prototype.downGetPlayer=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(this._actorInfo.length=0,this._actorInfo.push(t,e),e>0)for(var o=0;o<i.length;o++)this._actorInfo.push(i[o])},e.prototype.downRankInfoList=function(t,e){var i=rankControl.getRankModel(11);i.getDataList().length=t.length;for(var n=i.getDataList(),o=0;o<t.length;++o)this.setRankData(n,o,t[o]);var s=this.getMyRankInfo(n);i.selfPos=s?s.pos:0,this.upRankList=[],this.upweekLength=0;for(var o=0;o<e.length;++o)this.setRankData(this.upRankList,o,e[o],!0);this.fillingList(),EventMgr.ins().dispatch(61)},e.prototype.setRankData=function(t,e,i,n){void 0===n&&(n=!1),e in t||(t[e]=new RankDataLadderVo),t[e].init(i),t[e].pos=e+1,n&&t[e].id==ActorControl.actorID&&(this.upWeekRank=t[e].pos)},e.prototype.downChallageNum=function(t){this.todayBuyTime=t},e.prototype.downPlayResult=function(t,e,i,n,o){for(var s,r=[],a=0;a<e.length;a++)s=new RewardVo,s.init(e[a]),r.push(s);TimerMgr.ins().doTimer(1e3,1,function(){UIMgr.ins().open(LadderResultView,t,r.reverse(),i,n,o)},this)},e.prototype.fillingList=function(){0==this.upweekLength&&(this.upweekLength=this.checkObjListLength());var t=this.upweekLength-this.upRankList.length;if(t>0)for(var e=1;t>e;e++)this.upRankList.push(null);this.configList||(this.configList=this.cloneConfigDataList(DataCenter.ins().LadderInfoDanConfig),this.configList.reverse())},e.prototype.getUpRankList=function(){var t=[];for(var e in this.upRankList)this.upRankList[e]&&t.push(this.upRankList[e]);return t},e.prototype.checkObjListLength=function(){return Object.keys(DataCenter.ins().LadderInfoRankAwardConfig).length},e.prototype.getMyRankInfo=function(t){for(var e=0;e<t.length;e++)if(t[e].id==ActorControl.actorID)return t[e];return null},e.prototype.getDanLength=function(t){var e=DataCenter.ins().LadderInfoDanConfig;return Object.keys(e[t+""]).length},e.prototype.getRankDesc=function(){var t=this.getLevelConfig();return t?t.showLevel+LangMgr.getValueByKey("chinese"+t.showDan)+LangMgr.getValueByKey("numberParagraph"):""},e.prototype.getLevelConfig=function(t,e){void 0===t&&(t=-1),void 0===e&&(e=-1),-1==t&&(t=this.level),-1==e&&(e=this.nowId);var i=DataCenter.ins().LadderInfoDanConfig;for(var n in i[t+""])if(i[t+""][n].id==e)return i[t+""][n];return null},e.prototype.creatRewardData=function(t){var e;return e=new RewardVo,e.count=t.count,e.type=t.type,e.id=t.id,e},e.prototype.cloneConfigDataList=function(t){var e,i=[];for(var n in t)for(var o in t[n]){e={},e.level=parseInt(n),e.id=t[n][o].id,e.showStar=t[n][o].showStar,e.showDan=t[n][o].showDan,e.showLevel=t[n][o].showLevel,e.winAward=t[n][o].winAward,e.danAward=t[n][o].danAward,i.push(e);break}return i},e.prototype.checkRedShow=function(){return this.challgeNum>0&&this.isOpen?1:0},e.prototype.getStatuByLevel=function(t){return this.danStarNum[t-1]},__decorate([up(2)],e.prototype,"upGetSomeOne",null),__decorate([up(3,[3,3])],e.prototype,"upStarPlay",null),__decorate([up(5)],e.prototype,"upGetRankInfo",null),__decorate([up(6)],e.prototype,"upBuyChallgeTime",null),__decorate([down(1,[0,3,3,3,3,3,0,0,0,3,3,3])],e.prototype,"downLadderInfo",null),__decorate([down(2,[3,3,8,1,1,3,3])],e.prototype,"downGetPlayer",null),__decorate([down(5,[ByteConst.RankDataLadderVos,ByteConst.RankDataLadderVos])],e.prototype,"downRankInfoList",null),__decorate([down(6,[3])],e.prototype,"downChallageNum",null),__decorate([down(3,[0,ByteConst.RewardVos,3,3,3])],e.prototype,"downPlayResult",null),e=__decorate([protocolsId(34)],e)}(BaseSystem);__reflect(LadderControl.prototype,"LadderControl");var AmuseTarget0Panel3=function(t){function e(){var e=t.call(this)||this;return e._time=0,e.skinName="AmuseTarget0Panel3Skin",e}return __extends(e,t),e.prototype.open=function(){this.dailyReward.itemRenderer=AmuseDailyRechargeItemRender,this.addCustomEvent(446,this.updateList),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.initList()},e.prototype.updateData=function(){this.updateList()},e.prototype.updateList=function(){var t=this.dailyReward.dataProvider,e=t.source;e.sort(this.sort),t.refresh(),this.updateTime(),this.updateValue()},e.prototype.updateTime=function(){var t=new Date(GameServer.serverTime);t.setHours(23,59,59,0),this._time=Math.floor((t.getTime()-GameServer.serverTime)/1e3),this._time<0&&(this._time=0),this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3);var e=amusementControl.getbtnInfo(this.activityID);this.actDesc.text=e.acDesc},e.prototype.initList=function(){var t=payControl.getCurRechargeConfig(),e=[];for(var i in t)e.push(t[i]);e.sort(this.sort),this.dailyReward.dataProvider=new eui.ArrayCollection(e),this.updateTime(),this.updateValue()},e.prototype.updateValue=function(){var t=payControl.getRechargeData(0);this.record.text=LangMgr.getValueByKey("osaPayYB",t.curDayPay)},e.prototype.sort=function(t,e){var i=payControl.getRechargeData(0),n=i.isAwards>>t.index&1,o=i.isAwards>>e.index&1;return n&&!o?1:!n&&o?-1:t.pay<e.pay?-1:1},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e}(BasePanel);__reflect(AmuseTarget0Panel3.prototype,"AmuseTarget0Panel3");var LadderChallengeView=function(t){function e(){var e=t.call(this)||this;return e.sendCount=0,e.roleInfoList=[[[2,1],[1,0]],[[1,0],[3,1]],[[3,1],[2,0]],[[2,0],[3,1]]],e.skinName="LadderChallengeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.tweenObj={index:0},this.otherHead.scrollRect=new egret.Rectangle(-1,-1,84,84),this.scrollHead.scrollRect=new egret.Rectangle(-1,-56,84,84),this.otherMask=this.otherHead.scrollRect,this.scrollMask=this.scrollHead.scrollRect,this.posY=this.otherMask.y,this.posYImg=this.scrollHead.y,this.posYScroll=this.scrollMask.y},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];ladderControl.upGetSomeOne(),this.setMyHead(),this.startScrollHead(),this.ingImg.visible=!0,this.enterTime.visible=!1,portalControl.closeAuto()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.stopScrollHead(),this.removeCustomEvents(),this.ingImg.visible=!0,this.enterTime.visible=!1},e.prototype.setMyHead=function(){var t=heroControl.getSubRoleByIndex(0);this.myhead.source="head_"+t.job+t.sex;var e=ladderControl.getLevelConfig();this.myname.text=ActorControl.myName,this.mylv.text=""+e.showLevel+(e.showDan||"")+LangMgr.getValueByKey("numberParagraph")},e.prototype.startScrollHead=function(){this.rollTime=0,this.otherMask.y=this.posY,this.scrollMask.y=this.posYScroll,this.scrollHead.y=this.posYImg,this.refushRollInfo(0),egret.Tween.get(this.tweenObj,{loop:!0}).to({index:this.rollTime+1},20).call(this.startScroll,this)},e.prototype.stopScrollHead=function(){egret.Tween.removeTweens(this.tweenObj)},e.prototype.startScroll=function(){this.otherMask.y+=2,this.scrollMask.y+=2,this.scrollHead.y-=1,this.otherHead.scrollRect=this.otherMask,this.scrollHead.scrollRect=this.scrollMask,this.rollTime++,this.rollTime%27==0&&(this.otherMask.y=this.posY,this.scrollMask.y=this.posYScroll,this.scrollHead.y=this.posYImg,this.refushRollInfo(this.rollTime/27),this.rollTime/27==4&&(this.scrollHead.source="",this.rollOver()))},e.prototype.rollOver=function(){this.stopScrollHead(),this.ingImg.visible=!1,this.enterTime.visible=!0,this.rollTime=3,this.enterTime.text=LangMgr.getValueByKey("ladderEnter",this.rollTime),0==ladderControl.getActorInfo(1)&&0==ladderControl.getActorInfo(0)?(tipsControl.showTips(LangMgr.getValueByKey("ladderTips1")),UIMgr.ins().close(this)):TimerMgr.ins().doTimer(1e3,0,this.refushLabel,this)
},e.prototype.refushLabel=function(){this.rollTime--,this.enterTime.text=LangMgr.getValueByKey("ladderEnter",this.rollTime),this.rollTime<1&&(this.sendStarPlay(),TimerMgr.ins().remove(this.refushLabel,this))},e.prototype.refushRollInfo=function(t){if(t>3)return void this.showPointPlayerInfo();var e=ladderControl.level,i=Math.floor(Math.random()*ladderControl.getDanLength(e)),n=ladderControl.getLevelConfig(e,i);this.otherlv.text=""+n.showLevel+(n.showDan||"")+LangMgr.getValueByKey("numberParagraph");var o=this.roleInfoList[t];this.otherHead.source="head_"+o[0][0]+o[0][1],this.scrollHead.source="head_"+o[1][0]+o[1][1]},e.prototype.showPointPlayerInfo=function(){var t=ladderControl.getActorInfo();if(0!=t.length&&(0!=t[1]||0!=t[0])){this.otherHead.source="head_"+t[3]+t[4],this.scrollHead.source="";var e=ladderControl.getLevelConfig(t[5],t[6]);this.otherlv.text=""+e.showLevel+(e.showDan||"")+LangMgr.getValueByKey("numberParagraph"),this.othername.textFlow=TextUtils.generateTextFlow1(t[2])}},e.prototype.sendStarPlay=function(){ladderControl.upStarPlay(ladderControl.getActorInfo(1),ladderControl.getActorInfo(0)),UIMgr.ins().close(LadderView),UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(LadderChallengeView.prototype,"LadderChallengeView");var LadderInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("ladderTT"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.rewardList.itemRenderer=ItemBase},e.prototype.open=function(){this.buyTime.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("ladderTips2")),this.showRank.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("ladderTips3")),this.showReward.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("ladderTips4")),this.showLastRank.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("ladderTips5")),this.addEventTouchTap(this.flowPlayer,this.onTap),this.addEventTouchTap(this.buyTime,this.onTap),this.addEventTouchTap(this.showRank,this.onTap),this.addEventTouchTap(this.showReward,this.onTap),this.addEventTouchTap(this.showLastRank,this.onTap),this.addCustomEvent(60,this.tadderInfoChange),this.addCustomEvent(61,this.tadderInfoChange),ladderControl.upGetRankInfo(),this.tadderInfoChange()},e.prototype.$onClose=function(){t.prototype.$onClose.call(this),TimerMgr.ins().removeAll(this)},e.prototype.updateTime=function(){var t=ladderControl.challgeNum,e=DataCenter.ins().LadderInfoConstConfig.maxRestoreChallengesCount,i=t>0?LangMgr.getColor("color40"):LangMgr.getValueByKey("color10"),n=Math.round((ladderControl.challgeCd-egret.getTimer())/1e3);n=0>=n?0:n;var o=t>=e?LangMgr.getValueByKey("ladderTips6"):LangMgr.getValueByKey("ladderTips7",DateUtils.getFormatBySecond(n));this.lastNum.textFlow=(new egret.HtmlTextParser).parser('<font color="'+i+'">'+LangMgr.getValueByKey("bossHaveTimes","","")+t+"/"+e+' <font color="'+LangMgr.getValueByKey("color106")+'">'+o+"</font></font>")},e.prototype.tadderInfoChange=function(){TimerMgr.ins().remove(this.updateTime,this),TimerMgr.ins().doTimer(500,0,this.updateTime,this),this.updateTime();var t=rankControl.rankModel[11];t&&(this.rankLbl.text=t.selfPos>0?""+t.selfPos:LangMgr.getValueByKey("guanNoRank")),this.winNum.text=""+ladderControl.winNum,this.rankDecLbl.text=ladderControl.getRankDesc();var e=ladderControl.getLevelConfig();e&&(this.rewardList.dataProvider=new eui.ArrayCollection(e.danAward)),this.winImg.visible=ladderControl.continueWin,this.starInfo.updataStarInfo(e),this.noOpenDesc.visible=!ladderControl.isOpen,this.openInfo.visible=ladderControl.isOpen},e.prototype.onTap=function(t){switch(UIMgr.ins().close(LimitTaskView),t.currentTarget){case this.flowPlayer:if(copyControl.checkInFB())return;if(ladderControl.challgeNum<=0)return void tipsControl.showTips(LangMgr.getValueByKey("babelTips5"));if(UIMgr.ins().isShow(LadderChallengeView))return;UIMgr.ins().open(LadderChallengeView);break;case this.buyTime:if(ladderControl.todayBuyTime==DataCenter.ins().LadderInfoConstConfig.maxBuyChallengesCount)return void tipsControl.showTips(LangMgr.getValueByKey("ladderTips8"));if(ActorControl.yb<DataCenter.ins().LadderInfoConstConfig.buyChallengesCountYuanBao)return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));warnControl.show(LangMgr.getValueByKey("ladderTips9",DataCenter.ins().LadderInfoConstConfig.buyChallengesCountYuanBao)+LangMgr.getValueByKey("bossTodayBuy",ladderControl.todayBuyTime,DataCenter.ins().LadderInfoConstConfig.maxBuyChallengesCount),function(){ladderControl.upBuyChallgeTime()},this);break;case this.showReward:UIMgr.ins().open(LadderRewardShowView);break;case this.showRank:UIMgr.ins().open(LadderRankView,1);break;case this.showLastRank:ladderControl.upLevel>0?UIMgr.ins().open(LadderRankView,0):tipsControl.showTips(LangMgr.getValueByKey("ladderTips10"))}},e}(BasePanel);__reflect(LadderInfoPanel.prototype,"LadderInfoPanel");var LadderRankView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="LadderRankViewSkin",e}return __extends(e,t),e.prototype.createChildren=function(){this.list.itemRenderer=LadderRankItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.fgClose&&this.addEventTouchEnd(this.fgClose,this.close);var i=t[0];this.setPanelInfo(i),this.titleDesc.text=1==i?LangMgr.getValueByKey("ladderTips11"):LangMgr.getValueByKey("ladderTips12"),this.rankDesc.text=1==i?LangMgr.getValueByKey("ladderTips13"):LangMgr.getValueByKey("ladderTips14")},e.prototype.close=function(){UIMgr.ins().close(this)},e.prototype.setPanelInfo=function(t){var e=ladderControl.getLevelConfig();if(1==t){var i=rankControl.rankModel[11];this.list.dataProvider=new eui.ArrayCollection(i.getDataList()?i.getDataList():[]),this.myRank.text=i.selfPos>0?LangMgr.getValueByKey("ladderRank",i.selfPos):LangMgr.getValueByKey("babelMyRank1"),this.WinNum.text=LangMgr.getValueByKey("ladderJSC",ladderControl.winNum),this.myDanIng.source="ladder_rank_"+ladderControl.level,e=ladderControl.getLevelConfig()}else this.list.dataProvider=new eui.ArrayCollection(ladderControl.getUpRankList()),this.myRank.text=ladderControl.upWeekRank>0?LangMgr.getValueByKey("ladderRank",ladderControl.upWeekRank):LangMgr.getValueByKey("babelMyRank1"),this.WinNum.text=LangMgr.getValueByKey("ladderJSC",ladderControl.upWin),this.myDanIng.source="ladder_rank_"+ladderControl.upLevel,e=ladderControl.getLevelConfig(ladderControl.upLevel,ladderControl.upId);e.showDan>0?(this.levelBg.visible=!0,this.level.source="laddergradnum_"+e.showDan):(this.levelBg.visible=!1,this.level.source=null)},e}(BaseEuiView);__reflect(LadderRankView.prototype,"LadderRankView");var LadderRewardShowView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="LadderRewardShowViewSkin",e}return __extends(e,t),e.prototype.createChildren=function(){this.list0.itemRenderer=LadderRewardItemRenderer,this.list1.itemRenderer=ItemBase},e.prototype.open=function(){this.setPanelInfo(),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTap)},e.prototype.close=function(){this.removeEventTouchTap(this.fgClose,this.onTap)},e.prototype.onTap=function(){UIMgr.ins().close(this)},e.prototype.setPanelInfo=function(){var t=ladderControl.upRankList;t.length>5&&(t=t.slice(0,5)),this.list0.dataProvider=new eui.ArrayCollection(t);var e=ladderControl.configList,i=this.getRewardDataList(e);if(this.list1.dataProvider=new eui.ArrayCollection(i),this.winNum.text=LangMgr.getValueByKey("ladderJSC",ladderControl.upWin),this.winNum0.text=LangMgr.getValueByKey("ladderRank","")+(ladderControl.upWeekRank>0?""+ladderControl.upWeekRank:LangMgr.getValueByKey("guanNoRank")),ladderControl.playUpTime){this.upImg.source="ladder_rank_"+ladderControl.upLevel;var n=ladderControl.getLevelConfig(ladderControl.upLevel,ladderControl.upId);n.showDan>0?(this.levelbg.visible=!0,this.level.source="laddergradnum_"+n.showDan):(this.levelbg.visible=!1,this.level.source=null)}else this.upImg.source="ladder_rank_1",this.level.source="laddergradnum_5"},e.prototype.getRewardDataList=function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(t[i].danAward);return e},e.openCheck=function(){return ladderControl.configList?!0:(tipsControl.showTips(LangMgr.getValueByKey("bossErrorTips")),!1)},e}(BaseEuiView);__reflect(LadderRewardShowView.prototype,"LadderRewardShowView");var LadderStarListPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.skinName="LadderStarListPanelSkin",this.level.anchorOffsetX=10,this.level.anchorOffsetY=14,this.level.x=100,this.level.y=141},e.prototype.setLvAndRank=function(t){return void 0==t?(this.danImg.source="ladder_rank_0",void(this.level.source=null)):(this.danImg.source="ladder_rank_"+t.level,void(t.level>=4||t.showDan<=0||t.showDan>5?this.level.source=null:this.level.source="laddergradnum_"+t.showDan))},e.prototype.updataStarInfo=function(t){if(t){this.len=ladderControl.getStatuByLevel(t.level);for(var e=1;5>=e;e++)this["star"+e].currentState=e>t.showStar?"black":"light"}else this.len=0;this.currentState=this.len+"",this.setLvAndRank(t)},e.prototype.upStarStatu=function(t,e,i){var n=this;void 0===i&&(i=!1);var o=e,s=i?t:t-1,r=this;0>=s&&(s=1),void 0==this.mc&&(this.mc=new GameMovieClip);var a=this["star"+s];this.mc.x=a.x+22,this.mc.y=a.y+22,this.addChild(this.mc);this.len;if(i?(--o,this.mc.playFile(PATH_EFF+"addstar",1,function(){-1!=r.getChildIndex(r.mc)&&r.removeChild(r.mc),s==n.len?a.currentState="black":a.currentState="light",o>0&&s<n.len&&n.upStarStatu(++s,o,i)},!1)):(--o,--s,this.mc.playFile(PATH_EFF+"minusstar",1,function(){if(-1!=r.getChildIndex(r.mc)&&r.removeChild(r.mc),a.currentState="black",0==s){var t=UIMgr.ins().getView(LadderResultView);t&&t.isShow()&&t.cheackIsChangeLevel(o),n.upSign=!1}},!1),o=0),i&&s==this.len){var l=UIMgr.ins().getView(LadderResultView);l&&l.isShow()&&l.cheackIsChangeLevel(o),this.upSign=!0}},e.prototype.showLvUp=function(t){this.numLevel=t,this.level.source="laddergradnum_"+this.numLevel},e.prototype.showRankUp=function(t){this.numRank=t,this.rankMc=new GameMovieClip,this.rankMc.x=100,this.rankMc.y=99,this.rankMc.playFile(PATH_EFF+"ladderlvup",1,this.rankChangeCallback.bind(this)),this.addChild(this.rankMc)},e.prototype.showLvDown=function(t){this.numLevel=t,this.level.source="laddergradnum_"+this.numLevel},e.prototype.rankChangeCallback=function(){this.danImg.source="ladder_rank_"+this.numRank;var t=egret.Tween.get(this.danImg);this.danImg.alpha=0,t.to({alpha:1},700)},e}(BasePanel);__reflect(LadderStarListPanel.prototype,"LadderStarListPanel");var LadderView=function(t){function e(){var e=t.call(this)||this;return e.skinName="LadderViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.help,this.onTap),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.tab,this.selectIndexChange),this.addEventChanging(this.tab,this.checkIsBack),this.addEventTouchTap(this.closeBtn,this.onTap),this.addCustomEvent(618,this.updateMineRedPoint),this.addCustomEvent(626,this.refushredPoint),this.addCustomEvent(630,this.refushredPoint);var i=t[0]?t[0]:0;this.tab.selectedIndex=i,this.viewStack.selectedIndex=i,this.selectIndexChange(),this.refushredPoint(),crazybtplayCopyControl.isOpen()||(this.crazybtplayForbiddenPanel&&this.crazybtplayForbiddenPanel.parent&&this.crazybtplayForbiddenPanel.parent.removeChild(this.crazybtplayForbiddenPanel),this.redPoint5&&this.redPoint5.parent&&this.redPoint5.parent.removeChild(this.redPoint5))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.help,this.onTap),this.removeEventChanging(this.tab,this.onTabTouching),this.removeEventChange(this.tab,this.selectIndexChange),this.removeEventChanging(this.tab,this.checkIsBack),this.removeEventTouchTap(this.closeBtn,this.onTap)},e.prototype.selectIndexChange=function(t){switch(void 0===t&&(t=null),this.tab.selectedIndex){case 0:this.confrontPlayerInfoPanel.open();break;case 1:this.ladderInfoPanel.open();break;case 2:this.minePanel.open();break;case 3:this.playWayPanel.open();break;case 4:this.crazybtplayForbiddenPanel.open()}this.title.source="biaoti_jingji"+this.tab.selectedIndex},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.refushredPoint=function(){this.redPoint1.visible=!!confrontControl.isHasRed(),this.redPoint2.visible=ladderControl.isCanReward||ladderControl.isOpen?ladderControl.challgeNum>0:!1,this.redPoint3.visible=MineRedPoint.ins().redPoint,this.redPoint4.visible=PlayWayRedPoint.ins().redPoint,this.redPoint5.visible=!!CrazybtplayCopyRedPoint.ins().redPoint},e.prototype.updateMineRedPoint=function(){this.redPoint3.visible=MineRedPoint.ins().redPoint},e.prototype.onTap=function(t){switch(t.currentTarget){case this.help:0==this.tab.selectedIndex?HelpControl.openHelpWin(10):1==this.tab.selectedIndex?HelpControl.openHelpWin(4):2==this.tab.selectedIndex?HelpControl.openHelpWin(14):4==this.tab.selectedIndex&&HelpControl.openHelpWin(57);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.checkIsBack=function(t){var i=t.target;e.openCheck([i.selectedIndex])?UIMgr.ins().close(LimitTaskView):(t.$cancelable=!0,t.preventDefault())},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!crossArenaControl.checkIsMatching())return!1;var i=t[0]?t[0]:0;if(0==i){var n=DataCenter.ins().SkirmishBaseConfig.openLevel,o=copyControl.guanqiaID>=n;return o||tipsControl.showTips(LangMgr.getValueByKey("ladderTips17",n)),o}if(1==i){var n=DataCenter.ins().LadderInfoConstConfig.openLevel,o=ActorControl.level>=n;return o||tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",n)),o}if(2==i){var o=mineControl.openCheck(!0);return o}if(3==i){var o=!0;return o}if(4==i){var o=crazybtplayCopyControl.isOpen(!0);return o}},e}(BaseEuiView);__reflect(LadderView.prototype,"LadderView");var LadderRankItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="LadderRankItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;t.pos<=3?(this.rankImg.source="paihang"+t.pos,this.rank.text=""):(this.rank.text=t.pos+"",this.rankImg.source=""),this.nameLabel.text=t.player,this.winNum.text=LangMgr.getValueByKey("ladderC",t.winNum),this.dwImg.source="ladder_rank_"+t.challgeLevel;var e=ladderControl.getLevelConfig(t.challgeLevel,t.challgeId);e&&e.showDan>0?(this.level.source="laddergradnum_"+e.showDan,this.levelBg.visible=!0):(this.level.source=null,this.levelBg.visible=!1)},e}(BaseItemRender);__reflect(LadderRankItemRenderer.prototype,"LadderRankItemRenderer");var LadderRewardItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.index=this.itemIndex+1,this.index<=3?(this.rankImg.source="paihang"+this.index,this.rank.text=""):(this.rank.text=this.index+"",this.rankImg.source=""),this.data instanceof RankDataLadderVo){var t=this.data;this.danImg.source="ladder_rank_"+t.challgeLevel,this.nameLabel.text=t.player,this.winNum.text=LangMgr.getValueByKey("ladderC",t.winNum),this.head.source="head_"+t.job+t.sex;var e=ladderControl.getLevelConfig(t.challgeLevel,t.challgeId);this.item1.data=ladderControl.creatRewardData(DataCenter.ins().LadderInfoRankAwardConfig[this.index+""].award[0]),this.level.text=e.showDan+"",this.setlevelInfo(t.challgeLevel<4)}else if(this.data){var i=this.data;this.winNum.text="",this.nameLabel.text=i.showLevel+LangMgr.getValueByKey("loadderDan"),this.item1.data=ladderControl.creatRewardData(i.danAward[0]),this.danImg.source="ladder_rank_"+i.level,this.level.text=i.showDan+"",this.setlevelInfo(!1),this.rankImg.source="",this.rank.text=""}else this.winNum.text="",this.nameLabel.text=LangMgr.getValueByKey("ladderTips18",this.index),this.item1.data=ladderControl.creatRewardData(DataCenter.ins().LadderInfoRankAwardConfig[this.index+""].award[0]),this.danImg.source="ladder_rank_4",this.setlevelInfo(!1)},e.prototype.setlevelInfo=function(t){this.levelBg.visible=this.level.visible=t},e}(BaseItemRender);__reflect(LadderRewardItemRenderer.prototype,"LadderRewardItemRenderer");var LadderStarItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemRender);__reflect(LadderStarItemRenderer.prototype,"LadderStarItemRenderer");var MagicCircleControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.taskID=0,e.taskProgress=0,e.taskState=-1,e.lastState=0,e.taskCD=0,e.fistLogin=!0,e.curLayerId=1,e.layerData=[1,0,0],e.isAllPass=!1,e.isFrist=!0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.downRoleDatas=function(t){if(t){this.roleCirData||(this.roleCirData=[]),this.roleCirData.length=t.length;for(var e=0;e<t.length;e++){var i=this.roleCirData[e];i||(i=new MagicCircleRoleVo,this.roleCirData[e]=i),i.init(t[e])}}EventMgr.ins().dispatch(53)},e.prototype.downTask=function(t,e,n,o){if(this.taskID=t,this.taskProgress=e,this.lastState=this.taskState,this.taskState=n,this.taskCD=o,-1!=this.lastState&&this.lastState!=i.STATE_CAN_GET&&this.taskState==i.STATE_CAN_GET&&this.checkReward(),-1!=this.lastState&&this.lastState!=i.STATE_COMPLETE&&magicCircleControl.checkActived()){var s=DataCenter.ins().MagicCirBaseConfig[1];CommonFun.show(0,s.dcName,s.activatedImg)}if(TimerMgr.ins().remove(this.onCDChange,this),this.taskState==i.STATE_GOT&&magicCircleControl.taskCD>0){var r=magicCircleControl.getCDTime();r>0&&TimerMgr.ins().doTimer(1e3*r,1,this.onCDChange,this)}this.checkLastTask(),EventMgr.ins().dispatch(54)},e.prototype.onCDChange=function(){EventMgr.ins().dispatch(54)},e.prototype.upTaskEvent=function(){},e.prototype.upLevelUp=function(t,e){return[t,e]},e.prototype.downLevelUp=function(t,e,i,n,o){var s=magicCircleControl.getRoleDataByIndex(t),r=s.getDataByID(e);r.level=i,r.exp=n,r.potentionMaxTimes=o,EventMgr.ins().dispatch(55)},e.prototype.upActive=function(t,e){return[t,e]},e.prototype.upSpecialUp=function(t,e){return[t,e]},e.prototype.downSpecialUp=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=magicCircleControl.getRoleDataByIndex(t),o=e[0],s=n.getDataByID(o)||new MagicCircleVo;if(s)s.init(e);else{s=new MagicCircleVo,s.init(e),n.addData(o,s);var r=DataCenter.ins().MagicCirBaseConfig[o];CommonFun.show(0,r.dcName,r.activatedImg)}EventMgr.ins().dispatch(56)},e.prototype.upShowChange=function(t,e){return[t,e]},e.prototype.downShowChange=function(t,e){var i=magicCircleControl.getRoleDataByIndex(t);i.showID=e;var n=heroControl.getSubRoleByIndex(t);n&&(n.deCirShowID=e),EventMgr.ins().dispatch(57)},e.prototype.upTalentUp=function(t,e){return[t,e]},e.prototype.downTalentUp=function(t,e,i){var n=magicCircleControl.getRoleDataByIndex(t),o=n.getDataByID(e);o.talentLv=i,EventMgr.ins().dispatch(58)},e.prototype.getRoleDataByIndex=function(t){if(!this.roleCirData||!this.roleCirData.length)return null;for(var e=this.roleCirData.length,i=0;e>i;i++){var n=this.roleCirData[i];if(n.roleIndex==t)return n}return null},e.prototype.checkOpen=function(){return reincarnateControl.lv<DataCenter.ins().MagicCirConfig.openzhuanshenglv||GameServer.serverOpenDay<DataCenter.ins().MagicCirConfig.openserverday-1?!1:!0},e.prototype.checkActived=function(){var t=Object.keys(DataCenter.ins().MagicCirTaskConfig).length,e=DataCenter.ins().MagicCirTaskConfig[t];return this.taskID<e.taskIdx?!1:this.taskState==i.STATE_COMPLETE?!0:!1},e.prototype.getCDTime=function(){return Math.floor((DateUtils.formatMiniDateTime(this.taskCD)-GameServer.serverTime)/1e3)},e.prototype.upEnterFb=function(){},e.prototype.downDunInfo=function(t){this.isAllPass=!1,this.curLayerId=t,this.layerData=[];var e=CommonUtils.arraySort(CommonUtils.objectToArrayShallow(DataCenter.ins().MagicCirFbConfig),"id");if(this.curLayerId>e[e.length-1].id&&(this.isAllPass=!0,this.curLayerId=e[e.length-1].id),this.isAllPass)for(var i=0;i<e.length;i++)this.layerData.push(2);else for(var i=0;i<e.length;i++)e[i].id==this.curLayerId?this.layerData.push(1):this.curLayerId>e[i].id?this.layerData.push(2):this.layerData.push(0);EventMgr.ins().dispatch(59)},e.prototype.isLastLayer=function(){return this.isAllPass},e.prototype.checkDun=function(){if(!this.getCanSee()||reincarnateControl.lv<DataCenter.ins().MagicCirConfig.openzhuanshenglv)return!1;var t=DataCenter.ins().MagicCirFbConfig,e=0;for(var i in t)parseInt(i)>=this.curLayerId&&(e+=t[i].itemCount);var n=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MagicCirConfig.enterItemId);return this.isFrist&&!this.isAllPass&&n>=e?!0:!1},e.prototype.getCanSee=function(){return GameServer.serverOpenDay+1>=DataCenter.ins().MagicCirConfig.fbopenserverday},e.prototype.checkLastTask=function(){if(this.taskState==i.STATE_CAN_GET&&this.taskID>=Object.keys(DataCenter.ins().MagicCirTaskConfig).length){var t=DataCenter.ins().MagicCirTaskConfig[this.taskID];this.taskProgress==t.target&&UIMgr.ins().open(MagicCircleTaskTriggerView)}},e.prototype.getAddPerBySysID=function(t,e){var i=0,n=heroControl.subRolesLen;if(e>=n)return i;var o=magicCircleControl.getRoleDataByIndex(e);if(!o)return i;for(var s=o.demonCirDatas?o.demonCirDatas.length:0,r=0;s>r;r++){var a=o.demonCirDatas[r];if(a&&a.talentLv>0){var l=DataCenter.ins().MagicCirTalentConfig[DataCenter.ins().MagicCirBaseConfig[a.id].talent][a.talentLv];l.sysAttr&&l.sysAttr.type==t&&(i+=l.sysAttr.value)}}return i},e.prototype.getAttrsBySysID=function(t,e,i){if(!t||!t.length)return t;var n=magicCircleControl.getAddPerBySysID(e,i);if(!n)return t;for(var o,s=[],r=0;r<t.length;r++)o=t[r],s.push(new AttributeData(o.type,Math.floor(o.value*n/1e3)));return s=s.concat(t),AttributeData.combineAtts(s)},e.prototype.checkReward=function(){UIMgr.ins().open(MagicCircleTaskRewardView,{itemID:DataCenter.ins().MagicCirTaskConfig[magicCircleControl.taskID].itemId,des:LangMgr.getValueByKey("boxConGet","")})},e.prototype.checkRed=function(){if(!magicCircleControl.checkOpen())return!1;if(this.checkTaskRed())return!0;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(magicCircleControl.checkRedByIndex(e))return!0;return!1},e.prototype.checkTaskRed=function(){return 0!=magicCircleControl.taskID&&magicCircleControl.taskState==i.STATE_CAN_GET?!0:magicCircleControl.taskState==i.STATE_GOT&&magicCircleControl.taskCD>0&&magicCircleControl.getCDTime()<=0?!0:!1},e.prototype.checkRedByIndex=function(t){var e=magicCircleControl.getRoleDataByIndex(t);if(!e)return!1;for(var i,n=Object.keys(DataCenter.ins().MagicCirBaseConfig).length,o=0;n>o;o++){if(i=DataCenter.ins().MagicCirBaseConfig[o+1],this.checkCirMainRed(t,i.id))return!0;if(this.checkPotentionRed(t,i.id))return!0}return!1},e.prototype.checkPotentionRed=function(t,e){var i=magicCircleControl.getRoleDataByIndex(t);if(!i)return!1;var n=i.getDataByID(e);if(!n||n.potentionTimes>=n.potentionMaxTimes)return!1;if(this.fistLogin)return!0;if(n.specialVals&&n.specialVals.length){var o=magicCircleControl.getPotentionCostCfg(e,n.potentionTimes),s=backpackControl.getBagItemById(o.cost.id);if(s&&Math.floor(s.count/o.cost.count)>=DataCenter.ins().MagicCirConfig.skillCautionCount)return!0;if(n.potentionTimes<10&&ActorControl.yb>=o.cost.count*o.cost.price)return!0}return!1},e.prototype.checkCirLvRed=function(t,e){var i=magicCircleControl.getRoleDataByIndex(t);if(!i)return!1;var n=DataCenter.ins().MagicCirBaseConfig[e],o=i.getDataByID(n.id);if(o){if(o.level<Object.keys(DataCenter.ins().MagicCirLvConfig[n.id]).length){var s=DataCenter.ins().MagicCirLvConfig[e][o.level],r=backpackControl.getBagItemById(DataCenter.ins().MagicCirConfig.expItemId),a=r?r.count:0;if(a>=s.count&&DataCenter.ins().MagicCirConfig.expPerItem*a>=DataCenter.ins().MagicCirLvConfig[n.id][o.level].exp-o.exp&&o.talentLv>=s.talentLimit)return!0}}else{var r=backpackControl.getBagItemById(n.mat);if(r&&r.count>=n.matCost)return!0}return!1},e.prototype.checkCirTalentRed=function(t,e){var i=magicCircleControl.getRoleDataByIndex(t);if(!i)return!1;var n=DataCenter.ins().MagicCirBaseConfig[e],o=i.getDataByID(n.id);if(o&&o.talentLv>0&&o.talentLv<Object.keys(DataCenter.ins().MagicCirTalentConfig[n.talent]).length){var s=DataCenter.ins().MagicCirTalentConfig[n.talent][o.talentLv+1],r=backpackControl.getBagItemById(n.mat);if(r&&r.count>=s.costCount)return!0}return!1},e.prototype.checkCirMainRed=function(t,e){return this.checkCirLvRed(t,e)?!0:this.checkCirTalentRed(t,e)?!0:!1},e.prototype.getPotentionCostCfg=function(t,e){for(var i,n=DataCenter.ins().MagicCirSkillCostConfig[t],o=Object.keys(n).length,s=1;o>=s;s++)if(i=n[s],e<i.countLimit)return i;return n[o]},e.prototype.getPotentionTimes=function(){if(!this.roleCirData||!this.roleCirData.length)return 0;for(var t=this.roleCirData.length,e=0,i=0;t>i;i++){var n=this.roleCirData[i];if(n.demonCirDatas&&n.demonCirDatas.length)for(var o=n.demonCirDatas.length,s=0;o>s;s++){var r=n.demonCirDatas[s];r&&(e+=r.potentionTimes)}}return e},e.STATE_TASK=0,e.STATE_CAN_GET=1,e.STATE_GOT=2,e.STATE_COMPLETE=3,__decorate([down(1,[ByteConst.MagicCircleRoleVos])],e.prototype,"downRoleDatas",null),__decorate([down(2,[1,1,1,3])],e.prototype,"downTask",null),__decorate([up(3)],e.prototype,"upTaskEvent",null),__decorate([up(4,[1,1])],e.prototype,"upLevelUp",null),__decorate([down(4,[1,1,3,3,3])],e.prototype,"downLevelUp",null),__decorate([up(5,[1,1])],e.prototype,"upActive",null),__decorate([up(6,[1,1])],e.prototype,"upSpecialUp",null),__decorate([down(5,[1].concat(ByteConst.MagicCircleVos))],e.prototype,"downSpecialUp",null),__decorate([up(7,[1,1])],e.prototype,"upShowChange",null),__decorate([down(7,[1,1])],e.prototype,"downShowChange",null),__decorate([up(8,[1,1])],e.prototype,"upTalentUp",null),__decorate([down(8,[1,1,1])],e.prototype,"downTalentUp",null),__decorate([up(13)],e.prototype,"upEnterFb",null),__decorate([down(13,[3])],e.prototype,"downDunInfo",null),e=i=__decorate([protocolsId(52)],e);var i}(BaseSystem);__reflect(MagicCircleControl.prototype,"MagicCircleControl");var WeaponSoulShowPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="WeaponSoulShowPanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(140,this.callback),this.roleId=0,this.weaponId=0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.releaseEvent(),this.removeCustomEvents()},e.prototype.releaseEvent=function(){if(this.currentState){DisplayUtils.removeFromParent(this.mc),this.mc=null,DisplayUtils.removeFromParent(this.masksp),this.masksp=null;for(var t=0;t<Number(this.currentState);t++)this.removeEventTouchTap(this["item"+t],this.onClick)}},e.prototype.init=function(t,e){var i=t?t:this.weaponId,n=isNaN(e)?this.roleId:e;this.weaponId=i,this.roleId=n;var o=DataCenter.ins().WeaponSoulConfig[i];if(o){var s=o.actcond.length;this.releaseEvent();var r=heroControl.getSubRoleByIndex(n);this.currentState=s+"";for(var a=r.weapons.getWeapsInfoBySoulId(o.id),l=0,h=0;h<o.actcond.length;h++)if(this.addEventTouchTap(this["item"+h],this.onClick),a.id)l++,this["lianjiexian"+h]&&this.setLight(this["lianjiexian"+h]),this["item"+h]&&(this["item"+h].data=r.weapons.getSlotByInfo(o.actcond[h]));else{var u=r.weapons.getSlotByInfo(o.actcond[h]);u?(l++,this["lianjiexian"+h]&&this.setLight(this["lianjiexian"+h]),this["item"+h]&&(this["item"+h].data=r.weapons.getSlotByInfo(o.actcond[h]))):(this["lianjiexian"+h]&&this.setGray(this["lianjiexian"+h]),this["item"+h]&&(this["item"+h].data=DataCenter.ins().WeaponSoulPosConfig[o.actcond[h]][0]))}this.setEff(l,o.actcond.length,o,r)}},e.prototype.setEff=function(t,e,i,n){if(i){var o=i.inside[n.job-1];this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.effgroup.addChild(this.mc),this.mc.playFile(PATH_EFF+o,-1),this.mc.x=this.effpos.x,this.mc.y=this.effpos.y,this.mc.rotation=this.effpos.rotation}},e.prototype.setWeaponsModel=function(){this.weaponImg.source="";var t=heroControl.getSubRoleByIndex(this.roleId),e=t.getEquipByIndex(0),i=e.item.configID;if(i>0){var n=DataCenter.ins().EquipConfig[i].appearance;n&&n.indexOf("[job]")>-1&&(n=n.replace("[job]",t.job+"")),this.weaponImg.source=n+"_"+t.sex+"_c_png"}},e.prototype.onClick=function(t){for(var e=0;e<Number(this.currentState);e++)if(t.currentTarget==this["item"+e]){var i=this["item"+e].slot,n=heroControl.getSubRoleByIndex(this.roleId),o=n.weapons.getSlotByInfo(i);o&&o.level?o.assault?UIMgr.ins().open(WeaponSoulBreakView,WeaponSoulBreakView.TUPO,n.index,i):UIMgr.ins().open(WeaponSoulBreakView,WeaponSoulBreakView.SHENGJI,n.index,i):UIMgr.ins().open(WeaponSoulBreakView,WeaponSoulBreakView.JIHUO,n.index,i);break}},e.prototype.getJobSkinName=function(t){switch(t){case 1:return"zhan";case 2:return"fa";case 3:return"dao"}return""},e.prototype.callback=function(){this.init()},e.prototype.setGray=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];t.filters=[new egret.ColorMatrixFilter(e)]},e.prototype.setLight=function(t){t.filters=[]},e.prototype.cleanFilters=function(t,e){this["zhan"+t+e].filters=[],this["fa"+t+e].filters=[],this["dao"+t+e].filters=[]},e}(BasePanel);__reflect(WeaponSoulShowPanel.prototype,"WeaponSoulShowPanel");var MagicCircleRoleVo=function(){function t(){}return t.prototype.init=function(t){this.roleIndex=t[0],this.demonCirDatas||(this.demonCirDatas=[]);for(var e=0;e<t[1].length;e++){var i=t[1][e][0],n=this.demonCirDatas[i];n||(n=new MagicCircleVo,this.demonCirDatas[i]=n),n.init(t[1][e])}this.showID=t[2]},t.prototype.getDataByID=function(t){return this.demonCirDatas&&this.demonCirDatas.length?this.demonCirDatas[t]:null},t.prototype.addData=function(t,e){this.demonCirDatas&&(this.demonCirDatas[t]=e)},t}();__reflect(MagicCircleRoleVo.prototype,"MagicCircleRoleVo");var WeaponSoulPanel=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e}return __extends(e,t),e.prototype.closeSoulCondition=function(t){this.normal.visible=t,this.soul.visible=!t},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.leftbtn,this.onEvent),this.removeEventTouchTap(this.rightbtn,this.onEvent),this.removeEventTouchTap(this.active,this.onEvent),this.removeEventTouchTap(this.turnBtn,this.onEvent),this.removeEventTouchTap(this.backBtn,this.onEvent),this.removeEventTouchTap(this.leftbtn0,this.onEvent),this.removeEventTouchTap(this.rightbtn0,this.onEvent),this.removeEventTouchTap(this.list1,this.onClick),this.removeEventItemTap(this.list0,this.onSoulClick),this.removeCustomEvents(),UIMgr.ins().getView(IntensifyView).isNotMove=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().getView(IntensifyView).isNotMove=!0,this.roleId=t[0],this.addEventTouchTap(this.leftbtn,this.onEvent),this.addEventTouchTap(this.rightbtn,this.onEvent),this.addEventTouchTap(this.active,this.onEvent),this.addEventTouchTap(this.turnBtn,this.onEvent),this.addEventTouchTap(this.backBtn,this.onEvent),this.addEventTouchTap(this.leftbtn0,this.onEvent),this.addEventTouchTap(this.rightbtn0,this.onEvent),this.addEventTouchTap(this.list1,this.onClick),this.addEventChangeEnd(this.list1Scroll,this.onChange),this.addEventChangeEnd(this.list0Scroll,this.onChangeFlex),this.addEventItemTap(this.list0,this.onSoulClick),this.addCustomEvent(141,this.callback),this.addCustomEvent(142,this.callback),this.addCustomEvent(140,this.callback),this.addCustomEvent(143,this.callback),this.addCustomEvent(144,this.callback),this.list1.itemRenderer=WeaponSoulListItemRender,this.list0.itemRenderer=WeaponSoulListItemRender,this.leftbtn.parent.touchEnabled=!1,this.weaponId=1,this.weaponFlexible=0,this.closeSoulCondition(t[1]),this.updateBtn(),this.init(this.weaponId)
},e.prototype.updateBtn=function(){this.turnBtn.visible=!0},e.prototype.init=function(t){this.soulArr=[],this.listdata=[],this.dataArr=new eui.ArrayCollection(this.listdata);var e=heroControl.getSubRoleByIndex(this.roleId);for(var i in DataCenter.ins().WeaponSoulConfig){var n=DataCenter.ins().WeaponSoulConfig[i],o=e.weapons.getSoulInfoData()[n.id],s=e.weapons.getSuitConfig(n.id),r={isuse:e.weapons.weaponsId==n.id?!0:!1,id:o&&o.id&&s?s.id:0,isRedPoint:e.weapons.getRedPointBySuit(n.id),level:o&&o.id&&s?s.level:0,isSelect:i==t.toString()?!0:!1,showId:n.id,job:e.job};this.listdata.push(r),o&&o.id&&s&&this.soulArr.push(r)}this.updateUI(),this.list1.dataProvider=this.dataArr,this.list1.scrollH=0,this.onChange(),this.updateSoul(this.soulArr,!0),this.updateRedPoint(),this.onChangeFlex()},e.prototype.setSelectId=function(t){for(var e=0;e<this.listdata.length;e++){var i=this.listdata[e];i.isSelect=e==t?!0:!1}this.dataArr.replaceAll(this.listdata),this.list1.dataProvider=this.dataArr},e.prototype.onSoulClick=function(t){if(t&&t.itemRenderer&&t.item){var e=t.item,i=heroControl.getSubRoleByIndex(this.roleId),n=i.weapons.getFlexibleData(),o=i.weapons.getSuitConfig(e.id);if(o){var s="";e.isuse?(s="|C:"+LangMgr.getColor("qualityColor5")+"&T:",this.active.visible=!0):this.active.visible=i.weapons.flexibleCount<=n.length?!1:!0,this.weaponFlexible=o.id,this.skillicon0.data={icon:o.skillicon},this.skill.textFlow=TextUtils.generateTextFlow1(s+o.skilldesc),this.skillname0.textFlow=TextUtils.generateTextFlow1(o.skillname)}else this.weaponFlexible=0;e.isuse?(this.active.label=LangMgr.getValueByKey("cancel2"),this.redPoint.visible=!1):(this.active.label=LangMgr.getValueByKey("equiActive"),this.redPoint.visible=i.weapons.flexibleCount<=n.length?!1:!0)}},e.prototype.onClick=function(t){var e=t.currentTarget.selectedIndex;e=e>0?e:0,this.listdata[e]&&(this.weaponId=this.listdata[e].showId,this.setSelectId(e),UIMgr.ins().open(WeaponSoulFacadePanel,this.roleId,this.weaponId)),this.onChange()},e.prototype.onChange=function(){this.list1.scrollH<150?(this.leftbtn.visible=!1,this.rightbtn.visible=!0):this.list1.scrollH>=150*(this.list1.dataProvider.length-3)?(this.leftbtn.visible=!0,this.rightbtn.visible=!1):(this.leftbtn.visible=!0,this.rightbtn.visible=!0)},e.prototype.onChangeFlex=function(){if(this.nothingTips.visible)return this.leftbtn0.visible=!1,void(this.rightbtn0.visible=!1);var t=heroControl.getSubRoleByIndex(this.roleId);return t&&this.soulArr.length<=3?(this.leftbtn0.visible=!1,void(this.rightbtn0.visible=!1)):void(this.list0.scrollH<150?(this.leftbtn0.visible=!1,this.rightbtn0.visible=!0):this.list0.scrollH>=150*(this.list0.dataProvider.length-3)?(this.leftbtn0.visible=!0,this.rightbtn0.visible=!1):(this.leftbtn0.visible=!0,this.rightbtn0.visible=!0))},e.prototype.onEvent=function(t){var e=450;switch(t.currentTarget){case this.leftbtn:this.list1.scrollH<=e?this.list1.scrollH=0:this.list1.scrollH-=e;break;case this.rightbtn:this.list1.scrollH>=150*(this.list1.dataProvider.length-3)?this.list1.scrollH=150*(this.list1.dataProvider.length-3):this.list1.scrollH+=e;break;case this.leftbtn0:this.list0.scrollH<=e?this.list0.scrollH=0:this.list0.scrollH-=e;break;case this.rightbtn0:this.list0.scrollH>=150*(this.list0.dataProvider.length-3)?this.list0.scrollH=150*(this.list0.dataProvider.length-3):this.list0.scrollH+=e;break;case this.active:if(this.active.label==LangMgr.getValueByKey("equiActive")){var i=heroControl.getSubRoleByIndex(this.roleId),n=i.weapons.getFlexibleData();if(i.weapons.flexibleCount<=n.length)return void tipsControl.showCenterTips(LangMgr.getValueByKey("warnTips23",i.weapons.flexibleCount));if(!this.weaponFlexible)return void tipsControl.showCenterTips(LangMgr.getValueByKey("warnTips24"));this.isSendActFlex=!0,this.weaponId=this.weaponFlexible,weaponsSoulControl.upWeaponsFlexibleAct(this.roleId,0,this.weaponFlexible)}else if(this.active.label==LangMgr.getValueByKey("cancel2")){if(!this.weaponFlexible)return void tipsControl.showCenterTips(LangMgr.getValueByKey("warnTips24"));this.isSendActFlex=!0,this.weaponId=this.weaponFlexible,weaponsSoulControl.upWeaponsFlexibleAct(this.roleId,1,this.weaponFlexible)}break;case this.turnBtn:this.close(),this.open(this.roleId,!1);var o=UIMgr.ins().getView(IntensifyView);o&&o.redPointEx();var s=backpackControl.getBagItemById(DataCenter.ins().WeaponSoulBaseConfig.itemid),r=heroControl.getSubRoleByIndex(this.roleId);s&&r.weapons.flexibleCount-1<DataCenter.ins().WeaponSoulBaseConfig.maxItemNum&&UIMgr.ins().open(RoleChangeItemView,this.roleId);break;case this.backBtn:if(!backpackControl.getBagItemById(DataCenter.ins().WeaponSoulBaseConfig.itemid))return void tipsControl.showTips(LangMgr.getValueByKey("warnTips25"));UIMgr.ins().open(RoleChangeItemView,this.roleId)}this.onChange(),this.onChangeFlex()},e.prototype.updateUI=function(){var t=heroControl.getSubRoleByIndex(this.roleId);this.powerPanel.setPower(t.getWeaponTotalPower());var e=[4,2,6,5],i=[0,0,0,0],n=!1,o=t.weapons.getInfoData();for(var s in o){var r=o[s];for(var a in r)for(var l=r[a],h=0;h<l.attr.length;h++){var u=l.attr[h];if(-1!=e.indexOf(u.type))for(var p=0;p<e.length;p++)e[p]==u.type&&(i[p]+=u.value,n=!0)}}var c=t.weapons.flexibleCount?t.weapons.flexibleCount-1:0,d=DataCenter.ins().WeaponSoulItemAttrConfig[c];if(n&&d)for(var g=0;g<d.attr.length;g++)if(-1!=e.indexOf(d.attr[g].type))for(var p=0;p<e.length;p++)e[p]==d.attr[g].type&&(i[p]+=d.attr[g].value);for(var g=0;4>g;g++)if(this["attr"+g]){var m=AttributeData.getAttrStrByType(e[g]);this["attr"+g].text=m+"+"+i[g]}},e.prototype.callback=function(){this.soulArr=[];var t=heroControl.getSubRoleByIndex(this.roleId),e=t.weapons.getSuitConfig(this.weaponId);for(var i in this.listdata){var n=t.weapons.getSoulInfoData()[this.listdata[i].showId],o=this.listdata[i];o.showId==this.weaponId?(o.isuse=t.weapons.weaponsId==this.weaponId?!0:!1,o.id=n&&n.id&&e?e.id:0,o.isRedPoint=t.weapons.getRedPointBySuit(o.showId),o.level=n&&n.id&&e?e.level:0,o.isSelect=!0,o.showId=o.showId):(o.isRedPoint=t.weapons.getRedPointBySuit(o.showId),o.isSelect=!1,o.isuse=o.showId==t.weapons.weaponsId),n&&n.id&&e&&this.soulArr.push(o)}this.updateUI(),this.dataArr.replaceAll(this.listdata),this.list1.dataProvider=this.dataArr,this.updateSoul(this.soulArr),this.updateActLabel(),this.updateRedPoint()},e.prototype.updateSoul=function(t,e){var i=heroControl.getSubRoleByIndex(this.roleId);if(this.soulArr=[],i.weapons.flexibleCount)for(var n=0;n<t.length;n++){var o={isuse:weaponsSoulControl.checkIsUseFlexible(i.index,t[n].id),id:t[n].id,isRedPoint:IntensifyRedPoint.ins().getFlexibleRedPointOnly(i.index,t[n].showId),level:t[n].level,isSelect:t[n].isSelect,showId:t[n].showId,job:t[n].job};this.soulArr.push(o)}this.list0.dataProvider=new eui.ArrayCollection(this.soulArr);var s=i.weapons.flexibleCount?i.weapons.flexibleCount-1:0;if(this.desc.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("warnTips26",s,s+1)),e){if(this.soulArr.length>0&&i.weapons.flexibleCount){this.active.visible=this.skillicon0.visible=this.skill.visible=this.skillname0.visible=!0;var r=i.weapons.getSuitConfig(this.soulArr[0].id);if(r){var a="";this.soulArr[0].isuse&&(a="|C:"+LangMgr.getColor("qualityColor5")+"&T:"),this.skillicon0.data={icon:r.skillicon},this.skill.textFlow=TextUtils.generateTextFlow1(a+r.skilldesc),this.skillname0.textFlow=TextUtils.generateTextFlow1(r.skillname)}if(this.leftbtn0.visible=this.rightbtn0.visible=!1,this.soulArr.length>3&&(this.rightbtn0.visible=!0),this.soulArr[0].isuse)this.active.label=LangMgr.getValueByKey("cancel2"),this.redPoint.visible=!1;else{this.active.label=LangMgr.getValueByKey("equiActive");var l=i.weapons.getFlexibleData();this.active.visible=this.redPoint.visible=i.weapons.flexibleCount<=l.length?!1:!0}this.weaponFlexible=this.soulArr[0].showId}else this.redPoint.visible=!1,this.leftbtn0.visible=this.rightbtn0.visible=!1,this.active.visible=this.skillicon0.visible=this.skill.visible=this.skillname0.visible=!1;this.nothingTips.visible=!this.skillicon0.visible,this.nothingTips.visible&&(i.weapons.flexibleCount?this.nothingTips.text=LangMgr.getValueByKey("warnTips28"):this.nothingTips.text=LangMgr.getValueByKey("warnTips27"))}},e.prototype.updateActLabel=function(){if(!this.isSendActFlex)return void(this.isSendActFlex=!1);var t=heroControl.getSubRoleByIndex(this.roleId),e=t.weapons.getFlexibleData();this.isSendActFlex=!1;var i=this.skill.text;this.active.label==LangMgr.getValueByKey("equiActive")?(this.active.label=LangMgr.getValueByKey("cancel2"),this.redPoint.visible=!1,this.skill.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("qualityColor5")+"&T:"+i)):this.active.label==LangMgr.getValueByKey("cancel2")&&(this.active.label=LangMgr.getValueByKey("equiActive"),this.active.visible=this.redPoint.visible=t.weapons.flexibleCount<=e.length?!1:!0,this.skill.textFlow=TextUtils.generateTextFlow1("|C:"+LangMgr.getColor("color88")+"&T:"+i))},e.prototype.isShowSoul=function(){return this.soul?this.soul.visible:!1},e.prototype.updateRedPoint=function(){var t=backpackControl.getBagItemById(DataCenter.ins().WeaponSoulBaseConfig.itemid),e=heroControl.getSubRoleByIndex(this.roleId);this.redPoint0.visible=IntensifyRedPoint.ins().getFlexibleRedPoint(this.roleId)||t&&e.weapons.flexibleCount-1<DataCenter.ins().WeaponSoulBaseConfig.maxItemNum?!0:!1,this.backBtn.visible=this.redPoint1.visible=t&&e.weapons.flexibleCount-1<DataCenter.ins().WeaponSoulBaseConfig.maxItemNum?!0:!1},e}(BaseEuiView);__reflect(WeaponSoulPanel.prototype,"WeaponSoulPanel");var MagicCircleVo=function(){function t(){}return t.prototype.init=function(t){this.id=t[0],this.level=t[1],this.exp=t[2],this.talentLv=t[3];var e=this.specialVals;this.specialVals=[];for(var i=0;t[4].length>i;i++){for(var n=[],o=0;t[4][i].length>o;o++)n.push({type:t[4][i][o][0],param:t[4][i][o][1],value:t[4][i][o][2]});if(this.specialVals.push(n),e&&e.length&&-1==e[i][0].value&&-1!=n[0].value){var s=DataCenter.ins().MagicCirBaseConfig[this.id];UIMgr.ins().open(MagicCircleSkillActivatedTipsView,DataCenter.ins().MagicCirSkillConfig[s.skillgroup[i]][1])}}this.potentionTimes=t[5],this.potentionMaxTimes=t[6]},t.prototype.getActiveByIndex=function(t){if(!this.specialVals||this.specialVals.length<=t)return!1;var e=this.specialVals[t];if(!e||!e.length)return!1;for(var i=e.length,n=0;i>n;n++)if(-1==e[n].value)return!1;return!0},t}();__reflect(MagicCircleVo.prototype,"MagicCircleVo");var MagicCircleAbilityTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MagicCircleAbilityTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.touchEnabled=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(266,this.updateMaterail),this.addCustomEvent(267,this.updateMaterail),this.addCustomEvent(268,this.updateMaterail),this.addCustomEvent(58,this.update),this.roleId=t[0],this.id=t[1],this.isActived=t[2],this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents(),this.deEff&&(this.deEff.destroy(),this.deEff=null)},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.updateBtn:if(!this.isEnough)return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));magicCircleControl.upTalentUp(this.roleId,this.id);break;case this.getItemTxt:warnControl.setBuyGoodsWarn(DataCenter.ins().MagicCirBaseConfig[this.id].aGainwayId)}},e.prototype.update=function(){var t=DataCenter.ins().MagicCirBaseConfig[this.id];this.nametxt.textFlow=TextUtils.generateTextFlow(t.talentName);var e=0;if(this.isActived){var i=magicCircleControl.getRoleDataByIndex(this.roleId),n=i.getDataByID(this.id);e=n.talentLv,this.costImg.source=DataCenter.ins().ItemConfig[t.mat].icon+"_png"}this.nowDesctxt.textFlow=TextUtils.generateTextFlow(e?DataCenter.ins().MagicCirTalentConfig[t.talent][e].upgradeDesc:"                 "+LangMgr.getValueByKey("commonNoActive")),this.nextTitle.visible=!0,this.nextDesctxt.visible=!0,this.updateBtn.visible=this.isActived,this.redpoint.visible=!1,this.cost.visible=this.isActived,this.lvtxt.textFlow=TextUtils.generateTextFlow("Lv."+e),this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip")),this.deEff.parent||this.demonCirEff.addChild(this.deEff),this.deEff.playFile(""+PATH_EFF+t.winEff,-1),this.isMax=e>=Object.keys(DataCenter.ins().MagicCirTalentConfig[t.talent]).length,this.isMax?(this.nextTitle.visible=!1,this.nextDesctxt.visible=!1,this.updateBtn.visible=!1,this.cost.visible=!1):this.nextDesctxt.textFlow=TextUtils.generateTextFlow(DataCenter.ins().MagicCirTalentConfig[t.talent][e+1].upgradeDesc),this.updateMaterail(),this.abilityImg.source=t.talentImg,this.getItemTxt.visible=!this.isMax},e.prototype.updateMaterail=function(){if(this.isActived&&!this.isMax){var t=DataCenter.ins().MagicCirBaseConfig[this.id],e=magicCircleControl.getRoleDataByIndex(this.roleId),i=e.getDataByID(this.id),n=DataCenter.ins().MagicCirTalentConfig[t.talent][i.talentLv+1];if(n){var o=backpackControl.getBagItemById(t.mat),s=o?o.count:0;this.isEnough=s>=n.costCount,this.costNum.textFlow=TextUtils.generateTextFlow("|C:"+(this.isEnough?LangMgr.getColor("color43"):LangMgr.getColor("color22"))+"&T:"+s+"|/"+n.costCount),this.redpoint.visible=!this.isMax&&this.isEnough,this.updateBtn.enabled=this.isEnough}}},e}(BaseEuiView);__reflect(MagicCircleAbilityTipsView.prototype,"MagicCircleAbilityTipsView");var MagicCircleListPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("demonCir"),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=MagicCircleListItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.role=t[0],this.addCustomEvent(53,this.update),this.addCustomEvent(56,this.update),this.addCustomEvent(55,this.update),this.addCustomEvent(266,this.update),this.addCustomEvent(267,this.update),this.addCustomEvent(268,this.update),this.update()},e.prototype.update=function(){this.collect||(this.collect=new ArrayCollection,this.list.dataProvider=this.collect);for(var t=Object.keys(DataCenter.ins().MagicCirBaseConfig).length,e=[],i=magicCircleControl.getRoleDataByIndex(this.role.index),n=1;t>=n;n++){var o=DataCenter.ins().MagicCirBaseConfig[n],s=i.getDataByID(o.id),r=null!=s,a=null!=s?s.level:0,l=magicCircleControl.checkCirMainRed(this.role.index,o.id)||magicCircleControl.checkPotentionRed(this.role.index,o.id);e.push({cfg:o,showRed:l,level:a,roleIndex:this.role.index,actived:r})}this.collect.source=e},e.prototype.close=function(){this.removeCustomEvents()},e}(BasePanel);__reflect(MagicCircleListPanel.prototype,"MagicCircleListPanel");var MagicCircleMainView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MagicCircleMainViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.roleSelect.setCurRole(this.data.roleIndex),this.setRoleId(this.data.roleIndex),this.addCustomEvent(53,this.updateRed),this.addCustomEvent(56,this.updateRed),this.addCustomEvent(55,this.updateRed),this.addCustomEvent(266,this.updateRed),this.addCustomEvent(267,this.updateRed),this.addCustomEvent(268,this.updateRed),this.addEventTouchTap(this,this.onTouch),this.addEventChange(this.tab,this.onTabTouch),this.addEventChange(this.roleSelect,this.onChange),this.updateRed()},e.prototype.close=function(){this.removeCustomEvents()},e.prototype.onTouch=function(t){t.target==this.closeBtn?UIMgr.ins().close(this):t.target==this.help&&HelpControl.openHelpWin(46)},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole())},e.prototype.setRoleId=function(t){this.data.roleIndex=t,this.setOpenIndex(this.viewStack.selectedIndex),this.updateRed()},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.magicCirclePanel.open(this.data);break;case 1:this.magicCirclePotentialPanel.open(this.data),magicCircleControl.fistLogin&&(magicCircleControl.fistLogin=!1,magicCircleControl.downRoleDatas(null))}this.help.visible=1==t,this.tab.selectedIndex=this.viewStack.selectedIndex},e.prototype.updateRed=function(){var t=this.data.cfg.id;this.redPoint0.visible=magicCircleControl.checkCirMainRed(this.data.roleIndex,t),this.redPoint1.visible=magicCircleControl.checkPotentionRed(this.data.roleIndex,t);for(var e=heroControl.subRolesLen,i=0;e>i;i++)this.roleSelect.showRedPoint(i,magicCircleControl.checkCirMainRed(i,t)||magicCircleControl.checkPotentionRed(i,t))},e}(BaseEuiView);__reflect(MagicCircleMainView.prototype,"MagicCircleMainView");var MagicCirclePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.oldLvl=0,e.kk=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._expBar=new ProgressBarEff,this._expBar.setWidth(520),this.exp.addChild(this._expBar),this._expBar.x=-15,this._expBar.y=-10,this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.touchEnabled=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.role=heroControl.getSubRoleByIndex(this.data.roleIndex),this.addCustomEvent(53,this.update),this.addCustomEvent(56,this.update),this.addCustomEvent(55,this.levelUpBack),this.addCustomEvent(266,this.update),this.addCustomEvent(267,this.update),this.addCustomEvent(268,this.update),this.addCustomEvent(58,this.update),this.addCustomEvent(57,this.updateShow),this.addEventTouchTap(this,this.onTouch),this.oneKey=!1,this.oldLvl=0,this._expBar.reset(),this.update()},e.prototype.close=function(){this.deEff&&(this.deEff.destroy(),this.deEff=null),this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.levelUpBack=function(){this.update(),this.checkOnekey()},e.prototype.update=function(){var t=this.data.cfg,e=magicCircleControl.getRoleDataByIndex(this.role.index),i=e.getDataByID(t.id);this.actived=null!=i,this.getItemTxt.visible=!0,this.dcNameImg.source=t.mainNameImg,this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip")),this.deEff.parent||this.demonCirEff.addChild(this.deEff);var n=""+PATH_EFF+t.winEff;this.deEff.name!=n&&this.deEff.playFile(n,-1),this.upGradeBtn.visible=!0,this.maxDesc.visible=!1,this.nextAttr.visible=!0,this.arrow.visible=!0,this.costGroup.visible=!0,this.nowAttr.left=100;for(var o,s=[],r=t.tezhiAttrC.length,a=0;4>a;a++)if(o=this["skill"+a],r>a){o.visible=!0;var l=0,h=t.tezhiAttrC[a],u=0,p=this.actived;p&&(u=i.level,l=this.getTeZhiLvl(h,u),p=l>0,p&&s.push({id:h,lvl:l})),o.setData({roleId:this.role.index,type:1,id:h,actived:p,param:l}),o.demonID=t.id,o.demonLvl=u}else o.visible=!1;if(this.showBtn.visible=this.actived,this.redPoint.visible=!1,this.actived){var c=i.level>=Object.keys(DataCenter.ins().MagicCirLvConfig[t.id]).length;this.lvCount.text="Lv."+i.level;var d=this.getTotalAttrByLvl(i.level);if(s&&s.length&&(d=d.concat(this.getTZAttrs(s,i.level))),d=AttributeData.combineAtts(d),this.nowAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(d,0,1,"：")),this.powerPanel.setPower(BackpackControl.getAttrPower(d,heroControl.getSubRoleByIndex(this.role.index))),this.expbarBg.visible=this._expBar.visible=!c,c)this.upGradeBtn.visible=!1,this.maxDesc.visible=!0,this.maxDesc.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("maxLevel")),this.nextAttr.visible=!1,this.arrow.visible=!1,this.nowAttr.left=200,this.costGroup.visible=!1,this.oneKey=!1,this.getItemTxt.visible=!1;else{var g=DataCenter.ins().MagicCirLvConfig[t.id][i.level];this.updateMaterail(DataCenter.ins().MagicCirConfig.expItemId,g.count),this.upGradeBtn.label=LangMgr.getValueByKey("demonCirAuto"),d=this.getTotalAttrByLvl(i.level+1),s&&s.length&&(d=d.concat(this.getTZAttrs(s,i.level))),d=AttributeData.combineAtts(d),this.nextAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(d,0,1,"：")),this._expBar.getMaxValue()!=g.exp?this._expBar.setData(i.exp,g.exp):this._expBar.setValue(i.exp),i.talentLv<g.talentLimit&&(this.upGradeBtn.visible=!1,this.maxDesc.visible=!0,this.costGroup.visible=!1,this.maxDesc.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("demonCirTalentTip",g.talentLimit)),this.oneKey=!1,this.getItemTxt.visible=!1)}}else{this.upGradeBtn.label=LangMgr.getValueByKey("equiActive"),this._expBar.visible=!1,this.expbarBg.visible=!1,this.lvCount.text=LangMgr.getValueByKey("commonNoActive");for(var m=[],f=[],g=DataCenter.ins().MagicCirLvConfig[t.id][1],v=void 0,y=g.attrs.length,a=0;y>a;a++)v=g.attrs[a],m.push(new AttributeData(v.type,0)),f.push(new AttributeData(v.type,v.value));this.nowAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(m,0,1,"：")),this.nextAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(f,0,1,"：")),this.powerPanel.setPower(0),this.costGroup.visible=t.matCost>0,this.updateMaterail(t.mat,t.matCost)}this.ability.setData({roleId:this.role.index,type:0,id:t.id,actived:this.actived,param:null}),this.updateShow()},e.prototype.updateShow=function(){if(this.actived){var t=magicCircleControl.getRoleDataByIndex(this.role.index).showID==this.data.cfg.id;this.showBtn.icon=t?"dc_cancelBtn":"dc_showBtn",t&&1==this.data.cfg.id&&(this.showBtn.visible=!1)}},e.prototype.getTeZhiLvl=function(t,e){for(var i,n=DataCenter.ins().MagicCirTeZhiConfig[t],o=Object.keys(n).length,s=1;o>=s;s++){if(i=n[s],e<i.dcMinLv)return i.tezhiLv-1;if(e>=i.dcMinLv&&e<=i.dcMaxLv)return i.tezhiLv}return i.tezhiLv},e.prototype.getTotalAttrByLvl=function(t){for(var e,i=this.data.cfg,n=[],o=DataCenter.ins().MagicCirLvConfig[i.id][t],s=o.attrs.length,r=0;s>r;r++)e=o.attrs[r],n.push(new AttributeData(e.type,e.value));var a=[];if(a=a.concat(n),this.actived){for(var l=magicCircleControl.getRoleDataByIndex(this.role.index),h=l.getDataByID(i.id),u=void 0,p=0,c=0;5>c;c++){u=h.specialVals[c];for(var d=u.length,g=void 0,m=0;d>m;m++)g=u[m],2==g.type&&(p+=g.value>0?g.value:0)}if(p>0)for(var f,v=n.length,y=0;v>y;y++)f=n[y],a.push(new AttributeData(f.type,Math.floor(f.value*p/1e4)))}return a},e.prototype.getTZAttrs=function(t,e){for(var i=[],n=t.length,o=DataCenter.ins().MagicCirLvConfig[this.data.cfg.id][e].attrs,s=o.length,r=0;n>r;r++)for(var a=t[r],l=DataCenter.ins().MagicCirTeZhiConfig[a.id][a.lvl],h=0;s>h;h++){var u=o[h];if(l.attrs.type==u.type){i.push(new AttributeData(l.attrs.type,Math.floor(l.attrs.per*u.value/1e4)));break}}return i},e.prototype.updateMaterail=function(t,e){this.icon.source=DataCenter.ins().ItemConfig[t].icon+"_png";var i=backpackControl.getBagItemById(t),n=i?i.count:0;if(this.isEnough=n>=e,this.countLabel.textFlow=TextUtils.generateTextFlow("|C:"+(this.isEnough?LangMgr.getColor("color43"):LangMgr.getColor("color22"))+"&T:"+n+"|/"+e),t==DataCenter.ins().MagicCirConfig.expItemId&&this.isEnough){var o=magicCircleControl.getRoleDataByIndex(this.role.index),s=o.getDataByID(this.data.cfg.id),r=DataCenter.ins().MagicCirLvConfig[this.data.cfg.id][s.level];this.redPoint.visible=DataCenter.ins().MagicCirConfig.expPerItem*n>=DataCenter.ins().MagicCirLvConfig[this.data.cfg.id][s.level].exp-s.exp&&s.talentLv>=r.talentLimit}else this.redPoint.visible=this.isEnough;this.upGradeBtn.enabled=this.isEnough},e.prototype.onTouch=function(t){switch(t.target){case this.upGradeBtn:if(!this.isEnough)return tipsControl.showTips(LangMgr.getValueByKey("materialEnought")),void(this.oneKey=!1);if(this.actived){if(this.oneKey)return;this.oneKey=!0;var e=magicCircleControl.getRoleDataByIndex(this.role.index),i=e.getDataByID(this.data.cfg.id);this.oldLvl=i.level,this.checkOnekey()}else magicCircleControl.upActive(this.role.index,this.data.cfg.id);break;case this.showBtn:magicCircleControl.upShowChange(this.role.index,this.data.cfg.id);break;case this.getItemTxt:warnControl.setBuyGoodsWarn(this.actived?DataCenter.ins().MagicCirConfig.expItemId:this.data.cfg.aGainwayId)}},e.prototype.checkOnekey=function(){if(this.oneKey){if(!this.isEnough)return void(this.oneKey=!1);var t=magicCircleControl.getRoleDataByIndex(this.role.index),e=t.getDataByID(this.data.cfg.id);e.level!=this.oldLvl?this.oneKey=!1:magicCircleControl.upLevelUp(this.role.index,this.data.cfg.id)}},e}(BasePanel);__reflect(MagicCirclePanel.prototype,"MagicCirclePanel");var MagicCirclePotentialPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.touchEnabled=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.addCustomEvent(53,this.update),this.addCustomEvent(56,this.specialUp),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addCustomEvent(268,this.updateMaterial),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.deEff&&(this.deEff.destroy(),this.deEff=null),this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.clearMixEff(),TimerMgr.ins().removeAll(this),this.lastData=null,this.offData=null,this.isPotentialing=!1,this.mcTimes=0},e.prototype.update=function(){var t=magicCircleControl.getRoleDataByIndex(this.data.roleIndex),e=t.getDataByID(this.data.cfg.id);this.actived=null!=e,this.getItemTxt.visible=!0,this.dcNameImg.source=this.data.cfg.mainNameImg,this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip"),this.deEff.touchEnabled=!1),this.deEff.parent||this.demonCirEff.addChild(this.deEff);var i=this.data.cfg,n=PATH_EFF+i.winEff;this.deEff.name!=n&&this.deEff.playFile(n,-1);var o,s,r,a=i.skillgroup.length,l=[],h="",u=0,p=[],c=0;this.offData=[];for(var d=0;5>d;d++){o=this["potential"+d],s=null,r=!1,a>d?(o.visible=!0,this.actived&&(r=e.getActiveByIndex(d),r&&(s=e.specialVals[d],c++)),o.setData({id:i.skillgroup[d],actived:r,param:s,values:null})):o.visible=!1;for(var g=DataCenter.ins().MagicCirSkillConfig[i.skillgroup[d]],m=void 0,f=Object.keys(g).length,v=s?s.length:0,y=0;f>y;y++){m=v>y?s[y]:null;var C=g[y+1];u+=m?m.value*(C.expower?C.expower:0):0;var T=d*f+y;if(this.lastData||(this.lastData=[]),this.lastData.length<=T?this.lastData.push({value:r?m.value:-1,skillType:C.skillType,type:C.attrType,color:C.attrColor}):(this.offData.push(r?m.value-(this.lastData[T].value>0?this.lastData[T].value:0):-1),this.isPotentialing||(this.lastData[T].value=r?m.value:-1)),this.isPotentialing){var w=this.lastData[T].value;2==C.skillType?h+="|C:"+(r?C.attrColor:12434877)+("&T:"+LangMgr.getValueByKey("demonCirAttr")+":")+(r?((w>0?w:0)/100).toFixed(1)+"%":LangMgr.getValueByKey("demonCirNoPotention"))+"|\n":(l.push(new AttributeData(C.attrType,m?m.value:0)),h+="|C:"+(r?C.attrColor:12434877)+"&T:"+this.getAttrName(C.attrType)+":"+(r?w>0?w:0:LangMgr.getValueByKey("demonCirNoPotention"))+"|\n")}else 2==C.skillType?h+="|C:"+(r?C.attrColor:12434877)+("&T:"+LangMgr.getValueByKey("demonCirAttr")+":")+(r?(m.value/100).toFixed(1)+"%":LangMgr.getValueByKey("demonCirNoPotention"))+"|\n":(l.push(new AttributeData(C.attrType,m?m.value:0)),h+="|C:"+(r?C.attrColor:12434877)+"&T:"+this.getAttrName(C.attrType)+":"+(r?m.value:LangMgr.getValueByKey("demonCirNoPotention"))+"|\n")}p.push(r)}u+=BackpackControl.getAttrPower(l,heroControl.getSubRoleByIndex(this.data.roleIndex)),this.nowAttr.textFlow=TextUtils.generateTextFlow1(h),this.powerPanel.setPower(u),this.isMax=e&&e.potentionTimes>=e.potentionMaxTimes,this.upGradeBtn.visible=!this.isMax,this.upGradeBtn.enabled=!this.isPotentialing,this.maxDesc.visible=this.isMax,this.costGroup.visible=!this.isMax,this.skillPoint.textFlow=TextUtils.generateTextFlow(this.actived?LangMgr.getValueByKey("demonCirCanPotentionTimes")+": |C:"+(e.potentionMaxTimes-e.potentionTimes?LangMgr.getColor("color43"):LangMgr.getColor("color22"))+"&T:"+(e.potentionMaxTimes-e.potentionTimes)+"|/"+e.potentionMaxTimes:""),this.potentialTitle.visible=this.resultAttr.visible=this.arrow.visible=!0,this.curImg.left=57,this.nowAttr.left=57,a=p.length;var I;h="";for(var b,D=e?e.potentionTimes:0,d=0;a>d;d++){var g=DataCenter.ins().MagicCirSkillConfig[i.skillgroup[d]],f=Object.keys(g).length;r=p[d],b=[];for(var y=0;f>y;y++){var C=g[y+1];if(I=this.getSectionCfg(C.sectionId,D).attrAdd[c?c-1:0],b.push(I),this.isPotentialing){var w=this.offData[d*f+y];0>w&&(w=0),h+=2==C.skillType?"|C:"+(r?2925607:12434877)+("&T:"+LangMgr.getValueByKey("demonCirAttr")+":")+(r?"|C:2925607&T:+"+((w/100).toFixed(1)+"%")+"|":LangMgr.getValueByKey("demonCirNoPotention"))+"|\n":"|C:"+(r?2925607:12434877)+"&T:"+this.getAttrName(C.attrType)+":"+(r?"|C:2925607&T:+"+w+"|":LangMgr.getValueByKey("demonCirNoPotention"))+"|\n"}else h+=2==C.skillType?"|C:2925607&T:"+LangMgr.getValueByKey("demonCirAttr")+":|C:2925607&T:"+(r?(I[0]/100).toFixed(1)+"% ~ "+(I[1]/100).toFixed(1)+"%":(C.attrMin/100).toFixed(1)+"%")+"||\n":"|C:2925607&T:"+this.getAttrName(C.attrType)+":|C:2925607&T:"+(r?I[0]+" ~ "+I[1]:C.attrMin)+"||\n"}this["potential"+d].setValues(b)}this.resultAttr.textFlow=TextUtils.generateTextFlow1(h);var B=magicCircleControl.getPotentionCostCfg(this.data.cfg.id,e?e.potentionTimes:0);this.icon.source=DataCenter.ins().ItemConfig[B.cost.id].icon+"_png",this.getItemTxt.visible=!this.isMax;var k=this.getDemonLvlCfg();this.actived&&!k&&this.isMax&&(this.potentialTitle.visible=this.resultAttr.visible=this.arrow.visible=!1,this.curImg.left=205,k||(this.nowAttr.left=205),this.getItemTxt.visible=!1,this.skillPoint.textFlow=TextUtils.generateTextFlow("")),this.isMax&&(this.maxDesc.textFlow=TextUtils.generateTextFlow(k?LangMgr.getValueByKey("demonCirLimitPotention",k.level,k.skillPoint):LangMgr.getValueByKey("demonCirPentionMax"))),this.skillPoint.visible=!this.isMax,this.potentialTitle.source=this.isPotentialing?"dc_potentialtitle3":"dc_potentialtitle2",this.updateMaterial()},e.prototype.specialUp=function(){this.update(),TimerMgr.ins().removeAll(this),TimerMgr.ins().doTimer(500,1,this.playMc,this)},e.prototype.getSectionCfg=function(t,e){for(var i,n=DataCenter.ins().MagicCirSkillSectionConfig[t],o=Object.keys(n).length,s=1;o>=s;s++)if(i=n[s],e<=i.countLimit)return i;return n[o]},e.prototype.getDemonLvlCfg=function(){if(!this.actived)return null;for(var t,e=magicCircleControl.getRoleDataByIndex(this.data.roleIndex),i=e.getDataByID(this.data.cfg.id),n=DataCenter.ins().MagicCirLvConfig[this.data.cfg.id],o=Object.keys(n).length,s=i.level+1;o>=s;s++)if(t=n[s],t.skillPoint)return t;return null},e.prototype.updateMaterial=function(){if(this.clearMixEff(),!this.isMax&&this.actived){var t=magicCircleControl.getRoleDataByIndex(this.data.roleIndex),e=t.getDataByID(this.data.cfg.id),i=magicCircleControl.getPotentionCostCfg(this.data.cfg.id,e?e.potentionTimes:0),n=backpackControl.getBagItemById(i.cost.id),o=n?n.count:0;this.isEnough=o>=i.cost.count,this.countLabel.textFlow=TextUtils.generateTextFlow("|C:"+(this.isEnough?LangMgr.getColor("color43"):LangMgr.getColor("color22"))+"&T:"+o+"|/"+i.cost.count),(n&&Math.floor(n.count/i.cost.count)>=DataCenter.ins().MagicCirConfig.skillCautionCount||ActorControl.yb>=i.cost.count*i.cost.price)&&(this.mixEff||(this.mixEff=ObjectPool.pop("GameMovieClip"),this.mixEff.touchEnabled=!1,this.effGroup.addChild(this.mixEff),this.mixEff.scaleX=1,this.mixEff.scaleY=1,this.mixEff.x=0,this.mixEff.y=-22),this.mixEff.playFile(PATH_EFF+"chargeff1",-1))}},e.prototype.clearMixEff=function(){this.mixEff&&(this.mixEff.destroy(),this.mixEff=null)},e.prototype.playMc=function(){this.mcTimes=0,TimerMgr.ins().doTimer(500/e.MAX_MC_TIMES,e.MAX_MC_TIMES,this.changeDes,this)},e.prototype.changeDes=function(){this.mcTimes++;
for(var t,i,n,o=this.lastData.length,s="",r="",a=0;o>a;a++){t=this.lastData[a],i=this.offData[a],n=t.value,0>n&&(n=0);var l=t.value>=0?t.color:LangMgr.getColor("color49"),h=i>=0?2925607:LangMgr.getColor("color49");2==t.skillType?(s+="|C:"+l+("&T:"+LangMgr.getValueByKey("demonCirAttr")+":")+(i>=0?((n+i/e.MAX_MC_TIMES*this.mcTimes)/100).toFixed(1)+"%":LangMgr.getValueByKey("demonCirNoPotention"))+"|\n",r+="|C:"+h+("&T:"+LangMgr.getValueByKey("demonCirAttr")+":")+(i>=0?"+"+((i-i/e.MAX_MC_TIMES*this.mcTimes)/100).toFixed(1)+"%":LangMgr.getValueByKey("demonCirNoPotention"))+"|\n"):(s+="|C:"+l+"&T:"+this.getAttrName(t.type)+":"+(i>=0?Math.floor(n+i/e.MAX_MC_TIMES*this.mcTimes):LangMgr.getValueByKey("demonCirNoPotention"))+"|\n",r+="|C:"+h+"&T:"+this.getAttrName(t.type)+":"+(i>=0?"+"+Math.floor(i-i/e.MAX_MC_TIMES*this.mcTimes):LangMgr.getValueByKey("demonCirNoPotention"))+"|\n")}this.nowAttr.textFlow=TextUtils.generateTextFlow1(s),this.resultAttr.textFlow=TextUtils.generateTextFlow1(r),this.mcTimes==e.MAX_MC_TIMES&&(this.isPotentialing=!1,this.update())},e.prototype.getAttrName=function(t){return AttributeData.getAttrStrByType(t)},e.prototype.onTouch=function(t){if(t.target==this.upGradeBtn){if(!this.actived)return void tipsControl.showTips(LangMgr.getValueByKey("demonCirNoActive"));if(!this.isEnough)return void warnControl.setBuyGoodsWarn(this.data.cfg.pGainwayId);this.isPotentialing=!0,magicCircleControl.upSpecialUp(this.data.roleIndex,this.data.cfg.id)}else t.target==this.getItemTxt&&warnControl.setBuyGoodsWarn(this.data.cfg.pGainwayId)},e.MAX_MC_TIMES=10,e}(BasePanel);__reflect(MagicCirclePotentialPanel.prototype,"MagicCirclePotentialPanel");var MagicCircleSkillActivatedTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MagicCircleSkillActivatedTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t[0];egret.Tween.removeTweens(this),this.potentialName.text=n.skillName,this.potentialImg.source=n.skillIcon,this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip")),this.deEff.parent||this.tekuangeff.addChild(this.deEff),this.deEff.playFile(PATH_EFF+"tekuangeff",-1),this.x=StageUtils.ins().getWidth()-285>>1,this.y=750,this.alpha=1;var o=egret.Tween.get(this);o.to({y:600},300).wait(1e3).to({alpha:0},1e3).call(function(){UIMgr.ins().close(e)})},e.prototype.close=function(){this.deEff&&(this.deEff.destroy(),this.deEff=null),egret.Tween.removeTweens(this)},e}(BaseEuiView);__reflect(MagicCircleSkillActivatedTipsView.prototype,"MagicCircleSkillActivatedTipsView");var MagicCircleSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MagicCircleSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){var t=DataCenter.ins().MagicCirSkillConfig[this.data.id],e=t[1];this.nametxt.textFlow=TextUtils.generateTextFlow(e.skillName),this.skillDesctxt.textFlow=TextUtils.generateTextFlow(e.skillDesc);var i=this.getAttrNameByskill(e.skillType,e.attrType);if(this.data.actived){this.nonactivated.visible=!1,this.activated.visible=!0;for(var n=this.data.param,o=Object.keys(t).length,s=n?n.length:0,r=void 0,a="",l="",h=this.data.values?this.data.values.length:0,u=void 0,p=0;o>p;p++)r=s>p?n[p]:null,u=h>p?this.data.values[p]:null,e=t[p+1],a+=(r?"|C:"+e.attrColor+"&T:"+(i+"+"+(2==e.skillType?(r.value/100).toFixed(1)+"%":r.value))+"|":"")+"  ",l+=(u?LangMgr.getValueByKey("demonCirPotentionAdd")+(2==e.skillType?(u[0]/100).toFixed(1)+"% ~ "+(u[1]/100).toFixed(1)+"%":u[0]+" ~ "+u[1]):"")+"  ";this.curAttr.textFlow=TextUtils.generateTextFlow(a),this.randomAttr.textFlow=TextUtils.generateTextFlow(l)}else this.nonactivated.visible=!0,this.activated.visible=!1,this.activatedAttr.textFlow=TextUtils.generateTextFlow(i+"+"+(2==e.skillType?(e.attrMin/100).toFixed(1)+"%":e.attrMin));this.potentialImg.source=DataCenter.ins().MagicCirSkillConfig[this.data.id][1].skillIcon},e.prototype.onTouch=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e.prototype.getAttrNameByskill=function(t,e){return 2==t?LangMgr.getValueByKey("demonCirAttr"):AttributeData.getAttrStrByType(e)},e}(BaseEuiView);__reflect(MagicCircleSkillTipsView.prototype,"MagicCircleSkillTipsView");var MagicCircleSpecialCharacterTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MagicCircleSpecialCharacterTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){var t=this.data.actived&&this.data.level>=Object.keys(DataCenter.ins().MagicCirTeZhiConfig[this.data.id]).length;if(this.nextGroup.visible=this.data.actived&&!t,this.curGroup.y=this.nextGroup.visible?-1:141,!t){var e=DataCenter.ins().MagicCirTeZhiConfig[this.data.id][this.data.level+1];this.skillName0.textFlow=TextUtils.generateTextFlow(e.name+"Lv"+e.tezhiLv),this.skillDesc0.textFlow=TextUtils.generateTextFlow(e.desc.replace("{0}",this.data.actived?'|C:LangMgr.getColor("color43")&T:（'+this.getAddValue(e)+"）|":"")),this.condition0.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("numberLevel",e.dcMinLv))}var i=DataCenter.ins().MagicCirTeZhiConfig[this.data.id][this.data.actived?this.data.level:1];this.skillName2.textFlow=TextUtils.generateTextFlow(i.name+"Lv"+i.tezhiLv),this.skillDesc2.textFlow=TextUtils.generateTextFlow(i.desc.replace("{0}",this.data.actived?'|C:LangMgr.getColor("color43")&T:（'+this.getAddValue(i)+"）|":"")),this.condition2.textFlow=TextUtils.generateTextFlow(t?LangMgr.getValueByKey("maxLevel"):this.data.actived?"":"|C:"+LangMgr.getColor("color73")+"&T:"+LangMgr.getValueByKey("demonCirLevAch")+"|"+LangMgr.getValueByKey("numberLevel",i.dcMinLv)+("|C:"+LangMgr.getColor("color73")+"&T:"+LangMgr.getValueByKey("commonUnlock")+"|"))},e.prototype.getAddValue=function(t){for(var e=DataCenter.ins().MagicCirLvConfig[this.data.demonID][this.data.demonLvl].attrs,i=e.length,n=0;i>n;n++){var o=e[n];if(t.attrs.type==o.type)return Math.floor(t.attrs.per*o.value/1e4)}return 0},e.prototype.onTouch=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(MagicCircleSpecialCharacterTipsView.prototype,"MagicCircleSpecialCharacterTipsView");var MagicCircleTaskPanel=function(t){function e(){var e=t.call(this)||this;return e.state=0,e.name=LangMgr.getValueByKey("demonCir"),e.skinName="MagicCircleTaskPanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(54,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.clearEff(),this.clearTweens()},e.prototype.clearEff=function(){this.deEff&&(this.deEff.destroy(),this.deEff=null)},e.prototype.update=function(){TimerMgr.ins().removeAll(this),this.clearEff();var t=!0,e=magicCircleControl.taskID,i=DataCenter.ins().MagicCirTaskConfig[e?e:1],n=DataCenter.ins().ItemConfig[i.itemId].name;this.goBtn.enabled=!0;var o,s,r,a,l;if(0==e)o=i.npcDialog1,s=i.taskRequire1,r=i.taskInfo1,a="",l=LangMgr.getValueByKey("demonCirTaskBtn"),this.state=0,t=!1;else{var h=magicCircleControl.taskState;if(h==MagicCircleControl.STATE_TASK)o=i.npcDialog2,s=i.taskRequire2,r=i.taskInfo2,a=LangMgr.getValueByKey("fireTips16","")+n+"（|C:16711680&T:"+magicCircleControl.taskProgress+"|/"+i.target+"）",l=LangMgr.getValueByKey("artRenderer1")+LangMgr.getValueByKey("personFight"),this.state=1;else if(h==MagicCircleControl.STATE_CAN_GET||h==MagicCircleControl.STATE_GOT)if(o=i.npcDialog3,s=i.taskRequire3,r=i.taskInfo3,this.state=2,magicCircleControl.taskCD<=0)a=LangMgr.getValueByKey("fireTips16","")+n+"（"+magicCircleControl.taskProgress+"/"+i.target+"）",l=LangMgr.getValueByKey("magicCircleTaskState");else{a="";var u=magicCircleControl.getCDTime();u>0?(l=DateUtils.getFormatBySecond(u,DateUtils.TIME_FORMAT_1,5),TimerMgr.ins().doTimer(1e3,0,this.onRepeat,this),this.goBtn.enabled=!1):l=LangMgr.getValueByKey("demonCirBtn2"),this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip")),this.deEff.parent||this.taskEff.addChild(this.deEff),this.taskEff.visible=!0,this.deEff.playFile(PATH_EFF+"demonCirTask",-1),t=!1}else o=i.npcDialog4,s=i.taskRequire4,r=i.taskInfo4,a="",l=LangMgr.getValueByKey("commonWait"),this.state=3}this.npcDialog.textFlow=TextUtils.generateTextFlow(o),this.taskRequire.textFlow=TextUtils.generateTextFlow(s),this.taskInfo.textFlow=TextUtils.generateTextFlow(r),this.taskschedule.textFlow=TextUtils.generateTextFlow(a),this.goBtn.label=l,this.redPoint.visible=magicCircleControl.checkTaskRed(),this.updateTasks(t)},e.prototype.onRepeat=function(){var t=magicCircleControl.getCDTime();t>0?this.goBtn.label=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_1,5):this.update()},e.prototype.clearTweens=function(){for(var t=Object.keys(DataCenter.ins().MagicCirTaskConfig).length,e=1;t>=e;e++)egret.Tween.removeTweens(this["step"+e])},e.prototype.updateTasks=function(t){for(var e,i,n,o=Object.keys(DataCenter.ins().MagicCirTaskConfig).length,s=magicCircleControl.taskID,r=magicCircleControl.taskState,a=[[-128.5,49.5],[129.5,51.5]],l=1;o>=l;l++)if(e=this["step"+l],egret.Tween.removeTweens(e),t)if(e.visible=!0,n=DataCenter.ins().MagicCirTaskConfig[l],i=s==l,e.setData({itemID:n.itemId,done:s>l||s==l&&r==MagicCircleControl.STATE_COMPLETE,selected:i}),i)e.horizontalCenter=0,e.verticalCenter=-137.5,egret.Tween.get(e,{loop:!0}).to({verticalCenter:-117.5},1e3).to({verticalCenter:-137.5},1e3);else{var h=a.shift();e.horizontalCenter=h[0],e.verticalCenter=h[1]}else e.visible=!1;a=null},e.prototype.onTouch=function(t){if(t.target==this.goBtn)if(0==this.state)magicCircleControl.upTaskEvent();else if(1==this.state){var e=DataCenter.ins().MagicCirTaskConfig[magicCircleControl.taskID];UIMgr.ins().open(e.controlTarget[0],e.controlTarget[1]),UIMgr.ins().close(IntensifyView)}else 2==this.state&&(magicCircleControl.taskCD<=0||magicCircleControl.getCDTime()<=0)&&magicCircleControl.upTaskEvent()},e}(BasePanel);__reflect(MagicCircleTaskPanel.prototype,"MagicCircleTaskPanel");var MagicCircleTaskRewardView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GoodItemTipsPanelSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],this.update()},e.prototype.close=function(){egret.Tween.removeTweens(this)},e.prototype.update=function(){egret.Tween.removeTweens(this),this.desc.textFlow=TextUtils.generateTextFlow(this.data.des),this.item.data=this.data.itemID,this.item.hideName(),this.skillName.text=DataCenter.ins().ItemConfig[this.data.itemID].name,this.x=StageUtils.ins().getWidth()-280>>1,this.y=750,this.alpha=1;var t=egret.Tween.get(this);t.to({y:600},300).wait(1e3).to({alpha:0},1e3).call(function(){UIMgr.ins().close(e)})},e}(BaseEuiView);__reflect(MagicCircleTaskRewardView.prototype,"MagicCircleTaskRewardView");var MagicCircleTaskTriggerView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MagicCircleTaskTriggerViewSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.eff_dragon.touchEnabled=!1,this.eff_dragon.touchChildren=!1},e.prototype.open=function(){this.addEventTouchTap(this,this.onTouch),this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip")),this.deEff.parent||this.eff_dragon.addChild(this.deEff),this.deEff.playFile(PATH_EFF+"demonCirTask3",-1)},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.deEff&&(this.deEff.destroy(),this.deEff=null)},e.prototype.onTouch=function(t){t.target==this.hideBossBtn&&(magicCircleControl.upTaskEvent(),UIMgr.ins().close(this))},e}(BaseEuiView);__reflect(MagicCircleTaskTriggerView.prototype,"MagicCircleTaskTriggerView");var MagicCircleListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){this.lvCount.text=this.data.actived?"Lv."+this.data.level:"",this.nameImg.source=this.data.cfg.nameImg,this.redPoint.visible=this.data.showRed,this.deEff||(this.deEff=ObjectPool.pop("GameMovieClip")),this.deEff.parent||this.demonCirEff.addChild(this.deEff),this.deEff.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this.deEff,this.onRemove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch),this.deEff.playFile(""+PATH_EFF+this.data.cfg.winEff,-1),this.deEff.filters=this.data.actived?null:FilterUtils.ARRAY_GRAY_FILTER},e.prototype.onRemove=function(t){this.deEff&&(this.removeEventRemovedFromStage(this.deEff,this.onRemove),this.removeEventTouchTap(this,this.onTouch),this.deEff.destroy(),this.deEff=null)},e.prototype.onTouch=function(t){UIMgr.ins().open(MagicCircleMainView,{cfg:this.data.cfg,roleIndex:this.data.roleIndex})},e}(BaseItemRender);__reflect(MagicCircleListItemRenderer.prototype,"MagicCircleListItemRenderer");var MagicCirclePotentialItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.inited=!0,this.update()},e.prototype.setData=function(t){this.data=t,this.inited&&this.update()},e.prototype.setValues=function(t){this.data&&(this.data.values=t)},e.prototype.update=function(){this.data&&(this.redPoint.visible=!1,this.potentialImg.source=DataCenter.ins().MagicCirSkillConfig[this.data.id][1].skillIcon,this.potentialImg.filters=this.data.actived?null:FilterUtils.ARRAY_GRAY_FILTER,this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRmove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch))},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this,this.onTouch),this.data=null},e.prototype.onTouch=function(t){this.data&&UIMgr.ins().open(MagicCircleSkillTipsView,this.data)},e}(BaseItemRender);__reflect(MagicCirclePotentialItemRenderer.prototype,"MagicCirclePotentialItemRenderer");var MagicCircleSkillItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.inited=!0,this.update()},e.prototype.setData=function(t){this.data=t,this.inited&&this.update()},e.prototype.update=function(){if(this.data){if(0==this.data.type)this.dcImg.source=DataCenter.ins().MagicCirBaseConfig[this.data.id].talentImg;else if(1==this.data.type){var t=DataCenter.ins().MagicCirTeZhiConfig[this.data.id][this.data.actived?this.data.param:1];this.dcImg.source=t.icon}this.dcImg.filters=this.data.actived?null:FilterUtils.ARRAY_GRAY_FILTER,this.redPoint.visible=!1,this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRmove),this.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this,this.onTouch),this.updateRed()}},e.prototype.updateRed=function(){if(0==this.data.type&&(this.redPoint.visible=!1,this.data.actived)){var t=magicCircleControl.getRoleDataByIndex(this.data.roleId),e=t.getDataByID(this.data.id),i=DataCenter.ins().MagicCirBaseConfig[this.data.id];if(e.talentLv>0&&e.talentLv<Object.keys(DataCenter.ins().MagicCirTalentConfig[i.talent]).length){var n=DataCenter.ins().MagicCirTalentConfig[i.talent][e.talentLv+1],o=backpackControl.getBagItemById(i.mat);o&&o.count>=n.costCount&&(this.redPoint.visible=!0)}}},e.prototype.onRmove=function(t){this.removeEventRemovedFromStage(this,this.onRmove),this.removeEventTouchTap(this,this.onTouch),this.data=null},e.prototype.onTouch=function(t){this.data&&(0==this.data.type?UIMgr.ins().open(MagicCircleAbilityTipsView,this.data.roleId,this.data.id,this.data.actived):1==this.data.type&&UIMgr.ins().open(MagicCircleSpecialCharacterTipsView,{id:this.data.id,level:this.data.param,actived:this.data.actived,demonID:this.demonID,demonLvl:this.demonLvl}))},e}(BaseItemRender);__reflect(MagicCircleSkillItemRenderer.prototype,"MagicCircleSkillItemRenderer");var MagicCircleTaskItemIcon=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.inited=!0,this.update()},e.prototype.setData=function(t){this.data=t,this.inited&&this.update()},e.prototype.update=function(){this.data&&(this.curTask.visible=this.data.selected,this.doneImg.visible=this.data.done,this.itemIcon.source=DataCenter.ins().ItemConfig[this.data.itemID].icon+"_png")},e}(eui.Component);__reflect(MagicCircleTaskItemIcon.prototype,"MagicCircleTaskItemIcon");var WeaponSoulFacadePanel=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="WeaponSoulFacadePanelSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.skillicon,this.onEvent),this.addEventTouchTap(this.upGradeBtn0,this.onEvent),this.addEventTouchTap(this.turnTxt,this.onEvent),this.addEventTouchTap(this.closeBtn,this.onEvent),this.addCustomEvent(141,this.callback),this.addCustomEvent(142,this.callback),this.addCustomEvent(140,this.callback),this.weaponSoulShowPanel.open(),this.roleId=t[0],this.weaponId=t[1],this.init(this.weaponId)},e.prototype.init=function(t){this.updateUI(t)},e.prototype.updateUI=function(t){var e=DataCenter.ins().WeaponSoulConfig[t];if(!e)for(var i in DataCenter.ins().WeaponSoulConfig){e=DataCenter.ins().WeaponSoulConfig[i];break}var n=heroControl.getSubRoleByIndex(this.roleId);this.ringname.text=e.name;var o=n.weapons.getSoulInfoData()[t],s=n.weapons.getSuitConfig(t),r=LangMgr.getValueByKey("warnTips12"),a="|C:"+LangMgr.getColor("qualityColor5")+"&T:";if(!o||!o.id){a="";for(var i in DataCenter.ins().WeaponSoulSuitConfig[t]){s=DataCenter.ins().WeaponSoulSuitConfig[t][i];break}}-1==n.weapons.getFlexibleData().indexOf(t)&&(r=""),this.levellabel.text=s.level+LangMgr.getValueByKey("osaLevelJ"),this.skillicon.data={icon:s.skillicon},this.skillname.text=s.skillname,this.powerPanel.setPower(n.getWeaponTotalPower(t));for(var l=[4,2,6,5],h=[0,0,0,0],u=0;u<e.actcond.length;u++){var p=e.actcond[u],c=n.weapons.getSlotByInfo(p);if(c)for(var d=0;d<c.attr.length;d++){var g=c.attr[d];if(-1!=l.indexOf(g.type))for(var m=0;m<l.length;m++)l[m]==g.type&&(h[m]+=g.value)}}for(var u=0;4>u;u++)if(this["attr"+u]){var f=AttributeData.getAttrStrByType(l[u]);this["attr"+u].text=f+"+"+h[u]}this.skill.textFlow=TextUtils.generateTextFlow1(""+a+s.skilldesc+r);var v=n.weapons.getWeapsInfoBySoulId(t);this.turnTxt.parent&&(this.turnTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("warnTips13"))),this.descGroup.visible=!0,n.weapons.flexibleCount?(this.desc.text=LangMgr.getValueByKey("warnTips14"),this.turnTxt.parent||this.desc.parent.addChild(this.turnTxt)):(this.desc.text=LangMgr.getValueByKey("warnTips15"),DisplayUtils.removeFromParent(this.turnTxt)),v&&v.id?n.weapons.weaponsId==v.id?(this.upGradeBtn0.label=LangMgr.getValueByKey("cancel1"),this.huanhuaImage.visible=!0,this.redPoint.visible=!1):n.weapons.weaponsId?(this.upGradeBtn0.label=LangMgr.getValueByKey("warnTips17"),this.huanhuaImage.visible=!1,this.redPoint.visible=!1):(this.upGradeBtn0.label=LangMgr.getValueByKey("warnTips16"),this.huanhuaImage.visible=!1,this.redPoint.visible=!0):(this.upGradeBtn0.label=LangMgr.getValueByKey("warnTips11"),this.huanhuaImage.visible=!1,this.redPoint.visible=n.weapons.IsActivityWeapon(t),this.descGroup.visible=!1),this.weaponSoulShowPanel.init(t,this.roleId)},e.prototype.onEvent=function(t){switch(t.currentTarget){case this.skillicon:UIMgr.ins().open(WeaponSoulSkillTipsView,this.roleId,this.weaponId);break;case this.upGradeBtn0:var e=heroControl.getSubRoleByIndex(this.roleId);if(this.upGradeBtn0.label==LangMgr.getValueByKey("warnTips11")){var i=e.weapons.getSuitConfig(this.weaponId);if(!i)return void tipsControl.showTips(LangMgr.getValueByKey("warnTips18"));weaponsSoulControl.upWeaponsAct(this.roleId,this.weaponId)}else this.upGradeBtn0.label==LangMgr.getValueByKey("warnTips16")?weaponsSoulControl.upWeaponsUse(this.roleId,this.weaponId):this.upGradeBtn0.label==LangMgr.getValueByKey("cancel1")?weaponsSoulControl.upWeaponsUse(this.roleId,0):this.upGradeBtn0.label==LangMgr.getValueByKey("warnTips17")&&weaponsSoulControl.upWeaponsUse(this.roleId,this.weaponId);break;case this.closeBtn:UIMgr.ins().close(this);break;case this.turnTxt:var n=UIMgr.ins().getView(IntensifyView);n&&n.weaponSoulPanel.open(this.roleId,!1),UIMgr.ins().close(this)}},e.prototype.callback=function(){this.updateUI(this.weaponId)},e}(BaseEuiView);__reflect(WeaponSoulFacadePanel.prototype,"WeaponSoulFacadePanel");var MineControl=function(t){function e(){var e=t.call(this)||this;return e.mineStartTime=0,e.mineEndTime=0,e.hadMine=!1,e.hasNewRecord=!1,e.canShowOnceTips=!1,e.allCanRobData=new MineRobVo,e.helpDatas=[],e.isOnGuildChat=!1,e.isOnMineHelpData=!1,e.sendHelpMsgTime=0,e.inCopy=!1,e.mineIsFightDic={},e.mines=[],e.isShowTransfer=!0,e.addCustomEvent(30,e.onGuildChatMessage),e.addCustomEvent(466,e.openRobWin),SwitchSceneMgr.ins().register(e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.isInMine=function(){return 0==MapControl.copyType&&0!=MapControl.copyId},e.prototype.onEnterScene=function(){!this.inCopy&&this.isInMine()&&(this.inCopy=!0,UIMgr.ins().open(MineSceneView)),this.finishedData&&this.openRobWin(!0),this.inCopy&&this.hasNewRecord&&UIMgr.ins().open(MinePlunderView),73==MapControl.copyType&&this.robData?(this.robData.isBeFight=!0,gameControl.createEntityByModel(this.robData)):this.robData=null,!this.hadMine&&this.inCopy&&(this.canShowOnceTips=!0)},e.prototype.onExitScene=function(){this.inCopy&&!this.isInMine()?(this.inCopy=!1,UIMgr.ins().close(MineSceneView),this.removeAll()):this.inCopy&&this.removeAll()},e.prototype.initZero=function(){this.upRefresh()},e.prototype.initLogin=function(){var t=this;TimerMgr.ins().once(1e3,function(){t.upCanRobInfo()},this)},e.prototype.openCheck=function(t){var e=DataCenter.ins().MineConfig.openServerDay;if(e>GameServer.serverOpenDay+1)return t&&tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",e)),!1;var i=DataCenter.ins().MineConfig.openLevel,n=ActorControl.level>=i;return n?n:(t&&tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",i)),!1)},e.prototype.getCanMineCount=function(){var t=payControl.franchise?DataCenter.ins().FranchiseConfig.addKuangCount:0;return DataCenter.ins().MineConfig.maxOpenKuangCount+t},e.prototype.isOverTime=function(){return this.mineEndTime?GameServer.serverTime>this.mineEndTime:!0},e.prototype.dispatchMineFightState=function(t){EventMgr.ins().dispatch(632,t)},e.prototype.downBaseInfo=function(t,e,i,n,o,s,r){this.mineCount=t,this.robCount=e,this.mineId=i,this.mineFreshCount=n,this.mineQuaCount=o,this.mineEndTime=DateUtils.formatMiniDateTime(s),this.hadMine=r,this.mineId||(this.finishedData&&this.mineCount<this.getCanMineCount()&&this.inCopy&&UIMgr.ins().open(MineChoseWorkerView),this.finishedData=null),this.hadMine&&this.canShowOnceTips&&guideControl.updateByAppear(),EventMgr.ins().dispatch(243)},e.prototype.downRefresh=function(t,e,i){if(this.mineId=t,this.mineFreshCount=e,i>this.mineQuaCount){var n=DataCenter.ins().MineSourceConfig[this.mineId],o=Math.floor(n.maxTimes/n.baseTime);tipsControl.showTips(LangMgr.getValueByKey("errorUpLevel",o))}this.mineQuaCount=i,EventMgr.ins().dispatch(244)},e.prototype.downStart=function(t){this.mineCount=t,EventMgr.ins().dispatch(245)},e.prototype.downInitScene=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],this.isExitUp=!!t[1],this.isExitDown=!!t[2],this.removeAll();for(var i=0;i<t[3].length;i++)this.mines[i]=ObjectPool.pop("MineModel"),this.mines[i].init(t[3][i]),this.checkIsMyMine(this.mines[i]),this.updateMineConfig(this.mines[i]);this.resetRole(),this.createTransfer(),this.createEntity(),this.showAwardWin(),EventMgr.ins().dispatch(246)},e.prototype.downRecord=function(t){this.mineRecords=this.mineRecords||[],this.mineRecords.length=t.length;for(var e=0;e<t.length;e++)this.mineRecords[e]=this.mineRecords[e]||new MineRecordVo,this.mineRecords[e].init(t[e]);this.hasNewRecord=!1,EventMgr.ins().dispatch(247)},e.prototype.downSceneUpdate=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=ObjectPool.pop("MineSceneInfoVo");o.init(t,e,i),o.handler(),o.destroy(),EventMgr.ins().dispatch(248)},e.prototype.downRobResult=function(t){this.robCount=t,EventMgr.ins().dispatch(625)},e.prototype.downFinished=function(t,e){this.mineStartTime=0,this.mineEndTime=0,this.finishedData={},this.finishedData.configID=t,this.finishedData.beRob=[];for(var i=0;i<e.length;i++){var n={};n.name=e[i][0],n.win=e[i][1],this.finishedData.beRob.push(n)}this.openRobWin(),EventMgr.ins().dispatch(249)},e.prototype.openRobWin=function(t){if(void 0===t&&(t=!1),this.finishedData&&(!MineRobView.noPrompt||t&&this.inCopy)){if(void 0==GameServer.serverOpenDay)return;this.inCopy?UIMgr.ins().open(MineRobView,this.finishedData):MapControl.sceneInHook()||toseongControl.isToseong?UIMgr.ins().open(MineFinishOutsideView):UIMgr.ins().close(MineFinishOutsideView)}},e.prototype.downRecordHasUpdate=function(){this.hasNewRecord=!0,EventMgr.ins().dispatch(250,1)},e.prototype.downRoleInfo=function(t){EventMgr.ins().dispatch(251,t)},e.prototype.downAllHelpInfo=function(t){this.helpDatas=[];for(var e=0;t.length>e;e++){var i=new MineHelpVo;i.init(t[e]),this.helpDatas.push(i)}this.isOnMineHelpData=!0,this.checkMineHelpInfo()},e.prototype.downOneHelpInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new MineHelpVo;i.init(t),this.helpDatas.push(i),this.inserMineHelpToGuildChat(i,!0),i.sendPlayerId==ActorControl.actorID&&(this.sendHelpMsgTime=GameServer.serverTime)},e.prototype.downFightBackResult=function(t){for(var e in this.mineRecords)if(this.mineRecords[e].index==t){this.mineRecords[e].isBeatHim=1;break}EventMgr.ins().dispatch(631)},e.prototype.downCanRobInfo=function(t){this.allCanRobData.init(t),EventMgr.ins().dispatch(623)},e.prototype.downCanRobInfoUpdate=function(t){this.allCanRobData.update(t),EventMgr.ins().dispatch(624)},e.prototype.downResult=function(t,e,i,n,o,s){for(var r=[],a=0;a<s.length;a++){var l=new RewardVo;l.init(s[a]),r.push(l)}var h=MapControl.copyType;if(t){UnitMgr.ins().resetRole();for(var u=heroControl.subRolesLen,p=void 0,a=0;u>a;a++)p=UnitMgr.ins().getMainRole(a),p&&p.playAction(UnitAction.STAND);r=this.getCountAward(r),CommonFun.dropEff(r,null,function(){UIMgr.ins().open(MineResultView,t,h,e,i,n,o,r)})}else UIMgr.ins().open(MineResultView,t,h,e,i,n,o,r)},e.prototype.getCountAward=function(t){for(var e=[],i=0;i<t.length;i++)for(var n=t[i];n.count>0;){var o=new RewardVo;o.type=n.type,o.id=n.id,o.count=n.count>10?10:n.count,e.push(o),n.count-=10}return e},e.prototype.downUpdatePower=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1];this.setPower(i,n)}EventMgr.ins().dispatch(406)},e.prototype.onGuildChatMessage=function(){this.isOnGuildChat=!0,this.checkMineHelpInfo()},e.prototype.checkMineHelpInfo=function(){if(this.isOnGuildChat&&this.isOnMineHelpData){for(var t=0;t<this.helpDatas.length;t++){var e=this.helpDatas[t];this.inserMineHelpToGuildChat(e)}this.isOnGuildChat=!1,this.isOnMineHelpData=!1,rambleControl.sortAllChatMsg()}},e.prototype.inserMineHelpToGuildChat=function(t,e){void 0===e&&(e=!1);var i=""+t.idx,n=DataCenter.ins().MineSourceConfig[t.mineId],o=DataCenter.ins().MineConfig.helpInfo;o=o.replace("%s","|C:0xff0000&T:"+t.targetPlayerName+"|"),o=o.replace("%s","|C:"+n.color+"&T:"+n.name+"|"),o+=" |E:6,"+i+",&U:&C:65280&T:"+LangMgr.getValueByKey("clickxiezhu")+"|";var s=new UnionMessageInfoVo;s.type=1,s.str=o,s.roleId=t.sendPlayerId,s.name=t.sendPlayerName,s.vipLevel=t.sendPlayerVip,s.office=t.sendPlayerGuildPos,s.setTime(t.sendTime),s.analyzeE(),s.hasTimeOut?this.removeHelpIdx(t.idx):(unionControl.addChatMsg(s),e&&t.sendPlayerId==ActorControl.actorID&&tipsControl.showCenterTips(LangMgr.getValueByKey("xiezhufucsendok")))},e.prototype.removeHelpIdx=function(t){for(var e=0;e<this.helpDatas.length;e++)if(this.helpDatas[e].idx==t){this.helpDatas.splice(e,1);break}},e.prototype.upIntoMine=function(){},e.prototype.upRefresh=function(t){return t?[t]:void 0},e.prototype.upStart=function(){},e.prototype.upGetAward=function(t){return void 0===t&&(t=!1),[t?1:0]},e.prototype.upGetRecord=function(){},e.prototype.upRob=function(t){this.robData=t;var e=t.actorID;return[e]},e.prototype.upFightBack=function(t){return[t]},e.prototype.upQuickFinish=function(){},e.prototype.upSceneChange=function(t){return[t?1:0]},e.prototype.upGetRolePower=function(t){return[t]},e.prototype.upHelpIdx=function(t){return[t]},e.prototype.upHelpOther=function(t){for(var e=0;e<this.helpDatas.length;e++){var i=this.helpDatas[e];if(i.idx==t){this.curHelpData=i;break}}return[t]},e.prototype.upCanRobInfo=function(){},e.prototype.upGetPower=function(){},e.prototype.getMineLeftTime=function(){return this.mineEndTime?Math.floor((this.mineEndTime-GameServer.serverTime)/1e3):0},e.prototype.checkMineIsFight=function(t,e){return!!this.mineIsFightDic[t+"_"+e]},e.prototype.setMineIsFight=function(t){this.mineIsFightDic[t.endTime+"_"+t.index]=1},e.prototype.showAwardWin=function(){this.finishedData&&UIMgr.ins().open(MineRobView,this.finishedData)},e.prototype.resetRole=function(){UnitMgr.ins().resetRole();for(var t=heroControl.subRolesLen,e=1;t>e;e++){var i=heroControl.roles[e],n=UnitMgr.ins().getEntityByHandle(i.handle);n&&(n.visible=!1)}},e.prototype.createTransfer=function(){if(this.isShowTransfer){DataCenter.ins().MineConfig.transPos;if(this.isExitUp){var t=UnitMgr.ins().getTransferById(0);t?(t.infoModel.index=this.index-1,t.updateModel()):this.addTransfer(0,this.index-1)}else UnitMgr.ins().removeTransferById(0);if(this.isExitDown){var t=UnitMgr.ins().getTransferById(1);t?(t.infoModel.index=this.index+1,t.updateModel()):this.addTransfer(1,this.index+1)}else UnitMgr.ins().removeTransferById(1)}},e.prototype.showTransfer=function(t){this.isShowTransfer=t,t?this.createTransfer():(UnitMgr.ins().removeTransferById(0),UnitMgr.ins().removeTransferById(1))},e.prototype.setPower=function(t,e){for(var i=0;i<this.mines.length;i++){var n=this.mines[i];if(n.index==t){n.power=e;break}}},e.prototype.addTransfer=function(t,e){var i=DataCenter.ins().MineConfig.transPos,n=new TransferModel;n.configID=t,n.index=e;var o=i[n.configID];n.x=o.x*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1),n.y=o.y*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1),UnitMgr.ins().createEntity(n)},e.prototype.createEntity=function(){for(var t=0,e=this.mines;t<e.length;t++){var i=e[t];gameControl.createEntityByModel(i)}TimerMgr.ins().isExists(this.updateTime,this)||TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.updateTime=function(){for(var t=0,e=this.mines;t<e.length;t++){var i=e[t],n=UnitMgr.ins().getMineByIndex(i.index);n&&n.updateTime()}},e.prototype.getMineByIndex=function(t,e){for(var i=0,n=this.mines;i<n.length;i++){var o=n[i];if(o.index==t)return e&&e!=o.actorID?null:o}},e.prototype.add=function(t){this.remove(t.index),this.mines.push(t),this.checkIsMyMine(t),this.updateMineConfig(t),gameControl.createEntityByModel(t)},e.prototype.updateMineConfig=function(t){var e=DataCenter.ins().MineConfig.kuangPos,i=e[t.index-1];
t.x=i.x*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1),t.y=i.y*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1),t.dir=i.d},e.prototype.checkIsMyMine=function(t){return t.actorID==ActorControl.actorID?(this.myMine=t.clone(this.myMine),this.mineStartTime=this.myMine.startTime,this.mineEndTime=this.myMine.endTime,!0):!1},e.prototype.getIsCanAtk=function(t){return t.actorID==ActorControl.actorID?!1:this.robCount>=DataCenter.ins().MineConfig.maxRobCount?!1:this.getMineByIndex(t.index,t.actorID)?t.isBeFight?!1:t.isBeRobOver||t.isBeMeRob?!1:!0:!1},e.prototype.remove=function(t){for(var e in this.mines){var i=this.mines[e];if(i.index==t){this.mines.splice(parseInt(e),1),UnitMgr.ins().removeMineByIndex(t);break}}},e.prototype.removeAll=function(){for(;this.mines.length;){var t=this.mines.pop();UnitMgr.ins().removeMineByIndex(t.index)}TimerMgr.ins().removeAll(this)},__decorate([down(1,[2,2,3,3,3,3,0])],e.prototype,"downBaseInfo",null),__decorate([down(2,[3,3,3])],e.prototype,"downRefresh",null),__decorate([down(3,[2])],e.prototype,"downStart",null),__decorate([down(4,ByteConst.MineVos.slice())],e.prototype,"downInitScene",null),__decorate([down(6,[ByteConst.MineRecordVos])],e.prototype,"downRecord",null),__decorate([down(11,[2,2,[1],[],ByteConst.MineModels,[2,0,0],[3],ByteConst.MineModels])],e.prototype,"downSceneUpdate",null),__decorate([down(13,[2])],e.prototype,"downRobResult",null),__decorate([down(15,[2,[8,0]])],e.prototype,"downFinished",null),__decorate([down(16)],e.prototype,"downRecordHasUpdate",null),__decorate([down(17,[10])],e.prototype,"downRoleInfo",null),__decorate([down(18,[ByteConst.MineHelpVos])],e.prototype,"downAllHelpInfo",null),__decorate([down(21,ByteConst.MineHelpVos.slice())],e.prototype,"downOneHelpInfo",null),__decorate([down(22,[3])],e.prototype,"downFightBackResult",null),__decorate([down(23,[[2,[1,3,3,[3]]]])],e.prototype,"downCanRobInfo",null),__decorate([down(24,[4,2,1,3,3])],e.prototype,"downCanRobInfoUpdate",null),__decorate([down(25,[1,1,1,8,8,ByteConst.RewardVos])],e.prototype,"downResult",null),__decorate([down(26,[[4,10]])],e.prototype,"downUpdatePower",null),__decorate([up(1)],e.prototype,"upIntoMine",null),__decorate([up(2,[2])],e.prototype,"upRefresh",null),__decorate([up(3)],e.prototype,"upStart",null),__decorate([up(5,[2])],e.prototype,"upGetAward",null),__decorate([up(6)],e.prototype,"upGetRecord",null),__decorate([up(7,[3])],e.prototype,"upRob",null),__decorate([up(8,[3])],e.prototype,"upFightBack",null),__decorate([up(12)],e.prototype,"upQuickFinish",null),__decorate([up(14,[2])],e.prototype,"upSceneChange",null),__decorate([up(17,[3])],e.prototype,"upGetRolePower",null),__decorate([up(19,[3])],e.prototype,"upHelpIdx",null),__decorate([up(20,[3])],e.prototype,"upHelpOther",null),__decorate([up(23)],e.prototype,"upCanRobInfo",null),__decorate([up(26)],e.prototype,"upGetPower",null),e=__decorate([protocolsId(49)],e)}(BaseSystem);__reflect(MineControl.prototype,"MineControl");var AmuseTarget0Panel4=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=t.call(this)||this;return n.skinName="AmuseTarget0Panel4Skin",n}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.active,this.onTap),this.addCustomEvent(451,this.updateData),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.active,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){t.currentTarget==this.active&&(threeHeroesControl.awardState==ThreeHeroesControl.NotActive?UIMgr.ins().open(VipView,[4]):threeHeroesControl.awardState==ThreeHeroesControl.CanGet?threeHeroesControl.upReward():threeHeroesControl.awardState==ThreeHeroesControl.Active&&tipsControl.showTips(LangMgr.getValueByKey("activitLoinGet",DataCenter.ins().ThreeHeroesConfig.loginDays-threeHeroesControl.loginDays)))},e.prototype.getTime=function(t){var e=(DataCenter.ins().UnionBattleConstConfig.openServer,new Date(t.startTime)),i=e.getMonth()+1+LangMgr.getValueByKey("activitMonth")+e.getDate()+LangMgr.getValueByKey("activitDayTime","-1");e=new Date(t.endTime-1e3*DateUtils.SECOND_PER_DAY);var n=e.getMonth()+1+LangMgr.getValueByKey("activitMonth")+e.getDate()+LangMgr.getValueByKey("activitDayTime","")+"23:59";return i+n},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(t.startTime/1e3-GameServer.serverTime/1e3),i=Math.floor(t.endTime/1e3-GameServer.serverTime/1e3);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey('doubleEndActivity"'):this.actTime.text=this.getTime(t);var n=threeHeroesControl.awardState;this.active.enabled=n!=ThreeHeroesControl.Geted,this.redPoint.visible=n==ThreeHeroesControl.CanGet,n==ThreeHeroesControl.NotActive?this.active.label=LangMgr.getValueByKey("smeltActivity"):n==ThreeHeroesControl.CanGet||n==ThreeHeroesControl.Active?this.active.label=LangMgr.getValueByKey("tongGetGift"):this.active.label=LangMgr.getValueByKey("activitAlreadingGet");var o=DataCenter.ins().AmusementBtnConfig[this.activityID];this.actInfo.text=o.acDesc,this.state.text=n==ThreeHeroesControl.Active?LangMgr.getValueByKey("activitLoinGet",DataCenter.ins().ThreeHeroesConfig.loginDays-threeHeroesControl.loginDays):""},e}(BasePanel);__reflect(AmuseTarget0Panel4.prototype,"AmuseTarget0Panel4");var MineHelpVo=function(){function t(){}return t.prototype.init=function(t){this.idx=t[0],this.sendPlayerId=t[1],this.sendPlayerName=t[2],this.sendPlayerVip=t[3],this.sendPlayerGuildPos=t[4],this.sendTime=t[5],this.targetPlayerId=t[6],this.targetPlayerName=t[7],this.mineId=t[8]},t}();__reflect(MineHelpVo.prototype,"MineHelpVo");var MineRecordVo=function(){function t(){}return t.prototype.init=function(e){this.index=e[0],this.type=e[1],this.time=DateUtils.formatMiniDateTime(e[2]),this.type==t.TYPE_BEROB?(this.configID=e[3],this.fighterActorID=e[4],this.fighterName=e[5],this.fighterIsWin=e[6],this.isBeatHim=e[8],this.fighterJob=e[9],this.fighterSex=e[10],this.fighterPower=e[11]):(this.configID=e[3],this.robActorID=e[4],this.robMasterName=e[5],this.robIsWin=e[6])},t.TYPE_BEROB=1,t.TYPE_ROB=2,t}();__reflect(MineRecordVo.prototype,"MineRecordVo");var MineRobVo=function(){function t(){this.infos=[]}return t.prototype.init=function(t){this.infos.length=t.length;for(var e=0;t.length>e;e++){var i=this.infos[e]=this.infos[e]||{sceneId:0,mines:[]};i.sceneId=t[e][0];var n=t[e][1];i.mines.length=n.length;for(var o=0;n.length>o;o++){for(var s=n[o][0],r=DateUtils.formatMiniDateTime(n[o][1]),a=n[o][2],l=[],h=0;n[o][3].length>h;h++)l.push(n[o][3][h]);i.mines[o]={index:s,endTime:r,beRobed:l,actorId:a}}}},t.prototype.update=function(t){var e,i,n,o,s=t[0];switch(s){case 2:e=t[1],i=t[2];for(var r=0;r<this.infos.length;r++){var a=this.infos[r];if(a.sceneId==e){o=a;for(var l=0;l<a.mines.length;l++){var h=a.mines[l];if(h.index==i){a.mines.splice(l,1);break}}break}}break;case 3:e=t[1],i=t[2];for(var u=DateUtils.formatMiniDateTime(t[3]),p=t[4],r=0;r<this.infos.length;r++){var a=this.infos[r];if(a.sceneId==e){o=a;for(var l=0;l<a.mines.length;l++){var h=a.mines[l];if(h.index==i){n=h;break}}break}}if(o)n?n.endTime=u:o.mines.push({index:i,endTime:u,actorId:p,beRobed:[]});else{var c=[{index:i,endTime:u,actorId:p,beRobed:[]}];this.infos.push({sceneId:e,mines:c})}break;case 5:e=t[1],i=t[2];for(var r=0;r<this.infos.length;r++){var a=this.infos[r];if(a.sceneId==e){o=a;for(var l=0;l<a.mines.length;l++){var h=a.mines[l];if(h.index==i){h.beRobed.push(t[3]);break}}break}}}},t.prototype.canRob=function(){if(DataCenter.ins().MineConfig.maxRobCount<=mineControl.robCount)return!1;for(var t=0;t<this.infos.length;t++)for(var e=this.infos[t],i=e.mines.length-1;i>=0;i--){var n=e.mines[i];if(n){if(!(n.endTime<GameServer.serverTime||n.actorId==ActorControl.actorID||n.beRobed.length>=DataCenter.ins().MineConfig.maxBeRobCount||n.beRobed.indexOf(ActorControl.actorID)>=0||mineControl.checkMineIsFight(n.endTime,n.index)))return!0;e.mines.splice(i,1)}}return!1},t.prototype.getMiniTime=function(){for(var t=0,e=0;e<this.infos.length;e++)for(var i=this.infos[e],n=i.mines.length-1;n>=0;n--){var o=i.mines[n];o&&(o.endTime<=GameServer.serverTime||o.actorId==ActorControl.actorID||o.beRobed.length>=DataCenter.ins().MineConfig.maxBeRobCount||o.beRobed.indexOf(ActorControl.actorID)>=0||mineControl.checkMineIsFight(o.endTime,o.index)?i.mines.splice(n,1):t=t?Math.min(t,o.endTime):o.endTime)}return t},t}();__reflect(MineRobVo.prototype,"MineRobVo");var MineSceneInfoVo=function(){function t(){}return t.prototype.init=function(t,e,i){this.index=t,this.type=e;var n=i[e-1][0];1==this.type?this.state=n:3==this.type?(this.mine=ObjectPool.pop("MineModel"),this.mine.init(n)):4==this.type?(this.sceneIndex=n[0],this.isExitUp=n[1],this.isExitDown=n[2]):5==this.type?this.actorId=n:6==this.type&&(this.mine=mineControl.getMineByIndex(this.index),this.mine&&this.mine.init(n))},t.prototype.handler=function(){if(1==this.type){var t=mineControl.getMineByIndex(this.index);if(t){t.isBeFight=1==this.state;var e=UnitMgr.ins().getMineByIndex(this.index);e&&e.updateTitleState()}}else if(2==this.type)mineControl.remove(this.index);else if(3==this.type)mineControl.add(this.mine);else if(4==this.type)mineControl.isExitUp=this.isExitUp,mineControl.isExitDown=this.isExitDown,mineControl.index=this.sceneIndex,mineControl.createTransfer();else if(5==this.type){var t=mineControl.getMineByIndex(this.index);if(t){t.beFightActorID.push(this.actorId);var e=UnitMgr.ins().getMineByIndex(this.index);e&&e.updateTitleState()}}else if(6==this.type){var e=UnitMgr.ins().getMineByIndex(this.index);e&&e.updateModel()}},t.prototype.destroy=function(){this.mine=null,ObjectPool.push(this)},t}();__reflect(MineSceneInfoVo.prototype,"MineSceneInfoVo");var WeaponSoulBreakView=function(t){function e(){var e=t.call(this)||this;return e.calldesc="",e.skinName="WeaponSoulBreakViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.btnjihuo,this.onClick),this.removeEventTouchTap(this.btntupo,this.onClick),this.removeEventTouchTap(this.btnlianhua,this.onClick),this.removeEventTouchTap(this.bgClose,this.onClick),this.fgClose&&this.removeEventTouchTap(this.fgClose,this.onClick),TimerMgr.ins().remove(this.timeClock,this),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.upLvEff),DisplayUtils.removeFromParent(this.finisheff);for(var i=0;i<this.effs.length;i++)DisplayUtils.removeFromParent(this.effs[i])},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btnjihuo,this.onClick),this.addEventTouchTap(this.btntupo,this.onClick),this.addEventTouchTap(this.btnlianhua,this.onClick),this.addEventTouchTap(this.bgClose,this.onClick),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onClick),this.addCustomEvent(140,this.callback),this.tipsType=t[0],this.roleId=t[1],this.slot=t[2],this.effs=[],this.flys=[],this.update()},e.prototype.callback=function(){tipsControl.showTips(LangMgr.getValueByKey("warnTips19",this.calldesc)),this.calldesc==LangMgr.getValueByKey("smeltActivity")?(this.star.visible=!0,this.lock.visible=!1,this.tipsType=e.SHENGJI,this.callbackToUpdate()):this.calldesc==LangMgr.getValueByKey("dressUpdate")?this.playUpLvEff():this.calldesc==LangMgr.getValueByKey("warnTips20")&&this.playflyEff()},e.prototype.callbackToUpdate=function(){var t=heroControl.getSubRoleByIndex(this.roleId),i=t.weapons.getSlotByInfo(this.slot);Assert(i,"WeaponSoulBreakView slot:"+this.slot+", roleId:"+this.roleId),i&&i.assault?this.tipsType=e.TUPO:this.calldesc==LangMgr.getValueByKey("warnTips20")&&(this.btntupo.touchEnabled=!0,this.tipsType=e.SHENGJI),this.update()},e.prototype.update=function(){var t=DataCenter.ins().WeaponSoulPosConfig[this.slot];if(this.tipsType==e.JIHUO){this.title.text=LangMgr.getValueByKey("smeltActivity"),this.star.visible=!1,this.lock.visible=!0,this.jihuo.visible=!0,this.tupo.visible=!1,this.lianhua.visible=!1,this.item1.imgIcon.source="b_"+t[0].icon+"_png",this.item1.imgBg.visible=!1,this.item1.imgJob.visible=!1,this.name1.text=t[0].name;var i=backpackControl.getBagItemById(t[0].costItem),n=i?i.count:0;if(this.material1.data={costItem:t[0].costItem,costNum:t[0].costNum,sum:n},t[1].attr){var o=AttributeData.getAttrStrByType(t[1].attr[0].type);this.jhattr0.text=o+"+"+t[1].attr[0].value,this.jhattr1.visible=!0,t[1].attr[1]?(o=AttributeData.getAttrStrByType(t[1].attr[1].type),this.jhattr1.text=o+"+"+t[1].attr[1].value):this.jhattr1.visible=!1}this.needItemId=t[0].costItem,this.curSum=n,this.maxSum=t[0].costNum}else if(this.tipsType==e.TUPO){this.title.text=LangMgr.getValueByKey("warnTips20"),this.star.visible=!0,this.lock.visible=!1;var s=heroControl.getSubRoleByIndex(this.roleId),r=s.weapons.getSlotByInfo(this.slot);if(this.jihuo.visible=!1,this.tupo.visible=!0,this.lianhua.visible=!1,this.item1.imgIcon.source="b_"+t[0].icon+"_png",this.item1.imgBg.visible=!1,this.item1.imgJob.visible=!1,this.name3.text=t[0].name,this.tpattr1.text=r.showlv+"",this.tpattr2.text=r.assault+"",this.tpright0.x=this.tpattr1.x+this.tpattr1.width,this.tpattr2.x=this.tpright0.x+this.tpright0.width,r.attr){this.tpattr0.text=AttributeData.getAttrStrByType(r.attr[0].type),this.tpattr3.text=r.attr[0].value+"";var a=DataCenter.ins().WeaponSoulPosConfig[r.id][r.level+1];this.tpattr4.text=a.attr[0].value+"",this.tpright1.x=this.tpattr3.x+this.tpattr3.width,this.tpattr4.x=this.tpright1.x+this.tpright1.width,r.attr[1]&&a.attr[1]?(this.g2.visible=!0,this.tpattr5.text=AttributeData.getAttrStrByType(r.attr[1].type),this.tpattr6.text=r.attr[1].value+"",this.tpattr7.text=a.attr[1].value+"",this.tpright2.x=this.tpattr6.x+this.tpattr6.width,this.tpattr7.x=this.tpright2.x+this.tpright2.width):this.g2.visible=!1}var i=backpackControl.getBagItemById(r.costItem),n=i?i.count:0;this.material.data={costItem:r.costItem,costNum:r.costNum,sum:n},this.needItemId=r.costItem,this.curSum=n,this.maxSum=r.costNum}else if(this.tipsType==e.SHENGJI){this.title.text=LangMgr.getValueByKey("warnTips21"),this.star.visible=!0,this.lock.visible=!1,this.lianhua.visible=!0,this.jihuo.visible=!1,this.tupo.visible=!1;var s=heroControl.getSubRoleByIndex(this.roleId),r=s.weapons.getSlotByInfo(this.slot),l=DataCenter.ins().WeaponSoulPosConfig[r.id][0],a=DataCenter.ins().WeaponSoulPosConfig[r.id][r.level+1];if(!a)return this.costgroup0.visible=!1,this.btnlianhua.visible=this.costgroup0.visible,this.lhright1.visible=this.costgroup0.visible,this.lhright0.visible=this.costgroup0.visible,this.lhattr4.visible=this.costgroup0.visible,this.lhattr6.visible=this.costgroup0.visible,this.maxdesc0.visible=!this.costgroup0.visible,this.lhright2.visible=this.costgroup0.visible,this.lhattr8.visible=this.costgroup0.visible,r.attr&&(this.lhattr3.text=r.showlv+"",this.lhattr1.text=AttributeData.getAttrStrByType(r.attr[0].type),this.lhattr5.text=r.attr[0].value+"",r.attr[1]?(this.attr2.visible=!0,this.lhattr2.text=AttributeData.getAttrStrByType(r.attr[1].type),this.lhattr7.text=r.attr[1].value+""):this.attr2.visible=!1),this.name2.text=l.name,this.item1.imgIcon.source="b_"+l.icon+"_png",this.item1.imgBg.visible=!1,this.item1.imgJob.visible=!1,this.updateEff(),void this.addCheckEff();if(this.item1.imgIcon.source="b_"+l.icon+"_png",this.item1.imgBg.visible=!1,this.item1.imgJob.visible=!1,this.name2.text=l.name,r.attr){this.lhattr3.text=r.showlv+"",this.lhattr4.text=a.showlv+"",this.lhright1.x=this.lhattr3.x+this.lhattr3.width+this.lhright1.width,this.lhattr4.x=this.lhright1.x,this.lhattr1.text=AttributeData.getAttrStrByType(r.attr[0].type),this.lhattr5.text=r.attr[0].value+"",this.lhattr6.text=a.attr[0].value+"",this.lhright0.x=this.lhattr5.x+this.lhattr5.width+this.lhright0.width,this.lhattr6.x=this.lhright0.x,r.attr[1]&&a.attr[1]?(this.attr2.visible=!0,this.lhattr2.text=AttributeData.getAttrStrByType(r.attr[1].type),this.lhattr7.text=r.attr[1].value+"",this.lhattr8.text=a.attr[1].value+"",this.lhright2.x=this.lhattr7.x+this.lhattr7.width+this.lhright2.width,this.lhattr8.x=this.lhright2.x):this.attr2.visible=!1;var i=backpackControl.getBagItemById(r.costItem),n=i?i.count:0,h=DataCenter.ins().ItemConfig[r.costItem];this.micon0.source=h.icon+"_png";var u=void 0;u=n>=r.costNum?ColorUtils.GREEN:ColorUtils.RED,this.countLabel1.textFlow=TextUtils.generateTextFlow1("|C:"+u+"&T:"+n+"|/|C:"+ColorUtils.NORMAL_COLOR+"&T:"+r.costNum),this.needItemId=r.costItem,this.curSum=n,this.maxSum=r.costNum}}this.updateEff(),this.addCheckEff()},e.prototype.updateEff=function(){if(this.star.visible){var t=heroControl.getSubRoleByIndex(this.roleId),i=t.weapons.getSlotByInfo(this.slot);if(!i)return void tipsControl.showTips(LangMgr.getValueByKey("warnTips22"));if(this.cirimg.visible=!0,!i.level){for(var n=0;n<e.maxCir;n++)this["s"+n].visible=!1;return void(this.cirimg.visible=!1)}if(this.maxdesc0.visible||this.tipsType==e.TUPO){for(var n=0;n<e.maxCir;n++)this["s"+n].visible=!0;return void DisplayUtils.drawCir(this._shap,this.star.width>>1,360)}for(var o=i.level%10,n=0;n<e.maxCir;n++)o?this["s"+n].visible=o>n:this["s"+n].visible=!1,this._shap||(this._shap=new egret.Shape),this._shap.parent||(this.star.addChild(this._shap),this.cirimg.mask=this._shap,this._shap.x=this._shap.y=this.star.width>>1,this._shap.rotation=-90),n>0&&o>0?DisplayUtils.drawCir(this._shap,this.star.width>>1,360*(o-1)/e.maxCir):this._shap.graphics.clear()}},e.prototype.addCheckEff=function(){for(var t=0;t<e.maxCir;t++)if(this["s"+t].visible){if(!this.effs[t]){var i=new GameMovieClip;this.effs[t]=i}this.effs[t].parent||this["star"+t].addChild(this.effs[t]),this.effs[t].x=21,this.effs[t].y=21,this.effs[t].playFile(PATH_EFF+"bally2",-1)}else this.effs[t]&&this.effs[t].parent&&DisplayUtils.removeFromParent(this.effs[t])},e.prototype.playUpLvEff=function(){this.upLvEff||(this.upLvEff=new GameMovieClip),this.upLvEff.parent||this.star.addChild(this.upLvEff),this.upLvEff.x=145,this.upLvEff.y=140;var t=this;this.upLvEff.playFile(PATH_EFF+"forgeSuccess",1,function(){DisplayUtils.removeFromParent(t.upLvEff)}),t.callbackToUpdate()},e.prototype.playflyEff=function(){for(var t=this,e=function(e){if(i.effs[e]&&i.effs[e].parent){i.flys[e]=!0;var n=i.item1.localToGlobal();i["star"+e].globalToLocal(n.x+38,n.y+38,n),egret.Tween.get(i.effs[e]).to({x:n.x,y:n.y},500).call(function(){t.flys[e]=!1,egret.Tween.removeTweens(t.effs[e]),DisplayUtils.removeFromParent(t.effs[e])})}},i=this,n=0;n<this.effs.length;n++)e(n);TimerMgr.ins().remove(this.timeClock,this),TimerMgr.ins().doTimer(100,0,this.timeClock,this)},e.prototype.timeClock=function(){for(var t=0;t<this.flys.length;t++)if(this.flys[t])return;TimerMgr.ins().remove(this.timeClock,this),this.finisheff||(this.finisheff=new GameMovieClip),this.finisheff.parent||this.star.addChild(this.finisheff),this.finisheff.x=145,this.finisheff.y=140;var e=this;this.finisheff.playFile(PATH_EFF+"spirittupo",1,function(){e.callbackToUpdate(),DisplayUtils.removeFromParent(e.finisheff)})},e.prototype.onClick=function(t){switch(t.target){case this.btnjihuo:case this.btntupo:if(t.target==this.btnjihuo?this.calldesc=LangMgr.getValueByKey("smeltActivity"):(this.calldesc=LangMgr.getValueByKey("warnTips20"),this.btntupo.touchEnabled=!1),this.curSum<this.maxSum)return tipsControl.showTips(LangMgr.getValueByKey("materialEnought")),void warnControl.setBuyGoodsWarn(this.needItemId);weaponsSoulControl.upWeaponsUpLevel(this.roleId,this.slot),SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN);break;case this.btnlianhua:if(this.curSum<this.maxSum)return tipsControl.showTips(LangMgr.getValueByKey("materialEnought")),void warnControl.setBuyGoodsWarn(this.needItemId);this.calldesc=LangMgr.getValueByKey("dressUpdate"),weaponsSoulControl.upWeaponsUpLevel(this.roleId,this.slot),SoundUtils.ins().playEffect(SoundUtils.STRENGTHEN);break;case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e.TUPO=1,e.JIHUO=2,e.SHENGJI=3,e.maxCir=9,e}(BaseEuiView);__reflect(WeaponSoulBreakView.prototype,"WeaponSoulBreakView");var MineChoseWorkerView=function(t){function e(){var e=t.call(this)||this;return e._cost=0,e.skinName="MineChoseWorkerViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.record.itemRenderer=MineChoseWorkerItemRenderer},e.prototype.open=function(){this.addCustomEvent(244,this.update),this.addEventTouchTap(this.advance,this.onTap),this.addEventTouchTap(this.start,this.onTap),this.initList(),this.update()},e.prototype.onTap=function(t){var e=this,i=t.currentTarget;if(i==this.advance){if(!this.openCheck())return;if(this.isMaxLevel())return void tipsControl.showCenterTips(LangMgr.getValueByKey("maxLevel"));var n=this.checkBox.selected?1:2;if(this.checkBox.selected){var o=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MineConfig.needItem.id);if(o<DataCenter.ins().MineConfig.needItem.count)return void tipsControl.showTips(LangMgr.getValueByKey("zhuzaiPropEnought1"))}else if(ActorControl.yb<this._cost)return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"));mineControl.upRefresh(n)}else if(i==this.start){if(!this.openCheck())return;if(!this.isMaxLevel())return void warnControl.show(LangMgr.getValueByKey("millionTips10"),function(){mineControl.upStart(),e.checkBox.selected=!1,UIMgr.ins().close(e)},this);mineControl.upStart(),UIMgr.ins().close(this)}},e.prototype.initList=function(){var t=DataCenter.ins().MineSourceConfig,e=[];for(var i in t)e.push(t[i]);this.record.dataProvider=new eui.ArrayCollection(e),this._lastMineId=mineControl.mineId},e.prototype.update=function(){var t=DataCenter.ins().MineConfig.refreshCost,e=t.length,i=mineControl.mineFreshCount,n=i>=e?t[e-1]:t[i];this._cost=n,this.yuanbaoNum.text=""+n;var o=backpackControl.getBagGoodsCountById(0,DataCenter.ins().MineConfig.needItem.id),s=65280;o<DataCenter.ins().MineConfig.needItem.count&&(s=16711680),this.num1.textFlow=TextUtils.generateTextFlow1("|C:"+s+"&T:"+o),this.needlabel.text="/"+DataCenter.ins().MineConfig.needItem.count;var r=payControl.franchise?DataCenter.ins().FranchiseConfig.addKuangCount:0,a=DataCenter.ins().MineConfig.maxOpenKuangCount+r,l=mineControl.mineCount;if(l>=a?this.countTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips11",a-l,a)):this.countTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips11",a-l,a)),mineControl.mineId){var h=DataCenter.ins().MineSourceConfig[mineControl.mineId];this.expBar0.maximum=h.maxTimes,this.expBar0.value=Math.ceil(h.maxTimes/h.baseTime*mineControl.mineQuaCount)}else this.expBar0.maximum=10,this.expBar0.value=0;this.isMaxLevel()&&(this.expBar0.maximum=10,this.expBar0.value=0),this._lastMineId!=mineControl.mineId&&(this.record.dataProvider.refresh(),this._lastMineId=mineControl.mineId)},e.prototype.isMaxLevel=function(){var t=mineControl.mineId+1;return DataCenter.ins().MineSourceConfig[t]?!1:!0},e.prototype.openCheck=function(){return mineControl.mineCount>=mineControl.getCanMineCount()?(tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips12")),!1):mineControl.mineStartTime?(tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips13")),!1):!0},e.openCheck=function(){return mineControl.mineId||mineControl.upRefresh(),mineControl.mines.length>=DataCenter.ins().MineConfig.maxKuangCount?(tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips14")),!1):!0},e}(BaseEuiView);__reflect(MineChoseWorkerView.prototype,"MineChoseWorkerView");var MineFinishOutsideView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e.skinName="MineFinishOutsideViewSkin",e.doubleImg1.visible=!1,e.doubleImg2.visible=!1,e.doubleImg0.visible=!1,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.gotoBtn,this.onTap),this.addEventTouchTap(this.tipsCheckbox,this.onTap),this.updateData()},e.openCheck=function(){ClientStorage;var t=ClientStorage.ins().getValue("isTipsMineFinish");return!t},e.prototype.updateData=function(){var t=ClientStorage.ins().getValue("isTipsMineFinish");this.tipsCheckbox.selected=!!t;var e=this.getAwards();this.rewardShow.itemRenderer=ItemBase,this.rewardShow.dataProvider=new eui.ArrayCollection(e)},e.prototype.getAwards=function(){var t=mineControl.finishedData,e=DataCenter.ins().MineSourceConfig[t.configID],i=backpackControl.getAwardByOpenDay(e.rewards),n=[].concat(i);e.rewardItem&&(n=n.concat(backpackControl.getAwardByOpenDay(e.rewardItem)));for(var o=[],s=0,r=mineControl.finishedData.beRob,a=0;a<r.length;a++)r[a].win&&(s+=1);for(var a=0;a<n.length;a++){var l=RewardVo.copy(n[a]);if(o.push(l),s&&a<i.length){var h=Math.ceil(l.count*e.robPrecent/100)*s;l.count-=h}}return o},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.closeBtn)UIMgr.ins().close(this);else if(e==this.gotoBtn)UIMgr.ins().close(this),mineControl.upIntoMine();else if(e==this.tipsCheckbox){var i=this.tipsCheckbox.selected;ClientStorage.ins().setValue("isTipsMineFinish",i?1:0)}},e}(BaseEuiView);__reflect(MineFinishOutsideView.prototype,"MineFinishOutsideView");var MineHelpResultView=function(t){function e(){var e=t.call(this)||this;return e.time=5,e.uilayer=GameLayer.POPUP,e.skinName="MineHelpResultViewSkin",e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.quitBtn,this.onTap),this.quitBtn.name=this.quitBtn.label,t?(this.result.source="win_02",this.bg.source="resultWin_png",this.resultImg.source="peakness_win",this.lose.visible=!1,this.resText.visible=!0):(this.result.source="lost_02",this.bg.source="resultLost_png",this.resultImg.source="peakness_lose",this.lose.visible=!0,this.resText.visible=!1);var e=mineControl.curHelpData;e?t?this.resText.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("chenggongkoto",e.sendPlayerName,e.targetPlayerName)):this.losePlayer.text=e.targetPlayerName:t?this.resText.text=LangMgr.getValueByKey("xiezhuok"):this.losePlayer.text="",this.time=6,this.updateCloseBtnLabel(),toseongControl.isToseong||TimerMgr.ins().doTimer(1e3,this.time,this.updateCloseBtnLabel,this)},e.prototype.updateCloseBtnLabel=function(){this.time--,this.time<=0&&UIMgr.ins().close(this),this.quitBtn.label=this.quitBtn.name+"("+this.time+"s)"},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.close=function(){copyControl.upExitFb()},e}(BaseEuiView);__reflect(MineHelpResultView.prototype,"MineHelpResultView");var MinePanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.go,this.onTap),this.addCustomEvent(618,this.updateRedPoint),this.update()},e.prototype.update=function(){var t=payControl.franchise?DataCenter.ins().FranchiseConfig.addKuangCount:0,e=DataCenter.ins().MineConfig.maxOpenKuangCount+t,i=mineControl.mineCount;this.workNum.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("millionTips17",e-i,e));var n=DataCenter.ins().MineConfig.maxRobCount,o=mineControl.robCount;this.plunderNum.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("millionTips18",n-o,n)),this.updateRedPoint()},e.prototype.updateRedPoint=function(){this.redPoint.visible=MineRedPoint.ins().redPoint},e.prototype.onTap=function(t){crossArenaControl.checkIsMatching()&&(copyControl.checkInFB()||mineControl.upIntoMine())},e}(BasePanel);__reflect(MinePanel.prototype,"MinePanel");var MinePlunderPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.dataPro=new eui.ArrayCollection,this.record.itemRenderer=MinePlunderItemRenderer,this.record.dataProvider=this.dataPro},e.prototype.open=function(){this.addEventTouchTap(this.nextBtn,this.onTap),this.addEventTouchTap(this.lastBtn,this.onTap),this.addCustomEvent(246,this.updateView),this.addCustomEvent(248,this.updateView),this.addCustomEvent(406,this.updateList),this.addCustomEvent(407,this.updateView),this.updateView(),mineControl.upGetPower(),TimerMgr.ins().isExists(this.updateTime,this)||TimerMgr.ins().loop(1e3,this.updateTime,this)},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().remove(this.updateTime,this)},e.prototype.updateTime=function(){for(var t=this.record.numChildren,e=0;t>e;e++){var i=this.record.getChildAt(e);i instanceof MinePlunderItemRenderer&&i.updateTime()}},e.prototype.updateView=function(){this.nextBtn.visible=mineControl.isExitDown,this.lastBtn.visible=mineControl.isExitUp,this.powerTxt.text=LangMgr.getValueByKey("wodepow")+ActorControl.power;var t=DataCenter.ins().MineConfig.maxRobCount-mineControl.robCount;this.robTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("shengyulvdoucs")+"|C:"+(t>0?"0x00ff00":"0xff0000")+"&T:"+t+"|"),this.dataPro.replaceAll(this.getList())},e.prototype.updateList=function(){for(var t=this.dataPro.source,e=0;e<t.length;e++){var i=t[e];this.dataPro.itemUpdated(i)}},e.prototype.getList=function(){for(var t=mineControl.mines,e=[],i=0;i<t.length;i++){var n=t[i];n.actorID!=ActorControl.actorID&&n.endTime-GameServer.serverTime>0&&e.push(n)}return e.sort(function(t,e){var i=t.isBeRobOver,n=e.isBeRobOver;if(i&&!n)return 1;if(!i&&n)return-1;if(i=t.isBeMeRob,n=e.isBeMeRob,i&&!n)return 1;if(!i&&n)return-1;var o=DataCenter.ins().MineSourceConfig[t.configID].level,s=DataCenter.ins().MineSourceConfig[e.configID].level;return s>o?1:o>s?-1:t.power<e.power?-1:1}),e},e.prototype.onTap=function(t){var e=t.currentTarget==this.nextBtn?1:0,i=UnitMgr.ins().getTransferById(e),n=UnitMgr.ins().getNoDieRole();n&&i&&(MapControl.point2Grip(i.x)==MapControl.point2Grip(n.x)&&MapControl.point2Grip(i.y)==MapControl.point2Grip(n.y)?(mineControl.upSceneChange(e),mineControl.upGetPower()):moveControl.mapClick({target:i,x:i.x,y:i.y}))},e}(BasePanel);__reflect(MinePlunderPanel.prototype,"MinePlunderPanel");var MinePlunderView=function(t){function e(){var e=t.call(this)||this;return e._curTabIndex=-1,e.uilayer=GameLayer.POPUP,e.skinName="MinePlunderViewSkin",e}return __extends(e,t),e.prototype.open=function(t){this.addCustomEvent(619,this.updateRed),this.addCustomEvent(620,this.updateRed),this.addEventTouchTap(this.closeBtn,this.onClose),this.addEventChange(this.tab,this.onTap),t=t||0,t!=this._curTabIndex&&this._curTabIndex>-1&&this.closePanel(this._curTabIndex),this._curTabIndex=t,this.viewStack.selectedIndex=this.tab.selectedIndex=this._curTabIndex,this.updateView(this._curTabIndex)},e.prototype.close=function(){this.closePanel(this._curTabIndex)},e.prototype.updateView=function(t){this._curTabIndex!=t&&this.viewStack.getElementAt(this._curTabIndex).close(),this._curTabIndex=t,this.viewStack.getElementAt(this._curTabIndex).open(),this.updateRed()},e.prototype.onTap=function(t){this.updateView(this.tab.selectedIndex)},e.prototype.updateRed=function(){this.redpoinit1.visible=MineRedPoint.ins().mineCanRob,this.redpoinit2.visible=MineRedPoint.ins().mineRecord},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(MinePlunderView.prototype,"MinePlunderView");var MineRecordPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.record.itemRenderer=MineRecordItemRenderer},e.prototype.open=function(){this.addCustomEvent(247,this.update),this.addCustomEvent(631,this.update),mineControl.upGetRecord(),this.update()},e.prototype.update=function(){this.record.dataProvider=new eui.ArrayCollection(mineControl.mineRecords)},e}(BasePanel);__reflect(MineRecordPanel.prototype,"MineRecordPanel");var MineResultView=function(t){function e(){var e=t.call(this)||this;return e.time=6,e.uilayer=GameLayer.POPUP,e.skinName="MineResultViewSkin",e.list0.itemRenderer=ResultFailItemRenderer,e.listItem.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.closeBtn.name=this.closeBtn.label
},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap);var i=t[0],n=t[1],o=t[2],s=t[3],r=t[4],a=t[5],l=t[6];if(i){this.win.visible=!0,this.title.source="win_02",this.bg.source="resultWin_png",this.defeat.visible=!1,73==n?(this.player1title.text=LangMgr.getValueByKey("qiangdouzhe"),this.player2title.text=LangMgr.getValueByKey("beiqiangdouzhe")):(this.player1title.text=LangMgr.getValueByKey("fucouzhe"),this.player2title.text=LangMgr.getValueByKey("qiangdouzhe"));var h=heroControl.getSubRoleByIndex(0);this.roleIcon.icon="yuanhead"+h.job+h.sex,this.roleIcon.jobImg.visible=!1;var u="|C:0xffee00&T:"+unionControl.guildName+"|\n"+ActorControl.myName;this.player1.textFlow=TextUtils.generateTextFlow1(u),u="|C:0xffee00&T:"+a+"|\n|C:0xff0000&T:"+r+"|",this.player2.textFlow=TextUtils.generateTextFlow1(u),this.roleIcon0.icon="yuanhead"+o+s,this.roleIcon0.jobImg.visible=!1}else this.win.visible=!1,this.title.source="lost_02",this.bg.source="resultLost_png",this.defeat.visible=!0,this.updateDefeatList();this.listItem.dataProvider=new eui.ArrayCollection(l),this.time=6,this.updateCloseBtnLabel(),toseongControl.isToseong||TimerMgr.ins().doTimer(1e3,this.time,this.updateCloseBtnLabel,this)},e.prototype.updateCloseBtnLabel=function(){this.time--,this.time<=0&&UIMgr.ins().close(this),this.closeBtn.label=this.closeBtn.name+"("+this.time+"s)"},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.close=function(){DangerWarnView.cancelCall=function(){copyControl.upExitFb()},mineControl.upIntoMine()},e.prototype.updateDefeatList=function(){var t=DieGuide.ins().getDiedGainWay();this.list0.dataProvider=new eui.ArrayCollection(t)},e}(BaseEuiView);__reflect(MineResultView.prototype,"MineResultView");var MineRobView=function(t){function e(){var e=t.call(this)||this;return e._stateIndex=0,e._states=["plunder","revenge","done"],e.skinName="MineRobViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.robaward.itemRenderer=ItemBase,this.awardList.itemRenderer=ItemBase,this.recordList.itemRenderer=MineDoneRecordItemRenderer,this.addEventTouchTap(this.handleBtn,this.onTap),this.addEventTouchTap(this["double"],this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(251,this.updateInfo),this._data=t[0],this.update()},e.prototype.updateInfo=function(t){0==this._stateIndex?this.power.text=""+t:1==this._stateIndex&&(this.enemyPower.text=""+t)},e.prototype.update=function(){this._data instanceof MineRecordVo?(this._stateIndex=1,mineControl.upGetRolePower(this._data.fighterActorID)):this._data instanceof MineModel?(this._stateIndex=0,mineControl.upGetRolePower(this._data.actorID)):this._stateIndex=2,this.currentState=this._states[this._stateIndex];var t=DataCenter.ins().MineSourceConfig[this._data.configID];if(0==this._stateIndex){var e=this._data;this.title.textColor=t.color,this.title.text=LangMgr.getValueByKey("millionCanRob",t.name),this.owner.text=e.name,this.power.text=e.power+"",this.gang.text=e.guildName||LangMgr.getValueByKey("persontNone");var i=DataCenter.ins().MineConfig.maxRobCount;this.workNum.text=LangMgr.getValueByKey("millionTips24",i-mineControl.robCount,i),this.awardList.dataProvider=new eui.ArrayCollection(this.getAward(t))}else if(1==this._stateIndex){var e=this._data;this.enemy.text=e.fighterName,this.enemyPower.text=e.fighterPower+"",this.myFace0.source="head_"+e.fighterJob+e.fighterSex,this.time.text=DateUtils.getFormatBySecond(e.time/1e3>>0,DateUtils.TIME_FORMAT_2),this.robaward.dataProvider=new eui.ArrayCollection(this.getAward(t))}else{this.getAwardTxt(t);var n=DataCenter.ins().NpcBaseConfig[t.npcId];this.worker.source=n.icon,this.nameTxt.text=t.name,this.nameTxt.textColor=t.color,this.cost.text=DataCenter.ins().MineConfig.doubleCost+"",mineControl.finishedData.beRob.length?this.noRob.visible=!1:this.noRob.visible=!0,this.recordList.dataProvider=new eui.ArrayCollection(mineControl.finishedData.beRob)}},e.prototype.getAward=function(t){for(var e=backpackControl.getAwardByOpenDay(t.rewards),i=[],n=t.robPrecent,o=0;o<e.length;o++){var s=new RewardVo;s.type=e[o].type,s.id=e[o].id,s.count=Math.ceil(e[o].count*n/100),i.push(s)}return i},e.prototype.getAwardTxt=function(t){var e=[].concat(backpackControl.getAwardByOpenDay(t.rewards));t.rewardItem&&(e=e.concat(backpackControl.getAwardByOpenDay(t.rewardItem)));for(var i=0,n=0,o=mineControl.finishedData.beRob;n<o.length;n++){var s=o[n];s.win&&(i+=1)}for(var r="",a="",l=0;l<e.length;l++){if(0==e[l].type)r+=Currency.getCurrencyName(e[l].id);else{var h=DataCenter.ins().ItemConfig[e[l].id];r+=h.name}if(r+="x"+e[l].count+"\n",i&&l<t.rewards.length){var u=Math.ceil(e[l].count*t.robPrecent/100)*i;a+="-"+u+"\n"}}this.reward.text=r,this.minus.text=a},e.prototype.onTap=function(t){var i=this,n=t.currentTarget;if(n==this.bgClose)2!=this._stateIndex&&UIMgr.ins().close(this);else if(n==this.handleBtn){if(1==this._stateIndex){if(!crossArenaControl.checkIsMatching())return;mineControl.upFightBack(this._data.index)}else if(0==this._stateIndex){if(!crossArenaControl.checkIsMatching())return;if(!e.openCheck(this._data))return;mineControl.upRob(this._data)}else{if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);mineControl.upGetAward()}UIMgr.ins().close(this),UIMgr.ins().close(MinePlunderView)}else if(n==this["double"]){if(ActorControl.yb<DataCenter.ins().MineConfig.doubleCost)return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"),function(){UIMgr.ins().close(i),copyControl.upExitFb()});if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);mineControl.upGetAward(!0),UIMgr.ins().close(this),UIMgr.ins().close(MinePlunderView)}else n==this.closeBtn&&(UIMgr.ins().close(this),e.noPrompt=!0)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];if(i instanceof MineModel){if(i.actorID==ActorControl.actorID)return!1;if(mineControl.robCount>=DataCenter.ins().MineConfig.maxRobCount)return tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips25")),!1;if(i.isBeMeRob)return tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips26")),!1;if(!mineControl.getMineByIndex(i.index,i.actorID))return tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips27")),!1;if(i.isBeRobOver)return tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips28")),!1;if(i.isBeFight)return tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips29")),!1}return!0},e.noPrompt=!1,e}(BaseEuiView);__reflect(MineRobView.prototype,"MineRobView");var MineSceneView=function(t){function e(){var e=t.call(this)||this;return e.skinName="MineSceneViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.quickFinish.textFlow=[{text:LangMgr.getValueByKey("millionFastFinsh"),style:{underline:!0}}],this.addEventTouchTap(this.quickFinish,this.onTap),this.addEventTouchTap(this.xiangqing,this.onTap),this.addEventTouchTap(this.mine,this.onTap),this.addCustomEvent(243,this.updateBase),this.addCustomEvent(246,this.updateScene),this.addCustomEvent(248,this.updateScene),this.addCustomEvent(620,this.recordHasUpdate),this.addCustomEvent(619,this.recordHasUpdate),this.addCustomEvent(632,this.updateScene),this.addCustomEvent(621,this.mineRedPoint),this.addCustomEvent(622,this.mineRedPoint),this.updateScene()},e.prototype.onTap=function(t){var e=t.currentTarget;e==this.quickFinish?this.openQuick():e==this.xiangqing?UIMgr.ins().open(MinePlunderView):e==this.mine&&(mineControl.finishedData?UIMgr.ins().open(MineRobView,mineControl.finishedData):UIMgr.ins().open(MineChoseWorkerView))},e.prototype.openQuick=function(){var t=Math.floor((1e3*this._totalTime+mineControl.mineStartTime-GameServer.serverTime)/1e3),e=Math.ceil(t/60),i=DataCenter.ins().MineConfig.quickCost*e;if(!(0>=i)){if(ActorControl.yb<i)return void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"));var n=LangMgr.getValueByKey("millionTips30",i);warnControl.show(n,function(){mineControl.upQuickFinish()},this)}},e.prototype.updateBase=function(){var t=mineControl.myMine;if(this.recordGroup.visible=!0,this.mineGroup.visible=this.recordGroup.visible,!mineControl.isOverTime()&&t){this.myGroup.visible=!0;var e=DataCenter.ins().MineSourceConfig[t.configID];this._totalTime=e.needTime,this.addTime()}else this.removeTime(),this.myGroup.visible=!1;this.mineRedPoint()},e.prototype.updateScene=function(){this.nameTxt.text=LangMgr.getValueByKey("millionTips31",mineControl.index),this.workerNum.text=LangMgr.getValueByKey("millionTips31",mineControl.mines.length),this.recordHasUpdate(),this.updateBase()},e.prototype.recordHasUpdate=function(){this.redPoint.visible=MineRedPoint.ins().mineCanRob||MineRedPoint.ins().mineRecord},e.prototype.mineRedPoint=function(){this.redPoint1.visible=MineRedPoint.ins().mineCanAward||MineRedPoint.ins().mineCanStart},e.prototype.addTime=function(){TimerMgr.ins().isExists(this.timeHandler,this)||TimerMgr.ins().doTimer(1e3,0,this.timeHandler,this)},e.prototype.timeHandler=function(){var t=Math.floor((mineControl.mineEndTime-GameServer.serverTime)/1e3);t>=0&&(this.time.text="（"+DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3)+"）")},e.prototype.removeTime=function(){TimerMgr.ins().remove(this.timeHandler,this)},e}(BaseEuiView);__reflect(MineSceneView.prototype,"MineSceneView");var MineChoseWorkerItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="MineChoseWorkerItemRendererSkin",e.reward.itemRenderer=ItemBase,e.doubleImg1.visible=!1,e.doubleImg2.visible=!1,e.doubleImg3.visible=!1,e.doubleImg4.visible=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchTap(this.yijiantianmo,this.onClick)},e.prototype.isMaxLevel=function(){var t=(mineControl.mineId||1)+1;return DataCenter.ins().MineSourceConfig[t]?!1:!0},e.prototype.onClick=function(){return mineControl.mineCount>=mineControl.getCanMineCount()?(tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips12")),!1):mineControl.mineStartTime?(tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips13")),!1):void(this.isMaxLevel()?tipsControl.showCenterTips(LangMgr.getValueByKey("maxLevel")):mineControl.hadMine&&DataCenter.ins().MineConfig.oneKeyMaxLvCost>ActorControl.yb?tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):(mineControl.upRefresh(3),mineControl.upStart(),UIMgr.ins().close(MineChoseWorkerView),tipsControl.showCenterTips(LangMgr.getValueByKey("mineTips1"))))},e.prototype.dataChanged=function(){var t=this.data;this.nameTxt.text=t.name,this.nameTxt.textColor=t.color;var e=[].concat(backpackControl.getAwardByOpenDay(t.rewards));t.rewardItem?(e=e.concat(backpackControl.getAwardByOpenDay(t.rewardItem)),this.cannot.visible=!0):this.cannot.visible=!1,this.reward.dataProvider=new eui.ArrayCollection(e);for(var i,n=e.length>4?4:e.length,o=1;n>=o;o++)this["doubleImg"+o].visible=i;var s=DataCenter.ins().NpcBaseConfig[t.npcId];this.worker.source=s.icon,this.btn1.visible=4==t.id,this.btn1.visible&&(this.zb1.text=DataCenter.ins().MineConfig.oneKeyMaxLvCost+"",this.eff||(this.eff=new GameMovieClip),this.yijianeff.addChild(this.eff),this.eff.playFile(PATH_EFF+"chargeff1",-1),this.firstfree.visible=!mineControl.hadMine),t.id==(mineControl.mineId||1)?this.selectedImg.visible=!0:this.selectedImg.visible=!1},e}(BaseItemRender);__reflect(MineChoseWorkerItemRenderer.prototype,"MineChoseWorkerItemRenderer");var MineDoneRecordItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="MineDoneRecordItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data.name,i=this.data.win,n=DataCenter.ins().MineSourceConfig[mineControl.finishedData.configID],o=n.color;i?this.des0.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips15",e,o,n.name)):this.des0.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips16",e,o,n.name))},e}(BaseItemRender);__reflect(MineDoneRecordItemRenderer.prototype,"MineDoneRecordItemRenderer");var MinePlunderItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.listPro=new eui.ArrayCollection,this.list0.itemRenderer=ItemBase,this.list0.dataProvider=this.listPro,this.addEventTouchTap(this.getAward,this.onTap)},e.prototype.onTap=function(){this.data.isBeRobOver?tipsControl.showTips(LangMgr.getValueByKey("thiskuangnotchange")):mineControl.robCount>=DataCenter.ins().MineConfig.maxRobCount?tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips25")):mineControl.getMineByIndex(this.data.index,this.data.actorID)?this.data.isBeFight?tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips29")):(mineControl.upRob(this.data),UIMgr.ins().close(MinePlunderView)):tipsControl.showCenterTips(LangMgr.getValueByKey("millionTips27"))},e.prototype.dataChanged=function(){this.labelGuild.text=this.data.guildName,this.label_name.text=this.data.name;var t=DataCenter.ins().MineSourceConfig[this.data.configID];this.nameTxt1.text=t.name,this.nameTxt1.textColor=t.color,this.place.text=LangMgr.getValueByKey("godFightValue","")+(this.data.power||0),this.worker1.source=DataCenter.ins().NpcBaseConfig[t.npcId].icon,this.listPro.replaceAll(this.getAwardList(t)),this.redpoinit.visible=this.getRedpoint(this.data),this.data.isBeRobOver?(this.getAward.enabled=!1,this.getAward.label=LangMgr.getValueByKey("alrqiangguang")):this.data.isBeMeRob?(this.getAward.enabled=!1,this.getAward.label=LangMgr.getValueByKey("alrlvdou")):(this.getAward.enabled=!0,this.getAward.label=LangMgr.getValueByKey("lvdoubtn")),this.updateTime()},e.prototype.updateTime=function(){var t=this.data.endTime-GameServer.serverTime;t=t>0?t:0,this.place0.text=LangMgr.getValueByKey("activitRest",DateUtils.getFormatBySecond(t/1e3>>0,DateUtils.TIME_FORMAT_10)),0==t&&MineRedPoint.ins().dispatchMineEnd()},e.prototype.getRedpoint=function(t){return mineControl.robCount>=DataCenter.ins().MineConfig.maxRobCount?!1:mineControl.getMineByIndex(t.index,t.actorID)?t.isBeRobOver||t.isBeMeRob||t.isBeMeFight?!1:!0:!1},e.prototype.getAwardList=function(t){for(var e=backpackControl.getAwardByOpenDay(t.rewards),i=[],n=0;n<e.length;n++){var o=new RewardVo;o.type=e[n].type,o.id=e[n].id,o.count=Math.ceil(e[n].count*t.robPrecent/100),i.push(o)}return i},e}(BaseItemRender);__reflect(MinePlunderItemRenderer.prototype,"MinePlunderItemRenderer");var MineRecordItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="MineRecordItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data,i=DataCenter.ins().MineSourceConfig[e.configID],n=i.color;this.time.text=DateUtils.getFormatBySecond(e.time/1e3>>0,DateUtils.TIME_FORMAT_2),this.help.visible=!1,this.revenge.visible=!1,this.removeEventTouchTap(this.revenge,this.onTap),e.type==MineRecordVo.TYPE_BEROB?e.fighterIsWin?(this.des.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips15ld",e.fighterName,n,i.name)),this.help.visible=!0,e.isBeatHim?(this.help.enabled=!1,this.help.label=LangMgr.getValueByKey("millionTips20"),this.removeEventTouchTap(this.revenge,this.onTap)):(this.help.enabled=!0,this.help.label=LangMgr.getValueByKey("hanrenbangmang"),this.revenge.visible=!0,this.addEventTouchTap(this.revenge,this.onTap,this),this.addEventTouchTap(this.help,this.onHelp,this))):this.des.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips21",e.fighterName,n,i.name)):e.robIsWin?this.des.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips22",e.robMasterName,n,i.name)):this.des.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("millionTips23",e.robMasterName,n,i.name))},e.prototype.onTap=function(){UIMgr.ins().open(MineRobView,this.data)},e.prototype.onHelp=function(){if(!unionControl.guildID)return void tipsControl.showTips(LangMgr.getValueByKey("xianaddunion"));var t=DataCenter.ins().MineConfig.sendMsgCD;if(GameServer.serverTime-mineControl.sendHelpMsgTime<1e3*t){var e=Math.ceil((1e3*t-(GameServer.serverTime-mineControl.sendHelpMsgTime))/1e3);return void tipsControl.showTips(LangMgr.getValueByKey("askforhelplengque",e))}mineControl.upHelpIdx(this.data.index)},e}(BaseItemRender);__reflect(MineRecordItemRenderer.prototype,"MineRecordItemRenderer");var NoticeControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downNotice=function(t,e,i){1==t?0==i&&MarqueeView.show(e):2==t&&(this.data||(this.data=new RambleInfoVo),this.data.str=e,this.data.type=7),3==t&&MarqueeView.show(e),rambleControl.dispatchSysChatMsg(new RambleSystemVo(t,e))},e.prototype.downNoticeOpen=function(t){this.isOpenNotice=t,noticeControl.dispatchGameNotice()},e.prototype.upSetNoticeOPen=function(){},e.prototype.dispatchGameNotice=function(){EventMgr.ins().dispatch(175)},__decorate([down(1,[2,8,4])],e.prototype,"downNotice",null),__decorate([down(2,[0])],e.prototype,"downNoticeOpen",null),__decorate([up(2)],e.prototype,"upSetNoticeOPen",null),e=__decorate([protocolsId(20)],e)}(BaseSystem);__reflect(NoticeControl.prototype,"NoticeControl");var MarqueeView=function(t){function e(){var e=t.call(this)||this;return e.list=[],e.startX=0,e.endX=0,e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.frame=new eui.Image,this.frame.source="zjmgonggaobg",this.frame.width=480,this.frame.height=28,this.frame.y=240,this.frame.x=StageUtils.ins().getWidth()/2-this.frame.width/2,this.addChild(this.frame),this.frame.visible=!1,this.touchChildren=!1,this.touchEnabled=!1,this.startX=this.frame.x+this.frame.width,this.endX=this.frame.x},e.show=function(t){var i=UIMgr.ins().open(e);i.setContent(t)},e.prototype.setContent=function(t){this.frame.visible=!0;var e=new eui.Label;e.size=20,e.textColor=LangMgr.getColor("color80"),e.stroke=1,e.strokeColor=ColorUtils.BLACK,e.x=this.startX,e.y=this.frame.y+4,e.textFlow=TextUtils.generateTextFlow(t),this.addChild(e),this.list.push(e),e.visible=!1,1==this.list.length&&this.rollContent()},e.prototype.rollContent=function(){var t=this,e=this.list[0],i=this.endX-e.width,n=egret.Tween.get(e);e.visible=!0,n.to({x:i},20*e.width).call(function(){t.removeChild(e),t.list.shift(),t.list.length<1?t.frame.visible=!1:t.rollContent()},this)},e}(BaseEuiView);__reflect(MarqueeView.prototype,"MarqueeView");var NoticeView=function(t){function e(){var e=t.call(this)||this;e.startTime=0,e.isTopLevel=!0,e.rect=new eui.Rect,e.rect.left=e.rect.right=e.rect.top=e.rect.bottom=0,e.rect.fillAlpha=.7,e.addChild(e.rect);var i=new eui.Group;i.horizontalCenter=0,i.verticalCenter=-50,i.width=522,i.height=697,e.addChild(i),e.bg=new eui.Image,e.bg.source=PATH_ROOT+"startgame/ntcbg.png",i.addChild(e.bg),e.closeBtn=new egret.Sprite,e.closeBtn.x=440,e.closeBtn.y=5,e.closeBtn.graphics.beginFill(0,0),e.closeBtn.graphics.drawRect(0,0,53,50),e.closeBtn.graphics.endFill(),e.closeBtn.touchEnabled=!0,i.addChild(e.closeBtn);var n=new egret.ScrollView;n.x=30,n.y=62,n.width=i.width-2*n.x,n.height=i.height-n.x-n.y,i.addChild(n);var o=new egret.DisplayObjectContainer;return n.setContent(o),e.desc=new egret.TextField,e.desc.size=20,e.desc.width=n.width,e.desc.textColor=10458221,o.addChild(e.desc),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap);var i=GlobalModel.getUrlParamValue("notice");if(this.startTime=Date.now(),i&&i.length>0){var n=i.split("_");this.desc.textFlow=TextUtils.generateTextFlow(n[1]),this.desc.height=this.desc.textHeight}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),ReportData.getIns().reportIntervalPoint(Date.now()-this.startTime,3,GlobalModel.serverNumberPlyer<=1)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(NoticeView.prototype,"NoticeView");var PartnerControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.friendsList=new eui.ArrayCollection,e.recentList=new eui.ArrayCollection,e.appList=new eui.ArrayCollection,e.blackList=new eui.ArrayCollection,e.newMsgThre={},e.chatList={},e.newMsg={},e._selectedRoleId=0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.upAppList()},e.prototype.upFriendsList=function(){},e.prototype.upRecentList=function(){},e.prototype.upAppList=function(){},e.prototype.upBlackList=function(){},e.prototype.upAddFriend=function(t,e){if(1e3*reincarnateControl.lv+ActorControl.level<DataCenter.ins().PartnerLimitConfig.addFriendLv){var i=DataCenter.ins().PartnerLimitConfig.addFriendLv>1e3?LangMgr.getValueByKey("numberRotation",DataCenter.ins().PartnerLimitConfig.addFriendLv/1e3>>0):"",n=DataCenter.ins().PartnerLimitConfig.addFriendLv>1e3?LangMgr.getValueByKey("numberLevel",DataCenter.ins().PartnerLimitConfig.addFriendLv%1e3):LangMgr.getValueByKey("numberLevel",DataCenter.ins().PartnerLimitConfig.addFriendLv);return tipsControl.showTips(LangMgr.getValueByKey("friendOpenFunc",i+n)),!1}if(-1!=this.indexOfBlackList(t))return tipsControl.showTips(LangMgr.getValueByKey("friendAddPlayer")),!1;for(var o=0,s=this.blackList.source;o<s.length;o++){var r=s[o],a=r;if(a.name==e)return tipsControl.showTips(LangMgr.getValueByKey("friendAddPlayer")),!1}return[t,e]},e.prototype.upAddBlackList=function(t,e){if(1e3*reincarnateControl.lv+ActorControl.level<DataCenter.ins().PartnerLimitConfig.blackListLv){var i=DataCenter.ins().PartnerLimitConfig.blackListLv>1e3?LangMgr.getValueByKey("numberRotation",DataCenter.ins().PartnerLimitConfig.blackListLv/1e3>>0):"",n=DataCenter.ins().PartnerLimitConfig.blackListLv>1e3?LangMgr.getValueByKey("numberLevel",DataCenter.ins().PartnerLimitConfig.blackListLv%1e3):LangMgr.getValueByKey("numberLevel",DataCenter.ins().PartnerLimitConfig.blackListLv);return tipsControl.showTips(LangMgr.getValueByKey("friendOpenFunc",i+n)),!1}return[t,e]},e.prototype.upAgreeApp=function(t,e){return[t,e]},e.prototype.upDelete=function(t,e){return[t,e]},e.prototype.upChat=function(t,e,i){if(void 0===i&&(i=0),!rambleControl.checkCanSpeak())return rambleControl.chatLimit(0,t,e),!1;if(!SwitchMgr.ins().checkOpen(43,!0))return!1;var n=this.indexOfFriendList(t),o=this.friendsList.getItemAt(n);return o?ReportData.getIns().reportChatInfo(3,e,t,o.name):tipsControl.showTips(LangMgr.getValueByKey("partnerTips1")),[t,e,i]},e.prototype.upRecentChat=function(t){return[t]},e.prototype.downFriendsList=function(t){this.paserList(1,t),this.dispatchFriendChange()},e.prototype.downRencentList=function(t){this.paserList(2,t),this.dispatchFriendChange()},e.prototype.downAppList=function(t){this.paserList(3,t),this.dispatchFriendChange()},e.prototype.downBlackList=function(t){this.paserList(4,t),this.dispatchFriendChange()},e.prototype.downAddListMsg=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];2!=t&&(this.paserAddData(t,e),this.dispatchFriendChange())},e.prototype.downRemoveListMsg=function(t,e){2!=t&&(this.paserRemoveData(t,e),this.dispatchFriendChange())},e.prototype.downFriendsStateChange=function(t,e){this.paserOnlineChange(t,e),this.dispatchFriendChange()},e.prototype.downSendResult=function(t,e,i,n){0!=t&&this.paserChatMsg(1,e,i,n),this.dispatchFriendChange()},e.prototype.downChatAdd=function(t,e,i){this.insertFriendChat(0,t,e,i)},e.prototype.insertFriendChat=function(t,e,i,n){this.paserChatMsg(t,e,i,n),this.dispatchFriendChange(),this.paserOnlineChange(e,1)},e.prototype.downRecentChatList=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1],o=t[e][2];if(-1==this.indexOfBlackList(i))for(var s=0;e<this.recentList.length;e++){var r=this.recentList.getItemAt(s);if(r.id==i){r.lastMsg=o,r.offLineSec=n;break}}}this.dispatchFriendChange()},e.prototype.dispatchFriendChange=function(){EventMgr.ins().dispatch(212)},e.prototype.dispatchChatToFriend=function(t){EventMgr.ins().dispatch(214,t)},e.prototype.indexOfFriendList=function(t){for(var e=-1,i=0;i<this.friendsList.length;i++){var n=this.friendsList.getItemAt(i);if(n&&n.id==t){e=i;break}}return e},e.prototype.indexOfBlackList=function(t){for(var e=-1,i=0;i<this.blackList.length;i++){var n=this.blackList.getItemAt(i);if(n&&n.id==t){e=i;break}}return e},e.prototype.indexOfRecentList=function(t){for(var e=-1,i=0;i<this.recentList.length;i++){var n=this.recentList.getItemAt(i);if(n&&n.id==t){e=i;break}}return e},e.prototype.indexOfAppList=function(t){for(var e=-1,i=0;i<this.appList.length;i++){var n=this.appList.getItemAt(i);if(n&&n.id==t){e=i;break}}return e},e.prototype.sortFriendList=function(){var t=this.friendsList.source,e=[],i=[],n=this;t.forEach(function(t){1==t.online?e.push(t):i.push(t)}),e.sort(function(t,e){return void 0==n.newMsgThre[t.id]&&(n.newMsgThre[t.id]=0),void 0==n.newMsgThre[e.id]&&(n.newMsgThre[e.id]=0),n.newMsgThre[t.id]<n.newMsgThre[e.id]?1:n.newMsgThre[t.id]>n.newMsgThre[e.id]?-1:e.zs!=t.zs?e.zs-t.zs:e.lv-t.lv}),i.sort(function(t,e){return void 0==n.newMsgThre[t.id]&&(n.newMsgThre[t.id]=0),void 0==n.newMsgThre[e.id]&&(n.newMsgThre[e.id]=0),n.newMsgThre[t.id]<n.newMsgThre[e.id]?1:n.newMsgThre[t.id]>n.newMsgThre[e.id]?-1:e.zs!=t.zs?e.zs-t.zs:e.lv-t.lv}),t=e.concat(i),this.friendsList.replaceAll(t)},e.prototype.sortAppList=function(){var t=this.appList.source;t.sort(function(t,e){return e.power-t.power}),this.appList.replaceAll(t)},e.prototype.paserList=function(t,e){for(var n=[],o=0;o<e.length;o++){var s=new PartnerVo(t);s.init(e[o]),n.push(s)}switch(t){case 1:this.friendsList.source=n,this.sortFriendList();break;case 2:break;case 3:ServerStorage.ins().getBitBool(ClientSetBit.hide_friend_req)&&(n.length=0),n.length>i.MAXNUM&&(n=n.slice(n.length-i.MAXNUM,i.MAXNUM)),this.appList.source=n,this.sortAppList();break;case 4:this.blackList.replaceAll(n)}},e.prototype.paserAddData=function(t,e){var i=new PartnerVo(t);i.init(e);var n=["friendsList","recentList","appList","blackList"][t-1],o=-1;if(1==t?o=this.indexOfFriendList(i.id):2==t?o=this.indexOfRecentList(i.id):3==t?o=this.indexOfAppList(i.id):4==t&&(o=this.indexOfBlackList(i.id),this.paserRemoveData(1,i.id),this.paserRemoveData(2,i.id),this.paserRemoveData(3,i.id),rambleControl.removeChatWithId(i.id),unionControl.removeMsgWithId(i.id)),this[n]&&2!=t)if(o>-1)this[n].replaceItemAt(i,o);else{if(3==t&&ServerStorage.ins().getBitBool(ClientSetBit.hide_friend_req))return;this[n].addItemAt(i,0)}this.sortFriendList(),this.sortAppList()},e.prototype.paserRemoveData=function(t,e){var i=["friendsList","recentList","appList","blackList"][t-1],n=-1;this[i]&&(1==t?(n=this.indexOfFriendList(e),this.newMsg[e]=!1):2==t?(n=this.indexOfRecentList(e),this.newMsg[e]=!1):3==t?n=this.indexOfAppList(e):4==t&&(n=this.indexOfBlackList(e)),n>-1&&this[i].removeItemAt(n))},e.prototype.paserOnlineChange=function(t,e){var i=this.indexOfFriendList(t);if(i>-1){var n=this.friendsList.getItemAt(i);n.id==t&&(n.online=e,0==n.online?this.friendsList.replaceItemAt(n,i):(this.friendsList.removeItemAt(i),this.friendsList.addItemAt(n,0)))}},e.prototype.paserChatMsg=function(t,e,i,n){if(!(this.indexOfBlackList(e)>-1)){var o=this.indexOfFriendList(e);if(o>-1){var s=this.friendsList.getItemAt(o),r=new PartnerVo(1);r.id=ActorControl.actorID,r.job=heroControl.getSubRoleByIndex(0).job,r.sex=heroControl.getSubRoleByIndex(0).sex,r.power=ActorControl.power,0==t?s.addChat(new ChatData(s,r,i,n)):1==t&&s.addChat(new ChatData(r,s,i,n)),0==t&&this.selectedRoleId!=e&&(this.newMsg[e]=!0,this.newMsgThre[e]=egret.getTimer(),this.dispatchNewMsg())}var a=this.indexOfRecentList(e);if(a>-1){var s=this.recentList.getItemAt(a);s.lastMsg=n,a>0&&s.id!=this.selectedRoleId?(this.recentList.removeItemAt(a),this.addRecentList(s,0)):this.recentList.itemUpdated(s)}else if(o>-1){var s=this.friendsList.getItemAt(o);s.lastMsg=n,this.addRecentList(s,0)}else debug.log("id:"+e+"/ msg:"+n);this.sortFriendList(),this.sortAppList()}},e.prototype.dispatchNewMsg=function(){},e.prototype.getFriendIndex=function(t){for(var e=0;;){var i=this.friendsList.getItemAt(e);if(!i)return-1;if(i.id==t)return e;e++}},e.prototype.removeMsgWithId=function(t){var e=this.chatList[t];e&&(e.removeAll(),e.refresh())},Object.defineProperty(e.prototype,"selectedRoleId",{get:function(){return this._selectedRoleId},set:function(t){if(!t||t==this._selectedRoleId)return void(this._selectedRoleId=t);var e=this.indexOfRecentList(t);if(-1==e){var i=this.indexOfFriendList(t);if(!(i>=0))return;var n=this.friendsList.getItemAt(i);this.addRecentList(n,0)}this._selectedRoleId=t},enumerable:!0,configurable:!0}),e.prototype.addRecentList=function(t,e){if(this.recentList.addItemAt(t,e),this.recentList.length>DataCenter.ins().PartnerLimitConfig.chatsListLen){var i=this.recentList.length-1,n=this.recentList.getItemAt(i);n.id==this.selectedRoleId&&(i-=1,i>=0&&(n=this.recentList.getItemAt(i))),this.dispatchRemoveRecentList(n.id)}},e.prototype.dispatchRemoveRecentList=function(t){t==this._selectedRoleId&&(this.selectedRoleId=0);var e=this.indexOfRecentList(t);e>=0&&(this.recentList.removeItemAt(e),this.newMsg[t]&&(this.newMsg[t]=!1,this.dispatchFriendChange())),EventMgr.ins().dispatch(213)},e.MAXNUM=100,__decorate([up(1)],e.prototype,"upFriendsList",null),__decorate([up(2)],e.prototype,"upRecentList",null),__decorate([up(3)],e.prototype,"upAppList",null),__decorate([up(4)],e.prototype,"upBlackList",null),__decorate([up(5,[3,8])],e.prototype,"upAddFriend",null),__decorate([up(6,[3,8])],e.prototype,"upAddBlackList",null),__decorate([up(8,[3,1])],e.prototype,"upAgreeApp",null),__decorate([up(9,[1,3])],e.prototype,"upDelete",null),__decorate([up(11,[3,8,1])],e.prototype,"upChat",null),__decorate([up(14,[3])],e.prototype,"upRecentChat",null),__decorate([down(1,[ByteConst.PartnerVos])],e.prototype,"downFriendsList",null),__decorate([down(2,[ByteConst.PartnerVos])],e.prototype,"downRencentList",null),__decorate([down(3,[ByteConst.PartnerVos])],e.prototype,"downAppList",null),__decorate([down(4,[ByteConst.PartnerVos])],e.prototype,"downBlackList",null),__decorate([down(7,[1].concat(ByteConst.PartnerVos))],e.prototype,"downAddListMsg",null),__decorate([down(9,[1,3])],e.prototype,"downRemoveListMsg",null),__decorate([down(10,[6,1])],e.prototype,"downFriendsStateChange",null),__decorate([down(11,[1,6,3,8])],e.prototype,"downSendResult",null),__decorate([down(13,[6,3,8])],e.prototype,"downChatAdd",null),__decorate([down(14,[[1,3,8]])],e.prototype,"downRecentChatList",null),e=i=__decorate([protocolsId(47)],e);var i}(BaseSystem);__reflect(PartnerControl.prototype,"PartnerControl");var PartnerVo=function(){function t(t){this._offLineSec=0,this.appDate=0,this._redPoint=!1,this.msgMaxLen=50,this.lastMsg="",this.lastMsgDate=0,this.lastMsgData_local=0,this.type=t}return t.prototype.init=function(t){switch(this.id=t[0],this.name=t[1],this.guildName=t[2],this.online=t[3],this.job=t[4],this.sex=t[5],this.vip=t[6],this.lv=t[7],this.zs=t[8],this.monthCard=t[9],this.ladderLv=t[10],this.isLastWeekLadder=t[11],this.power=t[12],this.type){case 1:this.offLineSec=t[13]||0;break;case 2:this.lastMsgDate=t[13];break;case 3:this.appDate=t[13]||0;break;case 4:}},Object.defineProperty(t.prototype,"offLineSec",{get:function(){var t=0;try{var e=Date.now()/1e3;t=Math.floor(this._offLineSec+(e-this._updateTs))}catch(i){debug.log("Offline time failed to get a friend"+i)}return t},set:function(t){this._offLineSec=t,this._updateTs=Date.now()/1e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"redPoint",{get:function(){var t=this._redPoint;
return this._redPoint=!1,t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acMsg",{get:function(){return null==partnerControl.chatList[this.id]&&(partnerControl.chatList[this.id]=new eui.ArrayCollection),partnerControl.chatList[this.id]},set:function(t){partnerControl.chatList[this.id]=t},enumerable:!0,configurable:!0}),t.prototype.addChat=function(t){if(this._redPoint=t.fromActor.id==this.id,0==this.acMsg.length)t.showDate=!0;else for(var e=this.acMsg.length-1;e>=0;--e){var i=this.acMsg.getItemAt(e);if(t.date-i.date>300&&(t.showDate=!0),i.showDate)break}this.acMsg.addItem(t),this.lastMsgData_local=Date.now(),this.acMsg.length>this.msgMaxLen&&this.acMsg.removeItemAt(0)},t}();__reflect(PartnerVo.prototype,"PartnerVo");var ChatData=function(t){function e(e,i,n,o){var s=t.call(this)||this;return s.date=0,s.msg="",s.showDate=!1,s.fromActor=e,s.toActor=i,s.date=n,s.msg=o,s.msg=RambleHlpVo.checkVMsg(s.msg),s.setTime(n),s}return __extends(e,t),Object.defineProperty(e.prototype,"dateStr",{get:function(){var t="";return t=DateUtils.getFormatBySecond(DateUtils.formatMiniDateTime(this.date)/1e3,8),t=StringUtils.complementByChar(t,16)},enumerable:!0,configurable:!0}),e}(RambleBaseVo);__reflect(ChatData.prototype,"ChatData");var PartnerAddListPanel=function(t){function e(){var e=t.call(this)||this;return e.panelList=[],e.name=LangMgr.getValueByKey("friendSQ"),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btn_allNo,this.onTap),this.addEventTouchTap(this.btn_allYes,this.onTap),this.addEvent(egret.Event.RESIZE,this.list_appList,this.onSize),this.list_appList.itemRenderer=PartnerAppListItemRenderer,this.list_appList.dataProvider=partnerControl.appList,this.addCustomEvent(212,this.updateView),this.updateView(),this.panelList=partnerControl.appList.source},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];WatcherUtil.removeFromArrayCollection(this.list_appList.dataProvider),this.list_appList.dataProvider=null},e.prototype.onTap=function(t){switch(t.target){case this.btn_allYes:for(var e=0,i=this.panelList;e<i.length;e++){var n=i[e];partnerControl.upAgreeApp(n.id,1)}break;case this.btn_allNo:for(var o=0,s=this.panelList;o<s.length;o++){var n=s[o];partnerControl.upAgreeApp(n.id,0)}}},e.prototype.onSize=function(){this.list_appList.dataProvider&&this.list_appList.dataProvider.refresh()},e.prototype.updateView=function(){this.group_shenqing&&(this.group_shenqing.visible=0==partnerControl.appList.length)},e}(BasePanel);__reflect(PartnerAddListPanel.prototype,"PartnerAddListPanel");var PartnerAddView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PartnerAddViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btn_add,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.shadow,this.onTap)},e.prototype.onTap=function(t){switch(t.target){case this.closeBtn0:UIMgr.ins().close(e);break;case this.btn_add:if(this.editText_name.text==ActorControl.myName)return void tipsControl.showTips(LangMgr.getValueByKey("friendTips2"));""!=this.editText_name.text&&partnerControl.upAddFriend(0,this.editText_name.text),UIMgr.ins().close(e);break;case this.shadow:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(PartnerAddView.prototype,"PartnerAddView");var PartnerBgView=function(t){function e(){var e=t.call(this)||this;return e.BIG_HEIGHT=880,e.LITTLE_HEIGHT=403,e.isStretch=!1,e.skinName="PartnerBgViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.tab.dataProvider=e.viewStack,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0]?t[0]:0,n=t[1];this.tab.selectedIndex=this.viewStack.selectedIndex=i,this.addEventTouchTap(this.btnClose,this.onTap),this.addEventTouchTap(this.upBtn,this.onTap),this.addEventChange(this.tab,this.onTap),partnerControl.upFriendsList(),this.partnerListPanel.open(),this.partnerChatPanel.open(),this.partnerAddListPanel.open(),this.partnerBlackListPanel.open(n),this.emailPanel.open(),this.updateRedPoint(),this.setUpBtn(),this.addCustomEvent(212,this.updateRedPoint),this.addCustomEvent(216,this.updateRedPoint),this.addCustomEvent(215,this.updateRedPoint)},e.prototype.close=function(){this.partnerListPanel.close(),this.partnerChatPanel.close(),this.partnerAddListPanel.close(),this.partnerBlackListPanel.close(),this.emailPanel.close(),WatcherUtil.removeFromArrayCollection(this.tab.dataProvider)},e.prototype.getRedPoint=function(t){var e=this.tab.getVirtualElementAt(t);return e?e.redPoint:null},e.prototype.updateTabTypeRed=function(t,e){var i=this.getRedPoint(t);i&&(i.visible=e)},e.prototype.onShowdMailPoint=function(){emailUserControl.mailData?this.updateTabTypeRed(4,emailUserControl.getUnreadMail()>0):this.updateTabTypeRed(4,!1)},e.prototype.setStretchWin=function(){this.isStretch?(this.isStretch=!1,this.upBtn.scaleY=1,this.upGroup.height=this.LITTLE_HEIGHT):(this.isStretch=!0,this.upBtn.scaleY=-1,this.upGroup.height=this.BIG_HEIGHT)},e.prototype.setUpBtn=function(){this.upBg.visible=this.upBtn.visible=!0},e.prototype.updateRedPoint=function(){this.updateTabTypeRed(2,partnerControl.appList.length>0);var t=!1;for(var e in partnerControl.newMsg)if(partnerControl.newMsg[e]){t=!0;break}this.updateTabTypeRed(0,t),this.onShowdMailPoint()},e.prototype.onTap=function(t){switch(t.target){case this.btnClose:UIMgr.ins().close(this);break;case this.tab:break;case this.upBtn:this.setStretchWin()}},e}(BaseEuiView);__reflect(PartnerBgView.prototype,"PartnerBgView");var PartnerBlackListPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("friendBalck"),e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.btnList=[this.localBtn,this.crossBtn]},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curIndex=t[0]||0,this.addEventTouchTap(this.localBtn,this.onTap),this.addEventTouchTap(this.crossBtn,this.onTap),this.addEvent(egret.Event.RESIZE,this.list_blackList,this.onSize),this.addCustomEvent(212,this.updateView),this.addCustomEvent(637,this.updateView),partnerControl.upBlackList(),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];WatcherUtil.removeFromArrayCollection(partnerControl.blackList),this.list_blackList.dataProvider=null},e.prototype.setSelectedIndex=function(t){this.curIndex=t;for(var e=0;e<this.btnList.length;e++){var i=this.btnList[e];i.enabled=e!=this.curIndex}switch(this.curIndex){case 0:this.list_blackList.itemRenderer=PartnerBlackListItemRenderer,this.list_blackList.dataProvider=partnerControl.blackList,this.label_num.text=this.list_blackList.dataProvider.length+"/"+DataCenter.ins().PartnerLimitConfig.blacklistLen,this.group_pingbi&&(this.group_pingbi.visible=0==this.list_blackList.dataProvider.length);break;case 1:this.list_blackList.itemRenderer=RambleKfBlackItemRenderer,this.list_blackList.dataProvider=new eui.ArrayCollection(rambleBlackControl.getBlackList()),this.label_num.text=this.list_blackList.dataProvider.length+"/"+DataCenter.ins().PartnerLimitConfig.blacklistLen,this.group_pingbi&&(this.group_pingbi.visible=0==this.list_blackList.dataProvider.length)}},e.prototype.onTap=function(t){switch(t.target){case this.localBtn:this.setSelectedIndex(0);break;case this.crossBtn:this.setSelectedIndex(1)}},e.prototype.updateView=function(){this.setSelectedIndex(this.curIndex)},e.prototype.onSize=function(){this.list_blackList.dataProvider&&this.list_blackList.dataProvider.refresh()},e}(BasePanel);__reflect(PartnerBlackListPanel.prototype,"PartnerBlackListPanel");var PartnerChatPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("friendNear"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.listFriend.dataProvider=null,this.listChat.dataProvider=null,this.listFriend.itemRenderer=PartnerHeadItemRenderer,this.listChat.itemRenderer=PartnerChatItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];partnerControl.upFriendsList(),this.listDataPro!=partnerControl.recentList&&(this.listDataPro=partnerControl.recentList,this.listFriend.dataProvider=this.listDataPro),this.addEventChange(this.listFriend,this.onChange),this.addEventTouchTap(this.btnSend,this.onTap),this.addEventTouchTap(this.faceBtn,this.onTap),this.addCustomEvent(212,this.updateHeadList),this.addCustomEvent(214,this.updateHeadList),this.addCustomEvent(213,this.updateHeadList),this.addEventTouchTap(this.listChat,this.onListTap),this.addEvent(egret.Event.RESIZE,this.listChat,this.onSize),this.addEvent(egret.Event.RESIZE,this.listFriend,this.onSize),RambleHlpVo.regInputEvt(this.input,this.btnSend),this.listFriend.selectedIndex=this.selectedIndex=this.getSelectIndex(),this.onChange();var i=90*(this.selectedIndex+(this.selectedIndex<=2?1:2));DisplayUtils.scrollerToBottom(this.listScroller,i)},e.prototype.close=function(){this.removeEventTouchTap(this.listChat,this.onListTap),WatcherUtil.removeFromArrayCollection(this.listChat.dataProvider),WatcherUtil.removeFromArrayCollection(this.listFriend.dataProvider),this.listFriend.dataProvider=null,this.listChat.dataProvider=null,this.$onClose(),partnerControl.selectedRoleId=0},e.prototype.onListTap=function(){var t=this.listChat.selectedItem;if(t&&t instanceof ChatData){var e=t.msg;e&&e.indexOf("|E:")>=0&&this.onLink(e)}},e.prototype.onLink=function(t){if(!RambleEmojiRiceTextVo.isLinkRich){var e=t.indexOf("|E:");t=t.slice(e+3,Number.MAX_VALUE),LinkUtils.textLink(t)}},e.prototype.updateView=function(){var t=this,e=this.listFriend.selectedItem;if(e){partnerControl.selectedRoleId=e.id,partnerControl.newMsg[e.id]=!1,this.listDataPro.itemUpdated(e),this.currentState="chat";var i=partnerControl.indexOfFriendList(e.id);this.listChat.dataProvider!=partnerControl.chatList[e.id]&&(WatcherUtil.removeFromArrayCollection(this.listChat.dataProvider),this.listChat.dataProvider=partnerControl.chatList[e.id]),-1==i?this.listChat.dataProvider=new eui.ArrayCollection:(TimerMgr.ins().doTimer(200,1,function(){DisplayUtils.scrollerToBottom(t.scroller,null,!0)},this),DisplayUtils.scrollerToBottom(this.scroller))}else this.listChat.dataProvider&&(WatcherUtil.removeFromArrayCollection(this.listChat.dataProvider),this.listChat.dataProvider=null),this.currentState="nofriend"},e.prototype.updateHeadList=function(){this.listFriend.selectedIndex=this.selectedIndex=this.getSelectIndex(),this.updateView()},e.prototype.getSelectIndex=function(){for(var t=partnerControl.selectedRoleId,e=this.selectedIndex,i=0;i<this.listDataPro.length;i++)if(t==this.listDataPro.getItemAt(i).id){e=i;break}return e>=this.listDataPro.length&&(e=0),e},e.prototype.onChange=function(){var t=this.listFriend.selectedItem;t&&partnerControl.upRecentChat(t.id),this.updateView(),partnerControl.dispatchFriendChange()},e.prototype.onTap=function(t){switch(t.target){case this.btnSend:var e=this.listFriend.selectedItem;if(!e)return;if(!rambleControl.checkAllChatOpen())return;if(!rambleControl.checkSendMsg(this.input.text))return;ActorControl.level<DataCenter.ins().PartnerLimitConfig.chatLv?tipsControl.showTips(LangMgr.getValueByKey("friendLeverOpen",DataCenter.ins().PartnerLimitConfig.chatLv)):this.input.text.length>DataCenter.ins().PartnerLimitConfig.contentLimit?tipsControl.showTips(LangMgr.getValueByKey("friendTips1")):this.input.text.length>0&&(partnerControl.upChat(e.id,this.input.text+""),this.input.text="");break;case this.faceBtn:UIMgr.ins().open(RambleEmojiView,this.input)}},e.prototype.onSize=function(t){var e=this;t.currentTarget==this.listChat&&this.listChat.dataProvider&&(this.listChat.dataProvider.refresh(),TimerMgr.ins().once(200,function(){DisplayUtils.scrollerToBottom(e.scroller,null,!0)},this),DisplayUtils.scrollerToBottom(this.scroller)),t.currentTarget==this.listFriend&&this.listFriend.dataProvider&&(this.listFriend.dataProvider.refresh(),this.listFriend.selectedIndex=this.selectedIndex=this.getSelectIndex())},e}(BasePanel);__reflect(PartnerChatPanel.prototype,"PartnerChatPanel");var PartnerListPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("friendMan"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=PartnerListItemRenderer},e.prototype.open=function(){this.updateView(),this.addEventTouchTap(this.btnFind,this.onTap),this.addEvent(egret.Event.RESIZE,this.list,this.onSize)},e.prototype.close=function(){this.$onClose(),WatcherUtil.removeFromArrayCollection(this.list.dataProvider),this.list.dataProvider=null},e.prototype.updateView=function(){this.list.dataProvider=partnerControl.friendsList},e.prototype.onSize=function(){this.list.dataProvider&&this.list.dataProvider.refresh()},e.prototype.onTap=function(t){switch(t.target){case this.btnFind:UIMgr.ins().open(PartnerAddView)}},e}(BasePanel);__reflect(PartnerListPanel.prototype,"PartnerListPanel");var PartnerAppListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="PartnerAppListItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.btn_yes,function(t){partnerControl.upAgreeApp(e.data.id,1),t.stopPropagation(),t.stopImmediatePropagation()}),this.addEventTouchTap(this.btn_no,function(t){partnerControl.upAgreeApp(e.data.id,0),t.stopPropagation(),t.stopImmediatePropagation()}),this.addEventTouchTap(this,function(){e.data&&UIMgr.ins().open(RamblePlayerTipsView,e.data)})},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.label_name.text=e.name+"("+(e.zs>0?e.zs+LangMgr.getValueByKey("numberRotation",""):"")+e.lv+(LangMgr.getValueByKey("numberLevel","")+")"),this.img_userIcon.source="head_"+e.job+e.sex,this.labelGuild.text=e.guildName;var i=Math.floor(e.vip/10)||0,n=e.vip%10||0;i?this.img_vipLv0.source="xvip_4"+i+"_png":this.img_vipLv0.source=null,this.img_vipLv1.source="xvip_4"+n+"_png",this.headBg.source=RambleListItemRenderer.HEAD_BG[e.sex]},e}(BaseItemRender);__reflect(PartnerAppListItemRenderer.prototype,"PartnerAppListItemRenderer");var PartnerBlackListItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.btn_delete,function(t){partnerControl.upDelete(4,e.data.id),t.stopPropagation(),t.stopImmediatePropagation()}),this.addEventTouchTap(this,function(){e.data&&UIMgr.ins().open(RamblePlayerTipsView,e.data)}),this.severId.visible=!1},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.label_name.text=e.name+"("+(e.zs>0?e.zs+LangMgr.getValueByKey("numberRotation",""):"")+e.lv+(LangMgr.getValueByKey("numberLevel","")+")"),this.img_userIcon.source="head_"+e.job+e.sex+(1==e.online?"":"b"),this.labelGuild.text=e.guildName,this.headBg.source=RambleListItemRenderer.HEAD_BG[e.sex]},e}(BaseItemRender);__reflect(PartnerBlackListItemRenderer.prototype,"PartnerBlackListItemRenderer");var PartnerChatItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.label_msg&&(this.label_msg.wordWrap=!1),this.label_msg.visible=!1,this.emojiTxt=new RambleEmojiRiceTextVo,this.emojiTxt.x=17,this.emojiTxt.y=2,this.emojiTxt.lineSpacing=6,this.group_bubble.addChild(this.emojiTxt)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e,i,n=this.data;n.fromActor.id==ActorControl.actorID?(n.fromActor.name=ActorControl.myName,e="0xE5B613",i="0xE5B613"):(e=n.fromActor.sex?"0xBC8787":"0x318ECE",i="0xFFFFFF"),this.label_date.text=n.dateStr;var o="|C:"+e+"&T:"+n.fromActor.name+"|:|C:"+i+"&T:"+n.msg+"|";this.emojiTxt.width=this.group_bubble.width,this.emojiTxt.textColor=i,this.emojiTxt.richText=o,this.height=this.emojiTxt.uHeight+14+this.label_date.textHeight},e}(BaseItemRender);__reflect(PartnerChatItemRenderer.prototype,"PartnerChatItemRenderer");var PartnerHeadItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchTap(this["delete"],this.onDel),this.addEventTouchTap(this.img_userIcon,this.onView)},e.prototype.onDel=function(){partnerControl.dispatchRemoveRecentList(this.data.id)},e.prototype.onView=function(t){this.selected&&UIMgr.ins().open(RamblePlayerTipsView,this.data)},e.prototype.dataChanged=function(){var t=this.data;this.label_name.text=t.name,this.img_userIcon.source="head_"+t.job+t.sex,this.imgBg.source=RambleListItemRenderer.HEAD_BG[t.sex],this.redPoint.visible=!!partnerControl.newMsg[t.id]},e}(BaseItemRender);__reflect(PartnerHeadItemRenderer.prototype,"PartnerHeadItemRenderer");var PartnerListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="PartnerListItemRendererSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.btn_chat,function(t){partnerControl.dispatchChatToFriend(e.data.id),t.stopPropagation(),t.stopImmediatePropagation()}),this.addEventTouchTap(this.btn_delete,function(t){warnControl.show(LangMgr.getValueByKey("friendDelete",e.data.name),function(){partnerControl.upDelete(1,e.data.id)},e),t.stopPropagation(),t.stopImmediatePropagation()}),this.addEventTouchTap(this,function(){e.data&&UIMgr.ins().open(RamblePlayerTipsView,e.data)})},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.label_name.text=e.name+"("+(e.zs>0?e.zs+LangMgr.getValueByKey("numberRotation",""):"")+e.lv+(LangMgr.getValueByKey("numberLevel","")+")"),this.label_power.text=LangMgr.getValueByKey("friendFightValue",e.power),this.labelGuild.text=e.guildName,1==e.online?(this.label_lastLogin.text=LangMgr.getValueByKey("friendLine"),this.label_lastLogin.textColor=2610714):(this.label_lastLogin.text=DateUtils.getFormatBySecond(Math.max(e.offLineSec,60),4),this.label_lastLogin.textColor=16579836),this.img_userIcon.source="head_"+e.job+e.sex+(1==e.online?"":"b"),this.headBg.source=RambleListItemRenderer.HEAD_BG[e.sex]},e}(BaseItemRender);__reflect(PartnerListItemRenderer.prototype,"PartnerListItemRenderer");var PartnerRecentListItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this);var e=this.data;this.label_name.text=e.name+"("+(e.zs>0?e.zs+LangMgr.getValueByKey("numberRotation",""):"")+e.lv+(LangMgr.getValueByKey("numberLevel","")+")"),this.label_lastChat.text=e.lastMsg,this.img_userIcon.source="head_"+e.job+e.sex+(1==e.online?"":"b"),this.redPoint.visible=partnerControl.newMsg[e.id]},e}(BaseItemRender);__reflect(PartnerRecentListItemRenderer.prototype,"PartnerRecentListItemRenderer");var PayControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rechargeData=[],e.flag=0,e.forevetCard=0,e.recharge_type=0,e.chargeTime=0,e.franchiseflag=0,e.franchiseget=0,e.firstBuy=0,e.limitData={isOpen:0,endTime:0,states:[]},e.limitChargeMultiple=4,e.happyShopRechargeToltal=0,e.happyShopRewardState=0,e.happyShopCountdown=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upPayDebug=function(t){return[t]},e.prototype.getRechargeData=function(t){return void 0===t&&(t=-1),-1==t?this._rechargeData:this._rechargeData[t]||new PayVo},e.prototype.isFisrtCharge=function(){var t=this.getRechargeData(0);return!t||t.num<2?!0:!1},e.prototype.checkOpenWin=function(){var t=!1,e=this.getRechargeData(0);return!e||e.num<2?(UIMgr.ins().open(PayFirstView),t=!0):UIMgr.ins().open(PayView),t},e.prototype.getCurRechargeConfig=function(){var t=this.getRechargeData(0),e=CommonUtils.getObjectLength(DataCenter.ins().RechargeServiceConfig);if(t.day<=e)return DataCenter.ins().RechargeServiceConfig[t.day];var i=t.day-e;return e=CommonUtils.getObjectLength(DataCenter.ins().RechargeLoopConfig),i=i%e||e,DataCenter.ins().RechargeLoopConfig[i]},e.prototype.getCurDailyRechargeIsAllGet=function(){for(var t=this.getRechargeData(0),e=this.getCurRechargeConfig(),i=CommonUtils.getObjectLength(e),n=0;i>n;n++){var o=t.isAwards>>n&1?!0:!1;if(!o)return!1}return!0},e.prototype.downRecharge1Data=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.recharge(t.slice(0,-1),0),this.firstRechargeTime=t[t.length-1],EventMgr.ins().dispatch(177)},e.prototype.getFirstRechargeCdTime=function(t){return DateUtils.calcNextNDay(DateUtils.formatMiniDateTime(this.firstRechargeTime),t,GameServer.serverTime)},e.prototype.downChangeRecharge1Data=function(){this.upChangeRecharge1Data()},e.prototype.upChangeRecharge1Data=function(){},e.prototype.dispatchUpdateRechargeEx=function(t){EventMgr.ins().dispatch(446,{type:t})},e.prototype.dispatchUpdateRecharge=function(t){EventMgr.ins().dispatch(178,t)},e.prototype.upGetDayReward=function(t){return[t]},e.prototype.downGetRecharge2Data=function(){},e.prototype.downChangeRecharge2Data=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.getRechargeData(1);i&&(i.change(t),this.dispatchUpdateRecharge(1))},e.prototype.upGetRechargeTotalAward=function(t,e){return[t,e]},e.prototype.recharge=function(t,e){if(this._rechargeData[e]||(this._rechargeData[e]=new PayVo),this._rechargeData[e].init(t),0==e){var i=this.getCurDailyRechargeIsAllGet();i&&UIMgr.ins().close(PayDailyView)}this.dispatchUpdateRechargeEx(e),this.recharge_type=e},e.prototype.downUpDataItem=function(t){this.costList=t,EventMgr.ins().dispatch(179)},e.prototype.downRechargeTotalDay=function(t,e,i){this.rechargeTotal={},this.rechargeTotal.hasGetDays=[],this.rechargeTotal.hasGetDays1=[],this.rechargeTotal.cate=[],this.rechargeTotal.rechDay=[],this.rechargeTotal.lun1=0,this.rechargeTotal.lun2=0;for(var n=0;n<t.length;n++)this.rechargeTotal.hasGetDays.push(t[n]);this.rechargeTotal.totalDay=e;for(var n=0;n<i.length;n++){for(var o=i[n][0],s=[],r=0;r<i[n][1].length;r++)s.push(i[n][1][r]);this.rechargeTotal.hasGetDays1.push(s),this.rechargeTotal.cate.push(o),this.rechargeTotal.rechDay.push(i[n][2])}EventMgr.ins().dispatch(180)},e.prototype.downGetMonthDay=function(t,e){t>0?this.monthDay=t:this.monthDay=0,t>0&&(this.flag=2),this.forevetCard=e,!ServerStorage.ins().getValue(12)&&(this.monthDay>0||this.getIsForeve())&&ServerStorage.ins().setValue(12,1),EventMgr.ins().dispatch(447)},e.prototype.getOrderByIndex=function(t){void 0===t&&(t=0);var e=this.costList>>t&1;return e},Object.defineProperty(e.prototype,"monthDay",{get:function(){return this._monthDay},set:function(t){this._monthDay!=t&&(this._monthDay=t,TimerMgr.ins().remove(this.runTime,this),this._monthDay>0&&TimerMgr.ins().doTimer(1e3,this._monthDay,this.runTime,this))},enumerable:!0,configurable:!0}),e.prototype.runTime=function(){this._monthDay-=1},e.prototype.getAddBagGrid=function(){return this.monthDay>0?100:0},e.prototype.getAddBagFranchiseGrid=function(){return this.franchise>0?100:0},e.prototype.showReCharge=function(t){if(SDKManager.ins().CheckSupportRecharge()){if(!SwitchMgr.ins().checkOpen(1))return void tipsControl.showTips(LangMgr.getValueByKey("chargeTips9"));if(!(GameServer.serverTime>this.chargeTime))return void tipsControl.showTips(LangMgr.getValueByKey("chargeTips10"));this.chargeTime=GameServer.serverTime+DateUtils.MS_PER_SECOND;var e=DataCenter.ins().PayInfoConfig[t];if(!e)return void debug.error("PayInfoConfig Table gear ID:"+t+"Not configured");var i=e.id,n=i,o=e.num,s=e.cash,r=e.name,a=(Date.now()/1e3).toFixed(0),l={account:GlobalModel.openID,channelId:GlobalModel.channelId,pf:GlobalModel.pf,actorid:ActorControl.actorID,actorlogintime:GlobalModel.actorLoginTime,actorname:ActorControl.myName,career:CommonFun.getJobName(ActorControl.job),createaccounttime:GlobalModel.createAccountTime,createactortime:GlobalModel.createActorTime,gameid:GlobalModel.gameId,gold:o,itemid:i,itemname:r,jobid:taskControl.taskTrace.id,level:ActorControl.level,money:s,pfid:GlobalModel.gameId,power:ActorControl.power,serverid:GlobalModel.mainSrvid,servername:GlobalModel.srvname,time:Date.now(),viplevel:vipControl.lv,yb:ActorControl.yb,os:GlobalModel.os,Ctext:GlobalModel.getUrlParamValue("exText"),sdkargs:SDKManager.ins().GetMakeOrderSdkArgs({itemName:r,timestamp:a})},h=Md5Utils.obj_md5_args(l,PHPConfig.VERIFY_KEY,!0,["account","actorname","career","sdkargs","Ctext"],["itemname","os","servername","sdkargs","Ctext"]);debug.log("order no:"+h),PHPConfig.requestPhpData(PHPConfig.MAKE_ORDER_URL,h,this.onGetComplete,this,this.onGetIOError,null,null,n,r,1,s,a)}},e.prototype.onGetComplete=function(t,e,i,n,o,s){var r;try{r=JSON.parse(t.currentTarget.response)}catch(a){return void ErrorUtils.ins().show("order no error:"+t.currentTarget.response)}debug.log("Successful order, order no:",r.orderid);var l={itemid:e,order:r.orderid,goodsname:i,amount:n,fee:o,serverId:GlobalModel.srvid,serverName:GlobalModel.srvname,roleName:ActorControl.myName,timestamp:s};r.gamesign&&(l.gameSign=r.gamesign),r.wxpaydata&&(l.wxPayData=r.wxpaydata),r.paydata&&(l.paydata=r.paydata),r.OutOrderInfo&&(l.OutOrderInfo=r.OutOrderInfo),r.OutOrderInfoSign&&(l.OutOrderInfoSign=r.OutOrderInfoSign),r.orderno&&(l.orderno=r.orderno),r.gamesign&&(l["gamesign "]=r.gamesign),SDKManager.ins().SDKPayNative(l)},e.prototype.onGetIOError=function(t,e){debug.log("Error in recharge order!!!")},e.prototype.getIsForeve=function(){return 2==this.forevetCard},e.prototype.upGetFranchise=function(){},e.prototype.downFranchiseInfo=function(t,e,i){t>0?this.franchise=t:this.franchise=0,this.franchiseget=e,this.firstBuy=i,EventMgr.ins().dispatch(181)},Object.defineProperty(e.prototype,"franchise",{get:function(){return this._franchise},set:function(t){this._franchise!=t&&(this._franchise=t,TimerMgr.ins().remove(this.franchiseTime,this),this._franchise>0&&TimerMgr.ins().doTimer(1e3,this._franchise,this.franchiseTime,this))},enumerable:!0,configurable:!0}),e.prototype.franchiseTime=function(){this._franchise-=1},e.prototype.getRechargeList=function(t){var e=null;1==t?e=DataCenter.ins().RechargeDaysAwardsConfig:2==t&&(e=DataCenter.ins().RechargeDaysAwardssConfig);var i=[],n={},o={};for(var s in e)n[e[s].sum]||(n[e[s].sum]=[]),o[e[s].sum]||(o[e[s].sum]=0),1==t?this.rechargeTotal.hasGetDays.indexOf(e[s].id)>=0&&o[e[s].sum]++:2==t&&this.rechargeTotal.hasGetDays1[0].indexOf(e[s].id)>=0&&o[e[s].sum]++,n[e[s].sum].push(e[s]);for(var s in o){if(i.length)break;if(!(o[s]>=CommonUtils.getObjectLength(n[s])&&Number(s)<CommonUtils.getObjectLength(o)))for(var r in n[s])i.push(n[s][r])}return i},e.prototype.upMuchDayRecReward=function(){},e.prototype.downMuchDayRecReward=function(t,e,i){this.mRecNum=t,this.mReward=e,this.mDayNum=i,EventMgr.ins().dispatch(182)},e.prototype.downOrderCallback=function(t){var e=LangMgr.getValueByKey("chargeTips11");0==t&&(e=LangMgr.getValueByKey("chargeTips12")),warnControl.show(e,null,null,null,null,"sure")},e.prototype.downOneBuyState=function(t){this.oneBuyStateIndex=t,GlobalModel.openTab&&1==this.oneBuyStateIndex&&SDKManager.ins().SDKTapExecute(),EventMgr.ins().dispatch(183)},e.prototype.hasOneBuy=function(){for(var t in DataCenter.ins().RechargeOneConfig)if(Number(t)>this.oneBuyStateIndex)return!0;return!1},e.prototype.downLimitCharge=function(t,e,i){if(this.limitData.isOpen=t,this.limitData.isOpen){this.limitData.endTime=e;for(var n=0;n<i.length;n++)this.limitData.states[i[n][0]]=i[n][1]}EventMgr.ins().dispatch(184)},e.prototype.downLimitChargeMultiple=function(t){this.limitChargeMultiple=t,EventMgr.ins().dispatch(185)},e.prototype.limitChargeIsOpen=function(){for(var t=!1,e=0;e<this.limitData.states.length;e++)if(0==this.limitData.states[e]){t=!0;break}return this.limitData.isOpen&&t},e.prototype.downHappyShop=function(t,e,i){this.happyShopRechargeToltal=t,this.happyShopRewardState=e,this.happyShopCountdown=DateUtils.formatMiniDateTime(i),EventMgr.ins().dispatch(448)},e.prototype.upGetHappyShopAwards=function(t){return[t]},e.prototype.getRemindByIndex=function(t){return 1==(this.happyShopRewardState>>t-1&1)},e.prototype.downFlashSaleInfo=function(t,e){this.openFlashSaleId=t,this.openFlashSaleRed=0,this.flashSaleStates=[];for(var i=0;i<e.length;i++){var n=e[i][0],o=e[i][1];1==o&&this.openFlashSaleRed++,this.flashSaleStates[n]=o}EventMgr.ins().dispatch(186)},e.prototype.getFlashSaleConfigByPayId=function(t){var e=null;for(var i in DataCenter.ins().RechargeFlashSaleConfig){var n=DataCenter.ins().RechargeFlashSaleConfig[i];n.payId==t&&(e=n)}return e},e.prototype.upGetFlashSaleAwards=function(t){return[t]},e.prototype.hasGetedDan=function(){var t=this.getCurRechargeConfig();if(t){var e=this.getRechargeData(0);for(var i in t){var n=t[i];if(n.actAward||n.actId){if(e.curDayPay>=n.pay&&e.isAwards>>n.index&1)return!0;break}}}return!1},e.prototype.showZhShDanRe=function(){if(!SwitchMgr.ins().checkOpen(2))return[!1,0,""];var t=this.getCurRechargeConfig();if(t){var e=0,i=0,n=this.getRechargeData(0);for(var o in t){var s=t[o];n.curDayPay>=s.pay&&n.isAwards>>s.index&1&&i++,e++;var r=s.actAward;if(r)for(var a in r){var l=amusementControl.activityData[+a];if(l&&l.isOpenActivity())return e>i?[!0,l.id,s.icon]:[!1,0,""]}else if(s.actId)for(var h=0,u=s.actId;h<u.length;h++){var p=u[h],l=amusementControl.activityData[p];if(l&&l.isOpenActivity())return e>i?[!0,l.id,s.icon]:[!1,0,""]}}}return[!1,0,""]},e.prototype.checkZhShDanReRed=function(){var t=this.getCurRechargeConfig();if(t){var e=this.getRechargeData(0);for(var i in t){var n=t[i];if(e.curDayPay>=n.pay&&!(e.isAwards>>n.index&1))return!0;if(n.actAward||n.actId)break}}return!1},__decorate([up(12,[3])],e.prototype,"upPayDebug",null),__decorate([down(1,ByteConst.PayVos.concat([3]))],e.prototype,"downRecharge1Data",null),__decorate([down(2)],e.prototype,"downChangeRecharge1Data",null),__decorate([up(2)],e.prototype,"upChangeRecharge1Data",null),__decorate([up(3,[2])],e.prototype,"upGetDayReward",null),__decorate([down(6)],e.prototype,"downGetRecharge2Data",null),__decorate([down(7,[3,3])],e.prototype,"downChangeRecharge2Data",null),__decorate([up(8,[2,2])],e.prototype,"upGetRechargeTotalAward",null),__decorate([down(8,[3])],e.prototype,"downUpDataItem",null),__decorate([down(9,[[2],2,[2,[2],2]])],e.prototype,"downRechargeTotalDay",null),__decorate([down(20,[6,3])],e.prototype,"downGetMonthDay",null),__decorate([up(10)],e.prototype,"upGetFranchise",null),__decorate([down(11,[6,1,1])],e.prototype,"downFranchiseInfo",null),__decorate([up(11)],e.prototype,"upMuchDayRecReward",null),__decorate([down(12,[3,1,2])],e.prototype,"downMuchDayRecReward",null),__decorate([down(13,[3])],e.prototype,"downOrderCallback",null),__decorate([down(14,[1])],e.prototype,"downOneBuyState",null),__decorate([down(15,[1,3,[3,1]])],e.prototype,"downLimitCharge",null),__decorate([down(117,[2])],e.prototype,"downLimitChargeMultiple",null),__decorate([down(16,[3,3,3])],e.prototype,"downHappyShop",null),__decorate([up(13,[1])],e.prototype,"upGetHappyShopAwards",null),__decorate([down(118,[3,[3,1]])],e.prototype,"downFlashSaleInfo",null),__decorate([up(114,[1])],e.prototype,"upGetFlashSaleAwards",null),e=__decorate([protocolsId(27)],e)}(BaseSystem);__reflect(PayControl.prototype,"PayControl");var PayDailyGetExtraView=function(t){function e(){var e=t.call(this)||this;return e._jumpToAdd=!0,e._selIndex=-1,e._actID=0,e.skinName="PayDailyGetExtraViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.priceList.itemRenderer=PayDailyGetExtraItemRender,this._btnCol=new eui.ArrayCollection,this.priceList.dataProvider=this._btnCol,this.awardList.itemRenderer=ItemBase,this._awardCol=new eui.ArrayCollection,this.awardList.dataProvider=this._awardCol
},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t||(this._jumpToAdd=!1),this.addCustomEvent(177,this.update),this.addEventTouchTap(this,this.onTouch),this.priceList.addEventListener(eui.ItemTapEvent.ITEM_TAP,this.onPrice,this),this.update()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._selIndex=-1,this._actID=0,this.redpointGroup.removeChildren()},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.rechargeBtn:var e=this.priceList.selectedItem;if(e)if(e.state==AmusementControl.CanGet)backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH&&UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH),payControl.upGetDayReward(e.cfg.index),this._selIndex=-1;else{var i=payControl.getRechargeData(0),n=CommonUtils.getObjectLength(DataCenter.ins().RechargeFirstClientConfig[1]);UIMgr.ins().open(i.num<=n?PayFirstView:PayView),UIMgr.ins().close(this)}}},e.prototype.update=function(){var t,e=payControl.getCurRechargeConfig(),i=[],n=-1;if(e){var o=0,s=[],r=!1,a=0,l=payControl.getRechargeData(0);for(var h in e){var u=e[h];o=l.curDayPay>=u.pay?l.isAwards>>u.index&1?AmusementControl.Geted:AmusementControl.CanGet:AmusementControl.NotReached,-1==n&&o==AmusementControl.CanGet&&(n=a),s=[],r=!1;var p=void 0;if(u.actAward){for(var c in u.actAward)p=amusementControl.activityData[+c],p&&p.isOpenActivity()&&(s.push(u.actAward[c]),this._actID=p.id);r=!0}else if(u.actId){for(var d=0;d<u.actId.length;d++){var g=u.actId[d];p=amusementControl.activityData[g],p&&p.isOpenActivity()&&(this._actID=p.id)}r=!0}i.push({cfg:u,state:o,addAwards:s,type:0==a?0:r?2:1});var m=this.redpointGroup.numChildren>=a+1?this.redpointGroup.getChildAt(a):null;if(m||(m=new eui.Image,m.source="zjmhongdian",this.redpointGroup.addChild(m)),t=a,m.visible=o==AmusementControl.CanGet,r)break;a++}}for(var f=i.length;this.redpointGroup.numChildren>f;)this.redpointGroup.removeChildAt(this.redpointGroup.numChildren-1);this._btnCol.replaceAll(i),-1==this._selIndex&&(this._jumpToAdd?(this._jumpToAdd=!1,this._selIndex=t):this._selIndex=-1!=n?n:t),this._selIndex>=i.length&&(this._selIndex=i.length-1),this.priceList.selectedIndex=this._selIndex,this.updateTime(),this.updateCurPrice()},e.prototype.updateCurPrice=function(){var t=this.priceList.selectedItem;this._awardCol.replaceAll(t.cfg.awardList.concat(t.addAwards)),this.awardShow.source=t.cfg.awardShow,this.text.source=t.cfg.textRes,this.redPoint.visible=t.state==AmusementControl.CanGet,this.rechargeBtn.label=t.state==AmusementControl.CanGet?LangMgr.getValueByKey("tongGetGift"):t.state==AmusementControl.NotReached?LangMgr.getValueByKey("chargeTips4"):LangMgr.getValueByKey("activitAlreadingGet"),this.rechargeBtn.enabled=t.state!=AmusementControl.Geted,this.rechargeBtn.filters=t.state==AmusementControl.Geted?FilterUtils.ARRAY_GRAY_FILTER:null},e.prototype.onPrice=function(){this._selIndex=this.priceList.selectedIndex,this.updateCurPrice()},e.prototype.updateTime=function(){var t=amusementControl.activityData[this._actID];t&&t.isOpenActivity()?(TimerMgr.ins().isExists(this.onRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.onRepeat,this),this.onRepeat()):(TimerMgr.ins().remove(this.onRepeat,this),this.time.text=LangMgr.getValueByKey("doubleEndActivity"))},e.prototype.onRepeat=function(){var t=amusementControl.activityData[this._actID];t&&t.isOpenActivity()?this.time.text=""+DateUtils.getFormatBySecond(Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3),DateUtils.TIME_FORMAT_1):(TimerMgr.ins().remove(this.onRepeat,this),this.time.text=LangMgr.getValueByKey("doubleEndActivity"))},e}(BaseEuiView);__reflect(PayDailyGetExtraView.prototype,"PayDailyGetExtraView");var PayDailyView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PayDailyViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.totalPower=BitmapNumber.ins().createNumPic(0,"vip_v",5),this.totalPower.x=0,this.totalPower.y=0,this.moneyGroup.addChild(this.totalPower),this.eff=new GameMovieClip,this.eff.x=this.goUpBtn.width/2,this.eff.y=this.goUpBtn.height/2,this.eff.scaleX=1.3,this.eff.scaleY=1.4,this.eff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.goUpBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(446,this.setWinData);var i=UIMgr.playFun;i&&(i.preRecharge=i.recharge.visible=!1),this.setWinData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.goUpBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),DisplayUtils.removeFromParent(this.eff),egret.Tween.removeTweens(this),this.removeCustomEvents()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;case this.goUpBtn:if(this.goUpBtn.label==LangMgr.getValueByKey("chargeTips3"))this.currData&&this.getReward();else if(this.goUpBtn.label==LangMgr.getValueByKey("chargeTips4")){var e=payControl.getRechargeData(0),i=CommonUtils.getObjectLength(DataCenter.ins().RechargeFirstClientConfig[1]);UIMgr.ins().open(e.num<=i?PayFirstView:PayView),UIMgr.ins().close(this)}}},e.prototype.getReward=function(){this.playGet(void 0,this.currData),payControl.upGetDayReward(this.currData.index)},e.prototype.playGet=function(t,e){for(var i=UIMgr.ins().getView(GameBottomView),n=i.getBagBtn(),o=n.x-50,s=n.y-this.mainGroup.y-110,r=function(t){var e=new ItemBase;e.data=a["item"+(t+1)].data,e.x=a["item"+(t+1)].x,e.y=a["item"+(t+1)].y,a["item"+(t+1)].parent.addChild(e);var i=egret.Tween.get(e);i.to({x:o,y:s,scaleX:0,scaleY:0},500).call(function(){DisplayUtils.removeFromParent(e)})},a=this,l=0;4>l;l++)r(l)},e.prototype.setWinData=function(){var t=payControl.getRechargeData(0),e=payControl.getCurRechargeConfig();this.currData=null;var i=Number.MAX_VALUE;for(var n in e){var o=t.isAwards>>e[n].index&1;!o&&i>e[n].pay&&(i=e[n].pay,this.currData=e[n])}if(this.currData||(this.currData=e[0]),this.currData){var s=this.currData.pay-t.curDayPay;s>0?(this.goUpBtn.label=LangMgr.getValueByKey("chargeTips4"),DisplayUtils.removeFromParent(this.eff)):(this.goUpBtn.label=LangMgr.getValueByKey("chargeTips3"),this.eff.parent||(this.goUpBtn.addChildAt(this.eff,this.getChildIndex(this.goUpBtn)),this.eff.playFile(PATH_EFF+"chongzhi",-1))),this.setItem(),BitmapNumber.ins().changeNum(this.totalPower,0>s?0:s,"vip_v",3)}this.initPos()},e.prototype.setItem=function(){for(var t=0;t<this.currData.awardList.length;t++){var e=this.currData.awardList[t],i=t+1;this["item"+i].data=e,this["item"+i].visible=!0,this["item"+i].scaleX=this["item"+i].scaleY=1,this["item"+i].x=90*t,this["item"+i].y=0}},e.prototype.initPos=function(){this.totalPower.x=(this.moneyGroup.width-this.totalPower.width)/2},e}(BaseEuiView);__reflect(PayDailyView.prototype,"PayDailyView");var PayFirstView=function(t){function e(){var e=t.call(this)||this;return e.selectedIndex=0,e.isTopLevel=!0,e.skinName="PayFirstViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.btnArr=[];for(var e=0;4>e;e++)this.btnArr.push(this["chong"+e]);this.eff=new GameMovieClip,this.eff.scaleX=1.2,this.eff.scaleY=1.25,this.eff.touchEnabled=!1,this.dayLen=CommonUtils.getObjectLength(DataCenter.ins().RechargeFirstClientConfig[1]);var i=[];if(this.dayLen)for(var e=1;e<=this.dayLen;e++)i.push(e);this.tab.itemRenderer=PayFirstItemRenderer,this.tab.dataProvider=new eui.ArrayCollection(i),this.addEventChange(this.tab,this.onTabTouch)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!SwitchMgr.ins().checkOpen(1,!0))return!1;var i=payControl.getRechargeData(0),n=CommonUtils.getObjectLength(DataCenter.ins().RechargeFirstClientConfig[1]);if(!t[0]){if(i.num>n){var o=payControl.getCurDailyRechargeIsAllGet();return o||UIMgr.ins().open(PayDailyView),!1}return!0}return i.num>n?(UIMgr.ins().open(t[0][0]),!1):!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.closeCB),this.addEventTouchTap(this.buyed,this.onTouch);for(var i=0;i<this.btnArr.length;i++)this.addEventTouchTap(this.btnArr[i],this.onTouch);this.addCustomEvent(446,this.updateView);var n=UIMgr.playFun;n&&(n.preRecharge=n.recharge.visible=!1);var o=0;for(var s in DataCenter.ins().RechargeFirstConfig){var r=DataCenter.ins().RechargeFirstConfig[s];this.btnArr[o].rmb.text=r.paydesc,this.btnArr[o].yuanbao.text=r.payReturn,this.btnArr[o].money=r.pay,this["showOther"+o]&&r.showOther&&(this["showOther"+o].source=r.showOther),o++}var a=payControl.getRechargeData(0);a.num&&(this.selectedIndex=a.num-1,this.tab.selectedIndex=this.selectedIndex),this.updateView()},e.prototype.onTabTouch=function(){this.selectedIndex=this.tab.selectedIndex,this.updateView()},e.prototype.updateView=function(t){var e=heroControl.getSubRoleByIndex(0).job;if(this.payRewardVos=DataCenter.ins().RechargeFirstClientConfig[e][this.selectedIndex+1].RechargeRewardData,this.payRewardVos)for(var i=0;i<this.payRewardVos.length;i++){var n=this.payRewardVos[i],o={id:n.id,type:n.type,count:n.count};this["item"+(i+1)].data=o,this["item"+(i+1)].visible=!0}var s=DataCenter.ins().RechargeFirstClientConfig[e][this.selectedIndex+1];this.weapImg.source=s.weaponshow+"_png",this.roleImg.source=s.bodyshow+"_png";var r=t?t.type:payControl.recharge_type;this._data=payControl.getRechargeData(r),this.endTime=payControl.getFirstRechargeCdTime(this.selectedIndex-1),TimerMgr.ins().remove(this.timeClock,this),this._data.num?this._data.num>this.selectedIndex+1?(this.cdTxt.visible=!1,this.buyed.visible=!0,this.buyed.enabled=!1,this.buyed.label=LangMgr.getValueByKey("activitAlreadingGet"),this.unbuy.visible=!1,DisplayUtils.removeFromParent(this.eff)):(this.cdTxt.visible=this.endTime>0,this.buyed.visible=!0,this.buyed.enabled=this.endTime<0,this.buyed.label=LangMgr.getValueByKey("activitGet"),this.unbuy.visible=!1,this.endTime<0?this._data.num<this.selectedIndex+1?(this.cdTxt.visible=!0,this.buyed.enabled=!1,this.cdTxt.text=LangMgr.getValueByKey("qianyidaynolq"),DisplayUtils.removeFromParent(this.eff)):this.eff.parent||(this.buyGroup.addChild(this.eff),this.eff.x=this.buyGroup.width/2-2,this.eff.y=this.buyGroup.height/2,this.eff.touchEnabled=this.buyGroup.touchEnabled=!1,this.eff.playFile(PATH_EFF+"chongzhi",-1)):(DisplayUtils.removeFromParent(this.eff),this.timeClock(),TimerMgr.ins().doTimer(1e3,0,this.timeClock,this))):(this.cdTxt.visible=!1,this.buyed.visible=!1,this.unbuy.visible=!0,DisplayUtils.removeFromParent(this.eff))},e.prototype.timeClock=function(){this.endTime>0?this.cdTxt.text=LangMgr.getValueByKey("drawtime")+DateUtils.getFormatBySecond(this.endTime,DateUtils.TIME_FORMAT_1,4):(TimerMgr.ins().remove(this.timeClock,this),this.updateView()),this.endTime-=1},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.buyed:if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);payControl.upChangeRecharge1Data();break;default:for(var e=0;4>e;e++)if(t.currentTarget==this.btnArr[e]){var i=this.btnArr[e].money;for(var n in DataCenter.ins().RechargeItemsConfig)if(i==DataCenter.ins().RechargeItemsConfig[n].amount){DataCenter.ins().RechargeItemsConfig[n].id>400?PayControl.ins().showReCharge(DataCenter.ins().RechargeItemsConfig[n].id):PayControl.ins().showReCharge(400+DataCenter.ins().RechargeItemsConfig[n].id);break}break}}},e.prototype.closeCB=function(t){UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.eff),egret.Tween.removeTweens(this)},e}(BaseEuiView);__reflect(PayFirstView.prototype,"PayFirstView");var PayLimitView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="PayLimitViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.itemList.itemRenderer=PayLimitItemRenderer,this.itemScroller.viewport=this.itemList},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTouch),this.initList(),this.time=this.getLeftTime(),this.runTime(),TimerMgr.ins().remove(this.runTime,this),TimerMgr.ins().doTimer(1e3,0,this.runTime,this),this.addCustomEvent(184,this.refreshList),this.addCustomEvent(185,this.refreshList)},e.prototype.initList=function(){this.bg.source="limitchongbg"+payControl.limitChargeMultiple+"_png";var t=DataCenter.ins().RechargeQuadrupleItemsConfig,e=[];for(var i in t)e.push(t[i]);this.itemList.dataProvider=new eui.ArrayCollection(e)},e.prototype.refreshList=function(){this.bg.source="limitchongbg"+payControl.limitChargeMultiple+"_png";for(var t=this.itemList.dataProvider.length,e=0;t>e;e++){var i=this.itemList.dataProvider,n=i.getItemAt(e);i.itemUpdated(n)}},e.prototype.getLeftTime=function(){return Math.floor(DateUtils.calcNextDay(GameServer.serverTime)/DateUtils.MS_PER_SECOND)},e.prototype.runTime=function(){var t=this.time;this.time-=1,t>0?this.showTime&&(this.showTime.text=LangMgr.getValueByKey("chargeTips7",DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_11))):(this.showTime&&(this.showTime.text=LangMgr.getValueByKey("chargeTips8")),TimerMgr.ins().remove(this.runTime,this))},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(PayLimitView.prototype,"PayLimitView");var PayOneView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PayOneViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.goUpBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.data=DataCenter.ins().RechargeOneConfig[payControl.oneBuyStateIndex+1],this.bg.source="yiygbg"+payControl.oneBuyStateIndex+"_png",this.goUpBtn.icon="yiygbt"+payControl.oneBuyStateIndex+"_png";for(var i=0;4>i;i++)this["item"+i].data=this.data.rewards[i],this["item"+i].x=90*i,this["item"+i].y=0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.goUpBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;case this.goUpBtn:UIMgr.ins().close(this),payControl.showReCharge(this.data.payIndex)}},e}(BaseEuiView);__reflect(PayOneView.prototype,"PayOneView");var PaySaleView=function(t){function e(){var e=t.call(this)||this;return e.dataArr0=new eui.ArrayCollection,e.btnAry=[],e.selectedIndex=0,e.flashSaleAry=[],e.skinName="PaySaleViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.tab.itemRenderer=BtnTab8ItemRender,this.tab.dataProvider=this.dataArr0,this.reward.itemRenderer=ItemBase,this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventTouchTap(this.payBtn,this.onClickPay),this.flashSaleAry=[];for(var e in DataCenter.ins().RechargeFlashSaleConfig)this.flashSaleAry.push(DataCenter.ins().RechargeFlashSaleConfig[e]),this.btnAry.push(DataCenter.ins().RechargeFlashSaleConfig[e].day);this.dataArr0.replaceAll(this.btnAry),this.iconEff=new GameMovieClip,this.iconEffGroup.addChild(this.iconEff)},e.prototype.onClickPay=function(){var t=this.flashSaleAry[this.selectedIndex];this.payBtn.label==LangMgr.getValueByKey("activitGet")?payControl.upGetFlashSaleAwards(t.id):payControl.showReCharge(t.payId)},e.prototype.onTabTouch=function(){this.selectedIndex=this.tab.selectedIndex,this.updateView()},e.prototype.onTabTouching=function(t){return this.checkIsOpen(this.tab.selectedIndex)?void 0:void t.preventDefault()},e.prototype.checkIsOpen=function(t){return null==this.flashSaleAry[t]?(tipsControl.showTips(LangMgr.getValueByKey("kfTips44")),!1):0==payControl.openFlashSaleId||payControl.openFlashSaleId<this.flashSaleAry[t].id?(tipsControl.showTips(LangMgr.getValueByKey("kfTips44")),!1):!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.timeClock,this),this.addCustomEvent(186,this.updateView),this.endTime=Math.floor(DateUtils.calcNextDay(GameServer.serverTime)/DateUtils.MS_PER_SECOND),this.selectedIndex=payControl.openFlashSaleId-1,this.selectedIndex>=this.flashSaleAry.length&&(this.selectedIndex=this.flashSaleAry.length-1),this.tab.selectedIndex=this.selectedIndex,this.updateView()},e.prototype.timeClock=function(){this.endTime>0?(this.cdTime.visible=!0,this.cdTime.text=LangMgr.getValueByKey("expHaveTime",DateUtils.getFormatBySecond(this.endTime,DateUtils.TIME_FORMAT_1,4))):(TimerMgr.ins().remove(this.timeClock,this),this.cdTime.visible=!1),this.endTime-=1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];egret.Tween.removeTweens(this.iconImage)},e.prototype.updateView=function(){this.cdTime.visible=!1,this.already.visible=!1;var t=this.flashSaleAry[this.selectedIndex];this.powerPanel.setPower(t.showPower),egret.Tween.removeTweens(this.iconImage),1==t.pictype?(this.iconEff.visible=!1,this.iconImage.visible=!0,this.iconImage.source=t.avatar+"_png",this.iconImage.verticalCenter=t.offsetY||0,egret.Tween.get(this.iconImage,{loop:!0}).to({verticalCenter:this.iconImage.verticalCenter-10},250).to({verticalCenter:this.iconImage.verticalCenter},250)):(this.iconImage.visible=!1,this.iconEff.visible=!0,this.iconEff.playFile(PATH_EFF+t.avatar,-1),this.iconEffGroup.verticalCenter=t.offsetY||0),this.descImage.source=t.showTitle;var e=DataCenter.ins().PayInfoConfig[t.payId];if(this.shouchongIcon.visible=0!=e.vipexp,GlobalModel.isHw?this.payBtn.label="$"+t.showPrice:this.payBtn.label=LangMgr.getValueByKey("dollar",t.showPrice),this.reward.dataProvider=new eui.ArrayCollection(t.awardList),this.payBtn.visible=!1,TimerMgr.ins().remove(this.timeClock,this),payControl.openFlashSaleId>=this.flashSaleAry[this.selectedIndex].id){var i=payControl.flashSaleStates[t.id];0==i?payControl.openFlashSaleId==this.flashSaleAry[this.selectedIndex].id?(this.payBtn.visible=!0,this.timeClock(),TimerMgr.ins().doTimer(1e3,0,this.timeClock,this)):(this.payBtn.visible=!1,this.already.visible=!0,this.already.text=LangMgr.getValueByKey("activitOverDat")):1==i?(this.payBtn.visible=!0,this.payBtn.label=LangMgr.getValueByKey("activitGet")):2==i&&(this.payBtn.visible=!1,this.already.visible=!0,this.already.text=LangMgr.getValueByKey("activitAlreadingGet"))}},e}(BaseEuiView);__reflect(PaySaleView.prototype,"PaySaleView");var PayView=function(t){function e(){var e=t.call(this)||this;return e.barbc=new ProgressBarEff,e.skinName="PayViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=PayItemRenderer,this.scrollBar.viewport=this.list;var e=DataCenter.ins().RechargeItemsConfig,i=[];for(var n in e)e[n].id<405&&i.push(e[n]);this.list.dataProvider=new eui.ArrayCollection(i),this.barbc.setWidth(340),this.barbc.x=80,this.barbc.y=12,this.topGroup.addChild(this.barbc),this.vipValue=BitmapNumber.ins().createNumPic(0,"vip_v",5),this.vipValue.x=36,this.vipValue.y=39,this.vipGroup.addChild(this.vipValue)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.vipBtn,this.onTap),this.addCustomEvent(179,this.refushInfo),this.addEventItemTap(this.list,this.onListTap),this.barbc.reset(),this.setView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.vipBtn,this.onTap),this.removeEventItemTap(this.list,this.onListTap),this.removeCustomEvents()},e.prototype.onListTap=function(t){var e=t.item,i=(payControl.getOrderByIndex(e.id)?0:200)+Number(e.id);payControl.showReCharge(i)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.vipBtn:UIMgr.ins().open(VipView)}},e.prototype.refushInfo=function(){for(var t=this.list.dataProvider,e=0;e<t.length;e++){var i=t.getItemAt(e);t.itemUpdated(i)}this.setView()},e.prototype.setView=function(){var t=vipControl.lv,e=DataCenter.ins().VipConfig[t+1],i=0,n="",o=vipControl.exp;if(e){i=e.needYb-o;n=LangMgr.getValueByKey("chargeTips1",i,vipControl.getVipStr(t+1)),this.barbc.setData(o,e.needYb)}else n=LangMgr.getValueByKey(GlobalModel.baseVipLevel>0?"chargeTips14":"chargeTips2"),this.barbc.max();this.vipIcon.source=vipControl.isSuperVip(t)?"sviphuizhang":"viphuizhang",BitmapNumber.ins().changeNum(this.vipValue,vipControl.getVipLevel(t),"vip_v",3),vipControl.getVipLevel(t)<10?(this.vipValue.x=36,this.vipValue.y=39):(this.vipValue.x=26,this.vipValue.y=39),this.tipsText.textFlow=TextUtils.generateTextFlow(n)},e}(BaseEuiView);__reflect(PayView.prototype,"PayView");var BtnTab8ItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="BtnTab8ItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.refushInfo()},e.prototype.refushInfo=function(){this.iconImage.source="day_"+this.data},e}(BaseItemRender);__reflect(BtnTab8ItemRender.prototype,"BtnTab8ItemRender");var PayDailyGetExtraItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="PayDailyGetExtraItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.cfg;this.price.text=LangMgr.getValueByKey("dollar",Math.floor(t.pay/GlobalModel.chargeRate)),this.select.source="upgrate_tabbar_select"+(1==this.data.type?1:0),this.select.scaleX=2==this.data.type?-1:1,this.select.x=2==this.data.type?this.select.width:0,this.bg.source="upgrate_tabbar_btn"+(1==this.data.type?1:0),this.bg.scaleX=2==this.data.type?-1:1,this.bg.x=2==this.data.type?this.bg.width+8:8},e.prototype.invalidateState=function(){this.price.textColor=this.selected?16777164:14654050,this.select.visible=this.selected},e}(BaseItemRender);__reflect(PayDailyGetExtraItemRender.prototype,"PayDailyGetExtraItemRender");var PayFirstItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.iconImage.source="shouchong_day"+this.data},e}(BaseItemRender);__reflect(PayFirstItemRenderer.prototype,"PayFirstItemRenderer");var PayItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.totalPower=BitmapNumber.ins().createNumPic(0,"vip_v",5),this.totalPower.x=0,this.totalPower.y=0,this.moneyGroup.addChild(this.totalPower)},e.prototype.dataChanged=function(){this.gain0.text=this.data.itemName,this.gain1.text=this.data.desc,this.yuanbaoImg.source=this.data.icon;var t=this.data.cash;this.pay.text=GlobalModel.currentType+t,payControl.getOrderByIndex(this.data.id)?BitmapNumber.ins().changeNum(this.totalPower,this.data.amount,"vip_v",3):BitmapNumber.ins().changeNum(this.totalPower,this.data.award,"vip_v",3),this.moneyGroup.width=this.totalPower.width,this.invalidateState()},e.prototype.getCurrentState=function(){var t="up";return payControl.getOrderByIndex(this.data.id)?this.selected&&(t="down"):(t="firstUp",this.selected&&(t="fistDown")),t},e}(BaseItemRender);__reflect(PayItemRenderer.prototype,"PayItemRenderer");var PayLimitItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchChildren=!1,this.addEventTouchTap(this,this.onTouch)},e.prototype.dataChanged=function(){var t=this.data;this.rmb.text=GlobalModel.currentType+t.cash,this.yuanbao.text=(t.award*payControl.limitChargeMultiple).toString(),this.enabled=0==payControl.limitData.states[t.id]},e.prototype.onTouch=function(t){if(payControl.limitData.endTime>=GameServer.serverTime)return void tipsControl.showTips(LangMgr.getValueByKey("playTips4"));var e=this.data;payControl.showReCharge(400+e.id)},e}(BaseItemRender);__reflect(PayLimitItemRenderer.prototype,"PayLimitItemRenderer");var PieceControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.isOpen=function(){return reincarnationControl.isOpen()||ashtarteControl.ZhanLingOpen()||runeControl.isOpen()||beastControl.checkOpen()},e.prototype.redPoint=function(){var t=!1;return reincarnationControl.isOpen()&&(t=reincarnationControl.isCanCompose()),!t&&ashtarteControl.ZhanLingOpen()&&(t=this.isZlCanMerge()),!t&&runeControl.isOpen()&&(t=runeControl.isRuneCanMerge()),!t&&beastControl.checkOpen()&&(t=beastControl.canTypeCompose(5)),t},e.prototype.getMergeMenu=function(){var t=DataCenter.ins().PieceTotalConfig,e=ActorControl.level,i=reincarnateControl.lv,n=[];for(var o in t)1==t[o].type?reincarnationControl.isOpen()&&n.push(t[o]):2==t[o].type?ashtarteControl.ZhanLingOpen()&&n.push(t[o]):4==t[o].type?beastControl.checkOpen()&&n.push(t[o]):(t[o].openZs||0)<=i&&(t[o].openLv||0)<=e&&n.push(t[o]);n.sort(this.sortMenu);for(var s=[],o=0;o<n.length;o++){var r=n[o];s.push({selected:!1,config:r})}return s},e.prototype.getMergeSecMenu=function(t){var e=DataCenter.ins().PieceConfig[t],i=ActorControl.level,n=reincarnateControl.lv,o=[];for(var s in e)(!e[s].openDay||GameServer.serverOpenDay+1>=e[s].openDay)&&(e[s].openZs||0)<=n&&(e[s].openLv||0)<=i&&o.push(e[s]);return o.sort(this.sortMenu),o},e.prototype.sortMenu=function(t,e){return SortUtils.sortAscByKey(t.sort,e.sort)},e.prototype.getListData=function(t,e){var i=DataCenter.ins().PieceTotalConfig[t],n=DataCenter.ins().PieceConfig[t][e];return 1==i.type?reincarnationControl.composeEquipMap[n.lv][n.openZs]:2==i.type?this.getZlMergeEquipByLv(n.lv):3==i.type?runeControl.getRuneMergeEquipByLv(n.lv):4==i.type?beastControl.getListByQuality(n.lv):[]},e.prototype.isCanMergeById=function(t){var e=DataCenter.ins().PieceTotalConfig[t].type,i=!1;switch(e){case 1:i=reincarnationControl.isCanTypeCompose(t);break;case 2:i=this.isZlCanMerge();break;case 3:i=runeControl.isRuneCanMerge();break;case 4:i=beastControl.canTypeCompose(t)}return i},e.prototype.isCanMergeByIndex=function(t,e){var i=DataCenter.ins().PieceTotalConfig[t].type,n=!1;switch(i){case 1:n=reincarnationControl.isCanZsLvCompose(DataCenter.ins().PieceConfig[t][e].lv,DataCenter.ins().PieceConfig[t][e].openZs);break;case 2:n=this.isZlCanMergeByIndex(t,e);break;case 3:n=!!runeControl.isRuneCanMergeByType(e);break;case 4:n=beastControl.canTypeCompose(t,e)}return n},e.prototype.getCanMergeTargetId=function(t,e){var i=DataCenter.ins().PieceTotalConfig[t].type,n=0;switch(i){case 1:var o=DataCenter.ins().PieceConfig[t][e];n=reincarnationControl.getComposeEquipId(o.lv,o.openZs);break;case 2:n=this.getZlCanMergeTargetId(t,e);break;case 4:}return n},e.prototype.isCanMergeTargetId=function(t,e){if(1==t){var i=DataCenter.ins().ReincarnationEqComConfig[e];return reincarnationControl.isCanEquipCompose(i.material.id)}return 2==t?this.isZlEquipIdCanMerge(e):3==t?runeControl.isRuneCanMergeByID(e):4==t?beastControl.canNeedIdCompose(e-1e3):!1},e.prototype.getZlMergeEquipByLv=function(t){if(!this._zlMergeEquip){this._zlMergeEquip={};var e=DataCenter.ins().AshtarteEquipConfig;for(var i in e)this._zlMergeEquip[e[i].level]||(this._zlMergeEquip[e[i].level]=[]),this._zlMergeEquip[e[i].level].push({type:2,id:e[i].id})}return this._zlMergeEquip[t+1]},e.prototype.getZlCanMergeTargetId=function(t,e){for(var i=DataCenter.ins().PieceConfig[t][e].lv,n=this.getZlMergeEquipByLv(i),o=0,s=n;o<s.length;o++){var r=s[o];if(this.isZlEquipIdCanMerge(r.id))return r.id}return 0},e.prototype.isZlCanMerge=function(){var t=DataCenter.ins().AshtarteEquipConfig;for(var e in t)if(this.isZlEquipIdCanMerge(e))return!0;return!1},e.prototype.isZlCanMergeByIndex=function(t,e){return!!this.getZlCanMergeTargetId(t,e)},e.prototype.isZlEquipIdCanMerge=function(t){var e=DataCenter.ins().AshtarteEquipConfig[t],i=e.mat;if(i){var n=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,i[0].id)+this.getZlHadEquipCount(i[0].id);if(n>=i[0].count)return!0}return!1},e.prototype.getZlHadEquipCount=function(t){var e=DataCenter.ins().AshtarteEquipConfig[t];return ashtarteControl.getZhanLingDataByItem(0,e.pos)==t?1:0},e.prototype.dispatchComposeSecSel=function(t){EventMgr.ins().dispatch(638,[t])},e}(BaseSystem);__reflect(PieceControl.prototype,"PieceControl");var PiecePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._id=-1,e._index=-1,e._lastTabIndex=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initUI()},e.prototype.initUI=function(){this.list.itemRenderer=PieceMenuItemRender,this._tabListData=new eui.ArrayCollection,this.list.dataProvider=this._tabListData,this.list0.itemRenderer=ReincarnationComposeItemRender,this._listData=new eui.ArrayCollection,this.list0.dataProvider=this._listData},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(266,this.buffUpdata),this.addCustomEvent(268,this.buffUpdata),this.addCustomEvent(267,this.buffUpdata),this.addCustomEvent(638,this.updateComposeSecSel),this.addEventItemTap(this.list,this.onList),this.initMenuTab(),this.updateState(),void 0!=t[0]&&void 0!=t[1]&&void 0!=t[2]&&this.selectList(t[0],t[1],t[2])},e.prototype.updateComposeSecSel=function(t){var e=t[0];e.data.id==this.id&&e.data.index==this.index&&e.setSelect(!0)},e.prototype.initMenuTab=function(){this._tabListData.source=pieceControl.getMergeMenu()},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),e.prototype.buffUpdata=function(){this.delayUpdateState()},e.prototype.delayUpdateState=function(){for(var t=0;t<this._tabListData.length;t++)this._tabListData.itemUpdated(this._tabListData.getItemAt(t));this.updateState()},e.prototype.onList=function(t){if(this._lastTabIndex!=t.itemIndex){for(var e=t.itemIndex,i=1,n=0,o=this._tabListData.getItemAt(e).config.id,s=pieceControl.getMergeSecMenu(o),r=0;r<s.length;r++)if(n=pieceControl.getCanMergeTargetId(s[r].id,s[r].index)){i=s[r].index;break}if(!n){o=this._tabListData.getItemAt(0).config.id;var a=pieceControl.getMergeSecMenu(o);i=a[0].index}this.setSelect(e,i-1,n)}},e.prototype.updateState=function(){if(0!=this._tabListData.length){var t=this._id,e=this._lastTabIndex,i=this._index,n=0;if(-1==this._id||-1==this._index){for(var o=0;o<this._tabListData.length;o++){t=this._tabListData.getItemAt(o).config.id;for(var s=pieceControl.getMergeSecMenu(t),r=0;r<s.length;r++)if(n=pieceControl.getCanMergeTargetId(s[r].id,s[r].index)){i=s[r].index,e=o;break}if(n)break}if(!n){t=this._tabListData.getItemAt(0).config.id;var s=pieceControl.getMergeSecMenu(t);i=s[0].index}}else n=pieceControl.getCanMergeTargetId(t,i);this.setSelect(e,i-1,n)}},e.prototype.updateView=function(t,e,i){void 0===i&&(i=0);var n=this._id!=t||this._index!=e;this._id=t,this._index=e;var o=pieceControl.getListData(t,e);this._listData.replaceAll(o.concat()),this.contentScroller.validateNow(),this.refushBarList(i,n)},e.prototype.refushBarList=function(t,e){if(void 0===e&&(e=!0),e&&(this.contentScroller.viewport.scrollV=0),t&&e)for(var i=this.list0.dataProvider,n=0;n<i.length;n++)if(t==i.getItemAt(n).id){var o=101*n;
o>this.contentScroller.viewport.contentHeight-this.contentScroller.viewport.height&&(o=this.contentScroller.viewport.contentHeight-this.contentScroller.height),0>o&&(o=0),this.contentScroller.viewport.scrollV=o;break}},e.prototype.unSelectList=function(){for(var t=this.list.dataProvider.length,e=0;t>e;e++)for(var i=this.list.getVirtualElementAt(e),n=i.list,o=0;o<n.dataProvider.length;o++){var s=n.getVirtualElementAt(o);s&&s.setSelect(!1)}},e.prototype.selectList=function(t,e,i){void 0===i&&(i=0);for(var n=0,o=0;o<this._tabListData.length;o++){var s=this._tabListData.getItemAt(o).type;if(t==s){n=o;break}}this.setSelect(n,e-1,i)},e.prototype.setSelect=function(t,e,i){if(void 0===i&&(i=0),this._lastTabIndex!=t&&this._lastTabIndex>=0){var n=this._tabListData.getItemAt(this._lastTabIndex);n.selected=!1,this._tabListData.itemUpdated(n)}this._lastTabIndex=t;var o=this._tabListData.getItemAt(this._lastTabIndex);o.selected=!0,this._tabListData.itemUpdated(o);var s=this.list.getVirtualElementAt(t),r=s.list,a=r.getVirtualElementAt(e);a&&a.setSelect(!0),this.updateView(s.data.config.id,e+1,i)},e.prototype.close=function(){this._id=-1,this._index=-1},__decorate([callDelay(100)],e.prototype,"delayUpdateState",null),__decorate([callLater],e.prototype,"refushBarList",null),e}(BasePanel);__reflect(PiecePanel.prototype,"PiecePanel");var PieceMenuItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.list.itemRenderer=PieceSecMenuItemRenderer,this.addEventItemTap(this.list,this.onListChange),this.listData=new eui.ArrayCollection,this.list.dataProvider=this.listData},e.prototype.onListChange=function(){var t=this.list.selectedItem,e=UIMgr.ins().getView(BackpackView).piecePanel;e.updateView(t.id,t.index,pieceControl.getCanMergeTargetId(t.id,t.index)),e.unSelectList(),this.list.getVirtualElementAt(this.list.selectedIndex).setSelect(!0)},e.prototype.selectList=function(t){this.list.selectedIndex=t;var e=this.list.getVirtualElementAt(this.list.selectedIndex);e.selected=!0,e.setSelect(!0)},e.prototype.dataChanged=function(){var t=this.data.config;this.data.selected?this.listData.replaceAll(pieceControl.getMergeSecMenu(t.id)):this.listData.replaceAll([]),this.redPoint.visible=pieceControl.isCanMergeById(t.id),this.rein_equips.source=t.btn_source},e}(BaseItemRender);__reflect(PieceMenuItemRender.prototype,"PieceMenuItemRender");var PieceSecMenuItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.lv.text=""+t.btn_name,this.redPoint.visible=pieceControl.isCanMergeByIndex(t.id,t.index),this.chosen.visible=!1,pieceControl.dispatchComposeSecSel(this)},e.prototype.setSelect=function(t){this.chosen.visible=t},e}(BaseItemRender);__reflect(PieceSecMenuItemRenderer.prototype,"PieceSecMenuItemRenderer");var PortalShow=function(){function t(){}return t.topMain=1,t.leftGroup=2,t.rightGroup=4,t.downGroup=8,t.topGroup=16,t.downSortBtn=32,t}();__reflect(PortalShow.prototype,"PortalShow");var PortalControl=function(t){function e(){var i=t.call(this)||this;return i.showTipsObj=null,i.addCustomEvent(445,i.publicBossRelive),i.addCustomEvent(493,i.updateAutoPk),i.addCustomEvent(473,function(t){if(DeviceUtils.IsMobile){var e=UIMgr.playFun;e&&e.setVisible(!t)}}),i.addCustomEvent(353,function(){var t=MapControl.copyId;if(!toseongControl.isToseong){if(!t||1==MapControl.copyType)return UIMgr.ins().isShow(PortalView)||UIMgr.ins().open(PortalView),void(1==MapControl.copyType?i.dispatchShowViews(PortalShow.topMain):i.dispatchShowViews(e.showAll));UIMgr.ins().close(PortalView)}}),i}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.openAuto=function(){var t=UIMgr.playFun;t&&(t.autoPkBoss.selected=!0),this.updateAutoPk()},e.prototype.closeAuto=function(){var t=UIMgr.playFun;t&&(t.autoPkBoss.selected=!1),this.updateAutoPk()},e.prototype.publicBossRelive=function(t){var e=t[0],i=t[1],n=UIMgr.playFun;n&&n.publicBossRelive(e,i)},e.prototype.upDataWillBoss=function(t){var e=UIMgr.playFun;e&&e.upDataWillBoss(t)},e.prototype.updateAutoPk=function(){if(!copyControl.bossIsChallenged){var t=copyControl.energy,e=copyControl.currentEnergy,i=UIMgr.playFun;i&&i.autoPkBoss.selected&&e>=t?backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?(i.autoPkBoss.selected=!1,tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace")),this.removePkArrowTips()):copyControl.guanqiaID<DataCenter.ins().InstanceBaseConfig.maxCheckPoint?this.addPkArrowTips():(tipsControl.showCenterTips(LangMgr.getValueByKey("tipsMaxLevel")),this.removePkArrowTips()):this.removePkArrowTips()}},e.prototype.dispatchShowViews=function(t,e){void 0===e&&(e=!1),EventMgr.ins().dispatch(187,[t,e])},e.prototype.addPkArrowTips=function(){var t=this,e=UIMgr.playFun;e&&!this.showTipsObj&&(this.showTipsObj={},e.showTaskTips(LangMgr.getValueByKey("tipsPowerEnought")),egret.Tween.get(this.showTipsObj).wait(1500).call(function(){e.autoPkBoss.selected&&(gameControl.startPkBoss(),t.removePkArrowTips())}))},e.prototype.removePkArrowTips=function(){this.showTipsObj&&(egret.Tween.removeTweens(this.showTipsObj),this.showTipsObj=null)},e.showAll=PortalShow.topMain|PortalShow.leftGroup|PortalShow.rightGroup|PortalShow.downGroup|PortalShow.topGroup|PortalShow.downSortBtn,e}(BaseSystem);__reflect(PortalControl.prototype,"PortalControl");var AmusementAthleticsPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,183,374,376,178,446],n.updateMessage=[178,446],n}return __extends(e,t),e.prototype.createTar=function(){return t.prototype.createTar.call(this),GameServer.serverOpenDay<7&&SwitchMgr.ins().checkOpen(1010)?this.tar.icon="zjmkfjj_png":GameServer.serverOpenDay>=7&&(this.tar.icon="zjmlibao"),this.tar},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:GameServer.serverOpenDay<7&&SwitchMgr.ins().checkOpen(1010)?!0:GameServer.serverOpenDay>=7&&SwitchMgr.ins().checkOpen(1)?payControl.getCurDailyRechargeIsAllGet()?!1:!0:!1},e.prototype.checkShowRedPoint=function(){if(GameServer.serverOpenDay<7&&SwitchMgr.ins().checkOpen(1010)){var t=amusementControl.activityData;for(var e in t)if(t[e]&&101==t[e].pageType&&amusementControl.getAmusementDataById(+e).isOpenActivity()&&amusementControl.getAmusementDataById(+e).canReward())return 1;t=pAmusementControl.activityData;for(var e in t)if(t[e]&&101==t[e].pageType&&pAmusementControl.getAmusementDataById(+e).isOpenActivity()&&pAmusementControl.getAmusementDataById(+e).canReward())return 1}else if(GameServer.serverOpenDay>=7&&!payControl.getCurDailyRechargeIsAllGet()){var i=0,n=payControl.getRechargeData(0);if(1==n.num)i=n.num;else if(2==n.num){var o=payControl.getCurRechargeConfig();for(var e in o){var s=n.isAwards>>o[e].index&1;if(0==s&&n.curDayPay>=o[e].pay)return 1}}}return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){this.update(),GameServer.serverOpenDay<7?UIMgr.ins().open(AmusementUniversalView,0,101,"AmusementWinViewSkin","biaoti_huodong"):UIMgr.ins().open(PayDailyView)},e}(PortalBase);__reflect(AmusementAthleticsPortalIcon.prototype,"AmusementAthleticsPortalIcon");var AmusementOpenServerPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[461,374,376,392,437],n.updateMessage=[457,178,180,446,392,437],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(GameServer.serverOpenDay>=7)return!1;if(!SwitchMgr.ins().checkOpen(2))return!1;var t=Object.keys(amusementControl.activityData),e=Object.keys(pAmusementControl.activityData);if(!t.length&&!e.length)return!1;var i=amusementControl.activityData;for(var n in i){var o=i[n];if(!o.pageType&&2!=o.timeType&&3!=o.timeType&&o.isOpenActivity()&&!o.getHide())return!0}i=pAmusementControl.activityData;for(var n in i){var o=i[n];if(!o.pageType&&o.isOpenActivity()&&!o.getHide())return!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(!i.pageType&&2!=i.timeType&&3!=i.timeType&&i.isOpenActivity()&&i.canReward())return 1}t=pAmusementControl.activityData;for(var e in t){var i=t[e];if(!i.pageType&&i.isOpenActivity()&&i.canReward())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(AmusementOpenServerView),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(AmusementOpenServerPortalIcon.prototype,"AmusementOpenServerPortalIcon");var AmusementTotalEnterPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[461,374,376,392,437],n.updateMessage=[457,178,180,446,392,437],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(GameServer.serverOpenDay<7)return!1;if(!SwitchMgr.ins().checkOpen(2))return!1;var t=Object.keys(amusementControl.activityData),e=Object.keys(pAmusementControl.activityData);if(!t.length&&!e.length)return!1;var i=amusementControl.activityData;for(var n in i){var o=i[n];if(!o.pageType&&2!=o.timeType&&3!=o.timeType&&o.isOpenActivity()&&!o.getHide())return!0}i=pAmusementControl.activityData;for(var n in i){var o=i[n];if(!o.pageType&&o.isOpenActivity()&&!o.getHide())return!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(!i.pageType&&2!=i.timeType&&3!=i.timeType&&i.isOpenActivity()&&i.canReward())return 1}t=pAmusementControl.activityData;for(var e in t){var i=t[e];if(!i.pageType&&i.isOpenActivity()&&i.canReward())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(AmusementTotalEnterView),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(AmusementTotalEnterPortalIcon.prototype,"AmusementTotalEnterPortalIcon");var AmusementUniversalPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.firstTap=!0,n.funOpenId=0,n.acyPageType=-1,n.viewTitle="biaoti_huodong",n.viewSkin="AmusementWinViewSkin";var o=n.getConfig();return n.acyPageType=o.activityParam&&o.activityParam.pageType?o.activityParam.pageType:n.acyPageType,n.viewSkin=o.activityParam&&o.activityParam.viewSkin?o.activityParam.viewSkin:n.viewSkin,n.viewTitle=o.activityParam&&o.activityParam.viewTitle?o.activityParam.viewTitle:n.viewTitle,n.funOpenId=o.activityParam&&o.activityParam.funOpenId?o.activityParam.funOpenId:n.funOpenId,n.showMessage=[461,374,376,392,183,178,446],n.updateMessage=[392,457,178,180,446,266,268,400,401],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(this.funOpenId>0&&!SwitchMgr.ins().checkOpen(this.funOpenId))return!1;var t=amusementControl.activityData;for(var e in t){var i=t[e];if(i.pageType==this.acyPageType&&i.isOpenActivity()&&!i.getHide())return!0}t=pAmusementControl.activityData;for(var e in t){var i=t[e];if(i.pageType==this.acyPageType&&i.isOpenActivity()&&!i.getHide())return!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(i.pageType==this.acyPageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}t=pAmusementControl.activityData;for(var e in t){var i=t[e];if(i.pageType==this.acyPageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(AmusementUniversalView,0,this.acyPageType,this.viewSkin,this.viewTitle),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(AmusementUniversalPortalIcon.prototype,"AmusementUniversalPortalIcon");var ArtifactPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[374,376,91,45,46,686],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return this.updateInfo(),!1},e.prototype.updateInfo=function(){var t,e=copyControl.getCurrentReward(),i=copyControl.getNextReward();if(e)t=e[0],copyControl.getMapReward(),this.pretips&&this.pretips==t.id||(this.pretips=t.id,tipsControl.showItemTips(t.id));else if(i&&(t=i[0],this.labelChapter)){var n=LangMgr.getValueByKey("playTips8",copyControl.getNextNeedChapter());this.labelChapter.textFlow=TextUtils.generateTextFlow1(n)}t&&this.tar&&this.setReward(t)},e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.labelInfo=e.labelInfo,this.imgInfo=e.imgInfo,this.imgName=e.imgName,this.imgItem=e.imgItem,this.labelChapter=e.labelChapter,this.groupEff=e.groupEff,this.updateInfo(),e},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(TargetView,1),artifactControl.showGuide=-2e3},e.prototype.setReward=function(t){var e=artifactControl.getConfByChipId(t.id);e&&(this.imgName.source=e.imgName,this.imgItem.source=e.img,this.imgInfo.source=e.simpleDesc,this.labelInfo.text=e.buttonDesc)},e.prototype.getEffName=function(t){},e}(PortalBase);__reflect(ArtifactPortalIcon.prototype,"ArtifactPortalIcon");var AshtartePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,112],n.updateMessage=[266,262,258,259,260,261,112],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(1003)?!0:!1},e.prototype.checkShowRedPoint=function(){return ashtarteControl.checkRedPoint()?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(SkillView,4)},e}(PortalBase);__reflect(AshtartePortalIcon.prototype,"AshtartePortalIcon");var BargainPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[112],n.updateMessage=[189,190,191,495],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:bargainControl.isAuctionOpen()&&GameServer.serverOpenDay+1<DataCenter.ins().BargainConfig.iconHideday?!0:!1},e.prototype.checkShowRedPoint=function(){return bargainControl.checkRed()&&this.firstTap?1:0},e.prototype.getEffName=function(t){return(this.firstTap||t)&&(this.effX=38,this.effY=38),"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(BargainView),bargainControl.upGetList(0),this.firstTap&&(bargainControl.checkRed()&&(this.firstTap=!1),this.update())},e}(PortalBase);__reflect(BargainPortalIcon.prototype,"BargainPortalIcon");var AmuseTarget0Panel5=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget0Panel5Skin",e}return __extends(e,t),e.prototype.close=function(){this.removeEventTouchTap(this.goBtn,this.onTap),TimerMgr.ins().remove(this.playSkillAnmi,this)},e.prototype.open=function(){this.addEventTouchTap(this.goBtn,this.onTap),TimerMgr.ins().isExists(this.playSkillAnmi,this)||TimerMgr.ins().doTimer(3e3,0,this.playSkillAnmi,this),this.initData()},e.prototype.initData=function(){this.playSkillAnmi(),this.updateData()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.goBtn:UIMgr.ins().close(AmusementTotalEnterView),UIMgr.ins().open(TreasureHuntView)}},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(t.startTime/1e3-GameServer.serverTime/1e3),i=Math.floor(t.endTime/1e3-GameServer.serverTime/1e3);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3);var n=DataCenter.ins().AmusementBtnConfig[this.activityID];this.actDesc.textFlow=TextUtils.generateTextFlow1(n.acDesc)},e.prototype.playSkillAnmi=function(){for(var t=this,e=1;2>=e;e++)this["mc"+e]||(this["mc"+e]=new GameMovieClip);var i=heroControl.getSubRoleByIndex(0),n="skill40"+i.job,o="skill"+(403+i.job),s=egret.Tween.get(this);this.mc1.parent||this.eff1.addChild(this.mc1),this.mc1.playFile(""+PATH_SKILLEFF+n,1,null,!0),s.wait(1500).call(function(){t.mc2.parent||t.eff2.addChild(t.mc2),t.mc2.playFile(""+PATH_SKILLEFF+o,1,null,!0)},this)},e}(BasePanel);__reflect(AmuseTarget0Panel5.prototype,"AmuseTarget0Panel5");var BossPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[376,91,353],n.updateMessage=[296,307,445],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:bossControl.checkBossIconShow()},e.prototype.checkShowRedPoint=function(){return portalControl.newBossRelive||CopyControl.isCanChallenge()||bossControl.checkWorldBossRedPoint(2)||bossControl.checkWorldBossRedPoint(1)||bossControl.checkWorldBossRedPoint(3)||bossControl.checkWorldBossRedPoint(4)||bossControl.checkWorldBossRedPoint(7)?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(BossView),bossControl.dispatchBossData(!1)},e}(PortalBase);__reflect(BossPortalIcon.prototype,"BossPortalIcon");var BullyingServerPortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.checkShowIcon=function(){if(!SwitchMgr.ins().checkOpen(1017))return!1;var t=GlobalModel.getUrlParamValue("appver");return"Yyb"==GlobalModel.pf&&""!=t&&t>0},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){SDKManager.ins().SDKShowImmersiveIconNative("vplayer")},e}(PortalBase);__reflect(BullyingServerPortalIcon.prototype,"BullyingServerPortalIcon");var CbtestAmusementPortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(23)},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(CbtestAmusementView)},e}(PortalBase);__reflect(CbtestAmusementPortalIcon.prototype,"CbtestAmusementPortalIcon");var CDkeyPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376],n.updateMessage=[175,79,396,181,392,288,177,677],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(5)},e.prototype.checkShowRedPoint=function(){return signInControl.showRedPoint()||amusementControl.getSevenDayStast()||payControl.franchise&&payControl.franchiseget||amusementControl.checkNoticeRed()||dailyRedBagControl.isRedPoint()?1:0},e.prototype.getEffName=function(t){},e.prototype.tapExecute=function(){UIMgr.ins().open(WelfareView),this.update()},e}(PortalBase);__reflect(CDkeyPortalIcon.prototype,"CDkeyPortalIcon");var CopyPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[353,461,91],n.updateMessage=[521],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(12)&&!copyControl.pkGqboss},e.prototype.checkShowRedPoint=function(){return CopyRedPoint.ins().redPoint?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(CopyView)},e}(PortalBase);__reflect(CopyPortalIcon.prototype,"CopyPortalIcon");var CrazyDogPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,466,678,651,453],n.updateMessage=[678,651,453],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:DataCenter.ins().CrazyDogBaseConfig.openserverday<=GameServer.serverOpenDay+1&&ActorControl.level>=DataCenter.ins().CrazyDogBaseConfig.level&&reincarnateControl.lv>=(DataCenter.ins().CrazyDogBaseConfig.zsLeve?DataCenter.ins().CrazyDogBaseConfig.zsLeve:0)?!0:!1},e.prototype.checkShowRedPoint=function(){return CrazyDogRedPoint.ins().redpoint},e.prototype.tapExecute=function(){return heroControl.getSubRoleByJob(3)?void UIMgr.ins().open(CrazyDogView):void tipsControl.warnTips(LangMgr.getValueByKey("crazyDog1"))},e}(PortalBase);__reflect(CrazyDogPortalIcon.prototype,"CrazyDogPortalIcon");var CrossArenaPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._time=0,n.showMessage=[112,318,324],n.updateMessage=[543],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this._timeTxt=new eui.Label,this._timeTxt.x=0,this._timeTxt.y=70,this._timeTxt.width=70,this._timeTxt.textAlign="center",this._timeTxt.text="",this._timeTxt.size=14,this._timeTxt.textColor=LangMgr.getColor("color43"),e.addChild(this._timeTxt),this.setState(),e},e.prototype.setRepeat=function(){this._time--,this._time>0?this._timeTxt&&(this._timeTxt.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4)):(crossArenaControl.isStartIng=1,this._timeTxt&&(1==crossArenaControl.macthState?this._timeTxt.text=LangMgr.getValueByKey("playTips2"):this._timeTxt.text=LangMgr.getValueByKey("BattleComing")),TimerMgr.ins().removeAll(this))},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=crossArenaControl.isOpen();return this.setState(),t},e.prototype.setState=function(){var t=crossArenaControl.isOpen();if(t&&this.tar)if(1==crossArenaControl.macthState)this._timeTxt.text=LangMgr.getValueByKey("playTips2");else if(1==crossArenaControl.isStartIng)this._timeTxt.text=LangMgr.getValueByKey("BattleComing");else{var e=crossArenaControl.getOpenLeftTime();e>0&&(this._time=e,this._timeTxt.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4),TimerMgr.ins().isExists(this.setRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this))}},e.prototype.checkShowRedPoint=function(){return CrossArenaRedPoint.ins().redpoint},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(CrossArenaView,0)},e}(PortalBase);__reflect(CrossArenaPortalIcon.prototype,"CrossArenaPortalIcon");var CrossFieldPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[112],n.updateMessage=[550,557],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:crossBossControl.isOpen()},e.prototype.checkShowRedPoint=function(){return CrossFieldRedPoint.ins().redPoint+TotemBossRedpoint.ins().redpoint},e.prototype.tapExecute=function(){UIMgr.ins().open(CrossFieldView)},e}(PortalBase);__reflect(CrossFieldPortalIcon.prototype,"CrossFieldPortalIcon");var DailyRedBagPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.ani=!0,n.lastRedPoint=!1,n.showMessage=[461,112,374,376,288,177,466,677],n.updateMessage=[288,177,677,679],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this),i=DataCenter.ins().ClientGlobalConfig.spokesmanredbag,n=spokesPersonControl.checkBaseOpen(i.openTerm);return n&&(e.iconDisplay.source=i.img),this.playAni(),e},e.prototype.onAddToStage=function(){dailyRedBagControl.checkSysOpen()&&!TimerMgr.ins().isExists(this.runTime,this)&&dailyRedBagControl.isCount()&&TimerMgr.ins().doTimer(1e3,0,this.runTime,this)},e.prototype.onRemoveFromStage=function(){TimerMgr.ins().isExists(this.runTime,this)&&TimerMgr.ins().remove(this.runTime,this)},e.prototype.runTime=function(){if(!dailyRedBagControl.checkSysOpen())return TimerMgr.ins().remove(this.runTime,this),void this.updateShow();if(!dailyRedBagControl.isCount())return TimerMgr.ins().remove(this.runTime,this),void this.updateShow();var t=dailyRedBagControl.getLeftTime();t||TimerMgr.ins().remove(this.runTime,this),dailyRedBagControl.dispatchRuleIconRedPoint(),this.updateShow()},e.prototype.checkShowIcon=function(){return dailyRedBagControl.checkSysOpen()&&!TimerMgr.ins().isExists(this.runTime,this)&&dailyRedBagControl.isCount()&&TimerMgr.ins().doTimer(1e3,0,this.runTime,this),this.playAni(),dailyRedBagControl.checkSysOpen()&&dailyRedBagControl.isRedPoint()},e.prototype.checkShowRedPoint=function(){return dailyRedBagControl.isRedPoint()?1:0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){this.firstTap&&(this.firstTap=!1,this.update()),UIMgr.ins().open(WelfareView,6)},e.prototype.playAni=function(){if(this.tar){var t=dailyRedBagControl.isRedPoint();!this.lastRedPoint&&t&&TweenUtil.JumpAniByBottom(this.tar,900,1e3),this.lastRedPoint=t}},e}(PortalBase);__reflect(DailyRedBagPortalIcon.prototype,"DailyRedBagPortalIcon");var DesktopPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[687],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(21)&&1==platformAmuseControl.isShowGameDesktop},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){platformAmuseControl.saveGameDesktop()},e}(PortalBase);__reflect(DesktopPortalIcon.prototype,"DesktopPortalIcon");var DirectShop1PortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.actId=0,n.pageSkin="",n.showMessage=[392,461,374,376,106,466],n.updateMessage=[392],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,e},e.prototype.runTime=function(){var t=amusementControl.getAmusementDataById(this.actId);if(!t)return void this.stopRun();var e=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);e>=0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_12)):(this.stopRun(),this.updateShow())},e.prototype.onAddToStage=function(){t.prototype.onAddToStage.call(this),this.autoOpenWin(),this.startRun()},e.prototype.onRemoveFromStage=function(){t.prototype.onRemoveFromStage.call(this),this.stopRun()},e.prototype.startRun=function(){TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().loop(1e3,this.runTime,this),this.runTime()},e.prototype.stopRun=function(){this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this)},e.prototype.checkShowIcon=function(){if(!SwitchMgr.ins().checkOpen(1028))return!1;if(payControl.isFisrtCharge())return!1;var t=amusementControl.activityData;for(var e in t){var i=t[e];if(108==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide())return this.actId&&this.actId!=+e?(this.actId=+e,this.pageSkin=i.pageSkin,this.startRun()):(this.actId=+e,this.pageSkin=i.pageSkin),this.updateIcon(i),!0}return!1},e.prototype.updateIcon=function(t){this.tar||this.getTar();var e=DataCenter.ins().Amusement26Config[t.id];for(var i in e)if(e[i].Zjmicon)return void(this.tar.icon=e[i].Zjmicon)},e.prototype.autoOpenWin=function(){if(!MapControl.copyId&&!ClientStorage.ins().getValue("DirectShopWinKey")){ClientStorage.ins().setValue("DirectShopWinKey",1);var t=DataCenter.ins().Amusement26Config[this.actId],e=!1;for(var i in t)if(0==t[i].eject){e=!0;break}e&&this.tapExecute()}},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(108==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide()&&i.canReward())return 1}return 0},e.prototype.tapExecute=function(){"DirectShopCashViewSkin"==this.pageSkin?UIMgr.ins().open(DirectShopCash1View):UIMgr.ins().open(DirectShop1View)},e}(PortalBase);__reflect(DirectShop1PortalIcon.prototype,"DirectShop1PortalIcon");var DirectShopPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.actId=0,n.pageSkin="",n.showMessage=[392,461,374,376,106,466],n.updateMessage=[392],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,e},e.prototype.runTime=function(){var t=amusementControl.getAmusementDataById(this.actId);if(!t)return void this.stopRun();var e=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);e>=0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_12)):(this.stopRun(),this.updateShow())},e.prototype.onAddToStage=function(){t.prototype.onAddToStage.call(this),this.autoOpenWin(),this.startRun()},e.prototype.onRemoveFromStage=function(){t.prototype.onRemoveFromStage.call(this),this.stopRun()},e.prototype.startRun=function(){TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().loop(1e3,this.runTime,this),this.runTime()},e.prototype.stopRun=function(){this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this)},e.prototype.checkShowIcon=function(){if(!SwitchMgr.ins().checkOpen(80))return!1;if(payControl.isFisrtCharge())return!1;var t=amusementControl.activityData;for(var e in t){var i=t[e];if(29==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide())return this.actId&&this.actId!=+e?(this.actId=+e,this.pageSkin=i.pageSkin,this.startRun()):(this.actId=+e,this.pageSkin=i.pageSkin),this.updateIcon(i),!0}return!1},e.prototype.updateIcon=function(t){this.tar||this.getTar();var e=DataCenter.ins().Amusement26Config[t.id];for(var i in e)if(e[i].Zjmicon)return void(this.tar.icon=e[i].Zjmicon)},e.prototype.autoOpenWin=function(){if(!MapControl.copyId&&!ClientStorage.ins().getValue("DirectShopWinKey")){ClientStorage.ins().setValue("DirectShopWinKey",1);var t=DataCenter.ins().Amusement26Config[this.actId],e=!1;for(var i in t)if(0==t[i].eject){e=!0;break}e&&this.tapExecute()}},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(29==i.pageType&&26==i.type&&i.isOpenActivity()&&!i.getHide()&&i.canReward())return 1}return 0},e.prototype.tapExecute=function(){"DirectShopCashViewSkin"==this.pageSkin?UIMgr.ins().open(DirectShopCashView):UIMgr.ins().open(DirectShopView)},e}(PortalBase);__reflect(DirectShopPortalIcon.prototype,"DirectShopPortalIcon");var DoubleTwelvePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[461,392],n.updateMessage=[392],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(35))return!1;var t=amusementControl.doubleTwelveData;for(var e in t)if(t[e].isOpenActivity())return!0;return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.doubleTwelveData;for(var e in t)if(t[e].isOpenActivity()&&9==t[e].type)for(var i=0;3>i;i++)if(amusementControl.isGetRollReward(t[e].id,i))return 1;return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(DoubleTwelveView),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(DoubleTwelvePortalIcon.prototype,"DoubleTwelvePortalIcon");var DoubleTwelveRechargePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.time=0,n.showMessage=[392,461],n.updateMessage=[392,178,446],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,e},e.prototype.runTime=function(){var t=this.time;this.time-=1,t>0?this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12):(this.alertText.text="",TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(36))return!1;var t=amusementControl.doubleTwelveRechargeData;for(var e in t)if(t[e].isOpenActivity()){var i=t[amusementControl.doubleTwelveRechargeIDAry[0]];
return i&&(TimerMgr.ins().remove(this.runTime,this),this.time=i.getLeftTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this)),!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.doubleTwelveRechargeData;for(var e in t)if(t[e].canReward())return 1;return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(DoubleTwelveRechargeView),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(DoubleTwelveRechargePortalIcon.prototype,"DoubleTwelveRechargePortalIcon");var DownloadPortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.checkShowIcon=function(){return GlobalModel.showMicroclientDownload},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(DownloadView)},e}(PortalBase);__reflect(DownloadPortalIcon.prototype,"DownloadPortalIcon");var EmailPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[215,217,216],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=emailUserControl.getUnreadMail();return 0>=t?!1:!0},e.prototype.checkShowRedPoint=function(){return emailUserControl.mailData?1:0},e.prototype.blink=function(){var t=egret.Tween.get(this.tar);t.to({alpha:0},500).to({alpha:1},500).call(this.blink.bind(this))},e.prototype.tapExecute=function(){UIMgr.ins().open(PartnerBgView,4)},e}(PortalBase);__reflect(EmailPortalIcon.prototype,"EmailPortalIcon");var FBGiftPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[688],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(1005)&&1==platformAmuseControl.isShowFBGift},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){SDKManager.ins().SDKStartForGift()},e}(PortalBase);__reflect(FBGiftPortalIcon.prototype,"FBGiftPortalIcon");var FBRatePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[689],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(1006)&&1==platformAmuseControl.isShowFBRate},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){SDKManager.ins().SDKFaceStartGift()},e}(PortalBase);__reflect(FBRatePortalIcon.prototype,"FBRatePortalIcon");var FireRingPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376,162],n.updateMessage=[162,268,266],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=SwitchMgr.ins().checkOpen(9);return t},e.prototype.checkShowRedPoint=function(){var t=SwitchMgr.ins().checkOpen(9)&&(superRingControl.checkHaveUpRing()||superRingControl.isCanStudySkill()||superRingControl.isCanUpgradeSkill()||superRingControl.fireRingRedPoint()||flameMarkControl.checkRed());return t?1:0},e.prototype.tapExecute=function(){superRingControl.isFireRingFuse()?UIMgr.ins().open(FireRingView):superRingControl.checkRingOpen()?UIMgr.ins().open(SuperRingInfoView):tipsControl.showTips(LangMgr.getValueByKey("roleActivityAfter"))},e}(PortalBase);__reflect(FireRingPortalIcon.prototype,"FireRingPortalIcon");var FocusAttackPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;n.showMessage=[91];var o=heroControl.getSubRoleByIndex(0);n.guangquan=i.guangquan,n.questNumber=i.questNumber,n.skillName=i.skillName,n.Img=i.Img,n.bgimg=i.bgimg,n.imggroup=i.imggroup,n.eff=i.eff,n.skillName.source="8000"+o.job+"_png",n.questNumber.text="0",n.Img.source="7"+o.job+"000_png",n.bgimg.source="7"+o.job+"000b_png",n.mc=new GameMovieClip,n.eff.addChild(n.mc),n.prossY=0;var s=n.Img.localToGlobal();n.imggroup.globalToLocal(s.x,s.y,s),n.masksp=new egret.Sprite;var r=new egret.Shape;r.graphics.beginFill(LangMgr.getColor("color39")),r.graphics.drawRect(s.x,s.y,n.Img.width,n.Img.height),r.graphics.endFill(),n.prossY=s.y+n.Img.height,n.masksp.y=n.prossY,n.masksp.addChild(r),n.imggroup.addChild(n.masksp),n.Img.mask=n.masksp;var a=n.updatekStep();return n.updatePross(a),n}return __extends(e,t),e.prototype.checkShowIcon=function(){return taskControl.taskTrace?copyControl.pkGqboss?!1:taskControl.taskTrace.id>=TargetView.TASKID?(this.mc.parent&&DisplayUtils.removeFromParent(this.mc),!1):!0:!1},e.prototype.updatekStep=function(t){if(!taskControl.taskTrace)return 0;if(taskControl.taskTrace.id>=TargetView.TASKID)return 0;var e=function(e){if(taskControl.taskTrace.id==DataCenter.ins().GuideAchievementConfig[e].taskId){var n=DataCenter.ins().GuideAchievementConfig[e].index,o=n;t&&(o=n+1),i.questNumber.text=TargetView.TASKID%100-o+1+"";var s=i;return i.showEff(function(){s.updatePross(n)}),t?{value:n>0?n:0}:{value:1>=n?0:n}}},i=this;for(var n in DataCenter.ins().GuideAchievementConfig){var o=e(n);if("object"==typeof o)return o.value}return 0},e.prototype.showEff=function(t){var e=UIMgr.playFun,i=e.taskTraceName,n=i.localToGlobal();e.globalToLocal(n.x,n.y,n),this.jumpmc||(this.jumpmc=new GameMovieClip,this.jumpmc.playFile(PATH_EFF+"bally2",-1)),this.jumpmc.parent||e.addChild(this.jumpmc),this.jumpmc.x=n.x+e.taskTraceBtn.width/2,this.jumpmc.y=n.y,n=e.hejiguide.localToGlobal(),e.globalToLocal(n.x,n.y,n);var o=this;egret.Tween.get(this.jumpmc).to({x:n.x+e.hejiguide.width/2,y:n.y+e.hejiguide.height/2},600).call(function(){o.mc.parent||o.eff.addChild(o.mc),o.mc.playFile(PATH_EFF+"guidecircle",1,function(){DisplayUtils.removeFromParent(o.mc)}),egret.Tween.removeTweens(o.jumpmc),DisplayUtils.removeFromParent(o.jumpmc),t&&"function"==typeof t&&t()})},e.prototype.updatePross=function(t){if(this.masksp){var e=t,i=TargetView.TASKID%100,n=e/i;n=n>=1?1:n,this.masksp.y=this.prossY-Math.abs(this.prossY)*n}},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(TargetView,2),artifactControl.showGuide=-2e3},e.prototype.getEffName=function(t){},e}(PortalBase);__reflect(FocusAttackPortalIcon.prototype,"FocusAttackPortalIcon");var FocusGamePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,690],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(21)&&0==platformAmuseControl.focusState},e.prototype.checkShowRedPoint=function(){return 1},e.prototype.tapExecute=function(){UIMgr.ins().open(FocusGameView)},e}(PortalBase);__reflect(FocusGamePortalIcon.prototype,"FocusGamePortalIcon");var FuncNoticePortalIcon=function(t){function e(e){var i=t.call(this,e)||this;return i.funcNoticeLastLv=0,i.showMessage=[376],i}return __extends(e,t),e.prototype.checkShowIcon=function(){var t=copyControl.guanqiaID,e=FuncNoticeTipsView.getFuncNoticeConfigById(t);if(!e)return!1;var i=e.openLv-t<=10;return i&&(e.openLv-t==0&&(t-this.funcNoticeLastLv==1&&tipsControl.showFuncNotice(t),e=FuncNoticeTipsView.getFuncNoticeConfigById(t+1),(!e||e.openLv-t>10)&&(i=!1)),i&&this.tar&&this.updateButton()),this.funcNoticeLastLv=t,i},e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.updateButton(),e},e.prototype.updateButton=function(){var t=copyControl.guanqiaID,e=FuncNoticeTipsView.getFuncNoticeConfigById(t);this.tar.iconDisplay.source="yg_"+e.index+"0",this.tar.txt.text=LangMgr.getValueByKey("boxOpenDesc1",e.openLv),2==e.index?(this.tar.iconDisplay.x=15,this.tar.iconDisplay.y=0):(this.tar.iconDisplay.x=3,this.tar.iconDisplay.y=-30)},e.prototype.tapExecute=function(){var t=copyControl.guanqiaID,e=FuncNoticeTipsView.getFuncNoticeConfigById(t);e.openLv-t==0&&(t+=1),tipsControl.showFuncNotice(t)},e}(PortalBase);__reflect(FuncNoticePortalIcon.prototype,"FuncNoticePortalIcon");var GodWeaponPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[112,461,4],n.updateMessage=[601],n}return __extends(e,t),e.prototype.checkShowRedPoint=function(){var t=GodWeaponRedPoint.ins().godWeaponRed?1:0;return t},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:ActorControl.level>=DataCenter.ins().GodWeaponBaseConfig.noticeOpenLv&&GameServer.serverOpenDay>=DataCenter.ins().GodWeaponBaseConfig.openDay?!0:!1},e.prototype.tapExecute=function(){UIMgr.ins().open(GodWeaponView)},e}(PortalBase);__reflect(GodWeaponPortalIcon.prototype,"GodWeaponPortalIcon");var HappySevenDayPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n._activityID=0,n.showMessage=[392,461],n.updateMessage=[392],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(41))return!1;var t=amusementControl.activityData,e=Object.keys(t);if(!e||!e.length)return!1;for(var i in t){var n=t[i];if(4==n.pageType&&n.isOpenActivity()&&!n.getHide())return this._activityID=+i,!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(4==i.pageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(HappySevenDayView,this._activityID),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(HappySevenDayPortalIcon.prototype,"HappySevenDayPortalIcon");var HeirloomPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[4,112,157],n.updateMessage=[613],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:GameServer.serverOpenDay+1>=DataCenter.ins().CrazybtplayBossBaseConfig.openDay&&SwitchMgr.ins().checkOpen(69)?3==crazybtplayControl.step?!1:!0:!1},e.prototype.checkShowRedPoint=function(){return CrazybtplayRedPoint.ins().redPoint?1:0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(HeirloomView,1),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(HeirloomPortalIcon.prototype,"HeirloomPortalIcon");var IntensifyPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[54,112],n.updateMessage=[54],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:!magicCircleControl.checkOpen()||magicCircleControl.checkActived()?!1:!0},e.prototype.checkShowRedPoint=function(){return magicCircleControl.checkTaskRed()?1:this.firstTap&&0==magicCircleControl.taskState?1:0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(IntensifyView,4),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(IntensifyPortalIcon.prototype,"IntensifyPortalIcon");var InvestmentPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[461,449,112],n.updateMessage=[461,457,449,112,450,376],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=!1;return SwitchMgr.ins().checkOpen(71)&&investmentControl.IsExistInvest(1)&&(t=!0),SwitchMgr.ins().checkOpen(70)&&investmentControl.IsExistInvest(2)&&(t=!0),investmentControl.IsExistInvest(4)&&(t=!0),t=t?t:investmentControl.isOpenInvest()},e.prototype.checkShowRedPoint=function(){var t,e=DataCenter.ins().InvestmentBaseConfig.afterLoginInvestMoneyId,i=0;for(var n in e)if(investmentControl.IsRedPoint(e[n].payId)){i=1;break}if(SwitchMgr.ins().checkOpen(70)){t=investmentControl.InvestLvReward.toString(2).split("").reverse();for(var n in DataCenter.ins().InvestmentLevelConfig){var o=DataCenter.ins().InvestmentLevelConfig[n].id,s=DataCenter.ins().InvestmentLevelConfig[n].zsLevelLimit||0,r=DataCenter.ins().InvestmentLevelConfig[n].levelLimit||0;if(!investmentControl.InvestLvIsBuy){i=1;break}if(0!=investmentControl.InvestLvReward&&t.some(function(t){return"0"==t})){i=1;break}if(o>t.length&&ActorControl.level>=r&&reincarnateControl.lv>=s){i=1;break}}}t=investmentControl.InvestGuaQiaIsReward.toString(2).split("").reverse();for(var n in DataCenter.ins().InvestmentChapterConfig){var o=DataCenter.ins().InvestmentChapterConfig[n].id,a=DataCenter.ins().InvestmentChapterConfig[n].chapter||0;if(!investmentControl.InvestGuaQiaIsBuy){i=1;break}if(0!=investmentControl.InvestGuaQiaIsReward&&t.some(function(t){return"0"==t})){i=1;break}if(o>t.length&&copyControl.guanqiaID>=a){i=1;break}}return i},e.prototype.getEffName=function(){return this.firstTap?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){this.firstTap=!1,UIMgr.ins().open(InvestmentView)},e}(PortalBase);__reflect(InvestmentPortalIcon.prototype,"InvestmentPortalIcon");var InviteFriendsBtnPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[479],n}return __extends(e,t),e.prototype.checkShowIcon=function(){var t=!0;return platformAmuseControl.wxInviteCount>=3&&(t=!1),t&&e.isShowIcon},e.prototype.tapExecute=function(){UIMgr.ins().open(InviteFriendsView)},e.isShowIcon=!1,e}(PortalBase);__reflect(InviteFriendsBtnPortalIcon.prototype,"InviteFriendsBtnPortalIcon");var InviteFriendsPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[479,691,461],n.updateMessage=[479],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(22)&&-1!=platformAmuseControl.shareState&&platformAmuseControl.wxInviteCount<3},e.prototype.checkShowRedPoint=function(){var t=DateUtils.formatMiniDateTime(platformAmuseControl.inviteTime)-GameServer.serverTime;TimerMgr.ins().removeAll(this);var e=0>=t?1:0;return e||TimerMgr.ins().doTimer(t,1,this.updateTime,this),e},e.prototype.updateTime=function(){this.update()},e.prototype.tapExecute=function(){UIMgr.ins().open(InviteFriendsView)},e}(PortalBase);__reflect(InviteFriendsPortalIcon.prototype,"InviteFriendsPortalIcon");var LadderBattlePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._time=0,n.showMessage=[461,277],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this._timeTxt=new eui.Label,this._timeTxt.x=0,this._timeTxt.y=70,this._timeTxt.width=70,this._timeTxt.textAlign="center",this._timeTxt.text="",this._timeTxt.size=14,this._timeTxt.textColor=LangMgr.getColor("color43"),e.addChild(this._timeTxt),e},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:(TimerMgr.ins().remove(this.setRepeat,this),SwitchMgr.ins().checkOpen(37)&&(campWarControl.isOpen||campWarControl.getOpenLeftTime()>0)?(this.updateTime(),!0):!1)},e.prototype.onAddToStage=function(){this.updateTime()},e.prototype.onRemoveFromStage=function(){TimerMgr.ins().remove(this.setRepeat,this)},e.prototype.setRepeat=function(){var t=campWarControl.getOpenLeftTime();t>0?this._timeTxt&&(this._timeTxt.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,4)):(this._timeTxt&&(this._timeTxt.text=LangMgr.getValueByKey("BattleComing")),TimerMgr.ins().remove(this.setRepeat,this))},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(LadderView,3),this.update()},e.prototype.updateTime=function(){this._timeTxt&&(TimerMgr.ins().remove(this.setRepeat,this),campWarControl.isOpen?this._timeTxt.text=LangMgr.getValueByKey("BattleComing"):(this.setRepeat(),TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this)))},e}(PortalBase);__reflect(LadderBattlePortalIcon.prototype,"LadderBattlePortalIcon");var LadderBtnPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[353,461,376,91],n.updateMessage=[60,130,618,550,681],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:copyControl.guanqiaID>=DataCenter.ins().SkirmishBaseConfig.openLevel&&!confrontControl.isGuiding&&!copyControl.pkGqboss},e.prototype.checkShowRedPoint=function(){var t=confrontControl.isHasRed();return t?t:ladderControl.checkRedShow()?1:MineRedPoint.ins().redPoint?1:CrazybtplayCopyRedPoint.ins().redPoint?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(LadderView,0)},e}(PortalBase);__reflect(LadderBtnPortalIcon.prototype,"LadderBtnPortalIcon");var LadderPDPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._time=0,n.showMessage=[461,240],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);if(this._timeTxt=new eui.Label,this._timeTxt.x=0,this._timeTxt.y=70,this._timeTxt.width=70,this._timeTxt.textAlign="center",this._timeTxt.text="",this._timeTxt.size=14,this._timeTxt.textColor=LangMgr.getColor("color43"),e.addChild(this._timeTxt),blisterControl.isOpen)this._timeTxt.text=LangMgr.getValueByKey("BattleComing");else{var i=blisterControl.getOpenLeftTime();i>0&&(this._time=i,this._timeTxt.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4),TimerMgr.ins().isExists(this.setRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this))}return e},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(TimerMgr.ins().removeAll(this),!SwitchMgr.ins().checkOpen(38))return!1;if(blisterControl.isOpen)return!0;var t=blisterControl.getOpenLeftTime();return t>0?(this._time=t,TimerMgr.ins().isExists(this.setRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this),!0):!1},e.prototype.setRepeat=function(){this._time--,this._time>0?this._timeTxt&&(this._timeTxt.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,4)):(this._timeTxt&&(this._timeTxt.text=LangMgr.getValueByKey("BattleComing")),TimerMgr.ins().removeAll(this))},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(LadderView,3),this.update()},e}(PortalBase);__reflect(LadderPDPortalIcon.prototype,"LadderPDPortalIcon");var LeasePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[173,106,107,457,682,4,112,461],n.updateMessage=[173,106,107,457,682,4,112,461],n}return __extends(e,t),e.prototype.runTime=function(){if(!this.conditionText)return void TimerMgr.ins().remove(this.runTime,this);var t=leaseControl.getBuyEndTime();t>0?(t=Math.floor(t/DateUtils.MS_PER_SECOND),this.conditionText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.conditionText.text="",TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){return leaseControl.checkOpen()},e.prototype.checkShowRedPoint=function(){return leaseControl.getRedPoint()?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(LeaseView)},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e}(BasePortalIcon);__reflect(LeasePortalIcon.prototype,"LeasePortalIcon");var LevelGiftPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.activityId=0,n.showMessage=[461,112,395,392],n.updateMessage=[392,461,112],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=amusementControl.getAmusementDataById(this.activityId);return SwitchMgr.ins().checkOpen(1008)&&t&&t.isOpenActivity()&&!t.getHide()},e.prototype.checkShowRedPoint=function(){return amusementControl.checkAcCanGet(this.activityId.toString())?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(AmusementOpenServerView,this.activityId)},e}(PortalBase);__reflect(LevelGiftPortalIcon.prototype,"LevelGiftPortalIcon");var LimitTaskPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,112],n.updateMessage=[93],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,0==taskControl.limitTaskState?this.alertText.text=LangMgr.getValueByKey("playTips5"):(this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this)),e},e.prototype.runTime=function(){var t=taskControl.limitTaskEndTime-Math.floor(GameServer.serverTime/1e3);t>=0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(20))return!1;var t=DataCenter.ins().GuideLimitTimeConfig[taskControl.currTaskListsId];if(!t)return!1;if(taskControl.limitTaskEndTime>0)if(taskControl.limitTaskEndTime-Math.floor(GameServer.serverTime/1e3)<0){if(!DataCenter.ins().GuideLimitTimeConfig[taskControl.currTaskListsId+1])return UIMgr.ins().close(LimitTaskView),!1}else if(!DataCenter.ins().GuideLimitTimeConfig[taskControl.currTaskListsId+1]&&8==taskControl.limitTaskCount)return this.updateShow(),TimerMgr.ins().doTimer(1500,1,function(){UIMgr.ins().close(LimitTaskView)},this),!1;return-1!=taskControl.limitTaskState&&taskControl.limitTaskEndTime>0?!0:!0},e.prototype.checkShowRedPoint=function(){return taskControl.getLimitTaskRed()},e.prototype.tapExecute=function(){UIMgr.ins().open(LimitTaskView)},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e}(PortalBase);__reflect(LimitTaskPortalIcon.prototype,"LimitTaskPortalIcon");var LvTimeLimitGiftTipsPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.curDtList=[],n.firstTap=!0,n.conditionActivity={},n.showMessage=[461,374,376,437],n.updateMessage=[457,178,180,446,437],n.oldZsLv=reincarnateControl.lv,n.oldLv=ActorControl.level,n.chapter=copyControl.guanqiaID,n.clgLv=copyBabelControl.curLevel,n.initActivity(),n}return __extends(e,t),e.prototype.initActivity=function(){this.curDtList=[];var t=pAmusementControl.activityData;for(var e in t){var i=t[e];if(4==i.pageType&&i.isOpenActivity()&&!i.getHide()){var n=DataCenter.ins().PAmusement2Config[i.id];n&&n[1]&&12==n[1].showType&&this.curDtList.push(i)}}for(var o=this.curDtList.length-1;o>=0;o--){var s=this.curDtList[o],r=DataCenter.ins().PAmusementConfig[s.id],a=r.zslv?r.zslv:0,l=r.lv?r.lv:0,h=r.chapter?r.chapter:1,u=r.clgLv?r.clgLv:1;(!isNaN(r.zslv)&&reincarnateControl.lv<a||!isNaN(r.lv)&&ActorControl.level<l||!isNaN(r.chapter)&&copyControl.guanqiaID<h||!isNaN(r.clgLv)&&copyBabelControl.curLevel<u||reincarnateControl.lv>=a&&ActorControl.level>=l&&copyControl.guanqiaID>=h&&copyBabelControl.curLevel>=u)&&(this.conditionActivity[s.id]=!0)}},e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.runTime(),TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().doTimer(1e3,0,this.runTime,this),e},e.prototype.runTime=function(){if(this.curDtList.length){var t=this.curDtList[this.curDtList.length-1].getLeftTime();t>0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this),this.updateShow())}},e.prototype.checkShowIcon=function(){var t=!1;this.curDtList=[];var e=pAmusementControl.activityData;for(var i in e){var n=e[i];if(4==n.pageType&&n.isOpenActivity()&&!n.getHide()){var o=DataCenter.ins().PAmusement2Config[n.id];o&&o[1]&&12==o[1].showType&&this.curDtList.push(n),t=!0}}for(var s=this.curDtList.length-1;s>=0;s--){var r=this.curDtList[s],a=DataCenter.ins().PAmusementConfig[r.id],l=a.zslv?a.zslv:0,h=a.lv?a.lv:0,u=a.chapter?a.chapter:1,p=a.clgLv?a.clgLv:1;if((isNaN(a.zslv)||!(reincarnateControl.lv<l))&&(isNaN(a.lv)||!(ActorControl.level<h))&&(isNaN(a.chapter)||!(copyControl.guanqiaID<u))&&(isNaN(a.clgLv)||!(copyBabelControl.curLevel<p))&&!this.conditionActivity[r.id]){this.conditionActivity[r.id]=!0,UIMgr.ins().open(LvTimeLimitGiftTipsView,r.id);break}}return t},e.prototype.checkShowRedPoint=function(){var t=pAmusementControl.activityData;for(var e in t){var i=t[e];if(4==i.pageType&&(i.isOpenActivity()&&i.canReward()||i.loginRedPoint()))return 1}return 0},e.prototype.getEffName=function(t){return(this.firstTap||t)&&(this.effX=38,this.effY=38),"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(LvTimeLimitGiftView),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(LvTimeLimitGiftTipsPortalIcon.prototype,"LvTimeLimitGiftTipsPortalIcon");var MergeServerAmusementPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[392,461,374,376],n.updateMessage=[392,457,178,180,446,266,267],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(34))return!1;var t=amusementControl.activityData,e=Object.keys(t);if(!e.length)return!1;for(var i in t){var n=t[i];if(!n.pageType&&2==n.timeType&&n.isOpenActivity())return!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(!i.pageType&&2==i.timeType&&i.isOpenActivity()&&i.canReward()&&i.specialState())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(MergeServerAmusementView),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(MergeServerAmusementPortalIcon.prototype,"MergeServerAmusementPortalIcon");var MerryshopPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,448],n.updateMessage=[448],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(1004))return!1;for(var t=CommonUtils.getObjectLength(DataCenter.ins().RechargeHappyConfig),e=1;t>=e;e++)if(!payControl.getRemindByIndex(e))return!0;return!1},e.prototype.checkShowRedPoint=function(){for(var t=CommonUtils.getObjectLength(DataCenter.ins().RechargeHappyConfig),e=1;t>=e;e++)if(!payControl.getRemindByIndex(e)&&payControl.happyShopRechargeToltal>=DataCenter.ins().RechargeHappyConfig[e].val)return 1;return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){this.update(),UIMgr.ins().open(MerryshopView)},e}(PortalBase);__reflect(MerryshopPortalIcon.prototype,"MerryshopPortalIcon");var MiniAccountJumpPortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SDKManager.ins().isShowMiniAccountJumpPortalIcon()},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return null},e.prototype.tapExecute=function(){SDKManager.ins().miniAccountJumpPortalIconTap()},e}(PortalBase);__reflect(MiniAccountJumpPortalIcon.prototype,"MiniAccountJumpPortalIcon");var MonthCardPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=!0;return payControl.monthDay>0&&payControl.franchise>0&&(t=!1),SwitchMgr.ins().checkOpen(6)&&t},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){var t=2;payControl.monthDay>0&&(t=3),UIMgr.ins().open(WelfareView,t),this.update()},e}(PortalBase);__reflect(MonthCardPortalIcon.prototype,"MonthCardPortalIcon");var NationalDayAmusementPortalIcon=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=new Date(GameServer.serverTime),e=t.getFullYear(),i=t.getMonth()+1,n=t.getDate();return 2017==e&&(9==i&&30==n||10==i&&9>n)},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(NationalDayAmusementView)},e}(PortalBase);__reflect(NationalDayAmusementPortalIcon.prototype,"NationalDayAmusementPortalIcon");var NewWorldBossPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=n.updateMessage=[310],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,bossControl.newWorldBossData.startTime?(this.runTime(),TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().doTimer(1e3,0,this.runTime,this)):this.alertText.text=LangMgr.getValueByKey("playTips6"),e},e.prototype.runTime=function(){var t=Math.floor((bossControl.newWorldBossData.startTime-GameServer.serverTime)/1e3);t>=0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):1e3*DataCenter.ins().NewWorldBossBaseConfig.bossTime+bossControl.newWorldBossData.startTime>GameServer.serverTime?this.alertText&&(this.alertText.text=""):(this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!GameServer.serverOpenDay)return!1;var t=bossControl.newWorldBossData.isOpen;return t&&bossControl.newWorldBossData.startTime&&(TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().doTimer(1e3,0,this.runTime,this)),t},e.prototype.checkShowRedPoint=function(){return GameServer.serverTime>bossControl.newWorldBossData.startTime&&1e3*DataCenter.ins().NewWorldBossBaseConfig.bossTime+bossControl.newWorldBossData.startTime>GameServer.serverTime?1:0},e.prototype.getEffName=function(){return this.checkShowRedPoint()?(this.effX=38,this.effY=38,"actIconCircle"):""},e.prototype.tapExecute=function(){UIMgr.ins().open(NewWorldBossView)},e}(PortalBase);__reflect(NewWorldBossPortalIcon.prototype,"NewWorldBossPortalIcon");var OnlineQuizPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[692,693,461],n.updateMessage=[],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,this.alertText.y=70,e.addChild(this.alertText),this.playAni(),e},e.prototype.onAddToStage=function(){if(!TimerMgr.ins().isExists(this.runTime,this)){var t=onlineQuizControl.getlefttime();TimerMgr.ins().doTimer(1e3,t,this.runTime,this),this.runTime()}},e.prototype.onRemoveFromStage=function(){TimerMgr.ins().isExists(this.runTime,this)&&TimerMgr.ins().remove(this.runTime,this)},e.prototype.checkShowIcon=function(){return onlineQuizControl.checkOpen()},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(OnlineQuizView)},e.prototype.playAni=function(){TweenUtil.JumpAniByBottom(this.tar,900,1e3)},e.prototype.runTime=function(){var t=onlineQuizControl.getlefttime();t>0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.alertText&&(this.alertText.text=""),TimerMgr.ins().remove(this.runTime,this),this.updateShow())
},e}(BasePortalIcon);__reflect(OnlineQuizPortalIcon.prototype,"OnlineQuizPortalIcon");var PartnerBgPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!1,n.showMessage=[461],n.updateMessage=[212],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:ActorControl.level>=70},e.prototype.checkShowRedPoint=function(){var t=0;if(Object.keys(partnerControl.newMsg).length>0)for(var e in partnerControl.newMsg){var i=partnerControl.newMsg[e];if(1==i){t++;break}}return partnerControl.appList.length>0&&t++,t},e.prototype.getEffName=function(t){},e.prototype.tapExecute=function(){ActorControl.level<DataCenter.ins().PartnerLimitConfig.sysLv?tipsControl.showTips(LangMgr.getValueByKey("BattleTips2",DataCenter.ins().PartnerLimitConfig.sysLv)):UIMgr.ins().open(PartnerBgView)},e}(PortalBase);__reflect(PartnerBgPortalIcon.prototype,"PartnerBgPortalIcon");var PayDailyGetExtraPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,177,395,376],n.updateMessage=[177],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this._timeTxt=new eui.Label,this._timeTxt.x=0,this._timeTxt.y=70,this._timeTxt.width=70,this._timeTxt.textAlign="center",this._timeTxt.text="",this._timeTxt.size=14,this._timeTxt.textColor=65280,e.addChild(this._timeTxt),this.updateIcon(),e},e.prototype.checkShowIcon=function(){var t=payControl.showZhShDanRe(),e=t[0];return this._actID=e?t[1]:0,this._icon="",this._actID&&(this.updateTime(),this._icon=t[2],this.updateIcon()),e},e.prototype.checkShowRedPoint=function(){return payControl.checkZhShDanReRed()?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(PayDailyGetExtraView)},e.prototype.onAddToStage=function(){this.updateTime()},e.prototype.onRemoveFromStage=function(){TimerMgr.ins().remove(this.setRepeat,this)},e.prototype.setRepeat=function(){if(this._timeTxt){var t=amusementControl.activityData[this._actID];t&&t.isOpenActivity()?this._timeTxt.text=""+DateUtils.getFormatBySecond(Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3),DateUtils.TIME_FORMAT_1):(TimerMgr.ins().remove(this.setRepeat,this),this._timeTxt.text=LangMgr.getValueByKey("doubleEndActivity"))}},e.prototype.updateTime=function(){if(this._timeTxt){var t=amusementControl.activityData[this._actID];t&&t.isOpenActivity()&&!t.getHide()?(TimerMgr.ins().isExists(this.setRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this),this.setRepeat()):(TimerMgr.ins().remove(this.setRepeat,this),this._timeTxt.text=LangMgr.getValueByKey("doubleEndActivity"))}},e.prototype.updateIcon=function(){this.tar&&this.tar.icon&&(this.tar.icon=this._icon)},e.prototype.getEffName=function(t){return payControl.hasGetedDan()?null:(this.effX=38,this.effY=38,"actIconCircle")},e}(PortalBase);__reflect(PayDailyGetExtraPortalIcon.prototype,"PayDailyGetExtraPortalIcon");var PayFirstPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376,178,446],n.updateMessage=[178,446,180,4],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this),i=payControl.getRechargeData(0);return this.dayLen=CommonUtils.getObjectLength(DataCenter.ins().RechargeFirstClientConfig[1]),i.num<=this.dayLen?this.tar.icon="zjmshouchong":this.tar.icon="zjmcjfl_png",i.num<2&&(this.destText=new eui.Label,this.destText.size=13,this.destText.width=120,this.destText.textAlign="center",this.destText.textColor=LangMgr.getColor("firstRechargeColorDest"),this.destText.horizontalCenter=0,e.addChild(this.destText),this.destText.y=80,this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=110,this.time=this.getLeftTime(),this.time>0&&(this.destText.text=LangMgr.getValueByKey("firstRechargeContent")),this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this)),this.tar},e.prototype.getLeftTime=function(){return GlobalModel.createActorTime+DateUtils.SECOND_PER_HOUR/2-Math.floor(GameServer.serverTime/DateUtils.MS_PER_SECOND)},e.prototype.runTime=function(){var t=this.time;this.time-=1,t>0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_10)):(this.destText&&(this.destText.text=""),this.alertText&&(this.alertText.text=""),TimerMgr.ins().remove(this.runTime,this))},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(1))return!1;var t=payControl.getRechargeData(0);if(this.tar)if(t.num<=this.dayLen)this.tar.icon="zjmshouchong";else{var e=amusementControl.activityData;if(!e[10018])return!1;this.tar.icon="zjmcjfl_png"}return t.num>=2&&(this.destText&&(this.destText.visible=!1),this.alertText&&(this.alertText.visible=!1),TimerMgr.ins().remove(this.runTime,this)),!0},e.prototype.checkShowRedPoint=function(){var t=payControl.getRechargeData(0);if(t.num<=this.dayLen){var e=payControl.getFirstRechargeCdTime(t.num-2);return e>0?0:t.num}if(!payControl.rechargeTotal||null==payControl.rechargeTotal.hasGetDays||null==payControl.rechargeTotal.hasGetDays1)return 0;var i=payControl.getRechargeList(2),n=[];for(var o in i){var s=i[o];n.push(s)}var r=payControl.rechargeTotal.hasGetDays1,a=n.splice(0,4);for(var l in a){var h=a[l];return r[0].length>=h.id?0:h.id<=payControl.rechargeTotal.rechDay[0]?1:0}return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){var t=payControl.getRechargeData(0);t.num<=this.dayLen?UIMgr.ins().open(PayFirstView):GameServer.serverOpenDay<7?UIMgr.ins().open(AmusementOpenServerView,10018):UIMgr.ins().open(AmusementTotalEnterView,10018)},e}(PortalBase);__reflect(PayFirstPortalIcon.prototype,"PayFirstPortalIcon");var PayLimitPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[184,185,461],n}return __extends(e,t),e.prototype.createTar=function(){return t.prototype.createTar.call(this),this.tar.icon="limitChargeIcon"+payControl.limitChargeMultiple+"_png",this.tar},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(1007)?(this.tar&&(this.tar.icon="limitChargeIcon"+payControl.limitChargeMultiple+"_png"),payControl.limitChargeIsOpen()):!1},e.prototype.checkShowRedPoint=function(){return 1},e.prototype.tapExecute=function(){return payControl.limitData.endTime>=GameServer.serverTime?void tipsControl.showTips(LangMgr.getValueByKey("playTips4")):void UIMgr.ins().open(PayLimitView)},e}(PortalBase);__reflect(PayLimitPortalIcon.prototype,"PayLimitPortalIcon");var PayOnePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.onebuyTimes=0,n.showMessage=[461,183],n.onebuyTimes=0,n}return __extends(e,t),e.prototype.createTar=function(){return t.prototype.createTar.call(this),payControl.hasOneBuy()&&(this.tar.icon="yiyg"+payControl.oneBuyStateIndex+"_png"),this.tar},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(1002)&&payControl.hasOneBuy()?(this.tar&&payControl.hasOneBuy()&&(this.tar.icon="yiyg"+payControl.oneBuyStateIndex+"_png"),GlobalModel.openTab&&payControl.hasOneBuy()&&0==payControl.oneBuyStateIndex&&0==this.onebuyTimes&&(this.tapExecute(),this.onebuyTimes++),payControl.hasOneBuy()):!1},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){this.update(),UIMgr.ins().open(PayOneView)},e}(PortalBase);__reflect(PayOnePortalIcon.prototype,"PayOnePortalIcon");var PaySalePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376,178,446,186],n.updateMessage=[186],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(68)?payControl.openFlashSaleId>0||payControl.openFlashSaleRed>0:!1},e.prototype.checkShowRedPoint=function(){return payControl.openFlashSaleRed?1:0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(PaySaleView)},e}(PortalBase);__reflect(PaySalePortalIcon.prototype,"PaySalePortalIcon");var PeakedMainPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376,162,4,112,348,337,558,112],n.updateMessage=[558,162,337,348],n}return __extends(e,t),e.prototype.update=function(){t.prototype.update.call(this),this.tar.txt&&(peakedControl.isCross()?peakedControl.kfStatusIsEnd&&peakedControl.kfStatus<7?this.tar.txt.text=PeakedVo.STATE_KF_ICON_CN[peakedControl.kfStatus+1]:this.tar.txt.text=PeakedVo.STATE_KF_ICON_CN[peakedControl.kfStatus]:peakedControl.bfStatusIsEnd&&peakedControl.bfStatus<6?this.tar.txt.text=PeakedVo.STATE_ICON_CN[peakedControl.bfStatus+1]:this.tar.txt.text=PeakedVo.STATE_ICON_CN[peakedControl.bfStatus])},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:peakedControl.isOpen()},e.prototype.checkShowRedPoint=function(){return PeakedRedpoint.ins().redpoint},e.prototype.tapExecute=function(){UIMgr.ins().open(PeakedMainView)},e}(PortalBase);__reflect(PeakedMainPortalIcon.prototype,"PeakedMainPortalIcon");var PeriodBossPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;if(SwitchMgr.ins().checkOpen(45)){if(n.activityData=amusementControl.checkLabaBossData(),!n.activityData)return n;n.actId=n.activityData.id}return n.showMessage=[392],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.activityData.isOpenActivity()&&!this.activityData.IsEnd()&&(TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().doTimer(1e3,0,this.runTime,this),TimerMgr.ins().isExists(this.updateActivity,this)||TimerMgr.ins().doTimer(3e4,0,this.updateActivity,this)),e},e.prototype.updateActivity=function(){this.activityData&&amusementControl.upChangePage(this.activityData.id)},e.prototype.runTime=function(){if(this.actId){if(this.activityData=amusementControl.getAmusementDataById(this.actId),!this.activityData)return TimerMgr.ins().remove(this.runTime,this),void TimerMgr.ins().remove(this.updateActivity,this);if(this.activityData.IsEnd())return this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips3")),TimerMgr.ins().remove(this.runTime,this),void TimerMgr.ins().remove(this.updateActivity,this);var t=Math.floor(GameServer.serverTime/DateUtils.MS_PER_SECOND),e=this.activityData.getEndTimer();if(t>=e)return void(this.alertText&&(this.alertText.text=LangMgr.getValueByKey("osaEnd")));var i=this.activityData.getStartTimer();if(this.activityData.isGoIn)this.alertText&&(this.alertText.text=LangMgr.getValueByKey("bossUpdate"));else{var n=i-t;this.alertText&&(n>0?this.alertText.text=DateUtils.getFormatBySecond(n,DateUtils.TIME_FORMAT_12):this.alertText.text=LangMgr.getValueByKey("activitUpdata"))}}},e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(45)&&this.activityData?this.activityData.IsEnd()?!1:this.activityData.go2BossFb()?!0:!1:!1},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){return this.activityData?this.activityData.IsEnd()?void tipsControl.showTips(LangMgr.getValueByKey("osaAcea")):void(this.activityData.go2BossFb()?amusementControl.upReward(this.activityData.id,this.activityData.index):tipsControl.showTips(LangMgr.getValueByKey("osaNoTime"))):void 0},e}(PortalBase);__reflect(PeriodBossPortalIcon.prototype,"PeriodBossPortalIcon");var AmuseTarget0Panel6=function(t){function e(){var e=t.call(this)||this;return e.openTime=[0,1,3,5],e._aryTime=[],e.skinName="AmuseTarget0Panel6Skin",e.bossEffect=new GameMovieClip,e.bossEffect.scaleX=-1,e.bossEffect.scaleY=1,e.bossEffect.x=128,e.bossEffect.y=160,e.Boss.addChild(e.bossEffect),e.bossImage=new GameMovieClip,e.bossImage.scaleX=-1,e.bossImage.scaleY=1,e.bossImage.x=128,e.bossImage.y=160,e.Boss.addChild(e.bossImage),e.bossImg.visible=!1,e}return __extends(e,t),e.prototype.close=function(){this.removeEventTouchTap(this.goBtn,this.onTap)},e.prototype.open=function(){this.addEventTouchTap(this.goBtn,this.onTap),this.rewardList.itemRenderer=ItemBase,this.initView()},e.prototype.initView=function(){this._aryTime=[],this.actInfo.text=DataCenter.ins().AmusementBtnConfig[this.activityID].acDesc;var t,i,n=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime),o="",s=0;for(i=0;i<this.openTime.length;i++)o.length>0&&(o+="、"),s=n+this.openTime[i]*DateUtils.MS_PER_DAY,t=new Date(s),o+=t.getMonth()+1+LangMgr.getValueByKey("activitMonth")+t.getDate()+LangMgr.getValueByKey("activitDayTime",""),this._aryTime.push(t.getMonth()+1+LangMgr.getValueByKey("activitMonth")+t.getDate()+LangMgr.getValueByKey("activitDayTime",""));o+=LangMgr.getValueByKey("activtOpenDe",e.timer),this.actTime.text=o;var r,a,l,h,u=!1,p=-1;for(i=this.openTime.length-1;i>=0;i--){if(s=n+this.openTime[i]*DateUtils.MS_PER_DAY,t=new Date(s),t.setHours(20,30,0),r=n+(this.openTime[i]+1)*DateUtils.MS_PER_DAY,a=new Date(r),0==i&&(l=t.getTime()),i==this.openTime.length-1&&(h=a.getTime()),!i){GameServer.serverTime>=t.getTime()&&(u=!0),p=i;break}var c=i-1;if(c>=0){var d=this.getBossConfig(i),g=d.killBossId;s=n+this.openTime[i]*DateUtils.MS_PER_DAY;var m=new Date(s);if(m.setHours(0,0,0),1!=toseongControl.bossKillNumData[g][1]&&GameServer.serverTime<m.getTime())continue;GameServer.serverTime>=t.getTime()&&(u=!0),p=i;break}}if(u)this.selectCurBoss(DataCenter.ins().ToseongBossConfig[p+1].bossId,p);else if(GameServer.serverTime<l)p=-1,this.selectCurBoss(DataCenter.ins().ToseongBossConfig[1].bossId,p);else if(GameServer.serverTime>=h)p=-2,this.selectCurBoss(DataCenter.ins().ToseongBossConfig[4].bossId,p);else{var f=this.getBossConfig(p+1).bossId;this.selectCurBoss(f,p,!0)}var v;v=-1==p?1:-2==p?4:p+1;var y=DataCenter.ins().ToseongBossConfig[v];y&&(this.rewardList.dataProvider=new eui.ArrayCollection(y.showReward))},e.prototype.selectCurBoss=function(t,i,n){void 0===n&&(n=!1);var o=DataCenter.ins().MonstersConfig[t];if(i>=0){var s=DataCenter.ins().ToseongBossConfig[i+1].bossId;o=DataCenter.ins().MonstersConfig[s]}var r=DataCenter.ins().EffectConfig[o.effect].fileName;this.bossImage.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(o.avatar+"_3s"),-1),this.bossEffect.playFile(PATH_EFF+r,-1);var a,l=amusementControl.getAmusementDataById(this.activityID);if(this.redPoint.visible=l.specialState(),i>=0)if(n)a=this._aryTime[i],this.time.text=a+(" "+e.timer),this._btnB=!1;else{a=this._aryTime[i],this.time.text=a+(" "+e.timer);var h=this.getBossConfig(i+1),u=h.killBossId;if(toseongControl.bossKillNumData&&void 0!=toseongControl.bossKillNumData[u]&&1!=toseongControl.bossKillNumData[u][1])this._btnB=!0;else if(this._btnB=!1,a=this._aryTime[i+1]){this.time.text=a+(" "+e.timer);var s=DataCenter.ins().ToseongBossConfig[i+1].bossId;o=DataCenter.ins().MonstersConfig[s];var p=DataCenter.ins().EffectConfig[o.effect].fileName;this.bossImage.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(o.avatar+"_3s"),-1),this.bossEffect.playFile(PATH_EFF+p,-1)}}else this._btnB=!1,-2==i?this.time.text=LangMgr.getValueByKey("osaEnd"):-1==i&&(a=this._aryTime[0]+LangMgr.getValueByKey("activtOpenDe",e.timer),this.time.text=a)},e.getCityBossConfig=function(t){var e;for(var i in DataCenter.ins().ToseongBossConfig)if(DataCenter.ins().ToseongBossConfig[i].bossId==t&&DataCenter.ins().ToseongBossConfig[i].killBossId<=999){e=DataCenter.ins().ToseongBossConfig[i];break}return e},e.prototype.getNextBossId=function(){for(var t,e,i=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime),n=0,o=0;o<this.openTime.length;o++)t=i+this.openTime[o]*DateUtils.MS_PER_DAY,e=new Date(t),GameServer.serverTime>=e.getTime()&&(n=o);return n},e.prototype.getBossConfig=function(t){return DataCenter.ins().ToseongBossConfig[t]},e.prototype.onTap=function(t){switch(t.currentTarget){case this.goBtn:if(!this._btnB)return void tipsControl.showTips(LangMgr.getValueByKey("activitBossOpen"));if(toseongControl.enterCD>0)return void tipsControl.showTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD));toseongControl.isToseong?TimerMgr.ins().doNext(function(){var t=UIMgr.ins().getView(BossBelongView);t&&t.attrBoss()},this):(toseongControl.isChallenge=!0,toseongControl.upEnter()),UIMgr.ins().close(MergeServerAmusementView)}},e.timer="20:30",e}(BasePanel);__reflect(AmuseTarget0Panel6.prototype,"AmuseTarget0Panel6");var RamblePortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(RambleView)},e}(PortalBase);__reflect(RamblePortalIcon.prototype,"RamblePortalIcon");var RankingPortalIcon=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(3)},e.prototype.checkShowRedPoint=function(){return SwitchMgr.ins().checkOpen(3)?0:rankControl.canPraiseInAll()?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(RankingView)},e}(PortalBase);__reflect(RankingPortalIcon.prototype,"RankingPortalIcon");var RecruitPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.updateMessage=[461,352],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return heroControl.subRolesLen<3},e.prototype.checkShowRedPoint=function(){var t=heroControl.subRolesLen,e=DataCenter.ins().RoleNewConfig[t];if(!e)return 0;var i=e.zsLevel?reincarnateControl.lv:ActorControl.level,n=e.zsLevel?e.zsLevel:e.level;return i>=n||vipControl.lv>=e.vip?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(RecruitView)},e}(PortalBase);__reflect(RecruitPortalIcon.prototype,"RecruitPortalIcon");var RedBagPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.updateMessage=[673],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return!1},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){},e.prototype.tapExecute=function(){UIMgr.ins().open(RedBagView)},e}(PortalBase);__reflect(RedBagPortalIcon.prototype,"RedBagPortalIcon");var RedbagRainPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[392],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(!SwitchMgr.ins().checkOpen(91))return!1;var t=amusementControl.activityData,e=Object.keys(t);if(!e||!e.length)return!1;for(var i in t){var n=t[i];if(30==n.pageType&&n.isOpenActivity()&&!n.getHide())return!0}return!1},e.prototype.getEffName=function(){return this.firstTap?(this.effX=38,this.effY=38,"actIconCircle"):null},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(30==i.pageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}return 0},e.prototype.tapExecute=function(){this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(RedbagRainPortalIcon.prototype,"RedbagRainPortalIcon");var RewardWingPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,396],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.time=this.getLeftTime(),this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this),this.tar},e.prototype.getLeftTime=function(){return DateUtils.calcNextNDay(GlobalModel.createActorTime*DateUtils.MS_PER_SECOND,(DataCenter.ins().ClientGlobalConfig.rewardWingDay||2)-2,GameServer.serverTime)},e.prototype.runTime=function(){var t=this.time;this.time-=1,t>0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.alertText&&(this.alertText.text=""),TimerMgr.ins().remove(this.runTime,this))},e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(5)?0==(amusementControl.isAwards>>(DataCenter.ins().ClientGlobalConfig.rewardWingDay||2)&1):!1},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){var t=DataCenter.ins().PortalConfig[9];(!t||t&&amusementControl.getSevenDayLogIsVisible())&&UIMgr.ins().open(WelfareView,1)},e}(PortalBase);__reflect(RewardWingPortalIcon.prototype,"RewardWingPortalIcon");var RunePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[112],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return reincarnateControl.lv>=DataCenter.ins().RuneOtherConfig.zsLevel},e.prototype.getEffName=function(){},e.prototype.tapExecute=function(){var t=reincarnateControl.lv>=DataCenter.ins().RuneOtherConfig.zsLevel;return t?void UIMgr.ins().open(RuneView):void tipsControl.showTips(LangMgr.getValueByKey("playTips7",DataCenter.ins().RuneOtherConfig.zsLevel))},e}(PortalBase);__reflect(RunePortalIcon.prototype,"RunePortalIcon");var SealPvePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[437,112,461,467],n.updateMessage=[467],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this._timeTxt=new eui.Label,this._timeTxt.x=0,this._timeTxt.y=70,this._timeTxt.width=70,this._timeTxt.textAlign="center",this._timeTxt.text="",this._timeTxt.size=14,this._timeTxt.textColor=3532333,e.addChild(this._timeTxt),e},e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(95)?-1==SealPveControl.ins().getPveDoneIndex()?!1:(this.actId=SealPveControl.ins().getPveActivityId(),this.updateIcon(),this.updateTime(),!!this.actId):!1},e.prototype.isShowRedPoint=function(){var t=ServerStorage.ins().getValue(51);if(!t)return SealPveControl.ins().isHaveNextGuan();if(GameServer.serverTime/1e3-t>=DateUtils.MS_PER_DAY/1e3)return SealPveControl.ins().isHaveNextGuan();var e=new Date(GameServer.serverTime).getDate(),i=new Date(1e3*t).getDate();return i!=e&&SealPveControl.ins().isHaveNextGuan()},e.prototype.checkShowRedPoint=function(){return this.isShowRedPoint()?1:0},e.prototype.updateIcon=function(){if(this.actId){var t=DataCenter.ins().AmusementConfig[this.actId];t.newZjmIcon&&this.tar&&this.tar.img&&(this.tar.img.source=t.newZjmIcon)}},e.prototype.onAddToStage=function(){this.updateTime()},e.prototype.updateTime=function(){this._timeTxt&&(this.actData=amusementControl.activityData[this.actId],this.actData&&this.actData.isOpenActivity()&&!this.actData.getHide()?(TimerMgr.ins().isExists(this.setRepeat,this)||TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this),this.setRepeat()):(TimerMgr.ins().remove(this.setRepeat,this),this._timeTxt.text=LangMgr.getValueByKey("doubleEndActivity")))},e.prototype.setRepeat=function(){this._timeTxt&&(this.actData&&this.actData.isOpenActivity()?this._timeTxt.text=""+DateUtils.getFormatBySecond(Math.floor((DateUtils.formatMiniDateTime(this.actData.endTime)-GameServer.serverTime)/1e3),DateUtils.TIME_FORMAT_1):(TimerMgr.ins().remove(this.setRepeat,this),this._timeTxt.text=LangMgr.getValueByKey("doubleEndActivity")))},e.prototype.tapExecute=function(){UIMgr.ins().open(SealPveView),ServerStorage.ins().setValue(51,GameServer.serverTime/1e3),this.update()},e}(PortalBase);__reflect(SealPvePortalIcon.prototype,"SealPvePortalIcon");var SeckillGiftAmusePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.actId=0,n.showMessage=n.updateMessage=[178,392],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,e},e.prototype.runTime=function(){var t=amusementControl.getAmusementDataById(this.actId);if(!t)return void this.stopRun();var e=Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3);e>=0?this.alertText.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_12):(this.stopRun(),this.updateShow())},e.prototype.onAddToStage=function(){t.prototype.onAddToStage.call(this),this.autoOpenWin(),this.startRun()},e.prototype.onRemoveFromStage=function(){t.prototype.onRemoveFromStage.call(this),this.stopRun()},e.prototype.startRun=function(){TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().loop(1e3,this.runTime,this),this.runTime()},e.prototype.stopRun=function(){this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this)},e.prototype.checkShowIcon=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(109==i.pageType&&i.isOpenActivity()&&!i.getHide()){if(this.actId=+e,i.shopList&&i.shopList.length){for(var n=!0,o=0,s=i.shopList;o<s.length;o++){var r=s[o];0!=r.id&&(!r.buyCount||r.buyCount&&r.canGet)&&(n=!1)}if(n)return!1}return this.updateIcon(i),this.checkFirstCharge()}}return!1},e.prototype.checkFirstCharge=function(){var t=DataCenter.ins().Amusement26Config[this.actId],e=!1;for(var i in t)if(t[i].rechargeLimit&&1==t[i].rechargeLimit){e=!0;break}return e||!payControl.isFisrtCharge()},e.prototype.autoOpenWin=function(){if(!MapControl.copyId&&!ClientStorage.ins().getValue("SeckillGiftAmuseKey")){ClientStorage.ins().setValue("SeckillGiftAmuseKey",1);var t=DataCenter.ins().Amusement26Config[this.actId],e=!1;for(var i in t)if(0==t[i].eject){e=!0;break}e&&this.tapExecute()}},e.prototype.updateIcon=function(t){this.tar||this.getTar();var e=DataCenter.ins().Amusement26Config[t.id];for(var i in e)if(e[i].Zjmicon)return void(this.tar.icon=e[i].Zjmicon)},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(109==i.pageType&&i.isOpenActivity()&&!i.getHide()&&i.canReward())return 1}return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(SeckillGiftAmuseView)},e}(PortalBase);__reflect(SeckillGiftAmusePortalIcon.prototype,"SeckillGiftAmusePortalIcon");var SevenDayPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[396,376,461,467],n.updateMessage=[396],n}return __extends(e,t),e.prototype.updateIcon=function(){var t,e=amusementControl.dayNum;for(var i in DataCenter.ins().SevenDayConfig)if(DataCenter.ins().SevenDayConfig[i].icon){if(!(e>=DataCenter.ins().SevenDayConfig[i].day)){t=DataCenter.ins().SevenDayConfig[i];break}if(t=DataCenter.ins().SevenDayConfig[i],!this.getRemindByIndex(DataCenter.ins().SevenDayConfig[i].day))break}t&&this.tar&&(this.tar.icon=t.icon)},e.prototype.getRemindByIndex=function(t){return 1==(amusementControl.isAwards>>t&1)},e.prototype.checkShowIcon=function(){return SwitchMgr.ins().checkOpen(5)&&amusementControl.getSevenDayLogIsVisible()?(this.updateIcon(),!0):!1},e.prototype.checkShowRedPoint=function(){return amusementControl.getSevenDayStast()?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(WelfareView,1),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(SevenDayPortalIcon.prototype,"SevenDayPortalIcon");var ShareGamePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461],n.updateMessage=[730,731,732,733],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(!SDKManager.ins().isShowSharePortalIcon())return!1;var t=DataCenter.ins().ShareConfig;return ActorControl.level<t.level?!1:!0},e.prototype.checkShowRedPoint=function(){return shareGameControl.checkRed()?1:0},e.prototype.getEffName=function(){},e.prototype.tapExecute=function(){UIMgr.ins().open(ShareGameView)},e}(PortalBase);__reflect(ShareGamePortalIcon.prototype,"ShareGamePortalIcon");var SpokesBossPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[694,102],n.updateMessage=[],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this._timeTxt=new eui.Label,this._timeTxt.x=0,this._timeTxt.y=70,this._timeTxt.width=70,this._timeTxt.textAlign="center",this._timeTxt.text="",this._timeTxt.size=14,this._timeTxt.textColor=65280,e.addChild(this._timeTxt),e},e.prototype.onAddToStage=function(){this.updateTime()},e.prototype.onRemoveFromStage=function(){TimerMgr.ins().removeAll(this)},e.prototype.updateTime=function(){this._timeTxt&&(TimerMgr.ins().remove(this.setRepeat,this),this.setRepeat(),TimerMgr.ins().doTimer(1e3,0,this.setRepeat,this))},e.prototype.setRepeat=function(){if(this._timeTxt){if(spokesPersonControl.isSpokesBoss(toseongControl.cityBossId))return void(this._timeTxt.text=LangMgr.getValueByKey("trialsing"));var t=(this.nextDate.getTime()-GameServer.serverTime)/1e3>>0;t>0?this._timeTxt.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,4):(this._timeTxt.text=LangMgr.getValueByKey("trialsing"),TimerMgr.ins().remove(this.setRepeat,this))}},e.prototype.checkShowIcon=function(){if(this.nextDate=spokesPersonControl.getNextBossDate(),!this.nextDate)return!1;var t=SwitchMgr.ins().checkOpen(92)&&spokesPersonControl.checkSysOpen();if(!t)return!1;var e=spokesPersonControl.BOSS_READY_TIME*DateUtils.MS_PER_MINUTE,i=this.nextDate.getTime()-GameServer.serverTime;return(i>e||0>i)&&(t=!1),t||spokesPersonControl.isSpokesBoss(toseongControl.cityBossId)},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){this.firstTap&&(this.firstTap=!1,this.update()),UIMgr.ins().open(SpokesPersonView,SpokesmanActID.boss)},e}(BasePortalIcon);__reflect(SpokesBossPortalIcon.prototype,"SpokesBossPortalIcon");var SpokesmanPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.isShowBoo=!1,n.showMessage=[112,461,482],n.updateMessage=[487,266,268,269,683],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return e},e.prototype.checkShowIcon=function(){var t=SwitchMgr.ins().checkOpen(92)&&spokesPersonControl.checkSysOpen();return t&&!this.isShowBoo&&(spokesPersonControl.checkReadyBoss(),this.isShowBoo=!0),t},e.prototype.checkShowRedPoint=function(){return SpokesPersonRedPoint.ins().red?1:0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(SpokesPersonView),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(SpokesmanPortalIcon.prototype,"SpokesmanPortalIcon");var SpokesmanTaskPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[683,376,466],n.updateMessage=[683,376,466],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return spokesPersonTaskControl.checkOpen()},e.prototype.checkShowRedPoint=function(){return spokesPersonTaskControl.checkRedPoint()?1:0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(SpokesPersonView),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(SpokesmanTaskPortalIcon.prototype,"SpokesmanTaskPortalIcon");var SpringEightDayPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n._activityID=0,n.showMessage=[392,461],n.updateMessage=[392],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(50))return!1;var t=amusementControl.activityData,e=Object.keys(t);
if(!e||!e.length)return!1;for(var i in t){var n=t[i];if(13==n.pageType&&n.isOpenActivity()&&!n.getHide())return this._activityID=+i,!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(13==i.pageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(SpringEightDayView,this._activityID),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(SpringEightDayPortalIcon.prototype,"SpringEightDayPortalIcon");var StorePortalIcon=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376],n.updateMessage=[684],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(4)},e.prototype.checkShowRedPoint=function(){return StoreRedPoint.ins().shopRedPoint||!StoreRedPoint.ins().nfirstLogin?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(StoreView),StoreRedPoint.ins().nfirstLogin=!0,this.update()},e}(PortalBase);__reflect(StorePortalIcon.prototype,"StorePortalIcon");var SuicideLimitBuyTipsPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.curDtList=[],n.redpoint=!0,n.showMessage=[112,437,439],n.updateMessage=[457,456],n.oldZsLv=reincarnateControl.lv,n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.runTime(),TimerMgr.ins().isExists(this.runTime,this)||TimerMgr.ins().doTimer(1e3,0,this.runTime,this),e},e.prototype.runTime=function(){if(this.curDtList.length){var t=this.curDtList[this.curDtList.length-1].getLeftTime();t>0?this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.alertText&&(this.alertText.text=LangMgr.getValueByKey("playTips6")),TimerMgr.ins().remove(this.runTime,this),this.updateShow())}},e.prototype.checkShowIcon=function(){this.curDtList=[];var t=pAmusementControl.activityData;for(var e in t){var i=t[e];3==i.pageType&&i.isOpenActivity()&&!i.getHide()&&this.curDtList.push(i)}if(this.curDtList.length&&reincarnateControl.lv>this.oldZsLv){for(var n=0;n<this.curDtList.length;n++){var o=this.curDtList[n],s=DataCenter.ins().PAmusementConfig[o.id];if(s.zslv==reincarnateControl.lv){UIMgr.ins().open(SuicideLimitBuyTipsView,this.curDtList[this.curDtList.length-1]);break}}this.oldZsLv=reincarnateControl.lv}return!!this.curDtList.length},e.prototype.checkShowRedPoint=function(){if(this.redpoint)return 1;for(var t in this.curDtList){var e=this.curDtList[t],i=DataCenter.ins().PAmusement2Config[e.id][1];if(!e.buyData[1]&&ActorControl.yb>=i.price)return 1}return 0},e.prototype.tapExecute=function(){this.redpoint=!1,UIMgr.ins().open(SuicideLimitBuyView),this.update()},e}(PortalBase);__reflect(SuicideLimitBuyTipsPortalIcon.prototype,"SuicideLimitBuyTipsPortalIcon");var SuperVipPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(31)?SDKManager.ins().SDKShowSuperVip():!1},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(SuperVipView)},e}(PortalBase);__reflect(SuperVipPortalIcon.prototype,"SuperVipPortalIcon");var TaskTracePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.currentEff="",n.showMessage=[91,461,353],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return taskControl.getTaskState()&&!copyControl.pkGqboss},e.prototype.getEffName=function(t){var e,i=taskControl.taskTrace;if(i)switch(i.state){case 0:e="achieveCom",this.effX=185,this.effY=35;break;case 1:e="GWOpenEff",this.effX=185,this.effY=35}if(this.currentEff!=e){var n=UIMgr.playFun;n.ruleEff[this.tar.hashCode]&&(DisplayUtils.removeFromParent(n.ruleEff[this.tar.hashCode]),n.ruleEff[this.tar.hashCode]=null)}return this.currentEff=e,e},e.prototype.tapExecute=function(){var t=taskControl.taskTrace;if(0==t.state)GuideControl.taskGuidance(t.id,1),guideControl.updateByClick();else{taskControl.upGetAchieve(t.achievementId),taskControl.dispatchParabolicItem(),promptControl.dispatchAchievementAft(t),taskControl.getAchieveConfById(t.id+1)||tipsControl.showTips(LangMgr.getValueByKey("playTips9"));var e=UIMgr.playFun;e.hejiRule.updatekStep(!0)}this.update()},e}(PortalBase);__reflect(TaskTracePortalIcon.prototype,"TaskTracePortalIcon");var ToseongBossPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n._shap=new egret.Shape,n._radius=0,n.showMessage=[461,4,466,376],n.updateMessage=[101,102],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.monHead=e.monHead,this.process=e.process,this._radius=e.width>>1,this._shap.x=this._radius,this._shap.y=this._radius,this._shap.rotation=-90,e.addChild(this._shap),this.process.mask=this._shap,e},e.prototype.checkShowIcon=function(){return this.updateIcon(),DebugUtils.OpenRule?!0:GameServer.serverOpenDay&&SwitchMgr.ins().checkOpen(28)},e.prototype.checkShowRedPoint=function(){this.updateIcon();var t=toseongControl.cityBossId&&toseongControl.getCityBossConfig(toseongControl.cityBossId);return t?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(ToseongBossView)},e.prototype.getEffName=function(t){},e.prototype.updateIcon=function(){var t=toseongControl.cityBossId;if(0!=t&&toseongControl.getCityBossConfig(t))this.curAngle=360;else{var e=toseongControl.getMaxKillNumBoss(),i=e[0],n=e[1];t=i,this.curAngle=MathUtils.toInteger(360*n)}DataCenter.ins().MonstersConfig[t]&&DataCenter.ins().MonstersConfig[t]&&this.monHead&&(this.monHead.source="monhead"+DataCenter.ins().MonstersConfig[t].head+"_png")},Object.defineProperty(e.prototype,"curAngle",{set:function(t){DisplayUtils.drawCir(this._shap,this._radius,t)},enumerable:!0,configurable:!0}),e}(PortalBase);__reflect(ToseongBossPortalIcon.prototype,"ToseongBossPortalIcon");var ToseongPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[353,461],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:MapControl.sceneInHook()&&SwitchMgr.ins().checkOpen(32)},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.tapExecute=function(){return MapControl.sceneInHook()&&SwitchMgr.ins().checkOpen(32)?confrontControl.isEncounter()?void tipsControl.showTips(LangMgr.getValueByKey("atkPlayerIng")):void(toseongControl.enterCD<1?warnControl.showDangerWarn(function(){toseongControl.upEnter()}):tipsControl.showTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD))):void 0},e}(PortalBase);__reflect(ToseongPortalIcon.prototype,"ToseongPortalIcon");var TotalRecharge55PortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.activityId=0,n.showMessage=[392,461],n.updateMessage=[392,178],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.runTime(),this.addTime(),e},e.prototype.addTime=function(){TimerMgr.ins().doTimer(1e3,0,this.runTime,this)},e.prototype.removeTime=function(){TimerMgr.ins().remove(this.runTime,this)},e.prototype.runTime=function(){var t=amusementControl.activityData;if(!this.activityId)for(var e in t){var i=t[e];if(103==i.pageType&&i.isOpenActivity()&&!i.getHide()){this.activityId=+e;break}}if(!this.activityId)return void(this.alertText&&(this.alertText.text=""));var n=t[this.activityId];if(!n)return void(this.alertText&&(this.alertText.text=""));var o=n.getLeftTime();if(o>0)this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(o,DateUtils.TIME_FORMAT_12));else{var s=UIMgr.playFun;s&&(this.removeTime(),this.update())}},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(this.removeTime(),!SwitchMgr.ins().checkOpen(36))return!1;var t=amusementControl.activityData,e=Object.keys(t);if(!e||!e.length)return!1;for(var i in t){var n=t[i];if(103==n.pageType&&n.isOpenActivity()&&!n.getHide()){this.activityId=+i;var o=t[this.activityId];if(o.getLeftTime()>0)return this.addTime(),!0}}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(103==i.pageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(TotalRecharge55View),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(TotalRecharge55PortalIcon.prototype,"TotalRecharge55PortalIcon");var TotalRechargePortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.activityId=0,n.showMessage=[392,461],n.updateMessage=[392,178],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=ColorUtils.GREEN,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.runTime(),this.addTime(),e},e.prototype.addTime=function(){TimerMgr.ins().doTimer(1e3,0,this.runTime,this)},e.prototype.removeTime=function(){TimerMgr.ins().remove(this.runTime,this)},e.prototype.runTime=function(){var t=amusementControl.activityData;if(!this.activityId)for(var e in t){var i=t[e];if(5==i.pageType&&i.isOpenActivity()&&!i.getHide()){this.activityId=+e;break}}if(!this.activityId)return void(this.alertText&&(this.alertText.text=""));var n=t[this.activityId];if(!n)return void(this.alertText&&(this.alertText.text=""));var o=n.getLeftTime();if(o>0)this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(o,DateUtils.TIME_FORMAT_12));else{var s=UIMgr.playFun;s&&(this.removeTime(),this.update())}},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(this.removeTime(),!SwitchMgr.ins().checkOpen(36))return!1;var t=amusementControl.activityData,e=Object.keys(t);if(!e||!e.length)return!1;for(var i in t){var n=t[i];if(5==n.pageType&&n.isOpenActivity()&&!n.getHide()){this.activityId=+i;var o=t[this.activityId];if(o.getLeftTime()>0)return this.addTime(),!0}}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(5==i.pageType&&i.isOpenActivity()&&i.canReward()&&!i.getHide())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){UIMgr.ins().open(TotalRechargeView),this.firstTap&&(this.firstTap=!1,this.update())},e}(PortalBase);__reflect(TotalRechargePortalIcon.prototype,"TotalRechargePortalIcon");var TrailerPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=[4,112,105,376],n.updateMessage=[4,112,105,376],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.updateTar(),e},e.prototype.updateTar=function(t){void 0===t&&(t=null),t||(t=trailerControl.getCurShowCfg()),t&&(this.dataCfg=t,this.tar.imgItem.source=this.dataCfg.icon,trailerControl.isReach(this.dataCfg)?(this.time=0,TimerMgr.ins().remove(this.runTime,this),this.tar.conditionText.text=LangMgr.getValueByKey("newfeatureon"),this.tar.conditionText.visible=!0):(this.time=this.getLeftTime(),this.time>0?(this.runTime(),TimerMgr.ins().doTimer(1e3,this.time,this.runTime,this)):(this.tar.conditionText.text=LangMgr.getValueByKey("fbRotationOpen",this.dataCfg.zsLevel),TimerMgr.ins().remove(this.runTime,this),this.tar.conditionText.visible=!0)))},e.prototype.getLeftTime=function(){if(!this.dataCfg)return 0;var t=0;if(GameServer.serverOpenDay+1<this.dataCfg.openDay){var e=new Date(GameServer.serverTime),i=this.dataCfg.openDay-(GameServer.serverOpenDay+1);e.setDate(e.getDate()+i),e.setHours(0,0,0,0),t=Math.floor((e.getTime()-GameServer.serverTime)/1e3)}return t},e.prototype.runTime=function(){var t=this.time;this.time=this.getLeftTime(),t>0?this.tar.conditionText&&(this.tar.conditionText.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)):(this.tar.conditionText&&(this.tar.conditionText.text=""),TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;e.isOpen=!1;var t=trailerControl.getCurShowCfg();return t?(t!=this.dataCfg&&this.tar&&this.updateTar(t),!0):!1},e.prototype.checkShowRedPoint=function(){var t=trailerControl.getForeshow();if(t&&t.length>0){if(this.firstTap)return 1;for(var e in t){var i=t[e];if(trailerControl.isReach(i))return 1}}return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(TrailerView),this.firstTap=!1,this.update()},e.prototype.onAddToStage=function(){t.prototype.onAddToStage.call(this),e.checkAutoOpen()},e.checkAutoOpen=function(){e.isOpen&&!ServerStorage.ins().getBitValue(ClientSetBit.funcopen)&&(ServerStorage.ins().setBitValue(ClientSetBit.funcopen,1),UIMgr.ins().open(TrailerView))},e.isOpen=!1,e}(PortalBase);__reflect(TrailerPortalIcon.prototype,"TrailerPortalIcon");var TreasureBasin2PortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.leftTime=0,n.showMessage=[392,461],n.updateMessage=[392],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.leftTime=this.getBuyLeftTime(),this.leftTime&&(this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this)),e},e.prototype.getBuyLeftTime=function(){if(!this.actData||this.actData.buyState)return 0;var t=this.actData.getCurDay(),e=DataCenter.ins().Amusement16Config[this.actData.id][0];if(t<=e.buyDay){var i=new Date(DateUtils.formatMiniDateTime(this.actData.startTime));return i.setDate(i.getDate()+e.buyDay),Math.floor((i.getTime()-GameServer.serverTime)/1e3)}return 0},e.prototype.runTime=function(){this.leftTime>0?(this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(this.leftTime,DateUtils.TIME_FORMAT_12)),this.leftTime-=1):(this.alertText&&(this.alertText.text=""),TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(2))return!1;var t=amusementControl.activityData;for(var e in t){var i=t[e];if(34==i.pageType&&i.isOpenActivity()&&!i.getHide())return this.actData=i,this.leftTime=this.getBuyLeftTime(),!0}return this.actData=null,!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(34==i.pageType&&i.canReward())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){var t=DataCenter.ins().AmusementConfig[this.actData.id];t&&(UIMgr.ins().open(TreasureBasinMainView),this.firstTap&&(this.firstTap=!1,this.update()))},e}(PortalBase);__reflect(TreasureBasin2PortalIcon.prototype,"TreasureBasin2PortalIcon");var TreasureBasinPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.leftTime=0,n.showMessage=[392,461],n.updateMessage=[392],n}return __extends(e,t),e.prototype.createTar=function(){var e=t.prototype.createTar.call(this);return this.alertText=new eui.Label,this.alertText.size=14,this.alertText.width=120,this.alertText.textAlign="center",this.alertText.textColor=3532333,this.alertText.horizontalCenter=0,e.addChild(this.alertText),this.alertText.y=70,this.leftTime=this.getBuyLeftTime(),this.leftTime>0&&(this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this)),e},e.prototype.getBuyLeftTime=function(){if(!this.actData||this.actData.buyState)return 0;var t=this.actData.getCurDay(),e=DataCenter.ins().Amusement16Config[this.actData.id][0];if(t<=e.buyDay){var i=new Date(DateUtils.formatMiniDateTime(this.actData.startTime));return i.setDate(i.getDate()+e.buyDay),Math.floor((i.getTime()-GameServer.serverTime)/1e3)}return 0},e.prototype.runTime=function(){this.leftTime>0?(this.alertText&&(this.alertText.text=DateUtils.getFormatBySecond(this.leftTime,DateUtils.TIME_FORMAT_12)),this.leftTime-=1):(this.alertText&&(this.alertText.text=""),TimerMgr.ins().remove(this.runTime,this),this.updateShow())},e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(2))return!1;var t=amusementControl.activityData;for(var e in t){var i=t[e];if(24==i.pageType&&i.isOpenActivity()&&!i.getHide())return this.actData=i,this.leftTime=this.getBuyLeftTime(),!0}return this.actData=null,!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(24==i.pageType&&i.canReward())return 1}return 0},e.prototype.getEffName=function(t){return this.firstTap||t?(this.effX=38,this.effY=38,"actIconCircle"):void 0},e.prototype.tapExecute=function(){var t=DataCenter.ins().AmusementConfig[this.actData.id];t&&(UIMgr.ins().open(TreasureBasinMainView),this.firstTap&&(this.firstTap=!1,this.update()))},e}(PortalBase);__reflect(TreasureBasinPortalIcon.prototype,"TreasureBasinPortalIcon");var TreasureHuntPortalIcon=function(t){function e(e,i){void 0===i&&(i=null);var n=t.call(this,e,i)||this;return n.showMessage=[112,461,374,376,466],n.updateMessage=[266,271,68],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(7)},e.prototype.checkShowRedPoint=function(){if(ServerStorage.ins().getValue(14)!=new Date(GameServer.serverTime).getDate())return 1;var t=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureEquipConfig.huntItem),e=t?t.count:0,i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureRuneConfig.huntItem),n=i?i.count:0,o=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().HeirloomTreasureConfig.huntItem),s=o?o.count:0;return Boolean(backpackControl.getHuntGoods(0).length)||e>0||Boolean(backpackControl.getHuntGoods(1).length)||runeControl.getIsGetBox()||n>0||RuneRedPoint.ins().checkCanExchange()||heirloomControl.isHeirloomHuntOpen()&&(Boolean(backpackControl.getHuntGoods(2).length)||heirloomControl.getIsGetBox()||s>0)?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(TreasureHuntView);var t=new Date(GameServer.serverTime).getDate();ServerStorage.ins().getValue(14)!=t&&(ServerStorage.ins().setValue(14,t),this.update())},e}(PortalBase);__reflect(TreasureHuntPortalIcon.prototype,"TreasureHuntPortalIcon");var UnionApplyPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461],n.updateMessage=[685],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:ActorControl.level>=DataCenter.ins().UnionConfig.openLevel},e.prototype.checkShowRedPoint=function(){return UnionRedPoint.ins().hanghui?1:0},e.prototype.tapExecute=function(){ActorControl.level>=DataCenter.ins().UnionConfig.openLevel?void 0==unionControl.guildID||0==unionControl.guildID?UIMgr.ins().open(UnionApplyView):UIMgr.ins().open(UnionMapView):tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().UnionConfig.openLevel))},e}(PortalBase);__reflect(UnionApplyPortalIcon.prototype,"UnionApplyPortalIcon");var UnionWarMainPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[419],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:1==unionWarControl.getModel().getIsShowGuildWarBtn()},e.prototype.getEffName=function(t){},e.prototype.tapExecute=function(){return void 0==unionControl.guildID||0==unionControl.guildID?void tipsControl.showTips(LangMgr.getValueByKey("playTips1")):(unionWarControl.upWinGuildInfo(),UIMgr.ins().close(UnionMapView),void UIMgr.ins().open(UnionWarMainView))},e}(PortalBase);__reflect(UnionWarMainPortalIcon.prototype,"UnionWarMainPortalIcon");var UnlimitedAmusementPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,374,376,392,437],n.updateMessage=[457,178,180,446,392,437],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(1009))return!1;var t=amusementControl.activityData,e=Object.keys(t);if(!e.length)return!1;for(var i in t){var n=t[i];if(3==n.timeType&&n.isOpenActivity()&&!n.getHide())return!0}return!1},e.prototype.checkShowRedPoint=function(){var t=amusementControl.activityData;for(var e in t){var i=t[e];if(3==i.timeType&&i.isOpenActivity()&&i.canReward())return 1}return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){UIMgr.ins().open(UnlimitedAmusementView),this.update()},e}(PortalBase);__reflect(UnlimitedAmusementPortalIcon.prototype,"UnlimitedAmusementPortalIcon");var Vip3MBPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,108,178,446],n.updateMessage=[107],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;var t=payControl.getRechargeData(0);return SwitchMgr.ins().checkOpen(1)&&t.num>1&&SwitchMgr.ins().checkOpen(26)&&!(vipControl.state>>2&1)},e.prototype.checkShowRedPoint=function(){return vipControl.lv>=3?1:0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){this.update(),UIMgr.ins().open(Vip3MBView,3)},e}(PortalBase);__reflect(Vip3MBPortalIcon.prototype,"Vip3MBPortalIcon");var Vip3PortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.firstTap=!0,n.showMessage=n.updateMessage=[108],n}return __extends(e,t),e.prototype.checkShowIcon=function(){return 0==(vipControl.state>>2&1)},e.prototype.checkShowRedPoint=function(){var t=0==(vipControl.state>>2&1)&&vipControl.lv>=3;return t?1:0},e.prototype.tapExecute=function(){UIMgr.ins().open(Vip3View),this.firstTap=!1,this.update()},e}(PortalBase);__reflect(Vip3PortalIcon.prototype,"Vip3PortalIcon");var VipGiftPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[461,110],n.updateMessage=[106,110,446,457],n}return __extends(e,t),e.prototype.checkShowIcon=function(){if(DebugUtils.OpenRule)return!0;if(!SwitchMgr.ins().checkOpen(19))return!1;for(var t=Object.keys(DataCenter.ins().VipGiftConfig).length,e=vipControl.vipGiftState,i=1;t>=i;i++){var n=DataCenter.ins().VipGiftConfig[i].hfTimes;if(n=n?n:0,GameServer._hefuCount>=n&&0==(1&e[i-1].state))return!0}return!1},e.prototype.checkShowRedPoint=function(){var t=vipControl.lv;for(var e in DataCenter.ins().VipGiftConfig){var i=DataCenter.ins().VipGiftConfig[e],n=i.hfTimes;if(n=n?n:0,t>=i.vipLv&&GameServer._hefuCount>=n&&vipControl.getVipGiftRedPoint(+e))return 1}return 0},e.prototype.tapExecute=function(){UIMgr.ins().open(VipGiftView)},e}(PortalBase);__reflect(VipGiftPortalIcon.prototype,"VipGiftPortalIcon");var VouchersPortalIcon=function(t){function e(e,i){return t.call(this,e,i)||this}return __extends(e,t),e.prototype.checkShowIcon=function(){return DebugUtils.OpenRule?!0:SwitchMgr.ins().checkOpen(1022)},e.prototype.checkShowRedPoint=function(){return 0},e.prototype.getEffName=function(t){return this.effX=38,this.effY=38,"actIconCircle"},e.prototype.tapExecute=function(){this.update(),UIMgr.ins().open(VouchersView)},e}(PortalBase);__reflect(VouchersPortalIcon.prototype,"VouchersPortalIcon");var WarriorTaskPortalIcon=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.showMessage=[112,461,466],n.updateMessage=[112,461,466,37,267,266,268,41,42,43,44],n}return __extends(e,t),e.prototype.checkShowIcon=function(){var t=WarriorConfigMgr.ins().getBaseConfig();return ActorControl.level<t.level?!1:reincarnateControl.lv<t.openZhuanshengLv?!1:GameServer.serverOpenDay+1<t.openServerDay?!1:(WarriorModel.ins().firstOpenWinWhenLogin&&WarriorModel.ins().checkIsTaskStage()&&MapControl.sceneInHook()&&WarriorModel.ins().hasInitTask&&(WarriorModel.ins().firstOpenWinWhenLogin=!1,UIMgr.ins().open(WarriorTaskView)),!0)},e.prototype.checkShowRedPoint=function(){if(WarriorModel.ins().checkIsTaskStage()){if(WarriorModel.ins().checkTaskRewardRed())return 1}else if(WarriorModel.ins().checkAllWarriorRedForTabStren()||WarriorModel.ins().checkAllWarriorRedForTabBreach()||WarriorModel.ins().checkAllRedForTabEquip()||WarriorModel.ins().checkEquipRedForTabCompose())return 1;return 0},e.prototype.getEffName=function(){},e.prototype.tapExecute=function(){WarriorModel.ins().checkIsTaskStage()?UIMgr.ins().open(WarriorTaskView):UIMgr.ins().open(WarriorView)},e}(PortalBase);__reflect(WarriorTaskPortalIcon.prototype,"WarriorTaskPortalIcon");var PortalView=function(t){function e(){var e=t.call(this)||this;return e.taskEffTypes=[],e.ruleList={},e.ruleParent={},e.ruleIdList={},e.ruleEff={},e.lastEnergy=-1,e.tick=0,e.secondYbTime=5,e.preRecharge=!1,e.preVip=!1,e.ignoreLeak=!0,e.uilayer=GameLayer.SCENE3,e.isShowLog=!1,e.resident=!0,e.isPlayAnima=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.initData=function(){CommonUtils.labelIsOverLenght(this.goldTxt,ActorControl.gold),CommonUtils.labelIsOverLenght(this.ybTxt,ActorControl.yb),this.nameTxt.text=ActorControl.myName,this.expChange(),BitmapNumber.ins().changeNum(this.power,ActorControl.power,"8",5),this.vipImg0.source=vipControl.isSuperVip(vipControl.lv)?"szjmvipzi":"zjmvipzi",BitmapNumber.ins().changeNum(this.vipNum,vipControl.getVipLevel(vipControl.lv),"zv0",0),this.vipNum.x=this.vipImg0.x+this.vipImg0.width+8,this.vipNum.y=this.vipImg0.y-.84,this.upDataVipBtnRedPoint()},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PortalViewSkin",this.showViewList={},this.showViewList[PortalShow.topMain]=this.topMain,this.showViewList[PortalShow.leftGroup]=this.leftGroup,this.showViewList[PortalShow.rightGroup]=this.rightGroup,this.showViewList[PortalShow.downGroup]=this.downGroup,this.showViewList[PortalShow.topGroup]=this.topGroup,this.showViewList[PortalShow.downSortBtn]=this.downSortBtn,this.rulePos={0:this.downGroup,1:this.iconGroup,2:this.leftGroup,3:this.rightGroup,4:this.downSortBtn},this.flameMC=new GameMovieClip,this.flameMC.x=72,this.flameMC.y=21,this.flameGroup.addChildAt(this.flameMC,0),this.power=BitmapNumber.ins().createNumPic(0,"8",5),this.power.scaleX=this.power.scaleY=.8,this.power.x=this.fightImg.x+70,this.power.y=this.fightImg.y+8,this.flameGroup.addChild(this.power),this.guanQicMc=new GameMovieClip,this.guanQicMc.touchEnabled=!1,this.expBallMc=new GameMovieClip,this.expBallMc.x=80,this.expBallMc.y=86,this.expBallMc.touchEnabled=!1,this.guanQiaLineMc=new GameMovieClip,this.guanQiaLineMc.x=83,this.guanQiaLineMc.y=107,this.guanQiaLineMc.touchEnabled=!1,this.taskAsseptMc=new GameMovieClip,this.taskAsseptMc.x=140,this.taskAsseptMc.y=-50,this.taskAsseptMc.touchEnabled=!1,this.taskComMc=new GameMovieClip,this.taskComMc.x=140,this.taskComMc.y=-80,this.taskComMc.touchEnabled=!1;var e=heroControl.getSubRoleByIndex(0);this.face.source="yuanhead"+e.job+e.sex,this.vipImg0.source=vipControl.isSuperVip(vipControl.lv)?"szjmvipzi":"zjmvipzi",this.vipNum=BitmapNumber.ins().createNumPic(vipControl.getVipLevel(vipControl.lv),"zv0",8),this.vipNum.x=this.vipImg0.x+this.vipImg0.width+8,this.vipNum.y=this.vipImg0.y-.84,this.vipGroup.addChild(this.vipNum),this.guanqiaBar.slideDuration=0,PortalBase.update=this.updateRule.bind(this),PortalBase.updateShow=this.updateRuleAndSort.bind(this),this.initRuleList(),this.publicBossRelive(!1),""!=GlobalModel.playGameMusic&&SoundUtils.ins().playBg(GlobalModel.playGameMusic)},e.prototype.initRuleList=function(){var t=DataCenter.ins().PortalConfig;for(var e in t){var i=t[e],n=egret.getDefinitionByName(i.cls);n?this.addRuleList(new n(i.id)):alert(LangMgr.getValueByKey("errorFunc",e,i.cls))}this.groupGuanqia.touchEnabled=!1,this.addRuleList(new TaskTracePortalIcon(0,this.taskTraceBtn)),this.hejiRule=new FocusAttackPortalIcon(0,this.hejiguide),this.addRuleList(this.hejiRule)},e.prototype.addRuleList=function(t){if(this.ruleList[t.hashCode]=t,t.id&&(this.ruleIdList[t.id]=t),t.tar&&t.tar.parent)this.ruleParent[t.hashCode]=t.tar.parent,t.tar.parent.removeChild(t.tar);else{var e=DataCenter.ins().PortalConfig[t.id];this.ruleParent[t.hashCode]=this.rulePos[void 0==e.pos?1:e.pos]}},e.prototype.getRuleById=function(t){return this.ruleIdList[t]},e.prototype.showViews=function(t){var e=t[0],i=t[1];for(var n in PortalShow){var o=Number(PortalShow[n]),s=(e&o)==o;this.showView(o,i?!s:s)}},e.prototype.showView=function(t,e){this.showViewList[t].visible=e},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btn_toolbar,this.onTap),this.addEventTouchTap(this.autoPkBoss,this.onChange),this.addEventTouchTap(this.vipBtn0,this.onTap),this.addEventTouchTap(this.taskTraceBtn,this.onTaskTrace),this.addEventTouchTap(this.guanqiaBtn,this.onTaskTrace),this.addEventTouchTap(this.guanqiaBtn,this.guanqiaBtnClick),this.addEventTouchTap(this.face,this.onTap),this.addEventTouchTap(this.expGroup,this.onTap),this.addEventTouchTap(this.mapName0,this.onTap),this.soundRadioBtn&&this.addEventTouchTap(this.soundRadioBtn,this.onTap),this.timelabel&&this.addEventTouchTap(this.timelabel,this.onTap),this.ybIcon&&this.addEventTouchTap(this.ybIcon,this.onTap),this.addCustomEvent(353,this.upDataGuanqia),this.addCustomEvent(374,this.upDataGuanQiaInfo),this.addCustomEvent(91,this.changeTaskTrace),this.addCustomEvent(91,this.updateTaskState),this.addCustomEvent(376,this.guanqiaChange),this.addCustomEvent(352,this.initData),this.addCustomEvent(456,this.initData),this.addCustomEvent(457,this.initData),this.addCustomEvent(455,this.initData),this.addCustomEvent(463,this.initData),this.addCustomEvent(359,this.addExpFlyMc),this.addCustomEvent(493,this.upDataGuanqia),this.addCustomEvent(639,this.warmWord),this.addCustomEvent(106,this.initData),this.addCustomEvent(107,this.upDataVipBtnRedPoint),this.addCustomEvent(108,this.upDataVipBtnRedPoint),this.addCustomEvent(109,this.upDataVipBtnRedPoint),this.addCustomEvent(461,this.updateHeadRedPoint),this.addCustomEvent(511,this.updateHeadRedPoint),this.addCustomEvent(470,this.updateLevelBar),this.addCustomEvent(453,this.checkGuide),this.addCustomEvent(187,this.showViews),this.addCustomEvent(384,this.showFlower),this.addCustomEvent(640,this.GuanQiaEffLogic),this.addCustomEvent(641,this.GuanQiaEffLogic),this.addCustomEvent(483,this.upDataGuanQiaInfo),this.addCustomEvent(123,this.updateYbShow),this.updateYbShow(),this.addEventTouchTap(this.recharge1,this.onTap),this.addEventTouchTap(this.recharge2,this.onTap),this.addEventTouchTap(this.cz,this.onTap),this.initData(),this.upDataGuanQiaInfo(),this.changeTaskTrace(),this.addRuleEvent(),this.updateRules(),this.upDataWillBoss(confrontControl.willBossID),this.updateHeadRedPoint(),redPacketSysControl.updateRedPacket(),this.flameMC.playFile(PATH_EFF+"zhanduolibeijing",-1),this.setSoundRadio(ServerStorage.ins().getBitBool(ClientSetBit.sound_effect))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeGuanQiaEnergy(),this.removeRuleEvent(),this.hongbao.removeChildren(),DisplayUtils.removeFromParent(this.flowerPanel),TimerMgr.ins().remove(this.upDataGuanQiaInfo,this),this._expEff&&(this._expEff.destroy(),this._expEff=null)
},e.prototype.onMapChange=function(){this.upDataGuanqia()},e.prototype.setSoundRadio=function(t){this.soundRadioBtn&&(this.soundRadioBtn.source=t?"sound_activate":"sound_disable")},e.prototype.expChange=function(t){var e=t||ActorControl.level,i=ReincarnateControl.ins()?reincarnateControl.lv:0,n=LangMgr.getValueByKey("level",i?LangMgr.getValueByKey("numberRotation",i):"",e);this.lvTxt.textFlow=TextUtils.generateTextFlow(n)},e.prototype.hideBtn=function(){this.iconGroup.visible=!this.btn_toolbar.selected},e.prototype.addRuleEvent=function(){for(var t in this.ruleList){var e=this.ruleList[t];e.addShowEvents(),e.isShow&&(e.addRedEvents(),RecycleMgr.ins().reloadContainer(e.tar,!0),e.onAddToStage())}},e.prototype.removeRuleEvent=function(){for(var t in this.ruleList){var e=this.ruleList[t];e.removeEvents(),e.isShow&&e.onRemoveFromStage()}},e.prototype.updateRules=function(){TimerMgr.ins().isExists(this.startUpdateRule,this)||TimerMgr.ins().doTimer(60,1,this.startUpdateRule,this)},e.prototype.startUpdateRule=function(){var t=!1;for(var e in this.ruleList){var i=this.ruleList[e],n=this.updateShow(i);n&&(t=!0),!n&&i.isShow&&this.updateRule(i)}t&&this.sortBtnList(),this.checkGuide()},e.prototype.checkGuide=function(){DieGuide.ins().checkFirstChargeOrVIPWin()},e.prototype.updateRuleAndSort=function(t){TimerMgr.ins().doTimer(100,1,function(){this.updateShow(t)&&this.sortBtnList(t)},this)},e.prototype.updateShow=function(t){var e,i=t.checkShowIcon();if(crossFieldControl.isLinkingCross&&(i=!1),t.isShow==i)return!1;if(t.isShow=i,i){t.addRedEvents(),e=t.getTar(),this.addEventTouchTap(e,t.tapExecute,t);var n=this.ruleParent[t.hashCode];n.addChild(e),t.onAddToStage(),RecycleMgr.ins().reloadContainer(e,!0),this.updateRule(t)}else t.removeRedEvents(),e=t.tar,e&&(this.removeEventTouchTap(e,t.tapExecute,t),DisplayUtils.removeFromParent(e),DisplayUtils.removeFromParent(this.ruleEff[e.hashCode]),t.onRemoveFromStage());return!0},e.prototype.updateRule=function(t){var e=0,i=t.getTar();i.redPoint&&(e=t.checkShowRedPoint(),i.redPoint.visible=e);var n=t.getEffName(e);if(n)if(this.ruleEff[i.hashCode]&&this.ruleEff[i.hashCode].parent)this.ruleEff[i.hashCode].play(-1);else{var o=this.getEff(i.hashCode,n);o.x=t.effX,o.y=t.effY,i.addChildAt(o,100)}else DisplayUtils.removeFromParent(this.ruleEff[i.hashCode])},e.prototype.getEff=function(t,e){return this.ruleEff[t]=this.ruleEff[t]||new GameMovieClip,e&&this.ruleEff[t].playFile(PATH_EFF+e,-1),this.ruleEff[t]},e.prototype.onChange=function(t){if(copyControl.guanqiaID<=10)tipsControl.showTips(LangMgr.getValueByKey("tipsPass",10)),this.autoPkBoss.selected=!1;else{if(DataCenter.ins().ChaptersConfig[copyControl.guanqiaID].zsLevelLimit>(ReincarnateControl.ins()?reincarnateControl.lv:0))return tipsControl.showCenterTips(LangMgr.getValueByKey("kfTips74",DataCenter.ins().ChaptersConfig[copyControl.guanqiaID].zsLevelLimit)),void(this.autoPkBoss.selected=!1);this.autoPkBoss.selected?backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?(tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace")),this.autoPkBoss.selected=!1):copyControl.guanqiaID<GameConst.AUTO_GUANQIA?(tipsControl.showTips(LangMgr.getValueByKey("tipsChallenge",GameConst.AUTO_GUANQIA)),this.autoPkBoss.selected=!1):copyControl.guanqiaID>=DataCenter.ins().InstanceBaseConfig.maxCheckPoint?(tipsControl.showCenterTips(LangMgr.getValueByKey("tipsMaxLevel")),this.autoPkBoss.selected=!1):(this.GuanQiacleanEff(),portalControl.openAuto()):portalControl.closeAuto()}t.stopPropagation(),t.stopImmediatePropagation()},e.prototype.guanqiaChange=function(){},e.prototype.onTaskTrace=function(t){var e=taskControl.taskTrace;if(e&&0==e.state){var i=taskControl.getAchieveConfById(e.id);switch(i.control){case 2:case 5:if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return;copyControl.currentEnergy<copyControl.energy&&this.showTaskTips(LangMgr.getValueByKey("tipsNoChallenge")),5==i.control&&promptControl.dispatchKillBoss(i);break;case 6:var n=LangMgr.getValueByKey("tipsHaveNumber",i.target-e.value);this.showTaskTips(n)}}},e.prototype.guanqiaBtnClick=function(t){return copyControl.guanqiaID>=DataCenter.ins().InstanceBaseConfig.maxCheckPoint?void tipsControl.showCenterTips(LangMgr.getValueByKey("tipsMaxLevel")):void(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?UIMgr.ins().open(BackpackFullTipsView):copyControl.currentEnergy>=copyControl.energy?(this.GuanQiacleanEff(),copyControl.autoPk(),copyControl.firstAutoGuilder=copyControl.guanqiaID==GameConst.AUTO_GUANQIA-1):tipsControl.showTips(LangMgr.getValueByKey("powerInsufficient")))},e.prototype.showTaskTips=function(t){tipsControl.showTaskTips(t)},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.ybIcon:this.clickYbShow();break;case this.willBossPrompt:UIMgr.ins().open(BossView,1);break;case this.btn_toolbar:this.hideBtn();break;case this.soundRadioBtn:var i="sound_activate"==this.soundRadioBtn.source;this.setSoundRadio(!i),ServerStorage.ins().setBitBool(ClientSetBit.sound_effect,!i),ServerStorage.ins().updateSetting();break;case this.cz:case this.recharge1:payControl.checkOpenWin();break;case this.recharge2:storeControl.openBuyGoldWin();break;case this.vipBtn0:UIMgr.ins().open(VipView);break;case this.face:UIMgr.ins().open(SettingView),this.headRedPoint.visible&&(ServerStorage.ins().setValue(3,1),this.updateHeadRedPoint());break;case this.expGroup:case this.mapName0:UIMgr.ins().open(HookRewardTipsView,1)}},e.prototype.changeTaskTrace=function(){var t=taskControl.taskTrace;if(t){var e=taskControl.getAchieveConfById(t.id);if(!e)return void debug.log("Task Config"+t.id+"inexistence！");switch(79==e.type?this.taskTraceAwards.textFlow=TextUtils.generateTextFlow("|C:"+LangMgr.getColor("color81")+"&T:"+e.desc+"|"):this.taskTraceAwards.text=""+e.desc,t.state){case 0:var i=e.target,n=t.value;79==e.type&&(n=0,i=1),36==e.type&&(n-=1,i-=1),this.taskTraceName.textFlow=TextUtils.generateTextFlow(e.name+("|C:"+ColorUtils.RED+"&T: (")+n+"/"+i+")|"),0==t.value&&GuideControl.stopTaskEffect(),GuideControl.startTaskEffect();break;case 1:this.taskTraceName.textFlow=TextUtils.generateTextFlow(e.name+LangMgr.getValueByKey("tipsFinsh")),GuideControl.stopTaskEffect(),GuideControl.startTaskEffect()}var o=egret.Tween.get(this.taskTraceAwards),s=egret.Tween.get(this.taskTraceName);o.to({x:this.taskTraceAwards.x+100,alpha:0},200).to({x:0},200).to({x:61,alpha:1},200),s.to({x:this.taskTraceName.x+100,alpha:0},200).to({x:0},200).to({x:61,alpha:1},200)}else GuideControl.stopTaskEffect()},e.prototype.updateTaskState=function(){var t=taskControl.taskTrace;t&&(1==t.state?this.taskAsseptMc.parent?this.taskEffTypes.indexOf(1)<0&&this.taskEffTypes.push(1):this.taskComMc.parent||this.addTaskEffectIndex(1):0==t.state&&0==t.value&&(this.taskComMc.parent?this.taskEffTypes.indexOf(0)<0&&this.taskEffTypes.push(0):this.taskAsseptMc.parent||this.addTaskEffectIndex(0)))},e.prototype.addTaskEffectIndex=function(t){var e=this;0==t?(this.taskTraceBtn.addChild(this.taskAsseptMc),this.taskAsseptMc.playFile(PATH_EFF+"receive",1,function(){TimerMgr.ins().doNext(function(){e.taskEffTypes.length&&e.addTaskEffectIndex(e.taskEffTypes.shift())},e)}),SoundUtils.ins().playEffect(SoundUtils.TASK),this.taskAsseptMc.y=-50):1==t&&(this.taskTraceBtn.addChild(this.taskComMc),this.taskComMc.playFile(PATH_EFF+"complete",1,function(){TimerMgr.ins().doNext(function(){e.taskEffTypes.length&&e.addTaskEffectIndex(e.taskEffTypes.shift())},e)}),this.taskComMc.y=-80)},e.prototype.upDataGuanQiaInfo=function(){this.groupGuanqia.visible=copyControl.checkGuanqiaIconShow()&&MapControl.sceneInHook(),TimerMgr.ins().remove(this.upDataGuanQiaInfo,this);var t=spokesPersonDoubleExpControl.getLeftTime();t>0?(TimerMgr.ins().doTimer(1e3*t,1,this.upDataGuanQiaInfo,this),this._expEff||(this._expEff=ObjectPool.pop("GameMovieClip"),this._expEff.touchEnabled=!1),this._expEff.scaleX=this.expTxt.textWidth/164+.1,this._expEff.scaleY=.6,this._expEff.anchorOffsetX=-82,this._expEff.y=10,this._expEff.x=-164*.1/2,this._expEff.parent||this.expEff.addChild(this._expEff),this._expEff.playFile(PATH_EFF+"doubleExpEff",-1)):this._expEff&&(this._expEff.destroy(),this._expEff=null),this.expTxt.textFlow=TextUtils.generateTextFlow("|C:"+(t>0?16750848:3532333)+"&T:"+copyControl.expEff*(t>0?2:1)+"|"+LangMgr.getValueByKey("guanHour")),this.mapName0.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("showLevel",copyControl.guanqiaID)),this.upDataGuanqia()},e.prototype.upDataGuanqia=function(){var t=copyControl.guanqiaID;t>=0&&MapControl.sceneInHook()?(this.upDataExpMcBall(copyControl.currentEnergy,copyControl.energy),copyControl.energy&&copyControl.currentEnergy>=copyControl.energy?this.guanQicMc&&!this.guanQicMc.parent&&(this.guanQicMc.playFile(PATH_EFF+"guankabtn",-1),this.guanqiaEff0.addChild(this.guanQicMc),this.guanqiaEff0.touchEnabled=this.guanQicMc.touchEnabled=!1):(copyControl.energy>0&&this.lastEnergy!=copyControl.currentEnergy&&-1!=this.lastEnergy&&this.playGuanQiaDoorMc(),DisplayUtils.removeFromParent(this.guanQicMc)),this.lastEnergy=copyControl.currentEnergy):(DisplayUtils.removeFromParent(this.guanQicMc),this.lastEnergy=-1),t<GameConst.AUTO_GUANQIA?this.pkBossBtnGroup.visible=!1:this.pkBossBtnGroup.visible=!0},e.prototype.removeGuanQiaEnergy=function(){DisplayUtils.removeFromParent(this.guanQicMc),copyControl.currentEnergy=0},e.prototype.upDataExpMcBall=function(t,e){this.setGuanQiaBar(t,e)},e.prototype.upDataWillBoss=function(t){t?(this.willBossPrompt=this.willBossPrompt||new GameMovieClip,this.willBossPrompt.playFile(PATH_EFF+"zaoyuBoss",-1),this.willBossPrompt.y=500,this.willBossPrompt.x=330,this.willBossPrompt.touchEnabled=!0,this.addEventTouchTap(this.willBossPrompt,this.onTap),this.addChild(this.willBossPrompt)):this.willBossPrompt&&(DisplayUtils.removeFromParent(this.willBossPrompt),this.removeEventTouchTap(this.willBossPrompt,this.onTap))},e.prototype.updateHeadRedPoint=function(){ActorControl.level>=30&&!ServerStorage.ins().getValue(3)?this.headRedPoint.visible=!0:this.headRedPoint.visible=!1},e.prototype.updateLevelBar=function(t){this.expChange(t)},e.prototype.publicBossRelive=function(t,e){if(void 0===e&&(e=""),t||!e||e==this.reliveBossLab.name){var i=bossControl.checkBossIconShow(),n=t&&i&&MapControl.sceneInHook()&&void 0!=this.newBossReliveArrowTarget;this.newBossReliveArrowTarget&&(this.newBossRelive.x=this.newBossReliveArrowTarget.x-this.newBossRelive.width,this.newBossRelive.y=this.newBossReliveArrowTarget.y+(42-this.newBossRelive.height)/2),portalControl.newBossRelive=this.newBossRelive.visible=n,this.reliveBossLab.name=t?e:"1",n&&(this.reliveBossLab.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("tipsUpdate",StringUtils.addColor(""+e,"#35e62d"))))}},e.prototype.sortRule=function(t,e){var i=DataCenter.ins().PortalConfig[t.id],n=DataCenter.ins().PortalConfig[e.id];return i.sort<n.sort?-1:1},e.prototype.sortBtnList=function(t){void 0===t&&(t=null);var e=-1;if(t){var i=DataCenter.ins().PortalConfig[t.id];if(!i)return;e=void 0==i.pos?1:i.pos}var n={};-1==e?(n[0]=[],n[1]=[[],[],[]],n[2]=[],n[3]=[],n[4]=[]):1!=e?n[e]=[]:n[e]=[[],[],[]];var o=DataCenter.ins().PortalConfig,s=this.ruleIdList;for(var r in o){var a=s[r];if(a.isShow){var i=o[r],l=void 0==i.pos?1:i.pos;(-1==e||e==l)&&(1==l?n[l][i.layer-1].push(a):n[l].push(a))}}for(var h in n)if("1"==h)for(var u in n[h])n[h][u].sort(this.sortRule);else n[h].sort(this.sortRule);var p,c,d=GlobalModel.iconsIsLeft?0:this.width-156,g=0,m=0,f=0,v=0;if(-1==e||1==e){c=n[1];for(var y=c[2].length,C=0;C<c.length;C++){C>v?(v=C,m=0):2==C&&(v=C,m=0);for(var h=0;h<c[C].length;h++)p=c[C][h].tar,p.parent.setChildIndex(p,0),p.x=GlobalModel.iconsIsLeft?d+70*m:d-70*m,p.y=g+80*v,m+=1,m>5&&(y>0&&1==v&&2!=C?(v+=Math.ceil(y/6),m=y%6,0==m&&v++,y=0):(v+=1,m=0))}}if(-1==e||2==e){m=0,f=0,c=n[2];for(var h=0;h<c.length;h++){var a=c[h];p=a.tar,p.parent.setChildIndex(p,f),f+=1,a.getConfig().noMove||(p.left=10+80*(m/4>>0),p.top=(GlobalModel.iconsIsLeft?550:500)-m%4*70,m++)}}if(-1==e||3==e){m=0,f=0,c=n[3];for(var h=0;h<c.length;h++){var a=c[h];p=a.tar,a instanceof BossPortalIcon&&(this.newBossReliveArrowTarget=p),p.parent.setChildIndex(p,f),f+=1,a.getConfig().noMove||(p.right=0,p.bottom=300+m*p.height,m++)}}if(-1==e||0==e){m=0,f=0,c=n[0];for(var T=0,h=0;h<c.length;h++){var a=c[h];a.getConfig().noMove||T++}for(var w=StageUtils.ins().getWidth()-75*T>>1,h=0;h<c.length;h++){var a=c[h];p=a.tar,a instanceof BossPortalIcon&&(this.newBossReliveArrowTarget=p),p.parent.setChildIndex(p,f),f+=1,a.getConfig().noMove||(p.right=w+75*m-20,p.bottom=100,m++)}}if(-1==e||4==e){m=0,c=n[4];for(var h=0;h<c.length;h++)p=c[h].tar,p.parent.setChildIndex(p,m),m+=1}},e.prototype.addExpFlyMc=function(t){var e=this;if(16!=MapControl.copyType){if(!copyControl.checkGuanqiaIconShow())return void copyControl.dispatchAddEnergy();var i=new eui.Image;i.source="point",i.anchorOffsetX=20,i.anchorOffsetY=20;var n=UIMgr.gameScene.map,o=this.localToGlobal();n.globalToLocal(o.x,o.y,o),i.x=t.x-o.x,i.y=t.y-o.y,this.addChild(i);var s=this.groupGuanqia.x+60,r=this.groupGuanqia.y+60,a=egret.Tween.get(i);a.to({x:s,y:r,alpha:.5},600).call(function(){copyControl.dispatchAddEnergy(),e.removeChild(i),egret.Tween.removeTweens(i)},this);var l=egret.Tween.get(i,{loop:!0});l.to({rotation:i.rotation+360},800)}},e.prototype.playGuanQiaDoorMc=function(){this.eyesMc||(this.eyesMc=new GameMovieClip),this.eyesMc.parent||this.guanqiaEff1.addChild(this.eyesMc),this.eyesMc.playFile(PATH_EFF+"guankaeye",1)},e.prototype.warmWord=function(t){var e=this;t?MapControl.sceneInHook()&&(this.bossWarmMc=this.bossWarmMc||new GameMovieClip,this.bossWarmMc.touchEnabled=!1,this.mcGroup.addChildAt(this.bossWarmMc,0),this.mcGroup.visible=!0,this.aniShadow(),this.bossWarmMc.playFile(PATH_EFF+"bosscaution",2,function(){e.removeShadow()}),this.removeGuanQiaEnergy()):(this.mcGroup.visible=!1,egret.Tween.removeTweens(this.alphaGroup),this.bossWarmMc&&(DisplayUtils.removeFromParent(this.bossWarmMc),this.bossWarmMc=null))},e.prototype.aniShadow=function(){var t=this;this.warmImage.visible=!0;var e=egret.Tween.get(this.warmImage);this.warmImage.alpha=.23,e.to({alpha:1},300).wait(2200).to({alpha:0},350).call(function(){egret.Tween.removeTweens(t.warmImage)}),this.levelNum.text=copyControl.guanqiaID+"",this.alphaGroup.alpha=.2,egret.Tween.removeTweens(this.alphaGroup),egret.Tween.get(this.alphaGroup,{loop:!0}).to({alpha:1},625).to({alpha:.2},625),TimerMgr.ins().doTimer(3500,1,this.removeShadow,this)},e.prototype.removeShadow=function(){this.warmImage.visible=!1,this.mcGroup.visible=!1,egret.Tween.removeTweens(this.alphaGroup),TimerMgr.ins().remove(this.removeShadow,this)},e.prototype.upDataVipBtnRedPoint=function(){this.redPointVip0.visible=vipControl.getVipState()},e.prototype.setDieGuide=function(t){switch(t){case DieGuide.RECHARGE:this.preRecharge=this.recharge.visible=!0,this.cz.source="swyd_firstrecharge_png"}},e.prototype.setGuanQiaBar=function(t,e){var i=t,n=e;i>=n&&(i=n),this.guanqiaBar.value=i,this.guanqiaBar.maximum=n,this.guanqiaBar.labelFunction=function(){return""}},e.prototype.GuanQiaEffLogic=function(){var t=this;if(this.guanqiaBtn&&0==copyControl.showAutoPk){if(copyControl.showAutoPk=1,!this.arrow){this.arrow=new GuideArrow,this.arrow.touchEnabled=!1,this.arrow.lab.text=LangMgr.getValueByKey("tipsClickCh"),this.addChild(this.arrow);var e=this.guanqiaBtn.localToGlobal();this.globalToLocal(e.x,e.y,e),this.arrow.x=e.x,this.arrow.y=e.y+this.guanqiaBtn.height/2,this.eff||(this.eff=new GameMovieClip,this.eff.playFile(PATH_EFF+"guideff",-1),this.groupGuanqia.addChild(this.eff),this.eff.x=this.guanqiaBtn.x+this.guanqiaBtn.width/2,this.eff.y=this.guanqiaBtn.y+this.guanqiaBtn.height/2),egret.Tween.get(this.arrow,{loop:!0}).to({x:this.arrow.x+40},1e3).to({x:this.arrow.x},1e3),egret.Tween.get(this,{loop:!1}).wait(5e3).call(function(){copyControl.showAutoPk=-1,DisplayUtils.removeFromParent(t.eff),DisplayUtils.removeFromParent(t.arrow),t.arrow&&egret.Tween.removeTweens(t.arrow),t.arrow=null,t.eff=null})}}else if(this.pkBossBtnGroup&&0==copyControl.showAutoPk2&&(copyControl.showAutoPk2=1,!this.arrow)){this.arrow=new GuideArrow,this.arrow.touchEnabled=!1,this.arrow.lab.text=LangMgr.getValueByKey("tipsClickAutoCh"),this.addChild(this.arrow);var e=this.pkBossBtnGroup.localToGlobal();this.globalToLocal(e.x,e.y,e),this.arrow.x=e.x,this.arrow.y=e.y+this.pkBossBtnGroup.height/2,this.eff||(this.eff=new GameMovieClip,this.eff.playFile(PATH_EFF+"guideff",-1),this.groupGuanqia.addChild(this.eff),this.eff.x=this.pkBossBtnGroup.x+this.pkBossBtnGroup.width/2,this.eff.y=this.pkBossBtnGroup.y+this.pkBossBtnGroup.height/2),egret.Tween.get(this.arrow,{loop:!0}).to({x:this.arrow.x+40},1e3).to({x:this.arrow.x},1e3),egret.Tween.get(this,{loop:!1}).wait(5e3).call(function(){copyControl.showAutoPk2=-1,DisplayUtils.removeFromParent(t.eff),DisplayUtils.removeFromParent(t.arrow),t.arrow&&egret.Tween.removeTweens(t.arrow),t.arrow=null,t.eff=null})}},e.prototype.GuanQiacleanEff=function(){copyControl.showAutoPk=-1,copyControl.showAutoPk2=-1,DisplayUtils.removeFromParent(this.eff),DisplayUtils.removeFromParent(this.arrow),this.arrow&&egret.Tween.removeTweens(this.arrow),this.arrow=null,this.eff=null},e.prototype.showFlower=function(){return this.flowerPanel?(this.flowerPanel.parent||this.flower.addChild(this.flowerPanel),void this.flowerPanel.showEffect()):(this.flowerPanel=new FlowerPanel,void this.flower.addChild(this.flowerPanel))},e.prototype.removeFlower=function(){DisplayUtils.removeFromParent(this.flowerPanel)},e.prototype.getRuleIdTar=function(t){return this.ruleIdList[t]},e.prototype.hasBottomIcon=function(){return this.downSortBtn.numChildren>0},e.prototype.hasRedPack=function(){return this.hongbao.numChildren>0},e.prototype.updateYbShow=function(){this.ybTime&&(this.ybTime.visible=equipControl.getYbOverTime(),this.ybTime.visible||this.resetYbTime())},e.prototype.clickYbShow=function(){this.tick=0,this.timelabelGroup.visible=!0,TimerMgr.ins().remove(this.timerYbShow,this),TimerMgr.ins().doTimer(1e3,this.secondYbTime,this.timerYbShow,this),this.timerYbShow()},e.prototype.timerYbShow=function(){if(this.ybTime){var t=equipControl.ybTimers-GameServer.serverTime;if(this.ybTime.visible=equipControl.getYbOverTime(),!this.ybTime.visible||this.tick>=this.secondYbTime)return void this.resetYbTime();t=Math.floor(t/1e3);var e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3);this.timelabel0.text=LangMgr.getValueByKey("doublegoldcard")+e,this.tick++}},e.prototype.resetYbTime=function(){this.tick=0,this.timelabelGroup.visible=!1,TimerMgr.ins().remove(this.timerYbShow,this)},e.prototype.destoryView=function(){},__decorate([callLater],e.prototype,"initData",null),e}(BaseEuiView);__reflect(PortalView.prototype,"PortalView");var PrestigeControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._prestigeBack=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downPrestigeBack=function(t){this._prestigeBack=t,EventMgr.ins().dispatch(188)},Object.defineProperty(e.prototype,"prestigeBack",{get:function(){return this._prestigeBack},enumerable:!0,configurable:!0}),e.prototype.upFindPrestige=function(){},e.prototype.getPrestigeCfg=function(t){for(var e=Object.keys(DataCenter.ins().PrestigeLevelConfig).length,i=1;e>=i;i++)if(t<DataCenter.ins().PrestigeLevelConfig[i].exp)return DataCenter.ins().PrestigeLevelConfig[i-1];return DataCenter.ins().PrestigeLevelConfig[t?e:1]},Object.defineProperty(e.prototype,"isOpen",{get:function(){return ActorControl.level<DataCenter.ins().PrestigeBaseConfig.openLevel||GameServer.serverOpenDay<DataCenter.ins().PrestigeBaseConfig.openDay-1?!1:!0},enumerable:!0,configurable:!0}),__decorate([down(1,[3])],e.prototype,"downPrestigeBack",null),__decorate([up(2)],e.prototype,"upFindPrestige",null),e=__decorate([protocolsId(66)],e)}(BaseSystem);__reflect(PrestigeControl.prototype,"PrestigeControl");var PrestigeOverView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PrestigeOverViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=PrestigeItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onOtherClose),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onOtherClose),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onOtherClose)},e.prototype.update=function(){for(var t=[],e=Object.keys(DataCenter.ins().PrestigeLevelConfig).length,i=1;e>=i;i++)t.push(DataCenter.ins().PrestigeLevelConfig[i]);this.list.dataProvider=new eui.ArrayCollection(t.reverse())},e.prototype.onOtherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(PrestigeOverView.prototype,"PrestigeOverView");var PrestigePanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.findItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.findItemTxt.text),this.overViewTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.overViewTxt.text)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(464,this.update),this.addCustomEvent(188,this.updateBack),this.addCustomEvent(478,this.openOtherPlayerView),this.addCustomEvent(220,this.updateRank),this.update(),this.updateBack(),rankControl.upGetRankingData(22),this.updateRank(rankControl.getRankModel(22))},e.prototype.close=function(){this.removeEffect(),this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this._topThree&&(this._topThree.length=0),this._topThree=null},e.prototype.updateRank=function(t){if(!t||22==t.type){var e=void 0,i=void 0,n=t?t.getDataList():null,o=n?n.length:0;this._topThree=[];for(var s=1;3>=s;s++)i=s-1,o>=s?(e=n[i],this["name"+i].text=e.player,this._topThree[i]=e.id,this.getRole(s).name=e.id+"",rankOtherUserControl.upFindPlayer(e.id)):(this.getRole(s).data=null,this["name"+i].text=LangMgr.getValueByKey("notAvailable"));i=this._topThree.indexOf(ActorControl.actorID),this.desc.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().PrestigeBaseConfig.skillTips[-1==i?0:i+1])}},e.prototype.update=function(){this.prestigeCfg=prestigeControl.getPrestigeCfg(ActorControl.prestige);var t=this.prestigeCfg.level==Object.keys(DataCenter.ins().PrestigeLevelConfig).length;this.notMaxGroup.visible=!t,this.maxShowGroup.visible=t;var e=[];for(var i in this.prestigeCfg.attr)e.push(new AttributeData(this.prestigeCfg.attr[i].type,this.prestigeCfg.attr[i].value));var n;if(t)this.maxCurAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(e,0,1,"："));else{this.curAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(e,0,1,"：")),e=[],n=DataCenter.ins().PrestigeLevelConfig[this.prestigeCfg.level+1];for(var i in n.attr)e.push(new AttributeData(n.attr[i].type,n.attr[i].value));this.nextAtt.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(e,0,1,"："))}this.prestigeCfg.retrieve?this.info.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().PrestigeBaseConfig.recycle.replace("{0}",this.prestigeCfg.retrieve+"")):this.info.text="",this.expBar.maximum=n?n.exp:this.prestigeCfg.exp,this.expBar.value=ActorControl.prestige,this.expLabel.text=ActorControl.prestige+"/"+(ActorControl.prestige>this.expBar.maximum?"???":this.expBar.maximum),this.myTitle.source=this.prestigeCfg.res},e.prototype.updateBack=function(){this.findItemTxt.visible=prestigeControl.prestigeBack>0,this.findItemTxt.visible?(this._backEff||(this._backEff=ObjectPool.pop("GameMovieClip")),this._backEff.parent||(this.findItemTxt.parent.addChild(this._backEff),this._backEff.x=this.findItemTxt.x+this.findItemTxt.width/2,this._backEff.y=this.findItemTxt.y+this.findItemTxt.height/2,this._backEff.touchEnabled=!1,this._backEff.scaleY=.5,this._backEff.scaleX=.6),this._backEff.isPlaying||this._backEff.playFile(PATH_EFF+"chargeff1",-1)):this.removeEffect()},e.prototype.removeEffect=function(){this._backEff&&(DisplayUtils.removeFromParent(this._backEff),this._backEff.destroy(),this._backEff=null)},e.prototype.onTouch=function(t){switch(t.target){case this.getItemTxt:warnControl.setBuyGoodsWarn(14);break;case this.findItemTxt:warnControl.show(LangMgr.getValueByKey("liliTips1",prestigeControl.prestigeBack*DataCenter.ins().PrestigeBaseConfig.cost,prestigeControl.prestigeBack),function(){ActorControl.yb<prestigeControl.prestigeBack*DataCenter.ins().PrestigeBaseConfig.cost?tipsControl.showTips(LangMgr.getValueByKey("liliTips2")):prestigeControl.upFindPrestige()},this);break;case this.overViewTxt:UIMgr.ins().open(PrestigeOverView);break;case this.closeBtn:UIMgr.ins().close(ExperienceView);break;case this.title0:UIMgr.ins().open(PrestigeTitleTipsView,DataCenter.ins().PrestigeBaseConfig.topThree[0]);break;case this.title1:UIMgr.ins().open(PrestigeTitleTipsView,DataCenter.ins().PrestigeBaseConfig.topThree[1]);break;case this.title2:UIMgr.ins().open(PrestigeTitleTipsView,DataCenter.ins().PrestigeBaseConfig.topThree[2]);break;case this.help:HelpControl.openHelpWin(24);break;case this.role1:case this.role2:case this.role3:this._openOtherWin=!0,rankOtherUserControl.upFindPlayer(Number(t.target.name));break;case this.checkBtn:UIMgr.ins().open(RankingView,22)}},e.prototype.openOtherPlayerView=function(t){if(this._openOtherWin)UIMgr.ins().open(RankRoleView,t),this._openOtherWin=!1;else{var e=this._topThree.indexOf(t.id);if(0>e)return;var i=t.roleData[0];this.getRole(e+1).data=i}},e.prototype.getRole=function(t){return this["role"+t]},e}(BasePanel);__reflect(PrestigePanel.prototype,"PrestigePanel");var PrestigeTitleTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="PrestigeTitleTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onOtherClose),this.title.source=t[0].res,this.content.textFlow=TextUtils.generateTextFlow1(t[0].des)},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onOtherClose)},e.prototype.onOtherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(PrestigeTitleTipsView.prototype,"PrestigeTitleTipsView");var PrestigeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="PrestigeItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.title.source=t.res,this.value.text=t.exp+""},e}(BaseItemRender);__reflect(PrestigeItemRenderer.prototype,"PrestigeItemRenderer");var RankControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rankModel=[],e.rankTypeList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.upGetAllPraiseData()},e.prototype.upGetRankingData=function(t){return[t]},e.prototype.downRankingData=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=this.getRankModel(t);o.selfPos=e,o.parser(i[t]),EventMgr.ins().dispatch(220,o)},e.prototype.upGetPraiseData=function(t){return void 0===t&&(t=0),[t]},e.prototype.downPraiseData=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=rankControl.getRankModel(t);o.praise.praiseTime=e,o.praise.init(i),EventMgr.ins().dispatch(221,o.type)},e.prototype.upGetAllPraiseData=function(){},e.prototype.downAllPraiseData=function(t){for(var e=0;e<t.length;e++){var i=rankControl.getRankModel(t[e][0]);i.praise.praiseTime=t[e][1]}EventMgr.ins().dispatch(223)},e.prototype.upPraise=function(t){return[t]},e.prototype.downPraiseResult=function(t,e){var i=rankControl.getRankModel(t);i.praise.praiseTime=e,EventMgr.ins().dispatch(222,[i.type,i.praise.getLastMobaiNum()])},e.prototype.getRankModel=function(t){if(!(t in this.rankModel)){var e=void 0;e=0==t?RankDataPowerVo:2==t?RankDataSkirmishVo:3==t?RankDataPassVo:4==t?RankDataCopyVo:5==t?RankDataLevelVo:7==t?RankDataJobZsVo:8==t?RankDataJobFsVo:9==t?RankDataJobDsVo:10==t?RankDataLiLianVo:11==t?RankDataLadderVo:12==t?RankDataCastVo:14==t?RankDataDragonVo:15==t?RankDataXunZhangVo:16==t?RankDataWingVo:17==t?RankDataBookVo:18==t?RankDataTransfromVo:19==t?RankDataScoreVo:22==t?RankDataPrestigeVo:23==t?RankDataXiaYiVo:25==t?RankDataRuneVo:26==t?RankDataSpecialRingVo:RankDataBaseVo,this.rankModel[t]=new RankModel(t,e)}return this.rankModel[t]},e.prototype.canPraiseByType=function(t){return!1},e.prototype.canPraiseInAll=function(){this.rankTypeList.length<=0&&(this.rankTypeList=[0,2,5,10,15]);for(var t=0,e=this.rankModel;t<e.length;t++){var i=e[t];if(i&&this.rankTypeList.lastIndexOf(i.type)>-1&&i.praise&&i.praise.praiseTime<1)return!0}return!1},__decorate([up(1,[2])],e.prototype,"upGetRankingData",null),__decorate([down(1,[2,2,ByteConst.RankDataCommons,[],ByteConst.RankDataSkirmishVos,ByteConst.RankDataPassVos,ByteConst.RankDataPassVos,ByteConst.RankDataLevelVos,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataLadderVos,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataXiaYiVos,ByteConst.RankDataCommons,ByteConst.RankDataCommons,ByteConst.RankDataCommons])],e.prototype,"downRankingData",null),__decorate([up(2,[2])],e.prototype,"upGetPraiseData",null),__decorate([down(2,[2,2].concat(ByteConst.RankPraiseVos))],e.prototype,"downPraiseData",null),__decorate([up(4)],e.prototype,"upGetAllPraiseData",null),__decorate([down(4,[[2,2]])],e.prototype,"downAllPraiseData",null),__decorate([up(3,[2])],e.prototype,"upPraise",null),__decorate([down(3,[2,2])],e.prototype,"downPraiseResult",null),e=__decorate([protocolsId(18)],e)}(BaseSystem);__reflect(RankControl.prototype,"RankControl");var RankModel=function(){function t(t,e){this.type=t,this._dataClass=e,this._dataList=[],this.praise=new RankPraiseVo}return t.prototype.getDataList=function(t){return void 0===t&&(t=-1),-1==t?this._dataList:this._dataList[t]},t.prototype.parser=function(t){this._dataList.length=t.length;for(var e=0;e<t.length;++e)e in this._dataList||(this._dataList[e]=new this._dataClass),this._dataList[e].parser(t[e])},t}();__reflect(RankModel.prototype,"RankModel");var RankOtherUserControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upFindPlayer=function(t,e){return void 0===e&&(e=0),[t,e]},e.prototype.downPlayerResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=rankOtherUserControl.otherPlayerData;i||(i=new OtherPlayerData),i.init(t),EventMgr.ins().dispatch(478,i)},__decorate([up(16,[3,3])],e.prototype,"upFindPlayer",null),__decorate([down(16,ByteConst.OtherPlayerDatas.slice())],e.prototype,"downPlayerResult",null),e=__decorate([protocolsId(255)],e)}(BaseSystem);__reflect(RankOtherUserControl.prototype,"RankOtherUserControl");var OtherPlayerData=function(){function t(){this.roleData=[],this.lilianLv=0,this.zhanlingID=0,this.zhanlingLevel=0,this.darkDrug=[],this.darkEquips=[],this.warriorDataDict={},this.warriorEquipDataDict={},this.warriorFuzhuList=[],this.Thirteenequips={}}return t.prototype.init=function(t){this.id=t[0],this.serverId=t[1],this.name=t[2],this.level=t[3],this.vipLevel=t[4],this.zhuan=t[5],this.lilianLv=t[6],this.ce=t[7],this.guildId=t[8],this.guildName=t[9],this.zhanlingID=t[10],this.zhanlingLevel=t[11];for(var e=[0,0],i=[],n=0;n<t[12].length;n++)this.roleData[n]=new RoleModel,this.roleData[n].init(t[12][n]),e[0]+=this.roleData[n].getExAtt(64),e[0]+=this.roleData[n].getExAtt(21),e[1]+=this.roleData[n].getExAtt(22),e[1]+=this.roleData[n].getExAtt(65);
for(var n=0;t[13].length>n;n++){var o=t[13][n],s=o[0];this.darkDrug[s]||(this.darkDrug[s]={});var r=o[1],a=o[2];if(this.darkDrug[s][DataCenter.ins().DarkEquipBaConfig.AItemId]=r,this.darkDrug[s][DataCenter.ins().DarkEquipBaConfig.BItemId]=a,this.darkEquips[s]||(this.darkEquips[s]={}),!CommonUtils.getObjectLength(this.darkEquips[s]))for(var l=0;13>l;l++)this.darkEquips[s][l]||(this.darkEquips[s][l]=new DarkEquipDataVo(l,0,0));for(var h=0;o[3].length>h;h++){var u=o[3][h][0],p=o[3][h][1],c=o[3][h][2];this.darkEquips[s][u]?(this.darkEquips[s][u].level=p,this.darkEquips[s][u].itemId=c):this.darkEquips[s][u]=new DarkEquipDataVo(u,p,c)}}for(var n=0;t[14].length>n;n++){this.teTengInfo||(this.teTengInfo={});var s=t[14][n][0];this.ttSkillInfo||(this.ttSkillInfo=[]),this.ttSkillInfo[s]=t[14][n][1]>0,this.teTengInfo[s]={};for(var d=this.teTengInfo[s],h=0;t[14][n][2].length>h;h++){var g=new TotemVo;g.init(t[14][n][2][h]),d[g.id]=g}}this.warriorBattingId=t[15],this.warriorEquipStrenExp=t[16],this.warriorFuzhuList=[];for(var n=0;n<t[17].length;++n){var m=t[17][n];this.warriorFuzhuList.push(m)}for(var n=0;n<t[18].length;++n){var f=t[18][n],v=new WarriorVo;v.id=f[0],v.strenLev=f[1],v.breachLev=f[2],v.useDrugANum=f[3],v.useDrugBNum=f[4],v.strenExp=f[5],this.warriorDataDict[v.id]=v}for(var n=0;n<t[19].length;++n)for(var y=t[19][n][0],C=t[19][n][1],h=0;h<C.length;++h){var T=new WarriorEquipVo;T.pos=C[h][0],T.itemId=C[h][1],T.strenLev=C[h][2],this.warriorEquipDataDict[y]||(this.warriorEquipDataDict[y]={}),this.warriorEquipDataDict[y][T.pos]=T}for(var n=0;t[20].length>n;n++){var w=t[20][n];i[n]||(i[n]={});for(var I=0;I<w.length;I++){var b=new DevourEquipInfoVo;b.pos=I,b.lv=w[I][0],b.soul=w[I][1],b.stone=w[I][2],b.maxsoule=b.lv<=0?0:DataCenter.ins().DevourEquipLevelConfig[b.pos][b.lv].soulMax+DataCenter.ins().DevourEquipDataConfig.stoneAddSoul*b.stone,i[n][I]=b}}this.devourEquips||(this.devourEquips=new DevourEquipItemDataVo),this.devourEquips.roledata=e,this.devourEquips.items=i;for(var n=0;t[21].length>n;n++){var D=t[21][n],B=this.Thirteenequips[n];B||(B=new ReincarnateStarEquipVo,B.zhuHuns=[],this.Thirteenequips[n]=B);for(var I=0;I<D.length;I++){var k=D[I][0],x=D[I][1];B.zhuHuns[k]=x}}this.devourEquips.thirteenequips=this.Thirteenequips},t}();__reflect(OtherPlayerData.prototype,"OtherPlayerData");var AmuseTarget0Panel7=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=t.call(this)||this;return n.openTime=[3,5,7],n.skinName="AmuseTarget0Panel7Skin",n.effs=[],n}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.go,this.onTap),this.addCustomEvent(423,this.updateBelongs),unionWarControl.upHeFuBelong(),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.go,this.onTap),this.removeCustomEvents();for(var i=0;i<this.effs.length;i++)this.effs[i]&&DisplayUtils.removeFromParent(this.effs[i]);this.effs=[]},e.prototype.onTap=function(t){switch(t.currentTarget){case this.go:0!=unionControl.guildID?(UIMgr.ins().close(MergeServerAmusementView),unionWarControl.upWinGuildInfo(),UIMgr.ins().close(UnionMapView),UIMgr.ins().open(UnionWarMainView)):tipsControl.showTips(LangMgr.getValueByKey("osaNoJoinGuild"))}},e.prototype.updateData=function(){this.actInfo.text=DataCenter.ins().AmusementBtnConfig[this.activityID].acDesc;var t,e,i=DataCenter.ins().UnionBattleConstConfig.hefuOpen,n=DateUtils.formatMiniDateTime(GameServer._serverHeZeroTime),o="",s=0;for(e=0;e<i.length;e++){o.length>0&&(o+="、"),s=n+(i[e].day-1)*DateUtils.MS_PER_DAY,t=new Date(s),t.setHours(i[e].hours,i[e].min||0,0,0);var r=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()+"";o+=t.getMonth()+1+LangMgr.getValueByKey("activitMonth")+t.getDate()+LangMgr.getValueByKey("activitDayTime","")+t.getHours()+":"+r}this.actTime.text=o;var a,l,h,u=!1,p=0,c=0;for(e=0;e<i.length;e++)if(s=n+(i[e].day-1)*DateUtils.MS_PER_DAY,c=n+i[e].day*DateUtils.MS_PER_DAY,t=new Date(s),t.setHours(i[e].hours,i[e].min||0,0,0),l=new Date(c),l.setHours(0,0,0),0==e&&(a=t.getTime()),e==i.length-1&&(h=l.getTime()),GameServer.serverTime>=t.getTime()&&GameServer.serverTime<l.getTime()){u=!0,p=e;break}u?this.over.visible=!1:(this.over.visible=!0,GameServer.serverTime<a?this.over.text=LangMgr.getValueByKey("notOpen",""):GameServer.serverTime>=h?this.over.text=LangMgr.getValueByKey("osaEnd"):this.over.text=LangMgr.getValueByKey("notOpen","")),this.go.visible=!this.over.visible;var d=DataCenter.ins().UnionBattleConstConfig.hefuAward.leader,g=d.award;this.list0.itemRenderer=ItemBase,this.list1.itemRenderer=ItemBase,this.list2.itemRenderer=ItemBase,this.list0.dataProvider=new eui.ArrayCollection(g[0]),this.list1.dataProvider=new eui.ArrayCollection(g[1]),this.list2.dataProvider=new eui.ArrayCollection(g[2])},e.prototype.updateBelongs=function(){for(var t=0;3>t;t++)unionWarControl.GuildNameBelongs[t]?(this["guild"+t].visible=!0,this["guild"+t].text=LangMgr.getValueByKey("activitHome")+unionWarControl.GuildNameBelongs[t]):this["guild"+t].visible=!1},e}(BasePanel);__reflect(AmuseTarget0Panel7.prototype,"AmuseTarget0Panel7");var RankDataBookVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataBookVo.prototype,"RankDataBookVo");var RankDataCastVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataCastVo.prototype,"RankDataCastVo");var RankDataCopyVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(RankDataPassVo);__reflect(RankDataCopyVo.prototype,"RankDataCopyVo");var RankDataDragonVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataDragonVo.prototype,"RankDataDragonVo");var RankDataJobDsVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(RankDataPowerVo);__reflect(RankDataJobDsVo.prototype,"RankDataJobDsVo");var RankDataJobFsVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(RankDataPowerVo);__reflect(RankDataJobFsVo.prototype,"RankDataJobFsVo");var RankDataJobZsVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(RankDataPowerVo);__reflect(RankDataJobZsVo.prototype,"RankDataJobZsVo");var RankDataLadderVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.init=function(t){this.id=t[0],this.player=t[1],this.challgeLevel=t[2],this.challgeId=t[3],this.winNum=t[4],this.job=t[5],this.sex=t[6]},e}(RankDataBaseVo);__reflect(RankDataLadderVo.prototype,"RankDataLadderVo");var RankDataLevelVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zhuan=t[4],this.vip=t[5],this.month=t[6]},e}(RankDataBaseVo);__reflect(RankDataLevelVo.prototype,"RankDataLevelVo");var RankDataLiLianVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zhuan=t[4],this.vip=t[5],this.month=t[6],this.count=t[7][0],this.exp=t[7][1]},e}(RankDataBaseVo);__reflect(RankDataLiLianVo.prototype,"RankDataLiLianVo");var AmuseTarget0Panel8=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=t.call(this)||this;return n._time=0,n.skinName="AmuseTarget0Panel8Skin",n}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.pay0,this.onTap),this.updateData(),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.pay0:payControl.checkOpenWin()}},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(t.startTime/1e3-GameServer.serverTime/1e3),i=Math.floor(t.endTime/1e3-GameServer.serverTime/1e3);e>=0?this.actTime1.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime1.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime1.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3);var n=DataCenter.ins().AmusementBtnConfig[this.activityID];this.title.source=n.title,this.actDesc.textFlow=TextUtils.generateTextFlow1(n.acDesc)},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime1.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e}(BasePanel);__reflect(AmuseTarget0Panel8.prototype,"AmuseTarget0Panel8");var AmuseTarget0Panel9=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._time=0,e._angles=[0,0,0,0,0,0,0],e._circleCenter={x:168,y:120},e._a=155,e._b=80,e._angle=.1,e}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementBtnConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget0Panel9Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(),this.wing&&(this.wing.source="jwing09_png"),this.addEventTouchTap(this.pay0,this.onTap),this.updateData(),TimerMgr.ins().doTimer(1e3,0,this.setTime,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this),this.resetBalls()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.pay0:var e=DataCenter.ins().AmusementBtnConfig[this.activityID];if(!e.jump)return;switch(e.jump[0]){case 1:if(ActorControl.level<DataCenter.ins().FeatherCommonConfig.openLevel)return void tipsControl.showTips(LangMgr.getValueByKey("roleTips7",DataCenter.ins().FeatherCommonConfig.openLevel));UIMgr.ins().open(e.jump[1],e.jump[2],0);break;case 2:if(!flameMarkControl.checkOpen())return void tipsControl.showTips(LangMgr.getValueByKey("osaFireOpen",DataCenter.ins().FlameMarkConfig.openLevel));UIMgr.ins().open(e.jump[1],e.jump[2]);break;default:UIMgr.ins().open(e.jump[1],e.jump[2])}}},e.prototype.updateData=function(){var t=amusementControl.getAmusementDataById(this.activityID),e=Math.floor(t.startTime/1e3-GameServer.serverTime/1e3),i=Math.floor(t.endTime/1e3-GameServer.serverTime/1e3);e>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=i?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(i,DateUtils.TIME_FORMAT_5,3);var n=DataCenter.ins().AmusementBtnConfig[this.activityID];this.title.source=n.title,this.actInfo.textFlow=TextUtils.generateTextFlow1(n.acDesc);var o=DataCenter.ins().AmusementBtnConfig[this.activityID];switch(o.jump[0]){case 2:if(this.updateBalls(),this.redPoint.visible=!1,flameMarkControl.checkOpen()&&!flameMarkControl.isMax){var s=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv],r=backpackControl.getBagItemById(s.costItem),a=r?r.count:0;this.redPoint.visible=a>=s.costCount}}},e.prototype.setTime=function(){this._time>0&&(this._time-=1,this.actTime.text=DateUtils.getFormatBySecond(this._time,DateUtils.TIME_FORMAT_5,3))},e.prototype.updateBalls=function(){if(this.img&&this.img.parent){var t=7;if(t){this.resetBalls(),this._balls||(this._balls=[],TimerMgr.ins().doTimer(51,0,this.doCircle,this)),this._circleCenter.x=this.img.width/2,this._circleCenter.y=this.img.height/2+25;for(var e=void 0,i=2*Math.PI/t,n=0;t>n;n++)e=ObjectPool.pop("GameMovieClip"),this.img.parent.addChild(e),this._angles[n]=i*n,e.x=this._a*Math.cos(i*n)+this._circleCenter.x,e.y=this._b*Math.sin(i*n)+this._circleCenter.y,this._balls.push(e),e.playFile(PATH_EFF+"lymarkeff",-1)}}},e.prototype.doCircle=function(){if(!this._balls)return void TimerMgr.ins().removeAll(this);if(this.img&&this.img.parent)for(var t,e,i=this._balls.length,n=0,o=0,s=0;i>s;s++)t=this._balls[s],t.x=this._a*Math.cos(this._angles[s])+this._circleCenter.x,t.y=this._b*Math.sin(this._angles[s])+this._circleCenter.y,this._angles[s]+=this._angle,this._angles[s]=this._angles[s]%(2*Math.PI),e=t.parent,e&&(n=e.getChildIndex(this.img),o=e.getChildIndex(t),this._angles[s]>=2.5&&this._angles[s]<=6?o>n&&e.addChildAt(t,3):n>o&&e.addChildAt(t,e.numChildren))},e.prototype.resetBalls=function(){if(TimerMgr.ins().removeAll(this),this._balls){for(var t=this._balls.length,e=0;t>e;e++)this._balls[e].destroy(),this._balls[e]=null;this._balls.length=0,this._balls=null}},e}(BasePanel);__reflect(AmuseTarget0Panel9.prototype,"AmuseTarget0Panel9");var RankDataPrestigeVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.weiWang=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataPrestigeVo.prototype,"RankDataPrestigeVo");var RankDataRuneVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataRuneVo.prototype,"RankDataRuneVo");var RankDataScoreVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataScoreVo.prototype,"RankDataScoreVo");var RankDataSkirmishVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.job=t[3],this.sex=t[4],this.level=t[5],this.zhuan=t[6],this.vip=t[7],this.count=t[8],this.month=t[9];for(var e in DataCenter.ins().SkirmishRankConfig){var i=DataCenter.ins().SkirmishRankConfig[e];if(i.minRank<=this.pos&&this.pos<=i.maxRank)return this.reward=i.rewards[0].count,void(this.money=i.rewards[1].count)}this.money=this.reward=0},e}(RankDataBaseVo);__reflect(RankDataSkirmishVo.prototype,"RankDataSkirmishVo");var RankDataSpecialRingVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataSpecialRingVo.prototype,"RankDataSpecialRingVo");var RankDataTransfromVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataTransfromVo.prototype,"RankDataTransfromVo");var WeaponsSoulSuitInfoVo=function(){function t(){this.id=0,this.level=0,this.attr={},this.ex_attr={}}return t.prototype.setInfo=function(t){},t}();__reflect(WeaponsSoulSuitInfoVo.prototype,"WeaponsSoulSuitInfoVo");var RankDataWingVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zslevel=t[4],this.viplevel=t[5],this.monthCard=t[6],this.value=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataWingVo.prototype,"RankDataWingVo");var RankDataXiaYiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.vip=t[3],this.count=t[4]},e}(RankDataBaseVo);__reflect(RankDataXiaYiVo.prototype,"RankDataXiaYiVo");var RankDataXunZhangVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.parser=function(t){this.pos=t[0],this.id=t[1],this.player=t[2],this.level=t[3],this.zhuan=t[4],this.vip=t[5],this.month=t[6],this.count=t[7][0]},e}(RankDataBaseVo);__reflect(RankDataXunZhangVo.prototype,"RankDataXunZhangVo");var RankPraiseVo=function(){function t(){this.subRole=[]}return t.prototype.getLastMobaiNum=function(){var t=(reincarnateControl.lv>0?1e3*reincarnateControl.lv:ActorControl.level,999);return t-this.praiseTime},t.prototype.init=function(t){if(this.id=t[0],this.id>0){this.name=t[1],this.ce=t[2],this.level=t[3],this.zhuan=t[4],this.vipLevel=t[5];for(var e=0;e<t[6].length;e++)this.subRole[e]=new RankSubRoleVo,this.subRole[e].init(t[6][e])}},t.prototype.getRoleByJob=function(t){if(t>0)for(var e in this.subRole)if(this.subRole[e].job==t)return this.subRole[e];return this.subRole[0]},t}();__reflect(RankPraiseVo.prototype,"RankPraiseVo");var RankFbLevelsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FbRankSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.title.source="fbRankSkin_"+t[0];var i=rankControl.rankModel[t[0]];this.rank.text=0<i.selfPos&&i.selfPos<=1e3?i.selfPos+"":LangMgr.getValueByKey("guanNoRank"),this.list.itemRenderer=RankFbLevelsItemRenderer,this.list.dataProvider=new eui.ArrayCollection(i.getDataList()),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(RankFbLevelsView.prototype,"RankFbLevelsView");var RankingView=function(t){function e(){var e=t.call(this)||this;return e.firstId=0,e.skinName="RankingViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.praiseBtn.touchEnabled=!0,this.praiseBtn.icon="phb_2",this.list.itemRenderer=RankItemRenderer,this.tab.itemRenderer=RankTabItemRenderer,this.mobaiEff=new GameMovieClip,this.mobaiEff.x=35,this.mobaiEff.y=-35,this.mobaiEff.scaleX=this.mobaiEff.scaleY=.65},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.praiseBtn,this.onClick),this.addEventTouchTap(this.list,this.onClick),this.addEventChange(this.tab,this.onClick),this.addEventTouchTap(this.firstGroup,this.onClick),this.addEventTouchTap(this.role1,this.onClick),this.addEventTouchTap(this.role2,this.onClick),this.addEventTouchTap(this.role3,this.onClick),this.addEventTouchTap(this.help,this.onClick),this.setOpenType(void 0==t[0]?-1:t[0]),this.addCustomEvent(220,this.updateList),this.addCustomEvent(478,this.openOtherPlayerView),this.addCustomEvent(222,this.refushMoBaiStatu),this.addCustomEvent(221,this.updatePraise),this.addCustomEvent(223,this.updateTab),rankControl.upGetAllPraiseData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.role1.setRole(null),this.role2.setRole(null),this.role3.setRole(null),WatcherUtil.removeFromArrayCollection(this.tab.dataProvider)},e.prototype.updateList=function(t){if(t.type==this._type){this.selfPos.text=0<t.selfPos&&t.selfPos<=1e3?t.selfPos+"":LangMgr.getValueByKey("guanNoRank");var e=t.getDataList();if(this.list.dataProvider=new eui.ArrayCollection(e.slice(1)),this.refushMoBaiStatu(),this.refushFirstInfo(t.getDataList(0)),e&&!e.length?this.state.visible=!0:this.state.visible=!1,this.titleMcGroup.visible=this.titleImg.visible=this.firstGroup.visible=!this.state.visible,!this.state.visible){var i=this.tab.selectedItem,n=DataCenter.ins().TitleConfig[i.title]||{};this.titleImg.source=n.img,n.eff?(this.titleMc||(this.titleMc=ObjectPool.pop("GameMovieClip"),this.titleMc.x=0,this.titleMc.y=0,this.titleMc.scaleX=1.5,this.titleMc.scaleY=1.5,this.titleMcGroup.addChild(this.titleMc)),this.titleMc.playFile(PATH_EFF+n.eff,-1)):this.titleMc&&(this.titleMc.destroy(),this.titleMc=null)}}},e.prototype.refushFirstInfo=function(t){if(t){this.firstId=t.id,this.firstNameTxt.text=t.player,this.vip.visible=t.vip>0;var e="";if(15==rankControl.curType){var i=DataCenter.ins().ExperienceMedalConfig[t.count];e=i.type}else if(10==rankControl.curType){var i=DataCenter.ins().ExperienceKingLevelConfig[t.count];e=LangMgr.getValueByKey("rankWait",i.trainlevel,i.trainName)}else e=2==rankControl.curType?LangMgr.getValueByKey("rankType1",t.count):23==rankControl.curType?LangMgr.getValueByKey("equiCharmValue1",t.count):LangMgr.getValueByKey("numberLevel",t.level);22==rankControl.curType?(this.weiwang.visible=!0,this.weiwang.source=prestigeControl.getPrestigeCfg(t.weiWang).res,this.firstLevelTxt.visible=!1):(this.firstLevelTxt.visible=!0,this.weiwang.visible=!1),this.firstLevelTxt.text=e,this.lz0&&this.lz1&&this.lz0.parent&&this.lz1.parent&&(this.lz0.parent.removeChild(this.lz0),this.lz1.parent.removeChild(this.lz1),this.lz0=this.lz1=null)}else this.firstId=0,this.weiwang.visible=!1},e.prototype.updateValue=function(t,e,i){switch(e){case"vip":return;case"month":return;case"level":i=(t.zhuan?LangMgr.getValueByKey("numberRotation",t.zhuan):"")+LangMgr.getValueByKey("numberLevel",i);break;case"count":}this.firstLevelTxt.text=i},e.prototype.refushMoBaiStatu=function(){rankControl.canPraiseByType(this._type)?(this.praiseBtn.icon="phb_2",this.mobaiEff.playFile(PATH_EFF+"huoban",-1),this.mobai.addChild(this.mobaiEff)):(this.praiseBtn.icon="phb_23",DisplayUtils.removeFromParent(this.mobaiEff)),this.updateTab()},e.prototype.setOpenType=function(t){for(var e=this.tab.dataProvider,i=0,n=0;n<e.length;n++){var o=e.getItemAt(n);if(o.type==t){i=n;break}}this.setOpenIndex(i)},e.prototype.setOpenIndex=function(t){this.tab.selectedIndex=t;var e=this.tab.selectedItem;this._type=e.type,rankControl.curType=this._type,RankItemRenderer.dataFormat=e;var i=this.list.parent;i.stopAnimation(),this.list.scrollV=0,this.selfPos.text=null,this.list.dataProvider=null,this.list.itemRendererSkinName=e.skin||"RankItemPowerSkin",11==this._type?ladderControl.upGetRankInfo():rankControl.upGetRankingData(this._type),rankControl.upGetPraiseData(this._type)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.praiseBtn:rankControl.rankModel[this._type].praise.praiseTime<1?rankControl.upPraise(this._type):tipsControl.showTips(LangMgr.getValueByKey("rankTips1"));break;case this.list:this.list.selectedItem&&(this._openOtherWin=!0,rankOtherUserControl.upFindPlayer(this.list.selectedItem.id));break;case this.tab:this.setOpenIndex(this.tab.selectedIndex);break;case this.firstGroup:case this.role1:case this.role2:case this.role3:this.firstId&&(this._openOtherWin=!0,rankOtherUserControl.upFindPlayer(this.firstId));break;case this.help:HelpControl.openHelpWin(21)}},e.prototype.openOtherPlayerView=function(t){this._openOtherWin&&(this._openOtherWin=!1,UIMgr.ins().open(RankRoleView,t))},e.prototype.getRole=function(t){return this["role"+(t+1)]},e.prototype.updatePraise=function(t){if(rankControl.rankModel[t].praise.id>0){for(var e=0;3>e;e++)this.getRole(e).setSubRole(rankControl.rankModel[t].praise.subRole[e]);this.refushMoBaiStatu()}else for(var e=0;3>e;e++)this.getRole(e).setSubRole(null);this.updateTab()},e.prototype.updateTab=function(){for(var t=this.tab.selectedIndex,e=this.tab.dataProvider,i=e.source,n=0;n<i.length;n++){var o=i[n];e.itemUpdated(o)}this.tab.selectedIndex=t},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=ActorControl.level;return 60>i?(tipsControl.showTips(LangMgr.getValueByKey("rankTips2")),!1):!0},e}(BaseEuiView);__reflect(RankingView.prototype,"RankingView");var RankRoleAttrView=function(t){function e(){var e=t.call(this)||this;return e._lastX=0,e.proShowList=[2,3,4,5,6,7,19,56,67,69,13,26],e.skinName="RankRoleAttrViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._otherPlayerData=t[1],this.curRole=t[0],this.setRoleAttr(this.curRole);var i=this._otherPlayerData.roleData.length;i>1&&(this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchBegin(this.bg,this.onMove),this.addEventTouchEnd(this.bg,this.onMove)),this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.closeBtn,this.onClose),this.addEventTouchTap(this.bgClose,this.onClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this._otherPlayerData.roleData.length;i>1&&(this.removeEventTouchTap(this.leftBtn,this.onTouch),this.removeEventTouchTap(this.rightBtn,this.onTouch),this.removeEventTouchBegin(this.bg,this.onMove),this.removeEventTouchEnd(this.bg,this.onMove)),this.removeEventTouchEnd(this,this.otherClose),this.removeEventTouchTap(this.closeBtn,this.onClose),this.removeEventTouchTap(this.bgClose,this.onClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200)):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200))}},e.prototype.moveAttr=function(t){var e,i=egret.Tween.get(this.attrGroup);e=t>0?0:242,i.to({x:this.attrGroup.x+t,alpha:0},200).to({x:e},200).to({x:80,alpha:1},200)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.leftBtn:this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200));break;case this.rightBtn:this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200))}},e.prototype.setRoleAttr=function(t){var e=this._otherPlayerData.roleData[t];this.job.source="op_"+e.job;for(var i="",n=0,o=0,s=0;s<this.proShowList.length;s++){if(o=this.proShowList[s],n=e.attributeData[o],26==o&&(n=e.getExAtt(26)),o>1&&9>o)i+=7==o||8==o?n/100+"%":n;else{if(!(o>12&&15>o||o>15))continue;19==o&&(n+=e.getAtt(65),n+=1e4),i+=n/100+"%"}s<this.proShowList.length-1&&(i+="\n")}this.attr.text=i,this.setBtn()},e.prototype.setBtn=function(){var t=this._otherPlayerData.roleData.length;1==t?(this.leftBtn.visible=!1,this.rightBtn.visible=!1):t>1&&(0==this.curRole?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):1==this.curRole?(this.leftBtn.visible=!0,3>t?this.rightBtn.visible=!1:this.rightBtn.visible=!0):2==this.curRole&&(this.leftBtn.visible=!0,this.rightBtn.visible=!1))},e}(BaseEuiView);__reflect(RankRoleAttrView.prototype,"RankRoleAttrView");var RankRoleInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.curRole=0,e.beforeIndex=-1,e.showApproachEffDic={},e.name=LangMgr.getValueByKey("dressType1"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.touchEnabled=!1,this.touchChildren=!0,this.role0.touchEnabled=this.role0.touchChildren=!1,this.role1.touchEnabled=this.role1.touchChildren=!1,this.equips=[];for(var t=0;13>t;t++)this.equips[t]=this["item"+t],this.equips[t].touchEnabled=!0,this.equips[t].isShowJob(!1),this.equips[t].isShowTips(!1)},e.prototype.clear=function(){this.beforeIndex=-1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._otherPlayerData=t[0],this.addEventTouchTap(this.roleInfoItem0,this.onClick),this.addEventTouchTap(this.roleInfoItem1,this.onClick),this.addEventTouchTap(this.juesexiangxi,this.onClick),this.addEventTouchTap(this.AndianBtn,this.onClick),this.addEventTouchTap(this.warriorBtn,this.onClick),this.updateRing(),this.updataEquip(!1),this.updateSamsaraEquip(),this.clearChangeEff(),-1!=this.beforeIndex?this.roleChange(this.beforeIndex,this.curRole):(this.role0.setRole(this.getRole(this.curRole)),this._curRoleItem=this.role0,this.playRoleApproachEff(this.getRole(this.curRole),this.role0)),this.beforeIndex=this.curRole,this.powerPanel.visible=this.juesexiangxi.visible=!0,this.AndianBtn.visible=darkEquipControl.checkLookOtherCanSee()},e.prototype.playRoleApproachEff=function(t,e,i){var n=this;return this.showApproachEffDic[t.index]?!1:(i&&i.removeApproachEff(),e.playApproachEff(t,function(){n.showApproachEffDic[t.index]=1}))},e.prototype.getRole=function(t){return this._otherPlayerData.roleData[t]},e.prototype.close=function(){egret.Tween.removeTweens(this.role0),egret.Tween.removeTweens(this.role1),this.roleInfoItem0.destory(),this.roleInfoItem1.destory(),TimerMgr.ins().remove(this.hideZhanling,this),TimerMgr.ins().remove(this.playZhanLingAttack,this),TimerMgr.ins().remove(this.startShowZhanling,this)},e.prototype.clearChangeEff=function(){egret.Tween.removeTweens(this.role0),egret.Tween.removeTweens(this.role1),this.curRoleItem().x=0,this.nextRoleItem().x=580,this.curRoleItem().alpha=1,this.nextRoleItem().alpha=0,this.nextRoleItem().visible=!1,this.curRoleItem().setRole(this.getRole(this.curRole))},e.prototype.roleChange=function(t,e){var i=this;if(t==e)return void this.clearChangeEff();var n=this.curRoleItem(),o=this.nextRoleItem();if(o.visible=!0,n.setRole(this.getRole(t)),o.setRole(this.getRole(e)),this.playRoleApproachEff(this.getRole(e),o,n))return this._curRoleItem=o,void this.clearChangeEff();var s=egret.Tween.get(n),r=egret.Tween.get(o);e>t?(o.x=580,s.to({x:-580,alpha:0},600),r.to({x:0,alpha:1},600).call(function(){i._curRoleItem=o,i.clearChangeEff()})):(o.x=-580,s.to({x:580,alpha:0},600),r.to({x:0,alpha:1},600).call(function(){i._curRoleItem=o,i.clearChangeEff()}))},e.prototype.nextRoleItem=function(){return this.role1==this._curRoleItem?this.role0:this.role1},e.prototype.curRoleItem=function(){return this._curRoleItem?this._curRoleItem:this.role0},e.prototype.updateRing=function(){var t=this._otherPlayerData.roleData[this.curRole];if(t){var e=t.exRingsData;e[0]>0?(this.roleInfoItem0.setImgSource(0,1),this.roleInfoItem0.setBgValue("quality4")):(this.roleInfoItem0.setImgSource(0,0),this.roleInfoItem0.setBgValue("quality0")),this.roleInfoItem0.setLv(0),this.roleInfoItem0.setNameTxt(DataCenter.ins().FireRingConfig[0].name),e[1]>0?(this.roleInfoItem1.setImgSource(1,1),this.roleInfoItem1.setBgValue("quality4")):(this.roleInfoItem1.setImgSource(1,0),this.roleInfoItem1.setBgValue("quality0")),this.roleInfoItem1.setLv(0),this.roleInfoItem1.setNameTxt(DataCenter.ins().FireRingConfig[1].name)}},e.prototype.updataEquip=function(t){void 0===t&&(t=!0);var e=this._otherPlayerData.roleData[this.curRole];this.setEquip(e)},e.prototype.updateSamsaraEquip=function(){for(var t=this._otherPlayerData.zhuan,e=this._otherPlayerData.level,i=1e3*t+e,n=i>=DataCenter.ins().ReincarnationBaseConfig.openLevel,o=9;13>o;o++)this["item"+o].visible=n},e.prototype.setEquip=function(t){if(t){for(var e=t.getEquipLen(),i=0;e>i;i++){var n=t.getEquipByIndex(i);
if(this.equips[i].setModel(t),this.equips[i].setIndex(i),this.equips[i].data=n.item,0==n.item.configID?(this.equips[i].setItemImg(i>13?"":"xb_1"+IntensifyConst.EQUIP_POS[i]),this.equips[i].isShowTips(!1)):this.equips[i].isShowTips(!0),i>=9&&12>=i)n.soulLv>0?this["item"+i].setSoul(!0):this["item"+i].setSoul(!1);else if(i>=0&&7>=i){var o=this["item"+i].getItemIcon();o.extreme.visible=uitrasoneEquipControl.getZhiZunLvByRoleID(t,i)>0,this.equips[i].setDevour(this._otherPlayerData.devourEquips)}}this.powerPanel.setPower(t.power),this.role0.setRole(this.getRole(this.curRole))}},e.prototype.setSuit=function(t,e,i){DisplayUtils.removeFromParent(i);var n=this._otherPlayerData.roleData[t],o=n.heirloom.getSuitConfig(n);if(o){i.parent||e.parent.addChildAt(i,e.parent.getChildIndex(e));var s=DataCenter.ins().HeirloomEquipSetConfig[o.lv];i.playFile(PATH_EFF+s.neff,-1)}},e.prototype.getZhuangbanById=function(t){for(var e in DataCenter.ins().FashionIdConfig)if(DataCenter.ins().FashionIdConfig[e].id==t)return DataCenter.ins().FashionIdConfig[e];return null},e.prototype.onClick=function(t){switch(t.currentTarget){case this.juesexiangxi:UIMgr.ins().open(RankRoleAttrView,this.curRole,this._otherPlayerData);break;case this.roleInfoItem0:UIMgr.ins().open(RankSpecialRingView,0,this.curRole,this._otherPlayerData);break;case this.roleInfoItem1:UIMgr.ins().open(RankSpecialRingView,1,this.curRole,this._otherPlayerData);break;case this.AndianBtn:UIMgr.ins().open(DarkEquipOtherView,0,this.curRole,this._otherPlayerData);break;case this.warriorBtn:UIMgr.ins().open(WarriorOtherView,this._otherPlayerData)}},e.prototype.showZhanling=function(t){var e=t.zhanlingID,i=t.zhanlingLevel;if(!(0>i)){var n=DataCenter.ins().AshtarteLevelConfig[e][i];this.fileName=n.appearance,this.warMc||(this.warMc=new GameMovieClip,this.warMc.x=this.powerPanel.width/2,this.warMc.y=120,this.powerPanel.addChildAt(this.warMc,1),this.warMc.playFile(PATH_GUAIWU+this.fileName+"_4s",-1),this.warMc.touchEnabled=!1);var o=DataCenter.ins().AshtarteConfig.anchorOffset[0]||[];this.warMc.anchorOffsetX=o[0]||0,this.warMc.anchorOffsetY=o[1]||0,TimerMgr.ins().remove(this.startShowZhanling,this),TimerMgr.ins().remove(this.playZhanLingAttack,this),TimerMgr.ins().doTimer(200,1,this.playZhanLingAttack,this)}},e.prototype.playZhanLingAttack=function(){var t=this;if(this.warMc){var e=PATH_GUAIWU+this.fileName+"_4"+UnitAction.ATTACK;this.warMc.playFile(e,1,function(){var e=PATH_GUAIWU+t.fileName+"_4"+UnitAction.STAND;t.warMc.playFile(e,-1,null,!1),TimerMgr.ins().remove(t.playZhanLingAttack,t),TimerMgr.ins().doTimer(2800,1,t.hideZhanling,t)},!1)}},e.prototype.hideZhanling=function(){var t=this;this.warMc&&egret.Tween.get(this.warMc).to({alpha:0},DataCenter.ins().AshtarteConfig.disappearTime||1500).call(function(){t.powerPanel.removeChild(t.warMc),t.warMc.destroy(),t.warMc=null,TimerMgr.ins().remove(t.hideZhanling,t),TimerMgr.ins().doTimer(7e3,1,t.startShowZhanling,t)})},e.prototype.startShowZhanling=function(){this.showZhanling(this._otherPlayerData)},e}(BasePanel);__reflect(RankRoleInfoPanel.prototype,"RankRoleInfoPanel");var RankRoleSelectPanel=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e.skinName="RoleSelectPanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.roles=[];for(var t=0;5>t;t++)t<GlobalModel.roleNum?this.roles.push(this["role"+t]):this["role"+t]&&this["role"+t].parent.removeChild(this["role"+t])},e.prototype.open=function(){this.setCurRole(0),this.addEventTouchTap(this,this.onClick)},Object.defineProperty(e.prototype,"otherPlayerData",{set:function(t){this._otherPlayerData=t,this.updateRole()},enumerable:!0,configurable:!0}),e.prototype.getCurRole=function(){return this._curRole},e.prototype.setCurRole=function(t){this._curRole=t;for(var e=0;e<this.roles.length;e++){var i=this.roles[e];i.selected=e==t}this.dispatchEventWith(egret.Event.CHANGE,!1,this._curRole)},e.prototype.onClick=function(t){var e=this.roles.indexOf(t.target);if(e>-1){var i=t.target;this._otherPlayerData.roleData[e]?this.setCurRole(e):i.selected=!1}},e.prototype.updateRole=function(){for(var t,e,i=0;i<this.roles.length;i++)t=this.roles[i],e=this._otherPlayerData.roleData[i],e?(t.jobImg.visible=!0,t.jobImg.source="job"+e.job+"Item",t.icon="yuanhead"+e.job+e.sex):(t.icon="",t.jobImg.visible=!1)},e.prototype.close=function(){this.removeEventTouchTap(this,this.onClick)},e}(BasePanel);__reflect(RankRoleSelectPanel.prototype,"RankRoleSelectPanel");var RankRoleView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankRoleViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.selectedIndex=0,this.list.itemRenderer=TotemShowItemRender,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.otherPlayerData=t[0],this.rankRoleSelectPanel.otherPlayerData=this.otherPlayerData,this.nameTxt.text=this.otherPlayerData.name,this.rankRoleSelectPanel.open(),this.addEventTouchTap(this,this.onClick),this.addEventChange(this.rankRoleSelectPanel,this.onChange),this.addCustomEvent(338,this.upLikeDt),this.rankRoleSelectPanel.setCurRole(0),this.setRoleInfo(),this.upLikeDt(),this.rankRoleInfoPanel.showZhanling(this.otherPlayerData),this.addEventTouchTap(this.list,this.onListTouch),this.updateTuTeng()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onClick),this.rankRoleInfoPanel.clear(),this.closeFun&&this.closeFun()},e.prototype.destoryView=function(){t.prototype.destoryView.call(this),this.rankRoleSelectPanel.close(),this.rankRoleInfoPanel.close()},e.prototype.upLikeDt=function(){this.likeBtn&&(this.likeBtn.enabled=peakedControl.kideNum<DataCenter.ins().PeakRaceBaseConfig.likeCount&&PeakedRedpoint.ins().redpoint2>0)},e.prototype.setRoleInfo=function(){var t=this,e=this.otherPlayerData.roleData[0],i="[S"+this.otherPlayerData.serverId+"]";this.otherPlayerData.serverId&&this.otherPlayerData.serverId!=GlobalModel.srvid||(i=""),this.nameTxt.text=this.otherPlayerData.name+i,egret.callLater(function(){t.guildNameText.x=t.nameTxt.x+t.nameTxt.textWidth+10},this),this.guildNameText.text=this.otherPlayerData.guildName?LangMgr.getValueByKey("rankTips3",this.otherPlayerData.guildName):"";var n=this.otherPlayerData.zhuan?LangMgr.getValueByKey("numberRotation",this.otherPlayerData.zhuan):"";this.levelText.text=LangMgr.getValueByKey("numberLevel1",n,this.otherPlayerData.level),this.headIcon.source="head_"+e.job+e.sex;var o=this.otherPlayerData.lilianLv,s=DataCenter.ins().ExperienceKingLevelConfig[o];this.jueweiIcon.source="juewei_1_"+s.type+"_png"},e.prototype.onChange=function(t){this.setView(this.rankRoleSelectPanel.getCurRole())},e.prototype.setView=function(t){void 0===t&&(t=0),this.rankRoleInfoPanel.curRole=this.rankRoleSelectPanel.getCurRole(),this.rankRoleInfoPanel.open(this.otherPlayerData),this.updateTuTeng()},e.prototype.onClick=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);var e=UIMgr.ins().getView(GameBottomView);e&&e.closeNav(GameBottomView.NAV_ROLE);break;case this.likeBtn:peakedControl.isCross()?peakedControl.upKFToLikes(this.otherPlayerData.id):peakedControl.upToLikes(this.otherPlayerData.id)}},e.prototype.hideEx=function(t){switch(void 0===t&&(t=1),t){case 1:this.rankRoleInfoPanel.juesexiangxi.visible=!1,this.rankRoleInfoPanel.powerPanel.visible=!1,this.likeBtn&&(this.likeBtn.visible=!0);break;case 2:this.rankRoleInfoPanel.juesexiangxi.visible=!1,this.rankRoleInfoPanel.powerPanel.visible=!1,this.likeBtn&&(this.likeBtn.visible=!1)}},e.prototype.updateTuTeng=function(){totemControl.otherPlayerData=this.otherPlayerData,this._col.source=totemControl.getActivedTTInfo(this.rankRoleSelectPanel.getCurRole(),!1),this.totem.viewport.scrollH=0},e.prototype.onListTouch=function(t){t.target instanceof TotemShowItemRender&&UIMgr.ins().open(TotemOtherInfoView,this.rankRoleSelectPanel.getCurRole(),t.target.data.id)},e}(BaseEuiView);__reflect(RankRoleView.prototype,"RankRoleView");var RankSpecialRingView=function(t){function e(){var e=t.call(this)||this;return e.ringLv=0,e.skinName="SuperRingViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.iconMc=new GameMovieClip,this.iconMc.x=this.mcGroup.width/2,this.iconMc.y=160,this.gainList0.itemRenderer=SuperRingGainItemRender,this.btnUse.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],null==t[1]&&(t[1]=0),this._otherPlayerData=t[2],this.roleSelect.setCurRole(t[1]),this.iconMc&&!this.iconMc.parent&&this.mcGroup.addChild(this.iconMc),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventChange(this.roleSelect,this.roleChange),this.addEventItemTap(this.gainList0,this.onTouchList);var i=DataCenter.ins().FireRingConfig[this.index],n=DataCenter.ins().PropsGainConfig[i.costItem];this.gainList0.dataProvider=new eui.ArrayCollection(n.gainWay),this.roleChange()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventChange(this.roleSelect,this.roleChange),this.removeEventItemTap(this.gainList0,this.onTouchList),DisplayUtils.removeFromParent(this.iconMc),this.removeCustomEvents()},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&GuideControl.guidance(e[1],e[2],!0)}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.showIcon=function(){var t=this.index?"hushen":"mabi";this.iconMc.playFile(PATH_EFF+t,-1)},e.prototype.roleChange=function(t){void 0===t&&(t=!1);var e=this.roleSelect.getCurRole();this.ringLv=this._otherPlayerData.roleData[e].getExRingsData(this.index),this.showIcon();var i=DataCenter.ins().FireRingConfig[this.index],n=(DataCenter.ins()["FireRing"+this.index+"Config"][0],DataCenter.ins()["FireRing"+this.index+"Config"][1]);if(0==this.ringLv?(this.currentState="lock",this.tips.source="tjweijihuo"):(this.currentState="actived",this.tips.source="tjyijihuo"),n){for(var o="",s=0,r=0,a=0,l="",h=0;h<n.attrAward.length;h++)r=n.attrAward[h].type,15!=r&&13!=r&&(o=AttributeData.getAttrStrByType(r),s=n.attrAward[h].value,o.length<3&&(o=AttributeData.inserteBlank(o,7)),this["attr"+a].text=o+"：",r>1&&9>r?l=7==r||8==r?s/100+"%":s.toString():(r>12&&15>r||r>15)&&(l=19==r?s/100+150+"%":s/100+"%"),this["value"+a].text=l,a++);var u=BackpackControl.getAttrPower(n.attrAward);this.powerPanel.setPower(u),this.powerPanel.setMcVisible(!1),this.validateNow();var p=DataCenter.ins().ItemConfig[i.costItem];this.specialAttr.textFlow=TextUtils.generateTextFlow1(p.desc),this.imgTitle.source="wenzi_jz"+i.id}},e}(BaseEuiView);__reflect(RankSpecialRingView.prototype,"RankSpecialRingView");var RankFbLevelsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FbRankItemSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.openDetail)},e.prototype.close=function(){this.removeEventTouchTap(this,this.openDetail)},e.prototype.dataChanged=function(){this.rank.text=this.data.pos+"",this.monthcard.visible=1==this.data.month;var t=this.data.vip;this.vipImg.visible=t>0,this.vip.removeChildren(),t>0&&this.vip.addChild(BitmapNumber.ins().createNumPic(t,"5")),this.nameLabel.text=this.data.player,this.zhanli.text=CommonUtils.overLength(this.data.power),this.ce.text=this.data.count+LangMgr.getValueByKey("guanGK")},e.prototype.openDetail=function(){rankOtherUserControl.upFindPlayer(this.data.playId)},e}(BaseItemRender);__reflect(RankFbLevelsItemRenderer.prototype,"RankFbLevelsItemRenderer");var RankItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){if(null!=this.data){for(var t in this.data){var e=this[t];e&&this.updateValue(e,t,this.data[t])}2==this.data.pos?(this.t3.source="rankcolor_1",this.t1.source="paihang2",this.pos.visible=!1,this.t1.visible=!0):3==this.data.pos?(this.t3.source="rankcolor_2",this.t1.source="paihang3",this.pos.visible=!1,this.t1.visible=!0):4==this.data.pos?(this.t3.source="rankcolor_3",this.t1.source="",this.pos.visible=!0,this.t1.visible=!1):(this.t3.source="bantoutiaobg",this.pos.visible=!0,this.t1.visible=!1),this.lz0&&this.lz1&&this.lz0.parent&&this.lz1.parent&&(this.lz0.parent.removeChild(this.lz0),this.lz1.parent.removeChild(this.lz1),this.lz0=this.lz1=null),this.t10&&(this.t10.visible=this.data.pos<=10),this.vip.visible=this.data.vip>0}this.visible=null!=this.data},e.prototype.updateValue=function(t,i,n){switch(i){case"vip":return;case"month":return void(t.visible=1==n);case"level":n=LangMgr.getValueByKey("numberLevel",n);break;case"count":if(15==rankControl.curType){var o=DataCenter.ins().ExperienceMedalConfig[n];n=o.type}else if(10==rankControl.curType){var o=DataCenter.ins().ExperienceKingLevelConfig[n];n=LangMgr.getValueByKey("rankWait",o.trainlevel,o.trainName)}else 23==rankControl.curType&&(n=LangMgr.getValueByKey("rankCharmValue",n));break;case"weiWang":n=prestigeControl.getPrestigeCfg(n).res}t instanceof eui.Label?("number"==typeof n&&(n=CommonUtils.overLength(n)),t.text=i in e.dataFormat?e.dataFormat[i].replace("{value}",n):n):t instanceof eui.Image&&(t.source=i in e.dataFormat?e.dataFormat[i].replace("{value}",n):n)},e}(BaseItemRender);__reflect(RankItemRenderer.prototype,"RankItemRenderer");var RankTabItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="RankTabItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.redPoint.visible=rankControl.canPraiseByType(this.data.type)},e}(BaseItemRender);__reflect(RankTabItemRenderer.prototype,"RankTabItemRenderer");var RecruitView=function(t){function e(){var e=t.call(this)||this;return e.rolePos=[[100,0,1,3],[-4,79,.7,2],[336,79,.7,2]],e._sex=0,e.beginPoint=0,e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RecruitViewSkin",this.roles=[this.role0,this.role1,this.role2],this.updateRole()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addEventTouchBegin(this,this.onBegin),this.addEventTouchMove(this,this.onMove),this.addCustomEvent(107,this.setNeedTxt),this.updateRole(),this.setNeedTxt();for(var i=[0,1,2],n=heroControl.subRolesLen,o=0;n>o;o++){var s=heroControl.getSubRoleByIndex(o);if(!this.canVisibleOpen(s.job-1)){var r=i.indexOf(s.job-1);r>-1&&i.splice(r,1)}}this.job=i[0]},e.prototype.updateRole=function(){for(var t=0;t<this.roles.length;t++)this.setRole(this.roles[t],t)},e.prototype.setRole=function(t,e){var i=loginControl.getCreateRoleConfigByJob(e+1).sex,n=this._sex;-1==i.indexOf(this._sex)&&(n=n?0:1),t.job.source="op_"+(e+1),t.body.source="open_"+(e+1)+"_"+n+"_png",t.openedImg.visible=!this.canVisibleOpen(e)},e.prototype.canVisibleOpen=function(t){for(var e=0,i=heroControl.subRolesLen,n=0;i>n;n++){var o=heroControl.getSubRoleByIndex(n);o.job==t+1&&e++}return e<(GlobalModel.roleNum>3?2:1)},e.prototype.setNeedTxt=function(){var t,e,i,n=heroControl.subRolesLen,o=DataCenter.ins().RoleNewConfig[n],s="";o.zsLevel?(s=LangMgr.getValueByKey("numberRotation",o.zsLevel),this.canOpen=reincarnateControl.lv>=o.zsLevel,t=this.canOpen?ColorUtils.GREEN:ColorUtils.RED,s='<font color="#'+t.toString(16)+'">'+s+"</font>"):(s=LangMgr.getValueByKey("numberLevel",o.level),this.canOpen=ActorControl.level>=o.level,t=this.canOpen?ColorUtils.GREEN:ColorUtils.RED,s='<font color="#'+t.toString(16)+'">'+s+"</font>"),o.vip&&(e=vipControl.lv>=o.vip,this.canOpen=this.canOpen||e,t=e?ColorUtils.GREEN:ColorUtils.RED,s+=LangMgr.getValueByKey("nEquipTips2","#"+t.toString(16),vipControl.getVipStr(o.vip))),o.firstrecharge&&(i=vipControl.exp>0,this.canOpen=this.canOpen||i,t=i?ColorUtils.GREEN:ColorUtils.RED,s+=LangMgr.getValueByKey("firstrecharge","#"+t.toString(16))),this.needTxt.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("onLock",s))},e.prototype.selectJob=function(t,e){var i=this;void 0===e&&(e=!1);for(var n=function(n){var s=(t+t+n)%3;if(e)o.roles[n].x=o.rolePos[s][0],o.roles[n].y=o.rolePos[s][1],o.roles[n].scaleX=o.roles[n].scaleY=o.rolePos[s][2];else{var r=egret.Tween.get(o.roles[n]);r.to({x:o.rolePos[s][0],y:o.rolePos[s][1],scaleX:o.rolePos[s][2],scaleY:o.rolePos[s][2]},500).call(function(){i.roles[n].touchEnabled=0!=s},o)}0==s&&(o.roleGroup.addChild(o.roles[n]),o.openBtn.visible=!o.roles[n].openedImg.visible)},o=this,s=0;3>s;s++)n(s)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onTap),this.removeEventTouchBegin(this,this.onBegin),this.removeEventTouchMove(this,this.onMove),this.removeCustomEvents()},e.prototype.onBegin=function(t){this.stop||(this.beginPoint=t.stageX)},e.prototype.onMove=function(t){if(0!=this.beginPoint){var e=t.stageX-this.beginPoint;if(!(Math.abs(e)<5)){var i=this.job-e/Math.abs(e);if(i=i>2?i-3:0>i?i+3:i,this.addEventTouchEnd(this,this.onEnd),Math.abs(e)>=120)return this.job=i,this.beginPoint=0,void this.removeEventTouchEnd(this,this.onEnd);for(var n=0;3>n;n++){var o=this.roles[n],s=(i+i+n)%3,r=(this.job+this.job+n)%3,a=MathUtils.getRadian2(this.rolePos[r][0],this.rolePos[r][1],this.rolePos[s][0],this.rolePos[s][1]),l=MathUtils.getAngle(a),h=MathUtils.getDirMove(l,Math.abs(e));o.x=this.rolePos[r][0]+h.x,o.y=this.rolePos[r][1]+h.y;var u=Math.abs(e)/MathUtils.getDistance(this.rolePos[r][0],this.rolePos[r][1],this.rolePos[s][0],this.rolePos[s][1]);o.scaleX=o.scaleY=this.rolePos[r][2]-(this.rolePos[r][2]-this.rolePos[s][2])*u}}}},e.prototype.onEnd=function(t){this.job=this.job,this.removeEventTouchEnd(this,this.onEnd)},e.prototype.onTap=function(t){switch(t.target){case this.openBtn:if(!this.canOpen){var e=heroControl.subRolesLen,i=DataCenter.ins().RoleNewConfig[e],n=null;return n=i.firstrecharge?warnControl.show(LangMgr.getValueByKey("newRoleFirstrecharge",e+1),null,null,function(){UIMgr.ins().open(PayFirstView)},this):warnControl.show(LangMgr.getValueByKey("tipsVip",vipControl.getVipStr(i.vip),e+1),null,null,function(){UIMgr.ins().open(VipView,i.vip)},this),void(n&&n.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("traval")))}gameControl.upNewRole(this.job+1,this._sex),UIMgr.ins().close(LimitTaskView);case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.sexBtn0:this._sex=0,this.sexBtn1.selected=!1,this.updateRole();break;case this.sexBtn1:this._sex=1,this.sexBtn0.selected=!1,this.updateRole();break;default:var o=this.roles.indexOf(t.target);o>-1&&!this.stop&&(this.job=o)}},Object.defineProperty(e.prototype,"job",{get:function(){return this._job},set:function(t){var e=this;this._job=t,this.stop=!0,this.selectJob(t),TimerMgr.ins().doTimer(500,1,function(){e.stop=!1},this);var i=loginControl.getCreateRoleConfigByJob(this.job+1).sex;-1==i.indexOf(this._sex)&&(this._sex=this._sex?0:1),this.sexBtn0.visible=i.length>1,this.sexBtn1.visible=i.length>1,this.sexBtn0.selected=0==this._sex,this.sexBtn1.selected=1==this._sex},enumerable:!0,configurable:!0}),e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return heroControl.subRolesLen>=GlobalModel.roleNum?!1:(UIMgr.ins().close(ExperienceView),!0)},e}(BaseEuiView);__reflect(RecruitView.prototype,"RecruitView");var RecruitItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(eui.Component);__reflect(RecruitItemRenderer.prototype,"RecruitItemRenderer");var ReincarnateControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.exchange=!1,e.isSendXW=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downZsData=function(t,e){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];this.lv=t;var o=this.exp;this.exp=e,this.upgradeCount=i,o&&actorControl.dispatchZsExpChange(this.exp-o),EventMgr.ins().dispatch(112),UnitMgr.ins().updateRoleTitleState(!0)},e.prototype.upGetXiuWei=function(t){return[t]},e.prototype.upZsUpgrade=function(){},e.prototype.canUpgrade=function(){var t=DataCenter.ins().ReincarnateLevelConfig[this.lv+1];return t?this.exp>=t.exp:!1},e.prototype.isMaxLv=function(){return DataCenter.ins().ReincarnateLevelConfig[this.lv+1]?!1:!0},e.prototype.getMaxLv=function(){return CommonUtils.getObjectLength(DataCenter.ins().ReincarnateLevelConfig)-1},e.prototype.canGet=function(){var t=0;if(!this.upgradeCount)return t;for(var e=DataCenter.ins().ReincarnateConfig,i=[e.conversionCount,e.normalCount,e.advanceCount],n=[0,e.normalItem,e.advanceItem],o=0;o<i.length;o++)i[o]-this.upgradeCount[o]&&(!n[o]&&ActorControl.level>80||backpackControl.getBagGoodsCountById(0,n[o]))&&(0==o?reincarnateControl.exchange||(t|=1<<o):t|=1<<o);return t},e.prototype.canOpenZSWin=function(){var t=ActorControl.level,e=null!=this.lv?this.lv:0;return 0>=e&&80>t?!1:!0},__decorate([down(1,[3,3,2,2,2])],e.prototype,"downZsData",null),__decorate([up(1,[1])],e.prototype,"upGetXiuWei",null),__decorate([up(2)],e.prototype,"upZsUpgrade",null),e=__decorate([protocolsId(13)],e)}(BaseSystem);__reflect(ReincarnateControl.prototype,"ReincarnateControl");var ReincarnateGainView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ReincarnateGainViewSkin",this.infoTxts=[this.infoTxt0,this.infoTxt1,this.infoTxt2],this.toDays=[this.toDay0,this.toDay1,this.toDay2],this.items=[this.item0,this.item1,this.item2],this.btns=[this.btn0,this.btn1,this.btn2];for(var e=0;e<this.items.length;e++)this.items[e].isShowName(!1);this.priceIcon1.setType(2),this.priceIcon2.setType(2);var i=new RewardVo;i.type=0,i.id=0,i.count=0,this.items[0].data=i,this.isTopLevel=!0,this.tipsExp=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addCustomEvent(112,this.setData),this.addCustomEvent(461,this.setData),this.addCustomEvent(197,this.setData),this.addCustomEvent(198,this.setData),this.setData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents()},e.prototype.setData=function(){var t,e=DataCenter.ins().ReincarnateConfig,i=e.level+1,n=Math.max(ActorControl.level,i),o=(DataCenter.ins().ReincarnateLevelConfig[n],DataCenter.ins().ReincarnateExpConfig[n]);this.toDays[0].textColor=ActorControl.level<i?ColorUtils.RED:LangMgr.getColor("color78"),this.infoTxts[0].textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips1",o.exp)),t=e.conversionCount-reincarnateControl.upgradeCount[0],this.toDays[0].textFlow=(new egret.HtmlTextParser).parser(ActorControl.level<=80?LangMgr.getValueByKey("zsTips2",i-1):LangMgr.getValueByKey("zsTips3",t)),this.btns[0].enabled=t>0;var s=e.normalItem,r=DataCenter.ins().ItemConfig[s],a=backpackControl.getBagGoodsCountById(0,s),l=storeControl.getStoreByItemId(s);this.items[1].data=s,this.btns[1].label=a?LangMgr.getValueByKey("samTips6"):LangMgr.getValueByKey("fdBuy"),this.btns[1].name=e.normalExp+"",this.priceIcon1.visible=0==a,this.priceIcon1.setPrice(l.price),this.priceIcon1.name=r.name,this.infoTxts[1].textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips4",e.normalExp,r.name,a?LangMgr.getValueByKey("zsTips5",a):"")),t=e.normalCount-reincarnateControl.upgradeCount[1],this.toDays[1].textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips3",t)),this.btns[1].enabled=t>0,l.viplv&&vipControl.lv<l.viplv?(this.vipLb1.visible=!0,this.vipLb1.text=LangMgr.getValueByKey("shopVipBuy",vipControl.getVipStr(l.viplv))):this.vipLb1.visible=!1,s=e.advanceItem,r=DataCenter.ins().ItemConfig[s],a=backpackControl.getBagGoodsCountById(0,s),l=storeControl.getStoreByItemId(s),this.items[2].data=s,this.btns[2].label=a?LangMgr.getValueByKey("samTips6"):LangMgr.getValueByKey("fdBuy"),this.btns[2].name=e.advanceExp+"",this.priceIcon2.visible=0==a,this.priceIcon2.setPrice(storeControl.getStoreByItemId(s).price),this.priceIcon2.name=r.name,this.infoTxts[2].textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips6",e.advanceExp,r.name,a?LangMgr.getValueByKey("zsTips5",a):"")),t=e.advanceCount-reincarnateControl.upgradeCount[2],this.toDays[2].textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsTips3",t)),this.btns[2].enabled=t>0,l.viplv&&vipControl.lv<l.viplv?(this.vipLb2.visible=!0,this.vipLb2.text=LangMgr.getValueByKey("shopVipBuy",vipControl.getVipStr(l.viplv))):this.vipLb2.visible=!1;for(var h=reincarnateControl.canGet(),u=0;3>u;u++)this["redPoint"+u].visible=h>>u&1,this["redPointRule"+u]&&this["redPointRule"+u]();n=Math.max(ActorControl.level+1,i),o=DataCenter.ins().ReincarnateExpConfig[n],reincarnateControl.isSendXW[0]?reincarnateControl.isSendXW[0]=!1:reincarnateControl.isSendXW[1]?reincarnateControl.isSendXW[1]=!1:reincarnateControl.isSendXW[2]&&(reincarnateControl.isSendXW[2]=!1)},e.prototype.redPointRule0=function(){reincarnateControl.exchange||(reincarnateControl.exchange=!0)},e.prototype.onTap=function(t){switch(t.target){case this.colorCanvas:case this.closeBtn0:case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;default:var e=this.btns.indexOf(t.target);if(e>-1)if(0==e)reincarnateControl.isSendXW[e]=!0,reincarnateControl.upGetXiuWei(e+1);else if(this.btns[e].label==LangMgr.getValueByKey("samTips6"))reincarnateControl.isSendXW[e]=!0,reincarnateControl.upGetXiuWei(e+1);else{var i=this["priceIcon"+e].getPrice();if(ActorControl.yb<i)return tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),void UIMgr.ins().close(this);if(1==e){var n=DataCenter.ins().StoreItemConfig;for(var o in n)if(200009==n[o].itemId)return void this.buyGoodsId(n[o].id)}else if(2==e){var n=DataCenter.ins().StoreItemConfig;for(var o in n)if(200010==n[o].itemId)return void this.buyGoodsId(n[o].id)}}}},e.prototype.buyGoodsId=function(t){storeControl.shopData.checkBuyGoodsId(t)&&UIMgr.ins().open(StoreBuyView,t)},e}(BaseEuiView);__reflect(ReincarnateGainView.prototype,"ReincarnateGainView");var ReincarnatePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lastZsLevel=-1,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.link.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("zsPanelGetXW")),this.eff=new GameMovieClip,this.eff.x=this.link.x+this.link.width/2,this.eff.y=this.link.y+this.link.height/2,this.eff.touchEnabled=!1,this.eff.scaleX=.6,this.eff.scaleY=.5,this.upLevelEff=new GameMovieClip,this.upLevelEff.scaleX=this.upLevelEff.scaleY=2,this.upLevelEff.touchEnabled=!1,this.maxGroup.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEvents()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEvent()},e.prototype.addEvents=function(){this.addEventTouchTap(this.getBtn,this.onTap),this.addEventTouchTap(this.link,this.onTap),this.addCustomEvent(112,this.setData),this.addCustomEvent(461,this.setData)},e.prototype.removeEvent=function(){DisplayUtils.removeFromParent(this.eff),DisplayUtils.removeFromParent(this.upLevelEff)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.getBtn:var e=DataCenter.ins().ReincarnateLevelConfig[reincarnateControl.lv+1];if(reincarnateControl.exp<e.exp)return void tipsControl.showTips(LangMgr.getValueByKey("zsPanelEnoughtXW"));reincarnateControl.upZsUpgrade();break;case this.link:UIMgr.ins().open(ReincarnateGainView)}},e.prototype.setData=function(){this.redPoint.visible=reincarnateControl.canUpgrade();var t=reincarnateControl.lv;this.curZsLv.text=LangMgr.getValueByKey("zxPanelRotationLevel",t),this.haveTxt.text=reincarnateControl.exp+"";var e=DataCenter.ins().ReincarnateLevelConfig[t];this.curAtt.text=AttributeData.getAttStr(e,1);var i=[];for(var n in AttributeData.translate)if(!isNaN(e[n])){var o=new AttributeData;o.type=parseInt(AttributeData.translate[n]),o.value=e[n],i.push(o)}var s=heroControl.subRolesLen;this._totalPower=BackpackControl.getAttrPower(i)*s,this.powerPanel.setPower(this._totalPower);var r=DataCenter.ins().ReincarnateLevelConfig[t+1];if(r&&t<DataCenter.ins().ReincarnateConfig.baseMaxZsLv)this.nextAtt.text=AttributeData.getAttStr(r,1),this.useTxt.text=r.exp+"",this.maxGroup.visible=!1,this.normalGroup.visible=!0;else{DataCenter.ins().ReincarnateLevelConfig[t];this.group.visible=!1,this.curAtt.horizontalCenter=0,this.maxTxt.visible=!0,this.arrowImg.visible=!1,this.nextAtt.visible=!1,this.normalGroup.visible=!1,this.maxGroup.visible=!0;for(var a=0;a<i.length&&!(a>=4);a++)this["attr"+a].text=AttributeData.getAttStr(i[a],.5)}-1!=this.lastZsLevel&&this.lastZsLevel!=t?(this.upLevelEff.parent||this.upEffGroup.addChild(this.upLevelEff),this.upLevelEff.playFile(PATH_EFF+"zhuanshengeff",1)):DisplayUtils.removeFromParent(this.upLevelEff),this.lastZsLevel=t,reincarnateControl.canGet()&&r?(this.eff.parent||this.group.addChild(this.eff),this.eff.playFile(PATH_EFF+"chargeff1",-1)):DisplayUtils.removeFromParent(this.eff)},e}(BasePanel);__reflect(ReincarnatePanel.prototype,"ReincarnatePanel");var ReincarnateStarControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.point=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downZs13Data=function(t){this.point=t,EventMgr.ins().dispatch(115)},e.prototype.upZs13Upgrade=function(){},e.prototype.checkShow13ZsPanel=function(){return reincarnateControl.lv>=DataCenter.ins().ReincarnateConfig.baseMaxZsLv&&this.check13ZsOpenDay()},e.prototype.check13ZsOpenDay=function(){return GameServer.serverOpenDay>=DataCenter.ins().ReincarnateConfig.openDay[DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1]-1},e.prototype.getZsConfigMap=function(){if(!this._zsConfig){this._zsConfig={};for(var t in DataCenter.ins().ReincarnateStarStepZsLvConfig){var e=DataCenter.ins().ReincarnateStarStepZsLvConfig[t];this._zsConfig[e.zsLevel]||(this._zsConfig[e.zsLevel]=[]),this._zsConfig[e.zsLevel].push(e)}}return this._zsConfig},e.prototype.getShowZsConfig=function(){if(!(reincarnateControl.lv<DataCenter.ins().ReincarnateConfig.baseMaxZsLv)){var t=this.point?this.point:1,e=DataCenter.ins().ReincarnateStarStepZsLvConfig[t],i=this.getZsConfigMap(),n=[];return n=e.starLv?DataCenter.ins().ReincarnateConfig.baseMaxZsLv==reincarnateControl.lv?i[reincarnateControl.lv].concat(i[reincarnateControl.lv+1][0]):i[reincarnateControl.lv].slice(1).concat(i[reincarnateControl.lv+1][0]):DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1==reincarnateControl.lv?reincarnateControl.isMaxLv()?i[reincarnateControl.lv-1].concat(i[reincarnateControl.lv][0]):i[reincarnateControl.lv].slice(1).concat(i[reincarnateControl.lv][0]):reincarnateControl.isMaxLv()?i[reincarnateControl.lv-1].slice(1).concat(i[reincarnateControl.lv][0]):i[reincarnateControl.lv].slice(1).concat(i[reincarnateControl.lv+1][0])}},e.prototype.checkSZsIsOpen=function(t){if(void 0===t&&(t=DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1),!isNaN(DataCenter.ins().ReincarnateConfig.openDay[t]))return!1;var e=DataCenter.ins().ReincarnateConfig.openDay[t];return GameServer.serverOpenDay>=e-1},e.prototype.getStarLv=function(){if(reincarnateControl.lv<DataCenter.ins().ReincarnateConfig.baseMaxZsLv)return 0;var t=DataCenter.ins().ReincarnateConfig.baseMaxZsLv!=reincarnateControl.lv||this.point?this.point:0,e=DataCenter.ins().ReincarnateStarStepZsLvConfig[t];if(!e)return 0;var i=e.starLv;return e.starLv||(i=reincarnateControl.isMaxLv()?DataCenter.ins().ReincarnateStarStepZsLvConfig[t-1].starLv+1:0),i
},e.prototype.checkAter12MaxZs=function(){var t=DataCenter.ins().ReincarnateConfig.baseMaxZsLv!=reincarnateControl.lv||this.point?this.point:1;if(!DataCenter.ins().ReincarnateStarStepZsLvConfig[t])return!1;if(DataCenter.ins().ReincarnateStarStepZsLvConfig[t].starLv)return!1;var e=DataCenter.ins().ReincarnateStarStepZsLvConfig[t].zsLevel,i=DataCenter.ins().ReincarnateConfig.openDay[e+1];return i&&GameServer.serverOpenDay>=i-1?!1:!0},e.prototype.getAfter12Zs=function(){var t=DataCenter.ins().ReincarnateConfig.baseMaxZsLv!=reincarnateControl.lv||this.point?this.point:1,e=DataCenter.ins().ReincarnateStarStepZsLvConfig[t];if(Assert(e,"point:"+this.point+",zsLv:"+reincarnateControl.lv))return DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1;var i=e.zsLevel,n=0;if(e.starLv)n=DataCenter.ins().ReincarnateConfig.openDay[i+1];else if(reincarnateControl.isMaxLv()){if(n=DataCenter.ins().ReincarnateConfig.openDay[i])return i}else n=DataCenter.ins().ReincarnateConfig.openDay[i+1];return n?i+1:i},e.prototype.IsUpLevel13ZsExp=function(){if(reincarnateControl.isMaxLv())return!1;if(!this.checkShow13ZsPanel())return!1;var t=this.point?this.point+1:1;return DataCenter.ins().ReincarnateStarStepZsLvConfig[t]&&reincarnateControl.exp>=DataCenter.ins().ReincarnateStarStepZsLvConfig[t].exp?!0:!1},__decorate([down(3,[3])],e.prototype,"downZs13Data",null),__decorate([up(3)],e.prototype,"upZs13Upgrade",null),e=__decorate([protocolsId(13)],e)}(BaseSystem);__reflect(ReincarnateStarControl.prototype,"ReincarnateStarControl");var AmuseTarget100Panel2=function(t){function e(){var e=t.call(this)||this;return e.panArr=[],e.skinName="AmuseTarget100Panel2Skin",e}return __extends(e,t),e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(this.actConfig=DataCenter.ins().Amusement100Config[this.activityID],this.actConfig.skinname&&this.actConfig.classname&&!this.panArr.some(function(e){return e.name==t.actConfig.classname})){this.group.visible=!1;var n=egret.getDefinitionByName(this.actConfig.classname),o=new n;return o.name=this.actConfig.classname,this.panArr.push(o),this.panel=this.panArr.filter(function(e){return e.name==t.actConfig.classname})[0],this.panel.top=0,this.panel.bottom=0,this.panel.left=0,this.panel.right=0,this.panel.open(),void this.addChild(this.panel)}this.addEventTouchTap(this.goBtn,this.onTap);var s=DataCenter.ins().AmusementConfig[this.activityID];this.actDesc.text=s.desc;var r=DataCenter.ins().AmusementBtnConfig[this.activityID];if(r&&(this.title.source=r.title),this.showbg.source=this.actConfig.back,this.actConfig.jump){this.goBtn.visible=!0,this.goBtn.label=LangMgr.getValueByKey("jzdbGoBtnLabel"+this.actConfig.jump);var a=amusementControl.getAmusementDataById(this.activityID);a&&this.redPoint&&(this.redPoint.visible=a.canReward())}else this.goBtn.visible=!1},e.prototype.onTap=function(t){switch(t.currentTarget){case this.goBtn:this.jumpUI()}},e.prototype.jumpUI=function(){if(this.actConfig)switch(this.actConfig.jump){case 1:UIMgr.ins().open(CopyView,1,0);break;case 2:UIMgr.ins().open(BackpackView,4);break;case 3:UIMgr.ins().open(BossView,1);break;case 4:UIMgr.ins().open(BossView,2)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.goBtn,this.onTap)},e}(AmusementPanel);__reflect(AmuseTarget100Panel2.prototype,"AmuseTarget100Panel2");var ReincarnateStarBossControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(300,function(){e.isInFb&&UIMgr.ins().open(BossBelongView)}),e.addCustomEvent(301,function(){e.isInFb&&UIMgr.ins().close(BossBelongView)}),e.addCustomEvent(353,function(){e.isInFb?e.dispatchEnterFb():e.lastFb&&e.dispatchQuiFb()}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"isInFb",{get:function(){return 57==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.dispatchEnterFb=function(){this.lastFb=!0,UIMgr.ins().isShow(BossBloodView)&&UIMgr.ins().open(BossBloodView),UIMgr.ins().open(ReincarnateStarBossSceneView)},e.prototype.dispatchQuiFb=function(){UIMgr.ins().close(BossBelongView),UIMgr.ins().close(ReincarnateStarBossSceneView),this.lastFb=!1},e.prototype.enterFb=function(t){if(reincarnateStarControl.checkShow13ZsPanel()&&!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()){if(!GameServer.kfServerIDSmall)return void tipsControl.warnTips(LangMgr.getValueByKey("openkfopenfun"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)UIMgr.ins().open(BackpackFullTipsView,BackpackControl.BAG_ENOUGH);else{if(!bossControl.worldInfoList[11])return void tipsControl.showTips(LangMgr.getValueByKey("openkfgotobzfun"));isNaN(+t)?tipsControl.showTips("|C:0xf3311e&T:"+t+"|"):bossControl.challengWorldBoss(+t,11)}}},e}(BaseSystem);__reflect(ReincarnateStarBossControl.prototype,"ReincarnateStarBossControl");var ReincarnateStarBossPanel=function(t){function e(){var e=t.call(this)||this;return e.type=11,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ReincarnateStarBossItemRenderer,this.listDt=new eui.ArrayCollection,this.list.dataProvider=this.listDt,this.setting.textFlow=TextUtils.formatUnderLineStr(this.setting.text),this.bossItemId=DataCenter.ins().WorldBossBaseConfig.challengeItem[this.type-1],this.bostDpList=[];for(var e in DataCenter.ins().WorldBossConfig){var i=DataCenter.ins().WorldBossConfig[e];if(11==i.type){var n={};n.id=+e,n.dp=i,this.bostDpList.push(n)}}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.setting,this.onTouch),this.addEventTouchTap(this.list,this.onTouch),this.addCustomEvent(296,this.updata),this.addCustomEvent(645,this.upList),this.updata(),bossControl.upWorldBossInfo(this.type),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.initList(t[0],this.bostDpList),this.list.visible=!1,this.showList()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),this.$onClose()},e.prototype.showList=function(){this.list.visible=!0,TweenUtil.ListAnimation(this.list,4,80,0)},e.prototype.sortList=function(){for(var t=bossControl.worldInfoList[11],e=[],i=[],n=0;n<this.bostDpList.length;n++){var o=this.bostDpList[n],s=!1;if(t)for(var r=0;r<t.length;r++){var a=t[r];if(o.id==a.id&&a.canInto){s=!0;break}}s?e.push(o):i.push(o)}e.sort(this.compareFun),this.listDt.replaceAll(e.concat(i))},e.prototype.compareFun=function(t,e){var i=BossControl.ins();return i.getBossRemindByIndex(t.id)&&!i.getBossRemindByIndex(e.id)?-1:!i.getBossRemindByIndex(t.id)&&i.getBossRemindByIndex(e.id)?1:i.getBossRemindByIndex(t.id)&&i.getBossRemindByIndex(e.id)?SortUtils.sortDescByKey(t,e,"id"):SortUtils.sortAscByKey(t,e,"id")},e.prototype.onTime=function(){for(var t=0;t<this.list.numChildren;t++){var e=this.list.getChildAt(t);e.upTime()}},e.prototype.upList=function(){this.listDt.refresh()},e.prototype.onTouch=function(t){switch(t.target){case this.setting:bossControl.worldInfoList[11]&&UIMgr.ins().open(PublicBossRemindView,this.type);break;case this.buyText:this.buyCount();break;default:!(t.target instanceof ItemBase)&&t.target.parent.parent instanceof ReincarnateStarBossItemRenderer&&reincarnateStarBossControl.enterFb(t.target.parent.parent.name)}},e.prototype.buyCount=function(){var t=this,e=this,i=bossControl.worldBossBelongTime[this.type];if(i>0)return void tipsControl.showTips(LangMgr.getValueByKey("useFinishBuy"));var n=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,this.bossItemId);if(n>0){var o=DataCenter.ins().ItemConfig[this.bossItemId];return void warnControl.show(LangMgr.getValueByKey("warriorBelongItemUse",ItemUtils.getQualityColor(o),o.name),function(){backpackControl.upUseItem(e.bossItemId,1),bossControl.upWorldBossInfo(e.type)},this)}var s=DataCenter.ins().WorldBossBaseConfig.belongbuycount[this.type-1][vipControl.lv];if(!s)return void tipsControl.showTips(LangMgr.getValueByKey("bossTips5"));var r=bossControl.worldBossBelongBuyTime[this.type];if(0>=i&&r>=s)return void tipsControl.showTips(LangMgr.getValueByKey("ascriptionArlLimil"));if(ActorControl.yb<DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[this.type-1])return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));var a=LangMgr.getValueByKey("warriorBelongTimeTip1",DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[this.type-1],r,s);warnControl.show(a,function(){bossControl.upBuyBelongNum(t.type)},this)},e.prototype.updata=function(){var t=bossControl.worldBossBelongTime[this.type]||0,e=t>0?ColorUtils.GREEN:ColorUtils.RED;this.leftText.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("guilFightTimes")+"：|C:"+e+"&T:"+t+"|"+LangMgr.getValueByKey("rm")),this.asistText.visible=bossControl.checkShowAsist(57),this.asistText.visible&&(this.asistText.textFlow=TextUtils.generateTextFlow1(bossControl.getAsistText())),this.sortList()},e.prototype.initList=function(t,e){if(t){this.list.validateNow();for(var i=0;i<e.length;i++)if(e[i].id&&t==Number(e[i].id)){this.list.validateNow(),this.list.scrollV=212*i,this.list.scrollV>=this.list.contentHeight-this.list.parent.height&&(this.list.scrollV=this.list.contentHeight-this.list.parent.height);break}}},__decorate([callLater],e.prototype,"showList",null),e}(BasePanel);__reflect(ReincarnateStarBossPanel.prototype,"ReincarnateStarBossPanel");var ReincarnateStarBossSceneView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrossBossSceneViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(8,this.bossEnd),this.addCustomEvent(444,this.initDt),this.addCustomEvent(356,this.onRemove),this.addCustomEvent(305,this.onRelive),this.endGroup.visible=!1,this.nameTxt.text=MapControl.copyName,this.bossRefTimeLabel.text="",this.initDt()},e.prototype.close=function(){TimerMgr.ins().removeAll(this),Tween.removeTweens(this.endGroup)},e.prototype.onRelive=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.initDt=function(){if(!this.curInfo){for(var t=bossControl.worldInfoList[11],e=0;e<t.length;e++){var i=t[e],n=DataCenter.ins().WorldBossConfig[i.id];if(n&&n.bossId==bossControl.monsterID){this.curInfo=i;break}}this.bossStatus()}},e.prototype.onRemove=function(t){var e=t[1],i=e.infoModel;e instanceof UnitRole||!DataCenter.ins().MonstersConfig[i.configID]||1!=DataCenter.ins().MonstersConfig[i.configID].type||this.calcBossReTime()},e.prototype.calcBossReTime=function(){if(this.curInfo){var t=DataCenter.ins().WorldBossConfig[this.curInfo.id].refreshTime[0];t||(t=10),this.curInfo.relieveTime=1e3*t+egret.getTimer(),this.checkBossRelive()}},e.prototype.bossStatus=function(){this.curInfo&&!TimerMgr.ins().isExists(this.onBossRelive,this)&&this.checkBossRelive()},e.prototype.checkBossRelive=function(){var t=(this.curInfo.relieveTime-egret.getTimer())/1e3>>0;0>t&&!bossControl.hp?this.calcBossReTime():(TimerMgr.ins().doTimer(1e3,t+2,this.onBossRelive,this),this.onBossRelive())},e.prototype.onBossRelive=function(){if(this.curInfo){var t=(this.curInfo.relieveTime-egret.getTimer())/1e3>>0;t>0?(this.bossRefTimeLabel.text=LangMgr.getValueByKey("kfBossRefTime",DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3)),this.nameTxt.y=8):(TimerMgr.ins().remove(this.onBossRelive,this),this.bossRefTimeLabel.text="",this.nameTxt.y=18)}},e.prototype.bossEnd=function(t){var e=this;57==MapControl.copyType&&(this.endGroup.visible=!0,this.endGroup.alpha=1,this.winnerName.text=LangMgr.getValueByKey("bossWinner",t[1]),TimerMgr.ins().doTimer(1e4,1,function(){Tween.get(e.endGroup).to({alpha:0},300).call(function(){e.endGroup.visible=!1})},this))},e}(BaseEuiView);__reflect(ReincarnateStarBossSceneView.prototype,"ReincarnateStarBossSceneView");var ReincarnateStarBossItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.noDie=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.dataChanged=function(){var t=this.data.dp;this.reward.dataProvider=new eui.ArrayCollection(t.showReward);var e;t.thirteenzslv&&(e=DataCenter.ins().ReincarnateStarStepZsLvConfig[t.thirteenzslv]),e&&e.starLv?this.challengeLv.text=LangMgr.getValueByKey("numberRotation",t.zsLevel)+e.starLv+LangMgr.getValueByKey("roleStart"):this.challengeLv.text=LangMgr.getValueByKey("numberRotation",t.zsLevel),this.challengeLv.width=21,this.bossHeadImg.source="bzboss_head"+this.data.id,this.bazhufb_name.source="fb_name"+this.data.id,this.decoImg.source="",this.bgImg.source="bzboss_info_bg",DataCenter.ins().WorldBossBaseConfig.zsBossFbNames&&(this.challengeName.text=DataCenter.ins().WorldBossBaseConfig.zsBossFbNames[this.data.id]),e&&e.level>DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1?(this.headMc||(this.headMc=new GameMovieClip),this.headMc.playFile(PATH_EFF+("bzboss_head"+this.data.id+"_eff"),-1),this.headMcGroup.addChild(this.headMc),this.decoImg.source="fourteen_bian_png",this.bgImg.source="bzboss_info_bg2"):this.headMc&&DisplayUtils.removeFromParent(this.headMc);var i=bossControl.worldInfoList[11];if(i){for(var n=0;n<i.length;n++){var o=i[n];if(DataCenter.ins().WorldBossConfig[o.id]==t){this.bossData=o;break}}this.cannotGroup.visible=!(this.bossData&&this.bossData.canInto);var s=DataCenter.ins().MonstersConfig[t.bossId];this.bossName.text=s.name}else this.cannotGroup.visible=reincarnateControl.lv>=t.zsLevel&&ActorControl.level>=t.level;var r=LangMgr.getValueByKey("numberRotation",t.zsLevel)+(t.thirteenzslv?e.starLv+LangMgr.getValueByKey("roleStart"):"")+LangMgr.getValueByKey("lastopen");this.cannotGroup.visible?(this.name=r,this.bossName.textColor=16711680):this.name=this.bossData?this.bossData.id+"":r,this.rebornGroup.visible=!this.cannotGroup.visible,this.redPoint.visible=this.bossData&&this.bossData.canChallenge&&!!bossControl.worldBossBelongTime[11]&&bossControl.getBossRemindByIndex(this.bossData.id),this.upTime()},e.prototype.upTime=function(){if(!this.bossData)return void(this.rebornGroup.visible=!1);var t=this.bossData.relieveTime-egret.getTimer();this.noDie=0>t,this.noDie?this.rebornTimeLabel.text=LangMgr.getValueByKey("clickchallenge"):(this.rebornTimeLabel.text=LangMgr.getValueByKey("bossPlayRefush",DateUtils.getFormatBySecond(Math.floor(t/1e3),1)),0>=t&&bossControl.upWorldBossInfo(11))},e}(BaseItemRender);__reflect(ReincarnateStarBossItemRenderer.prototype,"ReincarnateStarBossItemRenderer");var ReincarnateStarEquipControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._equips={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upChangeEquip=function(t,e,i){return[t,e,i]},e.prototype.upCompose=function(t,e){return[t,e]},e.prototype.downCompose=function(t){EventMgr.ins().dispatch(113,t)},e.prototype.downEquips=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this._equips[t];n||(n=new ReincarnateStarEquipVo,this._equips[t]=n),n.init(e);var o=heroControl.getSubRoleByIndex(t);o.thirteenEquipLv=n.showLv;var s=UnitMgr.ins().getEntityByHandle(o.handle);s&&s.updateModel(),this.initSkillGroup(),EventMgr.ins().dispatch(114,t)},e.prototype.initSkillGroup=function(){if(!this._skillGroups){this._skillGroups=[];for(var t in DataCenter.ins().ReincarnateStarStepLinLvConfig){var e=DataCenter.ins().ReincarnateStarStepLinLvConfig[t];for(var i in e){var n=e[i];for(var o in n){var s=n[o];if(s.skillReviseId&&s.skillReviseId.length)for(var r in s.skillReviseId){var a=s.skillReviseId[r];if(a&&a.length)for(var l=0;l<a.length;l++){var h=a[l],u=DataCenter.ins().SkillsCommonReviseConfig[h];u&&-1==this._skillGroups.indexOf(u.skill)&&this._skillGroups.push(u.skill)}}}}}}},e.prototype.getLinkSkillReviseCfg=function(t,e){if(!this._skillGroups||!this._skillGroups.length)return null;var i=t/1e3>>0;if(-1==this._skillGroups.indexOf(i))return null;var n=this.getSkillReviseIds(e,i);if(!n||!n.length)return null;for(var o,s=0;s<n.length;s++){var r=n[s];if(o){var a=DataCenter.ins().SkillsCommonReviseConfig[r];for(var l in o)"skill"!=l&&"id"!=l&&(o[l]+=a[l])}else o=CommonUtils.copyDataDepth(DataCenter.ins().SkillsCommonReviseConfig[r])}return o},e.prototype.getSkillReviseIds=function(t,e){for(var i=Object.keys(DataCenter.ins().ReincarnateStarStepLinLvConfig).length,n=heroControl.getSubRoleByIndex(t).job,o=[],s=1;i>=s;s++){var r=this.getLinkLv(t,s);if(r){var a=this.getLinkCfg(s,r);if(a.skillReviseId&&a.skillReviseId.length){var l=a.skillReviseId[n-1];if(l&&l.length)for(var h=0;h<l.length;h++){var u=l[h],p=DataCenter.ins().SkillsCommonReviseConfig[u];p&&p.skill==e&&o.push(u)}}}}return o},e.prototype.getPassiveSkills=function(t){for(var e=[],i=Object.keys(DataCenter.ins().ReincarnateStarStepSoLvConfig).length,n=1;i>=n;n++){var o=this.getZhuHunlvByPos(t,n);if(o){var s=DataCenter.ins().ReincarnateStarStepSoLvConfig[n][o];if(s&&s.passiveSkillId)for(var r=s.passiveSkillId,a=0;a<r.length;a++){var l=r[a];e.push(new SkillVo(l))}}}return e},e.prototype.dispatchSuitRed=function(){EventMgr.ins().dispatch(650)},e.prototype.hideSuitRed=function(t){var e=this._equips[t];e&&(e.suitRed=!1,this.dispatchSuitRed())},e.prototype.upHuanHua=function(t,e){return[t,e]},e.prototype.upZhuHun=function(t,e){return[t,e]},e.prototype.upYangCheng=function(t,e,i){return[t,e,i]},e.prototype.checkOpen=function(){return reincarnateControl.lv<DataCenter.ins().ReincarnateStarStepBsConfig.openLevel||GameServer.serverOpenDay<DataCenter.ins().ReincarnateStarStepBsConfig.openDay-1?!1:!0},e.prototype.getEquipIDByPos=function(t,e){var i=this._equips[t];return i&&i.equips?void 0==i.equips[e]?0:i.equips[e]:0},e.prototype.getHuanHuaByRoleID=function(t){var e=this._equips[t];return e?e.showLv:0},e.prototype.checkEquipRedByPos=function(t,e,i){if(void 0===i&&(i=null),i||(i=backpackControl.getBagItemByType(37)),!i||!i.length)return!1;for(var n=this.getEquipPowerByID(this.getEquipIDByPos(t,e)),o=i.length,s=reincarnateControl.lv,r=0;o>r;r++){var a=i[r],l=DataCenter.ins().ReincarnateStarStepConfig[a.configID];if(l&&!(a.itemConfig.zsLevel>s)&&l.slot==e){var h=this.getEquipPowerByID(l.Id);if(h>n)return!0}}return!1},e.prototype.getEquipPowerByID=function(t){if(t){var e=DataCenter.ins().ReincarnateStarStepConfig[t];if(!e)return 0;var i=0;return i+=BackpackControl.getAttrPower(e.attr),e.exPower&&(i+=e.exPower),i}return 0},e.prototype.getSuitNumByLv=function(t,e){for(var i=0,n=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,o=1;n>=o;o++){var s=this.getEquipIDByPos(e,o);s&&DataCenter.ins().ReincarnateStarStepConfig[s].star>=t&&i++}return i},e.prototype.checkComRedByPos=function(t,e,i){var n=this.getEquipIDByPos(t,e);if(!n)return!1;var o=DataCenter.ins().ReincarnateStarStepComConfig[i][e];if(o.wearId!=n)return!1;var s=backpackControl.getBagGoodsCountById(0,o.muben.id);return s<o.muben.count?!1:(s=backpackControl.getBagGoodsCountById(0,o.material.id),s<o.material.count?!1:!0)},e.prototype.checkComRedByLv=function(t,e){for(var i=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,n=1;i>=n;n++)if(this.checkComRedByPos(t,n,e))return!0;return!1},e.prototype.checkEquipRedByRoleID=function(t){for(var e=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,i=reincarnateStarControl.point,n=backpackControl.getBagItemByType(37),o=1;e>=o;o++)if(!(o>i)&&(this.checkEquipRedByPos(t,o,n)||this.checkZhuHunRedByPos(t,o)))return!0;return this.showSuitInEquip()&&this.checkSuitRedByRoleID(t)?!0:!1},e.prototype.checkEquipRed=function(){if(!this.checkOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkEquipRedByRoleID(e))return!0;return!1},e.prototype.checkComRedByRoleID=function(t){for(var e=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv,i=2;e>=i;i++)if(this.checkComRedByLv(t,i))return!0;return!1},e.prototype.checkComposeRed=function(){if(!this.checkOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkComRedByRoleID(e))return!0;return!1},e.prototype.checkSuitRed=function(){if(!this.checkOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkSuitRedByRoleID(e))return!0;return!1},e.prototype.checkSuitRedByRoleID=function(t){var e=this._equips[t];return e&&e.suitRed?!0:!1},e.prototype.getSuitMaxLv=function(t){for(var e=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv,i=0,n=1;e>=n;n++)this.getSuitNumByLv(n,t)==DataCenter.ins().ReincarnateStarStepBsConfig.equipCount&&(i=n);return i},e.prototype.getSuiltAttStr=function(t,e,i,n){void 0===n&&(n=0);var o=DataCenter.ins().ReincarnateStarStepSuitConfig[e][t],s=AttributeData.getAttStrEx(o.baseAttrs,0,1,":");return o.exAttrs&&(s+="\n"+AttributeData.getAttStrEx(o.exAttrs,0,1,":")),o.ex_attrs&&(s+="\n"+AttributeData.getAttStrEx(o.ex_attrs,0,1,":")),o.masterEquipPre&&(s+=LangMgr.getValueByKey("zzequipsx")+o.masterEquipPre+"%"),o.thunderEquipPre&&(s+=LangMgr.getValueByKey("ltequipsx")+o.thunderEquipPre+"%"),o.zhizunEquipPre&&(s+=LangMgr.getValueByKey("zzunequipsx")+o.zhizunEquipPre+"%"),o.darkEquipPre&&(s+=LangMgr.getValueByKey("andianequipsx")+o.darkEquipPre+"%"),"|C:"+(n?n:i)+"&T:"+s+"|"},e.prototype.getSuiltSepcialAttStr=function(t,e){var i=DataCenter.ins().ReincarnateStarStepSuitConfig[e][t],n=""+AttributeData.getAttStrEx(i.exAttrs,0,1,":");return i.ex_attrs&&(n+="\n"+AttributeData.getAttStrEx(i.ex_attrs,0,1,":")),i.masterEquipPre&&(n+=LangMgr.getValueByKey("zzequipsx")+i.masterEquipPre+"%"),i.thunderEquipPre&&(n+=LangMgr.getValueByKey("ltequipsx")+i.thunderEquipPre+"%"),i.zhizunEquipPre&&(n+=LangMgr.getValueByKey("zzunequipsx")+i.zhizunEquipPre+"%"),i.darkEquipPre&&(n+=LangMgr.getValueByKey("andianequipsx")+i.darkEquipPre+"%"),n},e.prototype.getZhuHunlvByPos=function(t,e){var i=this._equips[t];return i&&i.zhuHuns&&i.zhuHuns[e]?i.zhuHuns[e]:0},e.prototype.checkZhuHunOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().ReincarnateStarStepBsConfig.soulLimitDay-1?!1:reincarnateControl.lv<DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1?!1:!0},e.prototype.checkZhuHunOpenByPos=function(t){var e=reincarnateControl.lv,i=DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1;if(i>e)return!1;if(e>i)return!0;var n=DataCenter.ins().ReincarnateStarStepZsLvConfig[reincarnateStarControl.point].starLv;return DataCenter.ins().ReincarnateStarStepBsConfig.soulLimitLevel[t-1]<=n},e.prototype.checkZhuHunRedByPos=function(t,e){if(!this.checkZhuHunOpen())return!1;if(!this.checkZhuHunOpenByPos(e))return!1;var i=this.getZhuHunlvByPos(t,e);if(i>=Object.keys(DataCenter.ins().ReincarnateStarStepSoLvConfig[e]).length)return!1;if(!this.getEquipIDByPos(t,e))return!1;var n=DataCenter.ins().ReincarnateStarStepSoLvConfig[e][i+1].materialInfo;return n.count<=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,n.id)?!0:!1},e.prototype.getZhuHunAddAttrs=function(t,e){if(!t)return null;var i=DataCenter.ins().ReincarnateStarStepConfig[t];if(!i||!i.attr)return null;var n=[];for(var o in i.attr){var s=i.attr[o];n.push(new AttributeData(s.type,Math.floor(s.value*e/100)))}return n},e.prototype.getLinkLv=function(t,e){var i=this.getZhuHunlvByPos(t,e);if(!i)return 0;var n=DataCenter.ins().ReincarnateStarStepLinLvConfig[e],o=0;for(var s in n){o=this.getZhuHunlvByPos(t,+s);break}return Math.min(i,o)},e.prototype.getLinkCfg=function(t,e){if(!e)return null;var i=DataCenter.ins().ReincarnateStarStepLinLvConfig[t];for(var n in i)return i[n][e];return null},e.prototype.getZhunHunPowerByPos=function(t,e){var i=this.getZhuHunlvByPos(t,e);if(!i)return 0;var n=this.getEquipIDByPos(t,e),o=DataCenter.ins().ReincarnateStarStepSoLvConfig[e][i],s=[],r=0;if(s=s.concat(o.attrs.concat()),o.ex_power&&(r+=o.ex_power),n&&o.addPrecent&&(s=s.concat(this.getZhuHunAddAttrs(n,o.addPrecent))),o.addBasePrecent&&o.addBasePrecent.precent){var a=BackpackControl.getEquipAddAttrsByPos(t,o.addBasePrecent.pos,o.addBasePrecent.precent);a&&a.length&&(s=s.concat(a))}var l=this.getLinkLv(t,e);if(l){var h=this.getLinkCfg(e,l);if(h.attrs){var u=heroControl.getSubRoleByIndex(t).job,p=h.attrs[u-1];p&&p.length&&(s=s.concat(p.concat()))}if(h.addPrecent&&h.addPrecent.length)for(var c in h.addPrecent){var d=h.addPrecent[c];n=this.getEquipIDByPos(t,d.pos),n&&d.precent&&(s=s.concat(this.getZhuHunAddAttrs(n,d.precent)))}}return s=AttributeData.combineAtts(s),BackpackControl.getAttPowerContainRelate(s,t)+r},e.prototype.checkQHRed=function(){if(!this.checkQHOpen())return!1;for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkQHRedByRoleID(e))return!0;return!1},e.prototype.checkQHRedByRoleID=function(t){for(var e=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,i=reincarnateStarControl.point,n=1;e>=n;n++)if(!(n>i)&&this.checkQHRedByPos(t,n))return!0;return!1},e.prototype.checkQHOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().ReincarnateStarStepBsConfig.slotLevelLimitDay-1?!1:!0},e.prototype.getQHPowerByPos=function(t,e){return 0},e.prototype.getQHTotallvByPos=function(t,e){var i=this._equips[t];if(!i||!i.yangchengs||!i.yangchengs[e])return 0;for(var n=0,o=1;5>=o;o++)n+=i.yangchengs[e][o];return n},e.prototype.getQHlvByPos=function(t,e,i){var n=this._equips[t];return n&&n.yangchengs&&n.yangchengs[e]?n.yangchengs[e][i]:0},e.prototype.getQHConditionConfig=function(t,e,i){var n=this._equips[t];if(!n||!n.yangchengs||!n.yangchengs[e])return!1;var o=n.yangchengs[e],s=DataCenter.ins().ReincarnateStarStepSoConConfig[e];if(!s)return!1;var r=s[i];if(r&&o){for(var a=0;a<r.condition.length;a++){var l=r.condition[a].slot;if(!o[l])return!1;if(o[l]<r.condition[a].lv)return!1}return!0}return r?!1:!0},e.prototype.getQHSlotLevelConfig=function(t,e,i){var n,o=this._equips[t],s=o.yangchengs[e];if(s){var r=s[i]+1;n=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][i][r]}else n=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][i][1];return n},e.prototype.getQHCostByKong=function(t){if(t){var e=backpackControl.getBagGoodsCountById(0,t.materialInfo.id),i=t.materialInfo.count;return e>=i}return!1},e.prototype.getQHDifAttrs=function(t,e,i){var n,o=[],s=this._equips[t],r=s.yangchengs[e];if(r&&r[i]){var a=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][i][r[i]+1];if(a&&(n=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][i][r[i]]))for(var l=0;l<a.attrs.length;l++)if(n.attrs[l]&&a.attrs[l].type==n.attrs[l].type){var h=new AttributeData;h.type=a.attrs[l].type,h.value=a.attrs[l].value-n.attrs[l].value,o.push(h)}}else{n=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][i][1];for(var l=0;l<n.attrs.length;l++){var h=new AttributeData;h.type=n.attrs[l].type,h.value=n.attrs[l].value,o.push(h)}}return o},e.prototype.getQHOneAttrs=function(t,e,i){var n=[],o=this.getQHlvByPos(t,e,i),s=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][i][o];if(s)for(var r=0;r<s.attrs.length;r++){var a=new AttributeData;a.type=s.attrs[r].type,a.value=s.attrs[r].value,n.push(a)}else n=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)];return n},e.prototype.getQHALLAttrs=function(t,e,i){for(var n=i?i:[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],o=1;5>=o;o++){var s=this.getQHlvByPos(t,e,o),r=DataCenter.ins().ReincarnateStarStepSlotLvConfig[e][o][s];if(r)for(var a=0;a<r.attrs.length;a++){for(var l=!1,h=0;h<n.length;h++)if(n[h].type==r.attrs[a].type){n[h].value+=r.attrs[a].value,l=!0;break}if(!l){var u=new AttributeData;u.type=r.attrs[a].type,u.value=r.attrs[a].value,n.push(u)}}}return n},e.prototype.checkQHRedByPos=function(t,e){if(!this.checkQHOpen())return!1;if(!this.getEquipIDByPos(t,e))return!1;for(var i=1;5>=i;i++){var n=this.getQHConditionConfig(t,e,i);if(n){var o=this.getQHSlotLevelConfig(t,e,i);if(o){var s=this.getQHCostByKong(o);if(s)return!0}}}return!1},e.prototype.getQHAttrs=function(t,e,i){for(var n=e?e:[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],o=e?e:[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],s=this._equips[t].equips,r=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,a=1;r>=a;a++)if(s[a])for(var l=this.getQHALLAttrs(t,a),h=this.getThirteenZSEquipSlotSum(t,a),u=0;u<l.length;u++)n[u].type==l[u].type&&(n[u].value+=l[u].value,l[u].value*=h?h.addSlotPrecent/100:1,o[u].value+=l[u].value);return[n,o]},e.prototype.getThirteenZSEquipSlotSum=function(t,e){var i=this._equips[t].equips;if(i[e]){var n=this.getQHTotallvByPos(t,e);if(n){var o=[];for(var s in DataCenter.ins().ReincarnateStarStepSoSumConfig[e])o.push(DataCenter.ins().ReincarnateStarStepSoSumConfig[e][s]);o.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var r=0;r<o.length;r++){var a=o[r];if(n>=a.totalLevel)return a}}}return null},e.prototype.getBasePower=function(t,e){var i=0,n=heroControl.getSubRoleByIndex(t),o=this._equips[t].equips;if(o[e]){var s=this.getQHTotallvByPos(t,e);if(s){var r=[];for(var a in DataCenter.ins().ReincarnateStarStepSoSumConfig[e])r.push(DataCenter.ins().ReincarnateStarStepSoSumConfig[e][a]);r.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var l=0;l<r.length;l++){var h=r[l];if(h.attr&&s>=h.totalLevel){var u=thunderControl.getBaseAttrs(n,e);for(var a in u)u[a].value*=h.addBasePrecent.precent/100,u[a].value=u[a].value>>0;i+=BackpackControl.getAttrPower(u);break}}}}return i},e.prototype.showSuitInEquip=function(){return GameServer.serverOpenDay+1>=DataCenter.ins().ReincarnateStarStepBsConfig.suitChangeDay},e.prototype.getZhuHunlvById=function(t){var e=this._equips[t];return e?e:null},__decorate([up(20,[1,1,3])],e.prototype,"upChangeEquip",null),__decorate([up(21,[1,1])],e.prototype,"upCompose",null),__decorate([down(21,[0])],e.prototype,"downCompose",null),__decorate([down(22,[4].concat(ByteConst.ReincarnateStarEquipVos))],e.prototype,"downEquips",null),__decorate([up(23,[1,1])],e.prototype,"upHuanHua",null),__decorate([up(31,[1,1])],e.prototype,"upZhuHun",null),__decorate([up(32,[1,1,1])],e.prototype,"upYangCheng",null),e=__decorate([protocolsId(4)],e)}(BaseSystem);__reflect(ReincarnateStarEquipControl.prototype,"ReincarnateStarEquipControl");var ReincarnateStarEquipVo=function(){function t(){this.showLv=0,this.lastLen=0,this.showLv=0,this.lastLen=0}return t.prototype.init=function(t){this.showLv=t[0];var e=0;this.equips=[],this.zhuHuns=[],this.yangchengs=[];for(var i=0;t[1].length>i;i++){var n=t[1][i],o=n[0];this.equips[o]=n[1],this.zhuHuns[o]=n[2],this.yangchengs[o]=[0,0,0,0,0,0];for(var s=0;n[3].length>s;s++){var r=n[3][s][0];this.yangchengs[o][r]=n[3][s][1]}this.equips[o]&&e++}var a=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount;a>e?this.suitRed=!1:e==a&&this.lastLen<a&&this.lastLen>0&&(this.suitRed=!0),this.lastLen=e},t}();__reflect(ReincarnateStarEquipVo.prototype,"ReincarnateStarEquipVo");var ReincarnateStarEquipChangeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarEquipChangeViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ReincarnateStarEquipChangeItemRenderer,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._pos=t[0],this._itemID=t[1],this._roleID=t[2],this.addCustomEvent(266,this.update),this.addCustomEvent(267,this.update),this.addCustomEvent(268,this.update),this.addEventTouchTap(this.bgClose,this.onClose),this.update()},e.prototype.update=function(){var t=backpackControl.getBagItemByType(37).concat();if(t.length){for(var e=reincarnateStarEquipControl.getEquipPowerByID(this._itemID),i=t.length,n=reincarnateControl.lv,o=[],s=0;i>s;s++){var r=t[s],a=DataCenter.ins().ReincarnateStarStepConfig[r.configID];a&&(r.itemConfig.zsLevel>n||a.slot==this._pos)&&o.push({itemData:r,curPower:e,isFirst:!1,roleID:this._roleID})}o.length&&(o.sort(this.sort),o[0].isFirst=!0),this._col.source=o}else this._col.source=null},e.prototype.sort=function(t,e){var i=reincarnateStarEquipControl.getEquipPowerByID(t.itemData.configID),n=reincarnateStarEquipControl.getEquipPowerByID(e.itemData.configID);
return i>n?-1:n>i?1:0},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(ReincarnateStarEquipChangeView.prototype,"ReincarnateStarEquipChangeView");var ReincarnateStarEquipPanel=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this.addCustomEvent(114,this.update),this.addCustomEvent(266,this.itemChange),this.addCustomEvent(267,this.itemChange),this.addCustomEvent(268,this.itemChange),this.addCustomEvent(648,this.updateSuitInfo),this.addEventTouchTap(this,this.onTouch),this.update(this._curRole),this.updateSuitInfo()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch),this.clearMc(),this._body&&(this._body.destroy(),this._body=null)},e.prototype.update=function(t){if(t==this._curRole){this.clearMc(),this._lineEffs=[];for(var e=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,i=reincarnateStarControl.point,n=backpackControl.getBagItemByType(37),o=0,s={},r=1;e>=r;r++){var a=reincarnateStarEquipControl.getEquipIDByPos(this._curRole,r),l=i>=r;if(this["item"+r].data={pos:r,unLock:l,itemID:a,showRed:l?reincarnateStarEquipControl.checkEquipRedByPos(this._curRole,r,n)||reincarnateStarEquipControl.checkZhuHunRedByPos(this._curRole,r):!1,zhuHunLv:a?reincarnateStarEquipControl.getZhuHunlvByPos(this._curRole,r):0},a){var h=DataCenter.ins().ReincarnateStarStepConfig[a];if(h.lineEff){var u=ObjectPool.pop("GameMovieClip");this["lineGroup"+r].addChild(u),u.playFile(""+PATH_EFF+h.lineEff,-1),this._lineEffs.push(u)}o+=reincarnateStarEquipControl.getEquipPowerByID(a);for(var p=h.star;p>0;p--)s[p]?s[p]++:s[p]=1}o+=reincarnateStarEquipControl.getZhunHunPowerByPos(this._curRole,r)}var c=1;e=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv;for(var d=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,g=[],r=e;r>0;r--){var m=s[r]?s[r]:0;if(0!=m){if(m==d){o+=this.getSpecailSuitPower(d,r,g),c=r+1;break}o+=this.getSpecailSuitPower(m%2==0?m:m-1,r,g)}}this.powerPanel.setPower(o),c>e&&(c=e),this._body||(this._body=ObjectPool.pop("GameMovieClip"));var f=heroControl.getSubRoleByIndex(this._curRole).sex;this.effGroup.addChild(this._body),this._body.playFile(PATH_EFF+DataCenter.ins().ReincarnateStarStepBsConfig.bodyEff[c-1]+"_"+f+"_13_eff",-1)}},e.prototype.itemChange=function(){this.update(this._curRole)},e.prototype.onTouch=function(t){if(t.target.parent instanceof ReincarnateStarEquipItemRenderer){var e=t.target.parent.data;e.unLock?e.itemID?UIMgr.ins().open(ReincarnateStarEquipTipsView,e.itemID,this._curRole):UIMgr.ins().open(ReincarnateStarEquipChangeView,e.pos,e.itemID,this._curRole):tipsControl.showTips(LangMgr.getValueByKey("partunlocked"))}else t.target==this.suitBtn&&UIMgr.ins().open(ReincarnateStarSuitView,this._curRole)},e.prototype.getSpecailSuitPower=function(t,e,i){for(var n=0;t>0;)-1==i.indexOf(t)&&(n+=this.getSuitPower(e,t),i.push(t)),t-=2;return n},e.prototype.getSuitPower=function(t,e){var i=DataCenter.ins().ReincarnateStarStepSuitConfig[e][t];if(!i)return 0;var n=BackpackControl.getAttrPower(i.baseAttrs);i.ex_power&&(n+=i.ex_power);var o=heroControl.getSubRoleByIndex(this._curRole);if(i.exAttrs){for(var s=i.exAttrs.length,r=0;s>r;r++)n+=ItemUtils.relatePower(i.exAttrs[r],o);var a=ItemUtils.relatePowerEx(i.exAttrs,o);a&&a.length&&(n+=BackpackControl.getAttrPower(a))}return n},e.prototype.clearMc=function(){if(this._lineEffs&&this._lineEffs.length)for(;this._lineEffs.length;){var t=this._lineEffs.shift();t&&(t.destroy(),t=null)}},e.prototype.updateSuitInfo=function(){var t=reincarnateStarEquipControl.showSuitInEquip();this.suitBtn.visible=t,this.suitBtnRedPoint.visible=t&&reincarnateStarEquipControl.checkSuitRedByRoleID(this._curRole)},e}(BasePanel);__reflect(ReincarnateStarEquipPanel.prototype,"ReincarnateStarEquipPanel");var ReincarnateStarEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._itemID=t[0],this._roleID=t.length>1?t[1]:-1,this.addCustomEvent(266,this.updateRed),this.addCustomEvent(267,this.updateRed),this.addCustomEvent(268,this.updateRed),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){var t=DataCenter.ins().ItemConfig[this._itemID];this.itemIcon.setData(t);var e=DataCenter.ins().ReincarnateStarStepConfig[this._itemID];this._pos=e.slot,this.type.text=LangMgr.getValueByKey("equipPosName"+DataCenter.ins().ReincarnateStarStepBsConfig.posChange[this._pos-1]),this.lv.text=LangMgr.getValueByKey("numberRotation",t.zsLevel);var i=reincarnateStarEquipControl.getEquipPowerByID(this._itemID);this.score.text=LangMgr.getValueByKey("wingPingfen",i),this.powerPanel.setPower(i);var n=AttributeData.getAttStr(e.attr,0,1,":");e.ex_attr&&(n+="\n"+AttributeData.getAttStrEx(e.ex_attr,0,1,":")),this.baseAttr.textFlow=TextUtils.generateTextFlow(n),this.suitName.text=DataCenter.ins().ReincarnateStarStepBsConfig.levelName[e.star-1];var o=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,s=-1==this._roleID?1:reincarnateStarEquipControl.getSuitNumByLv(e.star,this._roleID);this.suitNum.textFlow=TextUtils.generateTextFlow("|C:"+(o>s?16711680:65280)+"&T:("+s+"/"+o+")|");for(var r=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount/2,a=1;r>=a;a++){var l=2*a;this["suitState"+l].textFlow=TextUtils.generateTextFlow("|C:"+(s>=l?65280:6710886)+"&T:【"+l+LangMgr.getValueByKey("HunJ")+"】|"),this["suitAttr"+l].textFlow=TextUtils.generateTextFlow(reincarnateStarEquipControl.getSuiltAttStr(e.star,l,65280,l>s?6710886:0))}this.downBtn.visible=this.changeBtn.visible=-1!=this._roleID,this.soulBtn.visible=-1!=this._roleID&&reincarnateStarEquipControl.checkZhuHunOpen();var h="";if(this.soulTag.visible=!1,-1!=this._roleID){var u=reincarnateStarEquipControl.getZhuHunlvByPos(this._roleID,this._pos);if(u){var p=DataCenter.ins().ReincarnateStarStepSoLvConfig[this._pos][u];this.soulAttr.textFlow=TextUtils.generateTextFlow(p.addPrecent?AttributeData.getAttStrEx(reincarnateStarEquipControl.getZhuHunAddAttrs(this._itemID,p.addPrecent),4,1,"+"):""),p.passiveSkillId&&p.passiveSkillId.length?(this.talentName.text=DataCenter.ins().ReincarnateStarStepSoLvConfig[p.slot][1].passiveSkillName,this.talentLv.text="Lv"+u,this.talentDesc.textFlow=TextUtils.generateTextFlow(p.passiveSkillDesc)):DisplayUtils.removeFromParent(this.soulTalent);var c=reincarnateStarEquipControl.getLinkLv(this._roleID,this._pos),d=reincarnateStarEquipControl.getLinkCfg(this._pos,c?c:1);this.chainLv.text="Lv"+c,this.chainAttr.textFlow=TextUtils.generateTextFlow("|C:"+(c?16776960:6710886)+"&T:"+d.chainDesc[heroControl.getSubRoleByIndex(this._roleID).job-1]+"|"),h=DataCenter.ins().ReincarnateStarStepBsConfig.soulPrefix[u-1]+"•",this.soulTag.source=DataCenter.ins().ReincarnateStarStepBsConfig.soulLvTag[u-1],this.soulTag.visible=!0}else this.removeZhuHunGroup()}else this.removeZhuHunGroup();this.nameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t)+"&T:|"+(h+t.name)),this.updateRed(),this.updateJilian()},e.prototype.updateRed=function(){this.redPoint.visible=-1==this._roleID?!1:reincarnateStarEquipControl.checkEquipRedByPos(this._roleID,this._pos),this.redPoint1.visible=-1==this._roleID?!1:reincarnateStarEquipControl.checkZhuHunRedByPos(this._roleID,this._pos)},e.prototype.onTouch=function(t){switch(t.target){case this.downBtn:reincarnateStarEquipControl.upChangeEquip(this._roleID,this._pos,0),UIMgr.ins().close(this);break;case this.changeBtn:UIMgr.ins().open(ReincarnateStarEquipChangeView,this._pos,this._itemID,this._roleID);break;case this.bgClose:UIMgr.ins().close(this);break;case this.soulBtn:UIMgr.ins().open(ReincarnateStarSoulView,this._roleID,this._pos),UIMgr.ins().close(this)}},e.prototype.removeZhuHunGroup=function(){DisplayUtils.removeFromParent(this.soulGroup),this.soulAttr.visible=!1},e.prototype.updateJilian=function(){var t=reincarnateStarEquipControl.getQHTotallvByPos(this._roleID,this._pos);if(!t)return void DisplayUtils.removeFromParent(this.slotGroup);for(var e=reincarnateStarEquipControl.getQHALLAttrs(this._roleID,this._pos),i=0;i<e.length;i++){var n=this["att"+(i+1)+"Lable"];n&&(e[i].value?n.text=AttributeData.getAttrStrByType(e[i].type)+"+"+e[i].value:DisplayUtils.removeFromParent(n))}var o=[];for(var s in DataCenter.ins().ReincarnateStarStepSoSumConfig[this._pos])o.push(DataCenter.ins().ReincarnateStarStepSoSumConfig[this._pos][s]);o.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var r,a=0,i=0;i<o.length;i++){var l=o[i];if(a++,t>=l.totalLevel){r=l;break}}if(!r)return DisplayUtils.removeFromParent(this.slotalllevelLable),void DisplayUtils.removeFromParent(this.bazhusuxingLable);var h=o.length-a+1;this.slotalllevelLable.text="【"+LangMgr.getValueByKey("bazhuzhixinlv",h)+"】",this.bazhusuxingLable.text=LangMgr.getValueByKey("bazhubuweisx",RoleModel.getEquipNameByType(DataCenter.ins().ReincarnateStarStepBsConfig.posChange[this._pos-1]),r?r.addSlotPrecent:0)},e}(BaseEuiView);__reflect(ReincarnateStarEquipTipsView.prototype,"ReincarnateStarEquipTipsView");var ReincarnateStarSlotPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.getItemTxt,this.onTap),this.addLongPress(this.upGradeBtn,this.onLongTap),this.addEventTouchTap(this.suitAttr,this.onTap),this.addEventTouchTap(this.icon,this.onTap);for(var i=1;i<=this.equips.numElements;i++)this.addEventTouchTap(this["item"+i],this.onTap);for(var i=1;i<=this.equipUps.numElements;i++)this.addEventTouchTap(this["equipUp"+i],this.onClick);this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(114,this.UpdataThirteenEquip),this.roleId=t[0]?t[0]:0,this.kong=1,this.setRoleId(this.roleId)},e.prototype.close=function(){},e.prototype.onLongTap=function(t){this.onTap({currentTarget:t})},e.prototype.onTap=function(t){switch(t.currentTarget){case this.upGradeBtn:var e=reincarnateStarEquipControl.getQHConditionConfig(this.roleId,this.slot,this.kong);if(!e){var i=DataCenter.ins().ReincarnateStarStepSoConConfig[this.slot][this.kong];if(i){for(var n="",o=1;o<=i.condition.length;o++){var s=DataCenter.ins().ReincarnateStarStepBsConfig.slotName[i.condition[o].slot];n+=s+LangMgr.getValueByKey("thunerForge1",i.condition[o].lv),o+1<i.condition.length&&(n+=",")}return n+=LangMgr.getValueByKey("commonUnlock")+DataCenter.ins().ReincarnateStarStepBsConfig.slotName[this.kong],void tipsControl.showTips(n)}}if(!reincarnateStarEquipControl.getEquipIDByPos(this.roleId,this.slot))return void tipsControl.showTips(LangMgr.getValueByKey("notequipspirit"));var r=reincarnateStarEquipControl.getQHSlotLevelConfig(this.roleId,this.slot,this.kong);if(!r)return void tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));if(!reincarnateStarEquipControl.getQHCostByKong(r))return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));reincarnateStarEquipControl.upYangCheng(this.roleId,this.slot,this.kong);break;case this.getItemTxt:warnControl.setBuyGoodsWarn(this.costId);break;case this.suitAttr:UIMgr.ins().open(ReincarnateStarSlotTipsView,this.roleId,this.slot);break;case this.icon:CommonFun.viewItemTips(this.iconid);break;default:for(var o=1;o<=this.equips.numElements;o++){if(this["item"+o]&&t.currentTarget==this["item"+o]){var a=reincarnateStarControl.point,l=a>=o;if(!l)return void tipsControl.showTips(LangMgr.getValueByKey("ununlockedpart"));if(!reincarnateStarEquipControl.getEquipIDByPos(this.roleId,o))return void tipsControl.showTips(LangMgr.getValueByKey("partnotbzequip"));if(this.slot==o)return void UIMgr.ins().open(ReincarnateStarEquipTipsView,reincarnateStarEquipControl.getEquipIDByPos(this.roleId,o),this.roleId);this.slot=o,this.updateKongIndex()}this.updateView()}}},e.prototype.onClick=function(t){for(var e=this["equipUp"+this.kong],i=!1,n=-1,o=!1,s=1;s<=this.equipUps.numElements;s++)this["equipUp"+s]&&(this["equipUp"+s].select.visible=!1,t.currentTarget==this["equipUp"+s]&&(n=s,o=this.kong==s,i=reincarnateStarEquipControl.getQHConditionConfig(this.roleId,this.slot,s),i&&(this["equipUp"+s].select.visible=!0,this.kong=s)));if(!i&&n>0){e.select.visible=!0;var r=DataCenter.ins().ReincarnateStarStepSoConConfig[this.slot][n];if(r){for(var a="",s=0;s<r.condition.length;s++){var l=DataCenter.ins().ReincarnateStarStepBsConfig.slotName[r.condition[s].slot-1];a+=l+LangMgr.getValueByKey("thunerForge1",r.condition[s].lv),s+1<r.condition.length&&(a+=",")}return a+=LangMgr.getValueByKey("commonUnlock")+DataCenter.ins().ReincarnateStarStepBsConfig.slotName[n-1],void tipsControl.showCenterTips("|C:0xff0000&T:"+a)}}this.updateView()},e.prototype.UpdataThirteenEquip=function(){this.playMc(),this.updateKongIndex(),this.updateView()},e.prototype.playMc=function(){if(this.equipUpEff0){var t=new GameMovieClip;t.playFile(PATH_EFF+"leitingcuilianchenggong",1),this.equipUpEff0.addChild(t)}if(this["equipUp"+this.kong]){var t=new GameMovieClip,e=DataCenter.ins().ReincarnateStarStepBsConfig.slotIcon[this.kong-1];t.playFile(PATH_EFF+e[1]+"_small",1),this["equipUp"+this.kong].leveleff.addChild(t)}},e.prototype.playeff=function(){null==this.effmc&&(this.effmc=new GameMovieClip,this.effmc.touchEnabled=!1,this.effGroup.addChild(this.effmc),this.effGroup.touchChildren=!1,this.effGroup.touchEnabled=!1);for(var t=1,e=1;5>=e;e++){var i=reincarnateStarEquipControl.getQHConditionConfig(this.roleId,this.slot,e);if(!i)break;t=e}var n=DataCenter.ins().ReincarnateStarStepBsConfig.slotIcon[t-1];""!=n[2]&&this.effmc.playFile(PATH_EFF+n[2],-1)},e.prototype.setRoleId=function(t){this.roleId=t,this.slot=this.defaultSlot(),this.updateKongIndex(),this.updateView()},e.prototype.updateView=function(){this.playeff(),this.updateEquipUps(),this.updateAttr(),this.updateCost(),this.updateEquips(),this.updatNextNum()},e.prototype.updateKongIndex=function(){var t=reincarnateStarEquipControl.getQHSlotLevelConfig(this.roleId,this.slot,this.kong);if(t){var e=reincarnateStarEquipControl.getQHConditionConfig(this.roleId,this.slot,this.kong);if(e)return}for(var i=0;i<DataCenter.ins().ReincarnateStarStepBsConfig.slotName.length;i++){var n=reincarnateStarEquipControl.getQHSlotLevelConfig(this.roleId,this.slot,i+1);if(n){this.kong=i+1;break}}},e.prototype.updateEquips=function(){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,e=reincarnateStarControl.point,i=1;t>=i;i++){var n=reincarnateStarEquipControl.getEquipIDByPos(this.roleId,i),o=e>=i;this["item"+i].data={pos:i,unLock:o,itemID:n,showRed:o?reincarnateStarEquipControl.checkQHRedByPos(this.roleId,i):!1,isselect:i==this.slot,isshowlevel:o,unshoweff:!0,nlevel:reincarnateStarEquipControl.getQHTotallvByPos(this.roleId,i)}}},e.prototype.updateEquipUps=function(){for(var t=1;t<=this.equipUps.numElements;t++){var e=this["equipUp"+t];if(e)if(t>DataCenter.ins().ReincarnateStarStepBsConfig.slotName.length)e.visible=!1;else{e.visible=!0,e.redPoint.visible=!1;var i=reincarnateStarEquipControl.getQHConditionConfig(this.roleId,this.slot,t);if(i){var n=reincarnateStarEquipControl.getQHSlotLevelConfig(this.roleId,this.slot,t);n&&(e.redPoint.visible=reincarnateStarEquipControl.getQHCostByKong(n))}e.lvNum.text=reincarnateStarEquipControl.getQHlvByPos(this.roleId,this.slot,t)+"",e.lvGroup.visible=i?!0:!1,e.select.visible=this.kong==t,e.nameImg.source=DataCenter.ins().ReincarnateStarStepBsConfig.slotIcon[t-1][0];var o=e.eff.numChildren,s=void 0;if(o?s=e.eff.getChildAt(0):(s=new GameMovieClip,e.eff.addChildAt(s,0)),e.lvGroup.visible){var r=DataCenter.ins().ReincarnateStarStepBsConfig.slotIcon[t-1];s.playFile(PATH_EFF+r[1]+"_big",-1)}else s.playFile(PATH_EFF+"thirteenQHslot0",-1)}}this.slotselectdirImg.source="ThirteenZQHslotsdir"+this.kong},e.prototype.updateCost=function(){var t=reincarnateStarEquipControl.getQHSlotLevelConfig(this.roleId,this.slot,this.kong);if(t){this.upInfo.visible=!0;var e=ColorUtils.RED,i=backpackControl.getBagGoodsCountById(0,t.materialInfo.id),n=t.materialInfo.count;i>=n&&(e=ColorUtils.GREEN),this.iconid=t.materialInfo.id,this.icon.source=DataCenter.ins().ItemConfig[this.iconid].icon+"_png",this.countLabel.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+i+"|/"+n),this.costId=t.materialInfo.id}else this.upInfo.visible=!1,this.costId=0;this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.visible=this.costId?!0:!1,this.maxlv.visible=!this.upInfo.visible,this.redPoint0.visible=!1;var o=reincarnateStarEquipControl.getQHConditionConfig(this.roleId,this.slot,this.kong);o&&t&&(this.redPoint0.visible=reincarnateStarEquipControl.getQHCostByKong(t))},e.prototype.updateAttr=function(){for(var t=reincarnateStarEquipControl.getQHAttrs(this.roleId),e=t[0],i=t[1],n=BackpackControl.getAttrPower(i),o=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,s=1;o>=s;s++)n+=reincarnateStarEquipControl.getBasePower(this.roleId,s);this.powerPanel0.setPower(n);for(var r=reincarnateStarEquipControl.getQHDifAttrs(this.roleId,this.slot,this.kong),s=0;s<e.length;s++)this["attr"+e[s].type]&&(this["attr"+e[s].type].text=AttributeData.getAttrStrByType(e[s].type)+"+"+e[s].value,this["addAttr"+e[s].type].visible=r.length?!0:!1,r.length?r[s]&&(this["addAttr"+e[s].type].visible=this["arrow"+e[s].type].visible=r[s].value?!0:!1,this["addAttr"+e[s].type].text=e[s].value+r[s].value+""):this["addAttr"+e[s].type].visible=this["arrow"+e[s].type].visible=!1)},e.prototype.defaultSlot=function(){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,e=[],i=1;t>=i;i++)if(reincarnateStarEquipControl.getEquipIDByPos(this.roleId,i)&&(e.push(i),reincarnateStarEquipControl.checkQHRedByPos(this.roleId,i)))return i;return e[0]},e.prototype.updatNextNum=function(){var t=reincarnateStarEquipControl.getQHTotallvByPos(this.roleId,this.slot),e=[];for(var i in DataCenter.ins().ReincarnateStarStepSoSumConfig[this.slot])e.push(DataCenter.ins().ReincarnateStarStepSoSumConfig[this.slot][i]);e.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var n=e[e.length-1],o=!1,s=0,i=0;i<e.length;i++){var r=e[i];if(s++,t>=r.totalLevel){o=1==s,o||(n=e[s-2]);break}}this.nextLvNum.text=n.totalLevel,this.nextLvGroup.visible=!o},e}(BasePanel);__reflect(ReincarnateStarSlotPanel.prototype,"ReincarnateStarSlotPanel");var ReincarnateStarSlotTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarSlotTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.roleId=t[0],this.slot=t[1],this.updateActive(),this.updateView()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateActive=function(){this.totalLevel=0,this.suitLv=1,this.totalLevel=reincarnateStarEquipControl.getQHTotallvByPos(this.roleId,this.slot);var t=[];for(var e in DataCenter.ins().ReincarnateStarStepSoSumConfig[this.slot])t.push(DataCenter.ins().ReincarnateStarStepSoSumConfig[this.slot][e]);t.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});var i=!1;if(this.totalLevel){for(var n=0,o=0;o<t.length;o++){var s=t[o];if(n++,this.totalLevel>=s.totalLevel){this.suitConfig=s,i=1==n,i||(this.nextsuitConfig=t[n-2]);break}}this.suitLv=t.length-n+1}this.suitConfig?i?this.currentState="max":this.currentState="active":(this.currentState="unactive",this.suitConfig=t[t.length-1]),this.validateNow()},e.prototype.updateView=function(){this.setCurDesc(),this.setNextDesc()},e.prototype.setCurDesc=function(){this.name0.text=LangMgr.getValueByKey("bazhuzhixinlv",this.suitLv);var t="";t+=LangMgr.getValueByKey("bazhubuweisx",RoleModel.getEquipNameByType(DataCenter.ins().ReincarnateStarStepBsConfig.posChange[this.slot-1]),this.suitConfig.addSlotPrecent),this.content0.textFlow=TextUtils.generateTextFlow1(t)},e.prototype.setNextDesc=function(){if("unactive"==this.currentState?this.nextsuitConfig=this.suitConfig:this.suitLv+=1,this.nextsuitConfig){this.name1.text=LangMgr.getValueByKey("bazhuzhixinlv",this.suitLv);var t=LangMgr.getValueByKey("bzlvdadaolv",this.nextsuitConfig.totalLevel,this.totalLevel,this.nextsuitConfig.totalLevel);this.content1.textFlow=TextUtils.generateTextFlow1(t);var e=LangMgr.getValueByKey("bazhubuweisx",RoleModel.getEquipNameByType(DataCenter.ins().ReincarnateStarStepBsConfig.posChange[this.slot-1]),this.nextsuitConfig.addSlotPrecent);this.content2.textFlow=TextUtils.generateTextFlow1(e)}},e}(BaseEuiView);__reflect(ReincarnateStarSlotTipsView.prototype,"ReincarnateStarSlotTipsView");var ReincarnateStarSoulLlinkView=function(t){function e(){var e=t.call(this)||this;return e._isLink=!0,e.skinName="ReincarnateStarSoulLlinkViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1];if(t.length>2&&(this._isLink=t[2]),this.addEventTouchTap(this.bgClose,this.onClose),this._isLink){var o=heroControl.getSubRoleByIndex(i).job,s=reincarnateStarEquipControl.getLinkLv(i,n),r=reincarnateStarEquipControl.getLinkCfg(n,s?s:1),a=s>=Object.keys(DataCenter.ins().ReincarnateStarStepSoLvConfig[n]).length;if(this.currentState=s?a?"max":"active":"unactive",this.name0.text=LangMgr.getValueByKey("linhunsuolianlv",r.level),this.content0.textFlow=TextUtils.generateTextFlow(""+this.getLinkPre(r)+r.chainDesc[o-1]),s&&!a){var l=reincarnateStarEquipControl.getLinkCfg(n,s+1);this.name1.text=LangMgr.getValueByKey("linhunsuolianlv",l.level),this.content1.textFlow=TextUtils.generateTextFlow(""+this.getLinkPre(l)+l.chainDesc[o-1])}}else{var h=reincarnateStarEquipControl.getZhuHunlvByPos(i,n),u=DataCenter.ins().ReincarnateStarStepSoLvConfig[n][h?h:h+1],a=h>=Object.keys(DataCenter.ins().ReincarnateStarStepSoLvConfig[n]).length;this.currentState=h?a?"max":"active":"unactive";var p=DataCenter.ins().ReincarnateStarStepSoLvConfig[n][1].passiveSkillName;if(this.name0.text=LangMgr.getValueByKey("numberLevel",p+u.level),this.content0.textFlow=TextUtils.generateTextFlow(u.passiveSkillDesc),h&&!a){var c=DataCenter.ins().ReincarnateStarStepSoLvConfig[n][h+1];this.name1.text=LangMgr.getValueByKey("numberLevel",p+c.level),this.content1.textFlow=TextUtils.generateTextFlow(c.passiveSkillDesc)}}},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.getLinkPre=function(t){var e=DataCenter.ins().ReincarnateStarStepBsConfig.levelName[0];return"["+e+LangMgr.getValueByKey("equipPosName"+DataCenter.ins().ReincarnateStarStepBsConfig.posChange[t.firstSlot-1])+"] "+(LangMgr.getValueByKey("hezw")+" ["+e+LangMgr.getValueByKey("equipPosName"+DataCenter.ins().ReincarnateStarStepBsConfig.posChange[t.secondSlot-1])+"]"+LangMgr.getValueByKey("tsdaoda")+DataCenter.ins().ReincarnateStarStepBsConfig.soulPrefix[t.level-1]+"\n")},e}(BaseEuiView);__reflect(ReincarnateStarSoulLlinkView.prototype,"ReincarnateStarSoulLlinkView");var ReincarnateStarSoulTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarSoulTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClose);var i=DataCenter.ins().ReincarnateStarStepBsConfig.material.indexOf(t[0])+1,n=DataCenter.ins().ItemConfig[t[0]];this.nameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(n)+"&T:"+n.name+"|"),this.itemIcon.setData(n),this.posName.text=LangMgr.getValueByKey("equipPosName"+DataCenter.ins().ReincarnateStarStepBsConfig.posChange[i-1]);var o=DataCenter.ins().ReincarnateStarStepSoLvConfig[i][1];this.baseAttr.textFlow=TextUtils.generateTextFlow(AttributeData.getAttStr(o.attrs,4,1,"：")),this.posAttr.text=LangMgr.getValueByKey("weibazuupsxupto")+(o.addPrecent+100)+"%",this.chainAttr.textFlow=TextUtils.generateTextFlow(""+this.getMiniLinkStr(i)),o.passiveSkillId&&o.passiveSkillId.length?(this.skillIcon1.source=DataCenter.ins().ReincarnateStarStepSoLvConfig[o.slot][1].passiveSkillIcon,this.talentName1.text=DataCenter.ins().ReincarnateStarStepSoLvConfig[o.slot][1].passiveSkillName,this.talentDesc.textFlow=TextUtils.generateTextFlow(o.passiveSkillDesc)):DisplayUtils.removeFromParent(this.skillGroup);var s=BackpackControl.getAttPowerContainRelate(o.attrs.concat());this.powerPanel.setPower(s),this.score.text=LangMgr.getValueByKey("wingPingfen",s)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.getMiniLinkStr=function(t){for(var e=reincarnateStarEquipControl.getLinkCfg(t,1),i="",n=e.chainDesc.length,o=0;n>o;o++)i+=e.chainDesc[o],n-1>o&&(i+="\n");return i},e}(BaseEuiView);__reflect(ReincarnateStarSoulTipsView.prototype,"ReincarnateStarSoulTipsView");var ReincarnateStarSoulView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarSoulViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.getItemTxt.textFlow=TextUtils.generateTextFlow("|U:&T:"+this.getItemTxt.text),this.getItemTxt.touchEnabled=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleID=t[0],this._pos=t[1],this.addCustomEvent(114,this.update),this.addCustomEvent(267,this.updateMaterail),this.addCustomEvent(268,this.updateMaterail),this.addCustomEvent(266,this.updateMaterail),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){var t=reincarnateStarEquipControl.getZhuHunlvByPos(this._roleID,this._pos);this._isMax=t>=Object.keys(DataCenter.ins().ReincarnateStarStepSoLvConfig[this._pos]).length;var e=reincarnateStarEquipControl.getEquipIDByPos(this._roleID,this._pos),i=DataCenter.ins().ItemConfig[e];this.imgIcon.source=i.icon+"_png",this.nameImg.source=DataCenter.ins().ReincarnateStarStepBsConfig.posNameImg[this._pos-1],this.lvIcon.source=t?DataCenter.ins().ReincarnateStarStepBsConfig.soulLvTag[t-1]:null,this.currentState=this._isMax?"Max":"unMax";var n=t?DataCenter.ins().ReincarnateStarStepBsConfig.soulPrefix[t-1]+"•":"";this.nameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(i)+"&T:|"+(n+i.name));var o=DataCenter.ins().ReincarnateStarStepSoLvConfig[this._pos][t?t:t+1],s=reincarnateStarEquipControl.getLinkLv(this._roleID,this._pos),r=reincarnateStarEquipControl.getLinkCfg(this._pos,s?s:1);this.posAttr0.text=LangMgr.getValueByKey("buweibasesxupto")+(t&&o.addPrecent?o.addPrecent+100:100)+"%",this.chainLv0.text="Lv"+s;var a="",l="";if(o.passiveSkillId&&o.passiveSkillId.length?(a=DataCenter.ins().ReincarnateStarStepSoLvConfig[o.slot][1].passiveSkillIcon,l=DataCenter.ins().ReincarnateStarStepSoLvConfig[o.slot][1].passiveSkillName,this.skillIcon0.source=a,this.talentName0.text=l,this.talentLv0.text="Lv"+t):DisplayUtils.removeFromParent(this.talent0),this.powerPanel0.setPower(t?reincarnateStarEquipControl.getZhunHunPowerByPos(this._roleID,this._pos):0),t)this.attr0.textFlow=TextUtils.generateTextFlow(AttributeData.getAttStr(o.attrs,4,1,"："));else{for(var h=[],u=o.attrs.length,p=0;u>p;p++)h.push(new AttributeData(o.attrs[p].type,0));this.attr0.textFlow=TextUtils.generateTextFlow(AttributeData.getAttStr(h,4,1,"："))}if(!this._isMax){var c=t?DataCenter.ins().ReincarnateStarStepSoLvConfig[this._pos][t+1]:o,d=s+1,g=s?reincarnateStarEquipControl.getLinkCfg(this._pos,d):r;this.attr1.textFlow=TextUtils.generateTextFlow(AttributeData.getAttStr(c.attrs,4,1,"：")),this.posAttr1.text=LangMgr.getValueByKey("buweibasesxupto")+(c.addPrecent?c.addPrecent+100:100)+"%",this.chainLv1.text="Lv"+d,c.passiveSkillId&&c.passiveSkillId.length?(this.skillIcon1.source=a,this.talentName1.text=l,this.talentLv1.text="Lv"+(t+1)):DisplayUtils.removeFromParent(this.talent1);var h=[],m=0;if(h=h.concat(c.attrs.concat()),this.attr1.textFlow=TextUtils.generateTextFlow(AttributeData.getAttStr(c.attrs,4,1,"：")),c.ex_power&&(m+=c.ex_power),c.addPrecent&&(h=h.concat(reincarnateStarEquipControl.getZhuHunAddAttrs(e,c.addPrecent))),c.addBasePrecent&&c.addBasePrecent.precent){var f=BackpackControl.getEquipAddAttrsByPos(this._roleID,c.addBasePrecent.pos,c.addBasePrecent.precent);f&&f.length&&(h=h.concat(f))}if(g.attrs){var v=heroControl.getSubRoleByIndex(this._roleID).job,y=g.attrs[v-1];y&&y.length&&(h=h.concat(y.concat()))}if(g.addPrecent&&g.addPrecent.length)for(var C in g.addPrecent){var T=g.addPrecent[C];e=reincarnateStarEquipControl.getEquipIDByPos(this._roleID,T.pos),e&&T.precent&&(h=h.concat(reincarnateStarEquipControl.getZhuHunAddAttrs(e,T.precent)))}this.powerPanel1.setPower(BackpackControl.getAttPowerContainRelate(h,this._roleID)+m),this.updateMaterail(),this.openTips.visible=!reincarnateStarEquipControl.checkZhuHunOpenByPos(this._pos),this.openTips.visible&&(this.openTips.text=LangMgr.getValueByKey("zsreachlv",DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1)+DataCenter.ins().ReincarnateStarStepBsConfig.soulLimitLevel[this._pos-1]+LangMgr.getValueByKey("xijielockbuwei")),this.costInfo.visible=!this.openTips.visible,this.getItemTxt.visible=!this.openTips.visible}},e.prototype.updateMaterail=function(){var t=reincarnateStarEquipControl.getZhuHunlvByPos(this._roleID,this._pos);if(this._isMax=t>=Object.keys(DataCenter.ins().ReincarnateStarStepSoLvConfig[this._pos]).length,!this._isMax){var e=DataCenter.ins().ReincarnateStarStepSoLvConfig[this._pos][t+1];this.costImg.source=DataCenter.ins().ItemConfig[e.materialInfo.id].icon+"_png";var i=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,e.materialInfo.id);this.num.textFlow=TextUtils.generateTextFlow("（|C:"+(i>=e.materialInfo.count?65280:16711680)+"&T:"+i+"|/"+e.materialInfo.count+"）"),this.redPoint.visible=this.soulBtn.enabled=reincarnateStarEquipControl.checkZhuHunRedByPos(this._roleID,this._pos),this._materailID=e.materialInfo.id}},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.soulBtn:reincarnateStarEquipControl.upZhuHun(this._roleID,this._pos);break;case this.getItemTxt:warnControl.setBuyGoodsWarn(this._materailID);break;case this.linkGroup0:case this.linkGroup1:UIMgr.ins().open(ReincarnateStarSoulLlinkView,this._roleID,this._pos);break;case this.talent0:case this.talent1:UIMgr.ins().open(ReincarnateStarSoulLlinkView,this._roleID,this._pos,!1)}},e}(BaseEuiView);__reflect(ReincarnateStarSoulView.prototype,"ReincarnateStarSoulView");var ReincarnateStarStepPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=ReincarnateStarStepItemRenderer,this._col=new eui.ArrayCollection,this.list.dataProvider=this._col},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleID=t[0],this.addEventChange(this.list,this.onTabTouch),this.addCustomEvent(266,this.updateInfo),this.addCustomEvent(267,this.updateInfo),this.addCustomEvent(268,this.updateInfo),this.addCustomEvent(114,this.updateInfo),this.addCustomEvent(113,this.onResult),this.addEventTouchTap(this,this.onTouch),this._curIndex=this.initSuiltLv(),this._lastPos=1,this._selectRed=!0,this.updateInfo()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventChange(this.list,this.onTabTouch),this.removeEventTouchTap(this,this.onTouch),this._effMc&&(this._effMc.destroy(),this._effMc=null),this._rightMc&&(egret.Tween.removeTweens(this._rightMc),this._rightMc.destroy(),this._rightMc=null),this._leftMc&&(egret.Tween.removeTweens(this._leftMc),this._leftMc.destroy(),this._leftMc=null),this._upMc&&(egret.Tween.removeTweens(this._upMc),this._upMc.destroy(),this._upMc=null),this._isPlaying=!1},e.prototype.updateInfo=function(){if(!this._isPlaying){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv,e=[],i=2;t>=i;i++)e.push({lv:i,redPoint:reincarnateStarEquipControl.checkComRedByLv(this._roleID,i)});
this._col.source=e,this.list.selectedIndex=this._curIndex,this.changeSuit()}},e.prototype.changeSuit=function(){for(var t=this._curIndex+2,e=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,i=-1,n=1;e>=n;n++){var o=reincarnateStarEquipControl.checkComRedByPos(this._roleID,n,t);this["item"+n].data={pos:n,unLock:!0,itemID:0,showRed:o},-1==i&&o&&(i=n)}-1!=i&&this._selectRed&&(this._lastPos=i),this.setComPos(),this._isPlaying=!1,this._selectRed=!1},e.prototype.setComPos=function(){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,e=1;t>=e;e++)this["item"+e].selected=e==this._lastPos;this.redPoint.visible=this["item"+this._lastPos].data.showRed;var i=DataCenter.ins().ReincarnateStarStepComConfig[this._curIndex+2][this._lastPos];this.target.data=i.targetId,this.mom1.data=i.wearId;var n=reincarnateStarEquipControl.getEquipIDByPos(this._roleID,this._lastPos);this.mom1.setCountEx("|C:"+(n&&n==i.wearId?65280:16711680)+"&T:"+(n&&n==i.wearId?1:0)+"||C:14537649&T:/1|");var o=backpackControl.getBagGoodsCountById(0,i.muben.id);this.mom0.data=i.muben,this.mom0.setCountEx("|C:"+(o>=i.muben.count?65280:16711680)+"&T:"+o+"||C:14537649&T:/"+i.muben.count+"|"),o=backpackControl.getBagGoodsCountById(0,i.material.id),this.mom2.data=i.material,this.mom2.setCountEx("|C:"+(o>=i.material.count?65280:16711680)+"&T:"+o+"||C:14537649&T:/"+i.material.count+"|"),this._upMc||(this._upMc=ObjectPool.pop("GameMovieClip"),this.upEff.addChild(this._upMc),this._upMc.playFile(PATH_EFF+"jljdt",-1),this._upMc.scaleY=.8,this._upMc.$setRotation(90)),egret.Tween.removeTweens(this._upMc),this._upMc.scaleX=0,this._rightMc||(this._rightMc=ObjectPool.pop("GameMovieClip"),this.rightEff.addChild(this._rightMc),this._rightMc.playFile(PATH_EFF+"jljdt",-1),this._rightMc.scaleY=.8),egret.Tween.removeTweens(this._rightMc),this._rightMc.scaleX=0,this._leftMc||(this._leftMc=ObjectPool.pop("GameMovieClip"),this.leftEff.addChild(this._leftMc),this._leftMc.playFile(PATH_EFF+"jljdt",-1),this._leftMc.scaleY=.8),egret.Tween.removeTweens(this._leftMc),this._leftMc.scaleX=0},e.prototype.onTabTouch=function(t){this._curIndex=t.currentTarget.selectedIndex,this._lastPos=1,this._selectRed=!0,this.changeSuit()},e.prototype.onResult=function(t){var e=this;if(t&&this._isPlaying){var i=egret.Tween.get(this._rightMc);i.to({scaleX:.2},600);var n=egret.Tween.get(this._leftMc);n.to({scaleX:.2},600);var o=egret.Tween.get(this._upMc);o.to({scaleX:.25},600).call(function(){e._effMc||(e._effMc=ObjectPool.pop("GameMovieClip")),e.composeEff.addChild(e._effMc),e._effMc.playFile(PATH_EFF+"composeEff"),e._isPlaying=!1,e.updateInfo()},this)}else this._isPlaying=!1,this.updateInfo()},e.prototype.onTouch=function(t){if(t.target==this.update)this.redPoint.visible?(reincarnateStarEquipControl.upCompose(this._roleID,this._lastPos),this._isPlaying=!0):tipsControl.showTips(LangMgr.getValueByKey("suoxuecailiaonomeet"));else if(t.target.parent instanceof ReincarnateStarEquipItemRenderer){var e=t.target.parent.data.pos;this._lastPos!=e&&(this._lastPos=e,this.changeSuit())}},e.prototype.initSuiltLv=function(){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv,e=t;e>=2;e--)if(reincarnateStarEquipControl.checkComRedByLv(this._roleID,e))return e-2;return 0},e}(BasePanel);__reflect(ReincarnateStarStepPanel.prototype,"ReincarnateStarStepPanel");var ReincarnateStarSuitPanel=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.suitList.itemRenderer=ReincarnateStarSuitItemRenderer,this._suitCol=new eui.ArrayCollection,this.suitList.dataProvider=this._suitCol,this.suitAttList.itemRenderer=ReincarnateStarSuitAttrItemRenderer,this._suitAttrCol=new eui.ArrayCollection,this.suitAttList.dataProvider=this._suitAttrCol},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleID=t[0],this.addCustomEvent(114,this.update),this.addCustomEvent(650,this.update),this.addCustomEvent(711,this.update),this.addEventChange(this.suitList,this.onTabTouch),this.addEventTouchTap(this.huanhuaBtn,this.onHuanHua),this._curIndex=this.initSuiltLv(),this.update()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventChange(this.suitList,this.onTabTouch),this.removeEventTouchTap(this.huanhuaBtn,this.onHuanHua),this._body&&(this._body.destroy(),this._body=null),reincarnateStarEquipControl.hideSuitRed(this._roleID)},e.prototype.update=function(){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv,e=reincarnateStarEquipControl.getSuitMaxLv(this._roleID),i=reincarnateStarEquipControl.checkSuitRedByRoleID(this._roleID),n=[],o=1;t>=o;o++)n.push({lv:o,red:i&&o==e});this._suitCol.source=n,this.suitList.selectedIndex=this._curIndex,this.changeSuit()},e.prototype.changeSuit=function(){var t=this._curIndex+1;this._body||(this._body=ObjectPool.pop("GameMovieClip"));var e=heroControl.getSubRoleByIndex(this._roleID).sex;this.effGroup.addChild(this._body),this._body.playFile(""+PATH_EFF+DataCenter.ins().ReincarnateStarStepBsConfig.bodyEff[t-1]+"_"+e+"_13_eff",-1);for(var i=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount/2,n=[],o=1;i>=o;o++)n.push({lv:t,num:2*o});this._suitAttrCol.source=n,this.powerPanel.setPower(DataCenter.ins().ReincarnateStarStepSuitConfig[2*i][t].total_power);var s=reincarnateStarEquipControl.getSuitNumByLv(t,this._roleID);if(this.huanhuaBtn.visible=s>=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,this.huanhuaBtn.visible){var r=reincarnateStarEquipControl.getHuanHuaByRoleID(this._roleID);this._isHuanHua=t!=r,this.huanhuaBtn.icon=this._isHuanHua?"zl_huanhua_btn":"zl_quxiao_btn"}this.suitLevel.text=""+t,this.redPoint.visible=this.suitList.selectedItem.red},e.prototype.onTabTouch=function(t){this._curIndex=t.currentTarget.selectedIndex,this.changeSuit()},e.prototype.onHuanHua=function(){reincarnateStarEquipControl.upHuanHua(this._roleID,this._isHuanHua?this._curIndex+1:0),this.redPoint.visible&&reincarnateStarEquipControl.hideSuitRed(this._roleID)},e.prototype.initSuiltLv=function(){for(var t=DataCenter.ins().ReincarnateStarStepBsConfig.maxLv,e=reincarnateStarEquipControl.getSuitMaxLv(this._roleID),i=reincarnateStarEquipControl.checkSuitRedByRoleID(this._roleID),n=1;t>=n;n++)if(i&&n==e)return n-1;return 0},e}(BasePanel);__reflect(ReincarnateStarSuitPanel.prototype,"ReincarnateStarSuitPanel");var ReincarnateStarSuitView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarSuitViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._roleID=t[0],this.addEventChange(this.roleSelect,this.onChange),this.addCustomEvent(648,this.updateRedPoint),this.roleSelect.setCurRole(this._roleID),this.suitPanel.open(this._roleID),this.updateRedPoint()},e.prototype.close=function(){reincarnateStarEquipControl.hideSuitRed(this._roleID),this.suitPanel.close()},e.prototype.onChange=function(){this._roleID=this.roleSelect.getCurRole(),this.suitPanel.close(),this.suitPanel.open(this._roleID)},e.prototype.updateRedPoint=function(){for(var t=ReincarnateStarRedPoint.ins().suitRoleTab.length,e=0;t>e;e++)this.roleSelect.showRedPoint(e,ReincarnateStarRedPoint.ins().suitRoleTab[e])},e}(BaseEuiView);__reflect(ReincarnateStarSuitView.prototype,"ReincarnateStarSuitView");var ReincarnateStarEquipChangeItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.onRemove),this.addEventTouchTap(this.changeBtn,this.onChange)},e.prototype.dataChanged=function(){var t=this.data.itemData;this.itemIcon.setData(t.itemConfig),this.levelText.text=LangMgr.getValueByKey("numberRotation",t.itemConfig.zsLevel),this.nameTxt.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t.itemConfig)+"&T:|"+t.itemConfig.name);var e=reincarnateStarEquipControl.getEquipPowerByID(t.configID);this.power.text=LangMgr.getValueByKey("wingPingfen",e);var i=DataCenter.ins().ReincarnateStarStepConfig[t.configID],n=AttributeData.getAttStr(i.attr,0,1,":");i.ex_attr&&(n+="\n"+AttributeData.getAttStrEx(i.ex_attr,0,1,":")),this.attr1.textFlow=TextUtils.generateTextFlow(n),this.upImg.visible=e>this.data.curPower,this.best.visible=this.upImg.visible&&this.data.isFirst},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.removeEventTouchTap(this.changeBtn,this.onChange)},e.prototype.onChange=function(){reincarnateStarEquipControl.upChangeEquip(this.data.roleID,DataCenter.ins().ReincarnateStarStepConfig[this.data.itemData.configID].slot,this.data.itemData.configID),UIMgr.ins().close(ReincarnateStarEquipChangeView),UIMgr.ins().close(ReincarnateStarEquipTipsView)},e}(BaseItemRender);__reflect(ReincarnateStarEquipChangeItemRenderer.prototype,"ReincarnateStarEquipChangeItemRenderer");var ReincarnateStarEquipItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.onRemove),this.touchChildren=!0,this.touchEnabled=!1},e.prototype.dataChanged=function(){if(this.redPoint.visible=this.data.showRed,this.soulTag.visible=!1,this.data.unLock)if(this.clearMc(),this.data.itemID){this.iconImg.source=DataCenter.ins().ItemConfig[this.data.itemID].icon+"_png";var t=DataCenter.ins().ReincarnateStarStepConfig[this.data.itemID];t.frameEff&&!this.data.unshoweff&&(this._mc=ObjectPool.pop("GameMovieClip"),this.effGroup.addChild(this._mc),this._mc.playFile(""+PATH_EFF+t.frameEff,-1),this.touchEnabled=!1),this.data.zhuHunLv&&(this.soulTag.source=DataCenter.ins().ReincarnateStarStepBsConfig.soulLvTag[this.data.zhuHunLv-1],this.soulTag.visible=!0)}else this.iconImg.source=DataCenter.ins().ReincarnateStarStepBsConfig.posRes[this.data.pos-1];else this.iconImg.source=null;this.lock.visible=!this.data.unLock,this.iconImg.scaleX=this.iconImg.scaleY=DataCenter.ins().ReincarnateStarStepBsConfig.posScale[this.data.pos-1],this.selectImg.scaleX=this.selectImg.scaleY=this.iconImg.scaleX,this.lock.scaleY=this.lock.scaleX=this.selectImg.scaleX,this.posPanel.source=DataCenter.ins().ReincarnateStarStepBsConfig.posPanelRes[this.data.pos-1],this.unlock.text=this.data.unLock||this.data.pos!=reincarnateStarControl.point+1?"":LangMgr.getValueByKey("reincarnateStarEquipOpen",DataCenter.ins().ReincarnateConfig.baseMaxZsLv,reincarnateStarControl.point+1),this.selectImg.visible=this.data.isshowlevel?this.data.isselect:!1,this.levelLable.visible=this.data.isshowlevel?this.data.isshowlevel:!1,this.levelLable.text=(this.data.nlevel?this.data.nlevel:0)+""},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.clearMc()},e.prototype.clearMc=function(){this._mc&&(this._mc.destroy(),this._mc=null)},Object.defineProperty(e.prototype,"selected",{set:function(t){this.selectImg&&(this.selectImg.visible=t)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(ReincarnateStarEquipItemRenderer.prototype,"ReincarnateStarEquipItemRenderer");var ReincarnateStarStepItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.positionTxt.text=DataCenter.ins().ReincarnateStarStepBsConfig.levelName[this.data.lv-1],this.redPoint.visible=this.data.redPoint},Object.defineProperty(e.prototype,"selected",{set:function(t){this.currentState=t?"down":"up"},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(ReincarnateStarStepItemRenderer.prototype,"ReincarnateStarStepItemRenderer");var ReincarnateStarSuitAttrItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.suitTxt.text=DataCenter.ins().ReincarnateStarStepSuitConfig[this.data.num][this.data.lv].num+LangMgr.getValueByKey("numberJT1"),this.attrTxt.textFlow=TextUtils.generateTextFlow(reincarnateStarEquipControl.getSuiltSepcialAttStr(this.data.lv,this.data.num))},e}(BaseItemRender);__reflect(ReincarnateStarSuitAttrItemRenderer.prototype,"ReincarnateStarSuitAttrItemRenderer");var ReincarnateStarSuitItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.suitTxt.text=""+DataCenter.ins().ReincarnateStarStepBsConfig.levelName[this.data.lv-1],this.redPoint.visible=this.data.red},Object.defineProperty(e.prototype,"selected",{set:function(t){this.currentState=t?"down":"up"},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(ReincarnateStarSuitItemRenderer.prototype,"ReincarnateStarSuitItemRenderer");var ReincarnateStarPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="",e}return __extends(e,t),e.prototype.close=function(){DisplayUtils.removeFromParent(this.eff)},e.prototype.open=function(){this.addEventTouchTap(this.equipUnlock,this.onClick),this.addEventTouchTap(this.bossUnlock,this.onClick),this.addEventTouchTap(this.getBtn,this.onClick),this.addEventTouchTap(this.link,this.onClick),this.addCustomEvent(112,this.updateView),this.addCustomEvent(461,this.updateView),this.link.textFlow=TextUtils.generateTextFlow1("|U:&T:"+LangMgr.getValueByKey("zsPanelGetXW1")),this.updateView()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.link:UIMgr.ins().open(ReincarnateGainView);break;case this.getBtn:if(!reincarnateStarControl.check13ZsOpenDay()){var e=reincarnateStarControl.getAfter12Zs();return void tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().ReincarnateConfig.openDay[e]))}if(reincarnateControl.isMaxLv())return void tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));if(!reincarnateStarControl.IsUpLevel13ZsExp())return void tipsControl.showTips(LangMgr.getValueByKey("zsPanelEnoughtXW"));reincarnateStarControl.upZs13Upgrade();break;case this.bossUnlock:var i=DataCenter.ins().ReincarnateStarStepZsLvConfig[reincarnateStarControl.point];if(i&&i.skip)UIMgr.ins().open(i.skip[0],i.skip[1],i.skip[2]);else{var n=UIMgr.ins().getView(ReincarnateStarView);n&&n.switchTab(5)}break;case this.equipUnlock:var o=DataCenter.ins().ReincarnateStarStepZsLvConfig[reincarnateStarControl.point];if(o&&o.equipSkip)UIMgr.ins().open(o.equipSkip[0],o.equipSkip[1],o.equipSkip[2]);else{var n=UIMgr.ins().getView(ReincarnateStarView);n&&n.switchTab(1)}}},e.prototype.updateView=function(){this.updateStatus(),this.updateAttrs(),this.updateRedPoint(),this.updateCost(),this.updatePoint()},e.prototype.updateStatus=function(){var t=reincarnateStarControl.getAfter12Zs();this.currentState=""+(12+t-DataCenter.ins().ReincarnateConfig.baseMaxZsLv),this.validateNow()},e.prototype.updateRedPoint=function(){this.redPoint.visible=reincarnateStarControl.IsUpLevel13ZsExp()},e.prototype.updateAttrs=function(){var t=DataCenter.ins().ReincarnateLevelConfig[reincarnateControl.lv],e=[];for(var i in AttributeData.translate)if(!isNaN(t[i])){var n=new AttributeData;n.type=parseInt(AttributeData.translate[i]),n.value=t[i],e.push(n)}if(this.maxTxt.visible=!1,this.maxGroup.visible=this.maxTxt.visible,this.normalGroup.visible=!this.maxTxt.visible,this.bossUnlock.visible=this.equipUnlock.visible=!this.maxTxt.visible,this.link.visible=!this.maxTxt.visible,this.group.visible=!this.maxTxt.visible,reincarnateControl.isMaxLv()){this.maxTxt.visible=!0,this.maxGroup.visible=this.maxTxt.visible,this.normalGroup.visible=!this.maxTxt.visible,this.bossUnlock.visible=this.equipUnlock.visible=!this.maxTxt.visible,this.link.visible=!this.maxTxt.visible,this.group.visible=!this.maxTxt.visible;var o=DataCenter.ins().ReincarnateStarStepZsLvConfig[reincarnateStarControl.point];e=AttributeData.AttrAddition(e,o.attrs);for(var i in AttributeData.translate)if(!isNaN(t[i])&&this["attr"+AttributeData.translate[i]])for(var s=0;s<e.length;s++)AttributeData.translate[i]==e[s].type&&(this["attr"+AttributeData.translate[i]].text=AttributeData.getAttStr(e[s],.5))}else{var o=DataCenter.ins().ReincarnateStarStepZsLvConfig[reincarnateStarControl.point+1],r=AttributeData.AttrAddition(e,o.attrs);this.nextAtt.text=AttributeData.getAttStr(r,1),this.useTxt.text=o.exp+"",this.bossUnlock.data=o,this.bossUnlock.visible=!!o.desc,this.equipUnlock.data=o,this.equipUnlock.visible=!!o.desc;var a=reincarnateStarControl.point,l=DataCenter.ins().ReincarnateStarStepZsLvConfig[a];l&&(e=AttributeData.AttrAddition(e,l.attrs)),this.curAtt.text=AttributeData.getAttStr(e,1)}var h=heroControl.subRolesLen;this._totalPower=BackpackControl.getAttrPower(e)*h,this.powerPanel.setPower(this._totalPower)},e.prototype.updateCost=function(){var t=reincarnateStarControl.getStarLv(),e=reincarnateControl.isMaxLv()?"":t+LangMgr.getValueByKey("roleStart");this.curZsLv.text=LangMgr.getValueByKey("zxPanelRotationLevel",reincarnateControl.lv)+e,this.haveTxt.text=reincarnateControl.exp+"",reincarnateControl.canGet()&&!reincarnateControl.isMaxLv()?(this.eff||(this.eff=new GameMovieClip,this.eff.x=420,this.eff.y=100,this.eff.touchEnabled=!1,this.eff.scaleX=.6,this.eff.scaleY=.5),this.eff.parent||this.group.addChild(this.eff),this.eff.playFile(PATH_EFF+"chargeff1",-1)):DisplayUtils.removeFromParent(this.eff)},e.prototype.updatePoint=function(){var t=reincarnateStarControl.getShowZsConfig();if(t)for(var e=(reincarnateStarControl.getStarLv(),0);e<t.length;e++){var i=t[e],n=i.starLv;n||(n=t[e-1].starLv+1),this["zsPoint"+n]&&(this["zsPoint"+n].data=i),this["lv"+n]&&(this["lv"+n].source=n>=n?"tz_line1":"tz_line0")}},e}(BasePanel);__reflect(ReincarnateStarPanel.prototype,"ReincarnateStarPanel");var ReincarnateStarView=function(t){function e(){var e=t.call(this)||this;return e.curSelectIndex=0,e.skinName="ReincarnateStarViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.selectedIndex=0,this.tab.dataProvider=this.viewStack,this.seeRule.visible=!1},e.openCheck=function(t){var e=t?t:0;switch(e){case 0:if(!reincarnateStarControl.checkShow13ZsPanel())return tipsControl.showTips(LangMgr.getValueByKey("ladderTips16",DataCenter.ins().ReincarnateConfig.baseMaxZsLv,DataCenter.ins().ReincarnateConfig.openDay[DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1])),!1;break;case 1:case 2:case 3:if(!reincarnateStarEquipControl.checkOpen())return tipsControl.showTips(LangMgr.getValueByKey("ladderTips16",DataCenter.ins().ReincarnateStarStepBsConfig.openLevel,DataCenter.ins().ReincarnateStarStepBsConfig.openDay)),!1;if(3==e&&reincarnateStarEquipControl.showSuitInEquip())return!1;break;case 4:if(!reincarnateStarEquipControl.checkQHOpen())return tipsControl.showTips(LangMgr.getValueByKey("ladderTips16",DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1,DataCenter.ins().ReincarnateStarStepBsConfig.slotLevelLimitDay)),!1;break;case 5:}return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0]?t[0]:0;this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.roleSelect,this.onChange),this.addEventTouchTap(this.seeRule,this.onTap),this.addCustomEvent(652,this.updateRedPoint),this.addCustomEvent(645,this.updateRedPoint),this.addCustomEvent(646,this.updateRedPoint),this.addCustomEvent(647,this.updateRedPoint),this.addCustomEvent(648,this.updateRedPoint),this.resetViews(),t[0]=this._openIndexs.indexOf(i),this.setSelectedIndex(t[0],t[1]),this.updateRedPoint()},e.prototype.resetViews=function(){this._openIndexs=[];for(var t=0;6>t;t++){var e=this.checkHide(t);e?(DisplayUtils.removeFromParent(e),DisplayUtils.removeFromParent(this["redPoint"+t])):this._openIndexs.push(t)}},e.prototype.checkHide=function(t){switch(t){case 3:if(reincarnateStarEquipControl.showSuitInEquip())return this.reincarnateStarSuitPanel;break;case 4:if(!reincarnateStarEquipControl.checkQHOpen())return this.reincarnateStarSlotPanel}return null},e.prototype.onTap=function(t){if(t.currentTarget==this.seeRule){var e=this._openIndexs[this.curSelectIndex];switch(e){case 5:HelpControl.openHelpWin(82)}}},e.prototype.close=function(){this.viewStack.getChildAt(this.curSelectIndex).close()},e.prototype.onTabTouching=function(t){var e=t.currentTarget.selectedIndex,i=this._openIndexs[e];switch(i){case 0:case 3:if(!reincarnateStarControl.checkShow13ZsPanel())return tipsControl.showTips(LangMgr.getValueByKey("ladderTips16",DataCenter.ins().ReincarnateConfig.baseMaxZsLv,DataCenter.ins().ReincarnateConfig.openDay[DataCenter.ins().ReincarnateConfig.baseMaxZsLv+1])),void t.preventDefault();break;case 4:for(var n=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,o=this.roleSelect.getCurRole(),s=[],r=heroControl.subRolesLen,a=0;r>a;a++){for(var l=!1,h=1;n>=h;h++)if(reincarnateStarEquipControl.getEquipIDByPos(a,h)){l=!0;break}s[a]=l}if(!s[o])return tipsControl.showCenterTips(LangMgr.getValueByKey("rolebzequipopenszjl")),void t.preventDefault()}},e.prototype.switchTab=function(t){if(this.viewStack.getChildAt(this.curSelectIndex).close(),1==t||2==t)for(var e=1==t?ReincarnateStarRedPoint.ins().equipRoleTab:2==t?ReincarnateStarRedPoint.ins().composeRoleTab:ReincarnateStarRedPoint.ins().suitRoleTab,i=e.length,n=0;i>n;n++)if(e[n])return this.roleSelect.setCurRole(n),void this.updateRedPoint();this.setSelectedIndex(this._openIndexs.indexOf(t)),this.updateRedPoint()},e.prototype.onTabTouch=function(t){var e=t.currentTarget.selectedIndex;this.switchTab(this._openIndexs[e])},e.prototype.setSelectedIndex=function(t,e){this.curSelectIndex=t;var i=this._openIndexs[this.curSelectIndex];switch(i){case 1:case 4:case 2:case 3:this.viewStack.getChildAt(t).open(this.roleSelect.getCurRole());break;case 5:this.viewStack.getChildAt(t).open(e);break;default:this.viewStack.getChildAt(t).open()}switch(this.viewStack.selectedIndex=t,0==i||5==i?this.roleSelect.hideRole():this.roleSelect.openRole(),this.seeRule.visible=!1,i){case 5:this.seeRule.visible=!0}},e.prototype.updateRedPoint=function(){var t=this._openIndexs[this.viewStack.selectedIndex];switch(t){case 1:for(var e=ReincarnateStarRedPoint.ins().equipRoleTab.length,i=0;e>i;i++)this.roleSelect.showRedPoint(i,ReincarnateStarRedPoint.ins().equipRoleTab[i]);break;case 2:for(var n=ReincarnateStarRedPoint.ins().composeRoleTab.length,i=0;n>i;i++)this.roleSelect.showRedPoint(i,ReincarnateStarRedPoint.ins().composeRoleTab[i]);break;case 4:for(var o=ReincarnateStarRedPoint.ins().QHRoleTab.length,i=0;o>i;i++)this.roleSelect.showRedPoint(i,ReincarnateStarRedPoint.ins().QHRoleTab[i]);break;case 3:for(var s=ReincarnateStarRedPoint.ins().suitRoleTab.length,i=0;s>i;i++)this.roleSelect.showRedPoint(i,ReincarnateStarRedPoint.ins().suitRoleTab[i])}this.redPoint0.visible=ReincarnateStarRedPoint.ins().upGradeRed,this.redPoint1.visible=ReincarnateStarRedPoint.ins().equipRed,this.redPoint2.visible=ReincarnateStarRedPoint.ins().composeRed,this.redPoint3.visible=ReincarnateStarRedPoint.ins().suitRed,this.redPoint4.visible=ReincarnateStarRedPoint.ins().QHRed,this.redPoint5.visible=ReincarnateStarRedPoint.ins().bossRedpoint},e.prototype.onChange=function(){var t=this._openIndexs[this.curSelectIndex];if(4==t){for(var e=DataCenter.ins().ReincarnateStarStepBsConfig.equipCount,i=this.roleSelect.getCurRole(),n=[],o=heroControl.subRolesLen,s=0;o>s;s++){for(var r=!1,a=1;e>=a;a++)if(reincarnateStarEquipControl.getEquipIDByPos(s,a)){r=!0;break}n[s]=r}if(!n[i]){tipsControl.showCenterTips(LangMgr.getValueByKey("rolebzequipopenszjl"));for(var s=0;o>s;s++)n[s]&&this.roleSelect.setCurRole(s);return}}this.setRoleId(this.roleSelect.getCurRole())},e.prototype.setRoleId=function(t){this.curRole=t,this.setSelectedIndex(this.viewStack.selectedIndex)},e}(BaseEuiView);__reflect(ReincarnateStarView.prototype,"ReincarnateStarView");var ReincarnateStarBossUnlockItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarBossUnlockItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.bossName.text=this.data.desc?this.data.desc.bossName:"",this.require.text=this.data.desc?this.data.desc.bossDesc:"",this.monheadImg.source=this.data.desc?this.data.desc.bossIcon:"")},e}(BaseItemRender);__reflect(ReincarnateStarBossUnlockItemRenderer.prototype,"ReincarnateStarBossUnlockItemRenderer");var ReincarnateStarEquipUnlockItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarEquipUnlockItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.positionImg.source=this.data.desc?this.data.desc.posIcon:"",this.positionTxt.text=this.data.desc?this.data.desc.posName:"",this.require.text=this.data.desc?this.data.desc.posDesc:"")},e}(BaseItemRender);__reflect(ReincarnateStarEquipUnlockItemRenderer.prototype,"ReincarnateStarEquipUnlockItemRenderer");var ReincarnateStarUpItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnateStarUpItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.positionImg.source=this.data.point?this.data.point.posImg:"",this.selectImg.visible=!1;var t=this.data.starLv;t||(t=DataCenter.ins().ReincarnateStarStepZsLvConfig[this.data.level-1].starLv+1);var e=reincarnateStarControl.getStarLv();e+1==t&&(this.selectImg.visible=!0),e>=t?(this.eff||(this.eff=new GameMovieClip),this.eff.parent||(this.activityEff.addChild(this.eff),this.eff.playFile(PATH_EFF+"feishengfire",-1))):DisplayUtils.removeFromParent(this.eff)}},e}(BaseItemRender);__reflect(ReincarnateStarUpItemRenderer.prototype,"ReincarnateStarUpItemRenderer");var ReincarnationControl=function(t){function e(){var e=t.call(this)||this;e.samsaraDescAry=[],e.samsaraEquipMap={},e.composeEquipMap={},e.composeEquipTypes=[],e.equipCompose={};for(var i=DataCenter.ins().ReincarnationBaseConfig,n=1;12>=n&&i["level"+n];n++)e.samsaraDescAry.push(i["level"+n].lvName);return e.initComposeEquip(),e.composeEquipTypes=e.getComposeMenu(),e.firstRedPoint=!0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upExchangeSamsaraExp=function(t){return[t]},e.prototype.upUpgradeSamsaraLv=function(){},e.prototype.downSamsaraInfo=function(t,e,i,n,o){var s=this.samsaraInfo?!1:!0,r=this.samsaraInfo?this.samsaraInfo.exp:0;if(this.samsaraInfo=new ReincarnationVo(t,e,i,n,o),!s){var a=this.samsaraInfo.exp-r;a&&tipsControl.showTips(LangMgr.getValueByKey("samTips14",a))}EventMgr.ins().dispatch(151)},e.prototype.upCompose=function(t,e){return[t,e]},e.prototype.downCompose=function(){EventMgr.ins().dispatch(152)},e.prototype.isCanUpgrade=function(){if(!this.isOpen())return!1;if(!this.samsaraInfo)return!1;var t=this.samsaraInfo.lv,e=t+1,i=DataCenter.ins().ReincarnationLevelConfig[e],n=!1;return i&&GameServer.serverOpenDay+1>=i.openDay&&this.samsaraInfo.exp>=i.consume&&e<CommonUtils.getObjectLength(DataCenter.ins().ReincarnationLevelConfig)&&(n=!0),n},e.prototype.getExpExchangeTimes=function(){if(!this.samsaraInfo)return 0;var t=DataCenter.ins().ReincarnationBaseConfig.levelExchangeTimes-this.samsaraInfo.expUpgradeNum;return t},e.prototype.getNormalExchangeTimes=function(){if(!this.samsaraInfo)return 0;var t=DataCenter.ins().ReincarnationBaseConfig.normalItem.time-this.samsaraInfo.normalUpgradeNum;return t},e.prototype.getAdvancedExchangeTimes=function(){if(!this.samsaraInfo)return 0;var t=DataCenter.ins().ReincarnationBaseConfig.advanceItem.time-this.samsaraInfo.advancedUpgradeNum;return t},e.prototype.isCanExpExchange=function(){var t=!1;return this.firstRedPoint&&ActorControl.level>=DataCenter.ins().ReincarnationBaseConfig.levelLimit&&this.getExpExchangeTimes()>0&&(t=!0),t},e.prototype.isCanItemExchange=function(){var t;return this.getNormalExchangeTimes()>0&&(t=backpackControl.getBagGoodsCountById(0,DataCenter.ins().ReincarnationBaseConfig.normalItem.id),t>0)?!0:this.getAdvancedExchangeTimes()>0&&(t=backpackControl.getBagGoodsCountById(0,DataCenter.ins().ReincarnationBaseConfig.advanceItem.id),t>0)?!0:!1},e.prototype.isCanExchange=function(){return this.isMaxSamsara(ActorControl.samsaraLv)?!1:this.isCanExpExchange()||this.isCanItemExchange()},e.prototype.isOpen=function(){var t=1e3*reincarnateControl.lv+ActorControl.level;return t>=DataCenter.ins().ReincarnationBaseConfig.openLevel},e.prototype.isMaxSamsara=function(t){if(!this.isOpen())return!1;var e=GameServer.serverOpenDay+1>=DataCenter.ins().ReincarnationLevelConfig[37].openDay?CommonUtils.getObjectLength(DataCenter.ins().ReincarnationLevelConfig):37,i=DataCenter.ins().ReincarnationLevelConfig[e-1];return t>=i.level},e.prototype.isSuit=function(t,e){for(var i=this.getEquipSamsaraLvByRole(t,e),n=9;13>n;n++)if(n!=t){var o=this.getEquipSamsaraLvByRole(n,e);if(i>o)return!1}return!0},e.prototype.lowSuitEquips=function(t,e){for(var i=[],n=this.getEquipSamsaraLvByRole(t,e),o=9;13>o;o++){var s=this.getEquipSamsaraLvByRole(o,e);n>s?i.push(0):i.push(1)}return i},e.prototype.getEquipSamsaraLvByRole=function(t,e){var i=e.getEquipByIndex(t);return i.item.itemConfig?this.getEquipSamsaraLv(i.item.itemConfig.id):0},e.prototype.getEquipSamsaraLv=function(t){var e=DataCenter.ins().ItemConfig[t].zsLevel;return e},e.prototype.getReincarnateSuit=function(t){var e=DataCenter.ins().ItemConfig[t].descIndex,i=DataCenter.ins().ItemDescConfig[e].eType;return DataCenter.ins().ReincarnationSuitConfig[i]},e.prototype.getSamsara=function(t){var e=0;return t>=7&&(e=Math.ceil((t-6)/6)),e},e.prototype.getSamsaraDesc=function(t){return this.samsaraDescAry[t]},e.prototype.getSamsaraLv=function(t){var e=0;return e=0==t?-1:Math.ceil((t-1)%6)},e.prototype.getSamsaraLvDesc=function(t){var e=t+1;return DataCenter.ins().ReincarnationBaseConfig.state[e]},e.prototype.getAddSpiritEquips=function(t,e,i){void 0===i&&(i=10);var n=[],o=backpackControl.itemCount[1],s=t.getEquipByIndex(e);if(o&&!this.checkSpiritLvIsMax(s,e))for(var r in o)if(DataCenter.ins().ReincarnationEquipConfig[r]){var a=+r,l=this.isEquipCanAddSpirit(t,e,a);if(l)for(var h=o[r];h>0;){if(n.unshift(a),n.length>=i)return n;h--}}return n},e.prototype.isEquipCanAddSpirit=function(t,e,i){var n=t.getEquipByIndex(e),o=DataCenter.ins().ItemConfig[n.item.itemConfig.id].zsLevel,s=DataCenter.ins().ItemConfig[i].zsLevel;return s>o?!1:this.checkEquip(i)},e.prototype.checkEquip=function(t){var e=DataCenter.ins().ItemConfig[t],i=ItemUtils.getJob(e),n=heroControl.getSubRoleByJob(i);if(n){var o=n.getEquipByIndex(ItemUtils.getSubType(e));if(o.item.itemConfig){var s=DataCenter.ins().ItemConfig[o.item.itemConfig.id].zsLevel;if(s>=e.zsLevel){var r=this.getTargetShengEquipById(t,e.zsLevel);return this.checkNormalEquip(o,r)}}}return!1},e.prototype.checkNormalEquip=function(t,e){var i=t.item.point,n=new ItemData;n.configID=e;var o=n.point;return i>o},e.prototype.getTargetShengEquipById=function(t,e){var i=this.equipCompose[t];return i?this.getTargetShengEquipById(i.id,e):t},e.prototype.isCanAddSpirit=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++)for(var i=heroControl.getSubRoleByIndex(e),n=9;13>n;n++){var o=i.getEquipByIndex(n);if(o.item.itemConfig){var s=this.getAddSpiritEquips(i,n,1);if(s.length>0)return!0}}return!1},e.prototype.isCanUpgradeSoul=function(){if(!this.isOpen())return!1;for(var t=heroControl.roles,e=0;e<t.length;e++)for(var i=t[e],n=9;13>n;n++){var o=i.getEquipByIndex(n);if(o.item.itemConfig&&this.checkUpgradeSoul(i,n))return!0}return!1},e.prototype.checkRoleCanAddSpirit=function(t){for(var e=heroControl.getSubRoleByIndex(t),i=9;13>i;i++){var n=e.getEquipByIndex(i);if(n.item.itemConfig){var o=this.getAddSpiritEquips(e,i,1);if(o.length>0)return!0}}return!1},e.prototype.checkRoleCanUpgradeSoul=function(t){for(var e=heroControl.getSubRoleByIndex(t),i=9;13>i;i++){var n=e.getEquipByIndex(i);if(n.item.itemConfig&&this.checkUpgradeSoul(e,i))return!0}return!1},e.prototype.checkEquipPosCanAddSpirit=function(t,e){var i=t.getEquipByIndex(e);if(i.item.itemConfig&&!this.checkSpiritLvIsMax(i,e)){var n=this.getAddSpiritEquips(t,e,1);if(n.length>0)return!0}return!1
},e.prototype.checkSpiritLvIsMax=function(t,e){var i=t.spiritLv;return!DataCenter.ins().ReincarnationSpiritConfig[e][i+1]},e.prototype.getExtraPower=function(t,e,i){for(var n=0,o=0,s=9;12>=s;s++){var r=t.getEquipByIndex(s);if(r.item.itemConfig){var a=r.item.itemConfig.id;if(a&&DataCenter.ins().EquipConfig[a].baseAttr1){var l=DataCenter.ins().EquipConfig[a].baseAttr1;o+=l.value}}}if(i){var h=DataCenter.ins().CombatPowerConfig,u=h[i];n=o*u.relate_power*e}return n},e.prototype.initComposeEquip=function(){for(var t=DataCenter.ins().ReincarnationBaseConfig.headName,e=t.length,i=1;e>=i;i++)this.composeEquipMap[i]||(this.composeEquipMap[i]={});for(var n in DataCenter.ins().ReincarnationEqComConfig){var o=DataCenter.ins().ReincarnationEqComConfig[n];this.equipCompose[o.material.id]=o;var s=o.distinguishi,r=this.composeEquipMap[s],a=DataCenter.ins().ItemConfig[o.id],l=a.zsLevel,h=r[l];h||(h=[]),h.push({type:1,id:o.id}),r[l]=h,this.composeEquipMap[s]=r}},e.prototype.getComposeMenu=function(){for(var t=DataCenter.ins().ReincarnationBaseConfig.headName,e=t.length,i=[],n=1;e>=n;n++)i.push(n);return i},e.prototype.getComposeZsList=function(t){var e=reincarnateControl.lv,i=DataCenter.ins().ReincarnationBaseConfig.equipsList[t-1],n=[];for(var o in i)i[o]<=e&&n.push({type:t,zsLv:i[o]});return n},e.prototype.getComposeDesc=function(t){return DataCenter.ins().ReincarnationBaseConfig.headName[t-1]},e.prototype.isCanCompose=function(){return this.getComposeEquipList(!0).length>0},e.prototype.getComposeEquipId=function(t,e){var i=0,n=this.getComposeEquipList();for(var o in n){var s=n[o],r=this.getComposeTarget(s);if(DataCenter.ins().ItemConfig[r].zsLevel==e&&DataCenter.ins().ReincarnationEqComConfig[r].distinguishi==t)return s}return i},e.prototype.getComposeEquipList=function(t){void 0===t&&(t=!1);var e=[],i=backpackControl.itemCount[1];for(var n in i)if(this.equipCompose[n]){var o=+n,s=this.composeMaxEquip(o);if(s&&this.isCanWear(s)){var r=this.isComposeOpenDayByReincarnateEquip(s);if(r&&e.push(o),t)break}}return e},e.prototype.isComposeOpenDayByReincarnateEquip=function(t){var e=!0,i=DataCenter.ins().ReincarnationEqComConfig[t],n=DataCenter.ins().ItemConfig[t];if(i&&n){var o=DataCenter.ins().PieceConfig[i.distinguishi];if(o){var s=n.zsLevel||0;for(var r in o){var a=o[r];if(a.openZs==s&&(a.openDay&&GameServer.serverOpenDay+1<a.openDay||reincarnateControl.lv<a.openZs||reincarnateControl.lv==a.openZs&&ActorControl.level<a.openLv)){e=!1;break}}}}return e},e.prototype.isCanWear=function(t){if(!t)return!1;var e=DataCenter.ins().ItemConfig[t],i=1e3*reincarnateControl.lv+ActorControl.level,n=1e3*e.zsLevel+e.level;if(n>i)return!1;var o=ItemUtils.getJob(e),s=ItemUtils.getSubType(e),r=heroControl.getSubRoleByJob(o);if(!r)return!1;var a=r.getEquipByIndex(s),l=a.item.itemConfig;if(!l)return!0;var h=a.item.point,u=new ItemData;u.configID=t;var p=u.point;return p>h?!0:!1},e.prototype.composeMaxEquip=function(t){var e=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_EQUIP,t);if(e){var i=new RewardVo;i.id=t,i.count=0;var n=this.composeEquip(i);if(n&&n.id!=t)return n.id}return 0},e.prototype.composeEquip=function(t){var e,i=t.id,n=t.count+backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_EQUIP,i)+this.wearCount(i),o=this.equipCompose[i];return o&&n>=o.material.count?(e=new RewardVo,e.id=o.id,e.count=Math.floor(n/o.material.count),this.composeEquip(e)):t},e.prototype.wearCount=function(t){var e=DataCenter.ins().ItemConfig[t],i=ItemUtils.getJob(e),n=heroControl.getSubRoleByJob(i);if(!n)return 0;var o=ItemUtils.getSubType(e),s=n.getEquipByIndex(o),r=s.item.itemConfig;return r&&r.id==t?1:0},e.prototype.getRoleIndexByEquip=function(t){for(var e=DataCenter.ins().ItemConfig[t],i=ItemUtils.getJob(e),n=ItemUtils.getSubType(e),o=heroControl.subRolesLen,s=0;o>s;s++){var r=heroControl.getSubRoleByIndex(s);if(r.job==i){var a=r.getEquipByIndex(n),l=a.item.itemConfig;if(l&&l.id==t)return s}}return-1},e.prototype.isCanTypeCompose=function(t){var e=this.getComposeEquipList();for(var i in e){var n=e[i],o=DataCenter.ins().ReincarnationEqComConfig[this.getComposeTarget(n)];if(o.distinguishi==t)return!0}return!1},e.prototype.getComposeTarget=function(t){var e=this.equipCompose[t];return e?e.id:0},e.prototype.isCanZsLvCompose=function(t,e,i){if(void 0===i&&(i=0),GameServer.serverOpenDay+1<i)return!1;var n=this.getComposeEquipList();for(var o in n){var s=n[o],r=this.getComposeTarget(s),a=DataCenter.ins().ReincarnationEqComConfig[r],l=DataCenter.ins().ItemConfig[r].zsLevel;if(e==l&&a.distinguishi==t)return!0}return!1},e.prototype.isCanEquipCompose=function(t){var e=this.getComposeEquipList();return e.indexOf(t)>=0},e.prototype.getReincarnationLinkLevel=function(t,e){for(var i in DataCenter.ins().ReincarnationLinkLvConfig)if(i==t.toString())for(var n in DataCenter.ins().ReincarnationLinkLvConfig[i])for(var o in DataCenter.ins().ReincarnationLinkLvConfig[i][n])if(o==e.toString())return DataCenter.ins().ReincarnationLinkLvConfig[i][n][o];return null},e.prototype.getSoulLinkDesc=function(t){return LangMgr.getValueByKey("samType"+t)},e.prototype.getSoulMaxLevel=function(){return CommonUtils.getObjectLength(DataCenter.ins().ReincarnationDemonLvConfig[9])},e.prototype.getSoulLinkLv=function(t,e,i){var n=this.getLinkEquipPos(e),o=t.getEquipByIndex(e),s=t.getEquipByIndex(n);return o&&s?Math.min(o.soulLv,s.soulLv):0},e.prototype.getLinkEquipPos=function(t){for(var e in DataCenter.ins().ReincarnationLinkLvConfig)if(e==t.toString())for(var i in DataCenter.ins().ReincarnationLinkLvConfig[e])return+i;return null},e.prototype.checkUpgradeSoul=function(t,e){var i=t.getEquipByIndex(e),n=i.soulLv;if(n!=this.getSoulMaxLevel()&&i.item.itemConfig){var o=DataCenter.ins().ReincarnationSoulLvConfig[t.job][e][n+1],s=backpackControl.getBagGoodsCountById(0,o.materialInfo.id);return s>=o.materialInfo.count}return!1},__decorate([up(2,[1])],e.prototype,"upExchangeSamsaraExp",null),__decorate([up(3)],e.prototype,"upUpgradeSamsaraLv",null),__decorate([down(1,ByteConst.ReincarnationVos.slice())],e.prototype,"downSamsaraInfo",null),__decorate([up(4,[3,2])],e.prototype,"upCompose",null),__decorate([down(4)],e.prototype,"downCompose",null),e=__decorate([protocolsId(64)],e)}(BaseSystem);__reflect(ReincarnationControl.prototype,"ReincarnationControl");var ExchangeVo=function(){function t(){}return t}();__reflect(ExchangeVo.prototype,"ExchangeVo");var ReincarnationVo=function(){function t(t,e,i,n,o){this.lv=t,this.exp=e,this.expUpgradeNum=i,this.normalUpgradeNum=n,this.advancedUpgradeNum=o}return t}();__reflect(ReincarnationVo.prototype,"ReincarnationVo");var ReincarnationAddSpiritView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="ReincarnationAddSpiritViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.lunhuiList.itemRenderer=ItemBase,this.addEventTouchTap(this.upBtn,this.addSpirit),this.addEventTouchTap(this.bgClose,this.closeWin),this.addCustomEvent(120,this.updateView),this.index=t[1],this.roleIndex=t[0],this.updateView()},e.prototype.updateView=function(){var t=heroControl.getSubRoleByIndex(this.roleIndex),e=t.getEquipByIndex(this.index);this.setData(e)},e.prototype.addSpirit=function(){var t=this.lunhuiList.dataProvider;if(reincarnationControl.checkSpiritLvIsMax(this.equipData,this.index))return void tipsControl.showTips(LangMgr.getValueByKey("samTips3"));if(0==t.length)tipsControl.showTips(LangMgr.getValueByKey("samTips4"));else{for(var e=[],i=0;i<t.length;i++){var n=t.getItemAt(i),o=backpackControl.getFilterBagItemById(n,e,BackpackControl.BAG_TYPE_EQUIP);o&&o.handle&&e.push(o.handle)}e.length>0&&equipControl.upAddSpirit(this.roleIndex,this.index,e)}},e.prototype.setData=function(t){this.equipData=t;var e=t.spiritLv;this.lvTxt.text="(Lv."+e+")";var i=CommonUtils.getObjectByUnionAttr(DataCenter.ins().ReincarnationSpiritConfig,this.index,e),n=CommonUtils.getObjectByUnionAttr(DataCenter.ins().ReincarnationSpiritConfig,this.index,e+1),o=0;this.attr4.text="0",this.attr5.text="0",this.attr6.text="0",this.attr7.text="0",i&&(o=BackpackControl.getAttrPower(i.attrs),this.attr4.text=i.attrs[0].value.toString(),this.attr5.text=i.attrs[1].value.toString(),this.attr6.text=i.attrs[2].value.toString(),this.attr7.text=i.attrs[3].value.toString()),this.powerPanel.setPower(o),e==CommonUtils.getObjectLength(DataCenter.ins().ReincarnationSpiritConfig[this.index])?(this.attrGroup2.visible=!1,this.expBar.maximum=100,this.expBar.value=100):(this.attrGroup2.visible=!0,this.attr8.text=n.attrs[0].value.toString(),this.attr9.text=n.attrs[1].value.toString(),this.attr10.text=n.attrs[2].value.toString(),this.attr11.text=n.attrs[3].value.toString(),this.expBar.maximum=n.consume,this.expBar.value=t.spiritExp),this.expLabel.text=this.expBar.value+"/"+this.expBar.maximum;var s=heroControl.getSubRoleByIndex(this.roleIndex),r=reincarnationControl.getAddSpiritEquips(s,this.index);this.lunhuiList.dataProvider=new ArrayCollection(r),this.redPoint.visible=reincarnationControl.checkEquipPosCanAddSpirit(s,this.index)},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(ReincarnationAddSpiritView.prototype,"ReincarnationAddSpiritView");var ReincarnationEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ReincarnationEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(void 0!=t[1]){this.roleIndex=-1,this.roleModel=t[1],this.index=t[2];var i=t[0],n=!1;if(i>=0&&i<=heroControl.subRolesLen-1){var o=heroControl.getSubRoleByIndex(i);o.handle==this.roleModel.handle&&(n=!0,this.roleIndex=this.roleModel.index)}var s=this.roleModel.getEquipByIndex(this.index);this.setData(s),n?(this.addEventTouchTap(this.spiritBtn,this.addSpirit),this.addEventTouchTap(this.soulBtn,this.addSoul),this.spiritBtn.visible=!0,this.soulBtn.visible=!0,this.starBtn.visible=!0):(this.spiritBtn.visible=!1,this.soulBtn.visible=!1,this.starBtn.visible=!1),this.showEnhanceAttrs(this.roleModel,this.index,n)}else this.setTips(t[0]);this.addEventTouchTap(this.bgClose,this.closeWin),this.addEventTouchEnd(this.starBtn,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.starBtn:UIMgr.ins().open(StarSunView,this.roleModel.index,this.index),UIMgr.ins().close(this)}},e.prototype.setTips=function(t){this.spiritBtn.visible=!1,this.soulBtn.visible=!1,this.starBtn.visible=!1,this.redPoint.visible=!1,this.redPoint1.visible=!1;var e=DataCenter.ins().ItemConfig[t];this.updateBaseView(e);var i=new ItemData;i.itemConfig=e;var n=ItemUtils.calculateBagItemScore(i);this.powerPanel.setPower(n),this.score.text=LangMgr.getValueByKey("wingPingfen",n);var o,s=ItemUtils.getSubType(e);9==s?(this.currentState="noSpirit0",o=!0):(o=!1,this.currentState="noSpirit1"),this.validateNow(),this.updateBaseAttr(t,o),this.setSoulAttr(0),this.setSoulLink(0,0);var r=[0,0,0,0];switch(s){case 9:r[0]=1;break;case 10:r[1]=1;break;case 11:r[2]=1;break;case 12:r[3]=1}this.setSuitAttr(e.id,r)},e.prototype.setData=function(t){this.soulBtn.visible=!0,this.spiritBtn.visible=!0,this.starBtn.visible=!0,this.redPoint.visible=this.roleIndex>=0&&reincarnationControl.checkEquipPosCanAddSpirit(this.roleModel,this.index),this.redPoint1.visible=this.roleIndex>=0&&reincarnationControl.checkUpgradeSoul(this.roleModel,this.index);var e=t.item.itemConfig;this.updateBaseView(e,t.soulLv);var i,n=DataCenter.ins().EquipConfig[e.id],o=t.spiritLv;if(0==o&&0==t.spiritExp)9==this.index?(this.currentState="noSpirit0",i=!0):(this.currentState="noSpirit1",i=!1);else{var s=o==CommonUtils.getObjectLength(DataCenter.ins().ReincarnationSpiritConfig[this.index]);9==this.index?(this.currentState="doSpirit0",i=!0):(this.currentState="doSpirit1",i=!1),this.setSpirit(t.spiritExp,t.spiritLv,s,i)}this.validateNow(),this.updateBaseAttr(e.id,i);var r=reincarnationControl.lowSuitEquips(this.index,this.roleModel);this.setSuitAttr(e.id,r),this.score.text=LangMgr.getValueByKey("wingPingfen",t.item.point);for(var a=0,l=0;l<r.length;l++)r[l]&&a++;var h=4==a,u=reincarnationControl.getReincarnateSuit(e.id),p=t.item.point;if(p=this.setSoulAttr(t.soulLv,e.id,p),p=this.setSoulLink(t.soulLv,reincarnationControl.getSoulLinkLv(this.roleModel,this.index,t.soulLv),e.id,p),this.roleModel&&n&&n.baseAttr2){var c=n.baseAttr2.value/100;p+=reincarnationControl.getExtraPower(this.roleModel,c,n.baseAttr2.type)}if(h&&(p+=BackpackControl.getAttrPower(u.attrs)),o>0){var d=CommonUtils.getObjectByUnionAttr(DataCenter.ins().ReincarnationSpiritConfig,this.index,o);p+=BackpackControl.getAttrPower(d.attrs)}p>>=0,this.powerPanel.setPower(p)},e.prototype.updateBaseView=function(t,e){void 0===e&&(e=0);var i=ItemUtils.getQuality(t),n=ItemUtils.getSubType(t),o=ItemUtils.getJob(t);if(this.nameLabel.text=t.name,e>0){var s=LangMgr.getValueByKey("samTips8");switch(e){case 1:s+="Ⅰ";break;case 2:s+="Ⅱ";break;case 3:s+="Ⅲ";break;case 4:s+="Ⅳ"}this.nameLabel.text=s+"."+t.name,this.itemIcon.setSoul(!0)}this.nameLabel.textColor=ItemUtils.getQualityColor(t),this.quali.source=i>0?"quali"+i:"",this.itemIcon.setData(t),this.type.text=RoleModel.getEquipNameByType(n),this.lv.text=LangMgr.getValueByKey("numberRotation",t.zsLevel),this.lv.textColor=reincarnateControl.lv<t.zsLevel?15937822:3532333,this.career.text=RoleModel.getJobNameByJob(o)},e.prototype.updateBaseAttr=function(t,e){var i=DataCenter.ins().EquipConfig[t];this.attr0.text=i.atk.toString(),this.attr1.text=i.hp.toString(),this.attr2.text=i.def.toString(),this.attr3.text=i.res.toString(),this.attr4.text=i.baseAttr1.value.toString(),e&&(this.attr5.text=i.baseAttr2.value/100+"%")},e.prototype.setSuitAttr=function(t,e){var i=reincarnationControl.getEquipSamsaraLv(t),n=reincarnationControl.getSamsaraDesc(i-7),o=reincarnationControl.getReincarnateSuit(t);this.suitName.text=LangMgr.getValueByKey("samTips9",n),this.attr12.text=this.getValue(o.attrs,4),this.attr13.text=this.getValue(o.attrs,2),this.attr14.text=this.getValue(o.attrs,5),this.attr15.text=this.getValue(o.attrs,6),this.attr16.text=o.exAttrs[0].value/100+"%";try{this.attrDesc2.visible=!0,this.attr17.text=o.exAttrs[1].value/100+"%"}catch(s){this.attrDesc2.visible=!1,this.attr17.text=""}for(var r=e[0]?ColorUtils.GREEN_COLOR:"0xff0000",a=e[1]?ColorUtils.GREEN_COLOR:"0xff0000",l=e[2]?ColorUtils.GREEN_COLOR:"0xff0000",h=e[3]?ColorUtils.GREEN_COLOR:"0xff0000",u=0,p=0;p<e.length;p++)e[p]&&u++;this.suitState.textFlow=TextUtils.generateTextFlow("<font color="+r+">"+RoleModel.getEquipNameByType(9)+"、</font><font color="+a+">"+RoleModel.getEquipNameByType(10)+"、</font><font color="+l+">"+RoleModel.getEquipNameByType(11)+"、</font><font color="+h+">"+RoleModel.getEquipNameByType(12)+"</font>");var c=4==u,d=c?ColorUtils.GREEN:16711680;this.suitNum.textColor=d,this.suitNum.text="("+u+"/4)",this.setSuitAttrTextColor(c)},e.prototype.setSuitAttrTextColor=function(t){var e=65322;this.attr12.textColor=e,this.attr13.textColor=e,this.attr14.textColor=e,this.attr15.textColor=e,this.attr16.textColor=e,this.attr17.textColor=e,this.attrDesc.textColor=e,this.attrDesc1.textColor=e,this.attrDesc2.textColor=e},e.prototype.setSpirit=function(t,e,i,n){var o,s=CommonUtils.getObjectByUnionAttr(DataCenter.ins().ReincarnationSpiritConfig,this.index,e);o=i?"":"("+t+"/"+s.consume+")",this.spiritLv.text="Lv"+e,this.spiritCost.text=o,0==e?(this.attr6.text="0",this.attr7.text="0",this.attr8.text="0",this.attr9.text="0"):(this.attr6.text=this.getValue(s.attrs,4),this.attr7.text=this.getValue(s.attrs,2),this.attr8.text=this.getValue(s.attrs,5),this.attr9.text=this.getValue(s.attrs,6))},e.prototype.getValue=function(t,e){var i=CommonUtils.getObjectByAttr(t,"type",e);return i.value.toString()},e.prototype.addSpirit=function(){this.closeWin(),UIMgr.ins().open(ReincarnationAddSpiritView,this.roleIndex,this.index)},e.prototype.addSoul=function(){this.closeWin(),UIMgr.ins().open(ReincarnationSoulView,this.roleIndex,this.index)},e.prototype.setSoulAttr=function(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),0==t)this.soulDescLable.visible=!1,this.soulAddAttr0.text="",this.soulAddAttr1.text="",this.soulAddAttr2.text="",this.soulAddAttr3.text="",this.soulAddAttr4.text="";else{this.soulDescLable.visible=!0;var n=DataCenter.ins().EquipConfig[e],o=n.atk,s=n.hp,r=n.def,a=n.res,l=n.baseAttr1.value,h=ItemUtils.getSubType(DataCenter.ins().ItemConfig[e]),u=DataCenter.ins().ReincarnationDemonLvConfig[h][t],p=u.precent/1e4;this.soulAddAttr0.text=Math.floor(o*p).toString(),this.soulAddAttr1.text=Math.floor(s*p).toString(),this.soulAddAttr2.text=Math.floor(r*p).toString(),this.soulAddAttr3.text=Math.floor(a*p).toString(),this.soulAddAttr4.text=Math.floor(l*p).toString();var c=0;if(n.baseAttr2&&(c=BackpackControl.getAttrPower([n.baseAttr2])),i=(i-c)*(1+p)+c,t>0){var d=DataCenter.ins().ReincarnationSoulLvConfig[ItemUtils.getJob(DataCenter.ins().ItemConfig[e])][h][t];i+=BackpackControl.getAttrPower(d.attrs)}i>>=0}return i},e.prototype.setSoulLink=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0),0==t?(this.chainGroup.parent&&this.chainGroup.parent.removeChild(this.chainGroup),this.soulGroup.parent&&this.soulGroup.parent.removeChild(this.soulGroup)):(this.chainGroup.parent||this.suitGroup.parent.addChild(this.soulGroup),this.soulGroup.parent||this.suitGroup.parent.addChild(this.soulGroup)),this.soulLv.text="Lv"+t;var o=e;if(0==e&&(o=1),this.chainLv.text="Lv"+o,i){var s=ItemUtils.getSubType(DataCenter.ins().ItemConfig[i]);if(o>0){var r=reincarnationControl.getReincarnationLinkLevel(s,o);this.chainPos.text=LangMgr.getValueByKey("samTips10",RoleModel.getEquipNameByType(r.secondSlot)),this.chainAttr.text=reincarnationControl.getSoulLinkDesc(r.attrs[0].type),this.chainValue.text=r.attrs[0].value/100+"%";var a=void 0;if(a=0==e?6710886:16776960,this.chainPos.textColor=a,this.chainAttr.textColor=a,this.chainState.textColor=a,this.chainValue.textColor=a,e>0){var l=this.roleModel,h=BackpackControl.getAttrPower([r.attrs[0]])+ItemUtils.relatePower(r.attrs[0],l);n+=h}}if(t>0){var u=DataCenter.ins().ReincarnationDemonLvConfig[s][t],p=void 0,c=u.precent/100;c+=100,p=c+"%",this.soulAttr.text=p}}return n},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e.prototype.showEnhanceAttrs=function(t,e,i){if(void 0===i&&(i=!0),i&&!starSunControl.open())return DisplayUtils.removeFromParent(this.starBtn.parent),void DisplayUtils.removeFromParent(this.starGroup0);var n=t.starSunVos;if(n[e].level){this.showEnhanceLevel(n[e].level);var o=new StarSunAttrsItemRenderer;o.data={role:t,pos:e},this.starGroup1.addChild(o)}var s=454-this.starGroup0.height;this.attrScoller.scrollPolicyV=this.starGroup1.parent.height>=s?"on":"off",this.anigroup.height=this.anigroup.height>802?930:this.anigroup.height,this.redPoint0.visible=starSunControl.checkUpRedPoint(t,e)},e.prototype.showEnhanceLevel=function(t){if(t){var e=new StarSunEnhanceTipsItemRenderer;e.data=t,this.starGroup0.addChild(e),this.attrScoller.top+=this.starGroup0.height,this.attrScoller.height=this.attrScoller.height>590?590:this.attrScoller.height}},e}(BaseEuiView);__reflect(ReincarnationEquipTipsView.prototype,"ReincarnationEquipTipsView");var ReincarnationGetExpView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="ReincarnationGetExpViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.redPoint1.visible=!1,this.redPoint2.visible=!1;var i=new RewardVo;i.type=0,i.id=0,i.count=0,this.item0.data=i,this.item0.isShowName(!1),this.item1.isShowName(!1),this.item2.isShowName(!1),this.addEventTouchTap(this.bgClose,this.closeWin),this.closeBtn&&this.addEventTouchTap(this.closeBtn,this.closeWin),this.addEventTouchTap(this.btn0,this.expUpgrade),this.addEventTouchTap(this.btn1,this.normalUpgrade),this.addEventTouchTap(this.btn2,this.advanceUpgrade),this.addCustomEvent(151,this.updateView),this.addCustomEvent(197,this.updateView),this.addCustomEvent(198,this.updateView),this.updateView(),reincarnationControl.firstRedPoint&&(reincarnationControl.firstRedPoint=!1)},e.prototype.expUpgrade=function(){this.btn0.enabled&&(ActorControl.level>=DataCenter.ins().ReincarnationBaseConfig.levelLimit?(this.lastYeli=reincarnationControl.samsaraInfo.exp,reincarnationControl.upExchangeSamsaraExp(1)):tipsControl.showTips(LangMgr.getValueByKey("samTips5",DataCenter.ins().ReincarnationBaseConfig.levelLimit)))},e.prototype.normalUpgrade=function(){this.btn1.label==LangMgr.getValueByKey("fdBuy")?this.buy(1,DataCenter.ins().ReincarnationBaseConfig.normalItem.id):(this.lastYeli=reincarnationControl.samsaraInfo.exp,reincarnationControl.upExchangeSamsaraExp(2))},e.prototype.advanceUpgrade=function(){this.btn2.label==LangMgr.getValueByKey("fdBuy")?this.buy(2,DataCenter.ins().ReincarnationBaseConfig.advanceItem.id):(this.lastYeli=reincarnationControl.samsaraInfo.exp,reincarnationControl.upExchangeSamsaraExp(3))},e.prototype.buy=function(t,e){var i=this["priceIcon"+t].getPrice();if(ActorControl.yb<i)tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),UIMgr.ins().close(this);else{var n=CommonUtils.getObjectByAttr(DataCenter.ins().StoreItemConfig,"itemId",e);this.buyGoods(n.id)}},e.prototype.buyGoods=function(t){storeControl.shopData.checkBuyGoodsId(t)&&UIMgr.ins().open(StoreBuyView,t)},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e.prototype.updateView=function(){if(void 0!=this.lastYeli&&reincarnationControl.samsaraInfo.exp-this.lastYeli>0&&(this.lastYeli=reincarnationControl.samsaraInfo.exp),ActorControl.level>=DataCenter.ins().ReincarnationBaseConfig.levelLimit){var t=DataCenter.ins().ReincarnationExConfig[ActorControl.level];this.yeli0.text=t.value.toString(),this.redPoint0.visible=reincarnationControl.getExpExchangeTimes()>0,this.btn0.enabled=reincarnationControl.getExpExchangeTimes()>0,this.limit.visible=!1}else this.yeli0.text=DataCenter.ins().ReincarnationExConfig[DataCenter.ins().ReincarnationBaseConfig.levelLimit].value.toString(),this.redPoint0.visible=!1,this.limit.visible=!0;this.toDay0.text=reincarnationControl.getExpExchangeTimes().toString(),this.updateItem(DataCenter.ins().ReincarnationBaseConfig.normalItem,1,reincarnationControl.getNormalExchangeTimes()),this.updateItem(DataCenter.ins().ReincarnationBaseConfig.advanceItem,2,reincarnationControl.getAdvancedExchangeTimes())},e.prototype.updateItem=function(t,e,i){var n=DataCenter.ins().ItemConfig[t.id];this["item"+e].data=t.id,this["toDay"+e].text=i.toString(),i>0?this["toDay"+e].textColor=65280:this["toDay"+e].textColor=16711680,this["yeli"+e].text=t.value.toString();var o=backpackControl.getBagGoodsCountById(0,t.id);o>0?(this["name"+e].text=LangMgr.getValueByKey("samTips7",n.name,o),this["priceIcon"+e].visible=!1,this["redPoint"+e].visible=i>0,this["btn"+e].label=LangMgr.getValueByKey("samTips6")):(this["name"+e].text=n.name,this["priceIcon"+e].visible=!0,this["priceIcon"+e].setPrice(CommonUtils.getObjectByAttr(DataCenter.ins().StoreItemConfig,"itemId",t.id).price),this["redPoint"+e].visible=!1,this["btn"+e].label=LangMgr.getValueByKey("fdBuy"))},e}(BaseEuiView);__reflect(ReincarnationGetExpView.prototype,"ReincarnationGetExpView");var ReincarnationPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.lvImgAry=[this.lv0,this.lv1,this.lv2,this.lv3,this.lv4,this.lv5],this.effectContainerAry=[this.eff0,this.eff1,this.eff2,this.eff3,this.eff4,this.eff5];for(var t in this.effectContainerAry){var e=new GameMovieClip;e.playFile(PATH_EFF+"reincarnation_fire",-1),this.effectContainerAry[t].addChild(e)}this.ballEffect=new GameMovieClip,this.ballEffect.playFile(PATH_EFF+"reincarnation_ball",-1),this.ball.addChild(this.ballEffect),this.labelEffect=new GameMovieClip,this.labelEffect.scaleX=.7,this.labelEffect.scaleY=.5,this.labelEffect.touchEnabled=!1,this.redPoint.visible=!1,this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.getItemTxt.text+"</u></a>")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.getItemTxt,this.getItem),this.addEventTouchTap(this.upBtn,this.upgrade),this.addCustomEvent(151,this.updateView),this.updateView()},e.prototype.upgrade=function(){this.isExpEnough?reincarnationControl.upUpgradeSamsaraLv():tipsControl.showTips(LangMgr.getValueByKey("samTips11"))},e.prototype.getItem=function(){UIMgr.ins().open(ReincarnationGetExpView)},e.prototype.getValue=function(t,e){var i=CommonUtils.getObjectByAttr(t,"type",e);return i.value.toString()},e.prototype.updateView=function(){var t=reincarnationControl.samsaraInfo,e=t.lv,i=DataCenter.ins().ReincarnationLevelConfig[e],n=AttributeData.getAttStr(i.attrs,0,1,"  :  ");this.attr1.text=n;var o=3*BackpackControl.getAttrPower(i.attrs);this.powerPanel1.setPower(o);var s,r=e+1,a=reincarnationControl.isMaxSamsara(e);if(a)this.powerPanel0.setPower(o),this.attr0.text=n,this.yeliValue.text=LangMgr.getValueByKey("maxLevel"),s=1;else{var l=DataCenter.ins().ReincarnationLevelConfig[r],h=3*BackpackControl.getAttrPower(l.attrs);this.powerPanel2.setPower(h),n=AttributeData.getAttStr(l.attrs,0,1,"  :  "),this.attr2.text=n;var u=void 0,p=t.exp,c=l.consume;p>=c?(u=ColorUtils.GREEN_COLOR,this.isExpEnough=!0):(u=ColorUtils.RED_COLOR,this.isExpEnough=!1),this.yeliValue.textFlow=TextUtils.generateTextFlow("<font color="+u+">"+p+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+c+"</font> "),s=p/c}this.setMaxSamsaraState(a),reincarnationControl.isCanExchange()?this.addLabelEffect():this.removeLabelEffect();var d=reincarnationControl.getSamsara(ActorControl.samsaraLv),g=reincarnationControl.getSamsaraLv(ActorControl.samsaraLv),m=reincarnationControl.getSamsaraDesc(d)+"·"+reincarnationControl.getSamsaraLvDesc(g);this.lunhuiLv.text=m,this.setLvImgState(g),this.maskImage(s),this.redPoint.visible=this.upBtn.visible&&reincarnationControl.isCanUpgrade()},e.prototype.setMaxSamsaraState=function(t){this.attrGroup0.visible=t,this.arrow.visible=!t,this.attrGroup1.visible=!t,this.attrGroup2.visible=!t,this.upBtn.visible=!t,this.getItemTxt.visible=!t,this.maxLevel.visible=t},e.prototype.setLvImgState=function(t){for(var e in this.lvImgAry)this.lvImgAry[e].visible=!1,this.effectContainerAry[e].visible=!1;for(var e=0;t>=e;e++)this.lvImgAry[e].visible=!0,this.effectContainerAry[e].visible=!0},e.prototype.addLabelEffect=function(){var t=this;TimerMgr.ins().doNext(function(){DisplayUtils.removeFromParent(t.labelEffect),t.labelEffect.x=t.getItemTxt.x+t.getItemTxt.width/2,t.labelEffect.y=t.getItemTxt.y+t.getItemTxt.height/2,null==t.labelEffect.parent&&t.getItemTxt.parent.addChild(t.labelEffect),t.labelEffect.playFile(PATH_EFF+"chargeff1",-1)},this)},e.prototype.maskImage=function(t){if(t>=1)return DisplayUtils.removeFromParent(this.masksp),void(this.masksp=null);var e=103;if(!this.masksp){this.masksp=new egret.Sprite;var i=new egret.Shape;i.graphics.beginFill(16776960),i.graphics.drawRect(this.ball.x-60,this.ball.y-45,120,e),i.graphics.endFill(),this.masksp.addChild(i),this.ball.parent.addChild(this.masksp),this.ball.mask=this.masksp}this.masksp.y=e*(1-t)},e.prototype.removeLabelEffect=function(){this.labelEffect.stop(),DisplayUtils.removeFromParent(this.labelEffect)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e}(BasePanel);__reflect(ReincarnationPanel.prototype,"ReincarnationPanel");var ReincarnationSoulView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="ReincarnationSoulViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(121,this.updateView),this.addEventTouchTap(this.soulBtn,this.addSoul),this.addEventTouchTap(this.closeBtn,this.closeWin),this.roleIndex=t[0],this.subType=t[1],this.updateView()},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e.prototype.addSoul=function(){equipControl.upAddSoul(this.roleIndex,this.subType)},e.prototype.updateView=function(){var t=heroControl.getSubRoleByIndex(this.roleIndex),e=t.getEquipByIndex(this.subType);this.itemId=e.item.itemConfig.id;var i=t.getEquipByIndex(this.subType);this.soulLv=i.soulLv,this.soulLinkLv=reincarnationControl.getSoulLinkLv(t,this.subType,i.soulLv);var n=DataCenter.ins().ItemConfig[this.itemId],o=ItemUtils.getSubType(n),s=ItemUtils.getJob(n),r=reincarnationControl.getSoulMaxLevel(),a=this.soulLv==r,l=this.soulLinkLv==r;if(this.nextSoulTextGroup.visible=!(0==this.soulLv||a),this.nextChainTextGroup.visible=!(0==this.soulLinkLv||l),this.nextChainTextGroup.visible){var h=reincarnationControl.getReincarnationLinkLevel(o,this.soulLinkLv+1);this.nextChain0.text=h.attrs[0].value/100+"%"}if(this.nextSoulTextGroup.visible){var h=DataCenter.ins().ReincarnationDemonLvConfig[o][this.soulLv+1];this.nextChain1.text=100+h.precent/100+"%"}var u=0;u=0==this.soulLinkLv?1:this.soulLinkLv;var p=0;p=0==this.soulLv?1:this.soulLv;var c=reincarnationControl.getReincarnationLinkLevel(o,u);this.chainPos.text=LangMgr.getValueByKey("samTips10",RoleModel.getEquipNameByType(c.secondSlot)),this.chainAttr.text=reincarnationControl.getSoulLinkDesc(c.attrs[0].type),this.chainState.text=LangMgr.getValueByKey("samTips12"),this.chainValue.text=c.attrs[0].value/100+"%";var d,g=DataCenter.ins().ReincarnationDemonLvConfig[o][p],m=g.precent/100;m+=100,d=m+"%",this.soulAttr.text=d;var f=DataCenter.ins().ReincarnationSoulLvConfig[s][o][p],v=AttributeData.getAttStr(f.attrs,0,1,"  :  "),y=BackpackControl.getAttrPower(f.attrs);y+=this.getChainAddPower(this.soulLinkLv),y+=this.getSoulAddPower(e,this.soulLv),a||this.powerPanel0.setPower(y),0==this.soulLv?(this.attr0.text=LangMgr.getValueByKey("samTips13"),this.powerPanel0.setPower(0)):this.attr0.text=v;var C;if(a)this.attrGroup0.visible=!1,this.attrGroup1.visible=!1,this.attrGroup3.visible=!0,this.attr3.text=v,this.powerPanel3.setPower(y);else{this.attrGroup0.visible=!0,this.attrGroup1.visible=!0,this.attrGroup3.visible=!1,C=DataCenter.ins().ReincarnationSoulLvConfig[s][o][this.soulLv+1];var T=AttributeData.getAttStr(C.attrs,0,1,"  :  ");this.attr1.text=T;var w=BackpackControl.getAttrPower(C.attrs);w+=this.getChainAddPower(this.soulLinkLv+1),w+=this.getSoulAddPower(e,this.soulLv+1),this.powerPanel1.setPower(w)}this.chainLv0.text="Lv"+u,this.soulLvText.text="Lv"+p;var I=f.materialInfo.id,b=backpackControl.getBagGoodsCountById(0,I),D=!1;C&&(D=b>=C.materialInfo.count),this.materialLabel.text=DataCenter.ins().ItemConfig[I].name,this.costImg.source=DataCenter.ins().ItemConfig[I].icon+"_png",this.num.text=b.toString(),C?this.needNum.text="/"+C.materialInfo.count.toString():this.needNum.text="/0",this.soulBtn.enabled=D&&!a,D?this.num.textColor=ColorUtils.GREEN:this.num.textColor=ColorUtils.RED,this.redPoint.visible=D&&!a,this.arrow0.visible=!a,this.rein_title.source="rein_demon_soul_"+s+o},e.prototype.getChainAddPower=function(t){if(0==t)return 0;var e=reincarnationControl.getReincarnationLinkLevel(this.subType,t),i=heroControl.getSubRoleByIndex(this.roleIndex),n=BackpackControl.getAttrPower([e.attrs[0]])+ItemUtils.relatePower(e.attrs[0],i);return n>>0},e.prototype.getSoulAddPower=function(t,e){if(0==e)return 0;var i=DataCenter.ins().ReincarnationDemonLvConfig[this.subType][e],n=i.precent/1e4,o=ItemUtils.getBaseAttrData(t.item.itemConfig);return BackpackControl.getAttrPower(o)*n>>0},e.prototype.getValue=function(t,e){var i=CommonUtils.getObjectByAttr(t,"type",e);return i.value.toString()},e}(BaseEuiView);__reflect(ReincarnationSoulView.prototype,"ReincarnationSoulView");var ReincarnationComposeItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.addEventTouchTap(this.compose,this.onTouch),this.addEventTouchTap(this.compose1,this.onTouch),this.addEventRemovedFromStage(this,this.onRemove)
},e.prototype.dataChanged=function(){var t=this.data;if(t){var e=void 0,i=void 0,n=void 0;if(1==t.type)e=DataCenter.ins().ReincarnationEqComConfig[t.id],i=e.material.id,n=e.material.count,this.currentState="state1";else if(2==t.type)e=DataCenter.ins().AshtarteEquipConfig[t.id],i=e.mat[0].id,n=e.mat[0].count,this.currentState="state1";else{if(3==t.type)return this.currentState="state2",void this.setState3Info(t.type,t.id);if(4==t.type){var o=beastControl.getEquipQuality(t.id);this.currentState="state1",i=+t.id-1e3,n=DataCenter.ins().BeastConfig.matLimit[o-1].count}}this.need.showName=!0,this.need.data=i,this.num.text=n.toString(),this.target.showName=!0,this.target.data=t.id;var s=pieceControl.isCanMergeTargetId(t.type,t.id);this.redPoint.visible=s,s?this.content.filters=null:this.content.filters=FilterUtils.ARRAY_GRAY_FILTER}},e.prototype.onTouch=function(){if(this.redPoint.visible){var t=this.data,e=void 0;if(1==t.type){e=DataCenter.ins().ReincarnationEqComConfig[t.id];var i=reincarnationControl.getRoleIndexByEquip(e.material.id);reincarnationControl.upCompose(t.id,i)}else 2==t.type?ashtarteControl.upComposeItem(t.id):4==t.type&&beastControl.upComposeEquip(beastControl.getCanComposeList(t.id))}else this.redPoint1.visible?3==this.data.type?runeControl.upRuneMerge(this.data.id):4==this.data.type&&beastControl.upComposeEquip(beastControl.getCanComposeList(this.data.id)):tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"))},e.prototype.setState3Info=function(t,e){if(this.redPoint.visible=!1,this.need0.showName=!0,this.need1.showName=!0,this.need2.showName=!0,this.target1.showName=!0,3==t){var i=DataCenter.ins().RuneComposeConfig[e],n=DataCenter.ins().RuneOtherConfig.goldItemId;this.need0.data=i.material[0],this.need1.data=i.material[1],i.material[2]?(this.need2.num=1,this.need2.data=i.material[2]):(this.need2.num=i.count,this.need2.data=n),this.target1.data=i.id}var o=pieceControl.isCanMergeTargetId(t,e);this.redPoint1.visible=o,this.compose1.enabled=o,this.content1.filters=o?null:FilterUtils.ARRAY_GRAY_FILTER},e.prototype.setState2Info=function(t,e){if(this.redPoint.visible=!1,this.need0.showName=!0,this.need1.showName=!0,this.target1.showName=!0,4==t){var i=e-1e3,n=beastControl.getEquipQuality(i),o=DataCenter.ins().BeastConfig.matLimit[n];this.need0.data=i,this.need1.num=o.mixcount,this.need1.data=o.id,this.target1.data=e}var s=pieceControl.isCanMergeTargetId(t,e);this.redPoint1.visible=s,this.compose1.enabled=s,this.content1.filters=s?null:FilterUtils.ARRAY_GRAY_FILTER},e.prototype.onRemove=function(t){this.content&&(this.content.filters=null)},e}(BaseItemRender);__reflect(ReincarnationComposeItemRender.prototype,"ReincarnationComposeItemRender");var ReincarnationComposeSecMenuItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data.type,e=this.data.zsLv,i=reincarnationControl.getComposeDesc(t);this.head.text=i,this.lv.text=LangMgr.getValueByKey("samTips2",e),this.redPoint.visible=reincarnationControl.isCanZsLvCompose(t,e);var n=UIMgr.ins().getView(BackpackView).piecePanel;n.type==t&&n.zsLv==e&&this.setSelect(!0)},e.prototype.setSelect=function(t){this.chosen.visible=t},e}(BaseItemRender);__reflect(ReincarnationComposeSecMenuItemRender.prototype,"ReincarnationComposeSecMenuItemRender");var ResultControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.create=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];switch(this.fbType=t||MapControl.copyType,this.fbType){case 44:this.dropShow.apply(this,[this.fbType].concat(e));break;default:this.creatResult.apply(this,[this.fbType].concat(e))}},e.prototype.creatResult=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];switch(t){case 6:case 29:(n=UIMgr.ins()).open.apply(n,[PersonalResultView].concat(e));break;case 9:(o=UIMgr.ins()).open.apply(o,[ClimbTowerResultView].concat(e));break;case 24:case 2:24==t&&void 0!=e&&void 0!=e[0]&&0==e[0]&&amusementControl.removeEvent(),(s=UIMgr.ins()).open.apply(s,[MaterialResultView].concat(e));break;case 19:UIMgr.ins().open(WorldBossResultView);break;case 20:UIMgr.ins().open(ToseongBossResultView,e[1],e[4]);break;case 7:case 105:case 10:case 17:case 31:case 36:case 37:case 44:case 50:case 47:case 57:case 62:case 74:case 76:case 26:case 61:UIMgr.ins().open(BossResultView,e[1],e[4]);break;case 27:break;case 32:(r=UIMgr.ins()).open.apply(r,[CrossBossResultView].concat(e));break;case 60:(a=UIMgr.ins()).open.apply(a,[MineHelpResultView].concat(e));break;case 90:UIMgr.ins().open(SealPveResultView,e[0],e[1],e[2]);break;default:DieGuide.ins().dispatchdieGuide(e[0]),(l=UIMgr.ins()).open.apply(l,[ResultView].concat(e))}var n,o,s,r,a,l},e.prototype.dropShow=function(t){for(var e=this,i=[],n=1;n<arguments.length;n++)i[n-1]=arguments[n];for(var o=i[1],s=i[4][3],r=0;r<o.length;r++){var a=o[r];0==a.type&&1!=a.id&&2!=a.id&&9!=a.id||DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(s.x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(s.y/MapControl.CELL_SIZE),a])}s?(DropControl.start(s),DropControl.addCompleteFunc(function(){e.creatResult(t,i[0],e.mergeAward(o),i[2],i[3],i[4])},this)):this.creatResult(t,i[0],this.mergeAward(o),i[2],i[3],i[4])},e.prototype.mergeAward=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];if(0!=n.type||1!=n.id&&2!=n.id&&0!=n.id)e.push(n);else{for(var o=!1,s=0;s<e.length;s++){var r=e[s];r.id==n.id&&(r.count+=n.count,o=!0)}o||e.push(n)}}return e},e}(SingleClass);__reflect(ResultControl.prototype,"ResultControl");var BossResultView=function(t){function e(){var e=t.call(this)||this;return e.repeatTimes=5,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="BossResultViewSkin",this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.winnerEff=new GameMovieClip,this.winnerEff.x=41,this.winnerEff.y=41,this.winnerEff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._fbType=resultControl.fbType,this.bg.source="resultWin_png",this.closeBtn.name=LangMgr.getValueByKey("tongGetGift"),this.title.source="win_02";var i=5;(10==this._fbType||7==this._fbType||105==this._fbType||47==this._fbType||44==this._fbType||totemBossControl.inCopy)&&(i=10),this.countdown=this.repeatTimes=i,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this);var n=t[0];if(t[1]){var o=t[1][0];o?(this.winnerEff.parent||this.effGroup.addChild(this.winnerEff),this.winnerEff.playFile(PATH_EFF+"yanhuaeff",1),this.labelItem.text=LangMgr.getValueByKey("kfTips36")):(this.belongTxt.textColor=14668213,44==this._fbType||50==this._fbType||crazybtplayCopyControl.isShenwujindi||reincarnateStarBossControl.isInFb||totemBossControl.inCopy?(this.labelItem.text=LangMgr.getValueByKey("guishuaw"),this.closeBtn.name=LangMgr.getValueByKey("babelEnter")):this.labelItem.text=LangMgr.getValueByKey("myzhanyuaw"));var s=t[1][1]||"",r=s.split("\n");s=r[1]?r[1]:r[0],s=StringUtils.replaceStr(s,"0xffffff",ColorUtils.GREEN+""),this.belongTxt.textFlow=TextUtils.generateTextFlow1(s),this.roleIcon.icon=t[1][2],this.roleIcon.jobImg.visible=!1}else this.belongTxt.text="";this.addEventTouchTap(this.closeBtn,this.onTap),n?this.setRewardList(n):this.setRewardList()},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);var e=[],i=[],n=[];this.labelItem.visible=!0;for(var o=[],s=[],r=[],a=[],l=0;l<t.length;l++)if(1!=t[l].dropType){var h=DataCenter.ins().ItemConfig[t[l].id],u=ItemUtils.getType(h);if(1!=u)if(0==t[l].type){var p=e;4==t[l].id&&(p=o),bossControl.checkIsOpenMult(this._fbType)?this.mergeItem(t[l],p):p.push(t[l])}else 28==u?s.push(t[l]):8==u?this.mergeItem(t[l],n):n.push(t[l]);else this.mergeItem(t[l],i)}else r.push(t[l]);CommonFun.sortAwards(n),s.sort(this.andianSortFun),a=s.concat(o,e,i,n),a=r.concat(a),this.listItem.dataProvider=new eui.ArrayCollection(a)},e.prototype.mergeItem=function(t,e){if(e.length){for(var i=!1,n=0;n<e.length;n++)if(e[n].id==t.id){e[n].count+=t.count,i=!0;break}i||e.push(t)}else e.push(t)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateCloseBtnLabel,this),this.removeEventTouchTap(this.closeBtn,this.onTap),MapControl.copyId>0&&copyControl.isQuite&&10!=this._fbType&&!totemBossControl.inCopy&&47!=this._fbType&&57!=this._fbType&&74!=this._fbType&&this._fbType==MapControl.copyType&&copyControl.upExitFb(),17==this._fbType&&UIMgr.ins().open(BossView,5),this.closeFunc&&(this.closeFunc(),this.closeFunc=null)},e.prototype.andianSortFun=function(t,e){var i=DataCenter.ins().DarkEquipConfig[t.id],n=DataCenter.ins().DarkEquipConfig[e.id];return i.star>n.star?-1:i.star<n.star?1:i.itemId>n.itemId?-1:i.itemId<n.itemId?1:0},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&UIMgr.ins().close(this),this.closeBtn.label=this.closeBtn.name+"("+this.countdown+"s)"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(BossResultView.prototype,"BossResultView");var ClimbTowerResultView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ClimbTowerResultViewSkin",this.listCoin.itemRenderer=ResultCoinItemRenderer,this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.list0.itemRenderer=ResultFailItemRenderer},e.prototype.showRune=function(t){if(9==MapControl.copyType){if(!t)return void(this.nune.visible=!1);var e=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel-1];if(!e||!e.showIcon)return void(this.nune.visible=!1);var i=DataCenter.ins().ItemConfig[e.showIcon],n=ItemUtils.getQuality(i);if(n==CopyBabelPanel.RunType)return void(this.nune.visible=!1);this.nune.visible=!0,this.scrollerGroup.y+=3*this.nune.height/2;var o="";e.equipPos?(this.nuneLock.visible=!0,o=LangMgr.getValueByKey("tongOpenZW"),this.oldValue.text=(e.equipPos-1).toString(),this.newValue.text=e.equipPos.toString()):(this.nuneLock.visible=!1,o=LangMgr.getValueByKey("tongOpenType"),this.nuneValue.text=e.describe),this.nameLabel.text=o,this.nuneValue.visible=!this.nuneLock.visible}},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e);var n=e[0];this.bg.source=n?"resultWin_png":"resultLost_png",this.closeBtn.name=n?LangMgr.getValueByKey("tongGetGift"):LangMgr.getValueByKey("tongExit"),this.title.source=n?"win_02":"lost_02",DieGuide.ins().dispatchdieGuide(n),this.showRune(n),this.countdown=this.repeatTimes=5,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this);var o=e[1];if(e[2]&&(this.txt.text=e[2]),copyControl.isQuite=!0,e[3]instanceof Function?this.closeFunc=e[3]:0==e[3]&&(copyControl.isQuite=e[3]),this.txt.visible=0!=n,this.defeat.visible=0==n,this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.rewardBtn,this.onTap),0==n)this.rewardBtn.visible=!1,this.updateDefeatList();else if(1==n){var s=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel];s&&reincarnateControl.lv>=s.zsLevelLimit&&ActorControl.level>=s.levelLimit&&0==copyBabelControl.lotteryRemainTimes?(this.rewardBtn.visible=!0,this.closeBtn.x=0,1==s.layer?(this.rewardBtn.label=LangMgr.getValueByKey("tongContinuFight"),this.rewardBtn.width=130):(this.rewardBtn.label=LangMgr.getValueByKey("tongFightLevel",s.layer),this.rewardBtn.width=140)):(this.rewardBtn.visible=!1,this.closeBtn.x=90)}o?this.setRewardList(o):this.setRewardList(),this.rewardBtn.name=this.rewardBtn.label},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);for(var e=[],i=[],n=[],o=[],s=[],r=0;r<t.length;r++){var a=DataCenter.ins().ItemConfig[t[r].id];if(1!=ItemUtils.getType(a))0==t[r].type?e.push(t[r]):i.push(t[r]);else if(o.length){for(var l=!1,h=0;h<o.length;h++)if(o[h].id==t[r].id){o[h].count+=t[r].count,l=!0;break}l||o.push(t[r])}else o.push(t[r])}this.scrollerGroup.height=324,this.labelItem.text=LangMgr.getValueByKey("tongGetProp"),this.labelItem.height=i.length>0?20:0,this.labelItem.visible=i.length>0,e.sort(this.RuleSort),i.sort(this.RuleSortByItem),this.listCoin.dataProvider=new eui.ArrayCollection(e),s=n.concat(e,o,i),this.listItem.dataProvider=new eui.ArrayCollection(s)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateCloseBtnLabel,this),this.removeEventTouchTap(this.closeBtn,this.onTap),MapControl.copyId>0&&copyControl.isQuite&&copyControl.upExitFb(),this.closeFunc&&(this.closeFunc(),this.closeFunc=null),copyBabelControl.lotteryRemainTimes>0&&9==MapControl.copyType&&UIMgr.ins().open(CopyBabelLotteryView)},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&(this.rewardBtn.visible&&(challengeCopyControl.upChallenge(),copyControl.isQuite=!1),UIMgr.ins().close(this)),this.rewardBtn.visible?this.rewardBtn.label=this.rewardBtn.name+"("+this.countdown+"s)":this.closeBtn.label=this.closeBtn.name+"("+this.countdown+"s)"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.rewardBtn:challengeCopyControl.upChallenge(),copyControl.isQuite=!1,UIMgr.ins().close(this)}},e.prototype.updateDefeatList=function(){var t=[];for(var e in DataCenter.ins().DeathGuideConfig){var i=DataCenter.ins().DeathGuideConfig[e];if(reincarnateControl.lv<=i.zslv||ActorControl.level<=i.lv){for(var n in i.gainWay)if(16!=i.gainWay[n][0]){if(14==i.gainWay[n][0]||20==i.gainWay[n][0]){var o=Object.keys(DataCenter.ins().VipConfig).length;if(vipControl.lv>=o)continue}t.push(i.gainWay[n][0])}else{var s=DieGuide.ins().getOpenRoles();if(s){var r=DataCenter.ins().DeathgainWayConfig[i.gainWay[n][0]];r.itemId=s,t.push(i.gainWay[n][0])}}break}}this.listData0.source=t,this.list0.dataProvider=this.listData0},e.prototype.RuleSort=function(t,e){return t.id<e.id?-1:1},e.prototype.RuleSortByItem=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],n=DataCenter.ins().ItemConfig[e.id],o=ItemUtils.getQuality(i),s=ItemUtils.getQuality(n);return o>s?-1:s>o?1:0},e}(BaseEuiView);__reflect(ClimbTowerResultView.prototype,"ClimbTowerResultView");var ExpResultView=function(t){function e(){var e=t.call(this)||this;return e.countdown=11,e.skinName="ExpResultViewSkin",e.uilayer=GameLayer.POPUP,e.lbExp=BitmapNumber.ins().createNumPic(0,"r0",5),e.lbExp.y=97,e.lbExp.x=180,e.mainGroup.addChild(e.lbExp),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btnGet,this.onTouch),this.addCustomEvent(371,this.update),this.update(),this.countdown=9,this.btnGet.name=LangMgr.getValueByKey("fireGoGet"),this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.countdown,this.updateCloseBtnLabel,this)},e.prototype.onTouch=function(){UIMgr.ins().close(this)},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&UIMgr.ins().close(this),this.btnGet.label=this.btnGet.name+"("+this.countdown+"s)"},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().remove(this.updateCloseBtnLabel,this),UIMgr.ins().open(CopyView,1,SwitchMgr.ins().checkOpen(1013)?1:0),copyControl.upExitFb()},e.prototype.update=function(){var t=copyControl.fbExp,e=DataCenter.ins().CopyExpConfig[t.cid||t.sid];if(e){var i=DataCenter.ins().MonthCardConfig.expFubenPrecent/100,n=payControl.getIsForeve()?1+i:1;this.setExp(Math.ceil(e.exp*n))}},e.prototype.setExp=function(t){BitmapNumber.ins().changeNum(this.lbExp,t,"r0",5),this.lbExp.anchorOffsetX=this.lbExp.width/2},e}(BaseEuiView);__reflect(ExpResultView.prototype,"ExpResultView");var FireResultView=function(t){function e(){var e=t.call(this)||this;return e.countdown=11,e.skinName="FireResultViewSkin",e.uilayer=GameLayer.POPUP,e.lbExp=BitmapNumber.ins().createNumPic(0,"r0",5),e.lbExp.y=103,e.lbExp.x=171,e.mainGroup.addChild(e.lbExp),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btnGet,this.onTouch),this.countdown=9,this.btnGet.name=LangMgr.getValueByKey("fireGoGet"),this.updateCloseBtnLabel(),this.setExp(),TimerMgr.ins().doTimer(1e3,this.countdown,this.updateCloseBtnLabel,this)},e.prototype.onTouch=function(){UIMgr.ins().close(this)},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&UIMgr.ins().close(this),this.btnGet.label=this.btnGet.name+"("+this.countdown+"s)"},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().remove(this.updateCloseBtnLabel,this),UIMgr.ins().open(FireRingView,2),copyControl.upExitFb()},e.prototype.setExp=function(){var t=DataCenter.ins().FireRingRoleFubenConfig.reward[0].count;BitmapNumber.ins().changeNum(this.lbExp,t,"r0",5)},e}(BaseEuiView);__reflect(FireResultView.prototype,"FireResultView");var LadderResultView=function(t){function e(){var e=t.call(this)||this;return e.skinName="LadderResultViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.listData=new eui.ArrayCollection,this.list.itemRenderer=ItemBase,this.mc=new GameMovieClip,this.mc.scaleX=this.mc.scaleY=1.2,this.starList.addChildAt(this.mc,0)},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this.isWin=e[0];var n=e[1],o=e[2],s=e[3],r=e[4];this.bg.source=this.isWin?"resultWin_png":"resultLost_png",this.result.source=this.isWin?"win_02":"lost_02",this.sureBtn.name=this.isWin?LangMgr.getValueByKey("tongGetGift"):LangMgr.getValueByKey("tongExit1"),this.s=5,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,5,this.updateCloseBtnLabel,this),this.listData.source=n,this.list.dataProvider=this.listData,this.refushStarInfo(o,s,r),this.addEventTouchTap(this.sureBtn,this.onTap),this.playEffect()},e.prototype.playEffect=function(){this.isWin&&(this.mc.playFile(PATH_EFF+"laddercircle",-1),this.mc.x=this.starList.width>>1,this.mc.y=this.starList.height>>1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateCloseBtnLabel,this),this.removeEventTouchTap(this.sureBtn,this.onTap),egret.Tween.removeTweens(this.starList),DisplayUtils.removeFromParent(this.mc),MapControl.copyId>0&&(copyControl.upExitFb(),UIMgr.ins().open(LadderView,1))},e.prototype.refushStarInfo=function(t,e,i){var n=ladderControl.getLevelConfig(t,e);this.upLevel=t,this.upId=e,this.starList.updataStarInfo(n),this.lastlevel=n.showDan,this.lastRank=n.level,this.star1.visible=!1,this.star2.visible=!1;for(var o=0;i>o;o++)this["star"+(o+1)].visible=!0,this["star"+(o+1)].currentState=this.isWin?"light":"black";if(this.upStar.visible=ladderControl.getLevelConfig().showDan>0,i>0){var s=this,r=function(){TimerMgr.ins().remove(r,s),s.setStarInfoChange(n.showStar,i)};TimerMgr.ins().doTimer(500,1,r,s)}},e.prototype.setStarInfoChange=function(t,e){e>0&&this.starList.upStarStatu(t+1,e,this.isWin)},e.prototype.cheackIsChangeLevel=function(t){var e=this;if(this.upLevel!=ladderControl.level||this.upId!=ladderControl.nowId){var i=egret.Tween.get(this.starList);i.to({alpha:1},300).call(function(){e.isWin&&t>=1&&e.starList.upStarStatu(1,t,e.isWin);var i=ladderControl.getLevelConfig(),n=i.showDan,o=i.level;e.lastRank<o?(e.starList.showRankUp(o),e.starList.showLvUp(n)):e.lastlevel<n?e.starList.showLvDown(n):e.lastlevel>n&&e.starList.showLvUp(n),e.starList.updataStarInfo(i),egret.Tween.removeTweens(e.starList)},this)}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sureBtn:UIMgr.ins().close(this)}},e.prototype.updateCloseBtnLabel=function(){this.s--,this.s<=0&&UIMgr.ins().close(this),this.sureBtn.label=this.sureBtn.name+"("+this.s+"s)"},e}(BaseEuiView);__reflect(LadderResultView.prototype,"LadderResultView");var MaterialResultView=function(t){function e(){var e=t.call(this)||this;return e.winResult=0,e.repeatTimes=5,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="MaterialResultViewSkin",this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.list0.itemRenderer=ResultFailItemRenderer},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this._fbType=MapControl.copyType;var n=e[0];this.winResult=n,this.bg.source=n?"resultWin_png":"resultLost_png",this.closeBtn.name=n?LangMgr.getValueByKey("tongGetGift"):LangMgr.getValueByKey("tongExit"),this.title.source=n?"win_02":"lost_02",DieGuide.ins().dispatchdieGuide(n),this.countdown=this.repeatTimes=5,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this);var o=e[1];e[2]&&(this.txt.text=e[2]),this.txt.visible=0!=n,this.defeat.visible=0==n,this.addEventTouchTap(this.closeBtn,this.onTap),0==n&&this.updateDefeatList(),o&&this.setRewardList(o)},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);for(var e=[],i=0;i<t.length;i++){var n=DataCenter.ins().ItemConfig[t[i].id];1==ItemUtils.getType(n)&&e.push(t[i])}this.listItem.dataProvider=new eui.ArrayCollection(e)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(TimerMgr.ins().remove(this.updateCloseBtnLabel,this),this.removeEventTouchTap(this.closeBtn,this.onTap),copyControl.upExitFb(),2==this._fbType){var i=WarriorConfigMgr.ins().getBaseConfig(),n=i.fbId;DataCenter.ins().DailyCopyConfig[n];WarriorModel.ins().flagFromTaskWinBattle?(WarriorModel.ins().flagFromTaskWinBattle=!1,UIMgr.ins().open(WarriorTaskView)):UIMgr.ins().open(CopyView,0)}},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&UIMgr.ins().close(this),this.closeBtn.label=this.closeBtn.name+"("+this.countdown+"s)"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.updateDefeatList=function(){var t=[];for(var e in DataCenter.ins().DeathGuideConfig){var i=DataCenter.ins().DeathGuideConfig[e];if(reincarnateControl.lv<=i.zslv||ActorControl.level<=i.lv){for(var n in i.gainWay)if(16!=i.gainWay[n][0])t.push(i.gainWay[n][0]);else{var o=DieGuide.ins().getOpenRoles();if(o){var s=DataCenter.ins().DeathgainWayConfig[i.gainWay[n][0]];s.itemId=o,t.push(i.gainWay[n][0])}}break}}this.listData0.source=t,this.list0.dataProvider=this.listData0},e}(BaseEuiView);__reflect(MaterialResultView.prototype,"MaterialResultView");var PersonalResultView=function(t){function e(){var e=t.call(this)||this;return e.repeatTimes=5,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="PersonalResultViewSkin",this.listCoin.itemRenderer=ResultCoinItemRenderer,this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.list0.itemRenderer=ResultFailItemRenderer},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this._fbType=MapControl.copyType;var n=e[0];this.bg.source=n?"resultWin_png":"resultLost_png",this.closeBtn.name=n?LangMgr.getValueByKey("tongGetGift"):LangMgr.getValueByKey("tongExit"),this.title.source=n?"win_02":"lost_02",DieGuide.ins().dispatchdieGuide(n);var o=5;this.countdown=this.repeatTimes=o,this.updateCloseBtnLabel(),TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this);var s=e[1];e[2]&&(this.txt.text=e[2]),29==MapControl.copyType&&(this.txt.text=LangMgr.getValueByKey("personalKillTime",guardControl.getKillWave())),copyControl.isQuite=!0,e[3]instanceof Function&&(this.closeFunc=e[3]),this.txt.visible=0!=n,this.defeat.visible=0==n,this.addEventTouchTap(this.closeBtn,this.onTap),0==n&&this.updateDefeatList(),s?this.setRewardList(s):this.setRewardList()},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);for(var e=[],i=[],n=[],o=[],s=[],r=0;r<t.length;r++){var a=DataCenter.ins().ItemConfig[t[r].id];if(1!=ItemUtils.getType(a))0==t[r].type?e.push(t[r]):i.push(t[r]);else if(o.length){for(var l=!1,h=0;h<o.length;h++)if(o[h].id==t[r].id){o[h].count+=t[r].count,l=!0;break}l||o.push(t[r])}else o.push(t[r])}this.labelItem.text=LangMgr.getValueByKey("tongGetProp"),this.labelItem.height=i.length>0?20:0,this.labelItem.visible=i.length>0,e.sort(this.RuleSort),i.sort(this.RuleSortByItem),this.listCoin.dataProvider=new eui.ArrayCollection(e),s=n.concat(e,o,i),this.listItem.dataProvider=new eui.ArrayCollection(s)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateCloseBtnLabel,this),this.removeEventTouchTap(this.closeBtn,this.onTap),MapControl.copyId>0&&copyControl.isQuite&&copyControl.upExitFb(),this.closeFunc&&(this.closeFunc(),this.closeFunc=null)},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&UIMgr.ins().close(this),this.closeBtn.label=this.closeBtn.name+"("+this.countdown+"s)"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.updateDefeatList=function(){var t=[];for(var e in DataCenter.ins().DeathGuideConfig){var i=DataCenter.ins().DeathGuideConfig[e];if(reincarnateControl.lv<=i.zslv||ActorControl.level<=i.lv){for(var n in i.gainWay){if(14==i.gainWay[n][0]){var o=payControl.getRechargeData(0);if(o.num&&1==o.num&&vipControl.lv>=Object.keys(DataCenter.ins().VipConfig).length)continue}else if(16==i.gainWay[n][0]){var s=DieGuide.ins().getOpenRoles();if(s){var r=DataCenter.ins().DeathgainWayConfig[i.gainWay[n][0]];r.itemId=s,t.push(i.gainWay[n][0])}continue}t.push(i.gainWay[n][0])}break}}this.list0.dataProvider=this.listData0,this.listData0.source=t},e.prototype.RuleSort=function(t,e){return t.id<e.id?-1:1},e.prototype.RuleSortByItem=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],n=DataCenter.ins().ItemConfig[e.id],o=ItemUtils.getQuality(i),s=ItemUtils.getQuality(n);return o>s?-1:s>o?1:0},e}(BaseEuiView);__reflect(PersonalResultView.prototype,"PersonalResultView");var ResultView=function(t){function e(){var e=t.call(this)||this;return e.winResult=0,e.repeatTimes=5,e.isBossResult=!1,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ResultViewSkin",this.listCoin.itemRenderer=ResultCoinItemRenderer,this.listItem.itemRenderer=ItemBase,this.listEmblem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.list0.itemRenderer=ResultFailItemRenderer,this.winnerEff=new GameMovieClip,this.winnerEff.x=41,this.winnerEff.y=41,this.winnerEff.touchEnabled=!1},e.prototype.showRune=function(t){if(9==MapControl.copyType){if(!t)return void(this.nune.visible=!1);var e=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel-1];if(!e||!e.showIcon)return void(this.nune.visible=!1);var i=DataCenter.ins().ItemConfig[e.showIcon],n=ItemUtils.getQuality(i);if(n==CopyBabelPanel.RunType)return void(this.nune.visible=!1);this.nune.visible=!0,this.scrollerGroup.y+=3*this.nune.height/2;var o="";e.equipPos?(this.nuneLock.visible=!0,o=LangMgr.getValueByKey("tongOpenZW"),this.oldValue.text=(e.equipPos-1).toString(),this.newValue.text=e.equipPos.toString()):(this.nuneLock.visible=!1,o=LangMgr.getValueByKey("tongOpenType"),this.nuneValue.text=e.describe),this.nameLabel.text=o,this.nuneValue.visible=!this.nuneLock.visible}},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e),this._fbType=MapControl.copyType,this.doublePrice.visible=!1;var n=e[0];this.winResult=n,this.bg.source=n?"resultWin_png":"resultLost_png",this.closeBtn.name=n?LangMgr.getValueByKey("tongGetGift"):LangMgr.getValueByKey("tongExit"),this.title.source=n?"win_02":"lost_02",DieGuide.ins().dispatchdieGuide(n),this.showRune(n);var o=16==MapControl.copyType?15:5;(10==MapControl.copyType||7==MapControl.copyType||18==MapControl.copyType||1==MapControl.copyType)&&(o=10),this.countdown=this.repeatTimes=o,this.updateCloseBtnLabel(),toseongControl.isToseong||TimerMgr.ins().doTimer(1e3,this.repeatTimes,this.updateCloseBtnLabel,this);var s=e[1];if(e[2]&&(this.txt.text=e[2]),copyControl.isQuite=!0,e[3]instanceof Function?this.closeFunc=e[3]:0==e[3]&&(copyControl.isQuite=e[3]),toseongControl.isToseong&&(copyControl.isQuite=!1),e[4]){var r=e[4][0];r&&(this.winnerEff.parent||this.effGroup.addChild(this.winnerEff),this.winnerEff.playFile(PATH_EFF+"yanhuaeff",1));var a=e[4][1]||"",l=a.split("\n");a=l[1]?l[1]:l[0],a=StringUtils.replaceStr(a,LangMgr.getValueByKey("color39"),ColorUtils.GREEN+""),this.belongTxt.textFlow=TextUtils.generateTextFlow1(a),this.labelItem.text=r?LangMgr.getValueByKey("tongSelfAwards"):LangMgr.getValueByKey("tongJoinAwards"),this.isBossResult=!0,this.roleIcon.icon=e[4][2],this.roleIcon.jobImg.visible=!1,this.txt.text=""}else this.belongTxt.text="";if(this.txt.visible=0!=n,this.defeat.visible=0==n,this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.rewardBtn,this.onTap),this.addEventTouchTap(this.openRole,this.onTap),this.addEventTouchTap(this.openRole1,this.onTap),this.openRole.visible=!1,this.defeat.y=210,this.closeBtn.x=90,0==n&&(0!=MapControl.copyId&&(this.defeat.y=110),this.updateDefeatList()),0!=MapControl.copyId&&1==n)if(16==MapControl.copyType)this.closeBtn.label=LangMgr.getValueByKey("tongGetGift");else if(9==MapControl.copyType){var h=DataCenter.ins().BabelLotteryConfig[copyBabelControl.curLevel];h&&reincarnateControl.lv>=h.zsLevelLimit&&ActorControl.level>=h.levelLimit&&0==copyBabelControl.lotteryRemainTimes?(this.rewardBtn.visible=!0,this.closeBtn.x=0,1==h.layer?(this.rewardBtn.label=LangMgr.getValueByKey("tongContinuFight"),this.rewardBtn.width=130):(this.rewardBtn.label=LangMgr.getValueByKey("tongFightLevel",h.layer),this.rewardBtn.width=140)):(this.rewardBtn.visible=!1,this.closeBtn.x=90)}else if(38==MapControl.copyType){this.closeBtn.name=LangMgr.getValueByKey("tongExit"),this.closeBtn.label=this.closeBtn.name+"("+this.countdown+"s)";var u=soulBoneControl.dunPassID,p=u>=Object.keys(DataCenter.ins().SoulBoneCopyConfig).length;p?(this.rewardBtn.visible=!1,this.closeBtn.x=90):(this.rewardBtn.visible=!0,this.closeBtn.x=0,this.rewardBtn.label=LangMgr.getValueByKey("tongFightLevel",u+1))}else this.rewardBtn.visible=!1;else this.rewardBtn.visible=!1;s?this.setRewardList(s):this.setRewardList()},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);var i=[],n=[],o=[];if(this.isBossResult){this.winnerGroup.visible=!0,this.scrollerGroup.y+=60,this.scrollerGroup.height=267,this.labelEmblem.height=0,this.labelItem.height=20,this.labelEmblem.visible=!1,this.labelItem.visible=!0;for(var s=[],r=[],a=0;a<t.length;a++){var l=DataCenter.ins().ItemConfig[t[a].id];if(1!=ItemUtils.getType(l))0==t[a].type?4==t[a].id?s.push(t[a]):i.push(t[a]):o.push(t[a]);else if(-1!=e.filterFb.indexOf(MapControl.copyType))n.push(t[a]);else if(n.length){for(var h=!1,u=0;u<n.length;u++)if(n[u].id==t[a].id){n[u].count+=t[a].count,h=!0;break}h||n.push(t[a])}else n.push(t[a])}o.sort(this.RuleSortByItem),r=s.concat(i,n,o),this.listItem.dataProvider=new eui.ArrayCollection(r)}else{for(var s=[],p=[],r=[],a=0;a<t.length;a++){var l=DataCenter.ins().ItemConfig[t[a].id];if(1!=ItemUtils.getType(l))if(0==t[a].type)i.push(t[a]);else{var c=DataCenter.ins().ItemConfig[t[a].id],d=ItemUtils.getType(c);6==d?o.push(t[a]):o.push(t[a])}else if(-1!=e.filterFb.indexOf(MapControl.copyType))p.push(t[a]);else if(p.length){for(var h=!1,u=0;u<p.length;u++)if(p[u].id==t[a].id){p[u].count+=t[a].count,h=!0;break}h||p.push(t[a])}else p.push(t[a])}this.winnerGroup.visible=!1,this.scrollerGroup.height=324,this.labelItem.text=LangMgr.getValueByKey("tongGetProp"),this.labelEmblem.height=n.length>0?20:0,this.labelItem.height=o.length>0?20:0,this.labelEmblem.visible=n.length>0,this.labelItem.visible=o.length>0,i.sort(this.RuleSort),o.sort(this.RuleSortByItem),this.listCoin.dataProvider=new eui.ArrayCollection(i),this.listEmblem.dataProvider=new eui.ArrayCollection(n),r=s.concat(i,p,o),this.listItem.dataProvider=new eui.ArrayCollection(r)
}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.updateCloseBtnLabel,this);for(var i=1;6>i;i++)this.removeEventTouchTap(this["img"+i],this.onTap);this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.openRole,this.onTap),this.removeEventTouchTap(this.openRole1,this.onTap),MapControl.copyId>0&&copyControl.isQuite&&copyControl.upExitFb(),2==this._fbType?UIMgr.ins().open(CopyView,0):15==this._fbType?UIMgr.ins().open(UnionBossView):17==this._fbType&&UIMgr.ins().open(BossView,5),this.closeFunc&&(this.closeFunc(),this.closeFunc=null),this.bossmc&&(DisplayUtils.removeFromParent(this.bossmc),this.bossmc=null),copyBabelControl.lotteryRemainTimes>0&&9==MapControl.copyType&&UIMgr.ins().open(CopyBabelLotteryView)},e.prototype.updateCloseBtnLabel=function(){this.countdown--,this.countdown<=0&&UIMgr.ins().close(this),toseongControl.isToseong?this.closeBtn.label=""+this.closeBtn.name:this.closeBtn.label=this.closeBtn.name+"("+this.countdown+"s)"},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.rewardBtn:if(38==MapControl.copyType){if(!soulBoneControl.dunLeftTimes)return void tipsControl.showTips(LangMgr.getValueByKey("tongTimeEnought"));reincarnateControl.lv<DataCenter.ins().SoulBoneCopyConfig[soulBoneControl.dunPassID+1].zsLevelLimit?tipsControl.showTips(LangMgr.getValueByKey("tongRotationEnought")):(soulBoneControl.upEnterDun(),copyControl.isQuite=!1)}else challengeCopyControl.upChallenge(),copyControl.isQuite=!1;UIMgr.ins().close(this);break;case this.openRole:case this.openRole1:UIMgr.ins().close(this),UIMgr.ins().open(RecruitView)}},e.prototype.updateDefeatList=function(){var t=[];for(var e in DataCenter.ins().DeathGuideConfig){var i=DataCenter.ins().DeathGuideConfig[e];if(reincarnateControl.lv<=i.zslv||ActorControl.level<=i.lv){for(var n in i.gainWay)if(16!=i.gainWay[n][0])t.push(i.gainWay[n][0]);else{var o=DieGuide.ins().getOpenRoles();if(o){var s=DataCenter.ins().DeathgainWayConfig[i.gainWay[n][0]];s.itemId=o,t.push(i.gainWay[n][0])}}break}}this.listData0.source=t,this.list0.dataProvider=this.listData0},e.prototype.RuleSort=function(t,e){return t.id<e.id?-1:1},e.prototype.RuleSortByItem=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],n=DataCenter.ins().ItemConfig[e.id],o=ItemUtils.getQuality(i),s=ItemUtils.getQuality(n);return o>s?-1:s>o?1:0},e.filterFb=[2],e}(BaseEuiView);__reflect(ResultView.prototype,"ResultView");var TeamResultView=function(t){function e(){var e=t.call(this)||this;return e._result=0,e.skinName="TeamResultViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.listItem.itemRenderer=ItemBase,this.listChallenger.itemRenderer=ChallengerHeadItemRender,this.listAssistant.itemRenderer=AssistantHeadItemRender,this.list0.itemRenderer=ResultFailItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._configID=t[0],this._result=t[1],this._list=t[2],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){this.listItem.dataProvider=new ArrayCollection(DataCenter.ins().AsTeamCopyConfig[this._configID].rewardShow),this.title.source=this._result?"win_02":"lost_02",this.bg.source=this._result?"resultWin_png":"resultLost_png",this.win.visible=this._result>0,this.defeat.visible=0==this._result,this._hasCaptain=!1;for(var t,e,i,n=[],o=0;o<this._list.length;o++)2==this._list[o].position?(t=this._list.splice(o,1)[0],n.push(t),t.roleID==ActorControl.actorID&&(e=!0),o--):1==this._list[o].position&&(this._list[o].roleID==ActorControl.actorID&&(i=!0),this._hasCaptain=!0);this.assResultTxt.visible=e,0==this._result&&this.updateDefeatList(),this.listChallenger.dataProvider=new ArrayCollection(this._list);for(var s=n.length,r=[],o=0;s>o;o++)r.push({vo:n[o],id:this._configID});this.listAssistant.dataProvider=new ArrayCollection(r),this.closeBtn.visible=i&&1==this._result,0==this._result||this._configID>=Object.keys(DataCenter.ins().AsTeamCopyConfig).length?(this.closeBtn.horizontalCenter=0,this.challengeBtn.visible=!1):(this.closeBtn.horizontalCenter=-80,this.challengeBtn.visible=this.closeBtn.visible),this._exitTime=5,TimerMgr.ins().doTimer(1e3,0,this.repeate,this),this.repeate()},e.prototype.updateDefeatList=function(){var t=[];for(var e in DataCenter.ins().DeathGuideConfig){var i=DataCenter.ins().DeathGuideConfig[e];if(reincarnateControl.lv<=i.zslv||ActorControl.level<=i.lv){for(var n in i.gainWay)if(16!=i.gainWay[n][0])t.push(i.gainWay[n][0]);else{var o=DieGuide.ins().getOpenRoles();if(o){var s=DataCenter.ins().DeathgainWayConfig[i.gainWay[n][0]];s.itemId=o,t.push(i.gainWay[n][0])}}break}}this.list0.dataProvider=new ArrayCollection(t)},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:this.exitFb();break;case this.challengeBtn:this.exitFb(1);break;case this.openRole:case this.openRole1:UIMgr.ins().close(this),UIMgr.ins().open(RecruitView)}},e.prototype.repeate=function(){return this.closeBtn.label=LangMgr.getValueByKey("babelExit",this._exitTime),this.assResultTxt.text=LangMgr.getValueByKey("babelWait",this._exitTime),this._exitTime<=0?(TimerMgr.ins().removeAll(this),void this.exitFb()):void this._exitTime--},e.prototype.exitFb=function(t){void 0===t&&(t=0),0==this._result||this._configID>=Object.keys(DataCenter.ins().AsTeamCopyConfig).length?copyControl.upExitFb():this._hasCaptain?copyControl.upExitTFFb(t):copyControl.upExitFb(),UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TeamResultView.prototype,"TeamResultView");var ToseongBossResultView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ToseongBossResultViewSkin",this.listItem.itemRenderer=ItemBase,this.listData0=new eui.ArrayCollection,this.winnerEff=new GameMovieClip,this.winnerEff.x=41,this.winnerEff.y=41,this.winnerEff.touchEnabled=!1},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];if(t.prototype.open.call(this,e),this.addEventTouchTap(this.closeBtn,this.onTap),this.bg.source="resultWin_png",this.closeBtn.label=LangMgr.getValueByKey("tongGetGift"),this.title.source="win_02",e[1]){var n=e[1][0];n&&(this.winnerEff.parent||this.effGroup.addChild(this.winnerEff),this.winnerEff.playFile(PATH_EFF+"yanhuaeff",1));var o=e[1][1]||"",s=o.split("\n");o=s[1]?s[1]:s[0],o=StringUtils.replaceStr(o,LangMgr.getValueByKey("color39"),ColorUtils.GREEN+""),this.belongTxt.textFlow=TextUtils.generateTextFlow1(o),this.labelItem.text=n?LangMgr.getValueByKey("tongSelfAwards"):LangMgr.getValueByKey("tongJoinAwards"),this.roleIcon.icon=e[1][2],this.roleIcon.jobImg.visible=!1}var r=e[0];r&&this.setRewardList(r)},e.prototype.setRewardList=function(t){void 0===t&&(t=[]);for(var e=[],i=[],n=[],o=[],s=[],r=0;r<t.length;r++){var a=DataCenter.ins().ItemConfig[t[r].id];if(1!=ItemUtils.getType(a))0==t[r].type?4==t[r].id?o.push(t[r]):e.push(t[r]):n.push(t[r]);else if(i.length){for(var l=!1,h=0;h<i.length;h++)if(i[h].id==t[r].id){i[h].count+=t[r].count,l=!0;break}l||i.push(t[r])}else i.push(t[r])}n.sort(this.RuleSortByItem),s=o.concat(e,i,n),this.listItem.dataProvider=new eui.ArrayCollection(s)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.RuleSortByItem=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],n=DataCenter.ins().ItemConfig[e.id],o=ItemUtils.getQuality(i),s=ItemUtils.getQuality(n);return o>s?-1:s>o?1:0},e}(BaseEuiView);__reflect(ToseongBossResultView.prototype,"ToseongBossResultView");var WorldBossResultView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WorldBossResultViewSkin",this.winnerEff=new GameMovieClip,this.winnerEff.x=41,this.winnerEff.y=41,this.winnerEff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.init()},e.prototype.init=function(){this.winnerEff.parent||this.effGroup.addChild(this.winnerEff),this.winnerEff.playFile(PATH_EFF+"yanhuaeff",1),this.countdown=20;var t=bossControl.newWorldBossData;this.myrank.text=t.rank?t.rank+"":LangMgr.getValueByKey("newNoRank"),this.rankList.itemRenderer=WorldBossResultItemRenderer;var e=t.rankList.concat();e.length>3?e.length=3:null;for(var i=0;i<e.length;i++)e[i].rank=i+1;this.rankList.dataProvider=new eui.ArrayCollection(e),this.time.text=DateUtils.getFormatBySecond(t.totalTime,DateUtils.TIME_FORMAT_10),this.weidao.text=t.lastKillRoleName,t.randomRoleName&&t.randomAwards&&t.randomAwards.length?(this.lucky.visible=!0,this.luckyName.text=t.randomRoleName,this.luckyGift.text=DataCenter.ins().ItemConfig[t.randomAwards[0].id].name):this.lucky.visible=!1,this.updateBtn(),TimerMgr.ins().doTimer(1e3,this.countdown,this.updateCloseBtnLabel,this),copyControl.isQuite=!0},e.prototype.onTap=function(t){UIMgr.ins().close(this),copyControl.upExitFb()},e.prototype.updateCloseBtnLabel=function(){this.countdown>0&&this.countdown--,this.countdown<=0&&(UIMgr.ins().close(this),copyControl.upExitFb()),this.updateBtn()},e.prototype.updateBtn=function(){this.closeBtn.label=LangMgr.getValueByKey("newOut",this.countdown)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),TimerMgr.ins().removeAll(this)},e}(BaseEuiView);__reflect(WorldBossResultView.prototype,"WorldBossResultView");var ResultCoinItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ResultCoinItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.labelInfo.size=20,this.labelInfo.text=LangMgr.getValueByKey("resultGet",Currency.getCurrencyName(t.id)),this.imgCoin.source=Currency.getCurrencyRes(t.id),this.labelCount.text=""+t.count,this.labelInfo.x=0,this.imgCoin.x=this.labelInfo.x+this.labelInfo.textWidth,this.labelCount.x=this.imgCoin.x+this.imgCoin.width},e}(BaseItemRender);__reflect(ResultCoinItemRenderer.prototype,"ResultCoinItemRenderer");var ResultFailItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ResultFailItemRendererSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEventTouchEnd(this,this.onClick);var t="|U&S:"+this.jump.size+"&C:"+this.jump.textColor+"&T:"+this.jump.text+"|";this.jump.textFlow=TextUtils.generateTextFlow1(t)},e.prototype.onClick=function(t){switch(t.target){case this.openRole0:case this.jump:this.showDetail()}},e.prototype.showDetail=function(){this.cfg&&(UIMgr.ins().isShow(MaterialResultView)?UIMgr.ins().close(MaterialResultView):UIMgr.ins().isShow(ClimbTowerResultView)?UIMgr.ins().close(ClimbTowerResultView):UIMgr.ins().isShow(ToseongBossResultView)?UIMgr.ins().close(ToseongBossResultView):UIMgr.ins().isShow(WorldBossResultView)?UIMgr.ins().close(WorldBossResultView):UIMgr.ins().isShow(BossResultView)?UIMgr.ins().close(BossResultView):UIMgr.ins().isShow(PersonalResultView)?UIMgr.ins().close(PersonalResultView):UIMgr.ins().isShow(SealPveResultView)?UIMgr.ins().close(SealPveResultView):UIMgr.ins().close(ResultView),"VipView"==this.cfg.gainWay[1]?UIMgr.ins().open(this.cfg.gainWay[1],vipControl.lv+1):UIMgr.ins().open(this.cfg.gainWay[1],this.cfg.gainWay[2]))},e.prototype.dataChanged=function(){if(!isNaN(this.data)){this.cfg=null;var t=void 0;for(var e in DataCenter.ins().DeathgainWayConfig)if(t=DataCenter.ins().DeathgainWayConfig[e],t.level==this.data){this.cfg=t;break}if(this.cfg){if(14==this.cfg.level){var i=payControl.getRechargeData(0);i.num&&1==i.num&&(this.cfg=DataCenter.ins().DeathgainWayConfig[20])}this.icon.source=this.cfg.itemId,this.iconName.text=this.cfg.gainWay[0];this.desc.visible=!1,this.up.visible=this.desc.visible}16==this.data&&(this.mc||(this.mc=new GameMovieClip),this.mc.parent||(this.jump.parent.addChild(this.mc),this.mc.playFile(PATH_EFF+"chargeff1",-1),this.mc.touchEnabled=!1),this.mc.x=this.jump.x+18,this.mc.y=this.jump.y+9,this.mc.scaleX=this.mc.scaleY=.4,this.icon.scaleX=this.icon.scaleY=.55)}},e}(BaseItemRender);__reflect(ResultFailItemRenderer.prototype,"ResultFailItemRenderer");var WorldBossResultItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.nameTxt.text=t.roleName,this.valueTxt.text=""+Math.floor(t.value),this.paihang.source="paihangs"+t.rank},e}(BaseItemRender);__reflect(WorldBossResultItemRenderer.prototype,"WorldBossResultItemRenderer");var EquipControl=function(t){function e(){var e=t.call(this)||this;return e.ybTimers=0,e.isFind=!1,e.addCustomEvent(267,e.delayCheckHaveCan),e.addCustomEvent(266,e.delayCheckHaveCan),e.addCustomEvent(268,e.delayCheckHaveCan),e.addCustomEvent(271,e.delayCheckHaveCan),e.addCustomEvent(461,e.delayCheckHaveCan),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upUpgradeZhiZunEquip=function(t,e){return[t,e]},e.prototype.downZhiZunUpgrade=function(t,e,i){var n=heroControl.getSubRoleByIndex(t).getEquipByIndex(e);n.soulLv=i,EventMgr.ins().dispatch(122)},e.prototype.downYbShowTimer=function(t){this.ybTimers=DateUtils.formatMiniDateTime(t),EventMgr.ins().dispatch(123)},e.prototype.getYbOverTime=function(){return this.ybTimers?this.ybTimers-GameServer.serverTime>0:!1},e.prototype.upWearEquipment=function(t,e,i){return[t,i,e]},e.prototype.downUpDataEquip=function(t,e,i,n,o,s,r){var a=new ItemData;a.init([i,n,o,s,r]);var l=heroControl.getSubRoleByIndex(t),h=l.getEquipByIndex(e);if(h.item=a,this.dispatchEquipChange(),0==e||2==e){var u=UnitMgr.ins().getEntityByHandle(l.handle);u&&u.updateModel()}},e.prototype.dispatchEquipChange=function(){EventMgr.ins().dispatch(116)},e.prototype.upSmeltEquip=function(t,e){for(var i=[],n=0;n<e.length;n++)null!=e[n]&&i.push(e[n].handle);return i.length<=0?!1:[t,i]},e.prototype.downSmeltEquipComplete=function(t,e,i){if(0==t)return void tipsControl.showTips(LangMgr.getValueByKey("roleTips9"));for(var n=[],o=0;o<i.length;o++){var s={};s.itemId=i[o][0],s.count=i[o][1],n.push(s)}EventMgr.ins().dispatch(117,n)},e.contrastEquip=function(t,e){if(!t||0==t.handle)return e;if(!e||0==e.handle)return t;var i=t.point,n=e.point;return n>i?e:t},e.prototype.dispatchEquipCheckList=function(t){EventMgr.ins().dispatch(585,t)},e.prototype.getEquipsByJobNPos=function(t,e){for(var i=heroControl.subRolesLen,n=0;i>n;n++){var o=heroControl.getSubRoleByIndex(n);if(o.job==t)return o.getEquipByIndex(e)}return null},e.prototype.getEquipConfigIDByPosAndQuality=function(t,e,i){void 0===i&&(i=1);for(var n=reincarnateControl.lv||0,o=ActorControl.level,s=1e5+1+1e4*t+100*e+1e3*i,r=2;99>r;r++){var a=1e5+r+1e4*t+100*e+1e3*i,l=DataCenter.ins().ItemConfig[a];if(void 0==l)break;var h=l.zsLevel?l.zsLevel:0,u=l.level?l.level:1;if(!(n>=h&&o>=u))break;s=a}return s},e.prototype.getEquipConfigIDByPosAndQualityByLegend=function(t,e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=!1);for(var s=reincarnateControl.lv||0,r=ActorControl.level,a=1e5+1e4*e+1e3*n+100*i+1,l=heroControl.getSubRoleByIndex(t),h=l.getEquipByIndex(e),u=1;99>u;u++){var p=1e5+1e4*e+1e3*n+100*i+u,c=DataCenter.ins().ItemConfig[p];if(void 0==c)break;var d=c.zsLevel?c.zsLevel:0,g=c.level?c.level:1;if(!(s>=d&&r>=g))break;if(h&&h.item.configID){var m=ItemUtils.pointCalNumber(DataCenter.ins().ItemConfig[p]);if(h.item.point<m){a=p;break}o&&h.item.point==m&&(a=p)}else a=p}return a},e.prototype.getEquipConfigIDByPosAndQualityByGod=function(t,e,i,n,o){void 0===n&&(n=1),void 0===o&&(o=!1);for(var s=reincarnateControl.lv||0,r=ActorControl.level,a=1e5+1e4*e+1e3*n+100*i+1,l=t.getEquipByIndex(e),h=2;99>h;h++){var u=1e5+1e4*e+1e3*n+100*i+h,p=DataCenter.ins().ItemConfig[u];if(void 0==p)break;var c=p.zsLevel?p.zsLevel:0,d=p.level?p.level:1;if(!(s>=c&&r>=d))break;if(l&&l.item.configID){var g=ItemUtils.pointCalNumber(DataCenter.ins().ItemConfig[u]);if(l.item.point<g){a=u;break}o&&l.item.point==g&&(a=u)}else a=u}return a},e.prototype.checkEquipsIsWear=function(t){for(var e=heroControl.subRolesLen,i=0;e>i;i++){var n=heroControl.getSubRoleByIndex(i);if(n.job==ItemUtils.getJob(t.itemConfig)||0==ItemUtils.getJob(t.itemConfig))for(var o=n.getEquipLen(),s=0;o>s;s++)if(t.handle==n.getEquipByIndex(s).item.handle)return!0}return!1},e.prototype.downGrewupEquipResult1=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.grewupEquipResult(t)},e.prototype.downGrewupEquipResult2=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.grewupEquipResult(t)},e.prototype.grewupEquipResult=function(t){var e=t[0],i=t[1],n=t[2];4==ItemUtils.getQuality(DataCenter.ins().ItemConfig[n])?this.dispatchMixEquip(e,i,n):this.dispatchMixGodEquip(e,i,n)},e.prototype.dispatchMixEquip=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().dispatch(118,t)},e.prototype.dispatchMixGodEquip=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().dispatch(119,t)},e.prototype.upGrewupEquip=function(t,e){return[t,e]},e.prototype.upMixEquip=function(t,e,i){return[t,e,i]},e.prototype.delayCheckHaveCan=function(){TimerMgr.ins().isExists(this.dispatchCheckHaveCan,this)||TimerMgr.ins().doTimer(60,1,this.dispatchCheckHaveCan,this)},e.prototype.dispatchCheckHaveCan=function(){for(var t=heroControl.subRolesLen,e=0;t>e&&(this.isFind=this.checkRedPoint(4,e),!this.isFind);e++);if(!this.isFind)for(var i=0;t>i;i++)for(var e=0;8>e;e++)if(this.isFind=this.setOrangeEquipItemState(e,heroControl.getSubRoleByIndex(i)),this.isFind)return 1;if(!this.isFind){for(var e=0;t>e&&(this.isFind=this.checkRedPoint(5,e),!this.isFind);e++);if(!this.isFind)for(var i=0;t>i;i++)for(var e=0;2>e;e++)if(this.isFind=this.setLegendEquipItemUpState(e>0?2:0,heroControl.getSubRoleByIndex(i)),this.isFind=this.setLegendEquipItemState(e>0?2:0,heroControl.getSubRoleByIndex(i))||this.isFind,this.isFind)return 1}return this.isFind||(this.isFind=Boolean(backpackControl.getHuntGoods(0).length)),this.isFind?1:0},e.prototype.checkRedPointEx=function(t,e){for(var i=backpackControl.getBagEquipsByQuality(t),n=i.length,o=0;n>o;o++){var s=void 0,r=void 0;if(!isNaN(e)&&(s=ItemUtils.getJob(i[o].itemConfig),r=heroControl.getSubRoleByIndex(e),r.job!=s))return!1;if(!r)return!1;var a=this.getEquipConfigIDByPosAndQualityByGod(r,ItemUtils.getSubType(i[o].itemConfig),ItemUtils.getQuality(i[o].itemConfig)),l=DataCenter.ins().ItemConfig[a];if(l){var h=i[o].itemConfig.zsLevel?i[o].itemConfig.zsLevel:0,u=i[o].itemConfig.level?i[o].itemConfig.level:0,p=l.zsLevel?l.zsLevel:0,c=l.level?l.level:0,d=1e4*h+u,g=1e4*p+c;if(g>d){if(4!=t)return!0;var m=backpackControl.getBagGoodsCountById(0,a),f=DataCenter.ins().DeityEquipComposeConfig[a],v=f?f.count:0;if(m>=v)return!0}}}return!1},e.prototype.checkRedPointExOrg=function(t,e){var i=backpackControl.getBagEquipsByQuality(t),n=i.length;if(n)this.checkRedPoint(t,e);else if(isNaN(e)){if(this.IsEnoughChip(e))return!0}else for(var o=0;o<heroControl.subRolesLen;o++)if(this.IsEnoughChip(o))return!0;return!1},e.prototype.IsEnoughChip=function(t){for(var e=[0,2],i=heroControl.getSubRoleByIndex(t),n=0;n<e.length;n++){var o=this.getMixConfig(i.index,e[n]);if(o){var s=o.count,r=o.itemId,a=backpackControl.getBagGoodsCountById(0,r);if(a>=s)return!0}}return!1},e.prototype.getMixConfig=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=this.getEquipConfigIDByPosAndQualityByLegend(i.index,e,5),o=DataCenter.ins().DeityEquipComposeConfig[n];return o},e.prototype.checkRedPoint=function(t,e){for(var i=backpackControl.getBagEquipsByQuality(t),n=i.length,o=0;n>o;o++){var s=void 0,r=void 0;if(!isNaN(e)&&(s=ItemUtils.getJob(i[o].itemConfig),r=heroControl.getSubRoleByIndex(e),r.job!=s))return!1;if(!r)return!1;var a=this.getEquipConfigIDByPosAndQualityByGod(r,ItemUtils.getSubType(i[o].itemConfig),ItemUtils.getQuality(i[o].itemConfig)),l=DataCenter.ins().ItemConfig[a];if(l){var h=i[o].itemConfig.zsLevel?i[o].itemConfig.zsLevel:0,u=i[o].itemConfig.level?i[o].itemConfig.level:0,p=l.zsLevel?l.zsLevel:0,c=l.level?l.level:0,d=1e4*h+u,g=1e4*p+c;if(g>d)return!0}}return!1},e.prototype.setOrangeEquipItemState=function(t,e){var i,n=e.getEquipByIndex(t);i=n.item.itemConfig&&ItemUtils.getQuality(n.item.itemConfig)<4?null:DataCenter.ins().ItemConfig[n.item.configID+1];var o=0,s=0;if(n.item.itemConfig&&4==ItemUtils.getQuality(n.item.itemConfig)&&n.item.itemConfig.zsLevel>=reincarnateControl.getMaxLv())return!1;if(n.item.itemConfig&&5==ItemUtils.getQuality(n.item.itemConfig))return!1;if(null!=i&&(i.level>ActorControl.level||i.zsLevel>reincarnateControl.lv))return!1;if(void 0!=i&&0!=n.item.handle&&4==ItemUtils.getQuality(n.item.itemConfig)&&1!=n.item.itemConfig.level&&-1==BackpackControl.fitleEquip.indexOf(n.item.configID)){var r=DataCenter.ins().DeityEquipLevelupConfig[n.item.configID];r&&(o=r.count,s=r.itemId)}else{var a=equipControl.getEquipConfigIDByPosAndQualityByGod(e,t,4,e.job),l=e.getEquipByIndex(t);if(l&&l.item.configID){var h=ItemUtils.pointCalNumber(DataCenter.ins().ItemConfig[a]);if(l.item.point>h)return!1}var u=DataCenter.ins().DeityEquipComposeConfig[a];u&&(o=u.count,s=u.itemId)}var p=backpackControl.getBagGoodsCountById(0,s);return p>=o},e.prototype.setLegendEquipItemState=function(t,e){var i=e.getEquipByIndex(t),n=null,o=ItemUtils.getQuality(i.item.itemConfig);if(i.item.itemConfig&&5==o){if(i.item.itemConfig.zsLevel>=10)return!1;n=DataCenter.ins().ItemConfig[i.item.configID+1]}else n=null;var s=0,r=0;if(null!=n&&n.zsLevel>reincarnateControl.lv)return!1;if(null!=n&&0!=i.item.handle&&5==o){var a=DataCenter.ins().DeityEquipLevelupConfig[i.item.configID];s=a.count,r=a.itemId}else{var l=this.getEquipConfigIDByPosAndQualityByLegend(e.index,t,5),h=DataCenter.ins().DeityEquipComposeConfig[l];if(!h)return!1;s=h.count,r=h.itemId}var u=backpackControl.getBagGoodsCountById(0,r);return reincarnateControl.lv>=3?u>=s:!1},e.prototype.setLegendEquipItemUpState=function(t,e){var i=e.getEquipByIndex(t),n=DataCenter.ins().ItemConfig[i.item.configID+1],o=ItemUtils.getQuality(i.item.itemConfig);if(void 0==n&&0!=i.item.handle&&5==o)return!1;if(void 0!=n&&0!=i.item.handle&&5==o){var s=e.getEquipByIndex(t).item.configID,r=DataCenter.ins().ItemConfig[s+1];if(r.level>ActorControl.level||r.zsLevel>reincarnateControl.lv)return!1;var a=DataCenter.ins().DeityEquipLevelupConfig[s],l=backpackControl.getBagGoodsCountById(0,a.itemId);return l>=a.count}return!1},e.prototype.getLegendEquipItemUpMax=function(t){for(var e=0;8>e;e++)if(0==e||2==e){var i=heroControl.getSubRoleByIndex(t).getEquipByIndex(e);if(!i)return!0;var n=DataCenter.ins().ItemConfig[i.item.configID+1],o=ItemUtils.getQuality(i.item.itemConfig);if(n||0==i.item.handle||5!=o)return!1}return!0},e.prototype.upAddSpirit=function(t,e,i){return[t,e,i]},e.prototype.downAddSpirit=function(t,e,i,n){var o=heroControl.getSubRoleByIndex(t).getEquipByIndex(e);o.spiritLv=i,o.spiritExp=n,EventMgr.ins().dispatch(120)},e.prototype.upAddSoul=function(t,e){return[t,e]},e.prototype.downAddSoul=function(t,e,i){var n=heroControl.getSubRoleByIndex(t).getEquipByIndex(e);n.soulLv=i,EventMgr.ins().dispatch(121)},e.prototype.getMinZhuLingLvByRole=function(t){for(var e=heroControl.getSubRoleByIndex(t),i=Number.MAX_VALUE,n=0;8>n;n++){var o=e.equipsData[n].zhuling;i>o&&(i=o)}return i==Number.MAX_VALUE?0:i},__decorate([up(8,[2,2])],e.prototype,"upUpgradeZhiZunEquip",null),__decorate([down(8,[2,2,2])],e.prototype,"downZhiZunUpgrade",null),__decorate([down(35,[6])],e.prototype,"downYbShowTimer",null),__decorate([up(1,[10,2,2])],e.prototype,"upWearEquipment",null),__decorate([down(1,[2,2].concat(ByteConst.ItemDatas))],e.prototype,"downUpDataEquip",null),__decorate([up(2,[3,[10]])],e.prototype,"upSmeltEquip",null),__decorate([down(2,[3,3,[3,3]])],e.prototype,"downSmeltEquipComplete",null),__decorate([down(3,[2,3,3])],e.prototype,"downGrewupEquipResult1",null),__decorate([down(4,[2,3,3])],e.prototype,"downGrewupEquipResult2",null),__decorate([up(3,[2,2])],e.prototype,"upGrewupEquip",null),__decorate([up(4,[2,3,3])],e.prototype,"upMixEquip",null),__decorate([up(5,[2,2,[10]])],e.prototype,"upAddSpirit",null),__decorate([down(5,[2,2,2,3])],e.prototype,"downAddSpirit",null),__decorate([up(7,[2,2])],e.prototype,"upAddSoul",null),__decorate([down(7,[2,2,2])],e.prototype,"downAddSoul",null),e=__decorate([protocolsId(4)],e)}(BaseSystem);__reflect(EquipControl.prototype,"EquipControl");var RoleControl=function(t){function e(){var e=t.call(this)||this;e.canChangeEquips=[],e.timeID=0;for(var i=0;i<GlobalModel.roleNum;i++)e.canChangeEquips.push([]);return e.addCustomEvent(267,e.startCheckHaveCan),e.addCustomEvent(266,e.startCheckHaveCan),e.addCustomEvent(268,e.startCheckHaveCan),e.addCustomEvent(461,e.startCheckHaveCan),e.addCustomEvent(352,e.startCheckHaveCan),e.addCustomEvent(116,e.startCheckHaveCan),e.addCustomEvent(576,e.startCheckHaveCan),e.addCustomEvent(653,e.startCheckHaveCan),e.addCustomEvent(210,e.startCheckHaveCan),e.addCustomEvent(206,e.startCheckHaveCan),e.addCustomEvent(456,e.delayShowNavBtnRedPoint),e.addCustomEvent(469,e.delayShowNavBtnRedPoint),e.addCustomEvent(468,e.delayShowNavBtnRedPoint),e.addCustomEvent(271,e.delayShowNavBtnRedPoint),e.addCustomEvent(373,e.delayShowNavBtnRedPoint),e.addCustomEvent(562,e.delayShowNavBtnRedPoint),e.addCustomEvent(147,e.delayShowNavBtnRedPoint),e.addCustomEvent(574,e.delayShowNavBtnRedPoint),e.addCustomEvent(148,e.delayShowNavBtnRedPoint),e.addCustomEvent(655,e.delayShowNavBtnRedPoint),e.addCustomEvent(612,e.delayShowNavBtnRedPoint),e.addCustomEvent(613,e.delayShowNavBtnRedPoint),e.addCustomEvent(614,e.delayShowNavBtnRedPoint),e.addCustomEvent(651,e.delayShowNavBtnRedPoint),e.addCustomEvent(634,e.delayShowNavBtnRedPoint),e.addCustomEvent(617,e.delayShowNavBtnRedPoint),e.addCustomEvent(208,e.delayShowNavBtnRedPoint),e.addCustomEvent(718,e.delayShowNavBtnRedPoint),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.startCheckHaveCan=function(t,e){var i=this;void 0===t&&(t=!1),void 0===e&&(e=-1),this.timeID||(this.timeID=1,TimerMgr.ins().doTimer(50,1,function(){i.checkHaveCan(t,e)},this))},e.prototype.checkHaveCan=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=-1),this.timeID=0;var i=backpackControl.getBagEquipByType(0);if(i){for(var n=e>=0?e:0,o=e>=0?e+1:heroControl.subRolesLen,s=[],r=0;r<GlobalModel.roleNum;r++)s.push([]);for(var a=heroControl.subRolesLen,r=0;a>r;r++)for(var l=0,h=heroControl.getSubRoleByIndex(r).equipsData;l<h.length;l++){var u=h[l];s[r].push(u.item)}for(var p=0,c=i;p<c.length;p++)for(var d=c[p],g=n;o>g;g++){var m=ItemUtils.getJob(d.itemConfig);if((0==m||heroControl.getSubRoleByIndex(g).job==m)&&!(reincarnateControl.lv<d.itemConfig.zsLevel||ActorControl.level<d.itemConfig.level)){var f=backpackControl.getLowEquipIndex(s[g],ItemUtils.getSubType(d.itemConfig));f>=0&&(s[g][f]=this.contrastEquip(s[g][f]||heroControl.getSubRoleByIndex(g).equipsData[f].item,d))}}for(var v=s.length,r=0;v>r;r++){for(var g=0;g<s[r].length;g++)this.canChangeEquips[r][g]=!1,s[r][g]&&s[r][g].handle!=heroControl.getSubRoleByIndex(r).equipsData[g].item.handle&&(t&&e==r?(equipControl.upWearEquipment(s[r][g].handle,g,e),this.canChangeEquips[r][g]=!1):this.canChangeEquips[r][g]=!0);this.canChangeEquips[r].indexOf(!0)<0&&(this.canChangeEquips[r].length=0)}this.showNavBtnRedPoint()}},e.prototype.contrastEquip=function(t,e){if(!t||0==t.handle)return e;if(!e||0==e.handle)return t;var i=t.point,n=e.point;return n>i?e:t},e.prototype.getCanChangeEquips=function(){for(var t=0;t<this.canChangeEquips.length;t++)for(var e=0;e<this.canChangeEquips[t].length;e++)if(this.canChangeEquips[t][e])return!0;return!1},e.prototype.delayShowNavBtnRedPoint=function(){TimerMgr.ins().isExists(this.showNavBtnRedPoint,this)||TimerMgr.ins().doTimer(60,1,this.showNavBtnRedPoint,this)},e.prototype.showNavBtnRedPoint=function(t){void 0===t&&(t=!1);for(var e=0;e<this.canChangeEquips.length;e++){for(var i=0;i<this.canChangeEquips[e].length;i++)if(this.canChangeEquips[e][i]){t=!0;break}if(t)break}if(!t&&reincarnationControl.isCanAddSpirit()&&(t=!0),t||(t=SwitchMgr.ins().checkOpen(1016)?thunderControl.getRedPoint():SwitchMgr.ins().checkOpen(9)&&(superRingControl.checkHaveUpRing()||superRingControl.isCanStudySkill()||superRingControl.isCanUpgradeSkill()||superRingControl.fireRingRedPoint()||flameMarkControl.checkRed())),!t&&skillControl.canHejiEquip()&&(t=!0),!t&&skillControl.canExchange()&&(t=!0),!t&&skillControl.canSolve()&&(t=!0),!t&&dragonSoulControl.canShowRedPointInAll()&&(t=!0),!t&&reincarnateControl.canOpenZSWin()&&!reincarnateControl.isMaxLv()&&(reincarnateControl.canGet()>0||reincarnateControl.canUpgrade())&&(t=!0),(!t&&CommonFun.andState(featherControl.canGradeupWing())||CommonFun.andState(featherControl.canItemGradeupWing())||featherControl.isHaveActivationWing())&&(t=!0),!t&&fashionControl.redPoint()&&(t=!0),!t&&RuneRedPoint.ins().checkAllSituation(!1)&&(t=!0),!t){for(var n=heroControl.subRolesLen,o=0;n>o;o++){for(var s=heroControl.getSubRoleByIndex(o),e=0;8>e;e++){this["equip"+e];if(t=equipControl.setOrangeEquipItemState(e,s),!t&&2>e&&(t=equipControl.setLegendEquipItemState(e>0?2:0,s)),t){var r=backpackControl.checkEqRedPoint(e,s);t=null!=r?r:t}if(t)break}if(t)break}t||(t=MythEquipRedPoint.ins().redPoint),t||(t=backpackControl.getLegendHasResolve()),t||(t=darkEquipControl.checkSysOpen()?darkEquipControl.getRedPoint():Boolean(backpackControl.getHuntGoods(0).length)),t||(t=thunderControl.getRedPoint())}t||(t=heroControl.isLockRole()),t||(t=FeatherDeityRedPoint.ins().getGodWingRedPoint()),t||(t=reincarnationControl.isCanUpgrade()||reincarnationControl.isCanExchange()||reincarnationControl.isCanUpgradeSoul()),t||(t=experienceJadeNewControl.checkRed()),t||(t=featherControl.canUseFlyUp()),t||(t=featherControl.canUseAptitude()),t||(t=HeirloomRedPoint.ins().redPoint),t||(t=CrazybtplayRedPoint.ins().redPoint),t||(t=DominateEquipRedPoint.ins().redPoint),t||(t=OfficeRedPoint.ins().redPoint),t||(t=TotemRedPoint.ins().redPoint),t||(t=DevourEquipRedPoint.ins().redPoint),this.dispatchRoleHint(t)},e.prototype.dispatchRoleHint=function(t){EventMgr.ins().dispatch(586,t?1:0)},e.prototype.seekRoleItem=function(){for(var t=!1,e=backpackControl.getBagItemNum(0),i=0;e>i;i++){if(t)return t;var n=backpackControl.getBagGoodsByIndex(0,i);switch(n.itemConfig.id){case 200001:break;case 200004:t=this.roleHint(5);break;case 200013:t=this.roleHint(0);break;case 200014:t=this.roleHint(1)}}return t},e.prototype.roleHint=function(t){for(var e=heroControl.subRolesLen,i=!1,n=0;e>n;n++){var o=heroControl.getSubRoleByIndex(n);if(i=this.roleHintCheck(o,t))return i}return i},e.prototype.roleHintCheck=function(t,e){if(!t)return!1;var i=1,n=0,o=0,s=0;switch(e){case 0:i=t.getExRingsData(0);var r=DataCenter.ins().FireRing0Config[i];if(i>=1)return!1;r&&(n=r.cost,s=DataCenter.ins().FireRingConfig[0].costItem);break;case 1:i=t.getExRingsData(1);var a=DataCenter.ins().FireRing1Config[i];if(i>=1)return!1;a&&(n=a.cost,s=DataCenter.ins().FireRingConfig[1].costItem);break;case DragonSoulControl.TYPE_LONG_HUN:i+=t.loongSoulData.level;var l=DataCenter.ins().DragonSoulConfig[i],h=DataCenter.ins().DragonSoulStageConfig[t.loongSoulData.stage];l&&(n=h.normalCost,s=l.itemId);break;case 5:i=t.jingMaiData.level;var u=DataCenter.ins().MeridiansLevelConfig[i];u&&(n=u.count,s=u.itemId)}return n&&(o=backpackControl.getBagGoodsCountById(0,s),o>=n)?!0:!1},e.prototype.setCanChange=function(){var t=UIMgr.ins().getView(RoleView);t&&(t.roleInfoPanel.setCanChange(this.canChangeEquips),t.canChangeEquips=this.canChangeEquips)},e}(BaseSystem);__reflect(RoleControl.prototype,"RoleControl");var PunchEquipForgeVo=function(){function t(){this.data=[]
}return t.prototype.parser=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1];if(this.data[i])this.data[i].id=i,this.data[i].level=n;else{var o=new PunchEquipVo;o.id=i,o.level=n,this.data[i]=o}}},Object.defineProperty(t.prototype,"level",{get:function(){for(var t=0,e=0;e<this.data.length;e++){var i=this.data[e];t+=i.level}return t},enumerable:!0,configurable:!0}),t.prototype.getSuitlevel=function(){var t=0;for(var e in DataCenter.ins().FocusAttackPunchMasterConfig){var i=DataCenter.ins().FocusAttackPunchMasterConfig[e];Math.floor(this.level/8)>=i.level&&(t=i.level)}return t},t.prototype.getNextSuitlevel=function(){var t=0;for(var e in DataCenter.ins().FocusAttackPunchMasterConfig){var i=DataCenter.ins().FocusAttackPunchMasterConfig[e];if(i.level>Math.floor(this.level/8)){t=i.level;break}}return t},t.prototype.getPunchLevel=function(t){return this.data[t].level},t.prototype.getCurCost=function(){for(var t,e,i=!0,n=0;8>n;n++){var o=this.data[n];n?e<o.level&&(i=!1,t=n,e=o.level):(t=n,e=o.level)}return i&&(t=0,e++),DataCenter.ins().FocusAttackPunchConfig[t][e]},t.prototype.getNextConfig=function(t){var e=t+1,i=this.getPunchLevel(t);return e>7&&(e=0,i=this.getPunchLevel(e)+1),DataCenter.ins().FocusAttackPunchConfig[e][i]},t.prototype.getPosNextLevelConfig=function(t){var e=this.getPunchLevel(t);return e++,DataCenter.ins().FocusAttackPunchConfig[t][e]},t.prototype.isShowPunchEquipForge=function(){for(var t=skillControl.equipListData,e=0;e<t.length;e++){var i=t[e];if(!i.itemConfig||!i.itemConfig.zsLevel||i.itemConfig.zsLevel<4)return!1}return!0},t.prototype.isUpgradePunchForge=function(t){var e=1;if(this.data[t]&&(e=this.data[t].level),!DataCenter.ins().FocusAttackPunchConfig[t][e+1])return 2;e||(e=1);var i=DataCenter.ins().FocusAttackPunchConfig[t][e+1],n=0;return 11==i.cost.id?n=ActorControl.togeatter1:12==i.cost.id&&(n=ActorControl.togeatter2),n>=i.cost.count?1:0},t.prototype.calcSelectPos=function(){for(var t,e,i=!0,n=0;8>n;n++)if(this.data[n]){var o=this.data[n];n?e>o.level&&(i=!1,t=n,e=o.level):(t=n,e=o.level)}return i&&(t=0,e++),t},t.prototype.getRedPoint=function(){if(!this.isShowPunchEquipForge())return!1;for(var t=0,e=8,i=0;e>i;i++){var n=this.isUpgradePunchForge(i);if(0==n)return!1;2==n&&t++}return t==e?!1:!0},t.prototype.getAttributeData=function(){for(var t=[],e=0;e<this.data.length;e++){var i=this.data[e].id,n=this.data[e].level,o=DataCenter.ins().FocusAttackPunchConfig[i][n];if(o)for(var s=0;s<o.attr.length;s++)if(t.length){for(var r=!1,a=0;a<t.length;a++)t[a].type==o.attr[s].type&&(r=!0,t[a].value+=o.attr[s].value);if(!r){var l=new AttributeData;l.type=o.attr[s].type,l.value=o.attr[s].value,t.push(l)}}else{var l=new AttributeData;l.type=o.attr[s].type,l.value=o.attr[s].value,t.push(l)}}return t},t}();__reflect(PunchEquipForgeVo.prototype,"PunchEquipForgeVo");var WeaponsSoulOneInfoVo=function(){function t(){this.icon="",this.id=0,this.name="",this.actcond=[],this.inside=[],this.outside=[],this.pic=[],this.icon=""}return t.prototype.setSoulInfo=function(t){if(t>0){var e=DataCenter.ins().WeaponSoulConfig[t];if(!e)return;this.id=e.id,this.name=e.name,this.actcond=e.actcond,this.inside=e.inside,this.outside=e.outside,this.pic=e.pic,this.icon=e.icon}},t}();__reflect(WeaponsSoulOneInfoVo.prototype,"WeaponsSoulOneInfoVo");var PunchEquipVo=function(){function t(){}return t}();__reflect(PunchEquipVo.prototype,"PunchEquipVo");var RoleAttrView=function(t){function e(){var e=t.call(this)||this;return e._lastX=0,e.proShowList=[2,3,4,5,6,7,19,56,67,69,13,26],e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.skinName="RankRoleAttrViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.setRoleAttr(this.curRole);var i=heroControl.subRolesLen;i>1&&(this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchBegin(this.bg,this.onMove),this.addEventTouchEnd(this.bg,this.onMove)),this.addEventTouchEnd(this,this.otherClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=heroControl.subRolesLen;i>1&&(this.removeEventTouchTap(this.leftBtn,this.onTouch),this.removeEventTouchTap(this.rightBtn,this.onTouch),this.removeEventTouchBegin(this.bg,this.onMove),this.removeEventTouchEnd(this.bg,this.onMove)),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200)):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200))}},e.prototype.moveAttr=function(t){var e,i=egret.Tween.get(this.attrGroup);e=t>0?0:242,i.to({x:this.attrGroup.x+t,alpha:0},200).to({x:e},200).to({x:80,alpha:1},200)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.leftBtn:this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200));break;case this.rightBtn:this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200))}},e.prototype.setRoleAttr=function(t){var e=heroControl.getSubRoleByIndex(t);this.job.source="op_"+e.job;for(var i="",n=0,o=0,s=0;s<this.proShowList.length;s++){if(o=this.proShowList[s],n=e.attributeData[o],26==o&&(n=e.getExAtt(26)),o>1&&9>o)i+=7==o||8==o?n/100+"%":n;else{if(!(o>12&&15>o||o>15))continue;19==o&&(n+=e.getAtt(65),n+=1e4),i+=n/100+"%"}s<this.proShowList.length-1&&(i+="\n")}this.attr.text=i,this.setBtn()},e.prototype.setBtn=function(){var t=heroControl.subRolesLen;1==t?(this.leftBtn.visible=!1,this.rightBtn.visible=!1):t>1&&(0==this.curRole?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):1==this.curRole?(this.leftBtn.visible=!0,3>t?this.rightBtn.visible=!1:this.rightBtn.visible=!0):2==this.curRole&&(this.leftBtn.visible=!0,this.rightBtn.visible=!1))},e}(BaseEuiView);__reflect(RoleAttrView.prototype,"RoleAttrView");var RoleChangeEquipView=function(t){function e(){var e=t.call(this)||this;return e.itemList=[],e.pos=0,e.roleSelect=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="RoleChangeEquipViewSkin",this.list.itemRenderer=RoleChangeEquipItemRenderer,this.wearItem=new RoleChangeEquipItemRenderer,this.wearItem.imgBg1.visible=!1,this.wearItem.imgBg2.visible=!0,this.itemGroup.addChild(this.wearItem)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.roleSelect=t[0],this.pos=t[1];var i=heroControl.getSubRoleByIndex(this.roleSelect),n=i.getEquipDataByPos(this.pos);this.wearItem.setUpImage(!1),this.wearItem.data=n.item,this.wearItem.setBtnStatu();var o=0;if(n&&0!=n.item.configID){o=n.item.point;var s=0==ItemUtils.getJob(n.item.itemConfig)?i.job:ItemUtils.getJob(n.item.itemConfig);backpackControl.setEquipPowerDic(s,ItemUtils.getSubType(n.item.itemConfig),o)}else DisplayUtils.removeFromParent(this.itemGroup),this.scroll.top=49,this.scroll.height=486;this.itemList=backpackControl.getEquipByPos(this.roleSelect,this.pos),this.list.dataProvider=new eui.ArrayCollection(this.itemList),this.list.validateNow(),this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTap),this.addEventTouchTap(this,this.itemTap)},e.prototype.itemTap=function(t){if("changeBtn"==t.target.name){var e=t.target.parent.data;if(e&&e instanceof ItemData){var i=ActorControl.level,n=reincarnateControl.lv;if(e.itemConfig&&(n<(e.itemConfig.zsLevel||0)||i<(e.itemConfig.level||1)))return 5==ItemUtils.getQuality(e.itemConfig)?void tipsControl.showTips(LangMgr.getValueByKey("roleTips2",e.itemConfig.name,e.itemConfig.zsLevel,e.itemConfig.level||1)):void tipsControl.showTips(LangMgr.getValueByKey("roleTips1"));equipControl.upWearEquipment(e.handle,this.pos,this.roleSelect),UIMgr.ins().close(this),SoundUtils.ins().playEffect(SoundUtils.WEAR)}}},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.sortFun=function(t,e){var i=backpackControl.getEquipAttrs(t),n=BackpackControl.getAttrPower(i),o=backpackControl.getEquipAttrs(e),s=BackpackControl.getAttrPower(o);return s>n?1:n>s?-1:0},e}(BaseEuiView);__reflect(RoleChangeEquipView.prototype,"RoleChangeEquipView");var RoleChangeItemView=function(t){function e(){var e=t.call(this)||this;return e.initMc(),e.skinName="RoleChangeItemViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.id=t[0],this.addEventTouchTap(this,this.onClick),this.addEventTouchTap(this.btntupo,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addCustomEvent(144,this.otherClose),this.init(),this.setCurRole(this.id)},e.prototype.init=function(){this.roles=[this.role1,this.role2,this.role3];for(var t=0;2>t;t++){var e=this.roleMovie[t];this.roles[t+1].addChild(e)}this.updateRole(),this.updateSelect(this.id)},e.prototype.getCurRole=function(){return this.id},e.prototype.setCurRole=function(t){this.id=t;for(var e=0;e<this.roles.length;e++){var i=this.roles[e];i.selected=e==t}this.dispatchEventWith(egret.Event.CHANGE,!1,this.id)},e.prototype.initMc=function(){this.roleMovie=[];for(var t=0;2>t;t++){var e=new GameMovieClip;e.x=44,e.y=44,e.touchEnabled=!1,this.roleMovie.push(e)}},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.btntupo:var e=heroControl.getSubRoleByIndex(this.id);if(!e)return void tipsControl.showTips(LangMgr.getValueByKey("roleTips3"));if(e.weapons.flexibleCount-1>=DataCenter.ins().WeaponSoulBaseConfig.maxItemNum)return void tipsControl.showTips(LangMgr.getValueByKey("roleTips4",DataCenter.ins().WeaponSoulBaseConfig.maxItemNum));weaponsSoulControl.upWeaponsFlexibleCount(this.id)}},e.prototype.onClick=function(t){var e=this.roles.indexOf(t.target);e>-1&&this.changeRole(e)},e.prototype.changeRole=function(t){var e=heroControl.getSubRoleByIndex(t);e?(this.setCurRole(t),this.updateSelect(t)):(UIMgr.ins().open(RecruitView),this.roles[t].selected=!1,UIMgr.ins().close(this))},e.prototype.updateSelect=function(t){for(var e=1;3>=e;e++)t+1==e?this["selectrole"+e].visible=!0:this["selectrole"+e].visible=!1;var i=heroControl.getSubRoleByIndex(t);this.btntupo.visible=i.weapons.flexibleCount-1<DataCenter.ins().WeaponSoulBaseConfig.maxItemNum;var n=i.weapons.flexibleCount;n=n?n-1:1,n=n>=DataCenter.ins().WeaponSoulBaseConfig.maxItemNum?DataCenter.ins().WeaponSoulBaseConfig.maxItemNum:n;var o=DataCenter.ins().WeaponSoulItemAttrConfig[n],s=i.weapons.flexibleCount?n+1:n,r=DataCenter.ins().WeaponSoulItemAttrConfig[s],a=i.weapons.flexibleCount?n:0;a=a>=DataCenter.ins().WeaponSoulBaseConfig.maxItemNum?DataCenter.ins().WeaponSoulBaseConfig.maxItemNum:a,this.curUse.text=a+"",this.nextUse.visible=!0;for(var e=0;4>e;e++)this["name"+e].text=AttributeData.getAttrStrByType(o.attr[e].type),this["tpattr"+e].text=i.weapons.flexibleCount?o.attr[e].value:0,r?(this.nextUse.text=s+"",this["ntpattr"+e].visible=this["dir"+e].visible=!0,this["ntpattr"+e].text=r.attr[e].value):(this["ntpattr"+e].visible=this["dir"+e].visible=!1,this.nextUse.visible=!1);this.dir.visible=this.nextUse.visible,this.material.data=DataCenter.ins().WeaponSoulBaseConfig.itemid},e.prototype.updateRole=function(){for(var t,e,i=this.roles.length,n=0;i>n;n++){if(t=this.roles[n],e=heroControl.getSubRoleByIndex(n))t.jobImg.visible=!0,t.jobImg.source="job"+e.job+"Item",t.stageImg.visible=!1,t.stageImg.source="",t.icon="yuanhead"+e.job+e.sex,this.roleMovie[n-1]&&DisplayUtils.removeFromParent(this.roleMovie[n-1]);else{var o=DataCenter.ins().RoleNewConfig[n];if(!o){debug.warn("role"+(n+1)+"The opening condition is not configured(RoleNewConfig)");continue}t.jobImg.visible=!1,t.stageImg.visible=!0,o.zsLevel?reincarnateControl.lv<o.zsLevel?t.stageImg.source="toujiesuo"+o.zsLevel:t.stageImg.source="toujiesuo":ActorControl.level<o.level?t.stageImg.source="toujiesuo"+o.level:t.stageImg.source="toujiesuo",o.vip&&vipControl.lv>=o.vip&&(t.stageImg.source="toujiesuo"),t.icon=""}this.roleMovie[n-1]&&"toujiesuo"==t.stageImg.source&&t.stageImg.visible&&(this.roleMovie[n-1].playFile(PATH_EFF+"juesejiesuo",-1),this.showRedPoint(n,!0))}},e.prototype.showRedPoint=function(t,e){null!=this.roles&&(this.roles[t].redPoint.visible=e)},e.prototype.otherClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(RoleChangeItemView.prototype,"RoleChangeItemView");var RoleInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.beforeIndex=-1,e.showApproachEffDic={},e.name=LangMgr.getValueByKey("dressType1"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.currentState=SwitchMgr.ins().checkOpen(1016)?"leiting":"nor",this.init()},e.prototype.init=function(){this.touchEnabled=!1,this.touchChildren=!0,this.role0.touchChildren=this.role0.touchEnabled=!1,this.role1.touchChildren=this.role1.touchEnabled=!1,this.equips=[];for(var t=0;13>t;t++)this.equips[t]=this["item"+t],this.equips[t].touchEnabled=!0,this.equips[t].isShowJob(!1),this.equips[t].isShowTips(!1),this["redPoint"+t].touchEnabled=!1;this.eff=new GameMovieClip,this.eff.x=this.oneKeyChange.width/2,this.eff.y=this.oneKeyChange.height/2,this.eff.scaleX=1,this.eff.scaleY=1,this.eff.touchEnabled=!1},e.prototype.clear=function(){this.beforeIndex=-1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.shuzhuang,this.onClick),this.addEventTouchTap(this.bless0,this.onClick),this.addEventTouchTap(this.oneKeyChange,this.onClick),this.addEventTouchTap(this.roleInfoItem0,this.onClick),this.addEventTouchTap(this.roleInfoItem1,this.onClick),this.addEventTouchTap(this.shenlu,this.onClick),this.addEventTouchTap(this.orange,this.onClick),this.addEventTouchTap(this.heirloom,this.onClick),this.addEventTouchTap(this.rune,this.onClick),this.addEventTouchTap(this.juesexiangxi,this.onClick),this.addCustomEvent(116,this.updataEquipCallBack),this.addCustomEvent(120,this.updataEquipCallBack),this.addCustomEvent(121,this.updataEquipCallBack),this.addCustomEvent(161,this.updateRing),this.addCustomEvent(657,this.delayRedPoint),this.addCustomEvent(469,this.delayRedPoint),this.addCustomEvent(468,this.delayRedPoint),this.addCustomEvent(124,this.delayRedPoint),this.addCustomEvent(271,this.delayRedPoint),this.addCustomEvent(295,this.setRoleEff),this.addCustomEvent(145,this.updateLoongSoul),this.addCustomEvent(147,this.updateLoongSoul),this.addCustomEvent(498,this.updateLoongSoul),this.addCustomEvent(574,this.updateLoongSoul),this.addCustomEvent(293,this.setFashionRetPoint),this.addCustomEvent(162,this.delayRedPoint),this.addCustomEvent(373,this.delayRedPoint),this.addCustomEvent(65,this.setRoleEff),this.addCustomEvent(142,this.setRoleEff),this.addCustomEvent(266,this.delayRedPoint),this.addCustomEvent(268,this.delayRedPoint),this.addCustomEvent(267,this.delayRedPoint),this.addCustomEvent(269,this.delayRedPoint),this.addCustomEvent(373,this.delayRedPoint),this.addCustomEvent(461,this.delayRedPoint),this.addCustomEvent(576,this.delayRedPoint),this.addCustomEvent(653,this.delayRedPoint),this.addCustomEvent(562,this.delayRedPoint),this.addCustomEvent(656,this.delayRedPoint),this.addCustomEvent(656,this.updataEquipCallBack),this.addCustomEvent(612,this.delayRedPoint),this.addCustomEvent(613,this.delayRedPoint),this.addCustomEvent(614,this.delayRedPoint),this.addCustomEvent(634,this.delayRedPoint),this.addCustomEvent(617,this.delayRedPoint),this.addCustomEvent(711,this.setRoleEff),this.updateRing(),this.updateLoongSoul(),this.setRetPoint(),this.updataEquip(!1),this.setFashionRetPoint(),this.clearChangeEff(),-1!=this.beforeIndex?this.roleChange(this.beforeIndex,this.curRole):(this.role0.setRole(heroControl.getSubRoleByIndex(this.curRole)),this._curRoleItem=this.role0,this.playRoleApproachEff(heroControl.getSubRoleByIndex(this.curRole),this._curRoleItem)),this.beforeIndex=this.curRole,this.setSuitEquips(),this.bless0.icon=SwitchMgr.ins().checkOpen(1016)?"juese_leiting":"juese_tejie"},e.prototype.playRoleApproachEff=function(t,e,i){var n=this;return this.showApproachEffDic[t.index]?!1:(i&&i.removeApproachEff(),e.playApproachEff(t,function(){n.showApproachEffDic[t.index]=1}))},e.prototype.close=function(){DisplayUtils.removeFromParent(this.eff),this.roleInfoItem0.destory(),this.roleInfoItem1.destory()},e.prototype.clearChangeEff=function(){egret.Tween.removeTweens(this.role0),egret.Tween.removeTweens(this.role1),this.curRoleItem().x=0,this.nextRoleItem().x=580,this.curRoleItem().alpha=1,this.nextRoleItem().alpha=0,this.nextRoleItem().visible=!1,this.curRoleItem().setRole(heroControl.getSubRoleByIndex(this.curRole))},e.prototype.roleChange=function(t,e){var i=this;if(t==e)return void this.clearChangeEff();var n=this.curRoleItem(),o=this.nextRoleItem();if(o.visible=!0,n.setRole(heroControl.getSubRoleByIndex(t)),o.setRole(heroControl.getSubRoleByIndex(e)),this.playRoleApproachEff(heroControl.getSubRoleByIndex(e),o,n))return this._curRoleItem=o,void this.clearChangeEff();var s=egret.Tween.get(n),r=egret.Tween.get(o);e>t?(o.x=580,s.to({x:-580,alpha:0},600),r.to({x:0,alpha:1},600).call(function(){i._curRoleItem=o,i.clearChangeEff()},this)):(o.x=-580,s.to({x:580,alpha:0},600),r.to({x:0,alpha:1},600).call(function(){i._curRoleItem=o,i.clearChangeEff()},this))},e.prototype.updateLoongSoul=function(){this.redPointShenlu.visible=dragonSoulControl.canShowRedPointInAll()||experienceJadeNewControl.checkRed()||BeastRedPoint.ins().redpoint},e.prototype.updateRing=function(){var t=heroControl.getSubRoleByIndex(this.curRole);if(t){var e=t.exRingsData;e[0]>0?(this.roleInfoItem0.setImgSource(0,1),this.roleInfoItem0.setLv(0),this.roleInfoItem0.setNameTxt(LangMgr.getValueByKey("roleMb")),this.roleInfoItem0.setBgValue("quality4"),this.roleInfoItem0.setRedPointVisibel(!1)):(this.roleInfoItem0.setImgSource(0,0),this.roleInfoItem0.setLv(0),this.roleInfoItem0.setNameTxt(LangMgr.getValueByKey("roleMb")),this.roleInfoItem0.setBgValue("quality0")),e[1]>0?(this.roleInfoItem1.setImgSource(1,1),this.roleInfoItem1.setLv(0),this.roleInfoItem1.setNameTxt(LangMgr.getValueByKey("roleHS")),this.roleInfoItem1.setBgValue("quality4"),this.roleInfoItem1.setRedPointVisibel(!1)):(this.roleInfoItem1.setImgSource(1,0),this.roleInfoItem1.setLv(0),this.roleInfoItem1.setNameTxt(LangMgr.getValueByKey("roleHS")),this.roleInfoItem1.setBgValue("quality0"))}},e.prototype.updataEquip=function(t){void 0===t&&(t=!0);var e=heroControl.getSubRoleByIndex(this.curRole);this.setEquip(e),t?TimerMgr.ins().doTimer(300,1,this.onDelayReflash,this):this.onDelayReflash(),this.setSuitEquips()},e.prototype.onDelayReflash=function(){roleControl.setCanChange()},e.prototype.updataEquipCallBack=function(){this.updataEquip(),this.setEffect()},e.prototype.setEquip=function(t){if(t){for(var e=t.getEquipLen(),i=0;e>i;i++){var n=t.getEquipByIndex(i);this.equips[i].setModel(t),this.equips[i].setCurRole(this.curRole),this.equips[i].setIndex(i),this.equips[i].data=n.item,0==n.item.configID?(this.equips[i].setItemImg(i>13?"":"xb_1"+IntensifyConst.EQUIP_POS[i]),this.equips[i].isShowTips(!1),this.addEventTouchTap(this.equips[i],this.onClick)):(this.equips[i].isShowTips(!0),this.removeEventTouchTap(this.equips[i],this.onClick)),i>=0&&7>=i&&this.equips[i].setDevour(DevourEquipContorl.ins().getDevourAllRole())}this.powerPanel.setPower(t.power)}},e.prototype.setEffect=function(){this.curRoleItem().setRole(heroControl.getSubRoleByIndex(this.curRole))},e.prototype.setRoleEff=function(){this.curRoleItem().setRole(heroControl.getSubRoleByIndex(this.curRole))},e.prototype.nextRoleItem=function(){return this.role1==this._curRoleItem?this.role0:this.role1},e.prototype.curRoleItem=function(){return this._curRoleItem?this._curRoleItem:this.role0},e.prototype.setFashionRetPoint=function(){this.fashionPoint&&(this.fashionPoint.visible=fashionControl.redPoint())},e.prototype.onClick=function(t){switch(t.currentTarget){case this.juesexiangxi:UIMgr.ins().open(RoleAttrView,this.curRole);break;case this.oneKeyChange:roleControl.checkHaveCan(!0,this.curRole),this.setCanChange(),SoundUtils.ins().playEffect(SoundUtils.WEAR);break;case this.roleInfoItem0:UIMgr.ins().open(SuperRingView,0,this.curRole);break;case this.roleInfoItem1:UIMgr.ins().open(SuperRingView,1,this.curRole);break;case this.shuzhuang:UIMgr.ins().open(FashionView,this.curRole);break;case this.shenlu:UIMgr.ins().open(CimeliaView,0,this.curRole);break;case this.orange:UIMgr.ins().open(DeityEquipView,0,0),this.setRetPoint();break;case this.heirloom:UIMgr.ins().open(HeirloomView,0,this.curRole);break;case this.rune:UIMgr.ins().open(RuneView,this.curRole);break;case this.bless0:if(SwitchMgr.ins().checkOpen(1016))if(thunderControl.checkSysOpen())UIMgr.ins().open(ThunderView,0);else{var e="",i=DataCenter.ins().ThunderQuenBaseConfig.openLevel/1e3>>0,n=DataCenter.ins().ThunderQuenBaseConfig.openLevel%1e3>>0;e+=i?LangMgr.getValueByKey("numberRotation",i):"",e+=n?LangMgr.getValueByKey("numberLevel",n):"",tipsControl.showTips(LangMgr.getValueByKey("fbShow3",DataCenter.ins().ThunderQuenBaseConfig.openDay,e))}else superRingControl.isFireRingFuse()?UIMgr.ins().open(FireRingView):superRingControl.checkRingOpen()?UIMgr.ins().open(SuperRingInfoView):tipsControl.showTips(LangMgr.getValueByKey("roleActivityAfter"));break;default:var o=this.equips.indexOf(t.currentTarget);o>=0&&8>=o&&UIMgr.ins().open(RoleChangeEquipView,this.curRole,o)}},e.prototype.delayRedPoint=function(){TimerMgr.ins().isExists(this.setRetPoint,this)||TimerMgr.ins().doTimer(60,1,this.setRetPoint,this)},e.prototype.setRetPoint=function(){for(var t=0;2>t;t++){var e=heroControl.getSubRoleByIndex(this.curRole),i=roleControl.roleHintCheck(e,t);this["roleInfoItem"+t].setRedPointVisibel(i)}for(var n=!1,o=heroControl.subRolesLen,t=0;o>t;t++){for(var s=heroControl.getSubRoleByIndex(t),r=0;8>r;r++){if(n=equipControl.setOrangeEquipItemState(r,s),!n&&2>r&&(n=equipControl.setLegendEquipItemState(r>0?2:0,s)),n){var a=backpackControl.checkEqRedPoint(r,s);n=null!=a?a:n}if(n)break}if(n)break}n||(n=MythEquipRedPoint.ins().redPoint),n||(n=backpackControl.getLegendHasResolve()),n||(n=backpackControl.getLegendOutEquips().length>0),n||(n=darkEquipControl.checkSysOpen()?darkEquipControl.getRedPoint():Boolean(backpackControl.getHuntGoods(0).length)),n||(n=uitrasoneEquipControl.getRedPoint()),n||(n=thunderControl.getRedPoint()),this.orangeRedPoint.visible=n,this.heirloomRedPoint.visible=HeirloomRedPoint.ins().redPoint||CrazybtplayRedPoint.ins().redPoint||DominateEquipRedPoint.ins().redPoint||TotemRedPoint.ins().redPoint,this.updateLoongSoul(),SwitchMgr.ins().checkOpen(1016)?this.ringRedPoint.visible=thunderControl.getRedPoint():this.ringRedPoint.visible=SwitchMgr.ins().checkOpen(9)&&(superRingControl.checkHaveUpRing()||superRingControl.isCanStudySkill()||superRingControl.isCanUpgradeSkill()||superRingControl.fireRingRedPoint()||flameMarkControl.checkRed()),this.zwRedPoint.visible=RuneRedPoint.ins().checkAllSituation(!1),this.setCanChange()},e.prototype.setSamsaraRedPoint=function(){if(reincarnationControl.isOpen())for(var t=9;13>t;t++){var e=this["redPoint"+t],i=heroControl.getSubRoleByIndex(this.curRole),n=i.getEquipByIndex(t);n.soulLv>0?this["item"+t].setSoul(!0):this["item"+t].setSoul(!1),e.visible||(e.visible=reincarnationControl.checkEquipPosCanAddSpirit(i,t)||reincarnationControl.checkUpgradeSoul(i,t))}for(var t=9;13>t;t++)this["item"+t].visible=reincarnationControl.isOpen()},e.prototype.setCanChange=function(t){var e=t?t[this.curRole]?t[this.curRole]:[]:roleControl.canChangeEquips[this.curRole],i=!1,n=this.equips.length;DisplayUtils.removeFromParent(this.eff);for(var o=heroControl.getSubRoleByIndex(this.curRole),s=0;n>s;s++)this["redPoint"+s].visible=e[s]?e[s]:!1,this["redPoint"+s].visible||(this["redPoint"+s].visible=starSunControl.checkUpRedPoint(o,s)),i||(i=e[s]?e[s]:!1);this.redPoint8.visible||(this.redPoint8.visible=OfficeRedPoint.ins().getRed(o.job)),this.updateOneKey(i),this.setSamsaraRedPoint()},e.prototype.updateOneKey=function(t){return SwitchMgr.ins().checkOpen(13)?(this.oneKeyChange.visible=t,void(this.oneKeyChange.visible?(this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||this.effGroup.addChild(this.eff)):DisplayUtils.removeFromParent(this.eff))):void(this.oneKeyChange.visible=!1)},e.prototype.getEquipItem=function(t){return this.equips[t]},e.prototype.setSuitEquips=function(){for(var t=heroControl.getSubRoleByIndex(this.curRole),e=0;e<GameConst.FORGE_MAX;e++){var i=this.equips[e],n=t.heirloom.getInfoBySolt(e);i&&n.lv>0?i.setItemHeirloomBgImg(!0,n.image):i.setItemHeirloomBgImg(!1)}},__decorate([callLater],e.prototype,"updataEquip",null),e}(BasePanel);__reflect(RoleInfoPanel.prototype,"RoleInfoPanel");var RoleView=function(t){function e(){var e=t.call(this)||this;return e.roleIndex=0,e.oldIndex=0,e.roleSelectVis=!0,e.skinName="RoleViewSkin",e.isTopLevel=!0,e.canVis=!0,e.isPlayAnima=!1,e.addExclusionWin(egret.getQualifiedClassName(SmeltEquipView)),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.touchEnabled=!1},e.openCheck=function(t){var e=t?t:0;if(2==e){if(ActorControl.level<DataCenter.ins().ReincarnateConfig.level)return tipsControl.showTips(LangMgr.getValueByKey("roleTips6",DataCenter.ins().ReincarnateConfig.level)),!1;if(reincarnateStarControl.checkShow13ZsPanel())return UIMgr.ins().open(ReincarnateStarView),!1}return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.oldIndex=this.tab.selectedIndex=this.viewStack.selectedIndex=t[0]?t[0]:0,this.addEventTouchTap(this,this.onClick),this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.roleSelectPanel,this.onChange),this.addCustomEvent(586,this.delayRedPoint),this.addCustomEvent(112,this.delayRedPoint),this.addCustomEvent(461,this.delayRedPoint),this.addCustomEvent(460,this.delayRedPoint),this.addCustomEvent(376,this.delayRedPoint),this.addCustomEvent(87,this.delayRedPoint),this.addCustomEvent(266,this.delayRedPoint),this.addCustomEvent(267,this.delayRedPoint),this.addCustomEvent(268,this.delayRedPoint),this.addCustomEvent(576,this.delayRedPoint),this.addCustomEvent(653,this.delayRedPoint),this.addCustomEvent(210,this.delayRedPoint),this.addCustomEvent(206,this.delayRedPoint),this.addCustomEvent(208,this.delayRedPoint),this.addCustomEvent(151,this.delayRedPoint),this.addCustomEvent(231,this.delayRedPoint),this.addCustomEvent(232,this.delayRedPoint),this.addCustomEvent(656,this.delayRedPoint),this.addCustomEvent(612,this.delayRedPoint),this.addCustomEvent(613,this.delayRedPoint),this.addCustomEvent(614,this.delayRedPoint),this.addCustomEvent(651,this.delayRedPoint),this.addCustomEvent(652,this.ThirteenCallBack),this.addCustomEvent(634,this.delayRedPoint),this.addCustomEvent(617,this.delayRedPoint),this.addCustomEvent(718,this.delayRedPoint),this.addEventTouchTap(this.help,this.onClick),this.roleIndex=t[1]?t[1]:0;var i=this.viewStack.selectedIndex;this.roleSelectPanel.setCurRole(this.roleIndex),4==i&&this.roleSelectPanel.hideRole(),this.setOpenIndex(i),this.redPoint()},e.prototype.openSamsara=function(){var t=this.viewStack.getChildIndex(this.reincarnationPanel);0>t&&this.viewStack.addChild(this.reincarnationPanel),this.tab.dataProvider=this.viewStack,this.redPointGroup.horizontalCenter=49,this.redPoint4.visible=reincarnationControl.isCanUpgrade()||reincarnationControl.isCanExchange()||!reincarnationControl.isMaxSamsara(ActorControl.samsaraLv)&&reincarnationControl.isCanUpgradeSoul()},e.prototype.inactiveSamsara=function(){var t=this.viewStack.getChildIndex(this.reincarnationPanel);t>=0&&this.viewStack.removeChildAt(t),this.tab.dataProvider=this.viewStack,this.redPointGroup.horizontalCenter=104,this.redPoint4.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=UIMgr.ins().getView(GameBottomView);i&&i.closeNav(GameBottomView.NAV_ROLE);for(var n=this.viewStack.numChildren,o=0;n>o;o++)this.viewStack.getChildAt(o).close()},e.prototype.checkIsOpen=function(t){if(1==t){if(!skillControl.checkHejiOpen())return tipsControl.showTips(LangMgr.getValueByKey("roleTips5")),this.roleSelectPanel.visible=this.roleSelectVis,!1;if(GameServer.serverOpenDay+1>=DataCenter.ins().FocusAttackBaseConfig.openAwakeDay)return UIMgr.ins().open(FocusAwakeView),!1}else if(2==t){if(ActorControl.level<DataCenter.ins().ReincarnateConfig.level)return tipsControl.showTips(LangMgr.getValueByKey("roleTips6",DataCenter.ins().ReincarnateConfig.level)),!1;if(reincarnateStarControl.checkShow13ZsPanel())return UIMgr.ins().open(ReincarnateStarView),!1}else if(3==t&&ActorControl.level<DataCenter.ins().FeatherCommonConfig.openLevel)return tipsControl.showTips(LangMgr.getValueByKey("roleTips7",DataCenter.ins().FeatherCommonConfig.openLevel)),!1;return!0},e.prototype.onTabTouch=function(t){var e=this.tab.selectedIndex;4==e&&this.roleSelectPanel.hideRole(),this.setOpenIndex(e)},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.onChange=function(t){this.setRoleId(this.roleSelectPanel.getCurRole())},e.prototype.setRoleId=function(t){this.roleInfoPanel.curRole=this.featherPanel.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.setTabSelectedIndex=function(t){this.tab.selectedIndex=t,this.oldIndex=t,this.setOpenIndex(t)},e.prototype.setOpenIndex=function(t){if(this.roleSelectVis=this.roleSelectPanel.visible,this.oldIndex&&3==this.oldIndex&&this.oldIndex!=t&&this.getWingPanelInfo())return this.doOpenHintWin(1,this.tab.selectedIndex),void(this.tab.selectedIndex=this.oldIndex);switch(1!=t&&this.focusAttackPanel.close(),this.help.visible=!1,t){case 0:this.biaoti.source="biaoti_juese",this.roleSelectPanel.openRole(),this.roleInfoPanel.open();break;case 1:this.biaoti.source="biaoti_heji",this.roleSelectPanel.hideRole(),this.focusAttackPanel.open();break;case 2:ActorControl.level>=DataCenter.ins().ReincarnateConfig.level?(this.biaoti.source="biaoti_zhuansheng",this.roleSelectPanel.hideRole(),this.reincarnatePanel.open(),this.reincarnatePanel.setData()):(tipsControl.showTips(LangMgr.getValueByKey("roleTips6",DataCenter.ins().ReincarnateConfig.level)),this.tab.selectedIndex=this.viewStack.selectedIndex);break;case 3:ActorControl.level>=DataCenter.ins().FeatherCommonConfig.openLevel?(this.biaoti.source="biaoti_yuyi",this.roleSelectPanel.openRole(),this.featherPanel.open()):(tipsControl.showTips(LangMgr.getValueByKey("roleTips7",DataCenter.ins().FeatherCommonConfig.openLevel)),this.tab.selectedIndex=this.viewStack.selectedIndex);break;case 4:this.reincarnationPanel.open(),this.tab.selectedIndex=this.viewStack.selectedIndex=4,this.help.visible=!0}this.oldIndex!=t?this.tab.selectedIndex!=this.viewStack.selectedIndex&&(this.viewStack.getElementAt(this.oldIndex).close(),this.oldIndex=t):this.tab.selectedIndex=this.viewStack.selectedIndex=t,this.redPoint()},e.prototype.onClick=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);var e=UIMgr.ins().getView(GameBottomView);e&&e.closeNav(GameBottomView.NAV_ROLE);break;case this.help:HelpControl.openHelpWin(22)}},e.prototype.delayRedPoint=function(){TimerMgr.ins().isExists(this.redPoint,this)||TimerMgr.ins().doTimer(60,1,this.redPoint,this)},e.prototype.redPoint=function(){var t=[reincarnateControl.canOpenZSWin()&&!reincarnateControl.isMaxLv()&&(reincarnateControl.canGet()>0||reincarnateControl.canUpgrade())||ReincarnateStarRedPoint.ins().redPoint],e=this.canWingEquip(),i=skillControl.canHejiEquip()||skillControl.canExchange()||skillControl.canSolve(),n=this.canEquip(),o=(reincarnationControl.isOpen(),!1);
o=SwitchMgr.ins().checkOpen(1016)?thunderControl.getRedPoint():SwitchMgr.ins().checkOpen(9)&&(superRingControl.checkHaveUpRing()||superRingControl.isCanStudySkill()||superRingControl.isCanUpgradeSkill()||superRingControl.fireRingRedPoint()||flameMarkControl.checkRed());var s=[n,i,t,e];this.redPoint0.visible=CommonFun.andState(n)||o||heroControl.isLockRole()||experienceJadeNewControl.checkRed()||BeastRedPoint.ins().redpoint||HeirloomRedPoint.ins().redPoint||CrazybtplayRedPoint.ins().redPoint||DominateEquipRedPoint.ins().redPoint||reincarnationControl.isOpen()&&reincarnationControl.isOpen()&&(reincarnationControl.isCanAddSpirit()||reincarnationControl.isCanUpgradeSoul())||TotemRedPoint.ins().redPoint||featherControl.checkDanRed()||DevourEquipRedPoint.ins().redPoint,this.redPoint1.visible=i||skillControl.getPunchForge().getRedPoint(),this.redPoint2.visible=CommonFun.andState(t),this.redPoint3.visible=CommonFun.andState(e)||CommonFun.andState(featherControl.canGradeupWing())||CommonFun.andState(featherControl.canItemGradeupWing())||featherControl.isHaveActivationWing()||FeatherDeityRedPoint.ins().getGodWingRedPoint(),this.redPoint3.visible=ActorControl.level>=DataCenter.ins().FeatherCommonConfig.openLevel?this.redPoint3.visible:!1;for(var r=heroControl.subRolesLen,a=0;r>a;a++){var l=!1;this.tab.selectedIndex<4&&(s[this.tab.selectedIndex][a]&&(l=!0),this.roleSelectPanel.showRedPoint(a,l))}reincarnationControl.isOpen()?(this.openSamsara(),this.setSamsaraEquipVisible(!0)):(this.inactiveSamsara(),this.setSamsaraEquipVisible(!1))},e.prototype.setSamsaraEquipVisible=function(t){this.roleInfoPanel&&4==this.viewStack.selectedIndex&&this.roleInfoPanel.skinName&&(this.roleInfoPanel.item9.visible=t,this.roleInfoPanel.item10.visible=t,this.roleInfoPanel.item11.visible=t,this.roleInfoPanel.item12.visible=t)},e.prototype.canWingEquip=function(){for(var t=[!1,!1,!1],e=featherControl.canItemGradeupWing(),i=featherControl.canRoleOpenWing(),n=heroControl.subRolesLen,o=0;n>o;o++)DataCenter.ins().FeatherCommonConfig.openLevel>ActorControl.level?t[o]=!1:i[o]?t[o]=!0:(e[o]&&(t[o]=!0),featherControl.canUseAptitudeByRoleID(o)&&(t[o]=!0),featherControl.canUseFlyUpByRoleID(o)&&(t[o]=!0),featherControl.checkDanRedByIndex(o)&&(t[o]=!0));return t},e.prototype.canEquip=function(){var t=[!1,!1,!1];if(this.canChangeEquips&&this.canChangeEquips[0].length||(this.canChangeEquips=roleControl.canChangeEquips),this.canChangeEquips)for(var e=heroControl.subRolesLen,i=0;e>i;i++){var n=this.canChangeEquips[i];for(var o in n)if(n[o]){t[i]=!0;break}if(0==t[i])for(var s=0;5>s;s++){var r=[];if(r=s>1?dragonSoulControl.canGradeupLoongSoul(s):superRingControl.canGradeupRing(s),r[i]){t[i]=r[i];break}}for(var a=heroControl.getSubRoleByIndex(i),l=!1,h=0;8>h;h++){if(l=equipControl.setOrangeEquipItemState(h,a),!l&&2>h&&(l=equipControl.setLegendEquipItemState(h>0?2:0,a)),l){var u=backpackControl.checkEqRedPoint(i,a);l=null!=u?u:l}if(l)break}l||(l=equipControl.checkRedPointEx(4,i)),l||(l=equipControl.checkRedPointEx(5,i)),l||(l=darkEquipControl.checkSysOpen()?darkEquipControl.getRedPoint(i):Boolean(backpackControl.getHuntGoods(0).length)),l||(l=uitrasoneEquipControl.getRedPoint()),l||(l=thunderControl.getRedPoint()),l&&(t[i]=l),t[i]||(t[i]=StarSunRedPoint.ins().roleTabs[i]),t[i]||(t[i]=HeirloomRedPoint.ins().roleTab[i]),t[i]||(t[i]=OfficeRedPoint.ins().getRed(a.job)),t[i]||(t[i]=reincarnationControl.checkRoleCanAddSpirit(i)),t[i]||(t[i]=reincarnationControl.checkRoleCanUpgradeSoul(i))}return t},e.prototype.getWingPanelInfo=function(){if(!this.isShow())return!1;if(3!=this.oldIndex)return!1;for(var t,e=heroControl.roles.length,i=0;e>i;i++){var n=heroControl.getSubRoleByIndex(i).wingsData;t&&0!=t.clearTime?t.clearTime>n.clearTime&&n.clearTime>0&&(t=n):t=n}return this.wingData=t,t.clearTime>0&&FeatherControl.hint},e.prototype.doOpenHintWin=function(t,e){void 0===e&&(e=0),UIMgr.ins().open(FeatherHintView,t,e,this.wingData)},e.prototype.getEquipGrid=function(t){return this.validateNow(),this.roleInfoPanel.getEquipItem(t)},e.prototype.ThirteenCallBack=function(){2==this.tab.selectedIndex&&reincarnateStarControl.checkShow13ZsPanel()&&!UIMgr.ins().isShow(ReincarnateStarView)&&(this.viewStack.selectedIndex=0,this.setOpenIndex(0),UIMgr.ins().open(ReincarnateStarView))},e}(BaseEuiView);__reflect(RoleView.prototype,"RoleView");var RoleChangeEquipItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.showUpimage=!0,e.skinName="RoleChangeEquipItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&this.data.itemConfig){this.addEventRemovedFromStage(this,this.onRemove);var t=this.data;this.itemIcon.setData(this.data.itemConfig),this.nameTxt.text=t.itemConfig.name,this.nameTxt.textColor=ItemUtils.getQualityColor(this.data.itemConfig);var e=backpackControl.getEquipAttrs(this.data),i=(DataCenter.ins().EquipConfig[this.data.itemConfig.id],0),n=this.data.point+i;this.power.text=LangMgr.getValueByKey("wingPingfen",n);var o=ItemUtils.getSubType(this.data.itemConfig);this.upImg.x=this.power.x+this.power.textWidth+10;var s=ActorControl.level>=(this.data.itemConfig.level||1)&&reincarnateControl.lv>=(this.data.itemConfig.zsLevel||0),r=s?""+ColorUtils.GREEN:LangMgr.getValueByKey("color82");if(8==o)this.levelStrText.text=LangMgr.getValueByKey("equiLevelValue"),this.levelText.text=backpackControl.getGuanyinLevel(t.itemConfig);else{this.levelStrText.text=LangMgr.getValueByKey("equiLevel");var a=isNaN(this.data.itemConfig.zsLevel)?LangMgr.getValueByKey("numberLevel",this.data.itemConfig.level||1):LangMgr.getValueByKey("numberRotation",this.data.itemConfig.zsLevel);this.levelText.textFlow=TextUtils.generateTextFlow("|C:"+r+"&T:"+a+"|")}var l=0;if(this.now.visible=!this.showUpimage,this.data.itemConfig.job)l=ItemUtils.getJob(this.data.itemConfig);else{var h=UIMgr.ins().getView(RoleChangeEquipView),u=h.roleSelect,p=heroControl.getSubRoleByIndex(u);l=p.job}var c=backpackControl.getEquipPowerDic(l,o);if(n>c&&this.showUpimage&&s){this.upImg.visible=!0;var d=egret.Tween.get(this.upImg,{loop:!0});d.to({y:this.upImg.y-3},250).to({y:this.upImg.y+3},250)}else this.upImg.visible=!1;0==this.itemIndex&&this.showUpimage&&s&&n>c?(this.best.visible=!0,this.best.x=this.upImg.x+this.upImg.width+9):this.best.visible=!1;for(var g="",m=0;m<e.length;m++)if(0!=e[m].type&&0!=e[m].value){var a=AttributeData.getAttrNameByAttrbute(e[m],!0);g+=a+"\n"}this.attr1.textFlow=(new egret.HtmlTextParser).parser(g),reincarnateControl.lv<(this.data.itemConfig.zsLevel||0)||ActorControl.level<(this.data.itemConfig.level||1)?this.changeBtn.visible=!1:this.changeBtn.visible=!0}},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),egret.Tween.removeTweens(this.upImg)},e.prototype.setUpImage=function(t){this.showUpimage=t},e.prototype.setBtnStatu=function(){this.changeBtn.visible=!1,this.now.visible=!0},e}(BaseItemRender);__reflect(RoleChangeEquipItemRenderer.prototype,"RoleChangeEquipItemRenderer");var RoleItemItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curRole=-1,e._index=-1,e.showTip=!0,e}return __extends(e,t),e.prototype.init=function(){t.prototype.init.call(this),this.boostLv=new eui.Label,this.boostLv.x=35,this.boostLv.y=55,this.boostLv.textColor=LangMgr.getColor("color33"),this.zhulingLv=new eui.Label,this.zhulingLv.x=12,this.zhulingLv.y=55,this.zhulingLv.textColor=LangMgr.getColor("color34"),this.boostLv.size=this.zhulingLv.size=16,this.boostLv.width=this.zhulingLv.width=41,this.boostLv.stroke=this.zhulingLv.stroke=1,this.boostLv.strokeColor=this.zhulingLv.strokeColor=ColorUtils.BLACK,this.boostLv.textAlign="right",this.addChild(this.boostLv),this.addChild(this.zhulingLv),this.mc=new GameMovieClip,this.mc.x=46,this.mc.y=43},e.prototype.dataChanged=function(){this.playEff(),t.prototype.dataChanged.call(this);var e=this.data.itemConfig;if(e){for(var i=this._model.equipsData,n=void 0,o=0;o<i.length;o++)if(this.data.handle==i[o].item.handle){n=i[o];break}this.boostLv.text=n.strengthen>0?"+"+n.strengthen:"",this.zhulingLv.text=n.zhuling>0?n.zhuling+"":"",ItemUtils.getSubType(e)==IntensifyConst.EQUIP_POS[8]&&(this.nameTxt.text=backpackControl.getGuanyinLevel(e))}this.getItemIcon().extreme.visible=!1,this._curRole>=0&&this._index>=0&&this._index<=7&&(this.getItemIcon().extreme.visible||(this.getItemIcon().extreme.visible=uitrasoneEquipControl.getZhiZunLvByRoleID(this._model,this._index)>0)),this._lastData=this.data,this._lastModel=this._model},e.prototype.clear=function(){t.prototype.clear.call(this),this.boostLv.text=this.zhulingLv.text="",this.playEff()},e.prototype.isShowTips=function(t){this.showTip=t},e.prototype.openEquipsTips=function(){this.showTip&&(this._index>8?UIMgr.ins().open(ReincarnationEquipTipsView,this._curRole,this._lastModel,this._index):UIMgr.ins().open(EquipTipsView,1,this.data.handle,this.itemConfig.id,this.data,this._model,this._curRole,this._index,this.devourEquip))},e.prototype.showPower=function(){this.openEquipsTips()},e.prototype.setModel=function(t){this._model=t},e.prototype.getModel=function(){return this._model},e.prototype.setCurRole=function(t){this._curRole=t},e.prototype.getCurRole=function(){return this._curRole},e.prototype.setIndex=function(t){this._index=t},e.prototype.getIndex=function(){return this._index},e.prototype.playEff=function(){this._lastData&&this._lastData!=this.data&&this._model==this._lastModel&&(this.mc.playFile(PATH_EFF+"forgeSuccess",1),this.addChild(this.mc))},e.prototype.setDevour=function(t){this.devourEquip=t},e}(ItemBase);__reflect(RoleItemItemRenderer.prototype,"RoleItemItemRenderer");var RoleRingItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.iconMc=new GameMovieClip,e.iconMc.x=45,e.iconMc.y=40,e.iconMc.scaleX=e.iconMc.scaleY=.4,e}return __extends(e,t),e.prototype.getImgSource=function(){return this._imgSource},e.prototype.setImgSource=function(t,e){var i=t?"hushen":"mabi";this.iconMc.playFile(PATH_EFF+i,-1),this.iconMc&&!this.iconMc.parent&&this.addChild(this.iconMc);var n=e?[]:FilterUtils.ARRAY_GRAY_FILTER;this.iconMc.filters=n},e.prototype.getLv=function(){return this._lv},e.prototype.setLv=function(t){this._lv!=t&&(this._lv=t,0==this._lv?this.lvTxt.text="":this.lvTxt.text="+"+this._lv)},e.prototype.getNameTxt=function(){return this.labelDisplay.text},e.prototype.setNameTxt=function(t){this._imgSource!=t&&(this.labelDisplay.text=t)},e.prototype.setBgValue=function(t){this.bgImg.source=t},e.prototype.getRedPointVisibel=function(){return this.redPoint.visible},e.prototype.setRedPointVisibel=function(t){this.redPoint.visible=t},e.prototype.destory=function(){this.iconMc.filters=null,DisplayUtils.removeFromParent(this.iconMc),this.iconMc.filters=null},e}(BaseItemRender);__reflect(RoleRingItemRenderer.prototype,"RoleRingItemRenderer");var RuneControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.boxs=[],e.posIsWear=null,e._runeMergeNeedItems={},e.exchangeList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upInlay=function(t,e,i){return[t,e,i]},e.prototype.downInlay=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0);var o=Boolean(t);EventMgr.ins().dispatch(124,[o,e,i,n])},e.prototype.upUpgrade=function(t,e){return[t,e]},e.prototype.downUpgrade=function(t,e,i,n){t&&(this.replaceRune(e,i,n),EventMgr.ins().dispatch(125,[t,e,n,i]))},e.prototype.upOneKeyDecompose=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].configID);return[e]},e.prototype.downOneKeyDecompose=function(t,e){EventMgr.ins().dispatch(126,[t,e])},e.prototype.upExchangeRune=function(t){return[t]},e.prototype.upHuntRune=function(t){return[t]},e.prototype.downHuntRuneInfo=function(t,e){for(var i=[],n=0;n<e.length;n++)i[n]=[e[n][0],e[n][1]];UIMgr.ins().isShow(TreasureHuntResultView)?treasureHuntControl.dispatchHuntResult(t,i,1):UIMgr.ins().open(TreasureHuntResultView,t,i,1),EventMgr.ins().dispatch(127)},e.prototype.downBestListInfo=function(t){for(var e=[],i=0;i<t.length;i++)e[i]=[t[i][0],t[i][1]];return e.reverse(),e},e.prototype.upRuneBoxGift=function(t){return[t]},e.prototype.downRuneBoxGift=function(t,e,i){this.RuneRewards=t,this.runeCount=e,this.hope=i;var n=0;for(var o in DataCenter.ins().TreasureRuneRewardConfig){var s=DataCenter.ins().TreasureRuneRewardConfig[o];this.boxs[n]=this.RuneRewards>>s.id&1?2:this.runeCount>=s.needTime?1:0,n++}EventMgr.ins().dispatch(128)},e.prototype.getIsGetBox=function(){for(var t=0;5>t;t++)switch(this.boxs[t]){case 0:break;case 1:return!0;case 2:}return!1},e.prototype.upRuneMerge=function(t){return[t]},e.prototype.downDelRune=function(t,e){var i=this.getRune(t,e);i.reset(),EventMgr.ins().dispatch(129)},e.prototype.isOpen=function(){var t=DataCenter.ins().PieceTotalConfig[4];return(t.openZs||0)<=reincarnateControl.lv&&(t.openLv||0)<=ActorControl.level?!0:!1},e.prototype.getRuneMergeEquipByLv=function(t){var e=[],i=DataCenter.ins().RuneComposeConfig;for(var n in i)i[n].mixId[1]==t&&e.push({type:3,id:i[n].id});return e},e.prototype.getRuneMergeNeedItems=function(t){if(!this._runeMergeNeedItems[t]){var e=DataCenter.ins().RuneComposeConfig[t],i={};for(var n in e.material){var o=e.material[n];if(void 0==i[o]){var s=DataCenter.ins().ItemConfig[o];i[o]={count:1,config:s,qua:ItemUtils.getQuality(s),subType:ItemUtils.getSubType(s)}}else i[o].count+=1}this._runeMergeNeedItems[t]=i}return this._runeMergeNeedItems[t]},e.prototype.isRuneCanMergeByID=function(t){var e=DataCenter.ins().RuneComposeConfig[t];if(e.count){var i=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().RuneOtherConfig.goldItemId);if(e.count>i)return!1}for(var n=this.getRuneMergeNeedItems(t),o={},s=backpackControl.getGoodsListByType(1,BackpackControl.BAG_TYPE_OTHTER),r=0;r<s.length;r++){var a=s[r],l=a.itemConfig;for(var h in n){var u=n[h];u.config.descIndex==l.descIndex&&l.id%100==1&&(o[h]=(o[h]||0)+(a.count||1))}}for(var h in n){var p=o[h]||0;if(n[h].count>p)return!1}return!0},e.prototype.isRuneCanMergeByType=function(t){var e=DataCenter.ins().RuneComposeConfig;for(var i in e)if(e[i].mixId[1]==t&&this.isRuneCanMergeByID(e[i].id))return!0;return!1},e.prototype.isRuneCanMerge=function(){var t=DataCenter.ins().RuneComposeConfig;for(var e in t)if(this.isRuneCanMergeByID(t[e].id))return!0;return!1},e.prototype.getRuneMergeByID=function(t){var e=DataCenter.ins().RuneComposeConfig;for(var i in e){var n=e[i];for(var o in n.material)if(n.material[o]==t)return n}return null},e.prototype.getIsMergeByID=function(t){var e=DataCenter.ins().ItemConfig[t],i=DataCenter.ins().RuneComposeConfig;for(var n in i){var o=DataCenter.ins().ItemConfig[n];if(ItemUtils.getSubType(e)==ItemUtils.getSubType(o))return!0}return!1},e.prototype.getMergeIndexByType=function(t,e){var i=DataCenter.ins().RuneComposeConfig,n=0;for(var o in i)if(i[o].mixId[1]==t){if(e==i[o].id)return n;n++}return n},e.prototype.isEquipMerge=function(t,e,i){var n=this.isMergeId(t),o=DataCenter.ins().RuneComposeConfig[n];if(!o)return!1;var s=(DataCenter.ins().ItemConfig[t],this.getRoleRune(e));if(!s)return!1;for(var r,a=this.getRune(e,i),l=s.length,h=0;l>h;h++){var u=s[h];if(r=DataCenter.ins().RuneBaseConfig[u.configID])for(var p=this.getIsEquipMerge(o.checkMaterial,n),c=0;c<p.length;c++){var d=DataCenter.ins().ItemConfig[p[c]];if(ItemUtils.getSubType(d)==ItemUtils.getSubType(u.itemConfig)&&a){if(a.configID<=0&&(this.getIsMergeByID(t)||this.getRoleIsHasMerge(p,e)))return!0;if(a.itemConfig){var g=this.getCurIsType(p,ItemUtils.getSubType(a.itemConfig));if(g&&(this.getIsMergeByID(t)||this.getRoleIsHasMerge(p,e)))return!0}}}}return!1},e.prototype.getRoleIsHasMerge=function(t,e){var i=this.getRoleRune(e);if(!i)return!1;for(var n,o=i.length,s=0;o>s;s++){var r=i[s];if(n=DataCenter.ins().RuneBaseConfig[r.configID],n&&this.getIsMergeByID(n.id))for(var a=0;a<t.length;a++){var l=DataCenter.ins().ItemConfig[t[a]];if(ItemUtils.getSubType(r.itemConfig)==ItemUtils.getSubType(l))return!0}}return!1},e.prototype.getCurIsType=function(t,e){for(var i=!0,n=0;n<t.length;n++){var o=DataCenter.ins().ItemConfig[t[n]];if(ItemUtils.getSubType(o)==e){i=!1;break}}return i},e.prototype.getIsEquipMerge=function(t,e){for(var i=[],n=0;n<t.length;n++)i.push(t[n]);return i.push(e),i},e.prototype.isMergeId=function(t){var e=t,i=DataCenter.ins().ItemConfig[t],n=DataCenter.ins().RuneComposeConfig;for(var o in n){var s=DataCenter.ins().ItemConfig[o];if(ItemUtils.getSubType(i)==ItemUtils.getSubType(s))return parseInt(o);for(var r in n[o].material){var a=DataCenter.ins().ItemConfig[n[o].material[r]];if(ItemUtils.getSubType(i)==ItemUtils.getSubType(a))return parseInt(o)}}return e},e.prototype.isCanEquip=function(t,e,i,n){var o=DataCenter.ins().ItemConfig[t],s=this.getRoleRune(e);if(!s)return!0;for(var r,a=s.length,l=0;a>l;l++){var h=s[l];if(r=DataCenter.ins().RuneBaseConfig[h.configID],r&&h.itemConfig){var u=DataCenter.ins().RuneComposeConfig[r.id];if(!u)continue;for(var p=u.checkMaterial,c=0;c<p.length;c++){var d=DataCenter.ins().ItemConfig[p[c]];if(ItemUtils.getSubType(d)==ItemUtils.getSubType(o)){if(0==i)return!1;var g=DataCenter.ins().ItemConfig[i];if(ItemUtils.getSubType(g)==ItemUtils.getSubType(o))return!1}}}}return!0},e.prototype.getMergeRune=function(t,e,i){var n=this.isMergeId(t),o=(DataCenter.ins().ItemConfig[t],DataCenter.ins().RuneComposeConfig[n]),s=[];if(!o)return null;var r=this.getRoleRune(e);if(!r)return null;for(var a,l=r.length,h=0;l>h;h++){var u=r[h];if(a=DataCenter.ins().RuneBaseConfig[u.configID])for(var p=this.getIsEquipMerge(o.checkMaterial,n),c=0;c<p.length;c++){var d=DataCenter.ins().ItemConfig[p[c]];if(ItemUtils.getSubType(d)==ItemUtils.getSubType(u.itemConfig)&&i&&i.configID!=a.id&&this.getIsMergeByID(t))return s=[LangMgr.getValueByKey("runTips13",DataCenter.ins().ItemConfig[o.id].name,DataCenter.ins().ItemConfig[a.id].name),""+h]}}return null},Object.defineProperty(e.prototype,"totalPower",{get:function(){for(var t=0,e=heroControl.subRolesLen,i=0;e>i;i++)t+=this.getSingleRoleRunePower(heroControl.getSubRoleByIndex(i),i);return t},enumerable:!0,configurable:!0}),e.prototype.getSingleRoleRunePower=function(t,e){var i=0;if(t&&t.runeDatas&&t.runeDatas.length){for(var n=t.runeDatas.length,o=[],s=0,r=0;n>r;r++){var a=t.runeDatas[r];if(a){var l=DataCenter.ins().RuneBaseConfig[a.configID];if(l){l.attr&&(o=o.concat(l.attr)),l.power&&(s+=l.power);var h=BackpackControl.getEquipAddAttrs(l.equipAttr,e);h&&(o=o.concat(h))}}}o=AttributeData.combineAtts(o),i+=s+BackpackControl.getAttrPower(o)}return i},e.prototype.getRuneName=function(t){var e=DataCenter.ins().RuneNameConfig[ItemUtils.getSubType(t)];return e.runeName2&&e.runeName2[t.descIndex]?e.runeName2[t.descIndex]:e.runeName},e.prototype.getcfgAttrData=function(t,e){if(void 0===e&&(e=!0),!t)return"";var i="";return i+=this.getAttrNamesByList(t.attr,0,e),i+=this.getAttrNamesByList(t.equipAttr,1,e),i+=this.getAttrNamesByList(t.exAttr,2,e),i+=this.getAttrNamesByList(t.specialAttr,3,e)},e.prototype.getAttrNamesByList=function(t,e,i){var n="";if(!t||t.length<=0)return"";switch(e){case 0:for(var o in t)t[o]&&(n+=i?AttributeData.getAttrStrByType(t[o].type)+"\n":"+"+t[o].value+"\n");break;case 1:for(var o in t)t[o]&&(n+=i?AttributeData.getEEquipAttrStrByType(t[o].type)+"\n":"+"+t[o].value+"%\n");break;case 2:for(var o in t)t[o]&&(n+=i?AttributeData.getExtAttrStrByType(t[o].type)+"\n":"+"+t[o].value+"\n");break;case 3:for(var o in t)t[o]&&(n+=i?(1==t[o].type?LangMgr.getValueByKey("charItemJB",""):LangMgr.getValueByKey("currency0"))+"\n":"+"+t[o].value+"%\n")}return n},e.prototype.getcfgAttrDesc=function(t,e){if(void 0===e&&(e=!1),!t)return"";var i="";return i+=this.getAttrDescByList(t.attr,0,e),i+=this.getAttrDescByList(t.equipAttr,1,e),i+=this.getAttrDescByList(t.exAttr,2,e),i+=this.getAttrDescByList(t.specialAttr,3,e),i.lastIndexOf("\n")==i.length-1&&(i=i.substring(0,i.length-1)),i},e.prototype.getAttrDescByList=function(t,e,i){void 0===i&&(i=!1);var n="";if(!t||t.length<=0)return"";switch(e){case 0:for(var o in t)t[o]&&(i?5==t[o].type||(n+=6==t[o].type?LangMgr.getValueByKey("runTips1",t[o].value):AttributeData.getAttrNameByAttrbute(t[o],!0," + ")+"\n"):n+=AttributeData.getAttrNameByAttrbute(t[o],!0," + ")+"\n");break;case 1:for(var o in t)t[o]&&(n+=AttributeData.getEEquipAttrStrByType(t[o].type)+"  +"+t[o].value+"%\n");break;case 2:for(var o in t)t[o]&&(n+=AttributeData.getExAttrNameByAttrbute(t[o],!0," + ")+"\n");break;case 3:for(var o in t)t[o]&&(n+=(1==t[o].type?LangMgr.getValueByKey("charItemJB",""):LangMgr.getValueByKey("currency0"))+"  +"+t[o].value+"%\n")}return n},e.prototype.getAttrByList=function(t,e,i){void 0===i&&(i=!1);var n="";if(!t||t.length<=0)return"";switch(e){case 0:for(var o in t)t[o]&&(n+=AttributeData.getAttrNameByAttrbute(t[o],!0,"：",!1,LangMgr.getColor("color27"))+"\n");break;case 1:for(var o in t)t[o]&&(n+=AttributeData.getEEquipAttrStrByType(t[o].type)+"：|C:"+LangMgr.getColor("color27")+"&T:"+t[o].value+"%\n");break;case 2:for(var o in t)t[o]&&(n+=AttributeData.getExAttrNameByAttrbute(t[o],!0,"：",LangMgr.getColor("color27"))+"\n");break;case 3:for(var o in t)t[o]&&(n+=(1==t[o].type?LangMgr.getValueByKey("charItemJB",""):LangMgr.getValueByKey("currency0"))+"：|C:"+LangMgr.getColor("color27")+"&T:"+t[o].value+"%\n")}return n},e.prototype.getExchangeDataList=function(){if(this.exchangeList.length>0)return this.exchangeList;var t=DataCenter.ins().RuneConverConfig;for(var e in t)this.exchangeList.push(t[e]);return this.exchangeList.sort(this.sortExchange),this.exchangeList},e.prototype.sortExchange=function(t,e){return t.checkpoint<e.checkpoint?-1:t.checkpoint>e.checkpoint?1:t.id-e.id},e.prototype.getRoleRune=function(t){var e=heroControl.getSubRoleByIndex(t);return e?e.runeDatas:null},e.prototype.getRune=function(t,e){var i=this.getRoleRune(t);return i?i[e]:null},e.prototype.replaceRune=function(t,e,i){var n=this.getRoleRune(t);n&&e>=0&&(n[e].configID=i)},e.prototype.getMinRune=function(t,e){void 0===e&&(e=!1);var i=this.getRoleRune(t);if(!i)return null;for(var n=[],o=0;o<i.length;o++)i[o].itemConfig&&n.push(i[o]);if(n.sort(function(t,e){if(t.itemConfig.id%100<e.itemConfig.id%100)return-1;if(t.itemConfig.id%100>e.itemConfig.id%100)return 1;var i=ItemUtils.getQuality(t.itemConfig),n=ItemUtils.getQuality(e.itemConfig);return i>n?-1:n>i?1:0}),e)for(var s=0,r=n;s<r.length;s++){var a=r[s];if(RuneRedPoint.ins().checkSingleUpgrade(a))return a}return n[0]},__decorate([up(1,[2,2,10])],e.prototype,"upInlay",null),__decorate([down(1,[2,2,2,3])],e.prototype,"downInlay",null),__decorate([up(2,[2,2])],e.prototype,"upUpgrade",null),__decorate([down(2,[0,2,2,3])],e.prototype,"downUpgrade",null),__decorate([up(3,[[3]])],e.prototype,"upOneKeyDecompose",null),__decorate([down(3,[0,3])],e.prototype,"downOneKeyDecompose",null),__decorate([up(4,[6])],e.prototype,"upExchangeRune",null),__decorate([up(5,[2])],e.prototype,"upHuntRune",null),__decorate([down(5,[4,[3,4]])],e.prototype,"downHuntRuneInfo",null),__decorate([down(6,[[8,3]])],e.prototype,"downBestListInfo",null),__decorate([up(7,[3])],e.prototype,"upRuneBoxGift",null),__decorate([down(8,[3,3,3])],e.prototype,"downRuneBoxGift",null),__decorate([up(9,[3])],e.prototype,"upRuneMerge",null),__decorate([down(10,[3,3])],e.prototype,"downDelRune",null),e=__decorate([protocolsId(50)],e)}(BaseSystem);__reflect(RuneControl.prototype,"RuneControl");var AmuseTarget102Panel1=function(t){function e(){var e=t.call(this)||this;return e._time=0,e.skinName="AmuseTarget102Panel1Skin",e}return __extends(e,t),e.prototype.open=function(){this.dailyReward.itemRenderer=AmuseTarget102ItemRender,this.currentState="2",this.addCustomEvent(183,this.initList),this.initList(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.updateTime=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.initList=function(){var t=DataCenter.ins().Amusement102Config[this.activityID];this._activityData=amusementControl.activityData[this.activityID];for(var e=this._activityData.getRecordInfo().reverse(),i=e.length-1;3>i;i++)e.push(0);var n=(CommonUtils.getObjectLength(t),e.indexOf(0)+1),o=[];for(var s in t){var r=t[s];r.has=1==e[Number(s)-1]?0:1,r.index=Number(s),r.buystate=n,r.activityID=this.activityID,1==e[Number(s)-1]?r.icond="newoneBuy_hs_png":r.icond="newoneBuy_anniu"+s+"_png",o.push(r)}this.dailyReward.dataProvider=new eui.ArrayCollection(o),this.updateTime()},e.prototype.updateData=function(){this.initList()},e.prototype.sort=function(t,e){var i=payControl.getRechargeData(0),n=i.isAwards>>t.index&1,o=i.isAwards>>e.index&1;return n&&!o?1:!n&&o?-1:t.pay<e.pay?-1:1},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e}(BasePanel);__reflect(AmuseTarget102Panel1.prototype,"AmuseTarget102Panel1");var RuneAllVo=function(){function t(t,e){this.data=t,this.title=e,this.data&&(this._itemConfig=DataCenter.ins().ItemConfig[this.data.id])}return t.prototype.getItemConfig=function(){return this._itemConfig},t}();__reflect(RuneAllVo.prototype,"RuneAllVo");var WeaponsSoulInfoVo=function(){function t(){this.id=0,this.level=0,this.costItem=0,this.costNum=0,this.showlv=0,this.assault=0,this.icon="",this.name="",this.attr=[],this.ex_attr=[]}return t.prototype.setInfo=function(t,e){if(t>0&&e>0){var i=DataCenter.ins().WeaponSoulPosConfig[t][e];if(!i)return;this.id=i.id,this.level=i.level,this.costItem=i.costItem,this.costNum=i.costNum,this.showlv=i.showlv,this.assault=i.assault,this.icon=i.icon,this.name=i.name,this.attr=i.attr,this.ex_attr=i.ex_attr}},t}();__reflect(WeaponsSoulInfoVo.prototype,"WeaponsSoulInfoVo");var RuneChangeVo=function(){function t(t){this.data=t}return t}();__reflect(RuneChangeVo.prototype,"RuneChangeVo");var RuneResolveVo=function(){function t(){this.itemData=null,this.isSelected=!1}return t}();__reflect(RuneResolveVo.prototype,"RuneResolveVo");var RuneAllView=function(t){function e(){var e=t.call(this)||this;return e.dataCollection=null,e.skinName="RuneAllViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){this.nuneList.itemRenderer=RuneAllItemRenderer,t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventItemTap(this.nuneList,this.onListTap),this.showList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cleanList(),this.removeEventItemTap(this.nuneList,this.onListTap)},e.prototype.onListTap=function(t){var e=t.item;if(e&&e.data)for(var i=t.item,n=6;n>0&&i;){if(i.getItemConfig){var o=i.getItemConfig();UIMgr.ins().open(RuneItemTipsView,e.data,o);break}i=i.parent,n-=1}},e.prototype.showList=function(){if(!this.dataCollection){var t=[];t.push(new RuneAllVo(null,LangMgr.getValueByKey("runTips4")));var e=runeControl.getExchangeDataList();for(var i in e)t.push(new RuneAllVo(e[i]));this.dataCollection=new eui.ArrayCollection(t)}this.nuneList.dataProvider=this.dataCollection},e.prototype.cleanList=function(){this.dataCollection&&(this.dataCollection=null),this.nuneList.dataProvider=null},e}(BaseEuiView);__reflect(RuneAllView.prototype,"RuneAllView");var RuneAttrView=function(t){function e(){var e=t.call(this)||this;return e.curRole=0,e._lastX=0,e.proShowList=null,e.skinName="RuneAttrViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.setAttrList=function(){this.proShowList=[];var t=heroControl.getSubRoleByIndex(this.curRole),e=t.runeDatas,i=DataCenter.ins().RuneBaseConfig;if(i)for(var n in e){var o=e[n];if(o.configID){var s=i[o.configID];s&&this.setProShowList(s)}}},e.prototype.setProShowList=function(t){this.checkIsRepeat(t.attr,0),this.checkIsRepeat(t.equipAttr,1),this.checkIsRepeat(t.exAttr,2),this.checkIsRepeat(t.specialAttr,3)},e.prototype.checkIsRepeat=function(t,e){this.proShowList[e]||(this.proShowList[e]=[]);var i=this.proShowList[e];if(t){var n=!1;for(var o in t){var s=CommonUtils.copyDataHandler(t[o]);n=!1;for(var r in i)i[r].type==s.type&&(i[r].value=i[r].value+s.value,n=!0);n||i.push(s)}}},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=isNaN(t[0])?0:t[0],this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.closeBtn,this.onClose),this.addEventTouchEnd(this.bg,this.onMove),this.addEventTouchEnd(this,this.otherClose),this.setAttrList(),this.setAttrs(),this.setBtns()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().removeAll(this)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.leftBtn:this.curRole--,this.setAttrList(),this.setAttrs(),this.setBtns();break;case this.rightBtn:this.curRole++,this.setAttrList(),this.setAttrs(),this.setBtns()}},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<3&&(this.curRole++,this.setAttrList(),this.setAttrs(),this.setBtns()):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setAttrList(),this.setAttrs(),this.setBtns())}},e.prototype.setAttrs=function(){var t=heroControl.getSubRoleByIndex(this.curRole);if(t){this.job.source="op_"+t.job;for(var e="",i=this.imgGroup.numChildren-1;i>=0;i--){var n=this.imgGroup.getChildAt(i);DisplayUtils.removeFromParent(n),n=null}for(var o=0,s=0;s<this.proShowList.length;s++){var r=this.proShowList[s];e+=runeControl.getAttrByList(r,s);for(var a in r){var l=new eui.Image;l.source="tongyongdian2",l.x=-3,l.y=28*o,this.imgGroup.addChild(l),o++}}e.length<=0&&(e=LangMgr.getValueByKey("runTips2")),this.attr.textFlow=TextUtils.generateTextFlow(e),this.mainGroup.height=this.attr.height+190}},e.prototype.setBtns=function(){var t=heroControl.subRolesLen;1==t?(this.leftBtn.visible=!1,this.rightBtn.visible=!1):t>1&&(0==this.curRole?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):1==this.curRole?(this.leftBtn.visible=!0,this.rightBtn.visible=t>=3):2==this.curRole&&(this.leftBtn.visible=!0,this.rightBtn.visible=!1))},e}(BaseEuiView);__reflect(RuneAttrView.prototype,"RuneAttrView");var RuneChangeView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.posIndex=0,e.roleIndex=0,e.item=null,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RuneChangeViewSkin",this.isTopLevel=!0,this.list.itemRenderer=RuneChangeItemRenderer,this.myItem=new RuneChangeItemRenderer,this.itemGroup.addChild(this.myItem)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.posIndex=isNaN(t[0])?0:t[0],this.roleIndex=isNaN(t[1])?0:t[1],this.item=t[2],this.runeTypeList=t[3],runeControl.posIsWear=this.item,this.myItem.data=new RuneChangeVo(this.item),this.myItem.setBtnStatu(),this.addEventTouchTap(this.list,this.onListTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addCustomEvent(124,this.onInlayResult),this.updateList()},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.fgClose:UIMgr.ins().close(this)}},e.prototype.onListTap=function(t){var e=this;if("changeBtn"!=t.target.name)return void("getBtn"==t.target.name&&UIMgr.ins().open(CopyView,2));var i=null,n=this.list.selectedItem;n&&(i=n.data);var o=!1;if(i&&i instanceof ItemData){var s=DataCenter.ins().ItemConfig[i.configID],r=runeControl.getRune(this.roleIndex,this.posIndex);
if(r){var a=null;if(r.configID>0&&(a=DataCenter.ins().RuneBaseConfig[r.configID]),!a||!r.itemConfig||ItemUtils.getSubType(s)!=ItemUtils.getSubType(r.itemConfig)){var l=runeControl.getRoleRune(this.roleIndex);if(l)for(var h=null,u=0,p=l;u<p.length;u++){var c=p[u];if(c&&c.itemConfig&&c.itemConfig.id>0&&(h=DataCenter.ins().ItemConfig[c.configID],h&&ItemUtils.getSubType(h)==ItemUtils.getSubType(s))){o=!0;break}}}}if(o||!runeControl.isCanEquip(i.configID,this.roleIndex,this.myItem.getItemId(),this.posIndex))return void tipsControl.showTips(LangMgr.getValueByKey("runTips12"));var d=runeControl.getMergeRune(i.configID,this.roleIndex,this.item);if(d)return void warnControl.show(d[0],function(){runeControl.upInlay(e.roleIndex,e.posIndex,i.handle)},this);runeControl.upInlay(this.roleIndex,this.posIndex,i.handle)}},e.prototype.updateList=function(){var t=backpackControl.getBagGoodsByType(6);if(t){for(var e=[],i=[],n=this.item&&this.item.itemConfig?ItemUtils.getSubType(this.item.itemConfig):-1,o=0,s=t;o<s.length;o++){var r=s[o];if(r&&DataCenter.ins().RuneBaseConfig[r.configID]){var a=ItemUtils.getSubType(r.itemConfig);n==a||this.runeTypeList.indexOf(a)<0?(-1>=n||this.item.configID!=r.configID)&&(runeControl.isEquipMerge(r.configID,this.roleIndex,this.posIndex)?i.push(r):e.push(r)):i.push(r)}}e.sort(this.sortRunes),i.sort(this.sortRunes);var l=[].concat(e,i),h=new ItemData;l.push(h);for(var u=[],p=0;p<l.length;p++){var c=new RuneChangeVo(l[p]);c.canEquip=!1,p<e.length&&(c.canEquip=!0),u.push(c)}this.list.dataProvider=new eui.ArrayCollection(u)}},e.prototype.sortRunes=function(t,e){var i=ItemUtils.getQuality(t.itemConfig),n=ItemUtils.getQuality(e.itemConfig);if(i>n)return-1;if(n>i)return 1;var o=DataCenter.ins().RuneBaseConfig[t.configID],s=DataCenter.ins().RuneBaseConfig[e.configID];if(o&&s){var r=o.id%100,a=s.id%100;if(r>a)return-1;if(a>r)return 1}return t.configID-e.configID},e.prototype.onInlayResult=function(t){t[0]&&UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().removeAll(this),this.list.dataProvider=null},e}(BaseEuiView);__reflect(RuneChangeView.prototype,"RuneChangeView");var RuneExchangePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._scrollV=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.menulist0.itemRenderer=RuneExchangeItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(469,this.updateList),this.addEventTouchTap(this.menulist0,this.onListTap),this.updateList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents();for(var i=0;i<this.menulist0.numElements;i++){var n=this.menulist0.getVirtualElementAt(i);n.close()}},e.prototype.updateList=function(){var t=runeControl.getExchangeDataList();this.menulist0.dataProvider=new eui.ArrayCollection(t);var e=this.menulist0.parent;e.validateNow(),e.stopAnimation(),this.menulist0.scrollV=this._scrollV},e.prototype.onListTap=function(t){if("goBtn"==t.target.name){var e=this.menulist0.selectedItem;if(!e||e&&e.conversion>ActorControl.runeExchange)return warnControl.setBuyGoodsWarn(500008,e.conversion-ActorControl.runeExchange),void tipsControl.showTips(LangMgr.getValueByKey("zhuzaiPropEnought"));if(!(copyBabelControl.lastPass||copyBabelControl.curLevel>=e.checkpoint))return void tipsControl.showTips(LangMgr.getValueByKey("runTips10"));runeControl.upExchangeRune(e.id),this._scrollV=this.menulist0.scrollV}},e}(BasePanel);__reflect(RuneExchangePanel.prototype,"RuneExchangePanel");var RuneItemTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RuneItemTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){this.gainList.itemRendererSkinName="RingGainItemSkin",this.gainList.itemRenderer=GainGoodsNoSkinItem,t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.addEventItemTap(this.gainList,this.onTouchList),this.setData(t[0],t[1])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventItemTap(this.gainList,this.onTouchList),this.resetView()},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&(GuideControl.guidance(e[1],e[2]),UIMgr.ins().close(this))}},e.prototype.setData=function(t,e){if(e){this.nameLabel.textFlow=(new egret.HtmlTextParser).parser("<font color = '"+ItemUtils.getQualityColor(e)+"'>"+e.name+"Lv."+(e.level||1)+"</font>"),this.itemIcon.setData(e);var i=DataCenter.ins().RuneBaseConfig[e.id];this.attrName.text=runeControl.getcfgAttrData(i),this.attrValue.text=runeControl.getcfgAttrData(i,!1),0==t.checkpoint?this.attrDes.text=LangMgr.getValueByKey("runTips4"):this.attrDes.text=LangMgr.getValueByKey("runTips3",DataCenter.ins().BabelLotteryNameConfig[Math.round(t.checkpoint/10)].name);var n=DataCenter.ins().PropsGainConfig[e.id],o=0;n?(this.gainList.dataProvider=new eui.ArrayCollection(n.gainWay),o=60*n.gainWay.length):this.gainList.dataProvider=new eui.ArrayCollection([])}else this.resetView()},e.prototype.resetView=function(){this.nameLabel.text="",this.itemIcon.setData(null)},e}(BaseEuiView);__reflect(RuneItemTipsView.prototype,"RuneItemTipsView");var RunePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runeList=null,e.curRole=0,e.selectedIndex=0,e.upgradeDifference=0,e.selectItem=null,e.openNum=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.initRunes()},e.prototype.initRunes=function(){this.runeList=[];for(var t=8,e=null,i=0;t>i;i++)e=this["rune"+i],e&&this.runeList.push(e)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.runeList.length;this.selectedIndex=isNaN(t[1])?this.selectedIndex:t[1],this.selectedIndex<0&&(this.selectedIndex=0),this.selectedIndex>=i&&(this.selectedIndex=i-1),this.addEventTouchTap(this.replace,this.onTap),this.addEventTouchTap(this.uplevel,this.onTap),this.addEventTouchTap(this.runeBook,this.onTap),this.addEventTouchTap(this.bookBtn,this.onTap),this.addEventTouchTap(this.btn1,this.onTap),this.addEventTouchTap(this.btn2,this.onTap),this.addCustomEvent(124,this.onInlayResult),this.addCustomEvent(125,this.onUpgradeResult),this.addCustomEvent(112,this.onLevelUp),this.addCustomEvent(463,this.onLevelUp),this.addCustomEvent(468,this.onShatterChange),this.addCustomEvent(266,this.onItemChange),this.addCustomEvent(268,this.onItemChange),this.addCustomEvent(267,this.onItemChange),this.addCustomEvent(129,this.onLevelUp),this.updateRunes(!0);for(var n=null,o=0;i>o;o++)n=this.runeList[o],n.init(),n&&n.currentState==RuneItemRenderer.SKIN_STATE_UNLOCK?(this.addEventTouchTap(n,this.onRuneTap),this["linebg"+o]&&(this["linebg"+o].source="zwfwline2")):this["linebg"+o]&&(this["linebg"+o].source="zwfwline1");this.updateRuneDetail(),this.updateSelectedEffect(),this.showRuneRedPoint(),this.setNextOpenInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.replace,this.onTap),this.removeEventTouchTap(this.uplevel,this.onTap),this.removeEventTouchTap(this.runeBook,this.onTap),this.removeEventTouchTap(this.bookBtn,this.onTap),this.removeEventTouchTap(this.btn1,this.onTap),this.removeEventTouchTap(this.btn2,this.onTap),this.removeCustomEvents();for(var i=null,n=this.runeList.length,o=0;n>o;o++)i=this.runeList[o],i.close()},e.prototype.setNextOpenInfo=function(){var t=DataCenter.ins().RuneLockPosConfig[this.openNum];t?this.levelsay.text=LangMgr.getValueByKey("runTips14",t.lockLv):this.levelsay.text=""},e.prototype.onLevelUp=function(){this.updateRunes(),this.updateRuneDetail(),this.showRuneRedPoint(),this.showReplaceRedPoint()},e.prototype.onUpgradeResult=function(t){if(t[0]){tipsControl.showTips(LangMgr.getValueByKey("runTips15"));var e=t[1];this.curRole=e,this.updateRunes(),this.updateRuneDetail(),this.showRuneRedPoint(),this.showReplaceRedPoint()}else tipsControl.showTips(LangMgr.getValueByKey("runTips16"))},e.prototype.onInlayResult=function(t){if(t[0]){tipsControl.showTips(LangMgr.getValueByKey("runTips17"));var e=t[1],i=t[2],n=t[3];runeControl.replaceRune(e,i,n),this.curRole=e,this.updateRunes(),this.updateRuneDetail(),this.showRuneRedPoint(),this.showReplaceRedPoint()}else tipsControl.showTips(LangMgr.getValueByKey("runTips16"))},e.prototype.onShatterChange=function(){this.updateRuneDetail(),this.showRuneRedPoint()},e.prototype.onItemChange=function(){this.showRuneRedPoint(),this.showReplaceRedPoint()},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.replace:this.showReplaceWin();break;case this.uplevel:this.upgradeRune();break;case this.runeBook:UIMgr.ins().open(RuneAttrView,this.curRole);break;case this.bookBtn:UIMgr.ins().open(RuneAllView);break;case this.btn1:UIMgr.ins().open(TreasureHuntView,1);break;case this.btn2:UIMgr.ins().open(CopyView,2)}},e.prototype.upgradeRune=function(){var t=this.getRuneDisplay(this.selectedIndex);if(t)switch(t.currentState){case RuneItemRenderer.SKIN_STATE_LOCK:case RuneItemRenderer.SKIN_STATE_READY:tipsControl.showTips(LangMgr.getValueByKey("runTips18"));break;case RuneItemRenderer.SKIN_STATE_UNLOCK:var e=this.getCurIC();if(e){var i=DataCenter.ins().ItemConfig[e.id+1];i?this.upgradeDifference<=0?runeControl.upUpgrade(this.curRole,this.selectedIndex):tipsControl.showTips(LangMgr.getValueByKey("runTips20")):tipsControl.showTips(LangMgr.getValueByKey("runTips19"))}else tipsControl.showTips(LangMgr.getValueByKey("runTips21"))}},e.prototype.showReplaceWin=function(){var t=this.getRuneDisplay(this.selectedIndex);if(t)switch(t.currentState){case RuneItemRenderer.SKIN_STATE_LOCK:case RuneItemRenderer.SKIN_STATE_READY:tipsControl.showTips(LangMgr.getValueByKey("runTips18"));break;case RuneItemRenderer.SKIN_STATE_UNLOCK:UIMgr.ins().open(RuneChangeView,this.selectedIndex,this.curRole,t.data,this.runeTypeList)}},e.prototype.onRuneTap=function(t){if(t&&t.currentTarget){var e=t.currentTarget;if(this.selectedIndex=e.pos,this.updateRuneDetail(),this.updateSelectedEffect(),this.showReplaceRedPoint(),e.currentState==RuneItemRenderer.SKIN_STATE_UNLOCK){var i=runeControl.getRune(this.curRole,this.selectedIndex);i&&i.configID<=0&&UIMgr.ins().open(RuneChangeView,this.selectedIndex,this.curRole,e.data,this.runeTypeList)}}},e.prototype.updateSelectedEffect=function(){if(this.runeList)for(var t=0,e=this.runeList;t<e.length;t++){var i=e[t];i&&i.showOrHideSelected(i.pos==this.selectedIndex)}},e.prototype.showLink=function(){this.linkGroup.visible=!1;var t=runeControl.getRoleRune(this.curRole);if(t){for(var e,i=!0,n=this.runeList.length,o=0;n>o;o++){var s=t[o];if(e=DataCenter.ins().RuneBaseConfig[s.configID]){i=!1;break}}this.linkGroup.visible=i}},e.prototype.updateRunes=function(t){var e=runeControl.getRoleRune(this.curRole);if(e){this.openNum=0,this.runeTypeList=[];var i=0,n=null,o=null,s=null,r=this.runeList.length,a=0;this.runeBook.visible=!1;for(var l=0;r>l;l++)n=e[l],o=DataCenter.ins().RuneBaseConfig[n.configID],o&&(a+=BackpackControl.getAttrPower(o.attr)+(o.power||0)),s=this.runeList[l],n.configID&&n.itemConfig&&this.runeTypeList.push(ItemUtils.getSubType(n.itemConfig)),s&&(s.setPos(l),n&&n.itemConfig&&n.itemConfig.id>0?(s.setData(n),this.runeBook.visible=!0):s.cleanData(),s.currentState==RuneItemRenderer.SKIN_STATE_UNLOCK&&(this.openNum+=1),s.currentState==RuneItemRenderer.SKIN_STATE_LOCK?(i+=1,1==i?s.setLockTF(!0):s.setLockTF(!1)):s.setLockTF(!1));this.powerPanel.setPower(a),t&&this.setSelectedIndexRule(this.curRole),this.showLink()}},e.prototype.updateRuneDetail=function(){var t=runeControl.getRune(this.curRole,this.selectedIndex);if(this.selectItem=t,t&&t.configID>0){this.rune8.showName(!1),this.rune8.setData(t);var e=DataCenter.ins().ItemConfig[t.itemConfig.id],i=DataCenter.ins().RuneNameConfig[ItemUtils.getSubType(e)];this.nuneName.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(e)+"&T:"+i.runeName+"Lv."+e.id%100);var n=DataCenter.ins().RuneBaseConfig[t.configID],o=this.getCurIC();if(!o||!n)return;this.up.visible=!0,this.showReplaceRedPoint();var s=null;s=DataCenter.ins().RuneBaseConfig[t.configID+1],s?(this.attrDesc.text=runeControl.getcfgAttrDesc(s),this.setCost(n),this.costImg.visible=!0,this.cost.x=328,this.arrow.visible=!0):(this.attrDesc.text="",this.costImg.visible=!1,this.arrow.visible=!1,this.cost.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("guildTips25Max")),this.cost.x=310),this.addAttr.text=runeControl.getcfgAttrDesc(n)}else this.up.visible=!1},e.prototype.setCost=function(t){if(t){var e=t.expend,i=ActorControl.runeShatter;this.upgradeDifference=e-i,this.upgradeDifference<0&&(this.upgradeDifference=0);var n="";n=i>=e?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.cost.textFlow=TextUtils.generateTextFlow("<font color="+n+">"+i+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+e+"</font> ")}},e.prototype.getRuneDisplay=function(t){return this.runeList?this.runeList[t]:null},e.prototype.getCurIC=function(){var t=runeControl.getRune(this.curRole,this.selectedIndex);return t&&t.configID>0?DataCenter.ins().ItemConfig[t.configID]:null},e.prototype.showRuneRedPoint=function(){for(var t=!1,e=null,i=0,n=this.runeList;i<n.length;i++){var o=n[i];o&&(t=RuneRedPoint.ins().checkSingleInlay(this.curRole,o.pos),t||(e=o.data,e&&e instanceof ItemData&&e.configID>0&&(t=RuneRedPoint.ins().checkSingleUpgrade(e))),o.redPoint.visible=t)}},e.prototype.showReplaceRedPoint=function(){var t=runeControl.getRune(this.curRole,this.selectedIndex);t&&t.configID>0?(this.redPointReplace.visible=!1,this.upRed&&(this.upRed.visible=RuneRedPoint.ins().checkSingleUpgrade(t))):(this.redPointReplace.visible=!1,this.upRed&&(this.upRed.visible=!1))},e.prototype.setSelectedIndexRule=function(t){var e=runeControl.getMinRune(t,!0);if(e)for(var i=0;i<this.runeList.length;i++)if(this.runeList[i].getItemConfig()&&this.runeList[i].getItemConfig().id==e.configID){this.selectedIndex=this.runeList[i].pos;break}},e}(BasePanel);__reflect(RunePanel.prototype,"RunePanel");var RuneResolvePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cardList=null,e.cardCollection=null,e.checkBoxNum=5,e.itemListScrollV=0,e.resolveIng=!1,e._addNum=0,e._chipNum=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemList.itemRenderer=RuneResolveItemRenderer,this.itemList.useVirtualLayout=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.checkBoxNum;i++)this["cb"+i]&&this.addEventTouchTap(this["cb"+i],this.onCBTap);this.addEventTouchTap(this.decomposeBtn,this.onTap),this.addEventTouchTap(this.itemList,this.onListTap),this.addCustomEvent(468,this.onShatterChange),this.addCustomEvent(469,this.onShatterChange),this.addCustomEvent(126,this.onDecomposeResult),this.initCardList(),this.resetCheckBox(),this.updateShatter()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.cleanCardList()},e.prototype.onDecomposeResult=function(t){var e=this;if(t[0]){var i=t[1],n=t[2],o="",s=0;i>0?(o=LangMgr.getValueByKey("normal"),s=i):n>0&&(o=LangMgr.getValueByKey("specal"),s=n),this._addNum&&tipsControl.showTips(LangMgr.getValueByKey("runTips5",this._addNum)),this._chipNum&&tipsControl.showTips(LangMgr.getValueByKey("runTips5",this._chipNum)),this.playEffect(),TimerMgr.ins().doTimer(500,1,function(){e.initCardList(),e.updateShatter(),e.updateAddShatter(),e.resolveIng=!1},this)}else tipsControl.showTips(LangMgr.getValueByKey("happyTips1"))},e.prototype.playEffect=function(){for(var t=this.itemList.numChildren,e=0;t>e;e++){var i=this.itemList.getChildAt(e);i&&i.playEffect()}},e.prototype.onShatterChange=function(){this.updateShatter()},e.prototype.onListTap=function(t){if(t&&t.currentTarget){var e=this.itemList.selectedIndex;if(0>e)return;var i=this.itemList.getVirtualElementAt(e);if(i&&i.cb){var n=i.data;n&&(n.isSelected=!n.isSelected,this.cardCollection.itemUpdated(n))}this.itemList.selectedIndex=-1,this.updateAddShatter()}},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.decomposeBtn:this.decomposeRune()}},e.prototype.decomposeRune=function(){var t=this;if(!this.resolveIng){if(this.cardList&&this.cardList.length>0){for(var e=!1,i=null,n=null,o=[],s=0,r=this.cardList;s<r.length;s++){var a=r[s];a&&a.isSelected&&a.itemData&&a.itemData.itemConfig&&(o.push(a.itemData),i=DataCenter.ins().RuneBaseConfig[a.itemData.configID],n=a.itemData.itemConfig,ItemUtils.getQuality(n)>=DataCenter.ins().RuneOtherConfig.maxQuality&&(e=!0))}if(e){var l="",h="",u="";e&&(h="<font color = '"+LangMgr.getColor("qualityColor"+DataCenter.ins().RuneOtherConfig.maxQuality)+"' size = '22'>"+LangMgr.getValueByKey("dingjizhanwen")+"</font>");var p=l+u+h,c=LangMgr.getValueByKey("runTips7",p);return void warnControl.show(c,function(){t.resolveIng=!0,runeControl.upOneKeyDecompose(o)},this)}if(o.length>0)return this.resolveIng=!0,void runeControl.upOneKeyDecompose(o)}tipsControl.showTips(LangMgr.getValueByKey("runTips8"))}},e.prototype.onCBTap=function(t){if(t&&t.currentTarget){var e=t.currentTarget;if(e&&e instanceof eui.CheckBox)for(var i=null,n=0;n<this.checkBoxNum;n++)if(i=this["cb"+n],i&&i===e)return void this.setQualitySelected(n+1,e.selected)}},e.prototype.updateShatter=function(){var t=ActorControl.runeShatter;this.curLab.text=t.toString();var e=ActorControl.runeExchange;this.suipianNow.text=e.toString(),this.materialLab.text=""+backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,200332)},e.prototype.updateAddShatter=function(){var t=0,e=0,i=0,n=null;DataCenter.ins().ItemConfig[DataCenter.ins().RuneOtherConfig.goldItemId].name;if(this.cardList&&this.cardList.length>0)for(var o=0,s=this.cardList;o<s.length;o++){var r=s[o];if(r&&r.isSelected&&r.itemData&&r.itemData.itemConfig&&(n=DataCenter.ins().RuneBaseConfig[r.itemData.configID])){t+=n.gain,n.chip&&(e+=n.chip);var a=DataCenter.ins().RuneBaseConfig[n.id];a&&(i+=a.goldCount)}}this._addNum=t,this._chipNum=e,this.addLab.text=t>0?"+"+t+"  ":"",this.suipianAdd.text=e?"+"+e:"",this.materialLab.text=""+backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,200332),this.addMaterialLab.text=i>0?"  +"+i:""},e.prototype.setQualitySelected=function(t,e){if(0>t)for(var i=0,n=this.cardList;i<n.length;i++){var o=n[i];o.itemData&&o.itemData.itemConfig&&(o.isSelected=!1)}else for(var s=0,r=this.cardList;s<r.length;s++){var o=r[s];o.itemData&&o.itemData.itemConfig&&ItemUtils.getQuality(o.itemData.itemConfig)==t&&(o.isSelected=e)}for(var a=this.cardCollection.length,l=0;a>l;l++)this.cardCollection.itemUpdated(this.cardList[l]);this.updateAddShatter()},e.prototype.getCheckBoxSelected=function(t){var e=this["cb"+(t-1)];return e?e.selected:!1},e.prototype.resetCheckBox=function(t){void 0===t&&(t=1);for(var e=null,i=0;i<this.checkBoxNum;i++)e=this["cb"+i],e&&e instanceof eui.CheckBox&&(e.selected=i+1==t);this.setQualitySelected(t,!0)},e.prototype.initCardList=function(){this.cleanCardList(),this.cardList=[];var t=backpackControl.getBagGoodsByType(6);if(t&&t.length>0){for(var e=null,i=0,n=t;i<n.length;i++)for(var o=n[i],s=0;s<o.count;s++)e=new RuneResolveVo,e.itemData=o,this.cardList.push(e);this.cardList.sort(this.sortList)}this.cardCollection=new eui.ArrayCollection(this.cardList),this.itemList.dataProvider=this.cardCollection},e.prototype.cleanCardList=function(){this.cardList=null,this.cardCollection=null,this.itemList.dataProvider=null},e.prototype.sortList=function(t,e){var i=ItemUtils.getQuality(t.itemData.itemConfig),n=ItemUtils.getQuality(e.itemData.itemConfig);if(i>n)return-1;if(n>i)return 1;var o=DataCenter.ins().RuneBaseConfig[t.itemData.configID],s=DataCenter.ins().RuneBaseConfig[e.itemData.configID];if(o&&s){var r=o.id%100,a=s.id%100;if(r>a)return-1;if(a>r)return 1}return t.itemData.configID-e.itemData.configID},e}(BasePanel);__reflect(RuneResolvePanel.prototype,"RuneResolvePanel");var RuneView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="RuneViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t&&t[0]?t[0]:0,n=t&&t[1]?t[1]:0;this.roleSelect.setCurRole(i),this.switchTab(n),this.addEventChange(this.roleSelect,this.onChange),this.addEventChange(this.tab,this.onTabTouch),this.addEventTouchEnd(this.closeBtn,this.onClick),this.addCustomEvent(469,this.refushRedPoint),this.addCustomEvent(468,this.refushRedPoint),this.addCustomEvent(271,this.refushRedPoint),this.addCustomEvent(124,this.refushRedPoint),this.addCustomEvent(125,this.refushRedPoint),this.setRoleId(this.roleSelect.getCurRole()),this.refushRedPoint()},e.prototype.onClick=function(t){UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),UIMgr.ins().close(RuneAllView),this.runePanel.close(),this.decomPanel.close(),this.removeEventTouchTap(this.closeBtn,this.onClick)},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole()),this.refushRedPoint()},e.prototype.switchTab=function(t){this.viewStack.selectedIndex=t,this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.onTabTouch=function(t){this.setOpenIndex(this.tab.selectedIndex)},e.prototype.setRoleId=function(t){this.runePanel.curRole=this.decomPanel.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.runePanel.open();break;case 1:this.decomPanel.open()}},e.prototype.refushRedPoint=function(){this.redPoint1.visible=RuneRedPoint.ins().checkAllSituation(!1);for(var t=heroControl.subRolesLen,e=0;t>e;e++){var i=RuneRedPoint.ins().checkRoleAllSituation(e);this.roleSelect.showRedPoint(e,i)}},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().RuneOtherConfig.zsLevel;return ActorControl.level<i?(tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",i)),!1):!0},e}(BaseEuiView);__reflect(RuneView.prototype,"RuneView");var RuneAllItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.keys=["red","orange","purple","green","white"],e.skinName="RuneAllItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t.title)this.currentState="title",this.lbName.text=t.title;else{var e=t.data;if(e){if(0==e.checkpoint)this.currentState="rune";else{this.currentState="nune_lock";var i=DataCenter.ins().BabelLotteryConfig[e.checkpoint];this.lbName.text=LangMgr.getValueByKey("runTips3",DataCenter.ins().BabelLotteryNameConfig[i.group].name)}for(var n=e.id,o=0;o<this.keys.length;o++){var s=n-100*o,r=this[this.keys[o]];r.setDataByItemConfig(DataCenter.ins().ItemConfig[s])}}}},e}(BaseItemRender);__reflect(RuneAllItemRenderer.prototype,"RuneAllItemRenderer");var RuneChangeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="RuneChangeItemRendererSkin",e.changeBtn.name="changeBtn",e.changeBtn0.name="changeBtn",e.getBtn.name="getBtn",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=t.data;if(this.currentState="all",this.validateNow(),e&&e instanceof ItemData)if(e.configID){var i=DataCenter.ins().RuneBaseConfig[e.configID];if(i){this.itemIcon.showName(!1),this.itemIcon.setData(e);var n=DataCenter.ins().ItemConfig[e.itemConfig.id],o=runeControl.getRuneName(n);if(this.runeName.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(n)+"&T:"+o+"Lv."+n.id%100),this.back.text=LangMgr.getValueByKey("runTips11",i.gain),this.attr.text=runeControl.getcfgAttrDesc(i),this.changeBtn.visible=t.canEquip&&runeControl.posIsWear,this.changeBtn0.visible=t.canEquip&&!runeControl.posIsWear,this.now.visible=!t.canEquip&&runeControl.posIsWear&&runeControl.posIsWear.configID==e.configID,this.already.visible=!t.canEquip&&runeControl.posIsWear!=e,!this.already.visible){var s=UIMgr.ins().getView(RuneChangeView);s&&(this.already.visible=runeControl.isEquipMerge(e.configID,s.roleIndex,s.posIndex),this.changeBtn.visible=this.changeBtn0.visible=!this.already.visible)}}else this.resetView()}else this.setBtnStatu(),this.resetView();else this.resetView()},e.prototype.setBtnStatu=function(){null==this.data||null==this.data.data?(this.currentState="dis",this.itemIcon.currentState="emp"):this.data.data.configID?(this.currentState="all",this.changeBtn.visible=!1,this.changeBtn0.visible=!1,this.now.visible=!0,this.already.visible=!1):this.currentState="get"},e.prototype.getItemId=function(){return this.data&&this.data.data?this.data.data.configID:0},e.prototype.resetView=function(){this.itemIcon.setData(null),this.nameLab.text="",this.attr.text=""},e}(BaseItemRender);__reflect(RuneChangeItemRenderer.prototype,"RuneChangeItemRenderer");var RuneExchangeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.skinName="RuneExchangeItemRendererSkin",e.goBtn.name="goBtn",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){var e=DataCenter.ins().ItemConfig[t.id];this.icon.setDataByItemConfig(e);var i=DataCenter.ins().RuneBaseConfig[e.id];this.descLab.text=runeControl.getcfgAttrDesc(i);var n=DataCenter.ins().BabelLotteryConfig[t.checkpoint];n?this.descLab1.text=LangMgr.getValueByKey("runTips3",DataCenter.ins().BabelLotteryNameConfig[n.group].name):this.descLab1.text=LangMgr.getValueByKey("runTips4");var o="";o=ActorControl.runeExchange>=t.conversion?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.nameLab0.textFlow=TextUtils.generateTextFlow("<font color="+o+">"+ActorControl.runeExchange+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+t.conversion+"</font> "),this.setEff(e)}else this.retView()},e.prototype.setEff=function(t){var e=ItemUtils.getQuality(t);5==e&&(this.equipEffect=this.equipEffect||new GameMovieClip,this.equipEffect.touchEnabled=!1,this.equipEffect.parent||this.addChild(this.equipEffect),this.equipEffect.playFile(PATH_EFF+"chuanqizbeff",-1),this.equipEffect.x=this.effpos.x,this.equipEffect.y=this.effpos.y,this.equipEffect.scaleX=this.effpos.scaleX,this.equipEffect.scaleY=this.effpos.scaleY)},e.prototype.close=function(){DisplayUtils.removeFromParent(this.equipEffect)},e.prototype.retView=function(){this.descLab.text="",this.descLab1.text="",this.nameLab0.text="",this.icon.setData(null),this.close()},e}(BaseItemRender);__reflect(RuneExchangeItemRenderer.prototype,"RuneExchangeItemRenderer");var RuneItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pos=-1,e.isShowName=!0,e}return __extends(e,t),e.prototype.init=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.noOpenTF,this.onTap)},e.prototype.close=function(){this.removeEventTouchEnd(this.noOpenTF,this.onTap)},e.prototype.onTap=function(t){var e=t.target;e==this.noOpenTF&&UIMgr.ins().open(CopyView,2)},e.prototype.setPos=function(t){this.pos=t;var i=DataCenter.ins().RuneLockPosConfig[t];if(i){var n=copyBabelControl.curLevel,o=i.lockLv;n>o?this.currentState=e.SKIN_STATE_UNLOCK:this.currentState=e.SKIN_STATE_LOCK}},e.prototype.setLockTF=function(t){if(!(this.pos<0||this.currentState!=e.SKIN_STATE_LOCK&&this.currentState!=e.SKIN_STATE_READY)){var i=DataCenter.ins().RuneLockPosConfig[this.pos];if(i){var n=null;if(this.pos>=1&&(n=DataCenter.ins().RuneLockPosConfig[this.pos-1]),n&&n.lockLv<=copyBabelControl.curLevel&&t){var o=DataCenter.ins().BabelLotteryConfig[i.lockLv],s=copyBabelControl.getNextOpenLevel(),r=0;s&&(r=s.layer);var a=LangMgr.getValueByKey("runTips9",DataCenter.ins().BabelLotteryNameConfig[o.group].name,r);this.noOpenTF.textFlow=TextUtils.generateTextFlow1(a)}else this.noOpenTF.text=""}}},e.prototype.setData=function(t){if(t&&!(t.itemConfig&&t.itemConfig.id<=0)){this.data=t;var e=DataCenter.ins().ItemConfig[t.itemConfig.id];if(this._itemConfig=e,e){this.nameBG.visible=this.isShowName,this.nameTF.visible=this.isShowName,this.iconImg.source=e.icon+"_png";var i=(DataCenter.ins().RuneNameConfig[ItemUtils.getSubType(e)],runeControl.getRuneName(e));this.nameTF.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(e)+"&T:"+i+"Lv."+e.id%100)}}},e.prototype.setDataByItemConfig=function(t){if(t){this._itemConfig=t,this.currentState=e.SKIN_STATE_UNLOCK,this.nameBG.visible=this.isShowName,this.nameTF.visible=this.isShowName,this.iconImg.source=t.icon+"_png";var i=DataCenter.ins().RuneNameConfig[ItemUtils.getSubType(t)];t.level&&0!=t.level?this.nameTF.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t)+"&T:"+i.runeName+" Lv."+t.level%100+"|"):this.nameTF.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(t)+"&T:"+i.runeName+" Lv.1|")}},e.prototype.getItemConfig=function(){return this._itemConfig},e.prototype.showOrHideSelected=function(t){this.selectedImg.visible=t},e.prototype.showName=function(t){this.isShowName=t},e.prototype.cleanData=function(){this.data=null,this._itemConfig=null,this.iconImg.source=null,this.nameTF.text="",this.nameTF.visible=!1,this.nameBG.visible=!1},e.SKIN_STATE_LOCK="lock",e.SKIN_STATE_READY="ready",e.SKIN_STATE_UNLOCK="unlock",e}(BaseItemRender);__reflect(RuneItemRenderer.prototype,"RuneItemRenderer");var RuneResolveItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="RuneResolveItemRendererSkin",e.mc=new GameMovieClip,e.mc.x=56,e.mc.y=64,e.mc.scaleX=1.5,e.mc.scaleY=1.5,e.addChild(e.mc),e}return __extends(e,t),e.prototype.dataChanged=function(){this.cb.touchChildren=!1,this.cb.touchEnabled=!1;var t=this.data,e=t.itemData;if(e&&e instanceof ItemData){var i=DataCenter.ins().RuneBaseConfig[e.configID];i?(this.itemIcon.setData(e),this.power.text=runeControl.getcfgAttrDesc(i,!0)):this.resetView()}else this.resetView();this.cb.selected=t.isSelected},e.prototype.resetView=function(){this.itemIcon.setData(null),this.power.text=""},e.prototype.playEffect=function(){this.cb.selected&&this.mc.playFile(PATH_EFF+"litboom",1)},e}(BaseItemRender);__reflect(RuneResolveItemRenderer.prototype,"RuneResolveItemRenderer");var ShareGameControl=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downShareAllInfo=function(t,e,i,n,o){this.shareTimeStamp=t,this.dailyShareTimes=e,this.accuShareTimes=i,this.dailyRewardFlag=n,this.accuRewardFlag=o,this.dealShareTimes(),EventMgr.ins().dispatch(730)},e.prototype.upShare=function(){},e.prototype.downShareInfo=function(t,e,i){this.shareTimeStamp=t,this.dailyShareTimes=e,this.accuShareTimes=i,this.dealShareTimes(),EventMgr.ins().dispatch(731)},e.prototype.dealShareTimes=function(){var t=shareGameControl.getShareTimeStamp(),e=DateUtils.formatMiniDateTime(t)-GameServer.serverTime;e>0?(TimerMgr.ins().isExists(this.doShareTimer,this)&&TimerMgr.ins().remove(this.doShareTimer,this),TimerMgr.ins().doTimer(e,1,this.doShareTimer,this)):EventMgr.ins().dispatch(733)},e.prototype.doShareTimer=function(){EventMgr.ins().dispatch(733)},e.prototype.upGetReward=function(t,e){return[t,e]},e.prototype.downGetRewad=function(t,e){this.dailyRewardFlag=t,this.accuRewardFlag=e,EventMgr.ins().dispatch(732)},e.prototype.getCurDailyRewardCfg=function(){return DataCenter.ins().ShareDailyConfig[this.getDailyRewardStage()]},e.prototype.getDailyRewardStage=function(){if(null==this.dailyRewardFlag)return 1;for(var t=Object.keys(DataCenter.ins().ShareDailyConfig).length,e=this.dailyRewardFlag.toString(2).split("").reverse().join(""),i=0;i<e.length;++i){var n=e[i];if(n&&"0"==n)return i+1}return i+1>t?t:i+1},e.prototype.isDailyShareRed=function(){var t=shareGameControl.getShareTimeStamp();if(null==t)return!1;var e=DateUtils.formatMiniDateTime(t)-GameServer.serverTime,i=this.getDailyShareTimes();
return null==i?!1:i<this.getDailyRewardMaxShare()&&0>=e},e.prototype.isDailyRewardDone=function(){if(null==this.dailyRewardFlag)return!1;var t=Object.keys(DataCenter.ins().ShareDailyConfig).length,e=this.getDailyRewardStage(),i=this.dailyRewardFlag.toString(2).split("").reverse().join("");return e==t&&"1"==i[t-1]},e.prototype.isDailyRewardRed=function(){return!this.isDailyRewardDone()&&this.getCurDailyRewardCfg().count<=this.getDailyShareTimes()},e.prototype.isAccumulativeRewardRed=function(t){if(null==this.accuRewardFlag)return!1;var e=this.accuRewardFlag.toString(2).split("").reverse().join(""),i=DataCenter.ins().ShareCumulativeConfig;return(t-1>=e.length||"0"==e[t-1])&&i[t].count<=this.getAccumulativeShareTimes()},e.prototype.isAccumulativeRewardDone=function(t){var e=this.accuRewardFlag.toString(2).split("").reverse().join("");return"1"==e[t-1]},e.prototype.checkAllAccumulativeRewwardRed=function(){for(var t in DataCenter.ins().ShareCumulativeConfig)if(this.isAccumulativeRewardRed(Number(t)))return!0;return!1},e.prototype.checkRed=function(){return this.isDailyRewardRed()||this.checkAllAccumulativeRewwardRed()||this.isDailyShareRed()},e.prototype.getDailyShareTimes=function(){return this.dailyShareTimes},e.prototype.getAccumulativeShareTimes=function(){return this.accuShareTimes},e.prototype.getShareTimeStamp=function(){return this.shareTimeStamp},e.prototype.getDailyRewardMaxShare=function(){if(null==this.dailyRewardMax){var t=-1;for(var e in DataCenter.ins().ShareDailyConfig){var i=DataCenter.ins().ShareDailyConfig[e].count;t=i>t?i:t}this.dailyRewardMax=t}return this.dailyRewardMax},__decorate([down(101,[3,2,2,3,3])],e.prototype,"downShareAllInfo",null),__decorate([up(102)],e.prototype,"upShare",null),__decorate([down(102,[3,2,2])],e.prototype,"downShareInfo",null),__decorate([up(103,[1,1])],e.prototype,"upGetReward",null),__decorate([down(103,[3,3])],e.prototype,"downGetRewad",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(ShareGameControl.prototype,"ShareGameControl");var ShareGamePanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.dailyRewardList.itemRenderer=ItemBase,this.dailyRewardList.dataProvider=new eui.ArrayCollection,this.accuList.itemRenderer=ShareGameItemRenderer,this.accuList.dataProvider=new eui.ArrayCollection,this.initAllEvents(),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents()},e.prototype.initAllEvents=function(){this.addEventTouchTap(this.dailyGetButton,this.onTap),this.addEventTouchTap(this.shareButton,this.onTap),this.addCustomEvent(730,this.updateView),this.addCustomEvent(731,this.updateView),this.addCustomEvent(732,this.updateView),this.addCustomEvent(733,this.updateView)},e.prototype.removeAllEvents=function(){this.removeCustomEvents(),this.removeEventTouchTap(this.dailyGetButton,this.onTap),this.removeEventTouchTap(this.shareButton,this.onTap),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.shareButton:SDKManager.ins().SDKShowShare(function(){var t=shareGameControl.getShareTimeStamp(),e=DateUtils.formatMiniDateTime(t)-GameServer.serverTime;0>=e&&shareGameControl.upShare()});break;case this.dailyGetButton:shareGameControl.upGetReward(1,shareGameControl.getDailyRewardStage())}},e.prototype.updateView=function(){this.shareRed.visible=shareGameControl.isDailyShareRed(),this.dailyLimitTimeLbl.text=DataCenter.ins().ShareConfig.dailyShareLimit+"",this.dailyShareLbl.textFlow=TextUtils.generateTextFlow1("|C:"+ColorUtils.GREEN+"&T:"+(shareGameControl.getDailyShareTimes()>DataCenter.ins().ShareConfig.dailyShareLimit?DataCenter.ins().ShareConfig.dailyShareLimit:shareGameControl.getDailyShareTimes())+"|/"+DataCenter.ins().ShareConfig.dailyShareLimit);var t=shareGameControl.getShareTimeStamp();this.disTime=DateUtils.formatMiniDateTime(t)-GameServer.serverTime,this.disTime>0?(this.repeatTime(),TimerMgr.ins().isExists(this.repeatTime,this)||TimerMgr.ins().doTimer(1e3,0,this.repeatTime,this)):this.grpCountDown.visible=!1;var e=shareGameControl.isDailyRewardDone(),i=shareGameControl.getCurDailyRewardCfg(),n=shareGameControl.isDailyRewardRed(),o=n||e?ColorUtils.GREEN:ColorUtils.RED;e?this.dailyShareItemLbl.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("dailyShareRewardTip2")):this.dailyShareItemLbl.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("dailyShareRewardTip1",shareGameControl.getDailyRewardMaxShare(),o,shareGameControl.getDailyShareTimes(),i.count)),this.grpDailyGet.visible=!e,this.redPoint.visible=n,this.dailyGetButton.enabled=n,n?this.dailyGetButton.label=LangMgr.getValueByKey("activitGet"):e?this.dailyGetButton.label=LangMgr.getValueByKey("activitAlreadingGet"):this.dailyGetButton.label=LangMgr.getValueByKey("activitNoFinsh"),this.dailyRewardList.dataProvider.replaceAll(i.reward);var s=[];for(var r in DataCenter.ins().ShareCumulativeConfig)s.push(DataCenter.ins().ShareCumulativeConfig[r]);s.sort(function(t,e){var i=shareGameControl.isAccumulativeRewardDone(t.id),n=shareGameControl.isAccumulativeRewardDone(e.id),o=shareGameControl.isAccumulativeRewardRed(t.id),s=shareGameControl.isAccumulativeRewardRed(e.id);return o!=s?o?-1:1:i!=n?i?1:-1:t.id-e.id}),this.accuList.dataProvider.replaceAll(s)},e.prototype.repeatTime=function(){var t=Math.floor(this.disTime/DateUtils.MS_PER_SECOND);this.lblCountDown.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3),this.grpCountDown.visible=!0,this.disTime<=0&&(this.shareRed.visible=shareGameControl.isDailyShareRed(),this.grpCountDown.visible=!1,TimerMgr.ins().remove(this.repeatTime,this)),this.disTime-=DateUtils.MS_PER_SECOND},e}(BasePanel);__reflect(ShareGamePanel.prototype,"ShareGamePanel");var ShareGameView=function(t){function e(){var e=t.call(this)||this;return e.oldTapIndex=0,e.skinName="ShareGameViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.openCheck=function(t){var e=DataCenter.ins().ShareConfig;return ActorControl.level<e.level?(tipsControl.showTips(LangMgr.getValueByKey("open1",LangMgr.getValueByKey("numberLevel",e.level))),!1):!0},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initAllEvents(),this.shareGamePanel.open()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents(),this.shareGamePanel.close()},e.prototype.initAllEvents=function(){this.addEventTouchTap(this.closeBtn,this.onClick)},e.prototype.removeAllEvents=function(){this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ShareGameView.prototype,"ShareGameView");var ShareGameItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.rewardList.itemRenderer=ItemBase,this.rewardList.dataProvider=new eui.ArrayCollection,this.addEventTouchTap(this.getButton,this.onTap)},e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.rewardList.dataProvider.replaceAll(this.data.reward);var e=shareGameControl.isAccumulativeRewardRed(this.data.id),i=shareGameControl.isAccumulativeRewardDone(this.data.id),n=e||i?ColorUtils.GREEN:ColorUtils.RED;this.accumulativeLbl.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("AccumulativeShareTip1",this.data.count,n,shareGameControl.getAccumulativeShareTimes(),this.data.count)),this.getButton.enabled=e,this.redPoint.visible=e,e?this.getButton.label=LangMgr.getValueByKey("activitGet"):i?this.getButton.label=LangMgr.getValueByKey("activitAlreadingGet"):this.getButton.label=LangMgr.getValueByKey("activitNoFinsh")},e.prototype.onTap=function(t){switch(t.target){case this.getButton:shareGameControl.upGetReward(2,this.data.id)}},e}(BaseItemRender);__reflect(ShareGameItemRenderer.prototype,"ShareGameItemRenderer");var SkillControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hejiLevel=-1,e.hejiCD=0,e.hejiEnable=!1,e.isFirst=!0,e.fieldUse=!1,e.equipListData=[],e.hejiProgressList=[],e.reduceCD=0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.getPunchForge=function(){return this.punchEquipForge||(this.punchEquipForge=new PunchEquipForgeVo),this.punchEquipForge},e.prototype.upUseSkill=function(t,e,i){return[t,e,i]},e.prototype.downSkillResult=function(t,e,i,n){var o=UnitMgr.ins().getEntityByHandle(t);if(o){var s=UnitMgr.ins().getEntityByHandle(i);if(s&&(!s.parent&&o.isMy&&UnitShowMgr.ins().showHideSomeOne(i),!o.parent&&s.isMy&&UnitShowMgr.ins().showHideSomeOne(t),o.parent)){var r=new SkillVo(e),a=0;7==Math.floor(e/1e4)&&(a=16);var l;o.isMy&&(s.showBlood(!0),s.showName(!0)),s.isMy&&(o.showBlood(!0),o.showName(!0));for(var h=[],u=[],p=0;p<n.length;p++)l=n[p],u=[l],h[p]=u;this.useSkill(o,s,r),o instanceof UnitRole&&unionWarControl.getModel().checkinAppoint(2,!0)&&heroControl.getIsMyPlayer(i)&&o.infoModel.name&&unionWarControl.getModel().changeWeiXieList(o.infoModel.masterHandle,!0,o.infoModel.name)}}},e.prototype.useSkill=function(t,e,i,n){return void 0===n&&(n=null),t!=e&&(t.dir=DirUtils.get8DirBy2Point(t,e)),i?(gameControl.playSkillEff(i,t,[e],n),!SoundUtils.PLAY_OPEN_VIEW&&i.sound&&0==t.team&&SoundUtils.ins().playEffect(i.sound),!0):!1},e.prototype.downDoBuff=function(t,e){var i,n=UnitMgr.ins().getEntityByHandle(t);if(n){i=DataCenter.ins().SkillsEffectsConfig[e];var o=ObjectPool.pop("BuffModel");o.effConfig=i,o.value=0,o.addTime=egret.getTimer(),n.addBuff(o)}EventMgr.ins().dispatch(80,i)},e.prototype.downDoRemoveBuff=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);if(i){var n=DataCenter.ins().SkillsEffectsConfig[e].group;i.hasBuff(n)&&i.removeBuff(i.buffList[n])}EventMgr.ins().dispatch(81)},e.prototype.downAddEffect=function(t,e,i,n){var o=UnitMgr.ins().getEntityByHandle(t);o&&o.addServerEff(e,i,n)},e.prototype.downRemoveEffect=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);i&&i.removeServerEff(e)},e.prototype.upGrewUpSkill=function(t,e){return[t,e]},e.prototype.downSkillUpgrade=function(t,e,i){var n=heroControl.getSubRoleByIndex(t),o=n.skillsData[e].lv;n.skillsData[e]=SkillVo.getSkillByJob(n.job,e+1,i),0==o&&0!=i&&tipsControl.showSkillTips(n.skillsData[e].configID),EventMgr.ins().dispatch(82,[t,e,i])},e.prototype.upGrewUpAllSkill=function(t,e,i){return void 0===e&&(e=!0),void 0===i&&(i=0),[e?1:0,t,i]},e.prototype.downSkillUpgradeAll=function(t,e){var i=heroControl.getSubRoleByIndex(t),n=i.skillsData;i.skillsData=[];for(var o=0;o<e.length;o++)i.skillsData.push(SkillVo.getSkillByJob(i.job,o+1,e[o]));EventMgr.ins().dispatch(83,[n,t])},e.prototype.downHejiInfo=function(t,e){var i=!1;-1==this.hejiLevel&&1==t&&(i=!0),this.hejiLevel!=t&&(this.hejiLevel=t,EventMgr.ins().dispatch(85)),this.setHejiCD(e),EventMgr.ins().dispatch(84,{isAct:i})},e.prototype.downHejiEquipInfo=function(t){this.equipListData=[];for(var e,i=0;i<t.length;i++)e=new ItemData,e.init(t[i]),this.equipListData.push(e);this.setQimingInfo(),this.dispatchHejiEquipChange()},e.prototype.setQimingInfo=function(){if(this.qimingEquipDic={},!this.qmArr){this.qmArr=[];var t=DataCenter.ins().FocusAttackQmConfig;for(var e in t)for(var i in t[e])if(!isNaN(Number(e))&&!isNaN(Number(i))){var n=1e4*Number(e)+Number(i);this.qmArr.push(n)}}for(var o in this.equipListData)if(0!=this.equipListData[o].configID)for(var s=this.equipListData[o].itemConfig,r=1e4*(s.zsLevel||0)+s.level,a=0;a<this.qmArr.length;a++)if(!(r<this.qmArr[a])){var i=this.qmArr[a];this.qimingEquipDic[i]?this.qimingEquipDic[i].num++:(this.qimingEquipDic[i]={num:0},this.qimingEquipDic[i].num=1)}this.setQmAttr()},e.prototype.setQmAttr=function(){var t=DataCenter.ins().FocusAttackQmConfig;this.qimingAttrDic={};for(var e in this.qimingEquipDic){var i=Math.floor(Number(e)/1e4),n=Math.floor(Number(e)%1e4),o=this.qimingEquipDic[e].num,s=t[i][n];if(s)for(var r in s)o>=Number(r)&&(this.qimingAttrDic[e]||(this.qimingAttrDic[e]={}),this.qimingAttrDic[e][r]=s[r])}this.qimingValueDic={};for(var e in this.qimingAttrDic)for(var a in this.qimingAttrDic[e]){var l=this.qimingAttrDic[e][a],h=l.exAttr[0];this.qimingValueDic[a]||(this.qimingValueDic[a]=new Object),this.qimingValueDic[a].value||(this.qimingValueDic[a].value=0),this.qimingValueDic[a].type=h.type,this.qimingValueDic[a].value+=h.value}},e.prototype.downHejiEquipUpdate=function(t,e,i,n,o,s){var r=new ItemData;r.init([e,i,n,o,s]),this.equipListData[t]=r,this.setQimingInfo(),this.dispatchHejiEquipChange()},e.prototype.checkHejiOpen=function(){var t=DataCenter.ins().FocusAttackBaseConfig.actImbaId;return artifactControl.getNewArtifactBy(artifactControl.getArtifactIndexById(t))?artifactControl.getNewArtifactBy(artifactControl.getArtifactIndexById(t)).open:!1},e.prototype.canHejiEquip=function(){if(this.hejiLevel<=0)return!1;if(ActorControl.level<i.HEJI_SHOW_LEVEL)return!1;if(!this.equipListData)return!1;for(var t=0;t<this.equipListData.length;t++)if(this.checkIsHaveBestEquip(t))return!0;return!1},e.prototype.canExchange=function(){if(this.hejiLevel<=0)return!1;if(ActorControl.level<i.HEJI_SHOW_LEVEL)return!1;var t,e=this.getMaxzLv();for(var n in this.equipListData){var o=this.equipListData[n];if(o&&o.configID)for(var s=+n+1;;s+=8){var r=DataCenter.ins().FocusAttackExchangeConfig[s];if(!r)break;var a=o.itemConfig.level?o.itemConfig.level:0,l=o.itemConfig.zsLevel?o.itemConfig.zsLevel:0,h=r.level,u=r.zsLevel,p=r.getItem.id;if(!(a>=h&&l>=u||p%1e4<=o.configID%1e4||h>ActorControl.level||u>reincarnateControl.lv)){if(u>e[0]||h>e[1])break;if(u>=l&&h>=a){if(t=r.exchangeMaterial[0].count,11==r.exchangeMaterial[0].id&&ActorControl.togeatter1>=t)return!0;if(12==r.exchangeMaterial[0].id&&ActorControl.togeatter2>=t)return!0}}}else{var c=DataCenter.ins().FocusAttackExchangeConfig[Number(n)+1];if(c){if(t=c.exchangeMaterial[0].count,11==c.exchangeMaterial[0].id&&ActorControl.togeatter1>=t)return!0;if(12==c.exchangeMaterial[0].id&&ActorControl.togeatter2>=t)return!0}}}return!1},e.prototype.getMaxzLv=function(){var t=0,e=0,i=0,n=this.qimingEquipDic;for(var o in n)+o>t&&(t=+o);if(e=Math.floor(t/1e4),i=t%1e4,0==t||8==n[t].num){var s=DataCenter.ins().FocusAttackQmConfig,r=[];for(var a in s)r.push(+a);r.sort(function(t,e){return e>t?-1:1}),0==t?e=r[0]:(e=r[r.indexOf(e)+1],void 0==e&&(e=r[r.length-1]));for(var l in s[e])i=+l}return[e,i]},e.prototype.getPunchExchangePageRedPoint=function(t){var e,i=this.getMaxzLv();for(var n in this.equipListData){var o=this.equipListData[n];if(o&&o.configID){if(1==t)continue;var s=+n+1+8*(t-2),r=DataCenter.ins().FocusAttackExchangeConfig[s],a=r.getItem.id;if(a!=o.configID)continue;var l=+n+1+8*(t-1);if(r=DataCenter.ins().FocusAttackExchangeConfig[l]){var h=o.itemConfig.level?o.itemConfig.level:0,u=o.itemConfig.zsLevel?o.itemConfig.zsLevel:0,p=r.level,c=r.zsLevel,d=r.getItem.id;if(h>=p&&u>=c)continue;if(d%1e4<=o.configID%1e4)continue;if(p>ActorControl.level||c>reincarnateControl.lv)continue;if(c>i[0]||p>i[1])continue;if(c>=u&&p>=h){if(e=r.exchangeMaterial[0].count,11==r.exchangeMaterial[0].id&&ActorControl.togeatter1>=e)return!0;if(12==r.exchangeMaterial[0].id&&ActorControl.togeatter2>=e)return!0}}}else if(1==t){var g=DataCenter.ins().FocusAttackExchangeConfig[Number(n)+1];if(g){if(e=g.exchangeMaterial[0].count,11==g.exchangeMaterial[0].id&&ActorControl.togeatter1>=e)return!0;if(12==g.exchangeMaterial[0].id&&ActorControl.togeatter2>=e)return!0}}}return!1},e.prototype.getPunchExchangeItemRedPoint=function(t){var e,i=(t-1)%8,n=Math.ceil(t/8),o=this.equipListData[i];if(1==n){if(o&&o.configID)return!1}else{if(!o||!o.configID)return!1;var s=DataCenter.ins().FocusAttackExchangeConfig[t-8];if(s.getItem.id!=o.configID)return!1}var r=DataCenter.ins().FocusAttackExchangeConfig[t];if(r){if(r.zsLevel>reincarnateControl.lv||r.level>ActorControl.level)return!1;if(e=r.exchangeMaterial[0].count,11==r.exchangeMaterial[0].id&&ActorControl.togeatter1>=e)return!0;if(12==r.exchangeMaterial[0].id&&ActorControl.togeatter2>=e)return!0}return!1},e.prototype.canSolve=function(){if(this.hejiLevel<=0)return!1;if(ActorControl.level<i.HEJI_SHOW_LEVEL)return!1;var t=[];return backpackControl.checkHejiEquipsTodestroy(t),t.length?!0:!1},e.prototype.downHejiUpdateInfo=function(t){this.hejiProgressList=[];for(var e=0;e<t.length;e++){var i=new FocusAttackProgressVo;i.parser(t[e]),this.hejiProgressList[i.id-1]=i}},e.prototype.setHejiCD=function(t){if(void 0===t&&(t=0),this.hejiLevel>0){var e=this.getHejiSkillId();this.reduceCD=0;var i=UnitMgr.ins().getMainRole(0);i&&i.infoModel&&i.infoModel.getExAtt(23)>0&&(this.reduceCD=i.infoModel.getExAtt(23)/1e4*e.cd),-1==t?this.hejiCD=GameServer.serverTime+e.cd-this.reduceCD:this.hejiCD=GameServer.serverTime+t,this.dispatchHejiStartCD()}},e.prototype.getHejiSkillId=function(){var t=DataCenter.ins().FocusAttackConfig[this.hejiLevel],e=heroControl.getSubRoleByIndex(0);if(!e)return new SkillVo(DataCenter.ins().SkillsConfig[t.skill_id[0]].id);var i=DataCenter.ins().SkillsConfig[t.skill_id[e.job-1]];return new SkillVo(i.id)},e.prototype.getHejiSkillIdIcon=function(){var t=DataCenter.ins().FocusAttackConfig[this.hejiLevel],e=heroControl.getSubRoleByIndex(0);e||(e={job:1});var i=DataCenter.ins().SkillsConfig[t.skill_id[e.job-1]],n=1e3*Math.floor(i.id/1e3)+"_png";return n},e.prototype.getSkillIdIcon=function(t){var e=DataCenter.ins().SkillsConfig[t],i=1e3*Math.floor(e.id/1e3)+"_png";return i},e.prototype.upGrewUpHejiSkill=function(){},e.prototype.upUseHejiSkill=function(){},e.prototype.upDressHejiEquip=function(t,e){return[t,e]},e.prototype.upExchangeHejiEquip=function(t){return[t]},e.prototype.getWearEquipsData=function(t){return this.equipListData[t]?this.equipListData[t]:null},e.prototype.getSkillLimitLevel=function(){return reincarnateControl.lv>0?80+10*reincarnateControl.lv:ActorControl.level>80?80:ActorControl.level},e.prototype.getSingleSkillGrewUpCost=function(t,e){var i=this.getSkillLimitLevel(),n=heroControl.getSubRoleByIndex(t).skillsData[e],o=ActorControl.gold,s=0;if(n.lv>0){for(var r=n.lv;i>r;r++){var a=DataCenter.ins().SkillsUpgradeConfig[r].cost;if(s+a>o)return s;s+=a}return s}return 0},e.prototype.canGrewupSkill=function(){for(var t=[],e=this.getSkillLimitLevel(),i=heroControl.subRolesLen,n=0;i>n;n++)for(var o=heroControl.getSubRoleByIndex(n),s=0;s<o.skillsData.length;s++){var r=o.skillsData[s];if(r.lv>0&&e>r.lv){var a=DataCenter.ins().SkillsUpgradeConfig[r.lv].cost;if(ActorControl.gold>=a){t[n]=!0;break}}}return t},e.prototype.canGrewupAllSkills=function(t){for(var e=this.getSkillLimitLevel(),i=heroControl.getSubRoleByIndex(t).skillsData,n=!1,o=ActorControl.gold,s=0;s<i.length;s++){var r=i[s];if(0!=r.configID){var a=DataCenter.ins().SkillsUpgradeConfig[r.lv];a&&o>=a.cost&&r.configID!=e&&(n=!0)}}if(n){for(var s=0;5>s;s++){var r=i[s];if(r.lv>0&&r.lv<this.getSkillLimitLevel()){var l=this.getSingleSkillGrewUpCost(t,s);if(l>0)return!0}}return!1}return n},e.prototype.dispatchShowSkillWord=function(t){EventMgr.ins().dispatch(598,t)},e.prototype.dispatchHejiStartCD=function(){EventMgr.ins().dispatch(596)},e.prototype.dispatchHejiRemove=function(){EventMgr.ins().dispatch(595)},e.prototype.dispatchHejiEquipChange=function(){EventMgr.ins().dispatch(86)},e.prototype.checkIsHaveBestEquip=function(t,e){void 0===e&&(e=-1);var i=this.equipListData[t],n=backpackControl.getHejiEquipsByType(t);if(n.length>0)for(var o=void 0,s=200,r=0;r<n.length;r++){o=n[r];var a=o.itemConfig.level?o.itemConfig.level:0,l=o.itemConfig.zsLevel?o.itemConfig.zsLevel:0;if(o.itemConfig.level<=s&&(a<=ActorControl.level||l<=reincarnateControl.lv)&&o.itemConfig.level<=ActorControl.level&&l<=reincarnateControl.lv){var h=0;if(!i||0==i.configID){if(o.itemConfig.useCond)continue;return!0}h=i.point;var u=o.point;if(u>h&&o.itemConfig.useCond==i.itemConfig.id)return!0}}return!1},e.prototype.getPuchAwakeLvByPos=function(t){return this._punchAwake&&this._punchAwake[t]?this._punchAwake[t]:0},e.prototype.getPunchAwakeSuitInfo=function(t){void 0===t&&(t=-1);var e=this.getPuchAwakeMaxSuitLv(),i=1,n={};for(var o in DataCenter.ins().FocusAwakeHitLvConfig){var s=this.getPuchAwakeLvByPos(+o);if(t==+o&&s++,s)for(var r=s;r>=i;r--)n[r]?n[r]++:n[r]=1}for(var a=[],l=[],h=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length,u=e;u>=i;u--){var p=n[u]?n[u]:0;if(0!=p){if(p==h){this.setCountInfo(p,u,a,l);break}this.setCountInfo(p,u,a,l)}}return l},e.prototype.setCountInfo=function(t,e,i,n){for(var o in DataCenter.ins().FocusAwakeHitSuitConfig){var s=+o;t>=s&&-1==i.indexOf(s)&&(i.push(s),n[s]=e)}},e.prototype.getPuchAwakeMaxSuitLv=function(){for(var t in DataCenter.ins().FocusAwakeHitSuitConfig)return Object.keys(DataCenter.ins().FocusAwakeHitSuitConfig[t]).length;return 0},e.prototype.getPunchAwakeRedByPos=function(t){var e=this.getWearEquipsData(t);if(!e||!e.configID)return!1;var i=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig[t]).length,n=this.getPuchAwakeLvByPos(t);if(n>=i)return!1;var o=DataCenter.ins().FocusAwakeHitLvConfig[t][n+1].cost;return backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,o.id)>=o.count},e.prototype.getPunchAwakeRed=function(){for(var t=Object.keys(DataCenter.ins().FocusAwakeHitLvConfig).length,e=0;t>e;e++)if(this.getPunchAwakeRedByPos(e))return!0;return!1},e.prototype.checkAwakeOpen=function(){var t=!1;return skillControl.checkHejiOpen()&&GameServer.serverOpenDay+1>=DataCenter.ins().FocusAttackBaseConfig.openAwakeDay&&reincarnateControl.lv>=DataCenter.ins().FocusAttackBaseConfig.openAwakeZsLv&&(t=!0),t},e.prototype.canAcitve=function(){return!1},e.prototype.getPunchAwakePassiveSkills=function(){var t=[],e=this.getPunchAwakeSuitInfo();if(!e||!e.length)return null;for(var i in e)if(+i>0){var n=DataCenter.ins().FocusAwakeHitSuitConfig[i][e[i]];n.passive&&t.push(new SkillVo(n.passive))}return t},e.prototype.getCurSuitLv=function(){if(!this.qimingEquipDic)return 0;var t=0;for(var e in this.qimingEquipDic){var i=this.qimingEquipDic[e].num;i>=8&&+e>t&&(t=+e)}return t},e.prototype.getAttrByType=function(t,e){if(!e||!e.length)return null;for(var i=e,n=0;n<i.length;n++){var o=i[n];if(o.type==t)return o}return null},e.prototype.getPosesBySuitLv=function(t){var e=[];for(var i in DataCenter.ins().FocusAwakeHitLvConfig){var n=this.getPuchAwakeLvByPos(+i);n&&n>=t&&e.push(+i)}return e},e.prototype.upUpgradeForge=function(t){return[t]},e.prototype.downUpgradeForge=function(t){this.getPunchForge().parser(t),EventMgr.ins().dispatch(87)},e.prototype.upChangeTogeatterHigh=function(t){return[t]},e.prototype.isHejiSkill=function(t){for(var e in DataCenter.ins().FocusAttackConfig)if(DataCenter.ins().FocusAttackConfig[e].skill_id.indexOf(t)>=0)return!0;return!1},e.prototype.upPunchAwake=function(t){return[t]},e.prototype.downPunchAwake=function(t){this._punchAwake=[];for(var e=0;t.length>e;e++)this._punchAwake[e]=t[e];EventMgr.ins().dispatch(706)},e.prototype.downPunchAwakeBack=function(t,e){this._punchAwake||(this._punchAwake=[]),this._punchAwake[t]=e,EventMgr.ins().dispatch(705)},e.MAX_LEVEL=200,e.ACTIVE_LEVEL=10,e.HEJI_SKILL=7e4,e.HEJI_SHOW_LEVEL=60,__decorate([up(1,[10,10,3])],e.prototype,"upUseSkill",null),__decorate([down(1,[10,3,10,[10]])],e.prototype,"downSkillResult",null),__decorate([down(2,[10,3])],e.prototype,"downDoBuff",null),__decorate([down(3,[10,3])],e.prototype,"downDoRemoveBuff",null),__decorate([down(6,[10,3,1,3])],e.prototype,"downAddEffect",null),__decorate([down(7,[10,3])],e.prototype,"downRemoveEffect",null),__decorate([up(4,[2,2])],e.prototype,"upGrewUpSkill",null),__decorate([down(4,[2,2,2])],e.prototype,"downSkillUpgrade",null),__decorate([up(5,[2,2,2])],e.prototype,"upGrewUpAllSkill",null),__decorate([down(5,[2,[2]])],e.prototype,"downSkillUpgradeAll",null),__decorate([down(9,[6,6])],e.prototype,"downHejiInfo",null),__decorate([down(10,[ByteConst.ItemDatas])],e.prototype,"downHejiEquipInfo",null),__decorate([down(11,[2].concat(ByteConst.ItemDatas))],e.prototype,"downHejiEquipUpdate",null),__decorate([down(12,[[1,6]])],e.prototype,"downHejiUpdateInfo",null),__decorate([up(9)],e.prototype,"upGrewUpHejiSkill",null),__decorate([up(10)],e.prototype,"upUseHejiSkill",null),__decorate([up(11,[10,2])],e.prototype,"upDressHejiEquip",null),__decorate([up(12,[2])],e.prototype,"upExchangeHejiEquip",null),__decorate([up(13,[2])],e.prototype,"upUpgradeForge",null),__decorate([down(13,[[2,3]])],e.prototype,"downUpgradeForge",null),__decorate([up(14,[3])],e.prototype,"upChangeTogeatterHigh",null),__decorate([up(16,[1])],e.prototype,"upPunchAwake",null),__decorate([down(15,[[2]])],e.prototype,"downPunchAwake",null),__decorate([down(16,[1,2])],e.prototype,"downPunchAwakeBack",null),e=i=__decorate([protocolsId(2)],e);var i}(BaseSystem);__reflect(SkillControl.prototype,"SkillControl");var WeaponsSoulDataVo=function(){function t(){var t=Object.keys(DataCenter.ins().WeaponSoulConfig);this.WeaponsSoulInfoData={};for(var e=0;e<t.length;e++){var i=t[e],n=new WeaponsSoulOneInfoVo;this.WeaponsSoulInfoData[i]=n}t=Object.keys(DataCenter.ins().WeaponSoulPosConfig),this.WeaponsInfoData={};for(var e=0;e<t.length;e++){var i=t[e];this.WeaponsInfoData[i]||(this.WeaponsInfoData[i]={})}this.WeaponsFlexibleInfoData=[],this.weaponsId=0,this.flexibleCount=0}return t.prototype.getSuitConfig=function(t){for(var e=this.getInfoData(),i=0,n=!1,o=DataCenter.ins().WeaponSoulConfig[t],s=0;s<o.actcond.length;s++){var r=o.actcond[s];if(n=!0,Object.keys(e[r]).length)for(var a in e[r]){var l=e[r][a];if(0==s&&(i=l.level),!l.level){n=!1;break}l.level<=i&&(i=l.level)}else n=!1;if(!n)break}var h;if(n){var u="";for(var p in DataCenter.ins().WeaponSoulSuitConfig[t]){if(!(i>=Number(p)))break;u=p}u&&(h=DataCenter.ins().WeaponSoulSuitConfig[t][u])}return h},t.prototype.getNextSuitConfig=function(t){var e,i=this.getSuitConfig(t);i||(i=DataCenter.ins().WeaponSoulSuitConfig[t][0]);for(var n in DataCenter.ins().WeaponSoulSuitConfig[t])if(DataCenter.ins().WeaponSoulSuitConfig[t][n].level>i.level){e=DataCenter.ins().WeaponSoulSuitConfig[t][n];break}return e},t.prototype.init=function(t){this.initInfo(t[0]),this.initSoulInfo(t[1]),this.initWeaponFlexibleInfo(t[2],t[3])},t.prototype.initInfo=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1];this.WeaponsInfoData[i]={};var o=new WeaponsSoulInfoVo;o.setInfo(i,n),this.WeaponsInfoData[i][n]=o}},t.prototype.initSoulInfo=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.WeaponsSoulInfoData[i].setSoulInfo(i)}},t.prototype.initWeaponFlexibleInfo=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];this.WeaponsFlexibleInfoData.push(n)}this.flexibleCount=e,this.flexibleCount&&this.flexibleCount++},t.prototype.initInfoOnly=function(t,e){this.WeaponsInfoData[t]={};var i=new WeaponsSoulInfoVo;i.setInfo(t,e),this.WeaponsInfoData[t][e]=i},t.prototype.initSoulInfoOnly=function(t,e){if(t>0){this.WeaponsSoulInfoData[t].setSoulInfo(t);var i=heroControl.getSubRoleByIndex(e);if(i){var n=this.WeaponsSoulInfoData[t].inside[i.job-1];n&&(UIMgr.ins().close(WeaponSoulFacadePanel),CommonFun.show(0,this.WeaponsSoulInfoData[t].name,"weapsdao_png",n,!0,function(){var t=UIMgr.ins().getView(IntensifyView);t&&t.weaponSoulPanel&&UIMgr.ins().open(WeaponSoulFacadePanel,t.weaponSoulPanel.roleId,t.weaponSoulPanel.weaponId)}))}}},t.prototype.getRedPointBySuit=function(t){var e=DataCenter.ins().WeaponSoulConfig[t];if(!e)return!1;if(!this.WeaponsSoulInfoData[t].id&&this.IsActivityWeapon(t))return!0;for(var i in e.actcond){var n=e.actcond[i],o=this.getInfoLevel(n),s=DataCenter.ins().WeaponSoulPosConfig[n][o],r=s.costNum,a=DataCenter.ins().WeaponSoulPosConfig[n][o+1];if(r&&a){var l=backpackControl.getBagItemById(s.costItem),h=l?l.count:0;if(h>=r)return!0}}return this.IsHaveAndNotWear(t)},t.prototype.IsHaveAndNotWear=function(t){if(!this.weaponsId)for(var e in this.WeaponsSoulInfoData){var i=this.WeaponsSoulInfoData[e];if(t){if(t==i.id)return!0}else if(i.id)return!0}return!1},t.prototype.getInfoLevel=function(t){var e=0;if(!this.WeaponsInfoData[t])return 0;for(var i in this.WeaponsInfoData[t]){e=this.WeaponsInfoData[t][i].level;break}return e},t.prototype.getSlotByInfo=function(t){var e;if(!this.WeaponsInfoData[t])return e;for(var i in this.WeaponsInfoData[t]){e=this.WeaponsInfoData[t][i];break}return e},t.prototype.getWeapsInfoBySoulId=function(t){var e=this.WeaponsSoulInfoData[t];return e},t.prototype.IsActivityWeapon=function(t){var e=DataCenter.ins().WeaponSoulConfig[t];if(e){for(var i=0;i<e.actcond.length;i++){var n=e.actcond[i];if(!CommonUtils.getObjectLength(this.WeaponsInfoData[n]))return!1}return!0}return!1},t.prototype.getInfoData=function(){return this.WeaponsInfoData},t.prototype.getSoulInfoData=function(){return this.WeaponsSoulInfoData},t.prototype.getFlexibleData=function(){return this.WeaponsFlexibleInfoData},t}();__reflect(WeaponsSoulDataVo.prototype,"WeaponsSoulDataVo");var SkillPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.curRole=0,e.curIndex=0,e}return __extends(e,t),e.prototype.init=function(){this.curRole=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.all,this.onAllUpgrade);for(var i=0;5>i;i++){var n=this["skillItem"+(i+1)];this.addEventTouchTap(n,this.onSelect),this.addEventTouchTap(n.grewUpAllBtn,this.onSingleUpgrade)}this.addCustomEvent(83,this.grewupAllSkillCB),this.updateAllSkillItemAndDesc()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.all,this.onAllUpgrade);for(var i=0;5>i;i++){var n=this["skillItem"+(i+1)];this.removeEventTouchTap(n,this.onSelect),this.removeEventTouchTap(n.grewUpAllBtn,this.onSingleUpgrade)}this.removeCustomEvents(),DisplayUtils.removeFromParent(this.mc),this.mc=null},e.prototype.showHint=function(){var t;t=ActorControl.level>=80?LangMgr.getValueByKey("skillMaxLevel"):LangMgr.getValueByKey("skillSkillOverLevel"),tipsControl.showTips(t)},e.prototype.onSelect=function(t){var e=skillControl.getSkillLimitLevel();switch(t.currentTarget){case this.skillItem1:if(e<DataCenter.ins().SkillsOpenConfig[1].level)return;this.curIndex=0;break;case this.skillItem2:if(e<DataCenter.ins().SkillsOpenConfig[2].level)return;this.curIndex=1;break;case this.skillItem3:if(e<DataCenter.ins().SkillsOpenConfig[3].level)return;this.curIndex=2;break;case this.skillItem4:if(e<DataCenter.ins().SkillsOpenConfig[4].level)return;this.curIndex=3;break;case this.skillItem5:if(e<DataCenter.ins().SkillsOpenConfig[5].level)return;this.curIndex=4}this.setSkillItem()},e.prototype.onSingleUpgrade=function(t){switch(t.currentTarget.parent){case this.skillItem1:this.onSendUpgrade(0),this.curIndex=0;break;case this.skillItem2:this.onSendUpgrade(1),this.curIndex=1;break;case this.skillItem3:this.onSendUpgrade(2),this.curIndex=2;break;case this.skillItem4:this.onSendUpgrade(3),this.curIndex=3;break;case this.skillItem5:this.onSendUpgrade(4),this.curIndex=4}SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE),this.setSkillItem()},e.prototype.onAllUpgrade=function(t){this.onSendUpgrade(0,!0),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE),this.setSkillItem()},e.prototype.onSendUpgrade=function(t,e){void 0===e&&(e=!1),skillControl.upGrewUpAllSkill(this.curRole,e,t)},e.prototype.updateAllSkillItemAndDesc=function(){DisplayUtils.removeFromParent(this.mc),this.mc=null,this.updateAllSkillItem(),this.setSkillItem()},e.prototype.updateAllSkillItem=function(){this.isUpGrade=!1;for(var t=0;5>t;t++){var e=this["skillItem"+(t+1)],i=heroControl.getSubRoleByIndex(this.curRole);if(!i)return;var n=i.skillsData[t];n.lv<=0?(skillControl.getSkillLimitLevel()>=DataCenter.ins().SkillsOpenConfig[t+1].level?(e.lock.textColor=LangMgr.getColor("color36"),e.lock.text=LangMgr.getValueByKey("open","")):(e.lock.textColor=LangMgr.getColor("color37"),e.lock.text=LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().SkillsOpenConfig[t+1].level)),e.lock.visible=!0,e.lv.text="",e.costAll.visible=!1,e.coinIcon1.visible=!1,e.grewUpAllBtn.visible=!1):(e.lock.visible=!1,e.lv.text="Lv."+n.lv,e.costAll.visible=!0,e.coinIcon1.visible=!0,e.grewUpAllBtn.visible=!0,this.setCost(e,t,n.lv)),e.icon.source=n.icon,e.skillName.text=n.name+"",e.skillDesc.textFlow=TextUtils.generateTextFlow1(n.desc+"")
}this.all.visible&&this.isUpGrade&&(this.mc||(this.mc=new GameMovieClip,this.mc.x=this.all.width/2,this.mc.y=this.all.height/2,this.all.addChild(this.mc),this.mc.playFile(PATH_EFF+"chargeff1",-1)))},e.prototype.setCost=function(t,e,i){var n=DataCenter.ins().SkillsUpgradeConfig[i].cost,o=ActorControl.level,s=ActorControl.gold;if(t.costAll.visible=t.coinIcon1.visible=!0,i>=skillControl.getSkillLimitLevel()){t.grewUpAllBtn.enabled=!1;var r=heroControl.getSubRoleByIndex(this.curRole).skillsData[this.curIndex];r.lv>=SkillControl.MAX_LEVEL?(t.grewUpAllBtn.labelDisplay.text=LangMgr.getValueByKey("maxLevel"),t.costAll.visible=t.coinIcon1.visible=!1):i>=80?t.grewUpAllBtn.labelDisplay.text=reincarnateControl.lv+1+LangMgr.getValueByKey("skillRotationCanUpdate"):t.grewUpAllBtn.labelDisplay.text=o+1+LangMgr.getValueByKey("skillLevelCanUpdate"),s>=n?(t.costAll.textColor=ColorUtils.GREEN,t.costAll.text=""+n):(t.costAll.textColor=LangMgr.getColor("color37"),t.costAll.text=""+n)}else{var a=skillControl.getSingleSkillGrewUpCost(this.curRole,e);t.grewUpAllBtn.labelDisplay.text=LangMgr.getValueByKey("skillOnkeyUpdate"),a>0?(this.isUpGrade=!0,t.costAll.textColor=ColorUtils.GREEN,t.costAll.text=""+a,t.grewUpAllBtn.enabled=!0):(t.costAll.textColor=LangMgr.getColor("color37"),t.costAll.text=""+n,t.grewUpAllBtn.enabled=!1)}},e.prototype.setSkillItem=function(){for(var t=0;5>t;t++){var e=this["skillItem"+(t+1)];e.select.visible=t==this.curIndex}},e.prototype.setRoleId=function(t){this.curRole=t,this.updateAllSkillItemAndDesc()},e.prototype.grewupAllSkillCB=function(t){var e=t[0];if(t[1]==this.curRole){for(var i=heroControl.getSubRoleByIndex(this.curRole),n=0;n<e.length;n++)e[n].lv&&e[n].lv<i.skillsData[n].lv&&this.grewupTip(e[n],i.skillsData[n],n);this.updateAllSkillItemAndDesc(),DisplayUtils.removeFromParent(this.mc),this.mc=null}},e.prototype.grewupTip=function(t,e,i){var n=this,o="",s=new eui.Label;s.size=20,s.textColor=LangMgr.getColor("color38");var r;if(e.args)t.args?(r=e.args.b-t.args.b,o=LangMgr.getValueByKey("skillAddDanges",e.name,r)):Assert(!1,LangMgr.getValueByKey("skillError",e.id,e.lv,t.id,t.lv));else if(t.tarEff&&e.tarEff){var a=DataCenter.ins().SkillsEffectsConfig[t.tarEff[0]],l=DataCenter.ins().SkillsEffectsConfig[e.tarEff[0]],h=Math.floor(e.id/1e3);switch(h){case 24:r=Math.ceil(1e3*(l.args.d-a.args.d))/10,o=LangMgr.getValueByKey("skillDangeAdd",e.name,r);break;case 32:r=l.args.c-a.args.c,o=LangMgr.getValueByKey("skillHelpAdd",e.name,r);break;case 33:r=l.args.c-a.args.c,o=LangMgr.getValueByKey("skillLossHP",e.name,r);break;case 34:r=l.args.c-a.args.c,o=LangMgr.getValueByKey("skillDefenceAdd",e.name,r);break;case 35:r=l.args.a-a.args.a,o=LangMgr.getValueByKey("skillSSLevelAdd",r)}r=l.args.d-a.args.d}else e.tarEff&&Assert(!1,LangMgr.getValueByKey("skillError1",e.id,e.lv,t.id,t.lv));var u=this["skillItem"+(i+1)];s.text=o;var p=u.x+u.width/2-s.textWidth/2,c=u.y+u.height/4;s.x=p,s.y=c,this.addChild(s);var d=new GameMovieClip,g=u.icon.parent.localToGlobal(u.icon.x,u.icon.y);this.globalToLocal(g.x+u.icon.width/2,g.y+u.icon.height/2,g),d.x=g.x,d.y=g.y,d.playFile(PATH_EFF+"forgeSuccess",1),this.addChild(d);var m=egret.Tween.get(s);m.to({y:s.y-45},600).wait(1e3).call(function(){n.removeChild(s)},this)},e}(BasePanel);__reflect(SkillPanel.prototype,"SkillPanel");var SkillView=function(t){function e(){var e=t.call(this)||this;return e.lastIndex=0,e.isTopLevel=!0,e.skinName="SkillViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.tab,this.onTabTouch),this.addEventChange(this.roleSelect,this.onChange),this.addCustomEvent(266,this.updateRedPoint),this.addCustomEvent(268,this.updateRedPoint),this.addCustomEvent(267,this.updateRedPoint),this.addCustomEvent(218,this.updateRedPoint),this.addCustomEvent(233,this.updateRedPoint),this.addCustomEvent(456,this.updateRedPoint),this.addCustomEvent(461,this.updateRedPoint),this.addCustomEvent(83,this.updateRedPoint),this.addCustomEvent(658,this.onBagUseMiji),this.addCustomEvent(262,this.updateRedPoint),this.addCustomEvent(258,this.updateRedPoint),this.addCustomEvent(259,this.updateRedPoint),this.addCustomEvent(260,this.updateRedPoint),this.addCustomEvent(261,this.updateRedPoint),this.checkPage();var i=void 0!=t[0]?t[0]:0,n=t[1]?t[1]:0;this.viewStack.selectedIndex=this.tab.selectedIndex=i,this.roleSelect.setCurRole(n),this.setOpenIndex(i)},e.prototype.checkPage=function(){this.ashtartePanel.parent||this.viewStack.addChild(this.ashtartePanel),this.redPoint4.parent||this.redPointGroup.addChild(this.redPoint4)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this);var i=UIMgr.ins().getView(GameBottomView);i&&i.closeNav(GameBottomView.NAV_SKILL);for(var n=this.viewStack.numChildren,o=0;n>o;o++)this.viewStack.getChildAt(o).close()},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.onTabTouching=function(t){return e.checkIsOpen(t.currentTarget.selectedIndex)?void 0:void t.preventDefault()},e.prototype.setOpenIndex=function(t){var e,i;switch(this.roleSelect.openRole(),this.help.visible=!1,t){case 0:this.skillPanel.open(),this.skillTitle.source="biaoti_jineng";break;case 1:e=DataCenter.ins().CalcForceBaseConfig.openLevel,i=DataCenter.ins().CalcForceBaseConfig.openGuanqia,copyControl.guanqiaID<=i?(tipsControl.showTips(LangMgr.getValueByKey("tipsPass",i)),t=this.tab.selectedIndex=this.viewStack.selectedIndex=this.lastIndex):(this.calcForcePanel.open(this.roleSelect.getCurRole()),this.skillTitle.source="biaoti_neigong");break;case 2:e=DataCenter.ins().MeridiansCommonConfig.openLevel,ActorControl.level<e?(tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",e)),t=this.tab.selectedIndex=this.viewStack.selectedIndex=this.lastIndex):(this.meridiansPanel.open(),this.skillTitle.source="biaoti_jingmai");break;case 3:var n=EsotericaControl.ZsLv;reincarnateControl.lv<n?(tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",n)),t=this.tab.selectedIndex=this.viewStack.selectedIndex=this.lastIndex):(this.esotericaPanel.open(),this.skillTitle.source="biaoti_miji");break;case 4:ashtarteControl.ZhanLingOpen()?(this.help.visible=!0,this.roleSelect.hideRole(),this.ashtartePanel.open(),this.skillTitle.source="biaoti_zhanling"):tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().AshtarteConfig.openserverday,DataCenter.ins().AshtarteConfig.openzhuanshenglv))}this.lastIndex!=t?(this.viewStack.getElementAt(this.lastIndex).close(),this.lastIndex=t):this.tab.selectedIndex=this.viewStack.selectedIndex=t,this.updateRedPoint()},e.checkIsOpen=function(t){var e,i;switch(t){case 0:break;case 1:if(e=DataCenter.ins().CalcForceBaseConfig.openLevel,i=DataCenter.ins().CalcForceBaseConfig.openGuanqia,copyControl.guanqiaID<=i)return tipsControl.showTips(LangMgr.getValueByKey("tipsPass",i)),!1;break;case 2:if(e=DataCenter.ins().MeridiansCommonConfig.openLevel,ActorControl.level<e)return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",e)),!1;break;case 3:var n=EsotericaControl.ZsLv;if(reincarnateControl.lv<n)return tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",n)),!1;break;case 4:if(!ashtarteControl.ZhanLingOpen())return tipsControl.showTips(LangMgr.getValueByKey("fbShow1",DataCenter.ins().AshtarteConfig.openserverday,DataCenter.ins().AshtarteConfig.openzhuanshenglv)),!1}return!0},e.prototype.updateRedPoint=function(){TimerMgr.ins().isExists(this.updateRed,this)||TimerMgr.ins().doTimer(100,1,this.updateRed,this)},e.prototype.onBagUseMiji=function(t){for(var e=heroControl.subRolesLen,i=0;e>i;i++)if(!esotericaControl.hasEquipMiji(t,i)){this.roleSelect.setCurRole(i),this.setRoleId(i);break}this.esotericaPanel.onBagUseMiji(t)},e.prototype.updateRed=function(){this.redPoint0.visible=CommonFun.andState(skillControl.canGrewupSkill()),this.redPoint1.visible=calcForceControl.canUp(),this.redPoint2.visible=this.jingMaiCanUp(),this.redPoint3.visible=esotericaControl.isMjiSum(),this.redPoint4.visible=ashtarteControl.checkRedPoint();var t=heroControl.subRolesLen;this.roleSelect.clearRedPoint();for(var e=0;t>e;e++){var i=void 0;if(0==this.tab.selectedIndex)i=skillControl.canGrewupAllSkills(e);else if(1==this.tab.selectedIndex)i=calcForceControl.canUpById(e);else if(2==this.tab.selectedIndex){var n=heroControl.roles[e].jingMaiData;i=n.jingMaiCanUp()}else 3==this.tab.selectedIndex&&(i=esotericaControl.isMjiSum());this.roleSelect.showRedPoint(e,i)}},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole())},e.prototype.setRoleId=function(t){t!=this.skillPanel.curRole&&(this.calcForcePanel.curRole=this.esotericaPanel.curRole=this.skillPanel.curRole=this.meridiansPanel.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.help:4==this.viewStack.selectedIndex&&HelpControl.openHelpWin(35)}},e.openCheck=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t[0]||0;return e.checkIsOpen(n)},e.prototype.jingMaiCanUp=function(){var t;for(var e in heroControl.roles)if(t=heroControl.roles[e].jingMaiData,t.jingMaiCanUp()){var i=DataCenter.ins().MeridiansCommonConfig.openLevel;if(ActorControl.level>=i)return!0}return!1},e}(BaseEuiView);__reflect(SkillView.prototype,"SkillView");var SkillItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(BaseItemRender);__reflect(SkillItemRenderer.prototype,"SkillItemRenderer");var SmeltControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.smeltLogs=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.upSmeltItemLogInfo()},e.prototype.checkOpenSystem=function(){var t=DataCenter.ins().SpokesPersonSmeltBaseConfig;return spokesPersonControl.checkBaseOpen({level:0,pfIdLimit:t.pfIdLimit,pfIdOpenLimit:t.pfIdOpenLimit,openTimeLt:t.openTimeLt,openTimeGt:t.openTimeGt})},e.prototype.getLinkText=function(t){return t?t:""},e.prototype.upSmeltItemLogInfo=function(){},e.prototype.downSmeltItemLogInfo=function(t){this.smeltLogs=[];for(var e=0;t.length>e;e++){var i=t[e][0],n=t[e][1],o=DataCenter.ins().SpokesPersonSmeltBaseConfig.smeltLog;o=StringUtils.replace(o,""+i,""+n),this.smeltLogs.push(o)}},e.prototype.downSmeltItemLogAdd=function(t,e){var i=DataCenter.ins().SpokesPersonSmeltBaseConfig.smeltLog;i=StringUtils.replace(i,""+t,""+e),this.smeltLogs.push(i),this.smeltLogs.length>DataCenter.ins().SpokesPersonSmeltBaseConfig.maxShowLogs&&this.smeltLogs.shift(),crossFieldControl.isCross||(35==MapControl.copyType||UIMgr.ins().getView(UnionWarUiInfoView)||tipsControl.showLinkTips(i,DataCenter.ins().SpokesPersonSmeltBaseConfig.maxShowLogsTips),this.dispatchSmeltTips(i))},e.prototype.dispatchSmeltTips=function(t){EventMgr.ins().dispatch(88,t)},__decorate([up(37)],e.prototype,"upSmeltItemLogInfo",null),__decorate([down(33,[[8,5]])],e.prototype,"downSmeltItemLogInfo",null),__decorate([down(34,[8,5])],e.prototype,"downSmeltItemLogAdd",null),e=__decorate([protocolsId(4)],e)}(BaseSystem);__reflect(SmeltControl.prototype,"SmeltControl");var SmeltEquipPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.viewIndex=0,e.lastOutEquips=!1,e.lastCount=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.smeltEquips=[],this.smeltEquips.length=9,this.itemList.itemRenderer=SmeltItemRenderer,this.dataInfo=new eui.ArrayCollection(this.smeltEquips),this.itemList.dataProvider=this.dataInfo,this.eff=new GameMovieClip,this.eff=new GameMovieClip,this.eff.x=70,this.eff.y=30,this.eff.scaleX=.9,this.eff.scaleY=1,this.eff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.operate=t[0],this.addEventTouchTap(this.autoSmeltBtn,this.onTap),this.addEventTouchTap(this.itemList,this.onTap),this.addEventTouchTap(this.backbtn,this.onTap),this.addEventTouchEnd(this,this.onEnd),payControl.franchise||GlobalModel.oneKeySmelt?this.addEventTouchTap(this.smeltBtn,this.onTap):this.addLongPress(this.smeltBtn,this.onLongTap),this.setItemData(),this.addCustomEvent(585,this.setItemList),this.addCustomEvent(117,this.smeltComplete),this.addCustomEvent(117,this.smeltShowTips),this.addCustomEvent(659,this.smeltComplete),this.addCustomEvent(659,this.smeltShowTips),this.addCustomEvent(78,this.smeltComplete),this.addCustomEvent(78,this.smeltShowTips),this.ybTag.visible=3==this.operate&&equipControl.getYbOverTime(),this.setSmeltLabel()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.eff),TimerMgr.ins().remove(this.AutoSmeltEquip,this),smeltControl.autoSmelt=!1,smeltControl.longSmelt=!1,this.lastOutEquips=!1,this.lastCount=0},e.prototype.onEnd=function(){if(e.move&&smeltControl.longSmelt){smeltControl.longSmelt=!1,this.lastOutEquips=!1,this.lastCount=0;for(var t=0,i=0;i<this.smeltEquips.length;i++)this.smeltEquips[i]&&t++;if(t==this.smeltEquips.length)for(var i=0;i<this.itemList.numChildren;i++){var n=this.itemList.getChildAt(i);this.playFly(n)}}},e.prototype.smeltShowTips=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e],n=DataCenter.ins().EquipConfig[i.itemId];if(n){var o=DataCenter.ins().ItemConfig[n.id];if(o){var s=ItemUtils.getQualityColor(o),r=LangMgr.getValueByKey("bagGet")+s+"&T:"+o.name+" x "+i.count+"|",a=this.smeltBtn.localToGlobal();tipsControl.showEverTips({str:r,x:a.x-25,y:a.y-45})}}}},e.prototype.smeltComplete=function(){for(var t=this.itemList.numChildren;t--;){var i=this.itemList.getChildAt(t);i.data&&i.playEff()}if(e.move&&!smeltControl.autoSmelt&&!smeltControl.longSmelt)for(var n=0;n<this.itemList.numChildren;n++){var i=this.itemList.getChildAt(n);i.data&&this.playFly(i)}this.setItemData()},e.prototype.playFly=function(t){if(UIMgr.playFun&&UIMgr.ins().isShow(PortalView)&&t){var i=new eui.Image("ZScoin");i.x=t.x+t.width>>1,i.y=t.y+t.height>>1,TimerMgr.ins().doTimer(e.flyTime,1,function(){TweenUtil.LineTo(i,t,UIMgr.playFun.recharge1,UIMgr.ins().getView(SmeltEquipView),{time:1700})},this)}},e.prototype.setItemData=function(){if(this.smeltEquips=backpackControl.getOutEquips(this.operate),this.dataInfo.replaceAll(this.smeltEquips),e.move){if((smeltControl.autoSmelt||smeltControl.longSmelt)&&!this.lastOutEquips){for(var t=0,i=0;i<this.smeltEquips.length;i++)this.smeltEquips[i]&&t++;if(this.lastCount>t){this.lastOutEquips=!0;for(var i=0;i<this.lastCount;i++){var n=this.itemList.getChildAt(i);this.playFly(n)}}}this.lastCount=0;for(var i=0;i<this.smeltEquips.length;i++)this.smeltEquips[i]&&this.lastCount++}var o=LangMgr.getValueByKey("smeltCancel"+this.operate);o!=this.smeltBtn.label&&this.setBtnLabel()},e.prototype.setItemList=function(t){this.dataInfo.replaceAll(t),this.itemList.dataProvider=this.dataInfo},e.prototype.getGuildButton=function(){return this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.parent||this.btnGroup.addChild(this.eff),this.smeltBtn},e.prototype.onLongTap=function(t){t==this.smeltBtn&&(smeltControl.longSmelt=!0),this.onTap({currentTarget:t})},e.prototype.onTap=function(t){switch(t.currentTarget){case this.smeltBtn:if(payControl.franchise||GlobalModel.oneKeySmelt){var e=LangMgr.getValueByKey("smeltCancel"+this.operate);e==this.smeltBtn.label?(this.setBtnLabel(),TimerMgr.ins().remove(this.AutoSmeltEquip,this),smeltControl.autoSmelt=!1,this.lastOutEquips=!1):TimerMgr.ins().isExists(this.AutoSmeltEquip,this)||(this.smeltBtn.label=e,TimerMgr.ins().doTimer(150,0,this.AutoSmeltEquip,this),smeltControl.autoSmelt=!0)}else{DisplayUtils.removeFromParent(this.eff);var i=this.sendEquip(this.operate);i&&SoundUtils.ins().playEffect(SoundUtils.SMELT)}break;case this.autoSmeltBtn:if(payControl.franchise||GlobalModel.oneKeySmelt)return;warnControl.show(LangMgr.getValueByKey("smeltMonthCard"+this.operate),function(){UIMgr.ins().open(WelfareView,3),UIMgr.ins().close(SmeltEquipView)},this);break;case this.itemList:var n=t.target;if(n&&n.data){var o=this.smeltEquips.indexOf(n.data);o>=0&&(this.smeltEquips.splice(o,1),n.data=null)}break;case this.backbtn:UIMgr.ins().close(SmeltEquipView)}},e.prototype.AutoSmeltEquip=function(){DisplayUtils.removeFromParent(this.eff);var t=this.sendEquip(this.operate);t?SoundUtils.ins().playEffect(SoundUtils.SMELT):(this.setBtnLabel(),TimerMgr.ins().remove(this.AutoSmeltEquip,this),smeltControl.autoSmelt=!1,this.lastOutEquips=!1)},e.prototype.setBtnLabel=function(){this.updateBtn(),this.setSmeltLabel()},e.prototype.updateBtn=function(){this.autoSmeltGroup&&(payControl.franchise||GlobalModel.oneKeySmelt)&&DisplayUtils.removeFromParent(this.autoSmeltGroup)},e.prototype.setSmeltLabel=function(){payControl.franchise||GlobalModel.oneKeySmelt?this.smeltBtn.label=LangMgr.getValueByKey("smeltOneKeySmelt"+this.operate):(this.smeltBtn.label=LangMgr.getValueByKey("smeltKeySmelt"+this.operate),this.autoSmeltBtn.label=LangMgr.getValueByKey("smeltOneKeySmelt"+this.operate))},e.prototype.sendEquip=function(t){var e=null;switch(this.operate){case 0:case 3:e=equipControl.upSmeltEquip(this.viewIndex,this.smeltEquips);break;case 1:e=backpackControl.upDamageItem(this.viewIndex,this.smeltEquips);break;case 2:e=soulBoneControl.upResolveItem(this.viewIndex,this.smeltEquips)}return e},e.flyTime=1e3,e.move=0,e}(BasePanel);__reflect(SmeltEquipPanel.prototype,"SmeltEquipPanel");var SmeltEquipView=function(t){function e(){var e=t.call(this)||this;return e.linkList=[],e.skinName="SmeltEquipViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.operate=t[0]||0,0==this.operate&&smeltControl.checkOpenSystem()&&(this.operate=3),this.smeltTitle.text=LangMgr.getValueByKey("smeltName"+this.operate),this.nomarlDesc.text=LangMgr.getValueByKey("smeltTips"+this.operate),this.lastSelect=0,this.smeltEquipPanel.open(this.operate),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(88,this.showSmeltLog),this.ybTipsGroup.visible=3==this.operate&&smeltControl.checkOpenSystem(),this.nomarlDesc.visible=this.nomarlTab.visible=!this.ybTipsGroup.visible,TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.setTime()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.smeltEquipPanel.close(),this.linkList=[],TimerMgr.ins().remove(this.setTime,this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.showSmeltLog=function(t){var e=DataCenter.ins().SpokesPersonSmeltBaseConfig.maxShowLogsTips,i=ObjectPool.pop("LinkTipsView");if(i.bottom=0,i.horizontalCenter=DataCenter.ins().ClientGlobalConfig.gotoPosTips.horizontalCenter,i.labelText=t,this.ybnoticeGroup.addChild(i),this.linkList.unshift(i),!isNaN(e)&&this.linkList.length>e)for(var n=0;this.linkList.length>e;n++){var o=this.linkList.pop();this.removeLink(o)}if(this.linkList.length){this.addEventRemovedFromStage(i,this.removeLinkTip);for(var n=this.linkList.length-1;n>=0;n--)this.linkList[n].bottom=i.bottom+37*n}},e.prototype.removeLinkTip=function(t){this.removeLink(t.currentTarget)},e.prototype.removeLink=function(t){var e=this.linkList.indexOf(t);-1!=e&&this.linkList.splice(e,1),t.bottom=0/0,t.horizontalCenter=0/0,this.removeEventRemovedFromStage(t,this.removeLinkTip),ObjectPool.push(t),DisplayUtils.removeFromParent(t)},e.prototype.setTime=function(){var t=equipControl.ybTimers-GameServer.serverTime;if(t>0){t=Math.floor(t/DateUtils.MS_PER_SECOND);var e=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3);this.actTime.text=LangMgr.getValueByKey("doubleGoldTime",e),this.actTime.parent||this.nomarlDesc0.parent.addChild(this.actTime)}else DisplayUtils.removeFromParent(this.actTime),this.actTime.text="",TimerMgr.ins().remove(this.setTime,this)},e}(BaseEuiView);__reflect(SmeltEquipView.prototype,"SmeltEquipView");var SmeltItemPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.itemDataList=[],this.selectList=[],this.smeltEquips=[],this.smeltEquips.length=9,this.itemList.itemRenderer=SmeltItemRenderer,this.getItemList.itemRenderer=SmeltGainItemRenderer,this.dataInfo=new eui.ArrayCollection(this.smeltEquips),this.itemList.dataProvider=this.dataInfo,this.getItemCollection=new eui.ArrayCollection,this.getItemList.dataProvider=this.getItemCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemDataList=t[0],this.addEventTouchTap(this.smeltBtn,this.onTap),this.addEventTouchTap(this.itemList,this.onTap),this.addEventTouchTap(this.backbtn,this.onTap),this.setItemData(),this.addCustomEvent(171,this.smeltComplete)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.smeltComplete=function(){for(var t=0;t<this.selectList.length;t++)for(var e=0;e<this.itemList.numElements;e++){var i=this.itemList.dataProvider.getItemAt(e);if(i.handle==this.selectList[t].handle){var n=this.itemList.getVirtualElementAt(e);this.itemList.removeChild(n),this.itemDataList[e]&&this.itemDataList.splice(e,1);break}}this.selectList=[],SoundUtils.ins().playEffect(SoundUtils.SMELT),this.setItemData()},e.prototype.setItemData=function(){this.smeltEquips=this.updateList(),this.dataInfo.replaceAll(this.smeltEquips),this.updateFJlist()},e.prototype.updateList=function(){for(var t=[],e=0;e<this.smeltEquips.length&&this.itemDataList[e];e++)t.push(this.itemDataList[e]);return t},e.prototype.updateFJlist=function(){var t=[];for(var e in this.selectList){var i=DataCenter.ins().RongLuExpConfig[this.selectList[e].configID],n=!1;t:for(var o in t)for(var s in i.reward)if(t[o].id==i.reward[s].id){t[o].count+=i.reward[s].count*this.selectList[e].count,n=!0;break t}if(!n){var r=new RewardVo;r.type=i.reward[e].type,r.id=i.reward[e].id,r.count=i.reward[e].count*this.selectList[e].count,t.push(r)}}this.getItemCollection.replaceAll(t)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.smeltBtn:if(this.selectList.length<=0)return void tipsControl.showTips(LangMgr.getValueByKey("smeltNoChoose"));intensifyControl.upMeltItem(this.selectList);break;case this.itemList:var e=t.target;if(e&&e.data){var i=this.selectList.indexOf(e.data);-1==i?(e.selectFrame.visible=!0,this.selectList.push(e.data)):(e.selectFrame.visible=!1,this.selectList.splice(i,1))}this.updateFJlist();break;case this.backbtn:UIMgr.ins().close(SmeltItemView)}},e}(BasePanel);__reflect(SmeltItemPanel.prototype,"SmeltItemPanel");var SmeltItemView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SmeltItemViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.panel.open(t[0]),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.panel.close()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(SmeltItemView.prototype,"SmeltItemView");var SmeltGainItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.itemConfig=DataCenter.ins().ItemConfig[this.data.id],this.num=this.data.count,this.itemIcon.setData(this.itemConfig),this.setCount(this.num+""),this.nameTxt.text=this.itemConfig.name)},e}(ItemBase);__reflect(SmeltGainItemRenderer.prototype,"SmeltGainItemRenderer");var SmeltItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.mc=new GameMovieClip,this.mc.x=45,this.mc.y=40},e.prototype.dataChanged=function(){if(this.clear(),this.data instanceof ItemData){this.itemConfig=this.data.itemConfig,this.itemIcon.setData(this.itemConfig);var t=ItemUtils.getType(this.itemConfig),e=ItemUtils.getJob(this.itemConfig);if(4==t)this.nameTxt.text=this.itemConfig.name;else if(24==t||98==t)this.count.text=this.data.count+"",this.nameTxt.text=this.itemConfig.name;else{var i=this.itemConfig?ItemUtils.getSubType(this.itemConfig):-1;i==IntensifyConst.EQUIP_POS[8]?this.nameTxt.text=this.itemConfig.name:this.nameTxt.text=isNaN(this.itemConfig.zsLevel)?"lv."+(this.itemConfig.level||1):LangMgr.getValueByKey("numberRotation",this.itemConfig.zsLevel),-1!=BackpackControl.fitleEquip.indexOf(this.itemConfig.id)&&(this.nameTxt.text=LangMgr.getValueByKey("shopNoLevel"))}this.itemIcon.imgJob.source=(0==t||4==t)&&e&&this.itemIcon.imgJob.visible?"job"+e+"Item":""}},e.prototype.onClick=function(){},e.prototype.playEff=function(){this.data&&(this.mc.playFile(PATH_EFF+"litboom",1),this.addChild(this.mc),this.selectFrame.visible=!1)},e.prototype.clear=function(){t.prototype.clear.call(this),this.itemIcon.imgJob.source=null},e}(ItemBase);__reflect(SmeltItemRenderer.prototype,"SmeltItemRenderer");var SoulBoneControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dunLeftTimes=0,e.dunPassID=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"soulBoneData",{get:function(){return this.soulboneData||(this.soulboneData=[]),this.soulboneData},enumerable:!0,configurable:!0}),e.prototype.checkOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().SoulBoneConfig.openserverday-1?!1:reincarnateControl.lv<DataCenter.ins().SoulBoneConfig.openzhuanshenglv?!1:!0},e.prototype.checkShowOpen=function(){return GameServer.serverOpenDay<DataCenter.ins().SoulBoneConfig.openserverday-1?!1:reincarnateControl.lv<DataCenter.ins().SoulBoneConfig.showzhuanshenglv?!1:!0},e.prototype.getSoulBoneItemsPos=function(t){var e=-1,i=DataCenter.ins().ItemConfig[t];return i&&(e=ItemUtils.getSubType(i)),e},e.prototype.getSoulBoneItemsList=function(t){var e=backpackControl.getBagGoodsByType(24);return this.getSoulBoneItemsFormLists(e,t)},e.prototype.getSoulBoneItemsFormLists=function(t,e,i){void 0===i&&(i=24);for(var n=[],o=0;o<t.length;o++)ItemUtils.getType(t[o].itemConfig)==i&&this.getSoulBoneItemsPos(t[o].itemConfig.id)==e&&n.push(t[o]);return n.sort(function(t,e){var i=DataCenter.ins().SoulBoneEquipConfig[t.configID],n=DataCenter.ins().SoulBoneEquipConfig[e.configID];return n.stage-i.stage}),n},e.prototype.getSoulJadeRedPoint=function(t,e){if(!this.soulBoneData[t])return!1;for(var i=0;i<this.soulBoneData[t].items[e].soulJades.length;i++){var n=this.getSoulJadeItemRedPoint(t,e,i);if(n)return!0}return!1},e.prototype.getSoulJadeItemRedPoint=function(t,e,i){if(!this.soulBoneData[t])return!1;if(!this.soulBoneData[t].items[e].itemId||i+1>DataCenter.ins().SoulBoneEquipConfig[this.soulBoneData[t].items[e].itemId].hunyuNum)return!1;var n=DataCenter.ins().SoulBoneConfig.hunyuType[e][i],o=this.soulBoneData[t].items[e].soulJades[i],s=DataCenter.ins().SoulBoneJadeEquipConfig[n][o+1];if(!s)return!1;if(!o&&0!=i){var r=DataCenter.ins().SoulBoneConfig.unlockCost[i+1];return ActorControl.yb>=r}if(s.cost){var a=backpackControl.getBagItemById(s.cost.id);return a&&a.count>=s.cost.count}return!1},e.prototype.getPosJadePower=function(t,e){var i=0;if(!this.soulBoneData[t]||!this.soulBoneData[t].items[e].itemId)return i;var n=DataCenter.ins().SoulBoneEquipConfig[this.soulBoneData[t].items[e].itemId];if(!n)return i;for(var o=n.hunyuNum,s=0;o>s;s++){var r=DataCenter.ins().SoulBoneConfig.hunyuType[e][s],a=this.soulBoneData[t].items[e].soulJades[s],l=DataCenter.ins().SoulBoneJadeEquipConfig[r][a];if(l){i+=BackpackControl.getAttrPower(l.attrs,heroControl.getSubRoleByIndex(t));var h=l.expower?l.expower:0;i+=h}}return i},e.prototype.getSoulBoneItemPower=function(t){var e=0,i=DataCenter.ins().SoulBoneEquipConfig[t];if(i){e+=BackpackControl.getAttrPower(i.attrs);var n=i.expower?i.expower:0;e+=n}return e},e.prototype.getSoulBonePosPower=function(t,e,i,n){var o=0;if(!this.soulBoneData[t])return o;var s=0;n&&(s+=this.getPosJadePower(t,e));var r=[],a=this.soulBoneData[t].items[e].itemId,l=DataCenter.ins().SoulBoneEquipConfig[a];if(l){o+=BackpackControl.getAttrPower(l.attrs,heroControl.getSubRoleByIndex(t));var h=l.expower?l.expower:0;o+=h,i&&(r=AttributeData.combineAtts(l.attrs))}var u=[];return i&&(u=this.getSuitAddBasicAttr(i,r)),o+=s+BackpackControl.getAttrPower(u)},e.prototype.getSuitAddBasicAttr=function(t,e){var i=[];if(t){var n=[];for(var o in t)for(var s in t[o])if(t[o][s].count.length>=+s){var r=t[o][s].stage,a=DataCenter.ins().SoulBoneSuitConfig[o][s][r];a&&a.specialAttrs&&n.push(a.specialAttrs/1e4)}for(var o=0;o<n.length;o++)for(var s=0;s<e.length;s++)i[s]||(i[s]=new AttributeData(e[s].type,0)),i[s].value+=e[s].value*n[o]}return i},e.prototype.getResonancePower=function(t){var e=0;if(!this.soulBoneData[t])return e;var i=this.getSuitData(t);for(var n in i)for(var o in i[n]){var s=i[n][o].stage;if(s){var r=i[n][o].count;if(!(r.length<+o)){var a=DataCenter.ins().SoulBoneSuitConfig[n][o][s];a.attrs&&(e+=BackpackControl.getAttrPower(a.attrs,heroControl.getSubRoleByIndex(t)));var l=a.expower?a.expower:0;e+=l}}}return e},e.prototype.getSuitData=function(t){var e={};if(!this.soulBoneData[t])return e;var i=[];for(var n in DataCenter.ins().SoulBoneConfig.suit)if(DataCenter.ins().SoulBoneSuitConfig[n]){i[+n]=[];for(var o in DataCenter.ins().SoulBoneConfig.suit[n]){var s=DataCenter.ins().SoulBoneConfig.suit[n][o],r=this.soulBoneData[t].items[s].itemId;r&&i[+n].push(DataCenter.ins().SoulBoneEquipConfig[r])}i[+n].sort(function(t,e){return e.stage-t.stage})}for(var o in DataCenter.ins().SoulBoneSuitConfig){e[o]={};for(var a in DataCenter.ins().SoulBoneSuitConfig[o]){e[o][a]={},e[o][a].count=[],e[o][a].stage=0;for(var l=0;+a>l&&i[+o][l];l++)e[o][a].count.push(i[+o][l].id),e[o][a].stage||(e[o][a].stage=i[+o][l].stage),e[o][a].stage>i[+o][l].stage&&(e[o][a].stage=i[+o][l].stage)}}return e},e.prototype.getSoulBonePosName=function(t){return DataCenter.ins().SoulBoneConfig.hunguName[t]},e.prototype.getSoulBoneItemQualityName=function(t,e){var i=e;return i||(i=DataCenter.ins().SoulBoneEquipConfig[t]?DataCenter.ins().SoulBoneEquipConfig[t].stage:1),LangMgr.getValueByKey("taste"+i)},e.prototype.calcSoulBoneTotalValue=function(t){var e=[],i=this.soulBoneData[t];if(!i)return e;for(var n=[],o=0;o<i.items.length;o++){var s=i.items[o].itemId,r=DataCenter.ins().SoulBoneEquipConfig[s];if(r){n=AttributeData.AttrAddition(n,r.attrs);for(var a=0;a<i.items[o].soulJades.length;a++)if(i.items[o].soulJades[a]){var l=DataCenter.ins().SoulBoneConfig.hunyuType[o][a],h=i.items[o].soulJades[a],u=DataCenter.ins().SoulBoneJadeEquipConfig[l][h];e=AttributeData.AttrAddition(e,u.attrs)}}}var p=[],c=this.getSuitData(t);p=this.getSuitAddBasicAttr(c,n);var d=[];for(var o in c)for(var a in c[o])if(c[o][a].count.length>=+a){var g=c[o][a].stage,m=DataCenter.ins().SoulBoneSuitConfig[o][a][g];m&&m.attrs&&(e=AttributeData.AttrAddition(e,m.attrs)),m&&m.specialAttrs&&d.push(m.specialAttrs/1e4)}for(var o=0;o<d.length;o++)for(var a=0;a<n.length;a++)n[a].value*=1+d[o];return AttributeData.AttrAddition(e,n)},e.prototype.getAttrStrByType=function(t){var e="";switch(t){case 2:e=LangMgr.getValueByKey("attributeOther2");break;case 4:e=LangMgr.getValueByKey("attributeOther4");break;case 5:e=LangMgr.getValueByKey("attributeOther5");break;case 6:e=LangMgr.getValueByKey("attributeOther6")}return e},e.prototype.getCurSoulBoneId=function(t,e){var i=this.soulBoneData[t];
if(!i)return 0;var n=i.items[e];return n?n.itemId:0},e.prototype.getNextSoulBoneId=function(t,e){var i=this.soulBoneData[t];if(!i)return 0;var n=i.items[e];return n?DataCenter.ins().SoulBoneEquipConfig[n.itemId].nextId:0},e.prototype.getNextSoudJadeConfig=function(t,e,i){if(!this.soulBoneData[t])return null;var n=DataCenter.ins().SoulBoneConfig.hunyuType[e][i],o=this.soulBoneData[t].items[e].soulJades[i];return DataCenter.ins().SoulBoneJadeEquipConfig[n][o+1]},e.prototype.getUpgradeRedPoint=function(t){var e=DataCenter.ins().SoulBoneEquipConfig[t];if(!e||!e.addStageCost)return!1;var i=BackpackControl.ins();for(var n in e.addStageCost){var o=i.getBagItemById(e.addStageCost[n].id);if(!o||o.count<e.addStageCost[n].count)return!1}return!0},e.prototype.upWearItems=function(t,e,i){return[t,e,i]},e.prototype.upSoulJade=function(t,e,i){return[t,e,i]},e.prototype.upSoulBoneItemUpgrade=function(t,e){return[t,e]},e.prototype.downSoulBoneInfo=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=void 0;n=this.soulBoneData[i]?this.soulBoneData[i]:new SoulBoneVo;for(var o=0;o<t[e][1].length;o++)n.init(t[e][1][o],o);this.soulBoneData[i]=n}EventMgr.ins().dispatch(70)},e.prototype.downSoulBoneItems=function(t,e,i){this.soulBoneData[t]||(this.soulBoneData[t]=new SoulBoneVo);var n=this.soulBoneData[t],o=n.items[e].itemId;n&&(n.items[e].itemId=i),0==o&&0!=i&&this.dispatchNothing2Wear(1,e),0==i&&0!=o&&this.dispatchWear2Noting(0,e),EventMgr.ins().dispatch(73)},e.prototype.dispatchNothing2Wear=function(t,e){EventMgr.ins().dispatch(71,[t,e])},e.prototype.dispatchWear2Noting=function(t,e){EventMgr.ins().dispatch(72,[t,e])},e.prototype.downSoulJade=function(t,e,i,n){this.soulBoneData[t]&&(this.soulBoneData[t].items[e].soulJades[i-1]=n),EventMgr.ins().dispatch(74)},e.prototype.downSoulBoneItemUpgrade=function(t,e,i){this.soulBoneData[t]&&(this.soulBoneData[t].items[e].itemId=i),this.dispatchNothing2Wear(1,e),EventMgr.ins().dispatch(75)},e.prototype.upEnterDun=function(){},e.prototype.upSweepDun=function(){},e.prototype.downSweepDun=function(t,e,i){this.dunLeftTimes=e;for(var n,o=[],s=0;s<i.length;s++)n=new RewardVo,n.init(i[s]),o.push(n);UIMgr.ins().open(SoulBoneDunSweepView,t,o),EventMgr.ins().dispatch(76)},e.prototype.downDunInfo=function(t,e){this.dunPassID=t,this.dunLeftTimes=DataCenter.ins().SoulBoneConfig.dayRewardCount-e,EventMgr.ins().dispatch(77)},e.prototype.downDunEndTime=function(t){this.dunEndTime=t},e.prototype.getHunShouDunLeftTime=function(){return Math.floor((1e3*this.dunEndTime+1e3*DateUtils.SECOND_2010-GameServer.serverTime)/1e3)},e.prototype.isHunShouDunOpen=function(){return reincarnateControl.lv>=DataCenter.ins().SoulBoneConfig.needZsLv&&GameServer.serverOpenDay+1>=DataCenter.ins().SoulBoneConfig.fbOpenDay},e.prototype.showHunShouDun=function(){return reincarnateControl.lv>=DataCenter.ins().SoulBoneConfig.showZsLv&&GameServer.serverOpenDay+1>=DataCenter.ins().SoulBoneConfig.fbOpenDay},e.prototype.showHunShouDunInDaily=function(){return reincarnateControl.lv>=DataCenter.ins().SoulBoneConfig.zhuanyizslevel&&GameServer.serverOpenDay+1>=DataCenter.ins().SoulBoneConfig.zhuanyiday},e.prototype.showHunShouRed=function(){return this.isHunShouDunOpen()?this.dunLeftTimes>0:!1},e.prototype.upResolveItem=function(t,e){for(var i=[],n=0;n<e.length;++n)null!=e[n]&&i.push([e[n].handle,e[n].count]);return 0==i.length?!1:[t,i]},e.prototype.downResolveItemComplete=function(t,e,i){if(0==t)return void tipsControl.showTips(LangMgr.getValueByKey("roleTips9"));for(var n=[],o=0;o<i.length;o++){var s={};s.itemId=i[o][0],s.count=i[o][1],n.push(s)}EventMgr.ins().dispatch(78,n)},__decorate([up(2,[1,1,3])],e.prototype,"upWearItems",null),__decorate([up(3,[1,1,1])],e.prototype,"upSoulJade",null),__decorate([up(4,[1,1])],e.prototype,"upSoulBoneItemUpgrade",null),__decorate([down(1,[ByteConst.SoulBoneVos])],e.prototype,"downSoulBoneInfo",null),__decorate([down(2,[1,1,3])],e.prototype,"downSoulBoneItems",null),__decorate([down(3,[1,1,1,3])],e.prototype,"downSoulJade",null),__decorate([down(4,[1,1,3])],e.prototype,"downSoulBoneItemUpgrade",null),__decorate([up(5)],e.prototype,"upEnterDun",null),__decorate([up(6)],e.prototype,"upSweepDun",null),__decorate([down(6,[3,3,ByteConst.RewardVos])],e.prototype,"downSweepDun",null),__decorate([down(7,[3,3])],e.prototype,"downDunInfo",null),__decorate([down(8,[3])],e.prototype,"downDunEndTime",null),__decorate([up(100,[3,[10,3]])],e.prototype,"upResolveItem",null),__decorate([down(100,[3,3,[3,3]])],e.prototype,"downResolveItemComplete",null),e=__decorate([protocolsId(74)],e)}(BaseSystem);__reflect(SoulBoneControl.prototype,"SoulBoneControl");var AmuseTarget103Panel1=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmuseTarget103Panel1Skin",e}return __extends(e,t),e.prototype.open=function(){this.listView.itemRenderer=AmuseTarget103Panel1ItemRender,this.addCustomEvent(392,this.initList),this.initList(),TimerMgr.ins().doTimer(1e3,0,this.updateTime,this)},e.prototype.updateTime=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this._activityData.startTime)-GameServer.serverTime)/1e3),e=Math.floor((DateUtils.formatMiniDateTime(this._activityData.endTime)-GameServer.serverTime)/1e3);t>=0?this.actTime.text=LangMgr.getValueByKey("doubleNoActivity"):0>=e?this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"):this.actTime.text=DateUtils.getFormatBySecond(e,DateUtils.TIME_FORMAT_5,3)},e.prototype.initList=function(){var t=DataCenter.ins().Amusement103Config[this.activityID],e=DataCenter.ins().AmusementConfig[this.activityID];this.actInfo.text=e.desc,this._activityData=amusementControl.activityData[this.activityID];var i=[],n=[];for(var o in t){var s=this._activityData.getUseTimes(t[o].index);s>=t[o].num?n.push(t[o]):i.push(t[o])}this.listView.dataProvider=new eui.ArrayCollection(i.concat(n))},e.prototype.updateData=function(){this.initList()},e.prototype.close=function(){this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e}(BasePanel);__reflect(AmuseTarget103Panel1.prototype,"AmuseTarget103Panel1");var SoulBoneItemsVo=function(){function t(){this.itemId=0,this.soulJades=[];for(var t=0;t<DataCenter.ins().SoulBoneConfig.hunyuCount;t++)this.soulJades.push(0)}return t}();__reflect(SoulBoneItemsVo.prototype,"SoulBoneItemsVo");var SoulBoneVo=function(){function t(){}return Object.defineProperty(t.prototype,"items",{get:function(){if(!this._items){this._items=[];for(var t=0;t<DataCenter.ins().SoulBoneConfig.equipCount;t++){var e=new SoulBoneItemsVo;this._items.push(e)}}return this._items},set:function(t){this._items=t},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e){this.items[e].itemId=t[0];for(var i=0;i<t[1].length;++i)this.items[e].soulJades[i]=t[1][i]},t}();__reflect(SoulBoneVo.prototype,"SoulBoneVo");var SoulBoneAttrView=function(t){function e(){var e=t.call(this)||this;return e._lastX=0,e.proShowList=[],e.skinName="HeartMethodAttrViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.proShowList=[2,4,5,6],e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curRole=t[0],this.setRoleAttr(this.curRole);var i=heroControl.subRolesLen;i>1&&(this.addEventTouchTap(this.leftBtn,this.onTouch),this.addEventTouchTap(this.rightBtn,this.onTouch),this.addEventTouchBegin(this.bg,this.onMove),this.addEventTouchEnd(this.bg,this.onMove)),this.addEventTouchEnd(this,this.otherClose)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=heroControl.subRolesLen;i>1&&(this.removeEventTouchTap(this.leftBtn,this.onTouch),this.removeEventTouchTap(this.rightBtn,this.onTouch),this.removeEventTouchBegin(this.bg,this.onMove),this.removeEventTouchEnd(this.bg,this.onMove)),this.removeEventTouchEnd(this,this.otherClose)},e.prototype.onClose=function(t){UIMgr.ins().close(this)},e.prototype.otherClose=function(t){t.target==this.bg||t.target instanceof eui.Button||UIMgr.ins().close(this)},e.prototype.onMove=function(t){switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this._lastX=t.localX;break;case egret.TouchEvent.TOUCH_END:this._lastX>t.localX?this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200)):this._lastX<t.localX&&this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200))}},e.prototype.moveAttr=function(t){var e,i=egret.Tween.get(this.attrGroup);e=t>0?0:242,i.to({x:this.attrGroup.x+t,alpha:0},200).to({x:e},200).to({x:80,alpha:1},200)},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.leftBtn:this.curRole>0&&(this.curRole--,this.setRoleAttr(this.curRole),this.moveAttr(200));break;case this.rightBtn:this.curRole<2&&(this.curRole++,this.setRoleAttr(this.curRole),this.moveAttr(-200))}},e.prototype.setRoleAttr=function(t){var e=heroControl.getSubRoleByIndex(t);this.job.source="op_"+e.job;for(var i="",n="",o=0,s=0,r=soulBoneControl.calcSoulBoneTotalValue(e.index),a=0;a<this.proShowList.length;a++){s=this.proShowList[a],o=0;for(var l=0;l<r.length;l++)if(r[l].type==s){o=r[l].value;break}i+=Math.floor(o)+"",n+=soulBoneControl.getAttrStrByType(s)+":",a<this.proShowList.length-1&&(i+="\n",n+="\n")}this.attr.text=i,this.attrName.text=n,this.setBtn()},e.prototype.setBtn=function(){var t=heroControl.subRolesLen;this.leftBtn.visible=this.curRole>0,this.rightBtn.visible=this.curRole<t-1},e}(BaseEuiView);__reflect(SoulBoneAttrView.prototype,"SoulBoneAttrView");var SoulBoneDunPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.itemList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(77,this.update),this.addCustomEvent(76,this.updateTimes),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.update=function(){this.updateTimes();var t=soulBoneControl.dunPassID?soulBoneControl.dunPassID+1:1;this._isMax=!1,t>Object.keys(DataCenter.ins().SoulBoneCopyConfig).length&&(this._isMax=!0,t--);var e=DataCenter.ins().SoulBoneCopyConfig[t];this._zsLvEough=reincarnateControl.lv>=e.zsLevelLimit,this.zsLimit.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("babelFightNeed",this._zsLvEough?LangMgr.getColor("color62"):LangMgr.getColor("color22"),e.zsLevelLimit)),this._collect||(this._collect=new ArrayCollection,this.itemList.dataProvider=this._collect),this._collect.source=e.award,this.btnSweep.visible=DataCenter.ins().SoulBoneConfig.sweepLayer<=soulBoneControl.dunPassID,this.sweepInfoText.visible=this.sweepInfo.visible=this.btnSweep.visible,this.btnChallenge.visible=!this._isMax,this.btnChallenge.visible?this.btnChallenge.parent||this.btnSweep.parent&&this.btnSweep.parent.addChild(this.btnChallenge):DisplayUtils.removeFromParent(this.btnChallenge),this.btnSweep.visible?this.btnSweep.parent||this.btnChallenge.parent&&this.btnChallenge.parent.addChildAt(this.btnSweep,0):DisplayUtils.removeFromParent(this.btnSweep),this.max.visible=this._isMax,this.zsLimit.visible=!this._isMax,this.sweepInfo.visible&&(this.sweepInfo.text=soulBoneControl.dunPassID+""),this.bossName.source=e.pic,this._bossMc||(this._bossMc=ObjectPool.pop("GameMovieClip"),this.Boss.addChild(this._bossMc)),this._bossMc.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(DataCenter.ins().MonstersConfig[e.monster].avatar+"_3s"),-1)},e.prototype.updateTimes=function(){this.lbTime.textFlow=TextUtils.generateTextFlow("|c:"+(soulBoneControl.dunLeftTimes?LangMgr.getColor("color62"):LangMgr.getColor("color22"))+"&T:"+soulBoneControl.dunLeftTimes+"|")},e.prototype.onTouch=function(t){switch(t.target){case this.btnSweep:case this.btnChallenge:if(copyControl.checkInFB())return;if(t.target!=this.btnSweep&&!crossArenaControl.checkIsMatching())return;if(!soulBoneControl.dunLeftTimes)return void tipsControl.showTips(LangMgr.getValueByKey("tongTimeEnought"));t.target==this.btnSweep?soulBoneControl.upSweepDun():this._zsLvEough?this._isMax?tipsControl.showTips(LangMgr.getValueByKey("babelCurPass")):(soulBoneControl.upEnterDun(),UIMgr.ins().close(LadderView)):tipsControl.showTips(LangMgr.getValueByKey("tongRotationEnought"))}},e}(BasePanel);__reflect(SoulBoneDunPanel.prototype,"SoulBoneDunPanel");var SoulBoneDunSweepView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulBoneDunSweepViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._id=t[0],this._rewards=t[1],this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){this.reward.dataProvider=new ArrayCollection(this._rewards),this.times.textFlow=TextUtils.generateTextFlow("|c:"+(soulBoneControl.dunLeftTimes?LangMgr.getColor("color62"):LangMgr.getColor("color22"))+"&T:"+soulBoneControl.dunLeftTimes+"|"),this.fbName.text=DataCenter.ins().SoulBoneCopyConfig[this._id].fbName},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;case this.nextBtn:if(!soulBoneControl.dunLeftTimes)return void tipsControl.showTips(LangMgr.getValueByKey("tongTimeEnought"));soulBoneControl.upSweepDun()}},e}(BaseEuiView);__reflect(SoulBoneDunSweepView.prototype,"SoulBoneDunSweepView");var SoulBoneGroupView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulBoneGroupViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.roleId=t[0],this.id=t[1],this.updateShow()},e.prototype.updateShow=function(){this.itemData=[],this.init();var t=soulBoneControl.getSuitData(this.roleId);if(CommonUtils.getObjectLength(t)&&t[this.id]){this.itemData=[];var e=this.getPosColorName(this.id),i=[];for(var n in t[this.id])-1==i.indexOf(t[this.id][n].stage)&&i.push(t[this.id][n].stage);for(var o="",s=0;s<i.length;s++){var r=i[s];o=DataCenter.ins().SoulBoneConfig.suitName[this.id-1][1>=r?0:r-1];var a=[],l=[];for(var n in DataCenter.ins().SoulBoneSuitConfig[this.id]){for(var h=0;h<t[this.id][n].count.length;h++){var u=t[this.id][n].count[h],p=ItemUtils.getSubType(DataCenter.ins().ItemConfig[u]);-1==a.indexOf(p)&&a.push(p)}var c=DataCenter.ins().SoulBoneSuitConfig[this.id][n][r],d=0;d=t[this.id][n].stage==r&&t[this.id][n].count.length>=+n?ColorUtils.GREEN:ColorUtils.GRAY,c||(c=DataCenter.ins().SoulBoneSuitConfig[this.id][n][1]),c.dec&&l.push("|C:"+d+"&T:"+n+LangMgr.getValueByKey("HunJ")+c.dec)}for(var g="",n=0;n<e.length;n++){var d=0;d=-1==a.indexOf(e[n])?ColorUtils.GRAY:ColorUtils.GREEN,g+="|C:"+d+"&T:"+soulBoneControl.getSoulBonePosName(e[n])+"  "}this.itemData.push({qualityName:o,posName:g,suits:l})}if(1==i.length){var m=!0;if(soulBoneControl.soulBoneData[this.roleId])for(var n in soulBoneControl.soulBoneData[this.roleId].items)if(-1!=e.indexOf(Number(n))){var u=soulBoneControl.soulBoneData[this.roleId].items[n].itemId;if(!u||DataCenter.ins().SoulBoneEquipConfig[u].stage!=i[0]){m=!1;break}}if(m){var f=[];for(var n in DataCenter.ins().SoulBoneSuitConfig[this.id])if(t[this.id][+n]){var v=CommonUtils.getObjectLength(DataCenter.ins().SoulBoneSuitConfig[this.id][+n]),y=t[this.id][+n].stage;if(y!=v){for(var C=y+1,T=DataCenter.ins().SoulBoneConfig.suitName[this.id-1][1>=C?0:C-1],g="",h=0;h<e.length;h++)g+="|C:"+ColorUtils.GRAY+"&T:"+soulBoneControl.getSoulBonePosName(e[h])+"  ";for(var h in DataCenter.ins().SoulBoneSuitConfig[this.id]){var c=DataCenter.ins().SoulBoneSuitConfig[this.id][h][C];c.dec&&f.push("|C:"+ColorUtils.GRAY+"&T:"+h+LangMgr.getValueByKey("HunJ")+c.dec)}this.itemData.push({qualityName:T,posName:g,suits:f});break}}}}}for(var n=0;n<this.itemData.length;n++){var w=new SoulBoneGroupItemRenderer;w.data={qualityName:this.itemData[n].qualityName,posName:this.itemData[n].posName,suits:this.itemData[n].suits},this.content.addChild(w)}},e.prototype.getPosColorName=function(t){for(var e=[],i=0;i<DataCenter.ins().SoulBoneConfig.suit[t].length;i++)e.push(DataCenter.ins().SoulBoneConfig.suit[t][i]);return e},e.prototype.init=function(t){void 0===t&&(t=this.id);for(var e=1==t?LangMgr.getValueByKey("specal"):LangMgr.getValueByKey("hunHG"),i=LangMgr.getValueByKey("hunTips",e),n=DataCenter.ins().SoulBoneConfig.suit[t],o="",s=0;s<n.length;s++)o+="|C:"+ColorUtils.GRAY+"&T:"+soulBoneControl.getSoulBonePosName(n[s])+"  ";var r=[];for(var a in DataCenter.ins().SoulBoneSuitConfig[t]){var l=DataCenter.ins().SoulBoneSuitConfig[t][a][1];l.specialAttrs?r.push(LangMgr.getValueByKey("hunTips1",ColorUtils.GRAY,a,l.specialAttrs/100)):l.dec&&r.push(LangMgr.getValueByKey("hunTips2",ColorUtils.GRAY,a)+l.dec)}this.itemData.push({qualityName:i,posName:o,suits:r})},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(SoulBoneGroupView.prototype,"SoulBoneGroupView");var SoulBonePanel=function(t){function e(){var e=t.call(this)||this;return e.wireEffs=[],e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.resolveItem,this.onTap),this.addEventTouchTap(this.getItemTxt0,this.onTap),this.addEventTouchTap(this.executeBtn,this.onTap),this.addEventTouchTap(this.executeBtn0,this.onTap),this.addEventTouchTap(this.xiangxishuxing,this.onTap),this.addEventTouchTap(this.fenjie,this.onTap);for(var i=0;i<DataCenter.ins().SoulBoneConfig.equipCount;i++)this.addEventTouchTap(this["equip"+i],this.onSelect);this.addCustomEvent(578,this.updateUI),this.addCustomEvent(71,this.HunguItemsResult),this.addCustomEvent(72,this.HunguItemsResult),this.roleId=t[0],this.pos=t[1],this.initEff(),this.updateUI()},e.prototype.initEff=function(){this.posXian0=[this.HGliangxianzhi0,this.HGliangxianxie0],this.posXian1=[this.HGliangxianzhi1],this.posXian2=[this.HGliangxianzhi2,this.HGliangxianxie2],this.posXian3=[this.HGliangxianzhi3,this.HGliangxianxie3],this.posXian4=[this.HGliangxianzhi4,this.HGliangxianxie4],this.posXian5=[this.HGliangxianzhi5,this.HGliangxianxie5],this.posXian6=[this.HGliangxianzhi6,this.HGliangxianxie6],this.posXian7=[this.HGliangxianzhi7,this.HGliangxianxie7],this.effectPos=[this.effectPos0,this.effectPos1,this.effectPos2,this.effectPos3,this.effectPos4,this.effectPos5,this.effectPos6,this.effectPos7],this.liangdian=[this.liangdian0,this.liangdian1,this.liangdian2,this.liangdian3,this.liangdian4,this.liangdian5,this.liangdian6,this.liangdian7];var t=new GameMovieClip;t.playFile(PATH_EFF+"hguieffect1",-1),this.effect1quanshen.addChild(t),this.updateEff()},e.prototype.updateEff=function(){var t=soulBoneControl.soulBoneData[this.roleId];if(t){for(var e=0;8>e;e++)if(t.items[e].itemId){for(var i=0,n=this["posXian"+e];i<n.length;i++){var o=n[i];o.visible=!0}this.liangdian[e].visible=!0}for(var s in DataCenter.ins().SoulBoneConfig.suit){var r=+s;r&&this.playSuitEffect(r)}}},e.prototype.onSelect=function(t){for(var e=0;e<DataCenter.ins().SoulBoneConfig.equipCount;e++)if(this["equip"+e]&&(this["equip"+e].select.visible=!1,t.currentTarget==this["equip"+e])){this.pos=e,this["equip"+e].select.visible=!0;var i=soulBoneControl.soulBoneData[this.roleId];if(i&&i.items[e].itemId)UIMgr.ins().open(SoulBoneTipsView,!0,this.roleId,i.items[e].itemId);else{var n=soulBoneControl.getSoulBoneItemsList(e);n.length?soulBoneControl.upWearItems(this.roleId,e,n[0].configID):tipsControl.showTips(LangMgr.getValueByKey("hunTips5"))}}},e.prototype.updateUI=function(){for(var t=SoulBoneControl.ins(),e=t.getResonancePower(this.roleId),i=t.getSuitData(this.roleId),n=0;n<DataCenter.ins().SoulBoneConfig.equipCount;n++)this.updateItem(n),e+=t.getSoulBonePosPower(this.roleId,n,i,!0),this.powerPanel0.setPower(e);this.resolveItem.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.resolveItem.text),this.getItemTxt0.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt0.text)},e.prototype.updateItem=function(t){void 0===t&&(t=0);var e=this["equip"+t];if(e){var i=SoulBoneControl.ins(),n=e.itemIcon;n.imgJob.visible=!1,e.level.visible=!1,n.imgIcon.source="hungu"+t,e.select.visible=this.pos==t?!0:!1,n.imgBg.source=1>=t?"wupingkuangNB":"quality0",1>=t&&(n.imgBg.width=114,n.imgBg.height=114);var o=i.soulBoneData[this.roleId];if(o&&o.items[t].itemId){var s=o.items[t].itemId,r=DataCenter.ins().ItemConfig[s];n.imgIcon.source=r.icon+"_png"}else for(var a in this["posXian"+t])this["posXian"+t][a].visible=!1;e.redPoint.visible=this.getRedPoint(t)}},e.prototype.getRedPoint=function(t){return SoulBoneRedPoint.ins().soulBoneItemRedPoint(this.roleId,t)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.resolveItem:UIMgr.ins().open(SmeltEquipView,2);break;case this.getItemTxt0:warnControl.setBuyGoodsWarn(DataCenter.ins().SoulBoneConfig.gainItemId);break;case this.executeBtn:UIMgr.ins().open(SoulBoneGroupView,this.roleId,1);break;case this.executeBtn0:UIMgr.ins().open(SoulBoneGroupView,this.roleId,2);break;case this.xiangxishuxing:UIMgr.ins().open(SoulBoneAttrView,this.roleId);break;case this.fenjie:UIMgr.ins().open(SmeltItemView,this.getSmeltList())}},e.prototype.getSmeltList=function(){var t=[],e=DataCenter.ins().SoulBoneConfig.canFenjieItem;for(var i in e){var n=backpackControl.getBagItemById(e[i]);n&&t.push(n)}return t},e.prototype.HunguItemsResult=function(t){var e=t[0],i=t[1];e?this.playEff(i):this.cleanEff(i)},e.prototype.getSuitIdByPos=function(t){var e=0;for(var i in DataCenter.ins().SoulBoneConfig.suit)if(-1!=DataCenter.ins().SoulBoneConfig.suit[i].indexOf(t)){e=+i;break}return e},e.prototype.cleanEff=function(t){void 0===t&&(t=0);for(var e in this["posXian"+t])this["posXian"+t][e].visible=!1;this.liangdian[t].visible=!1;var i=this.getSuitIdByPos(t),n=[null,this.effect2toubu,this.effect3xia];n[i]&&n[i].removeChildren()},e.prototype.playEff=function(t){void 0===t&&(t=0);var e=1e3,i=[],n=0;for(var o in this["posXian"+t])n+=this["posXian"+t][o].width,this["posXian"+t][o].scrollRect=new egret.Rectangle(0,0,0,this["posXian"+t][o].height),this["posXian"+t][o].visible=!0;var s=0;for(var o in this["posXian"+t])Number(o)==this["posXian"+t].length-1?i[o]=e-s:(i[o]=this["posXian"+t][o].width/n*e,s+=i[o]);this.playWireEff(this["posXian"+t],i,0,t);var r=this.getSuitIdByPos(t);this.playSuitEffect(r)},e.prototype.playSuitEffect=function(t){var e=[null,this.effect2toubu,this.effect3xia];if(e[t]){var i=soulBoneControl.getSuitData(this.roleId);for(var n in i[t])if(!(i[t][n].count.length<+n)){var o=i[t][n].stage,s=DataCenter.ins().SoulBoneSuitConfig[t][n][o];if(s.effectId){var r=void 0;e[t].numElements?r=e[t].getChildAt(0):(r=new GameMovieClip,e[t].addChild(r)),r.playFile(PATH_EFF+s.effectId,-1)}}}},e.prototype.playWireEff=function(t,e,i,n){var o=this;if(void 0===i&&(i=0),void 0===n&&(n=0),t[i]){var s=egret.Tween.get(t[i].scrollRect);s.to({width:t[i].width},e[i]).call(function(){if(egret.Tween.removeTweens(s),t[i].scrollRect.width=t[i].width,i++,i>=t.length){var r=new GameMovieClip;r.playFile(PATH_EFF+"hguieffect0",1),o.effectPos[n].addChild(r),o.liangdian[n].visible=!0}else o.playWireEff(t,e,i,n)},this),this.wireEffs[n]||(this.wireEffs[n]=[]),this.wireEffs[n][i]&&egret.Tween.removeTweens(this.wireEffs[n][i]),this.wireEffs[n][i]=s}},e.prototype.cleanWireEff=function(){if(this.wireEffs)for(var t=0;t<this.wireEffs.length;t++)if(this.wireEffs[t])for(var e in this.wireEffs[t])egret.Tween.removeTweens(this.wireEffs[t][e])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cleanWireEff();for(var i=0;i<DataCenter.ins().SoulBoneConfig.equipCount;i++)this.cleanEff(i);this.removeCustomEvents()},e}(BasePanel);__reflect(SoulBonePanel.prototype,"SoulBonePanel");var SoulBoneStageView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulBoneStageViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.roleId=t[0],this.pos=t[1],this.getItemList.itemRenderer=ItemBase,this.addEventTouchTap(this.lvUpBtn,this.onTouch),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addCustomEvent(75,this.updateUI),this.attrNow=[this.attr1Now0,this.attr2Now0,this.attr3Now0],this.arrtNext=[this.attr1Next0,this.attr2Next0,this.attr3Next0],this.updateUI()},e.prototype.updateUI=function(){var t=SoulBoneControl.ins(),e=t.getCurSoulBoneId(this.roleId,this.pos),i=t.getNextSoulBoneId(this.roleId,this.pos),n=DataCenter.ins().SoulBoneEquipConfig[e],o=DataCenter.ins().SoulBoneEquipConfig[i];for(var s in this.attrNow)n&&n.attrs[s]?(this.attrNow[s].visible=!0,this.attrNow[s].text=AttributeData.getAttrStrByType(n.attrs[s].type)+":"+n.attrs[s].value):this.attrNow[s].visible=!1,o&&o.attrs[s]?(this.arrtNext[s].visible=!0,this.arrtNext[s].text=AttributeData.getAttrStrByType(o.attrs[s].type)+":"+o.attrs[s].value):this.arrtNext[s].visible=!1;var r=n&&n.hunyuNum?n.hunyuNum:0,a=o&&o.hunyuNum?o.hunyuNum:0;if(this.hunyuNow.text=LangMgr.getValueByKey("hunStone",r),this.hunyuNext.text=LangMgr.getValueByKey("hunStone",a),this.redPoint.visible=t.getUpgradeRedPoint(n&&n.id?n.id:0),n&&n.addStageCost){this.getItemList.dataProvider=new eui.ArrayCollection(n.addStageCost),this.getItemList.validateNow();for(var s=0;s<this.getItemList.numElements;s++){var l=this.getItemList.getVirtualElementAt(s),h=this.getItemList.dataProvider.getItemAt(s),u=ColorUtils.GREEN,p=backpackControl.getBagItemById(h.id),c=p?p.count:0;c<h.count&&(u=ColorUtils.RED),l.setName("|C:"+u+"&T:"+c+"/"+h.count)}}n&&(this.nowItemIcon.data=n.id,this.nowItemIcon.isShowJob(!1),this.nowItemIcon.showNum(!1),this.powerPanel0.setPower(this.getPower(n))),o?(this.nextItemIcon.data=o.id,this.nextItemIcon.isShowJob(!1),this.nextItemIcon.showNum(!1),this.powerPanel1.setPower(this.getPower(o))):UIMgr.ins().close(this)},e.prototype.getPower=function(t){var e=0;e+=BackpackControl.getAttrPower(t.attrs);var i=t.expower?t.expower:0;return e+=i},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.lvUpBtn:this.redPoint.visible?soulBoneControl.upSoulBoneItemUpgrade(this.roleId,this.pos):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));break;case this.bgClose:case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(SoulBoneStageView.prototype,"SoulBoneStageView");var SoulBoneTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulBoneTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.currentState=t[0]?"shenshang":"putong",this.validateNow(),this.addEventTouchTap(this.bgClose,this.onTap),"shenshang"==this.currentState&&(this.addEventTouchTap(this.takeoffBtn,this.onTap),this.addEventTouchTap(this.changeBtn,this.onTap),this.addEventTouchTap(this.hunyuBtn,this.onTap),this.wear=!0),this.addCustomEvent(73,this.HunguItemsCallback),this.addCustomEvent(75,this.HunguItemUpgradeCallback),this.roleId=t[1],this.itemId=t[2],this.updateUI()},e.prototype.HunguItemsCallback=function(){UIMgr.ins().close(this)},e.prototype.HunguItemUpgradeCallback=function(){var t=ItemUtils.getSubType(DataCenter.ins().ItemConfig[this.itemId]);this.itemId=soulBoneControl.soulBoneData[this.roleId].items[t].itemId,this.updateUI()},e.prototype.updateUI=function(){var t=DataCenter.ins().ItemConfig[this.itemId];this.equipIcon.setData(t);var e=ItemUtils.getQualityColor(t);this.nameTxt.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+t.name);var i=ItemUtils.getQuality(t);this.quali.source=i>0?"quali"+i:"",this.toubuhungu.textFlow=TextUtils.generateTextFlow1(""+soulBoneControl.getSoulBonePosName(ItemUtils.getSubType(t))),this.fanpin.textFlow=TextUtils.generateTextFlow1(""+soulBoneControl.getSoulBoneItemQualityName(t.id)),this.tongyong.textFlow=TextUtils.generateTextFlow1(""+RoleModel.getJobNameByJob(ItemUtils.getJob(t)));var n=0,o=soulBoneControl.getSuitData(this.roleId);n+=this.wear?soulBoneControl.getSoulBonePosPower(this.roleId,ItemUtils.getSubType(t),o,!0):soulBoneControl.getSoulBoneItemPower(t.id),this.powerPanel.setPower(n);var s=[],r=[],a=[],l=DataCenter.ins().SoulBoneEquipConfig[this.itemId];if(s=AttributeData.combineAtts(l.attrs),this.wear&&soulBoneControl.soulBoneData[this.roleId]){r=soulBoneControl.getSuitAddBasicAttr(o,s),this.updateRedPoint();for(var h=0;h<soulBoneControl.soulBoneData[this.roleId].items[ItemUtils.getSubType(t)].soulJades.length;h++){var u=soulBoneControl.soulBoneData[this.roleId].items[ItemUtils.getSubType(t)].soulJades[h],p=DataCenter.ins().SoulBoneConfig.hunyuType[ItemUtils.getSubType(t)][h],c=DataCenter.ins().SoulBoneJadeEquipConfig[p][u];c&&(a=AttributeData.combineAtts(c.attrs))}}for(var d=[2,4,5,6],g=0,m=0,h=0;h<d.length;h++){if(this["attr"+h]&&this["forgeAttr"+h]&&(this["attr"+h].visible=this["forgeAttr"+h].visible=!1),this["starAttr"+h]&&(this["starAttr"+h].visible=!1),this["attr"+g]&&this["forgeAttr"+g]){this["attr"+g].visible=this["forgeAttr"+g].visible=!1;for(var f=0;f<s.length;f++)if(s[f].type==d[h]){this["attr"+g].visible=!0,this["attr"+g].text=AttributeData.getAttStr(s[f],0,1,":"),"shenshang"==this.currentState&&r[f]&&(this["forgeAttr"+g].visible=!0,this["forgeAttr"+g].text="+"+r[f].value);break}this["attr"+g].visible&&g++}if(this["starAttr"+m]){this["starAttr"+m].visible=!1;for(var f=0;f<a.length;f++)if(a[f].type==d[h]){this["starAttr"+m].visible=!0,this["starAttr"+m].text=AttributeData.getAttStr(a[f],0,1,":");break}this["starAttr"+m].visible&&m++}}for(var h=0;3>=h;h++)this["attr"+h]&&!this["attr"+h].visible&&DisplayUtils.removeFromParent(this["attr"+h].parent),this["starAttr"+h]&&!this["starAttr"+h].visible&&DisplayUtils.removeFromParent(this["starAttr"+h]);this.starAttr.numElements<=1&&DisplayUtils.removeFromParent(this.starAttr)},e.prototype.updateRedPoint=function(){var t=DataCenter.ins().ItemConfig[this.itemId],e=ItemUtils.getSubType(t);this.changeRedPoint.visible=soulBoneControl.getUpgradeRedPoint(t.id),this.forgeRedPoint.visible=soulBoneControl.getSoulJadeRedPoint(this.roleId,e)},e.prototype.onTap=function(t){var e=DataCenter.ins().ItemConfig[this.itemId],i=ItemUtils.getSubType(e);switch(t.currentTarget){case this.takeoffBtn:if("shenshang"!=this.currentState)return void tipsControl.showTips(LangMgr.getValueByKey("hunNoErro"));if(soulBoneControl.soulBoneData[this.roleId]&&soulBoneControl.soulBoneData[this.roleId].items[i])return void soulBoneControl.upWearItems(this.roleId,i,0);tipsControl.showTips(LangMgr.getValueByKey("hunTips3"));break;case this.changeBtn:soulBoneControl.getNextSoulBoneId(this.roleId,i)?UIMgr.ins().open(SoulBoneStageView,this.roleId,i):tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));break;case this.hunyuBtn:if("shenshang"!=this.currentState)return void tipsControl.showTips(LangMgr.getValueByKey("hunTips4"));UIMgr.ins().open(SoulJadeView,this.roleId,this.itemId);break;case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(SoulBoneTipsView.prototype,"SoulBoneTipsView");var SoulJadeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulJadeViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(SoulBoneTipsView),this.addEventTouchTap(this.executeBtn0,this.onTap),this.addEventTouchTap(this.executeBtn,this.onTap),this.addEventTouchTap(this.getItemTxt0,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(74,this.updateShow),this.addCustomEvent(74,this.playEff);for(var i=0;i<DataCenter.ins().SoulBoneConfig.hunyuCount;i++)this.addEventTouchTap(this["equip"+i],this.onSelect);this.roleId=t[0],this.itemId=t[1],this.kong=t[2]||0,this["equip"+this.kong].select.visible=!0,this.updateShow()
},e.prototype.onSelect=function(t){for(var e=0;e<DataCenter.ins().SoulBoneConfig.hunyuCount;e++){var i=this["equip"+e];if(i.select.visible=!1,i&&t.currentTarget==i){var n=DataCenter.ins().ItemConfig[this.itemId],o=ItemUtils.getSubType(n);if(e+1>DataCenter.ins().SoulBoneEquipConfig[soulBoneControl.soulBoneData[this.roleId].items[o].itemId].hunyuNum){var s=soulBoneControl.getSoulBoneItemQualityName(0,e+1);s&&tipsControl.showTips(LangMgr.getValueByKey("hunTips6",s)),this["equip"+this.kong].select.visible=!0}else this.kong!=e?(i.select.visible=!0,this.kong=e,this.updateShow()):i.select.visible=!0}}},e.prototype.updateShow=function(){this.updateAct(),this.updateUI(),this.getItemTxt0.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt0.text)},e.prototype.playEff=function(){var t=this["equip"+this.kong];if(t){var e=new GameMovieClip;e.playFile(PATH_EFF+"forgeSuccess",1),t.eff.addChild(e)}},e.prototype.updateUI=function(){this.hide(),this.updateItems()},e.prototype.updateItems=function(){var t=this.equip,e=t.itemIcon,i=DataCenter.ins().ItemConfig[this.itemId];e.setData(i);for(var n=ItemUtils.getSubType(i),o=SoulBoneControl.ins(),s=0;s<DataCenter.ins().SoulBoneConfig.hunyuCount;s++){var r=this["equip"+s];if(r){var a=r.openText,l=o.getSoulJadeItemRedPoint(this.roleId,n,s);r.redPoint.visible=l;var h=r.itemIcon;h.icon.visible=!1,r.kejihuo.visible=!1,h.lock.visible=!1,a.visible=!1,r.level.visible=!1,r.lvBg.visible=!0;var u=DataCenter.ins().SoulBoneEquipConfig[o.soulBoneData[this.roleId].items[n].itemId].hunyuNum;if(s+1>u)if(h.lock.visible=!0,s==u){a.visible=!0;var p=soulBoneControl.getSoulBoneItemQualityName(0,s+1);p&&(a.text=LangMgr.getValueByKey("open1",p))}else r.lvBg.visible=!1;else{r.level.visible=!0,h.icon.visible=!0;var c=o.soulBoneData[this.roleId].items[n].soulJades[s];if(c){var d=DataCenter.ins().SoulBoneConfig.hunyuType[n][s];h.icon.source=DataCenter.ins().SoulBoneJadeEquipConfig[d][c].icon,r.level.text=LangMgr.getValueByKey("numberLevel",c)}else r.level.text=LangMgr.getValueByKey("numberLevel",0),l&&(r.kejihuo.visible=!0,h.icon.visible=!1,r.lvBg.visible=!1,r.level.visible=!1)}}}var g=0;if(o.soulBoneData[this.roleId]&&o.soulBoneData[this.roleId].items[n].soulJades)for(var m=DataCenter.ins().SoulBoneConfig.hunyuType[n][this.kong],s=0;s<o.soulBoneData[this.roleId].items[n].soulJades.length;s++){var f=o.soulBoneData[this.roleId].items[n].soulJades[s],v=DataCenter.ins().SoulBoneJadeEquipConfig[m][f];if(v){g+=BackpackControl.getAttrPower(v.attrs,heroControl.getSubRoleByIndex(this.roleId));var y=v.expower?v.expower:0;g+=y}}this.powerPanel0.setPower(g);var C=DataCenter.ins().SoulBoneConfig.hunyuType[n][this.kong];if("activation"==this.currentState){var T=DataCenter.ins().SoulBoneJadeEquipConfig[C][1],w=DataCenter.ins().SoulBoneConfig.unlockCost[this.kong+1],I=ColorUtils.RED;if(!this.kong&&T.cost){this.actRMB=!1,w=T.cost.count;var b=backpackControl.getBagItemById(T.cost.id),D=b?b.count:0;D>=w&&(I=ColorUtils.GREEN),this.icon0.source=DataCenter.ins().ItemConfig[T.cost.id].icon+"_png",this.countLabel0.textFlow=TextUtils.generateTextFlow1("|C:"+I+"&T:"+D+"|/"+w)}else this.actRMB=!0,this.icon0.source="szyuanbao",ActorControl.yb>=w&&(I=ColorUtils.GREEN),this.countLabel0.textFlow=TextUtils.generateTextFlow1("|C:"+I+"&T:"+ActorControl.yb+"|/"+w);this.name0.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().SoulBoneJadeEquipConfig[C][1].name),this.att0.text=AttributeData.getAttStr(DataCenter.ins().SoulBoneJadeEquipConfig[C][1].attrs,1)}else if("max"==this.currentState){var f=o.soulBoneData[this.roleId].items[n].soulJades[this.kong];this.name1.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().SoulBoneJadeEquipConfig[C][f].name),this.att1.text=AttributeData.getAttStr(DataCenter.ins().SoulBoneJadeEquipConfig[C][f].attrs,1)}else{var f=o.soulBoneData[this.roleId].items[n].soulJades[this.kong];this.curname.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().SoulBoneJadeEquipConfig[C][f].name),this.curAtt0.text=AttributeData.getAttStr(DataCenter.ins().SoulBoneJadeEquipConfig[C][f].attrs,1),this.nextname.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().SoulBoneJadeEquipConfig[C][f+1].name),this.nextAtt0.text=AttributeData.getAttStr(DataCenter.ins().SoulBoneJadeEquipConfig[C][f+1].attrs,1);var B=soulBoneControl.getNextSoudJadeConfig(this.roleId,n,this.kong);if(B){var I=ColorUtils.RED,k=B.cost.count,b=backpackControl.getBagItemById(B.cost.id),x=b?b.count:0;x>=k&&(I=ColorUtils.GREEN),this.countLabel1.textFlow=TextUtils.generateTextFlow1("|C:"+I+"&T:"+x+"|/"+k),this.icon1.source=DataCenter.ins().ItemConfig[B.cost.id].icon+"_png"}}},e.prototype.hide=function(){var t=this.equip;t.level.visible=!1;for(var e=0;e<DataCenter.ins().SoulBoneConfig.hunyuCount;e++){var i=this["equip"+e];i.level.visible=!1}},e.prototype.updateAct=function(){var t=SoulBoneControl.ins(),e=DataCenter.ins().ItemConfig[this.itemId],i=ItemUtils.getSubType(e);if(t.soulBoneData[this.roleId]&&t.soulBoneData[this.roleId].items[i].soulJades[this.kong]){var n=DataCenter.ins().SoulBoneConfig.hunyuType[i][this.kong],o=t.soulBoneData[this.roleId].items[i].soulJades[this.kong];o>=CommonUtils.getObjectLength(DataCenter.ins().SoulBoneJadeEquipConfig[n])?this.currentState="max":this.currentState="upgrade"}else this.currentState="activation";this.validateNow()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.executeBtn0:if("activation"==this.currentState)if(this.actRMB){var e=DataCenter.ins().SoulBoneConfig.unlockCost[this.kong+1];if(ActorControl.yb>=e){var i=DataCenter.ins().ItemConfig[this.itemId],n=ItemUtils.getSubType(i);soulBoneControl.upSoulJade(this.roleId,n,this.kong+1)}else tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))}else{var o=DataCenter.ins().ItemConfig[this.itemId],s=ItemUtils.getSubType(o),r=DataCenter.ins().SoulBoneConfig.hunyuType[s][this.kong],a=DataCenter.ins().SoulBoneJadeEquipConfig[r][1],l=backpackControl.getBagItemById(a.cost.id),h=l?l.count:0;h>=a.cost.count?soulBoneControl.upSoulJade(this.roleId,s,this.kong+1):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"))}else tipsControl.showTips(LangMgr.getValueByKey("hunTips7"));break;case this.executeBtn:if("upgrade"==this.currentState){var i=DataCenter.ins().ItemConfig[this.itemId],n=ItemUtils.getSubType(i),u=soulBoneControl.getNextSoudJadeConfig(this.roleId,n,this.kong);if(u&&u.cost){var l=backpackControl.getBagItemById(u.cost.id),p=l?l.count:0;p>=u.cost.count?soulBoneControl.upSoulJade(this.roleId,n,this.kong+1):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"))}else tipsControl.showTips(LangMgr.getValueByKey("hunTips8"))}else tipsControl.showTips(LangMgr.getValueByKey("hunTips9"));break;case this.getItemTxt0:if("upgrade"==this.currentState){var i=DataCenter.ins().ItemConfig[this.itemId],n=ItemUtils.getSubType(i),u=soulBoneControl.getNextSoudJadeConfig(this.roleId,n,this.kong);u&&u.cost&&warnControl.setBuyGoodsWarn(u.cost.id)}else tipsControl.showTips(LangMgr.getValueByKey("hunTips10"));break;case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(SoulJadeView.prototype,"SoulJadeView");var SoulBoneGroupItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulBoneGroupItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.qualityName.textFlow=TextUtils.generateTextFlow1(this.data.qualityName),this.posName.textFlow=TextUtils.generateTextFlow1(this.data.posName);for(var t=0;3>t;t++)this["suit"+t]&&this.data.suits[t]?this["suit"+t].textFlow=TextUtils.generateTextFlow1(this.data.suits[t]):DisplayUtils.removeFromParent(this["suit"+t])}},e}(BaseItemRender);__reflect(SoulBoneGroupItemRenderer.prototype,"SoulBoneGroupItemRenderer");var LoginControl=function(t){function e(){var e=t.call(this)||this;return e.canEnter=!1,e.enterID=-1,e.isFirstEnter=!0,e.lastRoleID=-1,e.cacheCreateRoleInfo={},e.addCustomEvent(2,e.perloadComplete),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.perloadComplete=function(){this.canEnter=!0,-1!=this.enterID&&this.upEnterGame(this.enterID)},e.prototype.upCheckAccount=function(){debug.log("ServerID:",GlobalModel.srvid,"Account:",GlobalModel.openID);var t=SDKManager.ins().GetSDKCheckAccountArgs();return t.ip=GlobalModel.clientPlayerIp,debug.log("login args:",t),[GlobalModel.srvid,GlobalModel.openID,t]},e.prototype.downCheckAccount=function(t,e){0==t?(GlobalModel.createAccountTime=e,this.upRoleList(GlobalModel.srvid)):(alert("Connect failed:"+LangMgr.getValueByKey("longinError"+t)),3!=t?window.location.reload():SDKManager.ins().SDKLogoutNative())},e.prototype.upCreateRole=function(t,e,i,n){return void 0===n&&(n=0),this.cacheCreateRoleInfo.sex=e,this.cacheCreateRoleInfo.job=i,[t,e,i,n,GlobalModel.pf.toString(),GlobalModel.pfid.toString(),GlobalModel.appid.toString(),GlobalModel.srvid]},e.prototype.downCreateRole=function(t,e,i){return 0!=e?(this.showErrorTips(e),void(6==Math.abs(e)&&EventMgr.ins().dispatch(573))):(SoundUtils.ins().playEffect(SoundUtils.CREATE_ROLE),SoundUtils.ins().delayTime(3e3),this.isCreateLogin=!0,ActorControl.actorID=t,SDKManager.ins().SDKCreateRoleNative({serverId:GlobalModel.srvid,serverName:GlobalModel.srvname,job:this.cacheCreateRoleInfo.job,sex:this.cacheCreateRoleInfo.sex,nickName:i}),ReportData.getIns().reportActorInfo(),void(!GlobalModel.isCreateRole||this.canEnter?this.upEnterGame(t):this.enterID=t))},e.prototype.upRoleList=function(t){return[t]},e.prototype.downRoleList=function(t,e,i,n){switch(e){case 0:StartLoading.ins().hideLoading();var o=DataCenter.ins().RoleCreateConfig[1];if(1==o.screate){var s=o.sex[Math.floor(Math.random()*o.sex.length)];loginControl.upCreateRole("",s,o.job)}else SceneMgr.ins().runScene(CreateRoleScene);GlobalModel.isCreateRole&&LoadUtils.ins().loadGroup("preload",Launcher.ins().perLoadComplete,Launcher.ins().perLoadProgress,Launcher.ins());break;case 1:i>=1?(this.enterID=n,this.upEnterGame(n)):this.isFirstEnter||-1==this.lastRoleID||this.upEnterGame(this.lastRoleID)}},e.prototype.upEnterGame=function(t){return this.lastRoleID=t,[t,GlobalModel.pf.toString(),GlobalModel.pfid.toString(),GlobalModel.appid.toString()]},e.prototype.downEnterGame=function(t,e){switch(t){case 0:GlobalModel.createActorTime=e;break;case 1:StartLoading.ins().hideLoading(),GameLoadingUI.GetInstance().close(),debug.log("Enter game success"),GlobalModel.actorLoginTime=Date.now(),crossFieldControl.linkingKFState(!1),SceneMgr.ins().runScene(MainScene),UnitMgr.ins().removeAll(),confrontControl.clearEncounterModel(),this.isFirstEnter&&(this.isFirstEnter=!1);break;default:this.showErrorTips(t),alert(LangMgr.getValueByKey("errorCode"+Math.abs(t)))}},e.prototype.upRandomName=function(t){return[t]},e.prototype.downRandom=function(t,e,i){0==t&&this.createRoleView.setName(i)},e.prototype.getCreateRoleView=function(){switch(GlobalModel.createRolePreload){case"createRole1":return CreateRoleView1;default:return CreateRoleView}},Object.defineProperty(e.prototype,"createRoleView",{get:function(){var t=this.getCreateRoleView();return UIMgr.ins().getView(t)},enumerable:!0,configurable:!0}),e.prototype.showErrorTips=function(t){0!=t&&tipsControl.showTips(LangMgr.getValueByKey("errorCode"+Math.abs(t)))},e.prototype.getCreateRoleConfigByJob=function(t){var e=null;for(var i in DataCenter.ins().RoleCreateConfig)if(DataCenter.ins().RoleCreateConfig[i].job==t){e=DataCenter.ins().RoleCreateConfig[i];break}return e},__decorate([up(1,[3,8,8])],e.prototype,"upCheckAccount",null),__decorate([down(1,[1,3])],e.prototype,"downCheckAccount",null),__decorate([up(2,[8,1,1,1,8,8,8,3])],e.prototype,"upCreateRole",null),__decorate([down(2,[3,1,8])],e.prototype,"downCreateRole",null),__decorate([up(4,[3])],e.prototype,"upRoleList",null),__decorate([down(4,[3,1,3,3])],e.prototype,"downRoleList",null),__decorate([up(5,[3,8,8,8])],e.prototype,"upEnterGame",null),__decorate([down(5,[1,3])],e.prototype,"downEnterGame",null),__decorate([up(6,[1])],e.prototype,"upRandomName",null),__decorate([down(6,[1,1,8])],e.prototype,"downRandom",null),e=__decorate([protocolsId(0)],e)}(BaseSystem);__reflect(LoginControl.prototype,"LoginControl");var CreateRoleView=function(t){function e(){var e=t.call(this)||this;e._selectJob=0,e._selectSex=0,e.isAutoEnter=!1,e.startTime=0,e.skinName="CreateRoleViewSkin",e.enterGroup.visible=!1,e.groupSpark=new eui.Group,e.addChild(e.groupSpark),e.groupSpark.touchChildren=!1,e.groupSpark.touchEnabled=!1,e.list.itemRenderer=CreateRoleItemRenderer;for(var i=[0,0,0,0],n=0;3>n;n++)for(var o=1;30>=o;o++)i.push(o);return e.list.dataProvider=new eui.ArrayCollection(i),e.scroller.touchChildren=!1,e.scroller.touchEnabled=!1,e.job1.selected.source="createrole_selected_1",e.job2.selected.source="createrole_selected_1",e.job3.selected.source="createrole_selected_1",e.boy.selected.source="createrole_selected_0",e.girl.selected.source="createrole_selected_0",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.selectJob=1,this.addEventTouchTap(this.job1,this.onClick),this.addEventTouchTap(this.job2,this.onClick),this.addEventTouchTap(this.job3,this.onClick),this.addEventTouchTap(this.boy,this.onClick),this.addEventTouchTap(this.girl,this.onClick),this.addEventTouchTap(this.createBtn,this.onClick),this.addEventTouchTap(this.diceBtn,this.onClick),this.addEventTouchTap(this,this.onClick),this.addEventTouchTap(this.nameInput,this.onClick),loginControl.upRandomName(this._selectSex),this.listH=this.list.height-200,this.scroller.viewport.scrollV=0;var i=egret.Tween.get(this.scroller.viewport);i.to({scrollV:this.listH},40*this.listH).call(this.loopT,this),this.addCustomEvent(1,this.perloadProgress),this.addCustomEvent(573,this.createRuselt),this.timeLab.text="",GameLoadingUI.GetInstance().close(),ReportData.getIns().reportDoPoint(2),this.startTime=Date.now()},e.prototype.updateTiem=function(){var t=Math.ceil((this.openTime-egret.getTimer())/1e3);this.timeLab.text=LangMgr.getValueByKey("startTips1",Math.max(t,0)),0>=t&&(this.isAutoEnter=!0,this.sendCreateRole())},e.prototype.createRuselt=function(){this.enterGroup.visible=!1,loginControl.upRandomName(this._selectSex)},e.prototype.perloadProgress=function(t){var e=t[0],i=t[1];this.loadText.text=LangMgr.getValueByKey("startTips2",Math.ceil(e/i*100))},e.prototype.loopT=function(){this.scroller.viewport.scrollV=200;var t=egret.Tween.get(this.scroller.viewport);t.to({scrollV:this.listH},40*this.listH).call(this.loopT,this)},e.prototype.loopT2=function(){var t=egret.Tween.get(this.imgA);t.to({horizontalCenter:-100},1e3).to({horizontalCenter:-115},1e3).call(this.loopT2,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.job1,this.onClick),this.removeEventTouchTap(this.job2,this.onClick),this.removeEventTouchTap(this.job3,this.onClick),this.removeEventTouchTap(this.boy,this.onClick),this.removeEventTouchTap(this.girl,this.onClick),this.removeEventTouchTap(this.createBtn,this.onClick),this.removeEventTouchTap(this.diceBtn,this.onClick),this.removeEventTouchTap(this,this.onClick),this.removeEventTouchTap(this.nameInput,this.onClick),this.closeTween(),TimerMgr.ins().removeAll(this),ReportData.getIns().reportIntervalPoint(Date.now()-this.startTime,6,GlobalModel.serverNumberPlyer<=1)},e.prototype.sendCreateRole=function(){loginControl.upCreateRole(this.nameInput.text,this.curSex(),this.curJob()),TimerMgr.ins().removeAll(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.createBtn:this.sendCreateRole(),this.enterGroup.visible=!0;break;case this.diceBtn:loginControl.upRandomName(this._selectSex);case this.nameInput:TimerMgr.ins().remove(this.updateTiem,this),this.timeLab.text="";break;case this.boy:this.selectSex=0;break;case this.girl:this.selectSex=1;break;case this.job1:this.selectJob=1;break;case this.job2:this.selectJob=2;break;case this.job3:this.selectJob=3}SoundUtils.ins().touchBg()},Object.defineProperty(e.prototype,"selectJob",{set:function(t){var e=0==this._selectJob;this._selectJob=t;var i=loginControl.getCreateRoleConfigByJob(t).sex;e?this._selectSex=i[Math.floor(Math.random()*i.length)]:-1==i.indexOf(this._selectSex)&&(this._selectSex=this._selectSex?0:1),this.boy.visible=i.length>1,this.girl.visible=i.length>1,this.updateRole()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectSex",{set:function(t){this._selectSex=t,this.updateRole()},enumerable:!0,configurable:!0}),e.prototype.updateRole=function(){var t=this.curJob(),e=this.curSex();this.role.source="cr_"+t+"_"+e+"_png";for(var i=1;3>=i;i++)this["job"+i].currentState="up";this["job"+t].currentState="selected",0==e?(this.boy.currentState="selected",this.girl.currentState="up"):(this.girl.currentState="selected",this.boy.currentState="up")},e.prototype.setName=function(t){this.nameInput.text=t,this.isAutoEnter&&this.sendCreateRole()},e.prototype.curJob=function(){return this._selectJob},e.prototype.curSex=function(){return this._selectSex},e.prototype.sparkTween=function(){for(var t=this,e=0;15>e;e++)TimerMgr.ins().doTimer(1e3*Math.random()+1500,1,function(){t.randomSpark()},this);TimerMgr.ins().doTimer(1500,1,function(){t.sparkTween()},this)},e.prototype.randomSpark=function(){var t=ObjectPool.pop("eui.Image");t.source="cr_3",t.x=300*Math.random()+500,t.rotation=180*Math.random(),t.touchEnabled=!1,this.groupSpark.addChild(t);var e=MathUtils.limit(.7,1);t.scaleX=t.scaleY=e,t.y=MathUtils.limit(-50,250)+700;var i=egret.Tween.get(t);i.to({x:480*Math.random(),y:500*Math.random()},3500).call(function(){t.parent.removeChild(t),egret.Tween.removeTweens(t),ObjectPool.push(t)})},e.prototype.closeTween=function(){for(var t=this.groupSpark.numChildren,e=0;t>e;e++){var i=this.groupSpark.getChildAt(e);egret.Tween.removeTweens(i)}egret.Tween.removeTweens(this.imgA),egret.Tween.removeTweens(this.scroller.viewport)},e}(BaseEuiView);__reflect(CreateRoleView.prototype,"CreateRoleView");var CreateRoleView1=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectJob=0,e.isAutoEnter=!1,e}return __extends(e,t),e.prototype.setSkinUI=function(){this.skinName="CreateRoleView1Skin"},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.setSkinUI(),this.jobImage=[this.j0,this.j1,this.j2,this.j3,this.j4,this.j5],this.enterGroup.visible=!1,this.groupSpark=new eui.Group,this.addChild(this.groupSpark),this.groupSpark.touchChildren=!1,this.groupSpark.touchEnabled=!1,this.list.itemRenderer=CreateRoleItemRenderer;for(var e=[0,0,0,0],i=0;3>i;i++)for(var n=1;30>=n;n++)e.push(n);this.list.dataProvider=new eui.ArrayCollection(e),this.scroller.touchChildren=!1,this.scroller.touchEnabled=!1},e.prototype.open=function(){this.selectJob=0;for(var t=0;t<this.jobImage.length;t++)this.addEventTouchTap(this.jobImage[t],this.onClick);this.addEventTouchTap(this.createBtn,this.onClick),this.addEventTouchTap(this.diceBtn,this.onClick),this.addEventTouchTap(this,this.onClick),this.addEventTouchTap(this.nameInput,this.onClick),loginControl.upRandomName(this._selectJob%2),this.sparkTween(),this.listH=this.list.height-200,this.scroller.viewport.scrollV=0;var e=egret.Tween.get(this.scroller.viewport);e.to({scrollV:this.listH},40*this.listH).call(this.loopT,this),this.addCustomEvent(1,this.perloadProgress),this.addCustomEvent(573,this.createRuselt),this.openTime=egret.getTimer()+15e3,this.timeLab.text="",this.addEventChange(this.nameInput,this.onChange),this.setBtnEff(),RambleHlpVo.regInputEvt(this.nameInput),GameLoadingUI.GetInstance().close()},e.prototype.setBtnEff=function(){this.btnMc||(this.btnMc=new GameMovieClip,this.btnMc.x=this.createBtn.x+this.createBtn.width/2+15,this.btnMc.y=this.createBtn.y+this.createBtn.height/2-2,this.createBtn.parent.addChild(this.btnMc)),this.btnMc.playFile(PATH_EFF+"chuangjuebtn",-1)},e.prototype.updateTiem=function(){var t=Math.ceil((this.openTime-egret.getTimer())/1e3);this.timeLab.text=LangMgr.getValueByKey("startTips1",Math.max(t,0)),0>=t&&(this.isAutoEnter=!0,this.sendCreateRole())},e.prototype.createRuselt=function(){this.enterGroup.visible=!1,loginControl.upRandomName(this._selectJob%2)},e.prototype.perloadProgress=function(t){var e=t[0],i=t[1];this.loadText.text=LangMgr.getValueByKey("startTips2",Math.ceil(e/i*100))},e.prototype.loopT=function(){this.scroller.viewport.scrollV=200;var t=egret.Tween.get(this.scroller.viewport);t.to({scrollV:this.listH},40*this.listH).call(this.loopT,this)},e.prototype.loopT2=function(){var t=egret.Tween.get(this.imgA);t.to({horizontalCenter:-100},1e3).to({horizontalCenter:-115},1e3).call(this.loopT2,this)},e.prototype.close=function(){for(var t=0;t<this.jobImage.length;t++)this.removeEventTouchTap(this.jobImage[t],this.onClick);this.removeEventTouchTap(this.createBtn,this.onClick),this.removeEventTouchTap(this.diceBtn,this.onClick),this.removeEventTouchTap(this,this.onClick),this.removeEventTouchTap(this.nameInput,this.onClick),this.closeTween(),TimerMgr.ins().removeAll(this),DisplayUtils.removeFromParent(this.btnMc),this.btnMc=null},e.prototype.sendCreateRole=function(){loginControl.upCreateRole(this.nameInput.text,this.curSex(),this.curJob()),TimerMgr.ins().removeAll(this)},e.prototype.onChange=function(t){switch(t.currentTarget){case this.nameInput:this.nameInput.text=this.nameInput.text.toLowerCase()}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.createBtn:this.sendCreateRole(),this.enterGroup.visible=!0;break;case this.diceBtn:loginControl.upRandomName(this._selectJob%2);case this.nameInput:this.removeDelayTime();break;default:var e=this.jobImage.indexOf(t.currentTarget);e>=0&&(this.selectJob=e,this.removeDelayTime())}SoundUtils.ins().touchBg()},e.prototype.removeDelayTime=function(){TimerMgr.ins().remove(this.updateTiem,this),this.timeLab.text=""},Object.defineProperty(e.prototype,"selectJob",{set:function(t){this._selectJob=t,this.currentState=""+t},enumerable:!0,configurable:!0}),e.prototype.setName=function(t){this.nameInput.text=t,this.isAutoEnter&&this.sendCreateRole()},e.prototype.curJob=function(){return Math.floor(this._selectJob/2)+1},e.prototype.curSex=function(){return this._selectJob%2},e.prototype.sparkTween=function(){for(var t=this,e=0;15>e;e++)TimerMgr.ins().doTimer(1e3*Math.random()+1500,1,function(){t.randomSpark()},this);TimerMgr.ins().doTimer(1500,1,function(){t.sparkTween()},this)},e.prototype.randomSpark=function(){var t=ObjectPool.pop("eui.Image");t.source="cr2_point_png",t.x=300*Math.random()+500,t.rotation=180*Math.random(),t.touchEnabled=!1,this.groupSpark.addChild(t);var e=MathUtils.limit(.7,1);t.scaleX=t.scaleY=e,t.y=MathUtils.limit(-50,250)+700;var i=egret.Tween.get(t);i.to({x:480*Math.random(),y:500*Math.random()},3500).call(function(){t.parent.removeChild(t),egret.Tween.removeTweens(t),ObjectPool.push(t)})},e.prototype.closeTween=function(){for(var t=this.groupSpark.numChildren,e=0;t>e;e++){var i=this.groupSpark.getChildAt(e);egret.Tween.removeTweens(i)}egret.Tween.removeTweens(this.imgA),egret.Tween.removeTweens(this.scroller.viewport)},e}(BaseEuiView);__reflect(CreateRoleView1.prototype,"CreateRoleView1");var LoginView=function(t){function e(){var e=t.call(this)||this,i=new eui.Image;i.horizontalCenter=0,i.y=600,i.source=PATH_ROOT+"startgame/accountbg.png",e.addChild(i);var n=new eui.Group;return n.horizontalCenter=88,n.y=i.y+5,n.width=272,n.height=37,e.addChild(n),e.account=new egret.TextField,e.account.width=272,e.account.height=37,e.account.text="ceshi1",e.account.textAlign="left",e.account.textColor=16114616,e.account.verticalAlign=egret.VerticalAlign.MIDDLE,e.account.type=egret.TextFieldType.INPUT,n.addChild(e.account),e.start=new eui.Image,e.start.horizontalCenter=0,e.start.y=i.y+80,e.start.source=PATH_ROOT+"startgame/enter.png",e.addChild(e.start),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.start,this.onClick),egret.localStorage.getItem("account")&&(this.account.text=egret.localStorage.getItem("account"))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.start,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.start:if(StringUtils.getStringLength(this.account.text)<=0)return void alert(LangMgr.getValueByKey("startTips4"));GlobalModel.openID=this.account.text,egret.localStorage.setItem("account",this.account.text),UIMgr.ins().close(this),UIMgr.ins().open(StartGameView)}},e}(BaseEuiView);__reflect(LoginView.prototype,"LoginView");var ServerListView=function(t){function e(){var e=t.call(this)||this;e.serverListData={},e.rect=new eui.Rect,e.rect.left=e.rect.right=e.rect.top=e.rect.bottom=0,e.rect.fillAlpha=.7,e.addChild(e.rect);var i=new eui.Group;i.horizontalCenter=0,i.verticalCenter=-50,i.width=468,i.height=656,e.addChild(i),e.bg=new eui.Image,e.bg.source=PATH_ROOT+"startgame/selserbg.png",i.addChild(e.bg),e.closeBtn=new egret.Sprite,e.closeBtn.x=410,e.closeBtn.y=5,e.closeBtn.graphics.beginFill(16777215,0),e.closeBtn.graphics.drawRect(0,0,53,50),e.closeBtn.graphics.endFill(),e.closeBtn.touchEnabled=!0,i.addChild(e.closeBtn);var n=new eui.Scroller;n.x=35,n.y=65,n.width=178,n.height=580,i.addChild(n),e.tapBtnList=new eui.List,e.tapBtnList.itemRenderer=ServerTapBtnItemRenderer,n.viewport=e.tapBtnList;var o=new eui.Scroller;return o.x=208,o.y=70,o.width=280,o.height=580,i.addChild(o),e.serversList=new eui.List,e.serversList.itemRenderer=ServerListItemRenderer,o.viewport=e.serversList,e}return __extends(e,t),e.prototype.open=function(t){this.serverListData=t,this.addEventTouchTap(this.closeBtn,this.onClick),this.updataTapList(),this.addEventItemTap(this.tapBtnList,this.onTapBtn);var e=this.serverListData.userinfo&&this.serverListData.userinfo.length>0?0:1;this.tapBtnList.selectedIndex=e,this.selectServerListByTapBtnIndex(e),this.addEventItemTap(this.serversList,this.onSelectServer)},e.prototype.updataTapList=function(){var t=[LangMgr.getValueByKey("serverList1"),LangMgr.getValueByKey("serverList2")],e=GlobalModel.serverStyle,i=e.some(function(t){return t==GlobalModel.pfid});if(this.serverListData.serverinfo){for(var n=Math.ceil(this.serverListData.serverinfo.length/100),o="",s=!1,r=0;r<this.serverListData.serverinfo.length;r++){for(var a=0;a<this.serverListData.serverinfo[r].serverName.length;a++){var l=Number(this.serverListData.serverinfo[r].serverName[a]);if(!isNaN(l)){o=this.serverListData.serverinfo[r].serverName.substring(0,a),s=!0;break}}if(s)break}if(i)for(var r=n-1;r>=0;r--)t.push(LangMgr.getValueByKey("serverList3",o+(100*r+1),100*(r+1)));this.tapBtnList.dataProvider=new eui.ArrayCollection(t)}},e.prototype.onTapBtn=function(t){this.selectServerListByTapBtnIndex(t.itemIndex)},e.prototype.selectServerListByTapBtnIndex=function(t){var e=[],i=Math.ceil(this.serverListData.serverinfo.length/100);switch(t){case 0:e=this.serverListData.userinfo;break;case 1:e=this.serverListData.serverinfo;break;default:var n=i-t+2;e=this.serverListData.serverinfo.slice(100*(n-1),100*n)}this.serversList.dataProvider=new eui.ArrayCollection(e)},e.prototype.onSelectServer=function(t){var e=this.serversList.dataProvider.getItemAt(t.itemIndex);SocketConnection.ins().record(e)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeEventItemTap(this.tapBtnList,this.onTapBtn),this.removeEventItemTap(this.serversList,this.onSelectServer)},e}(BaseEuiView);__reflect(ServerListView.prototype,"ServerListView");var StartGameView=function(t){function e(){var e=t.call(this)||this;e.serverListData={},e.startTime=0,e.bg=new eui.Image,e.bg.horizontalCenter=0,e.bg.source=PATH_ROOT+"startgame/startbg.png",e.addChild(e.bg),e.notice=new eui.Image,e.notice.y=20,e.notice.horizontalCenter=240,e.notice.source=PATH_ROOT+"startgame/notice.png",e.addChild(e.notice);var i=new eui.Group;i.width=438,i.height=92,i.horizontalCenter=0,i.bottom=300,e.addChild(i);var n=new eui.Image;n.source=PATH_ROOT+"startgame/dfbg.png",i.addChild(n),e.serverName=new eui.Label,e.serverName.cacheAsBitmap=!1,e.serverName.textAlign="center",e.serverName.verticalAlign="middle",e.serverName.width=302,e.serverName.text=LangMgr.getValueByKey("startGame1"),e.serverName.horizontalCenter=0,e.serverName.y=-5,e.serverName.size=20,e.serverName.anchorOffsetY=0,e.serverName.height=62,e.serverName.anchorOffsetX=0,e.serverName.textColor=16114616,i.addChild(e.serverName);var o=new eui.Image;return o.source=PATH_ROOT+"startgame/xuanqujiantou.png",o.x=330,o.y=12,i.addChild(o),e.selectServer=i,e.start=new eui.Image,e.start.horizontalCenter=0,e.start.bottom=240,e.start.source=PATH_ROOT+"startgame/enter.png",e.addChild(e.start),e.ownerDes=new eui.Label,e.ownerDes.size=13,e.ownerDes.width=506,e.ownerDes.textAlign="center",e.ownerDes.verticalAlign="bottom",e.ownerDes.textColor=14207153,e.ownerDes.lineSpacing=5,e.ownerDes.horizontalCenter=0,e.ownerDes.bottom=10,e.addChild(e.ownerDes),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addEventTouchTap(this.notice,this.onClick),this.addEventTouchTap(this.start,this.onClick),this.addEventTouchTap(this.selectServer,this.onLink),this.start.visible=!1,this.getServerListFailCount=0,TimerMgr.ins().doNext(this.getServerList,this),this.ownerDes&&GlobalModel.ownerDes.length>0){this.ownerDes.text=GlobalModel.ownerDes;var i=GlobalModel.getUrlParamValue("rawChannelId"),n=GlobalModel.pfArgs[GlobalModel.pf],o=GlobalModel.notdifferentiate;if(n=n?n[i]:"",i&&n&&n.startbg&&(this.bg.source=n.startbg),o.length>0)for(var s in o)if(GlobalModel.gameId==o[s]){var r=GlobalModel.pfArgs[GlobalModel.pf];r&&r.startbg&&r.ownerDes&&(this.ownerDes.text=r.ownerDes,this.bg.source=r.startbg);break}}GameLoadingUI.GetInstance().showState(!1),this.startTime=Date.now()},e.prototype.getServerList=function(){EasyLoading.ins().showLoading();var t={account:GlobalModel.openID,gameid:GlobalModel.gameId,pfid:GlobalModel.pfid,pf:GlobalModel.pf,channelId:GlobalModel.channelId,time:Date.now(),miniAuditVer:SDKManager.ins().SDKMiniAuditVer()},e=Md5Utils.obj_md5_args(t,PHPConfig.VERIFY_KEY,!0,[],["miniAuditVer"]);PHPConfig.requestPhpData(PHPConfig.GET_SERVER_URL,e,this.onGetComplete,this,this.onGetIOError)},e.prototype.onGetComplete=function(t){this.start.visible=!0,EasyLoading.ins().hideLoading();try{this.serverListData=JSON.parse(t.currentTarget.response),GlobalModel.clientPlayerIp=this.serverListData.ip,this.serverListData.notice&&StringUtils.getStringLength(this.serverListData.notice)>0&&(GlobalModel.setUrlParamValue("notice",this.serverListData.notice),1!=this.serverListData.mandatorylogin&&UIMgr.ins().open(NoticeView)),this.curServerInfo=this.serverListData.userinfo[0],1==this.serverListData.mandatorylogin?SocketConnection.ins().record(this.curServerInfo):this.curServerInfo&&(this.serverName.text=this.curServerInfo.serverName),GlobalModel.serverNumberPlyer=this.serverListData.userinfo.length,ReportData.getIns().reportIntervalPoint(Date.now()-window.bgTime1,2,GlobalModel.serverNumberPlyer<=1)}catch(e){alert(LangMgr.getValueByKey("startGame3"))}},e.prototype.onGetIOError=function(t){this.getServerListFailCount++,this.getServerListFailCount>=3?(this.getServerListFailCount=0,alert(LangMgr.getValueByKey("startGame3"))):this.getServerList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.notice,this.onClick),this.removeEventTouchTap(this.start,this.onClick),this.removeEventTouchTap(this.selectServer,this.onLink),ReportData.getIns().reportIntervalPoint(Date.now()-this.startTime,4,GlobalModel.serverNumberPlyer<=1)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.notice:UIMgr.ins().open(NoticeView);break;case this.start:this.curServerInfo?SocketConnection.ins().record(this.curServerInfo):alert(LangMgr.getValueByKey("startGame3"))
}},e.prototype.onLink=function(){UIMgr.ins().open(ServerListView,this.serverListData)},e}(BaseEuiView);__reflect(StartGameView.prototype,"StartGameView");var WXLoginView=function(t){function e(){var e=t.call(this)||this;return e.bg=new eui.Image,e.bg.source=PATH_ROOT+"loading/loading.png",e.bg.horizontalCenter=0,e.addChild(e.bg),e.GuestButton=new eui.Image,e.GuestButton.source=PATH_ROOT+"startgame/guestLogin.png",e.GuestButton.horizontalCenter=0,e.GuestButton.bottom=140,e.addChild(e.GuestButton),e.GuestButton.visible=!1,e.WXButton=new eui.Image,e.WXButton.source=PATH_ROOT+"startgame/wxLogin.png",e.WXButton.horizontalCenter=0,e.WXButton.bottom=40,e.addChild(e.WXButton),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.GuestButton,this.onClick),this.addEventTouchTap(this.WXButton,this.onClick)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.GuestButton,this.onClick),this.removeEventTouchTap(this.WXButton,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.GuestButton:break;case this.WXButton:SDKManager.ins().SDKLoginNative()}},e}(BaseEuiView);__reflect(WXLoginView.prototype,"WXLoginView");var YYBLoginView=function(t){function e(){var e=t.call(this)||this;return e.bg=new eui.Image,e.bg.source=PATH_ROOT+"loading/loading.png",e.bg.horizontalCenter=0,e.addChild(e.bg),e.GuestButton=new eui.Image,e.GuestButton.source=PATH_ROOT+"startgame/guestLogin.png",e.GuestButton.horizontalCenter=0,e.GuestButton.bottom=79,e.addChild(e.GuestButton),e.GuestButton.visible=!1,e.QQButton=new eui.Image,e.QQButton.source=PATH_ROOT+"startgame/qqLogin.png",e.QQButton.horizontalCenter=-141.5,e.QQButton.bottom=180,e.addChild(e.QQButton),e.WXButton=new eui.Image,e.WXButton.source=PATH_ROOT+"startgame/wxLogin.png",e.WXButton.horizontalCenter=141.5,e.WXButton.bottom=180,e.addChild(e.WXButton),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.GuestButton,this.onClick),this.addEventTouchTap(this.QQButton,this.onClick),this.addEventTouchTap(this.WXButton,this.onClick),SDKManager.ins().SDKAutoLoginNative()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.GuestButton,this.onClick),this.removeEventTouchTap(this.QQButton,this.onClick),this.removeEventTouchTap(this.WXButton,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.GuestButton:SDKManager.ins().SDKLoginNative({ePlatform:1});break;case this.QQButton:SDKManager.ins().SDKLoginNative({ePlatform:2});break;case this.WXButton:SDKManager.ins().SDKLoginNative({ePlatform:3})}},e}(BaseEuiView);__reflect(YYBLoginView.prototype,"YYBLoginView");var CreateRoleItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(0==this.data)return void(this.labelInfo.text="");var t=LangMgr.getValueByKey("startTips3",LangMgr.getValueByKey("startType"+this.data));this.labelInfo.textFlow=TextUtils.generateTextFlow1(t)},e}(BaseItemRender);__reflect(CreateRoleItemRenderer.prototype,"CreateRoleItemRenderer");var ServerListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.width=280,e.height=60,e.bg=new eui.Image,e.bg.source=PATH_ROOT+"startgame/serbg.png",e.addChild(e.bg),e.serverName=new eui.Label,e.serverName.x=40,e.serverName.y=10,e.serverName.size=20,e.serverName.width=245,e.serverName.height=36,e.serverName.anchorOffsetX=0,e.serverName.anchorOffsetY=0,e.serverName.verticalAlign="middle",e.serverName.touchEnabled=!1,e.serverName.textColor=12957564,e.addChild(e.serverName),e.isState=new eui.Image,e.addChild(e.isState),e}return __extends(e,t),e.prototype.dataChanged=function(){this.serverName.text=this.data.serverName,this.isState.source=PATH_ROOT+"startgame/"+(this.data.isnew?"new":"hot")+".png"},e}(BaseItemRender);__reflect(ServerListItemRenderer.prototype,"ServerListItemRenderer");var ServerTapBtnItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.width=150,e.height=55,e.selectImg=new eui.Image,e.addChild(e.selectImg),e.title=new eui.Label,e.title.width=e.width,e.title.height=e.height,e.title.verticalAlign="middle",e.title.textAlign="center",e.title.size=20,e.title.touchEnabled=!1,e.addChild(e.title),e}return __extends(e,t),e.prototype.dataChanged=function(){this.title.text=this.data},Object.defineProperty(e.prototype,"selected",{set:function(t){this.title.textColor=t?16776129:12957564,this.selectImg.source=PATH_ROOT+"startgame/"+(t?"curbg2":"curbg")+".png"},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(ServerTapBtnItemRenderer.prototype,"ServerTapBtnItemRenderer");var StoreControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.shopData=new StoreVo,e.zhenbaoShopData=new StoreTreasureVo,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upBuy=function(t,e){this.shopBuyArr=[];for(var i=0;i<e.length;i++){var n=DataCenter.ins().StoreItemConfig[e[i][0]];if(n&&200164==n.itemId){var o={id:200164,count:e[i][1]};this.shopBuyArr.push(o)}}return[t,e]},e.prototype.upRefreshShop=function(){},e.prototype.downUpdateShopData=function(t,e,i,n){storeControl.shopData.init(t,e,i,n),EventMgr.ins().dispatch(196)},e.prototype.downBuyResult=function(t){EventMgr.ins().dispatch(197,t)},e.prototype.downBuyCount=function(t){storeControl.shopData.parserBuyCount(t),EventMgr.ins().dispatch(198)},e.prototype.downRefreshGoodsSuccess=function(){this.dispatchRefreshGoodsSuccess(!0)},e.prototype.dispatchRefreshGoodsSuccess=function(t){EventMgr.ins().dispatch(199,t)},e.prototype.downRefreshIntegrationSucc=function(t,e){EventMgr.ins().dispatch(200,[t,storeControl.shopData.point])},e.prototype.upIntegrationShop=function(t){return[t]},e.prototype.upMedalMessage=function(){},e.prototype.downMedalMessage=function(t){this.medalData=new StoreFeatsVo(t),EventMgr.ins().dispatch(201)},e.prototype.upBuyMedal=function(t,e){return[t,e]},e.prototype.downUpdateBuyMedal=function(t,e){EventMgr.ins().dispatch(202,[t,e])},e.prototype.openBuyGoldWin=function(t){void 0===t&&(t=!0);var e=this.shopData.getGoodsIdByItemId(200164);return this.shopData.checkBuyGoodsId(e,t)?(UIMgr.ins().open(StoreBuyView,e),!0):!1},e.prototype.downWeekShopData=function(t,e,i){this.shopData.parseWeekStore(t,e,i),EventMgr.ins().dispatch(203)},e.prototype.downWeekShopResult=function(t,e){this.shopData.updateWeekStoreData(t,e),EventMgr.ins().dispatch(204,t)},e.prototype.upBuyWeekShop=function(t,e){return[t,e]},e.prototype.upWeekShopRedPoint=function(){this.shopData.weekStoreRedPoint=!1,this.dispatchWeekStoreRedPoint()},e.prototype.dispatchWeekStoreRedPoint=function(){EventMgr.ins().dispatch(701)},e.prototype.downTreasureShopPoint=function(t){this.zhenbaoShopData.parseACPoint(t),EventMgr.ins().dispatch(205)},e.prototype.upResolveTreasureShop=function(t,e){return[t,e]},e.prototype.isConditionShow=function(t){if(!t)return!1;if(t.openday&&GameServer.serverOpenDay+1<t.openday)return!1;if(t.zslevel){var e=Math.floor(t.zslevel/1e3),i=Math.floor(t.zslevel%1e3);if(reincarnateControl.lv<e)return!1;if(reincarnateControl.lv==e&&ActorControl.level<i)return!1}return!0},e.prototype.getStoreByItemId=function(t){var e=DataCenter.ins().StoreItemConfig;for(var i in e){var n=e[i];if(n.itemId==t)return n}return null},__decorate([up(2,[3,[3,3]])],e.prototype,"upBuy",null),__decorate([up(3)],e.prototype,"upRefreshShop",null),__decorate([down(1,[3,3,3,ByteConst.StoreEquipVos])],e.prototype,"downUpdateShopData",null),__decorate([down(2,[3])],e.prototype,"downBuyResult",null),__decorate([down(3,[ByteConst.StoreHadBuyVos])],e.prototype,"downBuyCount",null),__decorate([down(4)],e.prototype,"downRefreshGoodsSuccess",null),__decorate([down(5,[0,3])],e.prototype,"downRefreshIntegrationSucc",null),__decorate([up(5,[3])],e.prototype,"upIntegrationShop",null),__decorate([up(6)],e.prototype,"upMedalMessage",null),__decorate([down(6,ByteConst.StoreFeatsVos.slice())],e.prototype,"downMedalMessage",null),__decorate([up(7,[3,3])],e.prototype,"upBuyMedal",null),__decorate([down(7,[3,3])],e.prototype,"downUpdateBuyMedal",null),__decorate([down(8,[3,[3,3],[3]])],e.prototype,"downWeekShopData",null),__decorate([down(9,[3,3])],e.prototype,"downWeekShopResult",null),__decorate([up(9,[3,3])],e.prototype,"upBuyWeekShop",null),__decorate([up(10)],e.prototype,"upWeekShopRedPoint",null),__decorate([down(11,[3])],e.prototype,"downTreasureShopPoint",null),__decorate([up(12,[3,3])],e.prototype,"upResolveTreasureShop",null),e=__decorate([protocolsId(16)],e)}(BaseSystem);__reflect(StoreControl.prototype,"StoreControl");var AmuseTarget10Panel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),this.tttzhi&&egret.Tween.removeTweens(this.tttzhi);var i=amusementControl.activityData[this.activityID];i&&i.state&&amusementControl.upReward(this.activityID,this.level),this.rolling=!1,this.isClick=!1,TimerMgr.ins().removeAll(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.skinName||(this.skinName="AmuseTarget10PanelSkin"),this.addCustomEvent(395,this.resultCallBack),TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.addEventTouchTap(this.choujiangBtn,this.getLottery),this.list.itemRenderer=NoticeYBListItemRender,this.updateView()},e.prototype.updateView=function(){var t=amusementControl.activityData[this.activityID];if(t){var e=DataCenter.ins().Amusement10Config[this.activityID];this.level=t.getLevel();var i=this.level,n=!1;this.level||(i=Object.keys(e).length,n=!0),this.img_level.source="trun_10000"+i;for(var o=e[i],s=0;s<o.info.length;s++)this["multiple"+s].text=LangMgr.getValueByKey("beistr",o.info[s].multiple);this.pay0.text=o.yuanBao+"";var r=LangMgr.getColor("color43"),a=0;t.yb<o.recharge&&(r=LangMgr.getColor("color22"),a=o.recharge-t.yb),n?this.label_needCharge.text=LangMgr.getValueByKey("osaPayPart"):this.label_needCharge.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("osaMorePay",r,a)),this.listRefush(),this.setTime();var l=DataCenter.ins().AmusementBtnConfig[this.activityID];l&&(this.title.source=l.title)}},e.prototype.resultCallBack=function(t){if(this.isClick){var e=amusementControl.activityData[this.activityID];this.activityID==t&&(e&&e.state&&this.beginLottery(e.index),this.updateView(),this.listRefush())}},e.prototype.beginLottery=function(t){var e=this,i=1440+36*(t-1),n=egret.Tween.get(this.tttzhi);this.rolling=!0,n.to({rotation:i},4e3,egret.Ease.circOut).call(function(){amusementControl.upReward(e.activityID,e.level),e.flyItemEx(e["multiple"+(t-1)]),setTimeout(function(){e.rolling=!1,e.isClick=!1},2e3)},this)},e.prototype.flyItemEx=function(t){var e=new eui.Image(Currency.getCurrencyRes(2));e.x=t.x,e.y=t.y,e.scaleX=1,e.scaleY=1,t.parent.addChild(e),gameControl.dispatchFlyItemEx(e)},e.prototype.getLottery=function(){if(!this.level)return tipsControl.showTips(LangMgr.getValueByKey("osaPayPart")),void(this.isClick=!1);var t=amusementControl.activityData[this.activityID],e=DataCenter.ins().Amusement10Config[this.activityID][this.level];return t&&!t.getCondition(this.level)?(tipsControl.showTips(LangMgr.getValueByKey("osaMorePayYB",e.recharge-t.yb)),void(this.isClick=!1)):this.rolling?void tipsControl.showTips(LangMgr.getValueByKey("babelRemainTimes1")):this.isClick?void tipsControl.showTips(LangMgr.getValueByKey("osaDrawResult")):void(amusementControl.getRollSum(this.activityID)||ActorControl.yb>=e.yuanBao?(this.isClick=!0,amusementControl.upReward(this.activityID,this.level)):(tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),this.isClick=!1))},e.prototype.listRefush=function(){var t=amusementControl.activityData[this.activityID];if(t){this.list.dataProvider||(this.list.dataProvider=new eui.ArrayCollection);for(var e=this.list.dataProvider,i=[],n=0;n<t.noticeArr.length;n++){var o={activityID:this.activityID,name:t.noticeArr[n].name,multiple:t.noticeArr[n].multiple,yb:t.noticeArr[n].yb};i.push(o)}e.replaceAll(i)}},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID];t&&(this.actTime.text=LangMgr.getValueByKey("expHaveTime",t.getRemainTime()))},e}(AmusementPanel);__reflect(AmuseTarget10Panel.prototype,"AmuseTarget10Panel");var StoreEquipVo=function(){function t(){}return t.prototype.init=function(t){this.id=t[0],this.costType=t[1],this.costNum=t[2],this.discountType=t[3],this.item=new ItemData,this.item.init(t.slice(4))},t.discountDic={0:{discount:1,res:""},1:{discount:.8,res:"shangzk8"},2:{discount:.5,res:"shangzk5"}},t}();__reflect(StoreEquipVo.prototype,"StoreEquipVo");var StoreFeatsVo=function(){function t(t){this.exchangeCount=[];for(var e,i,n=0;n<t.length;n++)e=t[n][0],i=t[n][1],this.exchangeCount[e]=i}return t.prototype.checkHonorBuy=function(t){var e=DataCenter.ins().StoreConfig[t];if(ActorControl.chip<e.costMoney.count)return!1;switch(e.buyType){case 1:if(this.exchangeCount[e.index-1]>=e.daycount)return!0;break;case 2:return!0;case 3:if(this.exchangeCount[e.index-1]>=e.daycount)return!0}return!1},t.prototype.checkHonorRedPoint=function(){for(var t in DataCenter.ins().StoreConfig){var e=this.checkHonorBuy(DataCenter.ins().StoreConfig[t].goods[0].id);if(e)return!0}return!1},t}();__reflect(StoreFeatsVo.prototype,"StoreFeatsVo");var StoreHadBuyVo=function(){function t(){}return t.prototype.parser=function(t){this.itemId=t[0],this.count=t[1]},t}();__reflect(StoreHadBuyVo.prototype,"StoreHadBuyVo");var StoreTreasureVo=function(){function t(){this.initAcPoint=-1,this.TreasureStoreRedPoint=!1,this.treasureDecomRedpoints=[],this._ACPoint=0}return t.prototype.parseACPoint=function(t){if(this.initAcPoint<0)this.initAcPoint=1;else{var e=t-this._ACPoint;e>0&&tipsControl.showTips(LangMgr.getValueByKey("shopTips39",e))}this._ACPoint=t},t.prototype.getAcPoint=function(){return this.initAcPoint<0?0:this._ACPoint},t.prototype.isopen=function(){var t=GameServer.serverOpenDay+1;return t>=DataCenter.ins().StoreCommonConfig.treasureOpenDay&&reincarnateControl.lv>=DataCenter.ins().StoreCommonConfig.treasureZsLv&&this.isAllLv4()},t.prototype.updateTreasureStoreRP=function(){return this.isopen()?(this.TreasureStoreRedPoint=this.canResolve(),this.TreasureStoreRedPoint):!1},t.prototype.canResolve=function(){var t=DataCenter.ins().StoreTreasureDecomConfig,e=200301;for(var i in t){var n=t[i],o=backpackControl.getBagGoodsCountById(0,n.itemId);this.treasureDecomRedpoints[n.itemId]=n.itemId==e?o>=DataCenter.ins().StoreCommonConfig.diamondsNum:!!o}return this.treasureDecomRedpoints.indexOf(!0)>-1},t.prototype.isAllLv4=function(){var t=heroControl.subRolesLen;if(3>t)return!1;for(var e=0;t>e;e++){var i=heroControl.getSubRoleByIndex(e);if(!i)return!1;for(var n=0;8>n;n++){var o=i.heirloom.getInfoBySolt(n);if(o.lv<DataCenter.ins().StoreCommonConfig.heirloom)return!1}}return!0},t.prototype.returnitemconfig=function(t){var e=DataCenter.ins().HeirloomillusionConfig;for(var i in e){var n=e[i];if(n.itemid==t)return n}},t.prototype.returnWeekStoreonfig=function(t){var e=DataCenter.ins().StoreWeekConfig;for(var i in e){var n=e[i];if(n.itemId==t)return n}},t}();__reflect(StoreTreasureVo.prototype,"StoreTreasureVo");var StoreVo=function(){function t(){this.shopEquipData=[],this.hadBuyCount=[],this.weekStoreRedPoint=!1,this.weekStoreDatas={},this.weekSrvList=[]}return Object.defineProperty(t.prototype,"refushTime",{get:function(){return this._refushTime},set:function(t){this._refushTime=t,TimerMgr.ins().removeAll(this),t>0&&TimerMgr.ins().doTimer(1e3,t,this.enterTime,this)},enumerable:!0,configurable:!0}),t.prototype.init=function(t,e,i,n){this.shopEquipData.length=0,this.refushTime=t,this.point=e,this.times=i;for(var o=0;o<n.length;o++){var s=new StoreEquipVo;s.init(n[o]),this.shopEquipData.push(s)}},t.prototype.parserBuyCount=function(t){this.hadBuyCount.length=0;for(var e=0;e<t.length;e++){var i=new StoreHadBuyVo;i.parser(t[e]),this.hadBuyCount.push(i)}},t.prototype.enterTime=function(){this._refushTime<=0?this._refushTime=0:this._refushTime--},t.prototype.getHadBuyCountItem=function(t){for(var e=0,i=this.hadBuyCount;e<i.length;e++){var n=i[e];if(n.itemId==t)return n}return null},t.prototype.getHadBuyCount=function(t){var e=this.getHadBuyCountItem(t);return e?e.count:0},t.prototype.getShopEquipDataLength=function(){var t=0;return null!=this.shopEquipData&&(t=this.shopEquipData.length),t},t.prototype.getShopEquipDataByIndex=function(t){var e=null;return null!=this.shopEquipData&&t>=0&&t<this.shopEquipData.length&&(e=this.shopEquipData[t]),e},t.prototype.getShopEquipDataById=function(t){for(var e=0,i=this.shopEquipData;e<i.length;e++){var n=i[e];if(n.id==t)return n}return null},t.prototype.checkBuyGoodsId=function(t,e){void 0===e&&(e=!0);var i=DataCenter.ins().StoreItemConfig[t];if(i){if(i.viplv&&vipControl.lv<i.viplv)return e&&tipsControl.showTips(LangMgr.getValueByKey("shopVipBuy",vipControl.getVipStr(i.viplv))),!1;if(i.vipLimit){var n=i.vipLimit[vipControl.lv],o=this.getHadBuyCount(i.itemId);if(o>=n)return e&&tipsControl.showTips(LangMgr.getValueByKey("shopTips24")),!1}}return!0},t.prototype.getGoodsIdByItemId=function(t){for(var e in DataCenter.ins().StoreItemConfig)if(DataCenter.ins().StoreItemConfig[e].itemId==t)return parseInt(e);return 0},t.prototype.parseWeekStore=function(t,e,i){this.weekStoreDatas={},this.weekStoreRedPoint=1==t;for(var n=0;e.length>n;n++){var o=e[n][0],s=e[n][1];this.weekStoreDatas[o]=s}this.weekSrvList=[];for(var n=0;i.length>n;n++)this.weekSrvList.push(i[n])},t.prototype.updateWeekStoreData=function(t,e){this.weekStoreDatas[t]=e},t.prototype.getWeekBuyCount=function(t){return this.weekStoreDatas[t]||0},t.prototype.checkBuyWeekStore=function(t,e){void 0===e&&(e=!0);var i=DataCenter.ins().StoreWeekConfig[t];if(i){var n=this.getWeekBuyCount(t);return i.limitCount>0&&n>=i.limitCount?(e&&tipsControl.showTips(LangMgr.getValueByKey("shopTips35")),!1):i.vip>0&&i.vip>vipControl.lv?(e&&tipsControl.showTips(LangMgr.getValueByKey("shopTips36",i.vip)),!1):1==i.storeType&&ActorControl.yb<i.price?(tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),!1):2==i.storeType&&n>=DataCenter.ins().StoreCommonConfig.weekStoreCount[0]?(e&&tipsControl.showTips(LangMgr.getValueByKey("shopTips38")),!1):!0}return!1},t}();__reflect(StoreVo.prototype,"StoreVo");var StoreBestTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreBestTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.shopList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onClick);var i=[];for(var n in DataCenter.ins().StoreTreasureOverConfig)i.push(DataCenter.ins().StoreTreasureOverConfig[n].itemId);this.shopList.dataProvider=new eui.ArrayCollection(i)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(StoreBestTipsView.prototype,"StoreBestTipsView");var StoreBlackPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopType2"),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.listView.itemRenderer=StoreBlackItemRenderer,this.addEventTouchTap(this,this.onTap),this.addEventTouchTap(this.buyAllItemBtn,this.buyAllItem),this.addEventTouchTap(this.refreshShopBtn,this.refreshShop),this.addEventTouchTap(this.goodsOverView,this.onClick),this.addCustomEvent(196,this.updateData),this.addCustomEvent(197,this.buyResultCB),this.addCustomEvent(660,this.updateRedPoint),this.price.text=DataCenter.ins().StoreCommonConfig.refreshYuanBao+"";var i=this.goodsOverView.text;this.goodsOverView.textFlow=TextUtils.generateTextFlow1("|U:&T:"+i),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().removeAll(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.goodsOverView:UIMgr.ins().open(StoreBestTipsView)}},e.prototype.updateRedPoint=function(){this.redPoint.visible=StoreRedPoint.ins().blackMarketRedPoint},e.prototype.buyAllItem=function(t){for(var e=[],i=0,n=0,o=0,s=storeControl.shopData,r=s.getShopEquipDataLength(),a=null,l=0,h=0;r>h;h++)if(a=s.getShopEquipDataByIndex(h),null!=a){if(0==ItemUtils.getType(a.item.itemConfig)){if(l=backpackControl.calculationScore(a.item),!(l>0))continue;o+=1}e.push([a.id,1]),1==a.costType?i+=a.costNum:n+=a.costNum}if(backpackControl.getSurplusCount()<o){var u=LangMgr.getValueByKey("shopTips1");return void tipsControl.showTips(u)}return ActorControl.gold<i?void warnControl.setBuyGoodsWarn(1):ActorControl.yb<n?void tipsControl.showTips(LangMgr.getValueByKey("userNoMony")):0==i&&0==n?void tipsControl.showTips(LangMgr.getValueByKey("shopTips2")):void storeControl.upBuy(2,e)},e.prototype.refreshShop=function(t){if(storeControl.shopData.times>=DataCenter.ins().StoreCommonConfig.refreshLimit)return void tipsControl.showTips(LangMgr.getValueByKey("shopTips3"));if(storeControl.shopData.refushTime<=0)storeControl.upRefreshShop();else{var e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().StoreCommonConfig.refreshItem),i=e?e.count:0;if(i)storeControl.upRefreshShop();else{if(ActorControl.yb<DataCenter.ins().StoreCommonConfig.refreshYuanBao)return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));storeControl.upRefreshShop()}}},e.prototype.onTap=function(t){if("buy"==t.target.name){if(backpackControl.getSurplusCount()<=0)return void tipsControl.showTips(LangMgr.getValueByKey("shopTips4"));var e=t.target.parent.goodsID,i=storeControl.shopData.getShopEquipDataById(e);if(Assert(i,LangMgr.getValueByKey("shopTips5",e)))return;if(1==i.costType){if(ActorControl.gold<i.costNum)return void warnControl.setBuyGoodsWarn(1)}else if(ActorControl.yb<i.costNum)return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));var n=i.item,o=ItemUtils.getJob(n.itemConfig),s=ItemUtils.getType(n.itemConfig);if(0==s&&0!=o){var r=backpackControl.calculationScore(n);if(r>0){var a=[e,1];storeControl.upBuy(2,[a])}else warnControl.show(LangMgr.getValueByKey("shopTips6"),function(){},this,null,null,"sure")}else{var a=[e,1];storeControl.upBuy(2,[a])}}},e.prototype.buyResultCB=function(t){1==t?tipsControl.showTips(LangMgr.getValueByKey("auctionBuySucces")):tipsControl.showTips(LangMgr.getValueByKey("shopTips7")),this.updateOthersUI()},e.prototype.updateOthersUI=function(){var t=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().StoreCommonConfig.refreshItem),e=t?t.count:0,i="";i=e?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.keylabel.textFlow=TextUtils.generateTextFlow("<font color="+i+">"+e+"</font> "),storeControl.shopData.refushTime<=0?this.refreshShopBtn.label=LangMgr.getValueByKey("osaFreeUpdate"):this.refreshShopBtn.label=LangMgr.getValueByKey("osaUpdate")},e.prototype.updateData=function(){for(var t=[],e=storeControl.shopData,i=e.getShopEquipDataLength(),n=null,o=0;i>o;o++)n=e.getShopEquipDataByIndex(o),null!=n&&t.push(n);this.listView.dataProvider=new eui.ArrayCollection(t),TimerMgr.ins().isExists(this.refushEndTime,this)||(TimerMgr.ins().doTimer(1e3,storeControl.shopData.refushTime,this.refushEndTime,this),this.refushEndTime()),t.length<=0?this.noGoods.visible=!0:this.noGoods.visible=!1,this.point.text=LangMgr.getValueByKey("shopTips8",storeControl.shopData.point),this.updateOthersUI(),this.updateRedPoint()},e.prototype.refushEndTime=function(){this.tip.text=LangMgr.getValueByKey("shopTips9",DateUtils.getFormatBySecond(storeControl.shopData.refushTime)),this.tipsBg.visible=this.tip.visible=this.costGroup.visible=!0,storeControl.shopData.refushTime<=0&&(this.tipsBg.visible=this.tip.visible=this.costGroup.visible=!1)},e}(BasePanel);__reflect(StoreBlackPanel.prototype,"StoreBlackPanel");var StoreBuyView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="StoreBuyViewSkin",this.num=1,this.itemIcon.imgJob.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addEventTouchTap(this.add1Btn,this.onTap),this.addEventTouchTap(this.add10Btn,this.onTap),this.addEventTouchTap(this.sub1Btn,this.onTap),this.addEventTouchTap(this.sub10Btn,this.onTap),this.addEventTouchTap(this.buyBtn,this.buy),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventChange(this.numLabel,this.inputOver),this.num=1,this.shopID=t[0],this.shopType=t[1]?t[1]:0,this.yuanbao0.visible=this.yuanbao1.visible=!0,2==this.shopType||3==this.shopType){this.yuanbao0.visible=this.yuanbao1.visible=!1,this.num=this.getChipNumRule();var i="204076_png";this.honor0.source=2==this.shopType?"ZSchip":i,this.honor1.source=2==this.shopType?"ZSchip":i}5==this.shopType&&(this.yuanbao0.visible=this.yuanbao1.visible=!1,this.honor0.source=this.honor0.source="storeSuperZbHubi_png",this.honor1.source=this.honor1.source="storeSuperZbHubi_png"),this.honor0.visible=this.honor1.visible=!this.yuanbao0.visible,this.updateView()},e.prototype.getChipNumRule=function(){var t=DataCenter.ins().StoreConfig[this.shopID],e=0;if(1==t.shopType){if(ActorControl.chip<t.costMoney.count)return this.maxNum=1,this.maxNum;e=Math.floor(ActorControl.chip/t.costMoney.count)}else if(2==t.shopType){var i=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,t.costItem.id);if(i<t.costItem.count)return this.maxNum=1,this.maxNum;e=Math.floor(i/t.costItem.count)}var n=0;if(!storeControl.medalData)return 0;var o=storeControl.medalData.exchangeCount[this.shopID];switch(o=o?o:0,t.buyType){case 1:n=t.daycount-o,n=n>0?n:1,n=n>e?e:n;break;case 2:n=e;break;case 3:n=t.daycount-o,n=n>0?n:1,n=n>e?e:n}return this.maxNum=n,this.maxNum},e.prototype.updateView=function(){var t,e;if(4==this.shopType||5==this.shopType){var i=DataCenter.ins().StoreWeekConfig[this.shopID];if(e=DataCenter.ins().ItemConfig[i.itemId],this.itemIcon.setData(e),i.limitCount>0){var n=storeControl.shopData.getWeekBuyCount(this.shopID);this.maxNum=i.limitCount-n,this.itemName0.text=LangMgr.getValueByKey("shopTips10",this.maxNum),this.itemName0.visible=!0}else this.maxNum=Number.MAX_VALUE,this.itemName0.visible=!1;return 2==i.storeType&&(this.maxNum=DataCenter.ins().StoreCommonConfig.weekStoreCount[0]-storeControl.shopData.getWeekBuyCount(this.shopID)),this.num>this.maxNum&&(this.num=this.maxNum),5==this.shopType?(this.unitPrice.text=this.numconver(i.price)+"",this.allPrice.text=this.numconver(this.num*i.price)+""):(this.unitPrice.text=i.price+"",this.allPrice.text=this.num*i.price+""),this.numLabel.text=this.num+"",this.itemName.textColor=LangMgr.getColor("qualityColor"+ItemUtils.getQuality(e)),this.itemName.text=e.name,this.used.text="",void(this.used.x=this.itemName.x+this.itemName.width)}return 2!=this.shopType&&3!=this.shopType?(t=DataCenter.ins().StoreItemConfig[this.shopID],e=DataCenter.ins().ItemConfig[t.itemId],this.itemIcon.setData(e),t.vipLimit?(this.maxNum=t.vipLimit[vipControl.lv]-storeControl.shopData.getHadBuyCount(t.itemId),this.itemName0.text=LangMgr.getValueByKey("shopTips10",this.maxNum),this.itemName0.visible=!0):(this.maxNum=Number.MAX_VALUE,this.itemName0.visible=!1),this.num>this.maxNum&&(this.num=this.maxNum),this.unitPrice.text=t.price+"",this.allPrice.text=this.num*t.price+"",this.numLabel.text=this.num+"",this.itemName.text=e.name,this.itemName.textColor=LangMgr.getColor("qualityColor"+ItemUtils.getQuality(e)),this.used.text="（"+t.use+"）",void(this.used.x=this.itemName.x+this.itemName.width)):(this.itemName0.visible=!1,t=DataCenter.ins().StoreConfig[this.shopID],e=DataCenter.ins().ItemConfig[t.goods[0].id],this.itemIcon.setData(e),this.goodId=t.index,2==this.shopType?this.unitPrice.text=t.costMoney.count+"":3==this.shopType&&(this.unitPrice.text=t.costItem.count+""),this.allPrice.text=this.num*parseInt(this.unitPrice.text)+"",this.numLabel.text=this.num+"",this.itemName.text=e.name,this.itemName.textColor=LangMgr.getColor("qualityColor"+ItemUtils.getQuality(e)),void(this.used.text="（"+t.use+"）"))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sub10Btn:this.num-=10;break;case this.sub1Btn:this.num-=1;break;case this.add10Btn:this.num+=10;break;case this.add1Btn:this.num+=1;break;case this.bgClose:UIMgr.ins().close(this)}this.num<1&&(this.num=1),this.num>this.maxNum&&(this.num=this.maxNum),this.numLabel.text=this.num+"",this.inputOver()},e.prototype.buy=function(t){if(2==this.shopType)ActorControl.chip>=parseInt(this.allPrice.text)?(storeControl.upBuyMedal(this.goodId,this.num),UIMgr.ins().close(this)):tipsControl.showTips(LangMgr.getValueByKey("shopTips11"));else if(3==this.shopType){var i=DataCenter.ins().StoreConfig[this.shopID];backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,i.costItem.id)>=parseInt(this.allPrice.text)?(storeControl.upBuyMedal(this.goodId,this.num),UIMgr.ins().close(this)):tipsControl.showTips(LangMgr.getValueByKey("shopTips12"))}else if(4==this.shopType)ActorControl.yb>=parseInt(this.allPrice.text)?(storeControl.upBuyWeekShop(this.shopID,this.num),UIMgr.ins().close(this)):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));else if(5==this.shopType){var n=DataCenter.ins().StoreWeekConfig[this.shopID],o=this.num*n.price;if(storeControl.zhenbaoShopData.getAcPoint()>=o)storeControl.upBuyWeekShop(this.shopID,this.num),UIMgr.ins().close(this);else{var s=warnControl.show(LangMgr.getValueByKey("shopTips26"),null,null,function(){UIMgr.ins().close(e),UIMgr.ins().open(StoreTreasureResolveView)});s.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("artRenderer1"))}}else if(ActorControl.yb>=parseInt(this.allPrice.text)){var r=[this.shopID,this.num];storeControl.upBuy(1,[r]),UIMgr.ins().close(this)}else tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.inputOver=function(t){if(this.num=parseInt(this.numLabel.text),(isNaN(this.num)||this.num<1)&&(this.num=1),this.num>9999&&(this.num=9999),this.num>this.maxNum&&(this.num=this.maxNum),this.numLabel.text=this.num+"",5==this.shopType){var e=DataCenter.ins().StoreWeekConfig[this.shopID];this.allPrice.text=this.numconver(this.num*e.price)+""}else this.allPrice.text=this.num*parseInt(this.unitPrice.text)+""},e.prototype.numconver=function(t){var e=null;return 1e5>t?e=Math.floor(t)+"":t>=1e8?(t/=1e8,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan1",t)):(t/=1e4,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan",t)),e},e}(BaseEuiView);__reflect(StoreBuyView.prototype,"StoreBuyView");var StoreHonorPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopTips13"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.listView.itemRenderer=StoreHonorItemRenderer,this.dataArr=new eui.ArrayCollection,this.listView.dataProvider=this.dataArr},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.get,this.onClick),this.addCustomEvent(201,this.updateData),this.addCustomEvent(458,this.callback),this.addCustomEvent(202,this.callback),storeControl.upMedalMessage()},e.prototype.callback=function(){storeControl.upMedalMessage()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.updateData=function(){var t=[],e=DataCenter.ins().StoreConfig;
for(var i in e){var n=!0;if(3==e[i].buyType)for(var o in storeControl.medalData.exchangeCount)if(e[i].index==Number(o)&&e[i].daycount){storeControl.medalData.exchangeCount[o]>=e[i].daycount&&(n=!1);break}n&&t.push(e[i])}this.dataArr.replaceAll(t),this.myAttrValue0.text=ActorControl.feats+"";var s=this.get.text;this.get.textFlow=TextUtils.generateTextFlow1("|U:&T:"+s)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.get:warnControl.setBuyGoodsWarn(7)}},e}(BasePanel);__reflect(StoreHonorPanel.prototype,"StoreHonorPanel");var StoreIntegrationPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopTips27"),e.skinName="StoreIntegrationPanelSkon",e.list.itemRenderer=StoreIntegrationItemRenderer,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addCustomEvent(200,this.buyResultCB),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.buyResultCB=function(t,e){1==t[0]?tipsControl.showTips(LangMgr.getValueByKey("auctionBuySucces")):tipsControl.showTips(LangMgr.getValueByKey("shopTips7")),this.label1.text=LangMgr.getValueByKey("shopTips14",CommonUtils.overLength(t[1]))},e.prototype.updateData=function(){var t=[],e=DataCenter.ins().StoreIntegralConfig;for(var i in e)t.push(e[i]);this.list.dataProvider=new eui.ArrayCollection(t),this.label1.text=LangMgr.getValueByKey("shopTips14",CommonUtils.overLength(storeControl.shopData.point))},e.prototype.onTap=function(t){if("buy"==t.target.name){var e=t.target.parent.goodsID,i=DataCenter.ins().StoreIntegralConfig,n=void 0;for(var o in i){var s=i[o];s.index==e&&(n=s)}if(1!=n.type&&backpackControl.getSurplusCount()<=0){var r=LangMgr.getValueByKey("shopTips4");return void tipsControl.showTips(r)}if(ActorControl.yb<n.price)return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));if(storeControl.shopData.point<n.integral)return void tipsControl.showTips(LangMgr.getValueByKey("shopTips15"));storeControl.upIntegrationShop(e)}},e}(BasePanel);__reflect(StoreIntegrationPanel.prototype,"StoreIntegrationPanel");var StoreItemPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopTips16"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.listView.itemRenderer=StoreItemItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.addCustomEvent(198,this.refreshList),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.refreshList=function(){for(var t=this.listView.dataProvider.length,e=0;t>e;e++){var i=this.listView.dataProvider,n=i.getItemAt(e);i.itemUpdated(n)}},e.prototype.updateData=function(){var t=[],e=DataCenter.ins().StoreItemConfig;for(var i in e)t.push(e[i]);this.listView.dataProvider=new eui.ArrayCollection(t)},e.prototype.onTap=function(t){if("buy"==t.target.name){var e=t.target.parent.goodsID;DataCenter.ins().StoreItemConfig[e];storeControl.shopData.checkBuyGoodsId(e)&&UIMgr.ins().open(StoreBuyView,e)}},e}(BasePanel);__reflect(StoreItemPanel.prototype,"StoreItemPanel");var StoreMedalPanel=function(t){function e(){var e=t.call(this)||this;return e.coin=0,e.name=LangMgr.getValueByKey("shopTips13"),e.skinName="StoreMedalPanelSkin",e.labelGetCoin.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+e.labelGetCoin.text+"</u></a>"),e.list.itemRenderer=StoreMedalItemRenderer,e.scroller.scrollPolicyH=eui.ScrollPolicy.OFF,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];storeControl.upMedalMessage(),this.addCustomEvent(201,this.updataData),this.addCustomEvent(202,this.buyResult),this.addEventTouchTap(this.list,this.onBuy),this.addEventTouchTap(this.labelGetCoin,this.onGetCoin)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.updataData=function(){var t=DataCenter.ins().StoreConfig,e=storeControl.medalData;for(var i in t){var n=e.exchangeCount[t[i].index];isNaN(n)?t[i].exchangeCount=0:t[i].exchangeCount=n}this.setListData(t)},e.prototype.onBuy=function(t){if("buy"==t.target.name){var e=ActorControl.feats,i=t.target.parent,n=i.data;if(n.exchangeCount>=n.daycount&&0!=n.daycount){var o=LangMgr.getValueByKey("shopTips18");tipsControl.showTips(o)}else if(n.costMoney.count>e){var o=LangMgr.getValueByKey("shopTips19");tipsControl.showTips(o)}else storeControl.upBuyMedal(n.index,1)}},e.prototype.buyResult=function(t){var e=LangMgr.getValueByKey("shopTips20"),i=0,n=DataCenter.ins().StoreConfig;for(var o in n)n[o].index==t[0]&&(n[o].exchangeCount=t[1],i=n[o].costMoney.count);e=e+i+LangMgr.getValueByKey("currency7"),tipsControl.showTips(e),this.setListData(n)},e.prototype.setListData=function(t){var e=new eui.ArrayCollection;for(var i in t)e.addItem(t[i]);this.list.dataProvider=e;ActorControl.feats;this.labelCoin.text=ActorControl.feats.toString()},e.prototype.onGetCoin=function(t){UIMgr.ins().open(ShopWarnView).setData(7,1)},e}(BasePanel);__reflect(StoreMedalPanel.prototype,"StoreMedalPanel");var StoreNoblePanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopTips22"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.listView.itemRenderer=StoreNobleItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0]&&TimerMgr.ins().doNext(this.scrollBottom,this),this.addEventTouchTap(this,this.onTap),this.addEventTouchTap(this.tipImg,this.onTap),this.updateData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onTap),this.removeEventTouchTap(this.tipImg,this.onTap)},e.prototype.updateData=function(){var t=[],e=DataCenter.ins().StoreIntegralConfig;for(var i in e)t.push(e[i]);this.listView.dataProvider=new eui.ArrayCollection(t)},e.prototype.onTap=function(t){if("buy"==t.target.name){var e=t.target.parent.goodsID,i=t.target.parent.shopType;payControl.getIsForeve()?UIMgr.ins().open(StoreBuyView,e,i):tipsControl.showTips(LangMgr.getValueByKey("shopTips23"))}else t.currentTarget==this.tipImg&&UIMgr.ins().open(WelfareView,2)},e.prototype.scrollBottom=function(){this.listView.scrollV=this.listView.contentHeight-this.listView.height},e}(BasePanel);__reflect(StoreNoblePanel.prototype,"StoreNoblePanel");var StoreSpecialView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="StoreSpecialViewSkin",this.num=3},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.add1Btn,this.onTap),this.addEventTouchTap(this.add10Btn,this.onTap),this.addEventTouchTap(this.sub1Btn,this.onTap),this.addEventTouchTap(this.sub10Btn,this.onTap),this.addEventTouchTap(this.buyBtn,this.buy),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventChange(this.numLabel,this.inputOver),this.num=3,this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.add1Btn,this.onTap),this.removeEventTouchTap(this.add10Btn,this.onTap),this.removeEventTouchTap(this.sub1Btn,this.onTap),this.removeEventTouchTap(this.sub10Btn,this.onTap),this.removeEventTouchTap(this.buyBtn,this.buy),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventChange(this.numLabel,this.inputOver)},e.prototype.updateView=function(){this.numLabel.text=this.num+"",this.unitPrice.text=""+DataCenter.ins().GuardWeaponGuardConfig.sSummonCost[0],this.allPrice.text=this.num*parseInt(this.unitPrice.text)+""},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sub10Btn:this.num-=10;break;case this.sub1Btn:this.num-=1;break;case this.add10Btn:this.num+=10;break;case this.add1Btn:this.num+=1;break;case this.bgClose:UIMgr.ins().close(this)}this.num<0&&(this.num=0),this.num>this.maxNum&&(this.num=this.maxNum),this.numLabel.text=this.num+"",this.inputOver()},e.prototype.buy=function(t){ActorControl.yb>=parseInt(this.allPrice.text)?(copyControl.upShSweep(parseInt(this.numLabel.text)),UIMgr.ins().close(this)):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.inputOver=function(t){this.num=parseInt(this.numLabel.text),(isNaN(this.num)||this.num<0)&&(this.num=0),this.num>3&&(this.num=3),this.num>this.maxNum&&(this.num=this.maxNum),this.numLabel.text=this.num+"",this.allPrice.text=this.num*parseInt(this.unitPrice.text)+""},e}(BaseEuiView);__reflect(StoreSpecialView.prototype,"StoreSpecialView");var StoreTreasureResolveAllView=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreTreasureResolveAllViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onClick),this.addCustomEvent(267,this.updateView),this.addCustomEvent(268,this.updateView),this.updateView()},e.prototype.updateView=function(){var t=[],e=DataCenter.ins().StoreTreasureDecomConfig;for(var i in e){var n=e[i];t.push(n)}this.list.itemRenderer=StoreTreasureResolveAllItemRenderer,this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(StoreTreasureResolveAllView.prototype,"StoreTreasureResolveAllView");var StoreTreasureResolveNumView=function(t){function e(){var e=t.call(this)||this;return e.num=0,e.maxNum=0,e.skinName="StoreTreasureResolveNumViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemIcon.imgJob.visible=!1,this.addEventTouchTap(this.add1Btn,this.onTap),this.addEventTouchTap(this.add10Btn,this.onTap),this.addEventTouchTap(this.sub1Btn,this.onTap),this.addEventTouchTap(this.sub10Btn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.buyBtn,this.onBuyTap),this.addEventTouchTap(this.itemIcon,this.showTip),this.addEventChange(this.numLabel,this.onTxtChange),this.equiConfig=t[0]?t[0]:null,this.numLabel.restrict="0-9",this.updataView()},e.prototype.updataView=function(){var t=this.equiConfig;if(t){var e=backpackControl.getBagGoodsCountById(0,t.itemId);this.maxNum=e;var i=DataCenter.ins().ItemConfig[t.itemId];this.itemName.text=i.name,this.itemName.textColor=ItemUtils.getQualityColor(i),this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(i),this.num=this.maxNum,this.used.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("shopTips28",1,i.name,t.award.count)),this.numLabel.text=this.num+"",this.setViewCount(this.maxNum),this.inputOver()}},e.prototype.setViewCount=function(t){void 0!=t&&t>1?this.setCount(t+""):this.setCount("")},e.prototype.setCount=function(t){if(t.length>4){var e=Math.floor(Number(t)/1e3);t=LangMgr.getValueByKey("shopWan",e/10)}this.count.text=t},e.prototype.onTxtChange=function(t){var e=Number(this.numLabel.text);e>this.maxNum?e=this.maxNum:0>=e&&(e=1),this.num=e,this.numLabel.text=this.num+"",this.inputOver()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:return void UIMgr.ins().close(this);case this.sub10Btn:this.num=1;break;case this.sub1Btn:this.num-=1;break;case this.add10Btn:this.num=this.maxNum;break;case this.add1Btn:this.num+=1}this.num<1&&(this.num=1),this.num>this.maxNum&&(this.num=this.maxNum),this.numLabel.text=this.num+"",this.inputOver()},e.prototype.showTip=function(){var t=this.equiConfig;t&&UIMgr.ins().open(ItemTipsView,0,t.itemId,1)},e.prototype.onBuyTap=function(){var t=this.equiConfig;t&&(storeControl.upResolveTreasureShop(t.itemId,this.num),UIMgr.ins().close(this))},e.prototype.inputOver=function(){this.num=parseInt(this.numLabel.text),(isNaN(this.num)||this.num<1)&&(this.num=1),this.num>this.maxNum&&(this.num=this.maxNum),this.numLabel.text=this.num+"",CommonUtils.labelIsOverLenght(this.allPrice,this.num*this.equiConfig.award.count)},e}(BaseEuiView);__reflect(StoreTreasureResolveNumView.prototype,"StoreTreasureResolveNumView");var StoreTreasureResolveView=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreTreasureResolveViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.ListView.itemRenderer=StoreTreasureResolveItemRenderer,this._dataPro=new eui.ArrayCollection,this.ListView.dataProvider=this._dataPro},e.prototype.open=function(){this.addEventTouchTap(this.getallItemTxt,this.onClick),this.addEventTouchTap(this.bgClose,this.onClick),this.addEventTouchTap(this.closeBtn0,this.onClick),this.addEventTouchTap(this.closeBtn,this.onClick),this.addCustomEvent(663,this.updateView),this.updateView(),this.getallItemTxt.textFlow=TextUtils.generateTextFlow("|U:&T:"+this.getallItemTxt.text)},e.prototype.updateView=function(){var t=[],e=DataCenter.ins().StoreTreasureDecomConfig,i=[],n=0;for(var o in e){var s=e[o];(s.isshow||backpackControl.getBagGoodsCountById(0,s.itemId))&&(n+=1,t.push({index:n,cfg:s}))}var r=0;t.length<4?r=4-t.length:t.length%2!=0&&(r=1);for(var a=0;r>a;a++)n+=1,i.push({index:n});this._dataPro.replaceAll(t.concat(i))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.getallItemTxt:UIMgr.ins().open(StoreTreasureResolveAllView);break;default:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(StoreTreasureResolveView.prototype,"StoreTreasureResolveView");var StoreTreasureShopPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopTips30"),e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(205,this.refreshNum),this.addCustomEvent(204,this.updateView),this.addCustomEvent(662,this.refreshRedPoint),this.addEventTouchTap(this.duihuanBtn,this.OnTap),this.equipCfg=storeControl.zhenbaoShopData.returnitemconfig(991e3),this.equipCfg1=storeControl.zhenbaoShopData.returnWeekStoreonfig(991e3),this.updateView(),this.refreshRedPoint(),this.refreshNum()},e.prototype.refreshRedPoint=function(){this.redPoint.visible=!1},e.prototype.refreshNum=function(){var t=storeControl.zhenbaoShopData.getAcPoint(),e=this.equipCfg1.price,i=t>=e?ColorUtils.GREEN:ColorUtils.RED;this.zbnum.textFlow=TextUtils.generateTextFlow1("|C:"+i+"&T:"+t),this.neednum.text=e+"";var n=storeControl.shopData.getWeekBuyCount(this.equipCfg1.index);if(2==this.equipCfg1.storeType)storeControl.shopData.checkBuyWeekStore(this.equipCfg1.index,!1)?(this.costGroup.visible=!0,this.duihuanBtn.enabled=!0,this.numLable.visible=!1):(this.costGroup.visible=!1,this.duihuanBtn.enabled=!1,this.numLable.visible=!0,this.numLable.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("shopTips31")));else{if(this.equipCfg1.limitCount>0){this.numLable.visible=!0;var o=n>=this.equipCfg1.limitCount?""+n:"|C:0x00ff00&T:"+n+"|";this.numLable.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("shopTips32",o,this.equipCfg1.limitCount))}else this.numLable.visible=!1;this.duihuanBtn.enabled=!(n>=this.equipCfg1.limitCount)}heirloomControl.canDressHuanHua()?this.hhDes&&(this.hhDes.text=""):(this.duihuanBtn.visible=!1,this.redPoint.visible=!1,this.costGroup.visible=!1,this.hhDes&&(this.hhDes.visible=!0,this.hhDes.text=LangMgr.getValueByKey("shopTips33",heirloomControl.getDeressHHLevel())))},e.prototype.OnTap=function(t){switch(t.currentTarget){case this.duihuanBtn:storeControl.shopData.checkBuyWeekStore(this.equipCfg1.index)&&UIMgr.ins().open(StoreBuyView,this.equipCfg1.index,2==this.equipCfg1.storeType?5:4)}},e.prototype.updateView=function(){for(var t=[],e=0;e<this.equipCfg.attr.length;e++){var i=new AttributeData,n=this.equipCfg.attr[e];i.type=n.type,i.value=n.value,t.push(i);var o=AttributeData.getAttrStrByType(n.type);o+=20==n.type?"+"+n.value/100+"%":"+"+n.value;var s=this["attr"+this.equipCfg.attr[e].type];s&&(s.text=o)}var r=Math.floor(BackpackControl.getAttPowerContainRelate(t,0));this.powerPanel.setPower(r),null==this.effmc&&(this.effmc=new GameMovieClip,this.effmc.scaleX=this.effmc.scaleY=1.3,this.effmc.touchEnabled=!1,this.effGroup.addChild(this.effmc),this.effGroup.touchChildren=!1);var a=DataCenter.ins().HeirloomillusionConfig[this.equipCfg.id];this.effmc.playFile(PATH_EFF+a.eff+"n",-1)},e}(BasePanel);__reflect(StoreTreasureShopPanel.prototype,"StoreTreasureShopPanel");var StoreView=function(t){function e(){var e=t.call(this)||this;return e.lastIndex=0,e.scrollBottom=!1,e.skinName="StoreViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.closeBtn0,this.onClick),this.addEventTouchTap(this.getItemImg,this.onClick),this.addEventTouchTap(this.helpBtn,this.onClick),this.addEventChange(this.tab,this.onTabTouch),this.addCustomEvent(266,this.buyToUse),this.addCustomEvent(660,this.updateRedPoint),this.addCustomEvent(661,this.updateRedPoint),this.addCustomEvent(662,this.updateRedPoint),this.lastIndex=void 0==t[0]?this.lastIndex:t[0],t[1]&&(this.scrollBottom=t[1]),this.tab.selectedIndex=this.lastIndex,this.viewStack.selectedIndex=this.lastIndex,this.setOpenIndex(this.lastIndex),storeControl.dispatchRefreshGoodsSuccess(!1),this.updateRedPoint(),storeControl.zhenbaoShopData.isopen()||(DisplayUtils.removeFromParent(this.redPoint3),this.inactiveTreasure()),!bargainControl.isMoveEntrance){DisplayUtils.removeFromParent(this.redPoint4);var i=this.viewStack.getChildIndex(this.bargainView);i>=0&&this.viewStack.removeChildAt(i),this.tab.dataProvider=this.viewStack}},e.prototype.updateRedPoint=function(){this.redPoint0.visible=StoreRedPoint.ins().blackMarketRedPoint,this.redPoint2.visible=StoreRedPoint.ins().weekShopRedPoint,this.redPoint3.visible=StoreRedPoint.ins().treasureStoreRedPoint,this.redPoint4.visible=bargainControl.showRed||bargainControl.checkRed(),heirloomControl.canDressHuanHua()||(this.getItemImg.visible=!1),this.getItemRPImg.visible=this.getItemImg.visible&&StoreRedPoint.ins().treasureStoreRedPoint},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this.viewStack.numChildren,n=0;i>n;n++)this.viewStack.getChildAt(n).close()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.getItemImg:UIMgr.ins().open(StoreTreasureResolveView);break;case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.helpBtn:HelpControl.openHelpWin(111)}},e.prototype.inactiveTreasure=function(){var t=this.viewStack.getChildIndex(this.storeTreasureShopPanel);t>=0&&this.viewStack.removeChildAt(t),this.tab.dataProvider=this.viewStack},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex),2==t.currentTarget.selectedIndex&&this.redPoint2.visible&&(this.redPoint2.visible=!1,storeControl.upWeekShopRedPoint())},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.storeBlackPanel.open();break;case 1:this.storeItemPanel.open();break;case 2:this.storeWeekPanel.open();break;case 3:storeControl.zhenbaoShopData.isopen()?this.storeTreasureShopPanel.open():bargainControl.isMoveEntrance&&(UIMgr.ins().open(BargainView),UIMgr.ins().close(this));break;case 4:UIMgr.ins().open(BargainView),UIMgr.ins().close(this)}this.lastIndex!=t?(this.viewStack.getElementAt(this.lastIndex).close(),this.lastIndex=t):this.tab.selectedIndex=this.viewStack.selectedIndex=t,3!=t?(this.helpBtn.visible=!1,this.getItemImg.visible=this.getItemRPImg.visible=!1):(this.helpBtn.visible=!0,heirloomControl.canDressHuanHua()?(this.getItemImg.visible=!0,this.getItemRPImg.visible=StoreRedPoint.ins().treasureStoreRedPoint):(this.getItemImg.visible=!1,this.getItemRPImg.visible=!1))},e.prototype.buyToUse=function(){storeControl.shopBuyArr||(storeControl.shopBuyArr=[]);for(var t=0;t<storeControl.shopBuyArr.length;t++){var e=storeControl.shopBuyArr[t];backpackControl.upUseItem(e.id,e.count)}},e}(BaseEuiView);__reflect(StoreView.prototype,"StoreView");var StoreWeekPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("shopTips37"),e}return __extends(e,t),e.prototype.open=function(){this.addCustomEvent(203,this.updateView),this.addCustomEvent(204,this.refreshItem),this.updateView()},e.prototype.refreshItem=function(t){void 0===t&&(t=-1);for(var e=this.listView.dataProvider.length,i=0;e>i;i++){var n=this.listView.dataProvider,o=n.getItemAt(i);(-1==t||o.index==t)&&n.itemUpdated(o)}},e.prototype.updateView=function(){var t=this,e=[],i=GameServer.serverOpenDay+1,n=DataCenter.ins().StoreWeekConfig,o=[];for(var s in n){var r=n[s];1==r.storeType&&(storeControl.shopData.weekSrvList.indexOf(r.index)>-1&&o.push(r),r.openDay>0&&r.openDay<=i&&!r.pro&&e.push(r))}this.listView.itemRenderer=StoreWeekItemRenderer,this.listView.dataProvider=new eui.ArrayCollection(o.concat(e)),storeControl.shopData.weekStoreRedPoint&&TimerMgr.ins().doNext(function(){t.listView.contentHeight>t.listView.parent.height&&(t.listView.scrollV=t.listView.contentHeight-t.listView.parent.height)},this)},e}(BasePanel);__reflect(StoreWeekPanel.prototype,"StoreWeekPanel");var StoreBlackItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.goodsID=0,e.skinName="StoreBlackItemRendererSkin",e.addEventTouchTap(e.itemIcon,e.showTip),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,i=t.item,n=DataCenter.ins().ItemConfig[i.configID];this.goodsID=t.id;var o="";if(o=2==t.costType?t.costNum+"":t.costNum>1e5?LangMgr.getValueByKey("shopWan",Math.floor(t.costNum/1e4)):t.costNum+"",this.money.text=o,this.itemName.text=n.name,this.itemName.textColor=ItemUtils.getQualityColor(n),n.zsLevel&&n.zsLevel>0?this.level.text=LangMgr.getValueByKey("numberRotation1",n.zsLevel):n.level&&n.level>0?this.level.text="(Lv."+n.level+")":this.level.text="",this.level.x=this.itemName.x+this.itemName.width,this.num.text=1==i.count?"":i.count+"",this.moneyIcon.source=e.moneyTypeToIcon[t.costType],this.itemIcon.setData(n),0!=ItemUtils.getJob(n)){var s=backpackControl.calculationScore(t.item);s>0?(this.arrowIcon.visible=!0,this.CEKey.visible=!0,this.CEValue.visible=!0,this.CEValue.text=s+""):(this.arrowIcon.visible=!1,this.CEKey.visible=!1,this.CEValue.visible=!1)}else this.arrowIcon.visible=!1,this.CEKey.visible=!1,this.CEValue.visible=!1;var r=StoreEquipVo.discountDic[t.discountType];if(r)this.discount.source=r.res,this.wuzhe.visible=!1;else{var a=DataCenter.ins().StoreEquipItemConfig[this.goodsID];this.discount.source=a.discountImg,this.wuzhe.visible=!1}},e.prototype.showTip=function(){for(var t,e=storeControl.shopData,i=e.getShopEquipDataLength(),n=null,o=0;i>o;o++)if(n=e.getShopEquipDataByIndex(o),null!=n&&n.id==this.goodsID){t=n.item.configID;break}void 0==t&&new Error(LangMgr.getValueByKey("shopError"));var s=DataCenter.ins().ItemConfig[t],r=ItemUtils.getType(s);void 0!=r&&(0==r?UIMgr.ins().open(EquipTipsView,1,this.data.item.handle,s.id):9==r?UIMgr.ins().open(BookTipsView,s.id,0):UIMgr.ins().open(ItemTipsView,0,s.id,this.data.item.count))},e.moneyTypeToIcon=["","szjinbi","szyuanbao"],e}(BaseItemRender);__reflect(StoreBlackItemRenderer.prototype,"StoreBlackItemRenderer");var StoreHonorItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.goodsID=0,e.skinName="StoreHonorItemRendererSkin",e.addEventTouchTap(e.buyBtn,e.onClick),e.addEventTouchTap(e.itemIcon,e.showTip),e.itemIcon.imgJob.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){this.goodsID=t.goods[0].id;var e=DataCenter.ins().ItemConfig[this.goodsID];if(e)if(this.isShowTips=!1,1==t.shopType?(this.money.text=t.costMoney.count+"",this.moneyIcon.source="ZSchip"):2==t.shopType&&(this.money.text=t.costItem.count+"",this.moneyIcon.source="204076_png"),this.itemName.text=e.name,this.itemName.textColor=ItemUtils.getQualityColor(e),this.num.text=t.goods[0].count+"",this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(e),t.use&&(this.usage.text="（"+t.use+"）"),3==t.buyType){this.myTimes.visible=!0;var i=storeControl.medalData.exchangeCount[t.index];i=i?i:0;var n=this.myTimes.textColor,o=void 0,s="";t.daycount&&(i>=t.daycount?(o=ColorUtils.RED,s=LangMgr.getValueByKey("honorPerpetualBuy",o,i,t.daycount)):(o=ColorUtils.GREEN,s=LangMgr.getValueByKey("honorPerpetualLimitBuy",o,i,n,t.daycount))),this.myTimes.textFlow=TextUtils.generateTextFlow1(s)}else if(2==t.buyType)this.myTimes.visible=!1;else if(1==t.buyType){this.myTimes.visible=!0;var i=storeControl.medalData.exchangeCount[t.index];i=i?i:0;var n=this.myTimes.textColor,o=void 0,s="";t.daycount&&(i>=t.daycount?(o=ColorUtils.RED,s=LangMgr.getValueByKey("honorEveryDayBuy",o,i,t.daycount),this.isShowTips=!0):(o=ColorUtils.GREEN,s=LangMgr.getValueByKey("honorEveryDayLimitBuy",o,i,n,t.daycount))),this.myTimes.textFlow=TextUtils.generateTextFlow1(s)}}},e.prototype.onClick=function(){return this.isShowTips?void tipsControl.showTips(LangMgr.getValueByKey("honorEveryChange",LangMgr.getColor("color22"))):void(1==this.data.shopType?UIMgr.ins().open(StoreBuyView,this.data.index,2):2==this.data.shopType&&UIMgr.ins().open(StoreBuyView,this.data.index,3))},e.prototype.showTip=function(){var t,e=DataCenter.ins().StoreConfig;for(var i in e)e[i].goods[0].id==this.goodsID&&(t=e[i].goods[0].id);void 0==t&&new Error(LangMgr.getValueByKey("shopError"));var n=DataCenter.ins().ItemConfig[t],o=this.data;switch(DataCenter.ins().ItemDescConfig[n.descIndex].type){case 30:UIMgr.ins().open(DragonSoulItemTipsPreviewView,n.id);break;default:UIMgr.ins().open(ItemTipsView,0,n.id,o.goods[0].count)}},e}(BaseItemRender);__reflect(StoreHonorItemRenderer.prototype,"StoreHonorItemRenderer");var StoreIntegrationItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreIntegrationItemRendererSkin",e.item=new ItemBase,e.item.x=21,e.item.y=8,e.item.isShowName(!1),e.addChild(e.item),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().ItemConfig[t.itemId];if(void 0!=e){this.goodsID=t.index,this.money.text=CommonUtils.overLength(t.price),this.integration.text=CommonUtils.overLength(t.integral),this.itemName.text=e.name,this.itemName.textColor=ItemUtils.getQualityColor(e),this.used.text="",this.used.x=this.itemName.x+this.itemName.width;var i=new RewardVo;i.id=e.id,i.count=t.count,i.type=t.type,this.item.data=i}},e}(BaseItemRender);__reflect(StoreIntegrationItemRenderer.prototype,"StoreIntegrationItemRenderer");var StoreItemItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.goodsID=0,e.skinName="StoreItemItemRendererSkin",e.addEventTouchTap(e.itemIcon,e.showTip),e.itemIcon.imgJob.visible=!1,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().ItemConfig[t.itemId];this.goodsID=t.id;var i="";if(i=t.price>1e5?LangMgr.getValueByKey("shopWan",Math.floor(t.price/1e4)):t.price+"",this.money.text=i,this.itemName.text=e.name,this.itemName.textColor=ItemUtils.getQualityColor(e),this.used.text="（"+t.use+"）",this.used.x=this.itemName.x+this.itemName.width,t.viplv&&vipControl.lv<t.viplv)this.num.visible=!0,this.num.text=LangMgr.getValueByKey("shopVipBuy",vipControl.getVipStr(t.viplv));else if(t.vipLimit){var n=storeControl.shopData.getHadBuyCountItem(t.itemId),o=0;n&&(o=n.count);var s=t.vipLimit[vipControl.lv];this.num.text=LangMgr.getValueByKey("shopDayBuyTime",s-o),this.num.visible=!0}else this.num.visible=!1;this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(e)},e.prototype.showTip=function(){var t,e=DataCenter.ins().StoreItemConfig;for(var i in e)e[i].id==this.goodsID&&(t=e[i].itemId);void 0==t&&new Error(LangMgr.getValueByKey("shopError"));var n=DataCenter.ins().ItemConfig[t];UIMgr.ins().open(ItemTipsView,0,n.id,1)},e}(BaseItemRender);__reflect(StoreItemItemRenderer.prototype,"StoreItemItemRenderer");var StoreMedalItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="StoreMedalItemRendererSkin",e.item=new ItemBase,e.item.x=21,e.item.y=8,e.item.isShowName(!1),e.addChild(e.item),e.btnGet&&(e.btnGet.name="buy"),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.item.data=t.goods[0],this.itemName.text=this.item.getText(),this.itemName.textColor=this.item.getTextColor(),this.labelPrice.text=""+t.costMoney.count,t.daycount?(this.labelTimes.visible=!0,this.labelTimes.text=LangMgr.getValueByKey("shopTips17")+t.exchangeCount+"/"+t.daycount):this.labelTimes.visible=!1},e}(BaseItemRender);__reflect(StoreMedalItemRenderer.prototype,"StoreMedalItemRenderer");var StoreNobleItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.shopType=2,e.goodsID=0,e.skinName="StoreNobleItemRendererSkin",e.itemIcon.imgJob.visible=!1,e.addEventTouchTap(e.itemIcon,e.showTip),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t){var e=DataCenter.ins().ItemConfig[t.itemId];this.goodsID=t.index;var i="";i=t.price>1e5?LangMgr.getValueByKey("shopWan",Math.floor(t.price/1e4)):t.price+"",this.money0.text=i,i=t.showYuanBao>1e5?LangMgr.getValueByKey("shopWan",Math.floor(t.showYuanBao/1e4)):t.showYuanBao+"",this.money.text=i,this.itemName.text=e.name,this.itemName.textColor=ItemUtils.getQualityColor(e),this.used.text="（"+t.use+"）",this.used.x=this.itemName.x+this.itemName.width,this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(e)}},e.prototype.showTip=function(){var t,e=DataCenter.ins().StoreIntegralConfig;e[this.goodsID]&&(t=e[this.goodsID].itemId),void 0==t&&new Error(LangMgr.getValueByKey("shopError"));var i=DataCenter.ins().ItemConfig[t];UIMgr.ins().open(ItemTipsView,0,i.id,1)},e}(BaseItemRender);__reflect(StoreNobleItemRenderer.prototype,"StoreNobleItemRenderer");var StoreTreasureResolveAllItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemIcon.imgJob.visible=!1},e.prototype.dataChanged=function(){var t=this.data;if(t){var e=DataCenter.ins().ItemConfig[t.itemId];this.nameTxt.text=e.name,this.nameTxt.textColor=ItemUtils.getQualityColor(e),this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(e),this.used.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("shopTips28",1,e.name,t.award.count))}},e}(BaseItemRender);__reflect(StoreTreasureResolveAllItemRenderer.prototype,"StoreTreasureResolveAllItemRenderer");var StoreTreasureResolveItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemIcon.imgJob.visible=!1,this.addEventTouchTap(this.buyBtn,this.onBuyTap),this.addEventTouchTap(this.itemIcon,this.showTip)},e.prototype.dataChanged=function(){var t=this.data.index;this.superfjtai.scaleX=t%2==0?-1:1;var e=this.data.cfg;if(e){this.itemName.visible=!0,this.priceGroup.visible=!0,this.itemIcon.visible=!0,this.redPoint.visible=storeControl.zhenbaoShopData.treasureDecomRedpoints[e.itemId],this.buyBtn.visible=!0;var i=DataCenter.ins().ItemConfig[e.itemId];this.itemName.text=i.name,this.itemName.textColor=ItemUtils.getQualityColor(i),this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(i),this.Price.text=e.award.count+""}else this.itemName.visible=!1,this.priceGroup.visible=!1,this.itemIcon.visible=!1,this.buyBtn.visible=!1,this.redPoint.visible=!1},e.prototype.showTip=function(){var t=this.data.cfg;t&&UIMgr.ins().open(ItemTipsView,0,t.itemId,1)},e.prototype.onBuyTap=function(){var t=this.data.cfg;t&&(backpackControl.getBagGoodsCountById(0,t.itemId)?UIMgr.ins().open(StoreTreasureResolveNumView,t):tipsControl.showTips(LangMgr.getValueByKey("shopTips29")))},e}(BaseItemRender);__reflect(StoreTreasureResolveItemRenderer.prototype,"StoreTreasureResolveItemRenderer");
var StoreWeekItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.itemIcon.imgJob.visible=!1,this.addEventTouchTap(this.buyBtn,this.onBuyTap),this.addEventTouchTap(this.itemIcon,this.showTip)},e.prototype.dataChanged=function(){var t=this.data;if(t){this.money.text=t.price>1e5?Math.floor(t.price/1e4)+LangMgr.getValueByKey("chnUnitSection1"):t.price+"";var e=DataCenter.ins().ItemConfig[t.itemId];this.itemName.text=e.name,this.itemName.textColor=ItemUtils.getQualityColor(e),this.itemIcon&&this.itemIcon.setData&&this.itemIcon.setData(e),t.vip>0&&t.vip>vipControl.lv?(this.vip.visible=!0,this.vip.text=LangMgr.getValueByKey("shopTips34",t.vip)):this.vip.visible=!1,t.discount>0?(this.discountGroup.visible=!0,this.discount.text=t.discount+""):this.discountGroup.visible=!1,this.moneyImg.source=2==t.storeType?"storeSuperZbHubi_png":"szyuanbao";var i=storeControl.shopData.getWeekBuyCount(t.index);if(t.limitCount>0){this.num.visible=!0;var n=i>=t.limitCount?""+i:"|C:0x00ff00&T:"+i+"|";this.num.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("shopTips32",n,t.limitCount))}else this.num.visible=!1;this.buyBtn.enabled=!(i>=t.limitCount)}},e.prototype.showTip=function(){var t=this.data;if(t){var e=DataCenter.ins().ItemConfig[t.itemId];e.id==fashionControl.getIdZhuangBanId(e.id)?UIMgr.ins().open(FashionTipsView,e,!0):heirloomControl.getDressDpById(e.id)?UIMgr.ins().open(FashionHeirloomTipsView,e,!0):UIMgr.ins().open(ItemTipsView,0,t.itemId,1)}},e.prototype.onBuyTap=function(){var t=this.data;if(t){var e=storeControl.shopData.getWeekBuyCount(t.index);if(t.limitCount>0&&e>=t.limitCount)return void tipsControl.showTips(LangMgr.getValueByKey("shopTips35"));if(t.vip>0&&t.vip>vipControl.lv)return void tipsControl.showTips(LangMgr.getValueByKey("shopTips36",t.vip));if(2==t.storeType&&storeControl.zhenbaoShopData.getAcPoint()<=0){var i=warnControl.show(LangMgr.getValueByKey("shopTips26"),null,null,function(){UIMgr.ins().open(StoreTreasureResolveView)});return void i.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("artRenderer1"))}storeControl.shopData.checkBuyWeekStore(t.index)&&UIMgr.ins().open(StoreBuyView,t.index,2==t.storeType?5:4)}},e}(BaseItemRender);__reflect(StoreWeekItemRenderer.prototype,"StoreWeekItemRenderer");var FlameMarkControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._lyMarkLv=0,e._lyMarkExp=0,e._isMax=!1,e._attDan=0,e._flyDan=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"lyMarkLv",{get:function(){return this._lyMarkLv},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lyMarkExp",{get:function(){return this._lyMarkExp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"skills",{get:function(){return this._skills},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMax",{get:function(){return this._isMax},enumerable:!0,configurable:!0}),e.prototype.getSkillLvById=function(t){return!this._skills||this._skills.length<t?0:this._skills[t-1]},Object.defineProperty(e.prototype,"attDan",{get:function(){return this._attDan},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"flyDan",{get:function(){return this._flyDan},enumerable:!0,configurable:!0}),e.prototype.downData=function(t,e,i,n,o){this._lyMarkLv=t,this._lyMarkExp=e;var s=i.length;this._skills=[],this._skills.length=s;for(var r=0;s>r;r++)this._skills[r]=i[r];this._attDan=n,this._flyDan=o,this._isMax=this._lyMarkLv>=Object.keys(DataCenter.ins().FlameMarkLvConfig).length,EventMgr.ins().dispatch(653)},e.prototype.downUpgrade=function(t){EventMgr.ins().dispatch(654,[t])},e.prototype.upUpgrade=function(){},e.prototype.upUpSkill=function(t){return[t]},e.prototype.upCompound=function(t){return[t]},e.prototype.checkOpen=function(){if(!superRingControl.isFireRingActivate())return!1;var t=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID);return!t||t.level<DataCenter.ins().FlameMarkConfig.openLevel?!1:!0},e.prototype.checkRed=function(){if(!this.checkOpen())return!1;if(!this.lyMarkLv)return!1;if(!this.isMax){var t=DataCenter.ins().FlameMarkLvConfig[this.lyMarkLv];if(Assert(t,"FlameMarkControl lv:"+this.lyMarkLv+", exp:"+this.lyMarkExp))return!1;var e=backpackControl.getBagItemById(t.costItem),i=e?e.count:0,n=t.exp-this._lyMarkExp;if(i>=t.costCount&&i*DataCenter.ins().FlameMarkMatConfig[t.costItem].exp>=n)return!0}for(var o,s,r=0;6>=r;r++)if(0!=r){s=this.getSkillLvById(r+1);var a=s>=Object.keys(DataCenter.ins().FlameMarkEffectConfig[r+1]).length;if(!a&&(o=DataCenter.ins().FlameMarkEffectConfig[r+1][0>=s?1:s+1],o.costItem)){var i=backpackControl.getBagGoodsCountById(0,o.costItem);if(i>=o.costCount&&this.lyMarkLv>=o.stampLevel)return!0}}return this.checkAttrDanRed()?!0:this.checkFlyDanRed()?!0:this.checkMixRed()},e.prototype.checkMixRed=function(){var t,e;for(var i in DataCenter.ins().FlameMarkMatConfig)if(t=DataCenter.ins().FlameMarkMatConfig[i],e=0,t.costItem&&(e=backpackControl.getBagGoodsCountById(0,t.costItem)),t.costItem&&this.lyMarkLv>=t.limitLv&&e>=t.costCount)return!0;return!1},e.prototype.getCurSkillID=function(){for(var t,e,i=0,n=0,o=0;6>=o;o++)n=t=this.getSkillLvById(o+1),t||(t=1),e=DataCenter.ins().FlameMarkEffectConfig[o+1][t],o+1!=1&&o+1!=2||!n||(i=e.skillId);return i},e.prototype.getCurSkillCD=function(){var t=this.getCurSkillID(),e=this.getSkillLvById(3),i=e?DataCenter.ins().FlameMarkEffectConfig[3][e].reloadTime:0,n=DataCenter.ins().SkillsDescConfig[DataCenter.ins().SkillsConfig[t].desc];return n.cd-i},e.prototype.checkAttrDanRed=function(){if(!this.lyMarkLv)return!1;var t=DataCenter.ins().FlameMarkLvConfig[this.lyMarkLv];if(!t||this._attDan>=t.attrPill)return!1;var e=backpackControl.getBagGoodsCountById(0,DataCenter.ins().FlameMarkConfig.attrPillId);return e>0},e.prototype.checkFlyDanRed=function(){if(!this.lyMarkLv)return!1;var t=DataCenter.ins().FlameMarkLvConfig[this.lyMarkLv];if(!t||this._flyDan>=t.flyPill)return!1;var e=backpackControl.getBagGoodsCountById(0,DataCenter.ins().FlameMarkConfig.flyPillId);return e>0},e.prototype.userDans=function(t){if(!this.checkOpen()||!this.lyMarkLv)return void tipsControl.showTips(LangMgr.getValueByKey("flameMarkNoOpen"));var e=DataCenter.ins().FlameMarkLvConfig[this.lyMarkLv];t==DataCenter.ins().FlameMarkConfig.flyPillId&&this._flyDan>=e.flyPill?tipsControl.showTips(LangMgr.getValueByKey("flyIsFull")):t==DataCenter.ins().FlameMarkConfig.attrPillId&&this._attDan>=e.attrPill?tipsControl.showTips(LangMgr.getValueByKey("aptitudesIsFull")):UIMgr.ins().open(FireRingView,3)},e.prototype.getDanAttrs=function(){for(var t=DataCenter.ins().FlameMarkLvConfig[this._lyMarkLv],e=t.attrs.length,i=[],n=this._flyDan,o=this._attDan,s=0;e>s;s++)i.push(new AttributeData(t.attrs[s].type,Math.floor(t.attrs[s].value*DataCenter.ins().FlameMarkConfig.flyPill/1e4*n)));var r=DataCenter.ins().FlameMarkConfig.attrPill.concat();e=r.length;for(var s=0;e>s;s++)i.push(new AttributeData(r[s].type,r[s].value*o));r=DataCenter.ins().FlameMarkConfig.flyPillAttr.concat(),e=r.length;for(var s=0;e>s;s++)i.push(new AttributeData(r[s].type,r[s].value*n));return i},e.prototype.upUseDan=function(t){return[t]},e.prototype.downUseDan=function(t,e){t?this._flyDan=e:this._attDan=e,EventMgr.ins().dispatch(710)},e.TYPE_ATTDAN=0,e.TYPE_FLYDAN=1,__decorate([down(1,[2,3,[2],2,2])],e.prototype,"downData",null),__decorate([down(2,[1])],e.prototype,"downUpgrade",null),__decorate([up(2)],e.prototype,"upUpgrade",null),__decorate([up(3,[1])],e.prototype,"upUpSkill",null),__decorate([up(4,[3])],e.prototype,"upCompound",null),__decorate([up(5,[1])],e.prototype,"upUseDan",null),__decorate([down(5,[1,2])],e.prototype,"downUseDan",null),e=__decorate([protocolsId(71)],e)}(BaseSystem);__reflect(FlameMarkControl.prototype,"FlameMarkControl");var SuperRingControl=function(t){function e(){var e=t.call(this)||this;return e.mainHandler=[],e.ringList=[],e.loginDayCount=0,e.ringActiNum=0,e.specialRingHandler=[],e.ringsConfig=[],e.moneyOpenGrid=0,e.abilityIds=[],e.skillLvDic={},e.addCustomEvent(353,e.createRingAvatar),e}return __extends(e,t),i=e,e.prototype.downRingAbility=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1];this.abilityIds[i]=n}if(0==MapControl.copyType){var o=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);if(o){var s=this.getRingStair(o.level);s>=2&&(this.specialRingHandler[GameConst.FIRE_RING_ID]>0&&UnitMgr.ins().removeByHandle(this.specialRingHandler[GameConst.FIRE_RING_ID]),superRingControl.createRingMonster(GameConst.FIRE_RING_ID))}}var r=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID];for(var i in r)if(r[i][1]){var a=backpackControl.getBagItemById(r[i][1].itemId);a&&a.setCanbeUsed()}backpackControl.dispatchHasItemCanUse()},e.prototype.createRingAvatar=function(){if(0==MapControl.copyType){var t=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);if(t){var e=this.getRingStair(t.level);e>=2&&superRingControl.createRingMonster(GameConst.FIRE_RING_ID)}}},e.prototype.upUpGrade=function(t,e){return[t,e]},e.prototype.downRingUpdate=function(t,e,i){heroControl.getSubRoleByIndex(e).setExRingsData(t,i),EventMgr.ins().dispatch(161)},e.prototype.upActiveRing=function(t,e){return void 0===e&&(e=0),[t,e]},e.prototype.downActiveRing=function(t,e,i,n){var o=this.getSpecialRingDataById(t);o.level=e,o.exp=i,o.fight=n,this.ringActiNum++,t==GameConst.FIRE_RING_ID&&this.updateGrid(),EventMgr.ins().dispatch(162,[t,0])},e.prototype.downSRStairUp1=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.srStairUp(t)},e.prototype.downSRStairUp2=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.srStairUp(t)},e.prototype.srStairUp=function(t){var e=this.getSpecialRingDataById(t[0]);e.level=t[1],e.exp=t[2],e.fight=t[3],this.createRingAvatar(),this.updateGrid(),EventMgr.ins().dispatch(164,[t[0],0])},e.prototype.upSpicelRingUpdate=function(t){return[t]},e.prototype.downSpicelRingUpdate=function(t,e,i,n,o){var s=this.getSpecialRingDataById(t);s.level=e,s.exp=i,s.fight=o,EventMgr.ins().dispatch(163,[t,n])},e.prototype.downGetSpicelRingInfo=function(t,e){this.loginDayCount=t,this.ringList=[],this.ringActiNum=0;for(var i=0;i<e.length;i++){var n=new SpecialRingDataVo;n.init(e[i]),this.ringList.push(n),n.level>0&&this.ringActiNum++}return 0==MapControl.copyType&&gameControl.dispatchHookStateChange(GameControl.HOOK_STATE_FIND_ENMENY),this.createRingAvatar(),!0},e.prototype.isFireRing=function(t){return this.specialRingHandler[GameConst.FIRE_RING_ID]==t},e.prototype.createRingMonster=function(t){if(this.ringList&&!(this.ringList.length<=0)){var e=DataCenter.ins().FireRingRoleConfig[t],n=this.getSpecialRingDataById(t);if(!(n.level<e.showMonsterLv)){var o=e.monsterId,s=this.getAbilityID();if(s){var r=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][s][this.abilityIds[s]];r&&(o+=r.monId)}if(!UnitMgr.ins().getEntityByHandle(this.specialRingHandler[t])){var a=UnitMgr.ins().getNoDieRole();if(a){var l=copyControl.createModel(DataCenter.ins().MonstersConfig[o]);l.setAtt(9,i.FIRE_RING_MOVING_SPEED),l.x=a.x,l.y=a.y,l.masterHandle=ActorControl.handle,this.specialRingHandler[t]=l.handle=egret.getTimer(),l.lyMarkLv=flameMarkControl.lyMarkLv,l.lyMarkSkills=flameMarkControl.skills;var h=gameControl.createEntityByModel(l,0);h.AI_STATE=0}}}}},e.prototype.upRingLevelUp=function(t){return[t]},e.prototype.upRingFight=function(t,e){return[2,1]},e.prototype.checkOperation=function(){var t=this.checkHaveUpRing();return!t&&this.isFireRingFuse()&&(t=this.isCanStudySkill()||this.isCanUpgradeSkill()),t},e.prototype.checkHaveUpRing=function(){if(!superRingControl.checkRingOpen())return!1;for(var t=this.ringList.length,e=0;t>e;e++){var i=this.ringList[e],n=this.checkRedPoint(i.id,i.level);if(n)return n}return this.checkDanRed()},e.prototype.checkRingOpen=function(){var t=DataCenter.ins().FireRingRoleComConfig.actImbaId;return artifactControl.getNewArtifactBy(artifactControl.getArtifactIndexById(t))?artifactControl.getNewArtifactBy(artifactControl.getArtifactIndexById(t)).open:!1},e.prototype.checkRedPoint=function(t,e){return e>0?this.checkCanUpdate(t,e):this.checkCanActive(t)},e.prototype.checkCanUpdate=function(t,e){var i=!1;if(t==GameConst.FIRE_RING_ID&&this.isFireRingFuse()){DataCenter.ins().FireRingRoleConfig[t];if(this.getRingConfigById(t,e+1))if(e%11==0)i=!0;else{var n=this.getRingConfigById(t,e),o=backpackControl.getBagGoodsCountById(0,n.costItem);i=n.cost<=o}}return i},e.prototype.checkCanActive=function(t){var e=DataCenter.ins().FireRingRoleConfig[t],i=!1;if(t==GameConst.FIRE_RING_ID)this.isFireRingActivate()||(i=this.isFireRingCanActivate());else{var n=this.getSpecialRingDataById(t).level;0==n&&(i=superRingControl.loginDayCount>=e.openDay&&e.openDay>=0||vipControl.lv>=e.openVip&&e.openVip>=0&&ActorControl.yb>=e.openYb)}return i},e.prototype.canGradeupRing=function(t){for(var e,i=[!1,!1,!1],n=heroControl.subRolesLen,o=0,s=0,r=0,a=0;n>a;a++){var l=heroControl.getSubRoleByIndex(a);o=l.getExRingsData(t),e=DataCenter.ins()["FireRing"+t+"Config"][o],s=e.cost,s?(r=backpackControl.getBagGoodsCountById(0,DataCenter.ins().FireRingConfig[t].costItem),i[a]=r>=s):i[a]=!1}return i},e.prototype.getRingConfigById=function(t,e){return 0==this.ringsConfig.length&&this.initConfig(),this.ringsConfig[t]&&this.ringsConfig[t][e]?this.ringsConfig[t][e]:null},e.prototype.initConfig=function(){this.ringsConfig=[];var t=DataCenter.ins().FireRingRoleConfig;for(var e in t)this.ringsConfig[t[e].id]=DataCenter.ins()["FireRingRole"+e+"Config"]},e.prototype.getRingStair=function(t){var e=0;return e=Math.ceil(t/(i.perStar+1))},e.prototype.getRingStar=function(t){return 1>t?0:(t-1)%(i.perStar+1)},e.prototype.hasHanlder=function(t){for(var e=0;e<this.mainHandler.length;e++)if(t==this.mainHandler[e])return!0;return this.mainHandler.push(t),!1},e.prototype.delHanlder=function(t){for(var e=0;e<this.mainHandler.length;e++)if(t==this.mainHandler[e])return void this.mainHandler.splice(e,1)},e.prototype.getSpecialRingDataById=function(t){for(var e=0;e<this.ringList.length;e++)if(this.ringList[e].id==t)return this.ringList[e];return null},e.prototype.isFireRingFuse=function(){var t=!1,e=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);return e&&e.level>=1&&(t=!0),t},e.prototype.isFireRingActivate=function(){var t=!1,e=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);return e&&e.isUnLock&&(t=!0),t},e.prototype.isFireRingCanActivate=function(){var t=!1,e=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID];e.openDay;if(superRingControl.loginDayCount>=e.openDay)for(var i=0;i<this.ringList.length;i++)if(t=!0,this.ringList[i].id!=GameConst.FIRE_RING_ID&&0==this.ringList[i].level){t=!1;break}return t},e.prototype.upDeblock=function(t){return[t]},e.prototype.downUnLock=function(t,e,i,n,o){for(var s=0;s<this.ringList.length;s++)if(this.ringList[s].id==t){this.ringList[s].level=e,this.ringList[s].exp=i,this.ringList[s].fight=n,this.ringList[s].isUnLock=o;break}1==o&&EventMgr.ins().dispatch(165,!0)},e.prototype.upOpenGrid=function(){},e.prototype.upLearnSkill=function(t,e){return[t,e]},e.prototype.upUpgradeSkill=function(t){return[t]},e.prototype.downSkillInfo=function(t,e){this.initSkill(),this.moneyOpenGrid=t,this.updateGrid();for(var i=0;i<e.length;i++){var n=new RingSkillInfoVo;n.position=e[i][0],n.skillId=e[i][1],n.skillLvl=e[i][2],this.updateSkillInfo(n)}EventMgr.ins().dispatch(166)},e.prototype.updateGrid=function(){var t=this.getSpecialRingDataById(GameConst.FIRE_RING_ID),e=0;t&&t.level>0&&(e=this.moneyOpenGrid+this.getRingConfigById(GameConst.FIRE_RING_ID,t.level).freeSkillGrid),this.updateGridOpen(e)},e.prototype.updateGridOpen=function(t){for(var e=1;t>=e;e++){var i=this.skillInfo[e-1];i.isOpen=!0}},e.prototype.updateSkillInfo=function(t){for(var e=this.skillInfo.length,i=0;e>i;i++){var n=this.skillInfo[i];n.position==t.position&&(n.skillId=t.skillId,n.skillLvl=t.skillLvl)}},e.prototype.initSkill=function(){if(!this.skillInfo){this.skillInfo=[];for(var t=1;9>t;t++){var e=new RingSkillInfoVo;e.position=t,this.skillInfo.push(e)}}},e.prototype.getCanStudyBook=function(){var t=[];if(!this.skillInfo)return t;for(var e=this.skillInfo.length,i=[],n=0;e>n;n++){var o=this.skillInfo[n];o.skillId>0&&i.push(o.skillId)}for(var s=this.getActorExRingBookConfigByLvl(1),r=s.length,a=0;r>a;a++){var l=s[a];if(i.indexOf(l.id)<0){var h=backpackControl.getBagGoodsCountById(0,l.itemId);if(h>=l.num){var u=new RewardVo;u.id=l.itemId,u.count=h,u.type=1,t.push(u)}}}return t},e.prototype.isBookCanStudy=function(t){for(var e=this.skillInfo.length,i=[],n=0;e>n;n++){var o=this.skillInfo[n];o.skillId>0&&i.push(o.skillId)}for(var s=this.getActorExRingBookConfigByLvl(1),r=s.length,a=0;r>a;a++){var l=s[a];if(l.itemId==t&&i.indexOf(l.id)<0){var h=backpackControl.getBagGoodsCountById(0,l.itemId);if(h>=l.num)return!0}}return!1},e.prototype.getStudyBook=function(){for(var t=[],e=this.getActorExRingBookConfigByLvl(1),i=e.length,n=0;i>n;n++){var o=e[n],s=backpackControl.getBagGoodsCountById(0,o.itemId),r=new RewardVo;r.id=o.itemId,r.count=s,r.type=1,t.push(r)}return t},e.prototype.getFirstStudyBookIndex=function(){for(var t=this.getActorExRingBookConfigByLvl(1),e=t.length,i=0;e>i;i++){var n=t[i];if(this.isBookCanStudy(n.itemId))return i}return 0},e.prototype.isCanStudySkill=function(){var t=this.getCanStudyBook(),e=!1;return void 0!=t&&t.length>0&&this.isHaveFreeGrid()&&(e=!0),e},e.prototype.isHaveFreeGrid=function(){for(var t=this.skillInfo.length,e=0;t>e;e++){var i=this.skillInfo[e];if(0==i.skillId&&i.isOpen)return!0}return!1},e.prototype.isCanUpgradeSkill=function(){if(!this.skillInfo)return!1;for(var t=this.skillInfo.length,e=0;t>e;e++){var i=this.skillInfo[e];if(i.skillId>0&&i.skillLvl<this.getSkillMaxLvl(i.skillId)){var n=this.getActorExRingBookConfig(i.skillId,i.skillLvl),o=backpackControl.getBagGoodsCountById(0,n.itemId);if(o>=n.num)return!0}}return!1},e.prototype.fireRingRedPoint=function(){return copyControl.fbRings.challengeTime>0||copyControl.fbRings.canTakeAward},e.prototype.getActorExRingBookConfig=function(t,e){var i;for(var n in DataCenter.ins().FireRingRoleBookConfig)for(var o in DataCenter.ins().FireRingRoleBookConfig[n])if(n==t.toString()&&o==e.toString()){i=DataCenter.ins().FireRingRoleBookConfig[n][o];break}return i},e.prototype.getActorExRingBookConfigByLvl=function(t){var e=[],i=[];for(var n in DataCenter.ins().FireRingRoleBookConfig)for(var o in DataCenter.ins().FireRingRoleBookConfig[n])if(o==t.toString()){i.indexOf(DataCenter.ins().FireRingRoleBookConfig[n][o].itemId)<0&&(i.push(DataCenter.ins().FireRingRoleBookConfig[n][o].itemId),e.push(DataCenter.ins().FireRingRoleBookConfig[n][o]));break}return e},e.prototype.getSkillIdByItemId=function(t){var e;for(var i in DataCenter.ins().FireRingRoleBookConfig)for(var n in DataCenter.ins().FireRingRoleBookConfig[i])if(DataCenter.ins().FireRingRoleBookConfig[i][n].itemId==t)return e=parseInt(i);return 0},e.prototype.getSkillMaxLvl=function(t){var e=0;if(void 0!=this.skillLvDic[t])e=this.skillLvDic[t];else{for(var i in DataCenter.ins().FireRingRoleBookConfig)if(i==t.toString())for(var n in DataCenter.ins().FireRingRoleBookConfig[i])e++;this.skillLvDic[t]=e}return e},e.prototype.getNextStageSkillName=function(t){var e;for(var i in DataCenter.ins().FireRingRoleAbilityConfig){var n=DataCenter.ins().FireRingRoleAbilityConfig[i];if(n&&n.ringLv==t){e=n.abilityName;break}}return e},e.prototype.getUnLockStage=function(t){var e=DataCenter.ins().FireRingRoleAbilityConfig[t],i=e.ringLv,n=LangMgr.getValueByKey("chinese"+i);return n},e.prototype.getRingSkill=function(){if(!this.skillInfo)return 0;for(var t=this.skillInfo.length,e=0,i=0;t>i;i++){var n=this.skillInfo[i];if(7==n.skillId){e=n.skillLvl;break}}var o=this.getSpecialRingDataById(7).level,s=0,r=this.getRingConfigById(7,o);if(r&&(s=r.summonerSkillId,e>0&&s)){var a=s%10;a+=e,a>9&&(a=9);var l=Math.floor(s/10);s=10*l+a}return s},e.prototype.getCanUpgradeStars=function(t){for(var e=this.getSpecialRingDataById(GameConst.FIRE_RING_ID).level,i=0;;){e++;var n=DataCenter.ins().FireRingRole7Config[e];if(!n)return i;if(t-=n.cost,!(t>=0))return i;i++}},e.prototype.getAbilityID=function(t){void 0===t&&(t=0);var e=0;for(var i in this.abilityIds){if(e==t)return+i;e++}return 0},e.prototype.getAbilityIdByItemId=function(t){var e=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID];for(var i in e)if(e[i][1].itemId=t)return+i;return 0},e.prototype.getMaxAbilityLvByItemId=function(t){var e=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID];for(var i in e)if(e[i][1].itemId=t)return CommonUtils.getObjectLength(e[i]);return 0},e.prototype.checkCanUseByItem=function(t){var e=this.getAbilityIdByItemId(t),i=this.getMaxAbilityLvByItemId(t);return e&&this.abilityIds[e]>=i?!1:!0},e.ins=function(){return t.ins.call(this)},e.prototype.getRingTotalAttribute=function(){for(var t,e=this,i=function(i){var n=1;i==GameConst.FIRE_RING_ID&&(n=e.getSpecialRingDataById(GameConst.FIRE_RING_ID).level);var o=e.getRingConfigById(i,n);if(!o)return"continue";if(t)if(i==GameConst.FIRE_RING_ID){var s=CommonUtils.copyDataHandler(o.attrAward),r=superRingControl.getAbilityID();if(r){var a=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][r][superRingControl.abilityIds[r]];s.forEach(function(t,e){t.value*=1+a.attrPer/1e4,t.value=Math.round(t.value)})}t=AttributeData.AttrAddition(t,s)}else t=AttributeData.AttrAddition(t,o.attrAward);else t=o.attrAward},n=2;7>=n;n++)i(n);return t},e.prototype.getSpecailAddPower=function(t){var e=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);if(!e||!e.level)return 0;var i=superRingControl.getRingConfigById(GameConst.FIRE_RING_ID,e.level);if(!i||!i.attrAward||!i.attrAward.length)return 0;for(var n=[],o=i.attrAward.length,s=0;o>s;s++)n.push(new AttributeData(i.attrAward[s].type,Math.floor(i.attrAward[s].value*t/1e4)));return BackpackControl.getAttrPower(n)},Object.defineProperty(e.prototype,"totalPower",{get:function(){if(!this.checkRingOpen()&&!this.isFireRingFuse())return 0;for(var t=0,e=heroControl.subRolesLen,i=[],n=0,o=0,s=0,r=2;7>=r;r++){var a=this.getSpecialRingDataById(r);if(a||a.level){var l=a.level,h=this.getRingConfigById(r,l);if(h&&(i=i.concat(h.attrAward.concat()),r==GameConst.FIRE_RING_ID)){var u=superRingControl.getAbilityID();if(u){var p=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][u][superRingControl.abilityIds[u]];p&&p.attrPer&&(n+=p.attrPer,s+=p.attrPer)}h.exPower&&(o+=h.exPower)}}}for(var c,d,g=this.skillInfo?this.skillInfo.length:0,r=0;g>r;r++)c=this.skillInfo[r],c.skillId>0&&(d=superRingControl.getActorExRingBookConfig(c.skillId,c.skillLvl),c.skillId<=5?i=i.concat(d.attr.concat()):c.skillId>5&&d.exPower&&(o+=d.exPower),d.lvBaseAttrPer&&(n+=d.lvBaseAttrPer));if(n){var m=this.getSpecailAddAttrs(n);m&&m.length&&(i=i.concat(m))}i=AttributeData.combineAtts(i),g=i.length;for(var f=new Object,r=0;g>r;r++){var v=i[r];f[v.type]=v.value}f[11]&&f[2]&&i.push(new AttributeData(2,Math.floor(f[2]*f[11]/1e4))),f[12]&&f[4]&&i.push(new AttributeData(4,Math.floor(f[4]*f[12]/1e4))),f[23]&&f[5]&&i.push(new AttributeData(5,Math.floor(f[5]*f[23]/1e4))),f[24]&&f[6]&&i.push(new AttributeData(6,Math.floor(f[6]*f[24]/1e4)));var y=BackpackControl.getAttrPower2(i);if(y+=o,t+=y*e,flameMarkControl.lyMarkLv>0){var C=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv],T=[];s+=DataCenter.ins().FlameMarkConfig.flyPill*flameMarkControl.flyDan;for(var w in C.attrs)T.push(new AttributeData(C.attrs[w].type,C.attrs[w].value+Math.floor(C.attrs[w].value*s/1e4)));for(var I=DataCenter.ins().FlameMarkConfig.attrPill.concat(),b=I.length,r=0;b>r;r++)T.push(new AttributeData(I[r].type,I[r].value*flameMarkControl.attDan));I=DataCenter.ins().FlameMarkConfig.flyPillAttr.concat(),b=I.length;for(var r=0;b>r;r++)T.push(new AttributeData(I[r].type,I[r].value*flameMarkControl.flyDan));T=AttributeData.combineAtts(T);for(var D=BackpackControl.getAttrPower(T),B=0,r=0;6>=r;r++)B=flameMarkControl.getSkillLvById(r+1),B&&(D+=DataCenter.ins().FlameMarkEffectConfig[r+1][B].exPower);t+=D*e}return t},enumerable:!0,configurable:!0}),e.prototype.getSpecailAddAttrs=function(t){var e=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);if(!e||!e.level)return null;var i=superRingControl.getRingConfigById(GameConst.FIRE_RING_ID,e.level);if(!i||!i.attrAward||!i.attrAward.length)return null;for(var n=[],o=i.attrAward.length,s=0;o>s;s++)n.push(new AttributeData(i.attrAward[s].type,Math.floor(i.attrAward[s].value*t/1e4)));return n},e.prototype.getLyMarkPower=function(){if(flameMarkControl.lyMarkLv>0){var t=0,e=this.getSpecialRingDataById(GameConst.FIRE_RING_ID);if(e||e.level){var i=superRingControl.getAbilityID();if(i){var n=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][i][superRingControl.abilityIds[i]];n&&n.attrPer&&(t+=n.attrPer)}}else t=0;var o=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv],s=[];t+=DataCenter.ins().FlameMarkConfig.flyPill*flameMarkControl.flyDan;for(var r in o.attrs)s.push(new AttributeData(o.attrs[r].type,o.attrs[r].value+Math.floor(o.attrs[r].value*t/1e4)));for(var a=DataCenter.ins().FlameMarkConfig.attrPill.concat(),l=a.length,r=0;l>r;r++)s.push(new AttributeData(a[r].type,a[r].value*flameMarkControl.attDan));a=DataCenter.ins().FlameMarkConfig.flyPillAttr.concat(),l=a.length;for(var r=0;l>r;r++)s.push(new AttributeData(a[r].type,a[r].value*flameMarkControl.flyDan));s=AttributeData.combineAtts(s);for(var h=BackpackControl.getAttrPower(s),u=0,r=0;6>=r;r++)u=flameMarkControl.getSkillLvById(r+1),u&&(h+=DataCenter.ins().FlameMarkEffectConfig[r+1][u].exPower);return h*heroControl.subRolesLen}return 0},e.prototype.getSkillPower=function(){for(var t,e,i=[],n=0,o=this.skillInfo?this.skillInfo.length:0,s=0;o>s;s++)t=this.skillInfo[s],t.skillId>0&&(e=superRingControl.getActorExRingBookConfig(t.skillId,t.skillLvl),t.skillId<=5?i=i.concat(e.attr.concat()):t.skillId>5&&e.exPower&&(n+=e.exPower));return(BackpackControl.getAttrPower(i)+n)*heroControl.subRolesLen},e.prototype.getRingPower=function(){for(var t=[],e=0,i=0,n=0,o=2;7>=o;o++){var s=this.getSpecialRingDataById(o);if(s||s.level){var r=s.level,a=this.getRingConfigById(o,r);if(a&&(t=t.concat(a.attrAward.concat()),o==GameConst.FIRE_RING_ID)){var l=superRingControl.getAbilityID();if(l){var h=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][l][superRingControl.abilityIds[l]];h&&h.attrPer&&(e+=h.attrPer,n+=h.attrPer)}a.exPower&&(i+=a.exPower)}}}for(var u,p,c=this.skillInfo?this.skillInfo.length:0,d=[],o=0;c>o;o++)u=this.skillInfo[o],p=superRingControl.getActorExRingBookConfig(u.skillId,u.skillLvl),p&&(u.skillId<=5&&(d=d.concat(p.attr.concat())),p.lvBaseAttrPer&&(e+=p.lvBaseAttrPer));if(e){var g=this.getSpecailAddAttrs(e);g&&g.length&&(t=t.concat(g))}t=AttributeData.combineAtts(t),c=t.length;for(var m=new Object,o=0;c>o;o++){var f=t[o];m[f.type]=f.value}var v=new Object;d=AttributeData.combineAtts(d),c=d.length;for(var o=0;c>o;o++){var y=d[o];v[y.type]=y.value}m[11]&&(m[2]||v[2])&&t.push(new AttributeData(2,Math.floor(((m[2]?m[2]:0)+(v[2]?v[2]:0))*m[11]/1e4))),m[12]&&(m[4]||v[4])&&t.push(new AttributeData(4,Math.floor(((m[4]?m[4]:0)+(v[4]?v[4]:0))*m[12]/1e4))),m[23]&&(m[5]||v[5])&&t.push(new AttributeData(5,Math.floor(((m[5]?m[5]:0)+(v[5]?v[5]:0))*m[23]/1e4))),m[24]&&(m[6]||v[6])&&t.push(new AttributeData(6,Math.floor(((m[6]?m[6]:0)+(v[6]?v[6]:0))*m[24]/1e4)));var C=BackpackControl.getAttrPower2(t);return C+=i,C*heroControl.subRolesLen},e.prototype.checkDanRed=function(){for(var t=DataCenter.ins().FireRingRoleComConfig.upgrateItem,e=0;e<t.length;e++){var n=t[e];if(!backpackControl.isHideDanIcon(n)&&backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,n)){var o=this.getSpecialRingDataById(i.FIRE_RING_ID);if(o.level==DataCenter.ins().ItemConfig[n].useArg.maxLevel)return!0;break}}return!1},e.perStar=10,e.FIRE_RING_MOVING_SPEED=3750,e.FIRE_RING_ID=7,e.GRID_OPEN_LEVEL=20,__decorate([down(9,[[2,2]])],e.prototype,"downRingAbility",null),__decorate([up(1,[2,2])],e.prototype,"upUpGrade",null),__decorate([down(1,[2,2,2])],e.prototype,"downRingUpdate",null),__decorate([up(2,[2,1])],e.prototype,"upActiveRing",null),__decorate([down(2,[2,2,3,1])],e.prototype,"downActiveRing",null),__decorate([down(5,[2,2,3,1])],e.prototype,"downSRStairUp1",null),__decorate([down(6,[2,2,3,1])],e.prototype,"downSRStairUp2",null),__decorate([up(3,[2])],e.prototype,"upSpicelRingUpdate",null),__decorate([down(3,[2,2,3,1,1])],e.prototype,"downSpicelRingUpdate",null),__decorate([down(4,[3,ByteConst.SpecialRingDataVos])],e.prototype,"downGetSpicelRingInfo",null),__decorate([up(5,[2])],e.prototype,"upRingLevelUp",null),__decorate([up(6,[2,1])],e.prototype,"upRingFight",null),__decorate([up(7,[2])],e.prototype,"upDeblock",null),__decorate([down(7,[2,2,3,1,1])],e.prototype,"downUnLock",null),__decorate([up(8)],e.prototype,"upOpenGrid",null),__decorate([up(9,[2,2])],e.prototype,"upLearnSkill",null),__decorate([up(10,[2])],e.prototype,"upUpgradeSkill",null),__decorate([down(8,[2,[2,2,2]])],e.prototype,"downSkillInfo",null),e=i=__decorate([protocolsId(17)],e);var i}(BaseSystem);__reflect(SuperRingControl.prototype,"SuperRingControl");var BookSkillInfoVo=function(){function t(){this.itemId=0,this.num=0}return t}();__reflect(BookSkillInfoVo.prototype,"BookSkillInfoVo");var OtherFireRingDataVo=function(){function t(){this.lyMarkLv=0,this.lyMarkSkills=[]}return t.prototype.init=function(t){if(this.lv=t[0],this.skillBooks=[],this.abilityItems=[],!t[1]){for(var e=0;e<t[2].length;e++){var i=new RingSkillInfoVo;i.position=t[2][e][0],i.skillId=t[2][e][1],i.skillLvl=t[2][e][2],this.skillBooks.push(i)}for(var e=0;e<t[3].length;e++){var n=t[3][e][0],o=t[3][e][1];this.abilityItems[n]=o}this.lyMarkLv=t[4],this.lyMarkSkills=[],this.lyMarkSkills.length=t[5].length;for(var e=0;e<t[5].length;e++)this.lyMarkSkills[e]=t[5][e]}},t}();__reflect(OtherFireRingDataVo.prototype,"OtherFireRingDataVo");var RingSkillInfoVo=function(){function t(){this.position=0,this.skillId=0,this.skillLvl=0,this.isOpen=!1}return t}();__reflect(RingSkillInfoVo.prototype,"RingSkillInfoVo");var SpecialRingDataVo=function(){function t(){this.id=0,this.level=0,this.exp=0,this.fight=0,this.order=0,this.isUnLock=0}return t.prototype.init=function(t){this.id=t[0],this.level=t[1],this.exp=t[2],this.fight=t[3],this.isUnLock=t[4],this.order=DataCenter.ins().FireRingRoleConfig[this.id].order},t}();__reflect(SpecialRingDataVo.prototype,"SpecialRingDataVo");var FireRingAbilityView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FireRingAbilityViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.itemRenderer=FireRingAbilityItemRender,this.addEventTouchEnd(this.colorCanvas,this.otherClose),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.otherClose);var i=[];for(var n in DataCenter.ins().FireRingRoleAbilityConfig)i.push(parseInt(n));this.list.dataProvider=new ArrayCollection(i)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(FireRingAbilityView.prototype,"FireRingAbilityView");var FireRingBasePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isItemEnough=!1,e}return __extends(e,t),e.prototype.open=function(){this.addViewEvent(),this.initView(),this.upBtn.open(DataCenter.ins().FireRingRoleComConfig.upgrateItem)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.upBtn.close()},e.prototype.addViewEvent=function(){this.addEventTouchTap(this.showBtn,this.showDetail),this.addEventTouchTap(this.lvupBtn,this.upStar),this.addEventTouchTap(this.checkBtn,this.showAbility),this.addEventTouchTap(this.ultraBtn,this.showUltra),this.addCustomEvent(163,this.initView),this.addCustomEvent(164,this.initView)},e.prototype.showUltra=function(){UIMgr.ins().open(SuperRingUpgradeView)
},e.prototype.showAbility=function(){UIMgr.ins().open(FireRingAbilityView)},e.prototype.upStar=function(){10==this.starList.starNum?superRingControl.upRingLevelUp(GameConst.FIRE_RING_ID):this.isItemEnough?superRingControl.upSpicelRingUpdate(GameConst.FIRE_RING_ID):tipsControl.showTips(LangMgr.getValueByKey("fireTips8"))},e.prototype.showDetail=function(){UIMgr.ins().open(SuperRingDetailView,this.powerAttr)},e.prototype.initView=function(){var t=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID),e=superRingControl.getRingStair(t.level),i=superRingControl.getRingStar(t.level),n=0;n=void 0==this.lastStar?0:this.lastStar<i?1:0,this.lastStar=i;var o=superRingControl.getRingConfigById(GameConst.FIRE_RING_ID,t.level),s=DataCenter.ins().ItemConfig[o.costItem],r=superRingControl.getRingConfigById(GameConst.FIRE_RING_ID,t.level+1);this.lv.text=StringUtils.NumberToChinese(e)+LangMgr.getValueByKey("osaLevelJ"),this.costImg.source=s.icon+"_png";var a=backpackControl.getBagGoodsCountById(0,o.costItem),l="",h=o.cost;10==i?(a=0,h=0,this.costImg.visible=!1,this.costCount.visible=!1,this.costTitle.visible=!1,this.lvupBtn.label=LangMgr.getValueByKey("jingMaiUpdate")):(this.costImg.visible=!0,this.costCount.visible=!0,this.costTitle.visible=!0,this.lvupBtn.label=LangMgr.getValueByKey("fireTips9")),a>=h?(l=ColorUtils.GREEN_COLOR,this.isItemEnough=!0):(l=ColorUtils.RED_COLOR,this.isItemEnough=!1),this.costCount.textFlow=TextUtils.generateTextFlow("<font color="+l+">"+a+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+h+"</font> "),this.nowAttr.text=AttributeData.getAttStr(o.attrAward,0,1,"："),r?this.nextAttr.text=AttributeData.getAttStr(r.attrAward,0,1,"："):this.nextAttr.text=LangMgr.getValueByKey("maxLevel"),this.powerAttr=this.getRingTotalAttribute();var u=BackpackControl.getAttrPower(this.powerAttr);u*=heroControl.subRolesLen,this.power.setPower(u),this.starList||(this.starList=new StarList(10),this.starList.x=15,this.starGroup.addChild(this.starList)),this.starList.setStarNum(i,n),this.info.text=this.getNextStageAbility(e),superRingControl.getAbilityID()?(this.ultraBtn.icon="ability_0N",this.nameImg.source="ring_title2"):(this.ultraBtn.icon="ability_0L",this.nameImg.source="ring_title")},e.prototype.getRingTotalAttribute=function(){for(var t,e=function(e){var i=1;e==GameConst.FIRE_RING_ID&&(i=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID).level);var n=superRingControl.getRingConfigById(e,i);if(t)if(e==GameConst.FIRE_RING_ID){var o=CommonUtils.copyDataHandler(n.attrAward),s=superRingControl.getAbilityID();if(s){var r=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][s][superRingControl.abilityIds[s]];o.forEach(function(t,e){t.value*=1+r.attrPer/1e4,t.value=Math.round(t.value)})}t=AttributeData.AttrAddition(t,o)}else t=AttributeData.AttrAddition(t,n.attrAward);else t=n.attrAward},i=2;7>=i;i++)e(i);return t},e.prototype.getNextStageAbility=function(t){var e=t+1;2>e&&(e=2);var i=0;for(var n in DataCenter.ins().FireRingRole7Config)i++;for(var o=DataCenter.ins().FireRingRole7Config[i],s=superRingControl.getRingStair(o.level);s>e;){var r=superRingControl.getNextStageSkillName(e);if(r)return e+LangMgr.getValueByKey("fireTips1other","")+superRingControl.getNextStageSkillName(e);e++}return""},e}(BasePanel);__reflect(FireRingBasePanel.prototype,"FireRingBasePanel");var FireRingCopyPanel=function(t){function e(){var e=t.call(this)||this;return e.isUse=!1,e.name=LangMgr.getValueByKey("fireType1"),e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this,this.onTap),this.addCustomEvent(373,this.onUpdate),this.addCustomEvent(269,this.UseToItem),this.onUpdate()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTap),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.eff),this.eff=null},e.prototype.onUpdate=function(){this.isUse=!1;var t=copyControl.fbRings,e=0;t.canTakeAward?(e=1,this.currentState="free"):payControl.franchise?copyControl.fbRings.challengeTime>0?(this.currentState="sdget",e=1):(this.currentState="sdfb",e=0):(e=0,this.currentState="challenge"),this.validateNow(),this.onInitIndex(e)},e.prototype.UseToItem=function(){this.isUse&&(this.isUse=!1,copyControl.upChallengeFbRing())},e.prototype.getChangeNum=function(t){void 0==t&&(t=vipControl.lv);var e=DataCenter.ins().FireRingRoleFubenConfig.freeCount;return(DataCenter.ins().FireRingRoleFubenConfig.vipCount[t]||0)+e},e.prototype.onInitIndex=function(t){var e=copyControl.fbRings,i=DataCenter.ins().FireRingRoleFubenConfig.reward,n=i[0].count;if(0==t)if(this.lbTime.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("babelTodayTimes",e.challengeTime)),this.lbExp.text=""+n,e.challengeTime)this.btnChallenge.enabled=!0;else{for(var o=this.getChangeNum(),s=vipControl.lv+1,r=this.getChangeNum(s);void 0!=r&&r>=o&&(s+=1,r=this.getChangeNum(s),void 0!=DataCenter.ins().FireRingRoleFubenConfig.vipCount[s]););r-o>0&&(this.lbTime.text=LangMgr.getValueByKey("babelVipGet",vipControl.getVipStr(s),r-o))}else if(1==t){var a=DataCenter.ins().FireRingRoleFubenConfig.recPrice,l=0;for(var h in a){this["lbExp"+l].textFlow=TextUtils.generateTextFlow1("  "+n*(+h+1));var u=DataCenter.ins().FireRingRoleFubenConfig.recPrice[h];this["gold"+l].setPrice(u),l+=1}payControl.franchise&&(this.lbSweepTime.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("babelTodayTimes",e.challengeTime))),0==ServerStorage.ins().getValue(2)&&(this.eff||(this.eff=new GameMovieClip,this.eff.scaleX=1,this.eff.scaleY=1,this.eff.touchEnabled=!1,this.eff.x=this.btnGet2.width/2,this.eff.y=this.btnGet2.height/2,this.eff.playFile(PATH_EFF+"chargeff1",-1),this.btnGet2.addChild(this.eff))),ActorControl.level<80?(this.g1.visible=this.g2.visible=!1,this.g0.horizontalCenter=0):(this.g1.visible=this.g2.visible=!0,this.g0.horizontalCenter=-182)}},e.prototype.onTap=function(t){var e=t.target,i=copyControl.fbRings;if(this.checkBtnGet(e));else if(e==this.btnChallenge){if(copyControl.checkInFB())return;if(i.challengeTime<=0){var n="",o=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,202e3);return o?(n=LangMgr.getValueByKey("fireTips2",o.itemConfig.name),void warnControl.show(n,function(){this.isUse=!0,backpackControl.upUseItem(o.configID,1)},this)):i.buyTime<(DataCenter.ins().FireRingRoleFubenConfig.vipCount[vipControl.lv]||0)?(n=LangMgr.getValueByKey("fireTips3",DataCenter.ins().FireRingRoleFubenConfig.vipcost),void warnControl.show(n,function(){copyControl.upChallengeFbRing()},this)):(n=LangMgr.getValueByKey("bossTips6"),void tipsControl.showTips(n))}copyControl.upChallengeFbRing()}},e.prototype.checkBtnGet=function(t){var e=0;if(t==this.btnGet0?e=1:t==this.btnGet1?e=2:t==this.btnGet2&&(e=3),e>0){var i=DataCenter.ins().FireRingRoleFubenConfig.recPrice[e-1];if(ActorControl.yb<i)return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));var n=copyControl.fbRings;n.canTakeAward?copyControl.upFbRingTakeAward(e):payControl.franchise?copyControl.upRingSweep(e):copyControl.upFbRingTakeAward(e)}return e>0},e}(BasePanel);__reflect(FireRingCopyPanel.prototype,"FireRingCopyPanel");var FireRingFlyTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FireRingFlyTipViewSkin",e.uilayer=GameLayer.MAIN1,e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(710,this.update),this.addCustomEvent(653,this.update),this.addCustomEvent(266,this.itemChange),this.addCustomEvent(267,this.itemChange),this.addCustomEvent(268,this.itemChange),this.update()},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.updateBtn:flameMarkControl.upUseDan(FlameMarkControl.TYPE_FLYDAN)}},e.prototype.itemChange=function(){if("maxLv"!=this.currentState){var t=!1;flameMarkControl.checkAttrDanRed()?"normal"!=this.currentState&&(t=!0,this.currentState="normal"):"noitem"!=this.currentState&&(t=!0,this.currentState="noitem"),t&&this.updateAttrs()}},e.prototype.update=function(){var t=flameMarkControl.flyDan,e=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv].flyPill,i=t>=e;this.currentState=i?"maxLv":flameMarkControl.checkFlyDanRed()?"normal":"noitem",this.feishengLv.text=LangMgr.getValueByKey("numberLevel",t),this.maxLvDesc.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("fireRingFly",e)),this.updateAttrs()},e.prototype.updateAttrs=function(){for(var t=null,e=flameMarkControl.flyDan,i=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv],n=i.attrs.length,o=DataCenter.ins().FlameMarkConfig.flyPillAttr,s=o.length,r=[],a=1;4>=a;a++){var l=this["attr"+a],h=this["attr"+a+"NextLv"];l.text="",h.text="",n>=a&&(t=i.attrs[a-1],l.text=AttributeData.getAttrStrByType(t.type)+": +"+Math.floor(DataCenter.ins().FlameMarkConfig.flyPill/100)*e+"%","normal"==this.currentState&&(h.text="+"+Math.floor(DataCenter.ins().FlameMarkConfig.flyPill/100)*(e+1)+"%"),r.push(new AttributeData(t.type,Math.floor(t.value*DataCenter.ins().FlameMarkConfig.flyPill/1e4*e)))),l=this["attr"+(a+4)],h=this["attr"+(a+4)+"NextLv"],l.text="",h.text="",s>=a&&(t=o[a-1],l.text=AttributeData.getAttrStrByType(t.type)+": +"+t.value*e,"normal"==this.currentState&&(h.text="+"+t.value*(e+1)),r.push(new AttributeData(t.type,t.value*e)))}this.powerPanel.setPower(BackpackControl.getAttrPower(r))},e}(BaseEuiView);__reflect(FireRingFlyTipView.prototype,"FireRingFlyTipView");var FireRingMarkPanel=function(t){function e(){var e=t.call(this)||this;return e._angle=.1,e._angles=[0,0,0,0,0,0,0],e._circleCenter={x:279,y:229},e._a=155,e._b=80,e._oldBallNum=0,e.expBar=new ProgressBarEff,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.mixItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.mixItemTxt.text),this.expBar.setWidth(470),this.expBar.x=-85,this.expBar.y=-15,this.schedule.addChild(this.expBar)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(653,this.update),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addCustomEvent(654,this.updateEff),this.addEventTouchTap(this,this.onTouch),this._oldBallNum=0,this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents(),this._materailInfo=null,this.resetBalls(),this.clearRedEff(),this.updateMixEff(),this.updateDanRed(),this.expBar.reset()},e.prototype.resetBalls=function(){if(TimerMgr.ins().removeAll(this),this._balls){for(var t=this._balls.length,e=0;t>e;e++)this._balls[e].destroy(),this._balls[e]=null;this._balls.length=0,this._balls=null}},e.prototype.update=function(){var t=flameMarkControl.isMax,e=flameMarkControl.lyMarkLv;this.currentState=t?"max":"normal",this.lvtxt.text="Lv."+flameMarkControl.lyMarkLv;var i=[],n=DataCenter.ins().FlameMarkLvConfig[e];for(var o in n.attrs)i.push(new AttributeData(n.attrs[o].type,n.attrs[o].value));var s=BackpackControl.getAttrPower(i);if(this.nowAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(i,0,1,"：")),this.expBar.getMaxValue()!=n.exp?this.expBar.setData(flameMarkControl.lyMarkExp,n.exp):this.expBar.setValue(flameMarkControl.lyMarkExp),t)this.clearRedEff();else{i=[];var r=DataCenter.ins().FlameMarkLvConfig[e+1];for(var o in r.attrs)i.push(new AttributeData(r.attrs[o].type,r.attrs[o].value));this.nextAttr.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(i,0,1,"："));var a=DataCenter.ins().ItemConfig[n.costItem];this.costImg.source=a.icon+"_png",this.updateMaterial()}for(var l,h,u=0,p=0,c=0;6>=c;c++)p=l=flameMarkControl.getSkillLvById(c+1),l||(l=1),h=DataCenter.ins().FlameMarkEffectConfig[c+1][l],this["skill"+c].setCfg(h),c+1!=1&&c+1!=2||!p||(u=h.stamp),p&&h.exPower&&(s+=h.exPower);var d=heroControl.subRolesLen;if(this.power.setPower(s*d),u&&this._oldBallNum!=u){this.resetBalls(),this._oldBallNum=u,this._balls||(this._balls=[],TimerMgr.ins().doTimer(51,0,this.doCircle,this));for(var g=void 0,m=2*Math.PI/u,c=0;u>c;c++)g=ObjectPool.pop("GameMovieClip"),this.img.parent.addChild(g),this._angles[c]=m*c,g.x=this._a*Math.cos(m*c)+this._circleCenter.x,g.y=this._b*Math.sin(m*c)+this._circleCenter.y,this._balls.push(g),g.playFile(PATH_EFF+"lymarkeff",-1)}},e.prototype.doCircle=function(){if(!this._balls)return void TimerMgr.ins().removeAll(this);for(var t,e,i=this._balls.length,n=0,o=0,s=0;i>s;s++)t=this._balls[s],t.x=this._a*Math.cos(this._angles[s])+this._circleCenter.x,t.y=this._b*Math.sin(this._angles[s])+this._circleCenter.y,this._angles[s]+=this._angle,this._angles[s]=this._angles[s]%(2*Math.PI),e=t.parent,e&&(n=e.getChildIndex(this.img),o=e.getChildIndex(t),this._angles[s]>=2.5&&this._angles[s]<=6?o>n&&e.addChildAt(t,3):n>o&&e.addChildAt(t,e.numChildren))},e.prototype.updateMaterial=function(){if(this.updateMixEff(),this.updateDanRed(),!flameMarkControl.isMax){var t=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv],e=backpackControl.getBagItemById(t.costItem),i=e?e.count:0;this.costCount.textFlow=TextUtils.generateTextFlow1("|C:"+(i<t.costCount?LangMgr.getValueByKey("color22"):LangMgr.getValueByKey("color43"))+"&T:"+i+"|/"+t.costCount),this._materailInfo={enough:i>=t.costCount,id:t.costItem};var n=t.exp-flameMarkControl.lyMarkExp;i>=t.costCount&&i*DataCenter.ins().FlameMarkMatConfig[t.costItem].exp>=n?this._redEffect||(this._redEffect=ObjectPool.pop("GameMovieClip"),this._redEffect.touchEnabled=!1,this.lvupGroup.addChild(this._redEffect),this._redEffect.x=77,this._redEffect.y=28,this._redEffect.playFile(PATH_EFF+"chargeff1",-1)):this.clearRedEff()}},e.prototype.clearRedEff=function(){this._redEffect&&(this._redEffect.destroy(),this._redEffect=null)},e.prototype.onTouch=function(t){switch(t.target){case this.lvupBtn:this._materailInfo.enough?flameMarkControl.upUpgrade():tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));break;case this.mixItemTxt:UIMgr.ins().open(FlameMarkMixView);break;case this.skill0:case this.skill1:case this.skill2:case this.skill3:case this.skill4:case this.skill5:case this.skill6:UIMgr.ins().open(FlameMarkSkillTipsView,t.target.getCfg());break;case this.zizhiBtn:UIMgr.ins().open(FireRingTanleTipsView);break;case this.feishengBtn:UIMgr.ins().open(FireRingFlyTipView)}},e.prototype.updateEff=function(t){var e=t[0];if(e>1){var i=new eui.Image("xn_wingup"+e);i.horizontalCenter=0,i.verticalCenter=0,i.scaleX=i.scaleY=.5;var n=egret.Tween.get(i);n.to({scaleX:1.5,scaleY:1.5,alpha:0},500).call(function(){DisplayUtils.removeFromParent(i)},this),this.actEff.addChild(i)}},e.prototype.updateDanRed=function(){this.redPoint1.visible=flameMarkControl.checkFlyDanRed(),this.redPoint2.visible=flameMarkControl.checkAttrDanRed()},e.prototype.updateMixEff=function(){flameMarkControl.checkMixRed()?this.mixEff||(this.mixEff=ObjectPool.pop("GameMovieClip"),this.mixEff.touchEnabled=!1,this.mixGroup.addChild(this.mixEff),this.mixEff.scaleX=.6,this.mixEff.scaleY=.5,this.mixEff.x=40,this.mixEff.y=10,this.mixEff.playFile(PATH_EFF+"chargeff1",-1)):this.clearMixEff()},e.prototype.clearMixEff=function(){this.mixEff&&(this.mixEff.destroy(),this.mixEff=null)},e}(BasePanel);__reflect(FireRingMarkPanel.prototype,"FireRingMarkPanel");var FireRingSkillPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.skillId=0,e.isEoughItemUpgrade=!1,e.skillName="",e}return __extends(e,t),e.prototype.open=function(){this.initView(),this.addViewEvent(),this.upBtn.open(DataCenter.ins().FireRingRoleComConfig.upgrateSkillItem)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.upBtn.close()},e.prototype.addViewEvent=function(){this.addEventTouchTap(this.opraBtn,this.opration),this.addEventItemTap(this.list,this.onListChange),this.addEventItemTap(this.learnList,this.onLearnListChange),this.addCustomEvent(166,this.refreshView)},e.prototype.opration=function(){var t=superRingControl.skillInfo[this.lastSelectIndex];0==t.skillId?superRingControl.upLearnSkill(this.skillId,t.position):t.skillLvl==superRingControl.getSkillMaxLvl(t.skillId)?tipsControl.showTips(this.skillName+LangMgr.getValueByKey("fireTips10")):this.isEoughItemUpgrade?superRingControl.upUpgradeSkill(t.position):tipsControl.showTips(this.skillName+LangMgr.getValueByKey("fireTips11"))},e.prototype.onListChange=function(t){var e=superRingControl.skillInfo[this.list.selectedIndex];if(e.isOpen)this.updateView(t.itemIndex);else{var i=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID).level;superRingControl.getRingStair(i);if(i>=SuperRingControl.GRID_OPEN_LEVEL){var n=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID];ActorControl.yb>=n.skillGridYb?superRingControl.upOpenGrid():tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))}else tipsControl.showTips(LangMgr.getValueByKey("wingOpen",SuperRingControl.GRID_OPEN_LEVEL))}},e.prototype.onLearnListChange=function(t){this.selectSkill(this.learnList.selectedIndex)},e.prototype.initView=function(){this.list.itemRenderer=FireRingSkillItemRender,this.learnList.itemRenderer=FireRingSkillBookItemRender,this.updateList(),this.updateView(0)},e.prototype.updateList=function(){this.list.dataProvider=new ArrayCollection(superRingControl.skillInfo)},e.prototype.refreshView=function(){this.updateList(),this.updateView(this.lastSelectIndex)},e.prototype.updateView=function(t){this.lastSelectIndex=t,this.list.selectedIndex=t,this.selectList();var e=superRingControl.skillInfo[t];if(e.skillId){this.currentState="upgrade",this.opraBtn.enabled=!0;var i=superRingControl.getActorExRingBookConfig(e.skillId,e.skillLvl);if(this.skillName=i.skillName,this.nextLv.visible=!0,this.opraBtn.visible=!0,this.nowLvDesc.textFlow=TextUtils.generateTextFlow(i.skillDesc),e.skillLvl<superRingControl.getSkillMaxLvl(e.skillId)){this.nextLv.visible=!0;var n=superRingControl.getActorExRingBookConfig(e.skillId,e.skillLvl+1);this.nextLvDesc.textFlow=TextUtils.generateTextFlow(n.skillDesc),this.cost.text="X"+n.num,this.needItem.data=n.itemId,this.isEoughItemUpgrade=backpackControl.getBagGoodsCountById(0,i.itemId)>=n.num,this.isEoughItemUpgrade?(this.cost.textColor=ColorUtils.GREEN,this.updateRp.visible=!0):(this.cost.textColor=ColorUtils.RED,this.updateRp.visible=!1),this.updateGroup.visible=!0}else this.isEoughItemUpgrade=!0,this.updateGroup.visible=!1,this.nextLv.visible=!1,this.updateRp.visible=!1}else this.currentState="study",this.learnList.dataProvider=new ArrayCollection(superRingControl.getStudyBook()),0==this.learnList.dataProvider.length?(this.nowLvDesc.visible=!1,this.nextLvDesc.visible=!1,this.opraBtn.enabled=!1,this.nobook.visible=!0):(this.nowLvDesc.visible=!0,this.nextLvDesc.visible=!0,this.opraBtn.enabled=!0,this.nobook.visible=!1,this.selectSkill(superRingControl.getFirstStudyBookIndex()));for(var o,s,r,a,l=superRingControl.skillInfo.length,h=0,u=0;l>u;u++)s=superRingControl.skillInfo[u],s.skillId>0&&(r=superRingControl.getActorExRingBookConfig(s.skillId,s.skillLvl),s.skillId<=4?o=o?AttributeData.AttrAddition(o,r.attr):r.attr:5==s.skillId?a=r.bookAttrPer:s.skillId>5&&r.exPower&&(h+=r.exPower));var p=h;o&&(a&&(o=AttributeData.AttrMultiply(o,a)),p+=BackpackControl.getAttrPower(o)),p*=heroControl.subRolesLen,this.power.setPower(p)},e.prototype.selectSkill=function(t){this.learnList.selectedIndex=t;var e=this.learnList.dataProvider.getItemAt(t),i=superRingControl.getSkillIdByItemId(e.id),n=superRingControl.getActorExRingBookConfig(i,1);this.skillId=i,this.nowLvDesc.textFlow=TextUtils.generateTextFlow(n.skillDesc);var o=superRingControl.getActorExRingBookConfig(i,2);this.nextLvDesc.textFlow=TextUtils.generateTextFlow(o.skillDesc),this.selectLearnList()},e.prototype.selectList=function(){for(var t=this.list.dataProvider.length,e=0;t>e;e++){var i=this.list.getElementAt(e);i&&(e!=this.list.selectedIndex?i.setSelect(!1):i.setSelect(!0))}},e.prototype.selectLearnList=function(){for(var t=this.learnList.dataProvider.length,e=0;t>e;e++){var i=this.learnList.getElementAt(e);i&&(e!=this.learnList.selectedIndex?i.setSelect(!1):i.setSelect(!0))}void 0!=this.learnList.selectedItem&&void 0!=this.learnList.selectedItem.id&&(this.opraBtn.enabled=superRingControl.isBookCanStudy(this.learnList.selectedItem.id))},e}(BasePanel);__reflect(FireRingSkillPanel.prototype,"FireRingSkillPanel");var FireRingTanleTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FireRingTanleTipsViewSkin",e.uilayer=GameLayer.MAIN1,e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(710,this.update),this.addCustomEvent(653,this.update),this.addCustomEvent(266,this.itemChange),this.addCustomEvent(267,this.itemChange),this.addCustomEvent(268,this.itemChange),this.update()},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.updateBtn:flameMarkControl.upUseDan(FlameMarkControl.TYPE_ATTDAN)}},e.prototype.itemChange=function(){if("maxLv"!=this.currentState){var t=!1;flameMarkControl.checkAttrDanRed()?"normal"!=this.currentState&&(t=!0,this.currentState="normal"):"noitem"!=this.currentState&&(t=!0,this.currentState="noitem"),t&&this.updateAttrs()}},e.prototype.update=function(){var t=flameMarkControl.attDan,e=DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv].attrPill,i=t>=e;this.currentState=i?"maxLv":flameMarkControl.checkAttrDanRed()?"normal":"noitem",this.zizhiLv.text=LangMgr.getValueByKey("numberLevel",t),this.maxLvDesc.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("fireRingTanle",e)),this.updateAttrs()},e.prototype.updateAttrs=function(){for(var t,e=flameMarkControl.attDan,i=DataCenter.ins().FlameMarkConfig.attrPill,n=i.length,o=[],s=1;4>=s;s++){var r=this["attr"+s],a=this["attr"+s+"NextLv"];r.text="",a.text="",n>=s&&(t=i[s-1],r.text=AttributeData.getAttrStrByType(t.type)+": +"+t.value*e,o.push(new AttributeData(t.type,t.value*e)),"normal"==this.currentState&&(a.text="+"+i[s-1].value*(e+1)))}this.powerPanel.setPower(BackpackControl.getAttrPower(o))},e}(BaseEuiView);__reflect(FireRingTanleTipsView.prototype,"FireRingTanleTipsView");var FireRingView=function(t){function e(){var e=t.call(this)||this;return e.lastSelect=0,e.isTopLevel=!0,e.skinName="FireRingViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.lastSelect=t[0]||0,this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.tab,this.setSelectedIndex),this.tab.selectedIndex=this.lastSelect,this.viewStack.selectedIndex=this.lastSelect,this.viewStack.getElementAt(this.lastSelect).open(),this.checkPoint(),this.addCustomEvent(164,this.checkPoint),this.addCustomEvent(166,this.checkPoint),this.addCustomEvent(373,this.checkPoint),this.addCustomEvent(266,this.checkPoint),this.addCustomEvent(268,this.checkPoint),this.addCustomEvent(269,this.checkPoint),this.addCustomEvent(653,this.checkPoint)},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventChanging(this.tab,this.onTabTouching),this.removeEventChange(this.tab,this.setSelectedIndex),this.viewStack.getElementAt(this.lastSelect)&&this.viewStack.getElementAt(this.lastSelect).close()},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return 3!=t||flameMarkControl.checkOpen()?!0:(tipsControl.showTips(LangMgr.getValueByKey("osaFireOpen",DataCenter.ins().FlameMarkConfig.openLevel)),!1)},e.prototype.setSelectedIndex=function(t){this.viewStack.getElementAt(this.lastSelect).close(),this.lastSelect=this.viewStack.selectedIndex,this.viewStack.getElementAt(this.lastSelect).open()},e.prototype.checkPoint=function(){this.redPoint0.visible=superRingControl.checkHaveUpRing(),this.redPoint1.visible=superRingControl.isCanStudySkill()||superRingControl.isCanUpgradeSkill(),this.redPoint2.visible=superRingControl.fireRingRedPoint(),this.redPoint3.visible=flameMarkControl.checkRed()},e}(BaseEuiView);__reflect(FireRingView.prototype,"FireRingView");var FlameMarkMixView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FlameMarkMixViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=FlameMarkMixItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(266,this.update),this.addCustomEvent(267,this.update),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents()},e.prototype.update=function(){this._collect||(this._collect=new ArrayCollection,this.list.dataProvider=this._collect);var t,e,i,n,o,s=[];for(var r in DataCenter.ins().FlameMarkMatConfig)e=DataCenter.ins().FlameMarkMatConfig[r],e.costItem?(t=backpackControl.getBagItemById(e.costItem),n=DataCenter.ins().ItemConfig[e.costItem].name,i=t?t.count:0):(i=0,n=""),t=backpackControl.getBagItemById(e.itemId),o=t?t.count:0,s.push({cfg:e,count:i,itemName:n,itemCount:o});this._collect.source=s},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(FlameMarkMixView.prototype,"FlameMarkMixView");var FlameMarkSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="FlameMarkSkillTipsViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._cfg=t[0],this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(653,this.resetCfg),this.addCustomEvent(266,this.updateData),this.addCustomEvent(267,this.updateData),this.updateData()},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeCustomEvents(),this._uiEffect&&(this._uiEffect.destroy(),this._uiEffect=null)},e.prototype.resetCfg=function(){var t=flameMarkControl.getSkillLvById(this._cfg.id);t||(t=1),this._cfg=DataCenter.ins().FlameMarkEffectConfig[this._cfg.id][t],this.updateData()},e.prototype.updateData=function(){this.currentState="skill"+(this._cfg.id-1),this.skillImg.source=this._cfg.icon,this.nametxt.text=this._cfg.skillname;var t=flameMarkControl.getSkillLvById(this._cfg.id);if(this.lvtxt.text="Lv."+t,this.redpoint.visible=!1,this.nextLevel.text="",1==this._cfg.id){var e=0,i=flameMarkControl.getSkillLvById(3),n=i?DataCenter.ins().FlameMarkEffectConfig[3][i].reloadTime:0,o=this._cfg.skillId,s=this._cfg.stamp;t?flameMarkControl.getSkillLvById(2)&&(i=flameMarkControl.getSkillLvById(2),o=DataCenter.ins().FlameMarkEffectConfig[2][i].skillId,s=DataCenter.ins().FlameMarkEffectConfig[2][i].stamp):n=0;var r=DataCenter.ins().SkillsDescConfig[DataCenter.ins().SkillsConfig[o].desc];e=(r.cd-n)/1e3>>0,this.keyDesctxt.text=LangMgr.getValueByKey("lyMarkCNTime",e),this.skillDesctxt.textFlow=TextUtils.generateTextFlow1(r.desc.replace("{0}","|C:"+LangMgr.getColor("color43")+"&T:"+(e/s>>0)+"|").replace("{1}","|C:"+LangMgr.getColor("color43")+"&T:"+s+"|")),this.damageDesctxt.textFlow=TextUtils.generateTextFlow1(flameMarkControl.lyMarkLv?DataCenter.ins().FlameMarkLvConfig[flameMarkControl.lyMarkLv].bulletDesc:"")}else{2==this._cfg.id||3==this._cfg.id||7==this._cfg.id?this.keyDesctxt.text=LangMgr.getValueByKey("lyMarkMaxLevel")+Object.keys(DataCenter.ins().FlameMarkEffectConfig[this._cfg.id]).length:this.keyDesctxt.text=LangMgr.getValueByKey("lyMarkPart")+(DataCenter.ins().SkillsEffectsConfig[4==this._cfg.id?this._cfg.selfEffId:this._cfg.effId].probabilityBuff/100>>0)+"%",this.skillDesctxt.textFlow=TextUtils.generateTextFlow1(this._cfg.skillDesc);var a=t>=Object.keys(DataCenter.ins().FlameMarkEffectConfig[this._cfg.id]).length;if(this.cost.visible=!1,this.update.visible=!1,!a){var l=DataCenter.ins().FlameMarkEffectConfig[this._cfg.id][0>=t?1:t+1];if(l.costItem){var h=DataCenter.ins().ItemConfig[l.costItem];this.costImg.source=h.icon+"_png";var u=backpackControl.getBagItemById(l.costItem),s=u?u.count:0;this.costNum.textFlow=TextUtils.generateTextFlow1("|C:"+(s<l.costCount?LangMgr.getColor("color22"):ColorUtils.NORMAL_COLOR)+"&T:X "+l.costCount+"|"),this.redpoint.visible=s>=l.costCount&&flameMarkControl.lyMarkLv>=l.stampLevel,this._nextCfg=l,flameMarkControl.lyMarkLv>=l.stampLevel?(this.cost.visible=s<l.costCount,this.update.visible=!this.cost.visible):this.nextLevel.text=LangMgr.getValueByKey("lyMarkUnLock",l.stampLevel)}else flameMarkControl.lyMarkLv<l.stampLevel&&(this.nextLevel.text=LangMgr.getValueByKey("lyMarkUpdate",l.stampLevel))}}this._uiEffect||(this._uiEffect=ObjectPool.pop("GameMovieClip"),this.uieff.addChild(this._uiEffect)),this._uiEffect.playFile(""+PATH_EFF+this._cfg.uiEff,-1)},e.prototype.onTouch=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.update:this.redpoint.visible?flameMarkControl.upUpSkill(this._cfg.id):this._nextCfg.stampLevel>flameMarkControl.lyMarkLv?tipsControl.showTips(LangMgr.getValueByKey("lyMarkLeveNeed",this._nextCfg.stampLevel)):tipsControl.showTips(LangMgr.getValueByKey("materialEnought"))}},e}(BaseEuiView);__reflect(FlameMarkSkillTipsView.prototype,"FlameMarkSkillTipsView");var SuperRingDetailView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuperRingDetailViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];this.attrValue.text=AttributeData.getAttStr(i,0,1,"    ",!1,!1),this.addEventTouchEnd(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(SuperRingDetailView.prototype,"SuperRingDetailView");var SuperRingInfoView=function(t){function e(){var e=t.call(this)||this;return e.barbc=new ProgressBarEff,e.cruCostId=0,e.isAutoUp=!1,e.canUpdate=!1,e.isTopLevel=!0,e.skinName="SuperRingInfoViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.barbc.setWidth(400),this.barbc.x=-15,this.barbc.y=25,this.barGroup.addChild(this.barbc),this.starList=new StarList(SuperRingControl.perStar),this.starList.x=15,this.starList.y=0,this.star.addChild(this.starList),this.iconMc=new GameMovieClip,this.iconMc.x=0,this.iconMc.y=0,this.ringMcGroup.addChild(this.iconMc),this.reliveEff=new GameMovieClip,this.baojiMc=new GameMovieClip,this.baojiMc.x=245,this.baojiMc.y=650,this.menuList.itemRenderer=SuperRingItemRender,this.menuList.selectedIndex=0,this.menuListData=new eui.ArrayCollection,this.menuList.dataProvider=this.menuListData,this.ringget.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.ringget.text+"</u></a>"),this.upgradebtn.label=LangMgr.getValueByKey("fireType6"),this.uplevel.label=LangMgr.getValueByKey("bookStart"),this.countTxt.textColor=ColorUtils.NORMAL_COLOR},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.menuList,this.onClickMenu),this.addEventTouchTap(this.uplevel,this.onTap),this.addEventTouchTap(this.acivebtn,this.onTap),this.addEventTouchTap(this.ringget,this.onTap),this.addEventTouchTap(this.upgradebtn,this.onTap),this.addEventTouchTap(this.goQuicklyOpen,this.onQuickOpen),this.addCustomEvent(165,this.updateView),this.addCustomEvent(92,this.updateView),this.addCustomEvent(163,this.playEffect),this.addCustomEvent(162,this.showActivityView),this.addCustomEvent(162,this.updateView),this.addCustomEvent(164,this.updateView),this.barbc.reset(),this.updateView(),this.setIcon()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.uplevel,this.onTap),this.removeEventTouchTap(this.ringget,this.onTap),this.removeEventTouchTap(this.acivebtn,this.onTap),this.removeEventTouchTap(this.upgradebtn,this.onTap),DisplayUtils.removeFromParent(this.reliveEff),this.removeCustomEvents(),this.isAutoUp&&this.stopAutoUp()
},e.prototype.onQuickOpen=function(t){var e=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID],i=e.useYb;ActorControl.yb>=i?superRingControl.upActiveRing(GameConst.FIRE_RING_ID,1):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.uplevel:this.warnShow();break;case this.acivebtn:this.currData.id==GameConst.FIRE_RING_ID?superRingControl.upDeblock(this.currData.id):superRingControl.upActiveRing(this.currData.id);break;case this.upgradebtn:tipsControl.showTips(LangMgr.getValueByKey("fireTips12"));break;case this.ringget:warnControl.setBuyGoodsWarn(this.cruCostId)}},e.prototype.showActivityView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=DataCenter.ins().FireRingRoleConfig[this.currData.id];this.currData.id==GameConst.FIRE_RING_ID?(UIMgr.ins().close(this),UIMgr.ins().open(FireRingView)):this.upDateItem.apply(this,t),CommonFun.show(0,i.name,"j"+i.icon+"_png")},e.prototype.upDateItem=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0;t&&t[0]&&(i=t[0][0]);var n=superRingControl.getSpecialRingDataById(i),o=DataCenter.ins().FireRingRoleConfig[this.currData.id];this.menuListData.replaceItemAt(n,o.order-1),this.currData=n,this.updateDetail(!0)},e.prototype.playEffect=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.upDateItem.apply(this,e);var n=0,o=DataCenter.ins().FireRingRoleConfig[this.currData.id];e&&e[0]&&(n=e[0][1]);var s=superRingControl.getRingConfigById(this.currData.id,this.currData.level);n>0&&(this.baojiMc.playFile(PATH_EFF+"moneytreecrit",1),this.addChild(this.baojiMc));var r=new eui.Label;r.size=14,r.textColor=ColorUtils.GREEN,r.width=450,r.textAlign=egret.HorizontalAlign.CENTER,r.x=19,r.y=420,r.text=LangMgr.getValueByKey("fireTips13",o.name,s.addPower),this.addChild(r);var a=egret.Tween.get(r);a.to({y:r.y-45},500).call(function(){t.removeChild(r)},this)},e.prototype.onClickMenu=function(t){var e=this.specialDatas[t.currentTarget.selectedIndex];e&&(this.barbc.reset(),this.currData=e,this.updateDetail(),this.updateMenuList(),this.setIcon())},e.prototype.setIcon=function(){var t=DataCenter.ins().FireRingRoleConfig[this.currData.id];if(!DataCenter.ins().DefineEffConfig[t.effid])return void debug.log(t.name+"effID error");var e=DataCenter.ins().DefineEffConfig[t.effid].souce;this.iconMc.playFile(PATH_EFF+e,-1)},e.prototype.updateView=function(){this.updateDetail(),this.updateMenuList()},e.prototype.updateMenuList=function(){this.menuList.dataProvider=this.menuListData,this.menuListData.source=this.specialDatas;var t=0;if(this.currData)for(var e in this.specialDatas){if(this.currData.id==this.specialDatas[e].id){this.currData=this.specialDatas[e];break}t++}this.menuList.selectedIndex=t,this.menuList.validateNow()},e.prototype.updateFuseView=function(){var t=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID];this.price0.setPrice(t.useYb)},e.prototype.updateDetail=function(t){if(void 0===t&&(t=!1),this.specialDatas=CommonUtils.copyDataHandler(superRingControl.ringList),this.specialDatas.sort(function(t,e){return SortUtils.sortAscByKey(t,e,"order")}),this.currData){for(var e in this.specialDatas)if(this.currData.id==this.specialDatas[e].id){this.currData=this.specialDatas[e];break}}else this.currData=this.specialDatas[0];var i=DataCenter.ins().FireRingRoleConfig[this.currData.id],n=superRingControl.isFireRingActivate();if(n)this.currentState="tejie8",this.validateNow(),this.updateFuseView(),this.currData.id=GameConst.FIRE_RING_ID;else if(this.currData.id==GameConst.FIRE_RING_ID){this.currentState="disable",this.validateNow(),this.resetUI(),this.attrBg0.visible=!1,this.acivebtn.label=LangMgr.getValueByKey("fireType7");var o=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID];this.ringname.text=""+o.name,this.Explain0.textFlow=TextUtils.generateTextFlow(this.countStrDesc(o)),this.openDesc.text=LangMgr.getValueByKey("fireTips14",i.openDay),superRingControl.isFireRingCanActivate()?(this.acivebtn.visible=!0,this.openDesc.visible=!1,this.addReliveEff()):(this.acivebtn.visible=!1,this.openDesc.visible=!0,DisplayUtils.removeFromParent(this.reliveEff))}else{this.attrBg0.visible=!0,this.acivebtn.label=LangMgr.getValueByKey("smeltActivity");var s=0==this.currData.level?1:this.currData.level,r=superRingControl.getRingConfigById(this.currData.id,s),a=superRingControl.getRingStair(this.currData.level);if(this.ringname.text=""+i.name,this.stageImg.data=LangMgr.getValueByKey("stageNumberTxt",a),this.currData.level>0)if(ActorControl.level>=i.needLevel&&reincarnateControl.lv>=i.needZs)superRingControl.getRingConfigById(this.currData.id,this.currData.level+1)?(this.currentState="open",this.validateNow()):(this.currentState="final",this.validateNow()),this.setOpenInfo(t);else if(this.currentState="wait",this.validateNow(),this.Explain0.textFlow=TextUtils.generateTextFlow(this.countStrDesc(i)),this.openLevelDesc.text=""+LangMgr.getValueByKey("fireType9")+(i.needZs>0?LangMgr.getValueByKey("numberRotation",i.needZs):"")+(i.needLevel>0?LangMgr.getValueByKey("numberLevel",i.needLevel):"")+LangMgr.getValueByKey("fireTips15"),r.attrAward){this.setLayoutAttr(r);var l=BackpackControl.getAttrPower(r.attrAward);this.powerPanel.setPower(l)}else this.setLayoutAttr(r,!0),this.powerPanel.setPower(0);else{if(this.currentState="disable",this.validateNow(),r.attrAward){this.setLayoutAttr(r);var l=BackpackControl.getAttrPower(r.attrAward);this.powerPanel.setPower(l)}else this.setLayoutAttr(r,!0),this.powerPanel.setPower(0);this.Explain0.textFlow=TextUtils.generateTextFlow(this.countStrDesc(i));var h=superRingControl.checkRedPoint(this.currData.id,this.currData.level);if(h)this.openDesc.text="",this.acivebtn.visible=!0,this.addReliveEff();else{var u=DataCenter.ins().FireRingRoleConfig[this.currData.id];this.acivebtn.visible=!1,this.openDesc.text=LangMgr.getValueByKey("fireTips4",u.openDay,vipControl.getVipStr(u.openVip)),DisplayUtils.removeFromParent(this.reliveEff)}this.canUpdate=!1}this.skillname.text=r.SpecialRingSkin}},e.prototype.addReliveEff=function(){this.reliveEff.playFile(PATH_EFF+"chargeff1",-1),this.reliveEff.parent||(this.acivebtn.addChild(this.reliveEff),this.reliveEff.x=this.acivebtn.width/2,this.reliveEff.y=this.acivebtn.height/2)},e.prototype.resetUI=function(){this.setLayoutAttr(null,!0),this.Explain0.text="",this.skillname.text="",this.openDesc.text=""},e.prototype.setLayoutAttr=function(t,e){for(var i=0;4>i;i++)if(e)this["attrLabel"+(i+1)].text="";else{var n=AttributeData.getAttStr(this.getAttrArray(t.attrAward),1),o=n.split("\n");this["attrLabel"+(i+1)].text=o[i]}},e.prototype.getAttrArray=function(t){for(var e=[11,12,23,24],i=[],n=0;n<t.length;n++)e.indexOf(t[n].type)<0&&i.push(t[n]);return i},e.prototype.setOpenInfo=function(t){void 0===t&&(t=!1);var e=DataCenter.ins().FireRingRoleConfig[this.currData.id],i=0==this.currData.level?1:this.currData.level,n=superRingControl.getRingConfigById(this.currData.id,i);this.cruCostId=n.costItem,this.Explain0.textFlow=this.Explain.textFlow=TextUtils.generateTextFlow(this.countStrDesc(e));var o=backpackControl.getBagGoodsCountById(0,n.costItem);this.countTxt.text=LangMgr.getValueByKey("fireTips16",DataCenter.ins().ItemConfig[n.costItem].name);var s="";s=o>=n.cost?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.useTxt.textFlow=TextUtils.generateTextFlow("<font color="+s+">"+o+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+n.cost+"</font> "),this.canUpdate=o>=n.cost;var r;this.upgradebtn.visible=!1,"final"!=this.currentState&&(this.uplevel.visible=!0);var a=superRingControl.getRingStar(this.currData.level);if(n.judgeup>0?(r=superRingControl.getRingConfigById(this.currData.id,this.currData.level+1),this.currData.exp>=n.upPower?(this.starList.setStarNum(a,Number(t)),this.upgradebtn.visible=!0,this.uplevel.visible=!1,superRingControl.getRingConfigById(this.currData.id,this.currData.level+1)?this.upgradebtn.label=LangMgr.getValueByKey("fireType6"):this.upgradebtn.label=LangMgr.getValueByKey("maxLevel")):this.starList.setStarNum(a,Number(t))):(r=superRingControl.getRingConfigById(this.currData.id,this.currData.level+1),this.starList.setStarNum(a,Number(t))),r&&(r.attrAward?this.nextAttrLabel.text=AttributeData.getAttStr(this.getAttrArray(r.attrAward),1):this.nextAttrLabel.text=""),this.expBarChange(),n.attrAward){this.setLayoutAttr(n);var l=BackpackControl.getAttrPower(n.attrAward);this.powerPanel.setPower(l)}else this.setLayoutAttr(n,!0),this.attrLabel.text="",this.powerPanel.setPower(0)},e.prototype.warnShow=function(){if(!this.canUpdate){var t=superRingControl.getRingConfigById(this.currData.id,this.currData.level);return void tipsControl.showTips(LangMgr.getValueByKey("activitEnought1",DataCenter.ins().ItemConfig[t.costItem].name))}var e=DataCenter.ins().FireRingRoleConfig[this.currData.id];ActorControl.level>=e.needLevel&&reincarnateControl.lv>=e.needZs||tipsControl.showTips(""+(e.needZs>0?LangMgr.getValueByKey("numberRotation",e.needZs):"")+(e.needLevel>0?LangMgr.getValueByKey("numberLevel",e.needLevel):"")+LangMgr.getValueByKey("fireType10")),superRingControl.upSpicelRingUpdate(this.currData.id)},e.prototype.stopAutoUp=function(){this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpStar,this)},e.prototype.autoUpStar=function(){var t=superRingControl.getRingConfigById(this.currData.id,this.currData.level),e=backpackControl.getBagGoodsCountById(0,t.costItem);e?superRingControl.upSpicelRingUpdate(this.currData.id):(this.isAutoUp=!1,TimerMgr.ins().remove(this.autoUpStar,this))},e.prototype.expBarChange=function(){var t=superRingControl.getRingConfigById(this.currData.id,this.currData.level),e=t.upPower,i=this.currData.exp;i=superRingControl.getRingConfigById(this.currData.id,this.currData.level+1)?this.currData.exp>e?e:this.currData.exp:e,this.barbc.getMaxValue()!=e?this.barbc.setData(i,e):this.barbc.setValue(i)},e.prototype.countStrDesc=function(t){var e=0==this.currData.level?1:this.currData.level,i=superRingControl.getRingConfigById(this.currData.id,e),n=t.explain.split("$"),o="";if(n.length>0)for(var s=0;s<n.length;s++)if(Number(n[s])){var r=Number(n[s]),a=void 0;a=r/200>=1?i.extAttrAward:i.attrAward;for(var l in a)if(a[l].type==r%100){o+=r>200?AttributeData.getExtAttStrByType(a[l],0,"",!1,!1):AttributeData.getAttStrByType(a[l],0,"",!1,!1);break}}else o+=n[s];else o=t.explain;return o},e}(BaseEuiView);__reflect(SuperRingInfoView.prototype,"SuperRingInfoView");var SuperRingUpgradeView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuperRingUpgradeViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.addBossImg=function(t){this.bossImage=new GameMovieClip,this.bossImage.scaleX=-1,this.bossImage.scaleY=1,this.bossImage.x=this.ring0eff.width/2,this.bossImage.y=115,this.ring0eff.addChild(this.bossImage);var e=DataCenter.ins().MonstersConfig[t];this.bossImage.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(e.avatar+"_3s"),-1)},e.prototype.addNextBossImg=function(t){this.nextBossImage=new GameMovieClip,this.nextBossImage.scaleX=-1,this.nextBossImage.scaleY=1,this.nextBossImage.x=this.ring1eff.width/2,this.nextBossImage.y=115,this.ring1eff.addChild(this.nextBossImage);var e=DataCenter.ins().MonstersConfig[t];this.nextBossImage.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(e.avatar+"_3s"),-1)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.colorCanvas,this.otherClose),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.otherClose);var i=superRingControl.getAbilityID();0==i&&(i=1);var n=superRingControl.abilityIds[i];n=n?n:1;var o=DataCenter.ins().FireRingRoleItemConfig[GameConst.FIRE_RING_ID][i][n],s=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID].monsterId,r=s+o.monId;this.abilityDesc.textFlow=TextUtils.generateTextFlow(o.abilityDesc),this.addBossImg(s),this.addNextBossImg(r)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(SuperRingUpgradeView.prototype,"SuperRingUpgradeView");var SuperRingView=function(t){function e(){var e=t.call(this)||this;return e.ringLv=0,e.skinName="SuperRingViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.iconMc=new GameMovieClip,this.iconMc.x=this.mcGroup.width/2,this.iconMc.y=160,this.gainList0.itemRenderer=SuperRingGainItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],null==t[1]&&(t[1]=0),this.roleSelect.setCurRole(t[1]),this.iconMc&&!this.iconMc.parent&&this.mcGroup.addChild(this.iconMc),this.addEventTouchTap(this.btnUse,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventItemTap(this.gainList0,this.onTouchList),this.addSpecialListener(),this.addCustomEvent(266,this.roleChange),this.addCustomEvent(267,this.roleChange);var i=DataCenter.ins().FireRingConfig[this.index],n=DataCenter.ins().PropsGainConfig[i.costItem];this.gainList0.dataProvider=new eui.ArrayCollection(n.gainWay),this.roleChange()},e.prototype.addSpecialListener=function(){this.addCustomEvent(161,this.roleChange)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.colorCanvas0,this.onTap),this.removeEventTouchTap(this.btnUse,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventItemTap(this.gainList0,this.onTouchList),DisplayUtils.removeFromParent(this.iconMc),this.removeCustomEvents()},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&GuideControl.guidance(e[1],e[2],!0)}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.colorCanvas0:case this.bgClose:UIMgr.ins().close(this);break;case this.btnUse:"active"==this.currentState?this.sendUpgrade():this.openBuyGoods()}},e.prototype.showIcon=function(){var t=this.index?"hushen":"mabi";this.iconMc.playFile(PATH_EFF+t,-1)},e.prototype.roleChange=function(t){void 0===t&&(t=!1),this.setRedPoint();var e=this.roleSelect.getCurRole();this.ringLv=heroControl.getSubRoleByIndex(e).getExRingsData(this.index),this.showIcon();var i=DataCenter.ins().FireRingConfig[this.index],n=DataCenter.ins()["FireRing"+this.index+"Config"][0],o=DataCenter.ins()["FireRing"+this.index+"Config"][1];if(0==this.ringLv){var s=(CommonUtils.getObjectLength(DataCenter.ins()["FireRing"+this.index+"Config"]),backpackControl.getBagGoodsCountById(0,i.costItem)),r="";r=s>=n.cost?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,s<n.cost?this.currentState="lock":this.currentState="active",this.validateNow(),this.tips.source="weijihuo2"}else this.currentState="actived",this.validateNow(),this.tips.source="yijihuo";var a=0;if(o){for(var l="",h=0,u=0,p=0,c="",d=0;d<o.attrAward.length;d++)u=o.attrAward[d].type,15!=u&&13!=u&&(l=AttributeData.getAttrStrByType(u),h=o.attrAward[d].value,l.length<3&&(l=AttributeData.inserteBlank(l,1)),this["attr"+p].text=l+"：",u>1&&9>u?c=7==u||8==u?h/100+"%":h.toString():(u>12&&15>u||u>15)&&(c=19==u?h/100+150+"%":h/100+"%"),this["value"+p].text=c,p++);a=BackpackControl.getAttrPower(o.attrAward),a+=o.power,this.powerPanel.setPower(a),this.powerPanel.setMcVisible(!1);var g=DataCenter.ins().ItemConfig[i.costItem];this.specialAttr.textFlow=TextUtils.generateTextFlow1(g.desc),this.imgTitle.source="wenzi_jz"+i.id}},e.prototype.sendUpgrade=function(){superRingControl.upUpGrade(this.index,this.roleSelect.getCurRole())},e.prototype.openBuyGoods=function(){warnControl.setBuyGoodsWarn(DataCenter.ins().FireRingConfig[this.index].costItem)},e.prototype.setRedPoint=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++){var i=heroControl.getSubRoleByIndex(e);this.roleSelect.showRedPoint(e,roleControl.roleHintCheck(i,this.index))}},e.prototype.getPower=function(){return"actived"==this.currentState?this.powerPanel.power:0},e}(BaseEuiView);__reflect(SuperRingView.prototype,"SuperRingView");var FireRingAbilityItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().FireRingRoleAbilityConfig[t];this.nameTxt.text=e.abilityName,this.descLabel.textFlow=TextUtils.generateTextFlow(e.abilityDesc),this.imgIcon.source=e.abilityIcon;var i=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID),n=superRingControl.getRingStair(i.level);n>=e.ringLv?this.stateLabel.text="":(this.stateLabel.text=LangMgr.getValueByKey("fireTips1",superRingControl.getUnLockStage(t)),this.stateLabel.textColor=ColorUtils.RED)},e}(BaseItemRender);__reflect(FireRingAbilityItemRender.prototype,"FireRingAbilityItemRender");var FireRingSkillBookItemRender=function(t){function e(){var e=t.call(this)||this;return e.isOpenSelectImg=!0,e.addEventRemovedFromStage(e,e.onRemove),e}return __extends(e,t),e.prototype.init=function(){},e.prototype.dataChangeHandler=function(){var t=this.data.count;t>0?(this.itemIcon.imgIcon.filters=null,this.itemIcon.imgBg.filters=null):(this.itemIcon.imgIcon.filters=FilterUtils.ARRAY_GRAY_FILTER,this.itemIcon.imgBg.filters=FilterUtils.ARRAY_GRAY_FILTER)},e.prototype.onRemove=function(){this.itemIcon&&(this.itemIcon.imgIcon.filters=null,this.itemIcon.imgBg.filters=null)},e}(ItemBase);__reflect(FireRingSkillBookItemRender.prototype,"FireRingSkillBookItemRender");var FireRingSkillItemRender=function(t){function e(){var e=t.call(this)||this;return TimerMgr.ins().doNext(function(){var t=new egret.Shape;t.graphics.beginFill(LangMgr.getColor("color43")),t.graphics.drawRoundRect(0,0,e.width,e.height,1,1),t.graphics.endFill(),t.alpha=0,e.addChild(t)},e),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){if(this.myData=this.data,this.myData.isOpen)if(this.myData.skillId){this.currentState="learn",this.validateNow();var t=superRingControl.getActorExRingBookConfig(this.myData.skillId,this.myData.skillLvl);this.skillImg.source=t.skillIcon,this.skillLv.text="Lv"+this.myData.skillLvl,this.skillName.text=t.skillName;var e=backpackControl.getBagGoodsCountById(0,t.itemId);this.redpoint.visible=e>=t.num&&this.myData.skillLvl<superRingControl.getSkillMaxLvl(this.myData.skillId)}else this.currentState="unlearn",this.validateNow(),this.redpoint.visible=superRingControl.isCanStudySkill();else{this.currentState="lock",this.validateNow();var i=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID).level,n=superRingControl.getRingStair(i);if(n<SuperRingControl.GRID_OPEN_LEVEL)this.skillName.text=LangMgr.getValueByKey("fireTips1other",SuperRingControl.GRID_OPEN_LEVEL),this.price.visible=!1;else{this.price.visible=!0,this.skillName.text=LangMgr.getValueByKey("fireType2");var o=DataCenter.ins().FireRingRoleConfig[GameConst.FIRE_RING_ID];this.price.setPrice(o.skillGridYb)}}this.select.visible=this.selected}},e.prototype.setSelect=function(t){this.select.visible=t},e}(BaseItemRender);__reflect(FireRingSkillItemRender.prototype,"FireRingSkillItemRender");var FlameMarkMixItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="FlameMarkMixItemSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.MixBtn,this.onTap)},e.prototype.dataChanged=function(){var t=this.data.cfg.costItem;this.limitLv.textFlow=TextUtils.generateTextFlow1(this.data.cfg.mixDesc),this.cost.textFlow=TextUtils.generateTextFlow1(t?LangMgr.getValueByKey("fireTips6",this.data.count?ColorUtils.NORMAL_COLOR:LangMgr.getColor("color22"),this.data.itemName,this.data.cfg.costCount):""),this.stock.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("fireTips7",this.data.itemCount?LangMgr.getColor("color43"):LangMgr.getColor("color22"),this.data.itemCount)),this.MixBtn.label=t?LangMgr.getValueByKey("fireType3"):LangMgr.getValueByKey("fireType4"),this.MixBtn.enabled=!t||flameMarkControl.lyMarkLv>=this.data.cfg.limitLv,this.redpoint.visible=t&&flameMarkControl.lyMarkLv>=this.data.cfg.limitLv&&this.data.count>=this.data.cfg.costCount,this.itemIcon.data=this.data.cfg.itemId},e.prototype.onTap=function(t){this.data.cfg.costItem?this.data.count>=this.data.cfg.costCount?flameMarkControl.upCompound(this.data.cfg.itemId):tipsControl.showTips(LangMgr.getValueByKey("materialEnought")):warnControl.setBuyGoodsWarn(this.data.cfg.itemId)},e.prototype.destruct=function(){this.removeEventTouchTap(this.MixBtn,this.onTap)},e}(BaseItemRender);__reflect(FlameMarkMixItemRender.prototype,"FlameMarkMixItemRender");var FlameMarkSkillItemRender=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!0,e.touchChildren=!1,e.addEventAddedFromStage(e,e.addToStage),e}return __extends(e,t),e.prototype.setCfg=function(t){this._cfg=t,this.update()},e.prototype.getCfg=function(){return this._cfg},e.prototype.addToStage=function(t){this.removeEventAddedFromStage(this,this.addToStage),EventMgr.addListener(653,this.update,this),EventMgr.addListener(266,this.update,this),EventMgr.addListener(267,this.update,this),this.addEventRemovedFromStage(this,this.removeStage)},e.prototype.removeStage=function(t){EventMgr.ins().removeAll(this),this.removeEventRemovedFromStage(this,this.removeStage)},e.prototype.update=function(){if(this._cfg){this.skillImg.source=this._cfg.icon,this.skillName.textFlow=TextUtils.generateTextFlow1(this._cfg.skillname);var t=flameMarkControl.getSkillLvById(this._cfg.id);if(this.lock.visible=!t,this.redpoint.visible=!1,1!=this._cfg.id){var e=t>=Object.keys(DataCenter.ins().FlameMarkEffectConfig[this._cfg.id]).length;if(e)return;var i=DataCenter.ins().FlameMarkEffectConfig[this._cfg.id][0>=t?1:t+1];if(i.costItem){var n=(DataCenter.ins().ItemConfig[i.costItem],backpackControl.getBagItemById(i.costItem)),o=n?n.count:0;this.redpoint.visible=o>=i.costCount&&flameMarkControl.lyMarkLv>=i.stampLevel}}}},e}(BaseItemRender);__reflect(FlameMarkSkillItemRender.prototype,"FlameMarkSkillItemRender");var StudySkillNeedItemRender=function(){function t(){}return t.prototype.setData=function(t){var e=DataCenter.ins().ItemConfig[t];this.itemIcon.setData(e),this.nameTxt.text=e.name},t}();__reflect(StudySkillNeedItemRender.prototype,"StudySkillNeedItemRender");var SuperRingGainItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="RingGainItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.desc.text=this.data[0]},e}(BaseItemRender);__reflect(SuperRingGainItemRender.prototype,"SuperRingGainItemRender");var SuperRingItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuperRingItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=DataCenter.ins().FireRingRoleConfig[this.data.id];t&&(this.addEvents(),this.ringNameTxt.text=t.name,this.textBg.visible=this.data.level>0,this.data.level>0?(this.levelTxt.text=LangMgr.getValueByKey("stageNumberTxt",superRingControl.getRingStair(this.data.level)),this.openLv.text="",this.noopen.visible=!1,this.ringicon.source=t.icon):(this.levelTxt.text="",this.noopen.visible=!0,this.ringicon.source=t.icon+"a",t.openDay>0&&t.openVip>0?this.openLv.text=LangMgr.getValueByKey("fireTips4",t.openDay,vipControl.getVipStr(t.openVip)):t.openDay>0?this.openLv.text=LangMgr.getValueByKey("tipsOpenSeverDays1",t.openDay):t.openVip>0?this.openLv.text=LangMgr.getValueByKey("open1",vipControl.getVipStr(t.openVip)):t.openYb>0&&(this.openLv.text=LangMgr.getValueByKey("fireTips5",t.openYb))),this.updateRedPoint())},e.prototype.addEvents=function(){this.isAddEvent||(this.isAddEvent=!0,EventMgr.addListener(266,this.updateRedPoint,this),EventMgr.addListener(268,this.updateRedPoint,this),EventMgr.addListener(269,this.updateRedPoint,this),EventMgr.addListener(106,this.updateRedPoint,this),EventMgr.addListener(162,this.updateRedPoint,this),this.addEventRemovedFromStage(this,this.onRemove))},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),this.destruct()},e.prototype.destruct=function(){EventMgr.ins().removeAll(this),this.isAddEvent=!1},e.prototype.updateRedPoint=function(){this.data.level>0?this.actTxt.visible=!1:this.data.id==GameConst.FIRE_RING_ID?this.actTxt.visible=superRingControl.isFireRingCanActivate():this.actTxt.visible=superRingControl.checkCanActive(this.data.id),this.openLv.visible=!this.actTxt.visible,this.redPoint.visible=superRingControl.checkRedPoint(this.data.id,this.data.level)},e}(BaseItemRender);__reflect(SuperRingItemRender.prototype,"SuperRingItemRender");var TaskControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.achiEvement=[],e.limitTaskList=[],e.limitTaskDic={},e.limitTaskState=0,e.limitTaskCount=0,e.limitTaskEndTime=-1,e.currTaskListsId=-1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upGetTask=function(t){return[t]},e.prototype.upGetVitalityAwards=function(t){return[t]},e.prototype.upGetAchieve=function(t){return[t]},e.prototype.downTaskData=function(t,e,i){this.task=[],this.vitalityAwards=[];for(var n=0;n<t.length;n++){var o=new TaskVo;o.id=t[n][0],o.value=t[n][1],o.state=t[n][2],this.task.push(o)}this.vitality=e;for(var n=0;n<i.length;n++){var s=new VitalityVo;s.id=i[n][0],s.state=i[n][1],this.vitalityAwards.push(s)}this.sortTask()},e.prototype.downTaskChangeData=function(t,e,i){var n=this.getTaskDataById(t);Assert(n,"TaskControl doTaskChangeData id = "+t)||(n.value=e,n.state=i,this.sortTask(),this.dispatchTaskChangeData())},e.prototype.dispatchTaskChangeData=function(){EventMgr.ins().dispatch(90)},e.prototype.downVitality=function(t){this.vitality=t},e.prototype.downVitalityAwards=function(t,e){var i=this.getVitalityAwardsById(t);i.state=e,this.dispatchTaskChangeData()},e.prototype.downAchieveData=function(t){this.achiEvement.length=0;for(var e=0;e<t.length;e++){var i=new AchievementVo;i.achievementId=t[e][0],i.id=t[e][1],i.state=t[e][2],i.value=t[e][3];var n=this.getAchieveConfById(i.id);n&&(i.achievementType=n.achievementType),1e3==i.achievementId?(this.taskTrace=i,this.dispatchUpdteTaskTrace()):this.achiEvement.push(i)}this.sortAchiEvement(),EventMgr.ins().dispatch(92)},e.prototype.getTaskData=function(t,e){for(var i,n=this.achiEvement.length,o=0;n>o;o++){var s=this.achiEvement[o];if(s.achievementId==t&&s.id==e){i=s;break}}return i},e.prototype.getTaskTarget=function(t){var e=0,i=this.getAchieveConfById(t);return i&&(e=i.target),e},e.prototype.dispatchUpdteTaskTrace=function(){EventMgr.ins().dispatch(91)},e.prototype.dispatchUpdteLimitTaskData=function(t){EventMgr.ins().dispatch(93,t)},e.prototype.downJoinAchieveData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.changeAchieve(t,!0)},e.prototype.downAchieveChangeData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.changeAchieve(t)},e.prototype.changeAchieve=function(t,e){var i,n=t[0];if(i=1e3==n?this.taskTrace:this.getAchieveDataById(n),!Assert(i,"TaskControl  data is null  achievementId = "+n)){var o=t[1];(e||i.id==o)&&(i.id=o,i.state=t[2],i.value=t[3],1e3==i.achievementId?this.dispatchUpdteTaskTrace():(this.sortAchiEvement(),this.dispatchTaskChangeData()))}},e.prototype.downLimitDataChange=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0];if(this.limitTaskState=i,this.limitTaskCount=0,this.currTaskListsId=t[1],0==i)this.initLimitTaskData(this.currTaskListsId);else if(1==i){this.initLimitTaskData(this.currTaskListsId),this.limitTaskEndTime=t[2];var n=DataCenter.ins().GuideLimitTimeConfig[this.currTaskListsId];1==this.currTaskListsId&&n.time==this.limitTaskEndTime&&UIMgr.ins().open(LimitStartTipsView),this.limitTaskEndTime+=Math.floor(GameServer.serverTime/1e3);for(var o=0;o<t[3].length;o++){var s=t[3][o][0];this.limitTaskDic[s].init(t[3][o].slice(1)),2==this.limitTaskDic[s].state&&this.limitTaskCount++}}this.dispatchUpdteLimitTaskData()},e.prototype.initLimitTaskData=function(t){this.limitTaskList=[],this.limitTaskDic={};var e=DataCenter.ins().GuideLimitTimeConfig[t];for(var i in e.taskIds){var n=DataCenter.ins().GuideLimitTimeTaskConfig[e.taskIds[i]],o=new LimitTaskVo;o.initData(n),this.limitTaskList.push(o),this.limitTaskDic[o.id]=o}},e.prototype.downUpdateLimitData=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=this.limitTaskDic[t];n&&(n.init(e),2==n.state&&this.limitTaskCount++,this.dispatchUpdteLimitTaskData(n))},e.prototype.upGetLimitTask=function(){},e.prototype.upGetLimitTaskReward=function(t){return[t]},e.prototype.getChengjiuDataByType=function(t){if(void 0!=this.achiEvement){for(var e=[],i=0;i<this.achiEvement.length;i++)this.achiEvement[i].achievementType==t&&e.push(this.achiEvement[i]);return this.sortAchievementAcByType(e)}},e.prototype.sortAchievementAcByType=function(t){return t&&t.sort(function(t,e){return 2==t.state?1:2==e.state?-1:e.state-t.state}),t},e.prototype.getAchieveDataById=function(t){if(void 0!=this.achiEvement){for(var e=0;e<this.achiEvement.length;e++)if(this.achiEvement[e].achievementId==t)return this.achiEvement[e];return null}},e.prototype.getAchieveByTaskId=function(t){for(var e=0;e<this.achiEvement.length;e++)if(this.achiEvement[e].id==t)return this.achiEvement[e];return null},e.prototype.getVitalityAwardsById=function(t){for(var e=0;e<this.vitalityAwards.length;e++)if(this.vitalityAwards[e].id==t)return this.vitalityAwards[e];return null},e.prototype.getTaskDataById=function(t){if(!this.task)return null;for(var e=0;e<this.task.length;e++)if(this.task[e].id==t)return this.task[e];return null},e.prototype.getAchieveConfById=function(t){var e,i=DataCenter.ins().GuideAchievementConfig;for(e in i){var n=i[e];if(n.taskId==t)return n}return null},e.prototype.getAwardsConfigById=function(t){var e,i=DataCenter.ins().GuideAwardConfig;for(e in i){var n=i[e];if(n.id==t)return n}return null},e.prototype.getTaskStast=function(){if(this.task){var t=void 0;for(t=0;t<this.task.length;t++)if(1==this.task[t].state)return void this.dispatchUpdataTaskPoint(!0);for(t=0;t<this.vitalityAwards.length;t++){var e=this.getAwardsConfigById(this.vitalityAwards[t].id);if(this.vitality>=e.valueLimit&&0==this.vitalityAwards[t].state)return void this.dispatchUpdataTaskPoint(!0)}for(t=0;t<this.achiEvement.length;t++)if(1==this.achiEvement[t].state)return void this.dispatchUpdataTaskPoint(!0);return void this.dispatchUpdataTaskPoint(!1)}},e.prototype.dispatchUpdataTaskPoint=function(t){EventMgr.ins().dispatch(94,t)},e.prototype.sortTask=function(){if(this.task.length>2){this.task.sort(this.sort);for(var t=[],e=0;e<this.task.length;e++)0!=this.task[e].state&&(t.push(this.task[e]),this.task.splice(e,1),e--);t.length>0&&(this.task=this.task.concat(t))}},e.prototype.sort=function(t,e){var i=t.id,n=e.id;return n>i?-1:i>n?1:0},e.prototype.sortAchiEvement=function(){for(var t=0;t<this.achiEvement.length;t++){var e=this.achiEvement[t];1==e.state?(this.achiEvement.splice(t,1),this.achiEvement.unshift(e)):2==e.state&&(this.achiEvement.splice(t,1),this.achiEvement.push(e))}},e.prototype.getIsOpenChengjiu=function(){return ActorControl.level>=7},e.prototype.getIsHaveChengjiuReward=function(){if(!this.getIsOpenChengjiu())return!1;for(var t=experienceControl.chengjiuMaxData(),e=0,i=t;e<i.length;e++){var n=i[e],o=this.getChengjiuDataByType(n);if(void 0==o)return;for(var s=0,r=o;s<r.length;s++){var a=r[s];if(1==a.state)return!0}}return!1},e.prototype.getIsHaveChengjiuRewardBytype=function(t){for(var e=this.getChengjiuDataByType(t),i=0,n=e;i<n.length;i++){var o=n[i];if(1==o.state)return!0}return!1},e.prototype.getTaskState=function(){var t=this.taskTrace;if(t){var e=(this.getAchieveConfById(t.id),this.getAchieveConfById(t.id+1));return e||2!=t.state?!0:!1}return!1},e.prototype.getLimitTaskRed=function(){for(var t=0;t<this.limitTaskList.length;t++)if(1==this.limitTaskList[t].state)return 1;return 0},e.prototype.dispatchParabolicItem=function(){EventMgr.ins().dispatch(95)},e.prototype.getLimitTimeId=function(t){for(var e in DataCenter.ins().GuideLimitTimeConfig){var i=DataCenter.ins().GuideLimitTimeConfig[e];
if(-1!=i.taskIds.indexOf(t))return i.id}return 0},__decorate([up(1,[3])],e.prototype,"upGetTask",null),__decorate([up(2,[3])],e.prototype,"upGetVitalityAwards",null),__decorate([up(3,[3])],e.prototype,"upGetAchieve",null),__decorate([down(1,[[3,3,3],3,[3,3]])],e.prototype,"downTaskData",null),__decorate([down(2,[3,3,3])],e.prototype,"downTaskChangeData",null),__decorate([down(3,[3])],e.prototype,"downVitality",null),__decorate([down(4,[3,3])],e.prototype,"downVitalityAwards",null),__decorate([down(5,[[3,3,3,3]])],e.prototype,"downAchieveData",null),__decorate([down(7,[3,3,3,3])],e.prototype,"downJoinAchieveData",null),__decorate([down(8,[3,3,3,3])],e.prototype,"downAchieveChangeData",null),__decorate([down(9,[1,3,3,[3].concat(ByteConst.LimitTaskVos)])],e.prototype,"downLimitDataChange",null),__decorate([down(10,[3].concat(ByteConst.LimitTaskVos))],e.prototype,"downUpdateLimitData",null),__decorate([up(5)],e.prototype,"upGetLimitTask",null),__decorate([up(6,[3])],e.prototype,"upGetLimitTaskReward",null),e=__decorate([protocolsId(9)],e)}(BaseSystem);__reflect(TaskControl.prototype,"TaskControl");var AchievementVo=function(){function t(){}return t}();__reflect(AchievementVo.prototype,"AchievementVo");var LimitTaskVo=function(){function t(){this.id=0,this.name="",this.desc="",this.target=0,this.control=0,this.type=0,this.state=0,this.progress=0}return t.prototype.initData=function(t){this.id=t.id,this.name=t.name,this.desc=t.desc,this.target=t.target,this.awardList=t.awardList,this.control=t.control,this.controlTarget=t.controlTarget,this.type=t.type},t.prototype.init=function(t){this.progress=t[0],this.state=t[1]},t}();__reflect(LimitTaskVo.prototype,"LimitTaskVo");var TaskVo=function(){function t(){}return t}();__reflect(TaskVo.prototype,"TaskVo");var VitalityVo=function(){function t(){}return t}();__reflect(VitalityVo.prototype,"VitalityVo");var LimitStartTipsView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.skinName="LimitStartTipsViewSkin",e.name=LangMgr.getValueByKey("limitTips1"),e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.btn,this.onClick)},e.prototype.onClick=function(){UIMgr.ins().close(this),UIMgr.ins().open(LimitTaskView)},e}(BaseEuiView);__reflect(LimitStartTipsView.prototype,"LimitStartTipsView");var LimitTaskView=function(t){function e(){var e=t.call(this)||this;return e.skinName="LimitTaskViewSkin",e.name=LangMgr.getValueByKey("equiLimitTime"),e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.list,this.onTouch),this.addEventTouchTap(this.viewBtn,this.onTouch),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addCustomEvent(93,this.setPanel),this.addCustomEvent(93,this.updateFly),this.setPanel()},e.prototype.close=function(){TimerMgr.ins().remove(this.runTime,this)},e.prototype.onTouch=function(t){switch(t.target){case this.viewBtn:UIMgr.ins().open(RoleView,1);break;case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.setPanel=function(){var t=taskControl.limitTaskList;this.list.dataProvider=new eui.ArrayCollection(t);var e=taskControl.currTaskListsId,i=DataCenter.ins().GuideLimitTimeConfig[e];if(!i)return void tipsControl.showCenterTips(LangMgr.getValueByKey("limitTips3",e));var n="";n=i.openZhuan>0?LangMgr.getValueByKey("numberRotation",i.openZhuan):LangMgr.getValueByKey("numberLevel",i.openLevel);for(var o=0;3>o;o++)o==e-1?this["title"+o].visible=!0:this["title"+o].visible=!1;for(var o=0;8>o;o++)this["item"+o].redPoint.visible=!1;this.link0.text=n,this.expBarChange(),this.itemChange(),this.updateAttr(),taskControl.limitTaskEndTime-Math.floor(GameServer.serverTime/1e3)>0?(this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this)):this.time.text=LangMgr.getValueByKey("limitTips4")},e.prototype.runTime=function(){var t=taskControl.limitTaskEndTime-Math.floor(GameServer.serverTime/1e3);t>=0?this.time&&(this.time.text=DateUtils.getFormatBySecond(t,1)):(this.time&&(this.time.text=LangMgr.getValueByKey("limitTips4")),TimerMgr.ins().remove(this.runTime,this))},e.prototype.expBarChange=function(){var t=taskControl.limitTaskList.length,e=taskControl.limitTaskCount;this.expBar.maximum!=t&&(this.expBar.maximum=t),this.expBar.value=e,0==e?this.playAllEffect():this.removeAllEffect()},e.prototype.itemChange=function(){for(var t=taskControl.limitTaskList,e=0;e<t.length;e++){var i=t[e],n=this["item"+e];2==i.state?n.visible=!1:n.visible=!0;var o=i.awardList[0];n.data=o,n.destruct(),this.addEventTouchTap(n,this.onTouchItem)}},e.prototype.updateAttr=function(){var t=DataCenter.ins().FocusAttackQmConfig,e=taskControl.limitTaskList[0].awardList[0],i=DataCenter.ins().ItemConfig[e.id],n=i.zsLevel||0;for(var o in t)if(o+""==n+""){for(var s in t[o]){var r=t[o][s];for(var a in r)a+""=="3"?this.link4.textFlow=TextUtils.generateTextFlow1(r[a].desc):a+""=="5"?this.link6.textFlow=TextUtils.generateTextFlow1(r[a].desc):this.link8.textFlow=TextUtils.generateTextFlow1(r[a].desc)}break}},e.prototype.onTouchItem=function(t){var e=t.currentTarget,i=e.data;UIMgr.ins().open(PunchEquipTipsView,i,!1)},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=LimitTaskItemRenderer,this.time.text="",this.expBar.slideDuration=0,this.effArr=[];for(var e=0;8>e;e++){var i=new GameMovieClip;i.x=177,i.y=174,i.rotation=45*e,i.touchEnabled=!1,this.effArr.push(i)}},e.prototype.playAllEffect=function(){for(var t=0;t<this.effArr.length;t++)this.effArr[t].parent||(this.effArr[t].playFile(PATH_EFF+"hejizbjihuoeff",-1),this.EffectGroup.addChild(this.effArr[t]))},e.prototype.removeAllEffect=function(){for(var t=0;t<this.effArr.length;t++)this.effArr[t].parent&&DisplayUtils.removeFromParent(this.effArr[t])},e.prototype.updateFly=function(t){if(t&&2==t.state){var e=taskControl.limitTaskList.indexOf(t);e>=0&&this.addFly(e)}},e.prototype.addFly=function(t){var e=this["item"+t],i=new FocusAttackBaseItemRenderer;i.currentState=e.currentState,i.anchorOffsetX=e.width/2,i.anchorOffsetY=e.height/2,i.scaleX=.53,i.scaleY=.53,i.alpha=.8;var n=e.parent,o=new egret.Point;n.parent.localToGlobal(n.x+.53*(e.x+e.width/2),n.y+.53*(e.y+e.height/2),o),this.globalToLocal(o.x,o.y,o),i.x=o.x,i.y=o.y,this.addChild(i);var s=taskControl.limitTaskList[t].awardList[0];i.validateNow(),i.data=s;var r=UIMgr.ins().getView(GameBottomView),a=r.getToggleBtn(GameBottomView.NAV_ROLE),l=new egret.Point;a.parent.localToGlobal(a.x+a.width/2,a.y+a.height/2,l);var h=egret.Tween.get(i);h.to({scaleX:.8,scaleY:.8},300).to({x:o.x+30},50).to({x:o.x-30},50).to({x:o.x+30},50).to({x:o.x-30},50).to({x:o.x+30},50).to({x:o.x-30},50).to({x:o.x+30},50).to({x:o.x-30},50).to({x:o.x},25).to({x:l.x,y:l.y,scaleX:.15,scaleY:.15},800).call(function(){i.parent&&i.parent.removeChild(i)})},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return taskControl.currTaskListsId>0?!0:(UIMgr.ins().open(BossView,2),!1)},e}(BaseEuiView);__reflect(LimitTaskView.prototype,"LimitTaskView");var LimitTaskItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="LimitTaskItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.goBtn.visible=!0,this.done.visible=!1,this.taskNameTxt.text=this.data.name,this.taskIcon.isShowName(!1),this.taskIcon.data=this.data.awardList[0],this.progTxt.text="("+this.data.progress+"/"+this.data.target+")",83==this.data.type&&(this.data.progress>=this.data.target?this.progTxt.text="1/1":this.progTxt.text="0/1"),this.progTxt.textColor=LangMgr.getColor("color84"),0==this.data.state?(this.stateTxt.text=LangMgr.getValueByKey("BattleComing"),this.goBtn.label=LangMgr.getValueByKey("artRenderer1")):1==this.data.state?(this.stateTxt.text=LangMgr.getValueByKey("limitTips2"),this.goBtn.label=LangMgr.getValueByKey("activitGet"),this.progTxt.textColor=LangMgr.getColor("color85")):2==this.data.state&&(this.stateTxt.text=LangMgr.getValueByKey("liliFinsh"),this.goBtn.visible=!1,this.done.visible=!0,this.progTxt.textColor=LangMgr.getColor("color85")),this.redPoint.visible=1==this.data.state,this.addEventTouchTap(this,this.onTap),this.addEventTouchTap(this.taskIcon,this.onTopIcon)},e.prototype.onTopIcon=function(t){t.stopImmediatePropagation(),t.stopPropagation()},e.prototype.onTap=function(t){if(0==this.data.state){var e=this.data.controlTarget[1]?this.data.controlTarget[1]:0;if(CommonFun.isCyberPuzzle(this.data.controlTarget[0]))return void this.gotoQuanQia();UIMgr.ins().open(this.data.controlTarget[0],e)}else 1==this.data.state&&(backpackControl.getSurplusCount()<1?tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace")):taskControl.upGetLimitTaskReward(this.data.id))},e.prototype.gotoQuanQia=function(){return backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?(UIMgr.ins().closeTopLevel(),UIMgr.ins().open(BackpackFullTipsView)):copyControl.currentEnergy>=copyControl.energy?(UIMgr.ins().closeTopLevel(),copyControl.autoPk()):tipsControl.showTips(LangMgr.getValueByKey("powerInsufficient")),!1},e}(BaseItemRender);__reflect(LimitTaskItemRenderer.prototype,"LimitTaskItemRenderer");var TipsControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"view",{get:function(){return this._view&&this._view.parent||(UIMgr.ins().open(TipsView),this._view=UIMgr.ins().getView(TipsView)),this._view},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkView",{get:function(){return this._linkView&&this._linkView.parent||(UIMgr.ins().open(LinkTipsView),this._linkView=UIMgr.ins().getView(LinkTipsView)),this._linkView},enumerable:!0,configurable:!0}),e.prototype.showTips=function(t,e){if(t==LangMgr.getValueByKey("osaNoMoney")||t==LangMgr.getValueByKey("userNoMony")){var i=warnControl.show(LangMgr.getValueByKey("tipsTips3"),null,null,function(){payControl.checkOpenWin(),e&&"function"==typeof e&&e()});return void i.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("artRenderer1"))}DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showTips,t)},e.prototype.showCenterTips=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showCenterTips,t)},e.prototype.showLinkTips=function(t,e){DelayOptMgr.ins().addDelayOptFunction(this.linkView,this.linkView.showLinkTips,{str:t,maxLen:e})},e.prototype.showCenterTips2=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showCenterTips2,t)},e.prototype.showCenterTips3=function(t,e){void 0===e&&(e=3e3),DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showCenterTips3,{str:t,liftTime:e})},e.prototype.showBottomCenterTips=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showBottomCenterTips,t)},e.prototype.showSceneTips=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showSceneTips,t)},e.prototype.showTaskTips=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showTaskTips,t)},e.prototype.showAttrTips=function(t,e){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showAttrTips,[t,e])},e.prototype.showGoodEquipTips=function(t){this.view.showGoodEquipTip(t)},e.prototype.showSkillTips=function(t){this.view.showSkillTip(t)},e.prototype.showItemTips=function(t){this.view.showItemTip(t)},e.prototype.showHeartItemTips=function(t){this.view.showHeartItemTip(t)},e.prototype.showPowerPromote=function(t){var e=UIMgr.ins().open(PowerPromoteTipsView);e.showPowerPromote(t)},e.prototype.showFuncNotice=function(t){var e=UIMgr.ins().open(FuncNoticeTipsView);e.showWin(t)},e.prototype.showEverTips=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showEverTips,t)},e.prototype.showHintTips=function(t){DelayOptMgr.ins().addDelayOptFunction(this.view,this.view.showHintTips,t)},e.prototype.showGoodRewardTips=function(t){this.view.showGoodRewardTip(t)},e.prototype.warnTips=function(t){this.showTips("|C:0xf3311e&T:"+t+"|")},e}(SingleClass);__reflect(TipsControl.prototype,"TipsControl");var AshtarteTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteTipsItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.zlId,e=this.data.id,i=DataCenter.ins().AshtarteSkillConfig[e];i.desc&&i.desc.icon?this.skillIcon1.source=i.desc.icon:this.skillIcon1.source=1e3*Math.floor(i.passive/1e3)+"_png";for(var n=DataCenter.ins().AshtarteBaseConfig[t],o=0,s=0;s<n.skill.length;s++)if(n.skill[s].id==e){o=n.skill[s].open;break}var r=DataCenter.ins().SkillsConfig[i.passive],a=r?r.desc:0,l=DataCenter.ins().SkillsDescConfig[a],h={name:"",desc:""};l&&(h.name=l.name,h.desc=l.desc),r&&l&&h.desc&&(h.desc=StringUtils.replace(h.desc,""+r.desc_ex[0])),i.desc&&i.desc.name&&(h.name=i.desc.name),i.desc&&i.desc.desc&&(h.desc=i.desc.desc),i.attrs&&(h.desc&&(h.desc+="\n"),h.desc+="|C:65322&S:18&T:"+AttributeData.getAttStr(i.attrs,0,1,"：")+"|");var u=ashtarteControl.getStageLv(o);this.desc.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("wingTips13",u[0],h.name,h.desc))}},e.prototype.destruct=function(){},e}(BaseItemRender);__reflect(AshtarteTipsItemRenderer.prototype,"AshtarteTipsItemRenderer");var CrazyDogTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteTipsItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.id,e=this.data.skillid,i=DataCenter.ins().CrazyDogSkillConfig[e];this.skillIcon1.source=i.desc.icon;for(var n=DataCenter.ins().CrazyDogConfig[t],o=0,s=0;s<n.skill.length;s++)if(n.skill[s].id==e){o=n.skill[s].open;break}var r={name:"",desc:""};i.desc&&i.desc.name&&(r.name=i.desc.name),i.desc&&i.desc.desc&&(r.desc=i.desc.desc),i.attrs&&(r.desc&&(r.desc+="\n"),r.desc+="|C:"+LangMgr.getColor("color79")+"&T:"+AttributeData.getAttStr(i.attrs,0,1,"：")+"|");var a=crazyDogControl.getStageLv(o);this.desc.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("wingTips13",a[0],r.name,r.desc))}},e}(BaseItemRender);__reflect(CrazyDogTipsItemRenderer.prototype,"CrazyDogTipsItemRenderer");var ItemGainTipsItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.desc.textColor=this.desc.textColor,this.desc.text=this.data[0],this.goGroup.visible=!!this.data[1]},e}(BaseItemRender);__reflect(ItemGainTipsItemRenderer.prototype,"ItemGainTipsItemRenderer");var AshtarteSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.addEventTouchTap(this.bgClose,this.otherClose),this.id=t[0]||0,this.skillid=t[1];var i={name:"",desc:"",lock:""},n={name:"",desc:"",lock:""},o="",s="",r="";if(this.skillid){o="unactive";for(var a=ashtarteControl.getZhanLingDataById(this.id),l=(ashtarteControl.getZhanLingDataBySkill(this.id),DataCenter.ins().AshtarteBaseConfig[this.id]),h=ashtarteControl.getZhanLingDataByLevel(this.id),u=0;u<l.skill.length;u++)if(l.skill[u].id==this.skillid){var p=DataCenter.ins().AshtarteSkillConfig[l.skill[u].id];s=p.desc&&p.desc.icon?p.desc.icon:1e3*Math.floor(p.passive/1e3)+"_png";var c=DataCenter.ins().SkillsConfig[p.passive],d=c?c.desc:0,g=DataCenter.ins().SkillsDescConfig[d];if(!a||h<l.skill[u].open){var m=Math.floor(l.skill[u].open/10),f=Math.floor(l.skill[u].open%10);f?m+=1:l.skill[u].open&&l.skill[u].open%10==0?f=10:m+=1,g&&(i.name=g.name,i.desc=g.desc),i.lock=LangMgr.getValueByKey("wingTips4",m,f)}else o="max",g&&(i.name=g.name,i.desc=g.desc);c&&g&&i.desc&&(i.desc=StringUtils.replace(i.desc,""+c.desc_ex[0])),p.desc&&p.desc.name&&(i.name=p.desc.name),p.desc&&p.desc.desc&&(i.desc=p.desc.desc),p.attrs&&(i.desc&&(i.desc+="\n"),i.desc+="|C:"+LangMgr.getColor("color79")+"&T:"+AttributeData.getAttStr(p.attrs,0,1,"：")+"|");break}}else{var v=ashtarteControl.getZhanLingDataByTalentId(this.id),y=ashtarteControl.getZhanLingDataByTalentLv(this.id),C=CommonUtils.getObjectLength(DataCenter.ins().AshtarteTalentConfig[v]),T=DataCenter.ins().AshtarteTalentConfig[v][y];if(T)if(y>=C)o="max";else{o="active";var w=DataCenter.ins().AshtarteBaseConfig[this.id],I=DataCenter.ins().ItemConfig[w.mat],b=DataCenter.ins().AshtarteTalentConfig[v][y+1];if(b.talentDesc&&b.talentDesc.icon?(r=b.talentDesc.icon,!0):b.passive&&(r=1e3*Math.floor(b.passive[0].id/1e3)+"_png"),b.talentDesc)if(n.name=b.talentDesc.name,n.desc=StringUtils.replace(b.talentDesc.desc,""+b.rate/100),b.costCount)n.lock=LangMgr.getValueByKey("wingTips12",I.name,b.costCount),DisplayUtils.removeFromParent(this.lock1);else{var D=ashtarteControl.getZhanLingDataByNextStage(this.id);D&&(n.lock=LangMgr.getValueByKey("wingTips4",D[0],D[1]))}else{var B=b.passive[0].id,k=DataCenter.ins().SkillsConfig[B],d=k.desc,g=DataCenter.ins().SkillsDescConfig[d];if(n.name=g.name,n.desc=StringUtils.replace(g.desc,""+k.desc_ex[0]),b.costCount)n.lock=LangMgr.getValueByKey("wingTips12",I.name,b.costCount),DisplayUtils.removeFromParent(this.lock1);else{var D=ashtarteControl.getZhanLingDataByNextStage(this.id);D&&(n.lock=LangMgr.getValueByKey("wingTips4",D[0],D[1]))}}}else if(o="unactive",T=DataCenter.ins().AshtarteTalentConfig[v][1],T.costCount)i.lock=LangMgr.getValueByKey("wingTips11");else{var D=ashtarteControl.getZhanLingDataByNextStage(this.id);D&&(i.lock=LangMgr.getValueByKey("wingTips4",D[0],D[1]))}if(T.talentDesc)i.name=T.talentDesc.name,i.desc=StringUtils.replace(T.talentDesc.desc,""+T.rate/100);else{var B=T.passive[0].id,d=DataCenter.ins().SkillsConfig[B].desc,g=DataCenter.ins().SkillsDescConfig[d];i.name=g.name,i.desc=g.desc,i.desc=StringUtils.replace(i.desc,""+DataCenter.ins().SkillsConfig[B].desc_ex[0])}T.talentDesc&&T.talentDesc.icon?(s=T.talentDesc.icon,!0):T.passive&&(s=1e3*Math.floor(T.passive[0].id/1e3)+"_png")}this.currentState=o,this.validateNow(),this.lblUnlock.visible="unactive"!=this.currentState,this.imgIcon.source=s,this.imgNextIcon.source=r,this.skillName0.textFlow=TextUtils.generateTextFlow1(i.name),this.skillDesc0.textFlow=TextUtils.generateTextFlow1(i.desc),i.lock?this.condition0.textFlow=TextUtils.generateTextFlow1(i.lock):DisplayUtils.removeFromParent(this.condition0.parent),n.name&&("active"==o?(this.skillName1.textFlow=TextUtils.generateTextFlow1(n.name),this.skillDesc1.textFlow=TextUtils.generateTextFlow1(n.desc),n.lock?this.condition1.textFlow=TextUtils.generateTextFlow1(n.lock):DisplayUtils.removeFromParent(this.condition1.parent)):DisplayUtils.removeFromParent(this.nextGroup))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.otherClose),this.removeEventTouchTap(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(AshtarteSkillTipsView.prototype,"AshtarteSkillTipsView");var AshtarteTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="AshtarteTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.gainList.itemRenderer=GainGoodsItem,this.addEventItemTap(this.gainList,this.onTouchList),this.skillList.itemRenderer=AshtarteTipsItemRenderer,this.itemid=t[0],this.itemIcon.setData(DataCenter.ins().ItemConfig[this.itemid]);for(var i in DataCenter.ins().AshtarteBaseConfig){var n=DataCenter.ins().AshtarteBaseConfig[i];if(n.mat==this.itemid){this.zlId=n.id;break}}var o=DataCenter.ins().AshtarteLevelConfig[this.zlId][0];this.lblName.text=o.zlNameLabel,this.model||(this.model=new GameMovieClip),this.model.parent||this.zhanling.addChild(this.model),this.model.name!=PATH_EFF+o.innerAppearance&&this.model.playFile(PATH_EFF+o.innerAppearance,-1),this.bottomMc||(this.bottomMc=new GameMovieClip),this.bottomMc.parent||this.bottomD.addChild(this.bottomMc),this.bottomMc.isPlaying||this.bottomMc.playFile(PATH_EFF+"zhanlingbottom",-1);var s=DataCenter.ins().ItemConfig[this.itemid];this.itemname.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(s)+"&T:"+s.name);var r=ItemUtils.getQuality(s);this.quali.source=r>0?"quali"+r:"";var a=DataCenter.ins().AshtarteBaseConfig[this.zlId],l=DataCenter.ins().AshtarteTalentConfig[a.talent][1];l||(l=DataCenter.ins().AshtarteTalentConfig[a.talent][1]);var h=LangMgr.getValueByKey("wingTips14");if(l.talentDesc&&l.talentDesc.icon)this.skillIcon0.source=l.talentDesc.icon,l.talentDesc.desc&&(h+=l.talentDesc.desc);else{l.passive&&(this.skillIcon0.source=1e3*Math.floor(l.passive[0].id/1e3)+"_png");var u=DataCenter.ins().SkillsConfig[l.passive[0].id],p=DataCenter.ins().SkillsDescConfig[u.desc];h+=StringUtils.replace(p.desc,u.desc_ex)}this.desc.textFlow=TextUtils.generateTextFlow1(h);for(var c=GlobalModel.roleNum,d=DataCenter.ins().AshtarteLevelConfig[this.zlId][0],g=BackpackControl.getAttrPower(d.attrs)*c,m=(l.expower+BackpackControl.getAttrPower(l.attrs?l.attrs:[]))*c,f=0,v=[],y=0;y<a.skill.length;y++){var C=a.skill[y].id,T=DataCenter.ins().AshtarteSkillConfig[C];T.attrs&&(f+=BackpackControl.getAttrPower(T.attrs)*c,v.push({id:C,zlId:a.id}))}this.skillList.dataProvider=new ArrayCollection(v),g=g+m+f,this.powerPanel.setPower(g);var w=DataCenter.ins().PropsGainConfig[this.itemid];w&&(this.gainList.dataProvider=new eui.ArrayCollection(w.gainWay))},e.prototype.onTouchList=function(t){var e=t.item;null!=t.item&&e[1]&&UIMgr.ins().open(e[1],e[2])},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(AshtarteTipsView.prototype,"AshtarteTipsView");var AttriteChangeView=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=e.touchChildren=!1,e.initView(),e}return __extends(e,t),e.prototype.initView=function(){this._sp=new egret.Sprite,this.addChild(this._sp),this._bgImg=new eui.Image,this._sp.addChild(this._bgImg)},e.prototype.setLabelText=function(t,e){var i=this;this._sp.x=0,this._sp.alpha=1,this._bgImg.source="attr"+t;var n=BitmapNumber.ins().createNumPic(e,"attr",5);n.x=90,n.y=10,this._sp.addChild(n);var o=egret.Tween.get(this._sp);o.wait(1e3).to({alpha:0,x:-300},500).call(function(){BitmapNumber.ins().desstroyNumPic(n),n.x=0,n.y=0,DisplayUtils.removeFromParent(i)},this)},e}(BasePanel);__reflect(AttriteChangeView.prototype,"AttriteChangeView");var BackpackFullTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="BackpackFullTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.sureBtn,this.onTap);var i=20;t[0]&&(i=t[0]),this.numText.text=""+i},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.sureBtn:UIMgr.ins().close(this),UIMgr.ins().open(SmeltEquipView)}},e.prototype.close=function(){this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.sureBtn,this.onTap)},e}(BaseEuiView);__reflect(BackpackFullTipsView.prototype,"BackpackFullTipsView");var CenterTipsItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.liftTime=3e3,e}return __extends(e,t),Object.defineProperty(e.prototype,"labelText",{set:function(t){this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow(this._labelText),this.bg.width=this.lab.width+40,this.bg.source="zjmqipao",this.bg.visible=!0,this.lab.alpha=1,this.bg.y=0,this.lab.horizontalCenter=0,this.lab.verticalCenter=0,this.addToEvent||(this.addToEvent=!0,TimerMgr.ins().doTimer(5e3,1,this.removeFromParent,this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelText2",{set:function(t){this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow(this._labelText),this.bg.width=this.lab.width+40,this.bg.source="zjmqipao",this.bg.visible=!0,this.lab.alpha=1,this.bg.y=0,this.lab.horizontalCenter=0,this.lab.verticalCenter=0,this.addToEvent||(this.addToEvent=!0,TimerMgr.ins().doTimer(1e3,1,this.removeFromParent,this))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelText3",{set:function(t){this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow(this._labelText),this.bg.width=this.lab.width+40,this.bg.source="zjmqipao",this.bg.visible=!0,this.lab.alpha=1,this.bg.y=0,this.lab.horizontalCenter=0,this.lab.verticalCenter=0,this.addToEvent||(this.addToEvent=!0,TimerMgr.ins().doTimer(this.liftTime,1,this.removeFromParent,this))},enumerable:!0,configurable:!0}),e}(TipsItemRenderer);__reflect(CenterTipsItemRenderer.prototype,"CenterTipsItemRenderer");var CrazyDogTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="CrazyDogTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemid=t[0],this.addEventTouchEnd(this,this.otherClose),this.gainList.itemRenderer=GainGoodsItem,this.addEventItemTap(this.gainList,this.onTouchList),this.skillList.itemRenderer=CrazyDogTipsItemRenderer;for(var i in DataCenter.ins().CrazyDogConfig){var n=DataCenter.ins().CrazyDogConfig[i];if(n.mat==this.itemid){this.summonerId=n.id;break}}var o=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][0];this.zhanlingName.source=o.zlName,this.model||(this.model=new GameMovieClip),this.model.parent||this.zhanling.addChild(this.model),this.model.name!=PATH_EFF+o.innerAppearance&&this.model.playFile(PATH_EFF+o.innerAppearance,-1),this.bottomMc||(this.bottomMc=new GameMovieClip),this.bottomMc.parent||this.bottomD.addChild(this.bottomMc),this.bottomMc.isPlaying||this.bottomMc.playFile(PATH_EFF+"zhanlingbottom",-1);var s=DataCenter.ins().ItemConfig[this.itemid];this.itemname.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(s)+"&T:"+s.name);var r=ItemUtils.getQuality(s);this.quali.source=r>0?"quali"+r:"";for(var a=DataCenter.ins().CrazyDogConfig[this.summonerId],l=DataCenter.ins().CrazyDogBaseConfig.addjob.length,h=DataCenter.ins().CrazyDogLevelConfig[this.summonerId][0],u=BackpackControl.getAttrPower(h.attrs)*l,p=[],c=0;c<a.skill.length;c++){var d=a.skill[c].id;p.push({id:h.id,skillid:d})}this.skillList.dataProvider=new ArrayCollection(p),u=u,this.powerPanel.setPower(u);var g=DataCenter.ins().PropsGainConfig[this.itemid];g&&(this.gainList.dataProvider=new eui.ArrayCollection(g.gainWay))},e.prototype.onTouchList=function(t){var e=t.item;null!=t.item&&e[1]&&UIMgr.ins().open(e[1],e[2])},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(CrazyDogTipsView.prototype,"CrazyDogTipsView");var CurrencyTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="CurrencyTipsViewSkin",this.itemIcon.imgJob.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1];n=n?n:0,this.addEventTouchEnd(this,this.otherClose),this.setData(i,n)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.setData=function(t,e){var i="";switch(t){case 7:i=e?e+"":"0"}this.nameLabel.text=Currency.getCurrencyName(t),this.num.text=i,this.setImgData(t,e);var n=DataCenter.ins().MoneyConfig[t];this.description.textFlow=TextUtils.generateTextFlow1(n.describe),this.BG.height=170+this.description.height},e.prototype.setImgData=function(t,e){var i=1;switch(t){case 2:i=5;break;case 1:i=0;break;case 4:case 15:i=2;break;case 10:i=2;break;case 13:i=2}this.nameLabel.text=Currency.getCurrencyName(t),this.nameLabel.textColor=LangMgr.getColor("qualityColor"+i),this.itemIcon.imgIcon.source=Currency.getCurrencyRes(t),this.itemIcon.imgBg.source="quality"+i,this.setCount(e+"")},e.prototype.setCount=function(t){if(t.length>4){var e=Math.floor(Number(t)/1e3);t=LangMgr.getValueByKey("shopWan",e/10)}this.num.text=t},e}(BaseEuiView);__reflect(CurrencyTipsView.prototype,"CurrencyTipsView");var DegreeTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DegreeTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.textInfo.textFlow=TextUtils.generateTextFlow(t[0]),this.textInfo.height=this.textInfo.textHeight,this.background.height=this.textInfo.textHeight+60,this.anigroup.y=(StageUtils.ins().getHeight()-this.background.height)/2},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DegreeTipsView.prototype,"DegreeTipsView");var EquipTipsView=function(t){function e(){var e=t.call(this)||this;return e._bottomY=0,e._equipPower=0,e._totalPower=0,e.curRole=0,e.index=0,e.thunderSuitAttrs=[],e.thunderSuitData=[],e.thunderSkillData=[],e.skinName="EquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e.powerPanel.setBgVis(!1),e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.itemIcon.imgJob.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],n=t[1],o=t[2],s=t[3];if(this.roleModel=t[4],this.devourInfo=t[7],t[5]>=0)this.curRole=t[5],this.index=t[6],this.changeBtn.visible=!0,starSunControl.open()&&8!=this.index||DisplayUtils.removeFromParent(this.starBtn.parent),8==this.index&&officeControl.open()?8==this.index&&this.roleModel&&(this.officialRed.visible=OfficeRedPoint.ins().getRed(this.roleModel.job)):DisplayUtils.removeFromParent(this.officialBtn.parent);else{this.changeBtn.visible=!1,DisplayUtils.removeFromParent(this.starBtn.parent),DisplayUtils.removeFromParent(this.officialBtn.parent);var r=t[6];if(isNaN(r)){var a=DataCenter.ins().ItemConfig[o];r=ItemUtils.getSubType(a)}this.index=r}if(this.addEventTouchEnd(this.bgClose,this.otherClose),this.addEventTouchEnd(this.changeBtn,this.onEquipChange),this.addEventTouchEnd(this.starBtn,this.onClick),this.addEventTouchEnd(this.officialBtn,this.onClick),this.setData(i,n,o,s),this.updateRedPoint(),1==this.btnGroup.numElements){var l=this.btnGroup.layout;l.requestedColumnCount=1,l.horizontalGap=0}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onEquipChange=function(t){UIMgr.ins().open(RoleChangeEquipView,this.curRole,this.index),UIMgr.ins().close(this)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.starBtn:UIMgr.ins().open(StarSunView,this.curRole,this.index),UIMgr.ins().close(this);break;case this.officialBtn:UIMgr.ins().open(OfficePositionView,this.curRole),UIMgr.ins().close(this)}},e.prototype.getExtremeName=function(){if(!this.changeBtn.visible)return"";var t=uitrasoneEquipControl.getZhiZunLvByRoleID(this.roleModel,this.index);return t?DataCenter.ins().UitrasoneEquipLvConfig[this.index][t].headTxt:""},e.prototype.setData=function(t,e,i,n){var o,s=n instanceof ItemData?n:void 0;if(this._totalPower=0,void 0!=e&&void 0==s){if(s=backpackControl.getBagGoodsByHandle(t,e),!s)for(var r=heroControl.subRolesLen,a=0;r>a;a++)for(var l=heroControl.getSubRoleByIndex(a),h=l.getEquipLen(),u=0;h>u;u++)if(l.getEquipByIndex(u).item.handle==e){s=l.getEquipByIndex(u).item;break}if(!s)for(var p=storeControl.shopData,r=p.getShopEquipDataLength(),c=null,a=0;r>a;a++)if(c=p.getShopEquipDataByIndex(a),null!=c&&e==c.item.handle){s=c.item;break}s||new Error("EquipDetailedWin data is null!!!"),o=s.itemConfig,i=s.configID}else o=DataCenter.ins().ItemConfig[i];this.legendTipsImg.visible=!1,this.nameLabel.text=this.getExtremeName()+o.name,this.nameLabel.textColor=ItemUtils.getQualityColor(o);
var d=ItemUtils.getQuality(o),g=ItemUtils.getSubType(o),m=ItemUtils.getJob(o);this.quali.source=d>0?"quali"+d:"",this.itemIcon.setData(o);var f=0;if(s instanceof ItemData||null!=o)if(s&&4==ItemUtils.getType(s.itemConfig)){this.levelKey.text=LangMgr.getValueByKey("equiNeed"),this.type.text=RoleModel.getWingEquipNameByType(g),this.lv.text=o.level+1+LangMgr.getValueByKey("equiWingsUse"),this.lv.textColor=15991297;for(var r=heroControl.subRolesLen,a=0;r>a;a++)if(heroControl.getSubRoleByIndex(a).wingsData.lv>=o.level){this.lv.textColor=10721407;break}this.career.text=RoleModel.getJobNameByJob(m),this.jobGroup.visible=!0}else s&&5==ItemUtils.getType(s.itemConfig)?(this.levelKey.text=o.zsLevel>0?LangMgr.getValueByKey("equiRotation"):LangMgr.getValueByKey("equiLevel"),this.type.text=RoleModel.getHejiEquipNameByType(g),this.lv.text=isNaN(o.zsLevel)?(o.level||1)+LangMgr.getValueByKey("numberLevel",""):o.zsLevel+LangMgr.getValueByKey("numberRotation",""),o.zsLevel>0?this.lv.textColor=reincarnateControl.lv<o.zsLevel?15991297:10721407:this.lv.textColor=ActorControl.level<o.level?15991297:10721407,this.jobGroup.visible=!1,-1!=BackpackControl.fitleEquip.indexOf(o.id)&&(this.lv.text=LangMgr.getValueByKey("shopNoLevel")),o.lvName&&(this.lv.text=o.lvName)):(8==g?(this.levelKey.text=LangMgr.getValueByKey("equiLevelValue"),this.type.text=RoleModel.getEquipNameByType(g),this.lv.text=backpackControl.getGuanyinLevel(o)):(this.levelKey.text=o.zsLevel>0?LangMgr.getValueByKey("equiRotation"):LangMgr.getValueByKey("equiLevel"),this.type.text=RoleModel.getEquipNameByType(g),this.lv.text=isNaN(o.zsLevel)?(o.level||1)+LangMgr.getValueByKey("numberLevel",""):o.zsLevel+LangMgr.getValueByKey("numberRotation",""),-1!=BackpackControl.fitleEquip.indexOf(o.id)&&(this.lv.text=LangMgr.getValueByKey("shopNoLevel"))),o.lvName&&(this.lv.text=o.lvName),o.zsLevel>0?this.lv.textColor=reincarnateControl.lv<o.zsLevel?15991297:10721407:this.lv.textColor=ActorControl.level<o.level?15991297:10721407,this.career.text=RoleModel.getJobNameByJob(m),this.jobGroup.visible=!0);var v=1;this.attr1.visible=!1,this.attr2.visible=!1,this.attr3.visible=!1,this.attr4.visible=!1;var y,C=DataCenter.ins().EquipConfig[i],T=[];this.roleModel&&(y=this.roleModel.heirloom.getInfoBySolt(this.index));for(var w in AttributeData.translate)if(!isNaN(C[w])&&C[w]){var I="";I+=AttributeData.getAttrStrByType(RoleModel.getAttrTypeByName(w))+"  ",I+=C[w];var b=new AttributeData;if(void 0!=s){if(s.att){for(var D=s.att,B=0;B<D.length;B++)if(D[B].type==RoleModel.getAttrTypeByName(w)){I+=" |C:65322&T:+"+D[B].value+"|",y&&y.attr_add&&(I+="|C:65322&T:+"+Math.floor((C[w]+D[B].value)*(y.attr_add/100))+"|"),b.type=D[B].type,b.value=C[w]+D[B].value,T.push(b);break}}else for(var k in C)if(AttributeData.attrNames[k]){var x=C[AttributeData.attrNames[k]];if(void 0!=x&&0!=x){var R=RoleModel.getAttrTypeByName(AttributeData.attrNames[k]);I+=AttributeData.getAttrStrByType(R)+"  ",I+=C[k],b.type=R,b.value=C[k],T.push(b)}}}else b.type=RoleModel.getAttrTypeByName(w),b.value=C[w],T.push(b);this["attr"+v].textFlow=TextUtils.generateTextFlow1(I),this["attr"+v].visible=!0,v++}if(s?this._equipPower=s.point:(this._equipPower=Math.floor(BackpackControl.getAttrPower(T)),C&&C.exPower&&(f=C.exPower)),this._totalPower+=this._equipPower+f,this._score=this._totalPower,this.score.text=LangMgr.getValueByKey("wingPingfen",this._totalPower),this._bottomY=this["attr"+(v-1)].y+this["attr"+(v-1)].height,this.attr5&&C&&C.baseAttr1)if(121==o.descIndex||122==o.descIndex){this.attr5.textFlow=TextUtils.generateTextFlow1("|C:0xFFE500&T:"+AttributeData.getAttrStrByType(C.baseAttr1.type)+": |"+("|C:0xFFE500&T:"+C.baseAttr1.value/100+"%|")),this.attr5.y=this._bottomY+5,this._bottomY+=this.attr5.height+10;var E=0;this.roleModel&&(E=ItemUtils.relatePower(C.baseAttr1,this.roleModel)),this._totalPower+=E}else DisplayUtils.removeFromParent(this.attr5);else DisplayUtils.removeFromParent(this.attr5);for(this._bottomY+=10,this.lineImg.y=this._bottomY;this.forgeGroup.numElements;)this.forgeGroup.removeChildAt(0);if(this.roleModel){for(var r=this.roleModel.getEquipLen(),a=0;r>a;a++){var _=this.roleModel.getEquipByIndex(a);if(_.item.handle==e){this.setForge(_,a);break}}C&&(C.baseAttr1&&(this._equipPower+=ItemUtils.relatePower(C.baseAttr1,this.roleModel)),C.baseAttr2&&(this._equipPower+=ItemUtils.relatePower(C.baseAttr2,this.roleModel)))}if(8==g){if(this.roleModel&&this.roleModel.guanZhiLv){var S=officeControl.getTitle(this.roleModel);S&&this.addTips(null,10,0),this.addTips(DataCenter.ins().OfficeLevelConfig[this.roleModel.job][this.roleModel.guanZhiLv].attr,9,0),this._totalPower+=officeControl.getPower(this.roleModel)}this.addTips(null,4,0,null,null,null,null,!1)}if(o.desc){var M=new eui.Label;M.size=18,M.width=250,M.textColor=10721407,M.x=this.attr1.x,M.y=this._bottomY+=10,M.textFlow=TextUtils.generateTextFlow(o.desc),this.forgeGroup.addChild(M),this._bottomY+=M.textHeight}this.setOthers(g,o);var P=500;this._bottomY>P&&(this._bottomY=P),this.background.height=this.powerPanel.y+this.powerPanel.height+this._bottomY+this.starGroup0.height+34,this.background.height=this.background.height<470?470:this.background.height,this.starGroup0.y=this.background.height-this.starGroup0.height-26,this.bgDeco.height=this.background.height,this.bgGroup.y=this.background.y+this.background.height,this.powerPanel.setPower(this._totalPower);var L=this.attr1.parent.parent;L.height=this._bottomY,L.scrollPolicyV=this._bottomY>=P?"on":"off"},e.prototype.setForge=function(t,e){var i=0;if(e>=0&&7>=e){var n=this.devourInfo&&this.devourInfo.getDevourInfo(this.roleModel.index,e);if(n&&n.lv){this.addTips([],11,n.lv,n.soul,0,"",e);var o=DataCenter.ins().DevourEquipLevelConfig[e][n.lv],s=[];for(var r in o.attr){var a=o.attr[r],l=DevourEquipContorl.ins().getSoulValue(e,n.soul,parseInt(r));s[r]={type:a.type,value:l}}var h=AttributeData.AttrAddition(s,o.attr),u=Math.floor(BackpackControl.getAttrPower(h));u+=DevourEquipContorl.ins().calAttrPower(this.roleModel,this.devourInfo.thirteenequips[this.roleModel.index],e,n.lv),this._totalPower+=u}}for(var p=0;4>p;p++){switch(i=0,p){case 0:i=t.strengthen;break;case 2:i=t.zhuling;break;case 1:i=t.gem}if(i>0){var c=intensifyControl.getForgeConfigByPos(e,i,p);this.addTips(c.attr,p,i);var d=0;d=3==p?Math.floor(this._equipPower*(Number(c.attr)/100)):Math.floor(BackpackControl.getAttrPower(c.attr)),this._totalPower+=d}}if(e>=0&&7>=e&&(i=uitrasoneEquipControl.getZhiZunLvByRoleID(this.roleModel,e),this.itemIcon.extreme.visible=i?!0:!1,i)){var c=DataCenter.ins().UitrasoneEquipLvConfig[e][i];c.ex_attrs&&(this._totalPower+=Math.floor(BackpackControl.getAttrPower(c.ex_attrs))),this._totalPower+=c.ex_power?c.ex_power:0;var g="",m=uitrasoneEquipControl.getZhiZunLinkLvShow(this.curRole,e,i),f=m>0,v=void 0,y=!1;for(var C in DataCenter.ins().UitrasoneEquipLinkLvConfig[e]){for(var T in DataCenter.ins().UitrasoneEquipLinkLvConfig[e][C])if(v=DataCenter.ins().UitrasoneEquipLinkLvConfig[e][C][T],1==v.level&&(g=v.chainDesc),v.level==m&&f){y=!0,v.attrs&&(this._totalPower+=Math.floor(BackpackControl.getAttrPower(v.attrs))),v.exAttrs&&(this._totalPower+=Math.floor(BackpackControl.getAttrPower(v.exAttrs))),this._totalPower+=v.ex_power,g=v.chainDesc;break}if(y)break}this._totalPower+=Math.floor(BackpackControl.getAttrPower(c.attrs)),this.addTips(c.attrs,5,i,m,c.skillId,g)}if(e>=0&&7>=e){var w=this.roleModel.thunderForgeVos;if(w&&w[e]){var I=[],b=0;for(var C in w[e].level)b+=w[e].level[C];if(b){var D=[];for(var B in DataCenter.ins().ThunderQuenSumConfig[e])D.push(DataCenter.ins().ThunderQuenSumConfig[e][B]);D.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var p=0;p<D.length;p++){var k=D[p];if(b>=k.totalLevel){var x=thunderControl.getBaseAttrs(this.roleModel,e);for(var C in x)x[C].value*=k.precent/100,x[C].value=x[C].value>>0;I=AttributeData.AttrAddition(I,x);break}}}I.length&&(this._totalPower+=thunderControl.getRelatePower(this.roleModel,e),this._totalPower+=thunderControl.getBasePower(this.roleModel,e))}var R=thunderControl.getAttrs(this.roleModel,null,e);if(R=thunderControl.getThunderItemAttrs(this.roleModel,R,e),!this.thunderSuitAttrs.length){var E=0;this.thunderSuitAttrs=thunderControl.getThunderSuitAttrs(this.roleModel,E)}if(R.length&&R.length){for(var _=[],S=0;S<R.length;S++)R[S].value&&_.push(R[S]);_.length&&this.addTips(_,6,0,0,0,"",e)}0!=e&&2!=e&&thunderControl.AddThunderPercent(R,this.thunderSuitAttrs[1]),this._totalPower+=Math.floor(BackpackControl.getAttrPower(R));var M=thunderControl.getSuitData(1,this.roleModel);if(0!=e&&2!=e)for(var C in M){var P=DataCenter.ins().ThunderSuitLvConfig[1][M[C].num][M[C].level];this._totalPower+=P.ex_power?P.ex_power:0}if(this.roleModel.thunderSuitVos[e].level){var L=DataCenter.ins().ThunderEquipLvConfig[e][this.roleModel.thunderSuitVos[e].level];this._totalPower+=L.ex_power?L.ex_power:0}}if((0==e||2==e)&&t.item.configID&&this.roleModel.mythForgeVo){var A=this.roleModel.mythForgeVo.getSlotData(e);if(A.level){for(var V=DataCenter.ins().ItemConfig[t.item.configID],U=DataCenter.ins().MythLevelConfig[e][A.level],F=ItemUtils.getBaseAttrData(V),G=[],p=0;p<t.item.att.length;p++){var N=t.item.att[p];N&&N.value>0&&G.push(new AttributeData(N.type,N.value))}F=AttributeData.AttrAddition(G,F);for(var S=0;S<F.length;S++)F[S].value=Math.floor(F[S].value*U.percent/1e4);var I=AttributeData.AttrAddition(U.attr,F);this.addTips(I,7),this._totalPower+=BackpackControl.getAttrPower(I);var q=ItemUtils.getQuality(V);5==q&&(this.legendTipsImg.source=U.tipsImg,this.legendTipsImg.visible=!0)}}if(8!=e&&this.roleModel.starSunVos[e]&&this.roleModel.starSunVos[e].level){var O=starSunControl.getAttrs(this.roleModel,e),H=starSunControl.getPercentAttrs(this.roleModel,e);this.addTips(O[0],8,0,0,0,"",e),this._totalPower+=O[1]+H[1]||0}},e.prototype.addTips=function(t,e,i,n,o,s,r,a){void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===s&&(s=""),void 0===r&&(r=-1),void 0===a&&(a=!0);var l=new eui.Image("jinxian2"),h=new eui.Label;h.size=18,h.textColor=8283191,h.touchEnabled=!1;var u=new eui.Group;u.addChild(l),u.addChild(h);var p=new eui.HorizontalLayout;p.gap=6,p.verticalAlign=egret.VerticalAlign.MIDDLE,u.layout=p,u.y=this._bottomY+14,u.x=.4,this.forgeGroup.addChild(u);var c=new eui.Label;c.size=20,c.lineSpacing=2,c.y=u.y+24,c.touchEnabled=!1,this.forgeGroup.addChild(c);var d;switch(e){case 0:h.text=LangMgr.getValueByKey("equiAttrType1"),d=t,c.textColor=16773120;break;case 1:h.text=LangMgr.getValueByKey("equiAttrType2"),d=t,c.textColor=14233598;break;case 2:h.text=LangMgr.getValueByKey("equiAttrType3"),c.textColor=2271743,d=t;break;case 3:h.text=LangMgr.getValueByKey("equiAttrType4");break;case 4:h.text=LangMgr.getValueByKey("equiAttrType5");break;case 5:h.text=LangMgr.getValueByKey("equiAttrType6"),h.textColor=LangMgr.getColor("color53"),d=t,c.textColor=LangMgr.getColor("color53");break;case 6:h.text=LangMgr.getValueByKey("leitingsx"),h.textColor=LangMgr.getColor("color54"),d=t,c.textColor=LangMgr.getColor("color54");break;case 7:h.text=LangMgr.getValueByKey("shenhuasx"),h.textColor=LangMgr.getColor("color22"),d=t,c.textColor=LangMgr.getColor("color22");break;case 8:h.text=LangMgr.getValueByKey("xingchensx"),h.textColor=LangMgr.getColor("color48"),d=t,c.textColor=LangMgr.getColor("color48");break;case 9:h.text=LangMgr.getValueByKey("guanzhisx"),d=t,c.textColor=10458221;break;case 10:h.text=LangMgr.getValueByKey("guanzhich"),c.height=150;var g=new eui.Group;g.width=330,g.height=150,g.x=20,g.y=c.y,this.forgeGroup.addChild(g);var m=officeControl.getTitle(this.roleModel);if(m.eff){var f=new GameMovieClip;f.x=g.width/2,f.y=g.height/2,f.playFile(PATH_EFF+m.eff,-1),g.addChild(f)}else{var v=new eui.Image(m.img);g.addChild(v)}break;case 11:h.text=LangMgr.getValueByKey("tunshiAtt"),h.textColor=16711680,d=t,c.textColor=16750848}var y;2!=e&&5!=e&&6!=e&&7!=e&&this.roleModel&&(y=this.roleModel.heirloom.getInfoBySolt(this.index));var C=0;if(d)if(3!=e){if(8!=e&&(c.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStr(d,1,1,"  ",!1,!0,y))),5==e){var T=new eui.Label;T.size=20,T.textColor=LangMgr.getColor("color53"),T.x=24,T.y=c.y+c.height+10,T.touchEnabled=!1,T.width=280,this.forgeGroup.addChild(T),T.textFlow=TextUtils.generateTextFlow("<font color = '"+(n?"#FCF537":"#666666")+"'><b>【"+LangMgr.getValueByKey("equiSoulLink")+"Lv"+(n?n:1)+"】</b></font>"),C+=T.textHeight+10;var w=new eui.Label;if(w.size=18,w.lineSpacing=2,w.textColor=LangMgr.getColor("color53"),w.x=46,w.y=T.y+T.textHeight+10,w.touchEnabled=!1,w.multiline=!0,w.wordWrap=!0,this.forgeGroup.addChild(w),w.textFlow=TextUtils.generateTextFlow("<font color = '"+(n?"#FCF537":"#666666")+"'>"+s+"</font>"),C+=w.textHeight+10,o){var I=DataCenter.ins().SkillsConfig[o],b=DataCenter.ins().SkillsDescConfig[I.desc],D=new eui.Label;D.size=20,D.textColor=LangMgr.getColor("color53"),D.x=24,D.y=w.y+w.height+10,D.touchEnabled=!1,D.width=280,D.wordWrap=!0,D.multiline=!0,this.forgeGroup.addChild(D),D.textFlow=TextUtils.generateTextFlow("<b>【"+b.name+"Lv"+i+"】</b>"),C+=D.textHeight+10;var B=new eui.Label;B.size=18,B.lineSpacing=2,B.textColor=LangMgr.getColor("color53"),B.x=46,B.y=D.y+D.textHeight+10,B.touchEnabled=!1,B.width=280,B.wordWrap=!0,B.multiline=!0,this.forgeGroup.addChild(B),B.textFlow=TextUtils.generateTextFlow(b.desc.replace("%s%",I.desc_ex[0]+"")),C+=B.textHeight+10}}else if(6==e){var k=thunderControl.getEquipSlotTotalLv(this.roleModel,r);if(k){var x=[];for(var R in DataCenter.ins().ThunderQuenSumConfig[r])x.push(DataCenter.ins().ThunderQuenSumConfig[r][R]);x.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var E=1,_=0,S=void 0,M=0;M<x.length;M++){var P=x[M];if(_++,k>=P.totalLevel){S=P;break}}if(E=x.length-_+1,S){var L=c.text+"\n",A="";if(L+="|C:0x4e5bfa&T:【"+DataCenter.ins().ThunderQuenBaseConfig.suitSkillName[0]+"Lv"+E+"】",A+="\n",A+=RoleModel.getEquipNameByType(r)+LangMgr.getValueByKey("starSun1")+S.precent+"%",S.attr){var V=AttributeData.getCustomAttrValue(S.attr,65),U=void 0;V&&(U=[],U.push({type:65,value:AttributeData.getAttrStrWithSpaceByType(65)+V+"%"})),A+="\n"+AttributeData.getAttStr(S.attr,0,1," ",!1,!0,null,"",U)}L+=A,c.textFlow=TextUtils.generateTextFlow1(L)}}if(0!=r&&2!=r){this.thunderSuitData.length||(this.thunderSuitData=thunderControl.getSuitData(1,this.roleModel));var F=this.thunderSuitData.concat(),G=thunderControl.getAttrs(this.roleModel,null,r);if(G=thunderControl.getThunderItemAttrs(this.roleModel,G,r),F.length){for(var L=c.text+"\n",N=0,M=0;M<this.roleModel.thunderSuitVos.length;M++)0!=M&&2!=M&&this.roleModel.thunderSuitVos[M].level&&N++;L+="|C:0x4e5bfa&T:【"+LangMgr.getValueByKey("leitingtaozhuang")+"("+N+"/"+ThunderControl.suitMaxCount+")】",F.sort(function(t,e){return t.num<e.num?-1:1});for(var q=0;q<F.length;q++){var O=F[q].level,H=F[q].num,K=DataCenter.ins().ThunderSuitLvConfig[1][H][O];if(O){var W=thunderControl.getThunderSuitAttrs(this.roleModel,1,H),z="\n("+H+")"+LangMgr.getValueByKey("numberJT1")+":",A="",j=[];W[1]&&(A+="\n"+RoleModel.getEquipNameByType(r)+LangMgr.getValueByKey("buweitzbasesx")+100*W[1]+"%"),K.attrs&&(z+=A?"":"\n",j=AttributeData.AttrAddition(j,K.attrs));for(var Y=[],Z=0;Z<j.length;Z++)j[Z].value&&Y.push(j[Z]);z+=AttributeData.getAttStr(Y,0,1,"+"),L+=z,L+=A}}c.textFlow=TextUtils.generateTextFlow1(L)}}}else if(8==e){var X=starSunControl.getPercentAttrs(this.roleModel,r);c.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttStrSpecial([d,X[0]],4,1," "));var O=this.roleModel.starSunVos[r].level;if(O){var Q=DataCenter.ins().StarSunLvConfig[r][O];if(Q.per){var L=c.text+("\n"+RoleModel.getEquipNameByType(r)+LangMgr.getValueByKey("starSun1")+Q.per/100+"%");c.textFlow=TextUtils.generateTextFlow1(L)}}}else if(9==e){var J=officeControl.getAttrStr(this.roleModel.job,this.roleModel.guanZhiLv);c.textFlow=TextUtils.generateTextFlow1(J.str+"\n"+("|C:0xee00ff&T:"+J.exStr+"|"))}else if(11==e){var $="",te=DataCenter.ins().DevourEquipLevelConfig[r][i];for(var R in te.attr){var ee=te.attr[R];$+="|C:0xFF0000&T:"+AttributeData.getAttrStrByType(ee.type)+"|C:0x00ff00&T: +"+ee.value+"|\n"}if(te.specialAttr)for(var ie in te.specialAttr){var ne=LangMgr.getValueByKey("equipPosName"+r),oe="";switch(parseInt(ie)){case DevourEquipPosType.zhizun:oe=LangMgr.getValueByKey("tunshizhizhunEquipAtt",ne);break;case DevourEquipPosType.leiting:oe=LangMgr.getValueByKey("tunshileitingEquipAtt",ne);break;case DevourEquipPosType.chuanqi:oe=LangMgr.getValueByKey("tunshichuanqiEquipAtt",ne)}$+="|C:0xFF0000&T:"+oe+"|C:0x00ff00&T: +"+te.specialAttr[ie].prop/100+"%|\n"}var se=$.lastIndexOf("\n");$=$.substring(0,se),c.textFlow=TextUtils.generateTextFlow1($);var re=new eui.Label;re.fontFamily="Arial",re.size=18,re.textColor=16711680,re.x=46,re.y=u.y+26,re.touchEnabled=!1,re.width=280,this.forgeGroup.addChild(re),re.text=DataCenter.ins().DevourEquipDataConfig.equipIconInfo[r][0]+LangMgr.getValueByKey("tunshijieshu",i);var ae=new eui.Label;ae.fontFamily="Arial",ae.size=20,ae.textColor=16711680,ae.x=24,ae.y=re.y+re.height+10,ae.touchEnabled=!1,ae.width=280,this.forgeGroup.addChild(ae),ae.text=LangMgr.getValueByKey("tunshibaseAtt"),c.y+=ae.textHeight+re.textHeight+20;var le=new eui.Label;le.fontFamily="Arial",le.size=20,le.textColor=16711680,le.x=24,le.y=c.y+c.height+10,le.touchEnabled=!1,le.width=280,le.text=LangMgr.getValueByKey("tunshibasegrow"),this.forgeGroup.addChild(le),C+=le.textHeight+10;var he=new eui.Label;he.fontFamily="Arial",he.size=18,he.textColor=16711680,he.x=46,he.y=le.y+le.height+10,this.forgeGroup.addChild(he),he.text=LangMgr.getValueByKey("tunshibasegrowjd"),C+=he.textHeight+10;var ue=this.devourInfo.getDevourInfo(this.roleModel.index,r),pe=new DevourEquipBarItemRender;pe.x=46,pe.y=he.y+he.height+10,pe.updatePro(ue.soul,ue.maxsoule),this.forgeGroup.addChild(pe),C+=pe.height+10;var ce=pe.y+pe.height+10;$="";for(var de in te.attr){var ee=te.attr[de],ge=DevourEquipContorl.ins().getSoulValue(r,n,parseInt(de));ge&&($+="|C:0xFF0000&T:"+AttributeData.getAttrStrByType(ee.type)+"|C:0x00ff00&T: +"+ge+"|\n")}if(se=$.lastIndexOf("\n"),se>0){var me=new eui.Label;me.fontFamily="Arial",me.size=18,me.textColor=16750848,me.x=46,me.y=ce,me.touchEnabled=!1,me.width=280,this.forgeGroup.addChild(me),$=$.substring(0,se),me.textFlow=TextUtils.generateTextFlow1($),C+=me.textHeight+10,ce=me.y+me.textHeight+10}if(ue.stone){var fe=new eui.Label;fe.x=46,fe.y=ce,fe.fontFamily="Arial",fe.size=18,fe.textColor=16711680,fe.text=LangMgr.getValueByKey("tunshijubianjd")+ue.stone,this.forgeGroup.addChild(fe),C+=fe.height+10,$="";var ve=DataCenter.ins().DevourEquipDataConfig.stoneAttr;for(var R in ve)$+="|C:0xFF0000&T:"+AttributeData.getAttrStrByType(ve[R].type)+"|C:0x00ff00&T: +"+ve[R].value*ue.stone+"|\n";se=$.lastIndexOf("\n"),$=$.substring(0,se);var ye=new eui.Label;ye.x=46,ye.y=fe.y+fe.height+10,ye.fontFamily="Arial",ye.size=18,ye.textColor=16711680,this.forgeGroup.addChild(ye),ye.textFlow=TextUtils.generateTextFlow1($),C+=ye.height+10,ce=ye.y+ye.height+10}var Ce=DevourEquipContorl.ins().getSuitDataByData(this.roleModel,this.devourInfo.items[this.roleModel.index]),Te=DevourEquipContorl.ins().getRoleActNum(this.devourInfo.items[this.roleModel.index]);if(Ce.length>0){var we=new eui.Label;we.fontFamily="Arial",we.size=20,we.textColor=16711680,we.x=24,we.y=ce,we.touchEnabled=!1,we.width=280,we.text=LangMgr.getValueByKey("tunshitaozhuangatt")+Te+"/8",C+=we.textHeight+10;var Ie=new eui.Label;Ie.fontFamily="Arial",Ie.size=18,Ie.textColor=16711680,Ie.x=46,Ie.y=we.y+we.height+10,Ie.touchEnabled=!1,Ie.width=300,Ie.lineSpacing=8;for(var be="",De=[8,6,4,2],M=0;M<De.length;M++)for(var q=0;q<Ce.length;q++)if(Ce[q].count==De[M]){be+="|S:18&C:0xFF0000&T:"+De[M]+LangMgr.getValueByKey("thunderSuitTips1");var Be=DataCenter.ins().DevourSoulSuitConfig[De[M]][Ce[q].lv];if(Be.desc){var ke=Be.desc;if(8==Ce[q].count){var xe=DevourEquipContorl.ins().suitEffSkillData1(Ce[q].lv,this.devourInfo.roledata);for(var Re in xe)ke=ke.replace("d%",""+xe[Re])}be+="\n|S:18&C:0xFF9900&T:"+ke+"\n"}break}be=be.substring(0,be.length-1),Ie.textFlow=TextUtils.generateTextFlow1(be),this.forgeGroup.addChild(we),this.forgeGroup.addChild(Ie),C+=Ie.textHeight+10}}}else c.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("equiBasicAttr")+t+"%");if(a){var Ee=new eui.Image("tongyongline");Ee.horizontalCenter=0,this.forgeGroup.addChild(Ee),this._bottomY=c.y+c.height+C+8,Ee.y=this._bottomY}else this._bottomY=c.y+c.height+C;4==e&&(this._bottomY=u.y+h.height)},e.prototype.getScore=function(){return this._score},e.prototype.getPower=function(){return this.powerPanel.power},e.prototype.getType=function(){return this.type.text},e.prototype.updateRedPoint=function(){this.upRed.visible=starSunControl.checkUpRedPoint(this.roleModel,this.index)},e.prototype.setOthers=function(t,e){if(e){var i=ItemUtils.getQuality(e),n=DataCenter.ins().EquipConfig[e.id];n&&4==i&&n.stoneNum?this.decompose.text=""+n.stoneNum:DisplayUtils.removeFromParent(this.decomposeGroup)}else DisplayUtils.removeFromParent(this.decomposeGroup);if(this.roleModel&&this.roleModel.starSunVos.length>0&&this.roleModel.starSunVos[t].level){var o=new StarSunEnhanceTipsItemRenderer;o.data=this.roleModel.starSunVos[t].level,this.starGroup0.addChild(o),this.decomposeGroup.parent&&(o.y=this.decomposeGroup.height)}},e}(BaseEuiView);__reflect(EquipTipsView.prototype,"EquipTipsView");var EverTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.skinName="HintTipsItemRendererSkin",e.lab.stroke=1,e.lab.strokeColor=0,e.bg.source="zjmqipao",e}return __extends(e,t),e.prototype.setIndex=function(t){this.index=t},Object.defineProperty(e.prototype,"labelText",{get:function(){return this._labelText},set:function(t){var e=this;this.bg.alpha=1,this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow(this._labelText),this.bg.width=this.lab.width+80,this.lab.alpha=1,this.bg.y=0,this.lab.verticalCenter=-1;var i=egret.Tween.get(this.bg);i.to({y:0},500).wait(500).to({alpha:0},200).call(function(){DisplayUtils.removeFromParent(e)},this)},enumerable:!0,configurable:!0}),e}(BasePanel);__reflect(EverTipsItemRenderer.prototype,"EverTipsItemRenderer");var FakeEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FakeEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t){this.addEventTouchTap(this.bgClose,this.onClose),this.update(t)},e.prototype.update=function(t){var e=DataCenter.ins().ItemConfig[t],i=DataCenter.ins().FakeitemConfig[t];this.quali.source="quali"+ItemUtils.getQuality(e),this.itemIcon.setData(e),this.nameLabel.textFlow=TextUtils.generateTextFlow("|C:"+ItemUtils.getQualityColor(e)+"&T:"+e.name+"|"),this.type.textFlow=TextUtils.generateTextFlow(i.pos),this.career.text=i.job,this.lv.text=LangMgr.getValueByKey("numberRotation",i.zslevel),this.powerPanel.setPower(i.power),this.powerPanel.setMcVisible(!1),this.powerPanel.setBgVis(!1),this.score.text=LangMgr.getValueByKey("wingPingfen",i.power);for(var n="",o=i.attrs?i.attrs.length:0,s=0;o>s;s++){var r=i.attrs[s];n+=AttributeData.getAttStrEx([r],4,1,"：");var a=this.getAttrByType(r.type,i.addAttrs);a&&(n+=" "+AttributeData.getAttStrEx([a],4,1,"+",!1,!1)),o-1>s&&(n+="\n")}this.attrs.text=n},e.prototype.onClose=function(){UIMgr.ins().close(this)},e.prototype.getAttrByType=function(t,e){if(!e||!e.length)return null;for(var i=e.length,n=0;i>n;n++){var o=e[n];if(o.type==t)return o}return null},e}(BaseEuiView);__reflect(FakeEquipTipsView.prototype,"FakeEquipTipsView");var FashionHeirloomTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FashionTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(this.itemConfig=t[0],this.roleIndex=t[1],this.dressDp=heirloomControl.getDressDpById(this.itemConfig.id),this.addEventTouchTap(this.takeBtn,this.onTap),this.addEventTouchEnd(this,this.otherClose),isNaN(this.roleIndex)){var i=heroControl.roles.concat();i.sort(function(t,e){return SortUtils.sortDescByKey(t,e,"power")}),this.roleIndex=i[0].index}this.setData(),this.roleIndex&&DisplayUtils.removeFromParent(this.takeBtn)},e.prototype.setData=function(){this.bodyMc||(this.bodyMc=new GameMovieClip),this.bodyMc.parent||this.bodyEff.addChild(this.bodyMc),this.bodyMc.playFile(PATH_EFF+this.dressDp.eff+"n",-1);var t=BackpackControl.getAttPowerContainRelate(AttributeData.transformAttr(this.dressDp.attr),this.roleIndex);this.powerPanel.setPower(t),this.style.text=LangMgr.getValueByKey("equipment3"),this.itemname.text=this.itemConfig.name,this.lblTitle.text=this.itemname.text,this.itemIcon.setData(this.itemConfig),DisplayUtils.removeFromParent(this.invalidtime);var e=new EquipNormalTipsItemRenderer;e.data={title:LangMgr.getValueByKey("flowerNormalAttr"),attributeData:this.dressDp.attr,colorName:0,colorValue:0,others:null},this.content.addChild(e);for(var i=0;i<this.dressDp.attr.length;i++){var n=this.dressDp.attr[i].type;if(20==n){var o=new FashionSpecialTipsPanel;o.setData({title:LangMgr.getValueByKey("equiAttrType5"),attrDesc:AttributeData.getAttrStrByType(n)+" +"+this.dressDp.attr[i].value/100+"%"}),this.content.addChild(o);break}}},e.prototype.otherClose=function(){UIMgr.ins().close(this)},e.prototype.onTap=function(){UIMgr.ins().open(HeirloomDressView)},e}(BaseEuiView);__reflect(FashionHeirloomTipsView.prototype,"FashionHeirloomTipsView");var FashionSpecialTipsPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="FashionSpecialTipsPanelSkin",e}return __extends(e,t),e.prototype.setData=function(t){if(this.clear(),null!=t){var e=t.title,i=t.attrDesc;this.attrType.textFlow=TextUtils.generateTextFlow1(e),this.suit.textFlow=TextUtils.generateTextFlow1(i)}},e.prototype.clear=function(){this.attrType.textFlow=null,this.suit.textFlow=null},e}(BasePanel);__reflect(FashionSpecialTipsPanel.prototype,"FashionSpecialTipsPanel");var FashionTipsView=function(t){function e(){var e=t.call(this)||this;return e.approachDic={},e.skinName="FashionTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemConfig=t[0],this.itemId=this.itemConfig.id,this.addEventTouchTap(this.takeBtn,this.onTap),this.addEventTouchTap(this.boyOrGirlBtn,this.onTap),this.addEventTouchEnd(this,this.otherClose),this.boyOrGirlBtn.visible=!1,t[1]&&DisplayUtils.removeFromParent(this.takeBtn),this.setTipsData()},e.prototype.setTipsData=function(){var t=fashionControl.getIdByItemId(this.itemId)[0];if(this.itemData=t,t){var e=t.attr,i=heroControl.getSubRoleByIndex(0),n=ItemUtils.relatePowerEx(e,i),o=AttributeData.AttrAddition(n,e),s=BackpackControl.getAttrPower(AttributeData.transformAttr(o))+(t.exPower?t.exPower:0);if(s=BackpackControl.addSkillPower(s,[i],e),this.powerPanel.setPower(s),this.itemname.text=t.name,this.itemIcon.setData(DataCenter.ins().ItemConfig[this.itemId]),this.quali.source="quali"+ItemUtils.getQuality(this.itemConfig),this.style.text=t.dressTipsType?t.dressTipsType:LangMgr.getValueByKey("dressType"+t.pos),this.lblTitle.text=t.name,t.suitid){var r=DataCenter.ins().FashionSuitConfig[t.suitid],a=new eui.Component;a.skinName="FashionTipsSuitViewSkin",a.suitdesc.textFlow=TextUtils.generateTextFlow1(r.desc),this.content.addChild(a)}if(e=this.filterAttrStr(e),e.length){var l=new EquipNormalTipsItemRenderer;l.data={title:LangMgr.getValueByKey("flowerNormalAttr"),attributeData:e,colorName:0,colorValue:0,others:null},this.content.addChild(l)}if(t.special_attr_desc){var h=new FashionSpecialTipsPanel;h.setData({title:LangMgr.getValueByKey("equiAttrType5"),attrDesc:t.special_attr_desc}),this.content.addChild(h)}if(this.invalidtime&&(this.invalidtime.visible=!1,t.invalidtime&&(this.invalidtime.visible=!0,this.invalidtime.text=LangMgr.getValueByKey("validtimeday",Math.floor(t.invalidtime/DateUtils.SECOND_PER_DAY)))),2==t.pos)t.weaponHasFamale&&(this.boyOrGirlBtn.visible=!0);else{var u=this.itemId+"_0",p=this.itemId+"_1";DataCenter.ins().EquipWithEffConfig[u]&&DataCenter.ins().EquipWithEffConfig[p]&&(this.boyOrGirlBtn.visible=DataCenter.ins().EquipWithEffConfig[u].inShowEff!=DataCenter.ins().EquipWithEffConfig[p].inShowEff)}this.boyOrGirlBtn.selected=!0,this.setSex(0)}},e.prototype.setSex=function(t){var e=this.itemData,i=e.show_img,n=this.itemId+"_"+t,o=DataCenter.ins().EquipWithEffConfig[n];o&&o.pos?1==o.pos?(this.bodyMc||(this.bodyMc=new GameMovieClip),this.bodyMc.parent||this.bodyEff.addChild(this.bodyMc),o.tipsWeaponOffset&&(this.bodyMc.x=o.tipsWeaponOffset.x,this.bodyMc.y=o.tipsWeaponOffset.y),o.tipsScale&&(this.bodyMc.scaleX=o.tipsScale[0]||1,this.bodyMc.scaleY=o.tipsScale[1]||1),this.bodyMc.playFile(PATH_EFF+o.inShowEff,-1),this.module.source=""):2==o.pos?(this.weaponMc||(this.weaponMc=new GameMovieClip),this.weaponMc.parent||this.weaponEff.addChild(this.weaponMc),o.tipsWeaponOffset&&(this.weaponMc.x=o.tipsWeaponOffset.x,this.weaponMc.y=o.tipsWeaponOffset.y),o.tipsScale&&(this.weaponMc.scaleX=o.tipsScale[0]||1,this.weaponMc.scaleY=o.tipsScale[1]||1),this.weaponMc.playFile(PATH_EFF+o.inShowEff,-1),this.module.source=""):3==o.pos&&(this.wingMc||(this.wingMc=new GameMovieClip),this.wingMc.parent||this.wingEff.addChild(this.wingMc),o.tipsWeaponOffset&&(this.wingMc.x=o.tipsWeaponOffset.x,this.wingMc.y=o.tipsWeaponOffset.y),o.tipsScale&&(this.wingMc.scaleX=o.tipsScale[0]||1,this.wingMc.scaleY=o.tipsScale[1]||1),this.wingMc.playFile(PATH_EFF+o.inShowEff,-1),this.module.source=""):this.module.source=i,this.playApproachEff(t)},e.prototype.getTarGroup=function(){return[null,this.bodyEff,this.weaponEff,this.wingEff][this.itemData.pos]},e.prototype.playApproachEff=function(t){if(!this.approachDic[t]&&this.itemData.suitid){var e=DataCenter.ins().FashionSuitConfig[this.itemData.suitid];if(e.isShowApproachEff){var i=e.approachEff[t];if(i){var n=this.getTarGroup(),o=function(t){t&&egret.Tween.get(t).to({alpha:0},500).call(function(){DisplayUtils.removeFromParent(t),t.alpha=1}),egret.Tween.get(n).to({alpha:1},500)};this.removeApproachEff(),n.alpha=0,this.playEffArr(i.concat(),o)}}}},e.prototype.playEffArr=function(t,e){var i=this;0==t.length?e(this.approachEff):(this.approachEff=this.approachEff||new GameMovieClip,this.approachEff.alpha=1,this.approachEff.dispose(),this.approachAct.addChild(this.approachEff),this.approachEff.playFile(PATH_EFF+t[0],1,function(){1==t.length?e&&e(i.approachEff):(t.shift(),i.playEffArr(t,e))},!1))},e.prototype.removeApproachEff=function(){var t=this.getTarGroup();t.alpha=1,egret.Tween.removeTweens(t),this.approachEff&&this.approachEff.dispose(),DisplayUtils.removeFromParent(this.approachEff)},e.prototype.filterAttrStr=function(t){for(var e=[],i=0;i<t.length;i++)(2==t[i].type||4==t[i].type||5==t[i].type||6==t[i].type)&&e.push(t[i]);return e},e.prototype.onTap=function(t){t.currentTarget==this.boyOrGirlBtn?this.setSex(this.boyOrGirlBtn.selected?0:1):UIMgr.ins().open(FashionView,0,this.itemData.pos-1,this.itemData.id)},e.prototype.otherClose=function(t){t.target!=this.boyOrGirlBtn&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(FashionTipsView.prototype,"FashionTipsView");var FuncNoticeTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FuncNoticeTipsViewSkin"},e.prototype.showWin=function(t){this.curConfig=e.getFuncNoticeConfigById(t);var i=this.curConfig.openLv;t==i?this.sureBtn.icon="yg_002":this.sureBtn.icon="yg_001",this.bodyImg.source="yg_"+this.curConfig.index+"_png",this.txt.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("boxOpenDesc2",i)),this.addEventTouchTap(this.sureBtn,this.onTouch)},e.prototype.onTouch=function(t){var e=t.target;if("yg_002"==e.icon){var i=this.curConfig.openPanel[0].toString(),n=this.curConfig.openPanel[1];GuideControl.guidance(i,n)}this.removeEventTouchTap(this.sureBtn,this.onTouch),UIMgr.ins().close(this)},e.getFuncNoticeConfigById=function(t){var e=DataCenter.ins().TrailerConfig;
for(var i in e)if(e[i].openLv>=t)return e[i];return null},e}(BaseEuiView);__reflect(FuncNoticeTipsView.prototype,"FuncNoticeTipsView");var GoodEquipTipsPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GoodEquipTipsPanelSkin",e.isUsing=!1,e.horizontalCenter=0,e.bgMc=new GameMovieClip,e.bgMc.x=142,e.bgMc.y=58,e.bgMc.touchEnabled=!1,e.addChild(e.bgMc),e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{set:function(t){if(this.bgMc.playFile(PATH_EFF+"tekuangeff",1,null,!1),this.item.isShowName(!1),t instanceof ItemData){var e=ItemUtils.getQuality(t.itemConfig);this.item.showNum(!0),this.item.data=t,4==e?(this.desc.text=LangMgr.getValueByKey("tipsTips1"),this.itemName.visible=!0):5==e&&(this.desc.text=LangMgr.getValueByKey("tipsTips1"),this.itemName.visible=!0),7==ItemUtils.getType(t.itemConfig)&&(this.desc.text=LangMgr.getValueByKey("boxConGet1","")),this.itemName.text=t.itemConfig.name,this.itemName.textColor=LangMgr.getColor("qualityColor"+e)}},enumerable:!0,configurable:!0}),e}(BasePanel);__reflect(GoodEquipTipsPanel.prototype,"GoodEquipTipsPanel");var GoodHeartTipsPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GoodHeartTipsPanelSkin",e.isUsing=!1,e.horizontalCenter=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{set:function(t){var e=DataCenter.ins().ItemConfig[t];this.item.setItemImg(e.icon+"_png"),this.item.isShowJob(!1),this.item.setImgBg(ItemUtils.getQuality(e));var i=ItemUtils.getQualityColor(e);this.desc.textFlow=TextUtils.generateTextFlow1("C:"+i+"&T:"+e.name),this.itemName.visible=!1,this.item.isShowName(!1),this.item.showNum(!1)},enumerable:!0,configurable:!0}),e}(BasePanel);__reflect(GoodHeartTipsPanel.prototype,"GoodHeartTipsPanel");var GoodItemTipsPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GoodItemTipsPanelSkin",e.isUsing=!1,e.horizontalCenter=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{set:function(t){var e=DataCenter.ins().ItemConfig[t];this.item.setItemImg(e.icon+"_png"),this.item.isShowJob(!1),this.item.setImgBg(ItemUtils.getQuality(e)),this.desc.text=e.name,this.skillName.visible=!1,this.item.isShowName(!1),this.item.showNum(!1)},enumerable:!0,configurable:!0}),e}(BasePanel);__reflect(GoodItemTipsPanel.prototype,"GoodItemTipsPanel");var GoodRewardTipsPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GoodItemTipsPanelSkin",e.isUsing=!1,e.horizontalCenter=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{set:function(t){if(t)switch(t.id){case 2:this.desc.text=LangMgr.getValueByKey("charItemYB",""),this.skillName.text=""+t.count,this.item.setItemImg(Currency.getCurrencyRes(t.id)),this.item.isShowName(!1),this.item.showNum(!1),this.item.isShowJob(!1)}},enumerable:!0,configurable:!0}),e}(BasePanel);__reflect(GoodRewardTipsPanel.prototype,"GoodRewardTipsPanel");var GoodSkillTipsPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="GoodItemTipsPanelSkin",e.isUsing=!1,e.horizontalCenter=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{set:function(t){var e=new SkillVo(t);this.item.setItemImg(e.icon),this.skillName.text=e.name,this.skillName.textColor=ColorUtils.RED,this.item.isShowName(!1),this.item.showNum(!1)},enumerable:!0,configurable:!0}),e}(BasePanel);__reflect(GoodSkillTipsPanel.prototype,"GoodSkillTipsPanel");var HintTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="HintTipsItemRendererSkin",e.lab.visible=!1,e.bg.visible=!1,e}return __extends(e,t),e.prototype.setTips=function(t){var e=this;this.pic.source=t+"_png",this.pic.alpha=0,this.pic.y=0;var i=egret.Tween.get(this.pic);i.to({alpha:1},500).wait(3e3).to({alpha:0},200).call(function(){DisplayUtils.removeFromParent(e)},this)},e}(BasePanel);__reflect(HintTipsItemRenderer.prototype,"HintTipsItemRenderer");var HookRewardTipsView=function(t){function e(){var e=t.call(this)||this;return e.showType=0,e.skinName="HookRewardTipsViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.showType=t[0]?t[0]:0,this.addCustomEvent(483,this.update),this.update(),this.addEventTouchTap(this,this.onTap),TimerMgr.ins().doTimer(3e3,1,this.playTween,this)},e.prototype.playTween=function(){var t=this,e=egret.Tween.get(this.mainGroup);e.to({scaleX:0,scaleY:0,horizontalCenter:170,top:52},500).call(function(){UIMgr.ins().close(t)})},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];copyControl.showAni=!1,this.removeEventTouchTap(this,this.onTap),TimerMgr.ins().remove(this.playTween,this),egret.Tween.removeTweens(this.mainGroup),egret.Tween.removeTweens(this),TimerMgr.ins().removeAll(this)},e.prototype.onTap=function(t){this.removeEventTouchTap(this,this.onTap),TimerMgr.ins().remove(this.playTween,this),this.playTween()},e.prototype.update=function(){TimerMgr.ins().remove(this.onDouble,this);var t=spokesPersonDoubleExpControl.getLeftTime()>0;t&&(TimerMgr.ins().doTimer(1e3,0,this.onDouble,this),this.onDouble()),this.doubleExpGroup.visible=t,copyControl.expEff==copyControl.expEffLast?this.groupExp.visible=!1:(this.groupExp.visible=!0,this.curExp.text=copyControl.expEffLast*(t?2:1)+"",this.nextExp.text=copyControl.expEff*(t?2:1)+""),copyControl.goldEff==copyControl.goldEffLast?this.groupGold.visible=!1:(this.groupGold.visible=!0,this.curMoney.text=copyControl.goldEffLast+"",this.nextMoney.text=copyControl.goldEff+""),this.showType?(this.groupGold.visible=this.groupExp.visible=!1,this.groupInfoGold.visible=this.groupInfoExp.visible=!0,this.nextInfoExp.textFlow=TextUtils.generateTextFlow("|C:"+(t?16750848:2146336)+"&T:"+copyControl.expEff*(t?2:1)+"|"),this.nextInfoMoney.text=copyControl.goldEff+"",this.descTxt.text=LangMgr.getValueByKey("efficiencyLevel")):(this.groupGold.visible=this.groupExp.visible=!0,this.groupInfoGold.visible=this.groupInfoExp.visible=!1,this.descTxt.text=LangMgr.getValueByKey("efficiencyLevelUp"))},e.prototype.onDouble=function(){var t=spokesPersonDoubleExpControl.getLeftTime();t>0?this.doubleExpTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_10):(this.doubleExpGroup.visible=!1,TimerMgr.ins().remove(this.onDouble,this),this.update())},e}(BaseEuiView);__reflect(HookRewardTipsView.prototype,"HookRewardTipsView");var ItemGainTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ItemGainTipsViewSkin",this.gainList.itemRenderer=ItemGainTipsItemRenderer},e.prototype.open=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];t.prototype.open.call(this,e);var n=DataCenter.ins().PropsGainConfig[this.itemConfig.id];n&&(this.addEventItemTap(this.gainList,this.onTouchList),this.gainList.dataProvider=new eui.ArrayCollection(n.gainWay),this.gainList.validateNow())},e.prototype.onTouchList=function(t){UIMgr.ins().close(this);var e=t.item;null!=t.item&&e[1]&&UIMgr.ins().open(e[1],e[2])},e}(ItemTipsView);__reflect(ItemGainTipsView.prototype,"ItemGainTipsView");var AmuseTarget11Panel1=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget11Panel1Skin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!this._init){var i=DataCenter.ins().AmusementBtnConfig[this.activityID];this.rewardList.itemRenderer=i.listItem?egret.getDefinitionByName(i.listItem[0]):NewYearHighRewardItemRender,this.projectList.itemRenderer=i.listItem?egret.getDefinitionByName(i.listItem[1]):NewYearHighProjectItemRender;var n=DataCenter.ins().AmusementConfig[this.activityID];this.actInfo1.text=n.desc,this.addCustomEvent(392,this.updateData),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this.updateData(),this._init=!0}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents(),TimerMgr.ins().removeAll(this),this._init=!1},e.prototype.updateData=function(){var t=amusementControl.activityData[this.activityID];if(t){var e=Object.keys(DataCenter.ins().Amusement11_1Config[this.activityID]).length,i=0,n=[];n.length=e;var o,s;for(s=1;e>=s;s++)o=DataCenter.ins().Amusement11_1Config[this.activityID][s],i=t.rewardInfo>>s&1?2:t.gethiScore()>=o.score?1:0,n[s-1]={activityID:this.activityID,index:s,state:i,config:o};this._rewardCollect||(this._rewardCollect=new ArrayCollection,this.rewardList.dataProvider=this._rewardCollect),this._rewardCollect.source=n,e=Object.keys(DataCenter.ins().Amusement11_2Config[this.activityID]).length;var r;n=[],n.length=e;var a=0;for(s=0;e>s;s++){var l=t.achieveInfo[s];r=DataCenter.ins().Amusement11_2Config[this.activityID][s+1],n[s]={config:r,times:l.times};var h=Math.floor(l.times/r.target),u=Math.floor(r.dayLimit/r.target);h>u&&(h=u),a+=r.score*h}this._achieveCollect||(this._achieveCollect=new ArrayCollection,this.projectList.dataProvider=this._achieveCollect),this._achieveCollect.source=n,this.totalScore.text=LangMgr.getValueByKey("osaCurrScore")+a,this.setTime()}},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID];t&&(this.actTime1.text=t.getRemainTime())},e}(BasePanel);__reflect(AmuseTarget11Panel1.prototype,"AmuseTarget11Panel1");var ItemUseTipsView=function(t){function e(){var e=t.call(this)||this;return e.maxNum=0,e.bossBoxIdList=[230001,230002,230003],e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ItemUseTipsViewSkin",this.numLabel.restrict="0-9",this.itemIcon.imgJob.visible=!1,this.isTopLevel=!0,this.showNoBtn=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._data=t[0],this.showNoBtn=t[1],this.goodsId=this._data.configID,this.addEventTouchEnd(this.BG,this.otherClose),this.addEventTouchEnd(this.minBtn,this.onTap),this.addEventTouchEnd(this.maxBtn,this.onTap),this.addEventTouchEnd(this.sub1Btn,this.onTap),this.addEventTouchEnd(this.add1Btn,this.onTap),this.addEventTouchEnd(this.useBtn,this.onTap),this.addEventTouchEnd(this.useBtn0,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(273,this.useSuccess),this.addCustomEvent(267,this.itemChange),this.addCustomEvent(268,this.itemChange),this.addCustomEvent(664,this.itemChange),this.addCustomEvent(107,this.itemChange),this.addCustomEvent(664,this.itemChange),this.addEventChange(this.numLabel,this.onTxtChange),this.setData(this._data),this.itemList.itemRenderer=ItemBase,void 0!=this.showNoBtn&&(this.useBtn.visible=!this.showNoBtn,this.useLabel.visible=this.showNoBtn),this.add.visible=25!=ItemUtils.getType(this._data.itemConfig),this.checkDanTime()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this.BG,this.otherClose),this.removeEventTouchEnd(this.minBtn,this.onTap),this.removeEventTouchEnd(this.maxBtn,this.onTap),this.removeEventTouchEnd(this.sub1Btn,this.onTap),this.removeEventTouchEnd(this.add1Btn,this.onTap),this.removeEventTouchEnd(this.useBtn,this.onTap),this.removeEventTouchEnd(this.useBtn0,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents(),this._data=null},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onTxtChange=function(t){var e=Number(this.numLabel.text);e>this.maxNum?e=this.maxNum:0>=e&&(e=this.maxNum>0?1:0),this.useNum=e,this.numLabel.text=this.useNum+""},e.prototype.onTap=function(t){switch(t.target){case this.minBtn:this.maxNum>0&&(this.useNum=1);break;case this.maxBtn:this.useNum=this.maxNum;break;case this.sub1Btn:this.useNum--,this.useNum<=0&&(this.maxNum>0?this.useNum=1:this.useNum=0);break;case this.add1Btn:this.useNum++,this.useNum>this.maxNum&&(this.useNum=this.maxNum);break;case this.useBtn:Number(this.numLabel.text)<=0&&this.maxNum>0&&(this.numLabel.text="1"),this.onUse();break;case this.useBtn0:this.onBack();break;case this.bgClose:UIMgr.ins().close(this)}this.numLabel.text=this.useNum+""},e.prototype.onUse=function(){var t=this._data.itemConfig;if(t.id==DataCenter.ins().FeatherCommonConfig.attrPillId||t.id==DataCenter.ins().FeatherCommonConfig.flyPillId)return featherControl.userDans(t.id),void UIMgr.ins().close(this);if(205612==t.id)return UIMgr.ins().close(this),void UIMgr.ins().open(SpokesPersonView,SpokesmanActID.achiTask);if(this.checkCanMerge())return this.onMerge(),void UIMgr.ins().close(this);var e=ItemUtils.getType(t);if(2==e)return UIMgr.ins().open(SkillView,3),UIMgr.ins().close(this),void esotericaControl.dispatchBagUseMiji(t.id);if(10==e)return this.onUseType10(),void UIMgr.ins().close(this);if(13==e)return this.onUseType13(),void UIMgr.ins().close(this);if(14==e)return this.onUseType14(),void UIMgr.ins().close(this);if(20==e&&!superRingControl.checkCanUseByItem(t.id))return tipsControl.showTips(LangMgr.getValueByKey("equiFireDes")),void UIMgr.ins().close(this);if(200155==t.id&&payControl.isFisrtCharge())return tipsControl.showTips(LangMgr.getValueByKey("equiPayAny")),UIMgr.ins().close(this),void UIMgr.ins().open(PayFirstView);if(t.id==DataCenter.ins().EsotericaBaseConfig.lockId)return UIMgr.ins().close(this),void UIMgr.ins().open(EsotericaLockView,EsotericaControl.BAGOPEN);if(9==e)return UIMgr.ins().close(this),void UIMgr.ins().open(ExperienceView,3);if(t.needyuanbao&&ActorControl.yb<t.needyuanbao)return tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),void UIMgr.ins().close(this);if(8==e){var i=t.level?t.level:0,n=t.zsLevel?t.zsLevel:0;if(ActorControl.level>=i&&reincarnateControl.lv>=n);else{var o="";reincarnateControl.lv<n&&(o+=LangMgr.getValueByKey("numberRotation",n)),ActorControl.level<i&&(o+=LangMgr.getValueByKey("numberLevel",i)),tipsControl.showTips(LangMgr.getValueByKey("equiAfterUse",o))}}if(25==e)return bargainControl.upOpenAuBox(t.id),void UIMgr.ins().close(this);if(47==e){if(!backpackControl.isDanRechargeEnd(t.id)){var s=t.useArg;if(s&&s.jump)return 1==s.jump.length?UIMgr.ins().open(s.jump[0]):UIMgr.ins().open(s.jump[0],s.jump[1]),void UIMgr.ins().close(this)}return UIMgr.ins().close(this),void backpackControl.upUseItem(this.goodsId,this.useNum,0)}(!backpackControl.upUseItem(this.goodsId,this.useNum)||t.split)&&UIMgr.ins().close(this)},e.prototype.onUseType10=function(){for(var t=this._data.itemConfig,e=200013==t.id?0:1,i=0;i<GlobalModel.roleNum;i++){var n=heroControl.getSubRoleByIndex(i);if(!n){tipsControl.showTips(LangMgr.getValueByKey("equiNoUseNoOpen"));break}var o=heroControl.getSubRoleByIndex(i).getExRingsData(e);if(0>=o){UIMgr.ins().open(RoleView,0,i),UIMgr.ins().close(this);break}}},e.prototype.onUseType13=function(){var t=this._data.itemConfig,e=0,i=0,n=-1,o=!1;switch(t.useType){case 5:n=t.useArg.type,e=bossControl.worldBossLeftTime[n],i=DataCenter.ins().WorldBossBaseConfig.dayCount[n-1]||0;break;case 15:n=t.useArg.type,e=bossControl.worldBossBelongTime[n],i=DataCenter.ins().WorldBossBaseConfig.belongCount[n-1]||0,o=!0;break;case 8:e=godWeaponControl.dunInfoData.leftChallengeNum;break;case 9:e=copyControl.fbRings.challengeTime;break;case 13:e=crossBossControl.bossTimes,i=DataCenter.ins().CrossBossBaseConfig.bossBelongCount,o=!0;break;case 14:e=crazybtplayCopyControl.belongTimes,i=DataCenter.ins().CrazybtplayBossBaseConfig.maxEnterCount;break;default:return void tipsControl.showTips(LangMgr.getValueByKey("equiErrorPicUse"))}e>0?tipsControl.showTips(o?LangMgr.getValueByKey("wuguishucscan",t.name):LangMgr.getValueByKey("wutiaozhancscan",t.name)):(i>0&&this.useNum>i&&(this.useNum=i),tipsControl.showTips(o?LangMgr.getValueByKey("usesucgetgscs",this.useNum,t.name):LangMgr.getValueByKey("equiUseSucessTimes",this.useNum,t.name)),backpackControl.upUseItem(this.goodsId,this.useNum),n>-1&&bossControl.upWorldBossInfo(n))},e.prototype.onUseType13_300=function(){var t=copyControl.fbRings.challengeTime;return t>0?void tipsControl.showTips(LangMgr.getValueByKey("equiNoTimeUse","")):(tipsControl.showTips(LangMgr.getValueByKey("equiGetFireTime",this.useNum)),void backpackControl.upUseItem(this.goodsId,this.useNum))},e.prototype.onUseType13_302=function(){var t=godWeaponControl.dunInfoData.leftChallengeNum;return t>0?void tipsControl.showTips(LangMgr.getValueByKey("equiNoTimeUse","")):(tipsControl.showTips(LangMgr.getValueByKey("equiGetGodTime",this.useNum)),void backpackControl.upUseItem(this.goodsId,this.useNum))},e.prototype.onUseType14=function(){UIMgr.ins().open(RenameView)},e.prototype.onMerge=function(){var t=this._data.itemConfig,e=t.id,i=this._data.count,n=DataCenter.ins().ItemComposeConfig[e];return n.srcCount>i?void tipsControl.showTips(LangMgr.getValueByKey("equiNoTogther")):void backpackControl.upMergeItem(e,i)},e.prototype.onBack=function(){var t=this._data.itemConfig;10==ItemUtils.getType(t)?backpackControl.upUseItem(this.goodsId,this.useNum):backpackControl.upUseItem(this.goodsId,this.useNum)||UIMgr.ins().close(this)},e.prototype.useSuccess=function(){var t=backpackControl.getBagItemById(this.goodsId);t?(this.setData(t),this.onTxtChange(null)):UIMgr.ins().close(this)},e.prototype.itemChange=function(){var t=backpackControl.getBagItemById(this.goodsId);t?(this.setData(t),this.onTxtChange(null)):UIMgr.ins().close(this)},e.prototype.updateState=function(){var t=this._data,e=ItemUtils.getType(t.itemConfig);this.checkCanMerge()?this.currentState="rename":2==e?this.currentState="2":10==e?this.currentState="10":12==e?this.currentState="guildgifts":14==e?this.currentState="rename":205612==t.itemConfig.id?this.currentState="rename":this.currentState="2"},e.prototype.checkCanMerge=function(){var t=this._data,e=t.itemConfig.id;return!!DataCenter.ins().ItemComposeConfig[e]},e.prototype.updateBaseInfo=function(t){var e=this._data;t.count=t.count?t.count:1;var i=t.count+"",n=e.itemConfig;this.nameLabel.text=n.name,this.nameLabel.textColor=ItemUtils.getQualityColor(n),this.quaImg.source="quali"+ItemUtils.getQuality(n),this.itemIcon.setData(n),this.lv.text=LangMgr.getValueByKey("numberLevel",n.level||1),this.num.text=i,this.description.textFlow=TextUtils.generateTextFlow(n.desc)},e.prototype.updateUse=function(){var t=this._data;this.maxNum=t.count,this.useBtn.enabled=!0;var e=DataCenter.ins().ItemUseLimitConfig[t.configID];if(e){var i=backpackControl.useLimitData[t.configID]||0,n=e.uselimit[vipControl.lv]||0;if(n>i)this.useLimit.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("todayuseuplimit")+("|C:"+ColorUtils.GREEN+"&T:"+(n-i)+"|"));else{var o=backpackControl.getNextVipCount(t.configID,vipControl.lv);o?(this.useLimit.textFlow=TextUtils.generateTextFlow("|C:"+ColorUtils.RED+"&T:"+vipControl.getVipStr(o.vip)+"|"+LangMgr.getValueByKey("extusecs",o.addCount)),this.useBtn.enabled=!1):(this.useLimit.textFlow=TextUtils.generateTextFlow("|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("todayusecsalrup")),this.useBtn.enabled=!1)}n-i<this.maxNum&&(this.maxNum=n-i)}else this.useLimit.text="";this.useNum=this.maxNum,this.numLabel.text=this.useNum+""},e.prototype.updateHandlePos=function(){this._data},e.prototype.setData=function(t){this._data=t;var e=this._data.itemConfig;this.updateState(),this.updateBaseInfo(t);var i=ItemUtils.getType(e);2==i?this.updateType2():10==i&&this.updateType10(),this.checkCanMerge()?this.useBtn.label=LangMgr.getValueByKey("equiHC"):e.needyuanbao&&(this.useBtn.label=LangMgr.getValueByKey("charItemYB",e.needyuanbao)),this.updateUse(),this.updateHandlePos(),this.updateGuildGift(e)},e.prototype.updateType2=function(){},e.prototype.updateGuildGift=function(t){var e=DataCenter.ins().ItemGiftConfig[t.id];e&&(this.itemList.dataProvider=new eui.ArrayCollection(e.awards))},e.prototype.updateType10=function(){var t=this._data.itemConfig,e=0;if(heroControl.subRolesLen==GlobalModel.roleNum)for(var i=200013==t.id?0:1,n=0;n<GlobalModel.roleNum;n++){var o=heroControl.getSubRoleByIndex(n);if(o){var s=heroControl.getSubRoleByIndex(n).getExRingsData(i);s>0&&(e+=1)}}e==GlobalModel.roleNum?(this.useBtn0.horizontalCenter=0,this.useBtn.visible=!1):(this.useBtn0.horizontalCenter=-90,this.useBtn.visible=!0)},e.prototype.checkDanTime=function(){TimerMgr.ins().remove(this.onRepeat,this);var t=this._data.itemConfig,e=ItemUtils.getType(t);this.timeTxt.visible=!1,47==e&&(backpackControl.isDanRechargeEnd(t.id)?this.timeTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("usedaojutimeendTips")):(TimerMgr.ins().doTimer(1e3,0,this.onRepeat,this),this.onRepeat()),this.timeTxt.visible=!0)},e.prototype.onRepeat=function(){var t=backpackControl.getDanActivity(DataCenter.ins().ItemConfig[this._data.itemConfig.id].useArg.actId);t?this.timeTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("usedaojutimenoendTips")+DateUtils.getFormatBySecond(Math.floor((DateUtils.formatMiniDateTime(t.endTime)-GameServer.serverTime)/1e3),DateUtils.TIME_FORMAT_1)+"|"):(TimerMgr.ins().remove(this.onRepeat,this),this.timeTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("usedaojutimeendTips")))},e}(BaseEuiView);__reflect(ItemUseTipsView.prototype,"ItemUseTipsView");var LinkTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.liftTime=5e3,e.skinName="LinkTipsItemRendererSkin",e.lab.stroke=1,e.lab.strokeColor=0,e.lab0.textFlow=TextUtils.generateTextFlow1("|U:&C:0x00ff00&E:SmeltEquipView&T:"+LangMgr.getValueByKey("smeltMy")+"|"),e}return __extends(e,t),Object.defineProperty(e.prototype,"labelText",{set:function(t){this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow1(this._labelText),this.bg.touchEnabled=this.lab.touchEnabled=this.touchEnabled=!1,this.bg.visible=!0,this.lab0.touchEnabled=!0,this.addToEvent||(this.addToEvent=!0,TimerMgr.ins().doTimer(this.liftTime,1,this.removeFromParent,this))},enumerable:!0,configurable:!0}),e.prototype.linkClick=function(t){var e=t.text.split(","),i=e.slice(1);e[0]&&(isNaN(Number(e[0]))?UIMgr.ins().open(e[0],i[0]?i:null):CommonFun.viewItemTips(+e[1],+e[2]))},e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.addEventTextLink(this.lab0,this.linkClick)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.removeEventTextLink(this.lab0,this.linkClick)},e}(TipsItemRenderer);__reflect(LinkTipsItemRenderer.prototype,"LinkTipsItemRenderer");var LinkTipsView=function(t){function e(){var e=t.call(this)||this;return e.linkList=[],e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.touchEnabled=!1},e.prototype.showLinkTips=function(t){var e=t.str,i=t.maxLen,n=ObjectPool.pop("LinkTipsItemRenderer");if(n.bottom=DataCenter.ins().ClientGlobalConfig.gotoPosTips.bottom,n.horizontalCenter=DataCenter.ins().ClientGlobalConfig.gotoPosTips.horizontalCenter,n.labelText=e,this.addChild(n),this.linkList.unshift(n),!isNaN(i)&&this.linkList.length>i)for(var o=0;this.linkList.length>i;o++){var s=this.linkList.pop();this.removeLink(s)}if(this.linkList.length){this.addEventRemovedFromStage(n,this.removeLinkTip);for(var o=this.linkList.length-1;o>=0;o--)this.linkList[o].bottom=n.bottom+37*o}},e.prototype.removeLinkTip=function(t){this.removeLink(t.currentTarget)},e.prototype.removeLink=function(t){var e=this.linkList.indexOf(t);-1!=e&&this.linkList.splice(e,1),t.horizontalCenter=0/0,t.bottom=0/0,this.removeEventRemovedFromStage(t,this.removeLinkTip),ObjectPool.push(t),DisplayUtils.removeFromParent(t)},e}(BaseEuiView);__reflect(LinkTipsView.prototype,"LinkTipsView");var PowerPromoteTipsView=function(t){function e(){var e=t.call(this)||this;return e.defaultValue=0,e.isShowLog=!1,e.uilayer=GameLayer.TIPS,e.touchEnabled=e.touchChildren=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.gp=new eui.Group,this.gp.width=580,this.gp.height=930,this.addChild(this.gp),this.gp.horizontalCenter=40,this.gp.bottom=-100,this.horizontalCenter=0,this.imgBg=new eui.Image,this.imgBg.source="zhandoulibg",this.imgBg.x=50,this.imgBg.y=438,this.gp.addChild(this.imgBg),this.imgBg.alpha=1,this.imgBg.touchEnabled=!1,this.img=new eui.Image,this.img.source="zjmzhandouli",this.img.x=100,this.img.y=450,this.gp.addChild(this.img),this.img.alpha=1,this.img.touchEnabled=!1,this.sp=new egret.Sprite,this.sp.x=180,this.sp.y=474,this.gp.addChild(this.sp),this.lastTime=0,this.lastPower=0,this.clearShow()},e.prototype.showPowerPromote=function(t){this.defaultValue=t,0==this.lastPower&&(this.lastPower=t),TimerMgr.ins().doTimer(500,1,this.delayPowerUp,this)},e.prototype.clearShow=function(){this.sp.removeChildren(),egret.Tween.removeTweens(this.img),this.img.visible=!1,egret.Tween.removeTweens(this.imgBg),this.imgBg.visible=!1,TimerMgr.ins().removeAll(this)},e.prototype.delayPowerUp=function(){var t=this.lastPower?this.lastPower:this.defaultValue,e=ActorControl.power;e>t&&this.showPowerUp(t,e)},e.prototype.showPowerUp=function(t,e){var i=this;this.clearShow(),this.img.visible=!0,this.img.alpha=1,this.imgBg.visible=!0,this.imgBg.alpha=1;var n=BitmapNumber.ins().createNumPic(t,"8",5);n.x=0,n.y=-17,this.sp.addChild(n);var o=e-t;TimerMgr.ins().doTimer(20,25,function(){var e=o;e+=Math.round(Math.random()*e);var i=t.toString(),s="";s=e.toString().length==i.length?e.toString().slice(1):e+"",i=i.charAt(0),i+=s,BitmapNumber.ins().changeNum(n,i,"8",5)},this,function(){BitmapNumber.ins().changeNum(n,ActorControl.power,"8",5);var t="+"+o,e=BitmapNumber.ins().createNumPic(t,"r0",5);BitmapNumber.ins().changeNum(e,t,"r0",5),e.x=n.x+n.width+10,e.y=n.y+30,i.sp.addChild(e);var s=200,r=2e3;i.lastPower=0;var a=egret.Tween.get(e);a.to({y:e.y-30},s).to({alpha:0},r).call(function(){DisplayUtils.removeFromParent(e)},i);var l=egret.Tween.get(n);l.wait(s).to({alpha:0},r).call(function(){DisplayUtils.removeFromParent(n)},i);var h=egret.Tween.get(i.img);h.wait(s).to({alpha:0},r).call(function(){i.img.visible=!1},i);var u=egret.Tween.get(i.imgBg);u.wait(s).to({alpha:0},r).call(function(){i.imgBg.visible=!1},i)},this)},e}(BaseEuiView);__reflect(PowerPromoteTipsView.prototype,"PowerPromoteTipsView");var PunchEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e._bottomY=0,e._equipPower=0,e._totalPower=0,e.curRole=0,e.index=0,e.gainWay=[],e.skinName="PunchEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e.powerPanel.setBgVis(!1),e.powerPanel0.setBgVis(!1),e.gainWay=[[LangMgr.getValueByKey("equiKillBoss"),"BossView",2],[LangMgr.getValueByKey("equiLimitTime"),"LimitTaskView"]],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.itemIcon.imgJob.visible=!1,this.waylist.itemRenderer=SuperRingGainItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.data=t[0],t[1]?this.changeBtn.visible=!0:this.changeBtn.visible=!1,this.isBagTips=t[2],this.addEventTouchEnd(this.bgClose,this.otherClose),this.addEventTouchEnd(this.changeBtn,this.onEquipChange),this.addEventItemTap(this.waylist,this.onTouchList),this.setData(this.data)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this.bgClose,this.otherClose),this.removeEventTouchEnd(this.changeBtn,this.onEquipChange),this.removeEventItemTap(this.waylist,this.onTouchList)},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);i&&(GuideControl.guidance(e[1],e[2],!0),UIMgr.ins().close(this))}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onEquipChange=function(t){return this.needCount?void this.onBtn():void tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"))},e.prototype.onBtn=function(){var t;if(this.data instanceof ItemData||this.data.id)t=this.data.configID+10;else{var e=91e4+this.data+1;t=e}for(var i=DataCenter.ins().ItemConfig[t],n=ItemUtils.getSubType(i),o=backpackControl.getHejiEquipsByType(n),s=0,r=0;r<o.length;r++)if(o[r].configID==i.id&&n==ItemUtils.getSubType(o[r].itemConfig)){s=o[r].handle;break}if(!s)return void tipsControl.showTips(LangMgr.getValueByKey("equiHandError"));var a=i.level?i.level:0,l=i.zsLevel?i.zsLevel:0;return l>reincarnateControl.lv||a>ActorControl.level?void tipsControl.showTips(LangMgr.getValueByKey("equiRuneNeed",l,a)):(UIMgr.ins().close(this),void skillControl.upDressHejiEquip(s,n))},e.prototype.setData=function(t){var e;if(t instanceof ItemData){e=t;var i=DataCenter.ins().EquipConfig[e.configID+10];if(i){var n=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_EQUIP,i.id);n?this.currentState="not_max":this.currentState="not_max_no"}else this.currentState="max"}else{if(t.id)e=new ItemData,e.configID=t.id;else if(t>91e4)e=new ItemData,e.configID=t;else{var o=91e4+t+1;e=new ItemData,e.configID=o}var n=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_EQUIP,e.configID);n&&n.count?this.currentState="unactivated_have":this.currentState="unactivated_no"}this.isBagTips&&(this.currentState="default"),this.validateNow(),this.needCount=0,this.setCurAttrs(e),this.setNextAttrs(e),this.unactivated(e)},e.prototype.unactivated=function(t){if("max"!=this.currentState&&"default"!=this.currentState){var e;e=this.data instanceof ItemData||this.data.id?t.configID+10:t.configID;var i=DataCenter.ins().ItemConfig[e];this.attr0.text=""+i.name,this.attr0.textColor=ItemUtils.getQualityColor(i);var n=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_EQUIP,i.id);n?(this.attr6.text="("+LangMgr.getValueByKey("equiHave")+"×"+n.count+")",this.attr6.textColor=LangMgr.getColor("color43"),this.needCount=n.count):this.attr6.textColor=LangMgr.getColor("color22"),"unactivated_no"==this.currentState||"not_max_no"==this.currentState?this.waylist.dataProvider=new eui.ArrayCollection(this.gainWay):"unactivated_have"==this.currentState&&(this.changeBtn.label=LangMgr.getValueByKey("equiActive"))}},e.prototype.setNextAttrs=function(t){if("not_max"==this.currentState||"not_max_no"==this.currentState){this.changeBtn.label=LangMgr.getValueByKey("equiUpdate");var e=t.configID+10,i=DataCenter.ins().ItemConfig[e],n=DataCenter.ins().EquipConfig[e],o=i;this._totalPower=0,this.nextTile.text=LangMgr.getValueByKey("equiNextLevel")+"("+o.name+")",this.nextTile.textColor=ItemUtils.getQualityColor(o),this.attr7.text=""+o.name,this.attr7.textColor=this.nextTile.textColor;var s=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_EQUIP,i.id);s?(this.attr9.text="("+LangMgr.getValueByKey("equiHave")+"×"+s.count+")",this.attr9.textColor=LangMgr.getColor("color43"),this.needCount=s.count):this.attr9.textColor=LangMgr.getColor("color22");var r=1;this.nextAttr1.visible=!1,this.nextAttr2.visible=!1,this.nextAttr3.visible=!1,this.nextAttr4.visible=!1;var a=n,l=[];if(this.score.visible=!1,t.att){for(var h in AttributeData.translate)if(a[h]&&!(a[h]<=0)){var u=new AttributeData(AttributeData.translate[h],a[h]);for(var p in t.att)if(t.att[p].type==u.type){u.value+=t.att[p].value;break}var c="";c=AttributeData.getAttStrByType(u,0,"  "),l.push(u),this["nextAttr"+r].text=c,this["nextAttr"+r].visible=!0,r++}this._bottomY=this["nextAttr"+(r-1)].y+this["nextAttr"+(r-1)].height}else{for(var h in AttributeData.translate)if(a[h]&&!(a[h]<=0)){var u=new AttributeData(AttributeData.translate[h],a[h]),c="";c=AttributeData.getAttStrByType(u,0,"  "),l.push(u),this["nextAttr"+r].text=c,this["nextAttr"+r].visible=!0,r++}this._bottomY=this["nextAttr"+(r-1)].y+this["nextAttr"+(r-1)].height}if(a.baseAttr1){var d=new AttributeData(a.baseAttr1.type,a.baseAttr1.value);l.push(d)}if(a.baseAttr2){var d=new AttributeData(a.baseAttr2.type,a.baseAttr2.value);l.push(d)}for(this._equipPower=Math.floor(BackpackControl.getAttrPower(l)),this._totalPower+=this._equipPower+(a.exPower||0),this._totalPower*=heroControl.subRolesLen,this.score.text=LangMgr.getValueByKey("wingPingfen",this._totalPower);this.nextForgeGroup.numElements;)this.nextForgeGroup.removeChildAt(0);
this.addTips(a,this.nextForgeGroup),this.background.height=this._bottomY+12,this.powerPanel0.setPower(this._totalPower)}},e.prototype.setCurAttrs=function(t){var e=t.itemConfig;this._totalPower=0,this.nameLabel.text=e.name,this.nameLabel.textColor=ItemUtils.getQualityColor(e);var i=ItemUtils.getQuality(e);this.quali.source=i>0?"quali"+i:"",this.itemIcon.setData(e),(t instanceof ItemData||null!=e)&&t&&5==ItemUtils.getType(t.itemConfig)&&(this.levelKey.text=e.zsLevel>0?LangMgr.getValueByKey("equiRotation"):LangMgr.getValueByKey("equiLevel"),this.type.text=RoleModel.getHejiEquipNameByType(ItemUtils.getSubType(e)),this.lv.text=e.zsLevel>0?LangMgr.getValueByKey("numberRotation",e.zsLevel):LangMgr.getValueByKey("numberLevel",e.level),e.zsLevel>0?this.lv.textColor=reincarnateControl.lv<e.zsLevel?ColorUtils.RED:ColorUtils.GREEN:this.lv.textColor=ActorControl.level<(e.level||1)?ColorUtils.RED:ColorUtils.GREEN);var n=1;this.attr1.visible=!1,this.attr2.visible=!1,this.attr3.visible=!1,this.attr4.visible=!1;var o=DataCenter.ins().EquipConfig[t.configID],s=[];if(this.score.visible=!1,t.att){for(var r in AttributeData.translate)if(o[r]&&!(o[r]<=0)){var a=new AttributeData(AttributeData.translate[r],o[r]);for(var l in t.att)if(t.att[l].type==a.type){a.value+=t.att[l].value;break}var h="";h=AttributeData.getAttStrByType(a,0,"  "),s.push(a),this["attr"+n].text=h,this["attr"+n].visible=!0,n++}this._bottomY=this["attr"+(n-1)].y+this["attr"+(n-1)].height}else{for(var r in AttributeData.translate)if(o[r]&&!(o[r]<=0)){var a=new AttributeData(AttributeData.translate[r],o[r]),h=AttributeData.getAttStrByType(a,0,"  ");s.push(a),this["attr"+n].text=h,this["attr"+n].visible=!0,n++}this._bottomY=this["attr"+(n-1)].y+this["attr"+(n-1)].height}if(o.baseAttr1){var u=new AttributeData(o.baseAttr1.type,o.baseAttr1.value);s.push(u)}if(o.baseAttr2){var u=new AttributeData(o.baseAttr2.type,o.baseAttr2.value);s.push(u)}for(this._equipPower=Math.floor(BackpackControl.getAttrPower(s)),this._totalPower+=this._equipPower+(o.exPower||0),this._totalPower*=heroControl.subRolesLen,this.score.text=LangMgr.getValueByKey("wingPingfen",this._totalPower);this.forgeGroup.numElements;)this.forgeGroup.removeChildAt(0);this.addTips(o,this.forgeGroup),this.background.height=this._bottomY+12,this.powerPanel.setPower(this._totalPower),this.next.y=this._bottomY+12},e.prototype.addTips=function(t,e){var i=new eui.Label,n=new eui.Label;if(t.baseAttr1&&(i.parent||this.createTitle(i,n,e),n.text+=AttributeData.getAttStrByType(t.baseAttr1,1,""),this._bottomY=n.y+n.height),t.baseAttr2&&(i.parent||this.createTitle(i,n,e),n.text+=AttributeData.getAttStrByType(t.baseAttr2,1,""),this._bottomY=n.y+n.height),t.exAttr1&&(i.parent||this.createTitle(i,n,e),n.text+=AttributeData.getExtAttStrByType(t.exAttr1,1,""),this._bottomY=n.y+n.height),t.exAttr2&&(n.text=AttributeData.getExtAttStrByType(t.exAttr2,1,""),this._bottomY=n.y+n.height),this.forgeGroup==e){var o=new eui.Label,s=new eui.Label,r=t.id%10,a=skillControl.getPunchForge().getPunchLevel(r-1),l=DataCenter.ins().FocusAttackPunchConfig[r-1][a];l&&(o.parent||this.createTitle(o,s,e,LangMgr.getValueByKey("equiZhuAttr")),s.text=AttributeData.getAttStr(l.attr,1,1," "),this._bottomY=s.y+s.height)}},e.prototype.createTitle=function(t,e,i,n){var o=new eui.Group,s=new eui.HorizontalLayout;s.verticalAlign=egret.VerticalAlign.MIDDLE,s.gap=3,o.layout=s,t.size=18,t.textColor=7038294,o.x=34,o.y=this._bottomY+10+14,o.addChild(new eui.Image("jinxian2")),o.addChild(t);var r=new eui.Image("tongyongline");r.horizontalCenter=0,r.y=o.y-15,i.addChild(o),i.addChild(r),t.text=n?n:LangMgr.getValueByKey("equiJpAttr"),e.size=20,e.lineSpacing=8,e.x=36,e.y=o.y+24,e.textColor=14233598,i.addChild(e)},e}(BaseEuiView);__reflect(PunchEquipTipsView.prototype,"PunchEquipTipsView");var RuneTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RuneTipsViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t[0];this.item_config_id=t[1],this.cur_desc=t[2],this.cur_desc2=t[3],this.addEventTouchEnd(this,this.otherClose),this.addEventTouchEnd(this.userBtn,this.onUser),this.setData(this.item_config_id)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.otherClose),this.removeEventTouchEnd(this.userBtn,this.onUser)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onUser=function(t){var e=runeControl.getRuneMergeByID(this.item_config_id);e&&UIMgr.ins().open(BackpackView,3,3,e.mixId[1],runeControl.getMergeIndexByType(e.mixId[1],e.id))},e.prototype.setData=function(t){var e=DataCenter.ins().ItemConfig[t];if(e){this.quali.source="quali"+ItemUtils.getQuality(e),this.itemIcon.setData(e);var i="",n=e.id%100;0==n?this.cur_desc2||(i=" lv."+n):0!=ItemUtils.getSubType(e)&&(i=" lv."+n),this.nameLabel.textFlow=(new egret.HtmlTextParser).parser("<font color = '"+ItemUtils.getQualityColor(e)+"'>"+e.name+i+"</font>"),this.userBtn.visible=!1,runeControl.isOpen()&&runeControl.getRuneMergeByID(e.id)&&(this.userBtn.visible=!0);var o=!1;if(1==ItemUtils.getType(e))this.randomAttr.text=e.desc;else{var s=DataCenter.ins().RuneBaseConfig[t];s?(o=!0,this.attrName.text=runeControl.getcfgAttrData(s),this.attrValue.text=runeControl.getcfgAttrData(s,!1),this.attrName.x=this.runeAttr.width/2-(this.attrName.width+this.attrValue.width)/2,this.attrValue.x=this.attrName.x+this.attrName.width,this.attrDes.textFlow=TextUtils.generateTextFlow1(this.cur_desc)):(this.randomAttr.visible=!0,this.randomAttr.text=e.desc,this.cur_desc2?this.attrDes.text=LangMgr.getValueByKey("equiPassTips",this.cur_desc2):this.attrDes.visible=!1)}this.userBtn.visible&&(this.attrDes.text=""),this.attrName.visible=this.attrValue.visible=o,this.randomAttr.visible=!o}},e}(BaseEuiView);__reflect(RuneTipsView.prototype,"RuneTipsView");var SceneTipsItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),Object.defineProperty(e.prototype,"labelText",{set:function(t){var e=this;this._labelText=t,this.lab.textFlow=TextUtils.generateTextFlow(this._labelText),this.bg.width=this.lab.width,this.bg.visible=!1,this.lab.alpha=1,this.bg.y=0,this.lab.verticalCenter=-1,TimerMgr.ins().doTimer(500,1,function(){DisplayUtils.removeFromParent(e)},this)},enumerable:!0,configurable:!0}),e}(TipsItemRenderer);__reflect(SceneTipsItemRenderer.prototype,"SceneTipsItemRenderer");var AmuseTarget11Panel10=function(t){function e(e){var i=t.call(this)||this;return i.activityID=e,i}return __extends(e,t),e.prototype.close=function(){this._listCollect=null,TimerMgr.ins().removeAll(this),this._init=!1},e.prototype.open=function(){if(!this._init){if(this.setCurSkin(),this.addCustomEvent(392,this.refreshReds),this.addEventTouchTap(this.awardBtn,this.onTouch),this.stars)for(var t=1;t<=this.stars.numElements;t++)this["star"+t]&&this.addEventTouchTap(this["star"+t],this.onTouch);this.leftBtn&&this.addEventTouchTap(this.leftBtn,this.onleftOrRightTouch),this.rightBtn&&this.addEventTouchTap(this.rightBtn,this.onleftOrRightTouch),this.awardList.itemRenderer=ItemBase;var e=DataCenter.ins().AmusementBtnConfig[this.activityID];e&&(this.list.itemRenderer=e.listItem?egret.getDefinitionByName(e.listItem[0]):NationalDayListItemRender),this._curGroupIndex=this.getDirRedPoint(),this._curGroupIndex=this._curGroupIndex>0?this._curGroupIndex-1:0,this.refreshReds(),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this._init=!0}},e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget11Panel10Skin",this.actDesc&&(this.actDesc.textFlow=TextUtils.generateTextFlow1(t.desc))},e.prototype.updateView=function(){var t=amusementControl.getAmusementDataById(this.activityID);if(t){this._items=[];var e=void 0,i=void 0,n=void 0,o=DataCenter.ins().Amusement11_2Config[this.activityID],s=[];for(var r in o)e=o[r],n=e.group,i=this._items[n-1],i||(i=[],this._items[n-1]=i,s.push({gName:e.gName,showRed:!1,group:n,activityID:this.activityID,gNameRes:e.gNameRes})),i.push(e);this.updateStar()}},e.prototype.refreshReds=function(){this.updateView(),this.updateData()},e.prototype.updateData=function(){var t=this._items[this._curGroupIndex];if(t&&t.length){this._listCollect||(this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect);var e=void 0,i=void 0,n=t.length,o=[],s=0,r=amusementControl.getAmusementDataById(this.activityID);if(r){for(var a=0;n>a;a++)e=t[a],i=r.achieveInfo[e.index-1],s=i.isGot?e.againYb&&2!=i.isGot?3:2:i.times>=e.dayLimit?1:0,o[a]={activityID:this.activityID,conf:e,state:s,times:i.times};o.sort(this.sort),this._listCollect.source=o,n=Object.keys(DataCenter.ins().Amusement11_1Config[this.activityID]).length;var l=[];l.length=n;for(var h=void 0,a=1;n>=a;a++)h=DataCenter.ins().Amusement11_1Config[this.activityID][a],s=r.rewardInfo>>a&1?2:r.gethiScore(this._curGroupIndex+1)>=h.score?1:0,l[a-1]=h.reward;if(this._rewardCollect||(this._rewardCollect=new ArrayCollection,this.awardList.dataProvider=this._rewardCollect),this._rewardCollect.source=l[this._curGroupIndex],this.awardList.validateNow(),this.itemNameLabel&&(this.itemNameLabel.text=DataCenter.ins().ItemConfig[l[this._curGroupIndex][0].id].name),this.taskLabel){var u=DataCenter.ins().Amusement11_1Config[this.activityID][this._curGroupIndex+1];this.taskLabel.textFlow=TextUtils.generateTextFlow1(r.gethiScore(this._curGroupIndex+1)+"/"+u.score)}this.redPointImg&&(this.redPointImg.visible=r.checkPhaseAward(this._curGroupIndex+1)),this.awardBtn&&(this.awardBtn.visible=!0,r.rewardInfo>>this._curGroupIndex+1&1?this.awardBtn.visible=!1:this._curGroupIndex&&!r.IsPreCondition(this._curGroupIndex-1+1)&&(this.redPointImg.visible=!1),this.taskStatusImg.visible=!this.awardBtn.visible),this.taskStep.text=""+(this._curGroupIndex+1)}}},e.prototype.sort=function(t,e){return 1==t.state&&1!=e.state?-1:1!=t.state&&1==e.state?1:3==t.state&&3!=e.state?-1:3!=t.state&&3==e.state?1:2==t.state&&2!=e.state?1:2!=t.state&&2==e.state?-1:t.conf.index<e.conf.index?-1:t.conf.index>e.conf.index?1:0},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.awardBtn:var e=amusementControl.getAmusementDataById(this.activityID),i=this._curGroupIndex+1,n=DataCenter.ins().Amusement11_1Config[this.activityID][this._curGroupIndex+1];if(e.gethiScore(i)>=n.score){if(!e.IsPreCondition(i))return void tipsControl.showTips(LangMgr.getValueByKey("getbigAwCanGet"));amusementControl.upReward(this.activityID,i,1)}else tipsControl.showTips(LangMgr.getValueByKey("taskAwNoGet"));break;default:for(var o=1;o<=this.stars.numElements;o++)this["star"+o]&&t.currentTarget==this["star"+o]&&(this._curGroupIndex=o-1,this.updateData(),this.updateView())}},e.prototype.onleftOrRightTouch=function(t){switch(t.target){case this.leftBtn:this._curGroupIndex>0&&(this._curGroupIndex--,this.refreshReds());break;case this.rightBtn:var e=Object.keys(DataCenter.ins().Amusement11_1Config[this.activityID]).length;this._curGroupIndex<e-1&&(this._curGroupIndex++,this.refreshReds())}},e.prototype.updateStar=function(){var t=amusementControl.getAmusementDataById(this.activityID);if(t&&this.stars)for(var e=1;e<=this.stars.numElements;e++){var i=DataCenter.ins().Amusement11_1Config[this.activityID][e],n=t.getProcessByGroup(e),o=this.getDirRedPoint(e-1);this["star"+e].data={config:i,percent:n[2],redPoint:o,select:this._curGroupIndex==e-1}}else if(t&&this.leftBtn&&this.rightBtn){var s=Object.keys(DataCenter.ins().Amusement11_1Config[this.activityID]).length;this.leftGroup&&(this.leftGroup.visible=this._curGroupIndex>0),this.rightGroup&&(this.rightGroup.visible=this._curGroupIndex<s-1);var r=this.getDirRedPoint();this.leftRed.visible=this._curGroupIndex>r-1,this.rightRed.visible=this._curGroupIndex<r-1}},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID];if(t&&(this.actTime.text=t.getRemainTime()),this.dailyRefreshTime){var e=new Date(GameServer.serverTime),i=e.getTime();e.setDate(e.getDate()+1),e.setHours(0,0,0,0),i=Math.floor((e.getTime()-i)/1e3/60);var n=Math.floor(i/60),o=Math.floor(i%60);this.dailyRefreshTime.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("timeremaininghm",n,o))}},e.prototype.getDirRedPoint=function(t){var e=amusementControl.activityData[this.activityID];if(!e)return 0;var i=DataCenter.ins().Amusement11_1Config[e.id],n=DataCenter.ins().Amusement11_2Config[e.id],o={};for(var s in i){var r=Number(s);o[r]||(o[r]=[]);for(var a in n)r==n[a].group&&o[r].push(n[a])}var l=[];for(var h in o)l.push(o[h]);var u=0,p=0;for(isNaN(t)?(u=0,p=l.length):(u=t,p=t+1);p>u;u++){for(var c=u+1,d=0;d<l[u].length;d++){var g=l[u][d],m=e.achieveInfo[g.index-1];if(m&&!m.isGot&&m.times>=g.dayLimit)return c}if(e.IsPreCondition(c)&&(e.rewardInfo>>c&1)<=0&&e.gethiScore(c)>=i[c].score)return c}if(isNaN(t)){for(var c=-1,f=l.length-1;f>=0;f--){var v=f+1;(e.rewardInfo>>v&1)<=0&&(c=v)}return 0>c&&(c=l.length),c}return 0},e}(BasePanel);__reflect(AmuseTarget11Panel10.prototype,"AmuseTarget11Panel10");var TipsView=function(t){function e(){var e=t.call(this)||this;return e.labCount=0,e.list=[],e.listCenter=[],e.centerList=[],e.taskTipsList=[],e.sceneList=[],e.attrList=[],e.everList=[],e.hintList=[],e.rewardTipList=[],e.goodEquipList=[],e.skillTipList=[],e.equipItemList=[],e.equipHeartItemList=[],e.isShowLog=!1,e.resident=!0,e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.touchChildren=!1,this.touchEnabled=!1,this.rewardTip1=new GoodRewardTipsPanel,this.equipTip1=new GoodEquipTipsPanel,this.skillTip1=new GoodSkillTipsPanel,this.itemTip1=new GoodItemTipsPanel,this.equipHeartTip=new GoodHeartTipsPanel,this.addCustomEvent(453,this.showExp)},e.prototype.showExp=function(t){t&&this.showTips(LangMgr.getValueByKey("tipsTips2",t))},e.prototype.showHintTips=function(t){var e=ObjectPool.pop("HintTipsItemRenderer");e.verticalCenter=200,e.horizontalCenter=0,e.setTips(t),this.addChild(e),this.hintList.unshift(e),this.addEventRemovedFromStage(e,this.removeHintTip);for(var i=this.hintList.length-1;i>=0;i--){egret.Tween.removeTweens(this.hintList[i]);var n=egret.Tween.get(this.hintList[i]);n.to({verticalCenter:200+-30*i},300)}},e.prototype.removeHintTip=function(t){var e=this.hintList.indexOf(t.currentTarget);this.hintList.splice(e,1),egret.Tween.removeTweens(t.currentTarget),this.removeEventRemovedFromStage(t.currentTarget,this.removeHintTip),ObjectPool.push(t.currentTarget)},e.prototype.showEverTips=function(t){var e=ObjectPool.pop("EverTipsItemRenderer");e.x=t.x,e.y=t.y,e.labelText=t.str,this.addChild(e),this.everList.unshift(e),this.addEventRemovedFromStage(e,this.removeEverTip);for(var i=this.everList.length-1;i>=0;i--){egret.Tween.removeTweens(this.everList[i]);var n=egret.Tween.get(this.everList[i]);n.to({y:e.y-30*i},300)}},e.prototype.removeEverTip=function(t){var e=this.everList.indexOf(t.currentTarget);this.everList.splice(e,1),egret.Tween.removeTweens(t.currentTarget),this.removeEventRemovedFromStage(t.currentTarget,this.removeEverTip),ObjectPool.push(t.currentTarget)},e.prototype.showAttrTips=function(t){var e=ObjectPool.pop("AttriteChangeView");e.left=30,e.bottom=190,e.setLabelText(t[0],t[1]),this.addChild(e),this.attrList.unshift(e),this.addEventRemovedFromStage(e,this.removeAttrTip);for(var i=this.attrList.length-1;i>=0;i--){egret.Tween.removeTweens(this.attrList[i]);var n=egret.Tween.get(this.attrList[i]);n.to({bottom:190+40*i},300)}},e.prototype.removeAttrTip=function(t){this.removeEventRemovedFromStage(t.currentTarget,this.removeAttrTip);var e=this.attrList.indexOf(t.currentTarget);this.attrList.splice(e,1),egret.Tween.removeTweens(t.currentTarget),ObjectPool.push(t.currentTarget)},e.prototype.showCenterTips=function(t){var e=ObjectPool.pop("CenterTipsItemRenderer");e.verticalCenter=0,e.horizontalCenter=0,e.labelText=t,this.addChild(e),this.centerList.unshift(e),this.addEventRemovedFromStage(e,this.removeCenterTip);for(var i=this.centerList.length-1;i>=0;i--){egret.Tween.removeTweens(this.centerList[i]);var n=egret.Tween.get(this.centerList[i]);n.to({verticalCenter:0+-30*i},500)}},e.prototype.removeCenterTip=function(t){var e=t.currentTarget,i=this.centerList.indexOf(e);this.centerList.splice(i,1),e.horizontalCenter=0/0,e.verticalCenter=0/0,egret.Tween.removeTweens(e),this.removeEventRemovedFromStage(t.currentTarget,this.removeCenterTip),ObjectPool.push(e)},e.prototype.showCenterTips2=function(t){var e=ObjectPool.pop("CenterTipsItemRenderer");e.horizontalCenter=0,e.verticalCenter=-60,this.addChild(e),e.labelText2=t,this.centerList.unshift(e),this.addEventRemovedFromStage(e,this.removeCenterTip2);for(var i=this.centerList.length-1;i>=0;i--){egret.Tween.removeTweens(this.centerList[i]);var n=egret.Tween.get(this.centerList[i]);n.to({verticalCenter:-120-30*i},300)}},e.prototype.removeCenterTip2=function(t){var e=t.currentTarget;e.horizontalCenter=0/0,e.verticalCenter=0/0;var i=this.centerList.indexOf(e);this.centerList.splice(i,1),this.removeEventRemovedFromStage(t.currentTarget,this.removeCenterTip2)},e.prototype.showCenterTips3=function(t){var e=t.str,i=t.liftTime,n=ObjectPool.pop("CenterTipsItemRenderer");n.verticalCenter=0,n.horizontalCenter=0,n.liftTime=i,n.labelText3=e,this.addChild(n),this.centerList.unshift(n),this.addEventRemovedFromStage(n,this.removeCenterTip3);for(var o=this.centerList.length-1;o>=0;o--){egret.Tween.removeTweens(this.centerList[o]);var s=egret.Tween.get(this.centerList[o]);s.to({verticalCenter:0+-30*o},500)}},e.prototype.showBottomCenterTips=function(t){var e=ObjectPool.pop("CenterTipsItemRenderer");e.bottom=220,e.horizontalCenter=0,e.labelText3=t,e.liftTime=5e3,this.addChild(e),this.centerList.unshift(e),this.addEventRemovedFromStage(e,this.removeCenterTip3);for(var i=this.centerList.length-1;i>=0;i--){egret.Tween.removeTweens(this.centerList[i]);var n=egret.Tween.get(this.centerList[i]);n.to({bottom:220+30*i},500)}},e.prototype.removeCenterTip3=function(t){var e=t.currentTarget,i=this.centerList.indexOf(e);this.centerList.splice(i,1),e.horizontalCenter=0/0,e.verticalCenter=0/0,egret.Tween.removeTweens(e),this.removeEventRemovedFromStage(t.currentTarget,this.removeCenterTip3),ObjectPool.push(e)},e.prototype.showSceneTips=function(t){var e=ObjectPool.pop("SceneTipsItemRenderer");e.verticalCenter=-175,e.horizontalCenter=0,e.labelText=t,this.addChild(e),this.sceneList.unshift(e),this.addEventRemovedFromStage(e,this.removeSceneTip);for(var i=this.sceneList.length-1;i>=0;i--){egret.Tween.removeTweens(this.sceneList[i]);var n=egret.Tween.get(this.sceneList[i]);n.to({verticalCenter:-175+-30*i},500)}},e.prototype.removeSceneTip=function(t){var e=this.sceneList.indexOf(t.currentTarget);this.sceneList.splice(e,1),egret.Tween.removeTweens(t.currentTarget),this.removeEventRemovedFromStage(t.currentTarget,this.removeSceneTip),ObjectPool.push(t.currentTarget)},e.prototype.showTaskTips=function(t){var e=ObjectPool.pop("CenterTipsItemRenderer");e.bottom=232,e.horizontalCenter=0,e.labelText=t,this.addChild(e),this.taskTipsList.unshift(e),this.addEventRemovedFromStage(e,this.removeTaskTip);for(var i=this.taskTipsList.length-1;i>=0;i--){egret.Tween.removeTweens(this.taskTipsList[i]);var n=egret.Tween.get(this.taskTipsList[i]);n.to({bottom:232+30*i},500)}},e.prototype.removeTaskTip=function(t){var e=this.taskTipsList.indexOf(t.currentTarget);this.taskTipsList.splice(e,1),egret.Tween.removeTweens(t.currentTarget),this.removeEventRemovedFromStage(t.currentTarget,this.removeTaskTip),ObjectPool.push(t.currentTarget)},e.prototype.showTips=function(t){var e=ObjectPool.pop("TipsItemRenderer");e.left=0,e.bottom=190,this.addChild(e),e.labelText=t,this.list.unshift(e),this.addEventRemovedFromStage(e,this.removeTipsItem);for(var i=this.list.length-1;i>=0;i--){egret.Tween.removeTweens(this.list[i]);var n=egret.Tween.get(this.list[i]);n.to({bottom:190+30*i},300)}},e.prototype.removeTipsItem=function(t){var e=t.currentTarget;e.left=0/0,e.bottom=0/0;var i=this.list.indexOf(e);this.list.splice(i,1),this.removeEventRemovedFromStage(t.currentTarget,this.removeTipsItem),ObjectPool.push(e)},e.prototype.showGoodRewardTip=function(t){this.rewardTipList.push(t),TimerMgr.ins().isExists(this.goodRewardTimer,this)||TimerMgr.ins().doTimer(16,0,this.goodRewardTimer,this)},e.prototype.showGoodEquipTip=function(t){this.goodEquipList.push(t),TimerMgr.ins().isExists(this.goodEquipTimer,this)||TimerMgr.ins().doTimer(16,0,this.goodEquipTimer,this)},e.prototype.goodRewardTimer=function(){var t=this;if(0==this.rewardTipList.length)return void TimerMgr.ins().remove(this.goodEquipTimer,this);if(!this.isWait){var e;if(this.rewardTip1.isUsing||(e=this.rewardTip1),e){e.x=50,e.y=750,e.alpha=1,e.parent||this.addChild(e),e.isUsing=!0,this.isWait=!0,e.data=this.rewardTipList.pop();var i=egret.Tween.get(e);i.to({y:600},300).wait(1e3).to({alpha:0},1e3).call(function(){e.isUsing=!1,t.isWait=!1,t.removeChild(e)})}}},e.prototype.goodEquipTimer=function(){var t=this;if(0==this.goodEquipList.length)return void TimerMgr.ins().remove(this.goodEquipTimer,this);if(!this.isWait){var e;if(this.equipTip1.isUsing||(e=this.equipTip1),e){e.x=50,e.y=750,e.alpha=1,e.parent||this.addChild(e),e.isUsing=!0,this.isWait=!0,e.data=this.goodEquipList.pop();var i=egret.Tween.get(e);i.to({y:600},300).wait(1e3).to({alpha:0},1e3).call(function(){e.isUsing=!1,t.isWait=!1,t.removeChild(e)})}}},e.prototype.showSkillTip=function(t){this.skillTipList.push(t),TimerMgr.ins().isExists(this.skillTipTimer,this)||TimerMgr.ins().doTimer(16,0,this.skillTipTimer,this)},e.prototype.skillTipTimer=function(){var t=this;if(0==this.skillTipList.length)return void TimerMgr.ins().remove(this.skillTipTimer,this);if(!this.isWait){var e;if(this.skillTip1.isUsing||(e=this.skillTip1),e){e.x=50,e.y=750,e.alpha=1,this.addChild(e),e.isUsing=!0,this.isWait=!0,e.data=this.skillTipList.pop();var i=egret.Tween.get(e);i.to({y:600},300).wait(1e3).to({alpha:0},1e3).call(function(){e.isUsing=!1,t.isWait=!1,t.removeChild(e)})}}},e.prototype.showItemTip=function(t){this.equipItemList.push(t),TimerMgr.ins().isExists(this.itemTipTimer,this)||TimerMgr.ins().doTimer(16,0,this.itemTipTimer,this)},e.prototype.itemTipTimer=function(){var t=this;if(0==this.equipItemList.length)return void TimerMgr.ins().remove(this.itemTipTimer,this);if(!this.isWait){var e;if(this.itemTip1.isUsing||(e=this.itemTip1),e){e.x=50,e.y=750,e.alpha=1,this.addChild(e),e.isUsing=!0,this.isWait=!0,e.data=this.equipItemList.pop();var i=egret.Tween.get(e);i.to({y:600},300).wait(1e3).to({alpha:0},1e3).call(function(){e.isUsing=!1,t.isWait=!1,t.removeChild(e)})}}},e.prototype.showHeartItemTip=function(t){this.equipHeartItemList.push(t),TimerMgr.ins().isExists(this.itemHeartTipTimer,this)||TimerMgr.ins().doTimer(16,0,this.itemHeartTipTimer,this)},e.prototype.itemHeartTipTimer=function(){var t=this;if(0==this.equipHeartItemList.length)return void TimerMgr.ins().remove(this.itemHeartTipTimer,this);if(!this.isWait){var e;if(this.equipHeartTip.isUsing||(e=this.equipHeartTip),e){e.x=50,e.y=713,e.alpha=1,this.addChild(e),e.isUsing=!0,this.isWait=!0,e.data=this.equipHeartItemList.pop();var i=egret.Tween.get(e);i.to({y:563},300).wait(1e3).to({alpha:0},1e3).call(function(){e.isUsing=!1,t.isWait=!1,t.removeChild(e)})}}},e}(BaseEuiView);__reflect(TipsView.prototype,"TipsView");var TitleTipsView=function(t){function e(){var e=t.call(this)||this;return e.rareText=null,e.rareText=[LangMgr.getValueByKey("titleType1"),LangMgr.getValueByKey("titleType2"),LangMgr.getValueByKey("titleType3"),LangMgr.getValueByKey("titleType4"),LangMgr.getValueByKey("titleType5")],e.skinName="TitleTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.takeBtn,this.onTap),this.itemId=t[0],this.isbody=t[1],this.updateView()},e.prototype.updateView=function(){var t=titleControl.getTitleByItemId(this.itemId);if(Assert(t,"TitleTips: The title configuration could not be found，itemId:"+this.itemId+",isbody:"+this.isbody))return void UIMgr.ins().close(this);t.eff?(this.titleImg.visible=!1,this.titleMc||(this.titleMc=new GameMovieClip),this.titleMc.parent||this.titleEff.addChild(this.titleMc),this.titleMc.playFile(PATH_EFF+t.eff,-1)):(this.titleImg.visible=!0,DisplayUtils.removeFromParent(this.titleMc),this.titleImg.source=t.img),this.itemname.text=t.name;var e=BackpackControl.getAttrPower(t.attrs1);this.powerPanel.setPower(3*e),this.invalidtime.visible=!1,t.keepTime&&(this.invalidtime.visible=!0,this.invalidtime.text=LangMgr.getValueByKey("validtimeday",Math.floor(t.keepTime/DateUtils.SECOND_PER_DAY)));var i=DataCenter.ins().ItemConfig[this.itemId];this.quali.source="quali"+ItemUtils.getQuality(i);var n=new EquipNormalTipsItemRenderer;n.data={title:LangMgr.getValueByKey("flowerNormalAttr"),attributeData:t.attrs1,colorName:0,colorValue:0,others:null},this.content.addChild(n),this.isbody||DisplayUtils.removeFromParent(this.takeBtn),this.style.textFlow=TextUtils.generateTextFlow1("|C:"+this.rareText[t.rare]),t.attrs2?this.specialAttr.text=LangMgr.getValueByKey("equiAttrType5")+AttributeData.getAttStr(t.attrs2,0,1,"+"):DisplayUtils.removeFromParent(this.specialAttr)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.takeBtn:var e=DataCenter.ins().ItemConfig[this.itemId],i=e.level?e.level:0,n=e.zsLevel?e.zsLevel:0;if(ActorControl.level<i||reincarnateControl.lv<n){var o="";return reincarnateControl.lv<n&&(o+=LangMgr.getValueByKey("numberRotation",n)),ActorControl.level<i&&(o+=LangMgr.getValueByKey("numberLevel",i)),void tipsControl.showTips(LangMgr.getValueByKey("equiAfterUse",o))}var s=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,this.itemId);1>=s&&UIMgr.ins().close(this),backpackControl.upUseItem(this.itemId,1)}},e}(BaseEuiView);__reflect(TitleTipsView.prototype,"TitleTipsView");var ZealEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ZealEquipTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.open=function(t){this.addEventTouchEnd(this,this.otherClose),this.itemId=t,this.updateView()},e.prototype.updateView=function(){var t=DataCenter.ins().ItemConfig[this.itemId],e=ItemUtils.getQuality(t),i=ItemUtils.getSubType(t),n=ItemUtils.getJob(t);this.itemIcon.setData(t),this.lblTitle.text=t.name,this.quali.source=e>0?"quali"+e:"",this.type.text=RoleModel.getEquipNameByType(i),this.career.text=RoleModel.getJobNameByJob(n),this.zslevel.text=t.lvName;var o=DataCenter.ins().EquipConfig[this.itemId],s=[];for(var r in AttributeData.translate)if(o[""+r]){var a=new AttributeData;a.type=parseInt(AttributeData.translate[r]),a.value=o[""+r],s.push(a)}this.attr3.text=AttributeData.getAttStrEx(s,0,1,":");var l=[];this.attr0.text="",o.baseAttr1&&(l.push(o.baseAttr1),this.attr0.textFlow=TextUtils.generateTextFlow1(AttributeData.getAttrStrByType(o.baseAttr1.type)+("|C:0xFF00FF&T:+"+o.baseAttr1.value/100+"%|")));var h=BackpackControl.getAttrPower(s)+BackpackControl.getAttrAllPower(l,heroControl.getSubRoleByIndex(0));this.powerPanel.setPower(h);var u="",p=DataCenter.ins().EquipWithEffConfig[t.id+"_0"];switch(p&&(u=p.nextShowEff),i){case 0:this.rexueMc||(this.rexueMc=new GameMovieClip),this.rexueMc.parent||this.rexue.addChild(this.rexueMc),this.rexueMc.playFile(PATH_EFF+(""+u),-1);break;case 2:this.rexueClothesMc||(this.rexueClothesMc=new GameMovieClip),this.rexueClothesMc.parent||this.rexueClothes.addChild(this.rexueClothesMc),this.rexueClothesMc.playFile(PATH_EFF+(""+u),-1)}},e}(BaseEuiView);__reflect(ZealEquipTipsView.prototype,"ZealEquipTipsView");var TitleControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lvDict={},e.totalAttrsText=[],e.showTitleDic={},e.curSelectRole=0,e._totalPer=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getTotalPower=function(){for(var t=this.list.length,e=0,i=0;t>i;i++){var n=this.list.getItemAt(i);n.endTime>=0&&(e+=n.power)}return e},e.prototype.dispatchUseTitle=function(t){EventMgr.ins().dispatch(99,t)},e.prototype.upGetList=function(){},e.prototype.downListUpdate=function(t){for(var e={},i=0;i<t.length;++i){var n=t[i];e[n[0]]=n[1],this.lvDict[n[0]]=n.length>2?n[2]:0}this.initList(e),this.showTitleDic={};for(var o=heroControl.subRolesLen,i=0;o>i;i++){var s=heroControl.getSubRoleByIndex(i);null!=s&&(this.showTitleDic[Number(i)]=s.title)}EventMgr.ins().dispatch(98)},e.prototype.downAdd=function(t,e,i){this.change(t,e,i),EventMgr.ins().dispatch(98)},e.prototype.downRemove=function(t){this.change(t,-1,0),EventMgr.ins().dispatch(98)},e.prototype.upChangeShow=function(t,e){return[t,e]},e.prototype.downUpdateShow=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);if(i){if(i.infoModel.title=e,i.updateTitle(),0==i.team){var n=i.infoModel.index,o=this.showTitleDic[n]||0,s=i.infoModel.title;this.showTitleDic[n]=s,this.dispatchTitleShow(n,s,o)}titleControl.refNewTitle(i.infoModel.masterHandle)}},e.prototype.downUpdateNewTitle=function(t){for(var e=UnitMgr.ins().getEntityByIsMy(!0),i=0;i<e.length;i++){var n=e[i];n instanceof UnitRole&&(n.infoModel.newTitle=t)}titleControl.refNewTitle(ActorControl.handle)},e.prototype.dispatchTitleShow=function(t,e,i){EventMgr.ins().dispatch(100,[t,e,i])},e.prototype.setTitle=function(t,e){for(var i in this.showTitleDic)if(this.showTitleDic[i]==e){this.upChangeShow(Number(i),0);break}this.upChangeShow(t,e)},e.prototype.sortFunc=function(t,e){return t.endTime<0==e.endTime<0?t.config.sort>e.config.sort?1:-1:t.endTime<0?1:-1},e.prototype.initList=function(t){this.timeDict=t,this.infoDict={},this._totalAttrs=[],this._totalPer=0,this.totalAttrsText=[];var e=[],i=DataCenter.ins().TitleConfig;for(var n in i)if(i[n].attrs){var o=new TitleVo(i[n]);if(o.config.Id in t){o.endTime=t[o.config.Id];var s=o.config.attrs;if(0==o.config.keepTime){var r=DataCenter.ins().TitleLvUpConfig[o.config.Id],a=this.lvDict[o.config.Id];r&&a>1&&r[a]&&(s=r[a].attrs)}for(var l in s)this._totalAttrs[s[l].type]=(this._totalAttrs[s[l].type]||0)+s[l].value;o.config.title_attrs_pre&&(this._totalPer+=o.config.title_attrs_pre)}else o.endTime=-1;e[e.length]=this.infoDict[o.config.Id]=o}e.sort(this.sortFunc),this.list=new eui.ArrayCollection(e),this.updateTotalAttrs()},e.prototype.change=function(t,e,i){if(this.lvDict[t]=i,this.infoDict&&t in this.infoDict){var n=this.infoDict[t];n.endTime=e,0>e?delete this.timeDict[t]:this.timeDict[t]=e;var o=0>e?-1:1;this.initList(this.timeDict),o>0&&this.autoWearTitle(n)}},e.prototype.updateTotalAttrs=function(){this.totalAttrsText=[];for(var t in this._totalAttrs)this._totalAttrs[t]>0&&this.totalAttrsText.push(TitleVo.formatAttr(Number(t),this._totalPer?Math.floor(this._totalAttrs[t]*(1+this._totalPer/1e4)):this._totalAttrs[t]));if(0==this.totalAttrsText.length)for(var e=this.infoDict[1].config.attrs,i=0,n=e;i<n.length;i++){var o=n[i];this.totalAttrsText.push(TitleVo.formatAttr(o.type,0))}},e.prototype.autoWearTitle=function(t){if(17==t.config.Id&&this.filterTitleRule(t.config.Id)&&t instanceof TitleVo)for(var e=heroControl.subRolesLen,i=0;e>i;i++)if(!titleControl.showTitleDic[i]){titleControl.setTitle(i,t.config.Id);break}},e.prototype.getTitleByItemId=function(t){if(!t)return null;for(var e in DataCenter.ins().TitleConfig)if(DataCenter.ins().TitleConfig[e].activeItemId==t)return DataCenter.ins().TitleConfig[e];return null},e.prototype.refNewTitle=function(t){for(var e=UnitMgr.ins().getEntitysBymasterhHandle(t),i=!1,n=0;n<e.length;n++){var o=e[n];if(o instanceof UnitRole&&o.isMy){var s=o.infoModel;!s.title&&o.getHP()>0&&!i?(s.canWearNewTitle=!0,i=!0):o.getHP()?s.canWearNewTitle&&(s.canWearNewTitle=!1):s.canWearNewTitle&&(s.canWearNewTitle=!1),(!isNaN(confrontFightControl.encounterIndex)||0!=MapControl.copyId&&!toseongControl.isToseong)&&(s.canWearNewTitle=!1),o.updateTitle()
}}},e.prototype.filterTitleRule=function(t,e){void 0===e&&(e=!1);var i=DataCenter.ins().TitleConfig[t];if(!i||!i.highterTitle)return!1;for(var n=0;n<i.highterTitle.length;n++){var o=i.highterTitle[n],s=titleControl.timeDict[o];if(s>0&&DateUtils.formatMiniDateTime(s)-GameServer.serverTime>0){if(e){var r=DataCenter.ins().TitleConfig[o];r&&tipsControl.showCenterTips(LangMgr.getValueByKey("titleWear1",r.name))}return!0}}return!1},e.prototype.getTitleIsFullLv=function(t){var e=DataCenter.ins().TitleLvUpConfig[t];if(!e)return 0;if(null==this.lvDict[t])return 2;var i=-1;for(var n in e)i=i<Number(n)?Number(n):i;return this.lvDict[t]>=i?1:2},e.SIMLPE_HEIGHT=86,e.EXPAND_HEIGHT=380,__decorate([up(1)],e.prototype,"upGetList",null),__decorate([down(1,[[3,6,1]])],e.prototype,"downListUpdate",null),__decorate([down(2,[3,6,1])],e.prototype,"downAdd",null),__decorate([down(3,[3])],e.prototype,"downRemove",null),__decorate([up(4,[2,3])],e.prototype,"upChangeShow",null),__decorate([down(4,[10,3])],e.prototype,"downUpdateShow",null),__decorate([down(5,[2])],e.prototype,"downUpdateNewTitle",null),e=__decorate([protocolsId(38)],e)}(BaseSystem);__reflect(TitleControl.prototype,"TitleControl");var TitleVo=function(){function t(t){this.config=t}return Object.defineProperty(t.prototype,"attrsText",{get:function(){if(!this._attrsText){var e=[],i=this.config.attrs,n=DataCenter.ins().TitleLvUpConfig[this.config.Id],o=titleControl.lvDict[this.config.Id];n&&o>1&&n[o]&&(i=n[o].attrs);for(var s=i.length;s--;)e[s]=t.formatAttr(i[s].type,i[s].value);this._attrsText=e,this.power=BackpackControl.getAttrPower(i)}return this._attrsText},enumerable:!0,configurable:!0}),t.formatAttr=function(t,e){return{h:AttributeData.getAttrStrByType(t)+"：",t:String(e),textColor:ColorUtils.GREEN}},t}();__reflect(TitleVo.prototype,"TitleVo");var TitleUpLvTipsView=function(t){function e(){var e=t.call(this)||this;return e.curOwnNum=0,e.curNeedNum=1,e.uilayer=GameLayer.POPUP,e.skinName="TitleUpLvTipsViewSkin",e.itemIcon.imgJob.visible=!1,e.expenItemIcon.imgJob.visible=!1,e}return __extends(e,t),e.prototype.initUI=function(){},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.gid=t[1],this.num=t[2],this.gdata=t[3],this.addEventTouchTap(this.upLvOrActBtn,this.onTap),this.addEventTouchEnd(this.closeBtn,this.otherClose),this.setData(this.type,this.gid,this.num,null),this.setTitleAtt(),this.expenItemIcon.setData(this.itemConfig),this.addCustomEvent(98,this.setTitleAtt),this.addCustomEvent(267,this.setTitleAtt)},e.prototype.onTap=function(t){this.curOwnNum>=this.curNeedNum?backpackControl.upUseItem(this.gdata.configID,this.curNeedNum):tipsControl.showTips(LangMgr.getValueByKey("shopTips29"))},e.prototype.setTitleAtt=function(){this.titleConf=DataCenter.ins().TitleConfig[this.itemConfig.useArg];var t=titleControl.lvDict[this.titleConf.Id];this.arrValLabel.text="",this.arrValLabel0.text="",this.curOwnNum=backpackControl.getBagGoodsCountById(this.type,this.gid),this.setData(this.type,this.gid,this.curOwnNum,null);var e=DataCenter.ins().TitleLvUpConfig[this.titleConf.Id];if(0==this.curOwnNum||!e)return void UIMgr.ins().close(this);var i=ColorUtils.GREEN_COLOR;if(t){var n=void 0;if(1==t?n=this.titleConf:e[t]&&(n=e[t]),n&&this.setAttValLabel(this.arrValLabel,n.attrs,"titlenoupactatt"),1==titleControl.getTitleIsFullLv(this.titleConf.Id))this.currentState="fulllv";else{this.currentState="activate";var o=t+1;e[o]&&(this.setAttValLabel(this.arrValLabel0,e[o].attrs,"titleupactatt"),this.powerPanel1.setPower(BackpackControl.getAttrPower(e[o].attrs)),this.curNeedNum=e[o].cost,i=this.curOwnNum>=this.curNeedNum?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR)}this.powerPanel0.setPower(BackpackControl.getAttrPower(n.attrs)),this.curLvLab.text=LangMgr.getValueByKey("titlelvatttips",t)}else{this.curNeedNum=1,this.currentState="noactivate",this.setAttValLabel(this.arrValLabel,this.titleConf.attrs,"titlenoupactatt");var s=BackpackControl.getAttrPower(this.titleConf.attrs);this.powerPanel0.setPower(s)}this.expenLabel.textFlow=TextUtils.generateTextFlow("<font color="+i+">"+this.curOwnNum+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+this.curNeedNum+"</font> ")},e.prototype.setAttValLabel=function(t,e,i){for(var n="",o=0;o<e.length;o++){var s=TitleVo.formatAttr(e[o].type,e[o].value);n+=LangMgr.getValueByKey(i,s.h+s.t)+"\n"}t.textFlow=TextUtils.generateTextFlow(n)},e}(ItemTipsView);__reflect(TitleUpLvTipsView.prototype,"TitleUpLvTipsView");var TitleItemAttItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="TitleItemAttItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.attText0.text=this.data.h,this.attText1.text=this.data.t},e}(BaseItemRender);__reflect(TitleItemAttItemRender.prototype,"TitleItemAttItemRender");var TitleItemRenderer=function(t){function e(){var e=t.call(this)||this;return e._isShow=!1,e.skinName="TitleItemRendererSkin",e.attrs.itemRenderer=TitleItemAttItemRender,e.attrsTotal.itemRenderer=TitleItemAttItemRender,e}return __extends(e,t),e.prototype.onTap=function(t){t.target==this.btnSet?titleControl.dispatchUseTitle(this.data):(this._isShow=!this._isShow,this.currentState=this._isShow?"expand":"simple",EventMgr.ins().dispatch(10,this,this.currentState))},e.prototype.dataChanged=function(){if(this.addEventRemovedFromStage(this,this.onRemove),this.data instanceof TitleVo){var t=this.data;if(this.conditionTxt.text=LangMgr.getValueByKey("titleType6",t.config.condition),this.attrs.dataProvider=new eui.ArrayCollection(t.attrsText),this.attrsTotal.dataProvider=new eui.ArrayCollection(titleControl.totalAttrsText),this.img.source=t.config.img?t.config.img:"",t.config.eff){this.titleMc||(this.titleMc=ObjectPool.pop("GameMovieClip"),this.titleMc.x=118,this.titleMc.y=30,this.addChildAt(this.titleMc,20));var e=PATH_EFF+t.config.eff;this.titleMc.playFile(e,-1)}else this.titleMc&&(this.titleMc.destroy(),this.titleMc=null);if(t.endTime>=0){this.btnSet.label=t.config.Id==titleControl.showTitleDic[titleControl.curSelectRole]?LangMgr.getValueByKey("wearState1"):titleControl.showTitleDic[titleControl.curSelectRole]?LangMgr.getValueByKey("wearState2"):LangMgr.getValueByKey("wearState3"),this.btnSet.visible=!0,this.time.visible=!0;var i=DateUtils.formatMiniDateTime(t.endTime)/1e3,n=titleControl.lvDict[t.config.Id];this.time.text=0==t.endTime?LangMgr.getValueByKey("titleType7")+"\n"+LangMgr.getValueByKey("equiLevel")+n:LangMgr.getValueByKey("titleType8",DateUtils.getFormatBySecond(i,2)),this.labLack.visible=!1}else this.btnSet.visible=!1,this.time.visible=!1,this.labLack.visible=!0;var o=LangMgr.getValueByKey("titleType"+(t.config.rare+1));this.labRare.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("titleType9")+o),this.lblPower.text=LangMgr.getValueByKey("kfTips12",t.power),this.addEventTouchTap(this,this.onTap)}else this.img.source="",this.conditionTxt.text="",this.lblPower.text="",this.removeEventTouchTap(this,this.onTap)},e.prototype.onRemove=function(){this.removeEventRemovedFromStage(this,this.onRemove),WatcherUtil.removeFromArrayCollection(this.attrs.dataProvider),WatcherUtil.removeFromArrayCollection(this.attrsTotal.dataProvider),this.attrs.dataProvider=null,this.attrsTotal.dataProvider=null},e}(BaseItemRender);__reflect(TitleItemRenderer.prototype,"TitleItemRenderer");var ToseongControl=function(t){function e(){var e=t.call(this)||this;return e.cityBossId=0,e.cityBossHandle=0,e.attStatue=2,e.bossKillNumData={},e.enterCD=0,e.addCustomEvent(353,function(){e.isToseong?e.dispatchEnterCity():e.inCity&&e.dispatchEscCity()}),e.addCustomEvent(221,e.createStatue),e.addCustomEvent(418,e.createStatue),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"isToseong",{get:function(){return 20==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.getBossList=function(){var t,e=new Array;for(var i in DataCenter.ins().ToseongBossConfig){var n=DataCenter.ins().ToseongBossConfig[i];-1==e.indexOf(n.bossId)&&n.killBossId>999&&e.push(n.bossId)}return t=new eui.ArrayCollection(e)},e.prototype.getCityBossConfig=function(t){if(!this.cityBossIdConf){this.cityBossIdConf={};for(var e in DataCenter.ins().ToseongBossConfig){var i=DataCenter.ins().ToseongBossConfig[e];this.cityBossIdConf[i.bossId]=i}}var n=this.cityBossIdConf[t];return n&&n.killBossId>999?n:null},e.prototype.getKillBossNum=function(t){var e=this.getCityBossConfig(t),i=e.killBossId,n=0;void 0!=this.bossKillNumData[i]&&(n=this.bossKillNumData[i][0]);var o=this.getNeedKillBossNum(t);return(t==this.cityBossId||n>o)&&(n=o),n},e.prototype.getNeedKillBossNum=function(t){var e=this.getCityBossConfig(t),i=e.killBossId,n=0;return void 0!=this.bossKillNumData[i]&&(n=this.bossKillNumData[i][1]),n>=e.killCount.length&&(n=e.killCount.length-1),e.killCount[n]},e.prototype.getRefreshTime=function(t){var e=this.getCityBossConfig(t),i=e.killBossId,n=0;void 0!=this.bossKillNumData[i]&&(n=this.bossKillNumData[i][2]);var o;if(0==n)o="";else{if(n=DateUtils.formatMiniDateTime(n))for(var s in DataCenter.ins().WorldBossBaseConfig.halvedActId){var r=DataCenter.ins().WorldBossBaseConfig.halvedActId[s];if(amusementControl.activityData[r]&&amusementControl.getAmusementDataById(r).isOpenActivity()){n=(n-GameServer.serverTime)/2+GameServer.serverTime;break}}o=DateUtils.checkTime(n,7)||0==n?"":DateUtils.formatFullTime(n)}return o},e.prototype.downBossInfo=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],n=t[e][1],o=t[e][2],s=t[e][3];this.bossKillNumData[i]=[n,o,s]}EventMgr.ins().dispatch(101)},e.prototype.downCityBossId=function(t,e){this.cityBossId=t,this.cityBossHandle=e,this.changeFunView(),EventMgr.ins().dispatch(102)},e.prototype.getMaxKillNumBoss=function(){var t,e=0,i=0,n=0,o=Number.MAX_VALUE,s=!1,r=0;for(var a in this.bossKillNumData)if(!(999>+a)){t=this.getCfgByKillBossId(parseInt(a));var l=t.killCount[this.bossKillNumData[a][1]];if(void 0==l&&(l=t.killCount[t.killCount.length-1]),n=this.bossKillNumData[a][0]/l,n>=1)return[e,n];e||s||0!=this.bossKillNumData[a][2]||(s=!0,r=t.bossId,i=n),this.bossKillNumData[a][2]&&this.bossKillNumData[a][2]<o&&(e=t.bossId,o=this.bossKillNumData[a][2],i=n)}return[e||r,i]},e.prototype.getShowBossId=function(){var t;return t=this.cityBossId>0?this.cityBossId:this.getMaxKillNumBoss()[0]},e.prototype.getCfgByKillBossId=function(t){for(var e in DataCenter.ins().ToseongBossConfig)if(DataCenter.ins().ToseongBossConfig[e].killBossId==t)return DataCenter.ins().ToseongBossConfig[e];return null},e.prototype.createStatue=function(t){if(void 0===t&&(t=-1),this.isToseong){var e={};e[0]="chenghaotxdy",e[10]="chenghaomdtx",e[2]="chenghaoslzw";var i,n,o=UIMgr.gameScene.map;if(-1==t){var s=unionWarControl.getModel().winGuildInfo;n=DataCenter.ins().ToseongBaseConfig.masterPos,i=new UnitStatue("chenghaolcbz",s.guildOwnName||LangMgr.getValueByKey("clanEmptyJob"),"diaoxiang0_"+s.guildOwnSex)}else{if(n=DataCenter.ins().ToseongBaseConfig.statuePos[t],!n)return;var r=rankControl.getRankModel(t).praise,a=3;if(r.subRole[0])a=r.subRole[0].job;else switch(t){case 0:a=1;break;case 2:a=2}i=new UnitStatue(e[t],r.name||LangMgr.getValueByKey("clanEmptyJob"),"statue_"+a+"_"+(r.subRole[0]?r.subRole[0].sex:0))}i.x=n.x,i.y=n.y,o.addEntity(i)}},e.prototype.upEnter=function(){},e.prototype.upStopAI=function(){},e.prototype.upRevival=function(){},e.prototype.dispatchEnterCity=function(){this.inCity=!0,this.cityBossId>0&&this.isChallenge&&(this.isChallenge=!1,TimerMgr.ins().doNext(function(){var t=UIMgr.ins().getView(BossBelongView);t&&t.attrBoss()},this)),this.changeFunView(),UIMgr.ins().open(ToseongFunView),rankControl.upGetRankingData(0),rankControl.upGetPraiseData(0),rankControl.upGetPraiseData(2),rankControl.upGetPraiseData(10),unionWarControl.upWinGuildInfo()},e.prototype.dispatchEscCity=function(){this.inCity=!1,this.attStatue=2,UIMgr.ins().close(ToseongFunView),UIMgr.ins().close(BossBelongView),UIMgr.ins().close(BossBloodView),UIMgr.ins().close(TargetPlayerBigBloodView)},e.prototype.dispatchChangeAttStatue=function(t){this.attStatue=t,this.changeFunView(),EventMgr.ins().dispatch(665,t)},e.prototype.changeFunView=function(){this.isToseong&&(2==this.attStatue&&0==this.cityBossId?UIMgr.ins().open(PortalView):UIMgr.ins().close(PortalView),0==this.cityBossId?(UIMgr.ins().close(BossBloodView),UIMgr.ins().close(BossBelongView)):(bossControl.monsterID=this.cityBossId,bossControl.bossHandler=this.cityBossHandle,UIMgr.ins().open(BossBelongView),UIMgr.ins().open(BossBloodView)))},e.prototype.downCityBossBelong=function(t,e){var i="";if(t>0){var n=UnitMgr.ins().getMasterList(t);n&&n[0]&&n[0].infoModel&&(i=n[0].infoModel.name)}bossControl.dispatchBelongChange(e,t,i)},e.prototype.downBossChallengeResult=function(t,e,i,n,o){void 0===i&&(i=1);for(var s=[],r=0;o.length>r;r++)s[r]=new RewardVo,s[r].init(o[r]);var a,l=UnitMgr.ins().getMasterList(bossControl.attHandle);l&&(a=l[0]);var h="yuanhead"+i+n,u=[t,e,h,a];resultControl.create(MapControl.copyType,!0,s,"",null,u)},e.prototype.downRemainTime=function(t,e){bossControl.reliveTime=t,bossControl.killerHandler=e,bossControl.reliveTime>0?(bossControl.clearWorldBossList(),UIMgr.ins().open(WorldBossBeKillView)):UIMgr.ins().close(WorldBossBeKillView),EventMgr.ins().dispatch(103)},e.prototype.downHudunPoint=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&(this.hudun=t[0],this.huDunMax=t[1],TimerMgr.ins().remove(this.hudunPointFun,this),this.hudun>0&&TimerMgr.ins().doTimer(1e3,this.hudun,this.hudunPointFun,this)),EventMgr.ins().dispatch(104)},e.prototype.hudunPointFun=function(){this.hudun--,this.downHudunPoint(null)},e.prototype.downEnterCD=function(t){this.enterCD=t,TimerMgr.ins().remove(this.enterCDFun,this),this.enterCD>0&&TimerMgr.ins().doTimer(1e3,this.enterCD,this.enterCDFun,this)},e.prototype.enterCDFun=function(){this.enterCD--},e.prototype.enterCity=function(){return SwitchMgr.ins().checkOpen(32,!0)&&MapControl.sceneInHook()?confrontControl.isEncounter()?void tipsControl.showTips(LangMgr.getValueByKey("atkPlayerIng")):void(toseongControl.enterCD<1?warnControl.showDangerWarn(function(){toseongControl.upEnter()}):tipsControl.warnTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD))):void 0},__decorate([down(3,[[3,3,3,3]])],e.prototype,"downBossInfo",null),__decorate([down(4,[3,10])],e.prototype,"downCityBossId",null),__decorate([up(1)],e.prototype,"upEnter",null),__decorate([up(2)],e.prototype,"upStopAI",null),__decorate([up(3)],e.prototype,"upRevival",null),__decorate([down(1,[10,10])],e.prototype,"downCityBossBelong",null),__decorate([down(2,[1,8,1,1,ByteConst.RewardVos])],e.prototype,"downBossChallengeResult",null),__decorate([down(5,[2,10])],e.prototype,"downRemainTime",null),__decorate([down(6,[3,3])],e.prototype,"downHudunPoint",null),__decorate([down(7,[3])],e.prototype,"downEnterCD",null),e=__decorate([protocolsId(58)],e)}(BaseSystem);__reflect(ToseongControl.prototype,"ToseongControl");var ToseongBossPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.open=function(){this.addViewEvent(),this.initView()},e.prototype.init=function(){this.isInit||(this.list.itemRenderer=ToseongBossItemRenderer,this.rewardList.itemRenderer=ItemBase,this.canChallengeTxt.text=LangMgr.getValueByKey("cityNoUpdate"),this.bossEffect=new GameMovieClip,this.bossEffect.scaleX=-1,this.bossEffect.scaleY=1,this.bossEffect.x=78,this.bossEffect.y=160,this.bossGroup.addChild(this.bossEffect),this.bossImage=new GameMovieClip,this.bossImage.scaleX=-1,this.bossImage.scaleY=1,this.bossImage.x=78,this.bossImage.y=160,this.bossGroup.addChild(this.bossImage),this.isInit=!0)},e.prototype.addViewEvent=function(){this.addCustomEvent(101,this.checkState),this.addCustomEvent(102,this.checkState),this.addEventTouchTap(this.challengeBtn,this.onChallenge),this.addEventItemTap(this.list,this.onListChange),this.addEventTouchTap(this.bossName,this.openBossWin)},e.prototype.openBossWin=function(t){var e=this.list.dataProvider.getItemAt(this.list.selectedIndex),i=toseongControl.getCityBossConfig(e),n=i.killBossId;UIMgr.ins().open(BossView,1,n)},e.prototype.initView=function(){this.list.dataProvider=toseongControl.getBossList();var t=this.getBossIndex();this.list.selectedIndex=t,this.updateView(t)},e.prototype.getBossIndex=function(){var t=toseongControl.getShowBossId(),e=0;if(t>0)for(var i=this.list.dataProvider.length,n=0;i>n;n++)if(t==this.list.dataProvider.getItemAt(n)){e=n;break}return e},e.prototype.onChallenge=function(t){toseongControl.enterCD>0?tipsControl.showTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD)):toseongControl.isToseong?TimerMgr.ins().doNext(function(){var t=UIMgr.ins().getView(BossBelongView);t.attrBoss()},this):(toseongControl.isChallenge=!0,toseongControl.upEnter()),UIMgr.ins().close(this)},e.prototype.checkState=function(){this.list.dataProvider=toseongControl.getBossList(),this.updateView(this.list.selectedIndex)},e.prototype.onListChange=function(t){this.updateView(t.itemIndex)},e.prototype.updateView=function(t){var e=this.list.dataProvider.getItemAt(t),i=DataCenter.ins().MonstersConfig[e],n=toseongControl.getCityBossConfig(e),o=toseongControl.getKillBossNum(e),s=toseongControl.getNeedKillBossNum(e),r=o>=s,a=DataCenter.ins().EffectConfig[i.effect].fileName;this.bossName.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+DataCenter.ins().MonstersConfig[n.killBossId].name+"</u></a>"),this.bossName.touchEnabled=!0;var l=toseongControl.getRefreshTime(e);l&&l.length>0?this.nextTime.text=LangMgr.getValueByKey("cityUpdateFast",toseongControl.getRefreshTime(e)):this.nextTime.text="",this.nextTime.visible=!0,this.nameTxt.text=i.name+"("+i.level+LangMgr.getValueByKey("numberLevel","")+")",this.killProgressBar.minimum=0,this.killProgressBar.maximum=s,this.killProgressBar.value=o,this.rewardList.dataProvider=new eui.ArrayCollection(n.showReward),this.bossImage.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(i.avatar+"_3s"),-1),this.bossEffect.playFile(PATH_EFF+a,-1),this.updateState(r)},e.prototype.updateState=function(t){this.canChallengeTxt.visible=!t,this.challengeBtn.visible=t,this.redPoint.visible=t,this.stateImage.visible=t,this.nextTime.visible=!t},e}(BasePanel);__reflect(ToseongBossPanel.prototype,"ToseongBossPanel");var ToseongBossRewardTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ToseongBossRewardTipsViewSkin",this.isTopLevel=!0,this.belongList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.giveUp,this.otherClose),this.showAward()},e.prototype.showAward=function(){if(toseongControl.isToseong)for(var t in DataCenter.ins().ToseongBossConfig)if(DataCenter.ins().ToseongBossConfig[t].bossId==toseongControl.cityBossId){this.belongList.dataProvider=new eui.ArrayCollection(DataCenter.ins().ToseongBossConfig[t].showReward);break}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(ToseongBossRewardTipsView.prototype,"ToseongBossRewardTipsView");var ToseongBossView=function(t){function e(){var e=t.call(this)||this;return e.lastSelect=0,e.skinName="ToseongBossViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventChange(this.tab,this.setSelectedIndex),this.addEventTouchTap(this.seeRule,this.onSeeRule),this.viewStack.selectedIndex=0,this.viewStack.getElementAt(0).open()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn0,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.onSeeRule=function(t){HelpControl.openHelpWin(16)},e.prototype.setSelectedIndex=function(t){this.viewStack.getElementAt(this.lastSelect).close(),this.lastSelect=this.viewStack.selectedIndex,this.viewStack.getElementAt(this.lastSelect).open()},e}(BaseEuiView);__reflect(ToseongBossView.prototype,"ToseongBossView");var ToseongFunView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ToseongFunViewSkin",e.uilayer=GameLayer.SCENE3,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.attState,this.onClick),this.addEventTouchTap(this.quit,this.onClick),this.addCustomEvent(665,this.changeBtn),this.addCustomEvent(102,this.changeAttStatue),this.changeAttStatue()},e.prototype.changeAttStatue=function(){toseongControl.cityBossId>0&&(toseongControl.dispatchChangeAttStatue(1),UIMgr.ins().open(TargetListView))},e.prototype.changeBtn=function(){this.attState.selected=UIMgr.ins().isShow(TargetListView)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.attState:var e=0;this.attState.selected?(UIMgr.ins().open(TargetListView),e=1):0==toseongControl.cityBossId?(e=2,UIMgr.ins().close(TargetListView)):tipsControl.showTips(LangMgr.getValueByKey("cityTips2")),toseongControl.dispatchChangeAttStatue(e);break;case this.quit:warnControl.show(LangMgr.getValueByKey("cityTips3"),function(){copyControl.upExitFb()},this)}},e}(BaseEuiView);__reflect(ToseongFunView.prototype,"ToseongFunView");var ToseongBossItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="ToseongBossItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().MonstersConfig[t];this.nameTxt.text=e.name;var i=toseongControl.getKillBossNum(t)>=toseongControl.getNeedKillBossNum(t);this.redPoint.visible=i},e}(BaseItemRender);__reflect(ToseongBossItemRenderer.prototype,"ToseongBossItemRenderer");var TrailerControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rewardStatus={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downActivityForeshowInfo=function(t){this._rewardStatus={};for(var e=0;t.length>e;e++){var i=t[e];this._rewardStatus[i]=1}},e.prototype.downActivityForeshowReward=function(t,e){this._rewardStatus[t]=e,EventMgr.ins().dispatch(105)},e.prototype.upGetForeshowReward=function(t){return[t]},e.prototype.getCurShowCfg=function(){var t=this.getForeshow();if(t&&t.length>0){var e=null;for(var i in t){var n=t[i];this.isReach(n)&&(null==e||n.id<e.id)&&(e=n)}return e?e:t[0]}return null},e.prototype.getForeshow=function(){var t=GameServer.serverOpenDay+1,e=copyControl.guanqiaID,i=[];for(var n in DataCenter.ins().TrailerNewConfig){var o=DataCenter.ins().TrailerNewConfig[n];if((o.closeDay<0||o.closeDay>t)&&(o.chapter<=0||e>=o.chapter)&&o.startDay<=t){var s=this.isGotReward(o.id);s||i.push(o)}}return i.length>0?i=i.sort(this.sortById.bind(this)):null},e.prototype.sortById=function(t,e){return e.id-t.id},e.prototype.isShowForeshow=function(){var t=this.getForeshow();return t&&t.length>0},e.prototype.isGotReward=function(t){return this._rewardStatus[t]>0},e.prototype.isReach=function(t){var e=GameServer.serverOpenDay+1;return e>=t.openDay&&reincarnateControl.lv>=t.zsLevel?!0:!1},__decorate([down(38,[[3]])],e.prototype,"downActivityForeshowInfo",null),__decorate([down(39,[3,3])],e.prototype,"downActivityForeshowReward",null),__decorate([up(39,[3])],e.prototype,"upGetForeshowReward",null),e=__decorate([protocolsId(255)],e)}(BaseSystem);__reflect(TrailerControl.prototype,"TrailerControl");var DarkSuitTrailerView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t){1==t?this.skinName="DarkSuitTrailerView1Skin":this.skinName="DarkSuitTrailerViewSkin",this.addEventTouchEnd(this,this.onClose)},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(DarkSuitTrailerView.prototype,"DarkSuitTrailerView");var GodWeaponSkillTrailerView=function(t){function e(){var e=t.call(this)||this;return e._weaponId=1,e.skinName="GodWeaponSkillTrailerViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(t){this._weaponId=t,this.showSkill(),this.addEventTouchEnd(this,this.onClose)},e.prototype.showSkill=function(){this.initSkill()},e.prototype.initSkill=function(){for(var t=this._weaponId,e=DataCenter.ins().GodWeaponBaseConfig.noticeSkillId[t-1],i=DataCenter.ins().GodWeaponLineConfig[t],n=0,o=0;o<e.length;o++){var s=e[o],r=godWeaponControl.getWeaponSkinIdData(t,i[s].skinId);this["item"+n].imgLight=!0,this["item"+n].updateView(r,t-1),this["skillName"+n].text=i[s].skillName,this["skillDesc"+n].text=i[s].lockDesc,n+=1}},e.prototype.onClose=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(GodWeaponSkillTrailerView.prototype,"GodWeaponSkillTrailerView");var SoulBoneSuitTrailerView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SoulBoneGroupViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.id=t[0],this.cfg=t[1],this.updateShow()},e.prototype.updateShow=function(){this.itemData=[],this.init();var t=this.getSuitData(this.cfg.itemId);if(CommonUtils.getObjectLength(t)&&t[this.id]){this.itemData=[];var e=this.getPosColorName(this.id),i=[];for(var n in t[this.id])-1==i.indexOf(t[this.id][n].stage)&&i.push(t[this.id][n].stage);for(var o="",s=0;s<i.length;s++){var r=i[s];o=DataCenter.ins().SoulBoneConfig.suitName[this.id-1][1>=r?0:r-1];var a=[],l=[];for(var n in DataCenter.ins().SoulBoneSuitConfig[this.id]){for(var h=0;h<t[this.id][n].count.length;h++){var u=t[this.id][n].count[h],p=ItemUtils.getSubType(DataCenter.ins().ItemConfig[u]);-1==a.indexOf(p)&&a.push(p)}var c=DataCenter.ins().SoulBoneSuitConfig[this.id][n][r],d=t[this.id][n].stage==r&&t[this.id][n].count.length>=+n?ColorUtils.GREEN:ColorUtils.GRAY;c||(c=DataCenter.ins().SoulBoneSuitConfig[this.id][n][1]),c.dec&&l.push("|C:"+d+"&T:"+n+LangMgr.getValueByKey("HunJ")+":"+c.dec)}for(var g="",h=0;h<e.length;h++){var d=-1==a.indexOf(e[h])?ColorUtils.GRAY:ColorUtils.GREEN;g+="|C:"+d+"&T:"+soulBoneControl.getSoulBonePosName(e[h])+"  "}this.itemData.push({qualityName:o,posName:g,suits:l})}}for(var s=0;s<this.itemData.length;s++){var m=new SoulBoneGroupItemRenderer;m.data={qualityName:this.itemData[s].qualityName,posName:this.itemData[s].posName,suits:this.itemData[s].suits},this.content.addChild(m)}},e.prototype.getPosColorName=function(t){for(var e=[],i=0;i<DataCenter.ins().SoulBoneConfig.suit[t].length;i++)e.push(DataCenter.ins().SoulBoneConfig.suit[t][i]);return e},e.prototype.init=function(t){void 0===t&&(t=this.id);for(var e=1==t?LangMgr.getValueByKey("specal"):LangMgr.getValueByKey("hunHG"),i=LangMgr.getValueByKey("hunTips",e),n=DataCenter.ins().SoulBoneConfig.suit[t],o="",s=0;s<n.length;s++)o+="|C:"+ColorUtils.GRAY+"&T:"+soulBoneControl.getSoulBonePosName(n[s])+"  ";var r=[];for(var a in DataCenter.ins().SoulBoneSuitConfig[t]){var l=DataCenter.ins().SoulBoneSuitConfig[t][a][1];if(l.specialAttrs)r.push(LangMgr.getValueByKey("hunTips1",ColorUtils.GRAY,a,l.specialAttrs/100));else{for(var h="",s=0;s<l.attrs.length;s++)h+=AttributeData.getAttrStrByType(l.attrs[s].type)+"+"+l.attrs[s].value+"  ";l.dec&&r.push(LangMgr.getValueByKey("hunTips2",ColorUtils.GRAY,a)+l.dec)}}this.itemData.push({qualityName:i,posName:o,suits:r})},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.getSuitData=function(t){var e={};if(!t||0==t.length)return e;var i=[];for(var n in DataCenter.ins().SoulBoneConfig.suit)if(DataCenter.ins().SoulBoneSuitConfig[n]){i[+n]=[];for(var o in DataCenter.ins().SoulBoneConfig.suit[n]){var s=DataCenter.ins().SoulBoneConfig.suit[n][o],r=t[s].id;r&&i[+n].push(DataCenter.ins().SoulBoneEquipConfig[r])}i[+n].sort(function(t,e){return SortUtils.sortDescByKey(t.stage,e.stage)})}for(var r in DataCenter.ins().SoulBoneSuitConfig){e[r]={};for(var a in DataCenter.ins().SoulBoneSuitConfig[r]){e[r][a]={},e[r][a].count=[],e[r][a].stage=0;for(var l=0;+a>l&&i[+r][l];l++)e[r][a].count.push(i[+r][l].id),e[r][a].stage||(e[r][a].stage=i[+r][l].stage),e[r][a].stage>i[+r][l].stage&&(e[r][a].stage=i[+r][l].stage)}}return e},e}(BaseEuiView);__reflect(SoulBoneSuitTrailerView.prototype,"SoulBoneSuitTrailerView");var TrailerView=function(t){function e(){var e=t.call(this)||this;e.viewArr=[Trailer1Panel,Trailer2Panel,Trailer3Panel,Trailer4Panel,Trailer5Panel,Trailer6Panel,Trailer7Panel,Trailer8Panel,Trailer9Panel,Trailer10Panel,Trailer11Panel,Trailer12Panel,Trailer13Panel,Trailer14Panel,Trailer15Panel,Trailer16Panel,Trailer17Panel,Trailer18Panel,Trailer19Panel,Trailer20Panel,Trailer21Panel,Trailer22Panel,Trailer23Panel],e._autoTime=5,e._isAuto=!1,e._isFirst=!0,e.isTopLevel=!0,e.skinName="TrailerViewSkin",e.viewContainer.removeChildren(),e._panelList=[];for(var i=0;i<e.viewArr.length;i++){var n=new e.viewArr[i];n.visible=!1,e._panelList.push(n),e.viewContainer.addChild(n)}return e}return __extends(e,t),e.prototype.open=function(){this.checkOpen()&&(this.addEventTouchTap(this.go,this.onGoWin),this.addEventTouchTap(this.bgClose,this.closeWin),this.addEventTouchTap(this.btnLeft,this.onTap),this.addEventTouchTap(this.btnRight,this.onTap),this.addEventTouchTap(this.reward,this.onTap),this.addEventTouchTap(this,this.onCheckClick),this.addEventItemTap(this.list,this.onListTap),TimerMgr.ins().doTimerDelay(1e3,1e3,0,this.refreshTime,this),this._isFirst=!0,this.initView(),this.addCustomEvent(105,this.initView))},e.prototype.close=function(){this.closeWin()},e.prototype.closeWin=function(){egret.Tween.removeTweens(this.time);for(var t=0;t<this._panelList.length;t++)this._panelList[t]&&egret.Tween.removeTweens(this._panelList[t]),this._panelList[t].close&&this._panelList[t].close();UIMgr.ins().close(this)},e.prototype.onTap=function(t){switch(t.target){case this.btnLeft:this.curIndex>0&&(this.stopAuto(),this.updateView(this.curIndex-1,2));break;case this.btnRight:this.curIndex<this.dataList.length-1&&(this.stopAuto(),this.updateView(this.curIndex+1,1));break;case this.reward:if(this.stopAuto(),this.cfg&&this.cfg.reward){var e=this.cfg.reward[0];0==e.type?UIMgr.ins().open(CurrencyTipsView,e.id,e.count):UIMgr.ins().open(ItemTipsView,0,e.id,e.count)}}},e.prototype.onCheckClick=function(t){(t.target instanceof eui.Label||t.target.hasEventListener(egret.TouchEvent.TOUCH_TAP)||t.target instanceof BaseItemRender||t.target instanceof ItemBase||t.target.parent instanceof ItemBase||t.target.parent instanceof ItemIcon)&&this.stopAuto()},e.prototype.onListTap=function(t){this.stopAuto();var e=t.itemIndex;if(e!=this.curIndex){var i=0;(e>this.curIndex?i=1:e<this.curIndex)&&(i=2),this.updateView(e,i)}},e.prototype.checkOpen=function(){return this.dataList=trailerControl.getForeshow(),this.dataList&&0!=this.dataList.length?!0:(this.closeWin(),!1)},e.prototype.initView=function(){if(this.checkOpen()){for(var t=0,e=0;e<this.dataList.length;e++){var i=this.dataList[e];trailerControl.isReach(i)&&(t=e)}this.time.visible=!1,this.stopAuto(),this._isAuto=this._isFirst&&this.dataList.length>1,this._isFirst=!1,this.list.dataProvider=new eui.ArrayCollection(this.dataList),this.list.selectedIndex=t,this.curIndex=t,this.updateView(this.curIndex)}},e.prototype.updateView=function(t,e){void 0===e&&(e=0),this.curIndex=t,this.cfg=this.dataList[t],this.list.selectedIndex!=t&&(this.list.selectedIndex=t),this.updateBtns(),this.updateCurInfo();var i=this.panel,n=this.getViewIndex(this.cfg.skin);if(this.panel=this._panelList[n],this.panel.open(this.cfg),e>0&&i&&i!=this.panel){this.panel.x=1==e?this.panel.width:-this.panel.width,this.panel.visible=!0;var o=1==e?-i.width:i.width,s=500;egret.Tween.removeTweens(i),egret.Tween.get(i).to({x:o},s).call(function(){null!=i.close&&i.close(),i.visible=!1}),egret.Tween.removeTweens(this.panel),egret.Tween.get(this.panel).to({x:0},s)
}else i&&(null!=i.close&&i.close(),i.visible=!1),this.panel.x=0,this.panel.visible=!0;this._isAuto&&this.tweenTimeBar()},e.prototype.updateBtns=function(){this.btnRight.visible=this.curIndex<this.dataList.length-1,this.btnLeft.visible=this.curIndex>0},e.prototype.updateCurInfo=function(){if(this.cfg){var t=LangMgr.getValueByKey("tipsOpenSeverDays2",this.cfg.openDay),e=this.cfg.zsLevel>0?LangMgr.getValueByKey("zslvdadao",this.cfg.zsLevel):LangMgr.getValueByKey("zslvnoneed");if(this._leftTime=0,trailerControl.isReach(this.cfg))this.currentState="open",this.go.label=this.cfg.systemUi&&this.cfg.systemUi.length>0?LangMgr.getValueByKey("gotolook"):LangMgr.getValueByKey("zhenzhidaole"),this.dec1.textFlow=TextUtils.generateTextFlow(this.cfg.dess);else{this.currentState="show",this.dec1.textFlow=TextUtils.generateTextFlow(this.cfg.dess);var i=this.getLeftTime(this.cfg);this._leftTime=i,i>0?(t+=" |C:0x00ff00&T:("+DateUtils.getFormatBySecond(i)+")|",this.imgReach1.visible=!1):this.imgReach1.visible=!0;var n=reincarnateControl.lv;this.cfg.zsLevel>0?n<this.cfg.zsLevel?(e+=" (|C:0xff0000&T:"+n+"|/"+this.cfg.zsLevel+")",this.imgReach2.visible=!1):this.imgReach2.visible=!0:this.imgReach2.visible=!1,this.rewardShow.visible=this.cfg.reward&&this.cfg.reward.length>0}this.openText1.textFlow=TextUtils.generateTextFlow(t),this.openText2.textFlow=TextUtils.generateTextFlow(e),this.title.source=this.cfg.title}},e.prototype.getViewIndex=function(t){for(var e=0;e<this._panelList.length;e++){var i=this._panelList[e];if(i.skinName==t)return e}return this._panelList.length-1},e.prototype.onGoWin=function(){if(this.cfg){if(this.stopAuto(),!trailerControl.isGotReward(this.cfg.id)){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);trailerControl.upGetForeshowReward(this.cfg.id)}if(this.cfg.systemUi&&this.cfg.systemUi.length>0){var t=this.cfg.systemUi[0][0];"DarkHallBossView"==t&&(darkHallBossControl.checkOpen(!1)||(t="KFBattleWin")),UIMgr.ins().open(t,this.cfg.systemUi[0][1],this.cfg.systemUi[0][2])}}},e.prototype.refreshTime=function(){if(this._leftTime>0){if(this._leftTime=this.getLeftTime(this.cfg),this._leftTime<=0)return void this.updateView(this.curIndex);var t=LangMgr.getValueByKey("tipsOpenSeverDays2",this.cfg.openDay);t+=" |C:0x00ff00&T:("+DateUtils.getFormatBySecond(this._leftTime)+")|",this.openText1.textFlow=TextUtils.generateTextFlow(t)}},e.prototype.getLeftTime=function(t){if(!t)return 0;var e=0,i=GameServer.serverOpenDay+1;if(i<t.openDay){var n=new Date(GameServer.serverTime),o=t.openDay-i;n.setDate(n.getDate()+o),n.setHours(0,0,0,0),e=Math.floor((n.getTime()-GameServer.serverTime)/1e3)}return e},e.prototype.tweenTimeBar=function(){this.time.visible=!0,this.time.maximum=100,this.time.value=0,egret.Tween.removeTweens(this.time),egret.Tween.get(this.time).to({value:100},1e3*this._autoTime).call(this.tweenNext,this)},e.prototype.tweenNext=function(){var t=this.curIndex+1;t>=this.dataList.length&&(t=0),this.updateView(t,1)},e.prototype.stopAuto=function(){this._isAuto&&(this._isAuto=!1,this.time.visible=!1,egret.Tween.removeTweens(this.time),this.panel&&egret.Tween.removeTweens(this.panel))},e}(BaseEuiView);__reflect(TrailerView.prototype,"TrailerView");var Trailer10Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer10PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc()},e.prototype.update=function(){this.cfg&&(this.cfg.itemId&&this.cfg.itemId.length>0&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId)),this.updateModel())},e.prototype.updateModel=function(){if(this.clearMc(),this.cfg.modelId&&this.cfg.modelId.monster){var t=new GameMovieClip;t.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1),this.model.addChild(t),this.cfg.modelId.scale>0&&(t.scaleX=t.scaleY=this.cfg.modelId.scale/100)}},e.prototype.clearMc=function(){this.model.removeChildren()},e}(BasePanel);__reflect(Trailer10Panel.prototype,"Trailer10Panel");var Trailer11Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer11PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc()},e.prototype.update=function(){this.cfg&&(this.cfg.itemId&&this.cfg.itemId.length>0&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId)),this.updateModel())},e.prototype.updateModel=function(){this.clearMc(),this.cfg.modelId&&this.addMc(this.cfg.modelId.demoncir,this.demoncir)},e.prototype.addMc=function(t,e){if(t){var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),e.addChild(i)}},e.prototype.clearMc=function(){this.demoncir.removeChildren()},e}(BasePanel);__reflect(Trailer11Panel.prototype,"Trailer11Panel");var Trailer12Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer12PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc()},e.prototype.update=function(){this.cfg&&(this.cfg.itemId&&this.cfg.itemId.length>0&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId)),this.updateModel())},e.prototype.updateModel=function(){this.clearMc(),this.cfg.modelId&&this.addMc(this.cfg.modelId.thunder,this.thunder)},e.prototype.addMc=function(t,e){if(t){var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),e.addChild(i)}},e.prototype.clearMc=function(){this.thunder.removeChildren()},e}(BasePanel);__reflect(Trailer12Panel.prototype,"Trailer12Panel");var Trailer13Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer13PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc()},e.prototype.update=function(){this.cfg&&(this.cfg.itemId&&this.cfg.itemId.length>0&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId)),this.updateModel())},e.prototype.updateModel=function(){if(this.clearMc(),this.cfg.modelId){if(this.cfg.modelId.wing){var t=new GameMovieClip;t.playFile(PATH_CHIBANG+this.cfg.modelId.wing,-1),this.wing.addChild(t)}this.addMc(this.cfg.modelId.body,this.body),this.addMc(this.cfg.modelId.weapon,this.weapon),this.addMc(this.cfg.modelId.title,this.title)}},e.prototype.addMc=function(t,e){if(t){var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),e.addChild(i)}},e.prototype.clearMc=function(){this.body.removeChildren(),this.wing.removeChildren(),this.weapon.removeChildren(),this.title.removeChildren()},e}(BasePanel);__reflect(Trailer13Panel.prototype,"Trailer13Panel");var Trailer14Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer14PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.addEventTouchTap(this.itemList,this.onTouch),this.update()},e.prototype.update=function(){this.cfg&&(this.cfg.itemId&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId)),this.cfg.modelId&&(this.mc||(this.mc=new GameMovieClip,this.model.addChild(this.mc)),this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1)))},e.prototype.onTouch=function(t){},e.prototype.close=function(){this.mc&&(this.mc.dispose(),this.mc=null,this.model.removeChildren())},e}(BasePanel);__reflect(Trailer14Panel.prototype,"Trailer14Panel");var Trailer15Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer15PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.update=function(){this.cfg&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId))},e}(BasePanel);__reflect(Trailer15Panel.prototype,"Trailer15Panel");var Trailer16Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer16PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.update(),this.addEventTouchTap(this.skill,this.onTouch),this.items=[];for(var e=0;8>e;e++){var i=this["equip"+e];this.items.push(i),this.addEventTouchTap(i,this.onItemTouch)}},e.prototype.close=function(){this.mc.dispose()},e.prototype.update=function(){if(this.cfg&&(this.cfg.modelId&&(this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_EFF+this.cfg.modelId.effect,-1)),this.cfg.itemId))for(var t=0;8>t;t++){var e=this.cfg.itemId[t];this.updateItem(t,e)}},e.prototype.updateItem=function(t,e){var i=this["equip"+t];if(i){i.touchChildren=!1;var n=i.itemIcon;if(n.imgJob.visible=!1,i.level.visible=!1,n.imgIcon.source="hungu"+t,i.select.visible=!1,n.imgBg.source=1>=t?"wupingkuangNB":"quality0",e){var o=DataCenter.ins().ItemConfig[e.id];n.imgIcon.source=o.icon+"_png"}i.level.visible=!1}},e.prototype.onTouch=function(){UIMgr.ins().open(SoulBoneSuitTrailerView,2,this.cfg)},e.prototype.onItemTouch=function(t){var e=this.items.indexOf(t.target);if(-1!=e&&this.cfg&&this.cfg.itemId){var i=this.cfg.itemId[e];i&&UIMgr.ins().open(SoulBoneTipsView,!1,0,i.id)}},e}(BasePanel);__reflect(Trailer16Panel.prototype,"Trailer16Panel");var Trailer17Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer17PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc(),this.mc.dispose()},e.prototype.update=function(){this.cfg&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId),this.updateModel())},e.prototype.updateModel=function(){this.clearMc(),this.cfg.modelId&&(this.mc.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1),this.cfg.modelId.scale>0&&(this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100),this.addMc(this.cfg.modelId.eff1,this.eff1),this.addMc(this.cfg.modelId.eff2,this.eff2),this.addMc(this.cfg.modelId.eff3,this.eff3))},e.prototype.addMc=function(t,e){if(t){var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),e.addChild(i)}},e.prototype.clearMc=function(){this.eff1.removeChildren(),this.eff2.removeChildren(),this.eff3.removeChildren()},e}(BasePanel);__reflect(Trailer17Panel.prototype,"Trailer17Panel");var Trailer18Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer18PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc()},e.prototype.update=function(){this.cfg&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId),this.clearMc(),this.cfg.modelId&&(this.addMc(this.cfg.modelId.bodyEff,this.bodyEff),this.addMc(this.cfg.modelId.weaponEff0,this.weaponEff0),this.addMc(this.cfg.modelId.weaponEff1,this.weaponEff1),this.addMc(this.cfg.modelId.weaponEff2,this.weaponEff2),this.addMc(this.cfg.modelId.titleEff,this.titleEff)))},e.prototype.addMc=function(t,e){if(t){var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),e.addChild(i)}},e.prototype.clearMc=function(){this.bodyEff.removeChildren(),this.weaponEff0.removeChildren(),this.weaponEff1.removeChildren(),this.weaponEff2.removeChildren(),this.titleEff.removeChildren()},e}(BasePanel);__reflect(Trailer18Panel.prototype,"Trailer18Panel");var Trailer19Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer19PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.addEventTouchTap(this.suit1,this.onTouch),this.addEventTouchTap(this.suit2,this.onTouch),this.update()},e.prototype.close=function(){this.mc.dispose()},e.prototype.onTouch=function(t){switch(t.target){case this.suit1:UIMgr.ins().open(DarkSuitTrailerView,1);break;case this.suit2:UIMgr.ins().open(DarkSuitTrailerView,2)}},e.prototype.update=function(){this.cfg&&this.cfg.modelId&&(this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1))},e}(BasePanel);__reflect(Trailer19Panel.prototype,"Trailer19Panel");var Trailer1Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer1PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e.itemList.itemRenderer=ItemBaseNoName,e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.update()},e.prototype.close=function(){this.mc.dispose()},e.prototype.update=function(){this.cfg&&(this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1),this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId))},e}(BasePanel);__reflect(Trailer1Panel.prototype,"Trailer1Panel");var Trailer20Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer20PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){var e=this;this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,SkillEffPlayShow.bottomLayer=this.skillShow,SkillEffPlayShow.topLayer=this.skillShow,SkillEffPlayShow.setTimeout=function(t,e,i){TimerMgr.ins().doTimer(t,1,e,i)},SkillEffPlayShow.shake=function(t,i,n,o,s){s=s||1,t==UnitMgr.ins().getMainRole(0)&&Math.random()<s&&DisplayUtils.shakeIt(e.skillShow,i,n,o)},this.myself=new UnitRole,this.myself.x=this.bodyGroup.x,this.myself.y=this.bodyGroup.y,this.skillShow.addChild(this.myself),this.targetMonster=new UnitMonster,this.targetMonster.x=this.targetGroup.x,this.targetMonster.y=this.targetGroup.y,this.targetMonster.hideBodyContainer(),this.skillShow.addChild(this.targetMonster),this.myself.showBlood(!1),this.myself.showNeigong(!1),this.myself.initBody(PATH_RENWU+this.cfg.modelId.body),this.myself.setWeaponFileName(this.cfg.modelId.weapon),this.myself.setWingFileName(this.cfg.modelId.wing),this.myself.dir=this.cfg.modelId.dir,this.update()},e.prototype.close=function(){SkillEffPlayShow.bottomLayer=null,SkillEffPlayShow.topLayer=null,SkillEffPlayShow.setTimeout=null,SkillEffPlayShow.shake=null,TimerMgr.ins().removeAll(this),DisplayUtils.removeFromParent(this.myself),DisplayUtils.removeFromParent(this.targetMonster)},e.prototype.playSkillEff=function(t){for(var e=this,i=this.skillShow.getChildIndex(this.targetMonster);this.skillShow.numChildren>i+1;)this.skillShow.removeChildAt(this.skillShow.numChildren-1);TimerMgr.ins().removeAll(this);var n=function(){e.myself.playAction(t.actionType),SkillEffPlayShow.play(t.effectId,e.myself,[e.targetMonster],function(t){var i=DamageControl.ins().createDamageObj(1024,"z99999999","j0",0,0,1,!0);i.touchChildren=!1,e.wordGroup.addChild(i);var n=egret.Tween.get(i);n.to({y:i.y-50,alpha:0},500).call(function(){DisplayUtils.removeFromParent(i)},e)})};n(),TimerMgr.ins().doTimer(1e3,0,n,this)},e.prototype.update=function(){if(this.cfg&&(this.cfg.itemId&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId)),this.cfg.modelId&&this.cfg.modelId.skill)){var t=DataCenter.ins().SkillsDescConfig[this.cfg.modelId.skill];this.playSkillEff(t)}},e}(BasePanel);__reflect(Trailer20Panel.prototype,"Trailer20Panel");var Trailer21Panel=function(t){function e(){var e=t.call(this)||this;return e.curSelect=0,e.curSuitNum=0,e.curSuitLv=0,e.stageLv=0,e.lingLv=0,e.job=0,e.id=0,e.skinName="Trailer21PanelSkin",e}return __extends(e,t),e.prototype.close=function(){this.tuteng.close(),this.onRemove()},e.prototype.open=function(t){this.addEventTouchTap(this.tuteng0,this.onTouch),this.addEventTouchTap(this.tuteng1,this.onTouch),this.addEventTouchTap(this.tuteng2,this.onTouch),this.addEventTouchTap(this.skill0,this.onTouch),this.cfg=t,this.curSelect=0,this.update(),this.addEventTouch()},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.tuteng0:this.onRemove(),this.curSelect=0,this.addEventTouch();break;case this.tuteng1:this.onRemove(),this.curSelect=1,this.addEventTouch();break;case this.tuteng2:this.onRemove(),this.curSelect=2,this.addEventTouch();break;case this.skill0:UIMgr.ins().open(TotemSkillTipsShowView,this.job,this.id,this.curSuitNum,this.curSuitLv);break;default:if(!this["tutengGroup"+this.curSelect])return;for(var e=0;e<this["tutengGroup"+this.curSelect].numChildren;e++)if(this["zb"+this.curSelect+"_name"+e]==t.currentTarget){var i=this.tuteng["pos"+(e+1)].skinName;UIMgr.ins().open(TotemIntroTipsShowView,this.job,this.id,e+1,i,this.stageLv,this.lingLv)}}this.update()},e.prototype.addEventTouch=function(){if(this["tutengGroup"+this.curSelect])for(var t=0;t<this["tutengGroup"+this.curSelect].numChildren;t++)this["zb"+this.curSelect+"_name"+t]&&this.addEventTouchTap(this["zb"+this.curSelect+"_name"+t],this.onTouch)},e.prototype.onRemove=function(){if(this["tutengGroup"+this.curSelect])for(var t=0;t<this["tutengGroup"+this.curSelect].numChildren;t++)this["zb"+this.curSelect+"_name"+t]&&this.removeEventTouchTap(this["zb"+this.curSelect+"_name"+t],this.onTouch)},e.prototype.update=function(){if(this.cfg){var t=this.cfg.modelId;if(t)for(var e=t.data,i=t.desc,n=0;n<e.length;n++)if(this["tutengGroup"+n]&&(this["tutengGroup"+n].visible=!1),this["tuteng"+n]){var o=e[n].job,s=e[n].id,r=e[n].lv,a=e[n].stageLv,l=e[n].suitNum,h=e[n].suitLv,u=e[n].lingLv,p=DataCenter.ins().TotemPartConfig[o][s][1];if(this["tuteng"+n].icon=p.icon,this.curSelect==n){this.job=o,this.id=s,this.curSuitNum=l,this.curSuitLv=h,this.stageLv=a,this.lingLv=u,this["tutengGroup"+n]&&(this["tutengGroup"+n].visible=!0);for(var c=0;c<i[n].length;c++)this["zb"+this.curSelect+"_name"+c]&&(this["zb"+this.curSelect+"_name"+c].text=i[n][c]);this.tuteng&&this.tuteng.open(o,s,r,a,u)}}}},e}(BasePanel);__reflect(Trailer21Panel.prototype,"Trailer21Panel");var Trailer22Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer22PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.update=function(){this.cfg&&this.cfg.itemId&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId))},e}(BasePanel);__reflect(Trailer22Panel.prototype,"Trailer22Panel");var Trailer23Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer23PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.update=function(){this.cfg&&this.cfg.itemId&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId))},e}(BasePanel);__reflect(Trailer23Panel.prototype,"Trailer23Panel");var Trailer2Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer2PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e.itemList.itemRenderer=ItemBaseNoName,e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.addEventTouchTap(this.skill,this.onSkillTap),this.update()},e.prototype.close=function(){this.cfg=null,this.gwsconfig=null,this.removeEventTouchTap(this.skill,this.onSkillTap),this.mc.dispose()},e.prototype.update=function(){if(this.cfg){this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1),this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId);var t=null;for(var e in DataCenter.ins().FeatherDeitySuitConfig){var i=DataCenter.ins().FeatherDeitySuitConfig[e];(null==t||i.lv>t.lv)&&(t=i)}this.isActive=!1,this.gwsconfig=t}},e.prototype.onSkillTap=function(t){UIMgr.ins().open(FeatherDeitySkillTipsView,this.gwsconfig,this.isActive)},e}(BasePanel);__reflect(Trailer2Panel.prototype,"Trailer2Panel");var Trailer3Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer3PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.clearMc()},e.prototype.update=function(){this.cfg&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId),this.updateModel())},e.prototype.updateModel=function(){this.clearMc(),this.cfg.modelId&&(this.addMc(this.cfg.modelId.weaponEff,this.weaponEffect),this.addMc(this.cfg.modelId.bodyEff,this.bodyEffect),this.addMc(this.cfg.modelId.wingEff,this.wingEffect),this.addMc(this.cfg.modelId.titleEff,this.titleMcGroup))},e.prototype.addMc=function(t,e){if(t){var i=new GameMovieClip;i.playFile(PATH_EFF+t,-1),e.addChild(i)}},e.prototype.clearMc=function(){this.weaponEffect.removeChildren(),this.bodyEffect.removeChildren(),this.wingEffect.removeChildren(),this.titleMcGroup.removeChildren()},e}(BasePanel);__reflect(Trailer3Panel.prototype,"Trailer3Panel");var Trailer4Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer4PanelSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.skill0,this.onTap),this.addEventTouchTap(this.skill1,this.onTap),this.addEventTouchTap(this.skill2,this.onTap)},e.prototype.onTap=function(t){var e=0;switch(t.currentTarget){case this.skill0:e=0;break;case this.skill1:e=1;break;case this.skill2:e=2}UIMgr.ins().open(GodWeaponSkillTrailerView,e+1)},e}(BasePanel);__reflect(Trailer4Panel.prototype,"Trailer4Panel");var Trailer5Panel=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.skinName="Trailer5PanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.cfg=t[0],this.type=t[1]||0,this.itemList.itemRenderer=ItemBaseNoName,this.update()},e.prototype.close=function(){this.mc&&(this.mc.destroy(),this.mc=null,this.model.removeChildren())},e.prototype.update=function(){this.cfg&&(this.itemList.dataProvider=new eui.ArrayCollection(this.cfg.itemId),this.cfg.modelId&&(this.mc||(this.mc=new GameMovieClip,this.model.addChild(this.mc)),this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_GUAIWU+this.cfg.modelId.monster,-1)))},e}(BasePanel);__reflect(Trailer5Panel.prototype,"Trailer5Panel");var Trailer6Panel=function(t){function e(){var e=t.call(this)||this;return e._angle=.1,e._angles=[0,0,0,0,0,0,0],e._circleCenter={x:279,y:229},e._a=155,e._b=80,e.skinName="Trailer6PanelSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.skill0,this.onTouch),this.addEventTouchTap(this.skill1,this.onTouch),this.addEventTouchTap(this.skill2,this.onTouch),this.addEventTouchTap(this.skill3,this.onTouch),this.addEventTouchTap(this.skill4,this.onTouch),this.addEventTouchTap(this.skill5,this.onTouch),this.addEventTouchTap(this.skill6,this.onTouch),this.initBall(),this.update()},e.prototype.close=function(){if(TimerMgr.ins().removeAll(this),this._balls&&this._balls.length>0)for(var t=0;t<this._balls.length;t++){var e=this._balls[t];e.destroy()}this._balls=null},e.prototype.initBall=function(){this._balls||(this._balls=[],TimerMgr.ins().doTimer(51,0,this.doCircle,this));for(var t,e=7,i=2*Math.PI/e,n=0;e>n;n++)t=ObjectPool.pop("GameMovieClip"),this.img.parent.addChild(t),this._angles[n]=i*n,t.x=this._a*Math.cos(i*n)+this._circleCenter.x,t.y=this._b*Math.sin(i*n)+this._circleCenter.y,this._balls.push(t),t.playFile(PATH_EFF+"lymarkeff",-1)},e.prototype.doCircle=function(){if(!this._balls)return void TimerMgr.ins().removeAll(this);for(var t,e,i=this._balls.length,n=0,o=0,s=0;i>s;s++)t=this._balls[s],t.x=this._a*Math.cos(this._angles[s])+this._circleCenter.x,t.y=this._b*Math.sin(this._angles[s])+this._circleCenter.y,this._angles[s]+=this._angle,this._angles[s]=this._angles[s]%(2*Math.PI),e=t.parent,e&&(n=e.getChildIndex(this.img),o=e.getChildIndex(t),this._angles[s]>=2.5&&this._angles[s]<=6?o>n&&e.addChildAt(t,3):n>o&&e.addChildAt(t,e.numChildren))},e.prototype.update=function(){for(var t,e=0;6>e;e++){var i=DataCenter.ins().FlameMarkEffectConfig[e+1],n=CommonUtils.getObjectLength(i);t=i[n];var o=this["skill"+(e+1)];o&&(o.isShow=!0,o.setCfg(t))}},e.prototype.onTouch=function(t){switch(t.target){case this.skill0:UIMgr.ins().open(FireRingAbilityView);break;case this.skill1:case this.skill2:case this.skill3:case this.skill4:case this.skill5:case this.skill6:UIMgr.ins().open(FlameMarkSkillTipsView,t.target.getCfg(),!0)}},e}(BasePanel);__reflect(Trailer6Panel.prototype,"Trailer6Panel");var Trailer7Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer7PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.addEventTouchTap(this.skill0,this.onSkillTap),this.addEventTouchTap(this.skill1,this.onSkillTap),this.addEventTouchTap(this.skill2,this.onSkillTap),this.addEventTouchTap(this.skill3,this.onSkillTap),this.update()},e.prototype.close=function(){this.mc&&this.mc.dispose()},e.prototype.update=function(){this.cfg&&(this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_EFF+this.cfg.modelId.effect,-1))},e.prototype.onSkillTap=function(t){var e=1;switch(t.currentTarget){case this.skill0:e=1;break;case this.skill1:e=2;break;case this.skill2:e=3;break;case this.skill3:e=4}UIMgr.ins().open(HeartMethodSkillTipsView,-1,e)},e}(BasePanel);__reflect(Trailer7Panel.prototype,"Trailer7Panel");var Trailer8Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer8PanelSkin",e.mc=new GameMovieClip,e.model.addChild(e.mc),e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.update()},e.prototype.close=function(){this.mc.dispose()},e.prototype.update=function(){if(this.cfg){this.mc.scaleX=this.mc.scaleY=this.cfg.modelId.scale/100,this.mc.playFile(PATH_EFF+this.cfg.modelId.effect,-1);for(var t=0;5>t;t++){var e=DataCenter.ins().AshtarteTalentConfig[t][1];e.talentDesc&&e.talentDesc.icon?this["skillIcon"+t].source=e.talentDesc.icon:e.passive&&(this["skillIcon"+t].source=1e3*Math.floor(e.passive[0].id/1e3)+"_png"),this["skillIcon"+t].touchEnabled=!0,this.addEventTouchTap(this["skillIcon"+t],this.onSkillTap)}}},e.prototype.onSkillTap=function(t){var e=0;switch(t.currentTarget){case this.skillIcon0:e=0;break;case this.skillIcon1:e=1;break;case this.skillIcon2:e=2;break;case this.skillIcon3:e=3;break;case this.skillIcon4:e=4}UIMgr.ins().open(AshtarteSkillTipsView,e)},e}(BasePanel);__reflect(Trailer8Panel.prototype,"Trailer8Panel");var Trailer9Panel=function(t){function e(){var e=t.call(this)||this;return e.skinName="Trailer9PanelSkin",e}return __extends(e,t),e.prototype.open=function(t){this.cfg=t,this.items=[];for(var e=1;5>=e;e++){var i=this["item"+e];i.touchChildren=!1,this.addEventTouchTap(i,this.onItemTap),this.items.push(i)}this.update(),this.startBeatAnimat()},e.prototype.close=function(){this.stopBeatAnimat()},e.prototype.update=function(){for(var t=0;5>t;t++){var e=this["skill"+t];if(e){e.touchChildren=!1,this.addEventTouchTap(e,this.onSkillTap);var i=Number(e.name);if(i>0){var n=DataCenter.ins().BeastSkillConfig[i];e.skillImg.source=n.icon,e.skillName.text=n.name,e.skillQuality.source="quality"+n.quality}}}for(var t=0;t<this.items.length;t++){var o=this.items[t],i=this.cfg.itemId&&this.cfg.itemId[t]?this.cfg.itemId[t].id:0;o.data=i}},e.prototype.onSkillTap=function(t){("BeastSkillItemRendererSkin"==t.target.parent.skinName||"BeastSkillItemRendererSkin"==t.target.skinName)&&UIMgr.ins().open(BeastSkillTipView,DataCenter.ins().BeastSkillConfig[t.target.name])},e.prototype.onItemTap=function(t){if(t.target.data>0){var e=this.items.indexOf(t.target);UIMgr.ins().open(BeastEquipTipView,0,e+1,t.target.data)}},e.prototype.startBeatAnimat=function(){this.imgCopy||(this.imgCopy=new eui.Image),this.imgCopy.touchEnabled=!1,this.imgCopy.source=this.shenshouImg.source,this.imgCopy.visible=!1,this.addChild(this.imgCopy),TimerMgr.ins().doTimer(4e3,0,this.runTween,this),TimerMgr.ins().doTimer(500,1,this.runTween,this)},e.prototype.runTween=function(){this.imgCopy.visible=!0,this.imgCopy.alpha=0,this.imgCopy.scaleX=this.imgCopy.scaleY=1,this.imgCopy.x=this.shenshouImg.x+(this.shenshouImg.width>>1),this.imgCopy.y=this.shenshouImg.y+(this.shenshouImg.height>>1),this.imgCopy.anchorOffsetX=this.shenshouImg.width>>1,this.imgCopy.anchorOffsetY=this.shenshouImg.height>>1,this.imgCopy.top=this.shenshouImg.top,this.imgCopy.horizontalCenter=this.shenshouImg.horizontalCenter,Tween.get(this.imgCopy).to({alpha:1},250).to({alpha:0,scaleX:1.2,scaleY:1.2},2e3,egret.Ease.cubicInOut)},e.prototype.stopBeatAnimat=function(){TimerMgr.ins().removeAll(this),this.imgCopy&&(Tween.removeTweens(this.imgCopy),this.imgCopy.visible=!1)},e}(BasePanel);__reflect(Trailer9Panel.prototype,"Trailer9Panel");var TreasureHuntControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upHunt=function(t){return[t]},e.prototype.upHuntList=function(){},e.prototype.downHuntResult=function(t,e){UIMgr.ins().isShow(TreasureHuntResultView)?this.dispatchHuntResult(t,e,0):(UIMgr.ins().open(TreasureHuntResultView,t,e,0),this.dispatchHuntResult(t,e,0))},e.prototype.dispatchHuntResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().dispatch(224,t)},e.prototype.downBestListInfo=function(t){t.reverse(),EventMgr.ins().dispatch(225,t)},__decorate([up(1,[2])],e.prototype,"upHunt",null),__decorate([up(2)],e.prototype,"upHuntList",null),__decorate([down(1,[2,[3,3]])],e.prototype,"downHuntResult",null),__decorate([down(2,[[8,3]])],e.prototype,"downBestListInfo",null),e=__decorate([protocolsId(22)],e)}(BaseSystem);__reflect(TreasureHuntControl.prototype,"TreasureHuntControl");var WeaponsSoulControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkRedPoint=function(t){if(!SwitchMgr.ins().checkOpen(17))return!1;var e=heroControl.getSubRoleByIndex(t);for(var i in DataCenter.ins().WeaponSoulConfig){var n=DataCenter.ins().WeaponSoulConfig[i];if(e.weapons.getRedPointBySuit(n.id))return!0}var o=IntensifyRedPoint.ins().getFlexibleRedPoint(t);if(o)return!0;var s=backpackControl.getBagItemById(DataCenter.ins().WeaponSoulBaseConfig.itemid);return s&&e.weapons.flexibleCount-1<DataCenter.ins().WeaponSoulBaseConfig.maxItemNum},e.prototype.checkIsUseFlexible=function(t,e){var i=heroControl.getSubRoleByIndex(t);return-1!=i.weapons.getFlexibleData().indexOf(e)},e.prototype.getWeaponsCount=function(){for(var t=0,e=0;e<heroControl.subRolesLen;e++){var i=heroControl.getSubRoleByIndex(e);if(i.weapons){var n=i.weapons.getSoulInfoData();if(n)for(var o in n)n[o].id&&t++}}return t},e.prototype.upWeaponsUpLevel=function(t,e){return[t,e]},e.prototype.upWeaponsAct=function(t,e){return[t,e]},e.prototype.upWeaponsUse=function(t,e){return[t,e]},e.prototype.upWeaponsFlexibleAct=function(t,e,i){return[t,e,i]},e.prototype.upWeaponsFlexibleCount=function(t){return[t]},e.prototype.downWeaponsInfo=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var n=heroControl.getSubRoleByIndex(t);n.weapons.init(e),EventMgr.ins().dispatch(139)},e.prototype.downWeaponsUpLevel=function(t,e,i){var n=heroControl.getSubRoleByIndex(t);n.weapons.initInfoOnly(e,i),EventMgr.ins().dispatch(140)},e.prototype.downWeaponsAct=function(t,e){var i=heroControl.getSubRoleByIndex(t);i.weapons.initSoulInfoOnly(e,t),EventMgr.ins().dispatch(141)},e.prototype.downWeaponsUse=function(t,e){var i=heroControl.getSubRoleByIndex(t);i.weapons.weaponsId=e;var n=UnitMgr.ins().getEntityByHandle(i.handle);n&&n.updateModel(),EventMgr.ins().dispatch(142)},e.prototype.downWeaponsFlexibleAct=function(t,e,i){var n=heroControl.getSubRoleByIndex(t),o=n.weapons.getFlexibleData();if(0==e)-1==o.indexOf(i)&&o.push(i);else for(var s=0;s<o.length;s++)if(o[s]==i){o.splice(s,1);break}EventMgr.ins().dispatch(143)},e.prototype.downWeaponsFlexibleCount=function(t,e){var i=heroControl.getSubRoleByIndex(t);i&&(i.weapons.flexibleCount=e?e+1:0),EventMgr.ins().dispatch(144)},__decorate([up(1,[1,2])],e.prototype,"upWeaponsUpLevel",null),__decorate([up(2,[1,2])],e.prototype,"upWeaponsAct",null),__decorate([up(3,[1,2])],e.prototype,"upWeaponsUse",null),__decorate([up(4,[1,1,2])],e.prototype,"upWeaponsFlexibleAct",null),__decorate([up(5,[1])],e.prototype,"upWeaponsFlexibleCount",null),__decorate([down(0,[4,[2,3],[2],[2],2])],e.prototype,"downWeaponsInfo",null),__decorate([down(1,[4,2,3])],e.prototype,"downWeaponsUpLevel",null),__decorate([down(2,[4,2])],e.prototype,"downWeaponsAct",null),__decorate([down(3,[4,2])],e.prototype,"downWeaponsUse",null),__decorate([down(4,[4,4,2])],e.prototype,"downWeaponsFlexibleAct",null),__decorate([down(5,[1,2])],e.prototype,"downWeaponsFlexibleCount",null),e=__decorate([protocolsId(56)],e)
}(BaseSystem);__reflect(WeaponsSoulControl.prototype,"WeaponsSoulControl");var TreasureHuntBoxsTipsView=function(t){function e(){var e=t.call(this)||this;return e.type=0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="TreasureHuntBoxsTipsViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],t.length>=2&&(this.type=t[1],this.activityID=t[2]),this.addEventTouchTap(this.bgClose,this.onTap),this.gift.itemRenderer=ItemBase,3==this.type?this.initActivity():2==this.type?this.initHeirloom():this.initInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.initInfo=function(){var t=DataCenter.ins().TreasureRuneRewardConfig[this.index];if(t)if(this.gift.dataProvider=new eui.ArrayCollection(t.reward),this.num0.text=runeControl.runeCount.toString(),0==runeControl.boxs[this.index-1]){var e=t.needTime-runeControl.runeCount;this.num1.text=e>0?e+"":"0",this.already.visible=!1}else this.num1.visible=this.num2.visible=this.num3.visible=!1,this.already.visible=!0},e.prototype.initHeirloom=function(){var t=DataCenter.ins().HeirloomTreasureRewardConfig[this.index];if(t)if(this.gift.dataProvider=new eui.ArrayCollection(t.reward),this.num0.text=heirloomControl.huntTimes.toString(),heirloomControl.huntBoxInfo[this.index-1]==HeirloomControl.UNGET){var e=t.needTime-heirloomControl.huntTimes;this.num1.text=e>0?e+"":"0",this.already.visible=!1}else this.num1.visible=this.num2.visible=this.num3.visible=!1,this.already.visible=!0},e.prototype.initActivity=function(){var t=DataCenter.ins().Amusement18Config[this.activityID][this.index];this.gift.dataProvider=new eui.ArrayCollection(t.rewards);var e=amusementControl.getAmusementDataById(this.activityID);this.num0.text=e.num+"";var i=t.dbCount-e.num;this.num1.text=i>0?i+"":"0",1==e.getStateByIndex(this.index)?this.already.visible=!0:this.already.visible=!1},e.prototype.onTap=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(TreasureHuntBoxsTipsView.prototype,"TreasureHuntBoxsTipsView");var TreasureHuntExShopView=function(t){function e(){var e=t.call(this)||this;return e.curSelectIndex=0,e.isTopLevel=!0,e.skinName="TreasureHuntExShopViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.panelArr=[this.runeShop],this.viewStack.selectedIndex=0,this.tab.dataProvider=this.viewStack},e.prototype.destoryView=function(){t.prototype.destoryView.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.tab,this.onTabTouch),this.runeShop.curRole=0,this.setSelectedIndex(0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.tab,this.onTabTouch),this.removeCustomEvents(),this.panelArr[this.curSelectIndex].close()},e.prototype.onTabTouch=function(t){this.setOpenIndex(this.tab.selectedIndex)},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.runeShop.open()}},e.prototype.onClick=function(t){},e.prototype.setSelectedIndex=function(t){this.curSelectIndex=t,this.panelArr[t].open(),this.viewStack.selectedIndex=t},e}(BaseEuiView);__reflect(TreasureHuntExShopView.prototype,"TreasureHuntExShopView");var TreasureHuntPanel=function(t){function e(){var e=t.call(this)||this;return e.huntType=0,e.name=LangMgr.getValueByKey("nEquipTips3"),e}return __extends(e,t),e.prototype.init=function(){this.updateDescEx();var t;amusementControl.IsHefuXunBaoTimer()?(this.bdsz.visible=!1,t=DataCenter.ins().TreasureEquipHefuPoolConfig):t=DataCenter.ins().TreasureEquipPoolConfig,this.id1=t[1].reward[0].id,this.id2=t[2].reward[0].id,this.list1.itemRenderer=ItemBase,this.list2.itemRenderer=ItemBase,this.list1.dataProvider=new eui.ArrayCollection(t[3].reward),this.list2.dataProvider=new eui.ArrayCollection(t[4].reward);DataCenter.ins().ItemConfig;this.mc1=new GameMovieClip,this.mc1.x=this.icon1.x+30,this.mc1.y=this.icon1.y+25,this.mc1.scaleX=this.mc1.scaleY=1,this.chuanqi.addChild(this.mc1),this.mc2=new GameMovieClip,this.mc2.x=this.icon2.x+30,this.mc2.y=this.icon2.y+27,this.mc2.scaleX=this.mc2.scaleY=1,this.chuanqi.addChild(this.mc2),this.list.itemRenderer=TreasureHuntListItemRenderer,this.listRefush([]),this.longZhuEff=new GameMovieClip,this.longZhuEff.x=60,this.longZhuEff.y=30,this.longZhuEff.touchEnabled=!1,this.eff=new GameMovieClip,this.eff.x=this.btnGroup.width/2,this.eff.y=this.btnGroup.height/2,this.eff.scaleX=.5,this.eff.scaleY=.65,this.eff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.init(),this.costIcon1.source="200165_png",this.costIcon10.source="200165_png",this.longZhuEff.playFile(PATH_EFF+"longzubaozangeff",-1),this.titleMcGroup.addChild(this.longZhuEff),this.addEventTouchTap(this.buy1,this.onBuy),this.addEventTouchTap(this.buy10,this.onBuy),this.addEventTouchTap(this.outBag,this.onBuy),this.addEventTouchTap(this.icon1,this.onClick),this.addEventTouchTap(this.icon2,this.onClick),this.addCustomEvent(225,this.listRefush),this.addCustomEvent(266,this.setRedStatu),this.addCustomEvent(224,this.callHuntResult),this.mc1.playFile(PATH_EFF+"chuanqizbeff",-1),this.mc2.playFile(PATH_EFF+"chuanqizbeff",-1),this.listRefush([]),treasureHuntControl.upHuntList(),this.setRedStatu()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.buy1,this.onBuy),this.removeEventTouchTap(this.buy10,this.onBuy),this.removeEventTouchTap(this.icon1,this.onClick),this.removeEventTouchTap(this.icon2,this.onClick),this.removeEventTouchTap(this.outBag,this.onBuy),DisplayUtils.removeFromParent(this.eff),this.removeCustomEvents()},e.prototype.setRedStatu=function(){var t=Boolean(backpackControl.getHuntGoods(0).length);t?(this.outBag.parent.addChildAt(this.eff,this.getChildIndex(this.outBag)),this.eff.playFile(PATH_EFF+"chargeff1",-1)):DisplayUtils.removeFromParent(this.eff),this.redPoint2.visible=t},e.prototype.listRefush=function(t){this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(0);break;case this.buy10:this.buyHunt(1);break;case this.outBag:UIMgr.ins().open(TreasureHuntStoreView,0)}},e.prototype.buyHunt=function(t){this.huntType=t;var e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureEquipConfig.huntItem);if(e&&e.count)treasureHuntControl.upHunt(t);else{var i=0==t?DataCenter.ins().TreasureEquipConfig.huntOnce:DataCenter.ins().TreasureEquipConfig.huntTenth;TreasureHuntWarnBuyView.showBuyWarn("TreasureHuntPanel-HuntResultWin"+t,this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",i,DataCenter.ins().ItemConfig[DataCenter.ins().TreasureEquipConfig.huntItem].name,t?10:1))}},e.prototype.huntWarnFun=function(){var t=0==this.huntType?DataCenter.ins().TreasureEquipConfig.huntOnce:DataCenter.ins().TreasureEquipConfig.huntTenth;ActorControl.yb>=t?treasureHuntControl.upHunt(this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.onClick=function(t){switch(t.target){case this.icon1:UIMgr.ins().open(EquipTipsView,1,void 0,this.id1);break;case this.icon2:UIMgr.ins().open(EquipTipsView,1,void 0,this.id2)}},e.prototype.callHuntResult=function(){this.updateDescEx()},e.prototype.updateDescEx=function(){var t=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureEquipConfig.huntItem),e=t?t.count:0;this.num1.textFlow=TextUtils.generateTextFlow("<font color="+(e?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR)+">"+e+"</font> "),this.buy1RedPoint.visible=e>0,this.num10.textFlow=TextUtils.generateTextFlow("<font color="+(e>=10?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR)+">"+e+"</font> "),this.buy10RedPoint.visible=e>=10,this.zb1.text=DataCenter.ins().TreasureEquipConfig.huntOnce+"",this.zb10.text=DataCenter.ins().TreasureEquipConfig.huntTenth+""},e}(BasePanel);__reflect(TreasureHuntPanel.prototype,"TreasureHuntPanel");var TreasureHuntRareGiftView=function(t){function e(){var e=t.call(this)||this;return e.maxNum=0,e.lastSelected=-1,e.skinName="TreasureHuntSelectViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.id=t[1],this.num=t[2],this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(666,this.otherClose),this.addEventTouchEnd(this.minBtn0,this.onTap),this.addEventTouchEnd(this.maxBtn0,this.onTap),this.addEventTouchEnd(this.sub1Btn0,this.onTap),this.addEventTouchEnd(this.add1Btn0,this.onTap),this.addEventChange(this.numLabel0,this.onTxtChange),this.numLabel0.restrict="0-9",this.numLabel0.text="0",this.add.touchEnabled=!1,this.add.touchChildren=!1,this.update()},e.prototype.update=function(){var t=DataCenter.ins().OptionalGiftConfig[this.id];this.gift.itemRenderer=TreasureHuntRareItemRenderer,t.show[0].reward.length<=4?this.currentState="special":this.currentState="normal",this.validateNow(),this.gift.dataProvider=new eui.ArrayCollection(t.show[0].reward),this.gift.validateNow(),this.choose.textFlow=TextUtils.generateTextFlow1(t.show[0].str),this.maxNum=this.num,this.useNum=0},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onTouch),this.lastSelected=-1},e.prototype.onTouch=function(t){if(t.target==this.get){if(this.gift.selectedIndex<0)return void tipsControl.showTips(LangMgr.getValueByKey("titleTips13"));if(!this.useNum)return void tipsControl.showTips(LangMgr.getValueByKey("titleTips14"));backpackControl.upChoosableGift(this.id,this.useNum,this.gift.selectedIndex)}else t.target.parent==this.gift?(this.lastSelected>=0&&this.gift.getChildAt(this.lastSelected).checkSelcted(this.gift.selectedIndex),this.lastSelected=this.gift.selectedIndex,this.gift.dataProvider&&this.lastSelected>-1&&this.lastSelected<this.gift.dataProvider.length&&this.gift.getChildAt(this.lastSelected).checkSelcted(this.gift.selectedIndex),this.add.touchChildren=!0,this.useNum=this.num,this.numLabel0.text=this.useNum+""):t.target==this.bgClose&&this.otherClose()},e.prototype.otherClose=function(){UIMgr.ins().close(this)},e.prototype.onTap=function(t){switch(t.target){case this.minBtn0:this.useNum=1;break;case this.maxBtn0:this.useNum=this.maxNum;break;case this.sub1Btn0:this.useNum--,this.useNum<=0&&(this.useNum=1);break;case this.add1Btn0:this.useNum++,this.useNum>this.maxNum&&(this.useNum=this.maxNum)}this.numLabel0.text=this.useNum+""},e.prototype.onTxtChange=function(t){var e=Number(this.numLabel0.text);e>this.maxNum?e=this.maxNum:0>=e&&(e=1),this.useNum=e,this.numLabel0.text=this.useNum+""},e}(BaseEuiView);__reflect(TreasureHuntRareGiftView.prototype,"TreasureHuntRareGiftView");var TreasureHuntRarePanel=function(t){function e(){var e=t.call(this)||this;return e.addBoxEvent=!1,e.huntType=0,e.name=LangMgr.getValueByKey("equipment3"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init(),this.costIcon1.source="200300_png",this.costIcon10.source="200300_png"},e.prototype.init=function(){for(var t,e=DataCenter.ins().HeirloomTreasureConfig.boxes.length,i=0;e>i;i++)t=this["gift"+i],t.data=DataCenter.ins().HeirloomTreasureConfig.boxes[i];this.eff=new GameMovieClip,this.eff.x=this.btnGroup.width/2,this.eff.y=this.btnGroup.height/2,this.eff.scaleX=.55,this.eff.scaleY=.65,this.eff.touchEnabled=!1,this.list.itemRenderer=TreasureHuntListItemRenderer,this.zb1.text=DataCenter.ins().HeirloomTreasureConfig.huntOnce+"",this.zb10.text=DataCenter.ins().HeirloomTreasureConfig.huntTenth+""},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.buy1,this.onBuy),this.addEventTouchTap(this.buy10,this.onBuy),this.addEventTouchTap(this.outBag,this.onBuy),this.addCustomEvent(67,this.listRefush),this.addCustomEvent(266,this.setRedStatu),this.addCustomEvent(68,this.updateBox),this.addCustomEvent(66,this.updateMaterial),this.listRefush(),heirloomControl.upHuntRecord(),this.updateBox(),this.addBoxEvent=!0,this.updateMaterial(),this.setRedStatu();var i=DateUtils.calcWeekFirstDay();this.endedTime=i.getTime()/1e3,TimerMgr.ins().remove(this.timeClock,this),TimerMgr.ins().doTimer(1e3,0,this.timeClock,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.buy1,this.onBuy),this.removeEventTouchTap(this.buy10,this.onBuy),this.removeEventTouchTap(this.outBag,this.onBuy),this.removeCustomEvents(),DisplayUtils.removeFromParent(this.eff),TimerMgr.ins().remove(this.timeClock,this),this.addBoxEvent=!1},e.prototype.timeClock=function(){if(this.endedTime-=1,this.endedTime<=0){var t=DateUtils.calcWeekFirstDay();this.endedTime=t.getTime()/1e3}this.leftTimeTxt.text=DateUtils.getFormatBySecond(this.endedTime,DateUtils.TIME_FORMAT_5,4)},e.prototype.listRefush=function(){this.list.dataProvider=new eui.ArrayCollection(heirloomControl.huntRecords)},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(0);break;case this.buy10:this.buyHunt(1);break;case this.outBag:UIMgr.ins().open(TreasureHuntStoreView,2)}},e.prototype.buyHunt=function(t){if(0==t&&heirloomControl.huntFreeTimes>0)return void heirloomControl.upHunt(t);this.huntType=t;var e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().HeirloomTreasureConfig.huntItem);if(e&&e.count)heirloomControl.upHunt(t);else{var i=0==t?DataCenter.ins().HeirloomTreasureConfig.huntOnce:DataCenter.ins().HeirloomTreasureConfig.huntTenth;TreasureHuntWarnBuyView.showBuyWarn("TreasureHuntRarePanel-HuntResultWin"+t,this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",i,DataCenter.ins().ItemConfig[DataCenter.ins().HeirloomTreasureConfig.huntItem].name,t?10:1))}},e.prototype.huntWarnFun=function(){var t=0==this.huntType?DataCenter.ins().HeirloomTreasureConfig.huntOnce:DataCenter.ins().HeirloomTreasureConfig.huntTenth;ActorControl.yb>=t?heirloomControl.upHunt(this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.setRedStatu=function(){var t=Boolean(backpackControl.getHuntGoods(2).length);t?(this.outBag.parent.addChildAt(this.eff,this.getChildIndex(this.outBag)),this.eff.playFile(PATH_EFF+"chargeff1",-1)):DisplayUtils.removeFromParent(this.eff),this.redPoint2.visible=t},e.prototype.updateBox=function(){var t,e,i=heirloomControl.huntBoxInfo.length,n=0;for(var o in DataCenter.ins().HeirloomTreasureRewardConfig)e=DataCenter.ins().HeirloomTreasureRewardConfig[o],this["time"+n].text=e.needTime+LangMgr.getValueByKey("osaTimes",""),this["time"+n].visible=!0,this["done"+n].visible=!1,this["boxPoint"+n].visible=!1,this["bar"+n].value=0,this["box"+n].source="200116_0_png",this["box"+n].name="box"+(n+1),this.addBoxEvent||this.addEventTouchTap(this["box"+n],this.onGetAward),i>n&&(t=heirloomControl.huntBoxInfo[n],t==HeirloomControl.CANGET?(this["box"+n].source="200116_png",this["bar"+n].value=100,this["boxPoint"+n].visible=!0):t==HeirloomControl.ISNGET&&(this["time"+n].visible=!1,this["done"+n].visible=!0,this["bar"+n].value=100)),n++;this.hopeValue0.text=heirloomControl.huntHope+"",this.times.text=heirloomControl.huntTimes+"",this.maskImage(),this.buy1.label=heirloomControl.huntFreeTimes>0?LangMgr.getValueByKey("titleTips15"):LangMgr.getValueByKey("titleTips16");var s=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().HeirloomTreasureConfig.huntItem),r=s?s.count:0;this.buy1RedPoint.visible=r>0||heirloomControl.huntFreeTimes>0},e.prototype.maskImage=function(){var t=heirloomControl.huntHope,e=DataCenter.ins().HeirloomTreasureConfig.maxBlissVal,i=Math.floor(.01*Math.pow(t,.74)*e)/e;return i=1>i?i:1,i>=1?(this.maxHopeValue0.mask&&(this.maxHopeValue0.mask=null),void(this.maskShape&&(this.maskShape.graphics.clear(),this.maskShape=null))):(this.maxHopeValue0.mask||(this.maskShape=new egret.Shape,this.maskShape.graphics.beginFill(LangMgr.getColor("color42")),this.maskShape.graphics.drawRect(this.maxHopeValue0.x,this.maxHopeValue0.y,this.maxHopeValue0.width,this.maxHopeValue0.height),this.maxHopeValue0.parent.addChild(this.maskShape),this.maxHopeValue0.mask=this.maskShape),void(this.maskShape.y=this.maxHopeValue0.height*(1-i)))},e.prototype.onGetAward=function(t){var e=t.target.name.slice(3,4),i=heirloomControl.huntBoxInfo[e-1];i==HeirloomControl.CANGET?heirloomControl.upHuntAward(e):UIMgr.ins().open(TreasureHuntBoxsTipsView,e,2)},e.prototype.updateMaterial=function(){var t=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().HeirloomTreasureConfig.huntItem),e=t?t.count:0;this.num1.textFlow=TextUtils.generateTextFlow("|C:"+(e?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|"),this.buy1RedPoint.visible=e>0||heirloomControl.huntFreeTimes>0,this.num10.textFlow=TextUtils.generateTextFlow("|C:"+(e>=10?ColorUtils.GREEN:ColorUtils.RED)+"&T:"+e+"|"),this.buy10RedPoint.visible=e>=10},e}(BasePanel);__reflect(TreasureHuntRarePanel.prototype,"TreasureHuntRarePanel");var TreasureHuntResultView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arr=[],e.items=[],e.type=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.setCurSkin(t[3]),this.addEventTouchTap(this.buyBtn,this.buy),this.addCustomEvent(224,this.updateView),this.addCustomEvent(66,this.updateView),this.addCustomEvent(405,this.updateView),this.addCustomEvent(477,this.closeThis),this.updateView([t[0],t[1],t[2],t[3]])},e.prototype.setCurSkin=function(t){var e;t&&(e=DataCenter.ins().Amusement18Config[t][0]),e&&2==e.showType?this.skinName="WishDragonResultViewSkin":this.skinName="TreasureHuntResultViewSkin"},e.prototype.closeThis=function(t){"WishDragonResultViewSkin"==this.skinName&&t&&"AmusementUniversalView"==t[0]&&UIMgr.ins().close(this)},e.prototype.updateView=function(t){if(this.canClicck=!0,this.huntType=t[0],this.arr=t[1],this.type=t[2],this.activityID=t[3],0==this.huntType){var e=0;0==this.type?e=DataCenter.ins().TreasureEquipConfig.huntOnce:1==this.type?e=DataCenter.ins().TreasureRuneConfig.huntOnce:2==this.type?e=DataCenter.ins().HeirloomTreasureConfig.huntOnce:3==this.type&&(e=DataCenter.ins().Amusement18Config[this.activityID][1].yb),this.yb=e,this.buyBtn.labelDisplay.text=LangMgr.getValueByKey("fdBuy1",1)}else if(1==this.huntType){var e=0;0==this.type?e=DataCenter.ins().TreasureEquipConfig.huntTenth:1==this.type?e=DataCenter.ins().TreasureRuneConfig.huntTenth:2==this.type?e=DataCenter.ins().HeirloomTreasureConfig.huntTenth:3==this.type&&(e=DataCenter.ins().Amusement18Config[this.activityID][2].yb),this.yb=e,this.buyBtn.labelDisplay.text=LangMgr.getValueByKey("fdBuy1",10)}else 3==this.type&&(this.yb=DataCenter.ins().Amusement18Config[this.activityID][3].yb,this.buyBtn.labelDisplay.text=LangMgr.getValueByKey("fdBuy1",100));this.zwHunt.visible=!0;var i;if(0==this.type)i=DataCenter.ins().TreasureEquipConfig.huntItem;else if(1==this.type)i=DataCenter.ins().TreasureRuneConfig.huntItem;else if(2==this.type)i=DataCenter.ins().HeirloomTreasureConfig.huntItem;else if(3==this.type){i=DataCenter.ins().Amusement18Config[this.activityID][1].item;var n=amusementControl.getAmusementDataById(this.activityID);if(n){var o=DataCenter.ins().Amusement18Config[this.activityID][0].relateActivityId;amusementControl.getAmusementDataById(o)}}this.zw.text=this.yb+"";var s=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,i),r=this.huntType?1==this.huntType?10:100:1;this.zwNum1.textFlow=TextUtils.generateTextFlow("<font color="+(s>=r?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR)+">"+s+"</font> "),this.icon.source=DataCenter.ins().ItemConfig[i].icon+"_png",this.zwNum2.text=0==this.huntType?"/1）":1==this.huntType?"/10）":"/100）",this.playResult()},e.prototype.playResult=function(t){var e=this;this.releaseAllItem();for(var i=this.arr.length,n=0,o=0;i>o;o++)if(1!=this.arr[o][0]){this.items[n]=this.createItem(this.arr[o]);var s=egret.Tween.get(this.items[n]);this.items[n].x=n%5*77+0,this.items[n].y=93*Math.floor(n/5)+0,this.items[n].alpha=0,n++,s.wait(50*n).to({alpha:1},200).call(function(){i--,0==i&&(void 0!=t&&t(),e.canClicck=!0)})}},e.prototype.playGet=function(t){for(var e=this,i=this.arr.length,n=0;i>n;n++)if(this.items[n]){var o=egret.Tween.get(this.items[n]);o.to({y:620,x:320,scaleX:0,scaleY:0},300-50*Math.floor(n/5)).call(function(){i--,0==i&&(void 0!=t&&t(),e.releaseAllItem())})}},e.prototype.createItem=function(t){var e=new ItemBase;this.listCon.addChild(e);var i=DataCenter.ins().ItemConfig[t[0]];return i?(e.num=t[1],e.data=t[0]):e.data={type:0,count:t[1],id:t[0]},e.x=180,e.y=500,e},e.prototype.releaseAllItem=function(){for(var t in this.items)this.items[t].destruct(),this.listCon.removeChild(this.items[t]);this.items=[]},e.prototype.closeCB=function(t){var e=this;if(this.canClicck){this.canClicck=!1;var i=function(){UIMgr.ins().close(e)};this.playGet(i)}},e.prototype.buy=function(t){var e=this;if(3==this.type&&backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open(BackpackFullTipsView);if(this.canClicck){if(2==this.type&&0==this.huntType&&heirloomControl.huntFreeTimes>0)return void heirloomControl.upHunt(this.huntType);var i=0;i=3==this.type?DataCenter.ins().Amusement18Config[this.activityID][1].item:2==this.type?DataCenter.ins().HeirloomTreasureConfig.huntItem:1==this.type?DataCenter.ins().TreasureRuneConfig.huntItem:DataCenter.ins().TreasureEquipConfig.huntItem;var n=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,i);if(n){var o=function(){0==e.type?treasureHuntControl.upHunt(e.huntType):1==e.type?runeControl.upHuntRune(e.huntType):2==e.type?heirloomControl.upHunt(e.huntType):3==e.type&&amusementControl.upReward(e.activityID,e.huntType+1)};this.playGet(o),this.canClicck=!1}else{var s=this.huntType?1==this.huntType?10:100:1,r=this.getPanelNameByType(this.type);TreasureHuntWarnBuyView.showBuyWarn(r+"-HuntResultWin"+this.huntType,this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",this.yb,DataCenter.ins().ItemConfig[i].name,s))}}},e.prototype.getPanelNameByType=function(t){return 3==this.type?"AmuseTarget18Panel"+DataCenter.ins().Amusement18Config[this.activityID][0].showType:2==this.type?"TreasureHuntRarePanel":1==this.type?"TreasureHuntRunePanel":"TreasureHuntPanel"},e.prototype.huntWarnFun=function(){var t=this;if(ActorControl.yb>=this.yb){var e=function(){0==t.type?treasureHuntControl.upHunt(t.huntType):1==t.type?runeControl.upHuntRune(t.huntType):2==t.type?heirloomControl.upHunt(t.huntType):3==t.type&&amusementControl.upReward(t.activityID,t.huntType+1)};this.playGet(e),this.canClicck=!1}else tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e}(BaseEuiView);__reflect(TreasureHuntResultView.prototype,"TreasureHuntResultView");var TreasureHuntRunePanel=function(t){function e(){var e=t.call(this)||this;return e.huntType=0,e.name=LangMgr.getValueByKey("equipment5"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init(),this.costIcon1.source="200166_png",this.costIcon10.source="200166_png"},e.prototype.init=function(){this.updateDescEx();var t=DataCenter.ins().TreasureRuneLevelConfig,e=copyBabelControl.curLevel,i=null;for(var n in t){var o=t[n];if(e>=o.level&&e<=o.levelend){i=o;break}}this.list1.itemRenderer=ItemBase,this.list1.dataProvider=new eui.ArrayCollection(i.showicon),this.eff=new GameMovieClip,this.eff.x=this.btnGroup.width/2,this.eff.y=this.btnGroup.height/2,this.eff.scaleX=.65,this.eff.scaleY=.75,this.eff.touchEnabled=!1,this.open()},e.prototype.sortFunc=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],n=DataCenter.ins().ItemConfig[e.id],o=DataCenter.ins().RuneNameConfig[ItemUtils.getSubType(i)],s=DataCenter.ins().RuneNameConfig[ItemUtils.getSubType(n)];return o.type<s.type?-1:1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.buy1,this.onBuy),this.addEventTouchTap(this.buy10,this.onBuy),this.addEventTouchTap(this.outBag,this.onBuy),this.addEventTouchTap(this.outBag0,this.onBuy),this.addCustomEvent(127,this.callRuneResult);for(var i=0;5>i;i++)this.addEventTouchTap(this["box"+i],this.onTab);this.addCustomEvent(271,this.setRedStatu),this.addCustomEvent(128,this.callback),treasureHuntControl.upHuntList(),this.setRedStatu(),this.setBoxData();var n=DateUtils.calcWeekFirstDay();this.endedTime=n.getTime()/1e3,TimerMgr.ins().remove(this.timeClock,this),TimerMgr.ins().doTimer(1e3,0,this.timeClock,this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.buy1,this.onBuy),this.removeEventTouchTap(this.buy10,this.onBuy),this.removeEventTouchTap(this.outBag,this.onBuy),DisplayUtils.removeFromParent(this.eff);for(var i=0;5>i;i++)this.removeEventTouchTap(this["box"+i],this.onTab);this.removeCustomEvents(),TimerMgr.ins().remove(this.timeClock,this)},e.prototype.timeClock=function(){if(this.endedTime-=1,this.endedTime<=0){var t=DateUtils.calcWeekFirstDay();this.endedTime=t.getTime()/1e3}this.leftTime.text=LangMgr.getValueByKey("titleTips18")+DateUtils.getFormatBySecond(this.endedTime,DateUtils.TIME_FORMAT_5,4)},e.prototype.setRedStatu=function(){var t=Boolean(backpackControl.getHuntGoods(1).length);t?(this.outBag.parent.addChildAt(this.eff,this.getChildIndex(this.outBag)),this.eff.playFile(PATH_EFF+"chargeff1",-1)):DisplayUtils.removeFromParent(this.eff),this.redPoint2.visible=t,this.redPoint0.visible=RuneRedPoint.ins().checkCanExchange()},e.prototype.onBuy=function(t){switch(t.target){case this.buy1:this.buyHunt(0);break;case this.buy10:this.buyHunt(1);break;case this.outBag:UIMgr.ins().open(TreasureHuntStoreView,1);break;case this.outBag0:UIMgr.ins().open(TreasureHuntExShopView)}},e.prototype.onTab=function(t){for(var e=0;5>e;e++)if(t.target==this["box"+e]){if(0==runeControl.boxs[e]){UIMgr.ins().open(TreasureHuntBoxsTipsView,e+1);break}if(2==runeControl.boxs[e]){UIMgr.ins().open(TreasureHuntBoxsTipsView,e+1);break}this.boxId=e+1,runeControl.upRuneBoxGift(e+1);break}},e.prototype.buyHunt=function(t){this.huntType=t;var e=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureRuneConfig.huntItem);if(e&&e.count)runeControl.upHuntRune(t);else{var i=0==t?DataCenter.ins().TreasureRuneConfig.huntOnce:DataCenter.ins().TreasureRuneConfig.huntTenth;TreasureHuntWarnBuyView.showBuyWarn("TreasureHuntRunePanel-HuntResultWin"+t,this.huntWarnFun.bind(this),LangMgr.getValueByKey("osaPayShow1",i,DataCenter.ins().ItemConfig[DataCenter.ins().TreasureRuneConfig.huntItem].name,t?10:1))}},e.prototype.huntWarnFun=function(){var t=0==this.huntType?DataCenter.ins().TreasureRuneConfig.huntOnce:DataCenter.ins().TreasureRuneConfig.huntTenth;ActorControl.yb>=t?runeControl.upHuntRune(this.huntType):tipsControl.showTips(LangMgr.getValueByKey("userNoMony"))},e.prototype.callback=function(){if(this.boxId){var t=DataCenter.ins().TreasureRuneRewardConfig[this.boxId];if(t)for(var e=0;e<t.reward.length;e++)tipsControl.showTips(LangMgr.getValueByKey("titleTips19",t.reward[e].count));this.boxId=0}this.setBoxData()},e.prototype.setBoxData=function(){this.times.text=runeControl.runeCount+"";for(var t=0;5>t;t++){var e=DataCenter.ins().TreasureRuneRewardConfig[t+1],i=e.needTime?e.needTime:0;switch(runeControl.boxs[t]){case 0:this["time"+t].text=LangMgr.getValueByKey("osaTimes",i),this["time"+t].visible=!0,this["done"+t].visible=!this["time"+t].visible,this["box"+t].source="200116_0_png",this["boxPoint"+t].visible=!1;break;case 1:this["time"+t].text=LangMgr.getValueByKey("osaTimes",i),this["time"+t].visible=!1,this["done"+t].visible=!this["time"+t].visible,this["done"+t].text=LangMgr.getValueByKey("babelCanGet"),this["box"+t].source="200116_png",this["boxPoint"+t].visible=!0;break;case 2:this["time"+t].text=LangMgr.getValueByKey("osaTimes",i),this["time"+t].visible=!1,this["done"+t].visible=!this["time"+t].visible,this["done"+t].text=LangMgr.getValueByKey("activitAlreadingGet"),this["box"+t].source="200116_0_png",this["boxPoint"+t].visible=!1}}},e.prototype.callRuneResult=function(){this.updateDescEx()},e.prototype.updateDescEx=function(){var t=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureRuneConfig.huntItem),e=t?t.count:0;this.num1.textFlow=TextUtils.generateTextFlow("<font color="+(e?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR)+">"+e+"</font> "),this.buy1RedPoint.visible=e>0,this.num10.textFlow=TextUtils.generateTextFlow("<font color="+(e>=10?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR)+">"+e+"</font> "),this.buy10RedPoint.visible=e>=10,this.zw1.text=DataCenter.ins().TreasureRuneConfig.huntOnce+"",this.zw10.text=DataCenter.ins().TreasureRuneConfig.huntTenth+"",this.hopeValue.text=runeControl.hope+"",this.maskImage()},e.prototype.maskImage=function(){var t=runeControl.hope,e=DataCenter.ins().TreasureRuneConfig.maxBlissVal,i=Math.floor(.0096*Math.pow(t,.6719)*e)/e;if(i=1>i?i:1,i>=1)return DisplayUtils.removeFromParent(this.masksp),void(this.masksp=null);var n=118;if(!this.masksp){this.masksp=new egret.Sprite;var o=new egret.Shape;o.graphics.beginFill(LangMgr.getColor("color42")),o.graphics.drawRect(this.maxHopeValue.x,this.maxHopeValue.y,90,n),o.graphics.endFill(),this.masksp.addChild(o),this.maxHopeValue.parent.addChild(this.masksp),this.maxHopeValue.mask=this.masksp}this.masksp.y=n*(1-i)},e}(BasePanel);__reflect(TreasureHuntRunePanel.prototype,"TreasureHuntRunePanel");var TreasureHuntSelectView=function(t){function e(){var e=t.call(this)||this;return e.lastSelected=-1,e.maxNum=0,e.skinName="TreasureHuntSelectViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.id=t[0],this.index=t[1],this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(393,this.otherClose),this.addEventTouchEnd(this.minBtn0,this.onTap),this.addEventTouchEnd(this.maxBtn0,this.onTap),this.addEventTouchEnd(this.sub1Btn0,this.onTap),this.addEventTouchEnd(this.add1Btn0,this.onTap),this.addEventChange(this.numLabel0,this.onTxtChange),this.numLabel0.restrict="0-9",this.numLabel0.text="0",this.add.touchEnabled=!1,this.add.touchChildren=!1,this.update()},e.prototype.update=function(){var t=DataCenter.ins().Amusement13Config[this.id][this.index];this.gift.itemRenderer=TreasureHuntRareItemRenderer,t.award.length<=4?this.currentState="special":this.currentState="normal",this.validateNow(),this.gift.dataProvider=new eui.ArrayCollection(t.award),this.gift.validateNow();var e=amusementControl.getAmusementDataById(this.id);e?(this.num=e.proCount[this.index]/DataCenter.ins().Amusement13Config[this.id][this.index].count>>0,this.choose.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("treasure1")),this.maxNum=this.num,this.useNum=0):(tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity")),this.otherClose(this.id))},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.lastSelected=-1},e.prototype.onTouch=function(t){if(t.target==this.get){if(this.gift.selectedIndex<0)return void tipsControl.showTips(LangMgr.getValueByKey("titleTips13"));if(!this.useNum)return void tipsControl.showTips(LangMgr.getValueByKey("treasure2"));var e=amusementControl.getAmusementDataById(this.id);if(!e)return tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity")),void this.otherClose(this.id);amusementControl.upReward(this.id,this.index,this.gift.selectedIndex+1,this.useNum.toString())}else t.target.parent==this.gift?(this.lastSelected>=0&&this.gift.getChildAt(this.lastSelected).checkSelcted(this.gift.selectedIndex),this.lastSelected=this.gift.selectedIndex,this.gift.dataProvider&&this.lastSelected>-1&&this.lastSelected<this.gift.dataProvider.length&&this.gift.getChildAt(this.lastSelected).checkSelcted(this.gift.selectedIndex),this.add.touchChildren=!0,this.useNum=1,this.numLabel0.text=this.useNum+""):t.target==this.bgClose&&this.otherClose(this.id)
},e.prototype.otherClose=function(t){this.id==t&&UIMgr.ins().close(this)},e.prototype.onTap=function(t){switch(t.target){case this.minBtn0:this.useNum=1;break;case this.maxBtn0:this.useNum=this.maxNum;break;case this.sub1Btn0:this.useNum--,this.useNum<=0&&(this.useNum=1);break;case this.add1Btn0:this.useNum++,this.useNum>this.maxNum&&(this.useNum=this.maxNum)}this.numLabel0.text=this.useNum+""},e.prototype.onTxtChange=function(t){var e=Number(this.numLabel0.text);e>this.maxNum?e=this.maxNum:0>=e&&(e=1),this.useNum=e,this.numLabel0.text=this.useNum+""},e}(BaseEuiView);__reflect(TreasureHuntSelectView.prototype,"TreasureHuntSelectView");var TreasureHuntStoreView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.skinName="TreasureHuntStoreViewSkin",this.list.itemRenderer=TreasureHuntStoreItemRenderer,this.listScroller.viewport=this.list},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.addEventTouchTap(this.get,this.getGoods),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addCustomEvent(271,this.updateData),this.updateData()},e.prototype.onTap=function(t){if(t&&t.currentTarget)switch(t.currentTarget){case this.fgClose:UIMgr.ins().close(this)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.get,this.getGoods),this.removeCustomEvents()},e.prototype.updateData=function(){var t=backpackControl.getHuntGoodsBySort(this.type);this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.getGoods=function(t){this.list.dataProvider.length>0&&backpackControl.upGetGoodsByStore(this.type)},e}(BaseEuiView);__reflect(TreasureHuntStoreView.prototype,"TreasureHuntStoreView");var TreasureHuntView=function(t){function e(){var e=t.call(this)||this;return e.curRole=0,e.curSelectIndex=0,e.isTopLevel=!0,e.skinName="TreasureHuntViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.panelArr=[this.treasureHuntPanel,this.treasureRune,this.treasureChuanshi],this.viewStack.selectedIndex=0,this.checkHeirloomOpen(),this.tab.dataProvider=this.viewStack},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0]?t[0]:0;this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.help,this.onClick),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.checkIsOpen),this.addCustomEvent(267,this.setRedPoint),this.addCustomEvent(266,this.setRedPoint),this.addCustomEvent(268,this.setRedPoint),this.addCustomEvent(352,this.setRedPoint),this.addCustomEvent(128,this.setRedPoint),this.addCustomEvent(466,this.checkHeirloomOpen),this.addCustomEvent(112,this.checkHeirloomOpen),this.setSelectedIndex(i),this.setRedPoint()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.panelArr[this.curSelectIndex].close()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.help:var e=void 0;0==this.tab.selectedIndex?e=39:1==this.tab.selectedIndex?e=13:2==this.tab.selectedIndex&&(e=40),e&&HelpControl.openHelpWin(e)}},e.prototype.checkIsOpen=function(t){var e=t.target,i=DataCenter.ins().TreasureRuneConfig.openlevel;return 1==e.selectedIndex&&ActorControl.level<i?(tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",i)),t.$cancelable=!0,void t.preventDefault()):void 0},e.prototype.onTabTouch=function(t){this.panelArr[this.curSelectIndex].close();var e=t.currentTarget.selectedIndex;this.setSelectedIndex(e),this.setRedPoint(),UIMgr.ins().close(LimitTaskView)},e.prototype.setSelectedIndex=function(t){this.curSelectIndex=t,this.panelArr[t].open(),this.viewStack.selectedIndex=t},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(t[0])if(2==t[0]){if(!heirloomControl.isHeirloomHuntOpen())return tipsControl.showTips(LangMgr.getValueByKey("titleTips17",DataCenter.ins().HeirloomTreasureConfig.openDay,DataCenter.ins().HeirloomTreasureConfig.openZSlevel)),!1}else if(1==t[0]&&ActorControl.level<DataCenter.ins().TreasureRuneConfig.openlevel)return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().TreasureRuneConfig.openlevel)),!1;return SwitchMgr.ins().checkOpen(7,!0)?(UIMgr.ins().close(ExperienceView),!0):!1},e.prototype.setRedPoint=function(){var t=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureEquipConfig.huntItem),e=t?t.count:0;this.redPoint0.visible=Boolean(backpackControl.getHuntGoods(0).length)||e>0;var i=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().TreasureRuneConfig.huntItem),n=i?i.count:0;this.redPoint1.visible=Boolean(backpackControl.getHuntGoods(1).length)||runeControl.getIsGetBox()||RuneRedPoint.ins().checkCanExchange()||n>0;var o=backpackControl.getBagGoodsByTypeAndId(BackpackControl.BAG_TYPE_OTHTER,DataCenter.ins().HeirloomTreasureConfig.huntItem),s=o?o.count:0;this.redPoint2.visible=Boolean(heirloomControl.isHeirloomHuntOpen()&&(backpackControl.getHuntGoods(2).length||heirloomControl.getIsGetBox()||s>0))},e.prototype.checkHeirloomOpen=function(){heirloomControl.isHeirloomHuntOpen()?this.viewStack.length<3&&(this.viewStack.addChild(this.treasureChuanshi),this.redGroup.addChild(this.redPoint2),this.tab.dataProvider=this.viewStack):this.viewStack.length>2&&(this.viewStack.removeChildAt(2),this.redGroup.removeChildAt(2),this.tab.dataProvider=this.viewStack)},e}(BaseEuiView);__reflect(TreasureHuntView.prototype,"TreasureHuntView");var TreasureHuntWarnBuyView=function(t){function e(){var e=t.call(this)||this;return e.skinName="TreasureHuntWarnBuyViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.panel=t[0],this.callback=t[1],this.des=t[2],this.addEventTouchEnd(this,this.onTouch),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTouch),this.update()},e.prototype.close=function(){this.panel=null,this.callback=null,this.removeEventTouchTap(this,this.onTouch)},e.showBuyWarn=function(t,i,n){1==e.loginRecords[t]?i&&i():UIMgr.ins().open(e,t,i,n)},e.prototype.update=function(){this.tipsCheckbox.selected=!1,this.desTxt.textFlow=TextUtils.generateTextFlow(this.des)},e.prototype.onTouch=function(t){switch(t.target){case this.noBtn:case this.fgClose:case this.BG:UIMgr.ins().close(this);break;case this.yesBtn:e.loginRecords[this.panel]=this.tipsCheckbox.selected,this.callback&&this.callback(),UIMgr.ins().close(this)}},e.loginRecords={},e}(BaseEuiView);__reflect(TreasureHuntWarnBuyView.prototype,"TreasureHuntWarnBuyView");var TreasureHuntListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="NoticeListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data,e=DataCenter.ins().ItemConfig[t[1]];if(null!=e){var i,n=ItemUtils.getQualityColor(e),o=ItemUtils.getType(e);i=0==o?LangMgr.getValueByKey("titleTips1",t[0],n,this.makeNameList(e)):LangMgr.getValueByKey("titleTips1",t[0],n,e.name),this.showText.textFlow=TextUtils.generateTextFlow(i)}},e.prototype.makeNameList=function(t){var e="";return e=t.name,e+=t.zsLevel>0?"("+t.zsLevel+LangMgr.getValueByKey("numberRotation",""):"("+t.level+LangMgr.getValueByKey("numberLevel",""),e+=(t?LangMgr.getValueByKey("job"+(ItemUtils.getJob(t)+1)):"")+")"},e}(BaseItemRender);__reflect(TreasureHuntListItemRenderer.prototype,"TreasureHuntListItemRenderer");var TreasureHuntRareItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="TreasureHuntRareItemRendererSkin",e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){this.gift.data=this.data,this.select.visible=this.select2.visible=!1},e.prototype.checkSelcted=function(t){this.select.visible=this.select2.visible=this.itemIndex==t},e}(BaseItemRender);__reflect(TreasureHuntRareItemRenderer.prototype,"TreasureHuntRareItemRenderer");var TreasureHuntStoreItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onClick=function(){var t=this.data.handle;backpackControl.upGetGoodsByStore(t)},e}(ItemBase);__reflect(TreasureHuntStoreItemRenderer.prototype,"TreasureHuntStoreItemRenderer");var UitrasoneEquipControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectJob=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"descNames",{get:function(){return[LangMgr.getValueByKey("extreme1"),LangMgr.getValueByKey("extreme2"),LangMgr.getValueByKey("extreme3"),LangMgr.getValueByKey("extreme4"),LangMgr.getValueByKey("extreme5"),LangMgr.getValueByKey("extreme6"),LangMgr.getValueByKey("extreme7"),LangMgr.getValueByKey("extreme8")]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return[0,2,4,6,7,5,3,1]},enumerable:!0,configurable:!0}),e.prototype.getZhiZunLv=function(t,e){var i=heroControl.getSubRoleByJob(t),n=i.getEquipByIndex(e),o=n.item.configID;return o?n.soulLv:0},e.prototype.getZhiZunLvByRoleID=function(t,e){if(!t||e>7)return 0;var i=t.getEquipByIndex(e),n=i.item.configID;return n?i.soulLv:0},e.prototype.isWear=function(t,e){var i=heroControl.getSubRoleByJob(t),n=i.getEquipByIndex(e),o=n.item.configID;return o?!0:!1},e.prototype.canOperate=function(t,e){var i=heroControl.getSubRoleByJob(t),n=i.getEquipByIndex(e),o=n.item.configID;if(o){var s=n.soulLv;if(s<this.getMaxZhiZunEquipLevel(ItemUtils.getSubType(n.item.itemConfig))){var r=DataCenter.ins().UitrasoneEquipLvConfig[e][s+1],a=r.materialInfo.count,l=backpackControl.getBagGoodsCountById(0,r.materialInfo.id);return l>=a}}return!1},e.prototype.getRedPointByJob=function(t){for(var e=0;7>=e;e++)if(this.canOperate(t,e))return!0;return!1},e.prototype.getRedPoint=function(t){if(void 0===t&&(t=null),null!=t){var e=heroControl.getSubRoleByIndex(t);if(this.getRedPointByJob(e.job))return!0}else for(var i=heroControl.subRolesLen,n=0;i>n;n++){var e=heroControl.getSubRoleByIndex(n);if(this.getRedPointByJob(e.job))return!0}return!1},e.prototype.getMaxZhiZunEquipLevel=function(t){var e=CommonUtils.getObjectLength(DataCenter.ins().UitrasoneEquipLvConfig[t]);return e},e.prototype.getZhiZunSkills=function(t){for(var e=[0,2],i=[],n=0,o=e;n<o.length;n++){var s=o[n],r=t.getEquipByIndex(s);if(r.item.configID){var a=r.soulLv;if(a>0){var l=DataCenter.ins().UitrasoneEquipLvConfig[s][a];l.skillId&&i.push(new SkillVo(l.skillId))}}}return i},e.prototype.getZhiZunSkill=function(t,e){var i=heroControl.getSubRoleByJob(t),n=i.getEquipByIndex(e),o=n.item.configID;if(o){var s=n.soulLv;if(s>0){var r=DataCenter.ins().UitrasoneEquipLvConfig[e][s];return r.skillId}}return 0},e.prototype.getZhiZunLinkLv=function(t,e,i){var n=this.getLinkEquipPos(e),o=heroControl.getSubRoleByIndex(t-1);if(Assert(o,"fun getZhiZunLinkLv， roleIndex:"+t+",mainPos:"+e+",soullv:"+i))return 0;var s=o.getEquipByIndex(e),r=o.getEquipByIndex(n);return s&&r?Math.min(i,r.soulLv):0},e.prototype.getZhiZunLinkLvShow=function(t,e,i){var n=heroControl.getSubRoleByIndex(t),o=n.getEquipByIndex(e);if(o&&i){var s=DataCenter.ins().UitrasoneEquipLvConfig[e][i];return s.soulLinkLevel}return 1},e.prototype.getLinkEquipPos=function(t){for(var e in DataCenter.ins().UitrasoneEquipLinkLvConfig)if(e==t.toString())for(var i in DataCenter.ins().UitrasoneEquipLinkLvConfig[e])return+i;return null},e.prototype.getZhiZunLinkLevelConfig=function(t,e,i){var n=t,o=e,s=uitrasoneEquipControl.getLinkEquipPos(n),r=uitrasoneEquipControl.getZhiZunLv(o,s);r||(r=1),i&&(r+=1);var a=DataCenter.ins().UitrasoneEquipLinkLvConfig[n][s][r];return a},e.prototype.getZhiZunEquipLevelConfig=function(t,e,i){var n=t,o=e;o||(o=1),i&&(o+=1);var s=DataCenter.ins().UitrasoneEquipLvConfig[n][o];return s},e.prototype.getSkillName=function(t){var e=DataCenter.ins().UitrasoneEquipLvConfig[t][1];if(!e)return"";var i=DataCenter.ins().SkillsConfig[e.skillId];if(!i)return"";var n=DataCenter.ins().SkillsDescConfig[i.desc];return n?n.name:""},e.prototype.getSkillDesc=function(t){var e=DataCenter.ins().UitrasoneEquipLvConfig[t][1];if(!e)return"";var i=DataCenter.ins().SkillsConfig[e.skillId];if(!i)return"";var n=DataCenter.ins().SkillsDescConfig[i.desc];if(!n)return"";var o=n.desc;return o=o.replace("%s%",i.desc_ex[0]+"")},e.prototype.checkOpen=function(){var t=DataCenter.ins().OpenSystemConfig[44].openday;return t?GameServer.serverOpenDay>=t-1?!0:!1:!0},e}(SingleClass);__reflect(UitrasoneEquipControl.prototype,"UitrasoneEquipControl");var UitrasoneEquipPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.menuList.itemRenderer=UitrasoneEquipItemRender,this.menuListData=new ArrayCollection,this.menuList.dataProvider=this.menuListData,this.menuList.selectedIndex=0,this.addEventTouchTap(this.leftBtn,this.onLeft),this.addEventTouchTap(this.rightBtn,this.onRight),this.addEventTouchTap(this.updateBtn,this.update),this.addEventTouchTap(this.skillIcon0,this.onClick),this.addEventTouchTap(this.skillIcon1,this.onClick),this.addEventTouchTap(this.chainImg0,this.onClick),this.addEventTouchTap(this.chainImg1,this.onClick),this.addEventTouchTap(this.skillIcon2,this.onClick),this.addEventTouchTap(this.chainImg2,this.onClick),this.addEventItemTap(this.menuList,this.onListChange),this.addEventChange(this.menuScroller,this.onChange),this.addCustomEvent(122,this.undateView),UIMgr.ins().getView(DeityEquipView).isNotMove=!0,this.listWidth=726,this.setRoleId(t[0])},e.prototype.onClick=function(t){var e,i,n,o,s,r,a=null,l="";switch(t.currentTarget){case this.skillIcon0:a=this.skillIcon0.source,l=this.skillName0.text;case this.skillIcon2:null==a&&(a=this.skillIcon2.source),""==l&&(l=this.skillName2.text),i=uitrasoneEquipControl.getZhiZunLinkLevelConfig(this.menuList.selectedItem,uitrasoneEquipControl.selectJob),o=uitrasoneEquipControl.getZhiZunLv(uitrasoneEquipControl.selectJob,this.menuList.selectedItem),n=uitrasoneEquipControl.getZhiZunEquipLevelConfig(this.menuList.selectedItem,o),s=DataCenter.ins().SkillsConfig[n.skillId],e=DataCenter.ins().SkillsDescConfig[s.desc],r=e.desc,r=r.replace("%s%",s.desc_ex[0]+""),UIMgr.ins().open(UitrasoneSkillTipsView,l,r,a);break;case this.chainImg0:a=this.chainImg0.source,l=this.skillChain0.text;case this.chainImg2:null==a&&(a=this.chainImg2.source),""==l&&(l=this.skillChain2.text),i=uitrasoneEquipControl.getZhiZunLinkLevelConfig(this.menuList.selectedItem,uitrasoneEquipControl.selectJob),UIMgr.ins().open(UitrasoneSkillTipsView,l,i.chainDesc,a);break;case this.skillIcon1:a=this.skillIcon1.source,l=this.skillName1.text,i=uitrasoneEquipControl.getZhiZunLinkLevelConfig(this.menuList.selectedItem,uitrasoneEquipControl.selectJob),o=uitrasoneEquipControl.getZhiZunLv(uitrasoneEquipControl.selectJob,this.menuList.selectedItem),n=uitrasoneEquipControl.getZhiZunEquipLevelConfig(this.menuList.selectedItem,o,!0),s=DataCenter.ins().SkillsConfig[n.skillId],e=DataCenter.ins().SkillsDescConfig[s.desc],r=e.desc,r=r.replace("%s%",s.desc_ex[0]+""),UIMgr.ins().open(UitrasoneSkillTipsView,l,r,a);break;case this.chainImg1:a=this.chainImg1.source,l=this.skillChain1.text,i=uitrasoneEquipControl.getZhiZunLinkLevelConfig(this.menuList.selectedItem,uitrasoneEquipControl.selectJob,!0),UIMgr.ins().open(UitrasoneSkillTipsView,l,i.chainDesc,a)}},e.prototype.undateView=function(){var t=this.menuList.selectedItem;this.pos=t,this.setRoleId(this.curRole,t)},e.prototype.update=function(){var t=uitrasoneEquipControl.selectJob,e=this.menuList.selectedItem,i=heroControl.getSubRoleByJob(t),n=i.getEquipByIndex(e),o=n.item.configID;return o?uitrasoneEquipControl.canOperate(t,e)?void equipControl.upUpgradeZhiZunEquip(i.index,e):void tipsControl.showTips(LangMgr.getValueByKey("materialEnought1")):void tipsControl.showTips(LangMgr.getValueByKey("extreTips1"))},e.prototype.onListChange=function(){var t=this.menuList.selectedItem;this.pos=t,this.selectEquip(t),this.selectList()},e.prototype.onLeft=function(){var t=410,e=0;e=this.menuList.scrollH-t,e=82*Math.round(e/82),0>e&&(e=0),this.menuList.scrollH=e,this.onChange()},e.prototype.onRight=function(){var t=410,e=0;e=this.menuList.scrollH+t,e=82*Math.round(e/82),e>this.listWidth-this.menuScroller.width&&(e=this.listWidth-this.menuScroller.width),this.menuList.scrollH=e,this.onChange()},e.prototype.setRoleId=function(t,e){t=t?t:0,this.curRole=t;var i=heroControl.getSubRoleByIndex(t),n=i.job;uitrasoneEquipControl.selectJob=n,this.menuListData.replaceAll(uitrasoneEquipControl.positions),e=e?e:this.pos?this.pos:0,this.pos=e,this.selectEquip(e)},e.prototype.onChange=function(){this.updateRedPoint(),this.menuList.scrollH<46?(this.leftGroup.visible=!1,this.rightGroup.visible=!0):this.menuList.scrollH>=this.listWidth-this.menuList.width-46&&(this.leftGroup.visible=!0,this.rightGroup.visible=!1)},e.prototype.updateRedPoint=function(){this.leftRed.visible=uitrasoneEquipControl.getRedPoint(this.curRole),this.rightRed.visible=uitrasoneEquipControl.getRedPoint(this.curRole)},e.prototype.selectEquip=function(t){this.extremeName.source="extreme_name_0"+t;var e=uitrasoneEquipControl.selectJob,i=heroControl.getSubRoleByJob(e),n=uitrasoneEquipControl.getZhiZunLv(e,t);if(n)if(n>=uitrasoneEquipControl.getMaxZhiZunEquipLevel(t)){this.attrGroup1.visible=!0,this.attrGroup0.visible=!1,this.updateBtn.visible=this.redPoint.visible=this.cost.parent.visible=!1;var o=DataCenter.ins().UitrasoneEquipLvConfig[t][n],s=AttributeData.getAttStr(o.attrs,0,1,"  :  ");this.attr2.text=s,this.skillChain2.text=LangMgr.getValueByKey("equiSoulLink")+"Lv."+uitrasoneEquipControl.getZhiZunLinkLvShow(i.index,t,n);var r=uitrasoneEquipControl.getSkillName(t);r&&(this.skillName2.text=r+"Lv."+n,this.skillIcon2.source=skillControl.getSkillIdIcon(o.skillId));var a=Math.floor(BackpackControl.getAttrPower(o.attrs))+o.ex_power?o.ex_power:0;a+=this.getChainAddPower(t,n),this.powerPanel2.setPower(a)}else{this.attrGroup1.visible=!1,this.attrGroup0.visible=!0,this.updateBtn.visible=this.cost.parent.visible=!0;var o=DataCenter.ins().UitrasoneEquipLvConfig[t][n+1],l=DataCenter.ins().ItemConfig[o.materialInfo.id],h=o.materialInfo.count;this.cost.text=l.name;var u=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,o.materialInfo.id),p=void 0;u>=h?(p=ColorUtils.GREEN_COLOR,this.isItemEnough=!0):(p=ColorUtils.RED_COLOR,this.isItemEnough=!1),this.numLabel.textFlow=TextUtils.generateTextFlow("<font color="+p+">"+u+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+h+"</font> ");var s=AttributeData.getAttStr(o.attrs,0,1,"  :  "),c=void 0,d=void 0;0==n?(d=DataCenter.ins().UitrasoneEquipLvConfig[t][1],c=AttributeData.getAttStr(d.attrs,0,1,"  :  ")):(d=DataCenter.ins().UitrasoneEquipLvConfig[t][n],c=AttributeData.getAttStr(d.attrs,0,1,"  :  ")),this.attr0.text=c,this.attr1.text=s;var g=Math.floor(BackpackControl.getAttrPower(d.attrs))+d.ex_power?d.ex_power:0,m=Math.floor(BackpackControl.getAttrPower(o.attrs))+o.ex_power?o.ex_power:0;g+=this.getChainAddPower(t,n),m+=this.getChainAddPower(t,n+1),this.powerPanel0.setPower(g),this.powerPanel1.setPower(m),this.skillChain0.text=LangMgr.getValueByKey("equiSoulLink")+"Lv."+uitrasoneEquipControl.getZhiZunLinkLvShow(i.index,t,n),this.skillChain1.text=LangMgr.getValueByKey("equiSoulLink")+"Lv."+uitrasoneEquipControl.getZhiZunLinkLvShow(i.index,t,n+1);var r=uitrasoneEquipControl.getSkillName(t);r&&(this.skillName0.text=r+"Lv."+n,this.skillName1.text=r+"Lv."+(n+1),this.skillIcon0.source=skillControl.getSkillIdIcon(o.skillId),this.skillIcon1.source=skillControl.getSkillIdIcon(o.skillId)),this.redPoint.visible=uitrasoneEquipControl.canOperate(e,t),this.updateBtn.label=LangMgr.getValueByKey("dressUpdate1")}else{this.attrGroup1.visible=!0,this.attrGroup0.visible=!1,this.updateBtn.label=LangMgr.getValueByKey("zhuzaiActivty"),this.updateBtn.visible=!0;var d=DataCenter.ins().UitrasoneEquipLvConfig[t][1],c=AttributeData.getAttStr(d.attrs,0,1,"  :  ");this.attr2.text=c,this.skillChain2.text=LangMgr.getValueByKey("equiSoulLink")+"Lv.1";var r=uitrasoneEquipControl.getSkillName(t);r&&(this.skillName2.text=r+"Lv.1",this.skillIcon2.source=skillControl.getSkillIdIcon(d.skillId));var a=Math.floor(BackpackControl.getAttrPower(d.attrs))+(d.ex_power||0);a+=this.getChainAddPower(t,n),this.powerPanel2.setPower(a);var u=backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,d.materialInfo.id),l=DataCenter.ins().ItemConfig[d.materialInfo.id],h=d.materialInfo.count;this.cost.text=l.name;var p=void 0;u>=h?(p=ColorUtils.GREEN_COLOR,this.isItemEnough=!0):(p=ColorUtils.RED_COLOR,this.isItemEnough=!1),this.numLabel.textFlow=TextUtils.generateTextFlow("<font color="+p+">"+u+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+h+"</font> "),this.redPoint.visible=uitrasoneEquipControl.canOperate(e,t)}0==t||2==t?(this.skill_0_0.parent||this.group0.addChild(this.skill_0_0),this.skill_1_0.parent||this.group1.addChild(this.skill_1_0),this.skill_2_0.parent||this.group3.addChild(this.skill_2_0)):(this.skill_0_0.parent&&this.skill_0_0.parent.removeChild(this.skill_0_0),this.skill_1_0.parent&&this.skill_1_0.parent.removeChild(this.skill_1_0),this.skill_2_0.parent&&this.skill_2_0.parent.removeChild(this.skill_2_0)),this.setEff(t),this.selectList(),this.onChange()},e.prototype.setEff=function(t){this.mc1||(this.mc1=new GameMovieClip),this.mc1.parent||this.extreme_eff.addChild(this.mc1),this.mc2||(this.mc2=new GameMovieClip),this.mc2.parent||this.extreme_eff_bottom.addChild(this.mc2),this.mc1.playFile(PATH_EFF+("extrme_eff_0"+t),-1),this.mc2.playFile(PATH_EFF+"extrme_eff_bottom",-1)},e.prototype.selectList=function(){for(var t=this.menuList.dataProvider.length,e=0;t>e;e++){var i=this.menuList.getElementAt(e);i&&(e!=this.menuList.selectedIndex?i.setSelect(!1):i.setSelect(!0))}},e.prototype.getChainAddPower=function(t,e){if(!e)return 0;var i=DataCenter.ins().UitrasoneEquipLvConfig[t][e];if(!i)return 0;var n=uitrasoneEquipControl.getLinkEquipPos(t),o=DataCenter.ins().UitrasoneEquipLinkLvConfig[t][n][i.soulLinkLevel];if(!o)return 0;var s=0,r=heroControl.getSubRoleByIndex(this.curRole);if(o.attrs){s+=BackpackControl.getAttrPower(o.attrs);for(var a in o.attrs)s+=ItemUtils.relatePower(o.attrs[a],r)}var l=o.ex_power?o.ex_power:0;return s=Math.floor(s)+l},e.prototype.close=function(){UIMgr.ins().getView(DeityEquipView).isNotMove=!1},e}(BasePanel);__reflect(UitrasoneEquipPanel.prototype,"UitrasoneEquipPanel");var UitrasoneEquipTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="UitrasoneEquipTipsViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.posId=t[0],this.addEventTouchTap(this.bgClose,this.onTouch),this.updateTips()},e.prototype.updateTips=function(){this.pos.text=RoleModel.getEquipNameByType(this.posId);var t=DataCenter.ins().UitrasoneEquipLvConfig[this.posId][1],e=t.materialInfo.id,i=DataCenter.ins().ItemConfig[e];this.nameLabel.text=i.name,this.itemIcon.setData(i),this.powerPanel.setPower(t.showPower);for(var n in t.attrs)this["attr"+t.attrs[n].type]&&(this["attr"+t.attrs[n].type].text=t.attrs[n].value);0==this.posId||2==this.posId?(this.chainName.text=uitrasoneEquipControl.getSkillName(this.posId),this.chainPos.textFlow=TextUtils.generateTextFlow1(StringUtils.replaceStrColor(uitrasoneEquipControl.getSkillDesc(this.posId),LangMgr.getValueByKey("color42")))):DisplayUtils.removeFromParent(this.chainGroup);var o=uitrasoneEquipControl.getLinkEquipPos(this.posId),s=DataCenter.ins().UitrasoneEquipLinkLvConfig[this.posId][o][1];this.soulAttr.textFlow=TextUtils.generateTextFlow1(StringUtils.replaceStrColor(s.chainDesc,LangMgr.getValueByKey("color42")))},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTouch)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(UitrasoneEquipTipsView.prototype,"UitrasoneEquipTipsView");var UitrasoneSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="UitrasoneSkillTipsViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.nameLabel.text=t[0],this.description.textFlow=TextUtils.generateTextFlow1(t[1]),this.imgSkill.source=t[2],this.addEventTouchTap(this.bgClose,this.onTouch)},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTouch)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(UitrasoneSkillTipsView.prototype,"UitrasoneSkillTipsView");var UitrasoneEquipItemRender=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.redPoint.visible=uitrasoneEquipControl.canOperate(uitrasoneEquipControl.selectJob,t);var e,i=uitrasoneEquipControl.getZhiZunLv(uitrasoneEquipControl.selectJob,t);e=0>=i?uitrasoneEquipControl.descNames[t]:uitrasoneEquipControl.descNames[t],this.nameLabel.text=e,this.selectIcon.visible=this.selected,this.itemIcon.source="icon_extreme_0"+t},e.prototype.setSelect=function(t){this.selectIcon.visible=t},e}(BaseItemRender);__reflect(UitrasoneEquipItemRender.prototype,"UitrasoneEquipItemRender");var VipControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lv=0,e.weekState=0,e.vipGiftState=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upGetAwards=function(t){return[t]},e.prototype.upGetWeekAwards=function(){},e.prototype.upGetVipGift=function(t){return[t]},e.prototype.upGetSuperVipInfo=function(){},e.prototype.downUpdateVipData=function(t,e,i,n,o){this.lv=t,this.exp=e,this.state=i,this.weekState=n,this.vipGiftState=[];for(var s=0;s<o.length;s++){var r=o[s][0],a=o[s][1],l={id:r,state:a};this.vipGiftState.push(l)}EventMgr.ins().dispatch(106)},e.prototype.downUpdataExp=function(t,e,i){this.exp=e,this.weekState=i,t>this.lv&&(this.lv=t,UnitMgr.ins().updateRoleTitleState(!0)),EventMgr.ins().dispatch(107)},e.prototype.downUpdateVipAwards=function(t){this.state=t,EventMgr.ins().dispatch(108)},e.prototype.downUpdateWeekAwards=function(t){t&&(this.weekState=0),EventMgr.ins().dispatch(109)},e.prototype.downVipGiftBuy=function(t){for(var e=0;e<t.length;e++)for(var i=t[e][0],n=t[e][1],o=0;o<this.vipGiftState.length;o++)i==this.vipGiftState[o].id&&(this.vipGiftState[o].state=n);EventMgr.ins().dispatch(110)},e.prototype.downSuperVipInfo=function(t,e){this.superVip=this.superVip||[],this.superVip[0]=Math.floor(t/GlobalModel.chargeRate),this.superVip[1]=Math.floor(e/GlobalModel.chargeRate),EventMgr.ins().dispatch(111)},e.prototype.getSuperVipState=function(){if(this.superVip)for(var t in DataCenter.ins().SuperVipConfig){var e=DataCenter.ins().SuperVipConfig[t],i=+t-1;if(e.money<=(this.superVip[i]||0))return!0}return!1},e.prototype.getVipState=function(){for(var t=!1,e=0;e<this.lv;e++)if(void 0!=this.state&&0==(this.state>>e&1))return t=!0;return t},e.prototype.getVipGiftCanBuy=function(t){var e=DataCenter.ins().VipGiftConfig[t];if(e.cond)for(var i=0,n=e.cond;i<n.length;i++){var o=n[i];if(0==(1&this.vipGiftState[+o-1].state))return!1}return!0},e.prototype.getVipGiftIsBuy=function(t){return 1==(1&this.vipGiftState[t-1].state)},e.prototype.getVipGiftRedPoint=function(t){var e=DataCenter.ins().VipGiftConfig[t];return this.lv>=e.vipLv?this.getVipGiftCanBuy(t)&&!this.getVipGiftIsBuy(t)&&e.needYb<=ActorControl.yb:!1},e.prototype.getVipIndex=function(t){for(var e in DataCenter.ins().VipGiftConfig){var i=DataCenter.ins().VipGiftConfig[e].hfTimes;if(i=i?i:0,i==t)return DataCenter.ins().VipGiftConfig[e]}return null},e.prototype.checkVipSuccess=function(t){var e=!0;for(var i in DataCenter.ins().VipGiftConfig){var n=DataCenter.ins().VipGiftConfig[i].hfTimes;if(n=n?n:0,n==t){var o=DataCenter.ins().VipGiftConfig[i].id;if(!this.getVipGiftIsBuy(o)){e=!1;break}}}return e},e.prototype.getVipPage=function(){var t=[];for(var e in DataCenter.ins().VipGiftConfig){var i=DataCenter.ins().VipGiftConfig[e].hfTimes;i=i?i:0,GameServer._hefuCount>=i&&-1==t.indexOf(i)&&t.push(i)}return t},e.prototype.isSuperVip=function(t){return GlobalModel.baseVipLevel>0&&t>GlobalModel.baseVipLevel},e.prototype.getVipLevel=function(t){return t>GlobalModel.baseVipLevel?t-GlobalModel.baseVipLevel:t},e.prototype.getVipStr=function(t){return(this.isSuperVip(t)?"SVIP":"VIP")+this.getVipLevel(t)},e.prototype.getVipEmoji=function(t){return t>0?this.isSuperVip(t)?RambleEmojiRiceTextVo.SVIP_IMG:RambleEmojiRiceTextVo.VIP_IMG:""},__decorate([up(1,[3])],e.prototype,"upGetAwards",null),__decorate([up(4)],e.prototype,"upGetWeekAwards",null),__decorate([up(5,[1])],e.prototype,"upGetVipGift",null),__decorate([up(6)],e.prototype,"upGetSuperVipInfo",null),__decorate([down(1,[2,3,3,2,[6,1]])],e.prototype,"downUpdateVipData",null),__decorate([down(2,[2,3,2])],e.prototype,"downUpdataExp",null),__decorate([down(3,[3])],e.prototype,"downUpdateVipAwards",null),__decorate([down(4,[0])],e.prototype,"downUpdateWeekAwards",null),__decorate([down(5,[[6,1]])],e.prototype,"downVipGiftBuy",null),__decorate([down(6,[3,3])],e.prototype,"downSuperVipInfo",null),e=__decorate([protocolsId(19)],e)}(BaseSystem);__reflect(VipControl.prototype,"VipControl");var SuperVipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="SuperVipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.btnPay,this.onTap),this.addCustomEvent(107,this.initView),this.addCustomEvent(111,this.initView),vipControl.upGetSuperVipInfo(),this.initView()},e.prototype.initView=function(){var t=payControl.getRechargeData(0),e=0;try{e=vipControl.superVip[1]*GlobalModel.chargeRate}catch(i){}this.way0.text=LangMgr.getValueByKey("superVip1",DataCenter.ins().SuperVipConfig[1].money),this.cond0.text="("+(t.curDayPay||0)+"/"+DataCenter.ins().SuperVipConfig[1].money+")",this.way1.text=LangMgr.getValueByKey("superVip2",DataCenter.ins().SuperVipConfig[2].money),this.cond1.text="("+(e||0)+"/"+DataCenter.ins().SuperVipConfig[2].money+")",this.aread.text=LangMgr.getValueByKey("superTips1");var n=t.curDayPay>=DataCenter.ins().SuperVipConfig[1].money||e>=DataCenter.ins().SuperVipConfig[2].money;this.nopay1.visible=!n,this.pay0.visible=n;var o=SDKManager.ins().UgameAppType;if(DataCenter.ins().SuperVipbaseConfig.hasOwnProperty("wxAccount"+o)){var s=DataCenter.ins().SuperVipbaseConfig["wxAccount"+o];this.qqtxt.text=s}else this.qqtxt.text=n?LangMgr.getValueByKey("superVipAccount1",DataCenter.ins().SuperVipbaseConfig.wxAccount):LangMgr.getValueByKey("superTips");if(DataCenter.ins().SuperVipbaseConfig["lineAccount"+o]){var r=DataCenter.ins().SuperVipbaseConfig["lineAccount"+o];this.linetxt.text=n?LangMgr.getValueByKey("superVipAccount2",r):""}else this.linetxt.text=n?LangMgr.getValueByKey("superVipAccount2",DataCenter.ins().SuperVipbaseConfig.lineAccount):""},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.closeBtn:case this.bgClose:UIMgr.ins().close(this);break;case this.pey:payControl.checkOpenWin(),UIMgr.ins().close(this);break;case this.btnPay:payControl.checkOpenWin(),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(SuperVipView.prototype,"SuperVipView");var Vip3MBView=function(t){function e(){var e=t.call(this)||this;return e.skinName="Vip3ViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.pay,this.onTouchBtn),this.addEventTouchTap(this.closeBtn,this.onTouchBtn),this.addEventTouchTap(this.closeBtn0,this.onTouchBtn);
var i=t[0];this.init(i)},e.prototype.init=function(t){for(var e=DataCenter.ins().VipConfig[t],i=0;3>i;i++){this["gift"+i].data=e.awards[i+1].id;var n=this.getPower(e.awards[i+1].id,i);this["power"+i].setPower(n)}this.pay.label=vipControl.lv<3?LangMgr.getValueByKey("activitRechargeState"):LangMgr.getValueByKey("activitGet"),this.setIconEff()},e.prototype.setIconEff=function(){this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.mcGroup.addChild(this.mc),this.mc.playFile(PATH_EFF+"mabi",-1);var t=0,e=DataCenter.ins().FireRing0Config[1];t=BackpackControl.getAttrPower(e.attrAward),t+=e.power,this.powerPanel.setPower(t)},e.prototype.getPower=function(t,e){var i=0,n=DataCenter.ins().EquipConfig[t];if(!n)return i;var o=[],s=0;t:for(var r in n)for(var a in AttributeData.attrNames)if(AttributeData.attrNames[a]==r&&n[r]){var l=n[r];if(void 0==l||0==l)continue;var h=RoleModel.getAttrTypeByName(r),u=new AttributeData,p="";if(p+=AttributeData.getAttrStrByType(h)+":",p+=n[r],u.type=h,u.value=n[r],o.push(u),s?1==s&&(this["att"+e].text=p):this["at"+e].text=p,s++,s>1)break t}return i=Math.floor(BackpackControl.getAttrPower(o))},e.prototype.onTouchBtn=function(t){switch(t.target){case this.pay:this.onBtn();break;case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this)}},e.prototype.onBtn=function(){return vipControl.lv<3?(payControl.checkOpenWin(),void UIMgr.ins().close(this)):(UIMgr.ins().open(VipView,3),void UIMgr.ins().close(this))},e}(BaseEuiView);__reflect(Vip3MBView.prototype,"Vip3MBView");var Vip3View=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="Vip3ViewSkin",this.artifactEff=new GameMovieClip,this.artifactEff.x=233,this.artifactEff.y=335;var e=.178,i=.556*this.height;this.qualityEff1=new GameMovieClip,this.qualityEff1.x=this.width*e,this.qualityEff1.y=i,this.qualityEff2=new GameMovieClip,this.qualityEff2.x=.5*this.width,this.qualityEff2.y=i,this.qualityEff3=new GameMovieClip,this.qualityEff3.x=this.width*(1-e),this.qualityEff3.y=i,this.closeBtn1Eff=new GameMovieClip,this.closeBtn1Eff.x=this.closeBtn1.x+this.closeBtn1.width/2-2,this.closeBtn1Eff.y=this.closeBtn1.y+this.closeBtn1.height/2+2,this.closeBtn1Eff.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.closeBtn1,this.onTap),this.addEventTouchTap(this.sureBtn,this.onTap),this.qualityEff1.playFile(PATH_EFF+"quality_05",-1),this.addChild(this.qualityEff1),this.qualityEff2.playFile(PATH_EFF+"quality_05",-1),this.addChild(this.qualityEff2),this.qualityEff3.playFile(PATH_EFF+"quality_05",-1),this.addChild(this.qualityEff3),this.closeBtn1Eff.playFile(PATH_EFF+"chongzhi",-1),this.addChild(this.closeBtn1Eff),vipControl.lv<3?this.sureBtn.visible=!1:(this.sureBtn.visible=!0,this.closeBtn1.visible=!1)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.closeBtn1,this.onTap),this.removeEventTouchTap(this.sureBtn,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.closeBtn1:UIMgr.ins().open(PayView);break;case this.sureBtn:UIMgr.ins().open(VipView),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(Vip3View.prototype,"Vip3View");var VipGiftItemPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipGiftItemPanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.reward.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curId=t[0]||1,this.updateData(),this.close(),this.addEventTouchTap(this.getBtn,this.onGet),this.addCustomEvent(110,this.updateData)},e.prototype.close=function(){this.removeEventTouchTap(this,this.onGet),this.removeCustomEvents()},e.prototype.onGet=function(){var t=DataCenter.ins().VipGiftConfig[this.curId];return vipControl.lv<t.vipLv?void tipsControl.showTips(LangMgr.getValueByKey("doubleVip")):ActorControl.yb<t.needYb?void tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")):backpackControl.getSurplusCount()<=0?void tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace1")):void vipControl.upGetVipGift(this.curId)},e.prototype.updateData=function(){var t=DataCenter.ins().VipGiftConfig[this.curId],e=t.awards;this.reward.dataProvider=new eui.ArrayCollection(e.concat()),this.ggtxt.source=t.adImg,this.txt.source=t.nameImg,this.tu.source=t.bgImg,this.getBtn.visible=vipControl.getVipGiftCanBuy(this.curId)&&!vipControl.getVipGiftIsBuy(this.curId),this.getBtn.label=LangMgr.getValueByKey("charItemYB",t.needYb),this.redPoint.visible=vipControl.getVipGiftRedPoint(this.curId),this.already.visible=vipControl.getVipGiftIsBuy(this.curId)},e}(BasePanel);__reflect(VipGiftItemPanel.prototype,"VipGiftItemPanel");var VipGiftPanel=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=t.call(this)||this;return n.gifts=[],n.curIndex=e[0]?e[0]:0,n.skinName="VipGiftPanel"+n.curIndex+"Skin",n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.curIndex=t[0]?t[0]:0,this.menuList.itemRenderer=VipGiftBtnItemRenderer,this.addEventTouchTap(this.leftBtn,this.onTouchBtn),this.addEventTouchTap(this.rightBtn,this.onTouchBtn),this.addEventItemTap(this.menuList,this.onTouchMenu),this.addEventChangeEnd(this.menuScroller,this.onChange),this.addCustomEvent(110,this.onUpdate),this.roleSelect.hideRole(),this.updateMenu(),this.setDefault()},e.prototype.onTouchMenu=function(t){SoundUtils.ins().playEffect(SoundUtils.VIEW),this.setGiftId(t.item.id)},e.prototype.onChange=function(){this.menuList.scrollH<20?(this.leftBtn.visible=!1,this.rightBtn.visible=!0):this.menuList.scrollH>88*(this.menuList.dataProvider.length-5)+2?(this.leftBtn.visible=!0,this.rightBtn.visible=!1):(this.leftBtn.visible=!0,this.rightBtn.visible=!0),this.menuList.dataProvider.length<=5&&(this.leftBtn.visible=!1,this.rightBtn.visible=!1)},e.prototype.updateMenu=function(){this.gifts=[];var t=DataCenter.ins().VipGiftConfig;for(var e in t){var i=t[e].hfTimes?t[e].hfTimes:0;this.curIndex==i&&this.gifts.push(t[e])}this.gifts.sort(function(t,e){return t.id<e.id?-1:1}),this.menuList.dataProvider=new eui.ArrayCollection(this.gifts),this.menuList.validateNow()},e.prototype.setDefault=function(){for(var t=this,e=0,i=vipControl.vipGiftState,n=0;n<this.gifts.length;n++)if(0==(1&i[this.gifts[n].id-1].state)){e=n;break}this.setGiftId(this.gifts[e].id),this.menuList.selectedIndex=e,TimerMgr.ins().doNext(function(){var i=92*e;i>t.menuList.contentWidth-t.menuScroller.width&&(i=t.menuList.contentWidth-t.menuScroller.width),t.menuList.scrollH=i,t.onChange()},this)},e.prototype.onTouchBtn=function(t){var e=460,i=0;switch(t.target){case this.leftBtn:i=this.menuList.scrollH-e,i=92*Math.round(i/92),0>i&&(i=0),this.menuList.scrollH=i;break;case this.rightBtn:i=this.menuList.scrollH+e,i=92*Math.round(i/92),i>this.menuList.contentWidth-this.menuScroller.width&&(i=this.menuList.contentWidth-this.menuScroller.width),this.menuList.scrollH=i}this.onChange()},e.prototype.onUpdate=function(){for(var t=this.menuList.dataProvider,e=0;e<t.length;e++)t.itemUpdated(t.getItemAt(e));this.setDefault()},e.prototype.setGiftId=function(t){this.vipGiftItem.open(t)},e.prototype.close=function(){this.vipGiftItem.close(),this.menuList.dataProvider=new eui.ArrayCollection,this.removeCustomEvents(),this.removeEventTouchTap(this.leftBtn,this.onTouchBtn),this.removeEventTouchTap(this.rightBtn,this.onTouchBtn)},e}(BasePanel);__reflect(VipGiftPanel.prototype,"VipGiftPanel");var VipGiftView=function(t){function e(){var e=t.call(this)||this;return e.VipPanelList=[],e.isTopLevel=!0,e.skinName="VipGiftViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventTouchTap(this.closeBtn,this.onTouch),this.addCustomEvent(110,this.updateRedPoint),this.curIndex=t[0]?t[0]:0,this.checkIndex(),this.create(),this.updateView()},e.prototype.checkIndex=function(){var t=vipControl.getVipPage();if(vipControl.checkVipSuccess(t[this.curIndex]))for(var e=0;e<t.length;e++)if(this.curIndex!=e){var i=t[e];if(!vipControl.checkVipSuccess(i)){this.curIndex=e;break}}},e.prototype.updateView=function(){this.VipPanelList[this.curIndex].open(this.curIndex),this.tab.selectedIndex=this.viewStack.selectedIndex=this.curIndex,this.updateRedPoint();for(var t=vipControl.getVipPage(),e=0;e<t.length;e++){var i=t[e],n=vipControl.checkVipSuccess(i);n&&(DisplayUtils.removeFromParent(this.VipPanelList[e]),DisplayUtils.removeFromParent(this["redPoint"+e]))}},e.prototype.updateRedPoint=function(){for(var t=vipControl.getVipPage(),e=0;e<t.length;e++){var i=t[e];this["redPoint"+e].visible=!1;for(var n in DataCenter.ins().VipGiftConfig){var o=DataCenter.ins().VipGiftConfig[n].hfTimes?DataCenter.ins().VipGiftConfig[n].hfTimes:0;if(i==o&&(this["redPoint"+e].visible=vipControl.getVipGiftRedPoint(DataCenter.ins().VipGiftConfig[n].id),this["redPoint"+e].visible))break}}},e.prototype.onTabTouching=function(t){return this.checkIsOpen(t.currentTarget.selectedIndex)?void 0:void t.preventDefault()},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e.prototype.onTabTouch=function(t){this.setOpenIndex(t.currentTarget.selectedIndex)},e.prototype.setOpenIndex=function(t){this.VipPanelList[t].open(this.hfcount[t])},e.prototype.checkIsOpen=function(t){return t>GameServer._hefuCount?(tipsControl.showTips(LangMgr.getValueByKey("vipTips3",t)),!1):!0},e.prototype.close=function(){for(var t=0;t<this.VipPanelList.length;t++)this.VipPanelList[t].close()},e.prototype.create=function(){this.viewStack.removeChildren(),this.redPointGroup.removeChildren(),this.hfcount=vipControl.getVipPage();for(var t=0;t<this.hfcount.length;t++){var e=new VipGiftPanel(this.hfcount[t]);if(e){e.top=0,e.left=0,e.bottom=0,e.right=0;var i=vipControl.getVipIndex(this.hfcount[t]);i&&(e.name=i.pageName?i.pageName:""),this.VipPanelList[t]=e,this.viewStack.addChild(this.VipPanelList[t]),this.redPointGroup.addChild(this["redPoint"+t]),this["redPoint"+t].visible=!1}}},e.prototype.getVipPanel=function(t){for(var e=0;e<this.VipPanelList.length;e++)if(this.VipPanelList[e].curIndex==t)return this.VipPanelList[e];return null},e}(BaseEuiView);__reflect(VipGiftView.prototype,"VipGiftView");var VipView=function(t){function e(){var e=t.call(this)||this;return e.barbc=new ProgressBarEff,e._curLv=0,e.skinName="VipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.barbc.setWidth(320),this.barbc.x=88,this.barbc.y=10,this.barbc.setStroke(0,1),this.topGroup.addChild(this.barbc),this.list.itemRenderer=ItemBase,this.list0.itemRenderer=ItemBase,this.vipValue=BitmapNumber.ins().createNumPic(0,"vip_v",5),this.vipNumGrp.addChild(this.vipValue)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.topUpBtn,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.suerBtn,this.onTap),this.addEventTouchTap(this.suerBtn0,this.onTap),this.addCustomEvent(107,this.changeExpBar),this.addCustomEvent(108,this.changeAwards),this.addCustomEvent(106,this.changeAwards),this.addCustomEvent(109,this.changeAwards),this.barbc.reset(),this.changeExpBar(),this.changeAwards(),this._curLv=t[0]?t[0]:this.getVipLevel();var i=UIMgr.playFun;if(i&&(i.vip.visible&&(this._curLv=3),i.preVip=i.vip.visible=!1),this._curLv){var n=DataCenter.ins().VipConfig[this._curLv];this.showVipInfo(n)}},e.prototype.getVipLevel=function(){if(vipControl.lv)for(var t=0;t<vipControl.lv;t++)if(!(vipControl.state>>t&1))return t+1;var e=Object.keys(DataCenter.ins().VipConfig).length;return vipControl.lv>=e-1?e:vipControl.lv+1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.topUpBtn,this.onTap),this.removeEventTouchTap(this.leftBtn,this.onTap),this.removeEventTouchTap(this.rightBtn,this.onTap),this.removeEventTouchTap(this.suerBtn,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){var e;switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(this);break;case this.topUpBtn:UIMgr.ins().close(this),payControl.checkOpenWin();break;case this.leftBtn:e=DataCenter.ins().VipConfig[--this._curLv],this.showVipInfo(e);break;case this.rightBtn:e=DataCenter.ins().VipConfig[++this._curLv],this.showVipInfo(e);break;case this.suerBtn:e=DataCenter.ins().VipConfig[this._curLv];for(var i=0,n=e.awards,o=n.length,s=0;o>s;s++)1==n[s].type&&n[s].id<2e5&&i++;backpackControl.getSurplusCount()>=i?vipControl.upGetAwards(this._curLv):tipsControl.showTips(LangMgr.getValueByKey("tipsLackSpace1"));break;case this.suerBtn0:vipControl.upGetWeekAwards()}},e.prototype.showVipInfo=function(t){t?this.setAwards(t):this._curLv=vipControl.lv,this.changeBtn()},e.prototype.changeExpBar=function(){var t=DataCenter.ins().VipConfig[vipControl.lv],e=0,i=vipControl.exp;t&&(e=vipControl.lv);var n=DataCenter.ins().VipConfig[e+1],o=0,s="";if(n){o=n.needYb-i;s=LangMgr.getValueByKey("chargeTips1",o,vipControl.getVipStr(vipControl.lv+1)),this.barbc.setData(i,n.needYb)}else s=LangMgr.getValueByKey(GlobalModel.baseVipLevel>0?"chargeTips14":"chargeTips2"),this.barbc.setData(i,t.needYb),this.barbc.setLbValueText(i+"/"+t.needYb);this.titleLabel.textFlow=TextUtils.generateTextFlow(s),t=DataCenter.ins().VipConfig[this._curLv],this.showVipInfo(t)},e.prototype.changeAwards=function(){var t;if(this._curLv=vipControl.lv,this._curLv>=0){for(var e=0;e<this._curLv;e++)if(!this.getRemindByIndex(e)||this.checkWeekReward(e))return t=DataCenter.ins().VipConfig[e+1],this._curLv=e+1,this.setAwards(t?t:t=DataCenter.ins().VipConfig[--this._curLv]),void this.changeBtn();t=DataCenter.ins().VipConfig[++this._curLv],this.setAwards(t?t:t=DataCenter.ins().VipConfig[--this._curLv]),this.changeBtn()}},e.prototype.setAwards=function(t){this.depictLabel.textFlow=TextUtils.generateTextFlow(t.description),this.list.dataProvider=new eui.ArrayCollection(t.awards),this.list0.dataProvider=new eui.ArrayCollection(t.weekReward),this.vipImg.source=t.vipImg;var e=vipControl.exp,i=t.needYb-e,n="";n=i>0?LangMgr.getValueByKey("chargeTips1",i,vipControl.getVipStr(t.id)):"",this.more.textFlow=TextUtils.generateTextFlow1(n);var o=LangMgr.getValueByKey("chargeTips13",t.needYb,vipControl.getVipStr(t.id));this.show.textFlow=TextUtils.generateTextFlow1(o),this.vipIcon.source=vipControl.isSuperVip(vipControl.lv)?"sviphuizhang":"viphuizhang",BitmapNumber.ins().changeNum(this.vipValue,vipControl.getVipLevel(vipControl.lv),"vip_v",3),this.vipNumGrp.width=this.vipValue.width,this.titleText.text=LangMgr.getValueByKey("activitVipRoot",vipControl.getVipStr(this._curLv)),this.suerBtn.visible=!1,this.suerBtn.enabled=!1,this.mc&&DisplayUtils.removeFromParent(this.mc),this.mc1&&DisplayUtils.removeFromParent(this.mc1),this.getRemindByIndex(t.id-1)?(this.suerBtn.visible=!0,this.suerBtn.label=LangMgr.getValueByKey("activitAlreadingGet")):vipControl.lv>=t.id&&(this.suerBtn.visible=!0,this.suerBtn.enabled=!0,this.suerBtn.label=LangMgr.getValueByKey("activitGet"),this.mc=this.mc||new GameMovieClip,this.mc.x=49,this.mc.y=22,this.mc.scaleX=.6,this.mc.scaleY=.85,this.mc.playFile(PATH_EFF+"chargeff1",-1),this.suerBtn.addChild(this.mc)),vipControl.lv==t.id?(this.suerBtn0.visible=!0,0==vipControl.weekState?(this.suerBtn0.enabled=!1,this.suerBtn0.label=LangMgr.getValueByKey("activitAlreadingGet")):(this.suerBtn0.enabled=!0,this.suerBtn0.label=LangMgr.getValueByKey("activitGet"),this.mc1=this.mc1||new GameMovieClip,this.mc1.x=49,this.mc1.y=22,this.mc1.scaleX=.6,this.mc1.scaleY=.85,this.mc1.playFile(PATH_EFF+"chargeff1",-1),this.suerBtn0.addChild(this.mc1))):(this.suerBtn0.visible=!1,this.suerBtn0.label=LangMgr.getValueByKey("activitGet"))},e.prototype.getRemindByIndex=function(t){var e=VipControl.ins(),i=e.state;return e.lv<=0?!1:1==(i>>t&1)},e.prototype.checkWeekReward=function(t){return vipControl.lv<=0?!1:t+1==vipControl.lv&&1==vipControl.weekState},e.prototype.changeBtn=function(){this._curLv>1?(this.leftBtn.visible=!0,this.rightBtn.visible=!0,this._curLv>=CommonUtils.getObjectLength(DataCenter.ins().VipConfig)&&(this.rightBtn.visible=!1)):this._curLv<=1&&(this.leftBtn.visible=!1,this.rightBtn.visible=!0)},e}(BaseEuiView);__reflect(VipView.prototype,"VipView");var VipGiftBtnItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="VipGiftBtnItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.item.source=t.img,this.viptxt.text="v"+t.vipLv;var e=vipControl.getVipGiftRedPoint(t.id);e?(this.mc||(this.mc=new GameMovieClip,this.mc.x=40,this.mc.y=42),this.mc.playFile(PATH_EFF+"actIconCircle",-1),this.addChild(this.mc)):(DisplayUtils.removeFromParent(this.mc),this.mc=null),this.redPoint.visible=e},e}(BaseItemRender);__reflect(VipGiftBtnItemRenderer.prototype,"VipGiftBtnItemRenderer");var WarriorConfigMgr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.maxStrenLevDict={},e.maxBreachLevDict={},e.maxEquipStrenDict={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getStrenLevCostId=function(){return this.getBaseConfig().UpgradeId},e.prototype.getBreachCostId=function(t){return this.getActiveCostId(t)},e.prototype.getBreachCostType=function(){return BackpackControl.BAG_TYPE_OTHTER},e.prototype.getStrenLevlCostType=function(){return BackpackControl.BAG_TYPE_OTHTER},e.prototype.getActiveCostId=function(t){var e=this.getAttrConfigById(t);return e.itemId},e.prototype.getActiveCostNum=function(t){return 1},e.prototype.gettActiveCostType=function(t){return BackpackControl.BAG_TYPE_OTHTER},e.prototype.getBaseConfig=function(){return DataCenter.ins().WarriorConfig},e.prototype.getAttrConfigById=function(t){return DataCenter.ins().WarriorAttrConfig[t]},e.prototype.getAttrConfigs=function(){return DataCenter.ins().WarriorAttrConfig},e.prototype.getLevConfigByLev=function(t,e){return DataCenter.ins().WarriorLvConfig[t][e]},e.prototype.getBreanchConfigByLev=function(t,e){return DataCenter.ins().WarriorBreachConfig[t][e]},e.prototype.getMaxStrenLev=function(t){if(!this.maxStrenLevDict[t]){var e=-1;for(var i in DataCenter.ins().WarriorLvConfig[t]){var n=DataCenter.ins().WarriorLvConfig[t][i];n.level>e&&(e=n.level)}this.maxStrenLevDict[t]=e}return this.maxStrenLevDict[t]},e.prototype.getMaxBreachLev=function(t){if(!this.maxBreachLevDict[t]){var e=-1;for(var i in DataCenter.ins().WarriorBreachConfig[t]){var n=DataCenter.ins().WarriorBreachConfig[t][i];n.star>e&&(e=n.star)}this.maxBreachLevDict[t]=e}return this.maxBreachLevDict[t]},e.prototype.getSkillCfgBySkillId=function(t){return DataCenter.ins().WarriorSkillConfig[t]},e.prototype.getEquipCfgByid=function(t){return DataCenter.ins().WarriorEquipConfig[t]},e.prototype.getEquipPosNum=function(){if(!this.equipPosNum){var t={},e=DataCenter.ins().WarriorEquipConfig;for(var i in e){var n=e[i].pos;t[n]=!0}var o=-1;for(var s in t){var n=Number(s);n>o&&(o=n)}this.equipPosNum=o}return this.equipPosNum},e.prototype.checkEquipPosExit=function(t){if(!this.equipPosDict){this.equipPosDict={};var e=DataCenter.ins().WarriorEquipConfig;for(var i in e){var n=e[i].pos;this.equipPosDict[n]=!0}}return this.equipPosDict[t]},e.prototype.getEquipLevUpCfgByLev=function(t,e){return DataCenter.ins().WarriorEquipLvUpConfig[t][e]},e.prototype.getEquipMaxStrenLev=function(t){if(!this.maxEquipStrenDict[t]){var e=-1,i=DataCenter.ins().WarriorEquipLvUpConfig[t];for(var n in i)e<i[n].level&&(e=i[n].level);this.maxEquipStrenDict[t]=e}return this.maxEquipStrenDict[t]},e.prototype.getEquipSuitDict=function(){if(!this.equipSuitNumDict){this.equipSuitNumDict={};var t=DataCenter.ins().WarriorEquipSuitConfig;for(var e in t)this.equipSuitNumDict[e]=!0}return this.equipSuitNumDict},e.prototype.getEquipSuitMinStar=function(t){if(!this.equipSuitMinStarDict){this.equipSuitMinStarDict={};var e=DataCenter.ins().WarriorEquipSuitConfig;for(var i in e){var n=Number.MAX_VALUE;for(var o in e[i]){var s=Number(o);n>s&&(n=s)}this.equipSuitMinStarDict[i]=n}}return this.equipSuitMinStarDict[t]},e.prototype.getEquipSuitMaxStar=function(t){if(!this.equipSuitMaxStarDict){this.equipSuitMaxStarDict={};var e=DataCenter.ins().WarriorEquipSuitConfig;for(var i in e){var n=-1;for(var o in e[i]){var s=Number(o);s>n&&(n=s)}this.equipSuitMaxStarDict[i]=n}}return this.equipSuitMaxStarDict[t]},e.prototype.getEquipSuitMaxNums=function(){if(!this.equipMaxSuitNum){var t=this.getEquipSuitDict();this.equipMaxSuitNum=-1;for(var e in t){var i=Number(e);i>this.equipMaxSuitNum&&(this.equipMaxSuitNum=i)}}return this.equipMaxSuitNum},e.prototype.getEquipSuitCfg=function(t,e){return DataCenter.ins().WarriorEquipSuitConfig[t][e]},e.prototype.getEquipComposeTabData=function(){if(!this.equipStarPosComposeDict){this.equipStarPosComposeDict={};var t=DataCenter.ins().WarriorEquipConfig;for(var e in t)if(t[e].composeItem){var i=t[e].star,n=t[e].pos;this.equipStarPosComposeDict[i]||(this.equipStarPosComposeDict[i]={}),this.equipStarPosComposeDict[i][n]=t[e]}}return this.equipStarPosComposeDict},e.prototype.getEquipPosComposeDict=function(){if(!this.equipPosComposeDict){this.equipPosComposeDict={};var t=DataCenter.ins().WarriorEquipConfig;for(var e in t)if(t[e].composeItem){var i=t[e].pos;this.equipPosComposeDict[i]=!0}}return this.equipPosComposeDict},e.prototype.getEquipMaxIdCfgByPos=function(t){return this.equipPosMaxIdCfg||this.initEquipMaxAndMinCfgByPos(t),this.equipPosMaxIdCfg[t]},e.prototype.getEquipMinIdCfgByPos=function(t){return this.equipPosMinIdCfg||this.initEquipMaxAndMinCfgByPos(t),this.equipPosMinIdCfg[t]},e.prototype.initEquipMaxAndMinCfgByPos=function(t){this.equipPosMaxIdCfg||(this.equipPosMaxIdCfg={}),this.equipPosMinIdCfg||(this.equipPosMinIdCfg={});for(var e=this.getEquipPosNum(),i=0;e>=i;++i)if(this.checkEquipPosExit(i)){var n=-1,o=Number.MAX_VALUE,s=DataCenter.ins().WarriorEquipConfig;for(var r in s)s[r].pos==i&&(s[r].Id>n&&(n=s[r].Id),s[r].Id<o&&(o=s[r].Id));this.equipPosMaxIdCfg[i]=s[n],this.equipPosMinIdCfg[i]=s[o]}},e.prototype.getFiveColor=function(t){switch(t){case 1:return"0xFFE400";case 2:return"0x00D20F";case 3:return"0x00DAEE";case 4:return"0xEF3E00";case 5:return"0xFF7800"}},e.prototype.getFiveName=function(t){return LangMgr.getValueByKey("warriorFive"+t)},e.prototype.getStarResArray=function(t,e){var i=[],n=null!=e?e:WarriorModel.ins().getCurBreachLev(t);if(10>=n){for(var o=1;n>=o;++o)i.push({star:"shenqi_star",fullStar:"shenqi_star_empty"});for(var o=n+1;10>=o;++o)i.push({fullStar:"shenqi_star_empty"})}else if(n>=11&&20>=n){for(var o=11;n>=o;++o)i.push({star:"shenqi_moon"});for(var o=n+1;20>=o;++o)i.push({star:"shenqi_star"})}else if(n>=21&&30>=n){for(var o=21;n>=o;++o)i.push({star:"shenqi_sun"});for(var o=n+1;30>=o;++o)i.push({star:"shenqi_moon"})}return i},e.prototype.getEquipName=function(t){return LangMgr.getValueByKey("warriorEquipPosName"+t)},e.MAX_EQUIP_ID=3,e}(SingleClass);__reflect(WarriorConfigMgr.prototype,"WarriorConfigMgr");var WarriorControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(353,e.createWarriorAvatar),e.addCustomEvent(40,e.createWarriorAvatar),e.addCustomEvent(353,function(){e.isWarriorBoss?e.dispatchEnterFb():e.lastWarriorBoss&&e.dispatchQuiKFb()}),e.addCustomEvent(300,function(){e.isWarriorBoss&&UIMgr.ins().open(BossBelongView)}),e.addCustomEvent(306,e.onBossDisappear),e.addCustomEvent(301,function(){e.isWarriorBoss&&UIMgr.ins().close(BossBelongView)}),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"isWarriorBoss",{get:function(){return 200==MapControl.copyType},enumerable:!0,configurable:!0}),e.prototype.dispatchEnterFb=function(){this.lastWarriorBoss=!0,this.addCustomEvent(305,this.reliveInfoChange)},e.prototype.onBossDisappear=function(){this.isWarriorBoss&&UIMgr.ins().open(BossEndView)},e.prototype.reliveInfoChange=function(){bossControl.reliveTime>0?UIMgr.ins().open(WorldBossBeKillView):UIMgr.ins().close(WorldBossBeKillView)},e.prototype.dispatchQuiKFb=function(){this.lastWarriorBoss=!1,UIMgr.ins().close(BossBelongView),EventMgr.removeListener(305,this.reliveInfoChange,this),UIMgr.ins().close(BossEndView)},e.prototype.createWarriorAvatar=function(){if(0==MapControl.copyType){var t=WarriorModel.ins().getBattlingId();if(t>0){var e=UnitMgr.ins().getEntityByHandle(this.warriorHandler);if(e){if(t!=this.oldBattlingId){var n=WarriorConfigMgr.ins().getAttrConfigById(t),o=DataCenter.ins().MonstersConfig[n.monsterId],s=copyControl.createModel(o);o.ms||s.setAtt(9,i.WARRIOR_MOVING_SPEED);var r=WarriorModel.ins().getFuzhuList();if(r.length>0){for(var a=s.getAtt(4),l=WarriorConfigMgr.ins().getBaseConfig(),h=0,u=r;h<u.length;h++){var p=u[h],c=WarriorConfigMgr.ins().getAttrConfigById(p),d=DataCenter.ins().MonstersConfig[c.monsterId];a+=d.atk*l.AssistInherit/1e4}s.setAtt(4,a)}s.handle=e.infoModel.handle,s.masterHandle=e.infoModel.masterHandle,s.x=e.infoModel.x,s.y=e.infoModel.y,s.team=e.team,e.infoModel=s,e.updateModel(),this.oldBattlingId=t}}else{var g=UnitMgr.ins().getNoDieRole();if(g){var n=WarriorConfigMgr.ins().getAttrConfigById(t),o=DataCenter.ins().MonstersConfig[n.monsterId],s=copyControl.createModel(o);o.ms||s.setAtt(9,i.WARRIOR_MOVING_SPEED);var r=WarriorModel.ins().getFuzhuList();if(r.length>0){for(var a=s.getAtt(4),l=WarriorConfigMgr.ins().getBaseConfig(),m=0,f=r;m<f.length;m++){var p=f[m],c=WarriorConfigMgr.ins().getAttrConfigById(p),d=DataCenter.ins().MonstersConfig[c.monsterId];a+=d.atk*l.AssistInherit/1e4}s.setAtt(4,a)}s.x=g.x,s.y=g.y,s.masterHandle=ActorControl.handle,this.warriorHandler=s.handle=egret.getTimer();var v=gameControl.createEntityByModel(s,0);v.AI_STATE=0,this.oldBattlingId=t}}}}},e.prototype.updateOneWarriorData=function(t){var e=new WarriorVo;e.init(t),WarriorModel.ins().updateWarriorData(e)},e.prototype.downWarriorData=function(t,e,i,n,o){WarriorModel.ins().updateBattingId(t),WarriorModel.ins().updateEquipStrenExp(e),this.dispatchWarriorEquipExpChange(),WarriorModel.ins().updateFuzhuList(i),this.dispatchWarriorBattleChange();for(var s=0;s<n.length;++s)this.updateOneWarriorData(n[s]);this.downEquipData(o),this.dispatchWarriorDataChange(),this.dispatchWarriorEquipDataChange()},e.prototype.downUpdateWarriorData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.updateOneWarriorData(t),this.dispatchWarriorDataChange()},e.prototype.downResolveEquip=function(t){t||EventMgr.ins().dispatch(38)},e.prototype.downComposeEquip=function(t){t||EventMgr.ins().dispatch(39)},e.prototype.downWarriorBatteStatus=function(t,e){WarriorModel.ins().updateBattingId(t),WarriorModel.ins().updateFuzhuList(e),this.dispatchWarriorBattleChange()},e.prototype.downEquipStrenExp=function(t){WarriorModel.ins().updateEquipStrenExp(t),this.dispatchWarriorEquipExpChange()},e.prototype.downEquipData=function(t){for(var e=0;e<t.length;++e)for(var i=t[e][0],n=0;n<t[e][1].length;++n){var o=new WarriorEquipVo;o.init(t[e][1][n]),WarriorModel.ins().updateEquipData(i,o)}this.dispatchWarriorEquipDataChange()},e.prototype.downTaskData=function(t,e){WarriorModel.ins().updateTaskData(t,e),EventMgr.ins().dispatch(44)},e.prototype.buyCount=function(){var t=20,e=DataCenter.ins().WorldBossBaseConfig.challengeItem[t-1],i=bossControl.worldBossBelongBuyTime[t],n=DataCenter.ins().WorldBossBaseConfig.belongbuycount[t-1][vipControl.lv],o=bossControl.worldBossBelongTime[t];if(o>0)return void tipsControl.warnTips(LangMgr.getValueByKey("warriorBossTimeTip",i,n));var s=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,e);if(s>0){var r=DataCenter.ins().ItemConfig[e];return void warnControl.show(LangMgr.getValueByKey("warriorBelongItemUse",ItemUtils.getQualityColor(r),r.name),function(){backpackControl.upUseItem(e,1),bossControl.upWorldBossInfo(t)},this)}if(!n)return void tipsControl.showTips(LangMgr.getValueByKey("warriorVipExBelongTime"));if(0>=o&&i>=n){for(var a=-1,l=0,h=DataCenter.ins().WorldBossBaseConfig.belongbuycount[t-1];l<h.length;l++){var u=h[l];u>a&&(a=u)}return void(a>n?tipsControl.showTips(LangMgr.getValueByKey("warriorVipExBelongTime")):tipsControl.showTips(LangMgr.getValueByKey("warriorBuyTimeMax")))}if(ActorControl.yb<DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[t-1])return void tipsControl.showTips(LangMgr.getValueByKey("userNoMony"));var p=LangMgr.getValueByKey("warriorBelongTimeTip1",DataCenter.ins().WorldBossBaseConfig.buyBelongCountPrice[t-1],i,n);warnControl.show(p,function(){bossControl.upBuyBelongNum(t)},this)},e.prototype.enterFb=function(t){var e=20;if(!WarriorModel.ins().checkDunFive(t))return void tipsControl.showTips(LangMgr.getValueByKey("warriorFiveTip"));if(bossControl.worldInfoList[e]){for(var i=bossControl.worldInfoList[e].slice(),n=0;n<i.length;++n)i[n].id==t&&i[n].isDie&&tipsControl.showTips(LangMgr.getValueByKey("bossChallengeEnd"));if(!copyControl.checkInFB()&&crossArenaControl.checkIsMatching()){DataCenter.ins().WorldBossConfig[t];if(!bossControl.worldBossBelongTime[e])return void this.buyCount();bossControl.challengWorldBoss(t,e)}}},e.prototype.upUseDrugA=function(t){this.upUseDrug(t,1)},e.prototype.upUseDrugB=function(t){this.upUseDrug(t,2)},e.prototype.upUseDrug=function(t,e){return[t,e]},e.prototype.upActive=function(t){return[t]},e.prototype.upStrenLev=function(t){return[t]},e.prototype.upUpBattle=function(t,e,i){return[t,e,i]},e.prototype.upBreach=function(t){return[t]},e.prototype.upWearEquip=function(t,e,i){return[t,e,i]},e.prototype.upStrenEquip=function(t,e){return[t,e]},e.prototype.upResolveEquip=function(t){return[t]},e.prototype.upComposeEquip=function(t,e){return[t,e]},e.prototype.upTaskReward=function(){},e.prototype.dispatchWarriorDataChange=function(){EventMgr.ins().dispatch(37)},e.prototype.dispatchWarriorBattleChange=function(){EventMgr.ins().dispatch(40)},e.prototype.dispatchWarriorEquipExpChange=function(){EventMgr.ins().dispatch(41)},e.prototype.dispatchDunRemindRedPointChange=function(){EventMgr.ins().dispatch(42)},e.prototype.dispatchWarriorEquipDataChange=function(){EventMgr.ins().dispatch(43)},e.WARRIOR_MOVING_SPEED=3750,__decorate([down(1,[2,3,[2],ByteConst.WarriorVos,[2,ByteConst.WarriorEquipVos]])],e.prototype,"downWarriorData",null),__decorate([down(2,ByteConst.WarriorVos.slice())],e.prototype,"downUpdateWarriorData",null),__decorate([down(8,[1])],e.prototype,"downResolveEquip",null),__decorate([down(9,[1])],e.prototype,"downComposeEquip",null),__decorate([down(10,[2,[2]])],e.prototype,"downWarriorBatteStatus",null),__decorate([down(11,[3])],e.prototype,"downEquipStrenExp",null),__decorate([down(13,[[2,ByteConst.WarriorEquipVos]])],e.prototype,"downEquipData",null),__decorate([down(14,[1,1])],e.prototype,"downTaskData",null),__decorate([up(12,[2,1])],e.prototype,"upUseDrug",null),__decorate([up(3,[2])],e.prototype,"upActive",null),__decorate([up(4,[2])],e.prototype,"upStrenLev",null),__decorate([up(10,[2,1,1])],e.prototype,"upUpBattle",null),__decorate([up(5,[2])],e.prototype,"upBreach",null),__decorate([up(6,[2,1,3])],e.prototype,"upWearEquip",null),__decorate([up(7,[2,1])],e.prototype,"upStrenEquip",null),__decorate([up(8,[[3]])],e.prototype,"upResolveEquip",null),__decorate([up(9,[2,3])],e.prototype,"upComposeEquip",null),__decorate([up(14)],e.prototype,"upTaskReward",null),e=i=__decorate([protocolsId(15)],e);
var i}(BaseSystem);__reflect(WarriorControl.prototype,"WarriorControl");var WarriorEquipVo=function(){function t(){}return t.prototype.init=function(t){this.pos=t[0],this.itemId=t[1],this.strenLev=t[2]},t}();__reflect(WarriorEquipVo.prototype,"WarriorEquipVo");var AmuseTarget11Panel3=function(t){function e(e){var i=t.call(this)||this;return i._curDayIndex=0,i.activityID=e,i.setCurSkin(),i}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!this._init){this.tabD.itemRenderer=VersionCeleTabBtnItemRender,this.rewardlist.itemRenderer=VersionCeleRewardItemRender;var i=DataCenter.ins().AmusementBtnConfig[this.activityID];i&&(this.list.itemRenderer=i.listItem?egret.getDefinitionByName(i.listItem[0]):VersionCeleProjectItemRender),this._curDayIndex=0,this.setAct22ID(),this.updateView(),this.tabD.selectedIndex=this._curDayIndex,this.updateData(),this.addEventTouchTap(this,this.onTouch),this.addCustomEvent(392,this.refreshReds),this.addEventChange(this.tabD,this.onClickBtn),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),this._init=!0,this.visible=!0}},e.prototype.setAct22ID=function(){this.activity22ID=0;for(var t in amusementControl.activityData){var e=amusementControl.activityData[t];if(e&&22==e.type&&amusementControl.getAmusementDataById(+t).isOpenActivity()&&!amusementControl.getAmusementDataById(+t).getHide())return void(this.activity22ID=e.id)}},e.prototype.close=function(){this._btnCollect=null,this._listCollect=null,TimerMgr.ins().removeAll(this),this._init=!1,this.osa22Panel2&&(this.osa22Panel2.close(),DisplayUtils.removeFromParent(this.osa22Panel2),this.osa22Panel2=null)},e.prototype.setCurSkin=function(){var t=DataCenter.ins().AmusementConfig[this.activityID];t.pageSkin?this.skinName=t.pageSkin:this.skinName="AmuseTarget11Panel3Skin",this.actDesc&&(this.actDesc.text=t.desc)},e.prototype.updateView=function(){var t=amusementControl.getAmusementDataById(this.activityID);this._items=[];var e,i,n,o,s=DataCenter.ins().Amusement11_2Config[this.activityID],r=[];for(var a in s)e=s[a],n=e.group,i=this._items[n-1],i||(i=[],this._items[n-1]=i,r.push({gName:e.gName,showRed:!1})),o=t.achieveInfo[e.index-1],!o.isGot&&o.times>=e.dayLimit&&(r[n-1].showRed=!0),i.push(e);this._btnCollect||(this._btnCollect=new ArrayCollection,this.tabD.dataProvider=this._btnCollect),this._btnCollect.source=r,this.tabD.validateNow();var l=amusementControl.activityData[this.activity22ID];this.redPointImg.visible=AmusementType11DataVo.FIRST_OPEN_SHOP||l.refreshFree},e.prototype.refreshReds=function(){this.updateView(),this.updateData()},e.prototype.updateData=function(){var t=this._items[this._curDayIndex];if(t&&t.length){this._listCollect||(this._listCollect=new ArrayCollection,this.list.dataProvider=this._listCollect);for(var e,i,n=t.length,o=[],s=0,r=amusementControl.getAmusementDataById(this.activityID),a=0;n>a;a++)e=t[a],i=r.achieveInfo[e.index-1],s=i.isGot?2:i.times>=e.dayLimit?1:0,o[a]={activityID:this.activityID,conf:e,state:s,times:i.times};o.sort(this.sort),this._listCollect.source=o,n=Object.keys(DataCenter.ins().Amusement11_1Config[this.activityID]).length;var l=[];l.length=n;var h,u;for(u=1;n>=u;u++)h=DataCenter.ins().Amusement11_1Config[this.activityID][u],s=r.rewardInfo>>u&1?2:r.gethiScore()>=h.score?1:0,l[u-1]={activityID:this.activityID,index:u,state:s,config:h};this._rewardCollect||(this._rewardCollect=new ArrayCollection,this.rewardlist.dataProvider=this._rewardCollect),this._rewardCollect.source=l,this.totalScore.text=r.gethiScore()+""}},e.prototype.sort=function(t,e){return 1==t.state&&1!=e.state?-1:1!=t.state&&1==e.state?1:2==t.state&&2!=e.state?1:t.conf.index<e.conf.index?-1:t.conf.index>e.conf.index?1:0},e.prototype.onTouch=function(t){switch(t.target){case this.shopBtn:if(!this.activity22ID)return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));this.visible=!1,this.osa22Panel2||(this.osa22Panel2=ObjectPool.pop("AmuseTarget22Panel2",[this.activity22ID]),this.osa22Panel2.top=0,this.osa22Panel2.bottom=0,this.osa22Panel2.left=0,this.osa22Panel2.right=0),this.osa22Panel2.activityID=this.activity22ID,this.parent.addChild(this.osa22Panel2),this.osa22Panel2.open(),AmusementType11DataVo.FIRST_OPEN_SHOP=!1,amusementControl.dispatchActivityIsGetAwards()}},e.prototype.onClickBtn=function(t){this._curDayIndex!=t.currentTarget.selectedIndex&&(this._curDayIndex=t.currentTarget.selectedIndex,this.updateData(),this.updateView())},e.prototype.setTime=function(){var t=amusementControl.activityData[this.activityID];t&&(this.actTime.text=t.getRemainTime());var e=amusementControl.activityData[this.activity22ID];if(e){var i=e.getRefreshTime();this.refreshTime.text=DateUtils.getFormatBySecond(i>0?i:0,DateUtils.TIME_FORMAT_1,5)+LangMgr.getValueByKey("osaAfteUpdate","")}else this.refreshTime.text=LangMgr.getValueByKey("osaAfteUpdate","00:00:00");if(this.dailyRefreshTime){var n=new Date(GameServer.serverTime),o=n.getTime();n.setDate(n.getDate()+1),n.setHours(0,0,0,0),o=Math.floor((n.getTime()-o)/1e3/60);var s=Math.floor(o/60),r=Math.floor(o%60);this.dailyRefreshTime.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("timeremaininghm",s,r))}},e}(BasePanel);__reflect(AmuseTarget11Panel3.prototype,"AmuseTarget11Panel3");var WarriorVo=function(){function t(){}return t.prototype.init=function(t){this.id=t[0],this.strenLev=t[1],this.breachLev=t[2],this.useDrugANum=t[3],this.useDrugBNum=t[4],this.strenExp=t[5]},t}();__reflect(WarriorVo.prototype,"WarriorVo");var WarriorActiveItemTipView=function(t){function e(){var e=t.call(this)||this;return e.modelPrefix=PATH_EFF,e.skinName="WarriorActiveItemTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeEventItemTap(this.gainList,this.onTouchList)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.otherClose),this.gainList.itemRenderer=GainGoodsItem,this.addEventItemTap(this.gainList,this.onTouchList),this.skillList.itemRenderer=WarriorActiveItemTipSkillItemRenderer,this.itemid=t[0];var i=WarriorConfigMgr.ins().getAttrConfigs();for(var n in i){var o=i[n];if(o.itemId==this.itemid){this.attrCfg=o;break}}if(this.attrCfg){this.powerPanel.setPower(BackpackControl.getAttrPower(this.attrCfg.attr)),this.skillIcon.source=this.attrCfg.skillicon+"_png";var s=DataCenter.ins().SkillsConfig[this.attrCfg.skillid],r=DataCenter.ins().SkillsDescConfig[s.desc];this.desc.textFlow=TextUtils.generateTextFlow1(r.desc),this.model||(this.model=new GameMovieClip),this.model.scaleX=this.model.scaleY=.85,this.model.parent||this.grpModel.addChild(this.model),this.model.name!=this.modelPrefix+(""+this.attrCfg.innerAppearance)&&this.model.playFile(this.modelPrefix+(""+this.attrCfg.innerAppearance),-1),this.bottomMc||(this.bottomMc=new GameMovieClip),this.bottomMc.parent||this.bottomD.addChild(this.bottomMc),this.bottomMc.isPlaying||this.bottomMc.playFile(PATH_EFF+"zhanlingbottom",-1);var a=DataCenter.ins().ItemConfig[this.itemid];this.itemIcon.setData(a),this.lblName.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(a)+"&T:"+a.name),this.lblTitle.text=a.name;var l=ItemUtils.getQuality(a);this.qualiImg.source=l>0?"quali"+l:"";var h=DataCenter.ins().PropsGainConfig[this.itemid];h&&(this.gainList.dataProvider=new eui.ArrayCollection(h.gainWay));var u=[],p=this.attrCfg.skill,c=DataCenter.ins().WarriorSkillConfig;for(var n in c)for(var d=c[n],g=0,m=0,f=p;m<f.length;m++){var v=f[m];if(v.id==d.id){g=v.open,u.push({openLv:g,cfg:d});break}}this.skillList.dataProvider=new eui.ArrayCollection(u)}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onTouchList=function(t){var e=t.item;null!=t.item&&e[1]&&UIMgr.ins().open(e[1],e[2])},e}(BaseEuiView);__reflect(WarriorActiveItemTipView.prototype,"WarriorActiveItemTipView");var WarriorBossRemindTipView=function(t){function e(){var e=t.call(this)||this;return e.type=20,e.skinName="WarriorBossRemindTipViewSkin",e.isTopLevel=!0,e.list.itemRenderer=WarriorBossRemindItemRenderer,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTouch);var t=bossControl.worldInfoList[this.type].slice();if(t)for(var e=t.length-1;e>-1;e--){var i=DataCenter.ins().WorldBossConfig[t[e].id];(-1==WarriorModel.ins().canRemindBossIdList.indexOf(t[e].id)||i.openTime>GameServer.serverOpenDay)&&t.splice(e,1)}this.list.dataProvider=new eui.ArrayCollection(t.sort(this.compareFn))},e.prototype.close=function(){this.removeEventTouchTap(this.bgClose,this.onTouch),bossControl.upBossSetting(),warriorControl.dispatchDunRemindRedPointChange()},e.prototype.onTouch=function(t){t.target==this.bgClose&&UIMgr.ins().close(this)},e.prototype.compareFn=function(t,e){var i=DataCenter.ins().WorldBossConfig[t.id],n=DataCenter.ins().WorldBossConfig[e.id],o=BossControl.isCanChallenge(i),s=BossControl.isCanChallenge(n);return o&&!s?-1:!o&&s?1:i.samsaraLv>n.samsaraLv?1:i.samsaraLv<n.samsaraLv?-1:i.zsLevel>n.zsLevel?1:i.zsLevel<n.zsLevel?-1:i.level>n.level?1:i.level<n.level?-1:t.id>e.id?1:t.id<e.id?-1:0},e}(BaseEuiView);__reflect(WarriorBossRemindTipView.prototype,"WarriorBossRemindTipView");var WarriorBossView=function(t){function e(){var e=t.call(this)||this;return e.oldTapIndex=0,e.skinName="WarriorBossViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.openCheck=function(t){var e=WarriorConfigMgr.ins().getBaseConfig();if(reincarnateControl.lv<e.BossZSLv)return tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",e.BossZSLv)),!1;if(GameServer.serverOpenDay+1<e.BossOpenDay)return tipsControl.showTips(LangMgr.getValueByKey("serverDayOpen",e.BossOpenDay)),!1;var i=WarriorModel.ins().getBossListDatas();return i.length<=0&&tipsControl.showTips(LangMgr.getValueByKey("warriorNoBossData")),i.length>0},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initAllEvents(),this.warriorFuben.open()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents(),this.warriorFuben.close()},e.prototype.initAllEvents=function(){this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.seeRule,this.onClick)},e.prototype.removeAllEvents=function(){this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeEventTouchTap(this.seeRule,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:HelpControl.openHelpWin(2001)}},e}(BaseEuiView);__reflect(WarriorBossView.prototype,"WarriorBossView");var WarriorBreachPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.warriorId=1,e.listSelectIndex=0,e.gap=12,e.showListRangeNum=5,e.moveScrollerWidth=450,e.maxScrollerDis=0,e.listItemWidth=78,e.srcollerWidth=458,e.listData=[],e.modelPrefix=PATH_EFF,e.firstInitList=!0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initUI()},e.prototype.initUI=function(){this.starList=new StarList(10,0,45,1,1),this.starList.scaleX=.7,this.starList.scaleY=.7,this.groupTop.addChildAt(this.starList,0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initAllEvents(),this.getItemTxt.textFlow=[{text:this.getItemTxt.text,style:{underline:!0}}],this.listWarrior.itemRenderer=WarriorPersonItemRenderer,this.listWarrior.dataProvider=this.listWarrior.dataProvider||new eui.ArrayCollection;var i=this.btnBreak.labelDisplay;i&&(i.size=24),this.updateView(),this.updateModel(!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents()},e.prototype.initAllEvents=function(){this.addCustomEvent(267,this.onItemChange),this.addCustomEvent(266,this.onItemChange),this.addCustomEvent(268,this.onItemChange),this.addCustomEvent(37,this.updateView),this.addEventItemTap(this.listWarrior,this.onListWarriorTap),this.addEventChange(this.scroller,this.onScrollerChange),this.addEventTouchTap(this.getItemTxt,this.onTap),this.addEventTouchTap(this.btnBreak,this.onTap),this.addEventTouchTap(this.grpSkill,this.onTap),this.addEventTouchTap(this.grpSkillNext,this.onTap)},e.prototype.removeAllEvents=function(){this.removeCustomEvents(),this.removeEventItemTap(this.listWarrior,this.onListWarriorTap),this.removeEventChange(this.scroller,this.onScrollerChange),this.removeEventTouchTap(this.getItemTxt,this.onTap),this.removeEventTouchTap(this.btnBreak,this.onTap),this.removeEventTouchTap(this.grpSkill,this.onTap),this.removeEventTouchTap(this.grpSkillNext,this.onTap)},e.prototype.onListWarriorTap=function(t){var e=t.itemIndex;e!=this.listSelectIndex&&(this.warriorId=t.item.cfg.Id,this.updateView(),this.updateModel(!0))},e.prototype.onScrollerChange=function(){this.updateListArrow(),this.updateListArrowRed()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.getItemTxt:warnControl.setBuyGoodsWarn(WarriorConfigMgr.ins().getBreachCostId(this.warriorId));break;case this.btnBreak:WarriorModel.ins().checkIsActivated(this.warriorId)&&warriorControl.upBreach(this.warriorId);break;case this.rightGroup:this.moveList(1);break;case this.leftGroup:this.moveList(-1);break;case this.grpSkill:this.skillId&&DataCenter.ins().SkillsConfig[this.skillId]&&UIMgr.ins().open(WarriorSkillTipView,this.warriorId,null,this.skillId);break;case this.grpSkillNext:this.skillId&&DataCenter.ins().SkillsConfig[this.skillId]&&UIMgr.ins().open(WarriorSkillTipView,this.warriorId,null,this.nextSkillId)}},e.prototype.onItemChange=function(){this.updateCostView(),this.updateRed()},e.prototype.updateView=function(){this.updateListWarrior(),this.updateVisibleByStatus(),this.updateCostView(),this.updateAttrView(),this.updatePower(),this.updateRed(),this.updateInfo(),this.updateSkillView()},e.prototype.moveList=function(t){var e=this.scroller.viewport.scrollH,i=Math.ceil(e/(this.listItemWidth+this.gap));i+=t*this.showListRangeNum,i=0>i?0:i;var n=(this.listItemWidth+this.gap)*i;n=n>this.maxScrollerDis?this.maxScrollerDis:n,this.scroller.viewport.scrollH=n,this.onScrollerChange()},e.prototype.updateListArrow=function(){var t=this.scroller.viewport.scrollH;this.leftGroup.visible=t>=10,this.rightGroup.visible=t+10<=this.maxScrollerDis},e.prototype.updateListWarrior=function(){var t=WarriorConfigMgr.ins().getAttrConfigs(),e=[];for(var i in t){var n=t[i];WarriorModel.ins().checkIsActivated(n.Id)&&e.push({cfg:n,isRed:WarriorModel.ins().checkOneWarriorRedForTabBreach(n.Id)})}e.sort(this.sortWarrior),this.listData=e,this.listWarrior.dataProvider.replaceAll(e),this.firstInitList&&(this.firstInitList=!1,this.warriorId=e[0].cfg.Id,this.listSelectIndex=0);for(var o=0;o<e.length;++o)if(e[o].cfg.Id==this.warriorId){this.listSelectIndex=o;break}this.listWarrior.selectedIndex=this.listSelectIndex,this.gap=this.listWarrior.layout.gap,this.moveScrollerWidth=(this.listItemWidth+this.gap)*this.showListRangeNum,this.maxScrollerDis=e.length*this.listItemWidth+(e.length>1?e.length-1:0)*this.gap-this.srcollerWidth,this.maxScrollerDis=this.maxScrollerDis<0?0:this.maxScrollerDis,this.updateListArrow()},e.prototype.sortWarrior=function(t,e){var i=WarriorModel.ins().getBattlingId();if(t.cfg.Id==i)return-1;if(e.cfg.Id==i)return 1;var n=WarriorModel.ins().getFuzhuList(),o=-1!=n.indexOf(t.cfg.Id),s=-1!=n.indexOf(e.cfg.Id);return o&&s||!o&&!s?e.cfg.slot-t.cfg.slot:o?-1:1},e.prototype.updateVisibleByStatus=function(){var t=WarriorModel.ins().checkIsActivated(this.warriorId),e=WarriorModel.ins().checkIsBreachLevMax(this.warriorId);this.btnBreak.visible=t&&!e,this.grpAttr.visible=t,this.lblMaxTip.visible=e,this.lblActiveTip.visible=!t,this.costGroup.visible=t&&!e,this.getItemTxt.visible=t&&!e},e.prototype.updateCostView=function(){var t=WarriorModel.ins().checkIsActivated(this.warriorId),e=WarriorModel.ins().checkIsBreachLevMax(this.warriorId);if(t&&!e){var i=WarriorConfigMgr.ins().getBreachCostId(this.warriorId),n=WarriorModel.ins().getBreachLevCostNum(this.warriorId),o=WarriorConfigMgr.ins().getBreachCostType(),s=backpackControl.getBagItemById(i,o),r=s?s.count:0,a="";a=r>=n?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.costLbl.textFlow=TextUtils.generateTextFlow("<font color="+a+">"+r+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+n+"</font> ");var l=DataCenter.ins().ItemConfig[i];this.costImg.source=l?l.icon+"_png":null}},e.prototype.updateAttrView=function(){var t=(WarriorModel.ins().checkIsActivated(this.warriorId),WarriorModel.ins().checkIsBreachLevMax(this.warriorId));if(this.grpAttrShow.addChildAt(this.grpCurAttr,0),this.grpAttrShow.addChildAt(this.arrowImg,1),this.grpAttrShow.addChildAt(this.grpNextAttr,2),t){DisplayUtils.removeFromParent(this.grpNextAttr),DisplayUtils.removeFromParent(this.arrowImg),this.grpAttrShow.top=50,this.grpAttrShow.bottom=0,this.attr.text="";var e=0,i=WarriorModel.ins().getBreachCurAttr(this.warriorId);e=0;for(var n=0,o=i;n<o.length;n++){var s=o[n];this.attr.text+=AttributeData.getAttrStrByType(s.type)+("+"+Math.floor(s.value))+(e<i.length-1?"\n":""),e++}this.nextAttr.text=LangMgr.getValueByKey("maxLevel")}else{var r=WarriorModel.ins().getBreachNextAttr(this.warriorId);this.attr.text="";var e=0,a=WarriorModel.ins().getCurBreachLev(this.warriorId);if(!a)for(var l=0,h=r;l<h.length;l++){var s=h[l];this.attr.text+=AttributeData.getAttrStrByType(s.type)+"+0"+(e<r.length-1?"\n":""),e++}a?(this.grpAttrShow.addChildAt(this.grpCurAttr,0),this.grpAttrShow.addChildAt(this.arrowImg,1),this.grpAttrShow.addChildAt(this.grpNextAttr,2),this.grpAttrShow.top=14,this.grpAttrShow.bottom=45):(DisplayUtils.removeFromParent(this.grpCurAttr),DisplayUtils.removeFromParent(this.arrowImg),this.grpAttrShow.addChild(this.grpNextAttr),this.grpAttrShow.top=50,this.grpAttrShow.bottom=0);var i=WarriorModel.ins().getBreachCurAttr(this.warriorId);e=0;for(var u=0,p=i;u<p.length;u++){var s=p[u];this.attr.text+=AttributeData.getAttrStrByType(s.type)+("+"+Math.floor(s.value))+(e<i.length-1?"\n":""),e++}this.nextAttr.text="",e=0;for(var c=0,d=r;c<d.length;c++){var s=d[c];this.nextAttr.text+=AttributeData.getAttrStrByType(s.type)+("+"+Math.floor(s.value))+(e<r.length-1?"\n":""),e++}}},e.prototype.updatePower=function(){var t=WarriorModel.ins().getBreachCurAttr(this.warriorId),e=WarriorModel.ins().getBreachNextAttr(this.warriorId);this.powerPanelCur.setPower(BackpackControl.getAttrPower(t)*heroControl.subRolesLen),this.powerPanelNext.setPower(BackpackControl.getAttrPower(e)*heroControl.subRolesLen)},e.prototype.updateModel=function(t){void 0===t&&(t=!1),this.bossMc&&this.bossMc.parent||(this.bossMc=this.bossMc||new GameMovieClip,this.bossGroup.removeChildren(),this.bossGroup.addChild(this.bossMc));var e=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);this.bossMc.playFile(this.modelPrefix+(""+e.innerAppearance),-1)},e.prototype.updateRed=function(){this.redTupo.visible=WarriorModel.ins().checkCanBreach(this.warriorId),this.updateListArrowRed()},e.prototype.updateListArrowRed=function(){for(var t=24,e=this.scroller.viewport.scrollH,i=Math.ceil(e/(this.listItemWidth+this.gap)),n=e%(this.listItemWidth+this.gap),o=!1,s=0;i>s;++s)if(!(s==i-1&&n>0&&n<=this.listItemWidth-5)){var r=this.listData[s];if(r&&WarriorModel.ins().checkOneWarriorRedForTabBreach(r.cfg.Id)){o=!0;break}}this.leftRed.visible=o,o=!1;var a=i+this.showListRangeNum;for(n>0&&n<this.listItemWidth-t-5&&a--;a<this.listData.length;++a){var r=this.listData[a];if(WarriorModel.ins().checkOneWarriorRedForTabBreach(r.cfg.Id)){o=!0;break}}this.rightRed.visible=o},e.prototype.updateInfo=function(){this.starList.setlistLength(10,0,60),this.starList.updateStar(0,WarriorConfigMgr.ins().getStarResArray(this.warriorId));var t=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);this.imgName.source=t.TipsName+"_png"},e.prototype.updateSkillView=function(){var t=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);this.skillIconImg.source=t.skillicon+"_png";var e=t.skillid,i=WarriorModel.ins().getCurBreachLev(this.warriorId),n=WarriorConfigMgr.ins().getBreanchConfigByLev(this.warriorId,i);n&&(e=n.skillid),this.skillId=e;var o,s=DataCenter.ins().SkillsConfig[e];s&&(o=DataCenter.ins().SkillsDescConfig[s.desc],this.lblSkillName.text=o.name);var r=WarriorModel.ins().checkIsBreachLevMax(this.warriorId);if(this.grpSkillNext.visible=!r,!r){var a=WarriorConfigMgr.ins().getBreanchConfigByLev(this.warriorId,i+1);e=a.skillid,this.nextSkillId=e,s=DataCenter.ins().SkillsConfig[e],this.skillIconImgNext.source=t.skillicon+"_png",s&&(o=DataCenter.ins().SkillsDescConfig[s.desc],this.lblSkillNameNext.text=o.name)}},e}(BasePanel);__reflect(WarriorBreachPanel.prototype,"WarriorBreachPanel");var WarriorDrugDetailTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorDrugDetailTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.otherClose),this.id=t[0],this.useNum=t[1],this.limitNum=t[2],this.attrs=t[3],this.nextLimitDrugLv=t[4],this.addPre=t[5],this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(){var t=DataCenter.ins().ItemConfig[this.id];this.itemIcon.setData(t),this.lblName.text=t.name,this.lblName.textColor=ItemUtils.getQualityColor(t);var e=this.useNum>0?65280:16711680;this.lblUseTip.textFlow=[{text:this.useNum+"",style:{textColor:e}},{text:"/"+this.limitNum}],this.lblTip.text="",this.lblTip.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("warriorDrugTip")),this.lblAttr.text="";for(var i=0,n=0,o=this.attrs;n<o.length;n++){var s=o[n];this.lblAttr.text+=AttributeData.getAttrStrByType(s.type)+"+"+s.value+(i<this.attrs.length-1?"\n":""),i++}this.addPre&&(this.lblAttr.text+="\n"+LangMgr.getValueByKey("warriorBaseAttr")+"+"+100*this.addPre+"%"),this.nextLimitDrugLv?(this.lblLimitTip.visible=!0,this.lblLimitTip.text="",this.lblLimitTip.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("warriorDrugTip1",this.nextLimitDrugLv))):this.lblLimitTip.visible=!1},e}(BaseEuiView);__reflect(WarriorDrugDetailTipView.prototype,"WarriorDrugDetailTipView");var WarriorDunPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=20,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.listBoss.itemRenderer=WarriorBossItemRenderer,this.listBoss.dataProvider=new eui.ArrayCollection,this.updateBossList(),this.listBoss.selectedIndex=0,this.listBoss.dataProvider.source.length>0&&(this.listSelectId=this.listBoss.dataProvider.source[0].bossItem.id),this.rewardList.itemRenderer=ItemBase,this.rewardList.dataProvider=new eui.ArrayCollection,this.lblTip.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.lblTip.text+"</u></a>"),this.lblBuyCount.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.lblBuyCount.text+"</u></a>"),TimerMgr.ins().doTimer(1e3,0,this.onTimer,this),this.initAllEvents(),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents(),TimerMgr.ins().remove(this.onTimer,this)},e.prototype.initAllEvents=function(){this.addEventChange(this.listBoss,this.onListChange),this.addEventTouchTap(this.lblTip,this.onTap),this.addEventTouchTap(this.btnChallenge,this.onTap),this.addEventTouchTap(this.lblBuyCount,this.onTap),this.addCustomEvent(296,this.updateBossList),this.addCustomEvent(296,this.updateView),this.addCustomEvent(42,this.updateBossList),this.addCustomEvent(42,this.updateView)},e.prototype.removeAllEvents=function(){this.removeCustomEvents(),this.removeEventTouchTap(this.lblTip,this.onTap),this.removeEventTouchTap(this.btnChallenge,this.onTap),this.removeEventTouchTap(this.lblBuyCount,this.onTap),this.removeEventChange(this.listBoss,this.onListChange)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.lblBuyCount:warriorControl.buyCount();break;case this.lblTip:UIMgr.ins().open(WarriorBossRemindTipView);break;case this.btnChallenge:warriorControl.enterFb(this.listSelectId)}},e.prototype.onListChange=function(){var t=this.listBoss.selectedItem;t&&t.bossItem.id!=this.listSelectId&&(this.listSelectId=t.bossItem.id,this.updateView())},e.prototype.onTimer=function(){for(var t=0;t<this.listBoss.numElements;t++){var e=this.listBoss.getElementAt(t);e&&e.upTimer()}},e.prototype.updateView=function(){this.listSelectId&&(this.updateModel(),this.updateReward(),this.updateInfo(),this.updateFiveAttr(),this.updateRed())},e.prototype.updateModel=function(){this.bossMc&&this.bossMc.parent||(this.bossMc=this.bossMc||new GameMovieClip,this.bossGroup.removeChildren(),this.bossGroup.addChild(this.bossMc));var t=DataCenter.ins().WorldBossConfig[this.listSelectId],e=DataCenter.ins().MonstersConfig[t.bossId];this.bossMc.playFile(PATH_GUAIWU+GUAIWU_PREFIX+(e.avatar+"_3s"),-1)},e.prototype.updateReward=function(){var t=DataCenter.ins().WorldBossConfig[this.listSelectId];this.rewardList.dataProvider.replaceAll(CommonUtils.copyDataDepth(t.showReward))},e.prototype.updateInfo=function(){var t=bossControl.worldBossBelongTime[this.type];this.lblLeftCount.textColor=t>0?ColorUtils.GREEN:ColorUtils.RED,this.lblLeftCount.text=t+"";var e=DataCenter.ins().WorldBossConfig[this.listSelectId];this.nameTxt.text=DataCenter.ins().MonstersConfig[e.bossId].name;var i=WarriorModel.ins().checkDunFive(this.listSelectId),n=BossControl.isCanChallenge(e);this.lblNoOpenTip.visible=!i||!n,this.btnChallenge.visible=!this.lblNoOpenTip.visible;var o=!0;if(bossControl.worldInfoList[this.type]){for(var s=null,r=0,a=bossControl.worldInfoList[this.type];r<a.length;r++){var l=a[r];if(l.id==this.listSelectId){s=l;break}}o=s&&s.isDie}this.stateImage.visible=!this.lblNoOpenTip.visible&&!o},e.prototype.updateBossList=function(){this.listBoss.dataProvider.replaceAll(WarriorModel.ins().getBossListDatas())},e.prototype.updateFiveAttr=function(){var t=DataCenter.ins().WorldBossConfig[this.listSelectId],e=WarriorModel.ins().getEquipWuxingAttr();if(t.FiveElementsForce){this.fiveGrp.visible=!0;for(var i="",n=0;n<t.FiveElementsForce.length;++n){for(var o=0;o<e.length;++o)if(t.FiveElementsForce[n].type==e[o].type){var s=e[o].value>=t.FiveElementsForce[n].value?LangMgr.getValueByKey("color43"):LangMgr.getValueByKey("color22");i+="|C:"+WarriorConfigMgr.ins().getFiveColor(e[o].type)+"&T:"+WarriorConfigMgr.ins().getFiveName(e[o].type)+"|C:"+s+"&T:"+(e[o].value+"/"+t.FiveElementsForce[n].value);break}n<t.FiveElementsForce.length-1&&(i+="\n")}this.fiveLbl.textFlow=TextUtils.generateTextFlow1(i)}else this.fiveGrp.visible=!1;var r=WarriorModel.ins().checkDunFive(this.listSelectId);this.fiveGrp.visible=!r},e.prototype.updateRed=function(){this.redStren.visible=WarriorModel.ins().checkRedForOneBossChallengeRed(this.listSelectId)},e}(BasePanel);__reflect(WarriorDunPanel.prototype,"WarriorDunPanel");var WarriorEquipAttrView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorEquipAttrViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.otherClose),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(){for(var t=WarriorModel.ins().getEquipWuxingAttr(),e=0;e<t.length;++e)this["zhanjianattr"+(e+1)]&&(this["zhanjianattr"+(e+1)].text=t[e].value)},e}(BaseEuiView);__reflect(WarriorEquipAttrView.prototype,"WarriorEquipAttrView");var WarriorEquipBagView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorEquipBagViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.otherClose),this.addCustomEvent(43,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.equipId=t[0],this.equipPos=t[1],this.list.itemRenderer=WarriorEquipBagItemRenderer,this.list.dataProvider=new eui.ArrayCollection,this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeCustomEvents()},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(){var t=WarriorModel.ins().getBagEquipsByPos(this.equipPos);this.tipLabel.visible=0==t.length;for(var e=[],i=0,n=0,o=t;n<o.length;n++){var s=o[n];e.push({equipId:this.equipId,itemId:s.configID,isWearing:WarriorModel.ins().checkIsEquipWearing(this.equipId,this.equipPos)?WarriorModel.ins().getEquipData(this.equipId,this.equipPos).itemId==s.configID:!1,isBest:0==i}),i++}this.list.dataProvider.replaceAll(e)},e}(BaseEuiView);__reflect(WarriorEquipBagView.prototype,"WarriorEquipBagView");var WarriorEquipComposePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listPosRecordDict={},e.clearRecordOnChangeTap=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.composeBtn,this.onComposeBtnClick),this.addCustomEvent(43,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.list.itemRenderer=WarriorEquipComposeItemRenderer,this.list.dataProvider=new eui.ArrayCollection,this.list.selectedIndex=0,this.listSelectIndex=0,this.addEventItemTap(this.list,this.onListTap),this.curSelectPos=2,this.listEquips.itemRenderer=WarriorPersonItemRenderer,this.listEquips.dataProvider=new eui.ArrayCollection,this.listEquips.selectedIndex=0,this.addEventItemTap(this.listEquips,this.onListEquipTap),this.tarEff=new GameMovieClip,this.grpTarEff.addChild(this.tarEff),this.tarEff.playFile(PATH_EFF+"forgeSuccess",1,null,!1),this.grpTarEff.visible=!1,this.playEff(),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.composeBtn,this.onComposeBtnClick),this.removeCustomEvents(),this.removeEventItemTap(this.list,this.onListTap),this.removeEventItemTap(this.listEquips,this.onListEquipTap),this.cleanMovieClipAni()},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onListEquipTap=function(t){if(this.listEquips.selectedItem&&this.curSelectPos!=this.listEquips.selectedIndex+1){var e=this.listEquips.selectedItem;e.cfg?(this.curSelectPos=this.listEquips.selectedIndex+1,this.clearRecordOnChangeTap&&(this.listPosRecordDict={})):tipsControl.showTips(LangMgr.getValueByKey("warriorUpTip")),this.updateView()}},e.prototype.onListTap=function(t){this.listSelectIndex!=this.list.selectedIndex&&(this.listSelectIndex=this.list.selectedIndex,this.clearRecordOnChangeTap&&(this.listPosRecordDict={}),this.updateView())},e.prototype.onComposeBtnClick=function(){var t=this;this.composeBtn.enabled=!1,this.playEff(),TimerMgr.ins().doTimer(400,1,function(){warriorControl.upComposeEquip(t.curSelectPos,t.curEquipCfg.Id)},this),TimerMgr.ins().doTimer(500,1,function(){t.grpTarEff.visible=!0,t.tarEff.playFile(PATH_EFF+"forgeSuccess",1,function(){t.grpTarEff.visible=!1},!1)},this)},e.prototype.updateView=function(){this.updateEquipList(),this.updateList(),this.updateCostView(),this.updateRed()
},e.prototype.updateEquipList=function(){for(var t=[],e=WarriorModel.ins().getFuzhuList(),i=e.concat(),n=1;n<=WarriorConfigMgr.MAX_EQUIP_ID;++n)if(2==n){var o=WarriorModel.ins().getBattlingId();t.push({cfg:WarriorConfigMgr.ins().getAttrConfigById(o),showMain:!0,isRed:WarriorModel.ins().checkEquipIdComposeRed(n),canShowTagFuzhu:!1,canShowTagBattle:!1})}else{var s=i.shift(),r=void 0;s&&(r=WarriorConfigMgr.ins().getAttrConfigById(s)),t.push({cfg:r,showMain:!1,isRed:WarriorModel.ins().checkEquipIdComposeRed(n),canShowTagFuzhu:!1,canShowTagBattle:!1})}this.listEquips.dataProvider.replaceAll(t),this.listEquips.validateNow(),this.listEquips.selectedIndex=this.curSelectPos-1,this.target.warriorEquipId=this.curSelectPos,this.equip1.warriorEquipId=this.curSelectPos,this.equip2.warriorEquipId=this.curSelectPos},e.prototype.updateList=function(){var t=[],e=WarriorConfigMgr.ins().getEquipComposeTabData(),i=0;for(var n in e){var o=[];for(var s in e[n])o.push(e[n][s]);var r=this.listPosRecordDict[n];t.push({curPosIndex:this.listSelectIndex==i&&r?r:0,callBack:this.callback,callObj:this,battleEquipPos:this.curSelectPos,equipCfgList:o}),i++}if(this.list.dataProvider.replaceAll(t),this.list.selectedIndex==this.listSelectIndex){this.list.validateNow();var a=this.list.getVirtualElementAt(this.list.selectedIndex);a&&a.updateList(!0)}this.list.selectedIndex=this.listSelectIndex;var l=t[this.listSelectIndex];this.curEquipCfg=l.equipCfgList[l.curPosIndex]},e.prototype.callback=function(t,e){this.listPosRecordDict[t.cfg.star]=e,this.updateView()},e.prototype.updateCostView=function(){this.target.isShowName(!1),this.item1.isShowName(!1),this.equip1.isShowName(!1),this.equip2.isShowName(!1);var t,e=this.curEquipCfg,i=LangMgr.getValueByKey("attrDefaultColor"),n=0,o=WarriorConfigMgr.ins().getEquipCfgByid(e.composeItem[0].id);if(WarriorModel.ins().checkIsEquipWearing(this.curSelectPos,o.pos)){var s=WarriorModel.ins().getEquipData(this.curSelectPos,o.pos);s.itemId==e.composeItem[0].id&&(n=1)}var r=n>=e.composeItem[0].count?LangMgr.getValueByKey("color43"):LangMgr.getValueByKey("color22"),a="|C:"+r+"&T:"+n+"|C:"+i+"&T:/"+e.composeItem[0].count;this.equip1.data=DataCenter.ins().ItemConfig[e.composeItem[0].id],this.equip1.setCountEx(a),this.lblEquip1.textColor=ItemUtils.getQualityColor(DataCenter.ins().ItemConfig[e.composeItem[0].id]),this.lblEquip1.text=DataCenter.ins().ItemConfig[e.composeItem[0].id].name,this.lblEquip1.textAlign=egret.HorizontalAlign.CENTER,t=backpackControl.getBagItemById(e.composeItem[1].id),r=(t?t.count:0)>=e.composeItem[1].count?LangMgr.getValueByKey("color43"):LangMgr.getValueByKey("color22"),a="|C:"+r+"&T:"+(t?t.count:0)+"|C:"+i+"&T:/"+e.composeItem[1].count,this.equip2.data=DataCenter.ins().ItemConfig[e.composeItem[1].id],this.equip2.setCountEx(a),this.lblEquip2.textColor=ItemUtils.getQualityColor(DataCenter.ins().ItemConfig[e.composeItem[1].id]),this.lblEquip2.text=DataCenter.ins().ItemConfig[e.composeItem[1].id].name,this.lblEquip2.textAlign=egret.HorizontalAlign.CENTER,t=backpackControl.getBagItemById(e.composeItem[2].id),r=(t?t.count:0)>=e.composeItem[2].count?LangMgr.getValueByKey("color43"):LangMgr.getValueByKey("color22"),a="|C:"+r+"&T:"+(t?t.count:0)+"|C:"+i+"&T:/"+e.composeItem[2].count,this.item1.data=DataCenter.ins().ItemConfig[e.composeItem[2].id],this.item1.setCountEx(a),this.lblItem1.textColor=ItemUtils.getQualityColor(DataCenter.ins().ItemConfig[e.composeItem[2].id]),this.lblItem1.text=DataCenter.ins().ItemConfig[e.composeItem[2].id].name,this.lblItem1.textAlign=egret.HorizontalAlign.CENTER,this.target.data=DataCenter.ins().ItemConfig[e.Id],this.target.showNum(!1),this.lblTarget.textColor=ItemUtils.getQualityColor(DataCenter.ins().ItemConfig[e.Id]),this.lblTarget.text=DataCenter.ins().ItemConfig[e.Id].name,this.lblTarget.textAlign=egret.HorizontalAlign.CENTER},e.prototype.updateRed=function(){this.composeRed.visible=WarriorModel.ins().checkEquipComposeRed(this.curSelectPos,this.curEquipCfg.Id),this.composeBtn.enabled=this.composeRed.visible},e.prototype.playEff=function(){var t=this,e=500;this.trimc0||(this.trimc0=this.AniMovieClip(this.trieffDat0,this.trieff0)),this.trimc0.x=-this.trieff0.width,this.trit0=egret.Tween.get(this.trimc0),this.trit0.to({x:0},e).call(function(){egret.Tween.removeTweens(t.trit0)}),this.trimc1||(this.trimc1=this.AniMovieClip(this.trieffDat1,this.trieff1)),this.trimc1.x=-this.trieff1.width,this.trit1=egret.Tween.get(this.trimc1),this.trit1.to({x:0},e).call(function(){egret.Tween.removeTweens(t.trit1)}),this.trimc2||(this.trimc2=this.AniMovieClip(this.trieffDat2,this.trieff2)),this.trimc2.x=-this.trieff2.width,this.trit2=egret.Tween.get(this.trimc2),this.trit2.to({x:0},e).call(function(){egret.Tween.removeTweens(t.trit2)})},e.prototype.AniMovieClip=function(t,e){var i="jljdt",n=new GameMovieClip;n.playFile(PATH_EFF+i,-1),e.addChild(n),n.scaleX=t.scaleX,n.scaleY=t.scaleY;var o=new egret.Sprite,s=new egret.Shape;return s.graphics.beginFill(16777215),s.graphics.drawRect(t.x,t.y,e.width,e.height),s.graphics.endFill(),o.addChild(s),e.addChild(o),n.mask=o,n},e.prototype.cleanMovieClipAni=function(){for(var t=0;3>t;t++)this["trit"+t]&&egret.Tween.removeTweens(this["trit"+t])},e}(BasePanel);__reflect(WarriorEquipComposePanel.prototype,"WarriorEquipComposePanel");var WarriorEquipDetailTipView=function(t){function e(){var e=t.call(this)||this;return e.showBtnGroup=!0,e.skinName="WarriorEquipDetailTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(43,this.updateView),this.addCustomEvent(267,this.onItemChange),this.addCustomEvent(266,this.onItemChange),this.addCustomEvent(268,this.onItemChange),this.addEventTouchTap(this.bgClose,this.otherClose),this.addEventTouchTap(this.replaceBtn,this.onTap),this.addEventTouchTap(this.downBtn,this.onTap),this.addEventTouchTap(this.strenBtn,this.onTap),this.equipId=t[0],this.itemId=t[1],this.showBtnGroup=null!=t[2]?t[2]:!0,this.downBtn.parent&&(this.downBtn.parent.visible=this.showBtnGroup),this.replaceBtn.parent&&(this.replaceBtn.parent.visible=this.showBtnGroup),this.strenBtn.parent&&(this.strenBtn.parent.visible=this.showBtnGroup),this.equipCfg=WarriorConfigMgr.ins().getEquipCfgByid(this.itemId),this.itemCfg=DataCenter.ins().ItemConfig[this.itemId],this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeEventTouchTap(this.replaceBtn,this.onTap),this.removeEventTouchTap(this.downBtn,this.onTap),this.removeEventTouchTap(this.strenBtn,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.replaceBtn:this.equipId&&UIMgr.ins().open(WarriorEquipBagView,this.equipId,this.equipCfg.pos);break;case this.downBtn:this.equipId&&warriorControl.upWearEquip(this.equipId,this.equipCfg.pos,0);break;case this.strenBtn:this.equipId&&UIMgr.ins().open(WarriorEquipStrenView,this.equipId,this.equipCfg.pos)}},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onItemChange=function(){this.updateRed()},e.prototype.updateView=function(){this.updateInfo(),this.updatePower(),this.updateSuitAttr(),this.updateRed(),this.updateFiveAttr()},e.prototype.updateInfo=function(){this.itemIcon.setData(this.itemCfg),this.quaImg.source="quali"+ItemUtils.getQuality(this.itemCfg);var t=this.itemCfg.zsLevel?this.itemCfg.zsLevel:0,e=(reincarnateControl.lv>=t,10721407);this.lblLev.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+t),this.lblType.text=LangMgr.getValueByKey("warriorName")+WarriorConfigMgr.ins().getEquipName(this.equipCfg.pos),this.lblCareer.text=RoleModel.getJobNameByJob(ItemUtils.getJob(this.itemCfg));var i=ItemUtils.getQualityColor(this.itemCfg);this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+i+"&T:"+this.itemCfg.name)},e.prototype.updatePower=function(){this.powerPanel.setPower(BackpackControl.getAttrPower(this.equipCfg.attr))},e.prototype.updateFiveAttr=function(){var t;t=this.equipId?WarriorModel.ins().getOneEquipFiveAttr(this.equipId,this.equipCfg.pos):this.equipCfg.FiveElementsForce?this.equipCfg.FiveElementsForce:[],(!t||t.length<=0)&&DisplayUtils.removeFromParent(this.wuxingGroup);for(var e="",i=0;i<t.length;++i)e+="|C:"+WarriorConfigMgr.ins().getFiveColor(t[i].type)+"&T:"+WarriorConfigMgr.ins().getFiveName(t[i].type)+" "+t[i].value+(i<t.length-1?"\n":"");this.wuxingAttr.textFlow=TextUtils.generateTextFlow1(e)},e.prototype.updateSuitAttr=function(){this.baseAttrLbl.text="";for(var t=0,e=0,i=this.equipCfg.attr;e<i.length;e++){var n=i[e];this.baseAttrLbl.text+=AttributeData.getAttrStrByType(n.type)+(": "+n.value)+(t<this.equipCfg.attr.length-1?"\n":""),t++}var o=0;o=this.equipId?WarriorModel.ins().getEquipingNums(this.equipId):1;var s=WarriorConfigMgr.ins().getEquipSuitMaxNums(),r=LangMgr.getColor("color22");o>=s&&(r=LangMgr.getColor("color43")),this.suitNumLbl.textFlow=TextUtils.generateTextFlow1("|C:"+r+"&T:("+o+"/"+s+")");var a;if(this.equipId)a=WarriorModel.ins().getEquipSuitAttr(this.equipId);else{var l=new WarriorEquipVo;l.pos=this.equipCfg.pos,l.itemId=this.equipCfg.Id,l.strenLev=0;var h=[l];a=WarriorModel.ins().getEquipSuitAttr1(h)}for(var u=a?Object.keys(a).length:0,p=this.suitDetailGrp.numChildren-1;p>=u;--p)this.suitDetailGrp.removeChildAt(p);for(var p=this.suitDetailGrp.numChildren;u>p;++p){var c=new eui.Group,d=new eui.Label;d.size=18;var g=new eui.Label;g.size=18,g.x=22,g.y=25,c.addChild(d),c.addChild(g),this["lblSuitState"+p]=d,this["lblSuitAttr"+p]=g,this["lblSuitState"+p].x=33,this["lblSuitAttr"+p].x=36,this.suitDetailGrp.addChild(c)}var m=0;for(var f in a){var v=a[f][0],y=a[f][1],C=a[f][2],T=this["lblSuitState"+m];T&&(C?T.textColor=LangMgr.getColor("color43"):T.textColor=LangMgr.getColor("color83"),T.text="【"+f+LangMgr.getValueByKey("HunJ")+" "+y+LangMgr.getValueByKey("osaLevelJ")+"】");var w=this["lblSuitAttr"+m];if(w){C?w.textColor=LangMgr.getColor("color43"):w.textColor=LangMgr.getColor("color83"),w.text="";for(var I=0,b=0,D=v;b<D.length;b++){var n=D[b];w.text+=AttributeData.getAttStrByType(n,4,": ",!1)+(I<v.length-1?"\n":""),I++}}m++}},e.prototype.updateRed=function(){this.redDown.visible=!1,this.equipId&&(this.redReplace.visible=WarriorModel.ins().checkEquipWearRed(this.equipId,this.equipCfg.pos),this.redStren.visible=WarriorModel.ins().checkEquipStrenRed(this.equipId,this.equipCfg.pos)||WarriorModel.ins().checkEquipResolveRed(this.equipId,this.equipCfg.pos))},e}(BaseEuiView);__reflect(WarriorEquipDetailTipView.prototype,"WarriorEquipDetailTipView");var WarriorEquipPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipId=2,e.listSelectIndex=1,e.listData=[],e.modelPrefix=PATH_EFF,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initUI()},e.prototype.initUI=function(){this.starList=new StarList(10,0,45,1,1),this.starList.y=-17,this.starList.scaleX=.7,this.starList.scaleY=.7,this.grpStar.addChildAt(this.starList,0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.equipNums=this.grpEquip.numChildren,this.initAllEvents(),this.listWarrior.itemRenderer=WarriorPersonItemRenderer,this.listWarrior.dataProvider=this.listWarrior.dataProvider||new eui.ArrayCollection,this.updateView(),this.updateModel(!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents()},e.prototype.initAllEvents=function(){this.addCustomEvent(267,this.onItemChange),this.addCustomEvent(266,this.onItemChange),this.addCustomEvent(268,this.onItemChange),this.addCustomEvent(43,this.updateView),this.addCustomEvent(40,this.updateView),this.addEventItemTap(this.listWarrior,this.onListWarriorTap);for(var t=0;t<this.equipNums;++t)this.addEventTouchTap(this.grpEquip.getChildAt(t),this.onTap);this.addEventTouchTap(this.btnWuxing,this.onTap)},e.prototype.removeAllEvents=function(){this.removeCustomEvents(),this.removeEventItemTap(this.listWarrior,this.onListWarriorTap);for(var t=0;t<this.equipNums;++t)this.removeEventTouchTap(this.grpEquip.getChildAt(t),this.onTap);this.removeEventTouchTap(this.btnWuxing,this.onTap)},e.prototype.onListWarriorTap=function(t){var e=t.itemIndex;if(e!=this.listSelectIndex){var i=this.listWarrior.selectedItem;i.cfg?this.listSelectIndex=e:tipsControl.showTips(LangMgr.getValueByKey("warriorUpTip")),this.updateView(),this.updateModel(!0)}},e.prototype.onTap=function(t){if(t.currentTarget instanceof WarriorEquipItemRenderer){var e=t.currentTarget.data;if(e.cfg)UIMgr.ins().open(WarriorEquipDetailTipView,this.equipId,e.cfg.Id);else{var i=WarriorModel.ins().getBagEquipsByPos(e.pos);i.length>0?warriorControl.upWearEquip(this.equipId,e.pos,i[0].itemConfig.id):UIMgr.ins().open(WarriorEquipBagView,this.equipId,e.pos)}}else t.currentTarget==this.btnWuxing&&UIMgr.ins().open(WarriorEquipAttrView)},e.prototype.onItemChange=function(){this.updateRed()},e.prototype.updateView=function(){this.updateListWarrior(),this.updateRed(),this.updateEquipItems(),this.updatePower(),this.updateInfo()},e.prototype.updateListWarrior=function(){for(var t=[],e=WarriorModel.ins().getFuzhuList(),i=e.concat(),n=1;n<=WarriorConfigMgr.MAX_EQUIP_ID;++n)if(2==n){var o=WarriorModel.ins().getBattlingId();t.push({cfg:WarriorConfigMgr.ins().getAttrConfigById(o),showMain:!0,isRed:WarriorModel.ins().checkOneRedForTabEquip(n),equipId:n,canShowTagFuzhu:!1,canShowTagBattle:!1})}else{var s=i.shift(),r=void 0;s&&(r=WarriorConfigMgr.ins().getAttrConfigById(s)),t.push({cfg:r,showMain:!1,isRed:WarriorModel.ins().checkOneRedForTabEquip(n),equipId:n,canShowTagFuzhu:!1,canShowTagBattle:!1})}this.listData=t,this.listWarrior.dataProvider.replaceAll(t),this.listWarrior.validateNow(),this.listWarrior.selectedIndex=this.listSelectIndex,this.equipId=t[this.listSelectIndex].equipId,1==this.listSelectIndex?this.warriorId=WarriorModel.ins().getBattlingId():this.warriorId=0==this.listSelectIndex?e[0]:e[1]},e.prototype.updatePower=function(){var t=WarriorModel.ins().getEquipCurAttr(this.equipId);this.powerPanel.setPower(BackpackControl.getAttrPower(t)*heroControl.subRolesLen)},e.prototype.updateModel=function(t){void 0===t&&(t=!1),this.bossMc&&this.bossMc.parent||(this.bossMc=this.bossMc||new GameMovieClip,this.bossGroup.removeChildren(),this.bossGroup.addChild(this.bossMc));var e=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);e&&this.bossMc.playFile(this.modelPrefix+(""+e.innerAppearance),-1)},e.prototype.updateRed=function(){this.updateEquipItems()},e.prototype.updateEquipItems=function(){for(var t=0;t<=WarriorConfigMgr.ins().getEquipPosNum();++t)if(WarriorConfigMgr.ins().checkEquipPosExit(t)){var e=this.grpEquip.getChildByName("equipItem"+t);if(e){var i=WarriorModel.ins().getEquipData(this.equipId,t),n=void 0;n={isRed:WarriorModel.ins().checkEquipRed(this.equipId,t),cfg:WarriorModel.ins().checkIsEquipWearing(this.equipId,t)?WarriorConfigMgr.ins().getEquipCfgByid(i.itemId):null,pos:t,strenLv:WarriorModel.ins().getCurEquipPosStrenLev(this.equipId,t)},e.data=n}}},e.prototype.updateInfo=function(){this.starList.setlistLength(10,0,60),this.starList.updateStar(0,WarriorConfigMgr.ins().getStarResArray(this.warriorId))},e}(BasePanel);__reflect(WarriorEquipPanel.prototype,"WarriorEquipPanel");var WarriorEquipStrenView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorEquipStrenViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.otherClose),this.addEventTouchTap(this.closeBtn,this.otherClose),this.addEventTouchTap(this.resolveBtn,this.onResolveBtnClick),this.addEventTouchTap(this.lvUpBtn,this.onlvUpBtnClick),this.addCustomEvent(43,this.updateView),this.addCustomEvent(41,this.updateProgress),this.addCustomEvent(267,this.updateView),this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.equipId=t[0],this.equipPos=t[1],this.list.itemRenderer=WarriorEquipResolveItemRenderer,this.list.dataProvider=new eui.ArrayCollection,this.addEventItemTap(this.list,this.listItemTap),this.exp.slideDuration=0,this.exp.labelFunction=function(t,e){return WarriorModel.ins().getEquipStrenExp()+"/"+e},this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeEventTouchTap(this.closeBtn,this.otherClose),this.removeEventTouchTap(this.resolveBtn,this.onResolveBtnClick),this.removeEventTouchTap(this.lvUpBtn,this.onlvUpBtnClick),this.removeEventItemTap(this.list,this.listItemTap),this.removeCustomEvents()},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onResolveBtnClick=function(t){var e=[],i=0;this.selectInfos.sort(function(t,e){return t.itemInfo.configID-e.itemInfo.configID});for(var n=0,o=this.selectInfos;n<o.length;n++){var s=o[n];if(i>=12)break;for(var r=0;r<s.curLeftNum&&12>i;++r)e.push(s.itemInfo.configID),i++}warriorControl.upResolveEquip(e)},e.prototype.onlvUpBtnClick=function(t){warriorControl.upStrenEquip(this.equipId,this.equipPos)},e.prototype.listItemTap=function(t){var e=t.item;if(e){var i=new ItemBase;i.data=DataCenter.ins().ItemConfig[e.itemId],ItemBase.showDetail(i)}},e.prototype.updateView=function(){this.updateResolveList(),this.updateInfo(),this.updateAttrView(),this.updateProgress(),this.updateRed()},e.prototype.updateResolveList=function(){this.selectInfos=WarriorModel.ins().filterResolveItemInfos(this.equipPos);var t=[],e=0;this.selectInfos.sort(function(t,e){return t.itemInfo.configID-e.itemInfo.configID});for(var i=0,n=this.selectInfos;i<n.length;i++)for(var o=n[i],s=0;s<o.curLeftNum&&12>e;++s)t.push({itemId:o.itemInfo.configID,num:1}),e++;this.list.dataProvider.replaceAll(t)},e.prototype.updateInfo=function(){var t=WarriorModel.ins().checkIsEquipPosStrenLevMax(this.equipId,this.equipPos),e=WarriorModel.ins().getCurEquipPosStrenLev(this.equipId,this.equipPos);if(this.lblCurLev.text="Lv."+e,this.lblNextLev.text=t?LangMgr.getValueByKey("maxLevel"):"Lv."+(e+1),WarriorModel.ins().checkIsEquipWearing(this.equipId,this.equipPos)){var i=WarriorModel.ins().getEquipData(this.equipId,this.equipPos);this.itemIcon.setData(DataCenter.ins().ItemConfig[i.itemId])}this.lblEquipName.text=LangMgr.getValueByKey("warriorName")+WarriorConfigMgr.ins().getEquipName(this.equipPos)},e.prototype.updateAttrView=function(){var t,e=WarriorModel.ins().checkIsEquipPosStrenLevMax(this.equipId,this.equipPos);if(e){this.nowAttr.text="";var i=0;t=WarriorModel.ins().getEquipStrenAttr(this.equipId,this.equipPos),i=0;for(var n=0,o=t;n<o.length;n++){var s=o[n];this.nowAttr.text+=AttributeData.getAttrStrByType(s.type)+("+"+Math.floor(s.value))+(i<t.length-1?"\n":""),i++}this.nextAttr.text=LangMgr.getValueByKey("maxLevel")}else{var r=WarriorModel.ins().getEquipStrenNextAttr(this.equipId,this.equipPos);this.nowAttr.text="";var i=0,a=WarriorModel.ins().getCurEquipPosStrenLev(this.equipId,this.equipPos);if(!a)for(var l=0,h=r;l<h.length;l++){var s=h[l];this.nowAttr.text+=AttributeData.getAttrStrByType(s.type)+"+0"+(i<r.length-1?"\n":""),i++}t=WarriorModel.ins().getEquipStrenAttr(this.equipId,this.equipPos),i=0;for(var u=0,p=t;u<p.length;u++){var s=p[u];this.nowAttr.text+=AttributeData.getAttrStrByType(s.type)+("+"+Math.floor(s.value))+(i<t.length-1?"\n":""),i++}this.nextAttr.text="",i=0;for(var c=0,d=r;c<d.length;c++){var s=d[c];this.nextAttr.text+=AttributeData.getAttrStrByType(s.type)+("+"+Math.floor(s.value))+(i<r.length-1?"\n":""),i++}}this.powerPanel.setPower(BackpackControl.getAttrPower(t))},e.prototype.updateProgress=function(){var t=WarriorModel.ins().checkIsEquipPosStrenLevMax(this.equipId,this.equipPos);if(this.maxExpImg.visible=this.maxExpTxt.visible=t,this.exp.visible=!t,!t){var e=WarriorConfigMgr.ins().getEquipLevUpCfgByLev(this.equipPos,WarriorModel.ins().getCurEquipPosStrenLev(this.equipId,this.equipPos)+1);this.exp.maximum=e.exp,this.exp.value=WarriorModel.ins().getEquipStrenExp(),this.exp.labelDisplay.text=WarriorModel.ins().getEquipStrenExp()+"/"+this.exp.maximum}},e.prototype.updateRed=function(){this.lvUpRed.visible=WarriorModel.ins().checkEquipStrenRed(this.equipId,this.equipPos),this.resolveRed.visible=WarriorModel.ins().checkEquipResolveRed(this.equipId,this.equipPos)},e}(BaseEuiView);__reflect(WarriorEquipStrenView.prototype,"WarriorEquipStrenView");var WarriorOtherEquipPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipId=2,e.listSelectIndex=1,e.listData=[],e.modelPrefix=PATH_EFF,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initUI()},e.prototype.initUI=function(){this.starList=new StarList(10,0,45,1,1),this.starList.y=-17,this.starList.scaleX=.7,this.starList.scaleY=.7,this.grpStar.addChildAt(this.starList,0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.otherPlayerData=t[0],this.equipNums=this.grpEquip.numChildren,this.initAllEvents(),this.listWarrior.itemRenderer=WarriorPersonItemRenderer,this.listWarrior.dataProvider=this.listWarrior.dataProvider||new eui.ArrayCollection,this.btnWuxing.visible=!1,this.updateView(),this.updateModel(!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents()},e.prototype.initAllEvents=function(){this.addEventItemTap(this.listWarrior,this.onListWarriorTap);for(var t=0;t<this.equipNums;++t)this.addEventTouchTap(this.grpEquip.getChildAt(t),this.onTap)},e.prototype.removeAllEvents=function(){this.removeCustomEvents(),this.removeEventItemTap(this.listWarrior,this.onListWarriorTap);for(var t=0;t<this.equipNums;++t)this.removeEventTouchTap(this.grpEquip.getChildAt(t),this.onTap)},e.prototype.onListWarriorTap=function(t){var e=t.itemIndex;if(e!=this.listSelectIndex){var i=this.listWarrior.selectedItem;i.cfg&&(this.listSelectIndex=e),this.updateView(),this.updateModel(!0)}},e.prototype.onTap=function(t){if(t.currentTarget instanceof WarriorEquipItemRenderer){var e=t.currentTarget.data;e.cfg&&UIMgr.ins().open(WarriorEquipDetailTipView,this.equipId,e.cfg.Id,!1)}},e.prototype.updateView=function(){this.updateListWarrior(),this.updateEquipItems(),this.updatePower(),this.updateInfo()},e.prototype.updateListWarrior=function(){for(var t=[],e=this.otherPlayerData.warriorFuzhuList,i=e.concat(),n=1;n<=WarriorConfigMgr.MAX_EQUIP_ID;++n)if(2==n){var o=this.otherPlayerData.warriorBattingId;t.push({cfg:WarriorConfigMgr.ins().getAttrConfigById(o),showMain:!0,isRed:!1,equipId:n,canShowTagFuzhu:!1,canShowTagBattle:!1})}else{var s=i.shift(),r=void 0;s&&(r=WarriorConfigMgr.ins().getAttrConfigById(s)),t.push({cfg:r,showMain:!1,isRed:!1,equipId:n,canShowTagFuzhu:!1,canShowTagBattle:!1})}this.listData=t,this.listWarrior.dataProvider.replaceAll(t),this.listWarrior.validateNow(),this.listWarrior.selectedIndex=this.listSelectIndex,this.equipId=t[this.listSelectIndex].equipId,1==this.listSelectIndex?this.warriorId=this.otherPlayerData.warriorBattingId:this.warriorId=0==this.listSelectIndex?e[0]:e[1]},e.prototype.updatePower=function(){var t=this.getEquipCurAttr(this.equipId);this.powerPanel.setPower(BackpackControl.getAttrPower(t))},e.prototype.getOneEquipAllEquipAttr=function(t){for(var e=[],i=WarriorConfigMgr.ins().getEquipPosNum(),n=0;i>=n;++n)WarriorConfigMgr.ins().checkEquipPosExit(n)&&(e=AttributeData.AttrAddition(e,this.getEquipAttr(t,n)));return e},e.prototype.getEquipAttr=function(t,e){if(this.checkIsEquipWearing(t,e)){var i=this.getEquipData(t,e);if(i){var n=i.itemId,o=WarriorConfigMgr.ins().getEquipCfgByid(n);return o&&o.attr}}return[]},e.prototype.checkIsEquipWearing=function(t,e){var i=this.getEquipData(t,e);return i&&0!=i.itemId},e.prototype.getEquipData=function(t,e){return this.otherPlayerData.warriorEquipDataDict[t]&&this.otherPlayerData.warriorEquipDataDict[t][e]},e.prototype.getOneEquipAllStrenAttr=function(t){for(var e=[],i=WarriorConfigMgr.ins().getEquipPosNum(),n=0;i>=n;++n)WarriorConfigMgr.ins().checkEquipPosExit(n)&&(e=AttributeData.AttrAddition(e,this.getEquipStrenAttr(t,n)));return e},e.prototype.getEquipStrenAttr=function(t,e){var i=WarriorConfigMgr.ins().getEquipLevUpCfgByLev(e,this.getCurEquipPosStrenLev(t,e));return i?i.strengthenAttr:[]},e.prototype.getCurEquipPosStrenLev=function(t,e){var i=this.getEquipData(t,e);return i?i.strenLev:0},e.prototype.getAllEquipingData=function(t){var e=[];if(this.otherPlayerData.warriorEquipDataDict[t])for(var i in this.otherPlayerData.warriorEquipDataDict[t])this.checkIsEquipWearing(t,Number(i))&&e.push(this.otherPlayerData.warriorEquipDataDict[t][i]);return e},e.prototype.getEquipSuitAttr=function(t){var e=this.getAllEquipingData(t);return WarriorModel.ins().getEquipSuitAttr1(e)},e.prototype.getEquipCurAttr=function(t){var e=this.getOneEquipAllEquipAttr(t),i=this.getOneEquipAllStrenAttr(t),n=this.getEquipSuitAttr(t),o=[];if(n)for(var s in n){var r=n[s],a=r[2];a&&(o=AttributeData.AttrAddition(o,r[0]))}var l=[];return l=AttributeData.AttrAddition(l,e),l=AttributeData.AttrAddition(l,i),l=AttributeData.AttrAddition(l,o)},e.prototype.updateModel=function(t){void 0===t&&(t=!1),this.bossMc&&this.bossMc.parent||(this.bossMc=this.bossMc||new GameMovieClip,this.bossGroup.removeChildren(),this.bossGroup.addChild(this.bossMc));var e=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);e&&this.bossMc.playFile(this.modelPrefix+(""+e.innerAppearance),-1)},e.prototype.updateEquipItems=function(){for(var t=0;t<=WarriorConfigMgr.ins().getEquipPosNum();++t)if(WarriorConfigMgr.ins().checkEquipPosExit(t)){var e=this.grpEquip.getChildByName("equipItem"+t);if(e){var i=this.getEquipData(this.equipId,t),n=void 0;n={isRed:!1,cfg:this.checkIsEquipWearing(this.equipId,t)?WarriorConfigMgr.ins().getEquipCfgByid(i.itemId):null,pos:t,strenLv:this.getCurEquipPosStrenLev(this.equipId,t)},e.data=n}}},e.prototype.updateInfo=function(){this.otherPlayerData.warriorDataDict[this.warriorId]&&(this.starList.setlistLength(10,0,60),this.starList.updateStar(0,WarriorConfigMgr.ins().getStarResArray(this.warriorId,this.otherPlayerData.warriorDataDict[this.warriorId].breachLev)))},e}(BasePanel);__reflect(WarriorOtherEquipPanel.prototype,"WarriorOtherEquipPanel");var WarriorOtherView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorOtherViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initAllEvents(),(i=this.warriorOtherEquip).open.apply(i,t);var i},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents()},e.prototype.initAllEvents=function(){},e.prototype.removeAllEvents=function(){this.removeCustomEvents()},e}(BaseEuiView);__reflect(WarriorOtherView.prototype,"WarriorOtherView");var WarriorPersonPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.warriorId=1,e.listSelectIndex=0,e.gap=12,e.showListRangeNum=5,e.moveScrollerWidth=450,e.maxScrollerDis=0,e.listItemWidth=78,e.srcollerWidth=458,e.listData=[],e.modelPrefix=PATH_EFF,e.autoRequestBattle=!1,e.firstInitList=!0,e.auto=!1,e.autoId=null,e.autoLv=null,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.initUI()},e.prototype.initUI=function(){this.starList=new StarList(10,0,45,1,1),this.starList.y=-20,this.starList.scaleX=.7,this.starList.scaleY=.7,this.grpStar.addChildAt(this.starList,0)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.clearAuto(),this.initAllEvents(),this.getItemTxt.textFlow=[{text:this.getItemTxt.text,style:{underline:!0}}],this.listWarrior.itemRenderer=WarriorPersonItemRenderer,this.listWarrior.dataProvider=this.listWarrior.dataProvider||new eui.ArrayCollection,this.listSkill.itemRenderer=WarriorSkillItemRenderer,this.listSkill.dataProvider=this.listSkill.dataProvider||new eui.ArrayCollection;var i=this.btnStren.labelDisplay;i&&(i.size=24),this.updateView(),this.updateModel(!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents(),this.clearAuto()},e.prototype.initAllEvents=function(){this.addCustomEvent(267,this.onItemChange),this.addCustomEvent(266,this.onItemChange),this.addCustomEvent(268,this.onItemChange),this.addCustomEvent(40,this.updateView),this.addCustomEvent(37,this.dataChanged),this.addEventItemTap(this.listWarrior,this.onListWarriorTap),this.addEventItemTap(this.listSkill,this.onListSkillTap),this.addEventChange(this.scroller,this.onScrollerChange),this.addEventTouchTap(this.getItemTxt,this.onTap),this.addEventTouchTap(this.grpQianNeng,this.onTap),this.addEventTouchTap(this.grpFeisheng,this.onTap),this.addEventTouchTap(this.btnStren,this.onTap),this.addEventTouchTap(this.btnBattle,this.onTap),this.addEventTouchTap(this.rightGroup,this.onTap),this.addEventTouchTap(this.leftGroup,this.onTap),this.addEventTouchTap(this.costImg,this.onTap),this.addEventTouchTap(this.grpSkill,this.onTap)},e.prototype.removeAllEvents=function(){this.removeCustomEvents(),this.removeEventItemTap(this.listWarrior,this.onListWarriorTap),this.removeEventItemTap(this.listSkill,this.onListSkillTap),this.removeEventChange(this.scroller,this.onScrollerChange),this.removeEventTouchTap(this.getItemTxt,this.onTap),this.removeEventTouchTap(this.grpQianNeng,this.onTap),this.removeEventTouchTap(this.grpFeisheng,this.onTap),this.removeEventTouchTap(this.btnStren,this.onTap),this.removeEventTouchTap(this.btnBattle,this.onTap),this.removeEventTouchTap(this.rightGroup,this.onTap),this.removeEventTouchTap(this.leftGroup,this.onTap),this.removeEventTouchTap(this.costImg,this.onTap),this.removeEventTouchTap(this.grpSkill,this.onTap)},e.prototype.clearAuto=function(){this.auto=!1,this.autoLv=null,this.autoId=null},e.prototype.startAuto=function(t){this.auto=!0,this.autoId=t,this.autoLv=WarriorModel.ins().getCurLev(t),WarriorModel.ins().checkCanStrenLev(this.warriorId)?warriorControl.upStrenLev(this.warriorId):(this.clearAuto(),warnControl.setBuyGoodsWarn(WarriorConfigMgr.ins().getStrenLevCostId()))},e.prototype.onListWarriorTap=function(t){var e=t.itemIndex;e!=this.listSelectIndex&&(this.clearAuto(),this.warriorId=t.item.cfg.Id,this.updateView(!0),this.updateModel(!0))},e.prototype.onListSkillTap=function(t){var e=t.item;e&&UIMgr.ins().open(WarriorSkillTipView,this.warriorId,e.cfg)},e.prototype.onScrollerChange=function(){this.updateListArrow(),this.updateListArrowRed()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.getItemTxt:WarriorModel.ins().checkIsActivated(this.warriorId)?warnControl.setBuyGoodsWarn(WarriorConfigMgr.ins().getStrenLevCostId()):warnControl.setBuyGoodsWarn(WarriorConfigMgr.ins().getActiveCostId(this.warriorId));break;case this.grpQianNeng:if(WarriorModel.ins().checkUseDrugA(this.warriorId))warriorControl.upUseDrugA(this.warriorId);else{var e=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId),i=WarriorModel.ins().getDrugNextLimitLv(this.warriorId,1);UIMgr.ins().open(WarriorDrugDetailTipView,e.AItemId,WarriorModel.ins().getDrugAUsedNum(this.warriorId),WarriorModel.ins().getDrugALimitNum(this.warriorId),e.Aattr,i)}break;case this.grpFeisheng:if(WarriorModel.ins().checkUseDrugB(this.warriorId))warriorControl.upUseDrugB(this.warriorId);else{var e=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId),i=WarriorModel.ins().getDrugNextLimitLv(this.warriorId,2),n=e.addPre/1e4;UIMgr.ins().open(WarriorDrugDetailTipView,e.BItemId,WarriorModel.ins().getDrugBUsedNum(this.warriorId),WarriorModel.ins().getDrugBLimitNum(this.warriorId),e.Battr,i,n)}break;case this.btnStren:if(WarriorModel.ins().checkIsActivated(this.warriorId))this.auto?this.clearAuto():this.startAuto(this.warriorId);
else if(WarriorModel.ins().checkCanActive(this.warriorId)){warriorControl.upActive(this.warriorId);var o=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);TimerMgr.ins().doTimer(500,1,function(){CommonFun.show(0,o.showName||"",null,o.innerAppearance,!0,null,0,-100)},this)}else warnControl.setBuyGoodsWarn(WarriorConfigMgr.ins().getActiveCostId(this.warriorId));break;case this.btnBattle:WarriorModel.ins().checkIsActivated(this.warriorId)&&UIMgr.ins().open(WarriorUpBattleView,this.warriorId);break;case this.rightGroup:this.moveList(1);break;case this.leftGroup:this.moveList(-1);break;case this.costImg:WarriorModel.ins().checkIsActivated(this.warriorId)||UIMgr.ins().open(WarriorActiveItemTipView,WarriorConfigMgr.ins().getActiveCostId(this.warriorId));break;case this.grpSkill:this.skillId&&DataCenter.ins().SkillsConfig[this.skillId]&&UIMgr.ins().open(WarriorSkillTipView,this.warriorId,null,this.skillId)}},e.prototype.onItemChange=function(){this.updateCostView(),this.updateRed(),this.updateListWarrior()},e.prototype.dataChanged=function(){if(this.auto){var t=WarriorModel.ins().getCurLev(this.autoId);t!=this.autoLv?this.clearAuto():this.startAuto(this.autoId)}this.updateView()},e.prototype.updateView=function(t){this.updateListWarrior(),this.updateVisibleByStatus(),this.updateCostView(),this.updateAttrView(),this.updatePower(),this.updateRed(),this.updateProgress(t),this.updateInfo(),this.updateSkillView(),this.firstWarriorRequestBattle()},e.prototype.moveList=function(t){var e=this.scroller.viewport.scrollH,i=Math.ceil(e/(this.listItemWidth+this.gap));i+=t*this.showListRangeNum,i=0>i?0:i;var n=(this.listItemWidth+this.gap)*i;n=n>this.maxScrollerDis?this.maxScrollerDis:n,this.scroller.viewport.scrollH=n,this.onScrollerChange()},e.prototype.updateListArrow=function(){var t=this.scroller.viewport.scrollH;this.leftGroup.visible=t>=10,this.rightGroup.visible=t+10<=this.maxScrollerDis},e.prototype.updateListWarrior=function(){var t=WarriorConfigMgr.ins().getAttrConfigs(),e=[];for(var i in t){var n=t[i];n.show?WarriorModel.ins().checkIsActivated(n.Id)?e.push({cfg:n,isRed:WarriorModel.ins().checkOneWarriorRedForTabStren(n.Id)}):WarriorModel.ins().checkCanActive(n.Id)&&e.push({cfg:n,isRed:WarriorModel.ins().checkOneWarriorRedForTabStren(n.Id)}):e.push({cfg:n,isRed:WarriorModel.ins().checkOneWarriorRedForTabStren(n.Id)})}e.sort(this.sortWarrior),this.listData=e,this.listWarrior.dataProvider.replaceAll(e),this.firstInitList&&(this.firstInitList=!1,this.warriorId=e[0].cfg.Id,this.listSelectIndex=0);for(var o=0;o<e.length;++o)if(e[o].cfg.Id==this.warriorId){this.listSelectIndex=o;break}this.listWarrior.selectedIndex=this.listSelectIndex,this.gap=this.listWarrior.layout.gap,this.moveScrollerWidth=(this.listItemWidth+this.gap)*this.showListRangeNum,this.maxScrollerDis=e.length*this.listItemWidth+(e.length>1?e.length-1:0)*this.gap-this.srcollerWidth,this.maxScrollerDis=this.maxScrollerDis<0?0:this.maxScrollerDis,this.updateListArrow()},e.prototype.sortWarrior=function(t,e){var i=WarriorModel.ins().getBattlingId();if(t.cfg.Id==i)return-1;if(e.cfg.Id==i)return 1;var n=WarriorModel.ins().getFuzhuList(),o=-1!=n.indexOf(t.cfg.Id),s=-1!=n.indexOf(e.cfg.Id);return o&&s||!o&&!s?e.cfg.slot-t.cfg.slot:o?-1:1},e.prototype.updateVisibleByStatus=function(){var t=WarriorModel.ins().checkIsActivated(this.warriorId),e=WarriorModel.ins().checkIsStrenLevMax(this.warriorId);this.btnBattle.visible=t&&WarriorModel.ins().getBattlingId()!=this.warriorId,this.lblLv.visible=t,this.btnStren.visible=!e,this.lblMaxTip.visible=e,this.costGroup.visible=!e,this.getItemTxt.visible=!e,this.grpQianNeng.visible=t&&1==DataCenter.ins().WarriorConfig.showAItem,this.grpFeisheng.visible=t&&1==DataCenter.ins().WarriorConfig.showBItem},e.prototype.updateCostView=function(){var t,e,i,n=WarriorModel.ins().checkIsActivated(this.warriorId),o=WarriorModel.ins().checkIsStrenLevMax(this.warriorId);n?(this.btnStren.label=this.auto?LangMgr.getValueByKey("cancel1"):LangMgr.getValueByKey("forgeOneKey"),o||(t=WarriorConfigMgr.ins().getStrenLevCostId(),e=WarriorModel.ins().getStrenLevCostNum(this.warriorId),i=WarriorConfigMgr.ins().getStrenLevlCostType())):(this.btnStren.label=LangMgr.getValueByKey("zhuzaiActivty"),t=WarriorConfigMgr.ins().getActiveCostId(this.warriorId),e=WarriorConfigMgr.ins().getActiveCostNum(this.warriorId),i=WarriorConfigMgr.ins().gettActiveCostType(this.warriorId));var s;if(!o){s=backpackControl.getBagItemById(t,i);var r=s?s.count:0,a="";a=r>=e?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.costLbl.textFlow=TextUtils.generateTextFlow("<font color="+a+">"+r+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+e+"</font> ");var l=DataCenter.ins().ItemConfig[t];this.costImg.source=l?l.icon+"_png":null}this.lblQianNeng.text=WarriorModel.ins().getDrugAUsedNum(this.warriorId)+"",this.lblFeiSheng.text=WarriorModel.ins().getDrugBUsedNum(this.warriorId)+"";var h=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);this.btnQn.iconImg&&(this.btnQn.iconImg.source=DataCenter.ins().ItemConfig[h.AItemId].icon+"_png",this.btnQn.iconImg.scaleX=this.btnQn.iconImg.scaleY=1.1),this.btnFs.iconImg&&(this.btnFs.iconImg.source=DataCenter.ins().ItemConfig[h.BItemId].icon+"_png",this.btnFs.iconImg.scaleX=this.btnFs.iconImg.scaleY=1.1),this.lblFeiSheng.visible=!1,this.lblQianNeng.visible=!1},e.prototype.updateAttrView=function(){for(var t=WarriorModel.ins().checkIsStrenLevMax(this.warriorId),e=this.grpAttr.numChildren,i=0;e>i;++i)this["attr"+i]&&(this["attr"+i].visible=!1),this["arrow"+i]&&(this["arrow"+i].visible=!1),this["addAttr"+i]&&(this["addAttr"+i].visible=!1),t?(DisplayUtils.removeFromParent(this["arrow"+i]),DisplayUtils.removeFromParent(this["addAttr"+i])):(this["arrow"+i]&&this.grpAttr.getChildAt(i).addChild(this["arrow"+i]),this["addAttr"+i]&&this.grpAttr.getChildAt(i).addChild(this["addAttr"+i]));var n=WarriorModel.ins().checkIsActivated(this.warriorId);if(n){var o=WarriorModel.ins().getActiveAttr(this.warriorId),s=WarriorModel.ins().getStrenCurLevAttr(this.warriorId),r=AttributeData.AttrAddition(o,s),a=[];if(!t){var l=WarriorModel.ins().getStrenNextLevAttr(this.warriorId);a=AttributeData.AttrAddition(o,l)}for(var h=0,u=0,p=r;u<p.length;u++){var c=p[u],d=c.type,g=this["attr"+h];g&&(g.visible=!0,g.text=AttributeData.getAttrStrByType(c.type)+("+"+Math.floor(c.value)));for(var m=0,f=a;m<f.length;m++){var v=f[m];if(d==v.type){var y=this["arrow"+h];y&&(y.visible=!0);var C=this["addAttr"+h];C&&(C.visible=!0,C.text=Math.floor(v.value)+"")}}h++}}else for(var o=WarriorModel.ins().getActiveAttr(this.warriorId),h=0,T=0,w=o;T<w.length;T++){var c=w[T],g=this["attr"+h];g&&(g.visible=!0,g.text=AttributeData.getAttrStrByType(c.type)+"+0");var y=this["arrow"+h];y&&(y.visible=!0);var C=this["addAttr"+h];C&&(C.visible=!0,C.text=Math.floor(c.value)+""),h++}},e.prototype.updatePower=function(){this.powerPanel.setPower(WarriorModel.ins().getOneWarriorPower(this.warriorId))},e.prototype.updateModel=function(t){void 0===t&&(t=!1),this.bossMc&&this.bossMc.parent||(this.bossMc=this.bossMc||new GameMovieClip,this.bossGroup.removeChildren(),this.bossGroup.addChild(this.bossMc));var e=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);this.bossMc.playFile(this.modelPrefix+(""+e.innerAppearance),-1)},e.prototype.updateRed=function(){this.redStren.visible=WarriorModel.ins().checkCanActive(this.warriorId)||WarriorModel.ins().checkCanStrenLev(this.warriorId),this.redQianNeng.visible=WarriorModel.ins().checkUseDrugA(this.warriorId),this.redFeiSheng.visible=WarriorModel.ins().checkUseDrugB(this.warriorId),this.updateListArrowRed()},e.prototype.updateListArrowRed=function(){for(var t=24,e=this.scroller.viewport.scrollH,i=Math.ceil(e/(this.listItemWidth+this.gap)),n=e%(this.listItemWidth+this.gap),o=!1,s=0;i>s;++s)if(!(s==i-1&&n>0&&n<=this.listItemWidth-5)){var r=this.listData[s];if(r&&WarriorModel.ins().checkOneWarriorRedForTabStren(r.cfg.Id)){o=!0;break}}this.leftRed.visible=o,o=!1;var a=i+this.showListRangeNum;for(n>0&&n<this.listItemWidth-t-5&&a--;a<this.listData.length;++a){var r=this.listData[a];if(WarriorModel.ins().checkOneWarriorRedForTabStren(r.cfg.Id)){o=!0;break}}this.rightRed.visible=o},e.prototype.updateProgress=function(t){if(this.barbc||(this.barbc=new ProgressBarEff,this.barbc.setWidth(450),this.barbc.x=-225,this.barbc.y=-12,this.groupProgress.addChild(this.barbc),this.barbc.reset()),WarriorModel.ins().checkIsActivated(this.warriorId)&&!WarriorModel.ins().checkIsStrenLevMax(this.warriorId)){this.barbc.visible=!0;var e=WarriorModel.ins().getStrenExp(this.warriorId),i=WarriorModel.ins().getStrenExpMax(this.warriorId);t&&this.barbc.reset(),this.barbc.setData(e,i),this.barbc.setLbValueText(e+"/"+i)}else this.barbc.visible=!1},e.prototype.updateInfo=function(){this.lblLv.text="Lv."+WarriorModel.ins().getCurLev(this.warriorId),this.starList.setlistLength(10,0,60),this.starList.updateStar(0,WarriorConfigMgr.ins().getStarResArray(this.warriorId));var t=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);this.imgName.source=t.TipsName+"_png"},e.prototype.updateSkillView=function(){var t=[],e=DataCenter.ins().WarriorSkillConfig,i=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId);for(var n in e)for(var o=e[n],s=o.id,r=0,a=0,l=i.skill;a<l.length;a++){var h=l[a];if(h.id==s){r=h.open;var u=WarriorModel.ins().getCurLev(this.warriorId)>=r;t.push({cfg:o,isActive:u});break}}this.listSkill.dataProvider.replaceAll(t),this.skillIconImg.source=i.skillicon+"_png",WarriorModel.ins().checkIsActivated(this.warriorId)?FilterUtils.clearColorFilter(this.skillIconImg):this.skillIconImg.filters=FilterUtils.ARRAY_GRAY_FILTER;var p=i.skillid,c=WarriorModel.ins().getCurBreachLev(this.warriorId),d=WarriorConfigMgr.ins().getBreanchConfigByLev(this.warriorId,c);d&&(p=d.skillid),this.skillId=p;var g=DataCenter.ins().SkillsConfig[p];if(g){var m=DataCenter.ins().SkillsDescConfig[g.desc];this.lblSkillName.text=m.name}},e.prototype.firstWarriorRequestBattle=function(){var t=WarriorModel.ins().getWarriorDataDict(),e=Object.keys(t);if(e&&e.length>0&&!this.autoRequestBattle){for(var i=!1,n=0,o=e;n<o.length;n++){var s=o[n];if(WarriorModel.ins().checkIsUpBattling(Number(s))){i=!0;break}}i||(warriorControl.upUpBattle(Number(e[0]),1,0),this.autoRequestBattle=!0)}},e}(BasePanel);__reflect(WarriorPersonPanel.prototype,"WarriorPersonPanel");var WarriorSkillTipView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorSkillTipViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.warriorId=t[0],this.skillCfg=t[1],this.skillId=t[2],this.addEventTouchTap(this.bgClose,this.otherClose),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.updateView=function(){if(this.skillCfg){this.lblSkillName.text=this.skillCfg.skillname,this.lblSkillDesc.text="",this.lblSkillDesc.textFlow=[],this.lblAttr.text="",this.lblAttr.textFlow=[],this.lblSkillDesc.textFlow=TextUtils.generateTextFlow1(this.skillCfg.desc);var t=0;if(this.skillCfg.attrs)for(var e=0,i=this.skillCfg.attrs;e<i.length;e++){var n=i[e];this.lblAttr.text+=AttributeData.getAttrStrByType(n.type)+(": "+Math.floor(n.value))+(t<this.skillCfg.attrs.length-1?"\n":""),t++}for(var o=WarriorConfigMgr.ins().getAttrConfigById(this.warriorId),s=this.skillCfg.id,r=null,a=0,l=o.skill;a<l.length;a++){var h=l[a];if(h.id==s){r=h.open,this.lblCondition.text=LangMgr.getValueByKey("warriorSkillTip",r);break}}this.grpCondition.visible=r}else if(this.skillId){var u=DataCenter.ins().SkillsConfig[this.skillId],p=DataCenter.ins().SkillsDescConfig[u.desc];this.lblAttr.text="",this.lblSkillName.text=p.name,this.lblSkillDesc.textFlow=TextUtils.generateTextFlow1(p.desc),this.grpCondition.visible=!1}this.lblActive.visible=!this.grpCondition.visible},e}(BaseEuiView);__reflect(WarriorSkillTipView.prototype,"WarriorSkillTipView");var WarriorTaskView=function(t){function e(){var e=t.call(this)||this;return e.sendReward=!1,e.skinName="WarriorTaskViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.openCheck=function(t){var e=WarriorConfigMgr.ins().getBaseConfig();return ActorControl.level<e.level?(tipsControl.showTips(LangMgr.getValueByKey("open1",LangMgr.getValueByKey("numberLevel",e.openZhuanshengLv))),!1):reincarnateControl.lv<e.openZhuanshengLv?(tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",e.openZhuanshengLv)),!1):GameServer.serverOpenDay+1<e.openServerDay?(tipsControl.showTips(LangMgr.getValueByKey("serverDayOpen",e.openServerDay)),!1):!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.initAllEvents(),this.award.itemRenderer=ItemBase,this.award.dataProvider=new eui.ArrayCollection;var i=WarriorConfigMgr.ins().getBaseConfig();this.award.dataProvider.replaceAll(i.taskInfo.award),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents(),TimerMgr.ins().removeAll(this)},e.prototype.initAllEvents=function(){this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.seeRule,this.onClick),this.addEventTouchTap(this.goBtn,this.onClick),this.addCustomEvent(44,this.taskDataChange)},e.prototype.removeAllEvents=function(){this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeEventTouchTap(this.seeRule,this.onClick),this.removeEventTouchTap(this.goBtn,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:HelpControl.openHelpWin(2e3);break;case this.goBtn:var e=WarriorModel.ins().getTaskStatus();if(0==e){var i=WarriorConfigMgr.ins().getBaseConfig(),n=i.fbId;if(n){var o=DataCenter.ins().DailyCopyConfig[n];if(!crossArenaControl.checkIsMatching())return;var s=copyControl.getFbDataById(n);s.getCount()<=0?tipsControl.showTips(LangMgr.getValueByKey("babelTips5")):o.levelLimit>ActorControl.level?tipsControl.showTips(LangMgr.getValueByKey("babelTips6")):(copyControl.upChallenge(n),WarriorModel.ins().flagFromTaskWinBattle=!0)}else UIMgr.ins().open(CopyView,0)}else 1==e&&(warriorControl.upTaskReward(),this.sendReward=!0,this.flyToBag())}},e.prototype.flyToBag=function(){var t=this,e=new ItemBase,i=WarriorConfigMgr.ins().getBaseConfig();e.data=i.taskInfo.award[0].id;var n=this.localToGlobal(0,0),o=this.award.localToGlobal(0,0);e.x=o.x-n.x,e.y=o.y-n.y,this.addChild(e),gameControl.dispatchFlyItemEx(e),TimerMgr.ins().doTimer(1700,1,function(){WarriorModel.ins().checkIsTaskStage()||(UIMgr.ins().close(t),UIMgr.ins().open(WarriorView))},this)},e.prototype.taskDataChange=function(){if(this.sendReward){this.sendReward=!1;var t=WarriorModel.ins().getTaskStatus();(2==t||3==t)&&this.flyToBag()}this.updateView()},e.prototype.updateView=function(){var t=WarriorConfigMgr.ins().getBaseConfig();this.progressLabel.text=WarriorModel.ins().getTaskValue()+"/"+t.taskInfo.target,this.redPoint.visible=WarriorModel.ins().checkTaskRewardRed();var e=WarriorModel.ins().getTaskStatus();1==e?this.goBtn.icon="shenwu_get_reward_btn":0==e?this.goBtn.icon="swjd_btn":(2==e||3==e)&&(this.goBtn.icon="shenwu_get_reward_btn",this.goBtn.enabled=!1,this.goBtn.filters=FilterUtils.ARRAY_GRAY_FILTER)},e}(BaseEuiView);__reflect(WarriorTaskView.prototype,"WarriorTaskView");var WarriorUpBattleView=function(t){function e(){var e=t.call(this)||this;return e.skinName="WarriorUpBattleViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.otherClose),this.addEventTouchTap(this.closeBtn,this.otherClose),this.addCustomEvent(40,this.posBattleChange),this.warriorId=t[0],this.listFuzhu.itemRenderer=WarriorUpBattleItemRenderer,this.listFuzhu.dataProvider=new eui.ArrayCollection,this.listFuzhu.selectedIndex=0,this.addEventTouchTap(this.btnFuzhu1,this.onTap),this.addEventTouchTap(this.btnFuzhu2,this.onTap),this.addEventTouchTap(this.btnMain,this.onTap),this.updateView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.otherClose),this.removeEventTouchTap(this.closeBtn,this.otherClose),this.removeCustomEvents(),this.removeEventTouchTap(this.btnFuzhu1,this.onTap),this.removeEventTouchTap(this.btnFuzhu2,this.onTap),this.removeEventTouchTap(this.btnMain,this.onTap),this.lateCall&&(this.lateCall(),this.lateCall=null)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.onTap=function(t){var e,i=WarriorModel.ins().getFuzhuList();switch(t.currentTarget){case this.btnFuzhu1:e=i[0],this.upFuzhu(e),this.btnFuzhu1.enabled=this.btnFuzhu2.enabled=this.btnMain.enabled=!1;break;case this.btnFuzhu2:e=i[1],this.upFuzhu(e),this.btnFuzhu1.enabled=this.btnFuzhu2.enabled=this.btnMain.enabled=!1;break;case this.btnMain:warriorControl.upUpBattle(this.warriorId,1,0),this.btnFuzhu1.enabled=this.btnFuzhu2.enabled=this.btnMain.enabled=!1}},e.prototype.upFuzhu=function(t){var e=this;t?(warriorControl.upUpBattle(t,0,1),this.lateCall=function(){var i=WarriorModel.ins().getBattlingId(),n=WarriorModel.ins().getFuzhuList();t!=i&&-1==n.indexOf(t)&&warriorControl.upUpBattle(e.warriorId,0,0)}):warriorControl.upUpBattle(this.warriorId,0,0)},e.prototype.posBattleChange=function(){var t=WarriorModel.ins().getBattlingId(),e=WarriorModel.ins().getFuzhuList();this.warriorId==t||-1!=e.indexOf(this.warriorId)?this.updateView():this.lateCall&&(this.lateCall(),this.lateCall=null)},e.prototype.updateView=function(){var t=WarriorConfigMgr.ins().getAttrConfigById(WarriorModel.ins().getBattlingId());this.mainImg.source=t?t.monHeadIcon+"_png":"",this.mainNameImg.source=t?t.name:"";for(var e=[],i=WarriorModel.ins().getFuzhuList(),n=i.length>=2?i.length:2,o=0;n>o;++o){var s=void 0;i[o]&&(s=WarriorConfigMgr.ins().getAttrConfigById(i[o])),e.push({cfg:s,showAdd:!s,main:!1,hasSelect:!1})}this.listFuzhu.dataProvider.replaceAll(e),this.btnFuzhu2.enabled=i.length>=1;var r=LangMgr.getValueByKey("wearState2"),a=LangMgr.getValueByKey("warriorUp");this.btnFuzhu1.label=i.length>=1?r:a,this.btnFuzhu2.label=i.length>=2?r:a,this.btnMain.label=WarriorModel.ins().getBattlingId()?r:a,(-1!=i.indexOf(this.warriorId)||WarriorModel.ins().getBattlingId()==this.warriorId)&&(this.btnFuzhu1.enabled=!1,this.btnFuzhu2.enabled=!1),this.btnMain.enabled=!(WarriorModel.ins().getBattlingId()==this.warriorId)},e}(BaseEuiView);__reflect(WarriorUpBattleView.prototype,"WarriorUpBattleView");var WarriorView=function(t){function e(){var e=t.call(this)||this;return e.oldTapIndex=0,e.skinName="WarriorViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.openCheck=function(t){var e=WarriorConfigMgr.ins().getBaseConfig();return ActorControl.level<e.level?(tipsControl.showTips(LangMgr.getValueByKey("open1",LangMgr.getValueByKey("numberLevel",e.openZhuanshengLv))),!1):reincarnateControl.lv<e.openZhuanshengLv?(tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",e.openZhuanshengLv)),!1):GameServer.serverOpenDay+1<e.openServerDay?(tipsControl.showTips(LangMgr.getValueByKey("serverDayOpen",e.openServerDay)),!1):!0},e.prototype.checkAleastOneActive=function(){var t=WarriorConfigMgr.ins().getAttrConfigs(),e=!1;for(var i in t){var n=t[i];if(WarriorModel.ins().checkIsActivated(n.Id)){e=!0;break}}return e||tipsControl.showTips(LangMgr.getValueByKey("activeWarriorTip")),e},e.prototype.checkTapOpen=function(t){if(2==t||3==t){var e=WarriorConfigMgr.ins().getBaseConfig();return reincarnateControl.lv<e.EquipZSLv?(tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",e.EquipZSLv)),!1):GameServer.serverOpenDay+1<e.EquipOpenDay?(tipsControl.showTips(LangMgr.getValueByKey("serverDayOpen",e.EquipOpenDay)),!1):this.checkAleastOneActive()}return 1==t?this.checkAleastOneActive():!0},e.prototype.initUI=function(){t.prototype.initUI.call(this),this.viewStack.touchEnabled=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.oldTapIndex=this.tab.selectedIndex=this.viewStack.selectedIndex=t[0]?t[0]:0,this.initAllEvents(),this.updateTapView(!0),this.updateRed()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeAllEvents()},e.prototype.initAllEvents=function(){this.addEventTouchTap(this.closeBtn,this.onClick),this.addEventTouchTap(this.seeRule,this.onClick),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addCustomEvent(37,this.updateRed),this.addCustomEvent(266,this.updateRed),this.addCustomEvent(267,this.updateRed),this.addCustomEvent(268,this.updateRed),this.addCustomEvent(296,this.updateRed),this.addCustomEvent(42,this.updateRed)},e.prototype.removeAllEvents=function(){this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeEventTouchTap(this.seeRule,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(t){switch(t.target){case this.closeBtn:UIMgr.ins().close(this);break;case this.seeRule:HelpControl.openHelpWin(2e3)}},e.prototype.onTabTouch=function(t){this.updateTapView()},e.prototype.onTabTouching=function(t){this.checkTapOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.updateTapView=function(t){void 0===t&&(t=!1);var e=this.tab.selectedIndex;if(this.oldTapIndex!=e){var i=this.viewStack.getElementAt(this.oldTapIndex);i.close&&i.close();var n=this.viewStack.getElementAt(e);n.open&&n.open(),this.oldTapIndex=e}else if(t){var n=this.viewStack.getElementAt(e);n.open&&n.open()}},e.prototype.updateRed=function(){this.redPoint0.visible=WarriorModel.ins().checkAllWarriorRedForTabStren(),this.redPoint1.visible=WarriorModel.ins().checkAllWarriorRedForTabBreach(),this.redPoint2.visible=WarriorModel.ins().checkAllRedForTabEquip(),this.redPoint3.visible=WarriorModel.ins().checkEquipRedForTabCompose()},e}(BaseEuiView);__reflect(WarriorView.prototype,"WarriorView");var WarriorActiveItemTipSkillItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){this.skillIcon1.source=this.getImgIcon();var t={name:"",desc:""};t.name=this.data.cfg.skillname,t.desc=this.data.cfg.desc?this.data.cfg.desc:"",this.data.cfg.attrs&&(t.desc&&(t.desc+="\n"),t.desc+="|C:"+LangMgr.getColor("color79")+"&T:"+AttributeData.getAttStr(this.data.cfg.attrs,0,1,"：")+"|"),this.desc.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("wingTips13",this.data.openLv,t.name,t.desc))}},e.prototype.getImgIcon=function(){return this.data.cfg.skillicon},e}(BaseItemRender);__reflect(WarriorActiveItemTipSkillItemRenderer.prototype,"WarriorActiveItemTipSkillItemRenderer");var WarriorBossItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data&&this.stage){var e=DataCenter.ins().WorldBossConfig[this.data.bossItem.id],i=DataCenter.ins().MonstersConfig[e.bossId];this.lblName.text=i.name,this.refreshGrp.visible=!1,this.refreshTime.text="",this.notOpenImg.visible=!this.data.isOpenForFive||!this.data.isOpenForLv,this.imgIcon.source="monhead"+i.head+"_png";var n=e.showReward.map(function(t){return WarriorConfigMgr.ins().getEquipCfgByid(t)}),o=0;if(n&&n.length)for(var s=0;s<n.length;s++){var r=n[s];r&&(o=r.star>o?r.star:o)}this.stageTxt.text=LangMgr.getValueByKey("stageNumberTxt",o),this.upTimer()}},Object.defineProperty(e.prototype,"selected",{set:function(t){this.select.visible=t},enumerable:!0,configurable:!0}),e.prototype.upTimer=function(){if(this.data)if(this.redPoint.visible=WarriorModel.ins().checkRedForOneBossChallengeRed(this.data.bossItem.id),this.data.isOpenForFive&&this.data.isOpenForLv){var t=this.data.bossItem.relieveTime-egret.getTimer();t>0?(this.refreshGrp.visible=!0,this.refreshTime.text=""+DateUtils.getFormatBySecond(Math.floor(t/1e3),1)):(this.refreshGrp.visible=!1,this.refreshTime.text="")}else this.refreshGrp.visible=!1,this.refreshTime.text=""},e}(BaseItemRender);__reflect(WarriorBossItemRenderer.prototype,"WarriorBossItemRenderer");var WarriorBossRemindItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data){var e=DataCenter.ins().WorldBossConfig[this.data.id],i=e.showReward.map(function(t){return WarriorConfigMgr.ins().getEquipCfgByid(t)}),n=0;if(i&&i.length)for(var o=0;o<i.length;o++){var s=i[o];s&&(n=s.star>n?s.star:n)}this.demandScore.text=LangMgr.getValueByKey("stageNumberTxt",n);var r=BossControl.isCanChallenge(e),a=WarriorModel.ins().checkDunFive(this.data.id);this.txt.visible=!r||!a,a?r||(this.txt.text=LangMgr.getValueByKey("homeNoFight")):this.txt.text=LangMgr.getValueByKey("warriorFiveTip"),this.checkBoxs.visible=!this.txt.visible}},e}(PublicBossRemindItemRenderer);__reflect(WarriorBossRemindItemRenderer.prototype,"WarriorBossRemindItemRenderer");var WarriorEquipBagItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventRemovedFromStage(this,this.removeFromStage),this.addEventTouchTap(this.changeBtn,this.onChangeBtnTap)},e.prototype.removeFromStage=function(){this.removeEventRemovedFromStage(this,this.removeFromStage),this.removeEventTouchTap(this.changeBtn,this.onChangeBtnTap)},e.prototype.onChangeBtnTap=function(){if(this.data){var t=WarriorConfigMgr.ins().getEquipCfgByid(this.data.itemId);warriorControl.upWearEquip(this.data.equipId,t.pos,this.data.itemId),UIMgr.ins().close(WarriorEquipBagView),UIMgr.ins().close(WarriorEquipDetailTipView)}},e.prototype.dataChanged=function(){if(this.data){var t=DataCenter.ins().ItemConfig[this.data.itemId];this.itemIcon.data=t;var e=WarriorConfigMgr.ins().getEquipCfgByid(this.data.itemId);this.lblLev.text=StringUtils.NumberToChinese(e.star)+LangMgr.getValueByKey("osaLevelJ"),this.lblLev.textColor=ItemUtils.getQualityColor(t);var i=0;this.lblAttr.text="";for(var n=0,o=e.attr;n<o.length;n++){var s=o[n];this.lblAttr.text+=AttributeData.getAttrStrByType(s.type)+(": "+s.value)+(i<e.attr.length-1?"\n":"")}this.bestImg.visible=this.data.isBest&&!this.data.isWearing,this.grpNow.visible=this.data.isWearing,this.changeBtn.visible=!this.data.isWearing}},e}(BaseItemRender);__reflect(WarriorEquipBagItemRenderer.prototype,"WarriorEquipBagItemRenderer");var WarriorEquipComposeItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=WarriorEquipComposePosItemRenderer,this.list.dataProvider=new eui.ArrayCollection,this.addEventItemTap(this.list,this.onListTap)},e.prototype.onListTap=function(t){this.data.callBack&&this.data.callBack.call(this.data.callObj,t.item,this.list.selectedIndex)},e.prototype.dataChanged=function(){this.data&&(this.equipNum.text=this.data.equipCfgList[0].star+"",this.redPoint.visible=WarriorModel.ins().checkEquipStarComposeRed(this.data.battleEquipPos,this.data.equipCfgList[0].star))},e.prototype.updateList=function(t){if(this.data){this.list.selectedIndex=this.data.curPosIndex;for(var e=[],i=0,n=this.data.equipCfgList;i<n.length;i++){var o=n[i];e.push({battleEquipPos:this.data.battleEquipPos,cfg:o})}t?this.list.dataProvider.replaceAll(e):this.list.dataProvider.replaceAll([])}},Object.defineProperty(e.prototype,"selected",{set:function(t){this.updateList(t)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(WarriorEquipComposeItemRenderer.prototype,"WarriorEquipComposeItemRenderer");var WarriorEquipComposePosItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.lblName.text=this.data.cfg.star+LangMgr.getValueByKey("osaLevelJ")+WarriorConfigMgr.ins().getEquipName(this.data.cfg.pos),this.redPoint.visible=WarriorModel.ins().checkEquipComposeRed(this.data.battleEquipPos,this.data.cfg.Id))},Object.defineProperty(e.prototype,"selected",{set:function(t){this.imgSelect.visible=t},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(WarriorEquipComposePosItemRenderer.prototype,"WarriorEquipComposePosItemRenderer");var WarriorEquipItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effPrefix=PATH_EFF,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;if(t&&(this.redPoint.visible=t.isRed,this.lblStren.visible=t.strenLv>0,this.lblStren.text="+"+t.strenLv),t&&t.cfg){if(t.cfg.frameEff?(this.mc||(this.mc=new GameMovieClip),this.grpEffect.addChild(this.mc),this.mc.playFile(this.effPrefix+t.cfg.frameEff,-1),this.grpEffect.scaleX=this.grpEffect.scaleY=1):this.grpEffect.removeChildren(),this.itemIcon.setData(DataCenter.ins().ItemConfig[t.cfg.Id]),this.grpNum.visible=!0,!this.numGrp){this.numGrp=new eui.Group;var e=new eui.VerticalLayout;e.horizontalAlign=egret.HorizontalAlign.CENTER,e.verticalAlign=egret.VerticalAlign.MIDDLE,e.gap=2,this.numGrp.layout=e,this.grpNum.addChild(this.numGrp),this.numGrp.verticalCenter=0,this.numGrp.horizontalCenter=0}var i=DataCenter.ins().ItemConfig[t.cfg.Id],n=ItemUtils.getQuality(i);this.tagImg.source="zhanjiangzhuangbeidengjie"+(n-1)+"_bg",this.numGrp.removeChildren();for(var o=t.cfg.star,s=StringUtils.NumberToChinese(o),r=0;r<s.length;++r)this.numGrp.addChild(new eui.Image("zz"+(n-1)+"_"+this.getNumSource(s[r])));this.numGrp.addChild(new eui.Image("zz"+(n-1)+"_jie")),this.defaultGrayImg&&(this.defaultGrayImg.visible=!1),this.itemIcon.visible=!0}else{this.grpEffect.removeChildren();var a=WarriorConfigMgr.ins().getEquipMinIdCfgByPos(t.pos);this.itemIcon.setData(DataCenter.ins().ItemConfig[a.Id]),this.defaultGrayImg&&(this.defaultGrayImg.visible=!0),this.defaultGrayImg&&(this.defaultGrayImg.source=this.getDefaultGray(t.pos)),this.itemIcon.visible=!1,this.grpNum.visible=!1}},e.prototype.getNumSource=function(t){return t==LangMgr.getValueByKey("chnUnitChar1")?10:StringUtils.ChineseToNumber(t)},e.prototype.getDefaultGray=function(t){switch(t){case 0:return"kaitianzhan";case 1:return"toukui";case 2:return"kuijia";case 3:return"xianglian";case 4:return"huwan";case 5:return"yaodai";case 6:return"jiezhi";case 7:return"xiezi";case 9:return"shipin";case 10:return"mianzhao";case 11:return"jianjia";case 12:return"dunpai"}},e}(BaseItemRender);__reflect(WarriorEquipItemRenderer.prototype,"WarriorEquipItemRenderer");var WarriorEquipResolveItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=DataCenter.ins().ItemConfig[this.data.itemId];this.imgIcon.source=t.icon+"_png",this.imgBg.source="quality"+ItemUtils.getQuality(t),this.lblNum.text=this.data.num+"",this.lblName.textColor=ItemUtils.getQualityColor(t),this.lblName.text=t.name,this.lblName.visible=this.data.showName}},e}(BaseItemRender);__reflect(WarriorEquipResolveItemRenderer.prototype,"WarriorEquipResolveItemRenderer");var WarriorPersonItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(t.prototype.dataChanged.call(this),this.data&&this.stage){if(this.currentState=this.data.showMain?"main":"normal",this.validateNow(),this.imgIcon.source=this.getImgIcon(),this.imgName.source=this.getImgName(),this.redPoint.visible=this.data.isRed,this.data.cfg){this.imgBattling.visible=WarriorModel.ins().checkIsUpBattling(this.data.cfg.Id);var e=WarriorModel.ins().getFuzhuList();this.imgFuzhuing.visible=!this.imgBattling.visible&&-1!=e.indexOf(this.data.cfg.Id),this.imgNoActive.visible=!WarriorModel.ins().checkIsActivated(this.data.cfg.Id)
}else this.imgBattling.visible=!1,this.imgFuzhuing.visible=!1,this.imgNoActive.visible=!1,this.imgIcon.source="touxianglock";null!=this.data.canShowTagBattle&&(this.imgBattling.visible=this.data.canShowTagBattle),null!=this.data.canShowTagFuzhu&&(this.imgFuzhuing.visible=this.data.canShowTagFuzhu)}},e.prototype.getImgIcon=function(){return this.data.cfg?this.data.cfg.monHeadIcon+"_png":""},e.prototype.getImgName=function(){return this.data.cfg?this.data.cfg.name:""},Object.defineProperty(e.prototype,"selected",{set:function(t){this.data&&this.data.cfg?this.select.visible=t:this.select.visible=!1},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(WarriorPersonItemRenderer.prototype,"WarriorPersonItemRenderer");var WarriorSkillItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.data&&this.stage&&(this.data.isActive?FilterUtils.clearColorFilter(this.iconImg):this.iconImg.filters=FilterUtils.ARRAY_GRAY_FILTER,this.iconImg.source=this.getImgIcon())},e.prototype.getImgIcon=function(){return this.data.cfg.skillicon},e}(BaseItemRender);__reflect(WarriorSkillItemRenderer.prototype,"WarriorSkillItemRenderer");var WarriorUpBattleItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){t.prototype.dataChanged.call(this),this.redPoint.visible=!1,this.data&&this.stage&&(this.currentState=this.data.main?"main":"normal",this.validateNow(),this.imgIcon.source=this.getImgIcon(),this.imgName.source=this.getImgName(),this.imgAdd.visible=this.data.showAdd,this.data.hasSelect||(this.select.visible=!1))},e.prototype.getImgIcon=function(){return this.data.cfg?this.data.cfg.monHeadIcon+"_png":""},e.prototype.getImgName=function(){return this.data.cfg?this.data.cfg.name:""},Object.defineProperty(e.prototype,"selected",{set:function(t){this.data?this.data.hasSelect?this.select.visible=t:this.select.visible=!1:this.select.visible=t},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(WarriorUpBattleItemRenderer.prototype,"WarriorUpBattleItemRenderer");var WelfareBtnItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="AmusementBtnItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.iconDisplay.source=this.data.icon;var t=platformAmuseControl.checkFuLiRedPoint(this.data.id);t?(this.mc||(this.mc=new GameMovieClip,this.mc.x=40,this.mc.y=42),this.mc.playFile(PATH_EFF+"actIconCircle",-1),this.addChild(this.mc)):(DisplayUtils.removeFromParent(this.mc),this.mc=null),this.redPoint.visible=t},e}(BaseItemRender);__reflect(WelfareBtnItemRenderer.prototype,"WelfareBtnItemRenderer");var DevourEquipPosType;!function(t){t[t.zhizun=0]="zhizun",t[t.leiting=1]="leiting",t[t.chuanqi=2]="chuanqi",t[t.cailiao=3]="cailiao",t[t.tunshi=4]="tunshi"}(DevourEquipPosType||(DevourEquipPosType={}));var DevourEquipRewardType;!function(t){t[t.one=1]="one",t[t["double"]=2]="double",t[t.finish=3]="finish"}(DevourEquipRewardType||(DevourEquipRewardType={}));var DevourEquipHuanHuaPos;!function(t){t[t.weapon=0]="weapon",t[t.clothes=2]="clothes"}(DevourEquipHuanHuaPos||(DevourEquipHuanHuaPos={}));var ChipsTweenType;!function(t){t[t.MV_BROKEN=1]="MV_BROKEN",t[t.MV_LINE=2]="MV_LINE"}(ChipsTweenType||(ChipsTweenType={}));var DevourEquipViewType;!function(t){t[t.YANGCHENG=0]="YANGCHENG",t[t.LIANHUN=1]="LIANHUN"}(DevourEquipViewType||(DevourEquipViewType={})),window.Main=Main,window.Launcher=Launcher,window.AmusementControl=AmusementControl,window.AmusementRankData=AmusementRankData,window.RedPacketSysControl=RedPacketSysControl,window.ThreeHeroesControl=ThreeHeroesControl,window.AmusementBaseDataVo=AmusementBaseDataVo,window.AmusementDataFactory=AmusementDataFactory,window.AmusementType100DataVo=AmusementType100DataVo,window.AmusementType102DataVo=AmusementType102DataVo,window.AmusementType103DataVo=AmusementType103DataVo,window.AmusementType10DataVo=AmusementType10DataVo,window.AmusementType11DataVo=AmusementType11DataVo,window.AmusementType12DataVo=AmusementType12DataVo,window.RedEnvelope=RedEnvelope,window.EnvelopeData=EnvelopeData,window.AmusementType13DataVo=AmusementType13DataVo,window.AmusementType16DataVo=AmusementType16DataVo,window.AmusementType18DataVo=AmusementType18DataVo,window.AmusementType19DataVo=AmusementType19DataVo,window.AmusementType1DataVo=AmusementType1DataVo,window.AmusementType20DataVo=AmusementType20DataVo,window.AmusementType21DataVo=AmusementType21DataVo,window.AmusementType22DataVo=AmusementType22DataVo,window.AmusementType25DataVo=AmusementType25DataVo,window.AmusementType26DataVo=AmusementType26DataVo,window.AmusementType2DataVo=AmusementType2DataVo,window.AmusementType3DataVo=AmusementType3DataVo,window.AmusementType4DataVo=AmusementType4DataVo,window.AmusementType5DataVo=AmusementType5DataVo,window.AmusementType6DataVo=AmusementType6DataVo,window.AmusementType7DataVo=AmusementType7DataVo,window.AmusementType8DataVo=AmusementType8DataVo,window.AmusementType9DataVo=AmusementType9DataVo,window.AmusementTypeExDataVo=AmusementTypeExDataVo,window.RedPacketRecordVo=RedPacketRecordVo,window.RedPacketVo=RedPacketVo,window.SpringBeginShopVo=SpringBeginShopVo,window.AmusementBaseView=AmusementBaseView,window.AmusementOpenServerView=AmusementOpenServerView,window.AmusementTipsView=AmusementTipsView,window.AmusementUniversalView=AmusementUniversalView,window.LuckyResultView=LuckyResultView,window.AmusementPanel=AmusementPanel,window.AmuseRankTipsView=AmuseRankTipsView,window.AmuseTarget0Panel1=AmuseTarget0Panel1,window.AmuseTarget0Panel11=AmuseTarget0Panel11,window.AmuseTarget0Panel18=AmuseTarget0Panel18,window.AmuseTarget0Panel19=AmuseTarget0Panel19,window.AmuseTarget0Panel2=AmuseTarget0Panel2,window.AmuseTarget0Panel3=AmuseTarget0Panel3,window.AmuseTarget0Panel4=AmuseTarget0Panel4,window.AmuseTarget0Panel5=AmuseTarget0Panel5,window.AmuseTarget0Panel6=AmuseTarget0Panel6,window.AmuseTarget0Panel7=AmuseTarget0Panel7,window.AmuseTarget0Panel8=AmuseTarget0Panel8,window.AmuseTarget0Panel9=AmuseTarget0Panel9,window.AmuseTarget100Panel2=AmuseTarget100Panel2,window.AmuseTarget102Panel1=AmuseTarget102Panel1,window.AmuseTarget103Panel1=AmuseTarget103Panel1,window.AmuseTarget10Panel=AmuseTarget10Panel,window.AmuseTarget11Panel1=AmuseTarget11Panel1,window.AmuseTarget11Panel10=AmuseTarget11Panel10,window.AmuseTarget11Panel3=AmuseTarget11Panel3,window.AmuseTarget12Panel1=AmuseTarget12Panel1,window.AmuseTarget18Panel1=AmuseTarget18Panel1,window.AmuseTarget18Panel2=AmuseTarget18Panel2,window.AmuseTarget18Panel2TipsView=AmuseTarget18Panel2TipsView,window.AmuseTarget18Panel3=AmuseTarget18Panel3,window.AmuseTarget18Panel4=AmuseTarget18Panel4,window.AmuseTarget19NestedPanel1=AmuseTarget19NestedPanel1,window.AmuseTarget19Panel1=AmuseTarget19Panel1,window.AmuseTarget1Panel=AmuseTarget1Panel,window.AmuseTarget20Panel=AmuseTarget20Panel,window.AmuseTarget21Panel=AmuseTarget21Panel,window.AmuseTarget22Panel1=AmuseTarget22Panel1,window.AmuseTarget22Panel2=AmuseTarget22Panel2,window.AmuseTarget25Panel=AmuseTarget25Panel,window.AmuseTarget2Panel1=AmuseTarget2Panel1,window.AmuseTarget2Panel12=AmuseTarget2Panel12,window.AmuseTarget2Panel2=AmuseTarget2Panel2,window.AmuseTarget2Panel3=AmuseTarget2Panel3,window.AmuseTarget2Panel5=AmuseTarget2Panel5,window.AmuseTarget3Panel1=AmuseTarget3Panel1,window.AmuseTarget3Panel10=AmuseTarget3Panel10,window.AmuseTarget3Panel15=AmuseTarget3Panel15,window.AmuseTarget3Panel16=AmuseTarget3Panel16,window.AmuseTarget3Panel17=AmuseTarget3Panel17,window.AmuseTarget3Panel2=AmuseTarget3Panel2,window.AmuseTarget3Panel3=AmuseTarget3Panel3,window.AmuseTarget3Panel4=AmuseTarget3Panel4,window.AmuseTarget3Panel5=AmuseTarget3Panel5,window.AmuseTarget3Panel6=AmuseTarget3Panel6,window.AmuseTarget3Panel7=AmuseTarget3Panel7,window.AmuseTarget3Panel8=AmuseTarget3Panel8,window.AmuseTarget3Panel9=AmuseTarget3Panel9,window.AmuseTarget4Panel1=AmuseTarget4Panel1,window.AmuseTarget4Panel2=AmuseTarget4Panel2,window.AmuseTarget4Panel3=AmuseTarget4Panel3,window.AmuseTarget4PanelRankRewardView=AmuseTarget4PanelRankRewardView,window.AmuseTarget5Panel1=AmuseTarget5Panel1,window.ActivityHFRenderItem=ActivityHFRenderItem,window.AmuseTarget5Panel2=AmuseTarget5Panel2,window.AmuseTarget5Panel3=AmuseTarget5Panel3,window.AmuseTarget6Panel=AmuseTarget6Panel,window.AmuseTarget7Panel1=AmuseTarget7Panel1,window.AmuseTarget7Panel2=AmuseTarget7Panel2,window.AmuseTarget7Panel3=AmuseTarget7Panel3,window.AmuseTarget7Panel4=AmuseTarget7Panel4,window.AmuseTarget7Panel5=AmuseTarget7Panel5,window.AmuseTarget7Panel6=AmuseTarget7Panel6,window.AmuseTarget8Panel=AmuseTarget8Panel,window.AmuseTarget8Panel1=AmuseTarget8Panel1,window.AmuseTarget9Panel1=AmuseTarget9Panel1,window.AmuseTarget9Panel2=AmuseTarget9Panel2,window.AmuseTarget9Panel3=AmuseTarget9Panel3,window.AmuseTarget9Panel4=AmuseTarget9Panel4,window.AmuseTarget9Panel5=AmuseTarget9Panel5,window.AmuseTarget9Panel6=AmuseTarget9Panel6,window.Amuse18Panel4ItemRender=Amuse18Panel4ItemRender,window.AmuseDailyRechargeItemRender=AmuseDailyRechargeItemRender,window.AmuseTarget0Panel18ListItemRender=AmuseTarget0Panel18ListItemRender,window.AmuseTarget0Panel2ListItemRender=AmuseTarget0Panel2ListItemRender,window.AmuseTarget0Penal18RewardItemRender=AmuseTarget0Penal18RewardItemRender,window.AmuseTarget0Penal2RewardItemRender=AmuseTarget0Penal2RewardItemRender,window.AmuseTarget102ItemRender=AmuseTarget102ItemRender,window.AmuseTarget18Panel2ItemRender=AmuseTarget18Panel2ItemRender,window.AmuseTarget18Panel2ListItemRender=AmuseTarget18Panel2ListItemRender,window.AmuseTarget1PanelItemRender=AmuseTarget1PanelItemRender,window.AmuseTarget25PanelItemRenderer=AmuseTarget25PanelItemRenderer,window.AmuseTarget2Panel1ItemRender=AmuseTarget2Panel1ItemRender,window.AmuseTarget3BigRewardItemRender=AmuseTarget3BigRewardItemRender,window.AmuseTarget3ItemBar15=AmuseTarget3ItemBar15,window.AmuseTarget3ItemRender15=AmuseTarget3ItemRender15,window.AmuseTarget3ItemRender16=AmuseTarget3ItemRender16,window.AmuseTarget3ItemRender6=AmuseTarget3ItemRender6,window.AmuseTarget3ItemRender7=AmuseTarget3ItemRender7,window.AmuseTarget4Panel3ItemRender=AmuseTarget4Panel3ItemRender,window.AmuseTarget4PanelRankRewardItemRender=AmuseTarget4PanelRankRewardItemRender,window.AmuseTarget4RankTipsItemRender=AmuseTarget4RankTipsItemRender,window.AmuseTarget9Panel3ItemRender=AmuseTarget9Panel3ItemRender,window.AmuseTarget9Panel6ItemRender=AmuseTarget9Panel6ItemRender,window.DailyRechargeItemRender=DailyRechargeItemRender,window.AmusementBtnItemRender=AmusementBtnItemRender,window.MidFestivalItemRender=MidFestivalItemRender,window.NoticeListItemRender=NoticeListItemRender,window.NoticeYBListItemRender=NoticeYBListItemRender,window.PAmusementControl=PAmusementControl,window.LvTimeLimitGiftTipsView=LvTimeLimitGiftTipsView,window.LvTimeLimitGiftView=LvTimeLimitGiftView,window.PAmusementDataFactory=PAmusementDataFactory,window.PAmusementType1DataVo=PAmusementType1DataVo,window.PAmusementType2DataVo=PAmusementType2DataVo,window.PAmusementType3DataVo=PAmusementType3DataVo,window.PAmusementType9DataVo=PAmusementType9DataVo,window.SuicideLimitBuyTipsView=SuicideLimitBuyTipsView,window.SuicideLimitBuyView=SuicideLimitBuyView,window.AmusementTotalEnterView=AmusementTotalEnterView,window.CbtestAmusementView=CbtestAmusementView,window.CelebrationItemRender=CelebrationItemRender,window.CelebrationRechargeItemRender=CelebrationRechargeItemRender,window.ChristmasRechargeItemRender=ChristmasRechargeItemRender,window.ChritmasSnowMainItemRender=ChritmasSnowMainItemRender,window.DailyGiftActControl=DailyGiftActControl,window.DailyGiftAwItemRender=DailyGiftAwItemRender,window.DailysGiftItemRender=DailysGiftItemRender,window.DirectShop1View=DirectShop1View,window.DirectShopCash1View=DirectShopCash1View,window.DirectShopCashView=DirectShopCashView,window.DirectShopView=DirectShopView,window.DirectShopCashItemRenderer=DirectShopCashItemRenderer,window.DirectShopItemRender=DirectShopItemRender,window.DoubleElevenRechargesPanel=DoubleElevenRechargesPanel,window.DoubleEleventDailyGiftPanel=DoubleEleventDailyGiftPanel,window.DoubleEleventMotherPanel=DoubleEleventMotherPanel,window.DoubleEleventRedPacketPanel=DoubleEleventRedPacketPanel,window.DoubleElevenDailysGiftItemRender=DoubleElevenDailysGiftItemRender,window.DoubleElevenRechargesItemRender=DoubleElevenRechargesItemRender,window.DoubleElevenTimesBuyItemRender=DoubleElevenTimesBuyItemRender,window.DoubleElevenTimesBuyTabItemRender=DoubleElevenTimesBuyTabItemRender,window.DoubleTwelveGiftPanel=DoubleTwelveGiftPanel,window.DoubleTwelveLotteryPanel=DoubleTwelveLotteryPanel,window.DoubleTwelveRechargeView=DoubleTwelveRechargeView,window.DoubleTwelveView=DoubleTwelveView,window.DoubleTwelveRechargeItemRender=DoubleTwelveRechargeItemRender,window.RedPacketDetailView=RedPacketDetailView,window.TreasureLogView=TreasureLogView,window.RedPacketRecorrdItemRender=RedPacketRecorrdItemRender,window.HappySevenDayView=HappySevenDayView,window.TaskIntegralGiftView=TaskIntegralGiftView,window.HappySevenDayBtnItemRender=HappySevenDayBtnItemRender,window.HappySevenDayItemRender=HappySevenDayItemRender,window.HappySevenDayTabListItemRender=HappySevenDayTabListItemRender,window.SevenDayShowItemRender=SevenDayShowItemRender,window.InvestmentControl=InvestmentControl,window.InvestmentLevelPanel=InvestmentLevelPanel,window.InvestmentLoginPanel=InvestmentLoginPanel,window.InvestmentLvGiftPanel=InvestmentLvGiftPanel,window.InvestmentMonthView=InvestmentMonthView,window.InvestmentNewRewardTipsView=InvestmentNewRewardTipsView,window.InvestmentNewType1Panel=InvestmentNewType1Panel,window.InvestmentNewType2Panel=InvestmentNewType2Panel,window.InvestmentView=InvestmentView,window.ActBtnItemRender=ActBtnItemRender,window.InvestmentBtnItemRender=InvestmentBtnItemRender,window.InvestmentItemRender=InvestmentItemRender,window.InvestmentLevelItemRender=InvestmentLevelItemRender,window.InvestmentLoginListItemRender=InvestmentLoginListItemRender,window.InvestmentLvItemRender=InvestmentLvItemRender,window.InvestMonthRewardItem2Render=InvestMonthRewardItem2Render,window.InvestMonthRewardItemRender=InvestMonthRewardItemRender,window.LastEighthBossView=LastEighthBossView,window.LastEighthRankRewardView=LastEighthRankRewardView,window.LastEighthBossPlayerRankItemRender=LastEighthBossPlayerRankItemRender,window.LastEighthChangeItemRender=LastEighthChangeItemRender,window.LastEighthRewardItemRender=LastEighthRewardItemRender,window.MergeServerAmusementView=MergeServerAmusementView,window.MergeServerBossIntegrateView=MergeServerBossIntegrateView,window.limitChangeItemRender=limitChangeItemRender,window.MergeServerBossBtnItemRender=MergeServerBossBtnItemRender,window.MergeServerBossItemRender=MergeServerBossItemRender,window.RingBossScoreExchangeItemRenderer=RingBossScoreExchangeItemRenderer,window.NationalDayAmusementView=NationalDayAmusementView,window.NationalDayListItemRender=NationalDayListItemRender,window.NewYearFireworkerItemRender=NewYearFireworkerItemRender,window.NewYearHighProjectItemRender=NewYearHighProjectItemRender,window.NewYearHighRewardItemRender=NewYearHighRewardItemRender,window.RedpacketSpeakView=RedpacketSpeakView,window.OffYearListsItemRender=OffYearListsItemRender,window.OffYearRedPacketItemRender=OffYearRedPacketItemRender,window.RedPacketOpenItemRender=RedPacketOpenItemRender,window.RedPacketRewardsItemRender=RedPacketRewardsItemRender,window.RedPacketShowItemRender=RedPacketShowItemRender,window.OpenDoorRedItemRender=OpenDoorRedItemRender,window.KaiMenData=KaiMenData,window.PlatformAmuseControl=PlatformAmuseControl,window.FocusGameView=FocusGameView,window.FranchisePanel=FranchisePanel,window.InviteFriendsView=InviteFriendsView,window.MonthCardView=MonthCardView,window.SealPveControl=SealPveControl,window.SealPveFightView=SealPveFightView,window.SealPveRankView=SealPveRankView,window.SealPveResultView=SealPveResultView,window.SealPveView=SealPveView,window.SealPveItemRender=SealPveItemRender,window.SealPveRankItemRender=SealPveRankItemRender,window.SeckillGiftAmuseView=SeckillGiftAmuseView,window.SeckillGiftBtnItemRender=SeckillGiftBtnItemRender,window.SeckillGiftRewardItemRender=SeckillGiftRewardItemRender,window.SpokesPersonBossSysControl=SpokesPersonBossSysControl,window.SpokesPersonControl=SpokesPersonControl,window.SpokesmanActID=SpokesmanActID,window.SpokesPersonRedPoint=SpokesPersonRedPoint,window.SpokesPersonAchiTaskControl=SpokesPersonAchiTaskControl,window.SpokesPersonAchiTaskOpenControl=SpokesPersonAchiTaskOpenControl,window.SpokesPersonAchievementPanel=SpokesPersonAchievementPanel,window.SpokesPersonAchiTabBarItemRender=SpokesPersonAchiTabBarItemRender,window.SpokesPersonAchiTaskItemRender=SpokesPersonAchiTaskItemRender,window.SpokesPersonBossPanel=SpokesPersonBossPanel,window.SpokesPersonDoubleExpControl=SpokesPersonDoubleExpControl,window.SpokesPersonDoubleExpPanel=SpokesPersonDoubleExpPanel,window.SpokesPersonEqiupRecyclePanel=SpokesPersonEqiupRecyclePanel,window.OnlineQuizControl=OnlineQuizControl,window.OnlineQuizView=OnlineQuizView,window.SpokesPersonTalkingView=SpokesPersonTalkingView,window.SpokesPersonTaskControl=SpokesPersonTaskControl,window.SpokesPersonTaskPanel=SpokesPersonTaskPanel,window.SpokesPersonTurntableControl=SpokesPersonTurntableControl,window.SpokesPersonTurntablePanel=SpokesPersonTurntablePanel,window.SpokesPersonTurntableItemRender=SpokesPersonTurntableItemRender,window.SpokesPersonView=SpokesPersonView,window.SpokesPersonIconItemRender=SpokesPersonIconItemRender,window.SpringBeginStoreRewardShowView=SpringBeginStoreRewardShowView,window.SpringBeginStoreItemRender=SpringBeginStoreItemRender,window.SpringBeginStoreShowItemRender=SpringBeginStoreShowItemRender,window.SpringEightDayView=SpringEightDayView,window.StrideServerDataVo=StrideServerDataVo,window.StrideServerCostRewardPanel=StrideServerCostRewardPanel,window.StrideServerRankPanel=StrideServerRankPanel,window.StrideServerCostRankItemRender=StrideServerCostRankItemRender,window.StrideServerCostRankRewardItemRender=StrideServerCostRankRewardItemRender,window.TotalRecharge55View=TotalRecharge55View,window.TotalRechargeView=TotalRechargeView,window.TreasureBasinAwardView=TreasureBasinAwardView,window.TreasureBasinBargianPanel=TreasureBasinBargianPanel,window.TreasureBasinEightPanel=TreasureBasinEightPanel,window.TreasureBasinLuxuryPanel=TreasureBasinLuxuryPanel,window.TreasureBasinLuxuryTipsView=TreasureBasinLuxuryTipsView,window.TreasureBasinMainView=TreasureBasinMainView,window.TreasureBasinView=TreasureBasinView,window.TreasureBasinView2=TreasureBasinView2,window.NewYearPropItemRender=NewYearPropItemRender,window.TreasureBasinBargianItemRenderer=TreasureBasinBargianItemRenderer,window.TreasureBasinEightItemRenderer=TreasureBasinEightItemRenderer,window.TreasureBasinItemRender=TreasureBasinItemRender,window.TreasureBasinLuxuryTipsItemRenderer=TreasureBasinLuxuryTipsItemRenderer,window.TreasureBasinMainItemRenderer=TreasureBasinMainItemRenderer,window.TreasureBasinRewardItemRender=TreasureBasinRewardItemRender,window.UnlimitedAmusementView=UnlimitedAmusementView,window.AmuseTarget103Panel1ItemRender=AmuseTarget103Panel1ItemRender,window.VersionCeleProjectItemRender=VersionCeleProjectItemRender,window.VersionCeleRewardItemRender=VersionCeleRewardItemRender,window.VersionCeleStoreItemRender=VersionCeleStoreItemRender,window.VersionCelestoreShowItemRender=VersionCelestoreShowItemRender,window.VersionCeleTabBtnItemRender=VersionCeleTabBtnItemRender,window.ArtifactControl=ArtifactControl,window.ArtifactVo=ArtifactVo,window.ArtifactAllAttrView=ArtifactAllAttrView,window.ArtifactChipOpenView=ArtifactChipOpenView,window.ArtifactPanel=ArtifactPanel,window.ArtifactSelectItemPanel=ArtifactSelectItemPanel,window.ArtifactTipsView=ArtifactTipsView,window.TargetView=TargetView,window.ArtifactAttrDescItemRenderer=ArtifactAttrDescItemRenderer,window.ArtifactChipItemRenderer=ArtifactChipItemRenderer,window.AshtarteControl=AshtarteControl,window.AshtarteForgeRedPoint=AshtarteForgeRedPoint,window.AshtarteVo=AshtarteVo,window.AshtarteDrugExtView=AshtarteDrugExtView,window.AshtarteEquipTipsView=AshtarteEquipTipsView,window.AshtarteForgeEquipView=AshtarteForgeEquipView,window.AshtarteItemTipsView=AshtarteItemTipsView,window.AshtartePanel=AshtartePanel,window.AshtarteSuitTipsView=AshtarteSuitTipsView,window.AshtarteView=AshtarteView,window.AshtarteEquipItemRenderer=AshtarteEquipItemRenderer,window.AshtarteIconItemRenderer=AshtarteIconItemRenderer,window.BackpackControl=BackpackControl,window.BackpackBuyGridView=BackpackBuyGridView,window.BackpackView=BackpackView,window.BargainControl=BargainControl,window.BargainRecordVo=BargainRecordVo,window.BargainVo=BargainVo,window.BargainInfoView=BargainInfoView,window.BargainItemChoiceView=BargainItemChoiceView,window.BargainQuotaTipView=BargainQuotaTipView,window.BargainRecordView=BargainRecordView,window.BargainView=BargainView,window.BargainWarnView=BargainWarnView,window.BargainItemRender=BargainItemRender,window.BargainRecordItemRender=BargainRecordItemRender,window.BeastControl=BeastControl,window.BeastRedPoint=BeastRedPoint,window.BeastEquipVo=BeastEquipVo,window.BeastVo=BeastVo,window.BeastDanUseView=BeastDanUseView,window.BeastEquipTipView=BeastEquipTipView,window.BeastForgeView=BeastForgeView,window.BeastInfoPanel=BeastInfoPanel,window.BeastPanel=BeastPanel,window.BeastSkillTipView=BeastSkillTipView,window.BeastWearEquipView=BeastWearEquipView,window.BeastEquip1ItemRenderer=BeastEquip1ItemRenderer,window.BeastEquipItemRenderer=BeastEquipItemRenderer,window.BeastTabItemRenderer=BeastTabItemRenderer,window.BeastWearEquipItemRenderer=BeastWearEquipItemRenderer,window.BlisterControl=BlisterControl,window.BlisterRankVo=BlisterRankVo,window.BlisterCurrenView=BlisterCurrenView,window.BlisterNpcTalkView=BlisterNpcTalkView,window.BlisterResultView=BlisterResultView,window.BlisterView=BlisterView,window.BlisterIconItemRenderer=BlisterIconItemRenderer,window.BlisterResultItemRenderer=BlisterResultItemRenderer,window.BookControl=BookControl,window.BookRedPoint=BookRedPoint,window.BooKVo=BooKVo,window.BookDanSelectView=BookDanSelectView,window.BookPanel=BookPanel,window.BookSuitTipsView=BookSuitTipsView,window.BookTipsView=BookTipsView,window.BookUpView=BookUpView,window.BreakDownView=BreakDownView,window.BookDanSelectItemRender=BookDanSelectItemRender,window.BookItemRenderer=BookItemRenderer,window.BookListItemRenderer=BookListItemRenderer,window.BookSuitTipsItemRenderer=BookSuitTipsItemRenderer,window.BossAutoChallengeControl=BossAutoChallengeControl,window.BossControl=BossControl,window.DarkMysteryBossControl=DarkMysteryBossControl,window.GodWeaponBossControl=GodWeaponBossControl,window.NewWorldBossRankVo=NewWorldBossRankVo,window.NewWorldBossVo=NewWorldBossVo,window.WorldBossItemVo=WorldBossItemVo,window.WorldBossRankItemVo=WorldBossRankItemVo,window.BossBelongView=BossBelongView,window.BossBloodView=BossBloodView,window.BossEndView=BossEndView,window.BossHomePanel=BossHomePanel,window.BossView=BossView,window.HideBossBtnView=HideBossBtnView,window.HideBossView=HideBossView,window.HolyAreaBossPanel=HolyAreaBossPanel,window.NewBossRewardTipView=NewBossRewardTipView,window.NewWorldBossUIView=NewWorldBossUIView,window.NewWorldBossView=NewWorldBossView,window.PersonalBossPanel=PersonalBossPanel,window.PublicBossPanel=PublicBossPanel,window.PublicBossRemindView=PublicBossRemindView,window.PublicBossRewardTipView=PublicBossRewardTipView,window.ShieldView=ShieldView,window.SpokesPersonBossFightView=SpokesPersonBossFightView,window.WorldBossBeKillView=WorldBossBeKillView,window.WorldBossCdView=WorldBossCdView,window.WorldBossPanel=WorldBossPanel,window.WorldBossRewardTipView=WorldBossRewardTipView,window.WorldBossRewardView=WorldBossRewardView,window.WorldBossUiInfoView=WorldBossUiInfoView,window.BossHomeItemRenderer=BossHomeItemRenderer,window.BossHomeTitleItemRenderer=BossHomeTitleItemRenderer,window.BossItemRenderer=BossItemRenderer,window.BossRewardsItemRenderer=BossRewardsItemRenderer,window.DarkBossRemindItemRenderer=DarkBossRemindItemRenderer,window.GodWeaponBossRemindItemRenderer=GodWeaponBossRemindItemRenderer,window.HomeBossRemindItemRenderer=HomeBossRemindItemRenderer,window.PersonalBossItemRenderer=PersonalBossItemRenderer,window.PublicBossRemindItemRenderer=PublicBossRemindItemRenderer,window.WorldBossHeadItemRender=WorldBossHeadItemRender,window.WorldBossItemRenderer=WorldBossItemRenderer,window.WorldBossMainItemRenderer=WorldBossMainItemRenderer,window.CalcForceControl=CalcForceControl,window.CalcForceVo=CalcForceVo,window.CalcForcePanel=CalcForcePanel,window.CampWarControl=CampWarControl,window.CampWarNpcTipView=CampWarNpcTipView,window.CampWarRankPanel=CampWarRankPanel,window.CampWarRankView=CampWarRankView,window.CampWarResultView=CampWarResultView,window.CampWarRewardPanel=CampWarRewardPanel,window.CampWarView=CampWarView,window.CampWarRankItemRenderer=CampWarRankItemRenderer,window.CampWarResultItemRenderer=CampWarResultItemRenderer,window.CampWarRewardItemRenderer=CampWarRewardItemRenderer,window.CampWarTargetItemRenderer=CampWarTargetItemRenderer,window.CampWarRankVo=CampWarRankVo,window.ConfrontControl=ConfrontControl,window.ConfrontFightControl=ConfrontFightControl,window.ConfrontModelVo=ConfrontModelVo,window.WildPlayerDataVo=WildPlayerDataVo,window.BuyRedNameView=BuyRedNameView,window.ConfrontPlayerInfoPanel=ConfrontPlayerInfoPanel,window.ConfrontRecordView=ConfrontRecordView,window.ConfrontRewardView=ConfrontRewardView,window.ConfrontInfoItemRender=ConfrontInfoItemRender,window.ConfrontRecordItemRender=ConfrontRecordItemRender,window.ConfrontRewardItemRender=ConfrontRewardItemRender,window.ChallengeCopyControl=ChallengeCopyControl,window.CopyBabelControl=CopyBabelControl,window.CopyControl=CopyControl,window.CopyHelpControl=CopyHelpControl,window.CopyRedPoint=CopyRedPoint,window.DailyCopyRedPoint=DailyCopyRedPoint,window.GuardControl=GuardControl,window.MonsterSpeakControl=MonsterSpeakControl,window.GuardCopyInfoVo=GuardCopyInfoVo,window.GuardCallBossView=GuardCallBossView,window.GuardMainUIView=GuardMainUIView,window.GuardQuitTipsView=GuardQuitTipsView,window.GuardRewardView=GuardRewardView,window.GuardWeaponPanel=GuardWeaponPanel,window.ShortcutCD=ShortcutCD,window.GuardLogsListItemRender=GuardLogsListItemRender,window.CopyHelpVo=CopyHelpVo,window.CopyModelVo=CopyModelVo,window.WaveDropDataVo=WaveDropDataVo,window.TeamCopyRoleVo=TeamCopyRoleVo,window.FriendListView=FriendListView,window.MemberInfoView=MemberInfoView,window.TeamCopyCheckRoleView=TeamCopyCheckRoleView,window.TeamCopyDescentPanel=TeamCopyDescentPanel,window.TeamCopyFightView=TeamCopyFightView,window.TeamCopyGuideView=TeamCopyGuideView,window.TeamCopyInviteView=TeamCopyInviteView,window.TeamCopyRoomView=TeamCopyRoomView,window.AssistantHeadItemRender=AssistantHeadItemRender,window.ChallengerHeadItemRender=ChallengerHeadItemRender,window.FriendItemRender=FriendItemRender,window.TeamCopyGuideItemRender=TeamCopyGuideItemRender,window.TeamCopyItemRender=TeamCopyItemRender,window.TeamCopyMemberItemRender=TeamCopyMemberItemRender,window.TeamCopyRankItemRender=TeamCopyRankItemRender,window.TeamCopyRoleItemRender=TeamCopyRoleItemRender,window.TeamCopyTargetItemRender=TeamCopyTargetItemRender,window.ChallengeDayRewardView=ChallengeDayRewardView,window.ChallengeInfoView=ChallengeInfoView,window.CopyBabelLotteryView=CopyBabelLotteryView,window.CopyBabelPanel=CopyBabelPanel,window.CopyChallengeRankView=CopyChallengeRankView,window.CopyCountDownView=CopyCountDownView,window.CopyExpPanel=CopyExpPanel,window.CopyGoldPanel=CopyGoldPanel,window.CopyView=CopyView,window.DemonCircleCopyPanel=DemonCircleCopyPanel,window.DemonCircleResultView=DemonCircleResultView,window.DemonSceneView=DemonSceneView,window.EveryDayCopyView=EveryDayCopyView,window.PlayWayPanel=PlayWayPanel,window.CopyChallengeRankItemRender=CopyChallengeRankItemRender,window.CopyDialPropItemRender=CopyDialPropItemRender,window.CopyItemRender=CopyItemRender,window.DailyCopyTabBtnItemRender=DailyCopyTabBtnItemRender,window.DemonCircleMonsterItemRender=DemonCircleMonsterItemRender,window.SkyItemRender=SkyItemRender,window.CrazyDogControl=CrazyDogControl,window.CrazyDogRedPoint=CrazyDogRedPoint,window.CrazyDogVo=CrazyDogVo,window.CrazyDogSkillTipsView=CrazyDogSkillTipsView,window.CrazyDogStarView=CrazyDogStarView,window.CrazyDogView=CrazyDogView,window.CrazyDogIconItemRenderer=CrazyDogIconItemRenderer,window.CrazyDogStarBtnItemRenderer=CrazyDogStarBtnItemRenderer,window.CrossArenaControl=CrossArenaControl,window.CrossArenaRedPoint=CrossArenaRedPoint,window.CrossArenaInviteVo=CrossArenaInviteVo,window.CrossArenaRankVo=CrossArenaRankVo,window.CrossArenaRoleVo=CrossArenaRoleVo,window.CrossArenaMarkVo=CrossArenaMarkVo,window.CrossArenaPeakAwards=CrossArenaPeakAwards,window.CrossArenaEveryDayAwards=CrossArenaEveryDayAwards,window.CrossArenaFinalAwards=CrossArenaFinalAwards,window.CrossArenaMailData=CrossArenaMailData,window.CrossArenaPeakInfo=CrossArenaPeakInfo,window.CrossArenaRankAwardInfo=CrossArenaRankAwardInfo,window.CrossArenaVo=CrossArenaVo,window.CrossArenaCheckView=CrossArenaCheckView,window.CrossArenaFightView=CrossArenaFightView,window.CrossArenaInfoView=CrossArenaInfoView,window.CrossArenaInviteView=CrossArenaInviteView,window.CrossArenaJoinPanel=CrossArenaJoinPanel,window.CrossArenaMacthPanel=CrossArenaMacthPanel,window.CrossArenaMetalRankView=CrossArenaMetalRankView,window.CrossArenaRankPanel=CrossArenaRankPanel,window.CrossArenaReceiveInviteView=CrossArenaReceiveInviteView,window.CrossArenaReConnectView=CrossArenaReConnectView,window.CrossArenaResultView=CrossArenaResultView,window.CrossArenaRewardPanel=CrossArenaRewardPanel,window.CrossArenaView=CrossArenaView,window.CrossArenaInfoItemRenderer=CrossArenaInfoItemRenderer,window.CrossArenaJoinItemRenderer=CrossArenaJoinItemRenderer,window.CrossArenaMemberItemRenderer=CrossArenaMemberItemRenderer,window.CrossArenaMetalRankItemRenderer=CrossArenaMetalRankItemRenderer,window.CrossArenaRankItemRenderer=CrossArenaRankItemRenderer,window.CrossArenaResultDataItemRenderer=CrossArenaResultDataItemRenderer,window.CrossArenaRewardItemRenderer=CrossArenaRewardItemRenderer,window.CrossArenaRoleItemRenderer=CrossArenaRoleItemRenderer,window.CrossArenaTabItemRenderer=CrossArenaTabItemRenderer,window.CrossArenaTeamItemRenderer=CrossArenaTeamItemRenderer,window.CrossBossControl=CrossBossControl,window.CrossBossRedpoint=CrossBossRedpoint,window.CrossBossInfoVo=CrossBossInfoVo,window.CrossBossReliveView=CrossBossReliveView,window.CrossBossResultView=CrossBossResultView,window.CrossBossSceneView=CrossBossSceneView,window.CrossBossShowView=CrossBossShowView,window.CrossBossView=CrossBossView,window.CrossMutationBossPanel=CrossMutationBossPanel,window.CrossNormalBossPanel=CrossNormalBossPanel,window.CrossCollectView=CrossCollectView,window.CrossReliveView=CrossReliveView,window.CrossSmallMapView=CrossSmallMapView,window.DarkHallBossControl=DarkHallBossControl,window.DarkHallBossRedPoint=DarkHallBossRedPoint,window.DarkHallBossView=DarkHallBossView,window.DarkHallBossHeadItemRenderer=DarkHallBossHeadItemRenderer,window.DarkHallBossItemRenderer=DarkHallBossItemRenderer,window.DevildomControl=DevildomControl,window.DevildomFinalControl=DevildomFinalControl,window.DevildomRedPoint=DevildomRedPoint,window.DevildomGuildVo=DevildomGuildVo,window.DevildomBelongAwardView=DevildomBelongAwardView,window.DevildomBossAwardView=DevildomBossAwardView,window.DevildomFightInfoView=DevildomFightInfoView,window.DevildomFinalAwardView=DevildomFinalAwardView,window.DevildomFinalPanel=DevildomFinalPanel,window.DevildomFinalResultView=DevildomFinalResultView,window.DevildomGuildMembersView=DevildomGuildMembersView,window.DevildomPanel=DevildomPanel,window.DevildomPartAwardView=DevildomPartAwardView,window.DevildomRankView=DevildomRankView,window.DevildomReliveView=DevildomReliveView,window.DevildomResultView=DevildomResultView,window.DevildomView=DevildomView,window.DevildomBossItemRenderer=DevildomBossItemRenderer,window.DevildomGuildMembersItemRenderer=DevildomGuildMembersItemRenderer,window.DevildomRankItemRenderer=DevildomRankItemRenderer,window.DominateBossControl=DominateBossControl,window.DominateBossRedpoint=DominateBossRedpoint,window.DominateBossRemindView=DominateBossRemindView,window.DominateBossView=DominateBossView,window.DominateBossItemRenderer=DominateBossItemRenderer,window.DominateBossRemindItemRenderer=DominateBossRemindItemRenderer,window.CrossFieldControl=CrossFieldControl,window.CrossFieldRedPoint=CrossFieldRedPoint,window.CrossDropRecordVo=CrossDropRecordVo,window.CrossFieldPanel=CrossFieldPanel,window.CrossFieldRecordPanel=CrossFieldRecordPanel,window.CrossFieldView=CrossFieldView,window.CrossFieldRecordItemRederer=CrossFieldRecordItemRederer,window.HatredControl=HatredControl,window.HatredRedpoint=HatredRedpoint,window.HatredMessageVo=HatredMessageVo,window.HatredVo=HatredVo,window.HatredMessagePanel=HatredMessagePanel,window.HatredPanel=HatredPanel,window.HatredReminView=HatredReminView,window.HatredResultView=HatredResultView,window.HatredThankView=HatredThankView,window.HatredView=HatredView,window.HatredItemRenderer=HatredItemRenderer,window.HatredMessageItemRenderer=HatredMessageItemRenderer,window.HatredReminItemRenderer=HatredReminItemRenderer,window.PeakedControl=PeakedControl,window.PeakedRedpoint=PeakedRedpoint,window.PeakedHelp=PeakedHelp,window.PeakedBattleReportVo=PeakedBattleReportVo,window.PeakedBetVo=PeakedBetVo,window.PeakedKonckReportVo=PeakedKonckReportVo,window.PeakedPlayerInfoVo=PeakedPlayerInfoVo,window.PeakedPlayerVo=PeakedPlayerVo,window.PeakedTopRankVo=PeakedTopRankVo,window.PeakedVo=PeakedVo,window.PeakedAwardPanel=PeakedAwardPanel,window.PeakedBetView=PeakedBetView,window.PeakedChipMallPanel=PeakedChipMallPanel,window.PeakedDunResultView=PeakedDunResultView,window.PeakedEnterPanel=PeakedEnterPanel,window.PeakedMainView=PeakedMainView,window.PeakedMallPanel=PeakedMallPanel,window.PeakedMyBattleRecordView=PeakedMyBattleRecordView,window.PeakedMyBetRecordView=PeakedMyBetRecordView,window.PeakedSignUpPanel=PeakedSignUpPanel,window.PeakedSixteenPanel=PeakedSixteenPanel,window.PeakedTopRankView=PeakedTopRankView,window.PeakedWorshipChampionPanel=PeakedWorshipChampionPanel,window.PeakViewBattleReportView=PeakViewBattleReportView,window.PeakedAwardItemRenderer=PeakedAwardItemRenderer,window.PeakedKnockoutItemItemRenderer=PeakedKnockoutItemItemRenderer,window.PeakedMyBattleRecordItemRenderer=PeakedMyBattleRecordItemRenderer,window.PeakedMyBetItemRenderer=PeakedMyBetItemRenderer,window.PeakedTopRankItemRenderer=PeakedTopRankItemRenderer,window.PeakedViewBattleReportItemRender=PeakedViewBattleReportItemRender,window.FindPathMgr=FindPathMgr,window.TotemBossControl=TotemBossControl,window.TotemBossRedpoint=TotemBossRedpoint,window.TotemBossSceneControl=TotemBossSceneControl,window.TotemBossPanel=TotemBossPanel,window.TotemBossRemindView=TotemBossRemindView,window.TotemBossSceneMapView=TotemBossSceneMapView,window.TotemBossShowAwardView=TotemBossShowAwardView,window.TotemBossItemRender=TotemBossItemRender,window.TotemBossMapItemRender=TotemBossMapItemRender,window.TotemBossRemindItemRender=TotemBossRemindItemRender,window.TotemBossTabItemRender=TotemBossTabItemRender,window.DaifugControl=DaifugControl,window.DaifugEnterView=DaifugEnterView,window.DaifugPanel=DaifugPanel,window.DaifugRole=DaifugRole,window.DaifugTipsView=DaifugTipsView,window.DaifugItemRender=DaifugItemRender,window.DarkEquipControl=DarkEquipControl,window.DarkEquipRedPoint=DarkEquipRedPoint,window.DarkEquipDataVo=DarkEquipDataVo,window.DarkListMenuItemVo=DarkListMenuItemVo,window.DarkSuitDataVo=DarkSuitDataVo,window.SuitItemVo=SuitItemVo,window.DarkEquipAttrTipView=DarkEquipAttrTipView,window.DarkEquipComposePanel=DarkEquipComposePanel,window.DarkEquipDrugTipsView=DarkEquipDrugTipsView,window.DarkEquipForceTipView=DarkEquipForceTipView,window.DarkEquipForgeView=DarkEquipForgeView,window.DarkEquipOtherView=DarkEquipOtherView,window.DarkEquipPanel=DarkEquipPanel,window.DarkEquipSuitPreView=DarkEquipSuitPreView,window.DarkEquipTipsView=DarkEquipTipsView,window.DarkEquipView=DarkEquipView,window.DarkEquipWearEquipView=DarkEquipWearEquipView,window.DarkDrugItemRenderer=DarkDrugItemRenderer,window.DarkEquipItemRenderer=DarkEquipItemRenderer,window.DarkEquipSmeltItemRenderer=DarkEquipSmeltItemRenderer,window.DarkEquipSuitItemRenderer=DarkEquipSuitItemRenderer,window.DarkEquipUpList2ItemRenderer=DarkEquipUpList2ItemRenderer,window.DarkEquipUpListItemRenderer=DarkEquipUpListItemRenderer,window.DarkEquipWearItemRenderer=DarkEquipWearItemRenderer,window.DeityBreakDownView=DeityBreakDownView,window.DeityEquipPanel=DeityEquipPanel,window.DeityEquipView=DeityEquipView,window.ZealEquipPanel=ZealEquipPanel,window.DeityBreakDownItemRenderer=DeityBreakDownItemRenderer,window.DevourEquipContorl=DevourEquipContorl,window.DevourEquipRedPoint=DevourEquipRedPoint,window.DevourEquipInfoVo=DevourEquipInfoVo,window.DevourEquipItemDataVo=DevourEquipItemDataVo,window.DevourEquipSoulInfoVo=DevourEquipSoulInfoVo,window.DevourEquipAttrTipsView=DevourEquipAttrTipsView,window.DevourEquipFusionView=DevourEquipFusionView,window.DevourEquipPanel=DevourEquipPanel,window.DevourEquipRefiningPanel=DevourEquipRefiningPanel,window.DevourEquipSkillView=DevourEquipSkillView,window.DevourEquipSuitSkillView=DevourEquipSuitSkillView,window.DevourEquipTipsView=DevourEquipTipsView,window.DevourEquipView=DevourEquipView,window.DevourFinishView=DevourFinishView,window.DevourSkillNoticeView=DevourSkillNoticeView,window.DevourWarnView=DevourWarnView,window.ImgChipsUtils=ImgChipsUtils,window.SkillShowComponent=SkillShowComponent,window.DevourEquipBarItemRender=DevourEquipBarItemRender,window.DevourEquipBossItemRender=DevourEquipBossItemRender,window.DevourEquipItemRender=DevourEquipItemRender,window.DevourEquipUpItemRender=DevourEquipUpItemRender,window.DominateControl=DominateControl,window.DominateEquipControl=DominateEquipControl,window.DominateEquipRedPoint=DominateEquipRedPoint,window.DominateRedpoint=DominateRedpoint,window.DominateVo=DominateVo,window.DominateChooseView=DominateChooseView,window.DominateComposeView=DominateComposeView,window.DominateEquipChangeView=DominateEquipChangeView,window.DominateEquipComposeView=DominateEquipComposeView,window.DominateEquipPanel=DominateEquipPanel,window.DominateEquipResolvePanel=DominateEquipResolvePanel,window.DominateEquipSelectView=DominateEquipSelectView,window.DominateEquipSkillTipsView=DominateEquipSkillTipsView,window.DominateEquipTakeTipsView=DominateEquipTakeTipsView,window.DominateEquipTipsView=DominateEquipTipsView,window.DominateTakeTipsView=DominateTakeTipsView,window.DominateTipsView=DominateTipsView,window.DominateUpgradeView=DominateUpgradeView,window.DominateChangeItemRenderer=DominateChangeItemRenderer,window.DominateEquipItemRender=DominateEquipItemRender,window.DominateMixItemRenderer=DominateMixItemRenderer,window.DominateSelectItemRenderer=DominateSelectItemRenderer,window.DominateSkillItemRenderer=DominateSkillItemRenderer,window.DominateTrinkChItemRenderer=DominateTrinkChItemRenderer,window.DominateTrinkItemRenderer=DominateTrinkItemRenderer,window.DragonSoulControl=DragonSoulControl,window.ExperienceJadeNewControl=ExperienceJadeNewControl,window.DragonSoulDataVo=DragonSoulDataVo,window.DragonSoulItemDataVo=DragonSoulItemDataVo,window.DragonSoulItemDecomposeItemDataVo=DragonSoulItemDecomposeItemDataVo,window.JadeDataNewVo=JadeDataNewVo,window.CimeliaView=CimeliaView,window.DragonSoulEquipPreviewTipsView=DragonSoulEquipPreviewTipsView,window.DragonSoulEquipSkillTipsView=DragonSoulEquipSkillTipsView,window.DragonSoulItemAttrView=DragonSoulItemAttrView,window.DragonSoulItemDecomposeView=DragonSoulItemDecomposeView,window.DragonSoulItemTipsPreviewView=DragonSoulItemTipsPreviewView,window.DragonSoulItemTipsView=DragonSoulItemTipsView,window.DragonSoulPanel=DragonSoulPanel,window.DragonSoulItemDecomposeItemRender=DragonSoulItemDecomposeItemRender,window.DragonSoulItemDisplayItemRender=DragonSoulItemDisplayItemRender,window.DragonSoulItemRender=DragonSoulItemRender,window.ExperienceJadeMainPanel=ExperienceJadeMainPanel,window.ExperienceJadeSkillTipsView=ExperienceJadeSkillTipsView,window.ExperienceJadeUpTipsView=ExperienceJadeUpTipsView,window.EsotericaControl=EsotericaControl,window.EsotericaVo=EsotericaVo,window.EsotericaExchangeView=EsotericaExchangeView,window.EsotericaGainTipsView=EsotericaGainTipsView,window.EsotericaLearnView=EsotericaLearnView,window.EsotericaLockView=EsotericaLockView,window.EsotericaLookView=EsotericaLookView,window.EsotericaPanel=EsotericaPanel,window.EsotericaPhotoView=EsotericaPhotoView,window.EsotericaTipView=EsotericaTipView,window.EsotericaExItemRenderer=EsotericaExItemRenderer,window.EsotericaItemRenderer=EsotericaItemRenderer,window.EsotericaLearnItemRenderer=EsotericaLearnItemRenderer,window.EsotericaLookItemRenderer=EsotericaLookItemRenderer,window.ExperienceControl=ExperienceControl,window.ExperienceJadePanel=ExperienceJadePanel,window.ExperienceJadeSkillView=ExperienceJadeSkillView,window.ExperienceKnighthoodPanel=ExperienceKnighthoodPanel,window.ExperienceMedalPanel=ExperienceMedalPanel,window.ExperienceView=ExperienceView,window.ExperienceItemRenderer=ExperienceItemRenderer,window.ExperienceJadeItemRenderer=ExperienceJadeItemRenderer,window.ExperienceMedalAttrItemRenderer=ExperienceMedalAttrItemRenderer,window.ExperienceMedalTaskItemRenderer=ExperienceMedalTaskItemRenderer,window.FashionControl=FashionControl,window.FashionItemVo=FashionItemVo,window.FashionPosVo=FashionPosVo,window.FashionTimeVo=FashionTimeVo,window.FashionView=FashionView,window.FashionItemRenderer=FashionItemRenderer,window.FocusAttackControl=FocusAttackControl,window.FocusAwakeRedPoint=FocusAwakeRedPoint,window.FocusAttackProgressVo=FocusAttackProgressVo,window.FocusAttackAttrView=FocusAttackAttrView,window.FocusAttackChooseView=FocusAttackChooseView,window.FocusAttackDetailView=FocusAttackDetailView,window.FocusAttackExchangeView=FocusAttackExchangeView,window.FocusAttackForgePanel=FocusAttackForgePanel,window.FocusAttackPanel=FocusAttackPanel,window.FocusAttackResView=FocusAttackResView,window.FocusAttackShowView=FocusAttackShowView,window.FocusAttackSkillTipsView=FocusAttackSkillTipsView,window.FocusAttackTransformView=FocusAttackTransformView,window.FocusAwakeAttsView=FocusAwakeAttsView,window.FocusAwakeMaterialTips2View=FocusAwakeMaterialTips2View,window.FocusAwakeMaterialTipsView=FocusAwakeMaterialTipsView,window.FocusAwakePanel=FocusAwakePanel,window.FocusAwakeSuitTipsView=FocusAwakeSuitTipsView,window.FocusAwakeView=FocusAwakeView,window.FocusAttackBaseItemRenderer=FocusAttackBaseItemRenderer,window.FocusAttackExchangeBtnItemRenderer=FocusAttackExchangeBtnItemRenderer,window.FocusAttackExchangeItemRenderer=FocusAttackExchangeItemRenderer,window.FocusAttackItemRenderer=FocusAttackItemRenderer,window.FocusAttackListItemRenderer=FocusAttackListItemRenderer,window.FocusAttackSkillItemRenderer=FocusAttackSkillItemRenderer,window.FocusAwakeEquipItemRenderer=FocusAwakeEquipItemRenderer,window.MainScene=MainScene,window.TargetListControl=TargetListControl,window.TargetListView=TargetListView,window.TargetPlayerBigBloodView=TargetPlayerBigBloodView,window.TargetActedHeadItemRender=TargetActedHeadItemRender,window.TargetActHeadItemRender=TargetActHeadItemRender,window.TargetCanActHeadItemRender=TargetCanActHeadItemRender,window.TargetMemberHeadItemRender=TargetMemberHeadItemRender,window.GameBlackView=GameBlackView,window.GameBottomView=GameBottomView,window.GameKillInfoView=GameKillInfoView,window.GameSceneView=GameSceneView,window.GodWeaponControl=GodWeaponControl,window.GodWeaponItemControl=GodWeaponItemControl,window.GodWeaponRedPoint=GodWeaponRedPoint,window.GodWeaponDunFloorVo=GodWeaponDunFloorVo,window.GodWeaponDunShowItemVo=GodWeaponDunShowItemVo,window.GodWeaponDunVo=GodWeaponDunVo,window.GodWeaponItemVo=GodWeaponItemVo,window.GodWeaponRankInfoVo=GodWeaponRankInfoVo,window.GodWeaponRelicItemVo=GodWeaponRelicItemVo,window.GodWeaponSkillVo=GodWeaponSkillVo,window.GodWeaponTaskVo=GodWeaponTaskVo,window.GodWeaponVo=GodWeaponVo,window.GodWeaponAddAttrView=GodWeaponAddAttrView,window.GodWeaponBossChallengeView=GodWeaponBossChallengeView,window.GodWeaponBossPanel=GodWeaponBossPanel,window.GodWeaponDunPanel=GodWeaponDunPanel,window.GodWeaponDunRankView=GodWeaponDunRankView,window.GodWeaponDunRiseUpView=GodWeaponDunRiseUpView,window.GodWeaponItemMixPanel=GodWeaponItemMixPanel,window.GodWeaponPanel=GodWeaponPanel,window.GodWeaponRelicChooseView=GodWeaponRelicChooseView,window.GodWeaponRelicItem=GodWeaponRelicItem,window.GodWeaponResetView=GodWeaponResetView,window.GodWeaponResultView=GodWeaponResultView,window.GodWeaponSkillIcon=GodWeaponSkillIcon,window.GodWeaponSkillPanel=GodWeaponSkillPanel,window.GodWeaponSkillTipView=GodWeaponSkillTipView,window.GodWeaponTaskPanel=GodWeaponTaskPanel,window.GodWeaponView=GodWeaponView,window.GodWeaponAddAttrItemRenderer=GodWeaponAddAttrItemRenderer,window.GodWeaponChooseRelicItemRenderer=GodWeaponChooseRelicItemRenderer,window.GodWeaponRelicItemIcon=GodWeaponRelicItemIcon,window.GodWeaponDunItemRenderer=GodWeaponDunItemRenderer,window.GodWeaponDunRankItemRender=GodWeaponDunRankItemRender,window.GodWeaponDunRewardItemRenderer=GodWeaponDunRewardItemRenderer,window.GodWeaponDunShowItemRenderer=GodWeaponDunShowItemRenderer,window.GodWeaponMixItemRenderer=GodWeaponMixItemRenderer,window.HeartMethodControl=HeartMethodControl,window.HeartMethodRedPoint=HeartMethodRedPoint,window.HeartMethodDecomposeItemVo=HeartMethodDecomposeItemVo,window.HeartMethodVo=HeartMethodVo,window.HeartTypeVo=HeartTypeVo,window.HeartMethodAttrView=HeartMethodAttrView,window.HeartMethodDecomposeView=HeartMethodDecomposeView,window.HeartMethodPanel=HeartMethodPanel,window.HeartMethodSkillTipsView=HeartMethodSkillTipsView,window.HeartMethodTipsView=HeartMethodTipsView,window.HeartMethodDecomposeItemRenderer=HeartMethodDecomposeItemRenderer,window.HeartMethodDisplayItemRenderer=HeartMethodDisplayItemRenderer,window.HeartMethodItemRenderer=HeartMethodItemRenderer,window.HeirloomControl=HeirloomControl,window.HeirloomRedPoint=HeirloomRedPoint,window.CrazybtplayControl=CrazybtplayControl,window.CrazybtplayCopyControl=CrazybtplayCopyControl,window.CrazybtplayCopyRedPoint=CrazybtplayCopyRedPoint,window.CrazybtplayRedPoint=CrazybtplayRedPoint,window.CrazybtplayDataVo=CrazybtplayDataVo,window.CrazybtplayBossTipView=CrazybtplayBossTipView,window.CrazybtplayCopyFightView=CrazybtplayCopyFightView,window.CrazybtplayForbiddenPanel=CrazybtplayForbiddenPanel,window.CrazybtplayPanel=CrazybtplayPanel,window.ShenWuListMenuItem=ShenWuListMenuItem,window.CrazybtplaySkillTipsView=CrazybtplaySkillTipsView,window.CrazybtplayTalentTipsView=CrazybtplayTalentTipsView,window.CrazybtplayTipView=CrazybtplayTipView,window.CrazybtplayUpLvView=CrazybtplayUpLvView,window.CrazybtplayBossItemRender=CrazybtplayBossItemRender,window.CrazybtplayListItem2Render=CrazybtplayListItem2Render,window.CrazybtplayListItemRender=CrazybtplayListItemRender,window.CrazybtplayTipSkillItemRender=CrazybtplayTipSkillItemRender,window.CrazybtplayUpBtnItemRender=CrazybtplayUpBtnItemRender,window.HeirloomDressVo=HeirloomDressVo,window.HeirloomSlotVo=HeirloomSlotVo,window.HeirloomVo=HeirloomVo,window.TotemControl=TotemControl,window.TotemRedPoint=TotemRedPoint,window.TotemVo=TotemVo,window.TotemInfoShowPanel=TotemInfoShowPanel,window.TotemIntroTipsShowView=TotemIntroTipsShowView,window.TotemSkillTipsShowView=TotemSkillTipsShowView,window.TotemPieceShowItemRender=TotemPieceShowItemRender,window.TotembagTipsView=TotembagTipsView,window.TotemChangeView=TotemChangeView,window.TotemEquipShowTipsView=TotemEquipShowTipsView,window.TotemExhibitionTipsView=TotemExhibitionTipsView,window.TotemForgeView=TotemForgeView,window.TotemInfoPanel=TotemInfoPanel,window.TotemLvUpView=TotemLvUpView,window.TotemOtherInfoView=TotemOtherInfoView,window.TotemPanel=TotemPanel,window.TotemSkillTipsView=TotemSkillTipsView,window.TotemSuitTipsView=TotemSuitTipsView,window.TotemChangeItemRender=TotemChangeItemRender,window.TotemItemRender=TotemItemRender,window.TotemNameItemRender=TotemNameItemRender,window.TotemPieceItemRender=TotemPieceItemRender,window.TotemShowItemRender=TotemShowItemRender,window.TotemSkillTipsItemRender=TotemSkillTipsItemRender,window.TotemSuitItemRender=TotemSuitItemRender,window.HeirloomComposeView=HeirloomComposeView,window.HeirloomDownView=HeirloomDownView,window.HeirloomDressView=HeirloomDressView,window.HeirloomEquipTipsView=HeirloomEquipTipsView,window.HeirloomPanel=HeirloomPanel,window.HeirloomSkillTipView=HeirloomSkillTipView,window.HeirloomSuitView=HeirloomSuitView,window.HeirloomView=HeirloomView,window.HeirloomDownItemRenderer=HeirloomDownItemRenderer,window.HeirloomDressItemRenderer=HeirloomDressItemRenderer,window.HeirloomItemIconRenderer=HeirloomItemIconRenderer,window.HeirloomItemRenderer=HeirloomItemRenderer,window.ForgeControl=ForgeControl,window.IntensifyControl=IntensifyControl,window.IntensifyRedPoint=IntensifyRedPoint,window.RefineControl=RefineControl,window.EquipUpgrateChooseView=EquipUpgrateChooseView,window.ForgePanel=ForgePanel,window.IntensifyPanel=IntensifyPanel,window.IntensifyView=IntensifyView,window.ItemDirUpLvPanel=ItemDirUpLvPanel,window.RefinePanel=RefinePanel,window.EquipUpgrateChooseItemRender=EquipUpgrateChooseItemRender,window.RefineItemRender=RefineItemRender,window.LadderControl=LadderControl,window.PlayWayRedPoint=PlayWayRedPoint,window.LadderChallengeView=LadderChallengeView,window.LadderInfoPanel=LadderInfoPanel,window.LadderRankView=LadderRankView,window.LadderRewardShowView=LadderRewardShowView,window.LadderStarListPanel=LadderStarListPanel,window.LadderView=LadderView,window.LadderRankItemRenderer=LadderRankItemRenderer,window.LadderRewardItemRenderer=LadderRewardItemRenderer,window.LadderStarItemRenderer=LadderStarItemRenderer,window.MagicCircleControl=MagicCircleControl,window.MagicCircleRoleVo=MagicCircleRoleVo,window.MagicCircleVo=MagicCircleVo,window.MagicCircleAbilityTipsView=MagicCircleAbilityTipsView,window.MagicCircleListPanel=MagicCircleListPanel,window.MagicCircleMainView=MagicCircleMainView,window.MagicCirclePanel=MagicCirclePanel,window.MagicCirclePotentialPanel=MagicCirclePotentialPanel,window.MagicCircleSkillActivatedTipsView=MagicCircleSkillActivatedTipsView,window.MagicCircleSkillTipsView=MagicCircleSkillTipsView,window.MagicCircleSpecialCharacterTipsView=MagicCircleSpecialCharacterTipsView,window.MagicCircleTaskPanel=MagicCircleTaskPanel,window.MagicCircleTaskRewardView=MagicCircleTaskRewardView,window.MagicCircleTaskTriggerView=MagicCircleTaskTriggerView,window.MagicCircleListItemRenderer=MagicCircleListItemRenderer,window.MagicCirclePotentialItemRenderer=MagicCirclePotentialItemRenderer,window.MagicCircleSkillItemRenderer=MagicCircleSkillItemRenderer,window.MagicCircleTaskItemIcon=MagicCircleTaskItemIcon,window.MineControl=MineControl,window.MineRedPoint=MineRedPoint,window.MineHelpVo=MineHelpVo,window.MineRecordVo=MineRecordVo,window.MineRobVo=MineRobVo,window.MineSceneInfoVo=MineSceneInfoVo,window.MineChoseWorkerView=MineChoseWorkerView,window.MineFinishOutsideView=MineFinishOutsideView,window.MineHelpResultView=MineHelpResultView,window.MinePanel=MinePanel,window.MinePlunderPanel=MinePlunderPanel,window.MinePlunderView=MinePlunderView,window.MineRecordPanel=MineRecordPanel,window.MineResultView=MineResultView,window.MineRobView=MineRobView,window.MineSceneView=MineSceneView,window.MineChoseWorkerItemRenderer=MineChoseWorkerItemRenderer,window.MineDoneRecordItemRenderer=MineDoneRecordItemRenderer,window.MinePlunderItemRenderer=MinePlunderItemRenderer,window.MineRecordItemRenderer=MineRecordItemRenderer,window.NoticeControl=NoticeControl,window.MarqueeView=MarqueeView,window.NoticeView=NoticeView,window.PartnerControl=PartnerControl,window.PartnerVo=PartnerVo,window.ChatData=ChatData,window.PartnerAddListPanel=PartnerAddListPanel,window.PartnerAddView=PartnerAddView,window.PartnerBgView=PartnerBgView,window.PartnerBlackListPanel=PartnerBlackListPanel,window.PartnerChatPanel=PartnerChatPanel,window.PartnerListPanel=PartnerListPanel,window.PartnerAppListItemRenderer=PartnerAppListItemRenderer,window.PartnerBlackListItemRenderer=PartnerBlackListItemRenderer,window.PartnerChatItemRenderer=PartnerChatItemRenderer,window.PartnerHeadItemRenderer=PartnerHeadItemRenderer,window.PartnerListItemRenderer=PartnerListItemRenderer,window.PartnerRecentListItemRenderer=PartnerRecentListItemRenderer,window.PayControl=PayControl,window.PayDailyGetExtraView=PayDailyGetExtraView,window.PayDailyView=PayDailyView,window.PayFirstView=PayFirstView,window.PayLimitView=PayLimitView,window.PayOneView=PayOneView,window.PaySaleView=PaySaleView,window.PayView=PayView,window.BtnTab8ItemRender=BtnTab8ItemRender,window.PayDailyGetExtraItemRender=PayDailyGetExtraItemRender,window.PayFirstItemRenderer=PayFirstItemRenderer,window.PayItemRenderer=PayItemRenderer,window.PayLimitItemRenderer=PayLimitItemRenderer,window.PieceControl=PieceControl,window.PiecePanel=PiecePanel,window.PieceMenuItemRender=PieceMenuItemRender,window.PieceSecMenuItemRenderer=PieceSecMenuItemRenderer,window.PortalShow=PortalShow,window.PortalControl=PortalControl,window.AmusementAthleticsPortalIcon=AmusementAthleticsPortalIcon,window.AmusementOpenServerPortalIcon=AmusementOpenServerPortalIcon,window.AmusementTotalEnterPortalIcon=AmusementTotalEnterPortalIcon,window.AmusementUniversalPortalIcon=AmusementUniversalPortalIcon,window.ArtifactPortalIcon=ArtifactPortalIcon,window.AshtartePortalIcon=AshtartePortalIcon,window.BargainPortalIcon=BargainPortalIcon,window.BasePortalIcon=BasePortalIcon,window.BossPortalIcon=BossPortalIcon,window.BullyingServerPortalIcon=BullyingServerPortalIcon,window.CbtestAmusementPortalIcon=CbtestAmusementPortalIcon,window.CDkeyPortalIcon=CDkeyPortalIcon,window.CopyPortalIcon=CopyPortalIcon,window.CrazyDogPortalIcon=CrazyDogPortalIcon,window.CrossArenaPortalIcon=CrossArenaPortalIcon,window.CrossFieldPortalIcon=CrossFieldPortalIcon,window.DailyRedBagPortalIcon=DailyRedBagPortalIcon,window.DesktopPortalIcon=DesktopPortalIcon,window.DirectShop1PortalIcon=DirectShop1PortalIcon,window.DirectShopPortalIcon=DirectShopPortalIcon,window.DoubleTwelvePortalIcon=DoubleTwelvePortalIcon,window.DoubleTwelveRechargePortalIcon=DoubleTwelveRechargePortalIcon,window.DownloadPortalIcon=DownloadPortalIcon,window.EmailPortalIcon=EmailPortalIcon,window.FBGiftPortalIcon=FBGiftPortalIcon,window.FBRatePortalIcon=FBRatePortalIcon,window.FireRingPortalIcon=FireRingPortalIcon,window.FocusAttackPortalIcon=FocusAttackPortalIcon,window.FocusGamePortalIcon=FocusGamePortalIcon,window.FuncNoticePortalIcon=FuncNoticePortalIcon,window.GodWeaponPortalIcon=GodWeaponPortalIcon,window.HappySevenDayPortalIcon=HappySevenDayPortalIcon,window.HeirloomPortalIcon=HeirloomPortalIcon,window.IntensifyPortalIcon=IntensifyPortalIcon,window.InvestmentPortalIcon=InvestmentPortalIcon,window.InviteFriendsBtnPortalIcon=InviteFriendsBtnPortalIcon,window.InviteFriendsPortalIcon=InviteFriendsPortalIcon,window.LadderBattlePortalIcon=LadderBattlePortalIcon,window.LadderBtnPortalIcon=LadderBtnPortalIcon,window.LadderPDPortalIcon=LadderPDPortalIcon,window.LeasePortalIcon=LeasePortalIcon,window.LevelGiftPortalIcon=LevelGiftPortalIcon,window.LimitTaskPortalIcon=LimitTaskPortalIcon,window.LvTimeLimitGiftTipsPortalIcon=LvTimeLimitGiftTipsPortalIcon,window.MergeServerAmusementPortalIcon=MergeServerAmusementPortalIcon,window.MerryshopPortalIcon=MerryshopPortalIcon,window.MiniAccountJumpPortalIcon=MiniAccountJumpPortalIcon,window.MonthCardPortalIcon=MonthCardPortalIcon,window.NationalDayAmusementPortalIcon=NationalDayAmusementPortalIcon,window.NewWorldBossPortalIcon=NewWorldBossPortalIcon,window.OnlineQuizPortalIcon=OnlineQuizPortalIcon,window.PartnerBgPortalIcon=PartnerBgPortalIcon,window.PayDailyGetExtraPortalIcon=PayDailyGetExtraPortalIcon,window.PayFirstPortalIcon=PayFirstPortalIcon,window.PayLimitPortalIcon=PayLimitPortalIcon,window.PayOnePortalIcon=PayOnePortalIcon,window.PaySalePortalIcon=PaySalePortalIcon,window.PeakedMainPortalIcon=PeakedMainPortalIcon,window.PeriodBossPortalIcon=PeriodBossPortalIcon,window.PortalBase=PortalBase,window.RamblePortalIcon=RamblePortalIcon,window.RankingPortalIcon=RankingPortalIcon,window.RecruitPortalIcon=RecruitPortalIcon,window.RedBagPortalIcon=RedBagPortalIcon,window.RedbagRainPortalIcon=RedbagRainPortalIcon,window.RewardWingPortalIcon=RewardWingPortalIcon,window.RunePortalIcon=RunePortalIcon,window.SealPvePortalIcon=SealPvePortalIcon,window.SeckillGiftAmusePortalIcon=SeckillGiftAmusePortalIcon,window.SevenDayPortalIcon=SevenDayPortalIcon,window.ShareGamePortalIcon=ShareGamePortalIcon,window.SpokesBossPortalIcon=SpokesBossPortalIcon,window.SpokesmanPortalIcon=SpokesmanPortalIcon,window.SpokesmanTaskPortalIcon=SpokesmanTaskPortalIcon,window.SpringEightDayPortalIcon=SpringEightDayPortalIcon,window.StorePortalIcon=StorePortalIcon,window.SuicideLimitBuyTipsPortalIcon=SuicideLimitBuyTipsPortalIcon,window.SuperVipPortalIcon=SuperVipPortalIcon,window.TaskTracePortalIcon=TaskTracePortalIcon,window.ToseongBossPortalIcon=ToseongBossPortalIcon,window.ToseongPortalIcon=ToseongPortalIcon,window.TotalRecharge55PortalIcon=TotalRecharge55PortalIcon,window.TotalRechargePortalIcon=TotalRechargePortalIcon,window.TrailerPortalIcon=TrailerPortalIcon,window.TreasureBasin2PortalIcon=TreasureBasin2PortalIcon,window.TreasureBasinPortalIcon=TreasureBasinPortalIcon,window.TreasureHuntPortalIcon=TreasureHuntPortalIcon,window.UnionApplyPortalIcon=UnionApplyPortalIcon,window.UnionWarMainPortalIcon=UnionWarMainPortalIcon,window.UnlimitedAmusementPortalIcon=UnlimitedAmusementPortalIcon,window.Vip3MBPortalIcon=Vip3MBPortalIcon,window.Vip3PortalIcon=Vip3PortalIcon,window.VipGiftPortalIcon=VipGiftPortalIcon,window.VouchersPortalIcon=VouchersPortalIcon,window.WarriorTaskPortalIcon=WarriorTaskPortalIcon,window.PortalView=PortalView,window.PrestigeControl=PrestigeControl,window.PrestigeOverView=PrestigeOverView,window.PrestigePanel=PrestigePanel,window.PrestigeTitleTipsView=PrestigeTitleTipsView,window.PrestigeItemRenderer=PrestigeItemRenderer,window.RankControl=RankControl,window.RankModel=RankModel,window.RankOtherUserControl=RankOtherUserControl,window.OtherPlayerData=OtherPlayerData,window.RankDataBaseVo=RankDataBaseVo,window.RankDataBookVo=RankDataBookVo,window.RankDataCastVo=RankDataCastVo,window.RankDataCopyVo=RankDataCopyVo,window.RankDataDragonVo=RankDataDragonVo,window.RankDataJobDsVo=RankDataJobDsVo,window.RankDataJobFsVo=RankDataJobFsVo,window.RankDataJobZsVo=RankDataJobZsVo,window.RankDataLadderVo=RankDataLadderVo,window.RankDataLevelVo=RankDataLevelVo,window.RankDataLiLianVo=RankDataLiLianVo,window.RankDataPassVo=RankDataPassVo,window.RankDataPowerVo=RankDataPowerVo,window.RankDataPrestigeVo=RankDataPrestigeVo,window.RankDataRuneVo=RankDataRuneVo,window.RankDataScoreVo=RankDataScoreVo,window.RankDataSkirmishVo=RankDataSkirmishVo,window.RankDataSpecialRingVo=RankDataSpecialRingVo,window.RankDataTransfromVo=RankDataTransfromVo,window.RankDataWingVo=RankDataWingVo,window.RankDataXiaYiVo=RankDataXiaYiVo,window.RankDataXunZhangVo=RankDataXunZhangVo,window.RankPraiseVo=RankPraiseVo,window.RankFbLevelsView=RankFbLevelsView,window.RankingView=RankingView,window.RankRoleAttrView=RankRoleAttrView,window.RankRoleInfoPanel=RankRoleInfoPanel,window.RankRoleSelectPanel=RankRoleSelectPanel,window.RankRoleView=RankRoleView,window.RankSpecialRingView=RankSpecialRingView,window.RankFbLevelsItemRenderer=RankFbLevelsItemRenderer,window.RankItemRenderer=RankItemRenderer,window.RankTabItemRenderer=RankTabItemRenderer,window.RecruitView=RecruitView,window.RecruitItemRenderer=RecruitItemRenderer,window.ReincarnateControl=ReincarnateControl,window.ReincarnateGainView=ReincarnateGainView,window.ReincarnatePanel=ReincarnatePanel,window.ReincarnateStarControl=ReincarnateStarControl,window.ReincarnateStarRedPoint=ReincarnateStarRedPoint,window.ReincarnateStarBossControl=ReincarnateStarBossControl,window.ReincarnateStarBossPanel=ReincarnateStarBossPanel,window.ReincarnateStarBossSceneView=ReincarnateStarBossSceneView,window.ReincarnateStarBossItemRenderer=ReincarnateStarBossItemRenderer,window.ReincarnateStarEquipControl=ReincarnateStarEquipControl,window.ReincarnateStarEquipVo=ReincarnateStarEquipVo,window.ReincarnateStarEquipChangeView=ReincarnateStarEquipChangeView,window.ReincarnateStarEquipPanel=ReincarnateStarEquipPanel,window.ReincarnateStarEquipTipsView=ReincarnateStarEquipTipsView,window.ReincarnateStarSlotPanel=ReincarnateStarSlotPanel,window.ReincarnateStarSlotTipsView=ReincarnateStarSlotTipsView,window.ReincarnateStarSoulLlinkView=ReincarnateStarSoulLlinkView,window.ReincarnateStarSoulTipsView=ReincarnateStarSoulTipsView,window.ReincarnateStarSoulView=ReincarnateStarSoulView,window.ReincarnateStarStepPanel=ReincarnateStarStepPanel,window.ReincarnateStarSuitPanel=ReincarnateStarSuitPanel,window.ReincarnateStarSuitView=ReincarnateStarSuitView,window.ReincarnateStarEquipChangeItemRenderer=ReincarnateStarEquipChangeItemRenderer,window.ReincarnateStarEquipItemRenderer=ReincarnateStarEquipItemRenderer,window.ReincarnateStarStepItemRenderer=ReincarnateStarStepItemRenderer,window.ReincarnateStarSuitAttrItemRenderer=ReincarnateStarSuitAttrItemRenderer,window.ReincarnateStarSuitItemRenderer=ReincarnateStarSuitItemRenderer,window.ReincarnateStarPanel=ReincarnateStarPanel,window.ReincarnateStarView=ReincarnateStarView,window.ReincarnateStarBossUnlockItemRenderer=ReincarnateStarBossUnlockItemRenderer,window.ReincarnateStarEquipUnlockItemRenderer=ReincarnateStarEquipUnlockItemRenderer,window.ReincarnateStarUpItemRenderer=ReincarnateStarUpItemRenderer,window.ReincarnationControl=ReincarnationControl,window.ExchangeVo=ExchangeVo,window.ReincarnationVo=ReincarnationVo,window.ReincarnationAddSpiritView=ReincarnationAddSpiritView,window.ReincarnationEquipTipsView=ReincarnationEquipTipsView,window.ReincarnationGetExpView=ReincarnationGetExpView,window.ReincarnationPanel=ReincarnationPanel,window.ReincarnationSoulView=ReincarnationSoulView,window.ReincarnationComposeItemRender=ReincarnationComposeItemRender,window.ReincarnationComposeSecMenuItemRender=ReincarnationComposeSecMenuItemRender,window.ResultControl=ResultControl,window.BossResultView=BossResultView,window.ClimbTowerResultView=ClimbTowerResultView,window.ExpResultView=ExpResultView,window.FireResultView=FireResultView,window.LadderResultView=LadderResultView,window.MaterialResultView=MaterialResultView,window.PersonalResultView=PersonalResultView,window.ResultView=ResultView,window.TeamResultView=TeamResultView,window.ToseongBossResultView=ToseongBossResultView,window.WorldBossResultView=WorldBossResultView,window.ResultCoinItemRenderer=ResultCoinItemRenderer,window.ResultFailItemRenderer=ResultFailItemRenderer,window.WorldBossResultItemRenderer=WorldBossResultItemRenderer,window.EquipControl=EquipControl,window.RoleControl=RoleControl,window.PunchEquipForgeVo=PunchEquipForgeVo,window.PunchEquipVo=PunchEquipVo,window.RoleAttrView=RoleAttrView,window.RoleChangeEquipView=RoleChangeEquipView,window.RoleChangeItemView=RoleChangeItemView,window.RoleInfoPanel=RoleInfoPanel,window.RoleView=RoleView,window.RoleChangeEquipItemRenderer=RoleChangeEquipItemRenderer,window.RoleItemItemRenderer=RoleItemItemRenderer,window.RoleRingItemRenderer=RoleRingItemRenderer,window.RuneControl=RuneControl,window.RuneRedPoint=RuneRedPoint,window.RuneAllVo=RuneAllVo,window.RuneChangeVo=RuneChangeVo,window.RuneResolveVo=RuneResolveVo,window.RuneAllView=RuneAllView,window.RuneAttrView=RuneAttrView,window.RuneChangeView=RuneChangeView,window.RuneExchangePanel=RuneExchangePanel,window.RuneItemTipsView=RuneItemTipsView,window.RunePanel=RunePanel,window.RuneResolvePanel=RuneResolvePanel,window.RuneView=RuneView,window.RuneAllItemRenderer=RuneAllItemRenderer,window.RuneChangeItemRenderer=RuneChangeItemRenderer,window.RuneExchangeItemRenderer=RuneExchangeItemRenderer,window.RuneItemRenderer=RuneItemRenderer,window.RuneResolveItemRenderer=RuneResolveItemRenderer,window.ShareGameControl=ShareGameControl,window.ShareGamePanel=ShareGamePanel,window.ShareGameView=ShareGameView,window.ShareGameItemRenderer=ShareGameItemRenderer,window.SkillControl=SkillControl,window.SkillPanel=SkillPanel,window.SkillView=SkillView,window.SkillItemRenderer=SkillItemRenderer,window.SmeltControl=SmeltControl,window.SmeltEquipPanel=SmeltEquipPanel,window.SmeltEquipView=SmeltEquipView,window.SmeltItemPanel=SmeltItemPanel,window.SmeltItemView=SmeltItemView,window.SmeltGainItemRenderer=SmeltGainItemRenderer,window.SmeltItemRenderer=SmeltItemRenderer,window.SoulBoneControl=SoulBoneControl,window.SoulBoneRedPoint=SoulBoneRedPoint,window.SoulBoneItemsVo=SoulBoneItemsVo,window.SoulBoneVo=SoulBoneVo,window.SoulBoneAttrView=SoulBoneAttrView,window.SoulBoneDunPanel=SoulBoneDunPanel,window.SoulBoneDunSweepView=SoulBoneDunSweepView,window.SoulBoneGroupView=SoulBoneGroupView,window.SoulBonePanel=SoulBonePanel,window.SoulBoneStageView=SoulBoneStageView,window.SoulBoneTipsView=SoulBoneTipsView,window.SoulJadeView=SoulJadeView,window.SoulBoneGroupItemRenderer=SoulBoneGroupItemRenderer,window.LoginControl=LoginControl,window.CreateRoleView=CreateRoleView,window.CreateRoleView1=CreateRoleView1,window.LoginView=LoginView,window.ServerListView=ServerListView,window.StartGameView=StartGameView,window.WXLoginView=WXLoginView,window.YYBLoginView=YYBLoginView,window.CreateRoleItemRenderer=CreateRoleItemRenderer,window.ServerListItemRenderer=ServerListItemRenderer,window.ServerTapBtnItemRenderer=ServerTapBtnItemRenderer,window.StoreControl=StoreControl,window.StoreRedPoint=StoreRedPoint,window.StoreEquipVo=StoreEquipVo,window.StoreFeatsVo=StoreFeatsVo,window.StoreHadBuyVo=StoreHadBuyVo,window.StoreTreasureVo=StoreTreasureVo,window.StoreVo=StoreVo,window.StoreBestTipsView=StoreBestTipsView,window.StoreBlackPanel=StoreBlackPanel,window.StoreBuyView=StoreBuyView,window.StoreHonorPanel=StoreHonorPanel,window.StoreIntegrationPanel=StoreIntegrationPanel,window.StoreItemPanel=StoreItemPanel,window.StoreMedalPanel=StoreMedalPanel,window.StoreNoblePanel=StoreNoblePanel,window.StoreSpecialView=StoreSpecialView,window.StoreTreasureResolveAllView=StoreTreasureResolveAllView,window.StoreTreasureResolveNumView=StoreTreasureResolveNumView,window.StoreTreasureResolveView=StoreTreasureResolveView,window.StoreTreasureShopPanel=StoreTreasureShopPanel,window.StoreView=StoreView,window.StoreWeekPanel=StoreWeekPanel,window.StoreBlackItemRenderer=StoreBlackItemRenderer,window.StoreHonorItemRenderer=StoreHonorItemRenderer,window.StoreIntegrationItemRenderer=StoreIntegrationItemRenderer,window.StoreItemItemRenderer=StoreItemItemRenderer,window.StoreMedalItemRenderer=StoreMedalItemRenderer,window.StoreNobleItemRenderer=StoreNobleItemRenderer,window.StoreTreasureResolveAllItemRenderer=StoreTreasureResolveAllItemRenderer,window.StoreTreasureResolveItemRenderer=StoreTreasureResolveItemRenderer,window.StoreWeekItemRenderer=StoreWeekItemRenderer,window.FlameMarkControl=FlameMarkControl,window.SuperRingControl=SuperRingControl,window.BookSkillInfoVo=BookSkillInfoVo,window.OtherFireRingDataVo=OtherFireRingDataVo,window.RingSkillInfoVo=RingSkillInfoVo,window.SpecialRingDataVo=SpecialRingDataVo,window.FireRingAbilityView=FireRingAbilityView,window.FireRingBasePanel=FireRingBasePanel,window.FireRingCopyPanel=FireRingCopyPanel,window.FireRingFlyTipView=FireRingFlyTipView,window.FireRingMarkPanel=FireRingMarkPanel,window.FireRingSkillPanel=FireRingSkillPanel,window.FireRingTanleTipsView=FireRingTanleTipsView,window.FireRingView=FireRingView,window.FlameMarkMixView=FlameMarkMixView,window.FlameMarkSkillTipsView=FlameMarkSkillTipsView,window.SuperRingDetailView=SuperRingDetailView,window.SuperRingInfoView=SuperRingInfoView,window.SuperRingUpgradeView=SuperRingUpgradeView,window.SuperRingView=SuperRingView,window.FireRingAbilityItemRender=FireRingAbilityItemRender,window.FireRingSkillBookItemRender=FireRingSkillBookItemRender,window.FireRingSkillItemRender=FireRingSkillItemRender,window.FlameMarkMixItemRender=FlameMarkMixItemRender,window.FlameMarkSkillItemRender=FlameMarkSkillItemRender,window.StudySkillNeedItemRender=StudySkillNeedItemRender,window.SuperRingGainItemRender=SuperRingGainItemRender,window.SuperRingItemRender=SuperRingItemRender,window.TaskControl=TaskControl,window.AchievementVo=AchievementVo,window.LimitTaskVo=LimitTaskVo,window.TaskVo=TaskVo,window.VitalityVo=VitalityVo,window.LimitStartTipsView=LimitStartTipsView,window.LimitTaskView=LimitTaskView,window.LimitTaskItemRenderer=LimitTaskItemRenderer,window.TipsControl=TipsControl,window.AshtarteTipsItemRenderer=AshtarteTipsItemRenderer,window.CrazyDogTipsItemRenderer=CrazyDogTipsItemRenderer,window.ItemGainTipsItemRenderer=ItemGainTipsItemRenderer,window.AshtarteSkillTipsView=AshtarteSkillTipsView,window.AshtarteTipsView=AshtarteTipsView,window.AttriteChangeView=AttriteChangeView,window.BackpackFullTipsView=BackpackFullTipsView,window.CenterTipsItemRenderer=CenterTipsItemRenderer,window.CrazyDogTipsView=CrazyDogTipsView,window.CurrencyTipsView=CurrencyTipsView,window.DegreeTipsView=DegreeTipsView,window.EquipTipsView=EquipTipsView,window.EverTipsItemRenderer=EverTipsItemRenderer,window.FakeEquipTipsView=FakeEquipTipsView,window.FashionHeirloomTipsView=FashionHeirloomTipsView,window.FashionSpecialTipsPanel=FashionSpecialTipsPanel,window.FashionTipsView=FashionTipsView,window.FuncNoticeTipsView=FuncNoticeTipsView,window.GoodEquipTipsPanel=GoodEquipTipsPanel,window.GoodHeartTipsPanel=GoodHeartTipsPanel,window.GoodItemTipsPanel=GoodItemTipsPanel,window.GoodRewardTipsPanel=GoodRewardTipsPanel,window.GoodSkillTipsPanel=GoodSkillTipsPanel,window.HintTipsItemRenderer=HintTipsItemRenderer,window.HookRewardTipsView=HookRewardTipsView,window.ItemGainTipsView=ItemGainTipsView,window.ItemTipsView=ItemTipsView,window.ItemUseTipsView=ItemUseTipsView,window.LinkTipsItemRenderer=LinkTipsItemRenderer,window.LinkTipsView=LinkTipsView,window.PowerPromoteTipsView=PowerPromoteTipsView,window.PunchEquipTipsView=PunchEquipTipsView,window.RuneTipsView=RuneTipsView,window.SceneTipsItemRenderer=SceneTipsItemRenderer,window.TipsItemRenderer=TipsItemRenderer,window.TipsView=TipsView,window.TitleTipsView=TitleTipsView,window.ZealEquipTipsView=ZealEquipTipsView,window.TitleControl=TitleControl,window.TitleVo=TitleVo,window.TitleUpLvTipsView=TitleUpLvTipsView,window.TitleItemAttItemRender=TitleItemAttItemRender,window.TitleItemRenderer=TitleItemRenderer,window.ToseongControl=ToseongControl,window.ToseongBossPanel=ToseongBossPanel,window.ToseongBossRewardTipsView=ToseongBossRewardTipsView,window.ToseongBossView=ToseongBossView,window.ToseongFunView=ToseongFunView,window.ToseongBossItemRenderer=ToseongBossItemRenderer,window.TrailerControl=TrailerControl,window.DarkSuitTrailerView=DarkSuitTrailerView,window.GodWeaponSkillTrailerView=GodWeaponSkillTrailerView,window.SoulBoneSuitTrailerView=SoulBoneSuitTrailerView,window.TrailerView=TrailerView,window.Trailer10Panel=Trailer10Panel,window.Trailer11Panel=Trailer11Panel,window.Trailer12Panel=Trailer12Panel,window.Trailer13Panel=Trailer13Panel,window.Trailer14Panel=Trailer14Panel,window.Trailer15Panel=Trailer15Panel,window.Trailer16Panel=Trailer16Panel,window.Trailer17Panel=Trailer17Panel,window.Trailer18Panel=Trailer18Panel,window.Trailer19Panel=Trailer19Panel,window.Trailer1Panel=Trailer1Panel,window.Trailer20Panel=Trailer20Panel,window.Trailer21Panel=Trailer21Panel,window.Trailer22Panel=Trailer22Panel,window.Trailer23Panel=Trailer23Panel,window.Trailer2Panel=Trailer2Panel,window.Trailer3Panel=Trailer3Panel,window.Trailer4Panel=Trailer4Panel,window.Trailer5Panel=Trailer5Panel,window.Trailer6Panel=Trailer6Panel,window.Trailer7Panel=Trailer7Panel,window.Trailer8Panel=Trailer8Panel,window.Trailer9Panel=Trailer9Panel,window.TreasureHuntControl=TreasureHuntControl,window.TreasureHuntBoxsTipsView=TreasureHuntBoxsTipsView,window.TreasureHuntExShopView=TreasureHuntExShopView,window.TreasureHuntPanel=TreasureHuntPanel,window.TreasureHuntRareGiftView=TreasureHuntRareGiftView,window.TreasureHuntRarePanel=TreasureHuntRarePanel,window.TreasureHuntResultView=TreasureHuntResultView,window.TreasureHuntRunePanel=TreasureHuntRunePanel,window.TreasureHuntSelectView=TreasureHuntSelectView,window.TreasureHuntStoreView=TreasureHuntStoreView,window.TreasureHuntView=TreasureHuntView,window.TreasureHuntWarnBuyView=TreasureHuntWarnBuyView,window.TreasureHuntListItemRenderer=TreasureHuntListItemRenderer,window.TreasureHuntRareItemRenderer=TreasureHuntRareItemRenderer,window.TreasureHuntStoreItemRenderer=TreasureHuntStoreItemRenderer,window.UitrasoneEquipControl=UitrasoneEquipControl,window.UitrasoneEquipPanel=UitrasoneEquipPanel,window.UitrasoneEquipTipsView=UitrasoneEquipTipsView,window.UitrasoneSkillTipsView=UitrasoneSkillTipsView,window.UitrasoneEquipItemRender=UitrasoneEquipItemRender,window.VipControl=VipControl,window.SuperVipView=SuperVipView,window.Vip3MBView=Vip3MBView,window.Vip3View=Vip3View,window.VipGiftItemPanel=VipGiftItemPanel,window.VipGiftPanel=VipGiftPanel,window.VipGiftView=VipGiftView,window.VipView=VipView,window.VipGiftBtnItemRenderer=VipGiftBtnItemRenderer,window.WarriorConfigMgr=WarriorConfigMgr,window.WarriorControl=WarriorControl,window.WarriorEquipVo=WarriorEquipVo,window.WarriorModel=WarriorModel,window.WarriorVo=WarriorVo,window.WarriorActiveItemTipView=WarriorActiveItemTipView,window.WarriorBossRemindTipView=WarriorBossRemindTipView,window.WarriorBossView=WarriorBossView,window.WarriorBreachPanel=WarriorBreachPanel,window.WarriorDrugDetailTipView=WarriorDrugDetailTipView,window.WarriorDunPanel=WarriorDunPanel,window.WarriorEquipAttrView=WarriorEquipAttrView,window.WarriorEquipBagView=WarriorEquipBagView,window.WarriorEquipComposePanel=WarriorEquipComposePanel,window.WarriorEquipDetailTipView=WarriorEquipDetailTipView,window.WarriorEquipPanel=WarriorEquipPanel,window.WarriorEquipStrenView=WarriorEquipStrenView,window.WarriorOtherEquipPanel=WarriorOtherEquipPanel,window.WarriorOtherView=WarriorOtherView,window.WarriorPersonPanel=WarriorPersonPanel,window.WarriorSkillTipView=WarriorSkillTipView,window.WarriorTaskView=WarriorTaskView,window.WarriorUpBattleView=WarriorUpBattleView,window.WarriorView=WarriorView,window.WarriorActiveItemTipSkillItemRenderer=WarriorActiveItemTipSkillItemRenderer,window.WarriorBossItemRenderer=WarriorBossItemRenderer,window.WarriorBossRemindItemRenderer=WarriorBossRemindItemRenderer,window.WarriorEquipBagItemRenderer=WarriorEquipBagItemRenderer,window.WarriorEquipComposeItemRenderer=WarriorEquipComposeItemRenderer,window.WarriorEquipComposePosItemRenderer=WarriorEquipComposePosItemRenderer,window.WarriorEquipItemRenderer=WarriorEquipItemRenderer,window.WarriorEquipResolveItemRenderer=WarriorEquipResolveItemRenderer,window.WarriorPersonItemRenderer=WarriorPersonItemRenderer,window.WarriorSkillItemRenderer=WarriorSkillItemRenderer,window.WarriorUpBattleItemRenderer=WarriorUpBattleItemRenderer,window.WeaponsSoulControl=WeaponsSoulControl,window.WeaponsSoulDataVo=WeaponsSoulDataVo,window.WeaponsSoulInfoVo=WeaponsSoulInfoVo,window.WeaponsSoulOneInfoVo=WeaponsSoulOneInfoVo,window.WeaponsSoulSuitInfoVo=WeaponsSoulSuitInfoVo,window.WeaponSoulBreakView=WeaponSoulBreakView,window.WeaponSoulFacadePanel=WeaponSoulFacadePanel,window.WeaponSoulPanel=WeaponSoulPanel,window.WeaponSoulShowPanel=WeaponSoulShowPanel,window.WeaponSoulSkillTipsView=WeaponSoulSkillTipsView,window.WeaponSoulUplvView=WeaponSoulUplvView,window.WeaponSoulbreakItemRender=WeaponSoulbreakItemRender,window.WeaponSoulItemRender=WeaponSoulItemRender,window.WeaponSoulListItemRender=WeaponSoulListItemRender,window.WeaponSoulSkillItemRender=WeaponSoulSkillItemRender,window.CDKeyControl=CDKeyControl,window.WelfareControl=WelfareControl,window.CdKeyPanel=CdKeyPanel,window.GameNoticePanel=GameNoticePanel,window.RecoveryPanel=RecoveryPanel,window.SevenDayPanel=SevenDayPanel,window.VouchersPanel=VouchersPanel,window.VouchersView=VouchersView,window.WelfareView=WelfareView,window.RecoveryLogItemRender=RecoveryLogItemRender,window.SevenDayItemRender=SevenDayItemRender,window.SevenDayPanelItem2Render=SevenDayPanelItem2Render,window.WelfareBtnItemRenderer=WelfareBtnItemRenderer,window.SDKConst=SDKConst,window.GameSystem=GameSystem,window.Main=Main;
