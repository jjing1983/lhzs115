function callLater(t,e,i){var o=i.value,n="$isLater"+e,r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];delete this[n],o.call.apply(o,[this].concat(t))},a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this[n]||(egret.callLater.apply(egret,[r,this].concat(t)),this[n]=!0)};return i.value=a,i}function callDelay(t){var e=function(e,i,o){var n=o.value,r="$isDelay"+i,a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this[r]=!1,n.call.apply(n,[this].concat(t))},s=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this[r]||(this[r]=!0,egret.setTimeout.apply(egret,[a,this,t].concat(e)))};return o.value=s,o};return e}function recycle(t){egret.BitmapData.$removeDisplayObject=function(t,e){if(e){var i=e.hashCode;if(i&&egret.BitmapData._displayList[i]){var o=egret.BitmapData._displayList[i],n=o.indexOf(t);n>=0&&o.splice(n,1),0==o.length&&RecycleMgr.ins().disposeResTime(i)}}}}function injectable(t){}function protocolsId(t){return function(e){e.prototype.protocolsId=t}}function up(t,e){var i=function(i,o,n){var r=n.value,a=function(){for(var i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];var n=r.call.apply(r,[this].concat(i));if("boolean"==typeof n&&!n)return!1;var a=this.getBytes(t);return n&&n instanceof Array&&this.encodeBytes(e,n,a),this.sendToServer(a),n};return n.value=a,n};return i}function down(t,e){return function(i,o,n){var r=n.value;return r.messageId=t,r.decode=e,n.value=r,n}}var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},egret;!function(t){var e=function(){function t(){}return t.BINARY="binary",t.TEXT="text",t.VARIABLES="variables",t.TEXTURE="texture",t.SOUND="sound",t}();t.URLLoaderDataFormat=e,__reflect(e.prototype,"egret.URLLoaderDataFormat")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e,i,o){var n=t.call(this)||this;return n._name=e,n._frame=0|i,o&&(n._end=0|o),n}return __extends(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this._name,this._frame,this._end)},e}(t.EventDispatcher);t.FrameLabel=e,__reflect(e.prototype,"egret.FrameLabel")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.$mcData=null,t.numFrames=1,t.frames=[],t.labels=null,t.events=[],t.frameRate=0,t.textureData=null,t.spriteSheet=null,t}return __extends(i,e),i.prototype.$init=function(t,e,i){this.textureData=e,this.spriteSheet=i,this.setMCData(t)},i.prototype.getKeyFrameData=function(t){var e=this.frames[t-1];return e.frame&&(e=this.frames[e.frame-1]),e},i.prototype.getTextureByFrame=function(t){var e=this.getKeyFrameData(t);if(e.res){var i=this.getTextureByResName(e.res);return i}return null},i.prototype.$getOffsetByFrame=function(t,e){var i=this.getKeyFrameData(t);i.res&&e.setTo(0|i.x,0|i.y)},i.prototype.getTextureByResName=function(t){if(null==this.spriteSheet)return null;var e=this.spriteSheet.getTexture(t);if(!e){var i=this.textureData[t];e=this.spriteSheet.createTexture(t,i.x,i.y,i.w,i.h)}return e},i.prototype.$isDataValid=function(){return this.frames.length>0},i.prototype.$isTextureValid=function(){return null!=this.textureData&&null!=this.spriteSheet},i.prototype.$fillMCData=function(t){this.frameRate=t.frameRate||24,this.fillFramesData(t.frames),this.fillFrameLabelsData(t.labels),this.fillFrameEventsData(t.events)},i.prototype.fillFramesData=function(t){for(var e,i=this.frames,o=t?t.length:0,n=0;o>n;n++){var r=t[n];if(i.push(r),r.duration){var a=parseInt(r.duration);if(a>1){e=i.length;for(var s=1;a>s;s++)i.push({frame:e})}}}this.numFrames=i.length},i.prototype.fillFrameLabelsData=function(e){if(e){var i=e.length;if(i>0){this.labels=[];for(var o=0;i>o;o++){var n=e[o];this.labels.push(new t.FrameLabel(n.name,n.frame,n.end))}}}},i.prototype.fillFrameEventsData=function(t){if(t){var e=t.length;if(e>0){this.events=[];for(var i=0;e>i;i++){var o=t[i];this.events[o.frame]=o.name}}}},Object.defineProperty(i.prototype,"mcData",{get:function(){return this.$mcData},set:function(t){this.setMCData(t)},enumerable:!0,configurable:!0}),i.prototype.setMCData=function(t){this.$mcData!=t&&(this.$mcData=t,t&&this.$fillMCData(t))},i}(t.HashObject);t.MovieClipData=e,__reflect(e.prototype,"egret.MovieClipData")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i){var o=e.call(this)||this;return o.enableCache=!0,o.$mcDataCache={},o.$mcDataSet=t,o.setTexture(i),o}return __extends(i,e),i.prototype.clearCache=function(){this.$mcDataCache={}},i.prototype.generateMovieClipData=function(e){if(void 0===e&&(e=""),""==e&&this.$mcDataSet)for(e in this.$mcDataSet.mc)break;if(""==e)return null;var i=this.findFromCache(e,this.$mcDataCache);return i||(i=new t.MovieClipData,this.fillData(e,i,this.$mcDataCache)),i},i.prototype.findFromCache=function(t,e){return this.enableCache&&e[t]?e[t]:null},i.prototype.fillData=function(t,e,i){if(this.$mcDataSet){var o=this.$mcDataSet.mc[t];o&&(e.$init(o,this.$mcDataSet.res,this.$spriteSheet),this.enableCache&&(i[t]=e))}},Object.defineProperty(i.prototype,"mcDataSet",{get:function(){return this.$mcDataSet},set:function(t){this.$mcDataSet=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"texture",{set:function(t){this.setTexture(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spriteSheet",{get:function(){return this.$spriteSheet},enumerable:!0,configurable:!0}),i.prototype.setTexture=function(e){this.$spriteSheet=e?new t.SpriteSheet(e):null},i}(t.EventDispatcher);t.MovieClipDataFactory=e,__reflect(e.prototype,"egret.MovieClipDataFactory")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(t,i,o,n){void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===n&&(n=null);var r=e.call(this,t,i,o)||this;return r.frameLabel=null,r.frameLabel=n,r}return __extends(i,e),i.dispatchMovieClipEvent=function(e,o,n){void 0===n&&(n=null);var r=t.Event.create(i,o);r.frameLabel=n;var a=e.dispatchEvent(r);return t.Event.release(r),a},i.FRAME_LABEL="frame_label",i}(t.Event);t.MovieClipEvent=e,__reflect(e.prototype,"egret.MovieClipEvent")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.quintOut=e.getPowOut(5),e.quartOut=e.getPowOut(4),e}();t.ScrollEase=e,__reflect(e.prototype,"egret.ScrollEase");var i=function(e){function i(t,i,o){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n._actions=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,i,o),n}return __extends(i,e),i.get=function(t,e,o,n){return void 0===e&&(e=null),void 0===o&&(o=null),void 0===n&&(n=!1),n&&i.removeTweens(t),new i(t,e,o)},i.removeTweens=function(t){if(t.tween_count){for(var e=i._tweens,o=e.length-1;o>=0;o--)e[o]._target==t&&(e[o].paused=!0,e.splice(o,1));t.tween_count=0}},i.tick=function(t,e){void 0===e&&(e=!1);var o=t-i._lastTime;i._lastTime=t;for(var n=i._tweens.concat(),r=n.length-1;r>=0;r--){var a=n[r];e&&!a.ignoreGlobalPause||a.paused||a.tick(a._useTicks?1:o)}return!1},i._register=function(e,o){var n=e._target,r=i._tweens;if(o)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),r.push(e),i._inited||(i._lastTime=t.getTimer(),t.ticker.$startTick(i.tick,null),i._inited=!0);else{n&&n.tween_count--;for(var a=r.length;a--;)if(r[a]==e)return void r.splice(a,1)}},i.prototype.initialize=function(t,e,o){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=o||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],this._actions=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,o=!1;if(i>=this.duration&&(this.loop?i%=this.duration:(i=this.duration,o=!0)),i==this._prevPos)return o;var n=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target)if(o)this._updateTargetProps(null,1);else if(this._steps.length>0){var r=void 0,a=this._steps.length;for(r=0;a>r&&!(this._steps[r].t>i);r++);var s=this._steps[r-1];this._updateTargetProps(s,(this._stepPosition=i-s.t)/s.d)}return o&&this.setPaused(!0),0!=e&&this._actions.length>0&&(this._useTicks?this._runActions(i,i):1==e&&n>i?(n!=this.duration&&this._runActions(n,this.duration),this._runActions(0,i,!0)):this._runActions(n,i)),this.dispatchEventWith("change"),o},i.prototype._runActions=function(t,e,i){void 0===i&&(i=!1);var o=t,n=e,r=-1,a=this._actions.length,s=1;for(t>e&&(o=e,n=t,r=a,a=s=-1);(r+=s)!=a;){var l=this._actions[r],h=l.t;(h==n||h>o&&n>h||i&&h==t)&&l.f.apply(l.o,l.p)}},i.prototype._updateTargetProps=function(t,e){var o,n,r,a,s,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),o=t.p0,n=t.p1}else this.passive=!1,o=n=this._curQueueProps;for(var h in this._initQueueProps){null==(a=o[h])&&(o[h]=a=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=a),r=a==s||0==e||1==e||"number"!=typeof a?1==e?s:a:a+(s-a)*e;var u=!1;if(l=i._plugins[h])for(var c=0,p=l.length;p>c;c++){var d=l[c].tween(this,h,r,o,n,e,!!t&&o==n,!t);d==i.IGNORE?u=!0:r=d}u||(this._target[h]=r)}},i.prototype.setPaused=function(t){return this.paused=t,i._register(this,!t),this},i.prototype._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},i.prototype._addStep=function(t){return t.d>0&&(this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,o,n,r,a;for(var s in t)if(void 0===this._initQueueProps[s]){if(o=this._target[s],e=i._plugins[s])for(n=0,r=e.length;r>n;n++)o=e[n].init(this,s,o);this._initQueueProps[s]=this._curQueueProps[s]=void 0===o?null:o}else o=this._curQueueProps[s];for(var s in t){if(o=this._curQueueProps[s],e=i._plugins[s])for(a=a||{},n=0,r=e.length;r>n;n++)e[n].step&&e[n].step(this,s,o,t[s],a);this._curQueueProps[s]=t[s]}return a&&this._appendQueueProps(a),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,this._actions.push(t),this},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))})},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i?i:[],o:e?e:this._target})},i.prototype.tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i._tweens=[],i.IGNORE={},i._plugins={},i._inited=!1,i._lastTime=0,i}(t.EventDispatcher);t.ScrollTween=i,__reflect(i.prototype,"egret.ScrollTween")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var o=e.call(this)||this;return o.scrollBeginThreshold=10,o.scrollSpeed=1,o._content=null,o.delayTouchBeginEvent=null,o.touchBeginTimer=null,o.touchEnabled=!0,o._ScrV_Props_=new t.ScrollViewProperties,i&&o.setContent(i),o}return __extends(i,e),Object.defineProperty(i.prototype,"bounces",{get:function(){return this._ScrV_Props_._bounces},set:function(t){this._ScrV_Props_._bounces=!!t},enumerable:!0,configurable:!0}),i.prototype.setContent=function(t){this._content!==t&&(this.removeContent(),t&&(this._content=t,e.prototype.addChild.call(this,t),this._addEvents()))},i.prototype.removeContent=function(){this._content&&(this._removeEvents(),e.prototype.removeChildAt.call(this,0)),this._content=null},Object.defineProperty(i.prototype,"verticalScrollPolicy",{get:function(){return this._ScrV_Props_._verticalScrollPolicy},set:function(t){t!=this._ScrV_Props_._verticalScrollPolicy&&(this._ScrV_Props_._verticalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"horizontalScrollPolicy",{get:function(){return this._ScrV_Props_._horizontalScrollPolicy},set:function(t){t!=this._ScrV_Props_._horizontalScrollPolicy&&(this._ScrV_Props_._horizontalScrollPolicy=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollLeft",{get:function(){return this._ScrV_Props_._scrollLeft},set:function(t){t!=this._ScrV_Props_._scrollLeft&&(this._ScrV_Props_._scrollLeft=t,this._validatePosition(!1,!0),this._updateContentPosition())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"scrollTop",{get:function(){return this._ScrV_Props_._scrollTop},set:function(t){t!=this._ScrV_Props_._scrollTop&&(this._ScrV_Props_._scrollTop=t,this._validatePosition(!0,!1),this._updateContentPosition())},enumerable:!0,configurable:!0}),i.prototype.setScrollPosition=function(t,e,i){if(void 0===i&&(i=!1),(!i||0!=t||0!=e)&&(i||this._ScrV_Props_._scrollTop!=t||this._ScrV_Props_._scrollLeft!=e)){var o=this._ScrV_Props_._scrollTop,n=this._ScrV_Props_._scrollLeft;if(i){var r=this.getMaxScrollLeft(),a=this.getMaxScrollTop();(0>=o||o>=a)&&(t/=2),(0>=n||n>=r)&&(e/=2);var s=o+t,l=n+e,h=this._ScrV_Props_._bounces;h||((0>=s||s>=a)&&(s=Math.max(0,Math.min(s,a))),(0>=l||l>=r)&&(l=Math.max(0,Math.min(l,r)))),this._ScrV_Props_._scrollTop=s,this._ScrV_Props_._scrollLeft=l}else this._ScrV_Props_._scrollTop=t,this._ScrV_Props_._scrollLeft=e;this._validatePosition(!0,!0),this._updateContentPosition()}},i.prototype._validatePosition=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),t){var i=this.height,o=this._getContentHeight();this._ScrV_Props_._scrollTop=Math.max(this._ScrV_Props_._scrollTop,(0-i)/2),this._ScrV_Props_._scrollTop=Math.min(this._ScrV_Props_._scrollTop,o>i?o-i/2:i/2)}if(e){var n=this.width,r=this._getContentWidth();this._ScrV_Props_._scrollLeft=Math.max(this._ScrV_Props_._scrollLeft,(0-n)/2),this._ScrV_Props_._scrollLeft=Math.min(this._ScrV_Props_._scrollLeft,r>n?r-n/2:n/2)}},i.prototype.$setWidth=function(t){this.$explicitWidth!=t&&(e.prototype.$setWidth.call(this,t),this._updateContentPosition())},i.prototype.$setHeight=function(t){this.$explicitHeight!=t&&(e.prototype.$setHeight.call(this,t),this._updateContentPosition())},i.prototype._updateContentPosition=function(){var e=this.height,i=this.width;this.scrollRect=new t.Rectangle(Math.round(this._ScrV_Props_._scrollLeft),Math.round(this._ScrV_Props_._scrollTop),i,e),this.dispatchEvent(new t.Event(t.Event.CHANGE))},i.prototype._checkScrollPolicy=function(){var t=this._ScrV_Props_._horizontalScrollPolicy,e=this.__checkScrollPolicy(t,this._getContentWidth(),this.width);this._ScrV_Props_._hCanScroll=e;var i=this._ScrV_Props_._verticalScrollPolicy,o=this.__checkScrollPolicy(i,this._getContentHeight(),this.height);return this._ScrV_Props_._vCanScroll=o,e||o},i.prototype.__checkScrollPolicy=function(t,e,i){return"on"==t?!0:"off"==t?!1:e>i},i.prototype._addEvents=function(){this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.addEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._removeEvents=function(){this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBegin,this),this.removeEventListener(t.TouchEvent.TOUCH_BEGIN,this._onTouchBeginCapture,this,!0),this.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEndCapture,this,!0)},i.prototype._onTouchBegin=function(e){if(!e.$isDefaultPrevented){var i=this._checkScrollPolicy();i&&(this._ScrV_Props_._touchStartPosition.x=e.stageX,this._ScrV_Props_._touchStartPosition.y=e.stageY,(this._ScrV_Props_._isHTweenPlaying||this._ScrV_Props_._isVTweenPlaying)&&this._onScrollFinished(),this._tempStage=this.stage,this._tempStage.addEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.addEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.addEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.addEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._logTouchEvent(e),e.preventDefault())}},i.prototype._onTouchBeginCapture=function(e){var i=this._checkScrollPolicy();if(i){for(var o=e.target;o!=this;){if("_checkScrollPolicy"in o&&(i=o._checkScrollPolicy()))return;o=o.parent}e.stopPropagation();var n=this.cloneTouchEvent(e);this.delayTouchBeginEvent=n,this.touchBeginTimer||(this.touchBeginTimer=new t.Timer(100,1),this.touchBeginTimer.addEventListener(t.TimerEvent.TIMER_COMPLETE,this._onTouchBeginTimer,this)),this.touchBeginTimer.start(),this._onTouchBegin(e)}},i.prototype._onTouchEndCapture=function(e){var i=this;if(this.delayTouchBeginEvent){this._onTouchBeginTimer(),e.stopPropagation();var o=this.cloneTouchEvent(e);t.callLater(function(){i.stage&&i.dispatchPropagationEvent(o)},this)}},i.prototype._onTouchBeginTimer=function(){this.touchBeginTimer.stop();var t=this.delayTouchBeginEvent;this.delayTouchBeginEvent=null,this.stage&&this.dispatchPropagationEvent(t)},i.prototype.dispatchPropagationEvent=function(e){for(var i=e.$target,o=this.$getPropagationList(i),n=o.length,r=.5*o.length,a=-1,s=0;n>s;s++)if(o[s]===this._content){a=s;break}o.splice(0,a+1),r-=a+1,this.$dispatchPropagationEvent(e,o,r),t.Event.release(e)},i.prototype._onTouchMove=function(t){if(this._ScrV_Props_._lastTouchPosition.x!=t.stageX||this._ScrV_Props_._lastTouchPosition.y!=t.stageY){if(!this._ScrV_Props_._scrollStarted){var e=t.stageX-this._ScrV_Props_._touchStartPosition.x,i=t.stageY-this._ScrV_Props_._touchStartPosition.y,o=Math.sqrt(e*e+i*i);if(o<this.scrollBeginThreshold)return void this._logTouchEvent(t)}this._ScrV_Props_._scrollStarted=!0,this.delayTouchBeginEvent&&(this.delayTouchBeginEvent=null,this.touchBeginTimer.stop()),this.touchChildren=!1;var n=this._getPointChange(t);this.setScrollPosition(n.y,n.x,!0),this._calcVelocitys(t),this._logTouchEvent(t)}},i.prototype._onTouchEnd=function(e){this.touchChildren=!0,this._ScrV_Props_._scrollStarted=!1,this._tempStage.removeEventListener(t.TouchEvent.TOUCH_MOVE,this._onTouchMove,this),this._tempStage.removeEventListener(t.TouchEvent.TOUCH_END,this._onTouchEnd,this),this._tempStage.removeEventListener(t.TouchEvent.LEAVE_STAGE,this._onTouchEnd,this),this.removeEventListener(t.Event.ENTER_FRAME,this._onEnterFrame,this),this._moveAfterTouchEnd()},i.prototype._onEnterFrame=function(e){var i=t.getTimer();i-this._ScrV_Props_._lastTouchTime>100&&i-this._ScrV_Props_._lastTouchTime<300&&this._calcVelocitys(this._ScrV_Props_._lastTouchEvent)},i.prototype._logTouchEvent=function(e){this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY,this._ScrV_Props_._lastTouchEvent=this.cloneTouchEvent(e),this._ScrV_Props_._lastTouchTime=t.getTimer()},i.prototype._getPointChange=function(t){return{x:this._ScrV_Props_._hCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.x-t.stageX,y:this._ScrV_Props_._vCanScroll===!1?0:this._ScrV_Props_._lastTouchPosition.y-t.stageY}},i.prototype._calcVelocitys=function(e){var i=t.getTimer();if(0==this._ScrV_Props_._lastTouchTime)return void(this._ScrV_Props_._lastTouchTime=i);var o=this._getPointChange(e),n=i-this._ScrV_Props_._lastTouchTime;o.x/=n,o.y/=n,this._ScrV_Props_._velocitys.push(o),this._ScrV_Props_._velocitys.length>5&&this._ScrV_Props_._velocitys.shift(),this._ScrV_Props_._lastTouchPosition.x=e.stageX,this._ScrV_Props_._lastTouchPosition.y=e.stageY},i.prototype._getContentWidth=function(){return this._content.$explicitWidth||this._content.width},i.prototype._getContentHeight=function(){return this._content.$explicitHeight||this._content.height},i.prototype.getMaxScrollLeft=function(){var t=this._getContentWidth()-this.width;return Math.max(0,t)},i.prototype.getMaxScrollTop=function(){var t=this._getContentHeight()-this.height;return Math.max(0,t)},i.prototype._moveAfterTouchEnd=function(){if(0!=this._ScrV_Props_._velocitys.length){for(var t={x:0,y:0},e=0,o=0;o<this._ScrV_Props_._velocitys.length;o++){var n=this._ScrV_Props_._velocitys[o],r=i.weight[o];t.x+=n.x*r,t.y+=n.y*r,e+=r}this._ScrV_Props_._velocitys.length=0,this.scrollSpeed<=0&&(this.scrollSpeed=1);var a=t.x/e*this.scrollSpeed,s=t.y/e*this.scrollSpeed,l=Math.abs(a),h=Math.abs(s),u=this.getMaxScrollLeft(),c=this.getMaxScrollTop(),p=l>.02?this.getAnimationDatas(a,this._ScrV_Props_._scrollLeft,u):{position:this._ScrV_Props_._scrollLeft,duration:1},d=h>.02?this.getAnimationDatas(s,this._ScrV_Props_._scrollTop,c):{position:this._ScrV_Props_._scrollTop,duration:1};this.setScrollLeft(p.position,p.duration),this.setScrollTop(d.position,d.duration)}},i.prototype.onTweenFinished=function(t){t==this._ScrV_Props_._vScrollTween&&(this._ScrV_Props_._isVTweenPlaying=!1),t==this._ScrV_Props_._hScrollTween&&(this._ScrV_Props_._isHTweenPlaying=!1),0==this._ScrV_Props_._isHTweenPlaying&&0==this._ScrV_Props_._isVTweenPlaying&&this._onScrollFinished()},i.prototype._onScrollStarted=function(){},i.prototype._onScrollFinished=function(){t.ScrollTween.removeTweens(this),this._ScrV_Props_._hScrollTween=null,this._ScrV_Props_._vScrollTween=null,this._ScrV_Props_._isHTweenPlaying=!1,this._ScrV_Props_._isVTweenPlaying=!1,this.dispatchEvent(new t.Event(t.Event.COMPLETE))},i.prototype.setScrollTop=function(e,i){void 0===i&&(i=0);var o=Math.min(this.getMaxScrollTop(),Math.max(e,0));if(0==i)return void(this.scrollTop=o);0==this._ScrV_Props_._bounces&&(e=o);var n=t.ScrollTween.get(this).to({scrollTop:e},i,t.ScrollEase.quartOut);o!=e&&n.to({scrollTop:o},300,t.ScrollEase.quintOut),this._ScrV_Props_._isVTweenPlaying=!0,this._ScrV_Props_._vScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isHTweenPlaying||this._onScrollStarted()},i.prototype.setScrollLeft=function(e,i){void 0===i&&(i=0);var o=Math.min(this.getMaxScrollLeft(),Math.max(e,0));if(0==i)return void(this.scrollLeft=o);0==this._ScrV_Props_._bounces&&(e=o);var n=t.ScrollTween.get(this).to({scrollLeft:e},i,t.ScrollEase.quartOut);o!=e&&n.to({scrollLeft:o},300,t.ScrollEase.quintOut),this._ScrV_Props_._isHTweenPlaying=!0,this._ScrV_Props_._hScrollTween=n,n.call(this.onTweenFinished,this,[n]),this._ScrV_Props_._isVTweenPlaying||this._onScrollStarted()},i.prototype.getAnimationDatas=function(t,e,i){var o=Math.abs(t),n=.95,r=0,a=.998,s=.02,l=e+500*t;if(0>l||l>i)for(l=e;Math.abs(t)!=1/0&&Math.abs(t)>s;)l+=t,t*=0>l||l>i?a*n:a,r++;else r=500*-Math.log(s/o);var h={position:Math.min(i+50,Math.max(l,-50)),duration:r};return h},i.prototype.cloneTouchEvent=function(e){var i=new t.TouchEvent(e.type,e.bubbles,e.cancelable);return i.touchPointID=e.touchPointID,i.$stageX=e.stageX,i.$stageY=e.stageY,i.touchDown=e.touchDown,i.$isDefaultPrevented=!1,i.$target=e.target,i},i.prototype.throwNotSupportedError=function(){t.$error(1023)},i.prototype.addChild=function(t){return this.throwNotSupportedError(),null},i.prototype.addChildAt=function(t,e){return this.throwNotSupportedError(),null},i.prototype.removeChild=function(t){return this.throwNotSupportedError(),null},i.prototype.removeChildAt=function(t){return this.throwNotSupportedError(),null},i.prototype.setChildIndex=function(t,e){this.throwNotSupportedError()},i.prototype.swapChildren=function(t,e){this.throwNotSupportedError()},i.prototype.swapChildrenAt=function(t,e){this.throwNotSupportedError()},i.weight=[1,1.33,1.66,2,2.33],i}(t.DisplayObjectContainer);t.ScrollView=e,__reflect(e.prototype,"egret.ScrollView")}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){this._verticalScrollPolicy="auto",this._horizontalScrollPolicy="auto",this._scrollLeft=0,this._scrollTop=0,this._hCanScroll=!1,this._vCanScroll=!1,this._lastTouchPosition=new t.Point(0,0),this._touchStartPosition=new t.Point(0,0),this._scrollStarted=!1,this._lastTouchTime=0,this._lastTouchEvent=null,this._velocitys=[],this._isHTweenPlaying=!1,this._isVTweenPlaying=!1,this._hScrollTween=null,this._vScrollTween=null,this._bounces=!0}return e}();t.ScrollViewProperties=e,__reflect(e.prototype,"egret.ScrollViewProperties")}(egret||(egret={}));var egret;!function(t){function e(e){var i=e.url;return-1==i.indexOf("?")&&e.method==t.URLRequestMethod.GET&&e.data&&e.data instanceof t.URLVariables&&(i=i+"?"+e.data.toString()),i}var i=function(i){function o(e){void 0===e&&(e=null);var o=i.call(this)||this;return o.dataFormat=t.URLLoaderDataFormat.TEXT,o.data=null,o._request=null,o._status=-1,e&&o.load(e),o}return __extends(o,i),o.prototype.load=function(i){this._request=i,this.data=null;var o=this;if(o.dataFormat==t.URLLoaderDataFormat.TEXTURE)return void this.loadTexture(o);if(o.dataFormat==t.URLLoaderDataFormat.SOUND)return void this.loadSound(o);var n=e(i),r=new t.HttpRequest;r.open(n,i.method==t.URLRequestMethod.POST?t.HttpMethod.POST:t.HttpMethod.GET);var a;if(i.method!=t.URLRequestMethod.GET&&i.data)if(i.data instanceof t.URLVariables){r.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var s=i.data;a=s.toString()}else r.setRequestHeader("Content-Type","multipart/form-data"),a=i.data;for(var l=i.requestHeaders.length,h=0;l>h;h++){var u=i.requestHeaders[h];r.setRequestHeader(u.name,u.value)}r.addEventListener(t.Event.COMPLETE,function(){o.data=r.response,t.Event.dispatchEvent(o,t.Event.COMPLETE)},this),r.addEventListener(t.IOErrorEvent.IO_ERROR,function(){t.IOErrorEvent.dispatchIOErrorEvent(o)},this),r.responseType=o.dataFormat==t.URLLoaderDataFormat.BINARY?t.HttpResponseType.ARRAY_BUFFER:t.HttpResponseType.TEXT,r.send(a)},o.prototype.getResponseType=function(e){switch(e){case t.URLLoaderDataFormat.TEXT:case t.URLLoaderDataFormat.VARIABLES:return t.URLLoaderDataFormat.TEXT;case t.URLLoaderDataFormat.BINARY:return"arraybuffer";default:return e}},o.prototype.loadSound=function(e){var i=e._request.url,o=new t.Sound;this.sound=o,o.addEventListener(t.Event.COMPLETE,this.onSoundoadComplete,this),o.addEventListener(t.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),o.addEventListener(t.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this),o.load(i)},o.prototype.onSoundoadComplete=function(e){var i=this;this.removeSoundLoaderListeners(),this.data=this.sound,window.setTimeout(function(){i.dispatchEventWith(t.Event.COMPLETE)},0)},o.prototype.onSoundLoaderPostProgress=function(t){this.dispatchEvent(t)},o.prototype.onSoundLoaderError=function(t){this.dispatchEvent(t)},o.prototype.removeSoundLoaderListeners=function(){this.sound.removeEventListener(t.Event.COMPLETE,this.onSoundoadComplete,this),this.sound.removeEventListener(t.IOErrorEvent.IO_ERROR,this.onSoundLoaderError,this),this.sound.removeEventListener(t.ProgressEvent.PROGRESS,this.onSoundLoaderPostProgress,this)},o.prototype.loadTexture=function(e){this.virtualUrl=e._request.url;var i=new t.ImageLoader;this.imageLoader=i,i.addEventListener(t.Event.COMPLETE,this.onImageLoadComplete,this),i.addEventListener(t.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),i.addEventListener(t.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this),i.load(this.virtualUrl)},o.prototype.onImageLoadComplete=function(e){var i=this;this.removeImageLoaderListeners();var o=new t.Texture,n=this.imageLoader.data;n.source.setAttribute&&n.source.setAttribute("bitmapSrc",this.virtualUrl),o._setBitmapData(n),this.data=o,window.setTimeout(function(){i.dispatchEventWith(t.Event.COMPLETE)},0)},o.prototype.onImageLoaderPostProgress=function(t){this.dispatchEvent(t)},o.prototype.onImageLoaderError=function(t){this.dispatchEvent(t)},o.prototype.removeImageLoaderListeners=function(){this.imageLoader.removeEventListener(t.Event.COMPLETE,this.onImageLoadComplete,this),this.imageLoader.removeEventListener(t.IOErrorEvent.IO_ERROR,this.onImageLoaderError,this),this.imageLoader.removeEventListener(t.ProgressEvent.PROGRESS,this.onImageLoaderPostProgress,this)},o.prototype.__recycle=function(){this._request=null,this.data=null},o}(t.EventDispatcher);t.URLLoader=i,__reflect(i.prototype,"egret.URLLoader")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){var o=e.call(this)||this;return o.$texture=null,o.offsetPoint=t.Point.create(0,0),o.$movieClipData=null,o.frames=null,o.$totalFrames=0,o.frameLabels=null,o.$frameLabelStart=0,o.$frameLabelEnd=0,o.frameEvents=null,o.frameIntervalTime=0,o.$eventPool=null,o.$isPlaying=!1,o.isStopped=!0,o.playTimes=0,o.$currentFrameNum=0,o.$nextFrameNum=1,o.displayedKeyFrameNum=0,o.passedTime=0,o.$frameRate=0/0,o.lastTime=0,o.$smoothing=t.Bitmap.defaultSmoothing,o.setMovieClipData(i),t.nativeRender||(o.$renderNode=new t.sys.NormalBitmapNode),o}return __extends(i,e),i.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(11)},Object.defineProperty(i.prototype,"smoothing",{get:function(){return this.$smoothing},set:function(t){t!=this.$smoothing&&(this.$smoothing=t)},enumerable:!0,configurable:!0}),i.prototype.$init=function(){this.$reset();var t=this.$movieClipData;t&&t.$isDataValid()&&(this.frames=t.frames,this.$totalFrames=t.numFrames,this.frameLabels=t.labels,this.frameEvents=t.events,this.$frameRate=t.frameRate,this.frameIntervalTime=1e3/this.$frameRate,this._initFrame())},i.prototype.$reset=function(){this.frames=null,this.playTimes=0,this.$isPlaying=!1,this.setIsStopped(!0),this.$currentFrameNum=0,this.$nextFrameNum=1,this.displayedKeyFrameNum=0,this.passedTime=0,this.$eventPool=[]},i.prototype._initFrame=function(){this.$movieClipData.$isTextureValid()&&(this.advanceFrame(),this.constructFrame())},i.prototype.$updateRenderNode=function(){var e=this.$texture;if(e){var i=Math.round(this.offsetPoint.x),o=Math.round(this.offsetPoint.y),n=e.$bitmapWidth,r=e.$bitmapHeight,a=e.$getTextureWidth(),s=e.$getTextureHeight(),l=Math.round(e.$getScaleBitmapWidth()),h=Math.round(e.$getScaleBitmapHeight()),u=e.$sourceWidth,c=e.$sourceHeight;t.sys.BitmapNode.$updateTextureData(this.$renderNode,e.$bitmapData,e.$bitmapX,e.$bitmapY,n,r,i,o,a,s,l,h,u,c,t.BitmapFillMode.SCALE,this.$smoothing)}},i.prototype.$measureContentBounds=function(t){var e=this.$texture;if(e){var i=this.offsetPoint.x,o=this.offsetPoint.y,n=e.$getTextureWidth(),r=e.$getTextureHeight();t.setTo(i,o,n,r)}else t.setEmpty()},i.prototype.$onAddToStage=function(t,i){e.prototype.$onAddToStage.call(this,t,i),this.$isPlaying&&this.$totalFrames>1&&this.setIsStopped(!1)},i.prototype.$onRemoveFromStage=function(){e.prototype.$onRemoveFromStage.call(this),this.setIsStopped(!0)},i.prototype.getFrameLabelByName=function(t,e){void 0===e&&(e=!1),e&&(t=t.toLowerCase());var i=this.frameLabels;if(i)for(var o=null,n=0;n<i.length;n++)if(o=i[n],e?o.name.toLowerCase()==t:o.name==t)return o;return null},i.prototype.getFrameStartEnd=function(t){var e=this.frameLabels;if(e)for(var i=null,o=0;o<e.length;o++)if(i=e[o],t==i.name){this.$frameLabelStart=i.frame,this.$frameLabelEnd=i.end;break}},i.prototype.getFrameLabelByFrame=function(t){var e=this.frameLabels;if(e)for(var i=null,o=0;o<e.length;o++)if(i=e[o],i.frame==t)return i;return null},i.prototype.getFrameLabelForFrame=function(t){var e=null,i=null,o=this.frameLabels;if(o)for(var n=0;n<o.length;n++){if(i=o[n],i.frame>t)return e;e=i}return e},i.prototype.play=function(e){void 0===e&&(e=0),this.lastTime=t.getTimer(),this.passedTime=0,this.$isPlaying=!0,this.setPlayTimes(e),this.$totalFrames>1&&this.$stage&&this.setIsStopped(!1)},i.prototype.stop=function(){this.$isPlaying=!1,this.setIsStopped(!0)},i.prototype.prevFrame=function(){this.gotoAndStop(this.$currentFrameNum-1)},i.prototype.nextFrame=function(){this.gotoAndStop(this.$currentFrameNum+1)
},i.prototype.gotoAndPlay=function(e,i){void 0===i&&(i=0),(0==arguments.length||arguments.length>2)&&t.$error(1022,"MovieClip.gotoAndPlay()"),"string"==typeof e?this.getFrameStartEnd(e):(this.$frameLabelStart=0,this.$frameLabelEnd=0),this.play(i),this.gotoFrame(e)},i.prototype.gotoAndStop=function(e){1!=arguments.length&&t.$error(1022,"MovieClip.gotoAndStop()"),this.stop(),this.gotoFrame(e)},i.prototype.gotoFrame=function(e){var i;"string"==typeof e?i=this.getFrameLabelByName(e).frame:(i=parseInt(e+"",10),i!=e&&t.$error(1022,"Frame Label Not Found")),1>i?i=1:i>this.$totalFrames&&(i=this.$totalFrames),i!=this.$nextFrameNum&&(this.$nextFrameNum=i,this.advanceFrame(),this.constructFrame(),this.handlePendingEvent())},i.prototype.advanceTime=function(e){var i=this,o=e-i.lastTime;i.lastTime=e;var n=i.frameIntervalTime,r=i.passedTime+o;i.passedTime=r%n;var a=r/n;if(1>a)return!1;for(;a>=1;){if(a--,i.$nextFrameNum++,i.$nextFrameNum>i.$totalFrames||i.$frameLabelStart>0&&i.$nextFrameNum>i.$frameLabelEnd)if(-1==i.playTimes)i.$eventPool.push(t.Event.LOOP_COMPLETE),i.$nextFrameNum=1;else{if(i.playTimes--,!(i.playTimes>0)){i.$nextFrameNum=i.$totalFrames,i.$eventPool.push(t.Event.COMPLETE),i.stop();break}i.$eventPool.push(t.Event.LOOP_COMPLETE),i.$nextFrameNum=1}i.$currentFrameNum==i.$frameLabelEnd&&(i.$nextFrameNum=i.$frameLabelStart),i.advanceFrame()}return i.constructFrame(),i.handlePendingEvent(),!1},i.prototype.advanceFrame=function(){this.$currentFrameNum=this.$nextFrameNum;var e=this.frameEvents[this.$nextFrameNum];e&&""!=e&&t.MovieClipEvent.dispatchMovieClipEvent(this,t.MovieClipEvent.FRAME_LABEL,e)},i.prototype.constructFrame=function(){var e=this,i=e.$currentFrameNum;if(e.displayedKeyFrameNum!=i){var o=e.$movieClipData.getTextureByFrame(i);if(e.$texture=o,e.$movieClipData.$getOffsetByFrame(i,e.offsetPoint),e.displayedKeyFrameNum=i,e.$renderDirty=!0,t.nativeRender)e.$nativeDisplayObject.setDataToBitmapNode(e.$nativeDisplayObject.id,o,[o.$bitmapX,o.$bitmapY,o.$bitmapWidth,o.$bitmapHeight,e.offsetPoint.x,e.offsetPoint.y,o.$getScaleBitmapWidth(),o.$getScaleBitmapHeight(),o.$sourceWidth,o.$sourceHeight]),e.$nativeDisplayObject.setWidth(o.$getTextureWidth()),e.$nativeDisplayObject.setHeight(o.$getTextureHeight());else{var n=e.$parent;n&&!n.$cacheDirty&&(n.$cacheDirty=!0,n.$cacheDirtyUp());var r=e.$maskedObject;r&&!r.$cacheDirty&&(r.$cacheDirty=!0,r.$cacheDirtyUp())}}},i.prototype.$renderFrame=function(){var t=this;t.$texture=t.$movieClipData.getTextureByFrame(t.$currentFrameNum),t.$renderDirty=!0;var e=t.$parent;e&&!e.$cacheDirty&&(e.$cacheDirty=!0,e.$cacheDirtyUp());var i=t.$maskedObject;i&&!i.$cacheDirty&&(i.$cacheDirty=!0,i.$cacheDirtyUp())},i.prototype.handlePendingEvent=function(){if(0!=this.$eventPool.length){this.$eventPool.reverse();for(var e=this.$eventPool,i=e.length,o=!1,n=!1,r=0;i>r;r++){var a=e.pop();a==t.Event.LOOP_COMPLETE?n=!0:a==t.Event.COMPLETE?o=!0:this.dispatchEventWith(a)}n&&this.dispatchEventWith(t.Event.LOOP_COMPLETE),o&&this.dispatchEventWith(t.Event.COMPLETE)}},Object.defineProperty(i.prototype,"totalFrames",{get:function(){return this.$totalFrames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrame",{get:function(){return this.$currentFrameNum},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentFrameLabel",{get:function(){var t=this.getFrameLabelByFrame(this.$currentFrameNum);return t&&t.name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentLabel",{get:function(){var t=this.getFrameLabelForFrame(this.$currentFrameNum);return t?t.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"frameRate",{get:function(){return this.$frameRate},set:function(t){t!=this.$frameRate&&(this.$frameRate=t,this.frameIntervalTime=1e3/this.$frameRate)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this.$isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"movieClipData",{get:function(){return this.$movieClipData},set:function(t){this.setMovieClipData(t)},enumerable:!0,configurable:!0}),i.prototype.setMovieClipData=function(t){this.$movieClipData!=t&&(this.$movieClipData=t,this.$init())},i.prototype.setPlayTimes=function(t){(0>t||t>=1)&&(this.playTimes=0>t?-1:Math.floor(t))},i.prototype.setIsStopped=function(e){this.isStopped!=e&&(this.isStopped=e,e?t.ticker.$stopTick(this.advanceTime,this):(this.playTimes=0==this.playTimes?1:this.playTimes,this.lastTime=t.getTimer(),t.ticker.$startTick(this.advanceTime,this)))},i}(t.DisplayObject);t.MovieClip=e,__reflect(e.prototype,"egret.MovieClip")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(i){void 0===i&&(i=null);var o=e.call(this)||this;return o.data=null,o.method=t.URLRequestMethod.GET,o.url="",o.requestHeaders=[],o.url=i,o}return __extends(i,e),i}(t.HashObject);t.URLRequest=e,__reflect(e.prototype,"egret.URLRequest")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(t,e){this.name="",this.value="",this.name=t,this.value=e}return t}();t.URLRequestHeader=e,__reflect(e.prototype,"egret.URLRequestHeader")}(egret||(egret={}));var egret;!function(t){var e=function(){function t(){}return t.GET="get",t.POST="post",t}();t.URLRequestMethod=e,__reflect(e.prototype,"egret.URLRequestMethod")}(egret||(egret={}));var egret;!function(t){var e=function(t){function e(e){void 0===e&&(e=null);var i=t.call(this)||this;return i.variables=null,null!==e&&i.decode(e),i}return __extends(e,t),e.prototype.decode=function(t){this.variables||(this.variables={}),t=t.split("+").join(" ");for(var e,i=/[?&]?([^=]+)=([^&]*)/g;e=i.exec(t);){var o=decodeURIComponent(e[1]),n=decodeURIComponent(e[2]);if(o in this.variables!=0){var r=this.variables[o];r instanceof Array?r.push(n):this.variables[o]=[r,n]}else this.variables[o]=n}},e.prototype.toString=function(){if(!this.variables)return"";var t=this.variables,e=[];for(var i in t)e.push(this.encodeValue(i,t[i]));return e.join("&")},e.prototype.encodeValue=function(t,e){return e instanceof Array?this.encodeArray(t,e):encodeURIComponent(t)+"="+encodeURIComponent(e)},e.prototype.encodeArray=function(t,e){return t?0==e.length?encodeURIComponent(t)+"=":e.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):""},e}(t.HashObject);t.URLVariables=e,__reflect(e.prototype,"egret.URLVariables")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){var o=e.call(this)||this;return o._timeScale=1,o._paused=!1,o._callIndex=-1,o._lastTime=0,o.callBackList=[],null!=i.instance,t.ticker.$startTick(o.update,o),o._lastTime=t.getTimer(),o}return __extends(i,e),i.prototype.update=function(t){var e=t-this._lastTime;if(this._lastTime=t,this._paused)return!1;var i=e*this._timeScale;for(this._callList=this.callBackList.concat(),this._callIndex=0;this._callIndex<this._callList.length;this._callIndex++){var o=this._callList[this._callIndex];o.listener.call(o.thisObject,i)}return this._callIndex=-1,this._callList=null,!1},i.prototype.register=function(t,e,i){void 0===i&&(i=0),this.$insertEventBin(this.callBackList,"",t,e,!1,i,!1)},i.prototype.unregister=function(t,e){this.$removeEventBin(this.callBackList,t,e)},i.prototype.setTimeScale=function(t){this._timeScale=t},i.prototype.getTimeScale=function(){return this._timeScale},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){this._paused=!1},i.getInstance=function(){return null==i.instance&&(i.instance=new i),i.instance},i}(t.EventDispatcher);t.Ticker=e,__reflect(e.prototype,"egret.Ticker")}(egret||(egret={}));var egret;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),Object.defineProperty(i.prototype,"stage",{get:function(){return t.sys.$TempStage},enumerable:!0,configurable:!0}),Object.defineProperty(i,"instance",{get:function(){return null==i._instance&&(i._instance=new i),i._instance},enumerable:!0,configurable:!0}),i.deviceType=null,i.DEVICE_PC="web",i.DEVICE_MOBILE="native",i}(t.EventDispatcher);t.MainContext=e,__reflect(e.prototype,"egret.MainContext")}(egret||(egret={})),egret.testDeviceType1=function(){if(!window.navigator||!navigator)return!0;var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("mobile")||-1!=t.indexOf("android")},egret.MainContext.deviceType=egret.testDeviceType1()?egret.MainContext.DEVICE_MOBILE:egret.MainContext.DEVICE_PC,delete egret.testDeviceType1;var egret;!function(t){var e=function(e){function i(t){void 0===t&&(t=300);var i=e.call(this)||this;return i.objectPool=[],i._length=0,1>t&&(t=1),i.autoDisposeTime=t,i.frameCount=0,i}return __extends(i,e),i.$init=function(){t.ticker.$startTick(i.onUpdate,i)},i.onUpdate=function(t){for(var e=i._callBackList,o=e.length-1;o>=0;o--)e[o].$checkFrame();return!1},i.prototype.$checkFrame=function(){this.frameCount--,this.frameCount<=0&&this.dispose()},Object.defineProperty(i.prototype,"length",{get:function(){return this._length},enumerable:!0,configurable:!0}),i.prototype.push=function(t){var e=this.objectPool;-1==e.indexOf(t)&&(e.push(t),t.__recycle&&t.__recycle(),this._length++,0==this.frameCount&&(this.frameCount=this.autoDisposeTime,i._callBackList.push(this)))},i.prototype.pop=function(){return 0==this._length?null:(this._length--,this.objectPool.pop())},i.prototype.dispose=function(){this._length>0&&(this.objectPool=[],this._length=0),this.frameCount=0;var t=i._callBackList,e=t.indexOf(this);-1!=e&&t.splice(e,1)},i._callBackList=[],i}(t.HashObject);t.Recycler=e,__reflect(e.prototype,"egret.Recycler"),e.$init()}(egret||(egret={}));var egret;!function(t){function e(e,i,l){for(var h=[],u=3;u<arguments.length;u++)h[u-3]=arguments[u];var c={listener:e,thisObject:i,delay:l,originDelay:l,params:h};return a++,1==a&&(s=t.getTimer(),t.ticker.$startTick(o,null)),r++,n[r]=c,r}function i(e){n[e]&&(a--,delete n[e],0==a&&t.ticker.$stopTick(o,null))}function o(t){var e=t-s;s=t;for(var i in n){var o=n[i];o.delay-=e,o.delay<=0&&(o.delay=o.originDelay,o.listener.apply(o.thisObject,o.params))}return!1}var n={},r=0,a=0,s=0;t.setInterval=e,t.clearInterval=i}(egret||(egret={}));var egret;!function(t){function e(e,i,l){for(var h=[],u=3;u<arguments.length;u++)h[u-3]=arguments[u];var c={listener:e,thisObject:i,delay:l,params:h};return a++,1==a&&t.ticker&&(s=t.getTimer(),t.ticker.$startTick(o,null)),r++,n[r]=c,r}function i(e){n[e]&&(a--,delete n[e],0==a&&t.ticker&&t.ticker.$stopTick(o,null))}function o(t){var e=t-s;s=t;for(var o in n){var r=o,a=n[r];a.delay-=e,a.delay<=0&&(i(r),a.listener.apply(a.thisObject,a.params))}return!1}var n={},r=0,a=0,s=0;t.setTimeout=e,t.clearTimeout=i}(egret||(egret={}));var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},__decorate=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=3>r?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(3>r?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},egret;!function(t){var e=function(e){function i(t,i,o){var n=e.call(this)||this;return n._target=null,n._useTicks=!1,n.ignoreGlobalPause=!1,n.loop=!1,n.pluginData=null,n._steps=null,n.paused=!1,n.duration=0,n._prevPos=-1,n.position=null,n._prevPosition=0,n._stepPosition=0,n.passive=!1,n.initialize(t,i,o),n}return __extends(i,e),i.get=function(t,e,o,n){return void 0===o&&(o=null),void 0===n&&(n=!1),n&&i.removeTweens(t),new i(t,e,o)},i.removeTweens=function(t){if(t.tween_count){for(var e=i._tweens,o=e.length-1;o>=0;o--)e[o]._target==t&&(e[o].paused=!0,e.splice(o,1));t.tween_count=0}},i.pauseTweens=function(e){if(e.tween_count)for(var i=t.Tween._tweens,o=i.length-1;o>=0;o--)i[o]._target==e&&(i[o].paused=!0)},i.resumeTweens=function(e){if(e.tween_count)for(var i=t.Tween._tweens,o=i.length-1;o>=0;o--)i[o]._target==e&&(i[o].paused=!1)},i.tick=function(t,e){void 0===e&&(e=!1);var o=t-i._lastTime;i._lastTime=t;for(var n=i._tweens.concat(),r=n.length-1;r>=0;r--){var a=n[r];e&&!a.ignoreGlobalPause||a.paused||a.$tick(a._useTicks?1:o)}return!1},i._register=function(e,o){var n=e._target,r=i._tweens;if(o)n&&(n.tween_count=n.tween_count>0?n.tween_count+1:1),r.push(e),i._inited||(i._lastTime=t.getTimer(),t.ticker.$startTick(i.tick,null),i._inited=!0);else{n&&n.tween_count--;for(var a=r.length;a--;)if(r[a]==e)return void r.splice(a,1)}},i.removeAllTweens=function(){for(var t=i._tweens,e=0,o=t.length;o>e;e++){var n=t[e];n.paused=!0,n._target.tween_count=0}t.length=0},i.prototype.initialize=function(t,e,o){this._target=t,e&&(this._useTicks=e.useTicks,this.ignoreGlobalPause=e.ignoreGlobalPause,this.loop=e.loop,e.onChange&&this.addEventListener("change",e.onChange,e.onChangeObj),e.override&&i.removeTweens(t)),this.pluginData=o||{},this._curQueueProps={},this._initQueueProps={},this._steps=[],e&&e.paused?this.paused=!0:i._register(this,!0),e&&null!=e.position&&this.setPosition(e.position,i.NONE)},i.prototype.setPosition=function(t,e){void 0===e&&(e=1),0>t&&(t=0);var i=t,o=!1;if(i>=this.duration)if(this.loop){var n=i%this.duration;i=i>0&&0===n?this.duration:n}else i=this.duration,o=!0;if(i==this._prevPos)return o;o&&this.setPaused(!0);var r=this._prevPos;if(this.position=this._prevPos=i,this._prevPosition=t,this._target&&this._steps.length>0){for(var a=this._steps.length,s=-1,l=0;a>l&&!("step"==this._steps[l].type&&(s=l,this._steps[l].t<=i&&this._steps[l].t+this._steps[l].d>=i));l++);for(var l=0;a>l;l++)if("action"==this._steps[l].type)0!=e&&(this._useTicks?this._runAction(this._steps[l],i,i):1==e&&r>i?(r!=this.duration&&this._runAction(this._steps[l],r,this.duration),this._runAction(this._steps[l],0,i,!0)):this._runAction(this._steps[l],r,i));else if("step"==this._steps[l].type&&s==l){var h=this._steps[s];this._updateTargetProps(h,Math.min((this._stepPosition=i-h.t)/h.d,1))}}return this.dispatchEventWith("change"),o},i.prototype._runAction=function(t,e,i,o){void 0===o&&(o=!1);var n=e,r=i;e>i&&(n=i,r=e);var a=t.t;(a==r||a>n&&r>a||o&&a==e)&&t.f.apply(t.o,t.p)},i.prototype._updateTargetProps=function(t,e){var o,n,r,a,s,l;if(t||1!=e){if(this.passive=!!t.v,this.passive)return;t.e&&(e=t.e(e,0,1,1)),o=t.p0,n=t.p1}else this.passive=!1,o=n=this._curQueueProps;for(var h in this._initQueueProps){null==(a=o[h])&&(o[h]=a=this._initQueueProps[h]),null==(s=n[h])&&(n[h]=s=a),r=a==s||0==e||1==e||"number"!=typeof a?1==e?s:a:a+(s-a)*e;var u=!1;if(l=i._plugins[h])for(var c=0,p=l.length;p>c;c++){var d=l[c].tween(this,h,r,o,n,e,!!t&&o==n,!t);d==i.IGNORE?u=!0:r=d}u||(this._target[h]=r)}},i.prototype.setPaused=function(t){return this.paused==t?this:(this.paused=t,i._register(this,!t),this)},i.prototype._cloneProps=function(t){var e={};for(var i in t)e[i]=t[i];return e},i.prototype._addStep=function(t){return t.d>0&&(t.type="step",this._steps.push(t),t.t=this.duration,this.duration+=t.d),this},i.prototype._appendQueueProps=function(t){var e,o,n,r,a;for(var s in t)if(void 0===this._initQueueProps[s]){if(o=this._target[s],e=i._plugins[s])for(n=0,r=e.length;r>n;n++)o=e[n].init(this,s,o);this._initQueueProps[s]=this._curQueueProps[s]=void 0===o?null:o}else o=this._curQueueProps[s];for(var s in t){if(o=this._curQueueProps[s],e=i._plugins[s])for(a=a||{},n=0,r=e.length;r>n;n++)e[n].step&&e[n].step(this,s,o,t[s],a);this._curQueueProps[s]=t[s]}return a&&this._appendQueueProps(a),this._curQueueProps},i.prototype._addAction=function(t){return t.t=this.duration,t.type="action",this._steps.push(t),this},i.prototype._set=function(t,e){for(var i in t)e[i]=t[i]},i.prototype.wait=function(t,e){if(null==t||0>=t)return this;var i=this._cloneProps(this._curQueueProps);return this._addStep({d:t,p0:i,p1:i,v:e})},i.prototype.to=function(t,e,i){return void 0===i&&(i=void 0),(isNaN(e)||0>e)&&(e=0),this._addStep({d:e||0,p0:this._cloneProps(this._curQueueProps),e:i,p1:this._cloneProps(this._appendQueueProps(t))}),this.set(t)},i.prototype.call=function(t,e,i){return void 0===e&&(e=void 0),void 0===i&&(i=void 0),this._addAction({f:t,p:i?i:[],o:e?e:this._target})},i.prototype.set=function(t,e){return void 0===e&&(e=null),this._appendQueueProps(t),this._addAction({f:this._set,o:this,p:[t,e?e:this._target]})},i.prototype.play=function(t){return t||(t=this),this.call(t.setPaused,t,[!1])},i.prototype.pause=function(t){return t||(t=this),this.call(t.setPaused,t,[!0])},i.prototype.$tick=function(t){this.paused||this.setPosition(this._prevPosition+t)},i.NONE=0,i.LOOP=1,i.REVERSE=2,i._tweens=[],i.IGNORE={},i._plugins={},i._inited=!1,i._lastTime=0,i}(t.EventDispatcher);t.Tween=e,__reflect(e.prototype,"egret.Tween")}(egret||(egret={}));var RES;!function(t){}(RES||(RES={}));var RES;!function(t){function e(e){var i=t.config.config.fileSystem.getFile(e);return i||(e=t.resourceNameSelector(e),i=t.config.config.fileSystem.getFile(e)),i}function i(t,e){var i;i=t.indexOf(".json")>=0?"legacyResourceConfig":"resourceConfig",o={type:i,root:e,url:t,name:t}}t.resourceNameSelector=function(t){return t},t.getResourceInfo=e;var o;t.setConfigURL=i;var n=function(){function i(){}return i.prototype.init=function(){return this.config||(this.config={alias:{},groups:{},resourceRoot:o.root,mergeSelector:null,fileSystem:null,loadGroup:[]}),t.queue.pushResItem(o)["catch"](function(e){return t.isCompatible||e.__resource_manager_error__||(e.error?console.error(e.error.stack):console.error(e.stack),e=new t.ResourceManagerError(1002)),t.host.remove(o),Promise.reject(e)})},i.prototype.getGroupByName=function(e){var i=this.config.groups[e],o=[];if(!i)return o;for(var n=0,r=i;n<r.length;n++){var a=r[n],s=void 0;if(s=t.config.getResourceWithSubkey(a),null!=s){var l=s.r,h=s.key;if(null==l)throw new t.ResourceManagerError(2005,h);-1==o.indexOf(l)&&o.push(l)}}return o},i.prototype.__temp__get__type__via__url=function(e){var i=this.config.alias[e];if(i||(i=e),t.typeSelector){var o=t.typeSelector(i);if(!o)throw new t.ResourceManagerError(2004,i);return o}return console.warn("RES.mapConfig 并未设置 typeSelector"),"unknown"},i.prototype.getResourceWithSubkey=function(t){t=this.getKeyByAlias(t);var e=t.indexOf("#"),i="";e>=0&&(i=t.substr(e+1),t=t.substr(0,e));var o=this.getResource(t);return o?{r:o,key:t,subkey:i}:null},i.prototype.getKeyByAlias=function(t){return this.config.alias[t]?this.config.alias[t]:t},i.prototype.getResource=function(t){var i=this.config.alias[t];i||(i=t);var o=e(i);return o?o:null},i.prototype.createGroup=function(t,e,i){if(void 0===i&&(i=!1),!i&&this.config.groups[t]||!e||0==e.length)return!1;for(var o=[],n=0,r=e;n<r.length;n++){var a=r[n];if(this.config.groups[a]){var s=this.config.groups[a];o=o.concat(s)}else o.push(a)}return this.config.groups[t]=o,!0},i.prototype.addSubkey=function(t,e){this.addAlias(t,e+"#"+t)},i.prototype.addAlias=function(t,e){this.config.alias[e]&&(e=this.config.alias[e]),this.config.alias[t]=e},i.prototype.addResourceData=function(e){t.hasRes(e.name)||(e.type||(e.type=this.__temp__get__type__via__url(e.url)),t.config.config.fileSystem.addFile(e))},i.prototype.removeResourceData=function(e){t.hasRes(e.name)&&(t.config.config.fileSystem.removeFile(e.url),this.config.alias[e.name]&&delete this.config.alias[e.name])},i}();t.ResourceConfig=n,__reflect(n.prototype,"RES.ResourceConfig")}(RES||(RES={}));var RES;!function(t){var e=function(){function e(){this.groupTotalDic={},this.numLoadedDic={},this.groupErrorDic={},this.retryTimesDic={},this.maxRetryTimes=3,this.reporterDic={},this.dispatcherDic={},this.failedList=new Array,this.loadItemErrorDic={},this.errorDic={},this.itemListPriorityDic={},this.itemLoadDic={},this.promiseHash={},this.lazyLoadList=new Array,this.loadingCount=0,this.thread=4}return e.prototype.pushResItem=function(t){if(this.promiseHash[t.root+t.name])return this.promiseHash[t.root+t.name];this.lazyLoadList.push(t),this.itemListPriorityDic[Number.NEGATIVE_INFINITY]=this.lazyLoadList,this.updatelistPriority(this.lazyLoadList,Number.NEGATIVE_INFINITY);var e=new egret.EventDispatcher;this.dispatcherDic[t.root+t.name]=e;var i=new Promise(function(t,i){e.addEventListener("complete",function(e){t(e.data)},null),e.addEventListener("error",function(t){i(t.data)},null)});return this.promiseHash[t.root+t.name]=i,this.loadNextResource(),i},e.prototype.pushResGroup=function(t,e,i,o){if(this.promiseHash[e])return this.promiseHash[e];for(var n=t.length,r=0;n>r;r++){var a=t[r];a.groupNames||(a.groupNames=[]),a.groupNames.push(e)}this.groupTotalDic[e]=t.length,this.numLoadedDic[e]=0,this.updatelistPriority(t,i),this.reporterDic[e]=o;var s=new egret.EventDispatcher;this.dispatcherDic[e]=s;var l=new Promise(function(t,e){s.addEventListener("complete",t,null),s.addEventListener("error",function(t){e(t.data)},null)});return this.promiseHash[e]=l,this.loadNextResource(),l},e.prototype.updatelistPriority=function(t,e){void 0==this.itemListPriorityDic[e]&&(this.itemListPriorityDic[e]=[]);for(var i=0,o=t;i<o.length;i++){var n=o[i];if(1!=this.itemLoadDic[n.root+n.name]){var r=this.findPriorityInDic(n);if(void 0==r)this.itemListPriorityDic[e].push(n);else if(e>r){this.itemListPriorityDic[e].push(n);var a=this.itemListPriorityDic[r].indexOf(n);this.itemListPriorityDic[r].splice(a,1)}}}},e.prototype.findPriorityInDic=function(t){for(var e in this.itemListPriorityDic)if(this.itemListPriorityDic[e].indexOf(t)>-1)return parseInt(e)},e.prototype.loadNextResource=function(){for(;this.loadingCount<this.thread;){var t=this.loadSingleResource();if(!t)break}},e.prototype.loadSingleResource=function(){var e=this,i=this.getOneResourceInfoInGroup();return i?(this.itemLoadDic[i.root+i.name]=1,this.loadingCount++,this.loadResource(i).then(function(o){if(e.loadingCount--,delete e.itemLoadDic[i.root+i.name],t.host.save(i,o),e.promiseHash[i.root+i.name]){var n=e.deleteDispatcher(i.root+i.name);n.dispatchEventWith("complete",!1,o)}var r=i.groupNames;if(r){delete i.groupNames;for(var a=0,s=r;a<s.length;a++){var l=s[a];e.setGroupProgress(l,i)&&e.loadGroupEnd(l)}}e.loadNextResource()})["catch"](function(o){if(!o)throw i.name+" load fail";if(!o.__resource_manager_error__)throw o;delete e.itemLoadDic[i.root+i.name],e.loadingCount--,delete t.host.state[i.root+i.name];var n=e.retryTimesDic[i.name]||1;if(!(n>e.maxRetryTimes))return e.retryTimesDic[i.name]=n+1,e.failedList.push(i),void e.loadNextResource();if(delete e.retryTimesDic[i.name],e.promiseHash[i.root+i.name]){var r=e.deleteDispatcher(i.root+i.name);r.dispatchEventWith("error",!1,{r:i,error:o})}var a=i.groupNames;if(a){delete i.groupNames;for(var s=0,l=a;s<l.length;s++){var h=l[s];e.loadItemErrorDic[h]||(e.loadItemErrorDic[h]=[]),-1==e.loadItemErrorDic[h].indexOf(i)&&e.loadItemErrorDic[h].push(i),e.groupErrorDic[h]=!0,e.setGroupProgress(h,i)?e.loadGroupEnd(h,o):e.errorDic[h]=o}}e.loadNextResource()}),!0):!1},e.prototype.getOneResourceInfoInGroup=function(){if(this.failedList.length>0)return this.failedList.shift();var t=Number.NEGATIVE_INFINITY;for(var e in this.itemListPriorityDic)t=Math.max(t,e);var i=this.itemListPriorityDic[t];return i?0==i.length?(delete this.itemListPriorityDic[t],this.getOneResourceInfoInGroup()):i.shift():void 0},e.prototype.setGroupProgress=function(t,e){var i=this.reporterDic[t];this.numLoadedDic[t]++;var o=this.numLoadedDic[t],n=this.groupTotalDic[t];return i&&i.onProgress&&i.onProgress(o,n,e),o==n},e.prototype.loadGroupEnd=function(t,e){delete this.groupTotalDic[t],delete this.numLoadedDic[t],delete this.reporterDic[t];var i=this.deleteDispatcher(t);if(e){delete this.groupErrorDic[t];var o=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t],i.dispatchEventWith("error",!1,{itemList:o,lastError:e})}else{var n=this.groupErrorDic[t];if(delete this.groupErrorDic[t],n){var o=this.loadItemErrorDic[t];delete this.loadItemErrorDic[t];var r=this.errorDic[t];delete this.errorDic[t],i.dispatchEventWith("error",!1,{itemList:o,error:r})}else i.dispatchEventWith("complete")}},e.prototype.deleteDispatcher=function(t){delete this.promiseHash[t];var e=this.dispatcherDic[t];return delete this.dispatcherDic[t],e},e.prototype.loadResource=function(e,i){if(!i){if(1==t.FEATURE_FLAG.FIX_DUPLICATE_LOAD){var o=t.host.state[e.root+e.name];if(2==o)return Promise.resolve(t.host.get(e));if(1==o)return e.promise}i=t.processor.isSupport(e)}if(!i)throw new t.ResourceManagerError(2001,e.name,e.type);t.host.state[e.root+e.name]=1;var n=i.onLoadStart(t.host,e);return e.promise=n,n},e.prototype.unloadResource=function(e){var i=t.host.get(e);if(!i)return console.warn("尝试释放不存在的资源:",e.name),!1;var o=t.processor.isSupport(e);return o?(o.onRemoveStart(t.host,e),t.host.remove(e),1==e.extra&&t.config.removeResourceData(e),!0):!0},e}();t.ResourceLoader=e,__reflect(e.prototype,"RES.ResourceLoader")}(RES||(RES={}));var RES;!function(t){var e;!function(e){function i(t){return e._map[t.type]}function o(t,i){e._map[t]=i}function n(e,i){var o=this;return new Promise(function(n,r){var a=function(){var t=e.data?e.data:e.response;n(t)},s=function(){var e=new t.ResourceManagerError(1001,i.url);r(e)};e.addEventListener(egret.Event.COMPLETE,a,o),e.addEventListener(egret.IOErrorEvent.IO_ERROR,s,o)})}function r(t,e){if(-1!=e.indexOf("://"))return e;t=t.split("\\").join("/");var i=t.match(/#.*|\?.*/),o="";i&&(o=i[0]);var n=t.lastIndexOf("/");return t=-1!=n?t.substring(0,n+1)+e:e,t+o}function a(t){return{name:t.name+"_alpha",url:t.etc1_alpha_url,type:"ktx",root:t.root}}e.isSupport=i,e.map=o,e.getRelativePath=r,e.ImageProcessor={onLoadStart:function(e,i){var o=new egret.ImageLoader;return o.load(t.getVirtualUrl(i.root+i.url)),n(o,i).then(function(t){var o=new egret.Texture;o._setBitmapData(t);var n=e.resourceConfig.getResource(i.name);if(n&&n.scale9grid){var r=n.scale9grid.split(",");o.scale9Grid=new egret.Rectangle(parseInt(r[0]),parseInt(r[1]),parseInt(r[2]),parseInt(r[3]))}return o})},onRemoveStart:function(t,e){var i=t.get(e);i.dispose()}},e.KTXTextureProcessor={onLoadStart:function(t,e){return t.load(e,"bin").then(function(i){if(!i)return console.error("ktx:"+e.root+e.url+" is null"),null;var o=new egret.KTXContainer(i,1);if(o.isInvalid)return console.error("ktx:"+e.root+e.url+" is invalid"),null;var n=new egret.BitmapData(i);n.debugCompressedTextureURL=e.root+e.url,n.format="ktx",o.uploadLevels(n,!1);var r=new egret.Texture;r._setBitmapData(n);var a=t.resourceConfig.getResource(e.name);if(a&&a.scale9grid){var s=a.scale9grid.split(",");r.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}return t.save(e,r),r},function(i){throw t.remove(e),i})},onRemoveStart:function(t,e){var i=t.get(e);i&&i.dispose()}},e.makeEtc1SeperatedAlphaResourceInfo=a,e.ETC1KTXProcessor={onLoadStart:function(t,e){return t.load(e,"ktx").then(function(i){if(!i)return null;if(e.etc1_alpha_url){var o=a(e);return t.load(o,"ktx").then(function(e){return i&&i.$bitmapData&&e.$bitmapData?(i.$bitmapData.etcAlphaMask=e.$bitmapData,t.save(o,e)):t.remove(o),i},function(e){throw t.remove(o),e})}return i},function(i){throw t.remove(e),i})},onRemoveStart:function(t,e){var i=t.get(e);if(i&&i.dispose(),e.etc1_alpha_url){var o=a(e),n=t.get(o);n&&n.dispose(),t.unload(o)}}},e.BinaryProcessor={onLoadStart:function(e,i){var o=new egret.HttpRequest;return o.responseType=egret.HttpResponseType.ARRAY_BUFFER,o.open(t.getVirtualUrl(i.root+i.url),"get"),o.send(),n(o,i)},onRemoveStart:function(t,e){}},e.TextProcessor={onLoadStart:function(e,i){var o=new egret.HttpRequest;return o.responseType=egret.HttpResponseType.TEXT,o.open(t.getVirtualUrl(i.root+i.url),"get"),o.send(),n(o,i)},onRemoveStart:function(t,e){return!0}},e.JsonProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var e=JSON.parse(t);return e})},onRemoveStart:function(t,e){}},e.XMLProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var e=egret.XML.parse(t);return e})},onRemoveStart:function(t,e){return!0}},e.CommonJSProcessor={onLoadStart:function(e,i){return e.load(i,"text").then(function(e){var o=new Function("require","exports",e),n=function(){},r={};try{o(n,r)}catch(a){throw new t.ResourceManagerError(2003,i.name,a.message)}return r})},onRemoveStart:function(t,e){}},e.SheetProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(o){var n=e.resourceConfig.getResource(t.nameSelector(o.file));if(!n){var a=r(i.url,o.file);n={name:a,url:a,type:"image",root:i.root}}return e.load(n).then(function(t){if(!t)return null;var i=o.frames,r=new egret.SpriteSheet(t);r.$resourceInfo=n;for(var a in i){var s=i[a],l=r.createTexture(a,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);if(s.scale9grid){var h=s.scale9grid,u=h.split(",");l.scale9Grid=new egret.Rectangle(parseInt(u[0]),parseInt(u[1]),parseInt(u[2]),parseInt(u[3]))}}return e.save(n,t),r},function(t){throw e.remove(n),t})})},getData:function(t,e,i,o){var n=t.get(e);return n?n.getTexture(o):null},onRemoveStart:function(t,e){var i=t.get(e),o=i.$resourceInfo;i.dispose(),t.unload(o)}};var s=function(t,e){var i="",o=e.split("\n"),n=o[2],r=n.indexOf('file="');-1!=r&&(n=n.substring(r+6),r=n.indexOf('"'),i=n.substring(0,r)),t=t.split("\\").join("/");var r=t.lastIndexOf("/");return t=-1!=r?t.substring(0,r+1)+i:i};e.FontProcessor={onLoadStart:function(e,i){return e.load(i,"text").then(function(o){var n;try{n=JSON.parse(o)}catch(a){n=o}var l;l="string"==typeof n?s(i.url,n):r(i.url,n.file);var h=e.resourceConfig.getResource(t.nameSelector(l));return h||(h={name:l,url:l,type:"image",root:i.root}),e.load(h).then(function(t){var i=new egret.BitmapFont(t,n);return i.$resourceInfo=h,e.save(h,t),i},function(t){throw e.remove(h),t})})},onRemoveStart:function(t,e){var i=t.get(e),o=i.$resourceInfo;t.unload(o)}},e.SoundProcessor={onLoadStart:function(e,i){var o=new egret.Sound;return o.load(t.getVirtualUrl(i.root+i.url)),n(o,i).then(function(){return o})},onRemoveStart:function(t,e){var i=t.get(e);i.close()}},e.MovieClipProcessor={onLoadStart:function(e,i){var o,n;return e.load(i,"json").then(function(r){o=r;var a=i.name,s=a.substring(0,a.lastIndexOf("."))+".png";if(n=e.resourceConfig.getResource(s),!n)throw new t.ResourceManagerError(1001,s);return e.load(n)}).then(function(t){e.save(n,t);var i=t,r=new egret.MovieClipDataFactory(o,i);return r})},onRemoveStart:function(t,e){var i=t.get(e);i.clearCache(),i.$spriteSheet.dispose();var o=e.name,n=o.substring(0,o.lastIndexOf("."))+".png",r=t.resourceConfig.getResource(n);r&&t.unload(r)}},e.MergeJSONProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(e){for(var o in e)t.config.addSubkey(o,i.name);return e})},getData:function(t,e,i,o){var n=t.get(e);return n?n[o]:(console.error("missing resource :"+e.name),null)},onRemoveStart:function(t,e){}},e.TTFProcessor={onLoadStart:function(t,e){return t.load(e,"bin").then(function(t){egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(egret.sys.fontResourceCache||(egret.sys.fontResourceCache={}),egret.sys.fontResourceCache[e.root+e.url]=t)})},onRemoveStart:function(t,e){if(egret.Capabilities.runtimeType==egret.RuntimeType.WEB){var i=egret.sys.fontResourceCache;i&&i[e.url]&&(i[e.root+e.url]=null)}}},e.LegacyResourceConfigProcessor={onLoadStart:function(e,i){return e.load(i,"json").then(function(o){var n=t.config.config,r=i.root,a=n.fileSystem;a||(a={fsData:{},getFile:function(t){return p[t]},addFile:function(t){t.type||(t.type=""),void 0==r&&(t.root=""),p[t.name]=t},profile:function(){console.log(p)},removeFile:function(t){delete p[t]}},n.fileSystem=a);for(var s=n.groups,l=0,h=o.groups;l<h.length;l++){var u=h[l];""==u.keys?s[u.name]=[]:s[u.name]=u.keys.split(",")}for(var c=n.alias,p=a.fsData,d=function(t){p[t.name]=t,p[t.name].root=r,t.subkeys&&t.subkeys.split(",").forEach(function(e){c[e]=t.name+"#"+e,c[t.name+"."+e]=t.name+"#"+e})},g=0,f=o.resources;g<f.length;g++){var m=f[g];d(m)}return e.save(i,o),o})},onRemoveStart:function(){}},e._map={image:e.ImageProcessor,json:e.JsonProcessor,text:e.TextProcessor,xml:e.XMLProcessor,sheet:e.SheetProcessor,font:e.FontProcessor,bin:e.BinaryProcessor,commonjs:e.CommonJSProcessor,sound:e.SoundProcessor,movieclip:e.MovieClipProcessor,mergeJson:e.MergeJSONProcessor,legacyResourceConfig:e.LegacyResourceConfigProcessor,ktx:e.KTXTextureProcessor,"etc1.ktx":e.ETC1KTXProcessor,"pvrtc.ktx":e.KTXTextureProcessor,ttf:e.TTFProcessor}
}(e=t.processor||(t.processor={}))}(RES||(RES={}));var RES;!function(t){var e;!function(e){function i(e){var i=e.name;if(t.config.config)for(var o in t.config.config.alias)t.config.config.alias[o]==e.url&&(i=o);else i=e.url;var n={name:i,url:e.url,type:e.type,data:e,root:e.root};return n}e.TYPE_XML="xml",e.TYPE_IMAGE="image",e.TYPE_BIN="bin",e.TYPE_TEXT="text",e.TYPE_JSON="json",e.TYPE_SHEET="sheet",e.TYPE_FONT="font",e.TYPE_SOUND="sound",e.TYPE_TTF="ttf",e.convertToResItem=i}(e=t.ResourceItem||(t.ResourceItem={}))}(RES||(RES={}));var RES;!function(t){t.checkNull=function(t,e,i){var o=i.value;i.value=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t[0]?o.apply(this,t):(console.warn("方法"+e+"的参数不能为null"),null)}},t.FEATURE_FLAG={FIX_DUPLICATE_LOAD:1};var e;!function(t){function e(t){i=t}var i="warning";t.setUpgradeGuideLevel=e}(e=t.upgrade||(t.upgrade={}))}(RES||(RES={}));var egret;!function(t){}(egret||(egret={}));var Tween=egret.Tween,ArrayCollection=eui.ArrayCollection;String.prototype.format=function(t){var e=this;if(arguments.length>0)if(1==arguments.length&&"object"==typeof t){for(var i in t)if(void 0!=t[i]){var o=new RegExp("({"+i+"})","g");e=e.replace(o,t[i])}}else for(var n=0;n<arguments.length;n++)if(void 0!=arguments[n]){var o=new RegExp("({)"+n+"(})","g");e=e.replace(o,arguments[n])}return e};var BasePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.msgObject={},e._longPress=[],e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.addCustomEvent=function(t,e){var i=""+t;this.msgObject[i]=!0,EventMgr.addListener(t,e,this)},e.prototype.removeCustomEvents=function(){var t=Object.keys(this.msgObject);t&&t.length&&(EventMgr.ins().removeAll(this,t),this.msgObject={})},e.prototype.addLongPress=function(t,e){-1==this._longPress.indexOf(t.hashCode)&&(this._longPress.push(t.hashCode),LongPressUtils.ins().addLongPress(t,e,this))},e.prototype.removeLongPress=function(){for(var t=this._longPress.length,e=0;t>e;e++)LongPressUtils.ins().removeLongPress(this._longPress[e]);this._longPress.length=0},e.prototype.addEvent=function(t,e,i,o){return void 0===o&&(o=this),e?void e.addEventListener(t,i,o):void debug.error("Not binding object")},e.prototype.removeEvent=function(t,e,i,o){void 0===o&&(o=this),e&&e.removeEventListener(t,i,o)},e.prototype.addEventTouchTap=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e,i)},e.prototype.removeEventTouchTap=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_TAP,t,e,i)},e.prototype.addEventTouchEnd=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_END,t,e,i)},e.prototype.removeEventTouchEnd=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_END,t,e,i)},e.prototype.addEventChange=function(t,e,i){void 0===i&&(i=this),t&&t instanceof eui.TabBar?(this.tabClickFunc=this.tabClickFunc||{},this.tabClickFunc[t.hashCode]=e,this.addEvent(egret.TouchEvent.CHANGE,t,this.onChangeTap,this)):this.addEvent(egret.TouchEvent.CHANGE,t,e,i)},e.prototype.onChangeTap=function(t){this.tabClickFunc[t.currentTarget.hashCode]&&this.tabClickFunc[t.currentTarget.hashCode].call(this,t)},e.prototype.removeEventChange=function(t,e,i){void 0===i&&(i=this),t&&t instanceof eui.TabBar?this.removeEvent(egret.TouchEvent.CHANGE,t,this.onChangeTap,this):this.removeEvent(egret.TouchEvent.CHANGE,t,e,i)},e.prototype.addEventChanging=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.CHANGING,t,e,i)},e.prototype.removeEventChanging=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.CHANGING,t,e,i)},e.prototype.addEventItemTap=function(t,e,i){void 0===i&&(i=this),this.addEvent(eui.ItemTapEvent.ITEM_TAP,t,e,i)},e.prototype.removeEventItemTap=function(t,e,i){void 0===i&&(i=this),this.removeEvent(eui.ItemTapEvent.ITEM_TAP,t,e,i)},e.prototype.addEventAddedFromStage=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.Event.ADDED_TO_STAGE,t,e,i)},e.prototype.removeEventAddedFromStage=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.Event.ADDED_TO_STAGE,t,e,i)},e.prototype.addEventRemovedFromStage=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.Event.REMOVED_FROM_STAGE,t,e,i)},e.prototype.removeEventRemovedFromStage=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.Event.REMOVED_FROM_STAGE,t,e,i)},e.prototype.addEventTextLink=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TextEvent.LINK,t,e,i)},e.prototype.removeEventTextLink=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TextEvent.LINK,t,e,i)},e.prototype.addEventFocusIn=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.FocusEvent.FOCUS_IN,t,e,i)},e.prototype.removeEventFocusIn=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.FocusEvent.FOCUS_IN,t,e,i)},e.prototype.addEventFocusOut=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.FocusEvent.FOCUS_OUT,t,e,i)},e.prototype.removeEventFocusOut=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.FocusEvent.FOCUS_OUT,t,e,i)},e.prototype.addEventTouchBegin=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,t,e,i)},e.prototype.removeEventTouchBegin=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_BEGIN,t,e,i)},e.prototype.addEventTouchMove=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_MOVE,t,e,i)},e.prototype.removeEventTouchMove=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_MOVE,t,e,i)},e.prototype.addEventChangeStart=function(t,e,i){void 0===i&&(i=this),this.addEvent(eui.UIEvent.CHANGE_START,t,e,i)},e.prototype.removeEventChangeStart=function(t,e,i){void 0===i&&(i=this),this.removeEvent(eui.UIEvent.CHANGE_START,t,e,i)},e.prototype.addEventChangeEnd=function(t,e,i){void 0===i&&(i=this),this.addEvent(eui.UIEvent.CHANGE_END,t,e,i)},e.prototype.removeEventChangeEnd=function(t,e,i){void 0===i&&(i=this),this.removeEvent(eui.UIEvent.CHANGE_END,t,e,i)},e.prototype.$onClose=function(){var t=function(i){for(var o=0;o<i.numChildren;o++){var n=i.getChildAt(o);n instanceof e?n.$onClose():n instanceof egret.DisplayObjectContainer&&t(n)}};t(this),this.removeCustomEvents(),this.removeLongPress()},e}(eui.Component);__reflect(BasePanel.prototype,"BasePanel",["IBaseEvent"]);var SingleClass=function(){function t(){}return t.ins=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this;return this.instance||(this.instance=new(i.bind.apply(i,[void 0].concat(t)))),this.instance},t}();__reflect(SingleClass.prototype,"SingleClass");var GameByteArray=function(t){function e(){var e=t.call(this)||this;return e.endian=egret.Endian.LITTLE_ENDIAN,e}return __extends(e,t),e.prototype.writeCmd=function(t,e){this.writeByte(t),this.writeByte(e)},e.prototype.readString=function(){var t=this.readUTF();return this.position+=1,t},e.prototype.writeString=function(t){this.writeUTF(t||""),this.writeByte(0)},e.prototype.readUnsignedInt64=function(){var t=new UInt64(this),e=t.toString();return+e},e.prototype.writeUnsignedInt64=function(t){var e=UInt64.stringToUint64(t.toString());this.writeUnsignedInt(e._lowUint),this.writeUnsignedInt(e._highUint)},e}(egret.ByteArray);__reflect(GameByteArray.prototype,"GameByteArray");var BaseSound=function(){function t(){this._cache={},this._loadingCache=new Array,TimerMgr.ins().doTimer(6e4,0,this.dealSoundTimer,this)}return t.prototype.dealSoundTimer=function(){for(var t=egret.getTimer(),e=Object.keys(this._cache),i=0,o=e.length;o>i;i++){var n=e[i];this.checkCanClear(n)&&t-this._cache[n]>=18e4&&(delete this._cache[n],RES.destroyRes(n))}},t.prototype.getSound=function(t){var e=RES.getRes(t);if(e)this._cache[t]&&(this._cache[t]=egret.getTimer());else{if(-1!=this._loadingCache.indexOf(t))return null;this._loadingCache.push(t),RES.getResAsync(t,this.onResourceLoadComplete,this)}return e},t.prototype.onResourceLoadComplete=function(t,e){var i=this._loadingCache.indexOf(e);-1!=i&&(this._loadingCache.splice(i,1),this._cache[e]=egret.getTimer(),this.loadedPlay(e))},t.prototype.loadedPlay=function(t){},t.prototype.checkCanClear=function(t){return!0},t}();__reflect(BaseSound.prototype,"BaseSound");var RES;!function(t){var e=function(){function t(){}return t.prototype.init=function(){return this.versionInfo=this.getLocalData("all.manifest"),Promise.resolve()},t.prototype.getVirtualUrl=function(t){return t},t.prototype.getLocalData=function(t){if(egret_native.readUpdateFileSync&&egret_native.readResourceFileSync){var e=egret_native.readUpdateFileSync(t);if(null!=e)return JSON.parse(e);if(e=egret_native.readResourceFileSync(t),null!=e)return JSON.parse(e)}return null},t}();t.NativeVersionController=e,__reflect(e.prototype,"RES.NativeVersionController",["RES.IVersionController"]),egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE&&(t.VersionController=e)}(RES||(RES={}));var RES;!function(t){function e(){t.config.config.fileSystem.profile(),console.log(i);var e=0;for(var o in i){var n=i[o];n instanceof egret.Texture&&(e+=n.$bitmapWidth*n.$bitmapHeight*4)}console.log("gpu size : "+(e/1024).toFixed(3)+"kb")}var i={};t.profile=e,t.host={state:{},get resourceConfig(){return t.config},load:function(e,i){var o="string"==typeof i?t.processor._map[i]:i;return t.queue.loadResource(e,o)},unload:function(e){return t.queue.unloadResource(e)},save:function(e,o){t.host.state[e.root+e.name]=2,delete e.promise,i[e.root+e.name]=o},get:function(t){return i[t.root+t.name]},remove:function(e){delete t.host.state[e.root+e.name],delete i[e.root+e.name]}},t.config=new t.ResourceConfig,t.queue=new t.ResourceLoader;var o=function(t){function e(i,o,n){var r=t.call(this)||this;return r.__resource_manager_error__=!0,r.name=i.toString(),r.message=e.errorMessage[i].replace("{0}",o).replace("{1}",n),r}return __extends(e,t),e.errorMessage={1001:"文件加载失败:{0}",1002:"ResourceManager 初始化失败：配置文件加载失败",2001:"{0}解析失败,不支持指定解析类型:'{1}'，请编写自定义 Processor ，更多内容请参见 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2002:"Analyzer 相关API 在 ResourceManager 中不再支持，请编写自定义 Processor ，更多内容请参见 https://github.com/egret-labs/resourcemanager/blob/master/docs/README.md#processor",2003:"{0}解析失败,错误原因:{1}",2004:"无法找到文件类型:{0}",2005:'RES加载了不存在或空的资源组:"{0}"',2006:"资源配置文件中无法找到特定的资源:{0}"},e}(Error);t.ResourceManagerError=o,__reflect(o.prototype,"RES.ResourceManagerError")}(RES||(RES={}));var egret;!function(t){var e=function(e){function i(o,n){void 0===o&&(o=""),void 0===n&&(n=0);var r=e.call(this)||this;return r._writeMessage="",r._readMessage="",r._connected=!1,r._connecting=!1,r._isReadySend=!1,r._bytesWrite=!1,r._type=i.TYPE_STRING,r._connected=!1,r._writeMessage="",r._readMessage="",r.socket=new t.ISocket,r.socket.addCallBacks(r.onConnect,r.onClose,r.onSocketData,r.onError,r),r}return __extends(i,e),i.prototype.connect=function(t,e,i){if(!this._connecting&&!this._connected){this._connecting=!0;var o="ws://"+t+":"+e;i&&(o="wss://"+t+"/"+e),this.socket.connect(t,e,o)}},i.prototype.close=function(){this._connected&&this.socket.close()},i.prototype.onConnect=function(){this._connected=!0,this._connecting=!1,this.dispatchEventWith(t.Event.CONNECT)},i.prototype.onClose=function(e){this._connected=!1;var i=new t.Event(t.Event.CLOSE);i.data=e,this.dispatchEvent(i)},i.prototype.onError=function(e){this._connecting&&(this._connecting=!1);var i=new t.Event(t.IOErrorEvent.IO_ERROR);i.data=e,this.dispatchEvent(i)},i.prototype.onSocketData=function(e){"string"==typeof e?this._readMessage+=e:this._readByte._writeUint8Array(new Uint8Array(e)),t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.SOCKET_DATA)},i.prototype.flush=function(){return this._connected?(this._writeMessage&&(this.socket.send(this._writeMessage),this._writeMessage=""),this._bytesWrite&&(this.socket.send(this._writeByte.buffer),this._bytesWrite=!1,this._writeByte.clear()),void(this._isReadySend=!1)):void t.$warn(3101)},i.prototype.writeUTF=function(e){return this._connected?(this._type==i.TYPE_BINARY?(this._bytesWrite=!0,this._writeByte.writeUTF(e)):this._writeMessage+=e,void this.flush()):void t.$warn(3101)},i.prototype.readUTF=function(){var t;return this._type==i.TYPE_BINARY?(this._readByte.position=0,t=this._readByte.readUTF(),this._readByte.clear()):(t=this._readMessage,this._readMessage=""),t},i.prototype.writeBytes=function(e,i,o){return void 0===i&&(i=0),void 0===o&&(o=0),this._connected?this._writeByte?(this._bytesWrite=!0,this._writeByte.writeBytes(e,i,o),void this.flush()):void t.$warn(3102):void t.$warn(3101)},i.prototype.readBytes=function(e,i,o){return void 0===i&&(i=0),void 0===o&&(o=0),this._readByte?(this._readByte.position=0,this._readByte.readBytes(e,i,o),void this._readByte.clear()):void t.$warn(3102)},Object.defineProperty(i.prototype,"connected",{get:function(){return this._connected},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,e!=i.TYPE_BINARY||this._writeByte||(this._readByte=new t.ByteArray,this._writeByte=new t.ByteArray)},enumerable:!0,configurable:!0}),i.TYPE_STRING="webSocketTypeString",i.TYPE_BINARY="webSocketTypeBinary",i}(t.EventDispatcher);t.WebSocket=e,__reflect(e.prototype,"egret.WebSocket")}(egret||(egret={}));var egret;!function(t){var e;!function(e){var i=function(){function e(){this.host="",this.port=0,window.WebSocket||t.$error(3100)}return e.prototype.addCallBacks=function(t,e,i,o,n){this.onConnect=t,this.onClose=e,this.onSocketData=i,this.onError=o,this.thisObject=n},e.prototype.connect=function(t,e,i){this.host=t,this.port=e,this.socket=new window.WebSocket(i),this.socket.binaryType="arraybuffer",this._bindEvent()},e.prototype._bindEvent=function(){var t=this,e=this.socket;e.onopen=function(){t.onConnect&&t.onConnect.call(t.thisObject)},e.onclose=function(e){t.onClose&&t.onClose.call(t.thisObject,e)},e.onerror=function(e){t.onError&&t.onError.call(t.thisObject,e)},e.onmessage=function(e){t.onSocketData&&(e.data?t.onSocketData.call(t.thisObject,e.data):t.onSocketData.call(t.thisObject,e))}},e.prototype.send=function(t){this.socket.send(t)},e.prototype.close=function(){this.socket.close()},e.prototype.disconnect=function(){this.socket.disconnect&&this.socket.disconnect()},e}();e.HTML5WebSocket=i,__reflect(i.prototype,"egret.web.HTML5WebSocket",["egret.ISocket"]),t.ISocket=i}(e=t.web||(t.web={}))}(egret||(egret={}));var egret;!function(t){var e=function(){function e(){t.$error(1014)}return e.get=function(t){return-1>t&&(t=-1),t>1&&(t=1),function(e){return 0==t?e:0>t?e*(e*-t+1+t):e*((2-e)*t+(1-t))}},e.getPowIn=function(t){return function(e){return Math.pow(e,t)}},e.getPowOut=function(t){return function(e){return 1-Math.pow(1-e,t)}},e.getPowInOut=function(t){return function(e){return(e*=2)<1?.5*Math.pow(e,t):1-.5*Math.abs(Math.pow(2-e,t))}},e.sineIn=function(t){return 1-Math.cos(t*Math.PI/2)},e.sineOut=function(t){return Math.sin(t*Math.PI/2)},e.sineInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},e.getBackIn=function(t){return function(e){return e*e*((t+1)*e-t)}},e.getBackOut=function(t){return function(e){return--e*e*((t+1)*e+t)+1}},e.getBackInOut=function(t){return t*=1.525,function(e){return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)}},e.circIn=function(t){return-(Math.sqrt(1-t*t)-1)},e.circOut=function(t){return Math.sqrt(1- --t*t)},e.circInOut=function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},e.bounceIn=function(t){return 1-e.bounceOut(1-t)},e.bounceOut=function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},e.bounceInOut=function(t){return.5>t?.5*e.bounceIn(2*t):.5*e.bounceOut(2*t-1)+.5},e.getElasticIn=function(t,e){var i=2*Math.PI;return function(o){if(0==o||1==o)return o;var n=e/i*Math.asin(1/t);return-(t*Math.pow(2,10*(o-=1))*Math.sin((o-n)*i/e))}},e.getElasticOut=function(t,e){var i=2*Math.PI;return function(o){if(0==o||1==o)return o;var n=e/i*Math.asin(1/t);return t*Math.pow(2,-10*o)*Math.sin((o-n)*i/e)+1}},e.getElasticInOut=function(t,e){var i=2*Math.PI;return function(o){var n=e/i*Math.asin(1/t);return(o*=2)<1?-.5*(t*Math.pow(2,10*(o-=1))*Math.sin((o-n)*i/e)):t*Math.pow(2,-10*(o-=1))*Math.sin((o-n)*i/e)*.5+1}},e.quadIn=e.getPowIn(2),e.quadOut=e.getPowOut(2),e.quadInOut=e.getPowInOut(2),e.cubicIn=e.getPowIn(3),e.cubicOut=e.getPowOut(3),e.cubicInOut=e.getPowInOut(3),e.quartIn=e.getPowIn(4),e.quartOut=e.getPowOut(4),e.quartInOut=e.getPowInOut(4),e.quintIn=e.getPowIn(5),e.quintOut=e.getPowOut(5),e.quintInOut=e.getPowInOut(5),e.backIn=e.getBackIn(1.7),e.backOut=e.getBackOut(1.7),e.backInOut=e.getBackInOut(1.7),e.elasticIn=e.getElasticIn(1,.3),e.elasticOut=e.getElasticOut(1,.3),e.elasticInOut=e.getElasticInOut(1,.3*1.5),e}();t.Ease=e,__reflect(e.prototype,"egret.Ease")}(egret||(egret={}));var RES;!function(t){var e;!function(t){function e(t){var e=t.split("/");return e.filter(function(t,i){return!!t||i==e.length-1}).join("/")}function i(t){return t.substr(t.lastIndexOf("/")+1)}function o(t){return t.substr(0,t.lastIndexOf("/"))}t.normalize=e,t.basename=i,t.dirname=o}(e=t.path||(t.path={}))}(RES||(RES={}));var egret;!function(t){var e;!function(e){function i(e){if("function"==typeof e)return e;var i=t.Ease[e];return"function"==typeof i?i:null}function o(t,e,i,o){var n=t.prototype;n.__meta__=n.__meta__||{},n.__meta__[e]=i,o&&(n.__defaultProperty__=e)}var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="",e}return __extends(e,t),e}(t.EventDispatcher);e.BasePath=n,__reflect(n.prototype,"egret.tween.BasePath");var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e.duration=500,e.ease=void 0,e}return __extends(e,t),e}(n);e.To=r,__reflect(r.prototype,"egret.tween.To");var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.duration=500,e.passive=void 0,e}return __extends(e,t),e}(n);e.Wait=a,__reflect(a.prototype,"egret.tween.Wait");var s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.props=void 0,e}return __extends(e,t),e}(n);e.Set=s,__reflect(s.prototype,"egret.tween.Set");var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delta=0,e}return __extends(e,t),e}(n);e.Tick=l,__reflect(l.prototype,"egret.tween.Tick");var h=function(e){function o(){var t=e.call(this)||this;return t.isStop=!1,t}return __extends(o,e),Object.defineProperty(o.prototype,"props",{get:function(){return this._props},set:function(t){this._props=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"paths",{get:function(){return this._paths},set:function(t){this._paths=t||[]},enumerable:!0,configurable:!0}),o.prototype.play=function(t){this.tween?(this.tween.setPaused(!1),this.isStop&&void 0==t&&(t=0,this.isStop=!1),void 0!==t&&null!==t&&this.tween.setPosition(t)):this.createTween(t)},o.prototype.pause=function(){this.tween&&this.tween.setPaused(!0)},o.prototype.stop=function(){this.pause(),this.isStop=!0},o.prototype.createTween=function(e){this.tween=t.Tween.get(this._target,this._props),this._paths&&this.applyPaths(),void 0!==e&&null!==e&&this.tween.setPosition(e)},o.prototype.applyPaths=function(){for(var t=0;t<this._paths.length;t++){var e=this._paths[t];this.applyPath(e)}},o.prototype.applyPath=function(t){var e=this;t instanceof r?this.tween.to(t.props,t.duration,i(t.ease)):t instanceof a?this.tween.wait(t.duration,t.passive):t instanceof s?this.tween.set(t.props):t instanceof l&&this.tween.$tick(t.delta),this.tween.call(function(){return e.pathComplete(t)})},o.prototype.pathComplete=function(t){t.dispatchEventWith("complete"),this.dispatchEventWith("pathComplete",!1,t);var e=this._paths.indexOf(t);e>=0&&e===this._paths.length-1&&this.dispatchEventWith("complete")},o}(t.EventDispatcher);e.TweenItem=h,__reflect(h.prototype,"egret.tween.TweenItem"),o(h,"paths","Array",!0);var u=function(t){function e(){var e=t.call(this)||this;return e.completeCount=0,e}return __extends(e,t),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},set:function(t){this.completeCount=0,this.registerEvent(!1),this._items=t,this.registerEvent(!0)},enumerable:!0,configurable:!0}),e.prototype.registerEvent=function(t){var e=this;this._items&&this._items.forEach(function(i){t?i.addEventListener("complete",e.itemComplete,e):i.removeEventListener("complete",e.itemComplete,e)})},e.prototype.play=function(t){if(this._items)for(var e=0;e<this._items.length;e++){var i=this._items[e];i.play(t)}},e.prototype.pause=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.pause()}},e.prototype.stop=function(){if(this._items)for(var t=0;t<this._items.length;t++){var e=this._items[t];e.stop()}},e.prototype.itemComplete=function(t){var e=t.currentTarget;this.completeCount++,this.dispatchEventWith("itemComplete",!1,e),this.completeCount===this.items.length&&(this.dispatchEventWith("complete"),this.completeCount=0)},e}(t.EventDispatcher);e.TweenGroup=u,__reflect(u.prototype,"egret.tween.TweenGroup"),o(u,"items","Array",!0)}(e=t.tween||(t.tween={}))}(egret||(egret={}));var FontCustomProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(i){var o;try{o=JSON.parse(i)}catch(n){o=i}var r;r="string"==typeof o?RecycleMgr.ins().fontGetTexturePath(e.url,o):RES.processor.getRelativePath(e.url,o.file);var a=t.resourceConfig.getResource(RES.nameSelector(r));return a||(a={name:r,url:r,type:"image",root:e.root}),RecycleMgr.ins().fonts[a.name]=e.name,t.load(a).then(function(e){var i=new egret.BitmapFont(e,o);return i.$resourceInfo=a,t.save(a,e),i},function(e){throw t.remove(a),e})})},onRemoveStart:function(t,e){var i=t.get(e),o=i.$resourceInfo;t.unload(o)}};RES.processor.map(RES.ResourceItem.TYPE_FONT,FontCustomProcessor);var ImageCustomProcessor={onLoadStart:function(t,e){var i=this;return new Promise(function(o,n){var r=new egret.ImageLoader;r.load(RES.getVirtualUrl(e.root+e.url));var a=function(){var i=r.data?r.data:r.response,n=new egret.Texture;n._setBitmapData(i);var a=t.resourceConfig.getResource(e.name);if(a&&a.scale9grid){var s=a.scale9grid.split(",");n.scale9Grid=new egret.Rectangle(parseInt(s[0]),parseInt(s[1]),parseInt(s[2]),parseInt(s[3]))}RecycleMgr.ins().addImage(e.name,{resource:e,texture:n}),o(n)},s=function(){var t=new RES.ResourceManagerError(1001,e.url);n(t)};r.addEventListener(egret.Event.COMPLETE,a,i),r.addEventListener(egret.IOErrorEvent.IO_ERROR,s,i)})},onRemoveStart:function(t,e){RecycleMgr.ins().delImage(e.name);var i=t.get(e);i.dispose()}};RES.processor.map(RES.ResourceItem.TYPE_IMAGE,ImageCustomProcessor);var JsonCustomProcessor={onLoadStart:function(t,e){return t.load(e,"text").then(function(t){var i=JSON.parse(t);return RecycleMgr.ins().jsons[e.name]={resource:e,json:i},i})},onRemoveStart:function(t,e){delete RecycleMgr.ins().jsons[e.name]}};RES.processor.map(RES.ResourceItem.TYPE_JSON,JsonCustomProcessor);var SheetCustomProcessor={onLoadStart:function(t,e){return t.load(e,"json").then(function(i){var o=t.resourceConfig.getResource(RES.nameSelector(i.file));if(!o){var n=RES.processor.getRelativePath(e.url,i.file);o={name:n,url:n,type:"image",root:e.root}}return RecycleMgr.ins().sheets[o.name]=e.name,t.load(o).then(function(e){if(!e)return null;var n=i.frames,r=new egret.SpriteSheet(e);r.$resourceInfo=o;for(var a in n){var s=n[a],l=r.createTexture(a,s.x,s.y,s.w,s.h,s.offX,s.offY,s.sourceW,s.sourceH);if(s.scale9grid){var h=s.scale9grid.split(",");l.scale9Grid=new egret.Rectangle(parseInt(h[0]),parseInt(h[1]),parseInt(h[2]),parseInt(h[3]))}}return t.save(o,e),r},function(e){throw t.remove(o),e})})},getData:function(t,e,i,o){var n=t.get(e);return n?n.getTexture(o):null},onRemoveStart:function(t,e){var i=t.get(e),o=i.$resourceInfo;i.dispose(),t.unload(o),delete RecycleMgr.ins().jsons[e.name]}};RES.processor.map(RES.ResourceItem.TYPE_SHEET,SheetCustomProcessor);var AStar=function(){function t(){this.m_nMarkTag=0,this.grid=this.grid||new MapGrid}return t.prototype.init=function(t,e){this.grid.init(t,e);var i=0;this.m_MapCells?i=this.m_MapCells.length:this.m_MapCells=[],this.m_nCols=this.grid.mapCol,this.m_nRows=this.grid.mapRow;var o=this.m_nCols*this.m_nRows;o>this.m_MapCells.length&&(this.m_MapCells.length=o);for(var n=i;o>n;++n)this.m_MapCells[n]=new MapCell;var r,a,s,l=0;for(a=0;a<this.m_nRows;++a)for(r=0;r<this.m_nCols;++r)s=this.m_MapCells[l],s.x=r,s.y=a,s.block=this.grid.isBlock(r,a),l++},t.prototype.findPatch=function(e,i,o,n){if(e==o&&i==n)return null;if(0>e||e>=this.m_nCols||0>i||i>=this.m_nRows)return null;if(0>o||o>=this.m_nCols||0>n||n>=this.m_nRows)return null;var r=this.m_MapCells[n*this.m_nCols+o];if(!r||r.block)return null;this.reset(e,i);var a=!1,s=e,l=i,h=this.m_MapCells[l*this.m_nCols+s];h.g=0,h.LastX=-1,h.LastY=-1,h.x=s,h.y=l,h.MarkTag=this.m_nMarkTag,h.h=Math.abs(o-e)+10*Math.abs(n-i);for(var u,c,p,d,g,f,m,v;;){if(s==o&&l==n){a=!0;break}for(h.State!=MapCell.CSCLOSE&&this.closeCell(h),u=0;8>u;++u)c=s+t.NEIGHBORPOS_X_VALUES[u],p=l+t.NEIGHBORPOS_Y_VALUES[u],0>c||c>=this.m_nCols||0>p||p>=this.m_nRows||(d=this.m_MapCells[p*this.m_nCols+c],g=1&u,d.block?g||u++:(g&&(f=7==u?0:u+1,m=s+t.NEIGHBORPOS_X_VALUES[f],v=l+t.NEIGHBORPOS_Y_VALUES[f]),(!g||g&&!this.m_MapCells[v*this.m_nCols+m].block)&&(d.MarkTag!=this.m_nMarkTag||d.State==MapCell.CSNONE?(d.MarkTag=this.m_nMarkTag,d.LastX=s,d.LastY=l,d.dir=u,d.g=h.g+t.AS_MOVECOST[g],d.h=10*(Math.abs(o-c)+Math.abs(n-p)),this.openCell(d)):d.State==MapCell.CSOPEN&&d.g>h.g+t.AS_MOVECOST[g]&&(d.LastX=s,d.LastY=l,d.dir=u,d.g=h.g+t.AS_MOVECOST[g],this.reopenCell(d)))));if(h=this.m_LastOpenCell,null==h)break;s=h.x,l=h.y}if(a){for(var y=[],C=void 0;C&&C.dir==h.dir||(C=new AStarNode(h.x,h.y,h.dir),y.push(C)),h=this.m_MapCells[h.LastY*this.m_nCols+h.LastX],!(h.LastX<=0&&h.LastY<=0||h.MarkTag!=this.m_nMarkTag););return y}return null},t.prototype.reset=function(t,e){var i=this.m_MapCells[e*this.m_nCols+t];i&&(i.LastX=0,i.LastY=0,i.h=0,i.g=0,i.f=0,i.State=0,i.Prev=null,i.Next=null,i.dir=0),this.m_LastOpenCell=null,this.m_nMarkTag=this.m_nMarkTag+1},t.prototype.closeCell=function(t){t.State==MapCell.CSOPEN&&(t.Prev&&(t.Prev.Next=t.Next),t.Next&&(t.Next.Prev=t.Prev),t==this.m_LastOpenCell&&(this.m_LastOpenCell=t.Prev)),t.State=MapCell.CSCLOSE},t.prototype.openCell=function(t){t.State=MapCell.CSOPEN;var e=t.h+t.g;t.f=e;var i=this.m_LastOpenCell;if(i){for(;i.f<e;){if(null==i.Prev)return i.Prev=t,t.Prev=null,void(t.Next=i);i=i.Prev}t.Prev=i,i.Next?(t.Next=i.Next,i.Next.Prev=t,i.Next=t):(t.Next=null,i.Next=t,this.m_LastOpenCell=t)}else this.m_LastOpenCell=t,t.Prev=null,t.Next=null},t.prototype.reopenCell=function(t){var e=t.h+t.g;t.f=e;var i=t.Next;if(i&&i.f>e){do i=i.Next;while(i&&i.f>e);t.Prev&&(t.Prev.Next=t.Next),t.Next&&(t.Next.Prev=t.Prev),i?(t.Next=i,i.Prev?(t.Prev=i.Prev,i.Prev.Next=t):t.Prev=null,i.Prev=t):(t.Prev=this.m_LastOpenCell,t.Next=null,this.m_LastOpenCell.Next=t,this.m_LastOpenCell=t)}},t.prototype.isWalkable=function(t,e){var i=!1,o=this.grid.getNode(t,e);return o?i=!o.block:debug.error("WalkablePoint:"+t+","+e+"error!"),i},t.prototype.isAlpha=function(t,e){var i=!1,o=this.grid.getNode(t,e);return o?i=o.alpha:debug.error("AlphaPoint:"+t+","+e+"error!"),i},t.NEIGHBORPOS_X_VALUES=[0,1,1,1,0,-1,-1,-1],t.NEIGHBORPOS_Y_VALUES=[-1,-1,0,1,1,1,0,-1],t.AS_MOVECOST=[10,14],t}();__reflect(AStar.prototype,"AStar");var MapCell=function(){function t(){}return t.CSNONE=0,t.CSOPEN=1,t.CSCLOSE=2,t}();__reflect(MapCell.prototype,"MapCell");var AStarNode=function(){function t(t,e,i){this.x=t,this.y=e,this.dir=i}return t}();__reflect(AStarNode.prototype,"AStarNode");var Bresenham=function(){function t(){}return t.canThrough=function(t,e,i,o,n){var r=0,a=0,s=0,l=0,h=0,u=0,c=0,p=0,d=0,g=0,f=0,m=0,v=0,y=0,C=new Array(4);for(C[0]=0,C[1]=0,m=(n-i)/(o-e),v=n-m*o,h=o>e?1:-1,u=n>i?1:-1,r=e>>0,a=i>>0,s=o>>0,l=n>>0,c=s-r,c=(c^c>>31)-(c>>31),C[2]=p=r,C[3]=g=a,y=0;c>y;y++){for(p+=h,f=m*p+v,d=f>>0;g!=d;){if(g+=u,!t.isWalkable(p,g))return C;C[2]=p,C[3]=g}if(!t.isWalkable(p,d))return C;C[2]=p,C[3]=d}for(;g!=l;){if(g+=u,!t.isWalkable(p,g))return C;C[2]=p,C[3]=g}return C[0]=1,C},t.lineGrids=function(t,e,i,o){for(var n=function(t,e,i,o){for(var n=(o-e)/(i-t),r=o-n*i,a=i>t?1:-1,s=Math.abs(i-t),l=[],h=0;s>h;++h){var u=t+h*a>>0,c=n*u+r>>0;l.push(u),l.push(c)}if(1>=s&&Math.abs(o-e)>1){s=Math.abs(o-e);for(var p=0;s>p;++p){var u=t,c=o>e?e++:e--;(l[l.length-2]!=u||l[l.length-1]!=c)&&(l.push(u),l.push(c))}}return l[l.length-2]!=i&&l[l.length-1]!=o&&(l.push(i),l.push(o)),l},r=n(t,e,i,o),a=[],s=0;s<r.length;s+=2){var l=r[s],h=r[s+1];if(r.length>s+2){var u=r[s+2],c=r[s+3];if(Math.abs(l-u)>1||Math.abs(h-c)>1){var p=n(l,h,u,c);p.splice(0,2),p.splice(p.length-2,2),a=a.concat(p)}}}if(Math.abs(r[r.length-2]-i)>1||Math.abs(r[r.length-1]-o)>1){var p=n(r[r.length-2],r[r.length-1],i,o);p.splice(0,2),a=a.concat(p)}return r.concat(a)},t}();__reflect(Bresenham.prototype,"Bresenham");var MapGrid=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e._poolNodes=[],e}return __extends(e,t),e.prototype.init=function(t,e){this._nodes&&this.clearNodes(),this._mapCol=t.mapCol,this._mapRow=t.mapRow,this._nodes=[];for(var i,o=0;o<this._mapCol;o++){this._nodes[o]=[];for(var n=0;n<this._mapRow;n++)i=this.getGridNode(),i.data=t.datas[o*this._mapRow+n],this._nodes[o][n]=i}e&&this._nodes.reverse()},e.prototype.getGridNode=function(){return this._poolNodes.pop()||new MapNode},Object.defineProperty(e.prototype,"mapCol",{get:function(){return this._mapCol},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mapRow",{get:function(){return this._mapRow},enumerable:!0,configurable:!0}),e.prototype.getNode=function(t,e){return this._nodes&&this._nodes[t]?this._nodes[t][e]:void 0},e.prototype.isBlock=function(t,e){return 0>t||t>=this._mapCol||0>e||e>=this._mapRow?!0:this._nodes[t][e].block},e.prototype.clearNodes=function(){for(var t in this._nodes)this._poolNodes=this._poolNodes.concat(this._nodes[t]),this._nodes[t].length=0;this._nodes.length=0},e}(egret.Sprite);__reflect(MapGrid.prototype,"MapGrid");var MapNode=function(){function t(){}return Object.defineProperty(t.prototype,"alpha",{get:function(){return(2&this.data)>0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"block",{get:function(){return(1&this.data)<=0},enumerable:!0,configurable:!0}),t}();__reflect(MapNode.prototype,"MapNode");var BaseComponent=function(t){function e(){var e=t.call(this)||this;return e.className="Must fill className",e}return __extends(e,t),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,eui.PropertyEvent.dispatchPropertyEvent(this,eui.PropertyEvent.PROPERTY_CHANGE,"data"),this.dataChanged&&this.dataChanged()},enumerable:!0,configurable:!0}),e.filterKeys=["data"],e.copyKeys=["open","close"],e}(BasePanel);__reflect(BaseComponent.prototype,"BaseComponent");var BaseItemRender=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.addEvent=function(t,e,i,o){return void 0===o&&(o=this),e?void e.addEventListener(t,i,o):void debug.error("Not binding object")},e.prototype.removeEvent=function(t,e,i,o){void 0===o&&(o=this),e&&e.removeEventListener(t,i,o)},e.prototype.addEventTouchTap=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_TAP,t,e,i)},e.prototype.removeEventTouchTap=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_TAP,t,e,i)},e.prototype.addEventTouchEnd=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_END,t,e,i)},e.prototype.removeEventTouchEnd=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_END,t,e,i)
},e.prototype.addEventChange=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.CHANGE,t,e,i)},e.prototype.removeEventChange=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.CHANGE,t,e,i)},e.prototype.addEventChanging=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.CHANGING,t,e,i)},e.prototype.removeEventChanging=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.CHANGING,t,e,i)},e.prototype.addEventItemTap=function(t,e,i){void 0===i&&(i=this),this.addEvent(eui.ItemTapEvent.ITEM_TAP,t,e,i)},e.prototype.removeEventItemTap=function(t,e,i){void 0===i&&(i=this),this.removeEvent(eui.ItemTapEvent.ITEM_TAP,t,e,i)},e.prototype.addEventAddedFromStage=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.Event.ADDED_TO_STAGE,t,e,i)},e.prototype.removeEventAddedFromStage=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.Event.ADDED_TO_STAGE,t,e,i)},e.prototype.addEventRemovedFromStage=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.Event.REMOVED_FROM_STAGE,t,e,i)},e.prototype.removeEventRemovedFromStage=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.Event.REMOVED_FROM_STAGE,t,e,i)},e.prototype.addEventTextLink=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TextEvent.LINK,t,e,i)},e.prototype.removeEventTextLink=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TextEvent.LINK,t,e,i)},e.prototype.addEventFocusIn=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.FocusEvent.FOCUS_IN,t,e,i)},e.prototype.removeEventFocusIn=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.FocusEvent.FOCUS_IN,t,e,i)},e.prototype.addEventFocusOut=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.FocusEvent.FOCUS_OUT,t,e,i)},e.prototype.removeEventFocusOut=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.FocusEvent.FOCUS_OUT,t,e,i)},e.prototype.addEventTouchBegin=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_BEGIN,t,e,i)},e.prototype.removeEventTouchBegin=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_BEGIN,t,e,i)},e.prototype.addEventTouchMove=function(t,e,i){void 0===i&&(i=this),this.addEvent(egret.TouchEvent.TOUCH_MOVE,t,e,i)},e.prototype.removeEventTouchMove=function(t,e,i){void 0===i&&(i=this),this.removeEvent(egret.TouchEvent.TOUCH_MOVE,t,e,i)},e.prototype.addEventChangeStart=function(t,e,i){void 0===i&&(i=this),this.addEvent(eui.UIEvent.CHANGE_START,t,e,i)},e.prototype.removeEventChangeStart=function(t,e,i){void 0===i&&(i=this),this.removeEvent(eui.UIEvent.CHANGE_START,t,e,i)},e.prototype.addEventChangeEnd=function(t,e,i){void 0===i&&(i=this),this.addEvent(eui.UIEvent.CHANGE_END,t,e,i)},e.prototype.removeEventChangeEnd=function(t,e,i){void 0===i&&(i=this),this.removeEvent(eui.UIEvent.CHANGE_END,t,e,i)},e.prototype.destruct=function(){},e}(eui.ItemRenderer);__reflect(BaseItemRender.prototype,"BaseItemRender",["IBaseEvent"]);var BaseLayer=function(t){function e(){var e=t.call(this)||this;return e.percentWidth=100,e.percentHeight=100,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.setSafeArea=function(){},e}(eui.Group);__reflect(BaseLayer.prototype,"BaseLayer");var BaseLeakDisplay=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(egret.DisplayObjectContainer);__reflect(BaseLeakDisplay.prototype,"BaseLeakDisplay");var RES;!function(t){function e(e){return t.path.basename(e).split(".").join("_")}function i(e){var i,o=e.substr(e.lastIndexOf(".")+1);switch(o){case t.ResourceItem.TYPE_XML:case t.ResourceItem.TYPE_JSON:case t.ResourceItem.TYPE_SHEET:i=o;break;case"png":case"jpg":case"gif":case"jpeg":case"bmp":i=t.ResourceItem.TYPE_IMAGE;break;case"fnt":i=t.ResourceItem.TYPE_FONT;break;case"txt":i=t.ResourceItem.TYPE_TEXT;break;case"mp3":case"ogg":case"mpeg":case"wav":case"m4a":case"mp4":case"aiff":case"wma":case"mid":i=t.ResourceItem.TYPE_SOUND;break;case"mergeJson":case"zip":case"pvr":i=o;break;case"ttf":i=t.ResourceItem.TYPE_TTF;default:i=t.ResourceItem.TYPE_BIN}return i}function o(e,i){throw new t.ResourceManagerError(2002)}function n(e){t.isCompatible=e}function r(e,i){if(i.indexOf("://")>=0){var o=i.split("://");i=o[0]+"://"+t.path.normalize(o[1]+"/"),e=e.replace(i,"")}else i=t.path.normalize(i+"/"),e=e.replace(i,"");return t.setConfigURL(e,i),M||(M=new _),a(M.loadConfig())}function a(e){return t.isCompatible?void e["catch"](function(t){}).then():e}function s(t,e,i){return void 0===e&&(e=0),a(M.loadGroup(t,e,i))}function l(t){return M.isGroupLoaded(t)}function h(e){return M.getGroupByName(e).map(function(e){return t.ResourceItem.convertToResItem(e)})}function u(t,e,i){return void 0===i&&(i=!1),M.createGroup(t,e,i)}function c(t){return M.hasRes(t)}function p(t){return M.getRes(t)}function d(t,e,i){return a(M.getResAsync.apply(M,arguments))}function g(t,e,i,o){if(void 0===o&&(o=""),!M){var n=egret.sys.tr(3200);return egret.warn(n),Promise.reject(n)}return a(M.getResByUrl(t,e,i,o))}function f(t,e){return M.destroyRes(t,e)}function m(t){M||(M=new _),M.setMaxLoadingThread(t)}function v(t){M.setMaxRetryTimes(t)}function y(t,e,i,o,n){void 0===o&&(o=!1),void 0===n&&(n=0),M||(M=new _),M.addEventListener(t,e,i,o,n)}function C(t,e,i,o){void 0===o&&(o=!1),M.removeEventListener(t,e,i,o)}function b(t){M.addResourceData(t)}function T(){return M||(M=new _),M.vcs}function w(t){M||(M=new _),M.registerVersionController(t)}function S(t){return M.vcs?M.vcs.getVirtualUrl(t):t}t.nameSelector=e,t.typeSelector=i,t.registerAnalyzer=o,t.setIsCompatible=n,t.isCompatible=!1,t.loadConfig=r,t.loadGroup=s,t.isGroupLoaded=l,t.getGroupByName=h,t.createGroup=u,t.hasRes=c,t.getRes=p,t.getResAsync=d,t.getResByUrl=g,t.destroyRes=f,t.setMaxLoadingThread=m,t.setMaxRetryTimes=v,t.addEventListener=y,t.removeEventListener=C,t.$addResourceData=b,t.getVersionController=T,t.registerVersionController=w,t.getVirtualUrl=S;var _=function(e){function i(){var i=e.call(this)||this;return i.isVcsInit=!1,i.normalLoadConfig=function(){return t.config.init().then(function(e){t.ResourceEvent.dispatchResourceEvent(i,t.ResourceEvent.CONFIG_COMPLETE)},function(e){return t.ResourceEvent.dispatchResourceEvent(i,t.ResourceEvent.CONFIG_LOAD_ERROR),Promise.reject(e)})},t.VersionController&&(i.vcs=new t.VersionController),i}return __extends(i,e),i.prototype.registerVersionController=function(t){this.vcs=t,this.isVcsInit=!1},i.prototype.loadConfig=function(){var t=this;return!this.isVcsInit&&this.vcs?(this.isVcsInit=!0,this.vcs.init().then(function(){return t.normalLoadConfig()})):this.normalLoadConfig()},i.prototype.isGroupLoaded=function(e){var i=t.config.getGroupByName(e);return i.every(function(e){return null!=t.host.get(e)})},i.prototype.getGroupByName=function(e){return t.config.getGroupByName(e)},i.prototype.loadGroup=function(e,i,o){var n=this;void 0===i&&(i=0);var r={onProgress:function(i,r,a){o&&o.onProgress&&o.onProgress(i,r,a),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_PROGRESS,e,a,i,r)}};return this._loadGroup(e,i,r).then(function(i){-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_COMPLETE,e)},function(i){if(-1==t.config.config.loadGroup.indexOf(e)&&t.config.config.loadGroup.push(e),i.itemList)for(var o=i.itemList,r=o.length,a=0;r>a;a++){var s=o[a];delete s.promise,t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,e,s)}return t.isCompatible&&console.warn(i.error.message),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.GROUP_LOAD_ERROR,e),Promise.reject(i.error)})},i.prototype._loadGroup=function(e,i,o){void 0===i&&(i=0);var n=t.config.getGroupByName(e);return 0==n.length?new Promise(function(i,o){o({error:new t.ResourceManagerError(2005,e)})}):t.queue.pushResGroup(n,e,i,o)},i.prototype.createGroup=function(e,i,o){return void 0===o&&(o=!1),t.config.createGroup(e,i,o)},i.prototype.hasRes=function(e){return null!=t.config.getResourceWithSubkey(e)},i.prototype.getRes=function(e){var i=t.config.getResourceWithSubkey(e);if(i){var o=i.r,n=i.key,r=i.subkey,a=t.processor.isSupport(o);return a&&a.getData&&r?a.getData(t.host,o,n,r):t.host.get(o)}return null},i.prototype.getResAsync=function(e,i,o){var n=this,r=e,a=t.config.getResourceWithSubkey(e);if(null==a)return i&&i.call(o,null,r),Promise.reject(new t.ResourceManagerError(2006,e));var s=this.getRes(e);if(s)return i&&egret.callLater(function(){i.call(o,s,r)},this),Promise.resolve(s);var l=a.r,h=a.subkey;return t.queue.pushResItem(l).then(function(n){t.host.save(l,n);var a=t.processor.isSupport(l);return a&&a.getData&&h&&(n=a.getData(t.host,l,e,h)),i&&i.call(o,n,r),n},function(e){return t.host.remove(l),t.ResourceEvent.dispatchResourceEvent(n,t.ResourceEvent.ITEM_LOAD_ERROR,"",l),i?(i.call(o,null,r),Promise.reject(null)):Promise.reject(e)})},i.prototype.getResByUrl=function(e,i,o,n){var r=this;void 0===n&&(n="");var a=t.config.getResource(e);if(!a&&(n||(n=t.config.__temp__get__type__via__url(e)),a={name:e,url:e,type:n,root:"",extra:1},t.config.addResourceData(a),a=t.config.getResource(e),!a))throw"never";return t.queue.pushResItem(a).then(function(e){return t.host.save(a,e),i&&a&&i.call(o,e,a.url),e},function(n){return t.host.remove(a),t.ResourceEvent.dispatchResourceEvent(r,t.ResourceEvent.ITEM_LOAD_ERROR,"",a),i?(i.call(o,null,e),Promise.reject(null)):Promise.reject(n)})},i.prototype.destroyRes=function(e,i){void 0===i&&(i=!0);var o=t.config.getGroupByName(e);if(o&&o.length>0){var n=t.config.config.loadGroup.indexOf(e);if(-1==n)return!1;if(i||1==t.config.config.loadGroup.length&&t.config.config.loadGroup[0]==e){for(var r=0,a=o;r<a.length;r++){var s=a[r];t.queue.unloadResource(s)}t.config.config.loadGroup.splice(n,1)}else{for(var l={},h=0,u=t.config.config.loadGroup;h<u.length;h++){var c=u[h];for(var p in t.config.config.groups[c]){var d=t.config.config.groups[c][p];l[d]?l[d]++:l[d]=1}}for(var g=0,f=o;g<f.length;g++){var s=f[g];l[s.name]&&1==l[s.name]&&t.queue.unloadResource(s)}t.config.config.loadGroup.splice(n,1)}return!0}var s=t.config.getResource(e);return s?t.queue.unloadResource(s):(console.warn("在内存"+e+"资源不存在"),!1)},i.prototype.setMaxLoadingThread=function(e){1>e&&(e=1),t.queue.thread=e},i.prototype.setMaxRetryTimes=function(e){e=Math.max(e,0),t.queue.maxRetryTimes=e},i.prototype.addResourceData=function(e){e.root="",t.config.addResourceData(e)},__decorate([t.checkNull],i.prototype,"hasRes",null),__decorate([t.checkNull],i.prototype,"getRes",null),__decorate([t.checkNull],i.prototype,"getResAsync",null),__decorate([t.checkNull],i.prototype,"getResByUrl",null),i}(egret.EventDispatcher);t.Resource=_,__reflect(_.prototype,"RES.Resource");var M}(RES||(RES={}));var GameMovieClip=function(t){function e(){var i=t.call(this)||this;return i._rate=1,i.pixelHitTest=!1,i.$hitTest=function(t,i){if(!this.$renderNode||!this.$visible)return null;var o=this.$getInvertedConcatenatedMatrix();if(0==o.a&&0==o.b&&0==o.c&&0==o.d)return null;var n=this.$getContentBounds(),r=o.a*t+o.c*i+o.tx,a=o.b*t+o.d*i+o.ty;if(n.contains(r,a)){if(!this.$children){var s=this.$scrollRect?this.$scrollRect:this.$maskRect;if(s&&!s.contains(r,a))return null;if(this.$mask&&!this.$mask.$hitTest(t,i))return null;if(this.pixelHitTest&&this instanceof e&&!this.hitTestPoint(t,i,!0))return null}return this}return null},i}return __extends(e,t),e.prototype.playFile=function(t,i,o,n){var r=this;if(void 0===i&&(i=1),void 0===o&&(o=null),void 0===n&&(n=!0),this.time=egret.getTimer(),this._compFun=o,this.playCount=i,this.remove=n,TimerMgr.ins().remove(this.playComp,this),this.texture&&null==this.texture.bitmapData);else if(this.name==t)return void this.createBody();this.name=t,this.texture&&e.removeDisplayObject(this,this.texture.bitmapData),this.jsonData=null,this.texture=null,RES.getResByUrl(this.name+".json",function(t,e){r.name+".json"==e&&t&&(r.jsonData=t,r.createBody())},this,RES.ResourceItem.TYPE_JSON),RES.getResByUrl(this.name+".png",function(t,i){r.name+".png"==i&&t&&(r.texture=t,r.stage&&e.addDisplayObject(r,r.texture.bitmapData),r.createBody())},this,RES.ResourceItem.TYPE_IMAGE)},e.prototype.$onAddToStage=function(i,o){t.prototype.$onAddToStage.call(this,i,o),this.texture&&e.addDisplayObject(this,this.texture.bitmapData)},e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.texture&&e.removeDisplayObject(this,this.texture.bitmapData)},e.prototype.createBody=function(){if(this.jsonData&&this.texture&&this.texture.bitmapData){var t=this.name.split("/"),i=t.pop(),o=this.getMcFactory();this.movieClipData=o.generateMovieClipData(i),this.name in e.originalRate||(e.originalRate[this.name]=this.movieClipData.frameRate),this.frameRate=e.originalRate[this.name]*this.rate>>0;try{this.gotoAndPlay(1,this.playCount)}catch(n){debug.error("error mc:",this.name)}if(this.visible=!0,this.playCount>0){var r=egret.getTimer()-this.time;r=this.playTime*this.playCount-r,r>0?TimerMgr.ins().doTimer(r,1,this.playComp,this):this.playComp()}this.dispatchEventWith(egret.Event.CHANGE)}},e.prototype.getMcFactory=function(){var t=this.texture.bitmapData.hashCode;if(e.factoryDic[t])return e.factoryDic[t];var i=new egret.MovieClipDataFactory;return i.mcDataSet=this.jsonData,i.texture=this.texture,e.factoryDic[t]=i,i},e.prototype.playComp=function(){this.stage&&this._compFun&&this._compFun(),this.remove&&this&&null!=this.parent&&this.parent.removeChild(this)},Object.defineProperty(e.prototype,"playTime",{get:function(){return this.movieClipData?1/this.frameRate*this.totalFrames*1e3:0},enumerable:!0,configurable:!0}),e.prototype.clearComFun=function(){this._compFun=null},e.prototype.dispose=function(){this.stop(),this.resetMovieClip(),this.clearComFun(),TimerMgr.ins().removeAll(this)},e.prototype.destroy=function(){this&&null!=this.parent&&this.parent.removeChild(this),this.dispose(),ObjectPool.push(this)},e.prototype.resetMovieClip=function(){var t=this;t.rotation=0,t.scaleX=1,t.scaleY=1,t.alpha=1,t.anchorOffsetX=0,t.anchorOffsetY=0,t.x=0,t.y=0,t.rate=1,t.$renderNode&&t.$renderNode.cleanBeforeRender(),t.$nativeDisplayObject&&t.$nativeDisplayObject.setDataToBitmapNode&&t.$nativeDisplayObject.setDataToBitmapNode(0,null,[]),t.name=null,t.jsonData=null,t.filters=null;var i=t.texture;i&&e.removeDisplayObject(t,i.bitmapData),t.texture=null,t.remove=!1,t.visible=!1,egret.Tween.removeTweens(t)},e.addDisplayObject=function(t,i){if(i){var o=i.hashCode;if(!e.displayList[o])return void(e.displayList[o]=[t]);var n=e.displayList[o];n.indexOf(t)<0&&n.push(t)}},e.removeDisplayObject=function(t,i){if(i){var o=i.hashCode;if(e.displayList[o]){var n=e.displayList[o],r=n.indexOf(t);r>=0&&n.splice(r,1),0==n.length&&(delete e.displayList[o],RecycleMgr.ins().disposeResTime(o))}}},Object.defineProperty(e.prototype,"rate",{get:function(){return this._rate*(DataCenter.ins().ClientGlobalConfig.actionSpeedRate||1)},set:function(t){this._rate=t},enumerable:!0,configurable:!0}),e.originalRate={},e.factoryDic={},e.displayList=egret.createMap(),e}(egret.MovieClip);__reflect(GameMovieClip.prototype,"GameMovieClip");var FrameSurveillance=function(t){function e(){var e=t.call(this)||this;return e.totalTick=0,e.curTime=0,e.totalTime=0,e.lastLevel=0,e.curTime=egret.getTimer(),egret.startTick(e.callBack,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.callBack=function(t){if(this.totalTick++,this.totalTime+=t-this.curTime,this.curTime=t,this.totalTime>=5e3){var e=egret.ticker.$frameRate,i=Math.min(Math.ceil(1e3*this.totalTick/this.totalTime),e);if(!this.levelInterval){this.levelInterval=[];for(var o=1;3>=o;o++)this.levelInterval.push((1-.2*o)*e>>0)}for(var n=0,o=0;o<this.levelInterval.length;o++)if(i>=this.levelInterval[o]){n=o;break}this.updateLevel(n),this.totalTick=0,this.totalTime=this.totalTime%1e3}return!1},e.prototype.updateLevel=function(t){t!=this.lastLevel&&(this.lastLevel=t,EventMgr.ins().dispatch(5,t))},e}(SingleClass);__reflect(FrameSurveillance.prototype,"FrameSurveillance");var GameSystem;!function(t){t.frameSurveillance=FrameSurveillance.ins.bind(FrameSurveillance)}(GameSystem||(GameSystem={}));var DelayOptMgr=function(t){function e(){var e=t.call(this)||this;return e._delayTime=2,e._delayOpts=[],egret.startTick(e.run,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.run=function(t){if(0==this._delayOpts.length)return!1;for(var e,i=egret.getTimer();this._delayOpts.length&&(e=this._delayOpts.shift(),e.funPara?e.fun.call(e.thisObj,e.funPara):e.fun.call(e.thisObj),e.callBack&&(void 0!=e.para?e.callBack.call(e.thisObj,e.para):e.callBack()),!(egret.getTimer()-i>this._delayTime)););return!1},e.prototype.addDelayOptFunction=function(t,e,i,o,n){this._delayOpts.push({fun:e,funPara:i,thisObj:t,callBack:o,para:n})},e.prototype.clear=function(){this._delayOpts.length=0},e}(SingleClass);__reflect(DelayOptMgr.prototype,"DelayOptMgr");var EventMgr=function(t){function e(){var e=t.call(this)||this;return e.flag=0,e.dict={},e.eVec=[],egret.startTick(e.run,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.addListener=function(t,i,o){var n=""+t;n?e.ins().addListener(n,i,o):debug.log("EventMgr.addListener error:"+egret.getQualifiedClassName(o))},e.prototype.addListener=function(t,e,i){var o=this.dict[t];o?0!=this.flag&&(this.dict[t]=o=o.concat()):this.dict[t]=o=[];for(var n=0,r=o;n<r.length;n++){var a=r[n];if(a[0]==e&&a[1]==i)return}o.push([e,i])},e.prototype.dispatch=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=""+t,n=ObjectPool.pop("EventVo");n.key=o,n.param=e,this.eVec.push(n)},e.removeListener=function(t,i,o){var n=""+t;n?e.ins().removeListener(n,i,o):debug.log("EventMgr.removeListener error:"+egret.getQualifiedClassName(o))},e.prototype.removeListener=function(t,e,i){var o=this.dict[t];if(o){0!=this.flag&&(this.dict[t]=o=o.concat());for(var n=o.length,r=0;n>r;r++)if(o[r][0]==e&&o[r][1]==i){o.splice(r,1);break}0==o.length&&(this.dict[t]=null,delete this.dict[t])}},e.prototype.removeAll=function(t,e){e||(e=Object.keys(this.dict));for(var i=0,o=e;i<o.length;i++){var n=o[i],r=this.dict[n];0!=this.flag&&(this.dict[n]=r=r.concat());for(var a=r?r.length:0,s=a-1;s>=0;s--)r[s][1]==t&&r.splice(s,1);r&&0!=r.length||(this.dict[n]=null,delete this.dict[n])}},e.prototype.run=function(t){for(var e=egret.getTimer();this.eVec.length>0&&(this.dealMsg(this.eVec.shift()),!(egret.getTimer()-e>5)););return!1},e.prototype.dealMsg=function(t){var e=this.dict[t.key];if(e){var i=e.length;if(0!=i){this.flag++;for(var o=0,n=e;o<n.length;o++){var r=n[o];r[0].apply(r[1],t.param)}this.flag--,t.dispose(),ObjectPool.push(t)}}},e}(SingleClass);__reflect(EventMgr.prototype,"EventMgr");var EventVo=function(){function t(){}return t.prototype.dispose=function(){this.key=null,this.param=null},t}();__reflect(EventVo.prototype,"EventVo");var LangMgr=function(){function t(){}return t.initData=function(t){if(!this.init){var e=RES.getRes(t);e&&(this.addValue(e),RES.destroyRes(t),this.init=!0)}},t.addValue=function(t){if(this.config)for(var e in t)this.config[e]=t[e];else this.config=t},t.getValueByKey=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return this.config?this.config.hasOwnProperty(t)?this.config[t].format.apply(this.config[t],e).toString():(console.warn(t,"Language not key!!!"),t.format.apply(t,e).toString()):void console.error(t,"Language data error!!!")},t.getColor=function(t){return Number(this.getValueByKey(t))},t.getValueByArr=function(t,e){var i="";for(var o in t)i+=this.getValueByKey.apply(this,[t[o]].concat(e[o]));return i},t}();__reflect(LangMgr.prototype,"LangMgr");var ObjectPool=function(){function t(){this._objs=new Array}return t.prototype.pushObj=function(t){this._objs.push(t)},t.prototype.popObj=function(){return this._objs.length>0?this._objs.pop():null},t.prototype.clear=function(){for(;this._objs.length>0;)this._objs.pop()},t.pop=function(e){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t._content[e]||(t._content[e]=[]);var n=t._content[e];if(n.length){var r=n.pop();return r}var a=egret.getDefinitionByName(e),s=new(a.bind.apply(a,[void 0].concat(i)));return s.ObjectPoolKey=e,s},t.popWithExtraKey=function(e,i){t._content[e]||(t._content[e]=[]);var o,n=t._content[e];if(n.length)for(var r=0;r<n.length;r++)if(n[r].extraKey==i){o=n[r],n.splice(r,1);break}if(!o){var a=egret.getDefinitionByName(e);o=new a(i),o.extraKey=i,o.ObjectPoolKey=e}return o},t.push=function(e){if(null==e)return!1;var i=e.ObjectPoolKey;return!t._content[i]||t._content[i].indexOf(e)>-1?!1:(t._content[i].push(e),!0)},t.clear=function(){t._content={}},t.clearClass=function(e,i){void 0===i&&(i=null);for(var o=t._content[e];o&&o.length;){var n=o.pop();i&&n[i](),n=null}t._content[e]=null,delete t._content[e]},t.dealFunc=function(e,i){var o=t._content[e];if(null!=o){var n=0,r=o.length;for(n;r>n;n++)o[n][i]()}},t._content={},t}();__reflect(ObjectPool.prototype,"ObjectPool");var RES;!function(t){var e=function(e){function i(t,i,o){void 0===i&&(i=!1),void 0===o&&(o=!1);var n=e.call(this,t,i,o)||this;return n.itemsLoaded=0,n.itemsTotal=0,n.groupName="",n}return __extends(i,e),i.dispatchResourceEvent=function(e,o,n,r,a,s){void 0===n&&(n=""),void 0===r&&(r=void 0),void 0===a&&(a=0),void 0===s&&(s=0);var l=egret.Event.create(i,o);l.groupName=n,r&&(l.resItem=t.ResourceItem.convertToResItem(r)),l.itemsLoaded=a,l.itemsTotal=s;var h=e.dispatchEvent(l);return egret.Event.release(l),h},i.ITEM_LOAD_ERROR="itemLoadError",i.CONFIG_COMPLETE="configComplete",i.CONFIG_LOAD_ERROR="configLoadError",i.GROUP_PROGRESS="groupProgress",i.GROUP_COMPLETE="groupComplete",i.GROUP_LOAD_ERROR="groupLoadError",i}(egret.Event);t.ResourceEvent=e,__reflect(e.prototype,"RES.ResourceEvent")}(RES||(RES={}));var SceneMgr=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.clear=function(){var t=this._currScene;t&&(t.onExit(),this._currScene=void 0)},e.prototype.runScene=function(t){if(null==t)return void debug.log("runScene:scene is null");var e=this._currScene;e&&(e.onExit(),e=void 0);var i=new t;i.onEnter(),this._currScene=i},e.prototype.getCurrScene=function(){return this._currScene},e.prototype.getSceneName=function(){return this._currScene?egret.getQualifiedClassName(this._currScene):""},e.MAIN="MainScene",e}(SingleClass);__reflect(SceneMgr.prototype,"SceneMgr");var SwitchSceneMgr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scenes=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.register=function(t){-1==this.scenes.indexOf(t)&&this.scenes.push(t)},e.prototype.unregister=function(t){var e=this.scenes.indexOf(t);e>-1&&this.scenes.splice(e,1)},e.prototype.changeScene=function(){this.onExitScene(),this.onEnterScene()},e.prototype.onEnterScene=function(){for(var t=0;t<this.scenes.length;t++){var e=this.scenes[t];e.onEnterScene()}},e.prototype.onExitScene=function(){for(var t=0;t<this.scenes.length;t++){var e=this.scenes[t];e.onExitScene()}},e}(SingleClass);__reflect(SwitchSceneMgr.prototype,"SwitchSceneMgr");var TimerMgr=function(t){function e(){var e=t.call(this)||this;return e.currHandler=null,e._handlers=[],e.nexthandles=null,e._currTime=egret.getTimer(),e._currFrame=0,egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getFrameId=function(){return this._currFrame},e.prototype.getCurrTime=function(){return this._currTime},e.binFunc=function(t,e){return SortUtils.sortDescByKey(t,e,"exeTime")},e.DeleteHandle=function(t){t.clear(),ObjectPool.push(t)},e.prototype.onEnterFrame=function(t){this._currFrame++,this._currTime=egret.getTimer();var i=0,o=this.nexthandles;if(this.nexthandles=null,o&&o.length>0){for(var n=0,r=o;n<r.length;n++){var a=r[n];a.method.call(a.methodObj),e.DeleteHandle(a)}o=null}if(this._handlers.length<=0)return!1;for(var s=this._handlers[this._handlers.length-1];s.exeTime<=this._currTime;){this.currHandler=s=this._handlers.pop(),s.method.call(s.methodObj),i=egret.getTimer(),s.exeTime=i+s.delay;var l=s.forever;if(l||(s.repeatCount>1?(s.repeatCount--,l=!0):s.onFinish&&s.onFinish.apply(s.finishObj)),l){var h=CommonUtils.searchIndex(this._handlers,s,e.binFunc);this._handlers.splice(h,0,s)}else e.DeleteHandle(s);if(i-this._currTime>5)break;if(this._handlers.length<=0)break;s=this._handlers[this._handlers.length-1]}return this.currHandler=null,DebugUtils.OpenDebug&&this.delayCheckCache(),!1},e.prototype.delayCheckCache=function(){this.checkCache()},e.prototype.checkCache=function(){for(var t={0:"TimerMgr",1:"egret.Tween"},e=function(e,i){if(e instanceof egret.DisplayObject&&!e.stage){for(var o=e,n=egret.getQualifiedClassName(e),r=[];o;){if(o.ignoreLeak)return;var a=egret.getQualifiedClassName(o);if(o instanceof egret.DisplayObject&&r.push(a),o instanceof BaseEuiView&&o!=UIMgr.ins().getView(a))break;o=o.parent}var s=n+(" Leak, type:"+t[i]+",class:"+r.join(">"));debug.error(s),ReportData.getIns().reportClientErrorLog("MemLeak",s)}},i=this._handlers.length-1;i>=0;i--){var o=this._handlers[i],n=o.methodObj;o.forever&&e(n,0)}var r=egret.Tween._tweens;if(r)for(var i=0;i<r.length;i++){var a=r[i];a.loop&&e(a._target,1)}},e.prototype.create=function(t,i,o,n,r,a,s){if(!(0>i||0>o||null==n)){var l=ObjectPool.pop("MyTimerHandler");l.forever=0==o,l.repeatCount=o,l.delay=i,l.method=n,l.methodObj=r,l.onFinish=a,l.finishObj=s,l.exeTime=t+this._currTime;var h=CommonUtils.searchIndex(this._handlers,l,e.binFunc);this._handlers.splice(h,0,l)}},e.prototype.doTimer=function(t,e,i,o,n,r){void 0===n&&(n=null),void 0===r&&(r=null),this.create(t,t,e,i,o,n,r)},e.prototype.doTimerDelay=function(t,e,i,o,n,r,a){void 0===r&&(r=null),void 0===a&&(a=null),this.create(t,e,i,o,n,r,a)},e.prototype.doNext=function(t,e){var i=ObjectPool.pop("MyTimerHandler");i.method=t,i.methodObj=e,this.nexthandles||(this.nexthandles=[]),this.nexthandles.push(i)},e.prototype.once=function(t,e,i){this.create(t,t,1,e,i,null,null)},e.prototype.loop=function(t,e,i){this.create(t,t,0,e,i,null,null)},e.prototype.remove=function(t,i){var o=this.currHandler;o&&o.method==t&&o.methodObj==i&&(o.forever=!1,o.repeatCount=0);for(var n=this._handlers.length-1;n>=0;n--){var r=this._handlers[n];r.method==t&&r.methodObj==i&&(this._handlers.splice(n,1),e.DeleteHandle(r))}},e.prototype.removeAll=function(t){var i=this.currHandler;i&&i.methodObj==t&&(i.forever=!1,i.repeatCount=0);for(var o=this._handlers.length-1;o>=0;o--){var n=this._handlers[o];n.methodObj==t&&(this._handlers.splice(o,1),e.DeleteHandle(n))}},e.prototype.isExists=function(t,e){for(var i=0,o=this._handlers;i<o.length;i++){var n=o[i];if(n.method==t&&n.methodObj==e)return!0}return!1},__decorate([callDelay(5e3)],e.prototype,"delayCheckCache",null),__decorate([callLater],e.prototype,"doNext",null),e}(SingleClass);__reflect(TimerMgr.prototype,"TimerMgr");var MyTimerHandler=function(){function t(){this.delay=0,this.forever=!1,this.repeatCount=0,this.exeTime=0}return t.prototype.clear=function(){this.method=null,this.methodObj=null,this.onFinish=null,this.finishObj=null,this.forever=!1},t}();__reflect(MyTimerHandler.prototype,"MyTimerHandler");var CRC16=function(){function t(){}return t.update=function(e,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var n=0,r=0;0==o&&(o=e.length),e.position=i;for(var a=i;o>a;++a)r=255&t.CRCBitReflect(e.readByte(),8)^n>>8&16777215,r&=255,n=t.CRCTable[r]^n<<8&4294967040;return 65535&(0^t.CRCBitReflect(n,16))},t.makeCRCTable=function(){for(var e=0,i=new Array(256),o=0;256>o;++o){e=o<<8&4294967040;for(var n=0;8>n;++n)e=32768&e?e<<1&4294967294^t.POLYNOMIAL:e<<1&4294967294;i[o]=e}return i},t.CRCBitReflect=function(e,i){var o=0,n=0;i--;for(var r=0;i>=r;++r)n=i-r,1&e&&(o|=1<<n&t.DropBits[n]),e=e>>1&2147483647;return o},t.POLYNOMIAL=4129,t.CRCTable=t.makeCRCTable(),t.DropBits=[4294967295,4294967294,4294967292,4294967288,4294967280,4294967264,4294967232,4294967168,4294967040,4294966784,4294966272,4294965248,4294963200,4294959104,4294950912,4294934528],t}();__reflect(CRC16.prototype,"CRC16");var Encrypt=function(){function t(){}return t.encode=function(e,i,o){if(void 0===i&&(i=0),void 0===o&&(o=0),i>=e.length)return 0;var n=o?i+o:e.length;n>e.length&&(n=e.length),e.position=i;for(var r=i;n>r;++r){var a=e.readByte();a^=t.sKeyBuff[r%4],e.position--,e.writeByte(a)}return n-i},t.decode=function(e,i,o){return void 0===i&&(i=0),void 0===o&&(o=0),t.encode(e,i,o)},t.getCRC16=function(t,e){return void 0===e&&(e=0),CRC16.update(t,0,e)},t.getCRC16ByPos=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),CRC16.update(t,e,i)},t.getCheckKey=function(){var e=new egret.ByteArray;e.endian=egret.Endian.LITTLE_ENDIAN,e.writeUnsignedInt(t.sKey);var i=CRC16.update(e);return i},t.getSelfSalt=function(){return t.sSelfSalt},t.getTargetSalt=function(){return t.sTargetSalt},t.setTargetSalt=function(e){t.sTargetSalt=e,t.makeKey()},t.makeSalt=function(){return Math.random()*(Date.now()/1e3)>>0},t.makeKey=function(){t.sKey=(t.sSelfSalt^t.sTargetSalt)+8254;for(var e=0;4>e;++e)t.sKeyBuff[e]=(t.sKey&255<<(e<<3))>>(e<<3)},t.sSelfSalt=t.makeSalt(),t.sKeyBuff=new Array(4),t}();__reflect(Encrypt.prototype,"Encrypt");var WatcherUtil=function(){function t(){}return t.removeFromArrayCollection=function(e){e&&e.source&&e.source.length&&t.removeFromArray(e.source)},t.removeFromArray=function(e){if(e)for(var i=0,o=e;i<o.length;i++){var n=o[i];t.removeFromObject(n)}},t.removeFromObject=function(t){if(t instanceof egret.EventDispatcher){var e=t.$getEventMap(),i=e[eui.PropertyEvent.PROPERTY_CHANGE];if(i)for(var o=i.length-1;o>=0;o--){var n=i[o];n.thisObject instanceof eui.Watcher&&(n.thisObject.unwatch(),i.splice(o,1))}}else{var r=t.__listeners__;if(r&&r.length)for(var a=0;a<r.length;a+=2){var s=r[a+1];s instanceof eui.Watcher&&(s.unwatch(),a-=2)}}},t}();__reflect(WatcherUtil.prototype,"WatcherUtil");var SocketBase=function(t){function e(){var e=t.call(this)||this;return e.pid=0,e._socketStatus=0,e.PACK_HANDLER=[],e.showLog=!1,e.catchError=!1,e.newSocket(),e.recvPack=new GameByteArray,e}return __extends(e,t),Object.defineProperty(e.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),e.prototype.getSocket=function(){return this.socket},e.prototype.setOnClose=function(t,e){this.onClosedCallback=t.bind(e)},e.prototype.setOnConnected=function(t,e){this.onConnectedCallback=t.bind(e)},e.prototype.newSocket=function(){this.socket&&this.removeEvent(),this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket.addEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this)},e.prototype.removeEvent=function(){this.socket.removeEventListener(egret.Event.CONNECT,this.onSocketConnected,this),this.socket.removeEventListener(egret.Event.CLOSE,this.onSocketClose,this),this.socket.removeEventListener(egret.ProgressEvent.SOCKET_DATA,this.onSocketRead,this),this.socket.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.connectError,this)},e.prototype.connectSocket=function(t,e,i){void 0===i&&(i=!1),this.updateStatus(SocketConst.STATUS_CONNECTING),this._host=t,this._port=e,this.socket.connect(t,e,i)},e.prototype.onSocketConnected=function(){debug.log("Socket connected！ip:"+this._host+" port:"+this._port),this.updateStatus(SocketConst.STATUS_CHECKING);var t=Encrypt.getSelfSalt();debug.log("SendEncrypt:",t);var e=new GameByteArray;e.writeUnsignedInt(t),this.socket.writeBytes(e),this.socket.flush()},e.prototype.onSocketRead=function(t){if(this._socketStatus<SocketConst.STATUS_COMMUNICATION)return void this.sendKeyToServer();this.recvPack.clear(),this.socket.readBytes(this.recvPack,this.recvPack.length),NetCalcUtils.revBytes+=this.recvPack.length;
var e=this.recvPack.readUnsignedShort();e==SocketConst.DEFAULT_TAG&&(this.recvPack.readUnsignedShort(),this.recvPack.position+=4,this.processRecvPacket(this.recvPack))},e.prototype.sendKeyToServer=function(){var t=new GameByteArray;this.socket.readBytes(t),t.position=0;var e=t.readUnsignedInt();debug.log("ReceiveEncrypt:",e),Encrypt.setTargetSalt(e);var i=Encrypt.getCheckKey();debug.log("SendSign:",i),t.position=0,t.writeShort(i),this.socket.writeBytes(t,0,2),this.recycleByte(t),this.updateStatus(SocketConst.STATUS_COMMUNICATION)},e.prototype.processRecvPacket=function(t){var e=t.readUnsignedByte(),i=t.readUnsignedByte();this.dispatch(e,i,t)},e.prototype.dispatch=function(t,e,i){if(!this.PACK_HANDLER[t]||!this.PACK_HANDLER[t][e])return void debug.log("unregistered server agreements:"+t+"-"+e);this.printSocketLog("S->C:"+t+"-"+e),NetCalcUtils.calcRevBytes(t,e,i.length);var o=this.PACK_HANDLER[t][e],n=[i];if(o[2]&&(this.catchError=!1,n=this.decodeParam(o[2],i),this.catchError)){var r="S->C["+t+"-"+e+"]->:"+n;debug.error(r),ReportData.getIns().reportClientErrorLog("SocketDown",r)}(a=o[0]).call.apply(a,[o[1]].concat(n));var a},e.prototype.encodeParam=function(t,e,i){for(var o=t.length,n=0;o>n&&!(n>=e.length);n++)if(t[n]instanceof Array){i.writeUnsignedShort(e[n].length);for(var r=0;r<e[n].length;++r)this.encodeParam(t[n],e[n][r]instanceof Array?e[n][r]:[e[n][r]],i)}else{var a=t[n],s=e[n];0==a?i.writeBoolean(s):1==a?i.writeByte(s):2==a?i.writeShort(s):3==a?i.writeInt(s):4==a?i.writeByte(s):5==a?i.writeUnsignedShort(s):6==a?i.writeUnsignedInt(s):7==a?i.writeUnsignedInt64(s):8==a?i.writeString(s?s.toString():""):9==a?i.writeFloat(s):10==a&&i.writeDouble(s)}},e.prototype.decodeParam=function(t,e){for(var i=[],o=t.length,n=0;o>n&&!(e.position>=e.length);n++)if(t[n]instanceof Array){for(var r=e.readUnsignedShort(),a=[],s=0;r>s;s++){var l=this.decodeParam(t[n],e);1==l.length?a.push(l[0]):a.push(l)}if(i.push(a),this.catchError)return i}else try{var h=t[n];if(0==h)i.push(e.readBoolean());else if(1==h)i.push(e.readByte());else if(2==h)i.push(e.readShort());else if(3==h)i.push(e.readInt());else if(4==h)i.push(e.readUnsignedByte());else if(5==h)i.push(e.readUnsignedShort());else if(6==h)i.push(e.readUnsignedInt());else if(7==h)i.push(e.readUnsignedInt64());else if(8==h)i.push(e.readString());else if(9==h)i.push(e.readFloat());else if(10==h)i.push(e.readDouble());else if(11==h){var u=e.readBoolean();if(i.push(u),u)break}}catch(c){return this.catchError=!0,i}return i},e.prototype.close=function(){this.socket&&this._host&&this._port&&(debug.log("close socket！ip:"+this._host+" port:"+this._port),this.socket.close())},e.prototype.updateStatus=function(t){if(this._socketStatus!=t){var e=this._socketStatus;this._socketStatus=t,this.onFinishCheck(t,e)}},e.prototype.recycleByte=function(t){ObjectPool.push(t)},e.prototype.getBytes=function(){var t=ObjectPool.pop(SocketConst.CLASSNAME);return t.clear(),t.writeShort(SocketConst.DEFAULT_TAG),t.writeShort(0),t.writeShort(0),t.writeShort(SocketConst.DEFAULT_CRC_KEY),t.writeUnsignedInt(this.pid++),t},e.prototype.regHandler=function(t,e,i,o,n){if(this.PACK_HANDLER[t]){if(this.PACK_HANDLER[t][e])return void debug.error("repeat agreements:"+t+"-"+e)}else this.PACK_HANDLER[t]=[];this.PACK_HANDLER[t][e]=[i,o,n]},e.prototype.sendToServer=function(t){this._socketStatus==SocketConst.STATUS_COMMUNICATION?this.sendPack(t):debug.log("socket not connected"),t.position=12,this.printSocketLog("C->S:"+t.readUnsignedByte()+"-"+t.readUnsignedByte()),this.recycleByte(t)},e.prototype.sendPack=function(t){if(null==t||0==t.length)throw new debug.error("send bytes is null!");var e=SocketConst.HEAD_SIZE;t.position=2,t.writeShort(t.length-e);var i=Encrypt.getCRC16ByPos(t,e);t.position=4,t.writeShort(i);var o=Encrypt.getCRC16(t,e);t.position=6,t.writeShort(o),Encrypt.encode(t,4,4),NetCalcUtils.sendBytes+=t.length,this.socket.writeBytes(t)},e.prototype.printSocketLog=function(t){this.showLog&&console.log(t)},e.prototype.onSocketClose=function(t){},e.prototype.connectError=function(t){},e.prototype.reLogin=function(){},e.prototype.onFinishCheck=function(t,e){},e}(SingleClass);__reflect(SocketBase.prototype,"SocketBase");var SocketConst=function(){function t(){}return t.DEFAULT_TAG=52462,t.DEFAULT_CRC_KEY=30301,t.HEAD_SIZE=8,t.STATUS_CONNECTING=1,t.STATUS_CHECKING=2,t.STATUS_COMMUNICATION=3,t.STATUS_DISCONNECT=4,t.CLASSNAME=egret.getQualifiedClassName(GameByteArray),t}();__reflect(SocketConst.prototype,"SocketConst");var UInt64=function(){function t(t){this._lowUint=0,this._highUint=0,this.value=t}return t.prototype.isEqual=function(t){return t?this._lowUint==t._lowUint&&this._highUint==t._highUint:!1},t.prototype.isGreaterThan=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},t.prototype.isGreaterThanOrEqual=function(e){if(e instanceof t)return this._highUint>e._highUint||this._highUint==e._highUint&&this._lowUint>=e._lowUint;var i=new t;return"string"==typeof e?(i.value=e,this.isGreaterThanOrEqual(i)):"number"==typeof e?(i.value=e.toString(),this.isGreaterThanOrEqual(i)):void 0},Object.defineProperty(t.prototype,"isZero",{get:function(){return 0==this._lowUint&&0==this._highUint},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGreaterThanZero",{get:function(){return this._lowUint>0||this._highUint>0},enumerable:!0,configurable:!0}),t.prototype.writeByte=function(t){t.writeUnsignedInt(this._lowUint),t.writeUnsignedInt(this._highUint)},t.prototype.setValue=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._lowUint=t,this._highUint=e},Object.defineProperty(t.prototype,"value",{set:function(e){e instanceof egret.ByteArray?(this._lowUint=e.readUnsignedInt(),this._highUint=e.readUnsignedInt()):"string"==typeof e&&t.stringToUint64(e,10,this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueByString",{set:function(t){},enumerable:!0,configurable:!0}),t.prototype.leftMove=function(e,i){void 0===i&&(i=null),i=i||this;var o=t.LeftMoveMask[e],n=o&this._lowUint;n>>>=32-e,i._lowUint=this._lowUint<<e,i._highUint=this._highUint<<e,i._highUint=i._highUint|n},t.prototype.add=function(e,i){void 0===i&&(i=null),i=i||this;var o=this._lowUint+e._lowUint;i._highUint=this._highUint+e._highUint,o>=t.MaxLowUint?(i._highUint++,i._lowUint=o-t.MaxLowUint):i._lowUint=o},t.prototype.subtraction=function(e,i){void 0===i&&(i=null),i=i||this;var o=this._lowUint-e._lowUint;i._highUint=this._highUint-e._highUint,0>o?(i._highUint--,i._lowUint=o+t.MaxLowUint):i._lowUint=o},t.prototype.scale=function(e,i){void 0===i&&(i=null),i=i||this;var o=this._lowUint*e;i._highUint=this._highUint*e,i._highUint+=Math.floor(Math.abs(o/t.MaxLowUint)),i._lowUint=o%t.MaxLowUint},t.prototype.toString=function(e){void 0===e&&(e=10);for(var i,o,n,r="",a=this._lowUint,s=this._highUint;0!=s||0!=a;)i=s%e,n=i*t.MaxLowUint+a,o=n%e,r=o+r,s=(s-i)/e,a=(n-o)/e;return r.length?r:"0"},t.stringToUint64=function(e,i,o){void 0===i&&(i=10),void 0===o&&(o=null),o=o||new t;for(var n,r,a=0,s=0,l=e.length,h=0;l>h;h++)r=parseInt(e.charAt(h)),n=a*i+r,s=s*i+Math.floor(n/t.MaxLowUint),a=n%t.MaxLowUint;return o.setValue(a,s),o},t.LeftMoveMask=[0,2147483648,1073741824,536870912,268435456,134217728,67108864,33554432,16777216,8388608,4194304,2097152,1048576,524288,262144,131072,65536,32768,16384,8192,4096,2048,1024,512,256,128,64,32,16,8,4,2,1],t.MaxLowUint=4294967296,t}();__reflect(UInt64.prototype,"UInt64");var RES;!function(t){var e=function(){function e(t){this.data=t}return e.prototype.profile=function(){console.log(this.data)},e.prototype.addFile=function(e,i){i||(i=""),e=t.path.normalize(e);var o=t.path.basename(e),n=t.path.dirname(e);this.exists(n)||this.mkdir(n);var r=this.resolve(n);r[o]={url:e,type:i}},e.prototype.getFile=function(t){var e=this.resolve(t);return e&&(e.name=t),e},e.prototype.resolve=function(e){if(""==e)return this.data;e=t.path.normalize(e);for(var i=e.split("/"),o=this.data,n=0,r=i;n<r.length;n++){var a=r[n];if(!o)return o;o=o[a]}return o},e.prototype.mkdir=function(e){e=t.path.normalize(e);for(var i=e.split("/"),o=this.data,n=0,r=i;n<r.length;n++){var a=r[n];o[a]||(o[a]={}),o=o[a]}},e.prototype.exists=function(e){if(""==e)return!0;e=t.path.normalize(e);for(var i=e.split("/"),o=this.data,n=0,r=i;n<r.length;n++){var a=r[n];if(!o[a])return!1;o=o[a]}return!0},e}();t.NewFileSystem=e,__reflect(e.prototype,"RES.NewFileSystem")}(RES||(RES={}));var SoundBg=function(t){function e(){var e=t.call(this)||this;return e._currBg="",e}return __extends(e,t),e.prototype.stop=function(){this._currSoundChannel&&this.removeSoundChannel(this._currSoundChannel),this._currSoundChannel=null,this._currSound=null,this._currBg=""},e.prototype.play=function(t){if(this._currBg!=t){this.stop(),this._currBg=t;var e=this.getSound(t);e&&this.playSound(e)}},e.prototype.touchPlay=function(){if(this._currSoundChannel&&this._currSound){var t=this._currSoundChannel.position;this.removeSoundChannel(this._currSoundChannel),this._currSoundChannel=this._currSound.play(t,1),this.addSoundChannel(this._currSoundChannel)}},e.prototype.playSound=function(t){this._currSound=t,this._currSoundChannel=this._currSound.play(0,1),this.addSoundChannel(this._currSoundChannel)},e.prototype.onSoundComplete=function(){this._currSoundChannel&&this.removeSoundChannel(this._currSoundChannel),this.playSound(this._currSound)},e.prototype.addSoundChannel=function(t){t.volume=this._volume,t.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this)},e.prototype.removeSoundChannel=function(t){t.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),t.stop()},e.prototype.setVolume=function(t){this._volume=t,this._currSoundChannel&&(this._currSoundChannel.volume=this._volume)},e.prototype.loadedPlay=function(t){if(this._currBg==t){var e=RES.getRes(t);if(!e)return;this.playSound(e)}},e.prototype.checkCanClear=function(t){return this._currBg!=t},e}(BaseSound);__reflect(SoundBg.prototype,"SoundBg");var SoundEffects=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.play=function(t){var e=this.getSound(t);e&&this.playSound(e)},e.prototype.playSound=function(t){var e=t.play(0,1);e.volume=this._volume},e.prototype.setVolume=function(t){this._volume=t},e.prototype.loadedPlay=function(t){var e=RES.getRes(t);e&&this.playSound(e)},e}(BaseSound);__reflect(SoundEffects.prototype,"SoundEffects");var SoundManager=function(t){function e(){var e=t.call(this)||this;return e.bgOn=!0,e.effectOn=!0,e.bgVolume=.5,e.effectVolume=.5,e.bg=new SoundBg,e.bg.setVolume(e.bgVolume),e.effect=new SoundEffects,e.effect.setVolume(e.effectVolume),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.playEffect=function(t){this.effectOn&&this.effect.play(t)},e.prototype.playBg=function(t){this.currBg=t,this.bgOn&&this.bg.play(t)},e.prototype.stopBg=function(){this.bg.stop()},e.prototype.touchBg=function(){egret.Capabilities.isMobile&&"iOS"==egret.Capabilities.os&&this.bg.touchPlay()},e.prototype.setEffectOn=function(t){this.effectOn=t},e.prototype.setBgOn=function(t){this.bgOn=t,this.bgOn?this.currBg&&this.playBg(this.currBg):this.stopBg()},e.prototype.setBgVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.bgVolume=t,this.bg.setVolume(this.bgVolume)},e.prototype.getBgVolume=function(){return this.bgVolume},e.prototype.setEffectVolume=function(t){t=Math.min(t,1),t=Math.max(t,0),this.effectVolume=t,this.effect.setVolume(this.effectVolume)},e.prototype.getEffectVolume=function(){return this.effectVolume},e}(SingleClass);__reflect(SoundManager.prototype,"SoundManager");var Base64=function(){function t(){}return t.base64encode=function(t){var e,i,o,n,r,a;for(o=t.length,i=0,e="";o>i;){if(n=255&t.charCodeAt(i++),i==o){e+=this.base64EncodeChars.charAt(n>>2),e+=this.base64EncodeChars.charAt((3&n)<<4),e+="==";break}if(r=t.charCodeAt(i++),i==o){e+=this.base64EncodeChars.charAt(n>>2),e+=this.base64EncodeChars.charAt((3&n)<<4|(240&r)>>4),e+=this.base64EncodeChars.charAt((15&r)<<2),e+="=";break}a=t.charCodeAt(i++),e+=this.base64EncodeChars.charAt(n>>2),e+=this.base64EncodeChars.charAt((3&n)<<4|(240&r)>>4),e+=this.base64EncodeChars.charAt((15&r)<<2|(192&a)>>6),e+=this.base64EncodeChars.charAt(63&a)}return e},t.base64decode=function(t){var e,i,o,n,r,a,s;for(a=t.length,r=0,s="";a>r;){do e=this.base64DecodeChars[255&t.charCodeAt(r++)];while(a>r&&-1==e);if(-1==e)break;do i=this.base64DecodeChars[255&t.charCodeAt(r++)];while(a>r&&-1==i);if(-1==i)break;s+=String.fromCharCode(e<<2|(48&i)>>4);do{if(o=255&t.charCodeAt(r++),61==o)return s;o=this.base64DecodeChars[o]}while(a>r&&-1==o);if(-1==o)break;s+=String.fromCharCode((15&i)<<4|(60&o)>>2);do{if(n=255&t.charCodeAt(r++),61==n)return s;n=this.base64DecodeChars[n]}while(a>r&&-1==n);if(-1==n)break;s+=String.fromCharCode((3&o)<<6|n)}return s},t.base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t.base64DecodeChars=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],t}();__reflect(Base64.prototype,"Base64");var BezierWarp=function(){function t(t,e){this._fromPoint=t,this._toPoint=e}return t.pop=function(e,i){var o=null;return this._pool.length?(o=this._pool.pop(),o.fromPoint=e,o.toPoint=i):o=new t(e,i),o},t.push=function(t){t&&(t.display=null,t.ease=null,t.fromPoint=null,t.toPoint=null,t.centerPoint=null,this._pool.push(t))},Object.defineProperty(t.prototype,"fromPoint",{set:function(t){this._fromPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toPoint",{set:function(t){this._toPoint=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"display",{set:function(t){this._display=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ease",{set:function(t){this._ease=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"centerPoint",{set:function(t){this._centerPoint=t},enumerable:!0,configurable:!0}),t.prototype.start=function(t,e,i,o){var n=this;void 0===o&&(o=0),egret.Tween.get(this).wait(o).to({factor:1},t,this._ease).call(function(){egret.Tween.removeTweens(n),e&&e.call(i)})},Object.defineProperty(t.prototype,"factor",{get:function(){return 0},set:function(t){this._display.x=(1-t)*(1-t)*this._fromPoint.x+2*t*(1-t)*this._centerPoint.x+t*t*this._toPoint.x,this._display.y=(1-t)*(1-t)*this._fromPoint.y+2*t*(1-t)*this._centerPoint.y+t*t*this._toPoint.y},enumerable:!0,configurable:!0}),t._pool=[],t}();__reflect(BezierWarp.prototype,"BezierWarp");var ColorUtils=function(){function t(){}return t.getColorcChinese=function(t){return LangMgr.getValueByKey("colorcChinese"+t)},Object.defineProperty(t,"BLACK",{get:function(){return LangMgr.getColor("black")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ALPHA",{get:function(){return LangMgr.getColor("alpha")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RED",{get:function(){return LangMgr.getColor("red")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GREEN",{get:function(){return LangMgr.getColor("green")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"BLUE",{get:function(){return LangMgr.getColor("blue")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"YELLOW",{get:function(){return LangMgr.getColor("yellow")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GRAY",{get:function(){return LangMgr.getColor("gray")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"NORMAL_COLOR",{get:function(){return LangMgr.getColor("normalColor")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WHITE_COLOR",{get:function(){return LangMgr.getValueByKey("whiteColor")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"RED_COLOR",{get:function(){return LangMgr.getValueByKey("redColor")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GREEN_COLOR",{get:function(){return LangMgr.getValueByKey("greenColor")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GRAY_COLOR",{get:function(){return LangMgr.getValueByKey("grayColor")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ATTR_DEFAULT_COLOR",{get:function(){return LangMgr.getColor("attrDefaultColor")},enumerable:!0,configurable:!0}),t}();__reflect(ColorUtils.prototype,"ColorUtils");var CommonUtils=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.addLableStrokeColor=function(t,e,i){t.strokeColor=e,t.stroke=i},e.getObjectLength=function(t){var e=0;for(var i in t)e++;return e},e.getObjectByAttr=function(t,e,i){for(var o in t)if(t[o][e]==i)return t[o];return null},e.getObjectByUnionAttr=function(t,e,i){for(var o in t)if(o==e.toString())for(var n in t[o])if(n==i.toString())return t[o][n];return null},e.copyDataHandler=function(t){var e;if(t instanceof Array)e=[];else{if(!(t instanceof Object))return t;e={}}for(var i=Object.keys(t),o=0,n=i.length;n>o;o++){var r=i[o];e[r]=this.copyDataHandler(t[r])}return e},e.copyDataDepth=function(t){var e;if(!(t instanceof Object))return t;var i=egret.getQualifiedClassName(t);if(i)try{var o=egret.getDefinitionByName(i);e=o&&o.constructor?new o:{}}catch(n){e={}}else e={};for(var r=Object.keys(t),a=r.length,s=0;a>s;s++){var l=r[s];"function"!=typeof t[l]&&(e[l]=this.copyDataDepth(t[l]))}return e},e.objectToArray=function(t){return t instanceof Object?(t=this.copyDataHandler(t),this.objectToArrayShallow(t)):t},e.objectToArrayShallow=function(t){if(t instanceof Object){var e=[];for(var i in t)null!=t[i]&&e.push(t[i]);return e}return t},e.arraySort=function(t,e,i){return void 0===i&&(i=0),t.sort(function(t,o){return SortUtils.sortByKey(t,o,e,i)}),t},e.lock=function(){StageUtils.ins().getStage().touchEnabled=StageUtils.ins().getStage().touchChildren=!1},e.unlock=function(){StageUtils.ins().getStage().touchEnabled=StageUtils.ins().getStage().touchChildren=!0},e.labelIsOverLenght=function(t,e){t.text=this.overLength(e)},e.overLength=function(t){var e=null;return 1e5>t?e=Math.floor(t)+"":t>1e8?(t/=1e8,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan1",t)):(t/=1e4,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan",t)),e},e.overLengthChange=function(t){var e=null;return 1e4>t?e=Math.floor(t)+"":t>1e8?(t/=1e8,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan1",t)):(t/=1e4,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan",t)),e},e.overLengthNo=function(t){var e=null;return 1e4>t?e=Math.floor(t)+"":t>1e8?(t/=1e8,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan1",t)):(t/=1e4,t=Math.floor(10*t)/10,e=LangMgr.getValueByKey("shopWan",t)),e},e.getImgBase64Data=function(t){var e=new egret.RenderTexture;e.drawToTexture(t),e.toDataURL("image/png")},e.searchIndex=function(t,e,i){if(!t||0==t.length)return 0;i||(i=SortUtils.sortDescByKey);for(var o=0,n=t.length-1;n>=o;){var r=n+o>>1,a=t[r];i(a,e)<=0?o=r+1:n=r-1}return o},e}(SingleClass);__reflect(CommonUtils.prototype,"CommonUtils");var DateStyle=function(){function t(t,e,i,o){this.format=[],this.from=0,this.to=0,this.isFormatNum=!1,this.format=t,this.from=e,this.to=i,this.isFormatNum=o}return t}();__reflect(DateStyle.prototype,"DateStyle");var DateUtils=function(){function t(){}return Object.defineProperty(t,"FORMAT_1",{get:function(){return this.format_1_value||(this.format_1_value=[LangMgr.getValueByKey("activitSS"),LangMgr.getValueByKey("activitMine",""),LangMgr.getValueByKey("dateType1"),LangMgr.getValueByKey("activitDay",""),LangMgr.getValueByKey("activitMonth"),LangMgr.getValueByKey("dateType2")]),this.format_1_value},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STYLE_1",{get:function(){return this.style_1_value||(this.style_1_value=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_HOUR,!1)),this.style_1_value},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STYLE_2",{get:function(){return this.style_2_value||(this.style_2_value=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_DAY,!1)),this.style_2_value},enumerable:!0,configurable:!0}),Object.defineProperty(t,"STYLE_4",{get:function(){return this.style_4_value||(this.style_4_value=new DateStyle(t.FORMAT_1,t.TO_SECOND,t.TO_MINUTE,!0)),this.style_4_value},enumerable:!0,configurable:!0}),t.getFormatTimeByStyle=function(e,i){if(void 0===i&&(i=t.STYLE_1),0>e&&(e=0),i.from>i.to)return"";e>>=0;for(var o="",n=i.to;n>=i.from;n--){var r=e/this.mul[n],a="";n!=i.to&&(r%=this.mod[n]),a=i.isFormatNum&&10>r?"0"+(r>>0).toString():(r>>0).toString(),o+=a+i.format[n]}return o},t.getFormatTimeByStyle1=function(e,i){return void 0===i&&(i=t.STYLE_1),this.getFormatTimeByStyle(e/this.MS_PER_SECOND)},t.formatMiniDateTime=function(e){return t.MINI_DATE_TIME_BASE+(2147483647&e)*t.MS_PER_SECOND},t.formatServerTime=function(e){return(e-t.MINI_DATE_TIME_BASE)/t.MS_PER_SECOND},t.getFormatBySecond=function(t,e,i,o){void 0===e&&(e=1),void 0===i&&(i=2),void 0===o&&(o=!0);var n="",r=1e3*t;switch(e){case this.TIME_FORMAT_1:n=this.format_1(r);break;case this.TIME_FORMAT_2:n=this.format_2(r);break;case this.TIME_FORMAT_3:n=this.format_3(r);break;case this.TIME_FORMAT_4:n=this.format_4(r);break;case this.TIME_FORMAT_5:n=this.format_5(r,i,o);break;case this.TIME_FORMAT_6:n=this.format_6(r);break;case this.TIME_FORMAT_7:n=this.format_7(r);break;case this.TIME_FORMAT_8:n=this.format_8(r);break;case this.TIME_FORMAT_9:n=this.format_9(r);break;case this.TIME_FORMAT_10:n=this.format_10(r);break;case this.TIME_FORMAT_11:n=this.format_11(r);break;case this.TIME_FORMAT_12:n=this.format_12(r);break;case this.TIME_FORMAT_13:n=this.format_13(r);break;case this.TIME_FORMAT_14:n=this.format_14(r);break;case this.TIME_FORMAT_15:n=this.format_15(r);break;case this.TIME_FORMAT_16:n=this.format_16(r);break;case this.TIME_FORMAT_17:n=this.format_17(r);break;case this.TIME_FORMAT_19:n=this.format_19(t);break;case this.TIME_FORMAT_20:n=this.format_20(t)}return n},t.getRenainSecond=function(e){var i=e?new Date(e):new Date,o=t.getTodayZeroSecond(i)+86400-i.getTime()/1e3;return o.toFixed(0)},t.getTodayPassedSecond=function(){var t=new Date,e=((Date.now()-new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime())/1e3).toFixed(0);return parseInt(e)},t.getTodayZeroSecond=function(t){var e=t?t:new Date;return parseInt((new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()/1e3).toFixed(0))},t.showWeekFirstDay=function(){var t=new Date,e=t.getDay();e=e?e:7;var i=new Date(t-864e5*(e-1));return i},t.showWeekLastDay=function(){var e=(new Date,t.showWeekFirstDay()),i=new Date(1e3*(e/1e3+518400));return i},t.calcWeekFirstDay=function(){var t=new Date,e=t.getDay();e=e>0?e:7;var i=7-e,o=t.getHours(),n=t.getMinutes(),r=t.getSeconds(),a=86400*i*1e3+864e5-(3600*o*1e3+60*n*1e3+1e3*r);return new Date(a)},t.calcNextDay=function(e){var i=e?new Date(e):new Date,o=i.getHours(),n=24-o,r=i.getMinutes(),a=i.getSeconds(),s=n*t.MS_PER_HOUR-(r*t.MS_PER_MINUTE+a*t.MS_PER_SECOND);return s},t.calcNextNDay=function(e,i,o){void 0===i&&(i=0);var n=t.calcNextDay(e),r=i*t.SECOND_PER_DAY*t.MS_PER_SECOND,a=Math.floor((e+n+r-o)/t.MS_PER_SECOND);return a},t.sameDay=function(t,e){var i=!1,o=new Date(t),n=new Date(e);return o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()==n.getDate()&&(i=!0),i},t.calcDiffDay=function(e,i){var o=new Date(e);o.setHours(0),o.setMinutes(0),o.setSeconds(0),o.setMilliseconds(0);var n=new Date(i);n.setHours(0),n.setMinutes(0),n.setSeconds(0),n.setMilliseconds(0);var r=o.getTime()-n.getTime(),a=r>0?r/t.MS_PER_DAY:0;return Math.floor(a)},t.getDayState=function(e,i){var o=new Date(e),n=new Date(i),r=t.getTodayZeroSecond(o),a=t.getTodayZeroSecond(n);return r==a?0:n.getTime()>o.getTime()?1:-1},t.format_1=function(e){var i=0,o="##:##:##";return i=Math.floor(e/t.MS_PER_HOUR),o=o.replace("##",t.formatTimeNum(i)),i&&(e-=i*t.MS_PER_HOUR),i=Math.floor(e/t.MS_PER_MINUTE),o=o.replace("##",t.formatTimeNum(i)),i&&(e-=i*t.MS_PER_MINUTE),i=Math.floor(e/1e3),o=o.replace("##",t.formatTimeNum(i))},t.format_2=function(t){var e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),r=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return i+"-"+this.formatTimeNum(o)+"-"+this.formatTimeNum(n)+" "+this.formatTimeNum(r)+":"+this.formatTimeNum(a)+":"+this.formatTimeNum(s)},t.format_3=function(t){var e=this.format_1(t),i=e.split(":");return i[1]+":"+i[2]},t.format_4=function(t){return t<this.MS_PER_HOUR?Math.floor(t/this.MS_PER_MINUTE)+LangMgr.getValueByKey("dateTips1"):t<this.MS_PER_DAY?Math.floor(t/this.MS_PER_HOUR)+LangMgr.getValueByKey("dateTips2"):Math.floor(t/this.MS_PER_DAY)+LangMgr.getValueByKey("dateTips3")},t.format_5=function(t,e,i){void 0===e&&(e=2),void 0===i&&(i=!0);var o="",n=[LangMgr.getValueByKey("activitDay",""),LangMgr.getValueByKey("dateType1"),LangMgr.getValueByKey("activitMine",""),LangMgr.getValueByKey("activitSS")],r=[],a=Math.floor(t/this.MS_PER_DAY);r.push(a),t-=a*this.MS_PER_DAY;var s=Math.floor(t/this.MS_PER_HOUR);r.push(s),t-=s*this.MS_PER_HOUR;var l=Math.floor(t/this.MS_PER_MINUTE);r.push(l),t-=l*this.MS_PER_MINUTE;var h=Math.floor(t/1e3);r.push(h);for(var u in r)if(r[u]>0){var c=i?this.formatTimeNum(r[u],Number(u)):r[u].toString();if(o+=c+n[u],e--,0>=e)break}return o},t.format_6=function(t){var e=new Date(t),i=e.getHours(),o=e.getMinutes(),n=e.getSeconds();return this.formatTimeNum(i)+":"+this.formatTimeNum(o)+":"+this.formatTimeNum(n)},t.format_7=function(t){return t<this.MS_PER_HOUR?LangMgr.getValueByKey("dateTips4"):t<this.MS_PER_DAY?LangMgr.getValueByKey("activitHoure",Math.floor(t/this.MS_PER_HOUR)):LangMgr.getValueByKey("activitDay",Math.floor(t/this.MS_PER_DAY))},t.format_8=function(t){var e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=e.getDate(),r=e.getHours(),a=e.getMinutes();return i+"-"+o+"-"+n+" "+r+":"+a},t.format_9=function(t){var e=Math.floor(t/this.MS_PER_HOUR);t-=e*this.MS_PER_HOUR;var i=Math.floor(t/this.MS_PER_MINUTE);t-=i*this.MS_PER_MINUTE;var o=Math.floor(t/1e3);return LangMgr.getValueByKey("activitHoure",e)+LangMgr.getValueByKey("dateTips5",i)+LangMgr.getValueByKey("activitSS1",o)},t.format_10=function(t){var e=Math.floor(t/this.MS_PER_MINUTE);t-=e*this.MS_PER_MINUTE;var i=Math.floor(t/1e3);return LangMgr.getValueByKey("activitMine",e)+LangMgr.getValueByKey("activitSS1",i)},t.format_11=function(t){var e=Math.floor(t/this.MS_PER_HOUR);t-=e*this.MS_PER_HOUR;var i=Math.floor(t/this.MS_PER_MINUTE);t-=i*this.MS_PER_MINUTE;var o=Math.floor(t/1e3);return LangMgr.getValueByKey("activitHoure",e)+LangMgr.getValueByKey("activitMine",i)+LangMgr.getValueByKey("activitSS1",o)},t.format_12=function(e){var i=Math.floor(e/this.MS_PER_HOUR);e-=i*this.MS_PER_HOUR;var o=Math.floor(e/this.MS_PER_MINUTE);e-=o*this.MS_PER_MINUTE;var n=Math.floor(e/1e3);return t.formatTimeNum(i)+":"+t.formatTimeNum(o)+":"+t.formatTimeNum(n)},t.format_13=function(e){var i=new Date(e),o=(i.getFullYear(),i.getMonth()+1),n=i.getDay(),r=i.getDate(),a=i.getHours(),s=i.getMinutes();return LangMgr.getValueByKey("dateTips6",o,r,LangMgr.getValueByKey("weeksDay"+n),t.formatTimeNum(a),t.formatTimeNum(s))},t.format_14=function(t){var e=new Date(t),i=e.getHours(),o=e.getMinutes();return LangMgr.getValueByKey("activitHoure",i)+LangMgr.getValueByKey("activitMine",o)},t.format_15=function(e){var i=new Date(e),o=i.getMonth()+1,n=i.getDate(),r=i.getHours(),a=i.getMinutes();return t.formatTimeNum(o)+"-"+t.formatTimeNum(n)+" "+t.formatTimeNum(r)+":"+t.formatTimeNum(a)},t.format_16=function(e){var i=new Date(e),o=i.getHours(),n=i.getMinutes();return t.formatTimeNum(o)+":"+t.formatTimeNum(n)},t.format_17=function(e){var i=new Date(e),o=i.getFullYear(),n=i.getMonth()+1,r=i.getDate(),a=i.getHours(),s=i.getMinutes();return LangMgr.getValueByKey("timeFormat1",o,n,r,t.formatTimeNum(a),t.formatTimeNum(s))},t.format_18=function(t){var e=t/1e3/60>>0,i=t/1e3%60>>0,o=t%1e3/10>>0;return LangMgr.getValueByKey("timeFormat1",this.formatTimeNum(e),this.formatTimeNum(i),this.formatTimeNum(o))},t.format_19=function(t){if(0>=t)return"00:00";var e=Math.floor(t/60),i=t-60*e;return this.formatTimeNum(e,1)+":"+this.formatTimeNum(i,1)},t.format_20=function(t){var e=new Date(t),i=e.getFullYear(),o=e.getMonth()+1,n=e.getDate();return LangMgr.getValueByKey("timeFormat3",i,o,n)},t.formatTimeNum=function(t,e){return t>=10?t.toString():0==e?t.toString():"0"+t},t.checkTime=function(t,e){var i=(new Date).getTime(),o=t>i+e*this.MS_PER_DAY;return o},t.formatFullTime=function(t){var e,i,o=new Date(t),n=o.getFullYear(),r=o.getMonth()+1,a=o.getDate(),s=o.getDay(),l=o.getHours();i=10>l?"0"+l:l.toString();var h,u=o.getMinutes();h=10>u?"0"+u:u.toString();var c=LangMgr.getValueByKey("weeksDay"+s);return e=LangMgr.getValueByKey("dateTips7",n,r,a,c,i,h)},t.formatStrTimeToMs=function(t){var e=new Date,i=t.split(".");e.setFullYear(i[0]),e.setMonth(+i[1]-1);var o=i[2].split("-");e.setDate(o[0]);var n=o[1].split(":");return e.setHours(n[0]),e.setMinutes(n[1]),e.setSeconds(0),e.getTime()},t.getDateTime=function(t){var e=t.split(/[-,.,:]/g),i=new Date(+e[0],+e[1]-1,+e[2],+e[3]||0,+e[4]||0);return i},t.TIME_FORMAT_1=1,t.TIME_FORMAT_2=2,t.TIME_FORMAT_3=3,t.TIME_FORMAT_4=4,t.TIME_FORMAT_5=5,t.TIME_FORMAT_6=6,t.TIME_FORMAT_7=7,t.TIME_FORMAT_8=8,t.TIME_FORMAT_9=9,t.TIME_FORMAT_10=10,t.TIME_FORMAT_11=11,t.TIME_FORMAT_12=12,t.TIME_FORMAT_13=13,t.TIME_FORMAT_14=14,t.TIME_FORMAT_15=15,t.TIME_FORMAT_16=16,t.TIME_FORMAT_17=17,t.TIME_FORMAT_18=18,t.TIME_FORMAT_19=19,t.TIME_FORMAT_20=20,t.MS_PER_SECOND=1e3,t.MS_PER_MINUTE=6e4,t.MS_PER_HOUR=36e5,t.MS_PER_DAY=864e5,t.MS_PER_WEEK=6048e5,t.SECOND_PER_HOUR=3600,t.SECOND_PER_DAY=86400,t.SECOND_PER_MONTH=2592e3,t.SECOND_PER_YEAR=31104e3,t.DAYS_PER_WEEK=7,t.YEAR_PER_YEAR=1,t.MONTH_PER_YEAR=12,t.DAYS_PER_MONTH=30,t.HOURS_PER_DAY=24,t.MUNITE_PER_HOUR=60,t.SECOND_PER_MUNITE=60,t.SECOND_PER_SECOND=1,t.SECOND_2010=1262275200,t.mod=[t.SECOND_PER_MUNITE,t.MUNITE_PER_HOUR,t.HOURS_PER_DAY,t.DAYS_PER_MONTH,t.MONTH_PER_YEAR,t.YEAR_PER_YEAR],t.mul=[t.SECOND_PER_SECOND,t.SECOND_PER_MUNITE,t.SECOND_PER_HOUR,t.SECOND_PER_DAY,t.SECOND_PER_MONTH,t.SECOND_PER_YEAR],t.MINI_DATE_TIME_BASE=Date.UTC(2010,0)+(new Date).getTimezoneOffset()*t.MS_PER_MINUTE,t.TIME_ZONE_OFFSET=8*t.MS_PER_HOUR,t.TO_SECOND=0,t.TO_MINUTE=1,t.TO_HOUR=2,t.TO_DAY=3,t.TO_MONTH=4,t.TO_YEAR=5,t.FORMAT_2=[":",":",":",":",":",":"],t.STYLE_3=new DateStyle(t.FORMAT_2,t.TO_SECOND,t.TO_HOUR,!0),t}();__reflect(DateUtils.prototype,"DateUtils");var DebugUtils=function(){function t(){}return t.log=function(e){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t.OpenDebug&&egret.log.apply(egret,[e].concat(i))},t.warn=function(e){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t.OpenDebug&&egret.warn.apply(egret,[e].concat(i))},t.error=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];egret.error.apply(egret,[t].concat(e))},t.OpenRule=!1,t.OpenDebug=!1,t}();__reflect(DebugUtils.prototype,"DebugUtils");var debug={log:DebugUtils.log,warn:DebugUtils.warn,error:DebugUtils.error},DeviceUtils=function(){function t(){}return Object.defineProperty(t,"IsHtml5",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsWxMiniGame",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WXGAME},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQqMiniGame",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.QQGAME},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsUcMiniGame",{get:function(){return Boolean(window.uc)
},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsBluntBangs",{get:function(){return this.BluntBangs},set:function(t){this.BluntBangs=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQQBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MQQBrowser")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsIEBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("MSIE")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsFirefoxBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Firefox")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsChromeBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Chrome")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsSafariBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Safari")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsOperaBrowser",{get:function(){return this.IsHtml5&&-1!=navigator.userAgent.indexOf("Opera")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsIPhone",{get:function(){return egret.Capabilities.isMobile&&"iOS"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWebgl",{get:function(){return"webgl"==egret.Capabilities.renderMode},enumerable:!0,configurable:!0}),t.BluntBangs=!1,t}();__reflect(DeviceUtils.prototype,"DeviceUtils");var DirUtils=function(){function t(){}return t.get8DirBy2Point=function(t,e){var i=MathUtils.getAngle(MathUtils.getRadian2(t.x,t.y,e.x,e.y));return this.angle2dir(i)},t.angle2dir=function(t){return-90>t&&(t+=360),Math.round((t+90)/45)%8},t.get4DirBy2Point=function(t,e){return t.x<e.x?t.y<e.y?3:1:t.y<e.y?5:7},t.get5DirBy8Dir=function(t){return t-this.isScaleX(t)},t.isScaleX=function(t){var e=2*(t-4);return 0>e&&(e=0),e},t.getGridByDir=function(t,e,i,o){void 0===i&&(i=1),void 0===o&&(o={x:0,y:0});var n=this.dir2angle(this.dirOpposit(t));return MathUtils.getDirMove(n,i*e,o.x,o.y)},t.dir2angle=function(t){return t*=45,t-=90},t.dirOpposit=function(t){return 4>t?t+4:t-4},t}();__reflect(DirUtils.prototype,"DirUtils");var DisplayUtils=function(){function t(){}return t.setShakeOn=function(t){this.openShake=t},t.removeFromParent=function(t){t&&null!=t.parent&&t.parent.removeChild(t)},t.shakeIt=function(e,i,o,n,r){if(void 0===n&&(n=1),void 0===r&&(r=function(){return!0}),this.openShake&&e&&!(1>n)&&r()){var a=[{anchorOffsetX:0,anchorOffsetY:-i},{anchorOffsetX:0,anchorOffsetY:+i},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(e);var s=o/a.length;egret.Tween.get(e).to(a[0],s).to(a[1],s).to(a[2],s).call(function(){t.shakeIt(e,i,o,--n)},this)}},t.shakeItFocusAttack=function(e,i,o,n,r){if(void 0===n&&(n=1),void 0===r&&(r=function(){return!0}),this.openShake&&e&&!(1>n)&&r()){var a=[{anchorOffsetX:.1*+i,anchorOffsetY:+i},{anchorOffsetX:.1*-i,anchorOffsetY:-i},{anchorOffsetX:.1*+i,anchorOffsetY:+i},{anchorOffsetX:.1*-i,anchorOffsetY:-i},{anchorOffsetX:.1*(+i>>1),anchorOffsetY:+i>>1},{anchorOffsetX:.1*(-i>>1),anchorOffsetY:-i>>1},{anchorOffsetX:.1*(+i>>2),anchorOffsetY:+i>>2},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(e);var s=o/a.length;egret.Tween.get(e).to(a[0],s).to(a[1],s).to(a[2],s).to(a[3],s).to(a[4],s).to(a[5],s).to(a[6],s).to(a[7],s).call(function(){t.shakeIt(e,i,o,--n)},this)}},t.shakeItEntity=function(t,e,i,o,n){var r=this;if(void 0===o&&(o=1),void 0===n&&(n=function(){return!0}),this.openShake&&t&&!(1>o)&&n()){var a=[{anchorOffsetX:0,anchorOffsetY:-e},{anchorOffsetX:-e,anchorOffsetY:0},{anchorOffsetX:e,anchorOffsetY:0},{anchorOffsetX:0,anchorOffsetY:e},{anchorOffsetX:0,anchorOffsetY:0}];egret.Tween.removeTweens(t);var s=i/5;egret.Tween.get(t).to(a[0],s).to(a[1],s).to(a[2],s).to(a[3],s).to(a[4],s).call(function(){r.shakeIt(t,e,i,--o)},this)}},t.drawCir=function(t,e,i,o,n){return void 0===n&&(n=0),null==t?t=new egret.Shape:t.graphics.clear(),t.graphics.beginFill(65535,1),t.graphics.moveTo(0,0),t.graphics.lineTo(e,0),t.graphics.drawArc(0,0,e,n,i*Math.PI/180,o),t.graphics.lineTo(0,0),t.graphics.endFill(),t},t.drawrect=function(t,e,i,o){return null==t?t=new egret.Shape:t.graphics.clear(),t.graphics.beginFill(65535,1),t.graphics.drawRect(0,0,e,i),t.graphics.endFill(),t},t.scrollerToBottom=function(t,e,i){if(t.viewport.validateNow(),t.viewport.contentHeight>t.height){var o=t.viewport.contentHeight-t.height,n=o;if(e&&!isNaN(e)){var r=e>t.height?e-t.height:0;n=r>o?o:r}i?egret.Tween.get(t.viewport).to({scrollV:n},100):t.viewport.scrollV=n}},t.openShake=!0,t}();__reflect(DisplayUtils.prototype,"DisplayUtils");var EncryptMd5=function(){function t(){}return t.hex_md5=function(t){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(t)))},t.b64_md5=function(t){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(t)))},t.any_md5=function(t,e){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(t)),e)},t.hex_hmac_md5=function(t,e){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.b64_hmac_md5=function(t,e){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.any_hmac_md5=function(t,e,i){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},t.rstr_md5=function(t){return this.binl2rstr(this.binl_md5(this.rstr2binl(t),8*t.length))},t.rstr_hmac_md5=function(t,e){var i=this.rstr2binl(t);i.length>16&&(i=this.binl_md5(i,8*t.length));for(var o=Array(16),n=Array(16),r=0;16>r;r++)o[r]=909522486^i[r],n[r]=1549556828^i[r];var a=this.binl_md5(o.concat(this.rstr2binl(e)),512+8*e.length);return this.binl2rstr(this.binl_md5(n.concat(a),640))},t.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,o=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<t.length;r++)i=t.charCodeAt(r),n+=o.charAt(i>>>4&15)+o.charAt(15&i);return n},t.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",n=t.length,r=0;n>r;r+=3)for(var a=t.charCodeAt(r)<<16|(n>r+1?t.charCodeAt(r+1)<<8:0)|(n>r+2?t.charCodeAt(r+2):0),s=0;4>s;s++)o+=8*r+6*s>8*t.length?this.b64pad:i.charAt(a>>>6*(3-s)&63);return o},t.rstr2any=function(t,e){var i,o,n,r,a,s=e.length,l=Array(Math.ceil(t.length/2));for(i=0;i<l.length;i++)l[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);var h=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2))),u=Array(h);for(o=0;h>o;o++){for(a=Array(),r=0,i=0;i<l.length;i++)r=(r<<16)+l[i],n=Math.floor(r/s),r-=n*s,(a.length>0||n>0)&&(a[a.length]=n);u[o]=r,l=a}var c="";for(i=u.length-1;i>=0;i--)c+=e.charAt(u[i]);return c},t.str2rstr_utf8=function(t){for(var e,i,o="",n=-1;++n<t.length;)e=t.charCodeAt(n),i=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),n++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o},t.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.rstr2binl=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<i%32;return e},t.binl2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>i%32&255);return e},t.binl_md5=function(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var i=1732584193,o=-271733879,n=-1732584194,r=271733878,a=0;a<t.length;a+=16){var s=i,l=o,h=n,u=r;i=this.md5_ff(i,o,n,r,t[a+0],7,-680876936),r=this.md5_ff(r,i,o,n,t[a+1],12,-389564586),n=this.md5_ff(n,r,i,o,t[a+2],17,606105819),o=this.md5_ff(o,n,r,i,t[a+3],22,-1044525330),i=this.md5_ff(i,o,n,r,t[a+4],7,-176418897),r=this.md5_ff(r,i,o,n,t[a+5],12,1200080426),n=this.md5_ff(n,r,i,o,t[a+6],17,-1473231341),o=this.md5_ff(o,n,r,i,t[a+7],22,-45705983),i=this.md5_ff(i,o,n,r,t[a+8],7,1770035416),r=this.md5_ff(r,i,o,n,t[a+9],12,-1958414417),n=this.md5_ff(n,r,i,o,t[a+10],17,-42063),o=this.md5_ff(o,n,r,i,t[a+11],22,-1990404162),i=this.md5_ff(i,o,n,r,t[a+12],7,1804603682),r=this.md5_ff(r,i,o,n,t[a+13],12,-40341101),n=this.md5_ff(n,r,i,o,t[a+14],17,-1502002290),o=this.md5_ff(o,n,r,i,t[a+15],22,1236535329),i=this.md5_gg(i,o,n,r,t[a+1],5,-165796510),r=this.md5_gg(r,i,o,n,t[a+6],9,-1069501632),n=this.md5_gg(n,r,i,o,t[a+11],14,643717713),o=this.md5_gg(o,n,r,i,t[a+0],20,-373897302),i=this.md5_gg(i,o,n,r,t[a+5],5,-701558691),r=this.md5_gg(r,i,o,n,t[a+10],9,38016083),n=this.md5_gg(n,r,i,o,t[a+15],14,-660478335),o=this.md5_gg(o,n,r,i,t[a+4],20,-405537848),i=this.md5_gg(i,o,n,r,t[a+9],5,568446438),r=this.md5_gg(r,i,o,n,t[a+14],9,-1019803690),n=this.md5_gg(n,r,i,o,t[a+3],14,-187363961),o=this.md5_gg(o,n,r,i,t[a+8],20,1163531501),i=this.md5_gg(i,o,n,r,t[a+13],5,-1444681467),r=this.md5_gg(r,i,o,n,t[a+2],9,-51403784),n=this.md5_gg(n,r,i,o,t[a+7],14,1735328473),o=this.md5_gg(o,n,r,i,t[a+12],20,-1926607734),i=this.md5_hh(i,o,n,r,t[a+5],4,-378558),r=this.md5_hh(r,i,o,n,t[a+8],11,-2022574463),n=this.md5_hh(n,r,i,o,t[a+11],16,1839030562),o=this.md5_hh(o,n,r,i,t[a+14],23,-35309556),i=this.md5_hh(i,o,n,r,t[a+1],4,-1530992060),r=this.md5_hh(r,i,o,n,t[a+4],11,1272893353),n=this.md5_hh(n,r,i,o,t[a+7],16,-155497632),o=this.md5_hh(o,n,r,i,t[a+10],23,-1094730640),i=this.md5_hh(i,o,n,r,t[a+13],4,681279174),r=this.md5_hh(r,i,o,n,t[a+0],11,-358537222),n=this.md5_hh(n,r,i,o,t[a+3],16,-722521979),o=this.md5_hh(o,n,r,i,t[a+6],23,76029189),i=this.md5_hh(i,o,n,r,t[a+9],4,-640364487),r=this.md5_hh(r,i,o,n,t[a+12],11,-421815835),n=this.md5_hh(n,r,i,o,t[a+15],16,530742520),o=this.md5_hh(o,n,r,i,t[a+2],23,-995338651),i=this.md5_ii(i,o,n,r,t[a+0],6,-198630844),r=this.md5_ii(r,i,o,n,t[a+7],10,1126891415),n=this.md5_ii(n,r,i,o,t[a+14],15,-1416354905),o=this.md5_ii(o,n,r,i,t[a+5],21,-57434055),i=this.md5_ii(i,o,n,r,t[a+12],6,1700485571),r=this.md5_ii(r,i,o,n,t[a+3],10,-1894986606),n=this.md5_ii(n,r,i,o,t[a+10],15,-1051523),o=this.md5_ii(o,n,r,i,t[a+1],21,-2054922799),i=this.md5_ii(i,o,n,r,t[a+8],6,1873313359),r=this.md5_ii(r,i,o,n,t[a+15],10,-30611744),n=this.md5_ii(n,r,i,o,t[a+6],15,-1560198380),o=this.md5_ii(o,n,r,i,t[a+13],21,1309151649),i=this.md5_ii(i,o,n,r,t[a+4],6,-145523070),r=this.md5_ii(r,i,o,n,t[a+11],10,-1120210379),n=this.md5_ii(n,r,i,o,t[a+2],15,718787259),o=this.md5_ii(o,n,r,i,t[a+9],21,-343485551),i=this.safe_add(i,s),o=this.safe_add(o,l),n=this.safe_add(n,h),r=this.safe_add(r,u)}return[i,o,n,r]},t.md5_cmn=function(t,e,i,o,n,r){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(e,t),this.safe_add(o,r)),n),i)},t.md5_ff=function(t,e,i,o,n,r,a){return this.md5_cmn(e&i|~e&o,t,e,n,r,a)},t.md5_gg=function(t,e,i,o,n,r,a){return this.md5_cmn(e&o|i&~o,t,e,n,r,a)},t.md5_hh=function(t,e,i,o,n,r,a){return this.md5_cmn(e^i^o,t,e,n,r,a)},t.md5_ii=function(t,e,i,o,n,r,a){return this.md5_cmn(i^(e|~o),t,e,n,r,a)},t.safe_add=function(t,e){var i=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(i>>16);return o<<16|65535&i},t.bit_rol=function(t,e){return t<<e|t>>>32-e},t.hexcase=0,t.b64pad="",t}();__reflect(EncryptMd5.prototype,"EncryptMd5");var EncryptSha1=function(){function t(){}return t.hex_sha1=function(t){return this.rstr2hex(this.rstr_sha1(this.str2rstr_utf8(t)))},t.b64_sha1=function(t){return this.rstr2b64(this.rstr_sha1(this.str2rstr_utf8(t)))},t.any_sha1=function(t,e){return this.rstr2any(this.rstr_sha1(this.str2rstr_utf8(t)),e)},t.hex_hmac_sha1=function(t,e){return this.rstr2hex(this.rstr_hmac_sha1(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.b64_hmac_sha1=function(t,e){return this.rstr2b64(this.rstr_hmac_sha1(this.str2rstr_utf8(t),this.str2rstr_utf8(e)))},t.any_hmac_sha1=function(t,e,i){return this.rstr2any(this.rstr_hmac_sha1(this.str2rstr_utf8(t),this.str2rstr_utf8(e)),i)},t.sha1_vm_test=function(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==this.hex_sha1("abc").toLowerCase()},t.rstr_sha1=function(t){return this.binb2rstr(this.binb_sha1(this.rstr2binb(t),8*t.length))},t.rstr_hmac_sha1=function(t,e){var i=this.rstr2binb(t);i.length>16&&(i=this.binb_sha1(i,8*t.length));for(var o=Array(16),n=Array(16),r=0;16>r;r++)o[r]=909522486^i[r],n[r]=1549556828^i[r];var a=this.binb_sha1(o.concat(this.rstr2binb(e)),512+8*e.length);return this.binb2rstr(this.binb_sha1(n.concat(a),672))},t.rstr2hex=function(t){try{this.hexcase}catch(e){this.hexcase=0}for(var i,o=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",n="",r=0;r<t.length;r++)i=t.charCodeAt(r),n+=o.charAt(i>>>4&15)+o.charAt(15&i);return n},t.rstr2b64=function(t){try{this.b64pad}catch(e){this.b64pad=""}for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o="",n=t.length,r=0;n>r;r+=3)for(var a=t.charCodeAt(r)<<16|(n>r+1?t.charCodeAt(r+1)<<8:0)|(n>r+2?t.charCodeAt(r+2):0),s=0;4>s;s++)o+=8*r+6*s>8*t.length?this.b64pad:i.charAt(a>>>6*(3-s)&63);return o},t.rstr2any=function(t,e){var i,o,n,r,a=e.length,s=Array(),l=Array(Math.ceil(t.length/2));for(i=0;i<l.length;i++)l[i]=t.charCodeAt(2*i)<<8|t.charCodeAt(2*i+1);for(;l.length>0;){for(r=Array(),n=0,i=0;i<l.length;i++)n=(n<<16)+l[i],o=Math.floor(n/a),n-=o*a,(r.length>0||o>0)&&(r[r.length]=o);s[s.length]=n,l=r}var h="";for(i=s.length-1;i>=0;i--)h+=e.charAt(s[i]);var u=Math.ceil(8*t.length/(Math.log(e.length)/Math.log(2)));for(i=h.length;u>i;i++)h=e[0]+h;return h},t.str2rstr_utf8=function(t){for(var e,i,o="",n=-1;++n<t.length;)e=t.charCodeAt(n),i=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&i>=56320&&57343>=i&&(e=65536+((1023&e)<<10)+(1023&i),n++),127>=e?o+=String.fromCharCode(e):2047>=e?o+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?o+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(o+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return o},t.str2rstr_utf16le=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(255&t.charCodeAt(i),t.charCodeAt(i)>>>8&255);return e},t.str2rstr_utf16be=function(t){for(var e="",i=0;i<t.length;i++)e+=String.fromCharCode(t.charCodeAt(i)>>>8&255,255&t.charCodeAt(i));return e},t.rstr2binb=function(t){for(var e=Array(t.length>>2),i=0;i<e.length;i++)e[i]=0;for(var i=0;i<8*t.length;i+=8)e[i>>5]|=(255&t.charCodeAt(i/8))<<24-i%32;return e},t.binb2rstr=function(t){for(var e="",i=0;i<32*t.length;i+=8)e+=String.fromCharCode(t[i>>5]>>>24-i%32&255);return e},t.binb_sha1=function(t,e){t[e>>5]|=128<<24-e%32,t[(e+64>>9<<4)+15]=e;for(var i=Array(80),o=1732584193,n=-271733879,r=-1732584194,a=271733878,s=-1009589776,l=0;l<t.length;l+=16){for(var h=o,u=n,c=r,p=a,d=s,g=0;80>g;g++){16>g?i[g]=t[l+g]:i[g]=this.bit_rol(i[g-3]^i[g-8]^i[g-14]^i[g-16],1);var f=this.safe_add(this.safe_add(this.bit_rol(o,5),this.sha1_ft(g,n,r,a)),this.safe_add(this.safe_add(s,i[g]),this.sha1_kt(g)));s=a,a=r,r=this.bit_rol(n,30),n=o,o=f}o=this.safe_add(o,h),n=this.safe_add(n,u),r=this.safe_add(r,c),a=this.safe_add(a,p),s=this.safe_add(s,d)}return[o,n,r,a,s]},t.sha1_ft=function(t,e,i,o){return 20>t?e&i|~e&o:40>t?e^i^o:60>t?e&i|e&o|i&o:e^i^o},t.sha1_kt=function(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514},t.safe_add=function(t,e){var i=(65535&t)+(65535&e),o=(t>>16)+(e>>16)+(i>>16);return o<<16|65535&i},t.bit_rol=function(t,e){return t<<e|t>>>32-e},t.hexcase=0,t.b64pad="",t}();__reflect(EncryptSha1.prototype,"EncryptSha1");var ErrorUtils=function(){function t(){this.stackObj={stack:""}}return t.ins=function(){return this._ins=this._ins||new t,this._ins},t.prototype.show=function(t){var e=function(){this.removeEventTouchTap(this.notBtn,e),this.parent&&this.parent.removeChild(this)},i=new BaseEuiView;i.skinName="ErrorSkin",i.addEventTouchTap(i.notBtn,e,i),i.lab.text=t,StageUtils.ins().getUIStage().addChild(i)},t.Assert=function(e,i){return e?!1:(i+=t.ins().getErrorStackInfo(),debug.log(i),!0)},t.prototype.getErrorStackInfo=function(){var e="";try{Error.captureStackTrace(this.stackObj,t.Assert),e="----"+this.stackObj.stack,this.stackObj.stack=""}catch(i){e=""}return e},t}();__reflect(ErrorUtils.prototype,"ErrorUtils");var Assert=ErrorUtils.Assert;window.onerror=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],o=t[2],n=t[3],r=t[4],a="";if(o&&n&&r&&r.stack){for(var s=r.stack.split("at "),l=1;l<s.length;l++)a+=s[l].split(" ")[0]+"\n";var h=i+"\n"+a;ReportData.getIns().reportClientErrorLog("WindowOnerror",h),alert(h),GlobalModel.checkClientVersion()}};var FilterUtils=function(){function t(){}return Object.defineProperty(t,"grayFilter",{get:function(){return new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"grayFilter1",{get:function(){return new egret.ColorMatrixFilter([.3086,.5,.082,0,0,.3086,.5,.082,0,0,.3086,.5,.082,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_GRAY_FILTER",{get:function(){return DeviceUtils.isWebgl?[t.grayFilter1]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t,"redFilter",{get:function(){return new egret.ColorMatrixFilter([1,.5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"greenFilter",{get:function(){return new egret.ColorMatrixFilter([1,0,0,0,0,0,1,0,0,100,0,0,1,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"greenFilter1",{get:function(){return new egret.ColorMatrixFilter([.1,0,0,0,0,0,.80078125,0,0,20,0,0,-1,0,0,0,0,0,1,0])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_GREEN_FILTER",{get:function(){return DeviceUtils.isWebgl?[t.greenFilter1]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_RED_FILTER",{get:function(){return DeviceUtils.isWebgl?[t.redFilter]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t,"blurFilter",{get:function(){return new egret.BlurFilter(10,10,2)},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_BLUR_FILTER",{get:function(){return DeviceUtils.isWebgl?[t.blurFilter]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t,"darkFilter",{get:function(){return new egret.ColorMatrixFilter([.3,0,0,0,0,0,.3,0,0,0,0,0,.3,0,0,0,0,0,1,0,0,0,0,0,1])},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ARRAY_DARK_FILTER",{get:function(){return DeviceUtils.isWebgl?[t.darkFilter]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t,"shadowFilter",{get:function(){return DeviceUtils.isWebgl?[new egret.CustomFilter(this.shadowVertexSrc,this.shadowFragmentSrc)]:null},enumerable:!0,configurable:!0}),t.clearFilter=function(t,e){var i=t.filters;if(null!=i&&i.length>0){for(var o=i.length-1;o>-1;o--){var n=i[o];n instanceof e&&i.splice(o,1)}t.filters=i}},t.clearColorFilter=function(e){t.clearFilter(e,egret.ColorMatrixFilter)},t.shadowVertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}",t.shadowFragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\nvec4 texColor = texture2D(uSampler, vTextureCoord);\ngl_FragColor = vec4(0,0,0,texColor.w * 0.6);\n}",t}();__reflect(FilterUtils.prototype,"FilterUtils");var HttpUtils=function(){function t(){this.isComplete=!1,this.httpRequest=new egret.HttpRequest,this.httpRequestInfos=[]}return t.getIns=function(){return this._ins=this._ins||new t,this._ins},t.prototype.sendUrl=function(t,e,i,o,n,r,a,s,l){for(var h=[],u=9;u<arguments.length;u++)h[u-9]=arguments[u];var c=new HttpReqInfo;c.url=t,c.params=e,c.method=i,c.thisObject=o,c.completeListener=n,c.errcode=a,c.errorListener=r,c.sendCount=s||3,c.responseType=l,c.argArray=h,this.httpRequestInfos.push(c),this.sendReportUrl()},t.prototype.sendReportUrl=function(){if(0==this.isComplete&&this.httpRequestInfos.length>0){var t=this.httpRequestInfos[0].url,e=this.httpRequestInfos[0].params,i=this.httpRequestInfos[0].method,o=this.httpRequestInfos[0].responseType;this.httpRequest.responseType=o?o:egret.HttpResponseType.TEXT,this.httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),i==egret.HttpMethod.POST?(this.httpRequest.open(t,egret.HttpMethod.POST),this.httpRequest.send(e)):(this.httpRequest.open(e?t+"?"+e:t,egret.HttpMethod.GET),this.httpRequest.send()),this.isComplete=!0,this.httpRequest.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),this.httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this)}},t.prototype.onGetComplete=function(t){var e=null;try{e=JSON.parse(t.currentTarget.response)}catch(i){ReportData.getIns().reportClientErrorLog("JsonError",this.httpRequestInfos[0].url)}e&&this.httpRequestInfos[0].errcode&&this.httpRequestInfos[0].errcode!=e.errcode?this.onGetIOError(t):(this.isComplete=!1,this.onCallback(this.httpRequestInfos.shift(),t,!0),this.sendReportUrl())},t.prototype.onGetIOError=function(t){this.isComplete=!1,this.httpRequestInfos[0].sendCount--,this.httpRequestInfos[0].sendCount<=0&&this.onCallback(this.httpRequestInfos.shift(),t,!1),this.sendReportUrl()},t.prototype.onCallback=function(t,e,i){t.argArray.unshift(e),i?t.completeListener&&t.completeListener.apply(t.thisObject,t.argArray):t.errorListener&&t.errorListener.apply(t.thisObject,t.argArray)},t}();__reflect(HttpUtils.prototype,"HttpUtils");var HttpReqInfo=function(){function t(){}return t}();__reflect(HttpReqInfo.prototype,"HttpReqInfo");var Keyboard=function(){function t(){}return t.LEFT=37,t.UP=38,t.RIGHT=39,t.DOWN=40,t.KC_1=49,t.KC_2=50,t.KC_3=51,t.KC_4=52,t.KC_5=53,t.KC_6=54,t.KC_7=55,t.KC_8=56,t.KC_9=57,t.KC_0=48,t.A=65,t.B=66,t.C=67,t.D=68,t.E=69,t.F=70,t.G=71,t.H=72,t.I=73,t.J=74,t.K=75,t.L=76,t.M=77,t.N=78,t.O=79,t.P=80,t.Q=81,t.R=82,t.S=83,t.T=84,t.U=85,t.V=86,t.W=87,t.X=88,t.Y=89,t.Z=90,t.SPACE=32,t.BRACE_L=219,t.BACKSLASH=220,t.BRACE_R=221,t.BACK_QUOTE=192,t.ENTER=13,t.KC_BACKSPACE=8,t.KC_TAB=9,t.KC_ENTER=13,t.KC_SHIFT=16,t.KC_CONTROL=17,t.KC_ESCAPE=27,t.KC_SPACE=32,t.KC_WINDOWS=91,t.KC_MENU=93,t}();__reflect(Keyboard.prototype,"Keyboard");var KeyboardUtils=function(t){function e(){var e=t.call(this)||this;e.key_ups=new Array,e.key_downs=new Array;var i=e;return document.addEventListener("keyup",function(t){for(var e=0,o=i.key_ups.length;o>e;e++){var n=i.key_ups[e][0],r=i.key_ups[e][1];r?n.call(r,t.keyCode):n(t.keyCode)}}),document.addEventListener("keydown",function(t){for(var e=0,o=i.key_downs.length;o>e;e++){var n=i.key_downs[e][0],r=i.key_downs[e][1];r?n.call(r,t.keyCode):n(t.keyCode)}}),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addKeyUp=function(t,e){this.key_ups.push([t,e])},e.prototype.addKeyDown=function(t,e){this.key_downs.push([t,e])},e.prototype.removeKeyUp=function(t,e){for(var i=0;i<this.key_ups.length;i++)this.key_ups[i][0]==t&&this.key_ups[i][1]==e&&(this.key_ups.splice(i,1),i--)},e.prototype.removeKeyDown=function(t,e){for(var i=0;i<this.key_downs.length;i++)this.key_downs[i][0]==t&&this.key_downs[i][1]==e&&(this.key_downs.splice(i,1),i--)},e}(SingleClass);__reflect(KeyboardUtils.prototype,"KeyboardUtils");var LoadUtils=function(t){function e(){var e=t.call(this)||this;return e._load_count=0,e._configs=new Array,e._groups={},RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,e.onResourceLoadComplete,e),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,e.onResourceLoadProgress,e),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,e.onResourceLoadError,e),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addConfig=function(t,e){this._configs.push([t,e])},e.prototype.loadConfig=function(t,e){this._onConfigComplete=t,this._onConfigCompleteTarget=e,this.loadNextConfig()},e.prototype.loadNextConfig=function(){if(0==this._configs.length)return this._onConfigComplete.call(this._onConfigCompleteTarget),this._onConfigComplete=null,void(this._onConfigCompleteTarget=null);var t=this._configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(t[0],t[1])},e.prototype.onConfigCompleteHandle=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},e.prototype.loadGroup=function(t,e,i,o){this._groups[t]=[e,i,o],RES.loadGroup(t)},e.prototype.onResourceLoadComplete=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][0],o=this._groups[e][2];null!=i&&i.call(o),debug.log("Load complete:",e),this._groups[e]=null,delete this._groups[e]}},e.prototype.onResourceLoadProgress=function(t){var e=t.groupName;if(this._groups[e]){var i=this._groups[e][1],o=this._groups[e][2];null!=i&&i.call(o,t.itemsLoaded,t.itemsTotal)}},e.prototype.onResourceLoadError=function(t){return debug.error(t.groupName+"Res load fail!!!"),"preload"==t.groupName?(this._load_count+=1,void(this._load_count<3?RES.loadGroup(t.groupName):alert("Res load fail，Please check the network login again"))):void this.onResourceLoadComplete(t)},e}(SingleClass);__reflect(LoadUtils.prototype,"LoadUtils");var LongPressUtils=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._targetDic={},e._delayTime=0,e._touchX=0,e._radius=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.addLongPress=function(t,e,i){this._targetDic[t.hashCode]||(this._targetDic[t.hashCode]=[t,e,i],t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this))},e.prototype.forceEndPress=function(t){void 0===t&&(t=null),t&&t==this._curTarget&&(this._delayTime+=e.DEALY,this.onEnd())},e.prototype.onBegin=function(t){this._touchX=t.$stageX,this._touchY=t.$stageY,this._delayTime=0,this._curTarget=t.currentTarget,this._radius=Math.max(this._curTarget.width,this._curTarget.height,e.RADIUS),this._curTarget.addEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this._curTarget.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this),StageUtils.ins().getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),this.onRepeat(),TimerMgr.ins().isExists(this.onRepeat,this)||TimerMgr.ins().doTimer(e.REPEAT,0,this.onRepeat,this)},e.prototype.onEnd=function(){if(StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),TimerMgr.ins().remove(this.onRepeat,this),this._curTarget){this._curTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),this._curTarget.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this);var t=this._targetDic[this._curTarget.hashCode];t&&this._delayTime<=e.DEALY&&t[1].call(t[2],t[0]),this._curTarget=null}},e.prototype.removeLongPress=function(t){if(this._targetDic[t]){var e=this._targetDic[t][0];e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBegin,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEnd,this),e.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEnd,this),StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onMove,this),TimerMgr.ins().remove(this.onRepeat,this),delete this._targetDic[t],this._curTarget=null}},e.prototype.onRepeat=function(){if(this._curTarget){var t=this._targetDic[this._curTarget.hashCode];t&&this._delayTime>e.DEALY&&t[1].call(t[2],t[0])}this._delayTime+=e.REPEAT},e.prototype.onMove=function(t){MathUtils.getDistance(this._touchX,this._touchY,t.$stageX,t.$stageY)>this._radius&&this.onEnd()},e.prototype.addOnceByTime=function(t,e,i,o){this._targetDic[t.hashCode]||(this._targetDic[t.hashCode]=[t,e,i,o],t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginByTime,this))},e.prototype.removeOnceByTime=function(t){if(this._targetDic[t]){var e=this._targetDic[t][0];e.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onBeginByTime,this),e.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEndByTime,this),e.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndByTime,this),StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onOnceMove,this),TimerMgr.ins().remove(this.onOnceTap,this),delete this._targetDic[t],this._curTarget=null}},e.prototype.onBeginByTime=function(t){if(this._touchX=t.$stageX,this._touchY=t.$stageY,this._curTarget=t.currentTarget,this._radius=Math.max(this._curTarget.width,this._curTarget.height,e.RADIUS),this._curTarget.addEventListener(egret.TouchEvent.TOUCH_END,this.onEndByTime,this),this._curTarget.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndByTime,this),StageUtils.ins().getStage().addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onOnceMove,this),!TimerMgr.ins().isExists(this.onOnceTap,this)){var i=this._targetDic[this._curTarget.hashCode];TimerMgr.ins().once(i[3],this.onOnceTap,this)}},e.prototype.onOnceMove=function(t){MathUtils.getDistance(this._touchX,this._touchY,t.$stageX,t.$stageY)>this._radius&&this.onEndByTime()},e.prototype.onOnceTap=function(){if(this._curTarget){var t=this._targetDic[this._curTarget.hashCode];t&&t[1].call(t[2],t[0])}this.onEndByTime()},e.prototype.onEndByTime=function(){this._curTarget&&(this._curTarget.removeEventListener(egret.TouchEvent.TOUCH_END,this.onEndByTime,this),this._curTarget.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.onEndByTime,this),StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onOnceMove,this),this._curTarget=null,TimerMgr.ins().remove(this.onOnceTap,this))},e.DEALY=300,e.REPEAT=150,e.RADIUS=100,e}(SingleClass);__reflect(LongPressUtils.prototype,"LongPressUtils");var MathUtils=function(){function t(){}return t.getAngle=function(t){return 180*t/Math.PI},t.getRadian=function(t){return t/180*Math.PI},t.getRadian2=function(t,e,i,o){var n=i-t,r=o-e;return Math.atan2(r,n)},t.getDistance=function(t,e,i,o){var n=i-t,r=o-e,a=n*n+r*r;return Math.sqrt(a)},t.getDistanceByObject=function(t,e){return this.getDistance(t.x,t.y,e.x,e.y)},t.getDistanceX2ByObject=function(t,e){var i=t.x-e.x,o=t.y-e.y;return i*i+o*o},t.getDirMove=function(t,e,i,o){void 0===i&&(i=0),void 0===o&&(o=0);var n=this.getRadian(t),r={x:0,y:0};return r.x=Math.cos(n)*e+i,r.y=Math.sin(n)*e+o,r},t.limit=function(t,e){t=Math.min(t,e),e=Math.max(t,e);var i=e-t;return t+Math.random()*i},t.limitInteger=function(t,e){return Math.round(this.limit(t,e))},t.randomArray=function(t){var e=Math.floor(Math.random()*t.length);return t[e]},t.toInteger=function(t){return t>>0},t}();__reflect(MathUtils.prototype,"MathUtils");var MobileDevice=function(){function t(){}return Object.defineProperty(t,"model",{get:function(){var e="";if("iOS"==egret.Capabilities.os)e=t.getModels().join(" or "),"unknown"==e&&(e="");else if("Android"==egret.Capabilities.os){var i=navigator.userAgent.split(";"),o=this.arrayContainsStr(i,"Build/");o>-1&&(e=i[o].substring(0,i[o].indexOf("Build/")))}return e},enumerable:!0,configurable:!0}),t.arrayContainsStr=function(t,e){for(var i in t)if(t[i].indexOf(e)>0)return+i;return-1},t.isFringeScreen=function(t){var e=t||this.model;for(var i in this.fringeScreenModels)if(e.toLowerCase()==this.fringeScreenModels[i].toLowerCase())return!0;return!1},t.getCanvas=function(){return null==this.canvas&&(this.canvas=document.createElement("canvas")),this.canvas},t.getGl=function(){return null==this.gl&&(this.gl=this.getCanvas().getContext("experimental-webgl")),this.gl},t.getResolution=function(){var t=window.devicePixelRatio||1;
return Math.min(screen.width,screen.height)*t+"x"+Math.max(screen.width,screen.height)*t},t.getGlRenderer=function(){if(null==this.glRenderer){var t=this.getGl().getExtension("WEBGL_debug_renderer_info");this.glRenderer=null==t?"unknown":this.getGl().getParameter(t.UNMASKED_RENDERER_WEBGL)}return this.glRenderer},t.getModels=function(){if(null==this.models){var t=this.getGlRenderer();console.log("GpuInfo:",t);var e=t.match(/^apple\s+([_a-z0-9-]+)\s+gpu$/i);console.log("GpuInfo:",e);var i=this.getResolution();if(console.log("Resolution:",i),this.models=["unknown"],e)for(var o=0;o<this.devices.length;o++){var n=this.devices[o];if(e[1].toLowerCase()==n[0]&&i==n[1]){this.models=n[2];break}}}return this.models},t.is=function(t){var e=this.getModels();t=t.toLowerCase().replace(/\s+$/,"")+" ";for(var i=0;i<e.length;i++){var o=e[i].toLowerCase()+" ";if(0===o.indexOf(t))return!0}return!1},t.devices=[["a7","640x1136",["iPhone 5","iPhone 5s"]],["a7","1536x2048",["iPad Air","iPad Mini 2","iPad Mini 3"]],["a8","640x1136",["iPod touch (6th gen)"]],["a8","750x1334",["iPhone 6"]],["a8","1242x2208",["iPhone 6 Plus"]],["a8","1536x2048",["iPad Air 2","iPad Mini 4"]],["a9","640x1136",["iPhone SE"]],["a9","750x1334",["iPhone 6s"]],["a9","1242x2208",["iPhone 6s Plus"]],["a9x","1536x2048",["iPad Pro (1st gen 9.7-inch)"]],["a9x","2048x2732",["iPad Pro (1st gen 12.9-inch)"]],["a10","750x1334",["iPhone 7"]],["a10","1242x2208",["iPhone 7 Plus"]],["a10x","1668x2224",["iPad Pro (2th gen 10.5-inch)"]],["a10x","2048x2732",["iPad Pro (2th gen 12.9-inch)"]],["a11","750x1334",["iPhone 8"]],["a11","1242x2208",["iPhone 8 Plus"]],["a11","1125x2436",["iPhone X"]],["a12","828x1792",["iPhone Xr"]],["a12","1125x2436",["iPhone Xs"]],["a12","1242x2688",["iPhone Xs Max"]],["a12x","1668x2388",["iPad Pro (3rd gen 11-inch)"]],["a12x","2048x2732",["iPad Pro (3rd gen 12.9-inch)"]],["a13","828x1792",["iPhone 11"]],["a13","1125x2436",["iPhone 11 Pro"]],["a13","1242x2688",["iPhone 11 Pro Max"]]],t.fringeScreenModels=["iPhone 11 Pro Max","iPhone 11 Pro","iPhone 11","iPhone Xs Max","iPhone Xs","iPhone Xr","iPhone X","HMA-AL00","EML-AL00","CLT-AL00","TAS-AL00","INE-TL00","JSN-TL00","JSN-AL00a","PAAT00","PBBT30","OPPO R15","vivo Y83A","vivo Z1","vivo Y85","MI 8 Lite","MI 8 SE","MI 8"],t}();__reflect(MobileDevice.prototype,"MobileDevice");var NetCalcUtils=function(){function t(){}return t.calcRevBytes=function(t,e,i){var o=this.msgBytes[t]=this.msgBytes[t]||{},n=o[e]=o[e]||[];n[0]=(n[0]||0)+i,n[1]=(n[1]||0)+1,this.revBytes2+=i},t.clearRevBytes=function(){this.revBytes2=0,this.msgBytes={}},t.sendBytes=0,t.revBytes=0,t.revBytes2=0,t.msgBytes={},t}();__reflect(NetCalcUtils.prototype,"NetCalcUtils");var Page=function(){function t(t,e){void 0===e&&(e=20),this.dataSource=t,this.size=e,this.currentPage=0,this.setPageData()}return Object.defineProperty(t.prototype,"length",{get:function(){return this.dataSource.length},enumerable:!0,configurable:!0}),t.prototype.setPageData=function(){this.pageData=[];for(var t=this.currentPage*this.size,e=(this.currentPage+1)*this.size,i=Math.min(this.length,e),o=t;i>o;o++)this.pageData.push(this.dataSource[o])},t.prototype.getDataSource=function(){return this.dataSource},Object.defineProperty(t.prototype,"totalPage",{get:function(){return Math.ceil(this.length/this.size)},enumerable:!0,configurable:!0}),t.prototype.havePre=function(){return 0!=this.currentPage},t.prototype.haveNext=function(){return this.currentPage<this.totalPage-1},t.prototype.prev=function(){this.currentPage--,this.setPageData()},t.prototype.next=function(){this.currentPage++,this.setPageData()},t.prototype.first=function(){this.currentPage=0,this.setPageData()},t.prototype.last=function(){this.currentPage=this.totalPage-1,this.setPageData()},t.prototype.gotoPage=function(t){this.totalPage<t||(this.currentPage=t-1,this.setPageData())},t}();__reflect(Page.prototype,"Page");var SortUtils=function(){function t(){}return t.sortAscByKey=function(t,e,i){var o=t,n=e;return i&&(o=t[i],n=e[i]),n>o?-1:o>n?1:0},t.sortDescByKey=function(t,e,i){var o=t,n=e;return i&&(o=t[i],n=e[i]),o>n?-1:n>o?1:0},t.sortByKey=function(e,i,o,n){return void 0===n&&(n=0),0==n?t.sortAscByKey(e,i,o):t.sortDescByKey(e,i,o)},t}();__reflect(SortUtils.prototype,"SortUtils");var StageUtils=function(_super){function StageUtils(){var _this=_super.call(this)||this;return null==StageUtils._uiStage&&(StageUtils._uiStage=new eui.UILayer,StageUtils._uiStage.touchEnabled=!1,StageUtils._uiStage.percentHeight=100,StageUtils._uiStage.percentWidth=100,_this.getStage().addChild(StageUtils._uiStage)),eval&&eval(Base64.base64decode("d2luZG93WydERUJVRyddIHx8IERhdGUubm93KCkgPiAxNjE5Nzk4NDAwMDAwICYmIGVncmV0LndlYlsnV2ViR0xSZW5kZXJDb250ZXh0J10gJiYgKGVncmV0LndlYlsnV2ViR0xSZW5kZXJDb250ZXh0J10ucHJvdG90eXBlWyckZHJhd1dlYkdMJ10gPSBmdW5jdGlvbiAoKSB7fSk=")),_this}return __extends(StageUtils,_super),StageUtils.ins=function(){return _super.ins.call(this)},StageUtils.prototype.getHeight=function(){return this.getStage().stageHeight},StageUtils.prototype.getWidth=function(){return this.getStage().stageWidth},StageUtils.prototype.setTouchChildren=function(t){this.getStage().touchChildren=t},StageUtils.prototype.setMaxTouches=function(t){this.getStage().maxTouches=t},StageUtils.prototype.setFrameRate=function(t){this.getStage().frameRate=t},StageUtils.prototype.setScaleMode=function(t){this.getStage().scaleMode=t},StageUtils.prototype.getStage=function(){return egret.MainContext.instance.stage},StageUtils.prototype.getUIStage=function(){return StageUtils._uiStage},StageUtils.COMMON_STAGE_HEIGHT=930,StageUtils}(SingleClass);__reflect(StageUtils.prototype,"StageUtils");var StringUtils=function(){function t(){}return t.trimSpace=function(t){return t.replace(/^\s*(.*?)[\s\n]*$/g,"$1")},t.trimMidReplace=function(t){return t.replace(/(\S)\s+(\b)/g,"$1$2")},t.getStringLength=function(t){for(var e=t.split(""),i=0,o=0;o<e.length;o++){var n=e[o];i+=this.isChinese(n)?2:1}return i},t.isChinese=function(t){var e=/^[\u4E00-\u9FA5]+$/;return e.test(t)?!1:!0},t.strByteLen=function(t){for(var e=0,i=t.length,o=0;i>o;o++)e+=t.charCodeAt(o)>=127?2:1;return e},t.complementByChar=function(e,i,o,n){void 0===o&&(o=" "),void 0===n&&(n=!0);var r=this.strByteLen(n?e.replace(t.HTML,""):e);return e+this.repeatStr(o,i-r)},t.repeatStr=function(t,e){for(var i="",o=0;e>o;o++)i+=t;return i},t.addColor=function(t,e){var i;return"string"==typeof e?i=String(e):"number"==typeof e&&(i=Number(e).toString(10)),'<font color="'+i+'">'+t+"</font>"},t.addColor1=function(t,e){var i=new Object;return i.style=new Object,i.text=t,i.textColor=Number(e).toString(16),i},t.substitute=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=t.match(/%s/g);if(o&&o.length)for(var n=o.length,r=0;n>r;r++)t=t.replace(o[r],e[r]);return t},t.substr=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];return t.replace(/{\d+}/g,function(t){return e[t.match(/\d+/g)[0]]})},t.replaceStr=function(t,e,i){if(-1==t.indexOf(e))return t;var o=t.split(e);return o[0]+i+o[1]},t.getStrColor=function(t){for(var e=[],i=t.indexOf("0x"),o=i,n="",r="";-1!=o;)n=t.substring(i,i+8),e.push(n),i+=8,r=t.substring(i),o=r.indexOf("0x"),i+=o;return e},t.replaceStrColor=function(t,e){var i=t.indexOf("0x"),o=i,n="",r="",a=0,s=[];"string"==typeof e?s.push(e):(s=e,a=s.length);for(var l=0;-1!=o;)n=t.substring(i,i+8),t=t.replace(n,s[l]),a>l&&l++,i+=8,r=t.substring(i),o=r.indexOf("0x"),i+=o;return t},t.replace=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var o=0;o<e.length;o++)t=t.replace("%s",e[o]+"");return t},t.getStrByRegExp=function(t,e){void 0===e&&(e=/\d+/g);var i=[];return t.replace(e,function(){return i.push(arguments[0]),"number"==typeof arguments[0]?arguments[0].toString():arguments[0]}),i},t.formalName=function(t){return t=t.replace(/\|/g,"｜"),t=t.replace(/</g,"＜"),t=t.replace(/>/g,"＞")},t.ChineseToNumber=function(e){if(!t.chnNumCharCN){t.chnNumCharCN={};for(var i=0;9>=i;i++)t.chnNumCharCN[LangMgr.getValueByKey("chinese"+i)]=i}t.chnNameValueCN||(t.chnNameValueCN={},t.chnNameValueCN[LangMgr.getValueByKey("chnUnitChar1")]={value:10,secUnit:!1},t.chnNameValueCN[LangMgr.getValueByKey("chnUnitChar2")]={value:100,secUnit:!1},t.chnNameValueCN[LangMgr.getValueByKey("chnUnitChar3")]={value:1e3,secUnit:!1},t.chnNameValueCN[LangMgr.getValueByKey("chnUnitSection1")]={value:1e4,secUnit:!0},t.chnNameValueCN[LangMgr.getValueByKey("chnUnitSection2")]={value:1e8,secUnit:!0});for(var o=0,n=0,r=0,a=!1,s=e.split(""),i=0;i<s.length;i++){var l=t.chnNumCharCN[s[i]];if("undefined"!=typeof l)r=l,i===s.length-1&&(n+=r);else{var h=t.chnNameValueCN[s[i]].value;a=t.chnNameValueCN[s[i]].secUnit,a?(n=(n+r)*h,o+=n,n=0):n+=r*h,r=0}}return o+n},t.NumberToChinese=function(e){var i=0,o="",n="",r=!1,a=e;if(0===e)return LangMgr.getValueByKey("chinese0");for(;e>0;){var s=e%1e4;r&&(n=LangMgr.getValueByKey("chinese0")+n),o=t.SectionToChinese(s),o+=0==s?"":LangMgr.getValueByKey("chnUnitSection"+i),n=o+n,r=1e3>s&&s>0,e=Math.floor(e/1e4),i++}return a/100>>0==0&&a/10>>0!=0&&LangMgr.getValueByKey("chinese1")==n[0]&&(n=n.substr(1)),n},t.SectionToChinese=function(t){for(var e="",i="",o=0,n=!0;t>0;){var r=t%10;0===r?n||(n=!0,i=LangMgr.getValueByKey("chinese"+r)+i):(n=!1,e=LangMgr.getValueByKey("chinese"+r),e+=LangMgr.getValueByKey("chnUnitChar"+o),i=e+i),o++,t=Math.floor(t/10)}return i},t.strLeachNum=function(t,e,i){void 0===i&&(i="*");for(var o=t.split(/\D/),n="",r=0;r<o.length;r++)""!=o[r]&&(n+=o[r]);return n.length>=e&&(t=t.replace(/^\d+$/,i)),t},t.getChineseWeek=function(t){for(var e="",i=0;i<t.length;i++)e+=LangMgr.getValueByKey("weekStr"+t[i]);return e},t.HTML=/<[^>]+>/g,t.LuoMaNumbers=["","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ"],t.REG_NUM=/\d+/g,t}();__reflect(StringUtils.prototype,"StringUtils");var TextUtils=function(){function t(){}return t.generateTextFlow=function(e){if(!e)return(new egret.HtmlTextParser).parser("");for(var i,o=e.split("|"),n="",r=0,a=o.length;a>r;r++)n+=t.getSingleTextFlow1(o[r]);try{i=(new egret.HtmlTextParser).parser(n)}catch(s){return debug.log("Html text error"),(new egret.HtmlTextParser).parser("")}return i},t.generateTextFlow1=function(e){if(!e)return(new egret.HtmlTextParser).parser("");for(var i=e.split("|"),o=[],n=0,r=i.length;r>n;n++){var a=t.getSingleTextFlow(i[n]);a.text&&""!=a.text&&o.push(a)}return o},t.getSingleTextFlow1=function(e){var i=e.split("&T:",2);if(2==i.length){for(var o="<font",n=i[0].split("&"),r=void 0,a=!1,s=0,l=n.length;l>s;s++)switch(r=n[s].split(":"),r[0]){case t.STYLE_SIZE:o+=' size="'+Math.floor(+r[1])+'"';break;case t.STYLE_COLOR:o+=' color="'+Math.floor(+r[1])+'"';break;case t.UNDERLINE_TEXT:a=!0}return o+=a?"><u>"+i[1]+"</u></font>":">"+i[1]+"</font>"}return"<font>"+e+"</font>"},t.getSingleTextFlow=function(e){var i=e.split("&T:",2),o={style:{}};if(2==i.length){for(var n=(i[0],e.split("&")),r=void 0,a=0,s=n.length;s>a;a++)switch(r=n[a].split(":"),r[0]){case t.STYLE_SIZE:o.style.size=+r[1];break;case t.STYLE_COLOR:o.style.textColor=+r[1];break;case t.UNDERLINE_TEXT:o.style.underline=!0;break;case t.EVENT:o.style.href="event:"+r[1]}o.text=i[1]}else o.text=e;return o},t.generateTextFlow2=function(e,i){if(void 0===i&&(i=-1),!e)return(new egret.HtmlTextParser).parser("");for(var o,n=e.split("|"),r="",a=0,s=0,l=n.length;l>s;s++){var h=n[s];h.indexOf("&T:")>=0?(a++,r+="<font "):a>0&&(a--,r+="</font>"),r+=t.getSingleTextFlow2(n[s],i)}for(;a>0;)r+="</font>",a--;try{o=(new egret.HtmlTextParser).parser(r)}catch(u){return debug.log("Html text error"),void(new egret.HtmlTextParser).parser("")}return o},t.getSingleTextFlow2=function(e,i){void 0===i&&(i=-1);var o=e.split("&T:",2);if(2==o.length){for(var n="",r=o[0].split("&"),a=void 0,s=!1,l=0,h=r.length;h>l;l++)switch(a=r[l].split(":"),a[0]){case t.STYLE_SIZE:n+=' size="'+Math.floor(+a[1])+'"';break;case t.STYLE_COLOR:n+=' color="'+(i>=0?i:Math.floor(+a[1]))+'"';break;case t.UNDERLINE_TEXT:s=!0}return n+=s?"><u>"+o[1]+"</u>":">"+o[1]}return e},t.getChineseNum=function(t){return LangMgr.getValueByKey("chinese"+t)},t.formatUnderLineStr=function(t,e){return(new egret.HtmlTextParser).parser('<a href="event:"'+e+"><u>"+t+"</u></a>")},t.STYLE_COLOR="C",t.STYLE_SIZE="S",t.PROP_TEXT="T",t.UNDERLINE_TEXT="U",t.EVENT="E",t.ITEMID="D",t.ITEMCOUNT="C",t}();__reflect(TextUtils.prototype,"TextUtils");var TweenUtil=function(){function t(){}return t.FadeOut=function(t,e,i){if(t&&e){var o=egret.Tween.get(t),n=i?i.time||500:500;o.to({alpha:0},n).call(function(){egret.Tween.removeTweens(t),i&&i.callFun&&i.callFun.call(e,i.args)},e)}},t.FadeIn=function(t,e,i){if(t&&e){var o=egret.Tween.get(t),n=i?i.time||500:500;o.to({alpha:1},n).call(function(){egret.Tween.removeTweens(t),i&&i.callFun&&i.callFun.call(e,i.args)},e)}},t.LineTo=function(t,e,i,o,n){void 0==o&&(o=egret.MainContext.instance.stage),t.parent&&t.parent.removeChild(t);var r=e.localToGlobal(e.x,e.y);o.globalToLocal(r.x,r.y,r);var a=i.localToGlobal(i.x,i.y);o.globalToLocal(a.x,a.y,a),t.x=r.x,t.y=r.y,o.addChild(t);var s=n?n.time||500:500;egret.Tween.get(t).to({x:a.x,y:a.y},s,egret.Ease.sineOut).call(function(){egret.Tween.removeTweens(t),t&&t.parent&&t.parent.removeChild(t),n&&n.callFun&&n.objthis&&n.callFun.call(n.objthis,n.args)},o)},t.JumpAniByBottom=function(t,e,i,o){void 0===e&&(e=900),void 0===o&&(o=egret.Ease.bounceOut);var n=i?i:500;t.bottom=e,egret.Tween.get(t).to({bottom:0},n,o).call(function(){t&&egret.Tween.removeTweens(t)})},t.ListAnimation=function(t,e,i,o,n,r){void 0===e&&(e=1),void 0===i&&(i=70),void 0===o&&(o=1),void 0===n&&(n="tweenGroup"),t.validateNow(),t.touchEnabled=!1;for(var a=Math.min(t.numChildren,8),s=0,l=0;a>l;l++){var h=t.getChildAt(l),u=h[n];if(!u)return void console.log("not tweenGroup!!!");var c=u.x,p=u.y;r&&(c=r.x,p=r.y);var d=egret.Ease.sineOut;switch(e){case 1:u.x-=h.width;break;case 2:(l+1)%2==0?u.x-=h.width:u.x=h.width;break;case 3:u.y+=h.height;break;case 4:u.x+=h.width;break;case 5:u.y-=h.width;break;case 6:u.scaleX=u.scaleY=3,d=egret.Ease.quartIn;break;case 7:u.scaleX=u.scaleY=.1,d=egret.Ease.quartIn}u.alpha=o,egret.Tween.removeTweens(u),egret.Tween.get(u).to({x:c,y:p,scaleX:1,scaleY:1,alpha:1},100+l*i,d).call(function(){s++,s>=a&&(t.touchEnabled=!0)})}},t}();__reflect(TweenUtil.prototype,"TweenUtil");var RecycleMgr=function(t){function e(){var e=t.call(this)||this;return e.isFirstEnter=!0,e.resDisTime={},e.imageTotalSize=0,e.images=[],e.jsons=[],e.sheets=[],e.fonts=[],e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.addImage=function(t,e){i.ins().images[t]&&console.error("资源重复:",t),i.ins().images[t]=e;var o=e.texture,n=0;if(o instanceof egret.Texture){n=o.$bitmapWidth*o.$bitmapHeight*4,this.imageTotalSize+=n;var r=this.getTextureHashCode(o);r&&this.resDisTime[r]&&delete this.resDisTime[r]}},e.prototype.delImage=function(t){var e=i.ins().images[t];if(!e)return void console.error("资源不存在:",t);delete i.ins().images[t];var o=e.texture,n=0;o instanceof egret.Texture&&(n=o.$bitmapWidth*o.$bitmapHeight*4,this.imageTotalSize-=n)},e.prototype.start=function(){var t=this;TimerMgr.ins().doTimer(5e3,0,function(){t.destroy()},this)},e.prototype.destroy=function(){this.isFirstEnter?(this.isFirstEnter=!1,this.start()):this.destroyRes()},e.prototype.destroyWin=function(){},e.prototype.disposeResTime=function(t){this.resDisTime[t]=egret.getTimer()},e.prototype.destroyRes=function(){var t=[];for(var e in this.resDisTime){var o=this.resDisTime[e];t.push({code:e,disTime:o})}t.sort(function(t,e){return t.disTime-e.disTime});var n={};for(var r in this.images){var a=this.images[r];if(a.texture&&a.resource){var e=this.getTextureHashCode(a.texture);n[e]=a}else delete this.images[r]}for(var s=0;s<t.length;s++){var l=t[s],a=n[l.code];if(a){if(!(a.resource.url.indexOf(PATH_PUBLIC)>=0||a.resource.url.indexOf(PATH_MAP)>=0)){if(this.imageTotalSize<i.MaxImageSize)break;var r=a.resource.name;this.checkCanDestroy(l.code)&&(this.sheets[r]?(RES.hasRes(this.sheets[r])&&RES.destroyRes(this.sheets[r]),delete this.sheets[r]):this.fonts[r]?(RES.hasRes(this.fonts[r])&&RES.destroyRes(this.fonts[r]),delete this.fonts[r]):this.destoryMc(r))}}else delete this.resDisTime[l.code]}},e.prototype.checkCanDestroy=function(t){var e=egret.BitmapData._displayList[t],i=GameMovieClip.displayList[t];return e&&e.length||i&&i.length?(this.resDisTime[t]&&delete this.resDisTime[t],!1):this.resDisTime[t]?(delete egret.BitmapData._displayList[t],delete GameMovieClip.displayList[t],delete GameMovieClip.factoryDic[t],delete this.resDisTime[t],!0):!0},e.prototype.destroyMapFile=function(t){},e.prototype.destoryMc=function(t){RES.hasRes(t)?RES.destroyRes(t):delete this.images[t],this.destoryJson(t)},e.prototype.destoryJson=function(t){var e=t.replace(".png",".json");this.jsons[e]&&(RES.hasRes(e)?RES.destroyRes(e):delete this.jsons[e])},e.prototype.getTextureHashCode=function(t){var e=t.hashCode;return t.bitmapData&&t.bitmapData.hashCode&&(e=t.bitmapData.hashCode),e},e.prototype.reloadContainer=function(t,e){void 0===e&&(e=!1);for(var i=t.numChildren,o=0;i>o;o++){var n=t.getChildAt(o);n instanceof eui.Image?this.reloadImg(n):e&&n instanceof GameMovieClip?n.name&&-1==n.playCount&&n.playFile(n.name,n.playCount):n instanceof egret.DisplayObjectContainer&&this.reloadContainer(n,e)}},e.prototype.reloadImg=function(t){if(t){var e=t.source;if(e){if(t.texture&&t.texture.bitmapData)return;t.source=null,t.source=e}}},e.prototype.fontGetTexturePath=function(t,e){var i="",o=e.split("\n"),n=o[2],r=n.indexOf('file="');return-1!=r&&(n=n.substring(r+6),r=n.indexOf('"'),i=n.substring(0,r)),t=t.split("\\").join("/"),r=t.lastIndexOf("/"),t=-1!=r?t.substring(0,r+1)+i:i},e.MaxImageSize=209715200,__decorate([callLater],e.prototype,"destroyRes",null),e=i=__decorate([recycle],e);var i}(SingleClass);__reflect(RecycleMgr.prototype,"RecycleMgr"),window.BasePanel=BasePanel,window.SingleClass=SingleClass,window.GameByteArray=GameByteArray,window.BaseSound=BaseSound,window.AStar=AStar,window.MapCell=MapCell,window.AStarNode=AStarNode,window.Bresenham=Bresenham,window.MapGrid=MapGrid,window.MapNode=MapNode,window.BaseComponent=BaseComponent,window.BaseItemRender=BaseItemRender,window.BaseLayer=BaseLayer,window.BaseLeakDisplay=BaseLeakDisplay,window.GameMovieClip=GameMovieClip,window.FrameSurveillance=FrameSurveillance,window.DelayOptMgr=DelayOptMgr,window.EventMgr=EventMgr,window.EventVo=EventVo,window.LangMgr=LangMgr,window.ObjectPool=ObjectPool,window.SceneMgr=SceneMgr,window.SwitchSceneMgr=SwitchSceneMgr,window.TimerMgr=TimerMgr,window.MyTimerHandler=MyTimerHandler,window.CRC16=CRC16,window.Encrypt=Encrypt,window.WatcherUtil=WatcherUtil,window.SocketBase=SocketBase,window.SocketConst=SocketConst,window.UInt64=UInt64,window.SoundBg=SoundBg,window.SoundEffects=SoundEffects,window.SoundManager=SoundManager,window.Base64=Base64,window.BezierWarp=BezierWarp,window.ColorUtils=ColorUtils,window.CommonUtils=CommonUtils,window.DateStyle=DateStyle,window.DateUtils=DateUtils,window.DebugUtils=DebugUtils,window.DeviceUtils=DeviceUtils,window.DirUtils=DirUtils,window.DisplayUtils=DisplayUtils,window.EncryptMd5=EncryptMd5,window.EncryptSha1=EncryptSha1,window.ErrorUtils=ErrorUtils,window.FilterUtils=FilterUtils,window.HttpUtils=HttpUtils,window.HttpReqInfo=HttpReqInfo,window.Keyboard=Keyboard,window.KeyboardUtils=KeyboardUtils,window.LoadUtils=LoadUtils,window.LongPressUtils=LongPressUtils,window.MathUtils=MathUtils,window.MobileDevice=MobileDevice,window.NetCalcUtils=NetCalcUtils,window.Page=Page,window.SortUtils=SortUtils,window.StageUtils=StageUtils,window.StringUtils=StringUtils,window.TextUtils=TextUtils,window.TweenUtil=TweenUtil,window.RecycleMgr=RecycleMgr,window.callLater=callLater,window.callDelay=callDelay,window.recycle=recycle,window.injectable=injectable,window.protocolsId=protocolsId,window.up=up,window.down=down,window.FontCustomProcessor=FontCustomProcessor,window.ImageCustomProcessor=ImageCustomProcessor,window.JsonCustomProcessor=JsonCustomProcessor,window.SheetCustomProcessor=SheetCustomProcessor,window.debug=debug,window.Assert=Assert,window.Tween=Tween,window.ArrayCollection=ArrayCollection,window.RES=RES,window.egret=egret,window.GameSystem=GameSystem;var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);i.prototype=e.prototype,t.prototype=new i},__decorate=this&&this.__decorate||function(t,e,i,o){var n,r=arguments.length,a=3>r?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,o);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(3>r?n(a):r>3?n(e,i,a):n(e,i))||a);return r>3&&a&&Object.defineProperty(e,i,a),a},__awaiter=this&&this.__awaiter||function(t,e,i,o){return new(i||(i=Promise))(function(n,r){function a(t){try{l(o.next(t))}catch(e){r(e)}}function s(t){try{l(o["throw"](t))}catch(e){r(e)}}function l(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(a,s)}l((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return o([t,e])}}function o(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(a=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){l.label=i[1];break}if(6===i[0]&&l.label<a[1]){l.label=a[1],a=i;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(i);break}a[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(o){i=[6,o],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,r,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},UnitAction=function(){function t(){}return t.ATTACK="a",t.CAST="c",t.STAND="s",t.RUN="r",t.DIE="d",t.HIT="h",t}();__reflect(UnitAction.prototype,"UnitAction");var EffectModel=function(){function t(){this.dir=4,this.team=4}return t}();__reflect(EffectModel.prototype,"EffectModel");var NpcModel=function(t){function e(){var e=t.call(this)||this;return e.type=100,e}return __extends(e,t),Object.defineProperty(e.prototype,"avatarString",{get:function(){var t=DataCenter.ins().NpcBaseConfig[this.configID];return t?t.avatar:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatarFileName",{get:function(){var t=this.npcConfig;return 1==t.actType?""+PATH_RENWU+RENWU_PREFIX+t.avatar:""+PATH_GUAIWU+GUAIWU_PREFIX+t.avatar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weaponFileName",{get:function(){var t=this.npcConfig;return t.weapon?""+PATH_WUQI+WUQI_PREFIX+t.weapon:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"npcConfig",{get:function(){return DataCenter.ins().NpcBaseConfig[this.configID]},enumerable:!0,configurable:!0}),e.prototype.clone=function(t){var e=egret.getQualifiedClassName(this);t=t||ObjectPool.pop(e);for(var i in this)"function"!=typeof this[i]&&"__class__"!=i&&"__types__"!=i&&(t[i]=this[i]);return t},e}(EffectModel);__reflect(NpcModel.prototype,"NpcModel");var BaseEuiView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!1,e.canDestroy=!0,e.canVis=!1,e.isEasying=!1,e.isNotMove=!1,e.isShowLog=!0,e.resident=!1,e.exclusionWins=[],e.uilayer=GameLayer.MAIN1,e.isPlayAnima=!0,e._isInit=!1,e.percentHeight=100,e.percentWidth=100,e.addEvent(eui.UIEvent.COMPLETE,e,e.uiCompHandler),e}return __extends(e,t),e.prototype.uiCompHandler=function(){this.removeEvent(eui.UIEvent.COMPLETE,this,this.uiCompHandler),this.uiInitComplete?this.uiInitComplete.call(this):this.uiIsComplete=!0},e.prototype.addExclusionWin=function(t){-1==this.exclusionWins.indexOf(t)&&this.exclusionWins.push(t)},e.prototype.isInit=function(){return this._isInit},e.prototype.isShow=function(){return null!=this.stage&&this.visible},e.prototype.onChangeTap=function(e){t.prototype.onChangeTap.call(this,e),SoundUtils.ins().playEffect(SoundUtils.VIEW)},e.prototype.addToParent=function(t,e){null!=e?t.addChildAt(this,e):t.addChild(this)},e.prototype.removeFromParent=function(){DisplayUtils.removeFromParent(this),this.destoryView()},e.prototype.initUI=function(){this._isInit=!0},e.prototype.initData=function(){},e.prototype.destroy=function(){},e.prototype.destoryView=function(t){void 0===t&&(t=!0),TimerMgr.ins().removeAll(this),this.canDestroy&&UIMgr.ins().destroy(this.hashCode),t&&RecycleMgr.ins().destroyWin()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.closePanel=function(t){var e=this.viewStack;if(e&&t>=0&&t<e.numChildren){var i=e.getChildAt(t);i&&i.close&&i.close()}},e.prototype.loadResource=function(t,e){t(),null==this.skinName||this.uiIsComplete?e():this.uiInitComplete=e},e.prototype.setVisible=function(t){this.visible=t},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.playAnima=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.anigroup&&this.isPlayAnima&&AnimaMgr.play(this.anigroup,AnimaMgr.ANITYPE_IN_SCALE_VER,{time:200})},e.prototype.closeEx=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],o=t[1];o&&this.closeToRuleId(o,i)||(this.parent==GameLayer.POPUP&&this.anigroup?AnimaMgr.play(this.anigroup,AnimaMgr.ANITYPE_OUT_SCALE_VER,{time:200,func:i,ease:egret.Ease.sineIn}):i())},e.prototype.closeToRuleId=function(t,e){var i=UIMgr.playFun;if(i){var o=i.getRuleById(t);if(o){var n=o.tar;if(n&&n.parent)return this.easyToTarget(n,e),!0}}return!1},e.prototype.easyToTarget=function(t,e){var i=this;if(!this.isEasying){this.isEasying=!0;var o=this.x,n=this.y,r=this.anchorOffsetX,a=this.anchorOffsetY,s=this.scaleX,l=this.scaleY,h=this.width,u=this.height;this.percentHeight=0,this.percentWidth=0,this.width=h,this.height=u,this.x=this.anchorOffsetX=this.width/2,this.y=this.anchorOffsetY=this.height/2;var c=!1;this.bgClose&&(c=this.bgClose.visible,this.bgClose.visible=!1);var p=t.parent.localToGlobal(t.x+t.width/2,t.y+t.height/2);egret.Tween.get(this).to({scaleX:0,scaleY:0,x:p.x,y:p.y},500).call(function(){i.x=o,i.y=n,i.anchorOffsetX=r,i.anchorOffsetY=a,i.scaleX=s,i.scaleY=l,i.bgClose&&(i.bgClose.visible=c),i.percentHeight=100,i.percentWidth=100,i.isEasying=!1,e&&e()})}},e}(BasePanel);__reflect(BaseEuiView.prototype,"BaseEuiView",["IBaseView"]);var PlatformBase=function(){function t(){}return t.prototype.SDKInitNative=function(){egret.ExternalInterface.call("SDKInitNative","")},t.prototype.SDKMiniAuditVer=function(){return 0},t.prototype.SDKIsNeedInit=function(){},t.prototype.SDKIsNeedLoginNative=function(){},t.prototype.SDKAutoLoginNative=function(t){egret.ExternalInterface.call("SDKAutoLoginNative","")},t.prototype.SDKLoginNative=function(t){egret.ExternalInterface.call("SDKLoginNative","")},t.prototype.SDKHasLoginScene=function(){return!1},t.prototype.GetSDKCheckAccountArgs=function(){return null},t.prototype.SDKCreateRoleNative=function(t){},t.prototype.SDKEnterGameNative=function(t){},t.prototype.SDKUserUpgradeNative=function(t){},t.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({paytype:"home"})},t.prototype.CheckSupportRecharge=function(){return!0},t.prototype.SDKPayNative=function(t){},t.prototype.SDKSetDataNative=function(t){},t.prototype.SDKShowImmersiveIconNative=function(t){},t.prototype.SDKLogoutNative=function(){egret.ExternalInterface.call("SDKLogoutNative","")},t.prototype.SDKExitNative=function(){egret.ExternalInterface.call("SDKExitNative","")},t.prototype.nativeCallChannelType=function(t){GlobalModel.setUrlParamValue("channelId",t)},t.prototype.nativeCallAppVersion=function(t){GlobalModel.setUrlParamValue("appVersion",t)},t.prototype.SDKShowShare=function(t){},t.prototype.SDKShowQRCode=function(){},t.prototype.SDKStartForGift=function(){},t.prototype.SDKFaceStartGift=function(){},t.prototype.nativeCallback=function(t){debug.log("SDKCallData:",t);var e=JSON.parse(t);e.callType},t.prototype.SDKTapExecute=function(){},t.prototype.SDKShowLogout=function(){return!1},t.prototype.getStatusHeight=function(){return 0},t.prototype.getBottomSafeHeight=function(){return 0},t.prototype.showSuperVip=function(){return!1},t.prototype.isShowMiniAccountJumpPortalIcon=function(){return!1},t.prototype.miniAccountJumpPortalIconTap=function(){},t.prototype.isHideRechargeShow=function(){return!1},t.prototype.isShowSharePortalIcon=function(){return!1},t}();__reflect(PlatformBase.prototype,"PlatformBase");var UnitEffect=function(t){function e(){var e=t.call(this)||this;return e.myHeight=UnitMgr.CHAR_DEFAULT_HEIGHT,e.typeface=UnitMgr.CHAR_DEFAULT_TYPEFACE,e._dir=4,e._state=UnitAction.STAND,e._layerWeigth=0,e.hasDir=[1,2,3,7,8],e._disOrder={},e._mcFileName={},e._bodyContainer=new egret.DisplayObjectContainer,e.addChild(e._bodyContainer),e._body=ObjectPool.pop("GameMovieClip"),e._bodyContainer.addChild(e._body),e._disOrder[1]=e._body,e.titleCantainer=new egret.DisplayObjectContainer,e.titleCantainer.anchorOffsetY=e.myHeight,e.addChild(e.titleCantainer),e}return __extends(e,t),e.prototype.setBodyScale=function(t){this._bodyContainer.scaleX=this._bodyContainer.scaleY=t,this.myHeight=this.myHeight*t,this.typeface*=t,this.titleCantainer.anchorOffsetY=Math.floor(this.myHeight)},Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){this._infoModel=t},enumerable:!0,configurable:!0}),e.prototype.setConfig=function(t){var e=DataCenter.ins().MonstershpConfig[t];e?(this.myHeight=e.hp,this.typeface=e.hp):(this.myHeight=UnitMgr.CHAR_DEFAULT_HEIGHT,this.typeface=UnitMgr.CHAR_DEFAULT_TYPEFACE),this.titleCantainer.anchorOffsetY=Math.floor(this.myHeight)},e.prototype.updateModel=function(){},Object.defineProperty(e.prototype,"dir",{get:function(){return this._dir},set:function(t){this._dir!=t&&(this._dir=t,this.loadBody())},enumerable:!0,configurable:!0}),e.prototype.getResDir=function(t){var e=2*(this._dir-4);return 0>e&&(e=0),this._dir-e},e.prototype.playAction=function(t,e){this._state=t,this.playComplete=e,this._body.clearComFun(),this.loadBody()},e.prototype.loadBody=function(){this._body.stop(),this._body.addEventListener(egret.Event.CHANGE,this.playBody,this),this.hasDir.indexOf(1)>=0?this.loadFile(this._body,this.getFileName(1),1):this.playFile(this._body,this.getFileName(1)),this.loadShadow()},e.prototype.loadShadow=function(){this.shadow&&this.shadow.playFile(this._body.name,this._body.playCount,this._body.scaleX)},e.prototype.loadOther=function(t){var e=this.getMc(t);e&&(e.stop(),e.addEventListener(egret.Event.CHANGE,this.syncFrame,this),this.loadFile(e,this.getFileName(t),t))},e.prototype.loadNoDir=function(t){var e=this.getMc(t);this.playFile(e,this.getFileName(t))},e.prototype.getFileName=function(t){return this._mcFileName[t]},e.prototype.playFile=function(t,e){t.playFile(e,-1,null,!1)},e.prototype.loadFile=function(t,i,o){if(i&&!(e.ACTION_ODER[o]&&e.ACTION_ODER[o].indexOf(this._state)<0)){var n=this.getResDir(o);t.scaleX=this._dir>4?-1:1;var r=i+"_"+n+this._state;t.playFile(r,this.playCount(),t==this._body?this.playComplete:null,!1)}},e.prototype.playBody=function(t){var e=1;this._body.gotoAndPlay(e,this.playCount()),this.removeBodyEvent(this._body);for(var i in this._disOrder){var o=this._disOrder[i];o!=this._body&&this.hasDir.indexOf(+i)>=0&&o instanceof GameMovieClip&&this.loadOther(+i)}this.sortEffect()},e.prototype.syncFrame=function(t){this.removeMcEvent(t.currentTarget),t.currentTarget.gotoAndPlay(this._body.currentFrame,this.playCount())
},e.prototype.removeBodyEvent=function(t){t.removeEventListener(egret.Event.CHANGE,this.playBody,this)},e.prototype.removeMcEvent=function(t){t.removeEventListener(egret.Event.CHANGE,this.syncFrame,this)},e.prototype.onImgLoaded=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.COMPLETE,this.onImgLoaded,this),e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2},e.prototype.playCount=function(){return-1},e.prototype.addMc=function(t,e,i){if(void 0===i&&(i=0),this._mcFileName[t]!=e){this._mcFileName[t]=e;var o=this._disOrder[t];return o||(o=0==i?ObjectPool.pop("GameMovieClip"):new eui.Image,this._bodyContainer.addChild(o),this._disOrder[t]=o),o instanceof GameMovieClip?this.hasDir.indexOf(t)>=0?o==this._body?this.loadBody():this.loadOther(t):this.loadNoDir(t):(o.addEventListener(egret.Event.COMPLETE,this.onImgLoaded,this),o.source=e),this.sortEffect(),o}},e.prototype.removeMc=function(t){if(1!=t){var e=this._disOrder[t];e&&(e instanceof GameMovieClip?(this.removeMcEvent(e),e.destroy()):DisplayUtils.removeFromParent(e),delete this._mcFileName[t],delete this._disOrder[t])}},e.prototype.getMc=function(t){return this._disOrder[t]},e.prototype.removeAll=function(){for(var t in this._disOrder){var e=this._disOrder[t];e!=this._body&&(e instanceof GameMovieClip?(this.removeMcEvent(e),e.destroy()):DisplayUtils.removeFromParent(e),delete this._mcFileName[t],delete this._disOrder[t])}this._body.dispose(),this.removeBodyEvent(this._body),delete this._mcFileName[1]},e.prototype.addShadow=function(){this.shadow||(this.shadow=new UnitShadow,this.addChildAt(this.shadow,0))},e.prototype.setShadowType=function(t){this.shadow&&this.shadow.setType(t)},e.prototype.removeShadow=function(){this.shadow&&(this.shadow.dispose(),this.shadow=null)},e.prototype.sortEffect=function(){for(var t=e.FRAME_ODER[this._dir],i=t.length,o=0,n=0;i>n;n++){var r=t[n];this._disOrder[r]&&this._disOrder[r].parent&&(this._bodyContainer.addChildAt(this._disOrder[r],o),o+=1)}},Object.defineProperty(e.prototype,"weight",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"team",{get:function(){return this.infoModel.team},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAll()},e.prototype.getBody=function(){return this._body},e.FRAME_ODER=[[2,9,7,1,10,3,8],[1,10,2,9,7,3,8],[3,1,10,2,9,7,8],[8,3,1,10,2,9,7],[8,3,1,10,2,9,7],[8,3,1,10,2,9,7],[3,1,10,2,9,7,8],[1,10,2,9,7,3,8]],e.ACTION_ODER={8:[UnitAction.STAND,UnitAction.RUN,UnitAction.ATTACK]},e}(egret.DisplayObjectContainer);__reflect(UnitEffect.prototype,"UnitEffect");var ItemBase=function(t){function e(){var e=t.call(this)||this;return e.showSpeicalDetail=!0,e.isOpenSelectImg=!1,e.isCurrency=!1,e.showName=!1,e.skinName="ItemSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.addEventTouchEnd(this,this.onClick)},e.prototype.setSoul=function(t){this.itemIcon.setSoul(t)},e.prototype.setItemImg=function(t){this.itemIcon.imgIcon.source=t},e.prototype.setItemJob=function(t){this.itemIcon.setJobImg(t)},e.prototype.setItemHeirloomBgImg=function(t,e){e&&(this.itemIcon.imgheirloom.source=e+"_png"),this.itemIcon.imgheirloom.visible=t},e.prototype.setDataByConfig=function(t,e){this.itemIcon&&"function"==typeof this.itemIcon.setData&&this.itemIcon.setData(t);var i=ItemUtils.getType(t);if(0!=i||248==t.descIndex||this.showName)this.nameTxt.text=e?e:t.name,this.nameTxt.textColor=ItemUtils.getQualityColor(t);else{var o=isNaN(t.zsLevel)?LangMgr.getValueByKey("numberLevel",t.level||1):LangMgr.getValueByKey("numberRotation",t.zsLevel);if(this.nameTxt.text=o,-1!=BackpackControl.fitleEquip.indexOf(t.id)&&(this.nameTxt.text=LangMgr.getValueByKey("shopNoLevel"),this.nameTxt.textColor=ItemUtils.getQualityColor(t)),t.lvName&&(this.nameTxt.text=t.lvName,this.nameTxt.textColor=ItemUtils.getQualityColor(t)),t.bagLvName){this.showSpeicalDetail=!1;for(var n=this.parent;n&&n.parent;)if(n=n.parent,CommonFun.instanceofByName(n,"BackpackView")){this.showSpeicalDetail=!0;break}this.showSpeicalDetail&&(this.nameTxt.text=t.bagLvName)}}this.setViewCount(this.num),12==i&&this.redPoint&&(this.redPoint.visible=this.getGuildGift(t)),33==i&&this.equipLvImg&&(this.equipLvImg.source="mequip_lv"+t.level,this.equipLvImg.visible=!0),102==i&&this.redPoint&&(this.redPoint.visible=backpackControl.getTitleUpLvRedPoint(t,this.data.count))},e.prototype.dataChanged=function(){this.clear(),this.equipLvImg&&(this.equipLvImg.visible=!1);var t=!1;if(this.redPoint&&(this.redPoint.visible=!1),this.isDropTag(!1),this.isDropBig(!1),void 0!=this.data){if(isNaN(this.data))if(this.data instanceof ItemData){if(this.itemConfig=this.data.itemConfig,!this.itemConfig)return;this.setDataByConfig(this.itemConfig),this.setViewCount(this.data.count),t=!0}else{if(0==this.data.type){this.itemIcon.imgIcon.source=Currency.getCurrencyRes(this.data.id);var e=1;switch(this.data.id){case 2:e=5;break;case 1:e=0;break;case 4:case 15:e=2;break;case 10:e=2,this.itemIcon.imgIcon.source=Currency.getCurrencyRes(this.data.id);break;case 13:e=2}this.isCurrency=!0,this.itemIcon.imgBg.source="quality"+e,this.nameTxt.text=Currency.getCurrencyName(this.data.id),this.nameTxt.textColor=LangMgr.getColor("qualityColor"+e),this.setViewCount(this.data.count)}else if(1==this.data.type){if(this.itemConfig=DataCenter.ins().ItemConfig[this.data.id],!this.itemConfig)return;this.setDataByConfig(this.itemConfig),this.isDropTag(this.data.isDrop),this.isDropBig(1==this.data.dropType),this.setViewCount(this.data.count)}else 6==this.data.type?(this.itemConfig=DataCenter.ins().ItemConfig[this.data.id],this.setDataByConfig(this.itemConfig),this.setViewCount(this.data.count)):(this.itemConfig=DataCenter.ins().ItemConfig[this.data.id],this.itemConfig&&(this.setDataByConfig(this.itemConfig),this.setViewCount(this.data.count)));this.redPoint&&(this.redPoint.visible=1==this.data.isRedPoint),this.getImg&&(this.getImg.visible=2==this.data.isRedPoint),this.tagImg&&(this.data.tagImg?(this.tagImg.visible=!0,this.tagImg.source=this.data.tagImg):this.tagImg.visible=!1)}else this.itemConfig=DataCenter.ins().ItemConfig[this.data],this.setDataByConfig(this.itemConfig,this.runeName);if(this.redPoint&&!this.redPoint.visible&&(this.redPoint.visible=this.data.canbeUsed),this.showEquipEffect(),t&&this.redPoint&&this.itemConfig){var i=ItemUtils.getType(this.itemConfig),o=backpackControl.canUse(this.itemConfig.id);if(8==i){var n=!0;200137==this.itemConfig.id&&(n=BackpackControl.checkLvDanPoint(this.data)),this.redPoint.visible=this.data&&this.data.count>0&&n&&o,200155==this.itemConfig.id&&(this.redPoint.visible=o)}else if(17==i)this.redPoint.visible=o;else if(20==i)this.redPoint.visible=this.data.canbeUsed&&o;else if(25==i||26==i)this.redPoint.visible=o;else if(28==i)this.redPoint.visible=!1;else if(38==i)this.redPoint.visible=officeControl.checkItemIdCanDestroy(this.itemConfig.id)&&o;else if(39==i)this.redPoint.visible=o;else if(this.itemConfig.id==DataCenter.ins().AsTeamCopyBaseConfig.itemId)this.redPoint.visible=o;else{var r=DataCenter.ins().ItemComposeConfig[this.itemConfig.id];r&&r.srcCount<=this.data.count&&(this.redPoint.visible=!0)}}this.setSelect(this.selected),this.dataChangeHandler()}},e.prototype.dataChangeHandler=function(){},e.prototype.setViewCount=function(t){void 0!=t&&t>1?this.setCount(""+t):this.setCount("")},e.prototype.clear=function(){this.isCurrency=!1,this.itemConfig=null,this.itemIcon&&"function"==typeof this.itemIcon.setData&&this.itemIcon.setData(null),this.count.text="",this.nameTxt.text="",this.nameTxt.textColor=14668213,DisplayUtils.removeFromParent(this.equipEffect)},e.prototype.destruct=function(){this.removeEventTouchEnd(this,this.onClick)},e.prototype.isShowJob=function(t){this.itemIcon.imgJob.visible=t},e.prototype.onClick=function(){this.data&&1!=this.data.isRedPoint&&this.showDetail()},e.prototype.getItemType=function(){return this.itemConfig?ItemUtils.getType(this.itemConfig):-1},e.prototype.showCurrency=function(){},e.prototype.showDetail=function(){e.showDetail(this)},e.prototype.getGuildGift=function(t){var e=0;if(t instanceof ItemData){var i=DataCenter.ins().ItemConfig[t.configID];e=i.level}else t&&(e=t.level);return ActorControl.level>=e&&0!=unionControl.guildID?!0:!1},e.prototype.setCount=function(t){if(t.length>4){var e=Math.floor(Number(t)/1e3);t=LangMgr.getValueByKey("shopWan",e/10)}this.count.text=t},e.prototype.setCountEx=function(t){this.count.textFlow=TextUtils.generateTextFlow1(t)},e.prototype.openEquipsTips=function(){var t=ItemUtils.getSubType(this.itemConfig);if(t>=9&&12>=t)UIMgr.ins().open("ReincarnationEquipTipsView",this.itemConfig.id);else if(121==this.itemConfig.descIndex||122==this.itemConfig.descIndex){this.showSpeicalDetail=!1;for(var e=this.parent;e&&e.parent;)if(e=e.parent,CommonFun.instanceofByName(e,"RoleInfoPanel")||CommonFun.instanceofByName(e,"RankRoleInfoPanel")){this.showSpeicalDetail=!0;break}this.showSpeicalDetail?UIMgr.ins().open("EquipTipsView",1,this.data.handle,this.itemConfig.id,this.data):UIMgr.ins().open("ZealEquipTipsView",this.itemConfig.id)}else UIMgr.ins().open("EquipTipsView",1,this.data.handle,this.itemConfig.id,this.data)},e.prototype.isShowName=function(t){this.nameTxt.visible=t},e.prototype.getItemSoure=function(){var t="";return t=0==this.data.type?Currency.getCurrencyRes(this.data.id):this.itemIcon.config.icon+"_png"},e.prototype.getText=function(){return this.nameTxt.text},e.prototype.getTextColor=function(){return this.nameTxt.textColor},e.prototype.showEquipEffect=function(){if(this.tweenGroup){var t=ItemUtils.getQuality(this.itemConfig),e=ItemUtils.getType(this.itemConfig);if(33==e)return this.equipEffect=this.equipEffect||new GameMovieClip,this.equipEffect.touchEnabled=!1,this.equipEffect.x=44,this.equipEffect.y=36,this.equipEffect.scaleX=this.equipEffect.scaleY=1,this.equipEffect.playFile(""+PATH_EFF+DataCenter.ins().DominateEquipBaConfig.posEff[ItemUtils.getSubType(this.itemConfig)],-1),void this.tweenGroup.addChild(this.equipEffect);if(this.itemConfig&&!(3>=t)||2==this.data.id){var i="";this.equipEffect=this.equipEffect||new GameMovieClip,this.equipEffect.touchEnabled=!1,2==this.data.id?(i="quaeff6",this.equipEffect.x=44,this.equipEffect.y=32,this.equipEffect.scaleX=this.equipEffect.scaleY=1):4==t?(i="quality_05",this.equipEffect.x=this.tweenGroup.x,this.equipEffect.y=33,this.equipEffect.scaleX=this.equipEffect.scaleY=1):5==t&&(i="chuanqizbeff",this.equipEffect.x=44,this.equipEffect.y=33,this.equipEffect.scaleX=this.equipEffect.scaleY=1),this.tweenGroup.addChild(this.equipEffect),this.equipEffect.playFile(PATH_EFF+i,-1)}}},e.prototype.clearEffect=function(){DisplayUtils.removeFromParent(this.equipEffect),this.equipEffect=null},e.prototype.HideImgBg=function(){this.itemIcon.imgBg.visible=!1},e.prototype.showNum=function(t){this.count.visible=t},e.prototype.setImgBg=function(t){this.itemIcon.imgBg.source="quality"+t},e.prototype.isDropTag=function(t){this.dropTagsGroup&&(this.dropTagsGroup.visible=t)},e.prototype.isDropBig=function(t){this.bigDropGroup&&(this.bigDropGroup.visible=t)},e.prototype.getItemIcon=function(){return this.itemIcon},e.prototype.setSelect=function(t){this.isOpenSelectImg&&(this.selectFrame.visible=t)},e.prototype.hideName=function(){this.nameTxt.visible=!1},e.prototype.setName=function(t){this.nameTxt.textFlow=TextUtils.generateTextFlow1(t)},e.prototype.setImgBg1=function(t){this.itemIcon.setImgBg1(t)},e.prototype.setRedPoint=function(t){this.redPoint&&(this.redPoint.visible=t)},e.showDetail=function(t){var e=t.data;if(t.isCurrency)switch(e.id){case 2:case 7:case 13:UIMgr.ins().open("CurrencyTipsView",e.id,e.count)}else{var i=t.itemConfig;if(i){if(e.handle&&i.id==DataCenter.ins().AsTeamCopyBaseConfig.itemId)return void UIMgr.ins().open(FlowerUseView);if(dominateControl.isTrinketById(i.id))return void UIMgr.ins().open("DominateTipsView",i);switch(ItemUtils.getType(i)){case 0:case 4:t.openEquipsTips();break;case 5:UIMgr.ins().open("PunchEquipTipsView",e,!1,!0);break;case 1:var o=DataCenter.ins().ItemComposeConfig[i.id];if(o)e.handle?UIMgr.ins().open("ItemUseTipsView",e):UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,e.count,t.par1);else if(e.handle&&i.id==DataCenter.ins().BeastConfig.battleCountItem)UIMgr.ins().open("BeastDanUseView",i);else if(e.handle&&i.id==fashionControl.getIdZhuangBanId(i.id))UIMgr.ins().open("FashionTipsView",i);else if(heirloomControl.getDressDpById(i.id))UIMgr.ins().open("FashionHeirloomTipsView",i,!e.handle);else if(e.handle&&heirloomControl.getDressDpById(i.id))UIMgr.ins().open("FashionHeirloomTipsView",i);else if(864==i.descIndex)UIMgr.ins().open("AshtarteDrugExtView",e.handle,i.id);else if(i.id==fashionControl.getIdZhuangBanId(i.id)){for(var n=!1,r=t.parent;r&&r.parent;)if(r=r.parent,CommonFun.instanceofByName(r,"BackpackView")){n=!0;break}n?UIMgr.ins().open("FashionTipsView",i):UIMgr.ins().open("FashionTipsView",i,!0)}else UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,e.count,t.par1);break;case 2:e.handle?UIMgr.ins().open("ItemUseTipsView",e):e.count?UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,e.count):UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id);break;case 6:for(var a=!0,s=t.parent;s&&s.parent;)if(s=s.parent,CommonFun.instanceofByName(s,"CopyBabelPanel")){a=!1;break}UIMgr.ins().open("RuneTipsView",0,i.id,t.desc,t.desc2,a);break;case 9:UIMgr.ins().open("BookTipsView",i.id,0,e.handle);break;case 10:e.handle?UIMgr.ins().open("ItemUseTipsView",e):UIMgr.ins().open("ItemTipsView",0,i.id);break;case 8:case 20:if(1==e.type)UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,e.count);else{for(var l=+t.count.text||e.count||0,h=!1,u=t.parent;u&&u.parent;)if(u=u.parent,CommonFun.instanceofByName(u,"BackpackView")){h=!0;break}h?(200155==i.id&&(backpackControl.hideLvUpRed(),backpackControl.dispatchHasItemCanUse()),UIMgr.ins().open("ItemUseTipsView",{itemConfig:i,configID:i.id,count:l})):UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,l)}break;case 12:e.itemConfig&&t.getGuildGift(e)?UIMgr.ins().open("ItemUseTipsView",e):UIMgr.ins().open("ItemUseTipsView",{itemConfig:i,configID:i.id,count:e.count},!0);break;case 11:for(var c in DataCenter.ins().HeirloomEquipItemConfig){var p=DataCenter.ins().HeirloomEquipItemConfig[c];if(p&&p.item==i.id){UIMgr.ins().open("HeirloomEquipTipsView",null,p.pos-1);break}}break;case 13:case 14:1==e.type?UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,e.count):UIMgr.ins().open("ItemUseTipsView",{itemConfig:i,configID:i.id,count:e.count});break;case 15:UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,e?e.count:void 0);break;case 16:var d=DataCenter.ins().FeatherItemConfig[i.id];UIMgr.ins().open("FeatherDeityTipsView",d);break;case 17:if(857==i.descIndex);else if(863==i.descIndex);else{for(var g=!1,f=t.parent;f&&f.parent;)if(f=f.parent,CommonFun.instanceofByName(f,"BackpackView")){g=!0;break}UIMgr.ins().open(g?"TreasureHuntRareGiftView":this.getItemDetaileClass(i),0,i.id,e.count)}break;case 19:UIMgr.ins().open("UitrasoneEquipTipsView",ItemUtils.getSubType(i));break;case 21:ashtarteControl.ZhanLingItemTips(i.id);break;case 22:UIMgr.ins().open("AshtarteTipsView",i.id);break;case 23:UIMgr.ins().open("BeastEquipTipView",0,0,i.id);break;case 24:UIMgr.ins().open("SoulBoneTipsView",!1,0,i.id);break;case 25:case 26:e instanceof ItemData?UIMgr.ins().open("ItemUseTipsView",e):UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id);break;case 27:UIMgr.ins().open("ThunderItemTipsView",i.id);break;case 28:UIMgr.ins().open("DarkEquipTipsView",i.id,t.roleId,!0,void 0,void 0,t.notBody);break;case 30:UIMgr.ins().open("DragonSoulItemTipsPreviewView",i.id);break;case 31:for(var m=!1,v=t.parent;v&&v.parent;)if(v=v.parent,CommonFun.instanceofByName(v,"BackpackView")){m=!0;break}UIMgr.ins().open("CrazybtplayTipView",i.id,m);break;case 33:if(e instanceof ItemData)UIMgr.ins().open("DominateEquipTakeTipsView",e);else{var y=new ItemData;y.configID=i.id,UIMgr.ins().open("DominateEquipTakeTipsView",y,!0)}break;case 34:UIMgr.ins().open("DevourEquipTipsView",i.id);break;case 37:UIMgr.ins().open("ReincarnateStarEquipTipsView",i.id);break;case 38:e instanceof ItemData&&officeControl.checkItemIdCanDestroy(i.id)?UIMgr.ins().open("ItemUseTipsView",e):UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,void 0,t.par1);break;case 39:for(var C=!1,b=t.parent;b&&b.parent;)if(b=b.parent,CommonFun.instanceofByName(b,"BackpackView")){C=!0;break}UIMgr.ins().open("TitleTipsView",i.id,C);break;case 40:UIMgr.ins().open("TotembagTipsView",i.id);break;case 41:UIMgr.ins().open("ReincarnateStarSoulTipsView",i.id);break;case 42:UIMgr.ins().open("FakeEquipTipsView",i.id);break;case 47:e instanceof ItemData?UIMgr.ins().open("ItemUseTipsView",e):UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id);break;case 97:UIMgr.ins().open("CrazyDogTipsView",i.id);break;case 100:UIMgr.ins().open("WarriorActiveItemTipView",i.id);break;case 101:t.warriorEquipId?UIMgr.ins().open("WarriorEquipDetailTipView",t.warriorEquipId,i.id,!1):UIMgr.ins().open("WarriorEquipDetailTipView",null,i.id,!1);break;case 102:for(var T=!1,w=t.parent;w&&w.parent;)if(w=w.parent,CommonFun.instanceofByName(w,"BackpackView")){T=!0;break}if(T)UIMgr.ins().open("TitleUpLvTipsView",0,i.id,e.count||0,e);else{var l=+t.count.text||e.count||0;UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,l)}break;default:UIMgr.ins().open(this.getItemDetaileClass(i),0,i.id,+t.count.text||e.count||void 0,t.par1)}}}},e.getItemDetaileClass=function(t){return t.isWay?"ItemGainTipsView":"ItemTipsView"},e.ADDITION_RANGE=15,e}(BaseItemRender);__reflect(ItemBase.prototype,"ItemBase");var StartLoading=function(t){function e(){var e=t.call(this)||this;return e.content=null,e.init(),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.init=function(){this.content=new egret.Sprite,this.content.graphics.beginFill(0,.2),this.content.graphics.drawRect(0,0,StageUtils.ins().getWidth(),StageUtils.ins().getHeight()),this.content.graphics.endFill(),this.content.touchEnabled=!0,this.uiImageContainer=new egret.DisplayObjectContainer,this.uiImageContainer.x=.5*this.content.width,this.uiImageContainer.y=.5*this.content.height,this.content.addChild(this.uiImageContainer),this.loadReel()},e.prototype.loadReel=function(){this.uiImage||(this.uiImage=new eui.Image(PATH_RES+"loadLoop.png"),this.uiImage.x=-56,this.uiImage.y=-59,this.uiImageContainer.addChild(this.uiImage))},e.prototype.showLoading=function(){this.loadReel(),egret.startTick(this.enterFrame,this),StageUtils.ins().getStage().addChild(this.content)},e.prototype.hideLoading=function(){this.content&&this.content.parent&&(StageUtils.ins().getStage().removeChild(this.content),this.uiImageContainer.rotation=0),egret.stopTick(this.enterFrame,this)},e.prototype.enterFrame=function(t){return this.uiImageContainer.rotation+=5,!1},e}(SingleClass);__reflect(StartLoading.prototype,"StartLoading");var RoleItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.data instanceof RoleModel?this.setRole(this.data):this.data instanceof RankSubRoleVo?this.setSubRole(this.data):this.clearRole()},e.prototype.playApproachEff=function(t,e){var i=this;if(t.thirteenEquipLv||t.weaponViewId||t.clothesViewId)return!1;var o=appearanceControl.checkCanShow(t,2,0);if(o)return!1;var n=fashionControl.getApproachEff(t);if(n){var r=function(t){t&&egret.Tween.get(t).to({alpha:0},1500).call(function(){DisplayUtils.removeFromParent(t)}),egret.Tween.get(i.groupRole).to({alpha:1},1500),e&&e()};return this.groupRole.alpha=0,this.playEffArr(n.concat(),r),!0}return!1},e.prototype.playEffArr=function(t,e){var i=this;0==t.length?e(this.approachEff):(this.approachEff=this.approachEff||new GameMovieClip,this.approachEff.alpha=1,this.approachEff.dispose(),this.approachAct.addChild(this.approachEff),this.approachEff.playFile(PATH_EFF+t[0],1,function(){1==t.length?e&&e(i.approachEff):(t.shift(),i.playEffArr(t,e))},!1))},e.prototype.removeApproachEff=function(){this.groupRole.alpha=1,egret.Tween.removeTweens(this.groupRole),this.approachEff&&this.approachEff.dispose(),DisplayUtils.removeFromParent(this.approachEff)},e.prototype.setRole=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this.clearRole(),t&&(e&&this.setNameAndTitle(t),this.setBodyWeapon(t),i||this.setSuit(t),this.setWing(t),i||this.setDemonCir(t.deCirShowID),this.changeLayer(t))},e.prototype.setSubRole=function(t){this.clearRole(),t&&(this.setBodyWeapon(t),this.setSuit(t),this.setWing(t),this.setDemonCir(t.deCirShowID),this.changeLayer(t))},e.prototype.clearRole=function(){this.title.source=null,this.nameLabel.text="",this.bodyImg.source=RENWU_PREFIX+"00_png",this.wingImg.source=null,this.weaponImg.source=null,this.bodyImg.visible=this.weaponImg.visible=this.wingImg.visible=!0,DisplayUtils.removeFromParent(this.titleMc),DisplayUtils.removeFromParent(this.suitEff),DisplayUtils.removeFromParent(this.gwEff),DisplayUtils.removeFromParent(this.wingEff),DisplayUtils.removeFromParent(this.ltWeaponEff),DisplayUtils.removeFromParent(this.ltClothesEff),DisplayUtils.removeFromParent(this.weaponEff),DisplayUtils.removeFromParent(this.clothesEff),DisplayUtils.removeFromParent(this.deEff)},e.prototype.setNameAndTitle=function(t){this.nameLabel.text=t.name,this.title.source=null,DisplayUtils.removeFromParent(this.titleMc);var e=DataCenter.ins().TitleConfig[t.title];e&&(e.img&&(this.title.source=e.img),e.eff&&(this.titleMc=this.titleMc||new GameMovieClip,this.playMc(this.titleMc,PATH_EFF+e.eff,this.titleMcGroup)))},e.prototype.setBodyWeapon=function(t){var e=t instanceof RankSubRoleVo,i=null,o=null,n=appearanceControl.getEquipEffId(t,0,1),r=appearanceControl.getEquipEffId(t,2,1);GlobalModel.bodyBindWeapon&&n>0?r=n:GlobalModel.weaponBindBody&&r>0&&(n=r);var a,s,l=!1;this.bodyImg.source=this.weaponImg.source=null,DisplayUtils.removeFromParent(this.weaponEff),DisplayUtils.removeFromParent(this.clothesEff);var h=!1,u=!1;if(t.weaponViewId){var c=DataCenter.ins().DevourEquipLevelConfig[0],p=void 0;if(c&&c[t.weaponViewId]){p=c[t.weaponViewId].outside||c[t.weaponViewId].inside;var d=DataCenter.ins().EquipWithEffConfig[p+"_0"];this.setBodyWeaponEff("weaponEff",d,this.soulEff,"wsef0"),h=!0}}if(t.clothesViewId){var c=DataCenter.ins().DevourEquipLevelConfig[2],p=void 0;if(c&&c[t.clothesViewId]){p=c[t.clothesViewId].outside||c[t.clothesViewId].inside;var d=DataCenter.ins().EquipWithEffConfig[p+"_"+t.sex];this.setBodyWeaponEff("clothesEff",d,this.bodyEff,"bodyEffect"+t.sex),u=!0}}if(!e&&t.thirteenEquipLv){if(!h){var d=DataCenter.ins().EquipWithEffConfig[DataCenter.ins().ReincarnateStarStepBsConfig.weaponEff[t.thirteenEquipLv-1]+"_0"];this.setBodyWeaponEff("weaponEff",d,this.soulEff,"wsef0")}if(!u){var d=DataCenter.ins().EquipWithEffConfig[DataCenter.ins().ReincarnateStarStepBsConfig.bodyEff[t.thirteenEquipLv-1]+"_"+t.sex];this.setBodyWeaponEff("clothesEff",d,this.bodyEff,"bodyEffect"+t.sex)}}else{var g=fashionControl.checkActiveSuit(e?[t.pos1,t.pos2]:t);if(h&&(g=0),!h)if(appearanceControl.checkCanShow(t,0,0)){if(s=appearanceControl.getEquipEffId(t,0,0)){var f=0,d=DataCenter.ins().EquipWithEffConfig[s+"_"+f];if(d&&d.inShowEff)this.setBodyWeaponEff("weaponEff",d,this.soulEff,"wsef"+f);else{var m=DataCenter.ins().EquipConfig[s].appearance;m&&m.indexOf("[job]")>-1&&(m=m.replace("[job]",t.job+"")),i=m+"_"+f+"_c_png"}}}else if((appearanceControl.checkCanShow(t,0,1)||GlobalModel.weaponBindBody&&appearanceControl.checkCanShow(t,2,1))&&n){var f=0,v=fashionControl.getZhuangBanEffId(0,f,e?[t.pos1,t.pos2]:t.zhuangbei);e?appearanceControl.checkWeaponHasFamale(t.pos2)&&(f=t.sex):f=appearanceControl.getWeaponFashionSex(t);var d=DataCenter.ins().EquipWithEffConfig[v+"_"+f];if(d&&d.inShowEff)this.setBodyWeaponEff("weaponEff",d,this.soulEff,"wsef"+f,g);else{var m=DataCenter.ins().FashionIdConfig[n].res;m&&(l=!0,i=m+"_"+f+"_c_png",GlobalModel.weaponBindBody&&(i=i.replace(""+RENWU_PREFIX,""+WUQI_PREFIX)))}}if(!u)if(GlobalModel.bodyBindWeapon&&(a=s),appearanceControl.checkCanShow(t,2,0)){if(a=appearanceControl.getEquipEffId(t,2,0)){var d=DataCenter.ins().EquipWithEffConfig[a+"_"+t.sex];if(d&&d.inShowEff)this.setBodyWeaponEff("clothesEff",d,this.bodyEff,"bodyEffect"+t.sex);else{var m=DataCenter.ins().EquipConfig[a].appearance;m&&m.indexOf("[job]")>-1&&(m=m.replace("[job]",t.job+"")),o=m+"_"+t.sex+"_c_png"}}else o=RENWU_PREFIX+"000_"+t.sex+"_c_png";GlobalModel.bodyBindWeapon&&(o=o.replace(""+WUQI_PREFIX,""+RENWU_PREFIX))}else if((appearanceControl.checkCanShow(t,2,1)||GlobalModel.bodyBindWeapon&&appearanceControl.checkCanShow(t,0,1))&&r){var v=fashionControl.getZhuangBanEffId(2,t.sex,e?[t.pos1,t.pos2]:t.zhuangbei),d=DataCenter.ins().EquipWithEffConfig[v+"_"+t.sex];if(d&&d.inShowEff)this.setBodyWeaponEff("clothesEff",d,this.bodyEff,"bodyEffect"+t.sex,g);else{var m=DataCenter.ins().FashionIdConfig[r].res;m&&(o=m+"_"+t.sex+"_c_png",GlobalModel.bodyBindWeapon&&(o=o.replace(""+WUQI_PREFIX,""+RENWU_PREFIX)))}}this.weaponImg.source=i?appearanceControl.resJobHandler(i,t.job):null,this.bodyImg.source=o?appearanceControl.resJobHandler(o,t.job):null}this.currentState=appearanceControl.getJobUIState(t.job,n||s,l)},e.prototype.setBodyWeaponEff=function(t,e,i,o,n){void 0===n&&(n=0);var r=this[t]=this[t]||new GameMovieClip;i.addChild(r),n&&e.specialEff?(r.x=this[o].x+e.specialOffX||0,r.y=this[o].y+e.specialOffY||0,r.rotation=this[o].rotation,r.scaleX=r.scaleY=e.specialScaling||1,r.playFile(PATH_EFF+e.specialEff,-1)):(r.x=this[o].x+e.offX,r.y=this[o].y+e.offY,r.rotation=this[o].rotation,r.scaleX=r.scaleY=e.scaling||1,r.playFile(PATH_EFF+e.inShowEff,-1))},e.prototype.setSuit=function(t){var e=t instanceof RankSubRoleVo;DisplayUtils.removeFromParent(this.suitEff);var i=e?t.heirloomLv:appearanceControl.checkCanShow(t,0,4);if(i){var o=e?t.heirloomLv:appearanceControl.getEquipEffId(t,0,4);if(o)if(this.suitEff=this.suitEff||new GameMovieClip,this.suitEff.x=this.suitImg.x,this.suitEff.y=this.suitImg.y,this.suitEff.scaleX=this.suitImg.scaleX,this.suitEff.scaleY=this.suitImg.scaleY,!this.suitEff.parent&&this.suitImg.parent&&this.suitImg.parent.addChildAt(this.suitEff,this.suitImg.parent.getChildIndex(this.suitImg)),!e&&t.heirloomDressId){var n=DataCenter.ins().HeirloomillusionConfig[t.heirloomDressId];this.suitEff.playFile(PATH_EFF+n.eff+"n",-1)}else{var r=DataCenter.ins().HeirloomEquipSetConfig[o];this.suitEff.playFile(PATH_EFF+r.neff,-1)}}},e.prototype.setGwWeapons=function(t){DisplayUtils.removeFromParent(this.gwEff);var e=appearanceControl.checkCanShow(t,0,2);if(e){var i=appearanceControl.getEquipEffId(t,0,2);if(i){var o=this.gwEff=this.gwEff||new GameMovieClip;o.x=this["sef"+t.job].x,o.y=this["sef"+t.job].y,o.rotation=this["sef"+t.job].rotation,o.parent||this.soulEff.addChild(o);var n=DataCenter.ins().WeaponSoulConfig[i];o.playFile(PATH_EFF+n.inside[t.job-1],-1)}}},e.prototype.setWing=function(t){var e=t instanceof RankSubRoleVo;DisplayUtils.removeFromParent(this.wingEff);var i=this.wingEff=this.wingEff||new GameMovieClip;this.wingImg.source=null;var o=e?t.pos3:t.zhuangbei[2];if(o>0){var n=DataCenter.ins().FashionIdConfig[o].cost.itemId,r=DataCenter.ins().EquipWithEffConfig[n+"_"+t.sex];if(this.wingImg.visible=r?!1:!0,r){i.parent||this.wingEffect.addChild(i);var a=fashionControl.checkActiveSuit(t);a&&r.specialEff?(this.wingEff.playFile(PATH_EFF+r.specialEff,-1),this.wingEff.scaleX=this.wingEff.scaleY=r.specialScaling||1,this.wingEff.x=r.specialOffX||0,this.wingEff.y=r.specialOffY||0):(this.wingEff.playFile(PATH_EFF+r.inShowEff,-1),this.wingEff.scaleX=this.wingEff.scaleY=r.scaling||1,this.wingEff.x=r.offX||0,this.wingEff.y=r.offY||0)}else this.wingImg.source=DataCenter.ins().FashionIdConfig[o].res+"_png"}else{var s=null;if(e)s=DataCenter.ins().FeatherLevelConfig[t.wingLevel];else{var l=t.wingsData;l.openStatus&&(s=DataCenter.ins().FeatherLevelConfig[l.lv])}s?(this.wingImg.source=s.appearance+"_png",this.wingImg.visible=!0):this.wingImg.source=""}},e.prototype.setLeiTingEffect=function(t){DisplayUtils.removeFromParent(this.ltWeaponEff),DisplayUtils.removeFromParent(this.ltClothesEff);var e=appearanceControl.checkCanShow(t,0,3);if(e){var i=appearanceControl.getEquipEffId(t,0,3);if(i){var o=appearanceControl.getLTEquipEffId(t);this.ltWeaponEff=this.ltWeaponEff||new GameMovieClip;var n=PATH_EFF+"weaponthundereff"+o;4==o?this.playMc(this.ltWeaponEff,n,this["weaponThunderEffShort"+t.sex]):this.playMc(this.ltWeaponEff,n,this["weaponThunderEff"+t.sex])}}if(e=appearanceControl.checkCanShow(t,2,3)){var i=appearanceControl.getEquipEffId(t,2,3);i&&(this.ltClothesEff=this.ltClothesEff||new GameMovieClip,this.playMc(this.ltClothesEff,PATH_EFF+"bodythundereff"+t.sex,this["bodyThunderEff"+t.sex]))}},e.prototype.setDemonCir=function(t){DisplayUtils.removeFromParent(this.deEff),t>0&&(this.deEff=this.deEff||new GameMovieClip,this.playMc(this.deEff,""+PATH_EFF+DataCenter.ins().MagicCirBaseConfig[t].footEff,this.demonCirEff))},e.prototype.playMc=function(t,e,i){t.playFile(e,-1),i.addChild(t)},e.prototype.changeLayer=function(t){var e=this.bodyImg.parent.getChildIndex(this.bodyImg),i=(this.bodyEff.parent.getChildIndex(this.bodyEff),this.bodyEff.parent.getChildIndex(this.bodyThunderEff),this.weaponImg.parent.getChildIndex(this.weaponImg)),o=(this.soulEff.parent.getChildIndex(this.soulEff),this.soulEff.parent.getChildIndex(this.weaponThunderEff),t instanceof RankSubRoleVo),n=fashionControl.checkActiveSuit(o?[t.pos1,t.pos2]:t);t.weaponViewId&&(n=0),n||"nor"!=this.currentState&&!GlobalModel.bodyCoverWeapon(t.job)?e>i&&(this.bodyThunderEff.parent.addChildAt(this.bodyThunderEff,i),this.bodyEff.parent.addChildAt(this.bodyEff,i),this.bodyImg.parent.addChildAt(this.bodyImg,i)):i>e&&(this.weaponThunderEff.parent.addChildAt(this.weaponThunderEff,e),this.soulEff.parent.addChildAt(this.soulEff,e),this.weaponImg.parent.addChildAt(this.weaponImg,e))},e}(BaseItemRender);__reflect(RoleItemRenderer.prototype,"RoleItemRenderer");var FeatherDeityItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FeatherDeityItemRendererSkin",e}return __extends(e,t),e.prototype.setSelect=function(t){this.select.visible=t},e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.itemId=0,this.itemIcon.imgJob.visible=!1,this.itemIcon.imgIcon.source="";var e=t;if(this.data instanceof ItemData){var i=this.data;e=DataCenter.ins().ItemConfig[i.configID],this.count.text=i.count+""}else t.itemId&&(e=DataCenter.ins().ItemConfig[t.itemId]);this.itemIcon.imgIcon.source=e.icon?e.icon+"_png":"",this.nameTxt.text=e.name?e.name:"",this.itemId=e.id,this.itemIcon.imgBg.source="quality"+ItemUtils.getQuality(e),this.nameTxt.textColor=ItemUtils.getQualityColor(e),this.itemIcon.imgIcon.visible=this.itemIcon.imgIcon.source?!0:!1}},e.prototype.setCountVisible=function(t){this.count.visible=t},e.prototype.setNameVisible=function(t){this.nameTxt.visible=t,t||this.setQuality("quality0")},e.prototype.setImgIcon=function(t){this.itemIcon.imgIcon.source=t,this.itemIcon.imgJob.visible=!1,this.itemIcon.imgIcon.visible=this.itemIcon.imgIcon.source?!0:!1},e.prototype.updateRedPoint=function(t){this.redPoint.visible=t},e.prototype.setNameText=function(t){this.nameTxt.text=t},e.prototype.setQuality=function(t){this.itemIcon.imgBg.source=t},e.prototype.destruct=function(){},e}(BaseItemRender);__reflect(FeatherDeityItemRenderer.prototype,"FeatherDeityItemRenderer");var GreetView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GreetViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.validateNow()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.playEff(),smeltControl.checkOpenSystem()&&(this.pic.source="greet1_png")},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];egret.Tween.removeTweens(this.pic)},e.prototype.onTap=function(t){this.sureBtn.visible=!1;var e=egret.Tween.get(this.pic),i=UIMgr.playFun;
if(i&&i.location){var o=i.location;if(o){var n=this,r=o.localToGlobal();this.sureGroup.globalToLocal(r.x,r.y,r),e.to({scaleX:0,scaleY:0,x:r.x,y:r.y},500).call(function(){UIMgr.ins().close(n)})}this.eff&&(DisplayUtils.removeFromParent(this.eff),this.eff=null),promptControl.dispatchWelcome()}},e.prototype.playEff=function(){this.eff||(this.eff=new GameMovieClip,this.eff.x=this.sureGroup.width/2,this.eff.y=this.sureGroup.height/2-5,this.eff.scaleX=this.effgroup.scaleX,this.eff.scaleY=this.effgroup.scaleY,this.sureGroup.addChild(this.eff)),this.eff.playFile(PATH_EFF+"achieveCom",-1)},e}(BaseEuiView);__reflect(GreetView.prototype,"GreetView");var BaseScene=function(){function t(){this._layers=new Array}return t.prototype.onEnter=function(t){void 0===t&&(t=!1),this.showMask=t,this.updateBluntBangs()},t.prototype.updateBluntBangs=function(){this.showMask&&(this.topMask||(this.topMask=new eui.Image(PATH_RES+"bluntBangs.png"),this.topMask.width=580,this.topMask.height=100),StageUtils.ins().getStage().addChildAt(this.topMask,9999),ServerStorage.ins().getBitBool(ClientSetBit.bluntBangs)?this.topMask.y=60-this.topMask.height:DeviceUtils.IsBluntBangs?this.topMask.y=SDKManager.ins().getStatusHeight()-this.topMask.height:this.topMask.y=-this.topMask.height);for(var t=0;t<this._layers.length;t++)this._layers[t].setSafeArea()},t.prototype.onExit=function(){UIMgr.ins().closeAll(),this.removeAllLayer()},t.prototype.addLayer=function(t){t instanceof EuiLayer&&(StageUtils.ins().getUIStage().addChild(t),this._layers.push(t),this.showMask&&t.setSafeArea())},t.prototype.addLayerAt=function(t,e){t instanceof EuiLayer&&(StageUtils.ins().getUIStage().addChildAt(t,e),this._layers.push(t),this.showMask&&t.setSafeArea())},t.prototype.removeLayer=function(t){t instanceof EuiLayer&&(StageUtils.ins().getUIStage().removeChild(t),this._layers.splice(this._layers.indexOf(t),1))},t.prototype.layerRemoveAllChild=function(t){t instanceof EuiLayer&&t.removeChildren()},t.prototype.removeAllLayer=function(){for(;this._layers.length;){var t=this._layers[0];this.layerRemoveAllChild(t),this.removeLayer(t)}this.topMask&&(StageUtils.ins().getStage().removeChild(this.topMask),this.topMask=null)},t}();__reflect(BaseScene.prototype,"BaseScene");var RambleBaseVo=function(){function t(){this.time=0}return t.prototype.setTime=function(t){t?this.time=DateUtils.formatMiniDateTime(t):this.time=0},t.prototype.setNowTime=function(){this.time=GameServer.serverTime},t}();__reflect(RambleBaseVo.prototype,"RambleBaseVo");var RambleMainView=function(t){function e(){var e=t.call(this)||this;return e.resId=["xlt_98","xlt_99"],e.fistOpenGuild=!0,e.uilayer=GameLayer.POPUP,e.isShowLog=!1,e.resident=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RambleMainViewSkin",this.touchEnabled=!1,this.chatList.itemRenderer=RambleListItem2Renderer,this.chatList.itemRendererSkinName="RambleListItem2RendererSkin",this.dataList=new eui.ArrayCollection([]),this.chatList.dataProvider=this.dataList,copyControl.isFBChatChannle()?DisplayUtils.removeFromParent(this.guildMessage):(this.guildMessage.visible=!1,this.guildMessage.scaleX=this.guildMessage.scaleY=.7,egret.Tween.get(this.guildMessage,{loop:!0}).to({scaleX:.8,scaleY:.8},1e3).to({scaleX:.7,scaleY:.7},1e3))},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.message,this.onTap),this.addEventTouchTap(this.chatList,this.onTap),this.addEventTouchTap(this.guildMessage,this.onTap),this.addCustomEvent(227,this.getNewNotice),this.addCustomEvent(386,this.updataList),this.addCustomEvent(226,this.updateNewChatMsg),this.addCustomEvent(642,this.updateChatRed),this.addCustomEvent(353,this.checkShow),this.addCustomEvent(91,this.updateTipShow),this.updataList(),this.updateTipShow(),this.checkShow(),this.bottom=t[0]||0},e.prototype.close=function(){egret.Tween.removeTweens(this.guildMessage)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.message:case this.chatList:UIMgr.ins().open(RambleView);break;case this.guildMessage:UIMgr.ins().open(RambleView,this.guildMessage.name),egret.callLater(this.refTipMsgStatus,this)}},e.prototype.getNewNotice=function(t){7==t.type?(this.rambleTips||(this.rambleTips=new RambleTipsView,this.rambleTips.y=this.message.y+12,this.rambleTips.x=this.message.x+50),this.rambleTips.parent||this.addChildAt(this.rambleTips,0),this.rambleTips.setData(t)):3==t.type&&this.updataList()},e.prototype.updateNewChatMsg=function(){this.fistOpenGuild&&(this.fistOpenGuild=!1,unionControl.guildID&&unionControl.getAllGuildMessage()),this.updataList(),this.updateChatRed()},e.prototype.updateChatRed=function(){this.refTipMsgStatus()},e.prototype.updataList=function(){this.dataList.replaceAll(rambleControl.chatListTip2.concat())},e.prototype.checkShow=function(){var t=MapControl.copyId;this.updataLayer(0!=t),this.updataList()},e.prototype.updataLayer=function(t){t?this.chatGroup.y=616:this.chatGroup.y=546},e.prototype.updateTipShow=function(){this.refTipMsgStatus()},e.prototype.destoryView=function(){t.prototype.destoryView.call(this,!1)},e.prototype.refTipMsgStatus=function(){if(this.guildMessage.visible=unionControl.noReadMsgList.length>0||rambleControl.canKfNoReadTip(),this.guildMessage.visible)if(unionControl.noReadMsgList.length>0&&rambleControl.canKfNoReadTip()){var t=unionControl.noReadMsgList[unionControl.noReadMsgList.length-1].time,e=rambleControl.kfNoReadMsgList[rambleControl.kfNoReadMsgList.length-1].time;t>e?this.guildMessage.name="4":this.guildMessage.name="2"}else unionControl.noReadMsgList.length>0?this.guildMessage.name="4":rambleControl.canKfNoReadTip()&&(this.guildMessage.name="2")},e}(BaseEuiView);__reflect(RambleMainView.prototype,"RambleMainView");var GameLoadingUI=function(t){function e(){var e=t.call(this)||this;return e.maxIndex=10,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.OnAddStage,e),e}return __extends(e,t),e.GetInstance=function(){if(!this.instance)if(GlobalModel.loadingClass){var t=egret.getDefinitionByName(GlobalModel.loadingClass);this.instance=new t}else this.instance=new e;return this.instance},e.prototype.OnAddStage=function(){this.initUI()},e.prototype.initUI=function(){this.bg=new eui.Image;var t=GlobalModel.pfData,e=GlobalModel.notdifferentiate;if(t&&t.startbg?this.bg.source=t.startbg:this.bg.source=PATH_ROOT+"loading/loading.png",e.length>0)for(var i in e)if(GlobalModel.gameId==e[i]){var o=GlobalModel.pfArgs[GlobalModel.pf];o&&o.startbg&&(this.bg.source=o.startbg);break}this.addChild(this.bg),this.bg.x=(this.stage.stageWidth-580)/2,this.progressPane=new egret.DisplayObjectContainer,this.addChild(this.progressPane);var n=new eui.Image;n.source=PATH_ROOT+"loading/hlight.png",n.x=0,n.y=-25,this.messageText=new eui.Label,this.messageText.width=360,this.messageText.height=20,this.messageText.textAlign=egret.HorizontalAlign.CENTER,this.messageText.x=0,this.messageText.y=-20,this.messageText.size=16,this.progressPane.addChild(this.messageText),this.progressPane.addChild(n),this.progressBg1=new eui.Image,this.progressBg1.source=PATH_ROOT+"loading/bar4.png",this.progressBg1.scaleX=-1,this.progressBg1.x=25.5,this.progressBg1.y=25,this.progressPane.addChild(this.progressBg1),this.progressBg2=new eui.Image,this.progressBg2.source=PATH_ROOT+"loading/bar2.png",this.progressBg2.scale9Grid=new egret.Rectangle(12,8,5,5),this.progressBg2.width=310,this.progressBg2.x=10,this.progressBg2.y=this.progressBg1.y+5,this.progressPane.addChild(this.progressBg2),this.progressBg3=new eui.Image,this.progressBg3.source=PATH_ROOT+"loading/bar4.png",this.progressBg3.x=this.progressBg2.x+this.progressBg2.width,this.progressBg3.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg3),this.progress=new eui.Image,this.progress.source=PATH_ROOT+"loading/bar5.png",this.progress.scale9Grid=new egret.Rectangle(8,8,10,3),this.progress.width=0,this.progress.x=11,this.progress.y=32,this.progressPane.addChild(this.progress),this.pgrBg1=new eui.Image,this.pgrBg1.source=PATH_ROOT+"loading/s1.png",this.pgrBg1.scaleX=-1,this.pgrBg1.x=22,this.pgrBg1.y=60,this.progressPane.addChild(this.pgrBg1),this.pgrBg2=new eui.Image,this.pgrBg2.source=PATH_ROOT+"loading/s2.png",this.pgrBg2.scale9Grid=new egret.Rectangle(12,8,5,5),this.pgrBg2.width=297,this.pgrBg2.x=this.pgrBg1.x+this.pgrBg1.width,this.pgrBg2.y=this.pgrBg1.y+2,this.progressPane.addChild(this.pgrBg2),this.pgrBg3=new eui.Image,this.pgrBg3.source=PATH_ROOT+"loading/s1.png",this.pgrBg3.x=this.pgrBg2.x+this.pgrBg2.width,this.pgrBg3.y=this.pgrBg1.y,this.progressPane.addChild(this.pgrBg3),this.pgress=new eui.Image,this.pgress.source=PATH_ROOT+"loading/s0.png",this.pgress.scale9Grid=new egret.Rectangle(8,8,10,0),this.pgress.width=0,this.pgress.height=9,this.pgress.x=12,this.pgress.y=64,this.progressPane.addChild(this.pgress),this.progressText=new eui.Label,this.progressText.width=this.messageText.width,this.progressText.height=20,this.progressText.textAlign=egret.HorizontalAlign.CENTER,this.progressText.x=0,this.progressText.y=32,this.progressText.size=16,this.progressPane.addChild(this.progressText),this.progressPane.x=(this.stage.stageWidth-360)/2,this.progressPane.y=600,this.addLink(LangMgr.getValueByKey("loadingLink"),720),this.setOwnerDes(GlobalModel.ownerDes),this.fakePress(),this.runTips()},e.prototype.fakePress=function(t){var e=this;return this.pgress.width=0,egret.Tween.removeTweens(this.pgress),t?void(this.pgress.width=318):void egret.Tween.get(this.pgress).to({width:318},1e3).call(function(){e.fakePress()})},e.prototype.runTips=function(){this.pgrTipsText||(this.pgrTipsText=new eui.Label,this.pgrTipsText.size=14,this.pgrTipsText.width=this.stage.stageWidth,this.pgrTipsText.height=40,this.pgrTipsText.textAlign="center",this.pgrTipsText.verticalAlign="middle",this.pgrTipsText.lineSpacing=5,this.pgrTipsText.textColor=14207153,this.pgrTipsText.anchorOffsetX=this.stage.stageWidth/2,this.pgrTipsText.x=180,this.pgrTipsText.y=70,this.progressPane.addChild(this.pgrTipsText))},e.prototype.updeteTips=function(){void 0==this.tipsIndex&&(this.tipsIndex=1),this.pgrTipsText.text=LangMgr.getValueByKey("loadingTips"+this.tipsIndex),this.tipsIndex++,this.tipsIndex>this.maxIndex&&(this.tipsIndex=1)},e.prototype.setOwnerDes=function(t){t&&""!=t&&(!this.ownerDes&&this.stage&&(this.ownerDes=new eui.Label,this.ownerDes.size=12,this.ownerDes.width=520,this.ownerDes.textAlign="center",this.ownerDes.verticalAlign="middle",this.ownerDes.textColor=14207153,this.ownerDes.lineSpacing=5,this.addChild(this.ownerDes)),this.ownerDes&&(this.ownerDes.text=t,this.ownerDes.x=(this.stage.stageWidth-this.ownerDes.width)/2,this.ownerDes.y=this.stage.stageHeight-this.ownerDes.height-10))},e.prototype.addLink=function(t,e,i){GlobalModel.isAuditState||(this.refreshTips=new eui.Label,i&&(this.refreshTips.textColor=i),this.refreshTips.textFlow=(new egret.HtmlTextParser).parser(t),this.refreshTips.touchEnabled=!0,this.refreshTips.size=18,this.refreshTips.width=520,this.refreshTips.height=40,this.refreshTips.textAlign="center",this.refreshTips.verticalAlign="middle",this.refreshTips.lineSpacing=5,this.refreshTips.x=(this.stage.stageWidth-this.refreshTips.width)/2,this.refreshTips.y=e,this.addChild(this.refreshTips),this.refreshTips.addEventListener(egret.TextEvent.LINK,this.onLink,this))},e.prototype.onLink=function(){window.location.reload()},e.prototype.show=function(t){void 0===t&&(t=Main.ins()),UIMgr.ins().isShow("StartGameView")||(this.visible=!0,t.addChild(this))},e.prototype.setProgress=function(t,e,i,o){void 0===o&&(o=319);var n=o*t/100;egret.Tween.removeTweens(this.progress),this.posImage&&egret.Tween.removeTweens(this.posImage),i&&i>0?(egret.Tween.get(this.progress).to({width:n},i),this.posImage&&egret.Tween.get(this.posImage).to({x:n+6},i)):(this.progress.width=n,this.posImage&&(this.posImage.x=n+6)),this.progressText.text=Math.floor(t)+"%",this.messageText.text=e,100==t&&this.fakePress(!0)},e.prototype.showLogin=function(){this.loginImg||(this.loginImg=new eui.Image,this.loginImg.source="enter_png",this.loginImg.x=(this.stage.stageWidth-291)/2,this.loginImg.y=this.stage.stageHeight-128-70,this.addChild(this.loginImg),this.loginImg.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this))},e.prototype.onClick=function(t){switch(t.currentTarget){case this.loginImg:SDKManager.ins().SDKLoginNative()}},e.prototype.close=function(){this.visible=!1,this.parent&&this.parent.removeChild(this),this.progress&&egret.Tween.removeTweens(this.progress),this.fakePress(!0),this.hideProgress()},e.prototype.showProgress=function(){this.showState(!0),this.progressPane&&(this.refreshTips.visible=!0,this.progressPane.visible=!0),TimerMgr.ins().doTimerDelay(0,2500,0,this.updeteTips,this)},e.prototype.hideProgress=function(){this.progressPane&&(this.refreshTips.visible=!1,this.progressPane.visible=!1),TimerMgr.ins().remove(this.updeteTips,this)},e.prototype.showState=function(t){this.visible=t},e}(egret.Sprite);__reflect(GameLoadingUI.prototype,"GameLoadingUI");var BaseSystem=function(t){function e(){var e=t.call(this)||this,i=egret.getDefinitionByName(egret.getQualifiedClassName(e));for(var o in i.prototype)if(0==o.indexOf("down")){var n=i.prototype[o];n instanceof Function&&void 0!=n.messageId&&SocketConnection.ins().regHandler(e.protocolsId,n.messageId,n,e,n.decode)}return e.addCustomEvent(3,e.initLogin),e.addCustomEvent(4,e.initZero),e}return __extends(e,t),e.prototype.initLogin=function(){},e.prototype.initZero=function(){},e.prototype.getBytes=function(t){var e=SocketConnection.ins().getBytes();return e.writeCmd(this.protocolsId,t),e},e.prototype.encodeBytes=function(t,e,i){SocketConnection.ins().encodeParam(t,e,i)},e.prototype.sendToServer=function(t){SocketConnection.ins().sendToServer(t)},e.prototype.addCustomEvent=function(t,e){EventMgr.addListener(t,e,this)},e.prototype.removeCustomEvents=function(){EventMgr.ins().removeAll(this)},e.prototype.addCustomEventMany=function(t){for(var e=this,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];for(var n=!1,r=function(){n=!1,t.call(e)},a=function(){n||(n=!0,TimerMgr.ins().doTimer(60,1,r,e))},s=0,l=i;s<l.length;s++){var h=l[s];this.addCustomEvent(h,a)}},e}(SingleClass);__reflect(BaseSystem.prototype,"BaseSystem");var PlatformX7sy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,tokenkey:GlobalModel.getUrlParamValue("tokenkey"),shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverName:t.serverName,gameRoleName:t.roleName,serverId:t.serverId,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,goodsID:t.itemid,productName:t.goodsname,cpOrderID:t.order,count:t.amount,amount:t.fee,extrasParams:t.order,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime,gameSign:t.gameSign,guid:GlobalModel.openID}))},e.prototype.nativeCallback=function(e){var i=Base64.base64decode(e);t.prototype.nativeCallback.call(this,i);var o=JSON.parse(i),n=o.callType;if("init"==n)debug.log("SDK init suc");else if("login"==n)if(0==o.sdkcode){GlobalModel.setUrlParamValue("tokenkey",o.tokenkey),GlobalModel.setUrlParamValue("os",o.os);var r={tokenkey:o.tokenkey,os:o.os,gameVersion:GlobalModel.gameVersion},a=Md5Utils.obj_md5_args(r);debug.log("get UID parm:"+a),PHPConfig.requestPhpData(GlobalModel.sdkDomain+"/"+GlobalModel.pf.toLowerCase()+"/"+GlobalModel.gameId+"/sdkurlcallback",a,function(t){var i=JSON.parse(t.currentTarget.response);console.log("parm:",t.currentTarget.response),1==i.status?(GlobalModel.openID=i.guid,GlobalModel.setUrlParamValue("shellext",i.shellext),SceneMgr.ins().runScene(StartGameScene)):(debug.log("get Account error!!!"),SDKManager.ins().NativeCallback(e))},this,function(t){debug.log("get Account error!!!"),SDKManager.ins().NativeCallback(e)})}else this.SDKLoginNative();else"logout"==n?0==o.sdkcode&&window.location.reload():"switchAccount"==n&&0==o.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformX7sy.prototype,"PlatformX7sy");var PlatformZwH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url="https://tree77.cn/index.php",e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token"),shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("Ziwan loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.getUserInfoComplete=function(t){1001==t.status?(console.log("get suc:",t.info),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.userinfo}))):console.log("get fail",t.info)},e.prototype.getUserInfoIOError=function(t){console.log("request failed",t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="0";e&&(o="1"),i&&(o="2");var n=ActorControl.level,r={userToken:GlobalModel.getUrlParamValue("userToken"),channel_id:GlobalModel.getUrlParamValue("channel_id"),area:GlobalModel.srvname||"",role_name:t.nickName||"",new_role:"1"!=o?"0":o,rank:n,money:ActorControl.yb},a=this.getSign(r),s=JSON.parse(JSON.stringify(r));s.sign=a,console.log("Report info:"+this.getUrl(s)),PHPConfig.requestPhpData(this.url,"g=Home&m=GameOauth&a=roles&"+this.getUrl(s),this.onGetComplete,this,this.onGetIOError,egret.HttpMethod.GET)},e.prototype.onGetComplete=function(t,e,i,o){try{var n=JSON.parse(t.currentTarget.response);1001==n.status?console.log("Report ok"):console.log("Report fail"+n.info)}catch(r){console.log("Report fail"+r)}},e.prototype.onGetIOError=function(t){console.log("Report fail"+t)},e.prototype.ksort=function(t,e,i){var o,n,r,a={},s=[],l=t,h=!1,u={};switch(i){case"SORT_STRING":o=function(t,e){return l.strnatcmp(t,e)};break;case"SORT_LOCALE_STRING":var c=t.i18n_loc_get_default();o=t.php_js.i18nLocales[c].sorting;break;case"SORT_NUMERIC":o=function(t,e){return t+0-(e+0)};break;default:o=function(t,e){var i=parseFloat(t),o=parseFloat(e),n=i+""===t,r=o+""===e;return n&&r?i>o?1:o>i?-1:0:n&&!r?1:!n&&r?-1:t>e?1:e>t?-1:0}}for(r in e)e.hasOwnProperty(r)&&s.push(r);for(s.sort(o),t.php_js=t.php_js||{},t.php_js.ini=t.php_js.ini||{},h=t.php_js.ini["phpjs.strictForIn"]&&t.php_js.ini["phpjs.strictForIn"].local_value&&"off"!==t.php_js.ini["phpjs.strictForIn"].local_value,u=h?e:u,n=0;n<s.length;n++)r=s[n],a[r]=e[r],h&&delete e[r];for(n in a)a.hasOwnProperty(n)&&(u[n]=a[n]);return h||u},e.prototype.getSign=function(t){var e=this.ksort(this,t),i=this.getUrl(e);return EncryptMd5.hex_md5(i+SDKConst.ZiwanAppSecret)},e.prototype.SDKPayNative=function(t){var e={userToken:GlobalModel.getUrlParamValue("userToken"),channel_id:GlobalModel.getUrlParamValue("channel_id"),item_id:t.itemid,orderid:t.order,price:t.fee,other:""},i=this.getSign(e),o=JSON.parse(JSON.stringify(e));o.sign=i,console.log("pay parm："+this.getUrl(o)),PHPConfig.requestPhpData(this.url,"g=Home&m=GameOauth&a=pay_info&"+this.getUrl(o),this.payOnComplete,this,this.payIOError,egret.HttpMethod.GET)},e.prototype.payOnComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?(console.log("pay info get ok"),window.parent.postMessage(e.data,"*")):console.log("pay info get fail"+e.info)}catch(i){console.log("pay fail",i)}},e.prototype.payIOError=function(t){console.log("pay data error"+t)},e.prototype.showSuperVip=function(){return!0},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)debug.log("SDK init ok");else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.uid,GlobalModel.nickName=n.username,GlobalModel.setUrlParamValue("token",GlobalModel.getUrlParamValue("userToken")),GlobalModel.setUrlParamValue("isLogin",n.isLogin);var r=GlobalModel.getUrlParamValue("channel_id");GlobalModel.setUrlParamValue("rawChannelId",r);var a=r;GlobalModel.setUrlParamValue("channelId",a),SceneMgr.ins().runScene(StartGameScene)}else this.SDKLoginNative();else"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformZwH5.prototype,"PlatformZwH5");var EuiLayer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.setSafeArea=function(){ServerStorage.ins().getBitBool(ClientSetBit.bluntBangs)?(this.top=60,this.bottom=0):DeviceUtils.IsBluntBangs?(this.top=SDKManager.ins().getStatusHeight(),this.bottom=SDKManager.ins().getBottomSafeHeight()):this.top=this.bottom=0},e}(BaseLayer);__reflect(EuiLayer.prototype,"EuiLayer");var UnitModel=function(t){function e(){var e=t.call(this)||this;return e.isElite=!1,e.attributeData=[],e.attributeExData=[],e.killNum=0,e.isMy=!1,e.weaponsId=0,e.isWander=!1,e.lyMarkLv=0,e.lyMarkSkills=[],e.fixSkills=[],e.type=2,e}return __extends(e,t),e.prototype.init=function(t){if(this.initBase(t.slice(0,6)),5!=this.type){this.initAtt(t[6]),this.lyMarkLv=t[8],this.lyMarkSkills=[],this.lyMarkSkills.length=t[9].length;for(var e=0;e<t[9].length;e++)this.lyMarkSkills[e]=t[9][e]}},e.prototype.initBase=function(t){this.type=t[0],this.handle=t[1],this.configID=t[2],this.masterHandle=t[3],this.x=t[4],this.y=t[5],this.isMy=this.checkHandleIsMy(this.masterHandle)},e.prototype.initAtt=function(t,e){if(void 0===e&&(e=!1),e)for(var i=0;i<t.length;i++){var o=this.attributeData[i];this.attributeData[i]=t[i];var n=this.attributeData[i]-o;if(o!=this.attributeData[i]&&-1==AttributeData.FILTER_BASE_DATA_ID.lastIndexOf(i)){if(0>=n)continue;if(2>i||i>6){var r=n>0?"35e62d":"f3311e",a=new AttributeData(i,n);if(!AttributeData.getAttrStrByType(a.type))continue;var s="|C:0x"+r+"&T:"+AttributeData.getAttStrByType(a,0)+"|";godWeaponControl.gwshowTips||tipsControl.showTips(s);continue}tipsControl.showAttrTips(i,n)}}else for(var i=0;i<t.length;i++)this.attributeData[i]=t[i]},e.prototype.initExtAtt=function(t,e){if(void 0===e&&(e=!1),e)for(var i=0;i<t.length;i++){var o=this.attributeExData[i];if(this.attributeExData[i]=t[i],o!=this.attributeExData[i]&&-1==AttributeData.FILTER_EXTDATA_ID.lastIndexOf(i)){var n=this.attributeExData[i]-o;if(0>=n)continue;var r=n>0?"35e62d":"f3311e",a=new AttributeData(i,n),s="|C:0x"+r+"&T:"+AttributeData.getExtAttStrByType(a,0)+"|";tipsControl.showTips(s)}}else for(var i=0;i<t.length;i++)this.attributeExData[i]=t[i]},e.prototype.showHuDun=function(){var t=this.huDunEndTime-this.huDunTime,e=DateUtils.formatMiniDateTime(this.huDunTime);return Math.floor((GameServer.serverTime-e)/DateUtils.MS_PER_SECOND)<t?!0:!1},e.prototype.checkHandleIsMy=function(t){if(t==ActorControl.handle)return!0;for(var e=heroControl.roles,i=0,o=e;i<o.length;i++){var n=o[i];if(n.handle==t)return!0}return!1},e.prototype.parserHeirloom=function(){},e.prototype.getAtt=function(t){return this.attributeData[t]||0},e.prototype.setAtt=function(t,e){this.attributeData[t]=e},e.prototype.getExAtt=function(t){return this.attributeExData[t]||0},Object.defineProperty(e.prototype,"avatarFileName",{get:function(){return GUAIWU_PREFIX+this.avatar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weaponFileName",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatar",{get:function(){return this._avatar||DataCenter.ins().MonstersConfig[this.configID].avatar},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name||DataCenter.ins().MonstersConfig[this.configID].headName||DataCenter.ins().MonstersConfig[this.configID].name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weapon",{get:function(){return DataCenter.ins().MonstersConfig[this.configID]?DataCenter.ins().MonstersConfig[this.configID].weapon:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wing",{get:function(){return DataCenter.ins().MonstersConfig[this.configID]?DataCenter.ins().MonstersConfig[this.configID].wing:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return DataCenter.ins().MonstersConfig[this.configID]?DataCenter.ins().MonstersConfig[this.configID].body:null},enumerable:!0,configurable:!0}),e.prototype.getNameWithServer=function(){return this._servId&&crossFieldControl.isCross?this.name+("S"+this._servId):this.name},Object.defineProperty(e.prototype,"serverID",{get:function(){return this._servId},enumerable:!0,configurable:!0}),e.prototype.getDir=function(){var t=DataCenter.ins().MonstersConfig[this.configID];if(!t)return-1;var e=DataCenter.ins().MonstersConfig[this.configID].dir;return isNaN(e)?-1:e},Object.defineProperty(e.prototype,"dirNum",{get:function(){var t=DataCenter.ins().MonstersConfig[this.configID];return t&&(this._dirNum=0/0,t.dirNum)?t.dirNum:this._dirNum?this._dirNum:2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatarScale",{get:function(){var t=this._scale||DataCenter.ins().MonstersConfig[this.configID].scale;return t?t/100:1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"avatarEffect",{get:function(){return DataCenter.ins().MonstersConfig[this.configID]&&DataCenter.ins().MonstersConfig[this.configID].effect?DataCenter.ins().EffectConfig[DataCenter.ins().MonstersConfig[this.configID].effect].fileName:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"attRange",{get:function(){return DataCenter.ins().MonstersConfig[this.configID].attrange?DataCenter.ins().MonstersConfig[this.configID].attrange:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"movePara",{get:function(){return DataCenter.ins().YouDangConfig[this.wandertime]&&this.wanderrange?[this.wanderrange,DataCenter.ins().YouDangConfig[this.wandertime].fileName]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lv",{get:function(){return DataCenter.ins().MonstersConfig[this.configID].level},set:function(t){this._lv=t},enumerable:!0,configurable:!0}),e.prototype.setPos=function(t,e){this.x=t,this.y=e},Object.defineProperty(e.prototype,"isRoleMonster",{get:function(){return!!this.body},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHideBlood",{get:function(){var t=DataCenter.ins().MonstersConfig[this.configID];return t&&t.isHideBlood},enumerable:!0,configurable:!0}),e.getBodyDir=function(t){return void 0===t&&(t=0),0},e.getSceneDir=function(){var t=DataCenter.ins().ScenesConfig[MapControl.mapID];return t.bodyDir||0},e.OtherAttrType=[0,1,2,3,9,25,26],e}(NpcModel);__reflect(UnitModel.prototype,"UnitModel");var UnitMonster=function(t){function e(){var e=t.call(this)||this;return e.AI_STATE=0,e.filterDic={},e.publicCD=0,e.serverEffList={},e.nextPatrolTick=0,e.myKill=!1,e.isShowBody=!0,e.canMove=!1,e.moveRange=-1,e.moveLimTime=-1,e.moveMaxTime=-1,e.touchEnabled=!0,e.touchChildren=!1,e.buffList={},e.buffEff={},e.warnDisplay={},e.statusEffList={},e.extHurmBuff={},e.damageOverTimeList={},e.createTweenObj(),e.effs={},e.addShadow(),e.setShadowType(0),e._hpBar=new eui.ProgressBar,e._hpBar.skinName="bloodBarSkin",e._hpBar.anchorOffsetY=0,e._hpBar.labelDisplay.size=14,e._hpBar.visible=!1,e._hpBar.labelDisplay.visible=!1,e._hpBar.labelFunction=function(){return""},e.titleCantainer.addChild(e._hpBar),e._hpBar.anchorOffsetX=e._hpBar.width>>1,e._nameGroup=new eui.Group,e._nameGroup.touchEnabled=!1,e._nameGroup.height=30,e._nameGroup.width=260,e._nameGroup.anchorOffsetY=Math.floor(e._nameGroup.height+2),e._nameGroup.anchorOffsetX=Math.floor(e._nameGroup.width>>1),e.titleCantainer.addChild(e._nameGroup),e._nameTxt=new eui.Label,e._nameTxt.textAlign="center",e._nameTxt.size=14,e._nameTxt.stroke=1,e._nameTxt.strokeColor=0,e._nameTxt.textColor=15589033,e._nameTxt.bottom=0,e._nameTxt.horizontalCenter=0,e._nameGroup.addChild(e._nameTxt),e._nameGroup.visible=!1,e}return __extends(e,t),e.prototype.createTweenObj=function(){var t=this;this.dieTweenObj={set alpha(e){t.alpha=e},get alpha(){return t.alpha}},this.moveTweenObj={set x(e){t.x=e>>0},set y(e){t.y=e>>0},get x(){return t.x},get y(){return t.y}}},Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){this._infoModel=t,-1!=DataCenter.ins().FlameMarkConfig.monsterId.indexOf(t.configID)?this._lyMark||(this._lyMark=new FlameMarkEffect(this._body,t)):this._lyMark&&this.clearLyMark()},enumerable:!0,configurable:!0}),e.prototype.$onAddToStage=function(e,i){t.prototype.$onAddToStage.call(this,e,i),this.infoModel&&RecycleMgr.ins().reloadContainer(this,!0)},e.prototype.setCharName=function(t){this._nameTxt.textFlow=TextUtils.generateTextFlow(t)},e.prototype.setNameTxtColor=function(t){this._nameTxt.textColor=t},e.prototype.usedLyMarkSkill=function(){this._lyMark&&this._lyMark.usedLyMarkSkill()},e.prototype.playAction=function(e,i){(this._state!=e||this.isAtkAction())&&(!this.hasMaBi&&!this.isHardStraight||e==UnitAction.DIE)&&(e!=UnitAction.HIT&&e!=UnitAction.DIE||2!=this.infoModel.type||!DataCenter.ins().MonstersConfig[this.infoModel.configID]||4!=DataCenter.ins().MonstersConfig[this.infoModel.configID].type&&10!=DataCenter.ins().MonstersConfig[this.infoModel.configID].type)&&t.prototype.playAction.call(this,e,i)},e.prototype.stopMove=function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.canMove=!1,egret.Tween.removeTweens(this.moveTweenObj)},Object.defineProperty(e.prototype,"dir",{get:function(){if(this.infoModel){var t=this.infoModel.getDir();return 0>t?this._dir:t}return this._dir},set:function(t){this._dir==t||this.hasMaBi||this._state!=UnitAction.DIE&&(this._dir=t,this.loadBody())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this._state},set:function(t){this._state!=UnitAction.DIE&&(this._state=t)},enumerable:!0,configurable:!0}),e.prototype.getResDir=function(t){var e=2*(this._dir-4);0>e&&(e=0);var i=this._dir-e;if(this.infoModel&&2!=this.infoModel.dirNum)return i;var o=UnitModel.getBodyDir(1);return 5==o?i:2>i?1:3},Object.defineProperty(e.prototype,"moveSpeed",{get:function(){return this.infoModel?this.infoModel.getAtt(9)/1e3*MapControl.CELL_SIZE:0},enumerable:!0,configurable:!0}),e.prototype.hram=function(t){this._hpBar.value=Math.min(this._hpBar.value-t,this.infoModel.getAtt(2))},e.prototype.getHP=function(){return this._hpBar.value},e.prototype.getRealHp=function(){return this.infoModel.getAtt(0)},e.prototype.reset=function(){this._state=UnitAction.STAND,this.AI_STATE=0,this.dir=4,this._hpBar.slideDuration=500,this.myKill=!1,this.removeAllFilters()},e.prototype.destruct=function(){this.destroy(),ObjectPool.push(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.deadDelay(),this.alpha=1,this.AI_STATE=0,this._nameTxt.textColor=LangMgr.getColor("color41"),this.clearLyMark(),this.removeAllEffect(),this.removeAllFilters(),TimerMgr.ins().removeAll(this),this.stopMove(),DisplayUtils.removeFromParent(this)},e.prototype.deadDelay=function(){this._hpBar.slideDuration=0,this._hpBar.value=0,this.removeHardStraight();for(var t in this.damageOverTimeList){var e=this.damageOverTimeList[t];
this.deleteDamageOverTimer(e)}this.removeAllBuff(),this.atking=!1,this.haloMc&&DisplayUtils.removeFromParent(this.haloMc)},e.prototype.clearLyMark=function(){this._lyMark&&(this._lyMark.destruct(),this._lyMark=null)},e.prototype.addHardStraight=function(t){this.isHardStraight=!0,this.setMcFilterPlayOrStop(!1),TimerMgr.ins().doTimer(t,1,this.removeHardStraight,this)},e.prototype.removeHardStraight=function(){this.isHardStraight=!1,this.setMcFilterPlayOrStop(!0)},e.prototype.updateWarnDisplayPos=function(){var t=this.warnDisplay;for(var e in t)t[e].x=this.x,t[e].y=this.y},e.prototype.initBody=function(t){this.addMc(1,t),RecycleMgr.ins().reloadContainer(this.shadow)},Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this._body.isPlaying},enumerable:!0,configurable:!0}),e.prototype.isAtkAction=function(){return this._state==UnitAction.ATTACK||this._state==UnitAction.CAST},e.prototype.playBody=function(e){t.prototype.playBody.call(this,e)},e.prototype.loadBody=function(){this.isShowBody&&t.prototype.loadBody.call(this)},e.prototype.loadOther=function(e){if(this.isShowBody){if(this.action==UnitAction.DIE){if(1!=e&&2!=e){var i=this.getMc(e);return void(i&&(i.visible=!1))}}else{var o=this.getMc(e);o&&(o.visible=!0)}t.prototype.loadOther.call(this,e)}},e.prototype.loadNoDir=function(e){this.isShowBody&&t.prototype.loadNoDir.call(this,e)},e.prototype.showBodyContainer=function(){if(!this.isShowBody){this.isShowBody=!0,this.addChildAt(this._bodyContainer,1),this.loadBody();for(var t in this._disOrder){var e=+t;this._disOrder[t]instanceof GameMovieClip&&this.hasDir.indexOf(e)<0&&this.loadNoDir(e)}this.updateTitle(),this._lyMark&&this._lyMark.showBall()}},e.prototype.hideBodyContainer=function(){this.isShowBody&&(this.isShowBody=!1,this.removeChild(this._bodyContainer),this.infoModel&&this.updateTitle(),this._lyMark&&this._lyMark.hideBall())},e.prototype.showTitleCantainer=function(){this.titleCantainer.visible=!0},e.prototype.hideTitleCantainer=function(){this.titleCantainer.visible=!1},e.prototype.showShadowCantainer=function(){this.shadow.visible=!0},e.prototype.hideShadowCantainer=function(){this.shadow.visible=!1},e.prototype.getIsShowBody=function(){return this.isShowBody},e.prototype.resetStand=function(){this.isAtkAction()&&this.playAction(UnitAction.STAND)},e.prototype.hasEffById=function(t){return this.effs&&this.effs[t]?!0:!1},e.prototype.updateBlood=function(t){void 0===t&&(t=!1),this.infoModel&&(this._hpBar.maximum=this.infoModel.getAtt(2),(t||!(UnitMgr.ins().getTeamCount(2)>0&&0==MapControl.copyId))&&(this._hpBar.value=this.infoModel.getAtt(0)))},e.prototype.updateTitle=function(){var t=this.infoModel,e=DataCenter.ins().MonstersConfig[t.configID],i=e&&e.titleId;if(this.removeTitle(),e&&6==e.type&&this.showName(!0),this.getIsShowBody()&&i&&i>0){var o=DataCenter.ins().TitleMonsterConfig[i];if(o)if(o.img)null==this._title&&(this._title=new eui.Image,this._title.anchorOffsetX=115,this._title.addEventListener(egret.Event.COMPLETE,this.onTitleLoaded,this),this.titleCantainer.addChild(this._title)),o.anchorOffsetY?this._title.anchorOffsetY=o.anchorOffsetY:this._title.anchorOffsetY=100,this._title.source=o.img;else if(o.eff){null==this._titleMc&&(this._titleMc=ObjectPool.pop("GameMovieClip"),this._titleMc.anchorOffsetX=0,this.titleCantainer.addChild(this._titleMc));var n=PATH_EFF+o.eff;this.playFile(this._titleMc,n),o.anchorOffsetY?this._titleMc.anchorOffsetY=o.anchorOffsetY:this._titleMc.anchorOffsetY=80}}},e.prototype.onTitleLoaded=function(t){t.currentTarget.anchorOffsetX=t.currentTarget.width/2},e.prototype.removeTitle=function(){this._title&&(this._title.source=""),this._titleMc&&(this._titleMc.destroy(),this._titleMc=null)},e.prototype.onDead=function(t){this.stopMove(),this.showBlood(!1),this.showName(!1),this.removeTitle(),5!=this.infoModel.type&&this.playAction(UnitAction.DIE),t&&TimerMgr.ins().doTimer(300,1,t,this)},Object.defineProperty(e.prototype,"isCanAddBlood",{get:function(){return this._hpBar.value/this._hpBar.maximum<.8},enumerable:!0,configurable:!0}),e.prototype.damageOverTime=function(t){var e=t instanceof egret.Timer?t:t.currentTarget;e.currentCount==e.repeatCount&&this.deleteDamageOverTimer(e)},e.prototype.deleteDamageOverTimer=function(t){for(var e in this.damageOverTimeList)this.damageOverTimeList[e]==t&&(delete this.damageOverTimeList[e],t.stop(),t.removeEventListener(egret.TimerEvent.TIMER,this.damageOverTime,this))},e.prototype.addServerEff=function(t,e,i){this.serverEffList[t]={type:e,value:i},this.addEffect(t,e,i)},e.prototype.removeServerEff=function(t){delete this.serverEffList[t],this.removeEffect(t)},e.prototype.addEffect=function(t,e,i){if(this.statusEffList[t]={type:e,value:i},this.updateFilter(),11==e)return void this.initSkillBall(i);var o=DataCenter.ins().EffectConfig[t];if(o){if(0==o.type){var n=new eui.Image;n.source=o.fileName,this.addChild(n);var r=egret.Tween.get(n);return n.x=n.x-23,void r.to({y:-100},2e3).call(function(){DisplayUtils.removeFromParent(n)})}var a=this.effs[t]||ObjectPool.pop("GameMovieClip"),s=PATH_SKILLEFF+o.fileName;this.playFile(a,s),this.addChild(a),this.effs[t]=a}},e.prototype.addHalo=function(t){this.haloMc=this.haloMc?this.haloMc:ObjectPool.pop("GameMovieClip"),this.playFile(this.haloMc,PATH_EFF+t),this.addChildAt(this.haloMc,0)},e.prototype.removeEffect=function(t){if(this.statusEffList[t]){var e=this.statusEffList[t];delete this.statusEffList[t],11==e.type&&(this.playSkillBall(),delete this.extHurmBuff[11]),this.updateFilter()}var i=DataCenter.ins().EffectConfig[t];if(i&&0!=i.type){var o=this.effs[t];o&&(o instanceof GameMovieClip&&o.destroy(),delete this.effs[t])}},e.prototype.removeAllEffect=function(){this.serverEffList={};for(var t in this.statusEffList)this.removeEffect(+t);this.statusEffList={};for(var e in this.effs){var i=this.effs[e];i&&i instanceof GameMovieClip&&i.destroy()}this.effs={}},e.prototype.hasBuff=function(t){return!!this.buffList[t]},e.prototype.addBuff=function(t){var e=t.effConfig,i=e.group,o=this.buffList[i];if(o){if(2==o.effConfig.overlayType){var n=o.multRate+1;n>o.effConfig.overMaxCount&&(n=o.effConfig.overMaxCount),t.multRate=n}this.removeBuff(o)}if(this.buffList[i]=t,e.effName){var r=this.buffEff[i]||ObjectPool.pop("GameMovieClip"),a=PATH_SKILLEFF+e.effName;this.playFile(r,a),1==e.effType?(r.y=-20,this.titleCantainer.addChild(r)):2==e.effType?this.addChildAt(r,0):this.addChild(r),this.buffEff[i]=r}if(e.effID&&(e.args?(this.addEffect(e.effID,e.args.i,e.args.d),11==e.args.i&&(this.extHurmBuff[11]=e.args)):this.addEffect(e.effID)),e.skillEffId&&SkillEffPlayDisplay.play(e.skillEffId,this,[this]),t.effConfig.actionType&&this.playAction(t.effConfig.actionType),4==t.effConfig.type&&t.effConfig.args&&9==t.effConfig.args.i){var s=t.effConfig.duration;this.addHardStraight(s)}this.addGroup(i)},e.prototype.removeBuff=function(t){var e=t.effConfig,i=e.group;if(this.buffList[i]==t&&(t.dispose(),ObjectPool.push(this.buffList[i]),delete this.buffList[i],this.buffEff[i]&&(DisplayUtils.removeFromParent(this.buffEff[i]),delete this.buffEff[i]),e.effID&&7!=e.effID&&this.removeEffect(e.effID),e.unionBuff)){var o=this.buffList[e.unionBuff];o&&this.removeBuff(o)}this.removeGroup(i)},e.prototype.removeAllBuff=function(){for(var t in this.buffList)this.removeBuff(this.buffList[t])},e.prototype.addBubble=function(t){this.bubbleDisplay||(this.bubbleDisplay=new BubblePanel,this.addChildAt(this.bubbleDisplay,100),this.bubbleDisplay.open()),this.bubbleDisplay.anchorOffsetY=170,this.bubbleDisplay.anchorOffsetX=100;var e=this.infoModel.job;this.bubbleDisplay.setSpeak(t,e)},Object.defineProperty(e.prototype,"team",{get:function(){return this._infoModel.team},enumerable:!0,configurable:!0}),e.prototype.startPatrol=function(){if(TimerMgr.ins().getCurrTime()>this.nextPatrolTick){var t=this.getPointCanMove();t&&(MapControl.moveEntity(this,t.x,t.y),this.nextPatrolTick=TimerMgr.ins().getCurrTime()+MathUtils.limit(this.moveLimTime,this.moveMaxTime))}},e.prototype.setMoveAtt=function(t){this.moveRange=t[0],this.moveLimTime=t[1][0],this.moveMaxTime=t[1][1]},e.prototype.getPointCanMove=function(){for(var t,e=0,i=this.moveRange;100>e;){var o=MathUtils.limit(this.x-i>>0,this.x+i>>0),n=MathUtils.limit(this.y-i>>0,this.y+i>>0);if(MapControl.checkWalkableByPixel(o,n)){t=new egret.Point,t.x=o,t.y=n;break}e++}return t},e.prototype.playCount=function(){return this._state==UnitAction.RUN||this._state==UnitAction.STAND?-1:1},e.prototype.shakeIt=function(){var t=this;(this.action==UnitAction.STAND||this.action==UnitAction.HIT)&&(DisplayUtils.shakeItEntity(this,3,200,1),this.moveSpeed&&this.playAction(UnitAction.HIT,function(){t.playAction(UnitAction.STAND)}))},e.prototype.showName=function(t){this._nameGroup.visible=t},e.prototype.showBlood=function(t){t&&this.infoModel&&this.infoModel.name==LangMgr.getValueByKey("charMonsterSS")||t&&this.infoModel&&this.infoModel.isHideBlood||(this._hpBar.visible=t)},Object.defineProperty(e.prototype,"isMy",{get:function(){return this.infoModel.isMy},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weight",{get:function(){return this._infoModel&&0==this.team&&this instanceof UnitRole?this.y+32:this.y},enumerable:!0,configurable:!0}),e.prototype.updateModel=function(){this.removeAll(),this.parseModel()},e.prototype.parseModel=function(){var t=this,e=this.infoModel;0!=e.team&&t.updateBlood(!0),t.setCharName(e.name),e.body?t.initBody(PATH_RENWU+e.body):t.initBody(PATH_GUAIWU+e.avatarFileName),t.setConfig(e.avatar+""),t.updateTitle(),e.avatarEffect&&""!=e.avatarEffect&&t.addHalo(e.avatarEffect),e.movePara&&t.setMoveAtt(e.movePara),t.setBodyScale(e.avatarScale),e.weapon?t.addMc(2,PATH_WUQI+e.weapon):t.removeMc(2),e.wing?t.addMc(3,PATH_CHIBANG+e.wing):t.removeMc(3)},e.prototype.addGroup=function(t){var e=UnitFilterUtils.getUnitFilter(t);if(e){this.filterDic[e]=this.filterDic[e]||[];var i=this.filterDic[e].indexOf(t);-1==i&&(this.filterDic[e].push(t),this.updateFilter())}},e.prototype.removeGroup=function(t){var e=UnitFilterUtils.getUnitFilter(t);if(e){var i=this.filterDic[e];if(!i)return;var o=i.indexOf(t);o>=0&&(i.splice(o,1),this.updateFilter())}},e.prototype.updateFilter=function(){var t=0;this.hasMaBi?t=1:this.hasFilter(2)&&(t=2),this.curFilter!=t&&this.setFilter(t)},e.prototype.hasFilter=function(t){return!(!this.filterDic[t]||!this.filterDic[t].length)},Object.defineProperty(e.prototype,"hasMaBi",{get:function(){return MapControl.sceneInHook()?this.hasFilter(1):BuffModel.hasMabi(this)},enumerable:!0,configurable:!0}),e.prototype.setFilter=function(t){this.curFilter=t,t?(this.setMcFilter(t),1==t?this.setMcFilterPlayOrStop(!1):this.setMcFilterPlayOrStop(!0)):(this.setMcFilter(t),this.setMcFilterPlayOrStop(!0))},e.prototype.setMcFilter=function(t){if("webgl"==egret.Capabilities.renderMode)for(var e in this._disOrder)if(8!=+e){var i=this._disOrder[e];i.filters=t?UnitFilterUtils.getBuffFilter(t):null}},e.prototype.setMcFilterPlayOrStop=function(t){for(var e=0,i=this.hasDir;e<i.length;e++){var o=i[e];if(8!=o){var n=this.getMc(o);n&&(t?n.play():n.stop())}}},e.prototype.removeAllFilters=function(){this.filterDic={},this.curFilter=0;for(var t in this._disOrder){var e=this._disOrder[t];e.filters=null}},e.prototype.setExtTitle=function(t,e,i){void 0===e&&(e=115),null==this._title&&(this._title=new eui.Image,this.titleCantainer.addChild(this._title),this._title.addEventListener(egret.Event.COMPLETE,this.onTitleLoaded,this)),this._title.anchorOffsetX=e,i?this._title.anchorOffsetY=i:this._title.anchorOffsetY=130,this._title.source=t},e.prototype.addScore=function(t,e){void 0===t&&(t=1),void 0===e&&(e=1);var i=-this._title.anchorOffsetY-10;this.addScoreTween(t,e,i)},e.prototype.addScoreTween=function(t,e,i){void 0===t&&(t=1),void 0===e&&(e=1);var o=new eui.Group;o.y=i,this.titleCantainer.addChild(o);var n=new eui.Image;n.x=n.y=0,o.addChild(n);var r=new eui.BitmapLabel;r.x=55,r.y=-2,r.scaleX=r.scaleY=.6,o.addChild(r),1==e?(n.source="cgb_friend_add",r.font="num_score_blue_fnt"):(n.source="cgb_enemy_add",r.font="num_score_red_fnt"),r.text=t+"",o.anchorOffsetX=o.width>>1,egret.Tween.get(o).to({scaleX:1.5,scaleY:1.5},200,egret.Ease.backOut).to({scaleX:1,scaleY:1},100).wait(400).to({y:i-40,alpha:0},800).call(function(t){DisplayUtils.removeFromParent(t)},this,[o])},e.prototype.addTalk=function(t,e){void 0===e&&(e=5e3),this.talkDisplay||(this.talkDisplay=new TalkPanel,this.talkDisplay.setDefSkin(),this.addChildAt(this.talkDisplay,100),this.talkDisplay.open()),this.talkDisplay.anchorOffsetY=170,this.talkDisplay.anchorOffsetX=100,this.talkDisplay.setSpeak(t,e),this.talkDisplay.setScale(this.dir>4?-1:1)},e.prototype.initSkillBall=function(t){(!this.ballMax||this.ballMax<t)&&(this.ballMax=t),this.skillBall?this.ballMax<=t?this.skillBall.reset(t):this.skillBallAct(t):(this.skillBall=new SkillBallMgt(this,this.ballMax),this.skillBall.startRun())},e.prototype.hasSkillBall=function(){return this.skillBall?this.skillBall.getBallNum():0},e.prototype.skillBallReady=function(){return this.skillBall&&this.skillBall.isReady()},e.prototype.playSkillBall=function(){this.skillBall&&(this.removeSkillBall(),this.skillBall.starAddBall(2e4))},e.prototype.removeSkillBall=function(){this.skillBall&&this.skillBall.remove()},e.prototype.skillBallAct=function(t){this.skillBall&&this.skillBall.attackT(null,t)},e}(UnitEffect);__reflect(UnitMonster.prototype,"UnitMonster");var UnitNpc=function(t){function e(){var e=t.call(this)||this;return e.npcHead=new UnitNpcHead,e.npcHead.anchorOffsetY=90,e.npcHead.anchorOffsetX=100,e.npcHead.currentState=e.npcHead.states[0],e.titleCantainer.addChild(e.npcHead),e.touchEnabled=!0,e.touchChildren=!1,e}return __extends(e,t),Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){this._infoModel=t},enumerable:!0,configurable:!0}),e.prototype.playCount=function(){return this._state==UnitAction.RUN||this._state==UnitAction.STAND?-1:1},e.prototype.updateModel=function(){var t=this.infoModel.npcConfig;this.npcHead.nameTxt.text=t.name,this.npcHead.updateModel(this.infoModel),this.x=this.infoModel.x,this.y=this.infoModel.y,this.setConfig(this.infoModel.avatarString),this.dir=this.infoModel.dir,this.playAction(t.action||UnitAction.STAND),this.addMc(1,this.infoModel.avatarFileName),this.infoModel.weaponFileName&&this.addMc(2,this.infoModel.weaponFileName)},e}(UnitEffect);__reflect(UnitNpc.prototype,"UnitNpc");var ByteConst=function(){function t(){}return t.RewardVos=[3,3,3],t.ItemDatas=[10,3,3,[3,3],[3,3]],t.StoreEquipVos=[3,3,3,3].concat(t.ItemDatas),t.EquipVos=[3,3,3].concat(t.ItemDatas,[3,3,3,3]),t.FeatherVos=[3,6,3,6,2,2],t.EmailBaseVos=[3,8,3,3,3],t.EmailDataVos=t.EmailBaseVos.concat([8,t.RewardVos]),t.LimitTaskVos=[3,1],t.WorldBossItemVos=[3,8,8,3,2,1,2,1],t.WorldBossRankItemVos=[3,8,10],t.MeridiansVos=[3,3],t.DragonSoulDataVos=[3,3,3,1],t.HeirloomVos=[[3]],t.MythForgeVos=[[3]],t.WarriorVos=[2,2,2,2,2,3],t.WarriorEquipVos=[1,3,2],t.StoreHadBuyVos=[3,3],t.StoreFeatsVos=[[3,3]],t.HatredVos=[3,11,3,3,3,8,3,8,8,3,3,8,3,3,3],t.HatredMessageVos=[3,3,3,3,8,3],t.CrazyDogVos=[3,2,3,2],t.BargainVos=[1,3,3,3,3,1,1,1],t.BargainKfVos=[3,3,3,3,4],t.BargainRecordVo=[3,8,1,3,3],t.BargainRecordKfVo=[3,3,8,1,3,3],t.SpecialRingDataVos=[2,2,3,1,1],t.RankSubRoleVos=[1,1,3,3,3,3,3,3,3,3,1,1,3,1,3],t.RankPraiseVos=[3,8,10,2,2,2,t.RankSubRoleVos],t.StrideServerDataVos=[3,3,3,3,8,3,3],t.RedEnvelopes=[5,3],t.RedPacketVos=[3,3,3,8,8,1,1],t.PayVos=[2,3,3,3],t.RambleKfBlackVos=[6,3,8,1,1,1,2,6],t.RambleInfoVos=[1,6,3,8,1,1,1,1,1,1,4,2,8,6,8,3],t.DevildomGuildVos=[3,8,1,3],t.DominateVos=[1,[3]],t.UnionMessageInfoVos=[4,8,6,11,3,8,4,4,3,4,4,4,2,8],t.RankGuildInfos=[8,8,3],t.GuildRedRobInfos=[3,8,3],t.MyRankGuildInfos=[3,8,8,3,3,3,3,3],t.WinGuildInfos=[3,8,8,3,1,1,3,3,3,3],t.WarRankInfos=[8,3],t.PointRewarddInfos=[0,3,3],t.PartnerVos=[6,8,8,4,4,4,4,4,4,4,4,4,3,3],t.SoulBoneVos=[1,[3,[3]]],t.BeastVos=[1,[3],1],t.CrossBossInfoVos=[2,2,3,3],t.JadeDataNewVos=[2,2,[3,2]],t.HeatMethodVo=[2,2,1,[3]],t.PeakedKonckReportVos=[3,8,1],t.PeakedKonckReportKfVos=[3,8,3,1],t.PeakedPlayerDataVos=[3,[3]],t.PeakedPlayerInfoVos=[3,8,1,1,1],t.PeakedPlayerInfoKfVos=[3,3,8,1,1,1],t.PeakedPlayerBaseDataVos=[t.PeakedPlayerInfoVos,3,[3]],t.PeakedPlayerBaseDataKfVos=[t.PeakedPlayerInfoKfVos,3,[3]],t.PeakedTopRankVos=[3,8,3,3],t.PeakedBetVos=[1,3,3],t.MineModels=[1,3,8,3,8,4,3,3,0,[3]],t.MineVos=[2,2,2,t.MineModels],t.MineHelpVos=[3,3,8,3,3,3,3,8,3],t.MineRecordVos=[2,1,3,1,3,8,1,11,1,1,1,3],t.CalcForceVos=[3,3,3],t.MagicCircleVos=[1,3,3,1,[[1,3,3]],3,3],t.MagicCircleRoleVos=[1,t.MagicCircleVos,1],t.HeirloomDressVos=[1,1,3],t.ReincarnateStarEquipVos=[4,[4,3,4,[4,2]]],t.CrossArenaMarkVos=[3,3,3],t.CrossArenaRoleVos=[3,3,3,3,3].concat(t.CrossArenaMarkVos,t.CrossArenaMarkVos,[3,3,8,1,1,3,3,3,1,3,3,3,3,3,1,1,3,1,3]),t.CrossArenaInviteVos=[3,8,3,3,3],t.UnionMemberInfoVos=[3,3,3,1,1,8,3,3,3,4,4],t.CrossArenaBaseVos=[3,1,3,8,2,2,2,2,2,2,2,0,0,0,0,0],t.CrossArenaVos=[3,1,3,8,2,2,2,2,2],t.CrossArenaRankVos=[3,3,3,3,8,3,3],t.ReincarnationVos=[3,3,2,2,2],t.BlisterRankVos=[2,8,8,3,3],t.CampWarRankVos=[2,2,8,8,3],t.GodWeaponVos=[3,3,3,3,[3,3],[3,3]],t.GodWeaponDunVos=[3,3,3,3,[3,3]],t.GodWeaponRankInfoVos=[3,8,3],t.GodWeaponTaskVos=[3,3,3,3,3],t.RedPacketRecordVos=[3,3,3,8,1,3,3,1],t.RankDataCommons=[2,3,8,2,2,2,2,[10]],t.RankDataSkirmishVos=[2,3,8,1,1,2,2,2,3,2],t.RankDataPassVos=[2,3,8,10,2,3,2],t.RankDataLevelVos=[2,3,8,2,2,2,2],t.RankDataLadderVos=[3,8,3,3,3,1,1],t.RankDataXiaYiVos=[2,3,8,2,3],t.FashionIds=[3,3,3],t.RoleModels=[3,3,3,3,10,[3],t.EquipVos,[3]].concat(t.FeatherVos,t.MeridiansVos,t.DragonSoulDataVos,[t.ItemDatas],t.HeirloomVos,[3,[[2]],[3],t.ItemDatas,[10],[3],3,2],t.FashionIds,t.MythForgeVos,[[3],1,1,3,1,3,1,3]),t.OtherFireRingDataVos=[3,11,[2,2,2],[2,2],2,[2]],t.ConfrontModelVos=[3,2,2,8,t.RoleModels,t.OtherFireRingDataVos,1,3,3],t.WildPlayers=[3,2,2,2,2,1,1,3,2,2,8,t.RoleModels,t.OtherFireRingDataVos],t.TotemVos=[1,2,[1,3,2]],t.OtherPlayerDatas=[3,3,8,2,2,2,3,10,3,8,3,3,t.RoleModels,[4,2,2,[4,2,3]],[4,4,t.TotemVos],2,3,[2],[2,2,2,2,2,3],[2,[1,3,2]],[[3,3,2]],[[1,1]]],t.UnitModelBases=[2,10,3,10,3,3],t.UnitOtherRoles=[[10],[3],8,3,1,1,3,3,3,3,3,3,3,8].concat(t.FashionIds,[3,2],t.HeirloomVos,[2,1,3,1,3]),t.UnitActors=t.UnitModelBases.slice(),t.UnitRoles=t.UnitModelBases.concat(t.UnitOtherRoles),t.UnitMonsters=t.UnitModelBases.concat([[10],[3],2,[2]]),t.UnitDropItems=t.UnitModelBases.concat(t.RewardVos,[4]),t.CrossDropRecordVos=[2,1,3,3,3,8,8,8,3,8,3],t.AmusementCoverFives=[[],[],[],[],[]],t.AmusementCoverTens=t.AmusementCoverFives.concat(t.AmusementCoverFives),t.AmusementCoverTwentys=t.AmusementCoverTens.concat(t.AmusementCoverTens),t.AmusementCovers=t.AmusementCoverTwentys.concat(t.AmusementCoverTwentys,t.AmusementCoverTwentys,t.AmusementCoverTens,[[],[],[]]),t.AmusementTypeInitBases=[3,3,3,2,3],t.AmusementTypeUpdateBases=[0,3],t.AmusementType1Inits=t.AmusementTypeInitBases.concat([3,3,[2]]),t.AmusementType2Inits=t.AmusementTypeInitBases.concat([[2,2,3,3],3]),t.AmusementType3Inits=t.AmusementTypeInitBases.concat([[2],3,3,3]),t.AmusementType4Inits=t.AmusementTypeInitBases.slice(),t.AmusementType5Inits=t.AmusementTypeInitBases.concat([3]),t.AmusementType6Inits=t.AmusementTypeInitBases.concat([3,[2]]),t.AmusementType7Inits=t.AmusementTypeInitBases.concat([[2,2,2],3]),t.AmusementType8Inits=t.AmusementTypeInitBases.concat([3]),t.AmusementType9Inits=t.AmusementTypeInitBases.concat([3,3,[1],[8,1]]),t.AmusementType10Inits=t.AmusementTypeInitBases.concat([3,3,3,1,[8,10,3]]),t.AmusementType11Inits=t.AmusementTypeInitBases.concat([3,[2,3,1]]),t.AmusementType12Inits=t.AmusementTypeInitBases.concat([3,[2,8,3]]),t.AmusementType13Inits=t.AmusementTypeInitBases.concat([3,[2,2,0],[8,2,2]]),t.AmusementType16Inits=t.AmusementTypeInitBases.concat([0,2,0]),t.AmusementType18Inits=t.AmusementTypeInitBases.concat([3,3,[8,3],[8,3]]),t.AmusementType19Inits=t.AmusementTypeInitBases.slice(),t.AmusementType20Inits=t.AmusementTypeInitBases.concat([3,3,1]),t.AmusementType21Inits=t.AmusementTypeInitBases.slice(),t.AmusementType22Inits=t.AmusementTypeInitBases.concat([3,1,3,[3,3,2,3,1,1],[3,3,2,3]]),t.AmusementType25Inits=t.AmusementTypeInitBases.concat([3]),t.AmusementType26Inits=t.AmusementTypeInitBases.concat([[2,2,0]]),t.AmusementType100Inits=t.AmusementTypeInitBases.slice(),t.AmusementType102Inits=t.AmusementTypeInitBases.concat([3]),t.AmusementType103Inits=t.AmusementTypeInitBases.concat([[1,2]]),t.AmusementType1Updates=t.AmusementTypeUpdateBases.concat([2,3]),t.AmusementType2Updates=t.AmusementTypeUpdateBases.concat([2,3,3,3,3]),t.AmusementType3Updates=t.AmusementTypeUpdateBases.concat([2,3]),t.AmusementType4Updates=t.AmusementTypeUpdateBases.slice(),t.AmusementType5Updates=t.AmusementTypeUpdateBases.concat([2,3]),t.AmusementType6Updates=t.AmusementTypeUpdateBases.concat([2,3]),t.AmusementType7Updates=t.AmusementTypeUpdateBases.concat([2,2,2,2]),t.AmusementType8Updates=t.AmusementTypeUpdateBases.concat([3]),t.AmusementType9Updates=t.AmusementTypeUpdateBases.concat([3,3,[1],[8,1]]),t.AmusementType10Updates=t.AmusementTypeUpdateBases.concat([3,3,3,1,[8,10,3]]),t.AmusementType11Updates=t.AmusementTypeUpdateBases.concat([3,[2,3,1]]),t.AmusementType12Updates=t.AmusementTypeUpdateBases.concat([5,3,3,[2,2,8,3]]),t.AmusementType13Updates=t.AmusementTypeUpdateBases.concat([3,[2,2,0],[8,2,2]]),t.AmusementType16Updates=t.AmusementTypeUpdateBases.concat([0,2,0]),t.AmusementType18Updates=t.AmusementTypeUpdateBases.concat([2,3,3,[3,2]]),t.AmusementType19Updates=t.AmusementTypeUpdateBases.slice(),t.AmusementType20Updates=t.AmusementTypeUpdateBases.concat([3,3]),t.AmusementType21Updates=t.AmusementTypeUpdateBases.slice(),t.AmusementType22Updates=t.AmusementTypeUpdateBases.concat([3,1,3,[3,3,2,3,1,1],[3,3,2,3]]),t.AmusementType25Updates=t.AmusementTypeUpdateBases.concat([2,3]),t.AmusementType26Updates=t.AmusementTypeUpdateBases.concat([[2,2,0]]),t.AmusementType100Updates=t.AmusementTypeUpdateBases.slice(),t.AmusementType102Updates=t.AmusementTypeUpdateBases.slice(),t.AmusementType103Updates=t.AmusementTypeUpdateBases.slice(),t.PAmusementCovers=t.AmusementCoverFives.slice(),t.PAmusementTypeInitBases=t.AmusementTypeInitBases.slice(),t.PAmusementTypeUpdateBases=t.AmusementTypeUpdateBases.slice(),t.PAmusementType1Inits=t.PAmusementTypeInitBases.concat([3,3,[2]]),t.PAmusementType2Inits=t.PAmusementTypeInitBases.concat([[2,2],3]),t.PAmusementType3Inits=t.PAmusementTypeInitBases.concat([[2],3,3,3]),t.PAmusementType9Inits=t.PAmusementTypeInitBases.concat([3,3,[1],[8,1]]),t.PAmusementType1Updates=t.PAmusementTypeUpdateBases.concat([2,3]),t.PAmusementType2Updates=t.PAmusementTypeUpdateBases.concat([2,3,3]),t.PAmusementType3Updates=t.PAmusementTypeUpdateBases.concat([2,3]),t.PAmusementType9Updates=t.PAmusementTypeUpdateBases.concat([3,3,[1],[8,1]]),t}();__reflect(ByteConst.prototype,"ByteConst");var GuideViewBase=function(t){function e(){var e=t.call(this)||this;return e.clickCD=!0,e.otherMc=[],e.rect=new egret.Rectangle(1,1,1,1),e.infoGroup=new eui.Group,e.infoGroup.touchEnabled=!1,e.infoGroup.touchChildren=!1,e.addChild(e.infoGroup),e}return __extends(e,t),e.prototype.drawMask=function(){if(!this.shapeMasks){this.shapeMasks=[];for(var t=0;8>t;t++)this.shapeMasks[t]=new egret.Shape,this.shapeMasks[t].touchEnabled=!0}var e=this.rect,i=e.x,o=e.width,n=StageUtils.ins().getWidth()-e.right,r=e.y,a=e.height,s=StageUtils.ins().getHeight()-e.bottom;this.drawShape(this.shapeMasks[0],new egret.Rectangle(0,0,i,r)),this.drawShape(this.shapeMasks[1],new egret.Rectangle(e.x,0,o,r)),this.drawShape(this.shapeMasks[2],new egret.Rectangle(e.right,0,n,r)),this.drawShape(this.shapeMasks[3],new egret.Rectangle(0,e.topLeft.y,i,a)),this.drawShape(this.shapeMasks[4],new egret.Rectangle(e.bottomRight.x,e.topLeft.y,n,a)),this.drawShape(this.shapeMasks[5],new egret.Rectangle(0,e.bottomRight.y,i,s)),this.drawShape(this.shapeMasks[6],new egret.Rectangle(e.x,e.bottomRight.y,o,s)),this.drawShape(this.shapeMasks[7],new egret.Rectangle(e.right,e.bottomRight.y,n,s))},e.prototype.drawShape=function(t,e){t.graphics.clear(),t.graphics.beginFill(ColorUtils.BLACK,0),t.graphics.drawRect(e.x,e.y,e.width,e.height),t.graphics.endFill(),this.addChild(t)},e.prototype.onResize=function(){if(this.target){var t=this.target.localToGlobal();return(this.rect.x!=t.x||this.rect.y!=t.y||this.rect.width!=this.target.width||this.rect.height!=this.target.height)&&(this.refurbish(),this.drawMask()),!1}},e.prototype.onClick=function(t){var e=this;if(this.rect.contains(t.stageX,t.stageY)){this.clickCD&&(this.clickCD=!1,TimerMgr.ins().doNext(function(){e.dispatchEventWith(egret.Event.CHANGE)},this));for(var i=0;i<this.otherMc.length;i++)egret.Tween.removeTweens(this.otherMc[i]),DisplayUtils.removeFromParent(this.otherMc[i]);this.clicking=!1}else{if(guideControl.clickOut(),this.clicking)return;this.clicking=!0,this.otherMc.length=2;for(var o=function(t){n.otherMc[t]||(n.otherMc[t]=new GameMovieClip),n.otherMc[t].parent||n.addChild(n.otherMc[t]),n.otherMc[t].scaleX=3.3,n.otherMc[t].scaleY=3.3,n.otherMc[t].x=n.infoGroup.x,n.otherMc[t].y=n.infoGroup.y;var e=egret.Tween.get(n.otherMc[t]),i=n;e.wait(240*t).call(function(){i.otherMc[t].playFile(PATH_EFF+"forceguildeff",1,function(){egret.Tween.removeTweens(i.otherMc[t]),DisplayUtils.removeFromParent(i.otherMc[t]),t==i.otherMc.length-1&&(i.clicking=!1)})})},n=this,i=0;i<this.otherMc.length;i++)o(i)}},e.prototype.refurbish=function(){this.show(this.target)},e.prototype.show=function(t){if(null!=t){this.target=t;var e=t.localToGlobal();this.rect.x=e.x,this.rect.y=e.y,this.rect.width=t.width?t.width:60,this.rect.height=t.height?t.height:60,this.drawMask(),this.addChild(this.infoGroup),this.infoGroup.x=e.x+(this.rect.width>>1),this.infoGroup.y=e.y+(this.rect.height>>1);var i=StageUtils.ins().getStage();i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this,!0,0),egret.stopTick(this.onResize,this),egret.startTick(this.onResize,this)}},e.prototype.close=function(){this.target=null,this.rect.x=this.rect.y=this.rect.width=this.rect.height=1;var t=StageUtils.ins().getStage();t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this,!0),egret.stopTick(this.onResize,this)},e}(egret.DisplayObjectContainer);__reflect(GuideViewBase.prototype,"GuideViewBase");var RegressionConfig=function(){function t(){}return t}();__reflect(RegressionConfig.prototype,"RegressionConfig");var HeroControl=function(t){function e(){var e=t.call(this)||this;return e.roles=[],e.jobDic=[],e.isFirstSetAttr=!0,e.isFirstSetExAttr=!0,e.addCustomEvent(12,e.setGuildName),e.addCustomEvent(14,e.setGuildName),e.addCustomEvent(32,e.updateName),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downSubRole=function(t){for(var e=this.subRolesLen,i=0;i<t.length;i++){var o=this.roles[i];o||(o=new RoleModel),o.init(t[i]),this.roles[i]||this.roles.push(o),this.jobDic[o.job]||(this.jobDic[o.job]=o)}e&&e<this.roles.length&&tipsControl.showTips(LangMgr.getValueByKey("subOpenNewRole")),EventMgr.ins().dispatch(352)},e.prototype.downSubRoleAtt=function(t,e,i){for(var o=0,n=this.roles.length,r=0;n>r;r++){var a=this.getSubRoleByIndex(r);a.index==t&&(a.initAtt(e,!this.isFirstSetAttr),a.power=i),o+=a.power}this.isFirstSetAttr=!1,actorControl.dispatchPowerChange(o),godWeaponControl.gwshowTips&&(godWeaponControl.roleshowTips&&godWeaponControl.roleshowTips--,godWeaponControl.roleshowTips<=0&&(godWeaponControl.roleshowTips=0,godWeaponControl.gwshowTips=!1))},e.prototype.downSubRoleExtAtt=function(t,e){for(var i=this.roles.length,o=0;i>o;o++){var n=this.getSubRoleByIndex(o);n.index==t&&n.initExtAtt(e,!this.isFirstSetExAttr)}this.isFirstSetExAttr=!1},e.prototype.getSubRoleByIndex=function(t){return this.roles[t]},e.prototype.getSubRoleByJob=function(t){for(var e=this.roles.length,i=0;e>i;i++){var o=this.getSubRoleByIndex(i);if(o.job==t)return this.roles[i]}return null},Object.defineProperty(e.prototype,"subRolesLen",{get:function(){return this.roles.length},enumerable:!0,configurable:!0}),e.prototype.updateName=function(){for(var t=this.subRolesLen,e=0;t>e;e++){var i=UnitMgr.ins().getMainRole(e);if(i){var o=this.getSubRoleByIndex(e);i.setCharName(o.guildAndName),i.setLilian(o.lilianUrl)}}},e.prototype.setGuildName=function(t){for(var e=t[0],i=t[1],o=this.subRolesLen,n=0;o>n;n++)this.roles[n].guildName=i,this.roles[n].guildID=e;this.updateName()},e.prototype.getIsMyPlayer=function(t){for(var e in this.roles)if(this.roles[e].handle==t)return!0;return!1},e.prototype.isLockRole=function(){for(var t=GlobalModel.roleNum,e=0;t>e;e++){var i=this.getSubRoleByIndex(e);if(!i){var o=DataCenter.ins().RoleNewConfig[e];if(!o)continue;if(o.zsLevel){if(reincarnateControl.lv>=o.zsLevel)return!0}else if(ActorControl.level>=o.level)return!0;if(o.vip&&vipControl.lv>=o.vip)return!0}}return!1},e.prototype.getBaseAttrs=function(t,e){for(var i=[],o={hp:2,atk:4,def:5,res:6},n=0;13>n;n++)if(isNaN(e)||n==e){var r=t.getEquipByIndex(n);if(r&&r.item&&r.item.configID){var a=DataCenter.ins().EquipConfig[r.item.configID],s=[];for(var l in o)a[l]&&s.push(new AttributeData(o[l],a[l]));r.item.att&&(s=AttributeData.AttrAddition(s,r.item.att)),i=AttributeData.AttrAddition(i,s)}}return i},e.prototype.getBaseAttrPercent=function(t,e,i){void 0===i&&(i=!0);for(var o=[],n=0;n<t.length;n++)(2==t[n].type||4==t[n].type||5==t[n].type||6==t[n].type)&&o.push(new AttributeData(t[n].type,t[n].value));for(var n=0;n<o.length;n++)i?o[n].value*=1+e:o[n].value*=e,o[n].value=Math.floor(o[n].value);return o},__decorate([down(2,[ByteConst.RoleModels])],e.prototype,"downSubRole",null),__decorate([down(8,[3,[10],10])],e.prototype,"downSubRoleAtt",null),__decorate([down(27,[3,[3]])],e.prototype,"downSubRoleExtAtt",null),e=__decorate([protocolsId(255)],e)}(BaseSystem);__reflect(HeroControl.prototype,"HeroControl");var DataCenter=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.awaitLoad=function(){return new Promise(function(t){e.loadDone?t():e.awaitLoadResolve=t})},e.addData=function(t){return __awaiter(this,void 0,void 0,function(){var i,o,n;return __generator(this,function(r){switch(r.label){case 0:return GlobalModel.isMangleCfgWeb&&(e.hasMangle=!0,RES.getResByUrl(PATH_ROOT+"mangleCfgResult_Web.json",function(t){t&&(e.mangleCfg=t,e.loadDone=!0,e.awaitLoadResolve&&e.awaitLoadResolve())},this,RES.ResourceItem.TYPE_JSON)),!e.hasMangle||e.loadDone?[3,2]:[4,e.awaitLoad()];case 1:r.sent(),r.label=2;case 2:this.cfgData||(this.cfgData=t),i=function(i){var n=e.mangleCfg&&e.mangleCfg[i]?e.mangleCfg[i]:i;o.cfgData[n]||(o.cfgData[n]=t[i]),Object.defineProperty(o.ins(),n,{get:function(){var t=e.cfgData[n];if("string"==typeof t)try{t=JSON.parse(t),e.cfgData[n]=t}catch(i){ReportData.getIns().reportClientErrorLog("JsonError",n)}return t}})},o=this;for(n in t)i(n);return[2,new Promise(function(t){t()})]}})})},e.hasMangle=!1,e.loadDone=!1,e}(SingleClass);__reflect(DataCenter.prototype,"DataCenter");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function o(o){e.call(i,o,t)}if(RES.hasRes(t)){var n=RES.getRes(t);n?o(n):RES.getResAsync(t,o,this)}else RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,o){function n(t){e.call(o,t)}function r(e){if(e.resItem.url==t){if(s+=1,Assert(!1,"Load default.thm.json fail!!!Count："+s+"."),3>s)return void RES.getResByUrl(t,n,l,RES.ResourceItem.TYPE_TEXT);RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),alert("Skins load fail，Please check the network login again")}}var a=this,s=0,l=this;if("undefined"!=typeof generateEUI2){var h="";if(DeviceUtils.IsWxMiniGame){var u=SDKManager.ins().SDKMiniAuditVer(),c="",p=window.wxMiniName;c=null!=p&&""!=p?"wx_"+p+"_"+u:"wx_"+u,h="resource/"+c+"/gameEui_wxgame.json"}RES.getResByUrl(h,function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(o,generateEUI2)
},a)},this,RES.ResourceItem.TYPE_JSON)}else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var Currency=function(){function t(){}return t.getCurrencyName=function(t){return LangMgr.getValueByKey("currency"+t)},t.getCurrencyRes=function(e){return t.args[e]},t.args={0:"ZSexp",1:"ZSgold",2:"ZScoin",3:"ZSshengwang",4:"ZSlingpo",5:"ZSguildgx",6:"ZSguildfund",7:"ZSchengjiu",8:"ZShonor",9:"500007_png",10:"500008_png",11:"hejisuipian",12:"hejisuipian1",13:"ZSexp",14:"ZSprestige",15:"ZSchip",16:"SSExp"},t}();__reflect(Currency.prototype,"Currency");var ActorControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._level=0,e._power=0,e._gold=0,e._yb=0,e._feats=0,e._togeatter1=-1,e._togeatter2=-1,e._prestigeValue=0,e._chip=0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.downActorInit=function(t,e,o,n,r,a,s,l,h,u,c,p,d,g,f,m,v,y,C,b){i.handle=t,i.actorID=e,GlobalModel.srvid=o,this.dispatchNameChange(n),this._level=r,this._exp=a,this.dispatchGoldChange(l),this.dispatchYbChange(h),vipControl.lv=u,this.dispatchSoulChange(c),backpackControl.bagNum=p,this.dispatchFeatsChange(d),i.runeShatter=g,i.runeExchange=f,this.dispatchUpdateTogeatter(m,1),this.dispatchUpdateTogeatter(v,2),this.dispatchWeiWang(y),this._job=C,reincarnateControl.lv=b,ClientStorage.ins().init(),ServerStorage.ins().isInit&&ServerStorage.ins().initSetting(),SDKManager.ins().SDKEnterGameNative({serverId:GlobalModel.srvid,serverName:GlobalModel.srvname,job:i.job,nickName:i.myName,zsLevel:reincarnateControl.lv,level:i.level,vip:vipControl.lv,power:s}),EventMgr.ins().dispatch(454)},e.prototype.downActorExp=function(t,e,o){var n=this._level;if(this._level=t,this._exp=e,n<this._level){this.dispatchLevelChange(),UnitMgr.ins().updateRoleTitleState(!0);var r=UnitMgr.ins().getNoDieRole();if(r){var a=new GameMovieClip;a.playFile(PATH_EFF+"levelUpEffect",1),r.addChild(a),SDKManager.ins().SDKUserUpgradeNative({serverId:GlobalModel.srvid,serverName:GlobalModel.srvname,job:i.job,nickName:i.myName,zsLevel:reincarnateControl.lv,level:i.level,vip:vipControl.lv})}}EventMgr.ins().dispatch(453,o)},e.prototype.dispatchNameChange=function(t){this._myName!=t&&(this._myName=t),EventMgr.ins().dispatch(455)},e.prototype.dispatchGoldChange=function(t){if(this._gold!=t){if(this._gold>0){var e=t-this._gold;if(e>0){var i=LangMgr.getValueByKey("actorAddMoney",e);tipsControl.showTips(i)}}this._gold=t}EventMgr.ins().dispatch(456)},e.prototype.dispatchYbChange=function(t){if(this._yb!=t){if(this._yb>0){var e=t-this._yb;if(e>0){var i=LangMgr.getValueByKey("actorAddYB",e);tipsControl.showTips(i)}}this._yb=t}EventMgr.ins().dispatch(457)},e.prototype.dispatchFeatsChange=function(t){if(this._feats!=t){if(this._feats>0){var e=t-this._feats,i=parseInt(e.toString());if(i>0){var o=LangMgr.getValueByKey("actorGetGX",i);tipsControl.showTips(o)}}this._feats=t}EventMgr.ins().dispatch(458)},e.prototype.dispatchZsExpChange=function(t){var e=LangMgr.getValueByKey("actorChangeExp",t);tipsControl.showTips(e),EventMgr.ins().dispatch(459)},e.prototype.dispatchUpdateTogeatter=function(t,e){var i=0;if(i=1==e?this._togeatter1:this._togeatter2,i!=t){if(-1!=i){var o=t-i;if(o>0){var n=1==e?Currency.getCurrencyName(11):Currency.getCurrencyName(12),r=LangMgr.getValueByKey("actorGetInfo",o,n);tipsControl.showTips(r)}}i=t}1==e?this._togeatter1=i:this._togeatter2=i,EventMgr.ins().dispatch(460,{value:t,type:e})},e.prototype.dispatchLevelChange=function(){EventMgr.ins().dispatch(461)},e.prototype.dispatchSoulChange=function(t){if(this._soul>0){var e=t-this._soul;if(e>0){var i=LangMgr.getValueByKey("actorGetStone",e);tipsControl.showTips(i)}}this._soul=t,EventMgr.ins().dispatch(462)},e.prototype.dispatchPowerChange=function(t){this._power!=t&&(this._power<t&&this._power>0&&tipsControl.showPowerPromote(this._power),this._power=t),EventMgr.ins().dispatch(463)},e.prototype.dispatchWeiWang=function(t){this._prestigeValue>0&&t-this._prestigeValue>0&&tipsControl.showTips(LangMgr.getValueByKey("actorGetInfo",t-this._prestigeValue,Currency.getCurrencyName(14))),this._prestigeValue=t,EventMgr.ins().dispatch(464)},e.prototype.dispatchChip=function(t){this._chip>0&&t-this._chip>0&&tipsControl.showTips(LangMgr.getValueByKey("actorGetInfo",t-this._chip,Currency.getCurrencyName(15))),this._chip=t,EventMgr.ins().dispatch(465)},Object.defineProperty(e,"level",{get:function(){return this.ins()._level},enumerable:!0,configurable:!0}),Object.defineProperty(e,"job",{get:function(){return this.ins()._job},enumerable:!0,configurable:!0}),Object.defineProperty(e,"exp",{get:function(){return this.ins()._exp},enumerable:!0,configurable:!0}),Object.defineProperty(e,"power",{get:function(){return this.ins()._power},enumerable:!0,configurable:!0}),Object.defineProperty(e,"myName",{get:function(){return this.ins()._myName},enumerable:!0,configurable:!0}),Object.defineProperty(e,"gold",{get:function(){return this.ins()._gold},enumerable:!0,configurable:!0}),Object.defineProperty(e,"yb",{get:function(){return this.ins()._yb},enumerable:!0,configurable:!0}),Object.defineProperty(e,"soul",{get:function(){return this.ins()._soul},enumerable:!0,configurable:!0}),Object.defineProperty(e,"feats",{get:function(){return this.ins()._feats},enumerable:!0,configurable:!0}),Object.defineProperty(e,"togeatter1",{get:function(){return this.ins()._togeatter1<0?0:this.ins()._togeatter1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"togeatter2",{get:function(){return this.ins()._togeatter2<0?0:this.ins()._togeatter2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"samsaraLv",{get:function(){var t=reincarnationControl.samsaraInfo;return t?t.lv:0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"prestige",{get:function(){return this.ins()._prestigeValue},enumerable:!0,configurable:!0}),Object.defineProperty(e,"chip",{get:function(){return this.ins()._chip},enumerable:!0,configurable:!0}),Object.defineProperty(e,"camp",{get:function(){var t=heroControl.getSubRoleByIndex(0);return t.camp},enumerable:!0,configurable:!0}),e.actorID=0,e.runeShatter=0,e.runeExchange=0,__decorate([down(1,[10,3,3,8,3,3,10,7,7,3,7,3,7,7,7,7,7,3,3,3])],e.prototype,"downActorInit",null),__decorate([down(7,[3,3,3])],e.prototype,"downActorExp",null),e=i=__decorate([protocolsId(255)],e);var i}(BaseSystem);__reflect(ActorControl.prototype,"ActorControl");var GameConst=function(){function t(){}return t.FIRE_RING_ID=7,t.FORGE_MAX=8,t.AUTO_GUANQIA=11,t}();__reflect(GameConst.prototype,"GameConst");var IntensifyConst;!function(t){t.FORGE_EQUIP=[0,1,2,3,4,5,6,7],t.EQUIP_POS=[0,1,2,3,4,5,6,7,8,9,10,11,12]}(IntensifyConst||(IntensifyConst={}));var PATH_ROOT="resource/",PATH_MAP="resource/map/",PATH_RES="resource/res/",PATH_EFF="resource/res/texiao/eff/",PATH_WUQI="resource/res/model/wuqi/",PATH_RENWU="resource/res/model/renwu/",PATH_CHIBANG="resource/res/model/chibang/",PATH_GUAIWU="resource/res/model/guaiwu/",PATH_SKILLEFF="resource/res/texiao/skilleff/",PATH_SKILLJSON="resource/res/texiao/skill/",PATH_PUBLIC="tupian/public/",WUQI_PREFIX="wuqi",RENWU_PREFIX="renwu",CHIBANG_PREFIX="chibang",GUAIWU_PREFIX="guaiwu",SkillConst=function(){function t(){}return t.EFF_SKY_BALL=53001,t.BASE_SKILL_INDEX=[11,21,31],t}();__reflect(SkillConst.prototype,"SkillConst");var DamageControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.containers=[],e.imgs=[],e.urlDic={256:"wydEffectIcon",512:["j0z","j4z","j5z"],1024:["j0m_png","j4m_png","j5m_png"]},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.createDamageObj=function(t,e,i,o,n,r,a){void 0===o&&(o=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===a&&(a=!1);var s=this.getContainer();return s.createDamageObj(t,e,i,o,n,r,a),s},e.prototype.getTypeUrl=function(t,e){void 0===e&&(e=1);var i=this.urlDic[t];return i?"string"!=typeof i?i[e-1]:i:void 0},e.prototype.getImage=function(){return this.imgs.pop()||new eui.Image},e.prototype.getContainer=function(){return this.containers.pop()||new DamageContainer},e.prototype.pushImage=function(t){t&&-1==this.imgs.indexOf(t)&&this.imgs.push(t)},e.prototype.pushContainer=function(t){t&&-1==this.containers.indexOf(t)&&this.containers.push(t)},e}(SingleClass);__reflect(DamageControl.prototype,"DamageControl");var DamageContainer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offset=3,e}return __extends(e,t),e.prototype.createDamageObj=function(t,e,i,o,n,r,a){void 0===o&&(o=0),void 0===n&&(n=0),void 0===r&&(r=1),void 0===a&&(a=!1),256==(256&t)&&this.addImage(256,r),1024!=(1024&t)?512==(512&t)&&this.addImage(512,r):a&&2!=(2&t)&&512!=(512&t)&&this.addImage(1024,r),this.addBmpNumber(e,i,o,n),this.resetPosition()},e.prototype.addImage=function(t,e){void 0===e&&(e=1);var i=DamageControl.ins().getTypeUrl(t,e);if(!i)return void debug.log("Damage types:"+t+"No resources set");var o=DamageControl.ins().getImage();o.addEventListener(egret.Event.COMPLETE,this.onLoaded,this),o.width=0/0,o.height=0/0,o.source=i,this.addChild(o)},e.prototype.addBmpNumber=function(t,e,i,o){void 0===i&&(i=0),void 0===o&&(o=0),this.bmpContainer?BitmapNumber.ins().changeNum(this.bmpContainer,t,e,i,o):this.bmpContainer=BitmapNumber.ins().createNumPic(t,e,i,o),this.addChild(this.bmpContainer)},e.prototype.onLoaded=function(t){var e=t.currentTarget;e.removeEventListener(egret.Event.COMPLETE,this.onLoaded,this),this.resetPosition()},e.prototype.resetPosition=function(){for(var t=0,e=0,i=this.numChildren,o=0;i>o;o++){var n=this.getChildAt(o);n.x=t,t+=n.width+this.offset,e=Math.max(e,n.height)}for(var o=0;i>o;o++){var n=this.getChildAt(o);n.y=(e-n.height)/2}this.width=t-this.offset,this.height=e},e.prototype.destroy=function(){for(;this.numChildren;){var t=this.removeChildAt(this.numChildren-1);t instanceof eui.Image?(t.removeEventListener(egret.Event.COMPLETE,this.onLoaded,this),DamageControl.ins().pushImage(t)):t instanceof egret.DisplayObjectContainer&&BitmapNumber.ins().desstroyNumPic(t)}this.bmpContainer=null,DamageControl.ins().pushContainer(this)},e}(egret.DisplayObjectContainer);__reflect(DamageContainer.prototype,"DamageContainer");var DamageDisplay=function(t){function e(){var e=t.call(this)||this;return e.offY=0,e.offsetY=0,e._lastType=0,e.damageNum=50,e.tempdamageViews=[],e.tick=0,e.delayCount=0,e.ignoreLeak=!0,EventMgr.addListener(472,e.showDamage,e),egret.startTick(function(){return e.tick++,!1},e),TimerMgr.ins().doTimer(1e3,0,function(){var t=e.tick;return e.tick=0,e.delayCount<=0?void e.delayCount--:(t>=25?e.damageNum=50:t>=15?e.damageNum=10:t>=10?e.damageNum=5:e.damageNum=0,void(25>t&&(e.delayCount=5)))},e),e}return __extends(e,t),e.prototype.showDamage=function(t){var e=t[0],i=t[1],o=t[2],n=t[3];if(this.tempdamageViews.length>=this.damageNum){var r=this.tempdamageViews[0];r&&(egret.Tween.removeTweens(r),DisplayUtils.removeFromParent(r),this.destroyDamageObj(r))}if(e&&i&&(0==e.team||0==i.team)){0==e.team&&(o=1);var a=64&o&&i.isMy,s=2&o&&!a,l=8&o,h=16&o,u=4&o,c=32&o,p=128&o,d=512&o,g=1024&o&&i.isMy,f=2048&o,m=4096&o,v=8192&o;if(g&&(s||d?s=!1:g=!1),d&&(s=!1),this.offY=UnitMgr.CHAR_DEFAULT_TYPEFACE-e.typeface,this._lastType!=o&&(this.offsetY=0),this._lastType=o,0!=n||u){var y="";if(i instanceof UnitRole)switch(i.infoModel.job){case 1:y="j"+(s||a||g||m?0:1);break;case 2:y="j"+(s||a||g||m?4:2);break;case 3:y="j"+(s||a||g||m?5:3)}else if(i instanceof UnitMonster){var C=DataCenter.ins().MonstersConfig[i.infoModel.configID];C&&6==C.type?y="j2":(y="j3",s=!1,C&&4==C.type&&(y="j9",s=!0))}(h||l)&&(y="j0"),f&&(y="punch",h=0),v&&(y="j0",h=0);var b=0==e.team?"2":y;u&&(b="j0");var T="";T=u?"s":h?0>n?"+"+Math.abs(n):"h"+(n>>0):0>n?"+"+Math.abs(n):(f?"j":s?"b":a?"d":m?"t":v?"u":l?"b":g?"m":"")+(n>>0);var w=0>n?"g3":b,S=3.5;c||p?this.offsetY+=25:this.offsetY=0;var _=this.offsetY,M=DamageControl.ins().createDamageObj(o,T,w,S,_,i.infoModel.job||1,i.isMy);M.touchChildren=!1,h?this.addChildAt(M,1e3):this.addChild(M),M.x=e.x-M.width/2,M.y=e.y-50-_;var I=0>n;"6"==y&&(I=!0),this.floatImg(M,o,e,i,I),this.tempdamageViews.push(M)}}},e.prototype.removeFloatTarget=function(t){DisplayUtils.removeFromParent(t),this.destroyDamageObj(t)},e.prototype.injuredCritLucky=function(t,e){t.scaleX=t.scaleY=1.5;var i=t.y-(UnitMgr.CHAR_DEFAULT_TYPEFACE-80)/2,o=t.y-(UnitMgr.CHAR_DEFAULT_TYPEFACE-30);t.y=i,e.to({y:o,scaleX:1.5,scaleY:1.5},600).wait(200).to({alpha:0,scaleX:1.5,scaleY:1.5},200).call(this.removeFloatTarget,this,[t])},e.prototype.injured=function(t,e){t.scaleX=t.scaleY=1.3;var i=t.y-(UnitMgr.CHAR_DEFAULT_TYPEFACE-80)/2,o=t.y-(UnitMgr.CHAR_DEFAULT_TYPEFACE-30);t.y=i,e.to({y:o,scaleX:1.3,scaleY:1.3},600).wait(200).to({alpha:0,scaleX:1.3,scaleY:1.3},200).call(this.removeFloatTarget,this,[t])},e.prototype.atkCritLucky=function(t,e){var i=0,o=0;t.x+=0,i=t.x+100,o=t.x+120,t.scaleX=t.scaleY=.1,t.y=t.y-120+this.offY,t.alpha=1;var n=t.y-10;e.to({x:i,y:n,scaleX:.8,scaleY:.8,alpha:1},80,egret.Ease.circInOut).to({scaleX:.8,scaleY:.8,alpha:1},200,egret.Ease.circInOut).to({scaleX:.8,scaleY:.8,alpha:.6},200,egret.Ease.sineIn).wait(100).to({alpha:0,y:t.y+10,x:o,scaleX:.6,scaleY:.6},1e3).to({alpha:0,y:t.y+10,scaleX:.1,scaleY:.1},1200,egret.Ease.sineIn).call(this.removeFloatTarget,this,[t])},e.prototype.atkHeJi=function(t,e){var i=0,o=0,n=UIMgr.gameScene.map,r=this.localToGlobal();r.x=StageUtils.ins().getWidth()/2,n.globalToLocal(r.x,r.y,r);var a=100*Math.random()-50,s=200*Math.random()-100;t.x=r.x-100-t.width/2+a,t.x+=0,i=t.x+100,o=t.x+120,t.scaleX=t.scaleY=.1,t.y=t.y-150+this.offY+s,t.alpha=1;var l=t.y-10;e.to({x:i,y:l,scaleX:1.2,scaleY:1.2,alpha:1},80,egret.Ease.circInOut).to({scaleX:1.2,scaleY:1.2,alpha:1},300,egret.Ease.circInOut).to({scaleX:1.2,scaleY:1.2,alpha:.6},200,egret.Ease.sineIn).wait(100).to({alpha:0,y:t.y+-30,x:o,scaleX:1.2,scaleY:1.2},1e3).to({alpha:0,y:t.y+-30,scaleX:1.2,scaleY:1.2},1200,egret.Ease.sineIn).call(this.removeFloatTarget,this,[t])},e.prototype.atk=function(t,e){var i=0,o=0;t.x+=90,i=t.x+0,o=t.x+0,t.scaleX=t.scaleY=1.2,t.y=t.y-100+this.offY,t.alpha=1;var n=t.y-0;e.to({x:i,y:n,scaleX:.4,scaleY:.4,alpha:1},60,egret.Ease.circInOut).to({scaleX:.75,scaleY:.75,alpha:1},80,egret.Ease.circInOut).to({scaleX:.6,scaleY:.6,alpha:.9},80,egret.Ease.sineIn).wait(100).to({alpha:.6,y:t.y+10,x:t.x+-18,scaleX:.6,scaleY:.6},600).to({alpha:.5,y:t.y+13,x:t.x+-20,scaleX:.6,scaleY:.6},200).to({alpha:.4,y:t.y+16,x:t.x+-23,scaleX:.6,scaleY:.6},400).to({alpha:0,y:t.y+20,x:t.x+-30,scaleX:.6,scaleY:.6},400).to({alpha:0,y:t.y+10,scaleX:.6,scaleY:.6},720,egret.Ease.sineIn).call(this.removeFloatTarget,this,[t])},e.prototype.floatImg=function(t,e,i,o,n){var r=egret.Tween.get(t);if(null==o||0==i.team)2==(2&e)||8==(8&e)?this.injuredCritLucky(t,r):this.injured(t,r);else{var a=64==(64&e)&&o&&o.isMy,s=a&&2==(2&e),l=1024==(1024&e)&&o&&o.isMy,h=l&&(2==(2&e)||512==(512&e));h||s||2==(2&e)||8==(8&e)?this.atkCritLucky(t,r):16==(16&e)||2048==(2048&e)?this.atkHeJi(t,r):this.atk(t,r)}},e.prototype.destroyDamageObj=function(t){t.x=0,t.y=0,t.alpha=1,t.scaleX=t.scaleY=1,t.touchChildren=!0,t instanceof DamageContainer?t.destroy():BitmapNumber.ins().desstroyNumPic(t);var e=this.tempdamageViews.indexOf(t);-1!=e&&this.tempdamageViews.splice(e,1)},e}(BaseLeakDisplay);__reflect(DamageDisplay.prototype,"DamageDisplay");var MapControl=function(){function t(){}return t.init=function(t){this.aStar=this.aStar||new AStar,this.mapDatas=t},t.moveEntity=function(e,i,o,n){void 0===n&&(n=!1);var r,a=t.CELL_SIZE,s=Math.floor(e.x/a),l=Math.floor(e.y/a),h=Math.floor(i/a),u=Math.floor(o/a);if(n)r=[new AStarNode(i,o,DirUtils.get8DirBy2Point({x:e.x,y:e.y},{x:i,y:o}))];else if(s==h&&l==u)r=[new AStarNode(h,u,DirUtils.get8DirBy2Point({x:e.x,y:e.y},{x:i,y:o}))];else if(r=this.aStar.findPatch(s,l,h,u),!r){var c="Pathfinding error,mapId:"+t.mapID+",mapName:"+t.getFileName()+",sx:"+s+",sy:"+l+",tx:"+h+",ty:"+u;return void debug.log(c)}gameControl.dispatchMoveEntity(e,r,!n)},t.getPatch=function(t,e,i,o){return this.aStar.findPatch(t,e,i,o)},t.myMoveTo=function(t,e,i,o){for(var n,r=this,a=heroControl.subRolesLen,s=0;a>s;s++)n=UnitMgr.ins().getMainRole(s),n&&this.moveEntity(n,t,e);var l=function(){for(var s=!0,h=0;a>h;h++)n=UnitMgr.ins().getMainRole(h),n&&n.action==UnitAction.RUN&&(MathUtils.getDistance(n.x,n.y,t,e)<100&&(n.stopMove(),n.playAction(UnitAction.STAND)),s=!1);s&&(TimerMgr.ins().remove(l,r),i&&i.call(o))};TimerMgr.ins().doTimer(500,0,l,this)},t.moveTo=function(e,i){var o=t.CELL_SIZE,n=Math.floor(e/o),r=Math.floor(i/o);if(ClientStorage.ins().setValue("mapClickTx",n),ClientStorage.ins().setValue("mapClickTy",r),!this.aStar.isWalkable(n,r))return!1;var a=UnitMgr.ins().getNoDieRole();if(!a)return!1;if(a.hasFilter(1))return tipsControl.showTips(LangMgr.getValueByKey("mapNoMove")),!1;var s=Math.floor(a.x/o),l=Math.floor(a.y/o),h=this.aStar.findPatch(s,l,n,r);if(!h||0==h.length)return!1;var u=h[0];return u.x=e,u.y=i,gameControl.upFindPathToServer(a.infoModel.handle,h,!1),!0},t.parser=function(e,i,o,n,r,a,s){this.lastCopyId=this.copyId,this.copyId=e,this.mapID=i,this.mapX=o,this.mapY=n,this.lastCopyTyp=this.copyType,this.copyType=r,this.copyName=a,this.copyDesc=s;var l=this.getFileName();debug.log("MapId:",this.mapID,"CopyId:",this.copyId,"CopyType:",this.copyType,"MapName:",l);var h=l.substr(3),u=this.mapDatas[h];if("string"==typeof u)try{u=JSON.parse(u),this.mapDatas[h]=u}catch(c){ReportData.getIns().reportClientErrorLog("JsonError",l)}this.CELL_SIZE=u.titleSize,this.MAX_WIDTH=u.mapWidth,this.MAX_HEIGHT=u.mapHeight,this.COL=u.mapCol,this.ROW=u.mapRow,this.aStar.init(u,t.getTurn()),this.initArea()},t.initArea=function(){this.safetyZone={},this.areaData={},this.areaValue={};for(var t=DataCenter.ins().ScenesConfig[this.mapID],e=0;t.area&&e<t.area.length;e++)for(var i=t.area[e],o=i.attr,n=0;n<o.length;n++)switch(o[n].type){case 0:this.safetyZone[e]={},this.areaStore(this.safetyZone[e],i,0);break;case 3:case 5:for(var r=o[n].iparm,a=0;a<r.length;a++)this.areaData[r[a]]={},this.areaStore(this.areaData[r[a]],i,r[a])}},t.areaStore=function(e,i,o){var n=i.grids,r=Number.MAX_VALUE,a=Number.MAX_VALUE,s=Number.MIN_VALUE,l=Number.MIN_VALUE;e.grids={};for(var h=0;h<n.length;h++){for(var u=n[h],c=n.length==h+1?n[0]:n[h+1],p=Bresenham.lineGrids(u.x,u.y,c.x,c.y),d=0;d<p.length;d+=2){var g=p[d],f=p[d+1];e.grids[f*t.CELL_SIZE+g]={x:g,y:f,iparm:i.iparm}}r=Math.min(u.x,r),s=Math.max(u.x,s),a=Math.min(u.y,a),l=Math.max(u.y,l)}e.left=r,e.right=s,e.top=a,e.bottom=l},t.checkSafety=function(t){for(var e in this.safetyZone)if(this.checkAreaById(t,+e,this.safetyZone))return!0;return!1},t.checkAreaById=function(e,i,o){if(o||(o=this.areaData),!o[i])return!1;var n=e.y*t.CELL_SIZE+e.x+"_"+i;if(void 0!=this.areaValue[n])return this.areaValue[n];var r=o[i].left,a=o[i].right,s=o[i].top,l=o[i].bottom;if(e.x<r||e.x>a||e.y<s||e.y>l)return!1;var h=o[i].grids;if(e.y==s||e.y==l)return this.areaValue[n]=!!h[e.y*t.CELL_SIZE+e.x],this.areaValue[n];for(var u=!1,c=e.x;a>=c;c++)if(h[e.y*t.CELL_SIZE+c]){for(var p=0;a-c+2>=p;p++)if(!h[e.y*t.CELL_SIZE+c+p]&&p>0){c+=p;break}u=!u}return this.areaValue[n]=u||!!h[e.y*t.CELL_SIZE+e.x],this.areaValue[n]},Object.defineProperty(t,"copyId",{get:function(){return this._copyId},set:function(t){this._copyId=t,t>0&&gameControl.dispatchHookStateChange(GameControl.HOOK_STATE_HOOK)},enumerable:!0,configurable:!0}),t.sceneInHook=function(){return 0==t.copyType&&0==t.copyId},t.getFileName=function(){var t=DataCenter.ins().ScenesConfig[this.mapID];if(t.filename){var e=[];for(var i in t.filename)e.push(+i);e.sort(function(t,e){return e>=t?0:1});for(var o=GameServer.serverOpenDay+1,n=0;n<e.length;n++)if(o>=e[n]&&(void 0==e[n+1]||e[n+1]>o))return t.filename[e[n]]}return DataCenter.ins().ScenesConfig[this.mapID].mapfilename},t.getTurn=function(){return DataCenter.ins().ScenesConfig[this.mapID].turn},t.autoPunch=function(){return 1==DataCenter.ins().ScenesConfig[this.mapID].autoPunch},t.canHelp=function(){return 1==DataCenter.ins().ScenesConfig[this.mapID].helpBtn&&59!=t.copyType},t.getRectangle=function(e,i,o){var n=e.x+(i-.5)*t.CELL_SIZE,r=e.y+(o-.5)*t.CELL_SIZE;return new egret.Rectangle(n,r,t.CELL_SIZE,t.CELL_SIZE)},t.getIncludeElement=function(e,i,o){var n=[];for(var r in i){var a=t.getRectangle(e,i[r].x,i[r].y);for(var s in o){var l=o[s];l.x>=a.x&&l.y>=a.y&&l.x<a.x+a.width&&l.y<a.y+a.height&&n.push(l)}}return n},t.getPoint=function(t,e,i){var o=Math.floor(t/e)-Math.floor(i/2),n=Math.floor(t%e)-Math.floor(e/2);return new egret.Point(n,o)},t.getTargetIndex=function(e,i,o,n){var r=i.x-e.x+t.CELL_SIZE*(o/2),a=i.y-e.y+t.CELL_SIZE*(n/2),s=Math.floor(r/t.CELL_SIZE),l=Math.floor(a/t.CELL_SIZE);return o*l+s},t.checkWalkableByPixel=function(e,i){var o=Math.floor(e/t.CELL_SIZE),n=Math.floor(i/t.CELL_SIZE);return t.aStar.isWalkable(o,n)},t.getPosRange=function(e,i,o){var n=MathUtils.limitInteger(-o,+o),r=MathUtils.limitInteger(-o,+o);+n!=+o&&(r=Math.random()<.5?-o:o);for(var a=0,s=n,l=r;;){var h=t.aStar.isWalkable(e+s,i+l);if(h)return[e+s,i+l];if(s==o&&o>l?l+=1:l==o&&s>-o?s-=1:s==-o&&l>-o?l-=1:l==-o&&o>s&&(s+=1),s==n&&l==r&&(n==o&&(s=n=o+1),n==-o&&(s=n=-o-1),r==o&&(l=r=o+1),r==-o&&(l=r=-o-1),o+=1),a+=1,a>100)break}return[e,i]},t.getPosRangeByDir=function(e,i,o,n){var r=e,a=i;return(o>=0&&1>=o||7==o)&&(a-=n),o>=3&&5>=o&&(a+=n),o>=1&&3>=o&&(r+=n),o>=5&&7>=o&&(r-=n),[r,a,t.aStar.isWalkable(r,a)]},t.getPosRangeRandom=function(e,i,o,n){void 0===n&&(n=1);var r=t.point2Grip(e),a=t.point2Grip(i),s=[o],l=Math.random();l>.66?(o=0>o-1?7:o-1,s.unshift(o),l>.8?s.push((o+2)%8):s.splice(1,0,(o+2)%8)):l>.33&&(o=o+1>7?0:o+1,s.unshift(o),l>.5?s.push((o-2+8)%8):s.splice(1,0,(o-2+8)%8));for(var h,u=!1,c=0;c<s.length;c++)if(h=t.getPosRangeByDir(r,a,s[c],n),h[2]){u=!0;break}return u||(h=t.getPosRange(r,a,n)),h},t.point2Grip=function(e){return Math.floor(e/t.CELL_SIZE)},t.grip2Point=function(e){return e*t.CELL_SIZE+(t.CELL_SIZE>>1)},t.copyType=0,t.lastCopyTyp=0,t.lastCopyId=0,t}();__reflect(MapControl.prototype,"MapControl");var MapDisplay=function(t){function e(){var e=t.call(this)||this;return e.sceneEff={},e.moveObjDic={},e.ignoreLeak=!0,e.touchEnabled=!0,e.touchChildren=!0,e.addEventListener(egret.TouchEvent.TOUCH_TAP,e.onGridClick,e),egret.startTick(e.onEnterFrame,e),e}return __extends(e,t),e.prototype.initMap=function(){var t=this;this._stepIndex={},this._mapTile=new MapTile,this.addChild(this._mapTile),this._dropItemDisplay=new egret.DisplayObjectContainer,this.addChild(this._dropItemDisplay),this._skillBackDisplay=new egret.DisplayObjectContainer,this.addChild(this._skillBackDisplay),this._entityDisplay=new egret.DisplayObjectContainer,this.addChild(this._entityDisplay),this._dropItemNameDisplay=new egret.DisplayObjectContainer,this.addChild(this._dropItemNameDisplay),this._skillTopDisplay=new egret.DisplayObjectContainer,this.addChild(this._skillTopDisplay),this._damageDisplay=new DamageDisplay,this.addChild(this._damageDisplay),SkillEffPlayDisplay.bottomLayer=this._skillBackDisplay,SkillEffPlayDisplay.topLayer=this._skillTopDisplay,SkillEffPlayDisplay.setTimeout=function(t,e,i){TimerMgr.ins().doTimer(t,1,e,i)},SkillEffPlayDisplay.shake=function(e,i,o,n,r){r=r||1,e==UnitMgr.ins().getMainRole(0)&&Math.random()<r&&DisplayUtils.shakeIt(t._mapTile,i,o,n)},DropControl.init(this._dropItemDisplay,this._dropItemNameDisplay),TimerMgr.ins().doTimer(500,0,this.sortEntity,this)},e.prototype.sortEntity=function(){this._entityDisplay.$children.sort(this.sortF)},e.prototype.sortF=function(t,e){return t.weight>e.weight?1:t.weight<e.weight?-1:0},e.prototype.addEntity=function(t){this._entityDisplay.addChild(t)},e.prototype.removeEntity=function(t){t&&t.parent&&this._entityDisplay.removeChild(t)},e.prototype.moveEntity=function(t){var e=t[0],i=t[1],o=void 0==t[2]?!0:!!t[2];i&&i.length?(this._stepIndex[e.hashCode]=i.length-1,this.moveNextStep(e,i,o)):e.playAction(UnitAction.STAND)},e.moveComplete=function(t){EventMgr.ins().dispatch(6,t)},e.prototype.moveNextStep=function(t,i,o){if(void 0===o&&(o=!0),t.stopMove(),t.action!=UnitAction.DIE){if(this._stepIndex[t.hashCode]<0)return delete this._stepIndex[t.hashCode],t.playAction(UnitAction.STAND),void e.moveComplete(t);var n=i[this._stepIndex[t.hashCode]];if(n){var r={x:0,y:0},a=n.dir;o?(r.x=MapControl.grip2Point(n.x),r.y=MapControl.grip2Point(n.y)):(r.x=n.x,r.y=n.y),a=t instanceof UnitRole||2!=t.infoModel.dirNum?DirUtils.get8DirBy2Point(t,r):DirUtils.get4DirBy2Point(t,r),t.dir=a,t.playAction(UnitAction.RUN),this.moveToPoint(t,r,i,o)}}},e.prototype.moveToPoint=function(t,e,i,o){var n=t==UnitMgr.ins().getNoDieRole(),r=egret.getTimer(),a=this.moveObjDic[t.hashCode],s=0;a&&r>a.total&&(s=a.total-r),t.canMove=!0;var l={x:e.x-t.x,y:e.y-t.y},h=t.moveSpeed/1e3,u=Math.sqrt(l.x*l.x+l.y*l.y),c=u/h;l.x=l.x/c,l.y=l.y/c;var p={entity:t,endPoint:e,vec:l,path:i,isGrid:o,time:r+s,total:r+c+s,isMainRole:n};this.moveObjDic[t.hashCode]=p,0>s&&this.moveObj(p,r),n&&SoundUtils.ins().playRun()},e.prototype.onEnterFrame=function(t){for(var e in this.moveObjDic){var i=this.moveObjDic[e];i.entity.canMove?this.moveObj(this.moveObjDic[e],egret.getTimer()):delete this.moveObjDic[e]}return!1},e.prototype.moveObj=function(t,e){var i=t.entity;if(e>=t.total)i.x=t.endPoint.x,i.y=t.endPoint.y,this.onChange(t),this.onComplete(t);else{var o=e-t.time,n=t.vec.x*o,r=t.vec.y*o;t.time=e,i.x+=n,i.y+=r,this.onChange(t)}},e.prototype.onChange=function(t){var e=t.entity,i=MapControl.point2Grip(e.x),o=MapControl.point2Grip(e.y);e.alpha=MapControl.aStar.isAlpha(i,o)?.7:1,t.isMainRole&&this.lookAt(e.x,e.y)},e.prototype.onComplete=function(t){var e=t.entity.hashCode;this._stepIndex[e]--,this._stepIndex[e]<0&&delete this.moveObjDic[e],this.moveNextStep(t.entity,t.path,t.isGrid)},e.prototype.onGridClick=function(t){EventMgr.ins().dispatch(7,{target:t.target,x:t.stageX-t.currentTarget.x,y:t.stageY-t.currentTarget.y})},e.prototype.lookAt=function(t,e,i){void 0===i&&(i=!1);var o=StageUtils.ins().getWidth(),n=StageUtils.ins().getHeight(),r=this.minValue;this.x=r(t*this.scaleX,o,MapControl.MAX_WIDTH),this.y=r(e*this.scaleY,n,MapControl.MAX_HEIGHT,60),this._mapTile.updateHDMap({x:r(t,o/this.scaleX,MapControl.MAX_WIDTH),y:r(e,n/this.scaleY,MapControl.MAX_HEIGHT,60)},i)},e.prototype.minValue=function(t,e,i,o){return void 0===o&&(o=0),-Math.min(Math.max(t-o-(e>>1),0),i-e)},e.prototype.changeMap=function(){e.DRAW_GRID?this.drawGrid():this._shapeContainer&&this._shapeContainer.parent&&this.removeChild(this._shapeContainer),egret.Tween.removeTweens(this),egret.Tween.removeTweens(this._mapTile),this._mapTile.initThumbnail(MapControl.MAX_WIDTH,MapControl.MAX_HEIGHT,MapControl.getFileName(),MapControl.getTurn());for(var t=DataCenter.ins().ScenesConfig[MapControl.mapID],i=0;t.effPos&&i<t.effPos.length;i++){var o=t.effPos[i];o.type=o.type?o.type:0,this.sceneEff[o.type]=[];for(var n=o.pos.length,r=0;n>r;r++){var a=o.pos[r],s=ObjectPool.pop("GameMovieClip");s.playFile(PATH_EFF+o.eff,-1),s.x=a.x,s.y=a.y,this._skillBackDisplay.addChild(s),this.sceneEff[o.type].push(s)}}this.createNpc(),this.addEvents(),this.lookAt(MapControl.mapX,MapControl.mapY,!0)},e.prototype.addEvents=function(){var t=this;EventMgr.ins().removeAll(this),EventMgr.addListener(367,this.moveEntity,this),EventMgr.addListener(357,function(e){var i=e[0],o=e[1],n=e[2],r=e[3];n==MapControl.mapID&&r==MapControl.copyId&&t.lookAt(i,o)},this),EventMgr.addListener(471,this.adjustMapPos,this)},e.prototype.adjustMapPos=function(){this.x=this.x>>0,this.y=this.y>>0},e.prototype.createNpc=function(){var t=DataCenter.ins().ScenesConfig[MapControl.mapID],e=DataCenter.ins().NpcBaseConfig,i=spokesPersonControl.checkNpcOpen();if(t.npc)for(var o=0;o<t.npc.length;o++)i&&t.insteadNpc&&t.insteadNpc[t.npc[o].id]?UnitMgr.ins().createNpc(t.insteadNpc[t.npc[o].id]):e[t.npc[o].id]&&1==e[t.npc[o].id].isLoopTask||UnitMgr.ins().createNpc(t.npc[o]);if(i){var n=spokesPersonControl.getNpcs();if(n)for(var o=0;o<n.length;o++)UnitMgr.ins().createNpc(n[o])}},e.prototype.drawGrid=function(){var t=this._shape||new egret.Shape;this._shapeContainer=this._shapeContainer||new egret.DisplayObjectContainer,this._shapeContainer.cacheAsBitmap=!0,this._shapeContainer.touchEnabled=!1,this._shapeContainer.touchChildren=!1,t.graphics.clear(),t.graphics.lineStyle(.1);for(var e=MapControl.COL,i=MapControl.ROW,o=0;e>o;o++)for(var n=0;i>n;n++){MapControl.aStar.isAlpha(o,n)?t.graphics.beginFill(ColorUtils.GREEN,.3):MapControl.aStar.isWalkable(o,n)?t.graphics.beginFill(LangMgr.getColor("color47"),.3):t.graphics.beginFill(ColorUtils.RED,.3),t.graphics.drawRect(o*MapControl.CELL_SIZE,n*MapControl.CELL_SIZE,MapControl.CELL_SIZE,MapControl.CELL_SIZE),t.graphics.endFill();var r=new eui.Label;r.size=12,r.text=o+","+n,r.x=o*MapControl.CELL_SIZE,r.y=n*MapControl.CELL_SIZE,this._shapeContainer.addChild(r)}this._shapeContainer.addChild(t),this.addChild(this._shapeContainer),this._shape=t},e.prototype.clearAllLayer=function(){this._skillBackDisplay.removeChildren(),this._skillTopDisplay.removeChildren(),this._damageDisplay.removeChildren(),this._entityDisplay.removeChildren()},e.DRAW_GRID=!1,e}(BaseLeakDisplay);__reflect(MapDisplay.prototype,"MapDisplay");var MapTile=function(t){function e(){var e=t.call(this)||this;e.lastUpdateX=0,e.lastUpdateY=0,e.turn=0,e.touchChildren=!1,e.touchEnabled=!1,e._imageList=[],e.showImages=[],e._poolImages=[],e._fileDic={};var i=new eui.Image;return e.addChild(i),e.thumbnail=i,e.thumbnail.addEventListener(egret.Event.COMPLETE,e.onThumbnailComplete,e),e}return __extends(e,t),e.prototype.destructor=function(){this.thumbnail.removeEventListener(egret.Event.COMPLETE,this.onThumbnailComplete,this),this.removeChildren(),this._imageList.length=0},e.prototype.onThumbnailComplete=function(t){this.isThumbnailComplete=!0,t.target&&t.target.name==this.mapName&&this.updateHDMap({x:this.lastUpdateX,y:this.lastUpdateY},!0)},e.prototype.initThumbnail=function(t,e,i,o){this.mapName!=i&&(this.isThumbnailComplete=!1),(this.mapName!=i||this.turn!=o)&&this.clearHDMap(),this.mapName!=i&&this.destroyFile(),this.mapName=i,this.turn=o,this.thumbnail.width=t,this.thumbnail.height=e;var n=""+PATH_MAP+this.mapName+"/small.jpg";this.thumbnail.source=n,this.thumbnail.scaleX=o?-1:1,this.thumbnail.x=o?t:0,this.thumbnail.name=this.mapName,RES.hasRes(n)&&(this.isThumbnailComplete=!0);var r=256;this.maxImagX=Math.floor(t/r),this.maxImagY=Math.floor(e/r),this.updateHDMap({x:this.lastUpdateX,y:this.lastUpdateY},!0)},e.prototype.clearHDMap=function(){this._imageList=[],this.showImages=[],this.removeChildren(),this.addChild(this.thumbnail)},e.prototype.destroyFile=function(){RecycleMgr.ins().destroyMapFile(this._fileDic),this._fileDic={}},e.prototype.getImage=function(){return this._poolImages.pop()||new eui.Image},e.prototype.updateHDMap=function(t,e){void 0===e&&(e=!1);var i=256;if(e||Math.abs(this.lastUpdateX-t.x)>i/4||Math.abs(this.lastUpdateY-t.y)>i/4||0==this.lastUpdateX){if(this.lastUpdateX=t.x,this.lastUpdateY=t.y,!this.isThumbnailComplete)return;var o=[],n=StageUtils.ins().getWidth(),r=StageUtils.ins().getHeight(),a=Math.max(Math.floor(-t.x/i-.5),0),s=Math.max(Math.floor(-t.y/i-.5),0),l=a+Math.ceil(n/i+.5),h=s+Math.ceil(r/i+.5);if(this.turn)for(var u=a;l>=u&&u<this.maxImagX;u++)for(var c=this.maxImagX-u>0?this.maxImagX-u-1:0,p=s;h>=p&&p<this.maxImagY;p++){if(this._imageList[p]=this._imageList[p]||[],this._imageList[p][c])this._imageList[p][c].parent||this.addChild(this._imageList[p][c]);else{var d=""+PATH_MAP+this.mapName+"/image/"+p+"_"+c+".jpg";this._fileDic[d]=1;var g=this.getImage();g.source=d,g.name=d,g.scaleX=-1,g.x=(u+1)*i,g.y=p*i,this.addChild(g),this._imageList[p][c]=g}o.push(this._imageList[p][c])}else for(var u=a;l>=u&&u<this.maxImagX;u++)for(var p=s;h>=p&&p<this.maxImagY;p++){if(this._imageList[p]=this._imageList[p]||[],this._imageList[p][u])this._imageList[p][u].parent||this.addChild(this._imageList[p][u]);else{var d=""+PATH_MAP+this.mapName+"/image/"+p+"_"+u+".jpg";this._fileDic[d]=1;var g=this.getImage();
g.source=d,g.name=d,g.x=u*i,g.y=p*i,this.addChild(g),this._imageList[p][u]=g}o.push(this._imageList[p][u])}for(var f=this.showImages.length,u=f-1;u>=0;u--)o.indexOf(this.showImages[u])>=0||DisplayUtils.removeFromParent(this.showImages[u]);this.showImages=o}},e}(egret.DisplayObjectContainer);__reflect(MapTile.prototype,"MapTile");var AnimaMgr=function(){function t(){}return t.play=function(e,i,o){if(!t.checkObj(e))return void(o&&"function"==typeof o.func&&o.func());var n,r=egret.getQualifiedClassName(e);switch(r){case"eui.Button":n=e;break;case"eui.ToggleButton":n=e;break;case"eui.Image":n=e;break;case"eui.Group":n=e;break;case"eui.Rect":n=e;break;case"BaseComponent":n=e;break;case"eui.TabBar":n=e;break;default:n=e}if(n){egret.Tween.removeTweens(n);var a=0/0,s=0/0,l=0/0,h=0/0,u=0/0,c=0/0,p=0/0,d=0/0,g=0/0,f=0/0,m=0/0,v=0/0,y=0/0,C=0/0,b=0/0,T=0/0,w=0/0,S=0/0,_=0/0,M=0/0,I=0/0,D=0/0;switch(i){case t.ANITYPE_FADEIN_LEFT_HOR:isNaN(n.left)||(s=n.left-t.diff,p=n.left),isNaN(n.horizontalCenter)||(l=n.horizontalCenter-t.diff,d=n.horizontalCenter),isNaN(n.right)||(h=n.right+t.diff,g=n.right),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.x)||(a=n.x-t.diff,c=n.x),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_FADEIN_RIGHT_HOR:isNaN(n.left)||(s=n.left+t.diff,p=n.left),isNaN(n.horizontalCenter)||(l=n.horizontalCenter+t.diff,d=n.horizontalCenter),isNaN(n.right)||(h=n.right-t.diff,g=n.right),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.x)||(a=n.x+t.diff,c=n.x),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_FADEIN_UP_VER:isNaN(n.top)||(v=n.top-t.diff,w=n.top),isNaN(n.verticalCenter)||(y=n.verticalCenter-t.diff,S=n.verticalCenter),isNaN(n.bottom)||(C=n.bottom+t.diff,_=n.bottom),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.y)||(m=n.y-t.diff,T=n.y),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_FADEIN_DOWN_VER:isNaN(n.top)||(v=n.top+t.diff,w=n.top),isNaN(n.verticalCenter)||(y=n.verticalCenter+t.diff,S=n.verticalCenter),isNaN(n.bottom)||(C=n.bottom-t.diff,_=n.bottom),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.y)||(m=n.y+t.diff,T=n.y),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_IN_LEFT_HOR:isNaN(n.left)||(s=n.left-n.width,p=n.left),isNaN(n.horizontalCenter)||(l=n.horizontalCenter-n.width,d=n.horizontalCenter),isNaN(n.right)||(h=n.right+n.width,g=n.right),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.x)||(a=n.x-n.width,c=n.x),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_IN_RIGHT_HOR:isNaN(n.left)||(s=n.left+n.width,p=n.left),isNaN(n.horizontalCenter)||(l=n.horizontalCenter+n.width*t.hroWidh,d=n.horizontalCenter),isNaN(n.right)||(h=n.right-n.width*t.hroWidh,g=n.right),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.x)||(a=n.x+n.width*t.hroWidh,c=n.x),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_IN_UP_VER:isNaN(n.top)||(v=n.top-n.height,w=n.top),isNaN(n.verticalCenter)||(y=n.verticalCenter-n.height,S=n.verticalCenter),isNaN(n.bottom)||(C=n.bottom+n.height,_=n.bottom),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.y)||(m=n.y-n.height,T=n.y),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_IN_DOWN_VER:isNaN(n.top)||(v=n.top+n.height,w=n.top),isNaN(n.verticalCenter)||(y=n.verticalCenter+n.height,S=n.verticalCenter),isNaN(n.bottom)||(C=n.bottom-n.height,_=n.bottom),isNaN(n.alpha)||(I=0,D=n.alpha),isNaN(n.y)||(m=n.y+n.height,T=n.y),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_OUT_LEFT_HOR:isNaN(n.left)||(s=n.left,p=n.left-n.width),isNaN(n.horizontalCenter)||(l=n.horizontalCenter,d=n.horizontalCenter-n.width),isNaN(n.right)||(h=n.right,g=n.right+n.width),isNaN(n.alpha)||(I=n.alpha,D=0),isNaN(n.x)||(a=n.x,c=n.x-n.width),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_OUT_RIGHT_HOR:isNaN(n.left)||(s=n.left+n.width,p=n.left),isNaN(n.horizontalCenter)||(l=n.horizontalCenter,d=n.horizontalCenter+n.width*t.hroWidh),isNaN(n.right)||(h=n.right,g=n.right-n.width*t.hroWidh),isNaN(n.alpha)||(I=n.alpha,D=0),isNaN(n.x)||(a=n.x,c=n.x+n.width*t.hroWidh),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_OUT_UP_VER:isNaN(n.top)||(v=n.top,w=n.top-n.height),isNaN(n.verticalCenter)||(y=n.verticalCenter,S=n.verticalCenter-n.height),isNaN(n.bottom)||(C=n.bottom,_=n.bottom+n.height),isNaN(n.alpha)||(I=n.alpha,D=0),isNaN(n.y)||(m=n.y,T=n.y-n.height),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_OUT_DOWN_VER:isNaN(n.top)||(v=n.top,w=n.top+n.height),isNaN(n.verticalCenter)||(y=n.verticalCenter,S=n.verticalCenter+n.height),isNaN(n.bottom)||(C=n.bottom,_=n.bottom-n.height),isNaN(n.alpha)||(I=n.alpha,D=0),isNaN(n.y)||(m=n.y,T=n.y+n.height),isNaN(n.scaleX)||(u=n.scaleX,f=n.scaleX),isNaN(n.scaleY)||(b=n.scaleY,M=n.scaleY);break;case t.ANITYPE_IN_SCALE_VER:isNaN(n.scaleX)||(u=.5,f=n.scaleX),isNaN(n.scaleY)||(b=.5,M=n.scaleY);break;case t.ANITYPE_OUT_SCALE_VER:isNaN(n.scaleX)||(u=n.scaleX,f=0),isNaN(n.scaleY)||(b=n.scaleY,M=0)}a=a?a:n.x,s=s?s:n.left,l=l?l:n.horizontalCenter,h=h?h:n.right,u=u?u:n.scaleX,c=c?c:n.x,p=p?p:n.left,d=d?d:n.horizontalCenter,g=g?g:n.right,f=0==f?f:n.scaleX,m=m?m:n.y,v=v?v:n.top,y=y?y:n.verticalCenter,C=C?C:n.bottom,b=b?b:n.scaleY,T=T?T:n.y,w=w?w:n.top,S=S?S:n.verticalCenter,_=_?_:n.bottom,M=0==M?M:n.scaleY,I=0==I?I:n.alpha,D=0==D?D:1,t.aniStartEUI(n,{sx:a,sxleft:s,sxhro:l,sxright:h,ex:c,exleft:p,exhro:d,exright:g,sy:m,sytop:v,syver:y,sybot:C,ey:T,eytop:w,eyver:S,eybot:_,salpha:I,ealpha:D,sxscaleX:u,exscaleX:f,syscaleY:b,eyscaleY:M},o)}},t.aniStartEUI=function(e,i,o){e.x=i.sx,e.left=i.sxleft,e.horizontalCenter=i.sxhro,e.right=i.sxright,e.y=i.sy,e.top=i.sytop,e.verticalCenter=i.syver,e.bottom=i.sybot,e.alpha=i.salpha,e.scaleX=i.sxscaleX,e.scaleY=i.syscaleY;var n=egret.Tween.get(e),r=o&&o.time?o.time:t.time,a=o&&o.ease?o.ease:t.Egret_Ease;n.to({x:i.ex,left:i.exleft,horizontalCenter:i.exhro,right:i.exright,y:i.ey,top:i.eytop,verticalCenter:i.eyver,bottom:i.eybot,alpha:i.ealpha,scaleX:i.exscaleX,scaleY:i.eyscaleY},r,a).call(function(){e.x=i.ex,e.left=i.exleft,e.horizontalCenter=i.exhro,e.right=i.exright,e.y=i.ey,e.top=i.eytop,e.verticalCenter=i.eyver,e.bottom=i.eybot,e.alpha=i.ealpha,e.scaleX=i.exscaleX,e.scaleY=i.eyscaleY,t.cleanObj(e),egret.Tween.removeTweens(e),o&&"function"==typeof o.func&&o.func()})},t.checkObj=function(e){return t.aniMap[e.hashCode]?!1:(t.aniMap[e.hashCode]=e,!0)},t.cleanObj=function(e){t.aniMap[e.hashCode]&&delete t.aniMap[e.hashCode]},t.ANITYPE_FADEIN_LEFT_HOR=1,t.ANITYPE_FADEIN_RIGHT_HOR=2,t.ANITYPE_FADEIN_UP_VER=3,t.ANITYPE_FADEIN_DOWN_VER=4,t.ANITYPE_IN_LEFT_HOR=5,t.ANITYPE_IN_RIGHT_HOR=6,t.ANITYPE_IN_UP_VER=7,t.ANITYPE_IN_DOWN_VER=8,t.ANITYPE_OUT_LEFT_HOR=9,t.ANITYPE_OUT_RIGHT_HOR=10,t.ANITYPE_OUT_UP_VER=11,t.ANITYPE_OUT_DOWN_VER=12,t.ANITYPE_IN_SCALE_VER=13,t.ANITYPE_OUT_SCALE_VER=14,t.diff=50,t.time=200,t.Egret_Ease=egret.Ease.backInOut,t.aniMap={},t.hroWidh=1.5,t}();__reflect(AnimaMgr.prototype,"AnimaMgr");var EntrustMgr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isStart=!1,e.taskDic={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.start=function(){this.isStart||(this.isStart=!0,this.addCustomEvent(9,this.transferComplete))},e.prototype.stop=function(){this.taskDic={},this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.regEntrusTask=function(t,e,i){if(!Assert(!this.taskDic[0],"There is currently a delegate transfer task！ value="+e))switch(this.start(),t){case 0:this.transferTask(e,i)}},e.prototype.cancelEntrusTask=function(t){this.taskDic[t]=null,delete this.taskDic[t]},e.prototype.transferTask=function(t,e){this.taskDic[0]={doFun:t,callobj:e}},e.prototype.transferComplete=function(){var t=this.taskDic[0];t&&(t.doFun instanceof Function?(t.callobj?t.doFun.bind(t.callobj)():t.doFun(),this.cancelEntrusTask(0)):!isNaN(this.taskDic[0]))},e}(BaseSystem);__reflect(EntrustMgr.prototype,"EntrustMgr");var SwitchMgr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkOpen=function(t,e){void 0===e&&(e=!1);var i=DataCenter.ins().OpenSystemConfig[t],o=!1,n=!0,r=!0,a=!0,s=!0,l=!0,h="";return i&&(i.judge?(this.checkExtData(i),i.than?(i.openzs&&(n=reincarnateControl.lv<=i.openzs),i.openday&&(r=GameServer.serverOpenDay<=i.openday-1),i.recharge&&(a=vipControl.exp<=i.recharge),i.opencheck&&(s=copyControl.guanqiaID<=i.opencheck),i.openlevel&&(l=ActorControl.level<=i.openlevel)):(i.openzs&&(n=reincarnateControl.lv>=i.openzs,n||(h+=LangMgr.getValueByKey("zslvdadao",i.openzs))),i.openday&&(r=GameServer.serverOpenDay>=i.openday-1,r||(h+=LangMgr.getValueByKey("openSvHowDay",i.openday))),i.recharge&&(a=vipControl.exp>=i.recharge,a||(h+=LangMgr.getValueByKey("numberRecharge",i.recharge))),i.opencheck&&(s=copyControl.guanqiaID>=i.opencheck,s||(h+=LangMgr.getValueByKey("numberPassLevel",i.opencheck))),i.openlevel&&(l=ActorControl.level>=i.openlevel,l||(h+=LangMgr.getValueByKey("numberLevel",i.openlevel)))),o=n&&l&&s&&a&&r):h=LangMgr.getValueByKey("notOpen",i.funName)),!o&&e&&""!=h&&tipsControl.showTips(h),o},e.prototype.checkExtData=function(t){if(t&&t.extData&&t.extData.term&&t.extData.data&&spokesPersonControl.checkBaseOpen(t.extData.term))for(var e in t.extData.data)void 0!=t[e]&&(t[e]=t.extData.data[e])},e}(BaseSystem);__reflect(SwitchMgr.prototype,"SwitchMgr");var GameLayer=function(){function t(){}return t.SCENE1=new EuiLayer,t.SCENE2=new EuiLayer,t.SCENE3=new EuiLayer,t.MAIN1=new EuiLayer,t.MAIN2=new EuiLayer,t.POPUP=new EuiLayer,t.TIPS=new EuiLayer,t}();__reflect(GameLayer.prototype,"GameLayer");var UIMgr=function(t){function e(){var e=t.call(this)||this;return e._visWinLis=[],e._backWinList=[],e._opens=[],e._views={},e._hCode2Key={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getKey=function(t){var e="";if("string"==typeof t)e=t;else if("function"==typeof t)e=egret.getQualifiedClassName(t);else if(t instanceof BaseEuiView)for(var i=Object.keys(this._views),o=0,n=i.length;n>o;o++){var r=i[o];if(this._views[r]==t){e=r;break}}else debug.log("UIMgr getKey error:"+t);return e},e.prototype.getClass=function(t){var e=egret.getDefinitionByName(t);return e?e:void debug.error("Unknown uiClass:",t)},e.prototype.viewOpenCheck=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=!0,n=this.getClass(t);if(null!=n){var r=n.openCheck;null!=r&&(o=r.apply(void 0,e))}return o},e.prototype.open=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this.getKey(t);if(!this.viewOpenCheck.apply(this,[o].concat(e)))return null;var n=this.openEasy(o,e);return n&&(n.isShowLog&&debug.log("Open view: "+o,"skin: "+n.skinName),this.checkOpenView(n),this.playAnima(o)),n},e.prototype.playAnima=function(t){if(t){var e=this.getView(t);e&&e.playAnima()}},e.prototype.openEasy=function(t,i){void 0===i&&(i=null);var o=this.getKey(t),n=this._views[o];if(n)n.parent||RecycleMgr.ins().reloadContainer(n,!0);else{var r=this.getClass(o);r&&(n=new r,this._views[o]=n,this._hCode2Key[n.hashCode]=o)}if(null==n)return debug.log("Not view",o),null;for(var a=0,s=n.exclusionWins;a<s.length;a++){var l=s[a];this.close(l)}Assert(n.open,n+"Not open function!!"),n.isShow()||n.isInit()?(n.addToParent(n.uilayer),n.open.apply(n,i)):(EasyLoading.ins().showLoading(),n.loadResource(function(){if("RambleMainView"==o){var t=e.ins().getView("GameBottomView");h=t&&t.parent?t.parent.getChildIndex(t):null,n.addToParent(n.uilayer,h),null!=h&&t.addToParent(t.uilayer,h+1)}else n.addToParent(n.uilayer);n.setVisible(!1)}.bind(this),function(){n.initUI(),n.initData(),n.open.apply(n,i),n.setVisible(!0),EasyLoading.ins().hideLoading()}.bind(this)));var h=this._opens.indexOf(o);if(h>=0&&this._opens.splice(h,1),this._opens.push(o),n.canVis){var u=this.getKey(t),c=this._visWinLis.indexOf(u);c>-1&&this._visWinLis.splice(c,1),this._visWinLis.push(u),this.checkVisWin()}return n},e.prototype.checkOpenView=function(t){t.isTopLevel&&t.parent!=GameLayer.POPUP&&(SoundUtils.ins().playEffect(SoundUtils.VIEW),EventMgr.ins().dispatch(473,1),this.close("RambleMainView"),this.close("RambleView"),this.clreanBackWinList())},e.prototype.close=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=this.getKey(t);EventMgr.ins().dispatch(477,[o,e]),this.closeEx(o,e)},e.prototype.closeEx=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(t){var o=this.getView(t);if(o){var n=this;o.closeEx(function(){var i=n.closeEasy(t,e);i&&n.checkCloseView()})}}},e.prototype.checkIsTopView=function(t){for(var e=this._opens.length,i=this.getKey(t),o=e-1;o>=0;o--){var n=this.getView(this._opens[o]);if(n&&n.isTopLevel)return i==this._opens[o]}return!1},e.prototype.pushBackWin=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=[t,e];this._backWinList.indexOf(o)<=-1&&this._backWinList.push(o)},e.prototype.clreanBackWinList=function(){this._backWinList=[]},e.prototype.closeLastTopView=function(){var t=this._backWinList.pop();if(t)return void this.open(t[0],t[1]);for(var e=this._opens.length,i=e-1;i>=0;i--){var o=this.getView(this._opens[i]);if(o&&o.isTopLevel){this.close(o);break}}},e.prototype.closeEasy=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(!this.isShow(t))return null;var o=this.getKey(t),n=this.getView(o);if(n){var r=this._opens.indexOf(o);if(r>=0&&this._opens.splice(r,1),n.close.apply(n,e),n.$onClose.apply(n),n.removeFromParent(),n.canVis){var a=this._visWinLis.indexOf(o);a>-1&&this._visWinLis.splice(a,1),this.checkVisWin()}}return n},e.prototype.checkCloseView=function(){for(var t=!1,e=0,i=this._opens;e<i.length;e++){var o=i[e],n=this.getView(o);if(n&&n.isTopLevel){t=!0;break}}t||(SoundUtils.PLAY_OPEN_VIEW=!1,EventMgr.ins().dispatch(473,0),SceneMgr.ins().getSceneName()==SceneMgr.MAIN&&(this.isShow("GameSceneView")||this.openEasy("GameSceneView"),this.isShow("RambleMainView")||this.openEasy("RambleMainView")))},e.prototype.getView=function(t){var e=this.getKey(t);return this._views[e]},Object.defineProperty(e,"gameScene",{get:function(){return e.ins().getView("GameSceneView")},enumerable:!0,configurable:!0}),Object.defineProperty(e,"playFun",{get:function(){return e.ins().getView("PortalView")},enumerable:!0,configurable:!0}),e.prototype.closeAll=function(){for(;this._opens.length;)this.closeEasy(this._opens[0]);this.destroyAllNotShowView(),this.checkCloseView()},e.prototype.closeTopLevel=function(){for(var t=this._opens.length-1;t>=0;t--){var e=this._opens[t],i=this.getView(e);i&&i.isTopLevel&&this.closeEasy(e)}this.checkCloseView()},e.prototype.isShow=function(t){return this._opens.indexOf(this.getKey(t))>=0},e.prototype.hasTopView=function(){for(var t=0,e=this._opens;t<e.length;t++){var i=e[t],o=this.getView(i);if(o&&o.isTopLevel)return!0}return!1},e.prototype.destroyAllNotShowView=function(){for(var t in this._hCode2Key){var e=this._hCode2Key[t];if(-1==this._opens.indexOf(e)){var i=this.getView(e);i&&!i.resident&&i.destoryView&&i.destoryView(!1)}}},e.prototype.checkVisWin=function(){for(var t=0;t<this._visWinLis.length;t++){var e=this.getView(this._visWinLis[t]);e&&e.setVisible(t==this._visWinLis.length-1)}},e.prototype.clear=function(){this.closeAll(),this._views={}},e.prototype.destroy=function(t){var e=this._hCode2Key[t];delete this._views[e],delete this._hCode2Key[t]},e}(SingleClass);__reflect(UIMgr.prototype,"UIMgr");var ActivationView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ActivationViewSkin",e.isTopLevel=!0,e.addEventTouchTap(e.bgClose,e.onTap),e}return __extends(e,t),e.prototype.open=function(t,e,i,o,n,r,a,s){this.closeFunc=r,this.title.source=t?"tongyongjihuochenggongp3":"tongyongjihuochenggongp2",this.itemname.text=e,i&&(this.img.source=i),o&&(this.mcGroup.rotation=a,this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.mcGroup.addChild(this.mc),s&&(this.mc.y=s),this.mc.playFile(PATH_EFF+o,-1)),this.playAnimaiton(n)},e.prototype.close=function(){egret.Tween.removeTweens(this.title),egret.Tween.removeTweens(this.titleBg),egret.Tween.removeTweens(this.img),egret.Tween.removeTweens(this.mcGroup),egret.Tween.removeTweens(this.tielian),egret.Tween.removeTweens(this.imgAct),DisplayUtils.removeFromParent(this.mc),DisplayUtils.removeFromParent(this.eff),this.mc=null,this.eff=null,this.closeFunc&&this.closeFunc.apply(null),this.closeFunc=null},e.prototype.playAnimaiton=function(t){var e=this,i=[this.tielian.x,this.tielian.y],o=[this.lbg.x,this.lbg.y],n=[this.rbg.x,this.rbg.y],r=[this.title.scaleX,this.title.scaleY],a=[this.titleBg.scaleX,this.titleBg.scaleY],s=[this.img.scaleX,this.img.scaleY],l=[this.mcGroup.scaleX,this.mcGroup.scaleY];this.estrade.visible=!1,this.itemname.visible=!1,this.itemBg.visible=!1,this.buttonBg.visible=!1,this.title.scaleX=this.title.scaleY=0,this.titleBg.scaleX=this.titleBg.scaleY=0,this.img.scaleX=this.img.scaleY=0,this.mcGroup.scaleX=this.mcGroup.scaleY=0,this.tielian.y=2*-this.tielian.height;var h=1,u=egret.Tween.get(this.tielian);u.to({y:i[1]+50},200*h).to({y:i[1]},100*h).call(function(){e.estrade.visible=!0;var i=egret.Tween.get(e.title),o=egret.Tween.get(e.titleBg),n=egret.Tween.get(e.img),u=egret.Tween.get(e.mcGroup);i.to({scaleX:r[0],scaleY:r[1]},500*h),o.to({scaleX:a[0],scaleY:a[1]},500*h),u.to({scaleX:l[0],scaleY:l[1]},500*h),n.to({scaleX:s[0],scaleY:s[1]},500*h).wait(500).call(function(){e.itemname.visible=!0,e.itemBg.visible=!0,e.buttonBg.visible=!0,t&&e.showSpotlight(),e.fluctuateTween()})}),this.lbg.y=-this.tielian.height,this.rbg.y=-this.tielian.height;var c=egret.Tween.get(this.lbg);c.to({y:o[1]+50},200*h).to({y:o[1]},100*h);var p=egret.Tween.get(this.rbg);p.to({y:n[1]+50},200*h).to({y:n[1]},100*h)},e.prototype.showSpotlight=function(){this.eff=new GameMovieClip,this.eff.anchorOffsetX=this.effGroup.anchorOffsetX,this.eff.anchorOffsetY=this.effGroup.anchorOffsetY,this.effGroup.addChild(this.eff),this.eff.playFile(PATH_EFF+"artifacteff",-1)},e.prototype.fluctuateTween=function(){var t=egret.Tween.get(this.imgAct,{loop:!0});t.to({y:this.imgAct.y-20},1e3).to({y:this.imgAct.y},1e3)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(ActivationView.prototype,"ActivationView");var BubbleControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.playBubbleEffect=function(t){var e="",i=DataCenter.ins().BubbleConfig[t];if(i)switch(i.type){case 1:e=i.news;break;case 2:i.news&&skillControl.dispatchShowSkillWord(i.news)}return e},e}(SingleClass);__reflect(BubbleControl.prototype,"BubbleControl");var BubblePanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="BubblePanelSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.x=-this.width/2,this.visible=!1},e.prototype.setSpeak=function(t,e){void 0===e&&(e=1),TimerMgr.ins().removeAll(this),this.start(),this.content.textColor=LangMgr.getColor("bubbleJobColor"+e);var i=BubbleControl.ins().playBubbleEffect(t);i&&(this.content.text=i,this.content.x=-this.content.textWidth>>1,this.visible=!0)},e.prototype.start=function(){TimerMgr.ins().doTimer(1e3,1,this.destruct,this)},e.prototype.destruct=function(){this.parent&&(this.visible=!1)},e}(BasePanel);__reflect(BubblePanel.prototype,"BubblePanel");var TalkPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setDefSkin=function(){this.setCurSkin("TalkPanelSkin")},e.prototype.setCurSkin=function(t){this.skinName=t},e.prototype.open=function(){this.visible=!1},e.prototype.setScale=function(t){this.bg.scaleX=t,this.x=this.width/2*t},e.prototype.setSpeak=function(t,e){void 0===e&&(e=5e3),TimerMgr.ins().removeAll(this),this.start(e),this.msgTxt.textFlow=TextUtils.generateTextFlow1(t),this.visible=!0,this.scaleX=this.scaleY=.3,egret.Tween.get(this).to({scaleX:1,scaleY:1},100,egret.Ease.quadOut)},e.prototype.start=function(t){t&&TimerMgr.ins().doTimer(t,1,this.destruct,this)},e.prototype.destruct=function(){this.parent&&(this.visible=!1),TimerMgr.ins().removeAll(this)},e}(BasePanel);__reflect(TalkPanel.prototype,"TalkPanel");var AppearanceControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.getDefClothes=function(){return RENWU_PREFIX+"001"},e.prototype.downWeaponClothesType=function(t,e,i,o,n){var r=heroControl.getSubRoleByIndex(t);if(r){r.weaponViewType=e,r.weaponViewId=i,r.clothesViewType=o,r.clothesViewId=n;var a=UnitMgr.ins().getEntityByHandle(r.handle);if(a){var s=a.infoModel;s.weaponViewType=r.weaponViewType,s.weaponViewId=r.weaponViewId,s.clothesViewType=r.clothesViewType,s.clothesViewId=r.clothesViewId,a.updateModel()}}EventMgr.ins().dispatch(711,t)},e.prototype.checkCanShow=function(t,e,i){var o=DataCenter.ins().EquipAllEffConfig[e];if(!o||!o[i])return!0;var n=o[i];if(n.limitType)for(var r=n.limitType,a=0;a<r.length;a++){var s=r[a],l=this.getEquipEffId(t,e,s);if(l&&(!n.limited||!n.limited[s]||n.limited[s].indexOf(l)>=0))return!1}return!0},e.prototype.getEquipEffId=function(t,e,i){var o=t instanceof RankSubRoleVo;if(3==i){var n=t.thunders[0].level,r=t.thunders[2].level,a=Math.min(n,r);return a}if(0==i){if(!o){var s=t.getEquipByIndex(e);return s.item.configID}if(0==e)return t.swordID;if(2==e)return t.clothID}if(1==i){if(0==e)return o?t.pos2:t.zhuangbei[1];if(2==e)return o?t.pos1:t.zhuangbei[0]}else{if(2==i)return t.weapons&&t.weapons.weaponsId;if(4==i)return t.heirloom.getSuitLv(t);if(5==i)return t.thirteenEquipLv;if(6==i){if(0==e&&6==t.weaponViewType&&t.weaponViewId>0)return t.weaponViewId;if(2==e&&6==t.clothesViewType&&t.clothesViewId>0)return t.clothesViewId}}},e.prototype.getEquipEffName=function(t,e,i){var o=this.getEquipEffId(t,e,i);if(o){if(3==i){if(2==e)return"bodythunder";var n=this.getLTEquipEffId(t);return 0==n?"":"weaponthunder00"+n}if(0==i)return DataCenter.ins().EquipConfig[o].appearance;if(1==i)return DataCenter.ins().FashionIdConfig[o].res;if(2==i)return DataCenter.ins().WeaponSoulConfig[o].outside[t.job-1];if(4==i){var r=DataCenter.ins().HeirloomEquipSetConfig[o];return r&&r.weff}if(5==i)return 2==e?DataCenter.ins().ReincarnateStarStepBsConfig.bodyEff[o-1]:DataCenter.ins().ReincarnateStarStepBsConfig.weaponEff[o-1];if(6==i){var a=DataCenter.ins().DevourEquipLevelConfig[e],s=void 0;if(a&&a[o]&&(s=a[o].outside||a[o].inside),s)return s}}},e.prototype.checkWeaponHasFamale=function(t){return DataCenter.ins().FashionIdConfig[t]&&DataCenter.ins().FashionIdConfig[t].weaponHasFamale?!0:!1},e.prototype.getWeaponFashionSex=function(t){var e=t.zhuangbei[1];return e&&DataCenter.ins().FashionIdConfig[e].weaponHasFamale?t.sex:0},e.prototype.getLTEquipEffId=function(t){var e=0,i=this.getEquipEffId(t,0,1);if(i)e=DataCenter.ins().FashionIdConfig[i].thunderEff;else{var o=this.getEquipEffId(t,0,0);o&&(e=DataCenter.ins().EquipConfig[o].thunderEff)}return e},e.prototype.getJobUIState=function(t,e,i){var o="nor";if("sg"==GlobalModel.skinType){if(i)return o;if(e>0){var n=DataCenter.ins().ItemConfig[e];if(n.zsLevel>=6||121==n.descIndex)return o}}return GlobalModel.jobUIState&&(o="job"+t),o},e.prototype.resJobHandler=function(t,e){if("sg"==GlobalModel.skinType){var i=t.split("_");i.length>=2&&i[0]==RENWU_PREFIX+"000"&&(i[0]=""+RENWU_PREFIX+e+"00",t=i.join("_"))}else if("mh"==GlobalModel.skinType){var i=t.split("_");if(i.length>=2&&(0==i[0].indexOf(RENWU_PREFIX+"00")&&2==e?(i[1]=e.toString(),t=i.join("_")):0==i[0].indexOf(RENWU_PREFIX+"00")&&3==e&&45==GlobalModel.gameId?(i[1]="1",t=i.join("_")):0==i[0].indexOf(WUQI_PREFIX+"903")||0==i[0].indexOf(WUQI_PREFIX+"904")||0==i[0].indexOf(WUQI_PREFIX+"905")?(i[0]="rxweapon"+e+"00",t=i.join("_")):0==i[0].indexOf(RENWU_PREFIX+"903")&&(i[0]="rxbody"+e+"00",t=i.join("_")),GlobalModel.changeUglyRes)){for(var o=1;3>=o;o++)(0==i[0].indexOf(RENWU_PREFIX+"000")&&e==o||0==i[0].indexOf(RENWU_PREFIX+"001")&&e==o||0==i[0].indexOf(RENWU_PREFIX+"002")&&e==o||0==i[0].indexOf(""+RENWU_PREFIX+o+"00")||0==i[0].indexOf(""+RENWU_PREFIX+o+"01")||0==i[0].indexOf(""+RENWU_PREFIX+o+"02")||0==i[0].indexOf(""+RENWU_PREFIX+o+"03")||0==i[0].indexOf(""+RENWU_PREFIX+o+"04"))&&(i[0]=""+RENWU_PREFIX+o+"05",t=i.join("_"));for(var o=1;3>=o;o++)(0==i[0].indexOf(""+WUQI_PREFIX+o+"00")||0==i[0].indexOf(""+WUQI_PREFIX+o+"01")||0==i[0].indexOf(""+WUQI_PREFIX+o+"02")||0==i[0].indexOf(""+WUQI_PREFIX+o+"03")||0==i[0].indexOf(""+WUQI_PREFIX+o+"04")||0==i[0].indexOf(""+WUQI_PREFIX+o+"05"))&&(i[0]=""+WUQI_PREFIX+o+"06",t=i.join("_"))}}return t},__decorate([down(42,[1,1,3,1,3])],e.prototype,"downWeaponClothesType",null),e=__decorate([protocolsId(255)],e)}(BaseSystem);__reflect(AppearanceControl.prototype,"AppearanceControl");var AttributeData=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.type=t,this.value=e}return t.AttrAddition=function(e,i){if(!e||e.length<=0)return i?i.concat():null;if(!i||i.length<=0)return e?e.concat():null;for(var o=e.concat(i),n=[],r=o.length,a=new Object,s=0;r>s;s++)void 0==a[o[s].type]&&(a[o[s].type]=0),a[o[s].type]+=o[s].value;for(var l in a)n.push(new t(+l,+a[l]));return n},t.AttrDel=function(e,i){for(var o=[],n=0;n<e.length;n++){var r=new t;r.type=0!=e[n].type?e[n].type:i[n].type,r.value=e[n].value-i[n].value,o.push(r)}return o},t.AttrMultiply=function(e,i){for(var o=[],n=0;n<e.length;n++){var r=new t;r.type=0!=e[n].type?e[n].type:i[n].type,r.value=e[n].value*(1+i[n].value/1e4),o.push(r)}return o},t.transformAttr=function(e){var i=[];for(var o in e){var n=new t;n.type=e[o].type,n.value=e[o].value,i.push(n)}for(var r=0;r<i.length-1;r++)for(var a=0;a<i.length-r-1;a++)if(i[a]<i[a+1]){var s=i[a+1];i[a+1]=i[a],i[a]=s}return i},t.getAttStr=function(e,i,o,n,r,a,s,l,h){void 0===i&&(i=4),void 0===o&&(o=1),void 0===n&&(n="+"),void 0===r&&(r=!1),void 0===a&&(a=!0);var u="",c=0;if(e instanceof t)return this.getAttStrByType(e,i,n,r,a,h);if(!(e instanceof Array)){var p=[];for(var d in this.translate)if(!isNaN(e[d])){var g=new t;g.type=parseInt(this.translate[d]),g.value=e[d],p.push(g)}return this.getAttStr(p,i,o,n,r)}for(var f=e,m=f.length-1,v=0;v<f.length;v++)if(0!=f[v].type)if(11!=f[v].type&&12!=f[v].type&&16!=f[v].type&&23!=f[v].type&&24!=f[v].type&&89!=f[v].type&&90!=f[v].type){if(u+=this.getAttStrByType(f[v],i,n,r,a,h),s&&s.attr_add&&(u+="+"+Math.floor(f[v].value*(s.attr_add/100))),l&&(u+=l),m+c>v)for(var y=0;o>y;y++)u+="\n"}else c=-1;if(0>c){var C=u.lastIndexOf("\n");u=u.substring(0,C)}return u},t.getAttStrEx=function(e,i,o,n,r,a,s,l,h){void 0===i&&(i=4),void 0===o&&(o=1),void 0===n&&(n="+"),void 0===r&&(r=!1),void 0===a&&(a=!0);var u="",c=0;if(e instanceof t)return this.getAttStrByType(e,i,n,r,a,h);if(!(e instanceof Array)){var p=[];for(var d in this.translate)if(!isNaN(e[d])){var g=new t;g.type=parseInt(this.translate[d]),g.value=e[d],p.push(g)}return this.getAttStr(p,i,o,n,r)}for(var f=e,m=f.length-1,v=0;v<f.length;v++)if(0!=f[v].type&&(u+=this.getAttStrByType(f[v],i,n,r,a,h),s&&s.attr_add&&(u+="+"+Math.floor(f[v].value*(s.attr_add/100))),l&&(u+=l),m+c>v))for(var y=0;o>y;y++)u+="\n";if(0>c){var C=u.lastIndexOf("\n");u=u.substring(0,C)}return u},t.getAttStr1=function(t,e,i){void 0===i&&(i=!0);for(var o="",n=0;n<t.length;n++)o+=this.getAttStrByType1(t[n],e,i),n<t.length-1&&(o+=StringUtils.repeatStr("\n",e.emptyLine+1));return o},t.getAttStrByType1=function(e,i,o){void 0===o&&(o=!0);var n=i.addSpce?t.getAttrStrWithSpaceByType(e.type):t.getAttrStrByType(e.type),r=e.type,a=(i.sign,"");a=7==r?e.value/100+"%":60==r||57==r?e.value.toString():r>=11?15==r?e.value/1e3+LangMgr.getValueByKey("activitSS"):12==r?e.value/100+"%":17==r?(e.value>>0)+"":(e.value/100>>0)+"%":e.value.toString();var s=o?StringUtils.addColor(n+i.sign,i.wordColor):n+i.sign;i.isShowAttName&&(s=StringUtils.complementByChar(s,i.intervals));var l=s+(o?StringUtils.addColor(a,i.attrColor):a);return l},t.getExAttStr=function(t,e,i){void 0===i&&(i=!0);for(var o="",n=0;n<t.length;n++)o+=this.getExAttStrByType(t[n],e,i),n<t.length-1&&(o+=StringUtils.repeatStr("\n",e.emptyLine+1));return o},t.getExAttStrByType=function(e,i,o){void 0===o&&(o=!0);var n=t.getExtAttrStrByType(e.type),r="";r=4==e.type||3==e.type||12==e.type||5==e.type||31==e.type||32==e.type||33==e.type||16==e.type||17==e.type||18==e.type||19==e.type||20==e.type||26==e.type||21==e.type||22==e.type||14==e.type||15==e.type||15==e.type||6==e.type?e.value/100+"%":7==e.type?e.value/1e3+LangMgr.getValueByKey("activitSS"):2==e.type?"":""+e.value;var a=o?StringUtils.addColor(n+i.sign,i.wordColor):n+i.sign;i.isShowAttName&&(a=StringUtils.complementByChar(a,i.intervals));var s=a+(o?StringUtils.addColor(r,i.attrColor):r);return s},t.getAttStrByType=function(e,i,o,n,r,a){void 0===i&&(i=4),void 0===o&&(o="+"),void 0===n&&(n=!0),void 0===r&&(r=!0);var s="";switch(r&&(s=n?StringUtils.complementByChar(t.getAttrStrByType(e.type),8*i):t.getAttrStrByType(e.type)),e.type){case 7:case 63:s+=o+e.value/100+"%";break;case 15:s+=o+e.value/1e3+LangMgr.getValueByKey("activitSS");break;case 28:case 29:case 30:case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 8:case 9:case 10:case 26:case 31:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 57:case 60:case 64:case 17:case 76:case 77:case 78:case 82:case 85:s+=o+e.value;break;case 86:case 65:s+=o+e.value/100+"%";break;default:s+=o+(e.value/100).toFixed(1)+"%"}if(a){for(var l=0;l<a.length;l++)if(a[l].type==e.type){s=a[l].value.toString();break}}else 55==e.type&&(s="|C:0xFF0000&T:"+s+"|");return s},t.getExtAttStrByType=function(e,i,o,n,r){void 0===i&&(i=4),void 0===o&&(o="+"),void 0===n&&(n=!1),void 0===r&&(r=!0);var a="";return r&&(a=StringUtils.complementByChar(t.getExtAttrStrByType(e.type),8*i)),a+=4==e.type||3==e.type||12==e.type||5==e.type||31==e.type||32==e.type||33==e.type||16==e.type||17==e.type||18==e.type||19==e.type||20==e.type||26==e.type||21==e.type||22==e.type||14==e.type||15==e.type||15==e.type||6==e.type?o+e.value/100+"%":7==e.type?o+e.value/1e3+LangMgr.getValueByKey("activitSS"):2==e.type?"":o+e.value},t.inserteBlank=function(t,e,i){void 0===i&&(i=1);for(var o=t.length,n="";e--;)n+=" ";var r="";switch(i){case 0:r=n+t;break;case 1:r=t.slice(0,o/2)+n+t.slice(o/2);break;case 2:r=t+n}return r},t.getAttrInfoByItemData=function(e){var i=DataCenter.ins().EquipConfig[e.configID],o="",n=0;for(var r in this.translate)if(!(i[r]<=0))for(var a=0;a<e.att.length;a++)n=e.att[a].type,this.translate[r]==n&&(o+=t.getAttrStrByType(n)+": ",o+=i[r]+" +"+e.att[a].value+"\n");return o},t.getAttrStrByType=function(t){return LangMgr.getValueByKey("attributeType"+t)},t.getAttrStrWithSpaceByType=function(t){return LangMgr.getValueByKey("attributeOther"+t)},t.getExtAttrStrByType=function(t){return LangMgr.getValueByKey("exAttributeType"+t)},t.getEEquipAttrStrByType=function(t){return LangMgr.getValueByKey("equipAddAttrType"+t)},t.getExAttrNameByAttrbute=function(e,i,o,n){void 0===i&&(i=!1),void 0===o&&(o="："),void 0===n&&(n=void 0);var r=t.getExtAttrStrByType(e.type),a="";if(i)switch(e.type){case 31:case 32:case 33:case 17:case 18:case 19:case 20:case 21:case 22:case 8:case 42:case 26:a=e.value/100+"%";break;default:a+=e.value}return void 0!=n?r=""+r+o+"|C:"+n+"&T:"+a+"|":r+=o+a,r},t.getAttrStarAdd=function(e,i){var o=[];return e.forEach(function(e){var n=new t;n.type=e.type,n.value=e.value*i>>0,o.push(n)}),o},t.getAttrNameByAttrbute=function(e,i,o,n,r){void 0===i&&(i=!1),void 0===o&&(o="："),void 0===n&&(n=!1),void 0===r&&(r=void 0);var a=t.getAttrStrByType(e.type);n&&(a=t.inserteBlank(a,7));
var s="";if(i)switch(e.type){case 7:case 8:s=e.value/100+"%";break;default:s=e.value+""}return void 0!=r?a=""+a+o+"|C:"+r+"&T:"+s+"|":a+=o+s,a},t.getPercentAttr=function(e,i,o,n){void 0===o&&(o=!0);for(var r=[],a=0;a<e.length;a++){var s=new t;s.type=e[a].type,n&&-1==n.indexOf(s.type)||(o?s.value=Math.floor(e[a].value*(1+i)):s.value=Math.floor(e[a].value*i),r.push(s))}return r},t.sortAttribute=function(t,e){return SortUtils.sortAscByKey(t.type,e.type)},t.copyAttrbute=function(e){var i=new t;return i.type=e.type,i.value=e.value,i},t.addAttrToList=function(e,i){if(!e[i.type]){var o=new t;o.type=i.type,o.value=0,e[i.type]=o}var n=e[i.type];n.value+=i.value},t.combineAtts=function(e){if(!e||!e.length)return e;for(var i,o=[],n=e.length,r=new Object,a=[],s=0;n>s;s++)i=e[s].type,void 0==r[i]&&(r[i]=0,a.push(i)),r[e[s].type]+=e[s].value;n=a.length;for(var s=0;n>s;s++)i=a[s],o.push(new t(i,+r[i]));return o},t.getCustomAttrValue=function(t,e){for(var i=0,o=0;o<t.length;o++)t[o].type==e&&65==e&&(i=t[o].value/100);return i},t.filterAttrs=function(t,e){for(var i=0;i<t.length;)-1==e.indexOf(t[i].type)?t.splice(i,1):i++},t.getAttStrSpecial=function(e,i,o,n,r,a){void 0===i&&(i=4),void 0===o&&(o=1),void 0===n&&(n="+"),void 0===r&&(r=!1),void 0===a&&(a=!0);for(var s="",l=[],h=0;h<e.length;h++)if(e[h])for(var u=0;u<e[h].length;u++)if(e[h][u].value){for(var c=!1,p=0;p<l.length;p++)if(l[p].type==e[h][u].type){l[p].desc||(l[p].desc=[]),l[p].desc.push(e[h][u].value+""),c=!0;break}c||l.push({type:e[h][u].type,desc:[""+e[h][u].value]})}for(var h=0;h<l.length;h++){for(var u=0;u<l[h].desc.length;u++)if(l[h].desc[u])if(u)switch(l[h].type){case 2:case 4:case 5:case 6:s+="+"+l[h].desc[u];break;default:s="+"+Number(l[h].desc[u])/100+"%"}else s+=this.getAttStrByType(new t(l[h].type,Number(l[h].desc[u])),i,n,r,a);for(var u=0;o>u;u++)s+="\n";if(h==l.length-1)for(var u=0;o>u;u++){var d=s.lastIndexOf("\n");s=s.substring(0,d)}}return s},t.getBetweenAttrs=function(e,i){for(var o=[],n=0;n<i.length;n++){for(var r=!1,a=0;a<e.length;a++)if(i[n].type==e[a].type){var s=new t;s.type=i[n].type,s.value=i[n].value-e[a].value,s.value&&o.push(s),r=!0;break}if(!r){var s=new t;s.type=i[n].type,s.value=i[n].value,o.push(s)}}return o},t.FILTER_EXTDATA_ID=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,35,37,38,39],t.FILTER_BASE_DATA_ID=[18,20],t.attrNames=["hp","atk","def","res"],t.itemTranslate={hp:2,atk:4,def:5,res:6},t.translate={hp:2,atk:4,def:5,res:6,crit:7,tough:8},t.exRelate={2:11,4:12,5:23,6:24},t.exRelateEx={11:2,12:4,23:5,24:6},t.showTypeList=[4,2,5,6],t}();__reflect(AttributeData.prototype,"AttributeData");var AttributeFormat=function(){function t(){this.intervals=4,this.emptyLine=0,this.sign="+",this.spaceCount=0,this.isShowAttName=1,this.wordColor=ColorUtils.ATTR_DEFAULT_COLOR,this.attrColor=ColorUtils.ATTR_DEFAULT_COLOR}return t.getFormat=function(e,i,o,n,r,a,s,l){void 0===e&&(e=4),void 0===i&&(i=0),void 0===o&&(o="+"),void 0===n&&(n=0),void 0===r&&(r=1),void 0===a&&(a=ColorUtils.ATTR_DEFAULT_COLOR),void 0===s&&(s=ColorUtils.ATTR_DEFAULT_COLOR),void 0===l&&(l=!1);var h=new t;return h.intervals=e,h.emptyLine=i,h.sign=o,h.spaceCount=n,h.isShowAttName=r,h.wordColor=a,h.attrColor=s,h.addSpce=l,h},t.FORMAT_1=function(){return this.getFormat(0,0,"：")},t.FORMAT_2=function(){var t=this.FORMAT_1();return t.attrColor=ColorUtils.GREEN,t},t}();__reflect(AttributeFormat.prototype,"AttributeFormat");var DieGuide=function(t){function e(){var e=t.call(this)||this;return e.resImg=["vipbn2_png","vipbn2_1_png"],e.addCustomEvent(510,e.dispatchdieGuide),e.addCustomEvent(177,e.initRecharge1),e.addCustomEvent(511,e.initSetting),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initRecharge1=function(){this.isInitRecharge1=!0},e.prototype.initSetting=function(){this.isInitSetting=!0},e.prototype.dispatchdieGuide=function(t){if(!t){var e=ServerStorage.ins().getValue(4);e||(e=Math.floor((new Date).getTime()/1e3),ServerStorage.ins().setValue(4,e));var i=payControl.getRechargeData(0);i.num&&(e=ServerStorage.ins().getValue(10),e||(e=Math.floor((new Date).getTime()/1e3),ServerStorage.ins().setValue(10,e)))}EventMgr.ins().dispatch(696)},e.prototype.dieFbRedPoint=function(t,e){var i=DataCenter.ins().DailyCopyConfig[e];if(!i)return!1;if(reincarnateControl.lv<i.zsLevel||ActorControl.level<i.levelLimit)return!1;var o=ServerStorage.ins().getValue(8);if(o){var n=e-3e3;if(o>>n&1)return!1}var r=ServerStorage.ins().getValue(4);if(!r)return!1;var a=Math.floor((new Date).getTime()/1e3);return a>DateUtils.getTodayZeroSecond(new Date(1e3*r))+86400?!1:t>0?!0:!1},e.prototype.checkFirstChargeOrVIPWin=function(){if(this.isInitRecharge1&&this.isInitSetting&&!copyControl.pkGqboss){var t=payControl.getRechargeData(0);if(t.num){var i=ServerStorage.ins().getValue(10);if(i&&i>0&&vipControl.lv<3){var o=ServerStorage.ins().getValue(6);if(!o){var n=UIMgr.playFun;return n&&n.setDieGuide(e.VIP),void ServerStorage.ins().setValue(6,e.Show)}}}else{if(ActorControl.level>=30){var r=ServerStorage.ins().getValue(5);if(!r){var n=UIMgr.playFun;return n&&n.setDieGuide(e.RECHARGE),void ServerStorage.ins().setValue(5,e.Show)}}var i=ServerStorage.ins().getValue(4);if(i&&i>0){var r=ServerStorage.ins().getValue(9);if(!r){var n=UIMgr.playFun;return n&&n.setDieGuide(e.RECHARGE),void ServerStorage.ins().setValue(9,e.Show)}}}}},e.prototype.getOpenRoles=function(){var t=ServerStorage.ins().getValue(7);if(t==e.Show2&&heroControl.subRolesLen>=3)return"";for(var i=3,o=1;i>o;o++){var n=heroControl.getSubRoleByIndex(o);if(!n)return t?t==e.Show&&2==o&&ServerStorage.ins().setValue(7,e.Show2):ServerStorage.ins().setValue(7,e.Show),this.resImg[o-1]}return""},e.prototype.setClick=function(t){var e=t-3e3,i=ServerStorage.ins().getValue(8);i||(i=0),i>>e&1||(i|=1<<e,ServerStorage.ins().setValue(8,i))},e.prototype.setMaxFb=function(t){for(var e=ServerStorage.ins().getValue(8),i=0;i<t.length;i++)if(t[i]>3e3){var o=t[i]-3e3;if(e>>o&1)continue;e|=1<<o,ServerStorage.ins().setValue(8,e)}},e.prototype.getDiedGainWay=function(){var t=[];Object.keys(DataCenter.ins().VipConfig).length;for(var i in DataCenter.ins().DeathGuideConfig){var o=DataCenter.ins().DeathGuideConfig[i];if(reincarnateControl.lv<=o.zslv||ActorControl.level<=o.lv){for(var n in o.gainWay){var r=o.gainWay[n][0];if(16!=r){if(14==r||20==r){var a=Object.keys(DataCenter.ins().VipConfig).length;if(vipControl.lv>=a)continue}t.push(r)}else{var s=e.ins().getOpenRoles();if(s){var l=DataCenter.ins().DeathgainWayConfig[r];l.itemId=s,t.push(r)}}}break}}return t},e.Show=1,e.Show2=2,e.RECHARGE=1,e.VIP=2,e.FB=3,e}(BaseSystem);__reflect(DieGuide.prototype,"DieGuide");var DropControl=function(){function t(){}return t.init=function(t,e){this.dropContainer=t,this.dropNameContainer=e,EventMgr.addListener(131,this.addDrop,this)},t.start=function(t){this.mainEntity=t?t:UnitMgr.ins().getNoDieRole(),2==MapControl.copyType||100==MapControl.copyType||1==MapControl.copyType&&SwitchMgr.ins().checkOpen(25)||(6==MapControl.copyType||confrontControl.isEncounter()||9==MapControl.copyType)&&GameServer.serverOpenDay>0||29==MapControl.copyType||32==MapControl.copyType||41==MapControl.copyType||43==MapControl.copyType||44==MapControl.copyType||47==MapControl.copyType||55==MapControl.copyType||57==MapControl.copyType||58==MapControl.copyType||62==MapControl.copyType||74==MapControl.copyType||48==MapControl.copyType||63==MapControl.copyType||bossControl.checkIsOpenMult()?TimerMgr.ins().doTimer(1200,1,this.delayTweenItem,this):TimerMgr.ins().isExists(this.findDrop,this)||TimerMgr.ins().doTimer(100,0,this.findDrop,this),this.starting=!0},t.stop=function(){TimerMgr.ins().removeAll(this),this.starting=!1,HookControl.ins().isFindDrop=!1},t.delayTweenItem=function(){if(!t.getItemCount())return void this.checkDrop();var e=this.mainEntity;if(!e)return void this.clearDrop();for(var i in this.itemPos)t.tweenItem(this.itemPos[i],e,i)},t.tweenItem=function(e,i,o){if(null==e)return void DebugUtils.warn(LangMgr.getValueByKey("sceneTips1"));DisplayUtils.removeFromParent(e),e.setItemParent(t.dropNameContainer);var n=egret.Tween.get(e),r=500*Math.random()+200;n.wait(r).to({x:i.x,y:i.y-50},450,egret.Ease.backIn).call(function(){egret.Tween.removeTweens(e),DisplayUtils.removeFromParent(e),e.destruct(),delete t.itemPos[o],t.getItemCount()||t.checkDrop()},t)},t.getItemCount=function(){return t.itemPos?Object.keys(t.itemPos).length:0},t.addDrop=function(t){var e=t[0],i=t[1],o=t[2];!o.dropEffId&&DataCenter.ins().ItemConfig[o.id]&&(o.dropEffId=DataCenter.ins().ItemConfig[o.id].dropeff);var n=ObjectPool.pop("UnitItemNameMerge");n.setData(o);var r=0,a=0,s=0,l="|";if(this.itemPos[e+l+i]||!MapControl.aStar.isWalkable(e,i)){for(s=0;s<this.orderX.length&&(r=e+this.orderX[s],a=i+this.orderY[s],0==MapControl.aStar.isWalkable(r,a)||null!=this.itemPos[r+l+a]);s++);if(s>=this.orderX.length)for(var h=2,u=!0;u;){for(var c=e-h;e+h>c&&u;c++)for(var p=i-h;i+h>p&&u;p++)r=c,a=p,0!=MapControl.aStar.isWalkable(r,a)&&null==this.itemPos[r+l+a]&&(u=!1);h++}}else r=e,a=i;n.x=MapControl.grip2Point(r),n.y=MapControl.grip2Point(a),this.itemPos[r+l+a]=n,gameControl.addEntity(n),n.addRoatEffect(),n.addFloatEffect(),n.addEffect()},t.clearAllDropTween=function(){if(this.itemPos){var t=null;for(var e in this.itemPos)t=this.itemPos[e],t&&t instanceof UnitItemNameMerge&&(t.removeRoatEffect(),t.removeEffect())}},t.clearDrop=function(){t.clearAllDropTween(),this.stop();for(var e in this.itemPos)DisplayUtils.removeFromParent(this.itemPos[e]),this.itemPos[e]&&this.itemPos[e].destruct(),ObjectPool.push(this.itemPos[e]),delete this.itemPos[e];this.curTarget=null,this.completeFunc&&(this.completeFunc.func.call(this.completeFunc.funcThis),this.completeFunc=null)},t.findDrop=function(){var t=this.mainEntity;if(t){var e=UnitMgr.ins().getEntityByTeam(0);if(this.curTarget&&(!t||t.action==UnitAction.RUN||t.atking))return void(t&&t.action==UnitAction.RUN&&(t.x==this.lastPoint.x&&t.y==this.lastPoint.y?t.playAction(UnitAction.STAND):(this.lastPoint.x=t.x,this.lastPoint.y=t.y)));if(HookControl.ins().isFindDrop=!0,e.length>1)for(var i=(heroControl.subRolesLen,0),o=[-1,1],n=0;n<e.length;n++){var r=e[n];if(r!=t&&r.action!=UnitAction.RUN){var a=t;if(r.infoModel.masterHandle){var s=UnitMgr.ins().getEntityByHandle(r.infoModel.masterHandle);s&&(a=s)}2==e.length&&(o=[0]);var l=DirUtils.getGridByDir(a.dir+(o[i]||0),MapControl.CELL_SIZE);i+=1,MapControl.moveEntity(r,a.x+l.x,a.y+l.y)}}if(!(egret.getTimer()-this.waitTime<200)){var h=null;if(this.curTarget){if(h=this.curTarget,MathUtils.getDistance(t.x,t.y,h.x,h.y)<MapControl.CELL_SIZE>>1){for(var u in this.itemPos)if(this.itemPos[u]==h){var c=this.itemPos[u];c&&c instanceof UnitItemNameMerge&&(c.removeRoatEffect(),c.removeEffect()),delete this.itemPos[u];break}return egret.Tween.get(h).wait(100).call(function(){if(h&&h.parent){var t=h.parent.localToGlobal(h.x,h.y);gameControl.dispatchFlyItem({item:h,point:t}),DisplayUtils.removeFromParent(h)}h=null}),this.curTarget=null,void(this.waitTime=egret.getTimer())}this.curTarget=null}var p=null,d=Number.MAX_VALUE;for(var u in this.itemPos){h=this.itemPos[u];var g=MathUtils.getDistance(t.x,t.y,h.x,h.y);d>g&&(d=g,p=this.itemPos[u])}if(p)return this.curTarget=p,void MapControl.moveEntity(t,p.x,p.y);this.checkDrop(),0==MapControl.copyId&&copyControl.upGetReward()}}},t.checkDrop=function(){return this.getItemCount()?void 0:(this.stop(),void(this.completeFunc&&(this.completeFunc.func.call(this.completeFunc.funcThis),this.completeFunc=null)))},t.addCompleteFunc=function(t,e){this.completeFunc={func:t,funcThis:e}},t.orderX=[-1,1,-1,0,1,-1,0,1],t.orderY=[0,0,1,1,1,-1,-1,-1],t.tempDropPoint=new egret.Point,t.itemPos={},t.waitTime=0,t.lastPoint=new egret.Point,t}();__reflect(DropControl.prototype,"DropControl");var EquipPosAniVo=function(){function t(t,e,i,o){this.x=t,this.y=e,this.scaleX=i,this.scaleY=o}return t}();__reflect(EquipPosAniVo.prototype,"EquipPosAniVo");var EquipVo=function(){function t(){}return t.prototype.init=function(t){this.strengthen=t[0],this.spiritLv=t[1],this.gem=t[2],this.item=new ItemData;var e=3,i=e+ByteConst.ItemDatas.length;this.item.init(t.slice(e,i)),this.zhuling=t[i],this.soulLv=t[i+1],this.spiritExp=t[i+3]},t}();__reflect(EquipVo.prototype,"EquipVo");var FlameMarkEffect=function(){function t(t,e){this._angle=.1,this._angles=[0,0,0,0,0,0,0],this._circleCenter={x:0,y:-72},this._a=60,this._b=30,this._oldBallNum=0,this._curTimes=0,this._isShowBall=!0,this._ring=t,this._infoModel=e,EventMgr.addListener(653,this.dataChange,this),this.usedLyMarkSkill()}return t.prototype.dataChange=function(){this._infoModel&&this._infoModel.masterHandle==ActorControl.handle&&this.update()},Object.defineProperty(t.prototype,"_parent",{get:function(){return this._ring.parent},enumerable:!0,configurable:!0}),t.prototype.usedLyMarkSkill=function(){this.resetBalls(),TimerMgr.ins().removeAll(this);var t=this.getSkillLvById(1);if(t){var e=DataCenter.ins().FlameMarkEffectConfig[1][t];t=this.getSkillLvById(3);var i=t?DataCenter.ins().FlameMarkEffectConfig[3][t].reloadTime:0,o=e.skillId,n=e.stamp;this.getSkillLvById(2)&&(t=this.getSkillLvById(2),o=DataCenter.ins().FlameMarkEffectConfig[2][t].skillId,n=DataCenter.ins().FlameMarkEffectConfig[2][t].stamp);var r=DataCenter.ins().SkillsDescConfig[DataCenter.ins().SkillsConfig[o].desc],a=(r.cd-i)/n>>0;TimerMgr.ins().doTimer(a,n,this.doTimer,this),this._curTimes=0}},t.prototype.doTimer=function(){this._curTimes++,this.updateBalls(this._curTimes)},t.prototype.update=function(){for(var t,e,i=0,o=0,n=0;6>=n;n++)o=t=this.getSkillLvById(n+1),t||(t=1),e=DataCenter.ins().FlameMarkEffectConfig[n+1][t],n+1!=1&&n+1!=2||!o||(i=e.stamp);this.updateBalls(i)},t.prototype.updateBalls=function(t){if(this._ring&&this._parent&&t&&this._oldBallNum!=t){this.resetBalls(),this._oldBallNum=t,this._balls||(this._balls=[],TimerMgr.ins().doTimer(51,0,this.doCircle,this));for(var e=void 0,i=2*Math.PI/t,o=0;t>o;o++)e=ObjectPool.pop("GameMovieClip"),this._isShowBall&&this._parent.addChild(e),this._angles[o]=i*o,e.x=this._a*Math.cos(i*o)+this._circleCenter.x,e.y=this._b*Math.sin(i*o)+this._circleCenter.y,this._balls.push(e),e.playFile(PATH_SKILLEFF+"skill6204a",-1)}},t.prototype.doCircle=function(){if(!this._balls)return void TimerMgr.ins().remove(this.doCircle,this);if(this._isShowBall&&this._ring&&this._parent)for(var t,e,i=this._balls.length,o=0,n=0,r=0;i>r;r++)t=this._balls[r],t.x=this._a*Math.cos(this._angles[r])+this._circleCenter.x,t.y=this._b*Math.sin(this._angles[r])+this._circleCenter.y,this._angles[r]+=this._angle,this._angles[r]=this._angles[r]%(2*Math.PI),e=t.parent,e&&(o=e.getChildIndex(this._ring),n=e.getChildIndex(t),this._angles[r]>=2.5&&this._angles[r]<=6?n>o&&e.addChildAt(t,o):o>n&&e.addChildAt(t,e.numChildren))},t.prototype.resetBalls=function(){if(TimerMgr.ins().remove(this.doCircle,this),this._oldBallNum=0,this._balls){for(var t=this._balls.length,e=0;t>e;e++)this._balls[e].destroy();this._balls=null}},t.prototype.getSkillLvById=function(t){var e=this._infoModel.masterHandle==ActorControl.handle?flameMarkControl.skills:this._infoModel.lyMarkSkills;return!e||e.length<t?0:e[t-1]},t.prototype.getLyMarkLv=function(){return this._infoModel.masterHandle==ActorControl.handle?flameMarkControl.lyMarkLv:this._infoModel.lyMarkLv},t.prototype.showBall=function(){if(!this._isShowBall&&(this._isShowBall=!0,this.updateBalls(this._curTimes),this._balls))for(var t=this._balls.length,e=0;t>e;e++)this._parent.addChild(this._balls[e])},t.prototype.hideBall=function(){this._isShowBall&&(this._isShowBall=!1,this.resetBalls())},t.prototype.destruct=function(){this.resetBalls(),TimerMgr.ins().removeAll(this),this._ring=null,this._infoModel=null,EventMgr.ins().removeAll(this)},t}();__reflect(FlameMarkEffect.prototype,"FlameMarkEffect");var GameControl=function(t){function e(){var e=t.call(this)||this;e.MONSTER_RADIUS=2,e.MONSTER_LEN=2*e.MONSTER_RADIUS+1,e.radiusMap=[],e.atkTarget={},e.masterAtkTarget={},e.currHandle=0,e.currAttackHandle=0,e.rPosindex=[],e.runTime=0,e.guanqiaId=0,KeyboardUtils.ins().addKeyDown(e.onKeyClick,e);for(var i=2*e.MONSTER_RADIUS+1,o=0;i>o;o++)e.radiusMap[o]=[];return e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.heartbeat()},e.prototype.upNewRole=function(t,e){return[t,e]},e.prototype.heartbeat=function(){return this.heartBeatTimer?!1:(this.heartBeatTimer=new egret.Timer(6e4),this.heartBeatTimer.addEventListener(egret.TimerEvent.TIMER,this.upHeartbeat,this),void this.heartBeatTimer.start())},e.prototype.upHeartbeat=function(){},e.prototype.upGMCommad=function(t){return[t]},e.prototype.downEnterMap=function(t,e,i,o,n,r,a){MapControl.parser(t,e,i,o,n,r,a),DropControl.clearDrop(),HookControl.ins().clear(),lookControl.clear(),monsterSpeakControl.clear(),UnitMgr.ins().removeAll(),UnitHideMgr.ins().changeScene(),UnitShowMgr.ins().changeScene(),TimerMgr.ins().removeAll(MapControl),TimerMgr.ins().removeAll(SkillEffPlayDisplay),TimerMgr.ins().remove(this.shakeMapView,this);var s=UIMgr.gameScene.map;s.clearAllLayer(),s.changeMap(),0==MapControl.copyId?(copyControl.pkGqboss=!1,confrontControl.willBossID&&portalControl.upDataWillBoss(confrontControl.willBossID)):1!=MapControl.copyType&&UIMgr.ins().closeTopLevel(),UIMgr.ins().close("BossBloodView"),UIMgr.ins().close("TargetPlayerBigBloodView"),unionWarControl.getModel().clearGuildWarList(),bossControl.clearWorldBossList(),targetListControl.clear(),ObjectPool.clearClass("UnitMonster"),this.onEnterScene(),SwitchSceneMgr.ins().changeScene(),SoundUtils.PLAY_OPEN_VIEW||MapControl.lastCopyId==MapControl.copyId&&!MapControl.copyId||SoundUtils.ins().playEffect(SoundUtils.TRANSFER),crossFieldControl.isCross?rambleControl.setCurListData(rambleControl.kfListData):rambleControl.setCurListData(rambleControl.chatListData2),CommonFun.checkVersion(),RecycleMgr.ins().destroy(),EventMgr.ins().dispatch(353)},e.prototype.downCreateOtherEntity=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o,n=e[t][0];if(0==t)return o=new UnitModel,o.initBase(n),UnitMgr.ins().actorList[o.handle]=o,EventMgr.ins().dispatch(354,!1),!1;if(1==t?(o=new RoleModel,o.initBase(n.slice(0,6)),o.intOtherRole(n.slice(6)),titleControl.refNewTitle(o.masterHandle)):2==t?(o=new UnitModel,o.init(n)):4==t?(o=new RoleModel,o.initBase(n.slice(0,6)),o.intOtherRole(n.slice(6)),18==MapControl.copyType&&(o.masterHandle=o.handle),titleControl.refNewTitle(o.masterHandle)):5==t?(o=new UnitModel,o.initBase(n)):6==t&&(o=new ItemModel,o.initBase(n.slice(0,6)),o.initItemData(n.slice(6,-1)),o.itemData.dropEffId=n[n.length-1]),o){UnitHideMgr.ins().onCreateEntity(o);var r=this.createEntityByModel(o);this.afterCreateOtherEntity(t,o,r)}EventMgr.ins().dispatch(354,o)},e.prototype.afterCreateOtherEntity=function(t,e,i){2==t||5==t?(16==MapControl.copyType&&(copyControl.expMonterCount+=1),mineControl.inCopy&&i&&(i.visible=!1),monsterSpeakControl.trigger(e.configID,1)):1==t?(unionWarControl.getModel().checkinAppoint()||10==MapControl.copyType)&&(e.guildID!=unionControl.guildID?unionWarControl.getModel().changecanPlayList(e.masterHandle):unionWarControl.getModel().setMyGuildNum(e.masterHandle)):4==t&&18==MapControl.copyType&&(copyControl.guideBossPlayerId=e.configID,copyControl.guideBossPlayerJob=e.job,copyControl.guideBossPlayerSex=e.sex,copyControl.guideBossPlayerName=e.name,0==copyControl.guideBossKill&&bossControl.dispatchBelongChange(e.masterHandle))},e.prototype.downGoldChange=function(t,e){if(1==t)actorControl.dispatchGoldChange(e);else if(4==t)actorControl.dispatchSoulChange(e);else if(7==t)actorControl.dispatchFeatsChange(e);else if(9==t){var i=ActorControl.runeShatter;ActorControl.runeShatter=e,ActorControl.runeShatter-i>0&&tipsControl.showTips(LangMgr.getValueByKey("scentGetZW",ActorControl.runeShatter-i)),this.dispatchRuneShatter()}else if(10==t){var o=ActorControl.runeExchange;ActorControl.runeExchange=e,o&&ActorControl.runeExchange-o>0&&tipsControl.showTips(LangMgr.getValueByKey("scentGet",ActorControl.runeExchange-o,Currency.getCurrencyName(10))),this.dispatchRuneExchange()}else 11==t?actorControl.dispatchUpdateTogeatter(e,1):12==t?actorControl.dispatchUpdateTogeatter(e,2):14==t?actorControl.dispatchWeiWang(e):15==t?actorControl.dispatchChip(e):actorControl.dispatchYbChange(e)},e.prototype.dispatchRuneShatter=function(){EventMgr.ins().dispatch(468)},e.prototype.dispatchRuneExchange=function(){EventMgr.ins().dispatch(469)},e.prototype.dispatchLevelBarChange=function(t){EventMgr.ins().dispatch(470,t)},e.prototype.dispatchAdjustMapPos=function(){EventMgr.ins().dispatch(471)},e.prototype.downHpChange=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);if(i){var o=i.infoModel,n=o.getAtt(0);o.setAtt(0,e),i.updateBlood(),0==n&&o.getAtt(0)>0&&i instanceof UnitRole&&titleControl.refNewTitle(i.infoModel.masterHandle),0>=e?(HookControl.ins().checkPlayDieSound(i),DropControl.tempDropPoint.x=Math.floor(i.x/MapControl.CELL_SIZE),DropControl.tempDropPoint.y=Math.floor(i.y/MapControl.CELL_SIZE)):1!=o.type||i.nameVisible||i.showNameAndHp(),EventMgr.ins().dispatch(355,[i,e,n])}},e.prototype.downNeiGongChange=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);i&&i.infoModel&&(i.infoModel.setAtt(25,e),i.updateNeiGong())},e.prototype.dispatchEntityHpChange=function(t,e,i,o){if((e&&0==e.team||t&&0==t.team)&&(16==i||16==(16&i)||2048==(2048&i))){var n=UIMgr.gameScene.map;DisplayUtils.shakeItFocusAttack(n,30,700)}EventMgr.ins().dispatch(472,[t,e,i,o])},e.prototype.downRemoveEntity=function(t){var e=UnitMgr.ins().getEntityByHandle(t);if(e){if(e instanceof UnitRole)e.infoModel&&4==e.infoModel.type?18==MapControl.copyType?0==copyControl.guideBossKill?(this.removeEntity(t),bossControl.dispatchBelongChange(ActorControl.handle,t,e.infoModel.name),copyControl.guideBossKill+=1):(UnitMgr.ins().removeByHandle(t,!1,!0),e.onDead(function(){e.deadDelay()}),guideControl.clickOut(),copyControl.guideBossKill+=1,bossControl.threatList.length=0,bossControl.dispatchHasAttackChange(0)):this.removeEntity(t):UnitMgr.ins().removeByHandle(t);else if(e instanceof UnitItemNameMerge)UnitMgr.ins().removeByHandle(t);else{if(this.removeEntity(t),e&&0!=e.team){var i=!1,o=UnitMgr.ins().screeningTargetByPos(e,!0);if(o&&0!=o.length){if(14==MapControl.copyType){var n=UnitMgr.ins().getEntityByHandle(gameControl.currAttackHandle);(!n||n.infoModel.getAtt(0)<=0)&&(i=!0)}}else i=!0;if(i)for(var r=UnitMgr.ins().getEntityByTeam(0),a=0,s=r;a<s.length;a++){var n=s[a];n.action!=UnitAction.RUN&&n.playAction(UnitAction.STAND)}if((1==MapControl.copyType||9==MapControl.copyType)&&e.parent){var l=e.parent.localToGlobal(e.x,e.y);copyControl.dispatchExpFly(l,50)}}18==MapControl.copyType&&(bossControl.attHandle=0,copyControl.guideBossKill&&(bossControl.winner=ActorControl.myName),guideControl.clickOut(),gameControl.dispatchChangeTarget(0))}this.dispatchRemoveEntity(t,e)}},e.prototype.dispatchRemoveEntity=function(t,e){EventMgr.ins().dispatch(356,[t,e])},e.prototype.removeEntity=function(t){var e=UnitMgr.ins().getEntityByHandle(t);e&&e.infoModel.getAtt(0)<=0?(UnitMgr.ins().removeByHandle(t,!1,!0),e.playAction(UnitAction.HIT),e.stopMove(),e.onDead(function(){e.deadDelay();var t=egret.Tween.get(e.dieTweenObj);t.wait(1e3).to({alpha:0},1e3).call(function(){DisplayUtils.removeFromParent(e)})})):UnitMgr.ins().removeByHandle(t,!0,!0)},e.prototype.downMoveEntity=function(t,e,i){var o=UnitMgr.ins().getEntityByHandle(t);o&&(o.x!=e||o.y!=i)&&MapControl.moveEntity(o,e,i,!0)},e.prototype.downStopMoveEntity=function(t,e,i){var o=UnitMgr.ins().getEntityByHandle(t);o&&(o.stopMove(),o.infoModel.getAtt(0)>0&&o.playAction(UnitAction.STAND),o.x=e,o.y=i,o==UnitMgr.ins().getNoDieRole()&&(this.dispatchMoveCamera(),MapDisplay.moveComplete(o)))},e.prototype.downSyncPos=function(t,e,i,o,n){var r=this,a=UnitMgr.ins().getEntityByHandle(t);if(a){a.stopMove();var s=void 0;switch(e){case 0:a.playAction(UnitAction.STAND),a.x=i,a.y=o,a.isMy&&(egret.callLater(function(){r.dispatchMoveCamera()},this),UnitMgr.ins().getNoDieRole()==a&&EventMgr.ins().dispatch(9,{x:a.x,y:a.y}));break;case 1:a.playAction(UnitAction.RUN),s=egret.Tween.get(a.moveTweenObj),s.to({x:i,y:o},n).call(function(){a.playAction(UnitAction.STAND)});break;case 2:a.playAction(UnitAction.STAND),s=egret.Tween.get(a.moveTweenObj),s.to({x:i,y:o},n)}}},e.prototype.dispatchMoveCamera=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=UnitMgr.ins().getNoDieRole();i&&EventMgr.ins().dispatch(357,[i.x,i.y,MapControl.mapID,MapControl.copyId])},e.prototype.dispatchMainRoleMove=function(t,e){return[t,e,MapControl.mapID,MapControl.copyId]},e.prototype.downMpChange=function(t,e){var i,o=UnitMgr.ins().getEntityByHandle(t);o&&(i=o.infoModel,i.setAtt(1,e)),EventMgr.ins().dispatch(358,i)},e.prototype.dispatchExpMc=function(t){EventMgr.ins().dispatch(359,t)},e.prototype.downTips=function(t){var e=DataCenter.ins().ServerTipsConfig[t].tips;tipsControl.showTips(e)},e.prototype.downFirstRegister=function(t){var e=DataCenter.ins().ClientGlobalConfig.welcomeItem,i=spokesPersonControl.checkBaseOpen(e.openTerm);return 2==t?void UIMgr.ins().open(RegressionView):i?(TimerMgr.ins().doTimer(1e3,1,function(){HookControl.ins().stop();var t=UnitMgr.ins().getNoDieRole(),i=UnitMgr.ins().getNpcByConfigID(e.npc.id);i&&MapControl.moveEntity(t,i.x,i.y)},this),void TimerMgr.ins().doTimer(3e3,1,function(){SwitchMgr.ins().checkOpen(1024)?UIMgr.ins().open(GuideSelectView):UIMgr.ins().open(Greet1View)},this)):void(SwitchMgr.ins().checkOpen(1024)?UIMgr.ins().open(GuideSelectView):UIMgr.ins().open(GreetView))},e.prototype.downDieNotice=function(){},e.prototype.downGuildChange=function(t,e){EventMgr.ins().dispatch(360,[t,e])},e.prototype.downOtherAttChange=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);if(i&&i.infoModel){for(var o=0;o<e.length;o++)i.infoModel.setAtt(e[o][0],e[o][1]);EventMgr.ins().dispatch(361,i)}},e.prototype.downPaoPao=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);i&&i.addBubble(e)},e.prototype.upRename=function(t){return[t]},e.prototype.downRename=function(t){0==t?(SocketConnection.ins().close(),UIMgr.ins().close(RenameView),alert(LangMgr.getValueByKey("changeName")),window.location.reload()):loginControl.showErrorTips(t)},e.prototype.dispatchChangeAttrPoint=function(t){return unionWarControl.getModel().clickTime=1,EventMgr.ins().dispatch(362),[t]},e.prototype.downFindPath=function(t,e,i,o,n){var r=Math.floor(e/MapControl.CELL_SIZE),a=Math.floor(i/MapControl.CELL_SIZE),s=Math.floor(o/MapControl.CELL_SIZE),l=Math.floor(n/MapControl.CELL_SIZE),h=MapControl.getPatch(r,a,s,l);this.upFindPathToServer(t,h)},e.prototype.upFindPathToServer=function(t,e,i){void 0===i&&(i=!0);for(var o=e?e.length:0,n=[],r=0;o>r;r++){var a=e[r];a&&(0!=r||i?n.push([a.x*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1),a.y*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1)]):n.push([a.x,a.y]))}return[t,n]},e.prototype.downBloodNumShow=function(t,e,i,o){i=-1*Math.ceil(i);var n=UnitMgr.ins().getEntityByHandle(e);if(n){var r=UnitMgr.ins().getEntityByHandle(t);r&&(0==r.team&&2==r.infoModel.type&&0>i||(r instanceof UnitRole||r.shakeIt(),gameControl.dispatchEntityHpChange(r,n,o,i)))}},e.prototype.downChangeTarget=function(t,e){this.dispatchAllAtkTarget(t,e);var i=UnitMgr.ins().getEntityByHandle(t);if(i&&i.infoModel&&i.infoModel.masterHandle==ActorControl.handle&&this.dispatchAtkTarget(e),targetListControl.isShow)return void(crazybtplayCopyControl.isShenwujindi||totemBossControl.inCopy?targetListControl.dispatchTargetListEX(t,e):targetListControl.dispatchTargetList(t,e));if(14!=MapControl.copyType&&10!=MapControl.copyType&&7!=MapControl.copyType&&105!=MapControl.copyType&&17!=MapControl.copyType&&18!=MapControl.copyType||0==e)return void(i&&i==UnitMgr.ins().getNoDieRole()&&(this.currAttackHandle=UnitMgr.ins().getRootMasterHandle(e)));var o=UnitMgr.ins().getEntityByHandle(e);if(o&&o.infoModel&&o.infoModel.masterHandle>0){var n=UnitMgr.ins().getEntityByHandle(t);if(n&&n.infoModel&&n.infoModel.masterHandle==ActorControl.handle&&this.dispatchChangeTarget(o.infoModel.masterHandle),n&&n.infoModel){var r=UnitMgr.ins().getMasterList(n.infoModel.masterHandle);if(o.infoModel.masterHandle==ActorControl.handle&&r){for(var a in r)r[a]instanceof UnitRole&&r[a].setNameTxtColor(ColorUtils.YELLOW);if(18==MapControl.copyType){if(bossControl.threatList[0]!=n.infoModel.masterHandle){var s=n.infoModel.name;if(4==n.infoModel.type){var l=s.split("\n");s=l[1]?l[1]:l[0],s=StringUtils.replaceStr(s,"0xffffff",ColorUtils.GREEN+"")}copyControl.guideBossKill&&tipsControl.showCenterTips(LangMgr.getValueByKey("ssentTakeAttack",s))}bossControl.threatList.length=0,bossControl.changeThreatList(n.infoModel.masterHandle),bossControl.dispatchHasAttackChange(0)}}}}else{var h=UnitMgr.ins().getEntityByHandle(t);h&&h.infoModel&&h.infoModel.masterHandle==ActorControl.handle&&(o&&o.infoModel?this.dispatchChangeTarget(o.infoModel.masterHandle):this.dispatchChangeTarget(0))}},e.prototype.getAtkHandle=function(t){return this.atkTarget[t]||0},e.prototype.getAtkMasterHandle=function(t){return this.masterAtkTarget[t]||0},e.prototype.dispatchChangeTarget=function(t){this.currAttackHandle=t,EventMgr.ins().dispatch(363)},e.prototype.dispatchAtkTarget=function(t){this.currHandle=t,EventMgr.ins().dispatch(364)},e.prototype.dispatchAllAtkTarget=function(t,e){EventMgr.ins().dispatch(365,[t,e])},e.prototype.onKeyClick=function(t){t==Keyboard.BACK_QUOTE&&"Test"==GlobalModel.pf&&(GMCommandView.ins().stage?GMCommandView.ins().close():GMCommandView.ins().open())},e.prototype.startPkBoss=function(){copyControl.autoPk()},e.prototype.createEntityByModel=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];var o=UnitMgr.ins().createEntity(t,e);return o&&this.addEntity(o),o},e.prototype.addEntity=function(t){t instanceof UnitRole?(t.showBlood(t.isMy||2==t.team),t.showNeigong(t.isMy),t.dir=t.x>=MapControl.MAX_WIDTH>>1?6:2):t instanceof UnitMonster&&DataCenter.ins().MonstersConfig[t.infoModel.configID]&&3==DataCenter.ins().MonstersConfig[t.infoModel.configID].type&&(t.dir=t.x>=MapControl.MAX_WIDTH>>1?6:2);var e=UIMgr.gameScene.map;e.addEntity(t)},e.prototype.charAppearEff=function(t){if(t instanceof UnitMonster){var e=DataCenter.ins().MonstersConfig[t.infoModel.configID];if(e||(e=copyControl.guanqiaMonster[t.infoModel.configID]),e&&e.createEff)for(var i in e.createEff)if(Array.isArray(e.createEff)){var o=e.createEff[i];if(2==o.type)SkillEffPlayDisplay.play(o.res,t,[t]);else{var n=ObjectPool.pop("GameMovieClip");n.x=t.x,n.y=t.y,n.playFile(PATH_SKILLEFF+o.res,1),SkillEffPlayDisplay.bottomLayer.addChild(n)}}}},e.prototype.playSkillEff=function(t,e,i,o){void 0===o&&(o=null);var n=300;if(t.wordEff&&0==e.team&&(skillControl.dispatchShowSkillWord(t.wordEff+""),skillControl.hejiLevel>0&&skillControl.isHejiSkill(t.configID)&&(skillControl.hejiEnable=!1,skillControl.setHejiCD(-1),skillControl.dispatchHejiRemove())),(1==i.length&&e!=i[0]||i.length>1)&&(e.dir=DirUtils.get8DirBy2Point(e,i[0])),t&&t.actionType&&e.playAction(t.actionType,e instanceof UnitRole?null:function(){e.action!=UnitAction.DIE&&e.playAction(UnitAction.STAND)}),!UIMgr.ins().isShow("GameSceneView"))return 0;e&&0==e.team&&t.repelDistance&&TimerMgr.ins().doTimer(350,1,this.shakeMapView,this);var r=[14],a=Math.floor(t.configID/1e3);if(!(r.indexOf(a)<0&&!UnitShowMgr.ins().checkShowSkillEffect()&&e.infoModel.masterHandle)||e.isMy||i[0].isMy){if(!t.effectId)return o&&o(),0;if(2==e.infoModel.type&&-1!=DataCenter.ins().FlameMarkConfig.skillId.indexOf(t.configID)&&e.usedLyMarkSkill(),!e.getIsShowBody())return o&&o(),0;switch(SkillEffPlayDisplay.play(t.effectId,e,[i[0]],o),TotemSkillControl.ins().checkActedFHJT(e,i),t.effType){case 3:return 700}return n}},e.prototype.shakeMapView=function(){var t=UIMgr.gameScene.map;DisplayUtils.shakeIt(t,5,250,2)},e.prototype.addOutEff=function(t,e){var i=new TransferModel;i.configID=0,i.x=t,i.y=e,i.type=101,UnitMgr.ins().createEntity(i)},e.prototype.removeOutEff=function(){UnitMgr.ins().removeTransferById(0)},e.prototype.createGuanqiaMonster=function(t,e){if(void 0===t&&(t=!0),void 0===e&&(e=!1),this.guanqiaId=copyControl.guanqiaID,MapControl.sceneInHook()&&!confrontControl.isEncounter()){var i=Math.ceil(copyControl.waveMonsterCount*Math.random()),o=copyControl.waveMonsterId.length,n=UnitMgr.ins().getEntityByMonsterId(copyControl.eliteMonsterId).length,r=UnitMgr.ins().getTeamCount(1)-n;
if(!(r>3)||e){i=10-r;for(var a=0;o>a;a++){var s=t?copyControl.rPos[a].length:1;s>3&&(s=3),i=Math.ceil(i/s);for(var l=e,h=0;s>h;h++){this.runTime=0,(!this.rPosindex[a]||this.rPosindex[a]>=copyControl.rPos[a].length)&&(this.rPosindex[a]=0);var u=this.rPosindex[a],c=[],p=copyControl.rPos[a][u],d=p.x-this.MONSTER_RADIUS,g=p.y-this.MONSTER_RADIUS;this.addMonsterToMap(c,d,g,i);for(var f=0;f<this.MONSTER_LEN;f++)for(var m=0;m<this.MONSTER_LEN;m++)if(c[f]){var v=c[f][m];if(v){var y=void 0;if(e&&l&&5>n)y=copyControl.createMonster(copyControl.eliteMonsterId),y.isElite=!0,l=!1,n+=1;else{var C=copyControl.waveMonsterId[a];y=copyControl.createMonster(C)}y.x=(d+f)*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1),y.y=(g+m)*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1);var b=isNaN(copyControl.wanderpercent)?5e3:copyControl.wanderpercent;y.isWander=1e4*Math.random()<b;var T=this.createEntityByModel(y);T.AI_STATE=4,y.effect&&T.addHalo(DataCenter.ins().EffectConfig[y.effect].fileName)}}this.rPosindex[a]++}}MapControl.sceneInHook()&&HookControl.ins().start()}}},e.prototype.addMonsterToMap=function(t,e,i,o){if(this.runTime++,this.runTime>200){var n="Level "+this.guanqiaId+" Spawn point error. mapId:"+MapControl.mapID+",mapName:"+MapControl.getFileName()+",mapTurn:"+MapControl.getTurn()+",startX:"+(e+this.MONSTER_RADIUS)+",startY:"+(i+this.MONSTER_RADIUS);return debug.log(n),void ReportData.getIns().reportClientErrorLog("MapError",n)}var r=MathUtils.limitInteger(0,this.MONSTER_LEN-1),a=MathUtils.limitInteger(0,this.MONSTER_LEN-1);if(t[r]||(t[r]=[]),t[r][a])this.addMonsterToMap(t,e,i,o);else{var s=MapControl.aStar.isWalkable(e+r,i+a);s&&(t[r][a]=1,o--),o>0&&this.addMonsterToMap(t,e,i,o)}},e.prototype.dispatchHookStateChange=function(t){this.hookState=t,EventMgr.ins().dispatch(366,t)},e.prototype.dispatchMoveEntity=function(t,e,i){void 0===i&&(i=!0),EventMgr.ins().dispatch(367,[t,e,i])},e.calculateRealAttribute=function(t,e,i,o){void 0===o&&(o={});var n,r=t.infoModel.getAtt(e),a=t.buffList;for(var s in a){n=a[s];var l=UnitMgr.ins().getRootMasterHandle(i.infoModel.handle);(3==n.effConfig.type||7==n.effConfig.type&&n.hostsHandle&&n.hostsHandle.indexOf(l)>=0)&&n.effConfig.args.d==e&&(r+=n.multRate?n.value*n.multRate:n.value)}var h=o[e]?o[e]:0;return r+h},e.triggerAttr=function(t,e,i){void 0===i&&(i={});var o=t.infoModel.attributeData[e]||0;if(o+=i[e]?i[e]:0){var n=Math.random();if(o/1e4>n)return!0}return!1},e.triggerExAttr=function(t,e,i){var o=t.infoModel.attributeExData[e];if(i&&(o+=i[e]||0),o){var n=Math.random();if(o/1e4>n)return!0}return!1},e.calBuffAttribute=function(t){var e=t.buffList,i={},o={};for(var n in e){var r=e[n];if(r.effConfig)if(3==r.effConfig.type){var a=r.effConfig.args;if(!a)continue;var s=(t.infoModel.getAtt(a.b)||0)*(a.a||0)+(a.c||0);i[a.d]=(i[a.d]||0)+(r.value?r.value:s)}else if(6==r.effConfig.type){var a=r.effConfig.args;if(!a)continue;var s=(t.infoModel.getExAtt(a.b)||0)*(a.a||0)+(a.c||0);o[a.d]=(o[a.d]||0)+(r.value?r.value:s)}}return{attr:i,exAttr:o}},e.triggerCrit=function(t,e,i){void 0===i&&(i=0);var o=t.infoModel.getAtt(7);if(t.buffList[60003]){var n=t.buffList[60003].effConfig;o+=Math.floor(n.args.c/1e4*o)}var r=o-e.infoModel.getAtt(8)+i;if(r>0){var a=Math.random();if(r/1e4>a)return!0}return!1},e.triggerMiss=function(t,e){var i=t.infoModel.getExAtt(42),o=e.infoModel.getExAtt(26),n=Math.min(o-i,4e3);if(n>0){var r=Math.random();if(n/1e4>r)return!0}return!1},e.triggerValue=function(t){if(t){var e=Math.random();if(t/1e4>e)return!0}return!1},e.prototype.downAddMonsterConfig=function(t){try{var e=JSON.parse(t);for(var i in e)DataCenter.ins().MonstersConfig[i]=e[i]}catch(o){ReportData.getIns().reportClientErrorLog("JsonError","downAddMonsterConfig")}},e.prototype.downZeroInit=function(){EventMgr.ins().dispatch(4)},e.prototype.downChangeCamp=function(t,e){var i=UnitMgr.ins().getEntityByHandle(t);i&&i.infoModel&&(i.infoModel.camp=e,i.infoModel.masterHandle==ActorControl.handle&&(campWarControl.camp=i.infoModel.camp,campWarControl.dispatchEnterSuccess()),i.setCharName(i.infoModel.guildAndName),i.updateNameColor()),EventMgr.ins().dispatch(474)},e.prototype.upChooseOldPlayer=function(){},e.prototype.downChooseOldPlayer=function(){roleControl.checkHaveCan(!0,0)},e.skyBallCheck=function(t){if(this.triggerExAttr(t,8)){var e=ObjectPool.pop("BuffModel");return e.effConfig=DataCenter.ins().SkillsEffectsConfig[SkillConst.EFF_SKY_BALL],e.addTime=egret.getTimer(),e.endTime=e.addTime+t.infoModel.getExAtt(9),t.addBuff(e),!0}return!1},e.prototype.dispatchFlyItem=function(t){EventMgr.ins().dispatch(475,t)},e.prototype.dispatchFlyItemEx=function(t){EventMgr.ins().dispatch(476,t)},e.prototype.dispatchFlyBagToItem=function(t,e,i){if(t.parent){var o=UIMgr.ins().getView("GameBottomView");if(!o)return DisplayUtils.removeFromParent(t),void(e&&i.call(e));var n=o.getBagBtn(),r=o.localToGlobal(n.x,n.y);t.parent.globalToLocal(r.x,r.y,r);var a=new egret.Point(t.x,t.y);t.x=r.x,t.y=r.y,egret.Tween.get(t).to({x:a.x,y:a.y,duration:500},1e3,egret.Ease.backOut).call(function(){DisplayUtils.removeFromParent(t),e&&i.call(e)})}else DisplayUtils.removeFromParent(t);e&&i.call(e)},e.prototype.upStopAI=function(){},e.prototype.upGetOtherAttr=function(t){return[t]},e.prototype.dispatchUpdateTargetTask=function(){},e.prototype.dispatchUpdateHpMp=function(){},e.prototype.onEnterScene=function(){this.atkTarget={},this.masterAtkTarget={}},e.HOOK_STATE_HOOK=0,e.HOOK_STATE_FIND_ENMENY=1,__decorate([up(2,[1,1])],e.prototype,"upNewRole",null),__decorate([up(255)],e.prototype,"upHeartbeat",null),__decorate([up(0,[8])],e.prototype,"upGMCommad",null),__decorate([down(3,[3,3,2,2,4,8,8])],e.prototype,"downEnterMap",null),__decorate([down(4,[2,ByteConst.UnitActors,ByteConst.UnitRoles,ByteConst.UnitMonsters,[],ByteConst.UnitRoles,ByteConst.UnitModelBases,ByteConst.UnitDropItems])],e.prototype,"downCreateOtherEntity",null),__decorate([down(5,[2,7])],e.prototype,"downGoldChange",null),__decorate([down(9,[10,10])],e.prototype,"downHpChange",null),__decorate([down(26,[10,10])],e.prototype,"downNeiGongChange",null),__decorate([down(10,[10])],e.prototype,"downRemoveEntity",null),__decorate([down(11,[10,3,3])],e.prototype,"downMoveEntity",null),__decorate([down(12,[10,3,3])],e.prototype,"downStopMoveEntity",null),__decorate([down(13,[10,2,3,3,3])],e.prototype,"downSyncPos",null),__decorate([down(15,[10,10])],e.prototype,"downMpChange",null),__decorate([down(17,[3])],e.prototype,"downTips",null),__decorate([down(18,[1])],e.prototype,"downFirstRegister",null),__decorate([down(20)],e.prototype,"downDieNotice",null),__decorate([down(21,[3,8])],e.prototype,"downGuildChange",null),__decorate([down(24,[10,[3,10]])],e.prototype,"downOtherAttChange",null),__decorate([down(25,[10,3])],e.prototype,"downPaoPao",null),__decorate([up(22,[8])],e.prototype,"upRename",null),__decorate([down(22,[1])],e.prototype,"downRename",null),__decorate([up(25,[10])],e.prototype,"dispatchChangeAttrPoint",null),__decorate([down(31,[10,3,3,3,3])],e.prototype,"downFindPath",null),__decorate([up(31,[10,[3,3]])],e.prototype,"upFindPathToServer",null),__decorate([down(32,[10,10,10,6])],e.prototype,"downBloodNumShow",null),__decorate([down(33,[10,10])],e.prototype,"downChangeTarget",null),__decorate([down(34,[8])],e.prototype,"downAddMonsterConfig",null),__decorate([down(35)],e.prototype,"downZeroInit",null),__decorate([down(36,[10,3])],e.prototype,"downChangeCamp",null),__decorate([up(41)],e.prototype,"upChooseOldPlayer",null),__decorate([down(41)],e.prototype,"downChooseOldPlayer",null),__decorate([up(33)],e.prototype,"upStopAI",null),__decorate([up(34,[[10]])],e.prototype,"upGetOtherAttr",null),e=__decorate([protocolsId(255)],e)}(BaseSystem);__reflect(GameControl.prototype,"GameControl");var GameServer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curServerTime=0,e._curClientTime=0,e._tickCount=0,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initZero=function(){this.resetDailyRedPoint(),this.checkIsFirstLogin(),EventMgr.ins().dispatch(467)},Object.defineProperty(e,"serverTime",{get:function(){return i._serverTime+egret.getTimer()},enumerable:!0,configurable:!0}),e.setServerTime=function(t){i._serverTime=DateUtils.formatMiniDateTime(t)-egret.getTimer()},e.prototype.downServerOpenDay=function(t,e,o,n,r,a,s,l,h){i.serverOpenDay=t,i._serverZeroTime=e,i._serverHeZeroTime=o,i._hefuCount=n,i.isOpenLF=r,i.kfServerIDSmall=a,i.kfServerIDBig=s,i.kfOpenTimetampSmall=l,i.kfOpenTimetampBig=h,EventMgr.ins().dispatch(466)},e.prototype.downServerTime=function(t){i.setServerTime(t),i.loginTimetamp=i.serverTime},e.prototype.upSyncServerTime=function(){},e.prototype.checkServerTime=function(t){var e=this,i=60;if(0==this._curServerTime)TimerMgr.ins().doTimer(1e3*i,0,function(){e.upSyncServerTime()},this);else{var o=t-this._curServerTime,n=Math.floor(egret.getTimer()/1e3)-this._curClientTime;1.5*n>=i&&n>=1.5*o&&Math.floor((new Date).getTime()/1e3)!=Math.floor(Date.now()/1e3)&&(this._tickCount+=1,this._tickCount>=3&&(SocketConnection.ins().close(),warnControl.show(LangMgr.getValueByKey("usewgstop"),function(){},this),EasyLoading.ins().showLoading()))}this._curServerTime=t,this._curClientTime=Math.floor(egret.getTimer()/1e3)},e.prototype.checkIsFirstLogin=function(){i.isTodayFirst=!1;var t=function(){var t=new Date(1e3*ServerStorage.ins().getValue(19)),e=new Date(i.serverTime),o=t.getFullYear()!=e.getFullYear();return o||(o=t.getMonth()!=e.getMonth()),o||(o=t.getDate()!=e.getDate()),o};(!ServerStorage.ins().getValue(19)||t())&&(i.isTodayFirst=!0,ServerStorage.ins().setValue(19,i.serverTime/1e3>>0),ServerStorage.ins().setValue(20,1),ServerStorage.ins().setBitValue(ClientSetBit.kfzhbossRed,1),ServerStorage.ins().setBitValue(ClientSetBit.newFunNotice,0),ServerStorage.ins().setBitValue(ClientSetBit.pubBossNoTipItem,0),ServerStorage.ins().setBitValue(ClientSetBit.pubBossNoTipYb,0),ServerStorage.ins().setBitValue(ClientSetBit.syBossNoTipItem,0),ServerStorage.ins().setBitValue(ClientSetBit.matchKOTips,0),ServerStorage.ins().setBitValue(ClientSetBit.matchGPTips,0),ServerStorage.ins().setBitValue(ClientSetBit.funcopen,0)),this.updateDailyRedPoint()},e.prototype.updateDailyRedPoint=function(){var t=ServerStorage.ins().getValue(41);if(!t)return void this.resetDailyRedPoint();var e=i.serverTime,o=DateUtils.getDayState(e,t*DateUtils.MS_PER_SECOND);o&&this.resetDailyRedPoint()},e.prototype.resetDailyRedPoint=function(){ServerStorage.ins().setValue(41,Math.floor(i.serverTime/DateUtils.MS_PER_SECOND)),ServerStorage.ins().setBitValue(ClientSetBit.serverBattleShop,1),amusementControl.resetActivityTips()},Object.defineProperty(e,"smallKFServOpenDay",{get:function(){return this.kfOpenTimetampSmall?this.calcDayByTimetamp(this.kfOpenTimetampSmall):0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"bigKFServOpenDay",{get:function(){return this.kfOpenTimetampBig?this.calcDayByTimetamp(this.kfOpenTimetampBig):0},enumerable:!0,configurable:!0}),e.calcDayByTimetamp=function(t){var e=DateUtils.formatMiniDateTime(t),i=DateUtils.calcDiffDay(this.serverTime,e);return t>0?i+1:0},e.loginTimetamp=0,__decorate([down(23,[3,3,3,3,0,3,3,3,3])],e.prototype,"downServerOpenDay",null),__decorate([down(14,[6])],e.prototype,"downServerTime",null),__decorate([up(14)],e.prototype,"upSyncServerTime",null),e=i=__decorate([protocolsId(255)],e);var i}(BaseSystem);__reflect(GameServer.prototype,"GameServer");var ItemData=function(){function t(){this._point=-1}return t.prototype.init=function(t){this.handle=t[0],this.configID=t[1],this.count=t[2],this.att=[];for(var e=0;e<t[3].length;e++){var i=new AttributeData(t[3][e][0],t[3][e][1]);this.att.push(i)}this.extAtt=[];for(var e=0;e<t[4].length;e++){var i=new AttributeData(t[4][e][0],t[4][e][1]);this.extAtt.push(i)}},Object.defineProperty(t.prototype,"configID",{get:function(){return this._configID},set:function(t){this.itemConfig=DataCenter.ins().ItemConfig[t],0!=t&&Assert(this.itemConfig,LangMgr.getValueByKey("bagError",t)),this._point=-1,this._configID=t,this.setCanbeUsed()},enumerable:!0,configurable:!0}),t.getStringByList=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=": ");for(var o="",n=0;n<t.length;n++)if(o+=t[n]+i,n<t.length-1)for(var r=0;e>r;r++)o+="\n";return o},t.getStringByNextList=function(t,e){for(var i="",o=0;o<t.length;o++)i+=t[o],e[o]&&(i+=e[o]),o<t.length-1&&(i+="\n");return i},Object.defineProperty(t.prototype,"point",{get:function(){return-1==this._point&&(this._point=ItemUtils.calculateBagItemScore(this)),this._point},enumerable:!0,configurable:!0}),t.prototype.setCanbeUsed=function(){this.itemConfig&&(20==ItemUtils.getType(this.itemConfig)?this.canbeUsed=superRingControl.checkCanUseByItem(this.itemConfig.id):this.canbeUsed=!1)},t.prototype.getCanbeUsed=function(){return this.canbeUsed},t.prototype.copy=function(e){e||(e=new t);var i=this;e.handle=i.handle,e.configID=i.configID,e.count=i.count,e._point=i._point,e.att=[];for(var o=0;8>o;o++){var n=new AttributeData(i.att[o].type,i.att[o].value);e.att.push(n)}e.extAtt=[];for(var o=0;8>o;o++){var n=new AttributeData(i.extAtt[o].type,i.extAtt[o].value);e.extAtt.push(n)}return e},t.prototype.reset=function(){this.handle=0,this.configID=0,this.count=0,this.att=[];for(var t=0;8>t;t++){var e=new AttributeData(0,0);this.att.push(e)}this.extAtt=[];for(var t=0;8>t;t++){var e=new AttributeData(0,0);this.extAtt.push(e)}},t}();__reflect(ItemData.prototype,"ItemData");var LookControl=function(t){function e(){var e=t.call(this)||this;return e.lookerId=0,e.addCustomEvent(354,e.onCreateEntity),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.onCreateEntity=function(t){this.checkCanLook()&&1==t.type&&t instanceof RoleModel&&t.guildID==unionControl.guildID&&this.dispatchOnlook(t.masterHandle)},e.prototype.dispatchOnlook=function(t){this.lookerId=t},e.prototype.getLookRole=function(){if(!this.lookerId)return null;var t=UnitMgr.ins().getMasterList(this.lookerId);if(!t)return null;for(var e={},i=0;i<t.length;i++){var o=t[i];o instanceof UnitRole&&(e[o.infoModel.job]=o)}var n;for(var r in e){if(e[r].getHP()>0)return e[r];n||(n=e[r])}return n},e.prototype.checkCanLook=function(){return 45==MapControl.copyType},e.prototype.checkIsCamera=function(t){if(this.checkCanLook()){var e=this.getLookRole();if(e)return e==t}return t==UnitMgr.ins().getNoDieRole()},e.prototype.clear=function(){this.lookerId=0},e}(BaseSystem);__reflect(LookControl.prototype,"LookControl");var MoveControl=function(t){function e(){var e=t.call(this)||this;return e.addCustomEvent(7,e.mapClick),e.addCustomEvent(6,e.moveComplete),e.addCustomEvent(353,e.onEnterMap),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.canMove=function(){return toseongControl.isToseong||mineControl.inCopy||campWarControl.isCampWar()&&campWarControl.canMove()||blisterControl.isPaoDian||(godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss)&&godWeaponBossControl.canMove()||crossBossControl.isKFBossBattle||devildomControl.isDevildomBattle||crossArenaControl.isKFArena&&crossArenaControl.checkFBOperat()||darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss||totemBossControl.inCopy||crazybtplayCopyControl.isShenwujindi||reincarnateStarBossControl.isInFb?!0:!1},e.prototype.mapClick=function(t){var e=t.target,i=t.x,o=t.y;99999==MapControl.copyId?(gameControl.upStopAI(),this.doMove(e,i,o)):this.canMove()&&(this.findTarget=e,(toseongControl.isToseong||godWeaponBossControl.isGwBoss||godWeaponBossControl.isGwTopBoss||campWarControl.isCampWar()||blisterControl.isPaoDian||crossBossControl.isKFBossBattle||devildomControl.isDevildomBattle||crossArenaControl.isKFArena||darkHallBossControl.isDarkHallBoss||dominateBossControl.isZhuzaiBoss||reincarnateStarBossControl.isInFb||totemBossControl.inCopy||crazybtplayCopyControl.isShenwujindi)&&gameControl.upStopAI(),this.doMove(e,i,o))},e.prototype.doMove=function(t,e,i){var o=UnitMgr.ins().getNoDieRole();if(null!=o&&!o.isHardStraight){if(t&&t.infoModel&&(100==t.infoModel.type||102==t.infoModel.type)){var n=MathUtils.getDistanceByObject(t,o);if(n<=2*MapControl.CELL_SIZE)return void this.moveComplete(o);var r=MapControl.getPosRangeRandom(t.x,t.y,DirUtils.get8DirBy2Point(t,o));e=r[0]*MapControl.CELL_SIZE+MapControl.CELL_SIZE/2,i=r[1]*MapControl.CELL_SIZE+MapControl.CELL_SIZE/2}EntrustMgr.ins().cancelEntrusTask(0),MapControl.moveTo(e,i)}},e.prototype.moveComplete=function(t){if(0==t.team&&t instanceof UnitRole){var e=UnitMgr.ins().getNoDieRole();if(e==t)if(this.findTarget&&this.findTarget.infoModel)if(100==this.findTarget.infoModel.type){var i=MapControl.CELL_SIZE;Math.abs(e.x-this.findTarget.x)<=2*i&&Math.abs(e.y-this.findTarget.y)<=2*i&&this.moveToNpc(this.findTarget.infoModel.configID)}else 102==this.findTarget.infoModel.type?(UIMgr.ins().open("MineRobView",this.findTarget.infoModel),this.findTarget=null):101==this.findTarget.infoModel.type&&(mineControl.inCopy&&mineControl.upSceneChange(this.findTarget.infoModel.configID),this.findTarget=null);else if(this.moveTar&&this.moveTar.point){var o=MapControl.point2Grip(e.x),n=MapControl.point2Grip(e.y);Math.abs(this.moveTar.point.x-o)<=2&&Math.abs(this.moveTar.point.y-n)<=2&&(this.moveTar.callback&&this.moveTar.callback(),this.moveTar=null)}}},e.prototype.moveToNpc=function(t){var e=spokesPersonTaskControl.getNpcTask(t);if(e)spokesPersonTaskControl.showNpcView(e);else{var i=DataCenter.ins().NpcBaseConfig[t],o=i.controlTarget;o&&o[0]&&UIMgr.ins().open(o[0],o[1])}this.moveTar&&this.moveTar.npc==t&&this.moveTar.callback&&this.moveTar.callback(),this.moveTar=null,this.findTarget=null},e.prototype.onEnterMap=function(){var t=this.checkIsMove();t?this.moveToTar():this.moveTar=null},e.prototype.moveToTar=function(){var t=this.moveTar;if(t.npc){var e=UnitMgr.ins().getNpcByConfigID(t.npc);e?this.mapClick({target:e,x:e.x,y:e.y}):this.moveTar=null}else t.point&&this.mapClick({target:null,x:MapControl.grip2Point(t.point.x),y:MapControl.grip2Point(t.point.y)})},e.prototype.checkIsMove=function(t){if(t=t||this.moveTar,!t)return!1;switch(t.type){case 0:return!0;case 1:return toseongControl.isToseong;case 2:return mineControl.inCopy}return!1},e.prototype.moveTo=function(t){var e=this;if(!t.npc&&!t.point)return tipsControl.showTips(LangMgr.getValueByKey("gotoTypeinex")),!1;if(null==t.type&&(t.type=1),this.checkIsMove(t))return this.moveTar=t,this.moveToTar(),!0;switch(t.type){case 1:if(!(toseongControl.enterCD<1))return tipsControl.showTips(LangMgr.getValueByKey("activitClooding",toseongControl.enterCD)),!1;warnControl.showDangerWarn(function(){e.moveTar=t,toseongControl.upEnter()});break;case 2:this.moveTar=t,DangerWarnView.cancelCall=function(){e.moveTar=null},mineControl.upIntoMine();break;default:return tipsControl.showTips(LangMgr.getValueByKey("gotoTypeinex")),!1}return!0},e}(BaseSystem);__reflect(MoveControl.prototype,"MoveControl");var MultiKillControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downFbMultiKill=function(t){EventMgr.ins().dispatch(597,t)},__decorate([down(4,[2])],e.prototype,"downFbMultiKill",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(MultiKillControl.prototype,"MultiKillControl");var PayRewardVo=function(){function t(){}return t}();__reflect(PayRewardVo.prototype,"PayRewardVo");var PayVo=function(){function t(){}return t.prototype.init=function(t){this.day=t[0]+1,this.curDayPay=t[1],this.num=t[2],this.isAwards=t[3]},t.prototype.change=function(t){this.num=t[0],this.isAwards=t[1]},t}();__reflect(PayVo.prototype,"PayVo");var PromptControl=function(t){function e(){var e=t.call(this)||this;return e.presceneid=-1,e.prefbId=-1,e.killType=0,e.picKillBoss="",e.addCustomEvent(353,e.enterMap),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.enterMap=function(){-1==this.presceneid&&(this.presceneid=MapControl.mapID),-1==this.prefbId&&(this.prefbId=MapControl.copyId);var t=DataCenter.ins().ScenesConfig[MapControl.mapID];t&&(this.checkHint(t,e.TARTYPE_SCE_IN),this.presceneid=MapControl.mapID,this.prefbId=MapControl.copyId)},e.prototype.checkHint=function(t,i,o,n){if(!t){switch(i){case e.TARTYPE_WELCOME:return this.showHint(i),!0;case e.TARTYPE_KILL_BOSS:for(var r in DataCenter.ins().PromptConfig){var a=DataCenter.ins().PromptConfig[r];if(a.target[0].guanqiaId==n.gqid)return this.showHint(i,a.image),!0}}return!1}if(t){var s=this.HitConfig(t,i);if(null!=s)return this.showHint(i,s),!0}else for(var r in o){var l=o[r],s=this.HitConfig(l,i);if(null!=s)return this.showHint(i,s),!0}return!1},e.prototype.HitConfig=function(t,i){var o=t;for(var n in DataCenter.ins().PromptConfig){var r=DataCenter.ins().PromptConfig[n];if(r.targetType==i)switch(i){case e.TARTYPE_ACH_BEF:if(o.achievementId==r.target[0].achievementId&&o.taskId==r.target[0].taskId&&r.target[0].isfull&&r.target[0].isfull>0&&backpackControl.getSurplusCount())return r.image;break;case e.TARTYPE_ACH_AFT:if(o.achievementId==r.target[0].achievementId&&o.taskId==r.target[0].taskId)return r.image;break;case e.TARTYPE_SCE_IN:if(MapControl.mapID==r.target[0].sceneid&&MapControl.copyId==r.target[0].fbId&&this.presceneid==r.target[0].presceneid&&this.prefbId==r.target[0].prefbId)return r.image}}return null},e.prototype.showHint=function(t,i){if(!i&&t==e.TARTYPE_WELCOME){var o=DataCenter.ins().PromptConfig[t];return i=o.image,void tipsControl.showHintTips(i)}i&&""!=i&&tipsControl.showHintTips(i)},e.prototype.dispatchWelcome=function(){this.checkHint(null,e.TARTYPE_WELCOME)},e.prototype.dispatchAchievementBef=function(t){t&&this.checkHint(t,e.TARTYPE_ACH_BEF)},e.prototype.dispatchAchievementAft=function(t){if(t){var i;for(var o in DataCenter.ins().GuideAchievementConfig){var n=DataCenter.ins().GuideAchievementConfig[o];if(n.achievementId==t.achievementId&&n.taskId==t.id){i=n;break}}i&&this.checkHint(i,e.TARTYPE_ACH_AFT)}},e.prototype.dispatchKillBoss=function(t){this.checkHint(t,e.TARTYPE_KILL_BOSS)},e.prototype.dispatchKillBossEx=function(t){this.checkHint(null,e.TARTYPE_KILL_BOSS,null,{gqid:t})},e.TARTYPE_WELCOME=1,e.TARTYPE_ACH_BEF=2,e.TARTYPE_ACH_AFT=3,e.TARTYPE_SCE_IN=4,e.TARTYPE_KILL_BOSS=5,e}(BaseSystem);__reflect(PromptControl.prototype,"PromptControl");var HintTargetData=function(){function t(){}return t}();__reflect(HintTargetData.prototype,"HintTargetData");var RankSubRoleVo=function(){function t(){this.pos1=0,this.pos2=0,this.pos3=0,this.deCirShowID=0,this.heirloomLv=0,this.thirteenEquipLv=0,this.weaponViewId=0,this.clothesViewId=0}return t.prototype.init=function(t){this.job=t[0],this.sex=t[1],this.clothID=t[2],this.swordID=t[3],this.wingLevel=t[4],0==t[5]&&(this.wingLevel=-1),this.pos1=t[6],this.pos2=t[7],this.pos3=t[8],this.deCirShowID=t[9],this.thirteenEquipLv=t[10],this.weaponViewType=t[11],this.weaponViewId=t[12],this.clothesViewType=t[13],this.clothesViewId=t[14]},t}();__reflect(RankSubRoleVo.prototype,"RankSubRoleVo");var RewardVo=function(){function t(){this.isRedPoint=0,this.dropEffId=0,this.dropType=0}return t.prototype.init=function(t){this.type=t[0],this.id=t[1],this.count=t[2]},t.copy=function(e){var i=new t;return i.type=e.type,i.count=e.count,i.id=e.id,i},t.getRewardsByOpenDay=function(t,e){void 0===e&&(e=GameServer.serverOpenDay+1);var i=[];for(var o in t)e>=+o&&(i=t[o].concat());return i},t.getRewardsByJob=function(t,e){if(!e){var i=heroControl.getSubRoleByIndex(0);i&&(e=i.job)}var o=[];for(var n in t)(void 0==t[n].job||t[n].job==e)&&o.push(t[n]);return o},t}();__reflect(RewardVo.prototype,"RewardVo");var SkillVo=function(){function t(t){this._specialCD=0,t&&(this.configID=t)}return Object.defineProperty(t.prototype,"lv",{get:function(){return this._id%1e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"job",{get:function(){return Math.floor(this._id%1e5/1e4)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return 1e3*Math.floor(this._id/1e3)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"icon",{get:function(){return this.id+"_png"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"configID",{get:function(){return this._id},set:function(t){this._id!=t&&(this._id=t,!Assert(DataCenter.ins().SkillsConfig,"The configuration is empty, whether the first Angle is created："+GlobalModel.isCreateRole),this.config=DataCenter.ins().SkillsConfig[t],this._preId=0/0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"preId",{get:function(){return this._preId},set:function(t){this._preId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lv1ConfigID",{get:function(){return this.id+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"castType",{get:function(){return isNaN(this.config.castType)?2:this.config.castType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetType",{get:function(){return isNaN(this.config.targetType)?2:this.config.targetType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"desc",{get:function(){var t=this.config||DataCenter.ins().SkillsConfig[this.lv1ConfigID];if(Assert(t,LangMgr.getValueByKey("godError1",this.configID)))return"";var e=DataCenter.ins().SkillsDescConfig[t.desc],i=e?e.desc:"";if(!i.length||!t.desc_ex)return i;for(var o=t.desc_ex.length,n=0;o>n;n++)i=i.replace("%s%",t.desc_ex[n]+"");return i},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"affectRange",{get:function(){return isNaN(this.config.affectRange)?1:this.config.affectRange},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"affectCount",{get:function(){return isNaN(this.config.affectCount)?1:this.config.affectCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"calcType",{get:function(){return isNaN(this.config.calcType)?1:this.config.calcType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"herdMonRate",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?isNaN(t.herdMonRate)?100:t.herdMonRate:100},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"herdPlayerRate",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?isNaN(t.herdPlayerRate)?10:t.herdPlayerRate:10},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cd",{get:function(){if(this._specialCD)return this._specialCD;var t=DataCenter.ins().SkillsDescConfig[this.descID],e=this.reviseCD?this.reviseCD:0;return t?t.cd-e:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"specialCD",{set:function(t){this._specialCD=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPassive",{get:function(){return!!this.config.passive},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rate",{get:function(){return this.config.passive&&this.config.passive.rate||0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cond",{get:function(){return this.config.passive&&this.config.passive.cond||0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"castRange",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?t.castRange:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"repelDistance",{get:function(){return this.config.repelDistance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teleport",{get:function(){return this.config.teleport},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"actionType",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?t.actionType:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tarEff",{get:function(){return this.config.tarEff},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otarEff",{get:function(){return this.config.otarEff},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selfEff",{get:function(){return this.config.selfEff},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canUse",{get:function(){return this.config&&!!this.lv},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?t.name:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"args",{get:function(){return this.config.args},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wordEff",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?t.wordEff:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"effType",{get:function(){return this.config.effType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"otherSkills",{get:function(){return this.getOtherSkills(!0)},enumerable:!0,configurable:!0}),t.prototype.getOtherSkills=function(t){if(!this.config)return null;var e=[];if(this.config.otherSkills)for(var i in this.config.otherSkills){var o=this.config.otherSkills[i];t?GameControl.triggerValue(o.rate)&&e.push(o.id):e.push(o.id)}return e},Object.defineProperty(t.prototype,"effectId",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?t.effectId:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sound",{get:function(){var t=DataCenter.ins().SkillsDescConfig[this.descID];return t?t.sound:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"die_summoner",{get:function(){return this.config?this.config.die_summoner:[]},enumerable:!0,configurable:!0}),t.getSkillByJob=function(e,i,o){return void 0===i&&(i=1),void 0===o&&(o=1),new t(1e4*e+1e3*i+o)},Object.defineProperty(t.prototype,"descID",{get:function(){var t=DataCenter.ins().SkillsConfig[this.configID]||DataCenter.ins().SkillsConfig[this.lv1ConfigID];return t?t.desc:0},enumerable:!0,configurable:!0}),t.reviseDp=function(t,e){if(isNaN(e))return null;if(this.storeSkillReviDp[t])return this.storeSkillReviDp[t];var i=crazyDogControl.getLinkSkillReviseCfg(t);this.pushSkillReviDp(i,t);for(var o,n=totemControl.getSkillReviseId(e,t),r=0;r<n.length;r++){var a=n[r];o?this.mergeReviDp(o,DataCenter.ins().SkillsCommonReviseConfig[a]):o=CommonUtils.copyDataDepth(DataCenter.ins().SkillsCommonReviseConfig[a])}return this.pushSkillReviDp(o,t),this.storeSkillReviDp[t]},t.pushSkillReviDp=function(t,e){t&&(this.storeSkillReviDp[e]?this.mergeReviDp(this.storeSkillReviDp[e],t):this.storeSkillReviDp[e]=CommonUtils.copyDataDepth(t))},t.mergeReviDp=function(t,e){for(var i in t)"skill"!=i&&"id"!=i&&("selfEff"==i||"targetEff"==i||"args"==i||"desc"==i?t[i]&&t[i].concat(e[i]):t[i]+=e[i])},t.storeSkillReviDp={},t}();__reflect(SkillVo.prototype,"SkillVo");var ArrowEffect=function(t){function e(){var e=t.call(this)||this;return e.otherMc=[],e.init(),e}return __extends(e,t),e.prototype.init=function(){this._effGroup=new eui.Group,this.addChild(this._effGroup),this._arrowGroup=new eui.Group,this.addChild(this._arrowGroup),this._effCir=new GameMovieClip,this._effGroup.addChild(this._effCir),this._arrow=new GuideArrow2,this._arrowGroup.addChild(this._arrow),this.touchChildren=!1,this.touchEnabled=!1},e.prototype.show=function(t,e,i){void 0===i&&(i=0),this._isShow||(this._isShow=!0,egret.Tween.removeTweens(this),this.alpha=0,egret.Tween.get(this).to({alpha:1},300),this.x=e.width>>1,this.y=e.height>>1,e.addChild(this),this._arrow.setDirection(i),this._effCir.playFile(PATH_EFF+"guideff",-1)),this._arrow.setTips(t)},e.prototype.showTapOutEff=function(){var t=this;this.otherMc.length=2;for(var e=function(e){t.otherMc[e]||(t.otherMc[e]=new GameMovieClip),t.otherMc[e].parent||t.addChild(t.otherMc[e]),t.otherMc[e].scaleX=3.3,t.otherMc[e].scaleY=3.3,t.otherMc[e].x=0,t.otherMc[e].y=0;var i=egret.Tween.get(t.otherMc[e]);i.wait(240*e).call(function(){t.otherMc[e].playFile(PATH_EFF+"forceguildeff",1,function(){egret.Tween.removeTweens(t.otherMc[e]),DisplayUtils.removeFromParent(t.otherMc[e])})})},i=0;i<this.otherMc.length;i++)e(i)
},e.prototype.hide=function(){this._isShow&&(this._isShow=!1,this._arrow.removeTweens(),this.parent&&this.parent.removeChild(this))},e.prototype.isShow=function(){return this._isShow},e}(egret.DisplayObjectContainer);__reflect(ArrowEffect.prototype,"ArrowEffect");var BitmapNumber=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._imgPool=[],e._containerPool=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.createNumPic=function(t,e,i,o){void 0===i&&(i=0),void 0===o&&(o=0);for(var n,r=this.getContainer(),a=t.toString(),s=0;s<a.length;s++)n=this.getSingleNumPic(a.charAt(s),e),r.addChild(n);return this.repositionNumPic(r,i,o),r},e.prototype.desstroyNumPic=function(t){this.clearContainer(t),t.parent&&t.parent.removeChild(t),this._containerPool.push(t)},e.prototype.changeNum=function(t,e,i,o,n){void 0===o&&(o=0),void 0===n&&(n=0);var r=e.toString();if(t.numChildren>r.length)for(;t.numChildren>r.length;)this.recycleBM(t.getChildAt(t.numChildren-1));for(var a,s=0;s<r.length;s++)s>=t.numChildren&&t.addChild(this.getBitmap()),a=r.charAt(s),a="."==a?"dot":a,t.getChildAt(s).texture=this.getTexture(a,i);this.repositionNumPic(t,o,n)},e.prototype.repositionNumPic=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=0);for(var o,n=0,r=0;r<t.numChildren;r++)o=t.getChildAt(r),o.x=n-e,n=o.x+o.width},e.prototype.clearContainer=function(t){for(;t.numChildren;)this.recycleBM(t.getChildAt(t.numChildren-1))},e.prototype.recycleBM=function(t){t&&t.parent&&(t.parent.removeChild(t),t.texture=null,this._imgPool.push(t))},e.prototype.getContainer=function(){return this._containerPool.length?this._containerPool.shift():new egret.DisplayObjectContainer},e.prototype.getSingleNumPic=function(t,e){"."==t&&(t="dot");var i=this.getBitmap(),o=this.getTexture(t,e);return o?i.texture=o:this.getTextureAsync(t,e,i),i},e.prototype.getTexture=function(t,e){return RES.getRes(e+t+"_png")},e.prototype.getTextureAsync=function(t,e,i){RES.getResAsync(e+t+"_png",function(t){i.texture=t},void 0)},e.prototype.getBitmap=function(){return this._imgPool.length?this._imgPool.shift():new egret.Bitmap},e}(SingleClass);__reflect(BitmapNumber.prototype,"BitmapNumber");var BossAttackButton=function(t){function e(){var e=t.call(this)||this;return e.skinName="BossAttackButtonSkin",e}return __extends(e,t),e}(eui.Component);__reflect(BossAttackButton.prototype,"BossAttackButton");var DropDown=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.touchEnabled=!0,this.currentState="up",this.addEventChange(this.list,this.listSelect),this.addEventTouchTap(this,this.onTap),this.addEventRemovedFromStage(this,this.removeStage),this.dataPro=new eui.ArrayCollection,this.list.itemRenderer=DropDownListItem,this.list.dataProvider=this.dataPro},e.prototype.listSelect=function(t){this.list.selectedItem&&(this.value.text=this.list.selectedItem.name)},e.prototype.removeStage=function(t){this.stage&&this.removeEventTouchTap(this.stage,this.onTap)},e.prototype.onTap=function(t){this.currentState="up"==this.currentState?"down":"up",this.listSelect(null),t.stopPropagation(),this.stage&&("down"==this.currentState?this.addEventTouchTap(this.stage,this.onTap):this.removeEventTouchTap(this.stage,this.onTap))},e.prototype.setData=function(t){this.dataPro.replaceAll(t)},e.prototype.setSelectedIndex=function(t){this.list.selectedIndex=t},e.prototype.getSelectedIndex=function(){return this.list.selectedIndex},e.prototype.getSelectedItemData=function(){return this.list.selectedItem},e.prototype.setLabel=function(t){this.value.text=t},e.prototype.getLabel=function(){return this.value.text},e.prototype.setEnabled=function(t){this.list.touchEnabled=t,this.list.touchChildren=t},e.prototype.getEnabled=function(){return this.list.touchEnabled},e.prototype.destructor=function(){this.removeEventChange(this.list,this.listSelect),this.removeEventTouchTap(this,this.onTap),this.removeEventRemovedFromStage(this,this.removeStage),this.removeStage()},e}(BasePanel);__reflect(DropDown.prototype,"DropDown");var DropDownListItem=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.nameLbl.text=this.data.name},e}(BaseItemRender);__reflect(DropDownListItem.prototype,"DropDownListItem");var EasyLoading=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.init=function(){t.prototype.init.call(this),SocketConnection.ins().setOnClose(this.showLoading,this),SocketConnection.ins().setOnConnected(this.hideLoading,this)},e}(StartLoading);__reflect(EasyLoading.prototype,"EasyLoading");var GainGoodsItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="GainGoodsItemSkin",e.graycolor=LangMgr.getColor("color86"),e}return __extends(e,t),e.prototype.dataChanged=function(){this.greencolor=this.desc.textColor,this.norcolor=this.desc2.textColor,this.desc.text=this.data[0]},e.prototype.gainData=function(t,e,i){if(this.stars.visible=!0,t)for(var o=1;5>=o;o++)this["star"+o].visible=e>=o;else{if(this.desc.textColor=this.graycolor,this.desc2.textColor=this.graycolor,i){var n="";i.needZs&&(n+=LangMgr.getValueByKey("warnTips3",i.needZs)),i.needLv&&(n+=LangMgr.getValueByKey("tipsOpenLevel",i.needLv)),i.guanka&&(n+=LangMgr.getValueByKey("warnTips3",i.guanka)),this.desc2.text=n}this.dir.visible=!1;for(var o=1;5>=o;o++)this["star"+o].visible=!1}},e}(BaseItemRender);__reflect(GainGoodsItem.prototype,"GainGoodsItem");var GainGoodsNoSkinItem=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.desc.text=this.data[0]},e}(BaseItemRender);__reflect(GainGoodsNoSkinItem.prototype,"GainGoodsNoSkinItem");var ItemBaseNoName=function(t){function e(){var e=t.call(this)||this;return e.isShowName(!1),e.touchChildren=!1,e}return __extends(e,t),e}(ItemBase);__reflect(ItemBaseNoName.prototype,"ItemBaseNoName");var ItemBaseNoNameCanTap=function(t){function e(){var e=t.call(this)||this;return e.isShowName(!1),e}return __extends(e,t),e}(ItemBase);__reflect(ItemBaseNoNameCanTap.prototype,"ItemBaseNoNameCanTap");var ItemBaseNoTap=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.onClick=function(){},e}(ItemBase);__reflect(ItemBaseNoTap.prototype,"ItemBaseNoTap");var ItemBaseTimes=function(t){function e(){var e=t.call(this)||this;return e.skinName="ItemTimesSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.item.data=this.data,isNaN(this.data.tag)?this.tagImg.source=null:this.tagImg.source="tag_multi_"+this.data.tag)},e}(BaseItemRender);__reflect(ItemBaseTimes.prototype,"ItemBaseTimes");var ItemIcon=function(t){function e(){var e=t.call(this)||this;return e.skinName="ItemIconSkin",e}return __extends(e,t),e.prototype.setSoul=function(t){this.tag.visible=t},e.prototype.setData=function(t){if(this.config=t,null!=t){this.imgIcon.source=t.icon+"_png",this.imgBg.source="quality"+ItemUtils.getQuality(t);var e=ItemUtils.getType(t),i=ItemUtils.getJob(t);this.imgJob.source=(0==e||4==e)&&i&&this.imgJob.visible?"job"+i+"Item":"",DataCenter.ins().ClientGlobalConfig.effectItems.indexOf&&DataCenter.ins().ClientGlobalConfig.effectItems.indexOf(t.id)>=0&&(null==this.effect&&(this.effect=new GameMovieClip,this.effect.x=35,this.effect.y=35,this.addChildAt(this.effect,2),this.effect.addEventListener(egret.Event.ADDED_TO_STAGE,this.resumePlay,this)),this.effect.playFile(PATH_EFF+"quality_0"+ItemUtils.getQuality(t)))}else this.imgIcon.source="",this.imgBg.source="quality0",this.imgJob.source=""},e.prototype.resumePlay=function(t){this.effect.play(-1)},e.prototype.setActived=function(t){this.actived.visible=t},e.prototype.setImgBg1=function(t){this.imgBg1.visible=!0,this.imgBg.visible=!this.imgBg1.visible,t&&(this.imgBg1.source=t)},e.prototype.setJobImg=function(t){t&&(this.imgJob.visible=!0,this.imgJob.source="job"+t+"Item")},e}(BaseItemRender);__reflect(ItemIcon.prototype,"ItemIcon");var PriceIcon=function(t){function e(){var e=t.call(this)||this;return e.skinName="PriceIconSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.priceLabel.textColor=ColorUtils.NORMAL_COLOR},e.prototype.getPrice=function(){return this._price},e.prototype.setPrice=function(t,e){if(void 0===e&&(e=-1),t!=this._price||-1!=e)if(this._price=t,e>=0){var i="";i=e>=t?ColorUtils.GREEN_COLOR:ColorUtils.RED_COLOR,this.priceLabel.textFlow=TextUtils.generateTextFlow("<font color="+i+">"+e+"</font><font color="+ColorUtils.WHITE_COLOR+">/"+t+"</font> ")}else this.priceLabel.text=""+this._price},e.prototype.setText=function(t){this.priceLabel.textFlow=(new egret.HtmlTextParser).parser(t)},e.prototype.setData=function(t){var e="";if(t){var i=t;if(0==i.type)switch(i.id){case 0:e="exp_png";break;case 1:e="szjinbi";break;case 2:e="szyuanbao";break;case 3:e="fame";break;case 4:e="soul";break;case 5:e="yumao_png";break;case 10:e="500008_png"}else if(1==i.type)switch(i.id){case 200001:e="yumao_png";break;case 200002:e="forge";break;case 200003:e="gem";break;case 200004:e="spirit";break;case 200005:e="vigor";break;case 200006:e="shield"}this._type=i.id,this.setPrice(i.count)}else if(t){var o=t;switch(o.itemConfig.id){case 200001:e="yumao_png";break;case 200002:e="szyuanbao";break;case 200003:e="szyuanbao";break;case 200004:e="szyuanbao";break;case 200005:e="szyuanbao";break;case 200006:e="szyuanbao"}this._type=o.itemConfig.id,this.setPrice(o.count)}this.iconImg.source=e},e.prototype.getType=function(){return this._type},e.prototype.setType=function(t){if(this._type!=t){this._type=t;var e="";switch(this._type){case 0:e="exp";break;case 1:e="szjinbi";break;case 2:e="szyuanbao";break;case 3:e="fame";break;case 4:e="soul";break;case 5:e="yumao_png"}this.iconImg.source=e}},Object.defineProperty(e.prototype,"labelColor",{get:function(){return this._labelColor},set:function(t){this._labelColor!=t&&(this._labelColor=t,this.priceLabel.textColor=this._labelColor)},enumerable:!0,configurable:!0}),e}(BaseItemRender);__reflect(PriceIcon.prototype,"PriceIcon");var ProgressBarEff=function(t){function e(i){void 0===i&&(i=e.TYPE_ORANGE);var o=t.call(this)||this;return o.group=new eui.Group,o.bgmc=new GameMovieClip,o.xianmc=new GameMovieClip,o.bordermc=new GameMovieClip,o.lbvalue=new eui.Label,o.bgimg=new eui.Image,o.bgRect=new eui.Rect,o.isFisrt=!0,o.maxValue=0,o.value=0,o.isPlayMc=!0,o.offSetX=23,o.mcWidth=460,o.bgWidth=525,o.oldMaxValue=0,o.oldValue=0,o._proSkin=i,o.iniUi(),o}return __extends(e,t),e.prototype.iniUi=function(){this.touchEnabled=this.touchChildren=!1,this.bgRect=new eui.Rect,this.bgRect.width=this.mcWidth,this.bgRect.height=20,this.bgRect.fillColor=1051142,this.bgRect.x=50,this.bgRect.y=22,this.addChild(this.bgRect),this.group.x=50,this.group.y=22,this.group.width=0,this.group.height=50,this.group.scrollEnabled=!0,this.bgmc.playFile(PATH_EFF+this._proSkin,-1),this.addChild(this.group),this.group.addChild(this.bgmc),this.xianmc.playFile(PATH_EFF+"jindutiaotoueff",-1),this.xianmc.x=this.group.x+this.group.width-this.offSetX,this.xianmc.y=10,this.xianmc.scrollRect=new egret.Rectangle(0,0,24,39),this.addChild(this.xianmc),this.bgimg.x=14,this.bgimg.y=13,this.bgimg.source="jingyantiao1",this.bgimg.scale9Grid=new egret.Rectangle(54,0,13,37),this.bgimg.width=this.bgWidth,this.addChild(this.bgimg),this.lbvalue.x=this.bgimg.x+(this.bgimg.width-200)/2,this.lbvalue.y=22,this.lbvalue.size=16,this.lbvalue.width=200,this.lbvalue.textAlign="center",this.lbvalue.textColor=16772040,this.addChild(this.lbvalue)},e.prototype.setData=function(t,e){this.value=t,this.maxValue=e,this.setui()},e.prototype.setWidth=function(t){this.bgWidth=t,this.bgimg.width=this.bgWidth,this.lbvalue.x=this.bgimg.x+(this.bgimg.width-200)/2;var i=t/e.DEFAULT_WIDTH;this.bgmc.scaleX=i,this.mcWidth=this.bgWidth-2*(this.group.x-this.bgimg.x),this.bgRect.width=this.mcWidth},e.prototype.setEffXY=function(t,e){this.bgmc.x=this.bgmc.scaleX*t,this.bgmc.y=e},e.prototype.setValue=function(t){this.value=t,this.setui()},e.prototype.getValue=function(){return this.value},e.prototype.getMaxValue=function(){return this.maxValue},e.prototype.reset=function(){this.rePlayMc(),this.isFisrt=!0,this.oldValue=this.oldMaxValue=this.value=this.maxValue=0},e.prototype.rePlayMc=function(){this.xianmc.playFile(PATH_EFF+"jindutiaotoueff",-1),this.bgmc.playFile(PATH_EFF+this._proSkin,-1)},e.prototype.setProgressSkin=function(t){this._proSkin=t,this.bgmc.playFile(PATH_EFF+this._proSkin,-1)},e.prototype.setMaxValue=function(t){this.maxValue=t,this.setui()},e.prototype.setui=function(){var t=this;if(egret.Tween.removeTweens(this.group),0==this.maxValue?(this.value=100,this.maxValue=100,this.lbvalue.visible=!1):this.lbvalue.visible=!0,(this.maxValue>this.oldMaxValue&&0!=this.oldMaxValue||0==this.maxValue||this.value<this.oldValue)&&!this.isFisrt){var e=this.oldMaxValue/this.oldMaxValue*this.mcWidth,i=(this.value/this.oldMaxValue*this.mcWidth,30),o=this.group.x,n=this.group.width,r=egret.Tween.get(this.group,{onChange:function(){t.group.width>=t.mcWidth-3||t.group.width<3?t.xianmc.visible=!1:t.xianmc.visible=!0,t.xianmc.x=o+n-t.offSetX}});r.to({width:e},150+i).call(function(){var e=egret.Tween.get(t.group),o=t.value/t.maxValue*t.mcWidth;t.group.width=0,t.oldValue=t.value,t.oldMaxValue=t.maxValue,e.to({width:o},150+i).call(function(){t.xianmc.x=t.group.x+o-t.offSetX})})}else{this.oldValue=this.value;var a=0;if(this.value<=0)a=0;else{var s=this.value>this.maxValue?this.maxValue:this.value;a=s/this.maxValue*this.mcWidth}var r=egret.Tween.get(this.group,{onChange:function(){t.group.width>=t.mcWidth-3||t.group.width<3?t.xianmc.visible=!1:t.xianmc.visible=!0,t.xianmc.x=t.group.x+t.group.width-t.offSetX}});r.to({width:a},200).call(function(){t.oldMaxValue=t.maxValue})}return this.lbvalue.text=this.value+"/"+this.maxValue,this.isFisrt?void(this.isFisrt=!1):void 0},e.prototype.max=function(){this.maxValue=0,this.setui(),this.lbvalue.visible=!0,this.lbvalue.text=""},e.prototype.setLbValueText=function(t){this.setui(),this.lbvalue.visible=!0,this.lbvalue.text=t},e.prototype.setStroke=function(t,e){this.lbvalue.stroke=e,this.lbvalue.strokeColor=t},e.TYPE_GREEN="jindutiaoeff1",e.TYPE_ORANGE="jindutiaoeff",e.DEFAULT_WIDTH=525,e.DEFAULT_MC_WIDTH=460,e}(egret.DisplayObjectContainer);__reflect(ProgressBarEff.prototype,"ProgressBarEff");var SkillEffPlayDisplay=function(){function t(){}return Object.defineProperty(t,"urlSkill",{get:function(){return""+PATH_SKILLJSON},enumerable:!0,configurable:!0}),Object.defineProperty(t,"urlSkillEff",{get:function(){return""+PATH_SKILLEFF},enumerable:!0,configurable:!0}),t.playConfigs=function(e,i){var o=this;if(!this.setTimeout)return void debug.warn("SkillEffPlayDisplay.setTimeout Is not set");for(var n=function(n){var a=e[n];a=SkillEffConfig.initValue(a),r.setTimeout(a.delay/i.rate,function(){if(a.type>50){var e=o["type"+a.type];return void(e&&e.call(o,i,a))}var n=ObjectPool.pop("GameMovieClip");n.rate=a.playSpeed*(a.isRate?i.rate:1);var r=t.urlSkillEff+a.effectId+(a.isDirN?"":a.isDir?DirUtils.get5DirBy8Dir(i.initParam.dir):""),s=r+i.append;if(n.playFile(s,a.playCount,function(){o.removeMC(n)}),n.x=a.x,n.y=a.y,i.offset&&(n.x+=i.offset.x,n.y+=i.offset.y),"string"==typeof a.rotation){var l=a.rotation+"",h=l.split("|"),u=+h[0],c=+h[1]-+h[0];n.rotation=Math.random()*c+u}else n.rotation=a.rotation;n.scaleX=a.scaleX*(a.isDir&&DirUtils.isScaleX(i.initParam.dir)?-1:1),n.scaleY=a.scaleY,n.alpha=a.alpha,n.anchorOffsetX=a.cx,n.anchorOffsetY=a.cy;var p=a.layer;if(a.dirPos.length&&a.dirPos[i.initParam.dir]){var d=a.dirPos[i.initParam.dir];isNaN(d.x)||(n.x+=d.x),isNaN(d.y)||(n.y+=d.y),isNaN(d.layer)||(p=d.layer),isNaN(d.rotation)||(n.rotation+=d.rotation),isNaN(d.scaleX)||(n.scaleX=d.scaleX),isNaN(d.scaleY)||(n.scaleY=d.scaleY),isNaN(d.cx)||(n.anchorOffsetX=d.cx),isNaN(d.cy)||(n.anchorOffsetY=d.cy)}if(a.isRot&&i.target){var g=a.isInit?{x:i.initParam.tar[0].x,y:i.initParam.tar[0].y}:i.target[0],f=MathUtils.getAngle(MathUtils.getRadian2(i.source.x,i.source.y,g.x,g.y));n.rotation=f+n.rotation}i.mc=n;var m=o["layer"+p];m&&m.call(o,i);var v=o["type"+a.type];if(v&&v.call(o,i,a),a.tween.length>0)for(var y=egret.Tween.get(n),C=0;C<a.tween.length;C+=2){var b=a.tween[C];if(1==b.tweenType){var T={};for(var w in b)"tweenType"!=w&&(T[w]=(n[w]||0)+b[w]);y.to(T,a.tween[C+1].time)}else void 0!=b.tweenType&&delete b.tweenType,y.to(b,a.tween[C+1].time)}},r)},r=this,a=0;a<e.length;a++)n(a)},t.play=function(t,e,i,o,n,r,a){var s=this;void 0===i&&(i=[]),void 0===o&&(o=null),void 0===n&&(n=1),void 0===r&&(r=null),void 0===a&&(a="");var l=""+this.urlRoot+this.urlSkill+t+".json";RES.getResByUrl(l,function(l){if(!l)return void debug.log("You don't have that skill- "+t);var h=new EffParam;h.initParam={dir:e.dir,x:e.x,y:e.y,tar:[]};for(var u=0;i&&u<i.length;u++)h.initParam.tar.push({dir:i[u].dir,x:i[u].x,y:i[u].y});h.source=e,h.target=i,h.hitFun=o,h.rate=n,h.offset=r,h.append=a,s.playConfigs(l,h)},this,RES.ResourceItem.TYPE_JSON)},t.type1=function(t,e){var i=this,o=t.target,n=t.source,r=t.mc,a=t.hitFun,s=e.isInit?{x:t.initParam.tar[0].x,y:t.initParam.tar[0].y}:o[0],l=egret.Tween.get(r),h=e.dis||MathUtils.getDistanceByObject(n,s);e.sDis&&(h+=e.sDis);var u=MathUtils.getAngle(MathUtils.getRadian2(n.x,n.y,s.x,s.y))+e.range;if(e.sDis){var c=MathUtils.getDirMove(u,e.sDis);r.x+=c.x,r.y+=c.y}var p=MathUtils.getDirMove(u,h,r.x,r.y);l.to({x:p.x,y:p.y},h/e.moveSpeed*1e3).call(function(){i.removeMC(r),e.hit&&a&&a(e.probability),e.exEff&&i.play(e.exEff,n,o,a,1,null,t.append)})},t.removeMC=function(t){t.destroy()},t.type96=function(t,e){if(!this.shake)return void debug.warn("SkillEffPlayDisplay.shake Is not set");var i=t.source;this.shake(i,e.range,e.time,e.playCount,e.probability)},t.type97=function(t,e){var i=t.target,o=t.source;if(0==MapControl.copyType){i[0].stopMove();var n=(i[0]==UnitMgr.ins().getNoDieRole(),e.dis||MathUtils.getDistanceByObject(o,i[0])),r=MathUtils.getAngle(MathUtils.getRadian2(o.x,o.y,i[0].x,i[0].y)),a=MathUtils.getDirMove(r,n,i[0].x,i[0].y),s=Bresenham.canThrough(MapControl.aStar,MapControl.point2Grip(i[0].x),MapControl.point2Grip(i[0].y),MapControl.point2Grip(a.x),MapControl.point2Grip(a.y));if(0==s[0]&&(MapControl.point2Grip(i[0].x)==s[2]&&MapControl.point2Grip(i[0].y)==s[3]?(a.x=i[0].x,a.y=i[0].y):(a.x=MapControl.grip2Point(s[2]),a.y=MapControl.grip2Point(s[3]))),a.x=Math.max(Math.min(a.x,MapControl.MAX_WIDTH),0),a.y=Math.max(Math.min(a.y,MapControl.MAX_HEIGHT),0),n=MathUtils.getDistanceByObject(i[0],a),!(0>=n)){var l=egret.Tween.get(i[0].moveTweenObj);l.to({x:a.x,y:a.y},n/e.moveSpeed*1e3)}}},t.type98=function(t,e){var i=t.target,o=t.source;if(0==MapControl.copyType){o.stopMove();var n=(o==UnitMgr.ins().getNoDieRole(),e.dis||MathUtils.getDistanceByObject(o,i[0])),r=MathUtils.getAngle(MathUtils.getRadian2(o.x,o.y,i[0].x,i[0].y)),a=MathUtils.getDirMove(r,n,i[0].x,i[0].y),s=Bresenham.canThrough(MapControl.aStar,MapControl.point2Grip(i[0].x),MapControl.point2Grip(i[0].y),MapControl.point2Grip(a.x),MapControl.point2Grip(a.y));if(0==s[0]&&(MapControl.point2Grip(i[0].x)==s[2]&&MapControl.point2Grip(i[0].y)==s[3]?(a.x=i[0].x,a.y=i[0].y):(a.x=MapControl.grip2Point(s[2]),a.y=MapControl.grip2Point(s[3]))),a.x=Math.max(Math.min(a.x,MapControl.MAX_WIDTH),0),a.y=Math.max(Math.min(a.y,MapControl.MAX_HEIGHT),0),n=MathUtils.getDistanceByObject(i[0],a),!(0>=n)){a=MathUtils.getDirMove(r,n,o.x,o.y);var l=egret.Tween.get(o.moveTweenObj);l.to({x:a.x,y:a.y},n/e.moveSpeed*1e3)}}},t.type99=function(t,e){var i=t.hitFun;i&&i(e.probability)},t.layer0=function(t){var e=t.source,i=t.mc;return i.x+=e.x,i.y+=e.y,this.bottomLayer?void this.bottomLayer.addChild(i):void debug.warn("SkillEffPlayDisplay.bottomLayer Is not set")},t.layer1=function(t){var e=t.source,i=t.mc;e.addChildAt(i,0)},t.layer2=function(t){var e=t.source,i=t.mc;e.addChild(i)},t.layer3=function(t){var e=t.source,i=t.mc;return i.x+=e.x,i.y+=e.y,this.topLayer?void this.topLayer.addChild(i):void debug.warn("SkillEffPlayDisplay.topLayer Is not set")},t.layer4=function(t){var e=t.target,i=t.mc;return i.x+=e[0].x,i.y+=e[0].y,this.bottomLayer?void this.bottomLayer.addChild(i):void debug.warn("SkillEffPlayDisplay.bottomLayer Is not set")},t.layer5=function(t){var e=t.target,i=t.mc;e[0].addChildAt(i,0)},t.layer6=function(t){var e=t.target,i=t.mc;e[0].addChild(i)},t.layer7=function(t){var e=t.target,i=t.mc;return i.x+=e[0].x,i.y+=e[0].y,this.topLayer?void this.topLayer.addChild(i):void debug.warn("SkillEffPlayDisplay.topLayer Is not set")},t.layer8=function(t){return this.fixedLayer?void this.fixedLayer.addChild(t.mc):void debug.warn("SkillEffPlayDisplay.topLayer Is not set")},t.urlRoot="",t}();__reflect(SkillEffPlayDisplay.prototype,"SkillEffPlayDisplay");var EffParam=function(){function t(){this.append="",this.rate=1}return t}();__reflect(EffParam.prototype,"EffParam");var SkillEffConfig=function(){function t(){this.type=0,this.delay=0,this.layer=3,this.x=0,this.y=0,this.effectId=0,this.playSpeed=1,this.scaleX=1,this.scaleY=1,this.rotation=0,this.isDir=0,this.isDirN=0,this.moveSpeed=100,this.playCount=1,this.dis=0,this.sDis=0,this.alpha=1,this.isRot=0,this.hit=0,this.cx=0,this.cy=0,this.range=0,this.time=0,this.isRate=0,this.isInit=0,this.probability=1,this.exEff="",this.dirPos=[],this.tween=[]}return t.initValue=function(t){return t.__proto__=this.o,t},t.o=new t,t}();__reflect(SkillEffConfig.prototype,"SkillEffConfig");var SkillEffPlayShow=function(){function t(){}return Object.defineProperty(t,"urlSkill",{get:function(){return""+PATH_SKILLJSON},enumerable:!0,configurable:!0}),Object.defineProperty(t,"urlSkillEff",{get:function(){return""+PATH_SKILLEFF},enumerable:!0,configurable:!0}),t.playConfigs=function(e,i){var o=this;if(!this.setTimeout)return void debug.warn("SkillEffPlayShow.setTimeout Is not set");for(var n=function(n){var a=e[n];a=SkillEffConfig.initValue(a),r.setTimeout(a.delay/i.rate,function(){if(a.type>50){var e=o["type"+a.type];return void(e&&e.call(o,i,a))}var n=ObjectPool.pop("GameMovieClip");n.rate=a.playSpeed*(a.isRate?i.rate:1);var r=t.urlSkillEff+a.effectId+(a.isDirN?"":a.isDir?DirUtils.get5DirBy8Dir(i.initParam.dir):""),s=r+i.append;if(n.playFile(s,a.playCount,function(){o.removeMC(n)}),n.x=a.x,n.y=a.y,i.offset&&(n.x+=i.offset.x,n.y+=i.offset.y),"string"==typeof a.rotation){var l=a.rotation+"",h=l.split("|"),u=+h[0],c=+h[1]-+h[0];n.rotation=Math.random()*c+u}else n.rotation=a.rotation;n.scaleX=a.scaleX*(a.isDir&&DirUtils.isScaleX(i.initParam.dir)?-1:1),n.scaleY=a.scaleY,n.alpha=a.alpha,n.anchorOffsetX=a.cx,n.anchorOffsetY=a.cy;var p=a.layer;if(a.dirPos.length&&a.dirPos[i.initParam.dir]){var d=a.dirPos[i.initParam.dir];isNaN(d.x)||(n.x+=d.x),isNaN(d.y)||(n.y+=d.y),isNaN(d.layer)||(p=d.layer),isNaN(d.rotation)||(n.rotation+=d.rotation),isNaN(d.scaleX)||(n.scaleX=d.scaleX),isNaN(d.scaleY)||(n.scaleY=d.scaleY),isNaN(d.cx)||(n.anchorOffsetX=d.cx),isNaN(d.cy)||(n.anchorOffsetY=d.cy)}if(a.isRot&&i.target){var g=a.isInit?{x:i.initParam.tar[0].x,y:i.initParam.tar[0].y}:i.target[0],f=MathUtils.getAngle(MathUtils.getRadian2(i.source.x,i.source.y,g.x,g.y));n.rotation=f+n.rotation}i.mc=n;var m=o["layer"+p];m&&m.call(o,i);var v=o["type"+a.type];if(v&&v.call(o,i,a),a.tween.length>0)for(var y=egret.Tween.get(n),C=0;C<a.tween.length;C+=2){var b=a.tween[C];y.to(b,a.tween[C+1].time)}},r)},r=this,a=0;a<e.length;a++)n(a)},t.play=function(t,e,i,o,n,r,a){var s=this;void 0===i&&(i=[]),void 0===o&&(o=null),void 0===n&&(n=1),void 0===r&&(r=null),void 0===a&&(a="");var l=""+this.urlRoot+this.urlSkill+t+".json";RES.getResByUrl(l,function(l){if(!l)return void console.log("You don't have that skill:"+t);var h=new EffParam;h.initParam={dir:e.dir,x:e.x,y:e.y,tar:[]};for(var u=0;i&&u<i.length;u++)h.initParam.tar.push({dir:i[u].dir,x:i[u].x,y:i[u].y});h.source=e,h.target=i,h.hitFun=o,h.rate=n,h.offset=r,h.append=a,s.playConfigs(l,h)},this,RES.ResourceItem.TYPE_JSON)},t.type1=function(t,e){var i=this,o=t.target,n=t.source,r=t.mc,a=t.hitFun,s=e.isInit?{x:t.initParam.tar[0].x,y:t.initParam.tar[0].y}:o[0],l=egret.Tween.get(r),h=e.dis||MathUtils.getDistanceByObject(n,s);e.sDis&&(h+=e.sDis);var u=MathUtils.getAngle(MathUtils.getRadian2(n.x,n.y,s.x,s.y))+e.range;if(e.sDis){var c=MathUtils.getDirMove(u,e.sDis);r.x+=c.x,r.y+=c.y}var p=MathUtils.getDirMove(u,h,r.x,r.y);l.to({x:p.x,y:p.y},h/e.moveSpeed*1e3).call(function(){i.removeMC(r),e.hit&&a&&a(e.probability),e.exEff&&i.play(e.exEff,n,o,a,1,null,t.append)})},t.removeMC=function(t){t.destroy()},t.type96=function(t,e){if(!this.shake)return void debug.warn("SkillEffPlayShow.shake Is not set");var i=t.source;this.shake(i,e.range,e.time,e.playCount,e.probability)},t.type97=function(t,e){var i=t.target,o=t.source;if(0==MapControl.copyType){i[0].stopMove();var n=(i[0]==UnitMgr.ins().getNoDieRole(),e.dis||MathUtils.getDistanceByObject(o,i[0])),r=MathUtils.getAngle(MathUtils.getRadian2(o.x,o.y,i[0].x,i[0].y)),a=MathUtils.getDirMove(r,n,i[0].x,i[0].y),s=Bresenham.canThrough(MapControl.aStar,MapControl.point2Grip(i[0].x),MapControl.point2Grip(i[0].y),MapControl.point2Grip(a.x),MapControl.point2Grip(a.y));if(0==s[0]&&(MapControl.point2Grip(i[0].x)==s[2]&&MapControl.point2Grip(i[0].y)==s[3]?(a.x=i[0].x,a.y=i[0].y):(a.x=MapControl.grip2Point(s[2]),a.y=MapControl.grip2Point(s[3]))),a.x=Math.max(Math.min(a.x,MapControl.MAX_WIDTH),0),a.y=Math.max(Math.min(a.y,MapControl.MAX_HEIGHT),0),n=MathUtils.getDistanceByObject(i[0],a),!(0>=n)){var l=egret.Tween.get(i[0].moveTweenObj);l.to({x:a.x,y:a.y},n/e.moveSpeed*1e3)}}},t.type98=function(t,e){var i=t.target,o=t.source;if(0==MapControl.copyType){o.stopMove();var n=(o==UnitMgr.ins().getNoDieRole(),e.dis||MathUtils.getDistanceByObject(o,i[0])),r=MathUtils.getAngle(MathUtils.getRadian2(o.x,o.y,i[0].x,i[0].y)),a=MathUtils.getDirMove(r,n,i[0].x,i[0].y),s=Bresenham.canThrough(MapControl.aStar,MapControl.point2Grip(i[0].x),MapControl.point2Grip(i[0].y),MapControl.point2Grip(a.x),MapControl.point2Grip(a.y));if(0==s[0]&&(MapControl.point2Grip(i[0].x)==s[2]&&MapControl.point2Grip(i[0].y)==s[3]?(a.x=i[0].x,a.y=i[0].y):(a.x=MapControl.grip2Point(s[2]),a.y=MapControl.grip2Point(s[3]))),a.x=Math.max(Math.min(a.x,MapControl.MAX_WIDTH),0),a.y=Math.max(Math.min(a.y,MapControl.MAX_HEIGHT),0),n=MathUtils.getDistanceByObject(i[0],a),!(0>=n)){a=MathUtils.getDirMove(r,n,o.x,o.y);var l=egret.Tween.get(o.moveTweenObj);l.to({x:a.x,y:a.y},n/e.moveSpeed*1e3)}}},t.type99=function(t,e){var i=t.hitFun;i&&i(e.probability)},t.layer0=function(t){var e=t.source,i=t.mc;return i.x+=e.x,i.y+=e.y,this.bottomLayer?void this.bottomLayer.addChild(i):void debug.warn("SkillEffPlayShow.bottomLayer Is not set")},t.layer1=function(t){var e=t.source,i=t.mc;e.addChildAt(i,0)},t.layer2=function(t){var e=t.source,i=t.mc;e.addChild(i)},t.layer3=function(t){var e=t.source,i=t.mc;return i.x+=e.x,i.y+=e.y,this.topLayer?void this.topLayer.addChild(i):void debug.warn("SkillEffPlayShow.topLayer Is not set")},t.layer4=function(t){var e=t.target,i=t.mc;return i.x+=e[0].x,i.y+=e[0].y,this.bottomLayer?void this.bottomLayer.addChild(i):void debug.warn("SkillEffPlayShow.bottomLayer Is not set")},t.layer5=function(t){var e=t.target,i=t.mc;e[0].addChildAt(i,0)},t.layer6=function(t){var e=t.target,i=t.mc;e[0].addChild(i)},t.layer7=function(t){var e=t.target,i=t.mc;return i.x+=e[0].x,i.y+=e[0].y,this.topLayer?void this.topLayer.addChild(i):void debug.warn("SkillEffPlayShow.topLayer Is not set")},t.layer8=function(t){return this.fixedLayer?void this.fixedLayer.addChild(t.mc):void debug.warn("SkillEffPlayShow.topLayer Is not set")},t.clean=function(){TimerMgr.ins().removeAll(this),this.bottomLayer=null,this.topLayer=null,this.setTimeout=null,this.shake=null},t.urlRoot="",t.effScale=0,t}();__reflect(SkillEffPlayShow.prototype,"SkillEffPlayShow");var StarList=function(t){function e(e,i,o,n,r,a){void 0===e&&(e=10),void 0===i&&(i=0),void 0===o&&(o=50),void 0===n&&(n=1);var s=t.call(this)||this;s._statListLength=e,s._starNum=i,s.resType=r,s.resSources=a,s.list=[];for(var l=0;l<s._statListLength;l++){var h=new StarItem;h.x=l*o+10,s.addChild(h),l<=s._starNum-1&&h.isShow(1,s.resType,s.resSources&&s.resSources[l]),h.isShowFull(n,s.resType,s.resSources&&s.resSources[l]),s.list.push(h)}return s.mc=new GameMovieClip,s.mc.scaleX=1.5,s.mc.scaleY=1.5,s}return __extends(e,t),e.prototype.setStarNum=function(t,e,i){if(void 0===e&&(e=0),i){this.resSources=i;for(var o in this.list)this.list[o].isShowFull(+o+1,1,i[o])}if(this._starNum!=t){this._starNum=t;for(var n=0;n<this._statListLength;n++)n<=this._starNum-1?(this.list[n].isShow(1,this.resType,this.resSources&&this.resSources[n]),1==e&&n==this._starNum-1&&(this.mc.x=this.list[n].x+24,this.mc.y=this.list[n].y+28,this.mc.parent||this.addChild(this.mc),this.mc.playFile(PATH_EFF+"minusstar",1))):this.list[n].isShow(0,this.resType,this.resSources&&this.resSources[n])}},e.prototype.updateStar=function(t,e){void 0===t&&(t=0),this.resSources=e;for(var i=0;i<this._statListLength;i++)i<=this._starNum-1&&1==t&&i==this._starNum-1&&(this.mc.x=this.list[i].x+24,this.mc.y=this.list[i].y+28,this.mc.parent||this.addChild(this.mc),this.mc.playFile(PATH_EFF+"minusstar",1)),this.list[i].isShow(1,this.resType,this.resSources&&this.resSources[i]),this.list[i].isShowFull(1,this.resType,this.resSources&&this.resSources[i])},Object.defineProperty(e.prototype,"starNum",{get:function(){return this._starNum},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLength",{get:function(){return this._statListLength},enumerable:!0,configurable:!0}),e.prototype.setlistLength=function(t,e,i,o){void 0===t&&(t=10),void 0===e&&(e=0),void 0===i&&(i=50),void 0===o&&(o=1);for(var n=this._statListLength;t>n;n++){var r=new StarItem;r.x=n*i+10,this.addChild(r),e-1>=n&&r.isShow(1,this.resType,this.resSources&&this.resSources[n]),r.isShowFull(o,this.resType,this.resSources&&this.resSources[n]),this.list.push(r)}this._statListLength=t},e}(eui.Component);__reflect(StarList.prototype,"StarList");var StarItem=function(t){function e(){var e=t.call(this)||this;return e.skinName="StarItemSkin",e}return __extends(e,t),e.prototype.isShow=function(t,e,i){i?this.starImg.source=t?i.star:"":this.starImg.source=t?this.getStarSource(e):""},e.prototype.isShowFull=function(t,e,i){i?this.fullStarImg.source=t?i.fullStar:"":this.fullStarImg.source=t?this.getStarFullSource(e):""},e.prototype.getStarSource=function(t){switch(t){case 1:return"shenqi_star";default:return"star2"}},e.prototype.getStarFullSource=function(t){switch(t){case 1:return"shenqi_star_empty";default:return"star1"}},e}(eui.Component);__reflect(StarItem.prototype,"StarItem");var SuperRingTurnDisplayer=function(t){function e(){var e=t.call(this)||this;return e.gAngle=180,e.gHasReset=!0,e.gInitPos=!0,e.isMaxX=!1,e.isMaxY=!1,e.gemPos1=[64,-52,-68,-80,-84,-80,-64,-90,-50,-100,40,-110,64,-80,64,-52],e.mc=new GameMovieClip,e.gFollowItem=new egret.DisplayObjectContainer,e.addChild(e.gFollowItem),e.gCenterPos=new egret.Point,e.gTurnItem=new egret.DisplayObjectContainer,e.gTurnItem.addChild(e.mc),e.gFollowItem.addChild(e.gTurnItem),TimerMgr.ins().doTimer(20,0,e.update,e),e}return __extends(e,t),e.prototype.setOwner=function(t){this.gOwner=t,this.gTurnTime=1e4+1e4*Math.random()+egret.getTimer(),this.gAngle=e.STAR_ANGLE,this.gStopTime=0},e.prototype.update=function(){this.gInitPos?(this.gFollowItem.x=e.TARGET_POINT_X,this.gFollowItem.y=e.TARGET_POINT_Y-this.gOwner.height,this.gInitPos=!1):(this.gFollowItem.x=this.gFollowItem.x-(this.gOwner.x-this.gOwnerLastX),this.gFollowItem.y=this.gFollowItem.y-(this.gOwner.y-this.gOwnerLastY)),this.gCenterPos=new egret.Point(this.effectX,this.effectY),this.moveCenterPoint(),this.gOwnerLastX=this.gOwner.x,this.gOwnerLastY=this.gOwner.y},e.prototype.setEffectXY=function(t){var e=this.gemPos1[2*t],i=this.gemPos1[2*t+1];this.effectX=e+Math.ceil(100*Math.random()-50),this.effectY=i+Math.ceil(100*Math.random()-50)
},e.prototype.moveCenterPoint=function(){var t,i=this.gCenterPos.x-this.gFollowItem.x;0!=i&&(Math.abs(i)>e.MAX_DIS?(t=2*Math.ceil(Math.abs(i)*e.SPEED_RATIO)*3/2,i>0?i>t&&(this.gFollowItem.x=this.gFollowItem.x+t):0>i&&Math.abs(i)>t&&(this.gFollowItem.x=this.gFollowItem.x-t)):(this.isMaxX=!1,t=3*Math.ceil(Math.abs(i)*e.SPEED_RATIO)/2*1.35,i>0?i>t&&(this.gFollowItem.x=this.gFollowItem.x+t):0>i&&Math.abs(i)>t&&(this.gFollowItem.x=this.gFollowItem.x-t)));var o=this.gCenterPos.y-this.gFollowItem.y;0!=o&&(Math.abs(o)>e.MAX_DIS?(t=2*Math.ceil(Math.abs(o)*e.SPEED_RATIO)*3/2,o>=0?o>t&&(this.gFollowItem.y=this.gFollowItem.y+t):0>o&&Math.abs(o)>t&&(this.gFollowItem.y=this.gFollowItem.y-t)):(this.isMaxY=!1,t=3*Math.ceil(Math.abs(o)*e.SPEED_RATIO)/2*1.35,o>=0?o>t&&(this.gFollowItem.y=this.gFollowItem.y+t):0>o&&Math.abs(o)>t&&(this.gFollowItem.y=this.gFollowItem.y-t)))},e.prototype.setModel=function(t,e,i){if(this.infomodel=e,e.masterHandle&&e.masterHandle==ActorControl.handle){if(0>t||null==t)return;if(UnitMgr.ins().getMainRole(0)&&UnitMgr.ins().getMainRole(0).infoModel.handle!=e.handle)return}return e.masterHandle&&superRingControl.hasHanlder(e.masterHandle)?void(this.lastID!=t&&(this.showRing(t),this.lastID=t)):(this.showRing(t),void i.addChild(this))},e.prototype.showRing=function(t){this.mc.alpha=1,this.ringInfo=DataCenter.ins().FireRingRoleConfig[t];var e=DataCenter.ins().MonstersConfig[this.ringInfo.avatarFileName];this.mc.playFile(PATH_GUAIWU+"monster"+e.avatar+"_0a",-1)},e.prototype.reset=function(){this.mc&&DisplayUtils.removeFromParent(this.mc),superRingControl.delHanlder(this.infomodel.masterHandle),this.gOwnerLastX=0,this.gOwnerLastY=0,this.gCenterPos.x=0,this.gCenterPos.y=0,this.gHasReset=!0,this.gInitPos=!0,this.gModelUrl="",TimerMgr.ins().removeAll(this)},e.TARGET_POINT_X=95,e.TARGET_POINT_Y=-40,e.MAX_DIS=60,e.STAR_ANGLE=0,e.SPEED_RATIO=.015,e}(egret.DisplayObjectContainer);__reflect(SuperRingTurnDisplayer.prototype,"SuperRingTurnDisplayer");var CrossServerSwitchView=function(t){function e(){var e=t.call(this)||this;return e.isOnBack=!1,e.BAR_W=422,e.skinName="CrossServerSwitchViewSkin",e.uilayer=GameLayer.TIPS,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];this.isOnBack=!crossFieldControl.isCrossServer,this.switchLabel.text=this.isOnBack?LangMgr.getValueByKey("backServering"):LangMgr.getValueByKey("gotocrossserver"),this.progressBar.width=0,egret.Tween.get(this.progressBar,null,null,!0).to({width:this.BAR_W},e.Switch_Time+200)},e.readyClose=function(){var t=UIMgr.ins().getView(e);t&&t.readyClose()},e.prototype.readyClose=function(){TimerMgr.ins().isExists(this.closeWin,this)||TimerMgr.ins().doTimer(1e3,1,this.closeWin,this)},e.prototype.closeWin=function(){UIMgr.ins().close(this)},e.prototype.close=function(){egret.Tween.removeTweens(this.progressBar),this.isOnBack&&e.backCloseFun&&egret.callLater(function(){e.backCloseFun()},e.backCloseFun)},e.Switch_Time=2e3,e}(BaseEuiView);__reflect(CrossServerSwitchView.prototype,"CrossServerSwitchView");var EquipNormalTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="EquipNormalTipsViewSkin",e}return __extends(e,t),e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.otherClose),this.addEventTouchEnd(this.changeBtn,this.onTap),this.setHideButton()},e.prototype.updateView=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.itemType=t[0],this.id=t[1],this.sco=t[2],this.power=t[3],this.desc=t[4],this.attrs=t[5];var i=DataCenter.ins().ItemConfig[this.id];this.itemIcon.setData(i);var o=ItemUtils.getQuality(i);this.quali.source=o>0?"quali"+o:"",this.nameLabel.textFlow=TextUtils.generateTextFlow1("|C:"+ItemUtils.getQualityColor(i)+"&T:"+this.getItemName()),this.score.text="评分："+this.sco,this.typeName.textFlow=TextUtils.generateTextFlow1(this.desc.left),this.typeValue.textFlow=TextUtils.generateTextFlow1(this.desc.right),this.powerPanel.setPower(this.power);for(var n=0;n<this.attrs.length;n++){var r=new EquipNormalTipsItemRenderer;r.data={title:this.attrs[n].title,attributeData:this.attrs[n].attr,colorName:this.attrs[n].colorName,colorValue:this.attrs[n].colorValue,others:this.attrs[n].others,ext:this.attrs[n].ext},this.content.addChild(r)}},e.prototype.getItemName=function(){return DataCenter.ins().ItemConfig[this.id].name},e.prototype.setHideButton=function(){this.changeBtn.visible=!1},e.prototype.onTap=function(t){},e}(BaseEuiView);__reflect(EquipNormalTipsView.prototype,"EquipNormalTipsView");var PowerPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showBg=!0,e.imgWidth=72,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.playFlameMC(),this.totalPower=BitmapNumber.ins().createNumPic(0,"8",5),this.totalPower.x=100,this.totalPower.y=20,this.addChild(this.totalPower),this.initPos()},e.prototype.setPower=function(t){this.power=t,BitmapNumber.ins().changeNum(this.totalPower,t,"8",5),this.initPos()},e.prototype.initPos=function(){if(this.showBg){var t=this.totalPower.width>30?this.totalPower.width:30;this.totalPower.x=this.width-t/2-130,this.powerImg.x=this.totalPower.x-this.imgWidth-10}},e.prototype.setBgVis=function(t){this.bgImg.visible=t,this.flameGroup.visible=t,this.showBg=t},e.prototype.setMcVisible=function(t){this.flameGroup.visible=t},e.prototype.playFlameMC=function(){this.flameMC?this.flameMC.play(-1):(this.flameMC=new GameMovieClip,this.flameMC.x=76,this.flameMC.y=23,this.flameMC.playFile(PATH_EFF+"zhanduolibeijing",-1),this.flameGroup.addChild(this.flameMC))},e.prototype.destructor=function(){DisplayUtils.removeFromParent(this)},e}(BasePanel);__reflect(PowerPanel.prototype,"PowerPanel");var RoleSelectPanel=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e.lastX=0,e.isTouchBegin=!1,e.rolesLength=1,e.initMc(),e.addEventAddedFromStage(e,e.onAdd),e}return __extends(e,t),e.prototype.$onRemoveFromStage=function(){t.prototype.$onRemoveFromStage.call(this),this.destructor()},e.prototype.childrenCreated=function(){this.init()},e.prototype.initMc=function(){this.roleMovie=[];for(var t=0;t<GlobalModel.roleNum-1;t++){var e=new GameMovieClip;e.x=44,e.y=44,e.touchEnabled=!1,this.roleMovie.push(e)}},e.prototype.hideTop=function(){this.leftImg.visible=!1,this.rightImg.visible=!1,this.bgImg.visible=!1},e.prototype.init=function(){this.roles=[];for(var t=0;5>t;t++)this["role"+t]&&t<GlobalModel.roleNum?this.roles.push(this["role"+t]):this["role"+t]&&this["role"+t].parent.removeChild(this["role"+t]);for(var t=0;t<this.roles.length-1;t++){var e=this.roleMovie[t];this.roles[t+1].addChild(e)}},e.prototype.onAdd=function(){this.destructor(),this.addEventTouchBegin(this.parent,this.onMove),this.addEventTouchEnd(this.parent,this.onMove),this.addEventTouchTap(this.recharge,this.onBtnClick),this.addEventTouchTap(this.recharge0,this.onBtnClick),this.addEventTouchTap(this,this.onClick),this.addCustomEvent(352,this.updateRole),this.addCustomEvent(461,this.updateRole),this.addCustomEvent(106,this.updateRole),this.addCustomEvent(112,this.updateRole),this.addCustomEvent(456,this.initData),this.addCustomEvent(457,this.initData),this.setCurRole(this._curRole),this.updateRole(),this.initData()},e.prototype.initData=function(){CommonUtils.labelIsOverLenght(this.goldTxt,ActorControl.gold),CommonUtils.labelIsOverLenght(this.ybTxt,ActorControl.yb)},e.prototype.getCurRole=function(){return this._curRole},e.prototype.setCurRole=function(t){this._curRole=t;for(var e=0;e<this.roles.length;e++){var i=this.roles[e];i.selected=e==t}this.dispatchEventWith(egret.Event.CHANGE,!1,this._curRole)},e.prototype.onBtnClick=function(t){switch(t.currentTarget){case this.recharge0:payControl.checkOpenWin();break;case this.recharge:storeControl.openBuyGoldWin()}},e.prototype.onClick=function(t){var e=this.roles.indexOf(t.target);e>-1&&this.changeRole(e)},e.prototype.onMove=function(t){if(this.headGroup.visible&&this.parent&&this.parent.touchEnabled&&!this.isPass())switch(t.type){case egret.TouchEvent.TOUCH_BEGIN:this.lastX=t.stageX,this.isTouchBegin=!0;break;case egret.TouchEvent.TOUCH_END:if(!this.isTouchBegin)break;this.isTouchBegin=!1;var e=this._curRole;this.lastX-t.stageX>=100?(e++,e>this.rolesLength&&(e=0),this.changeRole(e)):this.lastX-t.stageX<=-100&&(e--,0>e&&(e=this.rolesLength),this.changeRole(e))}},e.prototype.isPass=function(){var t=UIMgr.ins().getView("IntensifyView");if(t&&t.isNotMove)return!0;var e=UIMgr.ins().getView("DeityEquipView");return e&&e.isNotMove?!0:!1},e.prototype.changeRole=function(t){var e=heroControl.getSubRoleByIndex(t);e?this.setCurRole(t):(UIMgr.ins().open("RecruitView"),Assert(this.roles[t],"RoleSelectPanel changeRole value:"+t)||(this.roles[t].selected=!1))},e.prototype.updateRole=function(){var t,e,i=this.roles.length;this.rolesLength=heroControl.subRolesLen-1;for(var o=0;i>o;o++){if(t=this.roles[o],e=heroControl.getSubRoleByIndex(o))t.jobImg.visible=!0,t.jobImg.source="job"+e.job+"Item",t.stageImg.visible=!1,t.stageImg.source="",t.icon="yuanhead"+e.job+e.sex,this.roleMovie[o-1]&&DisplayUtils.removeFromParent(this.roleMovie[o-1]);else{var n=DataCenter.ins().RoleNewConfig[o];if(!n){debug.warn("role"+(o+1)+"open condition no confing(RoleNewConfig)");continue}t.jobImg.visible=!1,t.stageImg.visible=!0,n.zsLevel?reincarnateControl.lv<n.zsLevel?t.stageImg.source="toujiesuo"+n.zsLevel:t.stageImg.source="toujiesuo":ActorControl.level<n.level?t.stageImg.source="toujiesuo"+n.level:t.stageImg.source="toujiesuo",n.vip&&vipControl.lv>=n.vip&&(t.stageImg.source="toujiesuo"),n.firstrecharge&&vipControl.exp>0&&(t.stageImg.source="toujiesuo"),t.icon=""}this.roleMovie[o-1]&&"toujiesuo"==t.stageImg.source&&t.stageImg.visible&&(this.roleMovie[o-1].playFile(PATH_EFF+"juesejiesuo",-1),this.showRedPoint(o,!0))}},e.prototype.showRedPoint=function(t,e){null!=this.roles&&(this.roles[t].redPoint.visible=e)},e.prototype.clearRedPoint=function(){for(var t=0;t<this.roles.length;t++)this.roles[t].redPoint.visible=!1},e.prototype.openRole=function(){this.headGroup.visible=!0},e.prototype.hideRole=function(){this.headGroup.visible=!1},e.prototype.destructor=function(){this.parent&&(this.removeEventTouchBegin(this.parent,this.onMove),this.removeEventTouchEnd(this.parent,this.onMove))},e}(BasePanel);__reflect(RoleSelectPanel.prototype,"RoleSelectPanel");var EquipNormalTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="EquipNormalTipsItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.title,e=this.data.colorName,i=this.data.colorValue,o=this.data.attributeData,n=this.data.others,r=this.data.ext,a="",s="";if(n&&n.suitdesc||DisplayUtils.removeFromParent(this.desc1),o){for(var l=0;l<o.length;l++)20!=o[l].type&&AttributeData.getAttrStrByType(o[l].type)&&(a+=AttributeData.getAttrStrByType(o[l].type)+": \n",s+=2==o[l].type||4==o[l].type||5==o[l].type||6==o[l].type||89==o[l].type?o[l].value:o[l].value/100+"%",s+="\n");if(a){var h=a.lastIndexOf("\n");a=a.substring(0,h)}if(s){var h=s.lastIndexOf("\n");s=s.substring(0,h)}if(n&&n.exdesc){var u=n.exdesc.split("+");a+="\n"+u[0]+":",s+="\n"+u[1]}this.attrName.textFlow=TextUtils.generateTextFlow1(e?"|C:"+e+"&T:"+a:""+a),this.attrValue.textFlow=TextUtils.generateTextFlow1(i?"|C:"+i+"&T:"+s:""+s)}else DisplayUtils.removeFromParent(this.attrDesc);this.attrType.textFlow=TextUtils.generateTextFlow1(t),this.desc1&&this.desc1.parent&&(this.suit.textFlow=TextUtils.generateTextFlow1(n.suitdesc)),r&&(this.ext.textFlow=TextUtils.generateTextFlow1(r.text),void 0!=r.pos&&(this.ext.x=r.pos))}},e}(BaseItemRender);__reflect(EquipNormalTipsItemRenderer.prototype,"EquipNormalTipsItemRenderer");var OtherRoleItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.addEventTouchTap(e,e.showRole),e}return __extends(e,t),e.prototype.dataChanged=function(){if(!this.data||!this.data.otherPlayerData||!CommonFun.instanceofByName(this.data.otherPlayerData,"OtherPlayerData"))return void this.setRole(null);var t=this.data.otherPlayerData,e=t.roleData[this.index];e&&this.setRole(e)},e.prototype.showRole=function(t){if(this.data&&this.data.otherPlayerData){UIMgr.ins().open("RankRoleView",this.data.otherPlayerData);var e=UIMgr.ins().open("RankRoleView",this.data.otherPlayerData);e.hideEx(2)}},e}(RoleItemRenderer);__reflect(OtherRoleItemRenderer.prototype,"OtherRoleItemRenderer");var StageItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="StageItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data&&"string"==typeof this.data){var t=StringUtils.getStrByRegExp(this.data),e=StringUtils.getStrByRegExp(this.data,/[\u4E00-\u9FA5]+/g),i="",o=[],n=[],r=this.data.indexOf(t[0]),a=this.data.indexOf(e[0]);r>=0&&a>=0?a>r?(o=this.convert(t),n=e):(o=e,n=this.convert(t)):o=-1==r?e:this.convert(t);for(var s=0;s<o.length;s++)i+=o[s],n[s]&&(i+=n[s]);this.lv0.text=i,this.calcHeight()}},e.prototype.convert=function(t){for(var e=0;e<t.length;e++)t[e]=StringUtils.NumberToChinese(Number(t[e]));return t},e.prototype.calcHeight=function(){this.validateNow();var t=this.lv0.textHeight;0==t&&(t=16*this.lv0.text.length),this.height=t+5},e}(BaseItemRender);__reflect(StageItemRenderer.prototype,"StageItemRenderer");var DailyRedBagControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dailySysOpen=0,e.curCount=0,e.nearGetTimes=0,e.nearNormalValue=0,e.nearGetRechargeValue=0,e.curDayRechargeSuccess=0,e.logs=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkSysOpen=function(){return this.dailySysOpen&&this.checkLvOpen()?!0:!1},e.prototype.checkLvOpen=function(){var t=Math.floor(DataCenter.ins().DailyRedBagConfig.openZslv/1e3),e=DataCenter.ins().DailyRedBagConfig.openZslv%1e3;return reincarnateControl.lv>=t&&ActorControl.level>=e},e.prototype.getLeftTime=function(){var t=Math.floor((DateUtils.formatMiniDateTime(this.nearGetTimes+DataCenter.ins().DailyRedBagConfig.cd)-GameServer.serverTime)/1e3);return 0>=t&&(t=0),t},e.prototype.isNormalGet=function(){return this.isCount()?this.getLeftTime()?!1:!0:!1},e.prototype.isExtraGet=function(){var t=payControl.getRechargeData(0);return t&&t.curDayPay&&!this.curDayRechargeSuccess},e.prototype.isEnvelope=function(){return this.isCount()&&!this.getLeftTime()?!0:!1},e.prototype.isCount=function(){return this.curCount<DataCenter.ins().DailyRedBagConfig.lottery?!0:!1},e.prototype.checkFirstRedPoint=function(){this.isFirstLogin||(this.isFirstLogin=!0,this.isExtraGet()?this.firstRedPoint=!0:this.firstRedPoint=!1,this.dispatchFirstRedPoint())},e.prototype.setFirstRedPoint=function(){this.isEnvelope()||(this.firstRedPoint=!1),this.dispatchFirstRedPoint()},e.prototype.dispatchFirstRedPoint=function(){EventMgr.ins().dispatch(677)},e.prototype.dispatchRuleIconRedPoint=function(){EventMgr.ins().dispatch(679)},e.prototype.isRedPoint=function(){return this.checkSysOpen()?this.isNormalGet()?!0:this.isExtraGet()?!0:this.firstRedPoint:!1},e.prototype.upDailyEnvelope=function(t){return[t]},e.prototype.upDailyEnvelopeLogs=function(){},e.prototype.downInfo=function(t,e,i,o,n,r){this.dailySysOpen=t,this.curCount=e,this.nearGetTimes=i,this.nearNormalValue=o,this.nearGetRechargeValue=n,this.curDayRechargeSuccess=r,this.checkFirstRedPoint(),EventMgr.ins().dispatch(288)},e.prototype.downLogs=function(t){this.logs=[];for(var e=0;t.length>e;e++)this.logs.push({name:t[e][0],value:t[e][1]});EventMgr.ins().dispatch(289)},__decorate([up(6,[1])],e.prototype,"upDailyEnvelope",null),__decorate([up(7)],e.prototype,"upDailyEnvelopeLogs",null),__decorate([down(5,[1,1,3,3,3,1])],e.prototype,"downInfo",null),__decorate([down(7,[[8,3]])],e.prototype,"downLogs",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(DailyRedBagControl.prototype,"DailyRedBagControl");var DailyRedBagPanel=function(t){function e(){var e=t.call(this)||this;e.bt1=!1,e.bt2=!1,e.bt3=!1;var i=DataCenter.ins().ClientGlobalConfig.spokesmanredbag,o=spokesPersonControl.checkBaseOpen(i.openTerm);return e.skinName=o?i.skin:"DailyRedBagPanelSkin",e.init(),e}return __extends(e,t),e.prototype.init=function(){this.logList.itemRenderer=DailyRedBagLogsItemRenderer,this.logListData=new eui.ArrayCollection,this.logList.dataProvider=this.logListData,this.reset()},e.openCheck=function(){if(!dailyRedBagControl.dailySysOpen)return tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity")),!1;if(!dailyRedBagControl.checkLvOpen()){var t=Math.floor(DataCenter.ins().DailyRedBagConfig.openZslv/1e3),e=DataCenter.ins().DailyRedBagConfig.openZslv%1e3;return tipsControl.showTips(LangMgr.getValueByKey("numberRotation",t)+LangMgr.getValueByKey("tipsOpenLevel",e)),!1}return!0},e.prototype.close=function(){TimerMgr.ins().remove(this.tick,this),TimerMgr.ins().remove(this.logsTick,this)},e.prototype.open=function(){this.addEventTouchEnd(this.getBtn,this.onClick),this.addEventTouchEnd(this.normalGet,this.onClick),this.addEventTouchEnd(this.ExtraGet,this.onClick),this.addCustomEvent(288,this.callBack),this.addCustomEvent(177,this.callBack),this.addCustomEvent(289,this.updateLogs),TimerMgr.ins().isExists(this.logsTick,this)||TimerMgr.ins().doTimer(1e4,0,this.logsTick,this),TimerMgr.ins().isExists(this.tick,this)||TimerMgr.ins().doTimer(1e3,0,this.tick,this),dailyRedBagControl.upDailyEnvelopeLogs(),this.updateView()},e.prototype.callBack=function(){!TimerMgr.ins().isExists(this.tick,this)&&dailyRedBagControl.isCount()&&TimerMgr.ins().doTimer(1e3,0,this.tick,this),this.updateView()},e.prototype.logsTick=function(){dailyRedBagControl.upDailyEnvelopeLogs()},e.prototype.tick=function(){dailyRedBagControl.isEnvelope()?(this.twGroup.visible=!0,this.getBtn.visible=!0):this.twGroup.visible=!1;var t=dailyRedBagControl.getLeftTime();0>=t?(this.timer.text="",TimerMgr.ins().remove(this.tick,this)):this.timer.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,4),this.timeGroup.visible=dailyRedBagControl.isCount()&&t>0},e.prototype.updateView=function(){var t=DataCenter.ins().DailyRedBagConfig.lottery-dailyRedBagControl.curCount,e=ColorUtils.GREEN;0>=t&&(e=ColorUtils.RED,t=0),this.count.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+t),this.normalRedbg.text=""+dailyRedBagControl.nearNormalValue,this.extraRedbg.text=""+dailyRedBagControl.nearGetRechargeValue,this.normalGet.enabled=dailyRedBagControl.isNormalGet(),this.normalGet.label=this.normalGet.enabled?LangMgr.getValueByKey("activitGet"):LangMgr.getValueByKey("activitAlreadingGet"),this.ExtraGet.enabled=!dailyRedBagControl.curDayRechargeSuccess,this.ExtraGet.label=dailyRedBagControl.curDayRechargeSuccess?LangMgr.getValueByKey("activitAlreadingGet"):LangMgr.getValueByKey("dailyRedBag1"),this.updateLogs(),this.tick(),dailyRedBagControl.setFirstRedPoint()},e.prototype.updateLogs=function(){var t=dailyRedBagControl.logs.concat();t=t.reverse(),this.logListData.replaceAll(t)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.getBtn:if(!dailyRedBagControl.dailySysOpen)return void tipsControl.showTips(LangMgr.getValueByKey("doubleEndActivity"));if(!dailyRedBagControl.checkLvOpen()){var e=Math.floor(DataCenter.ins().DailyRedBagConfig.openZslv/1e3),i=DataCenter.ins().DailyRedBagConfig.openZslv%1e3;return void tipsControl.showTips(LangMgr.getValueByKey("numberRotation",e)+LangMgr.getValueByKey("tipsOpenLevel",i))}if(!dailyRedBagControl.isCount())return void tipsControl.showTips(LangMgr.getValueByKey("dailyRedBag2"));dailyRedBagControl.upDailyEnvelope(2);break;case this.normalGet:if(!dailyRedBagControl.isNormalGet())return void tipsControl.showTips(LangMgr.getValueByKey("dailyRedBag3"));dailyRedBagControl.upDailyEnvelope(0);break;case this.ExtraGet:if(!dailyRedBagControl.isExtraGet()){var o=payControl.getRechargeData(0);if(!o)return void tipsControl.showTips(LangMgr.getValueByKey("activitDataError"));if(!o.curDayPay)return void warnControl.show(LangMgr.getValueByKey("dailyRedBag4"),function(){payControl.checkOpenWin()},this);if(dailyRedBagControl.curDayRechargeSuccess)return void tipsControl.showTips(LangMgr.getValueByKey("activitAlreadingGet"))}dailyRedBagControl.upDailyEnvelope(1)}},e.prototype.reset=function(){this.bt1=this.bt2=this.bt3=!1,this.startTopImgY=this.topImg.y,this.startDownImgY=this.downImg.y,this.topImg.scrollRect=void 0,this.downImg.scrollRect=void 0},e.prototype.playAni=function(t,e){var i=this;this.getBtn.visible=!1,this.topImg.scrollRect||(this.topImg.scrollRect=new egret.Rectangle(0,0,this.topImg.width,this.topImg.height)),this.downImg.scrollRect||(this.downImg.scrollRect=new egret.Rectangle(0,0,this.downImg.width,this.downImg.height)),this.callFun=function(){t&&t.call(e)};var o=this.topImg.scrollRect,n=this.downImg.scrollRect,r=400,a=egret.Tween.get(o,{onChange:function(){i.topImg.scrollRect=o}}).to({y:200},r).call(function(){egret.Tween.removeTweens(a),i.bt1=!0}),s=egret.Tween.get(n,{onChange:function(){i.downImg.scrollRect=n}}).to({height:0},r).call(function(){egret.Tween.removeTweens(s),i.bt2=!0}),l=egret.Tween.get(this.downImg).to({y:this.downImg.y+this.downImg.height},r).call(function(){egret.Tween.removeTweens(l),i.bt3=!0})},e}(BaseEuiView);__reflect(DailyRedBagPanel.prototype,"DailyRedBagPanel");var DailyRedBagLogsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="DailyRedBagLogItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.nameLabel.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("dailyRedBag5",this.data.name)),this.num.text=this.data.value+"")},e}(BaseItemRender);__reflect(DailyRedBagLogsItemRenderer.prototype,"DailyRedBagLogsItemRenderer");var GMCommandView=function(t){function e(){var e=t.call(this)||this;return e.skinName="GMCommandViewSkin",e.initUI(),e}return __extends(e,t),e.ins=function(){return this._ins||(this._ins=new e),this._ins},e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.commandSendBtn,this.onTou),this.addEventTouchTap(this.niubiBtn,this.onTou),this.addEventTouchTap(this.superManBtn,this.onTou),this.addEventTouchTap(this.superAttrBtn,this.onTou),this.addEventTouchTap(this.chapterBtn,this.onTou),this.addEventTouchTap(this.monthCardBtn,this.onTou),this.addEventTouchTap(this.monthCardBtn1,this.onTou),this.addEventTouchTap(this.additemBtn,this.onTou),this.addEventTouchTap(this.clearBagBtn,this.onTou),this.addEventTouchTap(this.stopAIBtn,this.onTou),this.addEventTouchTap(this.openAIBtn,this.onTou),this.addEventTouchTap(this.testFbBtn,this.onTou),this.addEventTouchTap(this.rgBtn,this.onTou),this.addEventTouchTap(this.newdayBtn,this.onTou),this.addEventTouchTap(this.rechargeBtn,this.onTou),this.addEventFocusIn(this.commandInput,this.focusInHandler),this.addEventFocusIn(this.chapterInput,this.focusInHandler),this.addEventFocusIn(this.additemInput,this.focusInHandler),this.versionLabel.text="Ver."+GlobalModel.gameVersion,this.accountTxt.text="Account:"+GlobalModel.openID,this.serverTxt.text=LangMgr.getValueByKey("serveridportstr",GlobalModel.srvid,GlobalModel.serverPort),StageUtils.ins().getUIStage().addChild(this),TimerMgr.ins().isExists(this.onTime,this)||TimerMgr.ins().doTimer(1e3,0,this.onTime,this),this.onTime()},e.prototype.onTime=function(){this.serverTimer.text=LangMgr.getValueByKey("openservertime",GameServer.serverOpenDay+1,DateUtils.getFormatBySecond(GameServer.serverTime/DateUtils.MS_PER_SECOND,DateUtils.TIME_FORMAT_2)),this.kfServerTimer.text=LangMgr.getValueByKey("crossdayallday",GameServer.smallKFServOpenDay,GameServer.bigKFServOpenDay);var t=UnitMgr.ins().getNoDieRole();if(t){var e=t.x>>0,i=t.y>>0,o=MapControl.point2Grip(t.x),n=MapControl.point2Grip(t.y),r=MapControl.aStar.isWalkable(o,n);this.xyLabel.text="posXY:("+(e+","+i)+")("+(o+","+n+","+(r?1:0))+")"}else this.xyLabel.text="posXY:(-,-)";var a=egret.$hashCount,s=a-this.hasCount,l=s>120?ColorUtils.RED:ColorUtils.GREEN;this.hasCountTxt.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("monitoringnum","|C:"+l+"&T:"+s+"/120|")),this.hasCount=a},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventFocusIn(this.commandInput,this.focusInHandler),this.removeEventFocusIn(this.chapterInput,this.focusInHandler),this.removeEventFocusIn(this.additemInput,this.focusInHandler),DisplayUtils.removeFromParent(this),this.$onClose(),TimerMgr.ins().removeAll(this)},e.prototype.focusInHandler=function(t){switch(t.currentTarget){case this.commandInput:if(LangMgr.getValueByKey("inputcmd")!=this.commandInput.text)return;t.target.text="@";break;case this.rechargeInput:if("10000"!=this.rechargeInput.text)return;t.target.text="";break;case this.chapterInput:if("100"!=this.chapterInput.text)return;t.target.text="";break;case this.additemInput:if("200002"!=this.additemInput.text)return;t.target.text=""}},e.prototype.focusOutHandler=function(t){switch(t.target){case this.commandInput:this.commandInput.text=LangMgr.getValueByKey("inputcmd")}},e.prototype.onTou=function(t){switch(t.target){case this.commandSendBtn:this.keyEnter();break;case this.rechargeBtn:if(!this.rechargeInput.text)return void tipsControl.showCenterTips(LangMgr.getValueByKey("inputpayid"));payControl.upPayDebug(Number(this.rechargeInput.text));break;case this.niubiBtn:gameControl.upGMCommad("@setbianniubi");break;case this.superManBtn:gameControl.upGMCommad("@biandage");break;case this.superAttrBtn:gameControl.upGMCommad("@setattr 4 99999999999"),gameControl.upGMCommad("@setattr 2 99999999999");break;case this.chapterBtn:if(!this.chapterInput.text)return void tipsControl.showCenterTips(LangMgr.getValueByKey("inputlevelnum"));gameControl.upGMCommad("@chapter2 "+this.chapterInput.text);break;case this.monthCardBtn:gameControl.upGMCommad("@buyprivilegemonthcard");break;case this.monthCardBtn1:gameControl.upGMCommad("@buymonthcard");break;case this.additemBtn:if(!this.additemInput.text)return void tipsControl.showCenterTips(LangMgr.getValueByKey("inputgoodsid"));var e=this.additemInput.text.split(" ");gameControl.upGMCommad("@additem "+e[0]+" "+(e[1]||1));break;case this.clearBagBtn:gameControl.upGMCommad("@clearbag 0"),gameControl.upGMCommad("@clearbag 1"),gameControl.upGMCommad("@clearbag 2");break;case this.storeBtn:gameControl.upGMCommad("@savesysvar");break;case this.stopAIBtn:gameControl.upGMCommad("@city eai");break;case this.openAIBtn:gameControl.upGMCommad("@city sai");break;case this.testFbBtn:gameControl.upGMCommad("@etfb");break;case this.rgBtn:gameControl.upGMCommad("@rsf");break;case this.newdayBtn:gameControl.upGMCommad("@newday")}},e.prototype.keyEnter=function(){gameControl.upGMCommad(this.commandInput.text)},e}(BaseEuiView);__reflect(GMCommandView.prototype,"GMCommandView");var GMMemView=function(t){function e(){var e=t.call(this)||this;e.showState=!1,e.touchEnabled=!1,e.touchChildren=!1;var i=new egret.Shape;return i.graphics.beginFill(0,.7),i.graphics.drawRect(0,0,120,20),i.graphics.endFill(),e.addChild(i),e.memText=new eui.Label,e.memText.width=120,e.memText.height=20,e.memText.size=16,e.memText.textColor=16777215,e.memText.verticalAlign="middle",e.addChild(e.memText),e}return __extends(e,t),e.Ins=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.show=function(t){this.showState=t,this.visible=this.showState,this.showState?(this.showMem(),StageUtils.ins().getStage().addChild(this),TimerMgr.ins().doTimer(5e3,0,this.showMem,this)):(TimerMgr.ins().remove(this.showMem,this),this.parent&&this.parent.removeChild(this))},e.prototype.showMem=function(){this.memText&&RecycleMgr.ins().imageTotalSize&&(this.memText.text="Mem:"+(RecycleMgr.ins().imageTotalSize/1024/1024).toFixed(2)+"M")},e}(egret.Sprite);__reflect(GMMemView.prototype,"GMMemView");var GMNetCalcItemRenderer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=this.data;this.idTxt.text=t.id,this.sumTxt.text=(t.sum/1024).toFixed(1)+"kb",this.countTxt.text=t.count+"",this.perTxt.text=t.per+"b"},e}(BaseItemRender);__reflect(GMNetCalcItemRenderer.prototype,"GMNetCalcItemRenderer");var GMNetCalcView=function(t){function e(){var e=t.call(this)||this;return e.listState=0,e.lastState=0,e.uilayer=GameLayer.POPUP,e.skinName="GMNetCalcViewSkin",e._dataPro=new eui.ArrayCollection,e.list.itemRenderer=GMNetCalcItemRenderer,e.list.dataProvider=e._dataPro,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.totalBtn,this.onTap),this.addEventTouchTap(this.countBtn,this.onTap),this.addEventTouchTap(this.perBtn,this.onTap),this.addEventTouchTap(this.idBtn,this.onTap),this.addEventTouchTap(this.clearBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.changeBtn,this.onTap),TimerMgr.ins().isExists(this.updateView,this)||TimerMgr.ins().loop(1e3,this.updateView,this),this.updateView()},e.prototype.updateView=function(){var t=this,e=NetCalcUtils.msgBytes,i=[];for(var o in e)for(var n in e[o]){var r=e[o][n];i.push({id:o+"-"+n,sum:r[0],count:r[1],per:r[0]/r[1]>>0,idSys:+o,idMsg:+n})}var a="sum";1==this.listState?a="count":2==this.listState&&(a="per");var s="sum";1==this.lastState?s="count":2==this.lastState&&(s="per"),i.sort(function(e,i){if(3==t.listState){if(e.idSys<i.idSys)return-1;if(e.idSys>i.idSys)return 1;if(3==t.lastState){if(e.idMsg<i.idMsg)return-1}else if(e[s]>i[s])return-1}else if(e[a]>i[a])return-1;return 1}),this._dataPro.replaceAll(i),this.timeTxt.text="运行时间："+(egret.getTimer()/1e3>>0)+"秒",this.totalTxt.text="总流量："+(NetCalcUtils.revBytes2/1024).toFixed(1)+"kb+"+(NetCalcUtils.sendBytes/1024).toFixed(1)+"kb"},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.bgClose:UIMgr.ins().close(this);break;case this.totalBtn:0!=this.listState&&(this.lastState=this.listState,this.listState=0,this.updateView());break;case this.countBtn:1!=this.listState&&(this.lastState=this.listState,this.listState=1,this.updateView());break;case this.perBtn:2!=this.listState&&(this.lastState=this.listState,this.listState=2,this.updateView());break;case this.idBtn:(3!=this.listState||this.listState!=this.lastState)&&(this.lastState=this.listState,this.listState=3,this.updateView());break;case this.clearBtn:NetCalcUtils.clearRevBytes(),this.updateView();break;case this.changeBtn:GMMemView.Ins().show(!GMMemView.Ins().showState)}},e}(BaseEuiView);__reflect(GMNetCalcView.prototype,"GMNetCalcView");var DownloadView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DownloadViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.androidBtn,this.onTap),this.addEventTouchTap(this.iosBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.androidBtn,this.onTap),this.removeEventTouchTap(this.iosBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.androidBtn:this.downloadFile(1);break;case this.iosBtn:this.downloadFile(2)}},e.prototype.downloadFile=function(t){var e="android";2==t&&(e="ios"),window.open(GlobalModel.gmDomain+":8080/api/download?pfid="+GlobalModel.pfid+"&gameid="+GlobalModel.gameId+"&channelId="+GlobalModel.channelId+"&device="+e,"newwindow","toolbar =no, menubar=no, scrollbars=no, resizable=no, location=no, status=no")},e}(BaseEuiView);__reflect(DownloadView.prototype,"DownloadView");var EmailUserControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.currentMailHandle=0,e.mailData=[],e._mailListData=new eui.ArrayCollection,e
}return __extends(e,t),e.ins=function(){return t.ins.call(this)},Object.defineProperty(e.prototype,"mailListData",{get:function(){return this.mailData.sort(this.mailSort2),this._mailListData.source=this.mailData,this._mailListData},enumerable:!0,configurable:!0}),e.prototype.upMailContentData=function(t){return[t]},e.prototype.upGetItem=function(t){return[t]},e.prototype.downMailData=function(t){this.mailData=[];for(var e=0;e<t.length;e++){var i=new EmailDataVo;i.initBase(t[e]),this.mailData.push(i)}this.mailSort(1),this.dispatchMailData()},e.prototype.dispatchMailData=function(){EventMgr.ins().dispatch(215)},e.prototype.downMailDetailedData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new EmailDataVo;i.init(t);for(var o=0;o<this.mailData.length;o++)if(this.mailData[o].handle==i.handle){this.mailData.splice(o,1,i);break}this.currentMailHandle=i.handle,emailUserControl.isAllReceive||UIMgr.ins().open(EmailDetailedView),this.dispatchMailDetail(i)},e.prototype.dispatchMailDetail=function(t){EventMgr.ins().dispatch(216,t)},e.prototype.downDeleteMail=function(t){this.deleteMailDataByHandle(t),this.dispatchMailData()},e.prototype.downGetItemMail=function(t){for(var e=0;e<t.length;e++)for(var i=t[e][0],o=0,n=this.mailData;o<n.length;o++){var r=n[o];if(r.handle==i){r.type=t[e][1],r.receive=t[e][2],this.dispatchMailDetail(r);break}}this.dispatchGetItemFromMail()},e.prototype.dispatchGetItemFromMail=function(){EventMgr.ins().dispatch(217)},e.prototype.downAddMail=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new EmailDataVo;i.initBase(t),this.mailData.unshift(i),this.dispatchMailData()},e.prototype.getMailDataByHandle=function(t){for(var e=0,i=this.mailData;e<i.length;e++){var o=i[e];if(o.handle==t)return o}return null},e.prototype.deleteMailDataByHandle=function(t){for(var e=0;e<this.mailData.length;e++)if(this.mailData[e].handle==t)return void this.mailData.splice(e,1)},e.prototype.getMailByReceive=function(t){void 0===t&&(t=0);for(var e=[],i=this.mailData.length-1;i>=0;i--)this.mailData[i].receive==t&&e.push(this.mailData[i]);return e},e.prototype.getUnreadMail=function(){for(var t=0,e=this.mailData.length-1;e>=0;e--){var i=this.mailData[e];(0==i.type||0==i.receive)&&(t+=1)}return t},e.prototype.getCurrentMail=function(){return this.getMailDataByHandle(this.currentMailHandle)},e.prototype.sortDesc=function(t,e){return SortUtils.sortDescByKey(t,e,"times")},e.prototype.sortAsc=function(t,e){return SortUtils.sortAscByKey(t,e,"times")},e.prototype.mailSort=function(t){var e=this.mailData;return t?e.sort(this.sortDesc):e.sort(this.sortAsc),e},e.prototype.mailSort2=function(t,e){var i=0;return i=SortUtils.sortAscByKey(t,e,"type"),0!=i?i:0==t.receive&&0!=e.receive?-1:0!=t.receive&&0==e.receive?1:(i=SortUtils.sortDescByKey(t,e,"times"),0!=i?i:i)},__decorate([up(2,[3])],e.prototype,"upMailContentData",null),__decorate([up(4,[[3]])],e.prototype,"upGetItem",null),__decorate([down(1,[ByteConst.EmailBaseVos])],e.prototype,"downMailData",null),__decorate([down(2,ByteConst.EmailDataVos.slice())],e.prototype,"downMailDetailedData",null),__decorate([down(3,[3])],e.prototype,"downDeleteMail",null),__decorate([down(4,[[3,3,3]])],e.prototype,"downGetItemMail",null),__decorate([down(5,ByteConst.EmailBaseVos.slice())],e.prototype,"downAddMail",null),e=__decorate([protocolsId(8)],e)}(BaseSystem);__reflect(EmailUserControl.prototype,"EmailUserControl");var EmailDataVo=function(){function t(){}return t.prototype.initBase=function(t){this.handle=t[0],this.title=t[1],this.times=t[2],this.type=t[3],this.receive=t[4]},t.prototype.init=function(t){this.initBase(t.slice(0,5)),this.item=[],this.text=t[5];for(var e=0;e<t[6].length;e++){var i=new RewardVo;i.init(t[6][e]),this.item.push(i)}},t}();__reflect(EmailDataVo.prototype,"EmailDataVo");var EmailDetailedView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="EmailDetailedViewSkin",this.itemList.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.rect,this.onTap),this.addEventTextLink(this.textLabel,this.linkClick),this.addEventTouchTap(this.receiveBtn,this.onTap),this.addCustomEvent(217,this.setMailData),this.setMailData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},e.prototype.linkClick=function(t){var e=t.text.split(","),i=e.slice(1);e[0]&&(UIMgr.ins().open(e[0],i[0]?i:null),UIMgr.ins().close(this),UIMgr.ins().close("PartnerBgView"))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.receiveBtn:var e=[];e.push(emailUserControl.currentMailHandle),emailUserControl.upGetItem(e);case this.closeBtn:case this.closeBtn0:case this.rect:UIMgr.ins().close(this)}},e.prototype.otherClose=function(t){var e=this.background;t.localX>=e.x&&t.localX<=e.x+e.width&&t.localY>=e.y&&t.localY<=e.y+e.height||UIMgr.ins().close(this)},e.prototype.setMailData=function(){var t=emailUserControl.getCurrentMail();this.textLabel.textFlow=TextUtils.generateTextFlow1(t.text),this.setReceiveBtn(t.receive,t.item.length>0),this.itemList.dataProvider=new eui.ArrayCollection(t.item)},e.prototype.setReceiveBtn=function(t,e){void 0===e&&(e=!1);var i="";this.receiveBtn.visible=t>=0,i=t?LangMgr.getValueByKey("activitAlreadingGet"):LangMgr.getValueByKey("mailTips1"),this.receiveBtn.label=i,this.receiveBtn.enabled=!Boolean(t),this.receiveBtn.visible=e,this.desc.visible=!e},e}(BaseEuiView);__reflect(EmailDetailedView.prototype,"EmailDetailedView");var EmailPanel=function(t){function e(){var e=t.call(this)||this;return e.name=LangMgr.getValueByKey("chatMenu7"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this._mails=[],this.mailList.itemRenderer=EmailItemRenderer,this.mailScroller.viewport=this.mailList},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.allReceiveBtn,this.onTap),this.addEventTouchTap(this.mailList,this.onSendMail),this.addCustomEvent(216,this.setOpenMail),this.addCustomEvent(217,this.mailCall),this.setMailData()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];WatcherUtil.removeFromArrayCollection(this.mailList.dataProvider),this.mailList.dataProvider=null},e.prototype.mailCall=function(){if(emailUserControl.isAllReceive)for(var t=0;t<this._mails.length;t++)emailUserControl.upMailContentData(this._mails[t].handle)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.allReceiveBtn:emailUserControl.isAllReceive=!0;for(var e=[],i=emailUserControl.getMailByReceive(),o=0;o<i.length;o++)e.push(i[o].handle);emailUserControl.upGetItem(e)}},e.prototype.onSendMail=function(t){if(t){emailUserControl.isAllReceive=!1;var e=t.target.parent;if(e){var i=e.data;i&&emailUserControl.upMailContentData(i.handle)}}},e.prototype.setMailData=function(){this._mails=emailUserControl.mailData,this.mailList.dataProvider=new eui.ArrayCollection(this._mails),this.allReceiveBtn.visible=Boolean(emailUserControl.getMailByReceive().length),emailUserControl.mailData.length>0&&(this.noMailTip.visible=!1)},e.prototype.setOpenMail=function(t){for(var e=0;e<this.mailList.numChildren;e++){var i=this.mailList.getChildAt(e);if(i.data.handle==t.handle)return void(i.data=t)}},e}(BasePanel);__reflect(EmailPanel.prototype,"EmailPanel");var EmailItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="EmailItemRendererSkin",e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.dataChanged=function(){var t=this.data;if(t instanceof EmailDataVo){var e="|C:"+LangMgr.getColor("color78")+"&T:"+t.title+"|";e=e+"|C:"+(t.type?LangMgr.getValueByKey("color76"):LangMgr.getValueByKey("color77"))+"&T:"+(t.type?LangMgr.getValueByKey("mailTips2"):LangMgr.getValueByKey("mailTips3"))+"|",this.nameLabel.textFlow=TextUtils.generateTextFlow(e),this.dateLabel.text=DateUtils.getFormatBySecond(t.times,2),this.treasure.source=0==t.receive?"220003_png":""}},e}(BaseItemRender);__reflect(EmailItemRenderer.prototype,"EmailItemRenderer");var FeatherControl=function(t){function e(){var e=t.call(this)||this;return e.timeID=0,e.godWing=[],e.isListen=!1,e.godWingForge=[],e.addCustomEventMany(e.startCheckHaveCan,266,268,352,461,206,267,210),e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e,"WingMaxLv",{get:function(){return DataCenter.ins().FeatherCommonConfig.wingMaxLv},enumerable:!0,configurable:!0}),e.prototype.initConfig=function(){if(!this.wingSkillDic){this.wingSkillDic=[];var t=DataCenter.ins().FeatherLevelConfig;for(var e in t)t[e].pasSkillId&&this.wingSkillDic.push(t[e].pasSkillId)}},e.prototype.getWingSkillByIndex=function(t){return this.initConfig(),this.wingSkillDic[t]},e.prototype.startCheckHaveCan=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=-1),this.isListen||(this.isListen=!0,TimerMgr.ins().doTimerDelay(3e3,1e3,1,this.showNavBtnRedPoint,this))},e.prototype.upBoost=function(t,e){return[t,e]},e.prototype.upUpgrade=function(t){return[t]},e.prototype.upActivate=function(t){return[t]},e.prototype.upBigUpLevel=function(t){return[t]},e.prototype.downUpDataWing=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];heroControl.getSubRoleByIndex(t).wingsData.init(e)},e.prototype.downBoost=function(t,e,i,o,n,r){var a=heroControl.getSubRoleByIndex(t).wingsData.lv;if(heroControl.getSubRoleByIndex(t).wingsData.parserBoost(e,i),heroControl.getSubRoleByIndex(t).wingsData.parserClearTime(n),this.dispatchBoost(r,o),a!=heroControl.getSubRoleByIndex(t).wingsData.lv){var s=DataCenter.ins().FeatherLevelConfig[heroControl.getSubRoleByIndex(t).wingsData.lv];heroControl.getSubRoleByIndex(t).setWingSkill();var l=UnitMgr.ins().getMainRole(t);l&&l.updateModel(),EventMgr.ins().dispatch(206),CommonFun.show(1,s.name,"j"+s.appearance+"_png")}this.dispatchWingTime()},e.prototype.dispatchBoost=function(t,e){EventMgr.ins().dispatch(580,[t,e])},e.prototype.downActivate=function(t,e){heroControl.getSubRoleByIndex(t).wingsData.parserOpenStatus(e);var i=DataCenter.ins().FeatherLevelConfig[0];CommonFun.show(0,i.name,"j"+i.appearance+"_png");var o=UnitMgr.ins().getMainRole(t);o&&o.updateModel(),EventMgr.ins().dispatch(208)},e.prototype.dispatchWingTime=function(){EventMgr.ins().dispatch(581)},e.prototype.showNavBtnRedPoint=function(){this.isListen=!1;var t=!1;return ActorControl.level,ActorControl.level>=DataCenter.ins().FeatherCommonConfig.openLevel&&!t&&CommonFun.andState(this.canGradeupWing())?void roleControl.showNavBtnRedPoint(!0):this.canUseFlyUp()?void roleControl.showNavBtnRedPoint(!0):this.canUseAptitude()?void roleControl.showNavBtnRedPoint(!0):void roleControl.showNavBtnRedPoint(!1)},e.prototype.getLevelBySkill=function(t){if(!this.wingSkillLevelDic){this.wingSkillLevelDic=[];var e=DataCenter.ins().FeatherLevelConfig;for(var i in e)e[i].pasSkillId>0&&this.wingSkillLevelDic.push(e[i].level)}return this.wingSkillLevelDic[t]?this.wingSkillLevelDic[t]:0},e.prototype.canGradeupWing=function(){var t=[!1,!1,!1];return t},e.prototype.canItemGradeupWing=function(){for(var t=[!1,!1,!1],e=i.WingMaxLv,o=heroControl.subRolesLen,n=0;o>n;n++){var r=heroControl.getSubRoleByIndex(n).wingsData.openStatus;if(r){var a=heroControl.getSubRoleByIndex(n).wingsData.lv;if(e>a&&a<i.WingExpRedPoint){var s=DataCenter.ins().FeatherLevelConfig[a];if(Assert(s,"get WingLevelConfig null "+a))continue;var l=backpackControl.getBagGoodsCountById(0,s.itemId);t[n]=s.itemNum<=l}else t[n]=!1;if(!t[n]){var h=backpackControl.getBagGoodsCountById(0,DataCenter.ins().FeatherCommonConfig.levelItemid);t[n]=h>0&&a==i.WingExpRedPoint}}}return t},e.prototype.isHaveActivationWing=function(t){void 0===t&&(t=-1);var e=ActorControl.level,i=DataCenter.ins().FeatherCommonConfig.openLevel;if(i>e)return!1;var o=heroControl.subRolesLen;if(-1==t)for(var n=0;o>n;n++){var r=heroControl.getSubRoleByIndex(n).wingsData;if(!r.openStatus)return!0}else{var r=heroControl.getSubRoleByIndex(t).wingsData;if(!r.openStatus)return!0}return!1},e.prototype.canRoleOpenWing=function(){for(var t=[!1,!1,!1],e=heroControl.subRolesLen,i=0;e>i;i++){var o=heroControl.getSubRoleByIndex(i).wingsData.openStatus;t[i]=!o&&ActorControl.level>=16}return t},e.prototype.upWingWear=function(t,e){return[t,e]},e.prototype.downWingWear=function(t){EventMgr.ins().dispatch(207,t)},e.prototype.downGodWingData=function(t,e){this.godWing[t]||(this.godWing[t]=new FeatherDeityVo),this.godWing[t].parser(e),EventMgr.ins().dispatch(209)},e.prototype.upUseDan=function(t,e){return[t,e]},e.prototype.downUseDanSuccess=function(t,e,i){var o=heroControl.getSubRoleByIndex(t).wingsData;0==e?o.aptitudeDan=i:o.flyUpDan=i,EventMgr.ins().dispatch(210)},e.prototype.canUseFlyUp=function(){for(var t=heroControl.roles.length,e=0;t>e;e++)if(this.canUseFlyUpByRoleID(e))return!0;return!1},e.prototype.canUseFlyUpByRoleID=function(t){var e=heroControl.getSubRoleByIndex(t);if(e.wingsData&&1==e.wingsData.openStatus&&e.wingsData.flyUpDan<DataCenter.ins().FeatherLevelConfig[e.wingsData.lv].flyPill){var i=backpackControl.getBagItemById(DataCenter.ins().FeatherCommonConfig.flyPillId),o=i?i.count:0;if(o)return!0}return!1},e.prototype.canUseAptitude=function(){for(var t=heroControl.roles.length,e=0;t>e;e++)if(this.canUseAptitudeByRoleID(e))return!0;return!1},e.prototype.canUseAptitudeByRoleID=function(t){var e=heroControl.getSubRoleByIndex(t);if(e.wingsData&&1==e.wingsData.openStatus&&e.wingsData.aptitudeDan<DataCenter.ins().FeatherLevelConfig[e.wingsData.lv].attrPill){var i=backpackControl.getBagItemById(DataCenter.ins().FeatherCommonConfig.attrPillId),o=i?i.count:0;if(o)return!0}return!1},e.prototype.userDans=function(t){for(var e,i,o,n=heroControl.roles.length,r=null,a=null,s=0,l=0,h=t==DataCenter.ins().FeatherCommonConfig.attrPillId,u=0;n>u;u++)e=heroControl.getSubRoleByIndex(u),1==e.wingsData.openStatus?(i=DataCenter.ins().FeatherLevelConfig[e.wingsData.lv],o=h&&e.wingsData.aptitudeDan>=i.attrPill||!h&&e.wingsData.flyUpDan>=i.flyPill,o?l++:(r||(r=e),e.wingsData.lv>r.wingsData.lv&&(r=e),a||(a=e),h&&e.wingsData.aptitudeDan>r.wingsData.aptitudeDan&&(a=e),!h&&e.wingsData.flyUpDan>r.wingsData.flyUpDan&&(a=e))):s++;if(s>=n)return void tipsControl.showTips(LangMgr.getValueByKey("allroleUnopenedwing"));if(l>=n)return void tipsControl.showTips(h?LangMgr.getValueByKey("allrolewingzzfull"):LangMgr.getValueByKey("allrolewingfsfull"));var c=r.index;r.index!=a.index&&r.wingsData.lv==a.wingsData.lv&&(c=a.index),UIMgr.ins().open("RoleView",3,c)},e.prototype.upWingCompose=function(t,e,i){var o=[t,e];return 1==t&&o.push(i),o},e.prototype.upResetGodWing=function(t,e){return[t,e]},e.prototype.getCurLevelItemId=function(t,e){var i,o;return this.godWing[t]&&(o=this.godWing[t].getLevel(e))?i=DataCenter.ins().FeatherDeityLevelConfig[o][e]:null},e.prototype.getNextLevelItemId=function(t,e){var i;return i=this.godWing[t].getLevel(e),i=i?this.getNextLevel(i):0,DataCenter.ins().FeatherDeityLevelConfig[i]?DataCenter.ins().FeatherDeityLevelConfig[i][e]:null},e.prototype.quickComposeRedPoint=function(t,e){var i=featherControl.getGodWing(t).getLevel(e),o=this.getNextLevel(i);if(!o)return!1;var n=DataCenter.ins().FeatherDeityLevelConfig[o][e];return this.checkGodWingLevel(t,n.itemId)&&this.checkGodWingItem(t,n.itemId,e)?!0:!1},e.prototype.wearItemRedPoint=function(t,e){return this.checkSlotLevel(t,e)?!0:!1},e.prototype.gridRedPoint=function(t,e){return this.wearItemRedPoint(t,e)?!0:this.quickComposeRedPoint(t,e)},e.prototype.isWearGodWing=function(t){var e=heroControl.getSubRoleByIndex(t);if(!e)return!1;for(var o=1;o<=i.GodWingMaxSlot;o++)if(this.gridRedPoint(e.index,o))return!0;return!1},e.prototype.checkSlot=function(t,e){var i=this.getGodWing(t).getLevel(e);return i?!0:!1},e.prototype.getWearItem=function(t,e){for(var i=this.getGodWing(t).getLevel(e),o=backpackControl.getBagGoodsByType(16),n=0;n<o.length;n++){var r=DataCenter.ins().FeatherItemConfig[o[n].configID];if(this.checkGodWingLevel(t,r.itemId)&&r.slot==e&&r.level>i)return r.itemId}return 0},e.prototype.checkSlotLevel=function(t,e){for(var i=this.getGodWing(t).getLevel(e),o=backpackControl.getBagGoodsByType(16),n=0;n<o.length;n++){var r=DataCenter.ins().FeatherItemConfig[o[n].configID];if(this.checkGodWingLevel(t,r.itemId)&&r.slot==e&&r.level>i)return!0}return!1},e.prototype.checkGodWingLevel=function(t,e){var i=DataCenter.ins().FeatherItemConfig[e],o=0,n=heroControl.getSubRoleByIndex(t).wingsData;return o+=n.lv,n.openStatus&&(o+=1),o>=i.level?!0:!1},e.prototype.checkGodWingItem=function(t,e,i){var o=DataCenter.ins().FeatherItemConfig[e],n=o.composeItem.count,r=0,a=backpackControl.getBagItemById(o.composeItem.id);if(a&&(r=a.count),i){var s=this.getGodWing(t).getLevel(i);s&&(n-=1)}return r>=n?!0:!1},e.prototype.isQuicComposeGodWing=function(t,e){var i=heroControl.getSubRoleByIndex(t);if(!i)return!1;var o=this.godWing[t].getLevel(e);if(o||(o=this.getStartLevel(e)),!o)return!1;var n=0,r=heroControl.getSubRoleByIndex(t).wingsData;if(n+=r.lv,r.openStatus&&(n+=1),o>n)return!1;var a=this.getGodWing(t).getLevel(e);if(a&&(o=this.getNextLevel(o),!o))return!1;var s=DataCenter.ins().FeatherDeityLevelConfig[o][e].itemId,l=DataCenter.ins().FeatherItemConfig[s],h=l.composeItem.count,u=0,c=backpackControl.getBagItemById(l.composeItem.id);c&&(u=c.count);var p=this.getGodWing(t).getLevel(e);if(p){var d=DataCenter.ins().FeatherDeityLevelConfig[p][e];d.itemId==l.composeItem.id&&(u+=1)}return u>=h?!0:!1},e.prototype.isComposeGodWingOnly=function(t){var e=DataCenter.ins().FeatherItemConfig[t],i=e.composeItem.count,o=0,n=backpackControl.getBagItemById(e.composeItem.id);return n&&(o=n.count),o>=i?!0:!1},e.prototype.isComposeGodWingAll=function(){for(var t in DataCenter.ins().FeatherDeitySuitConfig)for(var e=DataCenter.ins().FeatherDeitySuitConfig[t],o=1;o<=i.GodWingMaxSlot;o++){var n=DataCenter.ins().FeatherDeityLevelConfig[e.lv][o];if(this.isComposeGodWingOnly(n.itemId))return!0}return!1},e.prototype.isComposeGodWingLevel=function(t,e){var i=DataCenter.ins().FeatherDeityLevelConfig[t][e];return this.isComposeGodWingOnly(i.itemId)},e.prototype.isComposeGodWingSlot=function(t,e){var i=DataCenter.ins().FeatherDeitySuitConfig[t],o=DataCenter.ins().FeatherDeityLevelConfig[i.lv][e];return this.isComposeGodWingOnly(o.itemId)},e.prototype.isComposeGodWing=function(t){for(var e=(heroControl.subRolesLen,0);3>e;e++){var i=heroControl.getSubRoleByIndex(e);if(i)for(var o=this.calcGodWingSlot(e),n=0;n<o.length;n++){var r=DataCenter.ins().FeatherDeityLevelConfig[o[n].level][o[n].slot];if(t){var a=0,s=heroControl.getSubRoleByIndex(e).wingsData;if(a+=s.lv,s.openStatus&&(a+=1),a<r.level)continue}var l=DataCenter.ins().FeatherItemConfig[r.itemId],h=l.composeItem.id,u=backpackControl.getBagItemById(h),c=l.composeItem.count,p=u?u.count:0;if(p>=c)return!0}}return!1},e.prototype.calcGodWingSlot=function(t){for(var e=[],o=1;o<=i.GodWingMaxSlot;o++){var n=featherControl.getGodWing(t).getLevel(o),r={slot:0,level:0};r.slot=o,n||(n=this.getStartLevel(o)),r.level=n,e.push(r)}return e},e.prototype.getStartLevel=function(t){for(var e in DataCenter.ins().FeatherDeityLevelConfig){var i=DataCenter.ins().FeatherDeityLevelConfig[e];for(var o in i)if(i[o].slot==t)return i[o].level}return 0},e.prototype.getPreLevel=function(t){var e=0;for(var i in DataCenter.ins().FeatherDeityLevelConfig)if(e){if(Number(i)==t)return e;e=Number(i)}else e=Number(i);return e},e.prototype.getNextLevel=function(t){var e=[];for(var i in DataCenter.ins().FeatherDeityLevelConfig)e.push(+i);e.sort(function(t,e){return e>t?-1:1});for(var o=0,n=e;o<n.length;o++){var r=n[o];if(r>t)return r}return 0},e.prototype.getNameFromSlot=function(t){return LangMgr.getValueByKey("wingType"+t)},e.prototype.getGodWing=function(t){return this.godWing[t]||(this.godWing[t]=new FeatherDeityVo),this.godWing[t]},e.prototype.getGodWingItem=function(){for(var t=0,e=0;e<heroControl.subRolesLen;e++){var i=this.getGodWing(e);i&&i.getData()&&(t+=CommonUtils.getObjectLength(i.getData()))}return t},e.prototype.checkDanRed=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++)if(this.checkDanRedByIndex(e))return!0;return!1},e.prototype.checkDanRedByIndex=function(t){var e=heroControl.getSubRoleByIndex(t);if(!e||!e.wingsData.openStatus)return!1;for(var i=DataCenter.ins().FeatherCommonConfig.upgrateItem,o=0;o<i.length;o++){var n=i[o];if(!backpackControl.isHideDanIcon(n)){if(backpackControl.getBagGoodsCountById(BackpackControl.BAG_TYPE_OTHTER,n)&&e.wingsData.lv==DataCenter.ins().ItemConfig[n].useArg.maxLevel)return!0;break}}return!1},e.prototype.checkIsOpen=function(){if(heroControl.subRolesLen<3)return!1;for(var t=DataCenter.ins().FeatherCommonConfig.forgeOpenLv,e=0;3>e;e++){var i=heroControl.getSubRoleByIndex(e);if(i.wingsData.lv<t)return!1}return!0},e.prototype.checkRoleRed=function(t){for(var e=1;e<=featherControl.GodWingMaxSlot;e++)if(this.checkSlotRed(t,e))return!0;return!1},e.prototype.checkSlotRed=function(t,e){var i=this.getGodWingForgeData(t).getSlotData(e);if(!i.isTupo)for(var o in DataCenter.ins().FeatherDeityForgeExtraLvConfig){var n=DataCenter.ins().FeatherDeityForgeExtraLvConfig[o];if(n.forgeLvLimit==i.lv){var r=backpackControl.getBagGoodsCountById(0,DataCenter.ins().FeatherCommonConfig.forgeExtraItemId);return r>=n.cost}}var a=i.lv+1,s=DataCenter.ins().FeatherDeityForgeLvConfig[a];if(!s)return!1;var l=backpackControl.getBagGoodsCountById(0,DataCenter.ins().FeatherCommonConfig.forgeItemId);return l>=s.cost},e.prototype.checkIsCanTupo=function(t){for(var e in DataCenter.ins().FeatherDeityForgeExtraLvConfig){var i=DataCenter.ins().FeatherDeityForgeExtraLvConfig[e];if(i.forgeLvLimit==t)return!0}return!1},e.prototype.downAllForge=function(t){for(var e=0;t.length>e;e++){var i=new FeatherDeityForgeVo;i.parse(t[e]),this.godWingForge[i.roleId]=i}EventMgr.ins().dispatch(719)},e.prototype.upForge=function(t,e){return[t,e]},e.prototype.downItemForge=function(t,e,i,o){var n=this.getGodWingForgeData(t).getSlotData(e);return n.lv=i,n.isTupo=o,EventMgr.ins().dispatch(720),n},e.prototype.getGodWingForgeData=function(t){var e=this.godWingForge[t];return e||(e=new FeatherDeityForgeVo,e.roleId=t,this.godWingForge[t]=e),e},e.prototype.getSkillLv=function(t){for(var e=this.getGodWingForgeData(t),o=Number.MAX_VALUE,n=1;n<=i.GodWingMaxSlot;n++){var r=e.getSlotData(n),a=this.getStarData(r.lv,r.isTupo).level;o=Math.min(o,a)}return o},e.prototype.getStarData=function(t,e){var i=0,o=0;if(e&&t%10==0&&0!=t)i=Math.floor(t/10)-1,o=10;else{i=Math.floor(t/10),o=t%10;var n=DataCenter.ins().FeatherDeityForgeLvConfig[t+1];n||(i=Math.floor(t/10)-1,o=10)}return{level:i,star:o}},e.WingExpRedPoint=3,e.GodWingMaxSlot=4,e.hint=!0,__decorate([up(2,[2,1])],e.prototype,"upBoost",null),__decorate([up(3,[2])],e.prototype,"upUpgrade",null),__decorate([up(4,[2])],e.prototype,"upActivate",null),__decorate([up(12,[3])],e.prototype,"upBigUpLevel",null),__decorate([down(1,[2].concat(ByteConst.FeatherVos))],e.prototype,"downUpDataWing",null),__decorate([down(2,[2,3,6,3,6,2])],e.prototype,"downBoost",null),__decorate([down(4,[2,3])],e.prototype,"downActivate",null),__decorate([up(3,[2,3])],e.prototype,"upWingWear",null),__decorate([down(3,[0])],e.prototype,"downWingWear",null),__decorate([down(5,[2,[2,3]])],e.prototype,"downGodWingData",null),__decorate([up(8,[1,1])],e.prototype,"upUseDan",null),__decorate([down(8,[1,1,2])],e.prototype,"downUseDanSuccess",null),__decorate([up(6,[2,3,3])],e.prototype,"upWingCompose",null),__decorate([up(7,[3,3])],e.prototype,"upResetGodWing",null),__decorate([down(13,[[1,[3,1]]])],e.prototype,"downAllForge",null),__decorate([up(14,[1,1])],e.prototype,"upForge",null),__decorate([down(14,[1,1,3,1])],e.prototype,"downItemForge",null),e=i=__decorate([protocolsId(6)],e);var i}(BaseSystem);__reflect(FeatherControl.prototype,"FeatherControl");var FeatherVo=function(){function t(){this.openStatus=0,this.clearTime=0,this.aptitudeDan=0,this.flyUpDan=0}return t.prototype.init=function(t){this.parserBoost(t[0],t[1]),this.parserOpenStatus(t[2]),this.parserClearTime(t[3]),this.parserDans(t[4],t[5])},t.prototype.parserBoost=function(t,e){this.lv=t,this.exp=e},t.prototype.parserOpenStatus=function(t){this.openStatus=t},t.prototype.parserClearTime=function(t){this.clearTime=t},t.prototype.parserDans=function(t,e){this.aptitudeDan=t,this.flyUpDan=e},t.prototype.getImgSource=function(){return this.lv>FeatherControl.WingMaxLv||this.lv<0?"":DataCenter.ins().FeatherLevelConfig[this.lv].appearance+"_png"},t.getWingAllLevel=function(){for(var t=0,e=heroControl.subRolesLen,i=0;e>i;i++){var o=heroControl.getSubRoleByIndex(i).wingsData;t+=o.lv,o.openStatus&&(t+=1)}return t},t}();__reflect(FeatherVo.prototype,"FeatherVo");var FeatherAptitudesTipsView=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e.skinName="FeatherAptitudesTipsViewSkin",e.isTopLevel=!0,e.itemImg.source="200238_png",e.itemIcon.source="200238_png",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this.addCustomEvent(266,this.itemChange),this.addCustomEvent(267,this.itemChange),this.addCustomEvent(268,this.itemChange),this.addCustomEvent(210,this.update),this.addCustomEvent(206,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(this._curRole),e=DataCenter.ins().FeatherLevelConfig[t.wingsData.lv];this.wingName.text=e.name,this.zizhiLv.text=t.wingsData.aptitudeDan+LangMgr.getValueByKey("numberLevel",""),this.career.text=RoleModel.getJobNameByJob(t.job);var i=e.attrPill;if(t.wingsData.aptitudeDan>=i)this.currentState="maxLv";else{var o=backpackControl.getBagItemById(DataCenter.ins().FeatherCommonConfig.attrPillId),n=o?o.count:0;this.currentState=n?"normal":"noitem"}this.updateAttrs()},e.prototype.updateAttrs=function(){for(var t,e=heroControl.getSubRoleByIndex(this._curRole),i=DataCenter.ins().FeatherCommonConfig.attrPill,o=i.length,n=[],r=1;4>=r;r++)this["attr"+r].text="",this["attr"+r+"NextLv"].text="",o>=r&&(t=i[r-1],this["attr"+r].text=AttributeData.getAttrStrByType(t.type)+": +"+t.value*e.wingsData.aptitudeDan,n.push(new AttributeData(t.type,t.value*e.wingsData.aptitudeDan)),"normal"==this.currentState&&(this["attr"+r+"NextLv"].text="+"+i[r-1].value*(e.wingsData.aptitudeDan+1)));this.powerPanel.setPower(BackpackControl.getAttrPower(n))},e.prototype.itemChange=function(){if("maxLv"!=this.currentState){var t,e=backpackControl.getBagItemById(DataCenter.ins().FeatherCommonConfig.attrPillId),i=e?e.count:0;i?(t="normal"!=this.currentState,this.currentState="normal"):(t="noitem"!=this.currentState,this.currentState="noitem"),t&&this.updateAttrs()}},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.updateBtn:featherControl.upUseDan(this._curRole,0)}},e}(BaseEuiView);__reflect(FeatherAptitudesTipsView.prototype,"FeatherAptitudesTipsView");var FeatherHintView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FeatherHintViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.type=t[0],this.index=t[1],this.data=t[2],this.addEventTouchTap(this.closeBtn,this.onClick),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onClick),this.addEventTouchTap(this.up,this.onClick),this.addEventTouchTap(this.BG,this.onClick),this.lastTimeDown=Math.floor((DateUtils.formatMiniDateTime(this.data.clearTime)-GameServer.serverTime)/1e3),this.lastTimeDown=(DateUtils.formatMiniDateTime(this.data.clearTime)-GameServer.serverTime)/1e3,this.lastTimeDown=Math.max(0,this.lastTimeDown),this.desc.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("roleTips8",this.data.exp,DateUtils.getFormatBySecond(this.lastTimeDown,1)))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onClick),this.removeEventTouchTap(this.up,this.onClick),this.removeEventTouchTap(this.BG,this.onClick)},e.prototype.onClick=function(t){switch(UIMgr.ins().close(this),t.currentTarget){case this.closeBtn:if(1==this.type){var e=UIMgr.ins().getView("RoleView");e.setTabSelectedIndex(this.index)}else 2==this.type&&UIMgr.ins().close("RoleView")}FeatherControl.hint=!this.nextHint.selected},e}(BaseEuiView);__reflect(FeatherHintView.prototype,"FeatherHintView");var FeatherPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.barbc=new ProgressBarEff,e.curRole=0,e._lastLv=0,e._isAutoUp=!1,e.currViewNum=0,e.lastTimeDown=0,e.rapetNum=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.boostPrice1.setType(5),this.barbc.setWidth(525),this.barbc.x=10,this.barbc.y=-37,this.skillGroup.addChild(this.barbc),this.mc=new GameMovieClip,this.mc.x=214,this.mc.y=245,this.wingImg.touchEnabled=!1,this.reliveEff=new GameMovieClip,this.reliveEff.scaleX=1,this.reliveEff.scaleY=1,this.skillIconArr=[];for(var t=0;5>t;t++)this.skillIconArr[t]=this["itemicon"+t];this.danItemID=DataCenter.ins().FeatherCommonConfig.levelItemid},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.openStatusBtn,this.onTap),this.addEventTouchTap(this.boostBtn1,this.onTap),this.addEventTouchTap(this.checkBoxs,this.isShowUpGradeBtn),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.bigUpLevelBtn,this.onTap),this.addEventTouchTap(this.boostBtn0,this.onTap),this.addEventTouchTap(this.shenyu,this.onTap),this.addEventTouchTap(this.feishengBtn,this.onTap),this.addEventTouchTap(this.zizhiBtn,this.onTap);for(var i=0;5>i;i++)this.addEventTouchTap(this.skillIconArr[i],this.skillItemClick);this.addCustomEvent(580,this.showBoost),this.addCustomEvent(206,this.updateLevel),this.addCustomEvent(208,this.setWingData),this.addCustomEvent(581,this.setTimeDown),this.addCustomEvent(267,this.isShowUpGradeBtn),this.addCustomEvent(266,this.isShowUpGradeBtn),this.addCustomEvent(268,this.isShowUpGradeBtn),this.addCustomEvent(582,this.updateRedPoint),this.addCustomEvent(210,this.setWingData),this.barbc.reset(),this.setWingData(),this.updateLevel(),this.updateRedPoint(),this.upBtn.open(DataCenter.ins().FeatherCommonConfig.upgrateItem,this.curRole)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.openStatusBtn,this.onTap),this.removeEventTouchTap(this.boostBtn1,this.onTap),this.removeEventTouchTap(this.checkBoxs,this.isShowUpGradeBtn),this.removeEventTouchTap(this.rightBtn,this.onTap),this.removeEventTouchTap(this.leftBtn,this.onTap),this.removeEventTouchTap(this.boostBtn0,this.onTap),this.removeEventTouchTap(this.bigUpLevelBtn,this.onTap),this.removeEventTouchTap(this.shenyu,this.onTap),this.removeEventTouchTap(this.feishengBtn,this.onTap),this.removeEventTouchTap(this.zizhiBtn,this.onTap);for(var i=0;5>i;i++)this.removeEventTouchTap(this.skillIconArr[i],this.skillItemClick);TimerMgr.ins().remove(this.autoUpStar,this),this.removeCustomEvents(),this._isAutoUp&&this.stopAutoUp(),TimerMgr.ins().remove(this.refushTimeLabel,this),this.upBtn.close()},e.prototype.updateLevel=function(){for(var t=heroControl.getSubRoleByIndex(this.curRole).wingSkillData,e=0,i=0;5>i;i++)if(t[i]&&t[i]>0)this.skillIconArr[i].data=t[i],this["openTxt"+i].text="",e=i+1;else{var o=featherControl.getLevelBySkill(i);
this["openTxt"+i].text=LangMgr.getValueByKey("wingOpen",o+1);var n=DataCenter.ins().FeatherLevelConfig[o];n&&n.pasSkillId&&(this.skillIconArr[i].data=n.pasSkillId,this.skillIconArr[i].blackImg.visible=!0)}if(5>e){var r=void 0,a=DataCenter.ins().FeatherLevelConfig,s=0;for(var l in a){var n=a[l];if(n&&n.pasSkillId){if(r=n.pasSkillId,s==e)break;s++}}r&&(this.skillIconArr[e].data=r,this.skillIconArr[e].blackImg.visible=!0)}this._isAutoUp&&this.stopAutoUp(),this.setWingData()},e.prototype.updateDans=function(){this.redPoint1.visible=featherControl.canUseFlyUpByRoleID(this.curRole),this.redPoint2.visible=featherControl.canUseAptitudeByRoleID(this.curRole)},e.prototype.onTap=function(t){var e=this;switch(t.currentTarget){case this.openStatusBtn:ActorControl.level>=DataCenter.ins().FeatherCommonConfig.openLevel?this.showOpenMovie():tipsControl.showTips(LangMgr.getValueByKey("wingNoActivity"));break;case this.boostBtn1:this._isAutoUp&&this.stopAutoUp(),this.autoUpStar();break;case this.rightBtn:this.currViewNum++,this.setSeeBtnStatu(),this.setWingView(this.currViewNum);break;case this.leftBtn:this.currViewNum--,this.setSeeBtnStatu(),this.setWingView(this.currViewNum);break;case this.boostBtn0:this.boostBtn0.label==LangMgr.getValueByKey("wingStop")?this._isAutoUp&&this.stopAutoUp():(this._isAutoUp=!0,this.boostBtn0.label=LangMgr.getValueByKey("wingStop"),TimerMgr.ins().doTimer(150,0,this.autoUpStar,this));break;case this.bigUpLevelBtn:var i=DataCenter.ins().ItemConfig[this.danItemID].name;warnControl.show(LangMgr.getValueByKey("wingUpdate",i,DataCenter.ins().ItemConfig[this.danItemID].desc),function(){featherControl.upBigUpLevel(e.curRole)},this);break;case this.shenyu:UIMgr.ins().open(FeatherDeityView);break;case this.feishengBtn:UIMgr.ins().open(FeatherSoaringTipsView,this.curRole);break;case this.zizhiBtn:UIMgr.ins().open(FeatherAptitudesTipsView,this.curRole)}},e.prototype.skillItemClick=function(t){var e=this.skillIconArr.indexOf(t.currentTarget);if(e>=0){if(!this.skillIconArr[e].skillIcon.visible)return;UIMgr.ins().open(FeatherSkillTipsView,featherControl.getWingSkillByIndex(e),e,this.curRole)}},e.prototype.stopAutoUp=function(){this._isAutoUp=!1,this.boostBtn0.label=LangMgr.getValueByKey("wingOneKeyUpdate"),TimerMgr.ins().remove(this.autoUpStar,this)},e.prototype.autoUpStar=function(){var t=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv],e=backpackControl.getBagGoodsCountById(0,t.itemId);e>=t.itemNum?featherControl.upBoost(this.curRole,0):this.checkBoxs.selected?ActorControl.yb>=t.itemNum*t.itemPrice?featherControl.upBoost(this.curRole,1):this.stopAutoUp():(this.stopAutoUp(),tipsControl.showTips(LangMgr.getValueByKey("wingAutoUpdate")))},e.prototype.notOpenStatus=function(){this.expGroup.visible=!1,this.skillGroup.visible=!1,this.barbc.visible=!1,this.boostBtn0.visible=!1,this.boostBtn1.visible=!1,this.boostPrice1.visible=!1,this.powerPanel.visible=!1,this.openStatusBtn.visible=!0,this.rightBtn.visible=!1,this.leftBtn.visible=!1,this.jihuo.visible=!1,this.weijihuo.visible=!0,this.wing.visible=!0,this.dor1.x=2,this.dor2.x=558,this.shan.visible=!1;var t=DataCenter.ins().FeatherCommonConfig.openLevel>ActorControl.level;this.jihuolv.visible=t,this.jihuolv.text=LangMgr.getValueByKey("tipsOpenLevel",DataCenter.ins().FeatherCommonConfig.openLevel),this.bigUpLevelBtn.visible=this.redPoint.visible=!1,t||(this.reliveEff.playFile(PATH_EFF+"chargeff1",-1),this.openStatusBtn.addChild(this.reliveEff),this.reliveEff.x=this.openStatusBtn.width/2,this.reliveEff.y=this.openStatusBtn.height/2)},e.prototype.openStatusOpen=function(){this.skillGroup.visible=!0,this.openStatusBtn.visible=!1,this.barbc.visible=!0,this.boostBtn0.visible=!0,this.boostBtn1.visible=!0,this.powerPanel.visible=!0,this.rightBtn.visible=!0,this.leftBtn.visible=!0,this.jihuo.visible=!0,this.weijihuo.visible=!1,this.bigUpLevelBtn.visible=!0,this._wingsData.lv>=FeatherControl.WingMaxLv?(this.arrows.visible=!1,this.nextAttrLabel.text="",this.attrLabel.horizontalCenter=0,this.expGroup.visible=!1,this.maxInfo.visible=!0):(this.arrows.visible=!0,this.attrLabel.horizontalCenter=-100,this.expGroup.visible=!0,this.maxInfo.visible=!1),this.redPoint.visible=this.bigUpLevelBtn.visible&&this._wingsData.lv==FeatherControl.WingExpRedPoint},e.prototype.showBoost=function(t){var e=this,i=t[0],o=t[1],n=new eui.Label;n.size=20;var r="";n.textColor=ColorUtils.GREEN,r=LangMgr.getValueByKey("wingExpAdd"),n.x=225,n.y=326,n.text=r+o,this.addChild(n);var a=egret.Tween.get(n);if(a.to({y:n.y-45},500).call(function(){e.removeChild(n)},this),i&&(2==i||5==i)){var s=new eui.Image("xn_wingup"+i);s.horizontalCenter=0,s.verticalCenter=0,s.scaleX=s.scaleY=.5;var l=egret.Tween.get(s);l.to({scaleX:1.5,scaleY:1.5,alpha:0},500).call(function(){DisplayUtils.removeFromParent(s)},this),this.actEff.addChild(s)}this.expBarChange(),this.updateAtt(),this.isShowUpGradeBtn()},e.prototype.setWingView=function(t){if(this.updateDans(),!(t>FeatherControl.WingMaxLv||0>t)){var e=DataCenter.ins().FeatherLevelConfig[t];this.wingImg.source=e.appearance+"_png",this.nameTxt.text=e.name}},e.prototype.setWingData=function(){this._wingsData=heroControl.getSubRoleByIndex(this.curRole).wingsData,this.wingImg.source=this._wingsData.getImgSource(),this.currViewNum=this._wingsData.lv,this.setSeeBtnStatu();var t=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv];return this.nameTxt.text=t.name,this.updateDans(),this._wingsData.openStatus?(this.openStatusOpen(),this.expBarChange(),this.updateAtt(),this.isShowUpGradeBtn(),this.setTimeDown(),0==this._lastLv&&(this._lastLv=this._wingsData.lv),void(this._lastLv!=this._wingsData.lv&&(this._lastLv=this._wingsData.lv))):void this.notOpenStatus()},e.prototype.setSeeBtnStatu=function(){this.currViewNum>=FeatherControl.WingMaxLv||this.currViewNum>=this._wingsData.lv+1?(this.rightBtn.enabled=!1,this.leftBtn.enabled=!0):this.currViewNum<=0?(this.leftBtn.enabled=!1,this.rightBtn.enabled=!0):(this.leftBtn.enabled=!0,this.rightBtn.enabled=!0)},e.prototype.setTimeDown=function(){var t=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv];t&&(TimerMgr.ins().remove(this.refushTimeLabel,this),t.clearTime?(this.clearGroup.visible=!0,this._wingsData.clearTime>0?(this.lastTime.text=LangMgr.getValueByKey("expHaveTime",""),this.lastTimeDown=Math.floor((DateUtils.formatMiniDateTime(this._wingsData.clearTime)-GameServer.serverTime)/1e3),this.lastTimeDown=Math.max(0,this.lastTimeDown),this.timeLabel.text=DateUtils.getFormatBySecond(this.lastTimeDown,1),TimerMgr.ins().remove(this.refushTimeLabel,this),TimerMgr.ins().doTimer(1e3,this.lastTimeDown,this.refushTimeLabel,this)):(this.lastTime.text="",this.timeLabel.text="",TimerMgr.ins().remove(this.refushTimeLabel,this))):this.clearGroup.visible=!1,this.noclean.visible=!this.clearGroup.visible)},e.prototype.refushTimeLabel=function(){this.lastTimeDown>0&&(--this.lastTimeDown,this.timeLabel.text=DateUtils.getFormatBySecond(this.lastTimeDown,1))},e.prototype.updateAtt=function(){var t=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv],e=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv+1],i=0;this._totalPower=BackpackControl.getAttrPower(t.attr);var o=this.getDanAttrs(this._wingsData.lv);if(this._totalPower+=BackpackControl.getAttrPower(o),this.attrLabel.text=AttributeData.getAttStr(AttributeData.AttrAddition(o,t.attr),1),this._wingsData&&this._wingsData.exp&&e){for(var n=[],r=e.attr,a=DataCenter.ins().FeatherCommonConfig.tempattr?DataCenter.ins().FeatherCommonConfig.tempattr:1,s=0;s<r.length;s++){var l=new AttributeData;l.type=r[s].type,l.value=Math.ceil(this._wingsData.exp/t.exp*(a*r[s].value)),n.push(l)}this.attrTempLabel.text=AttributeData.getAttStr(n,1,1,LangMgr.getValueByKey("wingCur"),!1,!1,null,"）"),i=BackpackControl.getAttrPower(n),this.attrGroup.horizontalCenter=-143}else this.attrTempLabel.text="",this.attrGroup.horizontalCenter=-100;this._totalPower=this._totalPower+i,this.powerPanel.setPower(this._totalPower),this._wingsData.lv<FeatherControl.WingMaxLv&&(this.nextAttrLabel.text=AttributeData.getAttStr(AttributeData.AttrAddition(o,e.attr),1))},e.prototype.getDanAttrs=function(t){for(var e=heroControl.getSubRoleByIndex(this.curRole),i=DataCenter.ins().FeatherLevelConfig[t],o=i.attr.length,n=[],r=0;o>r;r++)n.push(new AttributeData(i.attr[r].type,Math.floor(i.attr[r].value*DataCenter.ins().FeatherCommonConfig.flyPill/1e4*e.wingsData.flyUpDan)));var a=DataCenter.ins().FeatherCommonConfig.attrPill;o=a.length;for(var r=0;o>r;r++)n.push(new AttributeData(a[r].type,a[r].value*e.wingsData.aptitudeDan));a=DataCenter.ins().FeatherCommonConfig.flyPillAttr,o=a.length;for(var r=0;o>r;r++)n.push(new AttributeData(a[r].type,a[r].value*e.wingsData.flyUpDan));return n},e.prototype.expBarChange=function(){var t=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv],e=t.exp;this.barbc.getMaxValue()!=e?this.barbc.setData(this._wingsData.exp,e):this.barbc.setValue(this._wingsData.exp)},e.prototype.isShowUpGradeBtn=function(){if(this.updateDans(),!(this._wingsData.lv>=FeatherControl.WingMaxLv)){var t=DataCenter.ins().FeatherLevelConfig[this._wingsData.lv];if(this._wingsData.lv>=FeatherControl.WingMaxLv)this.boostBtn1.visible=!1,this.boostPrice1.visible=!1,this.bigUpLevelBtn.visible=!1;else{this.boostBtn1.visible=!0,this.boostPrice1.visible=!0;var e=backpackControl.getBagGoodsCountById(0,this.danItemID);this.bigUpLevelBtn.visible=e>0;var i=backpackControl.getBagItemById(t.itemId);i?i.count<t.itemNum&&this.checkBoxs.selected?(this.boostPrice1.setType(2),this.boostPrice1.setPrice(t.itemPrice*t.itemNum,ActorControl.yb)):(this.boostPrice1.setType(5),this.boostPrice1.setPrice(t.itemNum,i.count)):this.checkBoxs.selected?(this.boostPrice1.setType(2),this.boostPrice1.setPrice(t.itemPrice*t.itemNum,ActorControl.yb)):(this.boostPrice1.setType(5),this.boostPrice1.setPrice(t.itemNum,0))}this.redPoint.visible=this.bigUpLevelBtn.visible&&this._wingsData.lv==FeatherControl.WingExpRedPoint}},e.prototype.showOpenMovie=function(){var t=this;StageUtils.ins().setTouchChildren(!1),DisplayUtils.removeFromParent(this.reliveEff),this.openStatusBtn.visible=!1,this.flyUpEffect||(this.flyUpEffect=new GameMovieClip,this.flyUpEffect.x=this.wingeff.width/2,this.flyUpEffect.y=this.wingeff.height/2),this.wingeff.addChild(this.flyUpEffect),this.flyUpEffect.playFile(PATH_EFF+"functionopeneff",-1);var e=new egret.Sprite,i=new egret.Shape;i.graphics.beginFill(LangMgr.getColor("color39")),i.graphics.drawRect(0,0,300,300),i.graphics.endFill(),e.anchorOffsetX=0,e.anchorOffsetY=0,e.addChild(i),this.wingeff.addChild(e),e.y=300,this.flyUpEffect.mask=e;var o=egret.Tween.get(e);o.to({y:0},1500).call(function(){egret.Tween.removeTweens(t.flyUpEffect),t.flyUpEffect.visible=!1,t.wingeff.removeChild(e),t.wingeff.removeChild(t.flyUpEffect),t.flowReckEffect()})},e.prototype.flowReckEffect=function(){var t=this;this.openEffect||(this.openEffect=new GameMovieClip,this.wingeff.addChild(this.openEffect),this.openEffect.x=this.wingeff.width/2,this.openEffect.y=this.wingeff.height/2),this.openEffect.playFile(PATH_EFF+"chibangstart",1),TimerMgr.ins().doTimer(500,1,function(){t.shan.visible=!0,t.openEffect.scaleX+=1,t.openEffect.scaleY+=1,egret.Tween.get(t.openEffect,{loop:!1,onChange:function(){var e=egret.Tween.get(t.dor1),i=egret.Tween.get(t.dor2),o=egret.Tween.get(t.shan);e.to({x:-280},500),i.to({x:838},500).call(function(){featherControl.upActivate(t.curRole),StageUtils.ins().setTouchChildren(!0)},t),t.wing.visible=!1,o.to({alpha:0},500),DisplayUtils.removeFromParent(t.openEffect)}})},this)},e.prototype.updateRedPoint=function(){this._wingsData.openStatus?this.redPoint0.visible=FeatherDeityRedPoint.ins().getGodWingRedPoint():this.redPoint0.visible=!1},e}(BasePanel);__reflect(FeatherPanel.prototype,"FeatherPanel");var FeatherSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="FeatherSkillTipsViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0],o=t[1],n=t[2];this.addEventTouchEnd(this,this.otherClose),this.setData(i,o,n)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e.prototype.setData=function(t,e,i){var o=new SkillVo(t);o.name&&(this.nameLabel.text=o.name),o.desc&&(this.description.textFlow=TextUtils.generateTextFlow(o.desc));var n=heroControl.getSubRoleByIndex(i).wingSkillData;if(n[e]&&n[e]>0)this.grpNoActiveTip.visible=!1,this.lblAcitveTip.visible=!0;else{this.grpNoActiveTip.visible=!0,this.lblAcitveTip.visible=!1;var r=featherControl.getLevelBySkill(e);this.lblNoAcitveTip.text=LangMgr.getValueByKey("wingNeedLevel1",r+1)}this.imgSkill.source=t+"_png",this.BG.height=170+this.description.height},e}(BaseEuiView);__reflect(FeatherSkillTipsView.prototype,"FeatherSkillTipsView");var FeatherSoaringTipsView=function(t){function e(){var e=t.call(this)||this;return e._curRole=0,e.skinName="FeatherSoaringTipsViewSkin",e.isTopLevel=!0,e.itemImg.source="200239_png",e.itemIcon.source="200239_png",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._curRole=t[0],this.addCustomEvent(266,this.itemChange),this.addCustomEvent(267,this.itemChange),this.addCustomEvent(268,this.itemChange),this.addCustomEvent(210,this.update),this.addCustomEvent(206,this.update),this.addEventTouchTap(this,this.onTouch),this.update()},e.prototype.close=function(){this.removeCustomEvents(),this.removeEventTouchTap(this,this.onTouch)},e.prototype.update=function(){var t=heroControl.getSubRoleByIndex(this._curRole),e=DataCenter.ins().FeatherLevelConfig[t.wingsData.lv];this.wingName.text=e.name,this.feishengLv.text=t.wingsData.flyUpDan+LangMgr.getValueByKey("numberLevel",""),this.career.text=RoleModel.getJobNameByJob(t.job);var i=e.flyPill;if(t.wingsData.flyUpDan>=i)this.currentState="maxLv";else{var o=backpackControl.getBagItemById(DataCenter.ins().FeatherCommonConfig.flyPillId),n=o?o.count:0;this.currentState=n?"normal":"noitem"}this.updateAttrs()},e.prototype.updateAttrs=function(){for(var t,e=heroControl.getSubRoleByIndex(this._curRole),i=DataCenter.ins().FeatherLevelConfig[e.wingsData.lv],o=i.attr.length,n=DataCenter.ins().FeatherCommonConfig.flyPillAttr,r=n.length,a=[],s=1;4>=s;s++)this["attr"+s].text="",this["attr"+s+"NextLv"].text="",o>=s&&(t=i.attr[s-1],this["attr"+s].text=AttributeData.getAttrStrByType(t.type)+": +"+Math.floor(DataCenter.ins().FeatherCommonConfig.flyPill/100)*e.wingsData.flyUpDan+"%","normal"==this.currentState&&(this["attr"+s+"NextLv"].text="+"+Math.floor(DataCenter.ins().FeatherCommonConfig.flyPill/100)*(e.wingsData.flyUpDan+1)+"%"),a.push(new AttributeData(t.type,Math.floor(t.value*DataCenter.ins().FeatherCommonConfig.flyPill/1e4*e.wingsData.flyUpDan)))),this["attr"+(s+4)].text="",this["attr"+(s+4)+"NextLv"].text="",r>=s&&(t=n[s-1],this["attr"+(s+4)].text=AttributeData.getAttrStrByType(t.type)+": +"+t.value*e.wingsData.flyUpDan,"normal"==this.currentState&&(this["attr"+(s+4)+"NextLv"].text="+"+t.value*(e.wingsData.flyUpDan+1)),a.push(new AttributeData(t.type,t.value*e.wingsData.flyUpDan)));this.powerPanel.setPower(BackpackControl.getAttrPower(a))},e.prototype.itemChange=function(){if("maxLv"!=this.currentState){var t,e=backpackControl.getBagItemById(DataCenter.ins().FeatherCommonConfig.flyPillId),i=e?e.count:0;i?(t="normal"!=this.currentState,this.currentState="normal"):(t="noitem"!=this.currentState,this.currentState="noitem"),t&&this.updateAttrs()}},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:UIMgr.ins().close(this);break;case this.updateBtn:featherControl.upUseDan(this._curRole,1)}},e}(BaseEuiView);__reflect(FeatherSoaringTipsView.prototype,"FeatherSoaringTipsView");var FeatherSkillItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.skinName="FeatherSkillItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.data&&(this.skillIcon.visible=!0,this.skillIcon.source=this.data+"_png",this.blackImg.visible=!1)},e}(BaseItemRender);__reflect(FeatherSkillItemRenderer.prototype,"FeatherSkillItemRenderer");var FeatherDeityRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.roleTabs={},e.tabs={},e.addCustomEventMany(e.dispatchGodWingRedPoint,583,721),e.addCustomEventMany(e.dispatchGodWingItem,207,209,206,208,267,266),e.addCustomEventMany(e.dispatchGodWingCompose,267,266),e.addCustomEventMany(e.postGodWingForge,719,720,209,206,208,267,266),e}return __extends(e,t),e.prototype.dispatchGodWingRedPoint=function(){var t=this.redPoint;this.redPoint=this.tabs[0]||this.tabs[1],EventMgr.ins().dispatch(582,t!=this.redPoint)},e.prototype.dispatchGodWingItem=function(){var t=0;this.roleTabs[t]||(this.roleTabs[t]={});for(var e=3,i=0;e>i;i++)this.roleTabs[t]||(this.roleTabs[t]={}),this.roleTabs[t][i]=featherControl.isWearGodWing(i);this.tabs[t]=!1;for(var o in this.roleTabs[t])this.roleTabs[t][o]&&(this.tabs[t]=!0);EventMgr.ins().dispatch(583,!0)},e.prototype.dispatchGodWingCompose=function(){var t=1;this.tabs[t]=featherControl.isComposeGodWingAll(),this.roleTabs[t]||(this.roleTabs[t]={}),EventMgr.ins().dispatch(584,!0)},e.prototype.dispatchGodWingTransfer=function(){var t=2;this.roleTabs[t]||(this.roleTabs[t]={}),this.tabs[t]=Boolean(backpackControl.getBagGoodsByType(16))},e.prototype.postGodWingForge=function(){var t=3;if(this.roleTabs[t]||(this.roleTabs[t]={}),this.tabs[t]=!1,!featherControl.checkIsOpen())return!1;for(var e=!1,i=3,o=0;i>o;o++){this.roleTabs[t]||(this.roleTabs[t]={});var n=this.roleTabs[t][o];this.roleTabs[t][o]=featherControl.checkRoleRed(o),!!n!=this.roleTabs[t][o]&&(e=!0)}for(var r in this.roleTabs[t])this.roleTabs[t][r]&&(this.tabs[t]=!0);return EventMgr.ins().dispatch(721),e},e.prototype.getGodWingRedPoint=function(){if(GameServer.serverOpenDay+1<DataCenter.ins().FeatherCommonConfig.openDay)return!1;for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t).wingsData;if(e.openStatus)return this.redPoint}return!1},e}(BaseSystem);__reflect(FeatherDeityRedPoint.prototype,"FeatherDeityRedPoint");var FeatherDeityForgeItemVo=function(){function t(){}return t}();__reflect(FeatherDeityForgeItemVo.prototype,"FeatherDeityForgeItemVo");var FeatherDeityForgeVo=function(){function t(){this.data={}}return t.prototype.parse=function(t){this.roleId=t[0];for(var e=0;t[1].length>e;e++){var i=new FeatherDeityForgeItemVo;i.roleId=this.roleId,i.slot=e+1,i.lv=t[1][e][0],i.isTupo=t[1][e][1],this.data[i.slot]=i}},t.prototype.getSlotData=function(t){var e=this.data[t];return e||(e=new FeatherDeityForgeItemVo,e.roleId=this.roleId,e.slot=t,e.lv=0,e.isTupo=0,this.data[t]=e),e},t}();__reflect(FeatherDeityForgeVo.prototype,"FeatherDeityForgeVo");var FeatherDeityVo=function(){function t(){this.data={}}return t.prototype.parser=function(t){for(var e=0;e<t.length;e++){var i=t[e][0],o=t[e][1];this.data[i]={slot:i,level:o}}},t.prototype.getLevel=function(t){return this.data[t]?this.data[t].level:0},t.prototype.getData=function(){return this.data},t.prototype.getSuitLevel=function(){var t=Number.MAX_VALUE,e=0;for(var i in this.data)this.data[i].level<t&&(e=this.data[i].slot,t=this.data[i].level);if(!e)return 0;var o=DataCenter.ins().FeatherDeityLevelConfig[t][e];if(!o)return 0;var n=[];for(var r in DataCenter.ins().FeatherItemConfig){var a=DataCenter.ins().FeatherItemConfig[r];if(n.length>=FeatherControl.GodWingMaxSlot)break;a.level>=o.level&&o.slot!=a.slot&&this.data[a.slot]&&this.data[a.slot].level>=a.level&&n.push(a.itemId)}return n.length>=FeatherControl.GodWingMaxSlot-1?t:0},t.prototype.getSuitSum=function(){var t=this.getSuitLevel(),e=0;for(var i in this.data)this.data[i].level>=t&&e++;return e},t}();__reflect(FeatherDeityVo.prototype,"FeatherDeityVo");var FeatherDeityComposePanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.compose,this.onClick),this.removeCustomEvents();for(var i=0;i<FeatherControl.GodWingMaxSlot;i++)this.removeEventTouchTap(this["item"+i],this.onSlot)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.compose,this.onClick),this.addEventTouchTap(this.now,this.onClick),this.addEventTouchEnd(this.next,this.onClick),this.addEventItemTap(this.list,this.onListTap),this.addCustomEvent(584,this.updateItem),this.slot=1;for(var i in DataCenter.ins().FeatherDeitySuitConfig){this.curIndex=DataCenter.ins().FeatherDeitySuitConfig[i].lv;break}for(var i=0;i<FeatherControl.GodWingMaxSlot;i++)this.addEventTouchTap(this["item"+i],this.onSlot),this["item"+i].setSelect(!1);this.item0.setSelect(!0),this.list.itemRenderer=FeatherDeityComposeItemRenderer,this.itemList=new eui.ArrayCollection([]),this.updateGodWing()},e.prototype.onListTap=function(t){if(t&&t.itemRenderer&&t.item){var e=t.item;this.curIndex=e.suitConfig.lv,this.updateItem()}},e.prototype.onSlot=function(t){for(var e=0;e<FeatherControl.GodWingMaxSlot;e++)t.currentTarget==this["item"+e]?(this["item"+e].setSelect(!0),this.slot=e+1,this.updateItem()):this["item"+e].setSelect(!1)},e.prototype.onClick=function(t){switch(t.currentTarget){case this.compose:var e=DataCenter.ins().FeatherDeityLevelConfig[this.curIndex][this.slot];if(featherControl.isComposeGodWingOnly(e.itemId)){var i=DataCenter.ins().FeatherDeityLevelConfig[this.curIndex][this.slot];featherControl.upWingCompose(2,i.itemId)}else tipsControl.showTips(LangMgr.getValueByKey("materialEnought1"));break;case this.now:var o=t.currentTarget.data,n=void 0;if(o.itemId&&(n=DataCenter.ins().FeatherItemConfig[o.itemId]),n)UIMgr.ins().open(FeatherDeityTipsView,n);else{var r=backpackControl.getBagItemById(o.id),a=r?r.count:0;UIMgr.ins().open("ItemTipsView",0,o.id,a)}break;case this.next:o=t.currentTarget.data,n=DataCenter.ins().FeatherItemConfig[o.itemId],UIMgr.ins().open(FeatherDeityTipsView,n)}},e.prototype.updateGodWing=function(){this.dataList=[];var t=1;for(var e in DataCenter.ins().FeatherDeitySuitConfig){var i=DataCenter.ins().FeatherDeitySuitConfig[e];this.dataList.push({slot:t,suitConfig:i})}this.itemList.replaceAll(this.dataList),this.list.dataProvider=this.itemList,this.list.validateNow(),this.list.selectedIndex=0,this.updateItem()},e.prototype.updateItem=function(){var t=DataCenter.ins().FeatherDeityLevelConfig[this.curIndex][this.slot],e=0,i=0;if(this.power0.visible=this.attr0.visible=!1,t){this.next.data=t,this.next.setCountVisible(!1);var o=DataCenter.ins().FeatherItemConfig[t.itemId];if(o=DataCenter.ins().FeatherItemConfig[o.composeItem.id]){var n=featherControl.getPreLevel(this.curIndex),r=DataCenter.ins().FeatherDeityLevelConfig[n][this.slot];this.now.data=r,this.now.setCountVisible(!1);var a=DataCenter.ins().FeatherItemConfig[r.itemId],s=AttributeData.getAttStr(a.attr,0,1,"：")+"\n";s+=AttributeData.getExAttrNameByAttrbute(a.exattr[0],!0),this.attr1.text=s;var l=Math.floor(BackpackControl.getAttrPower(a.attr));this.power1.text=LangMgr.getValueByKey("godFightValue",l+a.exPower),o=DataCenter.ins().FeatherItemConfig[t.itemId];var h=AttributeData.getAttStr(o.attr,0,1,"：")+"\n";h+=AttributeData.getExAttrNameByAttrbute(o.exattr[0],!0),this.attr2.text=h;var u=Math.floor(BackpackControl.getAttrPower(o.attr));this.power2.text=LangMgr.getValueByKey("godFightValue",u+o.exPower);var c=backpackControl.getBagItemById(o.composeItem.id);e=c?c.count:0,i=o.composeItem.count}else{o=DataCenter.ins().FeatherItemConfig[t.itemId];var p=DataCenter.ins().ItemConfig[o.composeItem.id];this.now.data=p,this.now.setCountVisible(!1);var h=AttributeData.getAttStr(o.attr,0,1,"：")+"\n";h+=AttributeData.getExAttrNameByAttrbute(o.exattr[0],!0),this.attr0.text=h;var d=Math.floor(BackpackControl.getAttrPower(o.attr));this.power0.text=LangMgr.getValueByKey("godFightValue",d+o.exPower);var c=backpackControl.getBagItemById(p.id);e=c?c.count:0,i=o.composeItem.count,this.power0.visible=this.attr0.visible=!0}}this.attr1.visible=this.attr2.visible=!this.attr0.visible,this.power1.visible=this.power2.visible=!this.power0.visible;var g;g=e>=i?ColorUtils.GREEN:ColorUtils.RED,this.number.textFlow=TextUtils.generateTextFlow1("|C:"+g+"&T:"+e+"|/|C:"+ColorUtils.NORMAL_COLOR+"&T:"+i);for(var f=0;f<this.dataList.length;f++)this.dataList[f].slot=this.slot;this.itemList.replaceAll(this.dataList),this.list.dataProvider=this.itemList,this.updateRedPoint(),this.updateGodWingItem()},e.prototype.updateGodWingItem=function(){for(var t=0;t<FeatherControl.GodWingMaxSlot;t++){var e=DataCenter.ins().FeatherDeityLevelConfig[this.curIndex][t+1],i=DataCenter.ins().FeatherItemConfig[e.itemId];this["item"+t].data=i,this["item"+t].setImgIcon("sybg"+(t+1)),this["item"+t].setCountVisible(!1),this["item"+t].setNameVisible(!1)}},e.prototype.updateRedPoint=function(){var t=DataCenter.ins().FeatherDeityLevelConfig[this.curIndex][this.slot];this.redPoint.visible=featherControl.isComposeGodWingOnly(t.itemId);for(var e=0;e<this.list.numElements;e++){var i=this.list.getVirtualElementAt(e),o=this.list.dataProvider.getItemAt(e),n=featherControl.isComposeGodWingLevel(o.suitConfig.lv,this.slot);i.setRedPoint(n)}for(var e=1;e<=FeatherControl.GodWingMaxSlot;e++)for(var r=0;r<this.list.numElements;r++){var o=this.list.dataProvider.getItemAt(r),n=featherControl.isComposeGodWingSlot(o.suitConfig.lv,e);if(this["item"+(e-1)].updateRedPoint(n),n)break}},e}(BasePanel);__reflect(FeatherDeityComposePanel.prototype,"FeatherDeityComposePanel");var FeatherDeityForgePanel=function(t){function e(){var e=t.call(this)||this;return e.roleId=0,e.slot=1,e.nextLv=1,e.nextTupo=0,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.starList=new StarList(10,0,60),this.starList.scaleX=.7,this.starList.scaleY=.7,this.schedule0.addChild(this.starList),this.getItemTxt.textFlow=(new egret.HtmlTextParser).parser("<u>"+this.getItemTxt.text+"</u>")},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.roleId=t[0]||0,this.addEventTouchTap(this.upGradeBtn,this.onTap),this.addEventTouchTap(this.icon,this.onTap),this.addEventTouchTap(this.getItemTxt,this.onTap);for(var i=0;4>i;i++)this.addEventTouchTap(this.getItem(i+1),this.onTap),this.addEventTouchTap(this.getLabel(i+1),this.onTap);this.addCustomEvent(720,this.update),this.addCustomEvent(719,this.update),this.addCustomEvent(267,this.updateItem),this.addCustomEvent(266,this.updateItem);for(var o=Number.MAX_VALUE,n=1,r=FeatherControl.ins().getGodWingForgeData(this.roleId),i=1;i<=FeatherControl.GodWingMaxSlot;i++){var a=r.getSlotData(i);this.getItem(i).data=a,a.lv<o&&(o=a.lv,n=i)}this.setSelectSlot(n),this.updateSkillName(),this.updatePower(),this.updateRedPoint()},e.prototype.update=function(t){this.updateSlot();var e=-1;t instanceof FeatherDeityForgeItemVo&&(e=10==this.starList.starNum?1:0),1==e&&this.playUpMc(),this.setSelectSlot(this.slot,!0,0==e?1:0),this.updateSkillName(),this.updatePower()},e.prototype.updateItem=function(){this.updateSlot(),this.setSelectSlot(this.slot,!1)},e.prototype.updateSlot=function(){for(var t=FeatherControl.ins().getGodWingForgeData(this.roleId),e=1;e<=FeatherControl.GodWingMaxSlot;e++){var i=t.getSlotData(e);this.getItem(e).data=i}this.updateRedPoint()},e.prototype.updateSkillName=function(){var t=FeatherControl.ins().getSkillLv(this.roleId);this.nameLbl.text=DataCenter.ins().FeatherCommonConfig.forgeSkillName+" Lv."+t},e.prototype.setSelectSlot=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=0),this.setSelectSkillEff(!1),this.getItem(this.slot).setSelect(!1),this.slot=t,this.getItem(this.slot).setSelect(!0);var o=FeatherControl.ins().getGodWingForgeData(this.roleId).getSlotData(this.slot),n=FeatherControl.ins().getStarData(o.lv,o.isTupo),r=FeatherControl.ins().getNameFromSlot(this.slot);this.curState.text=r+" "+LangMgr.getValueByKey("forgeTips2",StringUtils.NumberToChinese(n.level),n.star);var a=DataCenter.ins().FeatherDeityForgeLvConfig[o.lv],s=DataCenter.ins().FeatherDeityForgeExtraLvConfig[n.level],l=AttributeData.AttrAddition(a?a.attr:null,s?s.attr:null);this.sortAttr(l,a?a.attr:null);var h=LangMgr.getValueByKey("forgeTips1");l&&(h=AttributeData.getAttStr(l,0,1,":")),this.curAttr.text=h,e&&this.starList.setStarNum(n.star,i);var u=o.lv+1,c=o.isTupo?1:0;if(this.nextLv=u,this.nextTupo=c,a=DataCenter.ins().FeatherDeityForgeLvConfig[u]){var p=FeatherControl.ins().getStarData(u,c);this.nextState.text=r+" "+LangMgr.getValueByKey("forgeTips2",StringUtils.NumberToChinese(p.level),p.star),s=DataCenter.ins().FeatherDeityForgeExtraLvConfig[p.level];var d=AttributeData.AttrAddition(a?a.attr:null,s?s.attr:null);this.sortAttr(d,a?a.attr:null);var g="";d&&(g=AttributeData.getAttStr(d,0,1,":")),this.nextAttr.text=g,this.curState.horizontalCenter=-110,this.curAttr.horizontalCenter=-110,this.costGroup.visible=this.getItemTxt.visible=this.upGradeBtn.visible=!0,this.maxDesc.visible=!1,this.arrow.visible=!0}else this.nextState.text="",this.nextAttr.text="",this.curState.horizontalCenter=0,this.curAttr.horizontalCenter=0,this.costGroup.visible=this.getItemTxt.visible=this.upGradeBtn.visible=!1,this.maxDesc.visible=!0,this.arrow.visible=!1;var f=c?DataCenter.ins().FeatherCommonConfig.forgeExtraItemId:DataCenter.ins().FeatherCommonConfig.forgeItemId;this.icon0.source=DataCenter.ins().ItemConfig[f].icon+"_png";var m=backpackControl.getBagGoodsCountById(0,f),v=a&&!c?a.cost:s&&c?s.cost:0,y="|C:"+(m>=v?65280:16711680)+"&T:"+m+"|/"+v;this.countLabel0.textFlow=TextUtils.generateTextFlow1(y),this.upGradeBtn.label=LangMgr.getValueByKey("forgeTips"+(c?3:4)),this.needGet=v>m,this.forgeinfo.visible=this.forgeoprate.visible=!0,this.skillinfo.visible=this.skillrequire.visible=!1},e.prototype.sortAttr=function(t,e){return t&&e?t.sort(function(t,i){var o=0,n=0;return e.forEach(function(e,r){e.type==t.type&&(o=r),e.type==i.type&&(n=r)}),n>o?0:1}):t},e.prototype.setSelectSkill=function(){this.getItem(this.slot).setSelect(!1),this.setSelectSkillEff(!0);var t=DataCenter.ins().FeatherCommonConfig.forgeSkillName,e=FeatherControl.ins().getSkillLv(this.roleId);if(this.curSkillState.text=t+" Lv."+e,0==e)this.curSkillAttr.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().FeatherCommonConfig.forgeSkillInitial);else{var i=LangMgr.getValueByKey("forgeTips5",DataCenter.ins().FeatherDeityForgeSkillConfig[e].attr[0].value/100);this.curSkillAttr.textFlow=TextUtils.generateTextFlow1(i)}var o=e+1,n=DataCenter.ins().FeatherDeityForgeSkillConfig[o];if(n){this.arrow1.visible=!0,this.nextSkillState.text=t+" Lv."+o;var i=LangMgr.getValueByKey("forgeTips5",n.attr[0].value/100);this.nextSkillAttr.textFlow=TextUtils.generateTextFlow1(i)}else this.arrow1.visible=!1,this.nextSkillState.text="",this.nextSkillAttr.text="",o=e;for(var r=FeatherControl.ins().getGodWingForgeData(this.roleId),a=1;a<=FeatherControl.GodWingMaxSlot;a++){var s=r.getSlotData(a),l=FeatherControl.ins().getStarData(s.lv,s.isTupo).level,h=l>=o?65280:16711680,u=FeatherControl.ins().getNameFromSlot(a);this.getLabel(a).textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("forgeTips6",h,u+StringUtils.NumberToChinese(o)))}this.forgeinfo.visible=this.forgeoprate.visible=!1,this.skillinfo.visible=this.skillrequire.visible=!0},e.prototype.setSelectSkillEff=function(t){t?(this.skillSelMc=this.skillSelMc||new GameMovieClip,this.skillSelectEff.addChild(this.skillSelMc),this.skillSelMc.playFile(PATH_EFF+"quaeff5",-1)):this.skillSelMc&&this.skillSelMc.parent&&this.skillSelMc.parent.removeChild(this.skillSelMc)},e.prototype.onTap=function(t){var e=t.currentTarget;if(e==this.icon)this.setSelectSkill();else if(e==this.upGradeBtn)this.needGet?this.buyItem():this.sendUp();else if(e==this.getItemTxt)this.buyItem();else for(var i=0;4>i;i++)if(e==this.getItem(i+1)||e==this.getLabel(i+1)){this.setSelectSlot(i+1);
break}},e.prototype.buyItem=function(){var t=this.nextTupo?DataCenter.ins().FeatherCommonConfig.forgeExtraItemId:DataCenter.ins().FeatherCommonConfig.forgeItemId;warnControl.setBuyGoodsWarn(t)},e.prototype.getItem=function(t){return this["item"+(t-1)]},e.prototype.getLabel=function(t){return this["require"+(t-1)]},e.prototype.sendUp=function(){FeatherControl.ins().upForge(this.roleId,this.slot)},e.prototype.updatePower=function(){for(var t=0,e=1;e<=FeatherControl.GodWingMaxSlot;e++){var i=FeatherControl.ins().getGodWingForgeData(this.roleId).getSlotData(e),o=FeatherControl.ins().getStarData(i.lv,i.isTupo).level,n=DataCenter.ins().FeatherDeityForgeLvConfig[i.lv],r=DataCenter.ins().FeatherDeityForgeExtraLvConfig[o];n&&(t+=BackpackControl.getAttrPower(n.attr)),r&&(t+=BackpackControl.getAttrPower(r.attr))}var a=FeatherControl.ins().getSkillLv(this.roleId);DataCenter.ins().FeatherDeityForgeSkillConfig[a]&&(t+=ItemUtils.relatePower(DataCenter.ins().FeatherDeityForgeSkillConfig[a].attr[0],heroControl.getSubRoleByIndex(this.roleId))),this.powerPanel.setPower(t)},e.prototype.updateRedPoint=function(){for(var t=1;t<=featherControl.GodWingMaxSlot;t++)this.getItem(t).updateRedPoint(FeatherControl.ins().checkSlotRed(this.roleId,t))},e.prototype.playUpMc=function(){var t=this;this.mc||(this.mc=new GameMovieClip),this.mc.playFile(PATH_EFF+"forgeSuccess",1,function(){t.mc.parent&&t.mc.parent.removeChild(t.mc)}),this.mc.x=this.getItem(this.slot).x+45,this.mc.y=this.getItem(this.slot).y+35,this.addChild(this.mc)},e.prototype.close=function(){},e}(BasePanel);__reflect(FeatherDeityForgePanel.prototype,"FeatherDeityForgePanel");var FeatherDeityPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.attr,this.onClick),this.addEventTouchEnd(this.skill,this.onTouch),this.addEventTouchEnd(this.replace,this.onClick),this.addEventTouchEnd(this.replace0,this.onClick),this.addEventTouchEnd(this.getItemTxt,this.onClick),this.addCustomEvent(583,this.updateItem);for(var i=0;i<FeatherControl.GodWingMaxSlot;i++)this.addEventTouchTap(this["item"+i],this.onTab);this.slot=1,this.updateGodWing()},e.prototype.onTab=function(t){for(var e=0;e<FeatherControl.GodWingMaxSlot;e++)t.currentTarget==this["item"+e]?(this.slot=e+1,this["item"+e].setSelect(!0),this.updateGodWing()):this["item"+e].setSelect(!1)},e.prototype.onClick=function(t){switch(t.target){case this.attr:UIMgr.ins().open(FeatherDeitySuitTipsView,this.curRole);break;case this.replace:var e=this["item"+(this.slot-1)].data;if(e){if(e=DataCenter.ins().FeatherDeityLevelConfig[e.level][e.slot],!featherControl.wearItemRedPoint(this.curRole,this.slot))return void tipsControl.showTips(LangMgr.getValueByKey("godTips8"));var i=featherControl.getWearItem(this.curRole,this.slot);i||(i=e.itemId),featherControl.upWingWear(this.curRole,i)}break;case this.replace0:if(featherControl.isQuicComposeGodWing(this.curRole,this.slot)){var o=featherControl.getCurLevelItemId(this.curRole,this.slot);if(o){var n=featherControl.getNextLevel(o.level);o=DataCenter.ins().FeatherDeityLevelConfig[n][this.slot]}else{var n=featherControl.getStartLevel(this.slot);o=DataCenter.ins().FeatherDeityLevelConfig[n][this.slot]}if(!featherControl.checkGodWingLevel(this.curRole,o.itemId))return void tipsControl.showTips(LangMgr.getValueByKey("godTips9"));if(!featherControl.checkGodWingItem(this.curRole,o.itemId,this.slot))return void tipsControl.showTips(LangMgr.getValueByKey("godTips10"));featherControl.upWingCompose(1,o.itemId,this.curRole)}else tipsControl.showTips(LangMgr.getValueByKey("godTips11"));break;case this.getItemTxt:var r=this["item"+(this.slot-1)].data;if(r){r=DataCenter.ins().FeatherItemConfig[r.itemId];var a=r.itemId;featherControl.getGodWing(this.curRole).getLevel(this.slot)||r&&(a=r.composeItem.id),warnControl.setBuyGoodsWarn(a)}}},e.prototype.onTouch=function(t){switch(t.currentTarget){case this.skill:UIMgr.ins().open(FeatherDeitySkillTipsView,this.skill.data,this.isActive)}},e.prototype.updateGodWing=function(){this.updateItem()},e.prototype.updateItem=function(){var t=featherControl.getGodWing(this.curRole),e=t.getData(),i=t.getLevel(this.slot);if(this.attr0.visible=i?!1:!0,this.attr1.visible=this.attr2.visible=!this.attr0.visible,this.state0.visible=this.power0.visible=this.attr0.visible,this.power1.visible=this.power2.visible=!this.power0.visible,this.state1.visible=this.state2.visible=!this.state0.visible,this.attr3.visible=this.power3.visible=this.state3.visible=!1,this.replace.visible=this.replace0.visible=this.redPointReplace.visible=this.redPointReplace0.visible=!0,i&&!featherControl.getNextLevel(i)){this.replace.visible=this.replace0.visible=this.redPointReplace.visible=this.redPointReplace0.visible=!1,this.attr3.visible=this.power3.visible=this.state3.visible=!0;for(var o=0;3>o;o++)this["attr"+o].visible=this["power"+o].visible=this["state"+o].visible=!this.attr3.visible}var n,r,a=0,s=t.getSuitSum();if(s>=FeatherControl.GodWingMaxSlot){var l=t.getSuitLevel(),h=DataCenter.ins().FeatherDeitySuitConfig[l];h&&(a=h.precent/1e4)}if(this.attr0.visible){var u=featherControl.getStartLevel(this.slot),c=DataCenter.ins().FeatherDeityLevelConfig[u][this.slot];n=DataCenter.ins().FeatherItemConfig[c.itemId];var p=Math.floor(BackpackControl.getAttrPower(n.attr));this.power0.text=LangMgr.getValueByKey("godFightValue",p+n.exPower),this.power0.visible=!0,this.attr0.text=AttributeData.getAttStr(n.attr,0,1,"：");var d=AttributeData.getAttStr(n.attr,0,1,"：")+"\n";d+=AttributeData.getExAttrNameByAttrbute(n.exattr[0],!0),this.attr0.text=d}if(this.attr1.visible){var g=featherControl.getCurLevelItemId(this.curRole,this.slot);if(g){n=DataCenter.ins().FeatherItemConfig[g.itemId];var f=AttributeData.getPercentAttr(n.attr,a),m=Math.floor(BackpackControl.getAttrPower(f));this.power1.text=LangMgr.getValueByKey("godFightValue",m+n.exPower);var d=AttributeData.getAttStr(n.attr,0,1,"：")+"\n";d+=AttributeData.getExAttrNameByAttrbute(n.exattr[0],!0),this.attr1.text=d}if(g=featherControl.getNextLevelItemId(this.curRole,this.slot)){r=DataCenter.ins().FeatherItemConfig[g.itemId];var f=AttributeData.getPercentAttr(r.attr,a),v=Math.floor(BackpackControl.getAttrPower(f));this.power2.text=LangMgr.getValueByKey("godFightValue",v+r.exPower);var d=AttributeData.getAttStr(r.attr,0,1,"：")+"\n";d+=AttributeData.getExAttrNameByAttrbute(r.exattr[0],!0),this.attr2.text=d}}if(this.attr3.visible){var g=featherControl.getCurLevelItemId(this.curRole,this.slot);n=DataCenter.ins().FeatherItemConfig[g.itemId];var f=AttributeData.getPercentAttr(n.attr,a),p=Math.floor(BackpackControl.getAttrPower(f));this.power3.text=LangMgr.getValueByKey("godFightValue",p+n.exPower),this.power3.visible=!0,this.attr3.text=AttributeData.getAttStr(n.attr,0,1,"：");var d=AttributeData.getAttStr(n.attr,0,1,"：")+"\n";d+=AttributeData.getExAttrNameByAttrbute(n.exattr[0],!0),this.attr3.text=d}var y=n;if(this.costImg0.visible=this.cost0.visible=this.costName.visible=!0,!this.attr0.visible){var C=featherControl.getNextLevel(n.level);if(C){var b=DataCenter.ins().FeatherDeityLevelConfig[C][this.slot];y=DataCenter.ins().FeatherItemConfig[b.itemId]}else this.costImg0.visible=this.cost0.visible=this.costName.visible=!1}this.updateCost(y);for(var o=0;4>o;o++){this["item"+o].data=null,this["item"+o].setSelect(!1),this["item"+o].setCountVisible(!1);var T=featherControl.getGodWing(this.curRole).getLevel(o+1);this["item"+o].setNameVisible(T)}this["item"+(this.slot-1)].data=n,featherControl.getCurLevelItemId(this.curRole,this.slot)||this["item"+(this.slot-1)].setImgIcon("sybg"+this.slot),this["item"+(this.slot-1)].setSelect(!0),this["item"+(this.slot-1)].setCountVisible(!1);var w=featherControl.getGodWing(this.curRole).getLevel(this.slot);this["item"+(this.slot-1)].setNameVisible(w);for(var o=1;4>=o;o++)if(o!=this.slot){var S=void 0,_=!1;e[o]?(S=e[o].level,_=!0):S=featherControl.getStartLevel(o);var M=DataCenter.ins().FeatherDeityLevelConfig[S][o],I=DataCenter.ins().FeatherItemConfig[M.itemId];I&&(this["item"+(o-1)].data=I,_||(this["item"+(o-1)].setImgIcon("sybg"+o),this["item"+(o-1)].setQuality("quality0")))}this.updatePower(),this.updateRedPoint(),this.updateSkill()},e.prototype.setNnactive=function(){for(var t in DataCenter.ins().FeatherDeitySuitConfig){var e=DataCenter.ins().FeatherDeitySuitConfig[t];this.skill.data=e,this.skill.setCountVisible(!1),this.skill.setImgIcon("sy100000");break}},e.prototype.updateSkill=function(){var t,e=featherControl.getGodWing(this.curRole),i=e.getSuitLevel();if(this.isActive=!1,!i)return this.setNnactive(),0;var o=DataCenter.ins().FeatherDeitySuitConfig[i];if(o.skillname&&(this.isActive=!0),t=o,this.skill.data=t,this.skill.setCountVisible(!1),!this.isActive){this.skill.setImgIcon("sy100000");for(var n in DataCenter.ins().FeatherDeitySuitConfig){var r=DataCenter.ins().FeatherDeitySuitConfig[n];r.skillname&&this.skill.setNameText(r.skillname)}}},e.prototype.updateCost=function(t){if(t){var e=backpackControl.getBagItemById(t.composeItem.id),i=e?e.count:0,o=featherControl.getGodWing(this.curRole).getLevel(this.slot);if(o){var n=DataCenter.ins().FeatherDeityLevelConfig[o][this.slot];n.itemId==t.composeItem.id&&(i+=1)}var r=DataCenter.ins().ItemConfig[t.composeItem.id];this.costImg0.source=r.icon+"_png",this.costImg0.visible=!1;var a;a=i>=t.composeItem.count?ColorUtils.GREEN:ColorUtils.RED,this.cost0.textFlow=TextUtils.generateTextFlow1("|C:"+a+"&T:"+i+"|/|C:"+ColorUtils.NORMAL_COLOR+"&T:"+t.composeItem.count),this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text);var s=DataCenter.ins().ItemConfig[t.composeItem.id];a=ItemUtils.getQualityColor(s),this.costName.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("zhuzaiExpend")+"|C:"+a+"&T:"+s.name+"|C:"+LangMgr.getColor("color43")+"&T::")}},e.prototype.updateRedPoint=function(){for(var t=0;t<FeatherControl.GodWingMaxSlot;t++)this["item"+t].updateRedPoint(featherControl.gridRedPoint(this.curRole,t+1));this.redPointReplace.visible=featherControl.wearItemRedPoint(this.curRole,this.slot),this.redPointReplace0.visible=featherControl.quickComposeRedPoint(this.curRole,this.slot)},e.prototype.updatePower=function(){var t=featherControl.getGodWing(this.curRole),e=t.getData(),i=0,o=0,n=t.getSuitSum();if(n>=FeatherControl.GodWingMaxSlot){var r=t.getSuitLevel(),a=DataCenter.ins().FeatherDeitySuitConfig[r];a&&(o=a.precent/1e4)}for(var s in e){var l=DataCenter.ins().FeatherDeityLevelConfig[e[s].level][e[s].slot],h=DataCenter.ins().FeatherItemConfig[l.itemId],u=h.exPower?h.exPower:0,c=AttributeData.getPercentAttr(h.attr,o);i+=Math.floor(BackpackControl.getAttrPower(c))+u}this.powerPanel.setPower(i)},e}(BasePanel);__reflect(FeatherDeityPanel.prototype,"FeatherDeityPanel");var FeatherDeitySkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FeatherDeitySkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.onClick),this.gwsConfig=t[0];var i=t[1];for(var o in DataCenter.ins().FeatherDeitySuitConfig){var n=DataCenter.ins().FeatherDeitySuitConfig[o];if(n.skillname&&n.lv>this.gwsConfig.lv){this.nextConfig=n;break}}i?this.nextConfig?this.currentState="active":this.currentState="max":this.currentState="unactive",this.validateNow(),this.updateDesc()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(){UIMgr.ins().close(this)},e.prototype.updateDesc=function(){this.setCurDesc(),this.setNextDesc()},e.prototype.setCurDesc=function(){this.icon.data=this.gwsConfig,this.icon.setNameVisible(!1),this.icon.setCountVisible(!1),this.content.textFlow=TextUtils.generateTextFlow1(this.gwsConfig.skilldesc),this.lv.text=LangMgr.getValueByKey("equiLevel")+this.gwsConfig.skilllevel;var t=DataCenter.ins().FeatherDeityLevelConfig[this.gwsConfig.lv][1],e=DataCenter.ins().FeatherItemConfig[t.itemId].showlv;this.condition.text=LangMgr.getValueByKey("godGodCondition",e)},e.prototype.setNextDesc=function(){if(this.nextConfig){this.icon0.data=this.nextConfig,this.icon0.setNameVisible(!1),this.icon0.setCountVisible(!1),this.content0.textFlow=TextUtils.generateTextFlow1(this.nextConfig.skilldesc),this.lv0.text=LangMgr.getValueByKey("equiLevel")+this.nextConfig.skilllevel+"";var t=DataCenter.ins().FeatherDeityLevelConfig[this.nextConfig.lv][1];DataCenter.ins().FeatherItemConfig[t.itemId].showlv,this.condition0.text=LangMgr.getValueByKey("godGodCondition",this.nextConfig.lv)}},e}(BaseEuiView);__reflect(FeatherDeitySkillTipsView.prototype,"FeatherDeitySkillTipsView");var FeatherDeitySuitTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FeatherDeitySuitTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.onClick),this.roleIndex=t[0];var i=featherControl.getGodWing(this.roleIndex).getSuitLevel(),o=0;if(i&&(o=featherControl.getNextLevel(i)),this.gwsConfig=DataCenter.ins().FeatherDeitySuitConfig[i],!this.gwsConfig)for(var n in DataCenter.ins().FeatherDeitySuitConfig){this.gwsConfig=DataCenter.ins().FeatherDeitySuitConfig[n];break}i?(this.nextConfig=DataCenter.ins().FeatherDeitySuitConfig[o],this.nextConfig?this.currentState="active":this.currentState="max"):this.currentState="unactive",this.validateNow(),this.updateDesc()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onClick),this.removeCustomEvents()},e.prototype.onClick=function(){UIMgr.ins().close(this)},e.prototype.updateDesc=function(){this.setCurDesc(),this.setNextDesc()},e.prototype.setCurDesc=function(){if("unactive"==this.currentState){var t=Math.floor(this.gwsConfig.precent/100),e=FeatherControl.GodWingMaxSlot,i=featherControl.getGodWing(this.roleIndex).getSuitSum();this.content0.text=LangMgr.getValueByKey("godShow1",t),this.activeLbl.text=LangMgr.getValueByKey("godShow2",1,i,e),this.name0.text=this.gwsConfig.suitname}else if("max"==this.currentState){var t=Math.floor(this.gwsConfig.precent/100);this.content0.text=LangMgr.getValueByKey("godShow1",t),this.name0.text=this.gwsConfig.suitname}else{var t=Math.floor(this.gwsConfig.precent/100);this.content0.text=LangMgr.getValueByKey("godShow1",t),this.name0.text=this.gwsConfig.suitname}},e.prototype.setNextDesc=function(){if("active"==this.currentState){for(var t=Math.floor(this.nextConfig.precent/100),e=FeatherControl.GodWingMaxSlot,i=featherControl.calcGodWingSlot(this.roleIndex),o=0,n=0;n<i.length;n++)i[n].level>=this.nextConfig.lv&&o++;var r=DataCenter.ins().FeatherDeityLevelConfig[this.nextConfig.lv][1],a=DataCenter.ins().FeatherItemConfig[r.itemId].showlv;this.content1.text=LangMgr.getValueByKey("godShow1",t),this.nextActiveLbl.text=LangMgr.getValueByKey("godShow2",a,o,e),this.name1.text=this.nextConfig.suitname}},e}(BaseEuiView);__reflect(FeatherDeitySuitTipsView.prototype,"FeatherDeitySuitTipsView");var FeatherDeityTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FeatherDeityTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.bgClose,this.otherClose),this.gwConfig=t[0],this.updateTips()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchEnd(this.bgClose,this.otherClose)},e.prototype.otherClose=function(t){UIMgr.ins().close(e)},e.prototype.updateTips=function(){var t=DataCenter.ins().ItemConfig[this.gwConfig.itemId];this.nameLabel.text=t.name,this.type.text=featherControl.getNameFromSlot(this.gwConfig.slot),this.lv.text=LangMgr.getValueByKey("godShow3",this.gwConfig.level);for(var e=LangMgr.getColor("color22"),i=0;i<heroControl.subRolesLen;i++){var o=heroControl.getSubRoleByIndex(i);if(o&&o.wingsData.lv+1>=this.gwConfig.level){e=LangMgr.getColor("color43");break}}this.lv.textColor=e,this.nameLabel.textColor=ItemUtils.getQualityColor(t);for(var n=this.gwConfig.attr,r=this.gwConfig.exattr,a="",s=this.gwConfig.exPower,i=0;i<n.length;i++)a+=AttributeData.getAttrStrByType(n[i].type)+": ",a+=n[i].value+"\n";for(var i=0;i<r.length;i++){a+=AttributeData.getExtAttrStrByType(r[i].type)+": ";var l=r[i].value;(26==r[i].type||42==r[i].type)&&(l/=100,a+=l,a+="%"),a+="\n"}var h=a.lastIndexOf("\n");a=a.substring(0,h),this.attr0.text=a;var u=n,c=Math.floor(BackpackControl.getAttrPower(u))+s;this.score.text=LangMgr.getValueByKey("wingPingfen",c),this.powerPanel.setPower(c),this.itemIcon.data=this.gwConfig,this.itemIcon.setNameVisible(!1),this.itemIcon.setCountVisible(!1),this.quali.source="quali"+ItemUtils.getQuality(t)},e}(BaseEuiView);__reflect(FeatherDeityTipsView.prototype,"FeatherDeityTipsView");var FeatherDeityTransferPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.transfer,this.onClick),this.removeEventTouchTap(this.have,this.onListTap),this.removeEventTouchTap(this.item0,this.onClick),this.removeCustomEvents(),this.reset();for(var i=1;i<FeatherControl.GodWingMaxSlot;i++)this.removeEventTouchTap(this["item"+i],this.onTouchItem)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this.transfer,this.onClick),this.addEventTouchTap(this.have,this.onListTap),this.addEventTouchTap(this.item0,this.onClick),this.addCustomEvent(266,this.callbackUpdate),this.itemList=new eui.ArrayCollection,this.have.itemRenderer=FeatherDeityItemRenderer,this.have.dataProvider=new eui.ArrayCollection([]),this.updateGodWing()},e.prototype.reset=function(){for(var t=1;t<FeatherControl.GodWingMaxSlot;t++)this.addEventTouchTap(this["item"+t],this.onTouchItem),this["item"+t].setCountVisible(!1),this["item"+t].setNameVisible(!1),this["item"+t].setImgIcon(""),this["item"+t].setSelect(!1),this["item"+t].data=null;this.item0.setCountVisible(!1),this.item0.setImgIcon(""),this.item0.setNameVisible(!1),this.item0.data=null,this.updateBagList(),this.warn.visible=this.itemList.length?!1:!0,this.curItemId=0,this.desId=0},e.prototype.updateBagList=function(){var t=backpackControl.getBagGoodsByType(16);this.itemList.replaceAll(t),this.have.dataProvider=this.itemList},e.prototype.callbackUpdate=function(){if(this.item0.itemId){var t=backpackControl.getBagItemById(this.item0.itemId);t||this.reset(),this.updateBagList(),this.updateCost()}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.transfer:Boolean(backpackControl.getBagGoodsByType(16))?this.item0.itemId&&this.desId?featherControl.upResetGodWing(this.item0.itemId,this.desId):tipsControl.showTips(LangMgr.getValueByKey("godEnterRotation")):tipsControl.showTips(LangMgr.getValueByKey("godNoRotation"));break;case this.item0:if(this.curItemId){var e=DataCenter.ins().FeatherItemConfig[this.curItemId];UIMgr.ins().open(FeatherDeityTipsView,e)}}},e.prototype.onTouchItem=function(t){for(var e=1;e<FeatherControl.GodWingMaxSlot;e++)t.currentTarget==this["item"+e]?t.currentTarget.itemId&&(this.desId=t.currentTarget.itemId,this["item"+e].setSelect(!0)):this["item"+e].setSelect(!1)},e.prototype.onListTap=function(t){if(t&&t.currentTarget&&this.have.selectedItem){var e=this.have.selectedItem;this.curItemId=e.configID;var i=DataCenter.ins().FeatherItemConfig[this.curItemId],o=DataCenter.ins().FeatherDeityLevelConfig[i.level];this.item0.data=i,this.item0.setNameVisible(!0);var n=DataCenter.ins().ItemConfig[this.curItemId];this.item0.setImgIcon(n.icon+"_png");var r=1;for(var a in o)if(o[a].slot!=i.slot&&(this["item"+r].data=DataCenter.ins().FeatherItemConfig[o[a].itemId],this["item"+r].setNameVisible(!0),this["item"+r].setSelect(!1),r++,r>3))break;this.updateCost()}},e.prototype.updateGodWing=function(){this.reset(),this.updateCost()},e.prototype.updateCost=function(){if(!this.curItemId)return void(this.costImg0.visible=this.cost.visible=!1);this.costImg0.visible=this.cost.visible=!0;var t=DataCenter.ins().FeatherItemConfig[this.curItemId];this.cost.text=t.needMoney+""},e}(BasePanel);__reflect(FeatherDeityTransferPanel.prototype,"FeatherDeityTransferPanel");var FeatherDeityView=function(t){function e(){var e=t.call(this)||this;return e.roleIndex=0,e.isTopLevel=!0,e.skinName="FeatherDeityViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventChange(this.roleSelect,this.onChange),this.addCustomEvent(582,this.updateRedPoint),this.addCustomEvent(583,this.updateRedPoint),this.addCustomEvent(352,this.updateRedPoint),this.addCustomEvent(266,this.updateRedPoint),this.addCustomEvent(268,this.updateRedPoint),this.roleIndex=t[0]?t[0]:0,this.roleSelect.setCurRole(this.roleIndex),this.featherDeityPanel.curRole=this.roleIndex,this.setOpenIndex(0),this.updateRedPoint(),FeatherControl.ins().checkIsOpen()?this.viewStack.getChildIndex(this.godWingForgePanel)<0&&(this.viewStack.addChildAt(this.godWingForgePanel,3),this.redPointGroup.addChildAt(this.redPoint2,3)):this.viewStack.getChildIndex(this.godWingForgePanel)>=0&&(this.viewStack.removeChild(this.godWingForgePanel),this.redPointGroup.removeChild(this.redPoint2))},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=GameServer.serverOpenDay+1>=DataCenter.ins().FeatherCommonConfig.openDay?!0:!1;return i||tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().FeatherCommonConfig.openDay)),i},e.prototype.onTabTouching=function(t){this.checkIsOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.checkIsOpen=function(t){return!0},e.prototype.onChange=function(t){this.setRoleId(this.roleSelect.getCurRole())},e.prototype.onTabTouch=function(t){this.setOpenIndex(this.tab.selectedIndex)},e.prototype.setRoleId=function(t){this.featherDeityPanel.curRole=t,this.setOpenIndex(this.viewStack.selectedIndex)},e.prototype.setOpenIndex=function(t){switch(t){case 0:this.roleSelect.openRole(),this.featherDeityPanel.open();break;case 1:this.roleSelect.hideRole(),this.featherDeityComposePanel.open();break;case 2:this.roleSelect.hideRole(),this.featherDeityTransferPanel.open();break;case 3:this.roleSelect.openRole(),this.godWingForgePanel.open(this.roleSelect.getCurRole())}this.tab.selectedIndex=this.viewStack.selectedIndex=t,this.updateRedPoint()},e.prototype.updateRedPoint=function(){if(FeatherDeityRedPoint.ins().tabs||(FeatherDeityRedPoint.ins().tabs={}),this.redPoint0.visible=FeatherDeityRedPoint.ins().tabs[0],this.redPoint1.visible=FeatherDeityRedPoint.ins().tabs[1],0==this.tab.selectedIndex)for(var t=0;t<heroControl.subRolesLen;t++)this.roleSelect.showRedPoint(t,FeatherDeityRedPoint.ins().roleTabs[this.tab.selectedIndex][t]);if(3==this.tab.selectedIndex)for(var t=0;t<heroControl.subRolesLen;t++)this.roleSelect.showRedPoint(t,this.getForeRedByRole(t+""));this.redPoint2.visible=this.getForgeRed()},e.prototype.getForeRedByRole=function(t){var e=FeatherControl.ins().godWingForge;for(var i in e)if(i==t){for(var o in e[i].data){var n=e[i].data[o].lv,r=DataCenter.ins().FeatherDeityForgeLvConfig[n+1],a=e[i].data[o].isTupo,s=a?DataCenter.ins().FeatherCommonConfig.forgeExtraItemId:DataCenter.ins().FeatherCommonConfig.forgeItemId,l=backpackControl.getBagGoodsCountById(0,s),h=DataCenter.ins().FeatherDeityForgeExtraLvConfig[n];if(r){if(a&&h&&l>=h.cost)return!0;if(!a&&r&&l>=r.cost)return!0}else if(a&&h&&l>=h.cost)return!0}break}return!1},e.prototype.getForgeRed=function(){var t=FeatherControl.ins().godWingForge;for(var e in t)for(var i in t[e].data){var o=t[e].data[i].lv,n=DataCenter.ins().FeatherDeityForgeLvConfig[o+1],r=t[e].data[i].isTupo,a=r?DataCenter.ins().FeatherCommonConfig.forgeExtraItemId:DataCenter.ins().FeatherCommonConfig.forgeItemId,s=backpackControl.getBagGoodsCountById(0,a),l=DataCenter.ins().FeatherDeityForgeExtraLvConfig[o];if(n){if(r&&l&&s>=l.cost)return!0;if(!r&&n&&s>=n.cost)return!0}else if(r&&l&&s>=l.cost)return!0}return!1},e}(BaseEuiView);__reflect(FeatherDeityView.prototype,"FeatherDeityView");var FeatherDeityComposeItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="FeatherDeityComposeItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.suitConfig,e=this.data.slot,i=DataCenter.ins().FeatherDeityLevelConfig[t.lv][e],o=DataCenter.ins().ItemConfig[i.itemId];this.nameTxt.text=o.name}},e.prototype.setRedPoint=function(t){this.redPoint.visible=t},e.prototype.destruct=function(){},e}(BaseItemRender);__reflect(FeatherDeityComposeItemRenderer.prototype,"FeatherDeityComposeItemRenderer");var FeatherDeityForgeItemRendrere=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=featherControl.getCurLevelItemId(this.data.roleId,this.data.slot);if(t){var e=DataCenter.ins().ItemConfig[t.itemId];this.itemIcon.imgIcon.source=e.icon+"_png",this.itemIcon.imgBg.source="quality"+ItemUtils.getQuality(e)}else this.setImgIcon("sybg"+this.data.slot),this.itemIcon.imgBg.source="quality0";var i=FeatherControl.ins().getStarData(this.data.lv,this.data.isTupo);this.nameTxt.text=LangMgr.getValueByKey("forgeTips2",StringUtils.NumberToChinese(i.level),i.star),this.nameTxt.textColor=16298305,this.setCountVisible(!1),this.itemIcon.imgIcon.visible=this.itemIcon.imgIcon.source?!0:!1}},e}(FeatherDeityItemRenderer);__reflect(FeatherDeityForgeItemRendrere.prototype,"FeatherDeityForgeItemRendrere");var FeatherDeityItemItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.itemId=0,this.itemIcon.imgJob.visible=!1,this.itemIcon.imgIcon.source="";var e=t,i=DataCenter.ins().ItemConfig[e.itemId];this.itemIcon.imgIcon.source=i.icon+"_png",this.nameTxt.text=i.name,this.itemId=e.itemId,this.itemIcon.imgBg.source="quality"+ItemUtils.getQuality(i),this.nameTxt.textColor=ItemUtils.getQualityColor(i),this.itemIcon.imgIcon.visible=this.itemIcon.imgIcon.source?!0:!1}},e}(FeatherDeityItemRenderer);__reflect(FeatherDeityItemItemRenderer.prototype,"FeatherDeityItemItemRenderer");var FeatherDeitySuitItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data;this.itemId=0,this.itemIcon.imgJob.visible=!1,this.itemIcon.imgIcon.source="";var e=t;if(!e.skillname)for(var i in DataCenter.ins().FeatherDeitySuitConfig)if(DataCenter.ins().FeatherDeitySuitConfig[i].skillname){e=DataCenter.ins().FeatherDeitySuitConfig[i],this.data=e;break}this.itemIcon.imgIcon.source=e.skillicon,this.nameTxt.text=e.skillname,this.itemIcon.imgIcon.visible=this.itemIcon.imgIcon.source?!0:!1}},e}(FeatherDeityItemRenderer);__reflect(FeatherDeitySuitItemRenderer.prototype,"FeatherDeitySuitItemRenderer");var FlowerLogView=function(t){function e(){var e=t.call(this)||this;return e.skinName="FlowerLogViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=FlowerLogItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTouch),this.addEventTouchTap(this.closeBtn0,this.onTouch),this.addCustomEvent(384,this.update),this.update()},e.prototype.close=function(){this.removeEventTouchTap(this.closeBtn,this.onTouch),this.removeEventTouchTap(this.closeBtn0,this.onTouch),this.removeCustomEvents(),copyControl.clearTfFlowerRecords();var t=UIMgr.playFun;t&&t.removeFlower()},e.prototype.update=function(){this._collect||(this._collect=new ArrayCollection,this.list.dataProvider=this._collect);var t=copyControl.tfFlowerRecords.concat();t.reverse(),this._collect.source=t;for(var e=t.length,i=0,o=0;e>o;o++)i+=t[o].count*DataCenter.ins().AsTeamCopyBaseConfig.flowerChiv;this.charmCount.text=LangMgr.getValueByKey("equiCharmCount",i)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(FlowerLogView.prototype,"FlowerLogView");var FlowerPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="FlowerShowSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this._inited=!0,this.showEffect()},e.prototype.onTouch=function(t){UIMgr.ins().open(FlowerLogView),DisplayUtils.removeFromParent(this)},e.prototype.onRemove=function(t){this.removeEventTouchTap(this.flowerImg,this.onTouch),this.removeEventRemovedFromStage(this,this.onRemove),this.mcEff&&(this.mcEff.destroy(),this.mcEff=null,this.isPlaying=!1)},e.prototype.showEffect=function(){this._inited&&(this.isPlaying||(this.flowerImg.alpha=0,this.mcEff||(this.mcEff=ObjectPool.pop("GameMovieClip"),this.flowereff.addChild(this.mcEff)),this.mcEff.playFile(PATH_EFF+"flowereff",1,this.playComplete.bind(this),!0),this.isPlaying=!0,this.flowerImg.hasEventListener(egret.TouchEvent.TOUCH_TAP)||this.addEventTouchTap(this.flowerImg,this.onTouch),this.hasEventListener(egret.TouchEvent.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,this.onRemove),this.flowerImg.source=null,this.flowerImg.source="flower_openImg",this.imgBg.source=null,this.imgBg.source="redPacket_mainEff_png"))},e.prototype.playComplete=function(){this.mcEff.destroy(),this.mcEff=null,this.flowerImg.alpha=1,this.isPlaying=!1},e}(BasePanel);__reflect(FlowerPanel.prototype,"FlowerPanel");var FlowerUseView=function(t){function e(){var e=t.call(this)||this;return e._sendCount=1,e._maxCount=0,e.skinName="FlowerUseViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.list.itemRenderer=FlowerUseTargetItemRenderer},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.addEventTouchTap(this.list,this.onTouchList),this.addCustomEvent(212,this.update),this.addCustomEvent(266,this.updateMaterial),this.addCustomEvent(267,this.updateMaterial),this.addCustomEvent(268,this.updateMaterial),this._sendCount=1,this._friendID=0,this.update(),this.selectName.text=""},e.prototype.close=function(){this.removeEventTouchTap(this,this.onTouch),this.removeEventTouchTap(this.list,this.onTouchList),this.removeCustomEvents(),this.scroller.visible=!1},e.prototype.update=function(){this._collect||(this._collect=new ArrayCollection,this.list.dataProvider=this._collect),this._collect.source=partnerControl.friendsList.source,this.updateCount(),this.updateMaterial()},e.prototype.updateMaterial=function(){var t=backpackControl.getBagItemById(DataCenter.ins().AsTeamCopyBaseConfig.itemId);this._maxCount=t?t.count:0,this.itemCount.text=LangMgr.getValueByKey("equiFlowerCount",this._maxCount)},e.prototype.onTouch=function(t){switch(t.target){case this.bgClose:case this.closeBtn:UIMgr.ins().close(this);break;case this.sendBtn:if(!this._friendID)return void tipsControl.showTips(LangMgr.getValueByKey("equiSendFlower"));if(this._maxCount<=0||this._maxCount<this._sendCount)return void tipsControl.showTips(LangMgr.getValueByKey("equiNoProp"));copyControl.upTfFlower(this._friendID,this._sendCount);break;case this.minBtn:1!=this._sendCount&&(this._sendCount=1,this.updateCount());break;case this.maxBtn:this._sendCount!=this._maxCount&&(this._sendCount=this._maxCount,this.updateCount());break;case this.sub1Btn:this._sendCount>1&&(this._sendCount--,this.updateCount());
break;case this.add1Btn:this._sendCount<this._maxCount&&(this._sendCount++,this.updateCount());break;case this.openListBtn:this.scroller.visible=!this.scroller.visible}},e.prototype.onTouchList=function(t){var e=this.list.selectedItem;e&&(this._friendID=e.id,this.selectName.text=e.name,this.scroller.visible=!this.scroller.visible)},e.prototype.updateCount=function(){this.numLabel.text=this._sendCount+"",this.charmPoint.text=LangMgr.getValueByKey("equiCharmValue")+this._sendCount*DataCenter.ins().AsTeamCopyBaseConfig.flowerChiv},e}(BaseEuiView);__reflect(FlowerUseView.prototype,"FlowerUseView");var FlowerLogItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){this.playerName.text=this.data.roleName,this.flowerCount.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("flowerShow1",LangMgr.getColor("color43"),this.data.count))},e}(BaseItemRender);__reflect(FlowerLogItemRenderer.prototype,"FlowerLogItemRenderer");var FlowerUseTargetItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.touchChildren=!1,e.touchEnabled=!0,e}return __extends(e,t),e.prototype.dataChanged=function(){this.nameTxt.text=this.data.name},e}(BaseItemRender);__reflect(FlowerUseTargetItemRenderer.prototype,"FlowerUseTargetItemRenderer");var Greet1View=function(t){function e(){var e=t.call(this)||this;return e.skinName="Greet1ViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.sureGroup,this.onTap),this.playEff(),this.awardList.touchThrough=!1,this.awardList.itemRenderer=ItemBase,this.awardList.dataProvider=new ArrayCollection(DataCenter.ins().ClientGlobalConfig.welcomeItem.reward)},e.prototype.onTap=function(t){if(t.currentTarget==this.bgClose||t.currentTarget==this.sureGroup){this.sureBtn.visible=!1;var e=egret.Tween.get(this.pic),i=UIMgr.playFun;if(i&&i.expTxt){var o=i.expTxt;if(o){var n=this,r=o.localToGlobal();this.sureGroup.globalToLocal(r.x,r.y,r),e.to({scaleX:0,scaleY:0,x:r.x,y:r.y},500).call(function(){HookControl.ins().start(),UIMgr.ins().close(n)}),egret.Tween.get(this.awardList).to({scaleX:0,scaleY:0,x:r.x,y:r.y},500).call(function(){})}this.eff&&(DisplayUtils.removeFromParent(this.eff),this.eff=null),promptControl.dispatchWelcome()}}},e}(GreetView);__reflect(Greet1View.prototype,"Greet1View");var GuideControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.step=0,e.part=0,e.wrongCount=0,e.maxWrongCount=2,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.init=function(){if(!this.isInit){this.isInit=!0,0==ServerStorage.currPart?(this.part=1,this.step=1):(this.part=ServerStorage.currPart,this.step=ServerStorage.currStep),this.cfg=[];var t;for(var e in DataCenter.ins().GuideConfig){t=[];for(var i in DataCenter.ins().GuideConfig[e])t.push(DataCenter.ins().GuideConfig[e][i]);this.cfg.push(t)}if(this.part<=this.cfg.length){var o=this.cfg[this.part-1].length-1;this.overs=this.cfg[this.part-1][o].overs}this.part<=this.cfg.length&&EventMgr.addListener(91,this.updateByTask,this)}},e.prototype.updateByTask=function(){this.guideOver(),this.update(1)},e.prototype.updateByClick=function(){this.update(2)},e.prototype.updateByAppear=function(){this.update(3)},e.prototype.canShow=function(){return Assert(this.cfg,LangMgr.getValueByKey("guideError"))?!1:this.part>this.cfg.length?(EventMgr.ins().removeAll(this),!1):this.view&&this.view.parent?!1:!0},e.prototype.checkShow=function(){if(!this.curCfg)return!1;try{var t=this.getDisplayObj(this.part,this.step);if(!t)return!1}catch(e){return!1}return!0},e.prototype.addTimeHandler=function(){TimerMgr.ins().isExists(this.timeHandler,this)||TimerMgr.ins().doTimer(50,0,this.timeHandler,this)},e.prototype.removeTimeHandler=function(){TimerMgr.ins().remove(this.timeHandler,this)},e.prototype.timeHandler=function(){this.canShow()?this.checkShow()&&this.show(this.part,this.step):this.removeTimeHandler()},e.prototype.guideOver=function(){var t=taskControl.taskTrace;if(this.overs&&t&&0==t.state)for(var e=this.overs.length,i=0;e>i;i++){var o=this.overs[i];if(1==o.type&&o.value==t.id)return this.readyForNext(),void this.close()}},e.prototype.update=function(t){if(void 0===t&&(t=0),0!=this.canShow()&&(this.curCfg=this.cfg[this.part-1][this.step-1],this.curCfg&&this.curCfg.start))if(1==t){if(1==this.curCfg.start.type){var e=taskControl.taskTrace;e.id==this.curCfg.start.value&&0==e.state&&guideControl.show(this.part,this.step)}else if(3==this.curCfg.start.type){var e=taskControl.taskTrace;e.id==this.curCfg.start.value&&1==e.state&&guideControl.show(this.part,this.step)}}else if(2==t){if(2==this.curCfg.start.type){var e=taskControl.taskTrace;e.id==this.curCfg.start.value&&0==e.state&&guideControl.show(this.part,this.step)}}else 3==t&&4==this.curCfg.start.type&&guideControl.show(this.part,this.step)},e.prototype.show=function(t,e){var i=this;this.part=t,this.step=e;var o=this.cfg[this.part-1];if(o?this.curCfg=this.cfg[this.part-1][this.step-1]:this.curCfg=null,!this.curCfg)return this.readyForNext(),void this.close();if(!this.checkShow())return this.close(),void this.addTimeHandler();null==this.view&&(this.view=new GuideView),this.view.clickCD=!0,this.view.hasEventListener(egret.Event.CHANGE)||this.view.addEventListener(egret.Event.CHANGE,this.next,this),this.save();var n;try{n=this.getDisplayObj(t,e)}catch(r){return this.wrongCount>=this.maxWrongCount?void this.close():(this.wrongCount++,this.view.close(),debug.log("guide:"+t+","+e+"error,play back"),void TimerMgr.ins().doTimer(300,1,function(){i.show(t,e-1)},this))}n?(debug.log("play guide:"+t+","+e),TimerMgr.ins().doNext(function(){i.view.show(n),StageUtils.ins().getStage().addChild(i.view)},this)):(this.readyForNext(),this.close())},e.prototype.clickOut=function(){this.curCfg&&1==this.curCfg.type&&(this.readyForNext(),this.close())},e.prototype.readyForNext=function(){if(this.part++,this.step=1,this.part<=this.cfg.length){var t=this.cfg[this.part-1].length-1;this.overs=this.cfg[this.part-1][t].overs}else this.overs=null;this.curCfg=null},e.prototype.close=function(){this.view&&(DisplayUtils.removeFromParent(this.view),this.view.close(),this.view.removeEventListener(egret.Event.CHANGE,this.next,this),this.wrongCount=0),this.removeTimeHandler()},e.prototype.next=function(){var t=this;TimerMgr.ins().doNext(function(){t.show(t.part,t.step+1)},this)},e.prototype.save=function(){1==this.step&&(ServerStorage.ins().setValue(0,this.part+1),ServerStorage.ins().setValue(1,1))},e.prototype.getDisplayObj=function(t,e){var i,o;if(this.cfg[t-1]&&e<=this.cfg[t-1].length){o=this.cfg[t-1][e-1];var n=UIMgr.ins().getView(o.view);if(n){for(var r=o.target.split("."),a=n,s=0,l=r;s<l.length;s++){var h=l[s],u=/(\w+)\(([\w,]*)\)/.exec(h);if(u){var c=u[1],p=u[2];if(p){var d=p.split(",");a=a[c].apply(a,d)}else a=a[c].call(a)}else a=a[h]}i=a}}return i},e.taskGuidance=function(t,i){var o;switch(i){case 0:o=DataCenter.ins().GuideBasicConfig[t];break;case 1:o=taskControl.getAchieveConfById(t),promptControl.dispatchAchievementBef(o)}switch(o.control){case 1:100082==t&&"LimitTaskView"==String(o.controlTarget[0])?taskControl.limitTaskEndTime>0&&0!=taskControl.limitTaskState&&taskControl.limitTaskEndTime>0&&taskControl.limitTaskEndTime-Math.floor(GameServer.serverTime/1e3)>0?e.guidance(o.controlTarget[0],o.controlTarget[1]):e.guidance("RoleView",1):e.guidance(o.controlTarget[0],o.controlTarget[1]);break;case 2:if(this.challengeBoss(),1==i){var n=o;promptControl.dispatchKillBoss(n)}break;case 3:artifactControl.setGuide();break;case 4:HookControl.ins().stop();var r=o.controlTarget[0],a=copyControl.rPos[r][0].x*MapControl.CELL_SIZE,s=copyControl.rPos[r][0].y*MapControl.CELL_SIZE;this.tempMainRole=UnitMgr.ins().getNoDieRole(),MapControl.moveEntity(this.tempMainRole,a,s),TimerMgr.ins().doTimer(500,0,this.guideFun,this);break;case 5:copyControl.setAutoPk();break;case 7:if(confrontControl.isEncounter())return void tipsControl.showTips(LangMgr.getValueByKey("atkPlayerIng"));if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open("BackpackFullTipsView");copyControl.upIntoGuideFb(o.controlTarget[1])}},e.guideFun=function(){this.tempMainRole.action==UnitAction.STAND&&(HookControl.ins().start(),TimerMgr.ins().remove(this.guideFun,this))},e.guidance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=-1!=t[1]?t[1]:null;UIMgr.ins().open(t[0],i,t[2])},e.challengeBoss=function(t){return backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?void UIMgr.ins().open("BackpackFullTipsView"):void(copyControl.currentEnergy>=copyControl.energy?(t&&"function"==typeof t&&t(),copyControl.autoPk()):tipsControl.showTips(LangMgr.getValueByKey("gameGuiderPower")))},e.startTaskEffect=function(){this.guideEffect||(this.guideEffect=new GuideEffectDisplay),this.guideEffect.start()},e.stopTaskEffect=function(){this.guideEffect&&this.guideEffect.stop()},e}(SingleClass);__reflect(GuideControl.prototype,"GuideControl");var GuideConditionVo=function(){function t(){}return t}();__reflect(GuideConditionVo.prototype,"GuideConditionVo");var GuideArrow=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuideArrowsSkin",e}return __extends(e,t),e.prototype.update=function(){var t=guideControl.curCfg;if(t){if(!t.tips||""==t.tips)return void(this.visible=!1);egret.Tween.removeTweens(this.parent),this.parent.x=0,this.visible=!0,1==t.direction?(this.currentState="right",egret.Tween.get(this.parent,{loop:!0}).to({x:40},1e3).to({x:0},1e3)):(this.currentState="left",egret.Tween.get(this.parent,{loop:!0}).to({x:-40},1e3).to({x:0},1e3)),this.lab.text=t.tips}},e.prototype.close=function(){this.parent&&egret.Tween.removeTweens(this.parent)},e}(eui.Component);__reflect(GuideArrow.prototype,"GuideArrow");var GuideArrow2=function(t){function e(){var e=t.call(this)||this;return e.skinName="GuideArrowsSkin",e}return __extends(e,t),e.prototype.setDirection=function(t){egret.Tween.removeTweens(this),this.x=0,this.visible=!0,1==t?(this.currentState="right",egret.Tween.get(this,{loop:!0}).to({x:40},1e3).to({x:0},1e3)):(this.currentState="left",egret.Tween.get(this,{loop:!0}).to({x:-40},1e3).to({x:0},1e3))},e.prototype.setTips=function(t){this.lab.text=t},e.prototype.removeTweens=function(){egret.Tween.removeTweens(this)},e}(eui.Component);__reflect(GuideArrow2.prototype,"GuideArrow2");var GuideEffectDisplay=function(t){function e(){var e=t.call(this)||this;return e.ignoreLeak=!0,e.touchEnabled=!1,e.touchChildren=!1,e._effGroup=new eui.Group,e.addChild(e._effGroup),e._arrowGroup=new eui.Group,e.addChild(e._arrowGroup),e._effCir=new GameMovieClip,e._effGroup.addChild(e._effCir),e._arrow=new GuideArrow2,e._arrowGroup.addChild(e._arrow),e}return __extends(e,t),e.prototype.start=function(){TimerMgr.ins().remove(this.update,this),TimerMgr.ins().doTimer(500,0,this.update,this)},e.prototype.stop=function(){TimerMgr.ins().remove(this.update,this),this.hide()},e.prototype.show=function(t){if(!this._isShow){this._isShow=!0;var e=UIMgr.playFun;if(!e)return void this.hide();egret.Tween.removeTweens(this),this.alpha=0,egret.Tween.get(this).to({alpha:1},300);var i=e.taskTraceBtn;this.x=i.width>>1,this.y=i.height>>1,i.addChild(this),this._arrow.setDirection(0),this._effCir.playFile(PATH_EFF+"guideff",-1)}this._arrow.setTips(t)},e.prototype.hide=function(){this._isShow&&(this._isShow=!1,this._arrow.removeTweens(),this.parent&&this.parent.removeChild(this))},e.prototype.isShow=function(){return this._isShow},e.prototype.update=function(){var t=taskControl.taskTrace;if(t){for(var e=taskControl.getAchieveConfById(t.id),i=["GreetView"],o=0,n=i;o<n.length;o++){var r=n[o];if(UIMgr.ins().getView(r))return void this.hide()}e&&(0==t.state&&e.startwarning?this.show(e.startwarning):1==t.state&&e.finishwarning?this.show(e.finishwarning):this.hide())}},e}(BaseLeakDisplay);__reflect(GuideEffectDisplay.prototype,"GuideEffectDisplay");var GuideUpgradeView=function(t){function e(){var e=t.call(this)||this;return e.gainWay=[],e.uilayer=GameLayer.POPUP,e.gainWay=[[LangMgr.getValueByKey("towerPassLevel"),"CyberPuzzle",0,3],[LangMgr.getValueByKey("towerName"),"CopyView",2,5],[LangMgr.getValueByKey("towerKill"),"LadderView",0,4],[LangMgr.getValueByKey("towerExp"),"CopyView",1,5]],e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GuideUpgradeViewSkin",this.gainList.itemRenderer=GainGoodsItem},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addEventItemTap(this.gainList,this.onTouchList),this.gainList.dataProvider=new eui.ArrayCollection(this.gainWay),this.gainList.validateNow();for(var i=0;i<this.gainList.numElements;i++){var o=this.gainList.getElementAt(i);if(o){var n=!1,r=void 0,a=void 0,s=void 0;0>=i?n=!0:1==i?(n=reincarnateControl.lv>=DataCenter.ins().BabelLotteryConfig[1].zsLevelLimit&&ActorControl.level>=DataCenter.ins().BabelLotteryConfig[1].levelLimit,r=DataCenter.ins().BabelLotteryConfig[1].levelLimit,a=DataCenter.ins().BabelLotteryConfig[1].zsLevelLimit):2==i?(n=copyControl.guanqiaID>=DataCenter.ins().SkirmishBaseConfig.openLevel,s=DataCenter.ins().SkirmishBaseConfig.openLevel):3==i&&(n=ActorControl.level>=DataCenter.ins().CopyExpBaseConfig.openLv,r=DataCenter.ins().CopyExpBaseConfig.openLv),o.gainData(n,this.gainWay[i][3],{needLv:r,needZs:a,guanka:s})}}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventItemTap(this.gainList,this.onTouchList)},e.prototype.onTouchList=function(t){var e=t.item;if(null!=t.item){var i=UIMgr.ins().viewOpenCheck(e[1],e[2]);if(i){if(UIMgr.ins().closeTopLevel(),CommonFun.isCyberPuzzle(e[1]))return copyControl.guanqiaID<GameConst.AUTO_GUANQIA?(copyControl.setAutoPk(),void UIMgr.ins().close(this)):(portalControl.openAuto(),GuideControl.challengeBoss(),void UIMgr.ins().close(this));GuideControl.guidance(e[1],e[2]),UIMgr.ins().close(this)}}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(GuideUpgradeView.prototype,"GuideUpgradeView");var GuideView=function(t){function e(){var e=t.call(this)||this;return e.rect=new egret.Rectangle(1,1,1,1),e.infoGroup=new eui.Group,e.infoGroup.touchEnabled=!1,e.infoGroup.touchChildren=!1,e.addChild(e.infoGroup),e.mc=new GameMovieClip,e.infoGroup.addChild(e.mc),e.arrowGroup=new eui.Group,e.infoGroup.addChild(e.arrowGroup),e.arrow=new GuideArrow,e.arrowGroup.addChild(e.arrow),e}return __extends(e,t),e.prototype.show=function(e){t.prototype.show.call(this,e),this.arrow.update(),this.mc.playFile(PATH_EFF+"guideff",-1)},e.prototype.close=function(){t.prototype.close.call(this),this.arrow.close()},e}(GuideViewBase);__reflect(GuideView.prototype,"GuideView");var GuideSelectControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upNoGuide=function(){},__decorate([up(100)],e.prototype,"upNoGuide",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(GuideSelectControl.prototype,"GuideSelectControl");var GuideSelectView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.TIPS,e.skinName="GuideSelectViewSkin",e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.sureBtn,this.onTap),this.addEventTouchTap(this.grpNoGuide,this.onTap),this.addEventTouchTap(this.grpGuide,this.onTap),this.selectGuideImg.visible=!1,this.noSelectGuideImg.visible=!0,this.guideImg.visible=!1,this.guideImgGray.visible=!0,this.noGuideImg.visible=!0,this.noGuideImgGray.visible=!1},e.prototype.close=function(){this.removeEventTouchTap(this.sureBtn,this.onTap),this.removeEventTouchTap(this.grpNoGuide,this.onTap),this.removeEventTouchTap(this.grpGuide,this.onTap)},e.prototype.onTap=function(t){t.target==this.grpGuide||t.target.parent==this.grpGuide?(this.selectGuideImg.visible=!0,this.noSelectGuideImg.visible=!1,this.guideImg.visible=!0,this.guideImgGray.visible=!1,this.noGuideImg.visible=!1,this.noGuideImgGray.visible=!0):t.target==this.grpNoGuide||t.target.parent==this.grpNoGuide?(this.selectGuideImg.visible=!1,this.noSelectGuideImg.visible=!0,this.guideImg.visible=!1,this.guideImgGray.visible=!0,this.noGuideImg.visible=!0,this.noGuideImgGray.visible=!1):t.target==this.sureBtn&&(this.selectGuideImg.visible?(HookControl.ins().start(),UIMgr.ins().close(this)):(guideSelectControl.upNoGuide(),HookControl.ins().start(),UIMgr.ins().close(this)))},e}(BaseEuiView);__reflect(GuideSelectView.prototype,"GuideSelectView");var HelpControl=function(){function t(){}return t.openHelpWin=function(t){"string"==typeof t?UIMgr.ins().open(HelpView,t):UIMgr.ins().open(HelpView,this.getHelpStr(t))},t.getHelpStr=function(t){var e=DataCenter.ins().HelpInfoConfig[t];return Assert(e,"HelpInfoConfig do not have HelpID:"+t)?"":e.text},t}();__reflect(HelpControl.prototype,"HelpControl");var HelpView=function(t){function e(){var e=t.call(this)||this;return e.skinName="HelpViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchEnd(this,this.otherClose),this.textInfo.textFlow=TextUtils.generateTextFlow(t[0]),this.textInfo.height=this.textInfo.textHeight,this.background.height=this.textInfo.textHeight+60,this.anigroup.y=(StageUtils.ins().getHeight()-this.background.height)/2},e.prototype.otherClose=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(HelpView.prototype,"HelpView");var AshtarteSkillControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.triggerInterval={},e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkWarSpiritBubbleTrigger=function(){if(ashtarteControl.ZhanLingOpen())for(var t in DataCenter.ins().AshtarteBaseConfig){var e=DataCenter.ins().AshtarteBaseConfig[t],i=ashtarteControl.getZhanLingDataById(e.id);if(i)switch(e.talent){case 0:if(!DataCenter.ins().AshtarteLevelConfig[e.id][i.level])break;var o=DataCenter.ins().AshtarteLevelConfig[e.id][i.level].talentLevel,n=DataCenter.ins().AshtarteTalentConfig[e.talent][o];if(n&&GameControl.triggerValue(n.rate)){skillControl.dispatchShowSkillWord(n.showWords);for(var r=0;r<heroControl.subRolesLen;r++){var a=UnitMgr.ins().getMainRole(r);if(a){var s=BuffModel.createBuff(n.effId,a);a.addBuff(s)}}}break;case 8:if(o=ashtarteControl.getZhanLingDataByTalentLv(e.id),n=DataCenter.ins().AshtarteTalentConfig[e.talent][o],GameControl.triggerValue(n.rate))for(var r=0;r<heroControl.subRolesLen;r++){var a=UnitMgr.ins().getMainRole(r);if(a){var s=BuffModel.createBuff(n.effId,a);a.addBuff(s)}}}}},e.prototype.checkHJTrigger=function(t,e){if(ashtarteControl.ZhanLingOpen()){if(!t||!e[0])return;var i=(t.getHP(),t.infoModel.getAtt(2),0==t.infoModel.team&&t instanceof UnitRole);for(var o in DataCenter.ins().AshtarteBaseConfig){var n=DataCenter.ins().AshtarteBaseConfig[o],r=ashtarteControl.getZhanLingDataById(n.id);if(r)switch(n.talent){case 6:if(i){var a=ashtarteControl.getZhanLingDataByTalentLv(n.id),s=DataCenter.ins().AshtarteTalentConfig[n.talent][a];if(!s)break;for(var l=0;l<heroControl.subRolesLen;l++){var h=UnitMgr.ins().getMainRole(l);if(h)for(var u=function(e){if(!e.type||e.type==h.infoModel.job){var i=new SkillVo(e.id);c.intervalDoFun(t.infoModel.handle+e.id+n.talent,i.cd,function(){HookControl.ins().tryUseAshtarteSkill(t,e.id,!0)})}},c=this,p=0,d=s.passive;p<d.length;p++){var g=d[p];u(g)}}}break;case 7:var f=DataCenter.ins().AshtarteTalentConfig[n.talent][1];GameControl.triggerValue(f.rate)}}}},e.prototype.checkDieTrigger=function(t,e){if(ashtarteControl.ZhanLingOpen()){if(!t||!e[0])return;var i=(t.getHP(),t.infoModel.getAtt(2),0==t.infoModel.team&&t instanceof UnitRole);for(var o in DataCenter.ins().AshtarteBaseConfig){var n=DataCenter.ins().AshtarteBaseConfig[o],r=ashtarteControl.getZhanLingDataById(n.id);if(r){var a=ashtarteControl.getZhanLingDataByTalentLv(n.id),s=DataCenter.ins().AshtarteTalentConfig[n.talent][a];if(s)switch(n.talent){case 2:if(i)for(var l=0;l<heroControl.subRolesLen;l++){var h=UnitMgr.ins().getMainRole(l);if(h&&h.infoModel.handle!=t.infoModel.handle)for(var u=function(e){if(!e.type||e.type==h.infoModel.job){var i=new SkillVo(e.id);c.intervalDoFun(t.infoModel.handle+e.id+n.id,i.cd,function(){HookControl.ins().tryUseAshtarteSkill(t,e.id,!0)})}},c=this,p=0,d=s.passive;p<d.length;p++){var g=d[p];u(g)}}break;case 1:if(!i&&e[0]&&0==e[0].infoModel.team)for(var f=0,m=s.passive;f<m.length;f++){var g=m[f];if(!g.type||e[0].infoModel.job==g.type)for(var l=(new SkillVo(g.id),0);l<heroControl.subRolesLen;l++){var h=UnitMgr.ins().getMainRole(l);if(!h||h.infoModel.handle==e[0].infoModel.handle)break;var v=new SkillVo(g.id);if(v.tarEff&&v.tarEff.length>0)for(var y=0,C=v.tarEff;y<C.length;y++){var b=C[y],T=BuffModel.createBuff(b,h);h.addBuff(T)}}}break;case 3:if(!i&&e[0]&&0==e[0].infoModel.team&&1==e[0].infoModel.job)for(var w=function(e){if(!e.type||e.type==t.infoModel.job){var i=new SkillVo(e.id);S.intervalDoFun(t.infoModel.handle+e.id+n.id,i.cd,function(){HookControl.ins().tryUseAshtarteSkill(t,e.id,!0)})}},S=this,_=0,M=s.passive;_<M.length;_++){var g=M[_];w(g)}break;case 5:if(!i&&e[0]&&0==e[0].infoModel.team&&2==e[0].infoModel.job)for(var I=function(e){if(!e.type||e.type==t.infoModel.job){var i=new SkillVo(e.id);D.intervalDoFun(t.infoModel.handle+e.id+n.id,i.cd,function(){HookControl.ins().tryUseAshtarteSkill(t,e.id,!0)})}},D=this,E=0,k=s.passive;E<k.length;E++){var g=k[E];I(g)}}}}}},e.prototype.checkHPTrigger=function(t,e){if(ashtarteControl.ZhanLingOpen()){if(!t||!e)return;var i=t.getHP(),o=t.infoModel.getAtt(2),n=0==t.infoModel.team&&t instanceof UnitRole,r=function(e){var r=DataCenter.ins().AshtarteBaseConfig[e],s=ashtarteControl.getZhanLingDataById(r.id);if(!s)return"continue";switch(r.talent){case 4:break;case 9:if(n){var l=0,h=ashtarteControl.getZhanLingDataBySkill(l),u=ashtarteControl.getZhanLingDataById(l),c=0;for(var p in h)u.level>=h[p].open&&(1==h[p].id?c=DataCenter.ins().AshtarteSkillConfig[h[p].id].passive:4==h[p].id&&(c=DataCenter.ins().AshtarteSkillConfig[h[p].id].passivePlus));if(c>0){var d=new SkillVo(c);i/o<d.config.passive.p1/1e4&&a.intervalDoFun(t.infoModel.handle+c+l,d.cd,function(){HookControl.ins().tryUseAshtarteSkill(t,c,!0)})}}}},a=this;for(var s in DataCenter.ins().AshtarteBaseConfig)r(s)}},e.prototype.intervalDoFun=function(t,e,i){void 0==this.triggerInterval[t]&&(this.triggerInterval[t]=egret.getTimer()),egret.getTimer()-this.triggerInterval[t]>=0&&(this.triggerInterval[t]=egret.getTimer()+e,i())},e}(SingleClass);__reflect(AshtarteSkillControl.prototype,"AshtarteSkillControl");var HookControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.aiList={},e.zhanlingTime=0,e.zhanlingdelayTime=0,e.isFindDrop=!1,e.pStarting=!1,e.isLog=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.init=function(){this.stop(),this.skillCD={},this.attrCD={},this.attrValue={},this.inited=!0},e.prototype.start=function(){this.pStarting=!0,this.isStartAtk=!1,gameControl.dispatchHookStateChange(GameControl.HOOK_STATE_FIND_ENMENY),this.teamAction={},this.starting||(this.inited||this.init(),this.addHookTimer())},e.prototype.stop=function(){this.pStarting=!1,this.inited&&this.stopHookTimer(),this.skillCD={};for(var t in this.curSkill)this.curSkill[t]&&ObjectPool.push(this.curSkill[t]);this.curSkill={},this.curTarget={},this.lastTarget={},this.skillCastType={},this.skillTargetType={},this.hashHpObj={},this.attrCD={},this.attrValue={}},e.prototype.clearTarget=function(t){if(t&&t.infoModel){var e=t.infoModel.handle;delete this.skillCD[e];var i=this.curSkill[e];i&&ObjectPool.push(i),delete this.curSkill[e],delete this.curTarget[e],delete this.lastTarget[e],delete this.skillCastType[e],delete this.skillTargetType[e];for(var o in this.curTarget)this.curTarget[o]==t&&delete this.curTarget[o];for(var o in this.lastTarget)o+""==e+""&&delete this.lastTarget[o]}},e.prototype.clearAIList=function(){this.aiList={}},e.prototype.clear=function(){this.stop(),this.clearAIList(),this.isFindDrop=!1,TimerMgr.ins().removeAll(this)},e.prototype.destruct=function(){this.skillCD={},this.stop()},Object.defineProperty(e.prototype,"starting",{get:function(){return TimerMgr.ins().isExists(this.startHook,this)},enumerable:!0,configurable:!0}),e.prototype.add=function(t){this.aiList[t.infoModel.handle]=t},e.prototype.remove=function(t){delete this.aiList[t.infoModel.handle]},e.prototype.getAIList=function(){return this.aiList},e.prototype.startHook=function(){var t=this.aiList,i=UnitMgr.ins().getNoDieRole(),o={};for(var n in t){var r=t[n],a=void 0,s=r instanceof UnitRole,l=r.infoModel.handle,h=r.buffList,u=!1;for(var c in h){if(3==r.AI_STATE)break;var p=h[c];if((2==p.effConfig.type||1==p.effConfig.type)&&p.isExecute()){p.step++;var d=this.hramedDie(r,p.value);d&&(r.AI_STATE=3),this.showHram(d,1,r,p.source,p.value,LangMgr.getValueByKey("zsType12")+p.effConfig.id),p.step>=p.count&&r.removeBuff(p)}p.canRemove()?(p.isLift&&UnitMgr.ins().removeByHandle(l),r.removeBuff(p)):p.isCanotHit()&&(u=!0)}if(!u&&3!=r.AI_STATE&&!r.isHardStraight){if(0==r.infoModel.team&&skillControl.hejiLevel>0&&skillControl.hejiEnable&&r.infoModel instanceof RoleModel){if(i&&r.infoModel.handle==i.infoModel.handle){a=this.curTarget[l];var g=skillControl.getHejiSkillId();if(skillControl.fieldUse&&0!=g.id&&a&&0!=a.team&&3!=a.AI_STATE){var f=UnitMgr.ins().screeningTargetByPos(r,!1,g.affectCount,g.castRange,this.aiList);if(f.length){this.useSkill(r,a,g),AshtarteSkillControl.ins().checkHJTrigger(r,[a]),skillControl.fieldUse=!1;var m=DataCenter.ins().SkillsEffectsConfig[g.selfEff[0]]?DataCenter.ins().SkillsEffectsConfig[g.selfEff[0]]:null;if(m)for(var v=heroControl.subRolesLen,y=0;v>y;y++){var C=UnitMgr.ins().getMainRole(y);if(C){var p=ObjectPool.pop("BuffModel");p.effConfig=m,p.addTime=egret.getTimer(),p.endTime=p.addTime+m.duration,p.count=m.duration/m.interval>>0,p.step=0,p.source=C,C.addBuff(p),C.stopMove(),C!=i&&C.playAction(UnitAction.STAND),C.AI_STATE=0}}continue}}}}else if(2==r.infoModel.team&&focusAttackControl.canUse()){a=this.curTarget[l];var b=focusAttackControl.getMaster();if(a&&0==a.team&&b==r){var g=focusAttackControl.getSkillData();if(g&&3!=a.AI_STATE){var f=UnitMgr.ins().screeningTargetByPos(r,!1,g.affectCount,g.castRange,this.aiList);if(f.length){this.useSkill(r,a,g),focusAttackControl.useSuccess();var m=DataCenter.ins().SkillsEffectsConfig[g.selfEff[0]]?DataCenter.ins().SkillsEffectsConfig[g.selfEff[0]]:null;if(m)for(var T=focusAttackControl.getRoles(),v=T.length,w=0;v>w;w++){var C=UnitMgr.ins().getEntityByHandle(T[w].handle);if(C){var p=ObjectPool.pop("BuffModel");p.effConfig=m,p.addTime=egret.getTimer(),p.endTime=p.addTime+m.duration,p.count=m.duration/m.interval>>0,p.step=0,p.source=C,C.addBuff(p),C.stopMove(),C!=b&&C.playAction(UnitAction.STAND),C.AI_STATE=0}}continue}}}}if(t[l]){if(s){if(r.publicCD&&egret.getTimer()-r.publicCD<=(DataCenter.ins().ClientGlobalConfig.skillCd||800))continue}else if(r.publicCD&&egret.getTimer()-r.publicCD<=(DataCenter.ins().ClientGlobalConfig.skillCd||800))continue;if(!e.ins().isFindDrop||0!=r.team||!i||r.infoModel.handle!=i.infoModel.handle)switch(r.AI_STATE){case 0:this.screeningSkill(l);var S=!1,_=!1;if(this.curSkill[l]||(S=!0),!S&&this.checkCanScreeningTarget(r,this.curSkill[l],this.curTarget[l])&&(2==r.team?this.screeningTarget(r,9):this.screeningTarget(r)),0==r.team&&r!=i&&i&&MathUtils.getDistance(r.x,r.y,i.x,i.y)>250){var M=this.curTarget[i.infoModel.handle];M&&3!=M.AI_STATE&&this.curSkill[l]&&2==this.curSkill[l].targetType&&0!=M.team?this.curTarget[l]=M:_=!0}if(S||_){if(0==r.team&&r!=i&&i){var I=i;if(r.infoModel.masterHandle){var D=UnitMgr.ins().getEntityByHandle(r.infoModel.masterHandle);D&&(I=D)}var E=UnitMgr.ins().getMasterList(r.infoModel.masterHandle),k=[1,-1,0];E&&2==E.length&&(k=[0]);var P=o[r.infoModel.masterHandle]||0,x=DirUtils.getGridByDir(I.dir+(k[P]||0),MapControl.CELL_SIZE);P+=1,o[r.infoModel.masterHandle]=P,MapControl.moveEntity(r,I.x+x.x,I.y+x.y)}continue}if(!this.curTarget[l])continue;this.tryUseSkill(r)?r.AI_STATE=2:(0==r.team||2==r.team||5==r.team||this.teamAction[r.team])&&(MapControl.moveEntity(r,this.curTarget[l].x,this.curTarget[l].y),r.AI_STATE=1);break;case 1:if(a=this.curTarget[l],0==r.team&&(copyControl.canChallengGuanQia=!0),!a||3==a.AI_STATE){r.stopMove(),r.playAction(UnitAction.STAND),r.AI_STATE=0,delete this.curTarget[l];continue}if(5==r.team){var R=confrontControl.wildPersonList[r.infoModel.masterHandle];if(!R)continue;var B=confrontControl.countKillNumByMarster(r.infoModel.masterHandle),L=MathUtils.getDistance(r.x,r.y,R.backX,R.backY);if(R&&1==R.actionType&&B>=R.killNum){10>L?(UnitMgr.ins().removeByHandle(r.infoModel.masterHandle),confrontControl.RunAwary(r.infoModel.masterHandle),confrontControl.upCleanWildPeople(R.index)):MapControl.moveEntity(r,R.backX,R.backY);continue}}this.tryUseSkill(r)&&(r.stopMove(),r.AI_STATE=2),r.action==UnitAction.STAND&&(r.AI_STATE=0);break;case 2:if(this.isStartAtk||gameControl.dispatchHookStateChange(GameControl.HOOK_STATE_HOOK),this.isStartAtk=!0,a=this.curTarget[l],!a||3==a.AI_STATE){r.AI_STATE=0,delete this.curTarget[l];continue}if(this.teamAction[a.team]=!0,r.atking)continue;var g=this.curSkill[l];if(!g)continue;this.skillCD[l][g.id]=egret.getTimer(),this.skillCastType[l]=g.castType,this.skillTargetType[l]=g.targetType,r.atking=!0,0==r.team&&(copyControl.canChallengGuanQia=!1),r.publicCD=egret.getTimer(),GameControl.skyBallCheck(r),this.useSkill(r,a,g),delete this.curSkill[l];break;case 4:var U=r.infoModel.configID,m=copyControl.guanqiaMonster[U];r.infoModel.isWander&&m.attrange?(this.screeningTarget(r,m.attrange),this.curTarget[r.infoModel.handle]?r.AI_STATE=0:r.startPatrol()):r.startPatrol()}}}}},e.prototype.checkCanScreeningTarget=function(t,e,i){if(!i||!i.parent||3==i.AI_STATE)return!0;var o=t.infoModel.handle;return void 0==this.skillCastType[o]&&void 0==this.skillTargetType[o]?!0:this.skillCastType[o]!=e.castType||this.skillTargetType[o]!=e.targetType?!0:!1},e.prototype.useSkill=function(t,e,i){var o=this,n=skillControl.isHejiSkill(i.configID),r=i.config.passive;if(r&&8==r.cond)return void(r.p1&&0==t.team&&skillControl.setHejiCD(-1,r.p1));var a,s,l,h,u,c=i.selfEff?DataCenter.ins().SkillsEffectsConfig[i.selfEff[0]]:null,p=3==i.castType?t:e,d=0,g=!1,f=t.infoModel;0==t.team&&(s=artifactControl.getReviseBySkill(i.id),s&&s.crit&&(d=s.crit),u=godWeaponControl.getReviseBySkill(i.id),u&&(l=u[0]),l&&(d=l.crit),h=SkillVo.reviseDp(i.id+i.lv,t.infoModel.index),h&&(d=h.crit||0));var m=i.affectCount;if(s&&s.affectCount&&(m+=s.affectCount),l&&l.affectCount&&(m+=l.affectCount),h&&h.affectCount&&(m+=h.affectCount),4==i.castType){a=UnitMgr.ins().screeningTargetByPos(t,!0,0,Number.MAX_VALUE,this.aiList);for(var v=0;v<a.length;v++)if(a[v].isCanAddBlood){a[0]=a[v];break}}else a=2!=i.castType&&2==i.targetType?UnitMgr.ins().screeningTargetByPos(p,!1,m,i.affectRange,this.aiList):m>1?UnitMgr.ins().screeningTargetByPos(p,p.team==e.team,m,i.affectRange,this.aiList):[e],0==a.length&&(a=[e]);i.preId&&DataCenter.ins().FlameMarkConfig.skillId.indexOf(i.preId)>=0&&(g=!0);var y=!1,C=a.length=Math.min(a.length,m),b=[];this._isTogetherCrit=!1;var T=!1;n&&(n&&GameControl.triggerExAttr(t,70)&&(this._isTogetherCrit=!0),f.getExAtt(83)&&(T=!0));for(var w=GameControl.calBuffAttribute(t),S=0;C>S;S++){var _=a[S],M=_.infoModel,I=!1,D=0==S;if(_.team!=t.team){var E=void 0;(GameControl.triggerAttr(t,13)||90005==i.id)&&(E=ObjectPool.pop("BuffModel"),E.effConfig=DataCenter.ins().SkillsEffectsConfig[51001],E.value=f.getAtt(15),E.addTime=egret.getTimer(),E.endTime=E.addTime+E.value,E.source=t,_.addBuff(E),_.stopMove(),_.AI_STATE=0),GameControl.triggerExAttr(t,5)&&(E=ObjectPool.pop("BuffModel"),E.effConfig=DataCenter.ins().SkillsEffectsConfig[52001],E.addTime=egret.getTimer(),E.endTime=E.effConfig.args.d?f.attributeExData[7]:E.effConfig.duration,E.source=t,_.addBuff(E),t.addBubble(3),I=!0),GameControl.triggerExAttr(t,12)
}var k=!1,P=!1,x=!1,R=!1,B=!1,L=!1,U=!1,A=void 0,N=void 0,G=0,V=!1,O=i&&6==i.calcType,F=!1;if(3!=i.calcType&&0!=i.calcType&&(R=GameControl.triggerMiss(t,_)),0==i.calcType)G=0;else if(R)G=0;else{if(G=this.damageBaseCalculation(t,_,i),3!=i.calcType){T=!1,x=GameControl.triggerExAttr(t,28),x&&(G*=f.getExAtt(29)/1e4,G+=f.getExAtt(30),t.addBubble(21)),k=GameControl.triggerCrit(t,_,d);var K=t.hasBuff(SkillConst.EFF_SKY_BALL);K&&(t.addBubble(6),k=!0);var H=0,j=1;if(k){y=!0;var W=f.getAtt(19);l&&l.critDamage&&(W+=l.critDamage);var q=f.getExAtt(54);M.getAtt(0)/M.getAtt(2)<=q/1e4&&(W+=f.getExAtt(55)),j+=W/1e4,H+=f.getAtt(17)}var Y={};Y[67]=GameControl.calculateRealAttribute(t,67,t),U=GameControl.triggerAttr(t,67,Y),U&&(j+=.5+(f.getAtt(68)-M.getAtt(69))/1e4),Y={},Y[79]=GameControl.calculateRealAttribute(t,79,t),A=this.tryTriggerHungu(t),A&&(j+=f.getAtt(80)/1e4),N=this.tryTriggerHeart(t),N&&(j+=f.getAtt(83)/1e4,H+=f.getAtt(82)),V=GameControl.triggerExAttr(t,66),V&&(j+=f.getExAtt(67)/1e4,this.triggerMaster(t,e)),L=GameControl.triggerAttr(t,63),L&&(G+=f.getAtt(64)),F=GameControl.triggerExAttr(t,81,w.exAttr),F&&(j+=f.getExAtt(82)/1e4),G=G*j+H,I&&(G*=1+f.attributeExData[6]/1e4),D||2!=i.targetType||(G*=1==M.type?i.herdPlayerRate/100:i.herdMonRate/100),t.isMy&&1==f.type&&1==e.infoModel.type&&confrontControl.isEncounter()&&confrontFightControl.getIsWeiShe(t.isMy)&&(B=!0),G=this.damageBuff(t,_,G),G+=f.getAtt(57)*(1+f.getAtt(58)/1e4-M.getAtt(59)/1e4),G*=1-f.getAtt(27)/1e4}G>>=0,t.team==_.team&&G>0&&(G=0)}_ instanceof UnitRole||4==_.AI_STATE&&(_.stopMove(),_.playAction(UnitAction.STAND),_.AI_STATE=0);var X=this.hramedDie(_,G);X&&(_.AI_STATE=3,AshtarteSkillControl.ins().checkDieTrigger(t,[_]));var J=0;if(0==t.team&&(n?J=16:R?J=4:(P&&(J|=8),k&&(J|=2),O&&(J|=1)),B&&(J|=64),L&&(J|=256),U&&(J|=512),V&&(J|=1024),this._isTogetherCrit&&(J|=2048),F&&(J|=4096),T&&(J|=8192)),t.team!=_.team&&5==i.calcType){for(var z=G/5>>0,Q=z*MathUtils.limit(0,.05)>>0,$=z*MathUtils.limit(0,.05)>>0,Z=[z-Q,z+Q,z-$,z+$,G-4*z],te=[],ee=0;ee<Z.length;ee++)te.push({isDie:X,damageType:32,ttarget:_,hramValue:Z[ee]});b.push(te)}else if(b.push([{isDie:X,damageType:J,ttarget:_,hramValue:G}]),t.team!=_.team&&GameControl.triggerAttr(t,54)){X=this.hramedDie(_,G>>1),t.addBubble(20);var ie=b[b.length-1];ie.push({isDie:X,damageType:32,ttarget:_,hramValue:G>>1})}_.myKill=_.myKill||t.isMy,(t.isMy||2==t.team)&&(_.showBlood(!0),_.showName(!0)),_.isMy&&(t.showBlood(!0),t.showName(!0))}this._isTogetherCrit=!1;var oe=MapControl.copyType,ne=MapControl.copyId,re=0;gameControl.playSkillEff(i,t,a,function(n){if(MapControl.copyType==oe&&ne==MapControl.copyId){var r=0;for(var d in a){var f=a[d],m=(f.infoModel,b[d][b[d].length-1].isDie);p==f&&(r=b[d][0].damageType);for(var v=0,y=0;y<b[d].length;y++){var C=b[d][y];v+=C.hramValue,o.showHram(C.isDie,C.damageType,f,t,C.hramValue,i.name)}if(0==t.team&&2==f.team&&0!=confrontFightControl.willEntityFightTeam){confrontFightControl.willEntityFightTeam=0;for(var T=UnitMgr.ins().getEntityByTeam(2),w=0,S=T;w<S.length;w++){var _=S[w];o.curTarget[_.infoModel.handle]=null,o.lastTarget[_.infoModel.handle]=null}}if(f.shakeIt(),t.isMy&&t instanceof UnitRole&&!f.isMy&&(o.tryExtHarm(t,f),o.tryExtSummoner(t,f,i)),!m){var M=i.tarEff;if(p!=f&&1==f.infoModel.type&&(M=i.otarEff||M),h&&h.targetEff)for(var I=0;h.targetEff&&I<h.targetEff.length;I++){var D=o.getArgs(h.targetEff[I],s,l,h),E=BuffModel.createBuff(h.targetEff[I],t,D);f.addBuff(E)}for(var k=0;M&&k<M.length;k++){var D=o.getArgs(M[k],s,l,h),E=BuffModel.createBuff(M[k],t,D);f.addBuff(E)}s&&o.addTargetReviseSkillEffect(f,t,s),l&&o.addTargetReviseSkillEffect(f,t,l),u&&u[1]&&o.addTargetReviseSkillEffect(f,t,u[1]),h&&o.addTargetReviseSkillEffect(f,t,h),f instanceof UnitRole&&o.tryUseWingSkill(f,i,!0),o.tryUsePassiveSkill(t,f,!0,b[d][0].damageType),o.tryUseWeaponSkill(f,i,!0),o.tryTriggerMijiBuqu(f),t instanceof UnitRole&&t.isMy&&!f.isMy&&o.tryThunderSkill(t,f,i)}o.showBuffHarm(t,f,i,v)}if(h&&h.selfEff)for(var k=0;h.selfEff&&k<h.selfEff.length;k++){var D=o.getArgs(h.selfEff[k],s,l,h),E=BuffModel.createBuff(h.selfEff[k],t,D);t.addBuff(E)}if(c&&i.selfEff)for(var k=0;k<i.selfEff.length;k++){var D=o.getArgs(i.selfEff[k],s,l,h),E=BuffModel.createBuff(i.selfEff[k],t,D);t.addBuff(E)}if(s&&o.addSelfReviseSkillEffect(t,s),l&&o.addSelfReviseSkillEffect(t,l),u&&u[1]&&o.addSelfReviseSkillEffect(t,u[1]),h&&o.addSelfReviseSkillEffect(t,h),t instanceof UnitRole&&o.tryUseWingSkill(t,i,!1),o.tryUsePassiveSkill(t,p,!1,r),o.tryTriggerHeirloomSkill(t,a,b),8192==(8192&r)){var P=t.infoModel.getExAtt(83);P&&DataCenter.ins().SkillsEffectsConfig[P]&&p.addBuff(BuffModel.createBuff(P,t))}if(g&&o.tryUseYlPassiveSkill(t,p,i),(80002==i.configID||crazyDogControl.isSummonerSkill(i.configID))&&o.petTryUsePassiveSkill(t,!1),i.otherSkills){var x=i.otherSkills.concat();if(!x[re])return;var R=new SkillVo(x[re]);return R.preId=i.configID,o.useSkill(t,e,R),void(re+=1)}}}),!SoundUtils.PLAY_OPEN_VIEW&&i.sound&&0==t.team&&SoundUtils.ins().playEffect(i.sound),t.AI_STATE=0,t.atking=!1,y&&f.getExAtt(59)&&this.checkTriggerAttr(t,1,60,1),this.repel(t,e,i)},e.prototype.tryExtHarm=function(t,e){var i=0;if(t.extHurmBuff)for(var o in t.extHurmBuff){var n=t.extHurmBuff[o];i+=n.a*t.infoModel.getAtt(n.b)+n.c}if(i){var r=this.hramedDie(e,i);this.showHram(r,32,e,t,i)}},e.prototype.tryExtSummoner=function(t,e,i){if(i.config.ex_summoner)for(var o=i.config.ex_summoner,n=0;n<o.length;n++){var r=o[n],a=copyControl.createModel(DataCenter.ins().MonstersConfig[r]);a.x=e.x+100*Math.random(),a.y=e.y+100*Math.random(),a.masterHandle=t.infoModel.handle,a.setAtt(9,t.infoModel.getAtt(9)),a.isMy=a.checkHandleIsMy(a.masterHandle),a.fixSkills=[r];var s=gameControl.createEntityByModel(a,t.team);if(i.config.esEff)for(var l=i.config.esEff,h=0;h<l.length;h++){var u=l[h],c=BuffModel.createBuff(u,e);c.isLift=!0,s.addBuff(c)}}},e.prototype.repel=function(t,e,i){if(i&&i.repelDistance){e.stopMove(),e.playAction(UnitAction.STAND);var o=e.infoModel.handle;delete this.curTarget[o];var n=MathUtils.getAngle(MathUtils.getRadian2(t.x,t.y,e.x,e.y)),r=MathUtils.getDirMove(n,i.repelDistance);r.x=e.x+r.x,r.y=e.y+r.y;var a=Bresenham.canThrough(MapControl.aStar,MapControl.point2Grip(e.x),MapControl.point2Grip(e.y),MapControl.point2Grip(r.x),MapControl.point2Grip(r.y));0==a[0]&&(a[1]>3&&debug.error("Check if there are any exceptions by passing more than 3 cells"+a[2]+","+a[3],r),MapControl.point2Grip(e.x)==a[2]&&MapControl.point2Grip(e.y)==a[3]?(r.x=e.x,r.y=e.y):(r.x=MapControl.grip2Point(a[2]),r.y=MapControl.grip2Point(a[3]))),r.x=Math.max(Math.min(r.x,MapControl.MAX_WIDTH),0),r.y=Math.max(Math.min(r.y,MapControl.MAX_HEIGHT),0);var s=r.x-e.x,l=r.y-e.y,h=Math.sqrt(s*s+l*l)/(t.moveSpeed/1e3),u=DataCenter.ins().SkillsEffectsConfig[i.tarEff[0]].duration;if(e.addHardStraight(u),h>0){var c=egret.Tween.get(e.moveTweenObj);c.to({x:r.x,y:r.y},h)}if(1==i.teleport&&(i&&""!=i.actionType&&t.playAction(i.actionType),t.stopMove(),h>0)){var c=egret.Tween.get(t.moveTweenObj);c.to({x:t.x-(e.x-r.x),y:t.y-(e.y-r.y)},h).call(function(){t.stopMove(),t.resetStand()}),t.addHardStraight(h)}}},e.prototype.checkTriggerAttr=function(t,e,i,o,n){if(void 0===o&&(o=1),void 0===n&&(n=0),Math.random()<o){var r=t.infoModel,a=r.handle,s=this.attrCD[a]=this.attrCD[a]||{},l=e+"_"+i,h=n?n:0==e?r.getAtt(i):r.getExAtt(i),u=s[l]||0,c=egret.getTimer();if(u&&h>c-u)return;s[l]=c;var p=this.attrValue[a]=this.attrValue[a]||{};p[l]=1}},e.prototype.isTriggerAttr=function(t,e,i,o){void 0===o&&(o=0);var n=t.infoModel,r=this.attrValue[n.handle];if(r){var a=e+"_"+i,s=r[a];return r[a]=o,s}return 0},e.prototype.addSelfReviseSkillEffect=function(t,e){if(e.selfEff)for(var i in e.selfEff){var o=DataCenter.ins().SkillsEffectsConfig[e.selfEff[i]];if(o){var n=this.getArgs(e.selfEff[i],e,null),r=BuffModel.createBuff(e.selfEff[i],t,n);t.addBuff(r)}}},e.prototype.addTargetReviseSkillEffect=function(t,e,i){if(i.targetEff)for(var o in i.targetEff){var n=DataCenter.ins().SkillsEffectsConfig[i.targetEff[o]];if(n){var r=this.getArgs(i.targetEff[o],i,null),a=BuffModel.createBuff(i.targetEff[o],e,r);t.addBuff(a)}}},e.prototype.tryUsePassiveSkill=function(t,e,i,o){void 0===i&&(i=!1),void 0===o&&(o=0);var n=i?e:t,r=i?t:e;if(n instanceof UnitRole){var a=this.getCanUseSkillList(n,!1);if(!a||0==a.length)return;for(var s=[],l=0,h=a;l<h.length;l++){var u=h[l],c=u.config.passive;switch(c.cond){case 0:i||GameControl.triggerValue(c.rate)&&s.push(u);break;case 1:i&&GameControl.triggerValue(c.rate)&&s.push(u);break;case 2:i||2!=(2&o)||GameControl.triggerValue(c.rate)&&s.push(u);break;case 3:i&&2==(2&o)&&GameControl.triggerValue(c.rate)&&s.push(u);case 4:n.infoModel.getAtt(0)/n.infoModel.getAtt(2)<=c.p1/1e4&&GameControl.triggerValue(c.rate)&&s.push(u);break;case 8:i||2!=(16&o)||GameControl.triggerValue(c.rate)&&s.push(u)}}if(!s.length)return;for(var p=0,d=s;p<d.length;p++){var g=d[p],f=void 0;if(2!=g.targetType)f=n;else if(r&&r.infoModel.getAtt(0)>0)f=r;else{var m=UnitMgr.ins().screeningTargetByPos(n,!1,0,g.affectRange,this.aiList);f=m&&m[0]}if(f){var v=n.infoModel.handle;this.skillCD[v]=this.skillCD[v]||{},this.skillCD[v][g.id]=egret.getTimer(),this.useSkill(n,f,g)}}}},e.prototype.tryUseAshtarteSkill=function(t,e,i){var o=ObjectPool.pop("SkillVo");o.configID=e;var n;if(2!=o.targetType)n=t;else{var r=UnitMgr.ins().screeningTargetByPos(t,!1,0,o.affectRange,this.aiList);n=r[0]}if(n){var a=t.infoModel.handle;this.skillCD[a]=this.skillCD[a]||{},this.skillCD[a][o.id]=egret.getTimer(),this.useSkill(t,n,o)}},e.prototype.tryUseWingSkill=function(t,e,i){var o=this.checkWingEffect(t,e,i);if(o.length)for(var n=0,r=o;n<r.length;n++){var a=r[n],s=ObjectPool.pop("SkillVo");s.configID=a;var l=void 0;if(2!=s.targetType)l=t;else{var h=UnitMgr.ins().screeningTargetByPos(t,!1,0,s.affectRange,this.aiList);l=h[0]}if(l){var u=t.infoModel.handle;this.skillCD[u]=this.skillCD[u]||{},this.skillCD[u][s.id]=egret.getTimer(),this.useSkill(t,l,s)}}},e.prototype.checkWingEffect=function(t,e,i){void 0===i&&(i=!1);var o=t.infoModel.wingSkillData,n=[];if(e.isPassive)return n;for(var r=this.skillCD[t.infoModel.handle],a=0,s=o;a<s.length;a++){var l=s[a],h=ObjectPool.pop("SkillVo");h.configID=l,r&&r[h.id]&&egret.getTimer()-r[h.id]<h.cd||(0!=h.config.passive.cond||i?1==h.config.passive.cond&&i&&GameControl.triggerValue(h.config.passive.rate)&&n.push(l):GameControl.triggerValue(h.config.passive.rate)&&n.push(l))}return n},e.prototype.tryUseYlPassiveSkill=function(t,e,i){var o=t.infoModel;if(o.lyMarkLv&&o.lyMarkSkills)for(var n=0;n<o.lyMarkSkills.length;n++){var r=o.lyMarkSkills[n]||0;if(r){var a=DataCenter.ins().FlameMarkEffectConfig[n+1][r];if(a.effId){var s=DataCenter.ins().SkillsEffectsConfig[a.effId];if(s.probabilityBuff&&GameControl.triggerValue(s.probabilityBuff)){var l=BuffModel.createBuff(a.effId,t);e.addBuff(l)}}if(a.selfEffId){var s=DataCenter.ins().SkillsEffectsConfig[a.selfEffId];if(s.probabilityBuff&&GameControl.triggerValue(s.probabilityBuff)){var l=BuffModel.createBuff(a.selfEffId,t);t.addBuff(l)}}}}},e.prototype.tryTriggerHeirloomSkill=function(t,e,i){var o=null,n=80004,r=6666601,a=-1,s=0,l=t.infoModel.handle;for(var h in e){var u=e[h],c=u.infoModel.handle;if(t.team!=u.team&&(-1==a&&(a=0,(!this.skillCD[l]||!this.skillCD[l][r]||egret.getTimer()-this.skillCD[l][r]>=5e3)&&GameControl.triggerAttr(t,32)&&(a=1,this.skillCD[l]=this.skillCD[l]||{},this.skillCD[l][r]=egret.getTimer())),u instanceof UnitRole&&!t.hasBuff(n)&&!o&&(!this.skillCD[c]||!this.skillCD[c][n]||egret.getTimer()-this.skillCD[c][n]>=5e3)&&GameControl.triggerAttr(u,35))){var p=u.infoModel.heirloom.getInfoBySolt(2).lv;if(p>0){var d=this.getEffectIdsByGroup(n),g=d[p-1];o=ObjectPool.pop("BuffModel"),o.effConfig=DataCenter.ins().SkillsEffectsConfig[g],o.value=o.effConfig.args.a,o.addTime=egret.getTimer(),o.endTime=o.addTime+o.effConfig.duration,o.source=u,t.addBuff(o),u.addBubble(13),this.skillCD[c]=this.skillCD[c]||{},this.skillCD[c][n]=egret.getTimer()}}}if(1==a){t.addBubble(14);for(var f=0,m=i;f<m.length;f++){var v=m[f];0==s&&(s=Math.floor(t.infoModel.getAtt(33)/1e4*v[0].hramValue))}this.hramedDie(t,-s),this.showHram(!1,1,t,t,-s)}},e.prototype.tryUseWeaponSkill=function(t,e,i){if(3!=t.AI_STATE&&!(t.getRealHp()<=0)&&i){var o=GameControl.triggerAttr(t,39);if(o){t.addBubble(16);var n=t.infoModel.getAtt(40);this.hramedDie(t,-n),this.showHram(!1,1,t,t,-n)}if(t.infoModel.getAtt(42)&&t.infoModel.getAtt(0)/t.infoModel.getAtt(2)<t.infoModel.getAtt(42)/1e4){var r=this.skillCD[t.infoModel.handle],a=DataCenter.ins().SkillsEffectsConfig[t.infoModel.getExAtt(40)];if(!a)return;if(r&&r[40]&&egret.getTimer()-r[40]<t.infoModel.getExAtt(41))return;t.addBubble(18);var s=ObjectPool.pop("BuffModel");s.effConfig=a,s.value=s.effConfig.args.a,s.addTime=egret.getTimer(),s.endTime=s.addTime+s.effConfig.duration,s.source=t,t.addBuff(s),this.skillCD[t.infoModel.handle]=this.skillCD[t.infoModel.handle]||{},this.skillCD[t.infoModel.handle][40]=egret.getTimer()}}},e.prototype.tryTriggerMijiBuqu=function(t){var e=t.infoModel;if(e.getExAtt(63)&&e.getAtt(0)/e.getAtt(2)*1e4<e.getExAtt(62)){this.checkTriggerAttr(t,1,61,1);var i=this.isTriggerAttr(t,1,61);if(i){var o=BuffModel.createBuff(e.getExAtt(63),t);t.addBuff(o),t.addBubble(23)}}},e.prototype.tryTriggerHungu=function(t){var e=t.infoModel,i=e.getAtt(79);if(i){this.checkTriggerAttr(t,0,81,i/1e4);var o=this.isTriggerAttr(t,0,81);return o&&BubbleControl.ins().playBubbleEffect(24),o}},e.prototype.tryTriggerHeart=function(t){var e=t.infoModel;if(e.getAtt(84)){var i=1e3,o=e.job;switch(o){case 1:i*=15;break;case 2:i*=17;break;case 3:i*=19}this.checkTriggerAttr(t,0,84,1,i);var n=this.isTriggerAttr(t,0,84);return n&&BubbleControl.ins().playBubbleEffect(25),n}},e.prototype.triggerMaster=function(t,e){var i=t.infoModel.handle,o=t.infoModel;this.skillCD[i]=this.skillCD[i]||{};var n=o.getExAtt(68);if(!(this.skillCD[i][n]&&egret.getTimer()-this.skillCD[i][n]<o.getExAtt(69))){var r=DataCenter.ins().SkillsEffectsConfig[n];if(r){var a=ObjectPool.pop("BuffModel");a.effConfig=r,a.value=a.effConfig.args.a,a.addTime=egret.getTimer(),a.endTime=a.addTime+a.effConfig.duration,a.source=t,e.addBuff(a),this.skillCD[i][n]=egret.getTimer(),t.addBubble(26)}}},e.prototype.tryThunderSkill=function(t,e,i){if(thunderControl.isThunderSkill(i.configID))return!1;var o=thunderControl.getCurThunderSkillLv(t.infoModel);if(o>0){var n=thunderControl.getThunderSuitLevelConfig(0,2,o),r=n.skillId[t.infoModel.job-1],a=DataCenter.ins().SkillsConfig[r],s=new SkillVo(r),l=t.infoModel.handle;if(this.skillCD[l]=this.skillCD[l]||{},this.skillCD[l][s.id]&&egret.getTimer()-this.skillCD[l][s.id]<s.cd)return!1;if(GameControl.triggerValue(a.passive.rate))return this.skillCD[l][s.id]=egret.getTimer(),this.useSkill(t,e,s),!0}return!1},e.prototype.petTryUsePassiveSkill=function(t,e){void 0===e&&(e=!0);var i=t.infoModel.masterHandle,o=UnitMgr.ins().getEntityByHandle(i);if(o&&o.infoModel&&o.infoModel.getExAtt(47)){for(var n=36e3+o.infoModel.getExAtt(47),r=[new SkillVo(n)],a=[],s=0,l=r;s<l.length;s++){var h=l[s];0!=h.config.passive.cond||e?1==h.config.passive.cond&&e&&GameControl.triggerValue(h.config.passive.rate)&&a.push(h):GameControl.triggerValue(h.config.passive.rate)&&a.push(h)}if(!a.length)return;for(var u=0,c=a;u<c.length;u++){var p=c[u],d=void 0;if(2!=p.targetType)d=t;else{var g=UnitMgr.ins().screeningTargetByPos(t,!1,0,p.affectRange,this.aiList);d=g[0]}if(d){var f=t.infoModel.handle;this.skillCD[f]=this.skillCD[f]||{},this.skillCD[f][p.id]=egret.getTimer(),this.useSkill(t,d,p)}}}},e.prototype.showBuffHarm=function(t,e,i,o){var n=GameControl.calculateRealAttribute(e,70,t);n>0&&(n=-n,this.hramedDie(t,n),t instanceof UnitRole&&this.showHram(!1,0,t,t,n));var r=GameControl.calculateRealAttribute(t,71,e);if(r){var a=Math.floor(o*r/1e4),s=this.hramedDie(t,a);this.showHram(s,0,t,e,a)}},e.prototype.hramedDie=function(t,e){var i=t.infoModel.getAtt(0)-e;if(0>e){var o=t.infoModel.getAtt(2);i=i>o?o:i}return t.infoModel.setAtt(0,i),t.infoModel.getAtt(0)<=0?!0:!1},e.prototype.showHram=function(t,i,o,n,r,a){var s=this;if(void 0===a&&(a=""),o&&o.infoModel)if(this.trace(o.infoModel.name+" "+o.team+" "+LangMgr.getValueByKey("zsType13",o.infoModel.handle,r,o.getHP(),a)),o.hram(r),gameControl.dispatchEntityHpChange(o,n,i,r),t){if(o.removeAllFilters(),o.stopMove(),o.playAction(UnitAction.HIT),o.myKill&&!(o instanceof UnitRole)){var l=!1,h=taskControl.taskTrace;if(h){var u=taskControl.getAchieveConfById(h.id);u&&u.type==e.SEND_TASK_TYPE&&(copyControl.upKillMonster(o.infoModel.configID),l=!0);var c=spokesPersonTaskControl.getCfg();l||!c||68!=c.type||spokesPersonTaskControl.getTaskPro()||copyControl.upKillMonster(o.infoModel.configID)}}if(!o.hasBuff(52001)&&GameControl.triggerExAttr(o,3)){o.AI_STATE=0,o.removeAllBuff();var p=o.infoModel.getAtt(2)*o.infoModel.attributeExData[4]/1e4;o.infoModel.setAtt(0,p),o.hram(-p),this.trace(LangMgr.getValueByKey("zsType14",o.getHP())),o.addBubble(7)}else if(this.trace(LangMgr.getValueByKey("zsType15",o.infoModel.handle)),n&&0==n.team&&this.checkPlayDieSound(o),TimerMgr.ins().doTimer(500,1,function(){if(s.trace(LangMgr.getValueByKey("zsType16",o.infoModel.handle)),UnitMgr.ins().removeByHandle(o.infoModel.handle,!1,o.myKill&&2==o.infoModel.type),1==o.infoModel.type){var t=UnitMgr.ins().getEntityBymasterhHandle(o.infoModel.masterHandle);if(!t){var e=UnitMgr.ins().getMasterList(o.infoModel.masterHandle);if(e&&e.length)for(var i=0,r=e;i<r.length;i++){var a=r[i];UnitMgr.ins().removeByHandle(a.infoModel.handle)}}}if(delete s.hashHpObj[o.hashCode],o.onDead(function(){o.deadDelay(),s.clearTarget(o);var t=egret.Tween.get(o.dieTweenObj);t.wait(1e3).to({alpha:0},1e3).call(function(){o instanceof UnitMonster&&!(o instanceof UnitRole)?o.destruct():DisplayUtils.removeFromParent(o)})}),1==o.team){var l=UnitMgr.ins().getTeamCount(1);l<=copyControl.rCount&&gameControl.createGuanqiaMonster(!1)}s.checkAIend(n,o)},this),1==o.team){var d=UnitMgr.ins().getTeamCount(1);if(d<=copyControl.rCount&&gameControl.createGuanqiaMonster(!1),0==n.team){var g=UnitMgr.ins().getNoDieRole(),f=o.infoModel.configID==copyControl.eliteMonsterId;if(g&&(f||n.infoModel.handle==g.infoModel.handle)&&0==MapControl.copyId){var m=Math.floor(o.x/MapControl.CELL_SIZE),v=Math.floor(o.y/MapControl.CELL_SIZE),y=void 0;if(f?y=copyControl.eliteRewards.shift():(y=copyControl.getRewardsPop(),copyControl.rewards=[]),y&&y.length>0){for(var C=0;C<y.length&&8>C;C++)confrontControl.dispatchCreateDrop(m,v,y[C].drops[0]);var b=function(){copyControl.upGetReward(f)};DropControl.addCompleteFunc(b,this),DropControl.start()}copyControl.exp>0&&(!y||0==y.length)&&(copyControl.upGetReward(f),copyControl.exp=0)}var T=UnitMgr.ins().screeningTargetByPos(n,!1,0,Number.MAX_VALUE,this.aiList);if(!T||0==T.length)for(var w=UnitMgr.ins().getEntityByTeam(0),S=0,_=w;S<_.length;S++){var M=_[S];M.playAction(UnitAction.STAND)}}for(var I in this.curTarget)if(this.curTarget[I]==o){var M=UnitMgr.ins().getEntityByHandle(I);M&&M.infoModel&&++M.infoModel.killNum;break}if(5==n.team){var D=confrontControl.wildPersonList[n.infoModel.masterHandle],E=confrontControl.countKillNumByMarster(n.infoModel.masterHandle);D&&1==D.actionType&&E>=D.killNum&&MapControl.moveEntity(n,D.backX,D.backY)}}}else 3!=o.AI_STATE&&r>0,AshtarteSkillControl.ins().checkHPTrigger(o,n)},e.prototype.checkAIend=function(t,e){if(t){var i=UnitMgr.ins().getTeamCount(e.team);if(this.trace(LangMgr.getValueByKey("shengyunum")+t.infoModel.name+" "+t.team+" "+e.infoModel.name+" "+e.team+" "+i),!i){switch(t.team){case 0:switch(e.team){case 1:this.trace(LangMgr.getValueByKey("zsTips35"));break;case 3:confrontControl.upResult(!0),this.trace(LangMgr.getValueByKey("zsTips36"));break;case 2:if(this.trace(LangMgr.getValueByKey("zsTips37")),!UnitMgr.ins().getTeamCount(0))return;confrontFightControl.sendFightResult(1);break;case 5:var o=confrontControl.wildPersonList[e.infoModel.masterHandle];o&&confrontControl.upWildPeopleResult(o.index,1)}confrontControl.isGuiding&&(confrontControl.isGuiding=!1,confrontControl.dispatchEncounterDataChange()),UnitMgr.ins().resetRole();break;case 3:confrontControl.upResult(!1),this.trace(LangMgr.getValueByKey("zsTips38"));break;case 2:if(0!=e.team)return;if(this.trace(LangMgr.getValueByKey("zsTips39")),0!=e.team||!UnitMgr.ins().getTeamCount(2))return;confrontFightControl.sendFightResult(0);break;case 5:var n=confrontControl.wildPersonList[t.infoModel.masterHandle];n&&0==e.team&&confrontControl.upWildPeopleResult(n.index,0);break;case 1:UnitMgr.ins().resetRole()}this.getPickAI()}}},e.prototype.checkPlayDieSound=function(t){var e,i=t.infoModel?t.infoModel.configID:0;!SoundUtils.PLAY_OPEN_VIEW&&i&&(e=copyControl.guanqiaMonster[i],e?e.sound&&SoundUtils.ins().playEffect(e.sound):(e=DataCenter.ins().MonstersConfig[i],e&&e.sound&&SoundUtils.ins().playEffect(e.sound)))},e.prototype.getPickAI=function(){this.inited&&!confrontControl.isEncounter()&&this.stopHookTimer()},e.prototype.getTeamCount=function(t,e){var i=0;for(var o in this.aiList){var n=this.aiList[o];if(n.team==t){if(e){for(var r=!1,a=0;a<e.length;a++){var s=e[a];if(s(n)){r=!0;break}}if(!r)continue}i+=1}}return i},e.prototype.stopHookTimer=function(){TimerMgr.ins().remove(this.startHook,this),TimerMgr.ins().remove(this.startAshtarte,this)},e.prototype.addHookTimer=function(){TimerMgr.ins().isExists(this.startHook,this)||(TimerMgr.ins().doTimer(e.AI_UPDATE_TIME,0,this.startHook,this),this.addAshtarteTimer())},e.prototype.addAshtarteTimer=function(){this.zhanlingTime=egret.getTimer(),this.zhanlingdelayTime=egret.getTimer(),TimerMgr.ins().isExists(this.startAshtarte,this)||TimerMgr.ins().doTimer(1e3,0,this.startAshtarte,this)},e.prototype.getArgs=function(t,e,i,o){var n=DataCenter.ins().SkillsEffectsConfig[t],r=0,a=0,s=0;if(e&&e.args)for(var l=0,h=e.args;l<h.length;l++){var u=h[l];8==u.type&&u.vals[0]==n.group&&(r+=u.vals[2]||0,a+=u.vals[4]||0,s+=u.vals[1]||0),6==u.type&&(r+=u.vals[0]||0)}if(i&&i.args)for(var c=0,p=i.args;c<p.length;c++){var u=p[c];8==u.type&&u.vals[0]==n.group&&(r+=u.vals[2]||0,a+=u.vals[4]||0,s+=u.vals[1]||0),6==u.type&&(r+=u.vals[0]||0)}if(o&&o.args)for(var d=0,g=o.args;d<g.length;d++){var u=g[d];8==u.type&&u.vals[0]==n.group&&(r+=u.vals[2]||0,a+=u.vals[4]||0,s+=u.vals[1]||0),6==u.type&&(r+=u.vals[0]||0)}return{a:r,b:0,c:a,time:s}},e.prototype.skillEffValue=function(t,e,i){var o=0,n=0,r=0;if(i&&(n=i.a||0,r=i.c||0),e){if(e.args)switch(e.type){case 1:o=t.infoModel.getAtt(e.args.b)*(e.args.a+n)+(e.args.c||0)+r;break;case 2:o=t.infoModel.getAtt(e.args.b)*(e.args.a+n)+(e.args.c||0)+r,o=-o;break;case 3:case 7:o=t.infoModel.getAtt(e.args.b)*(e.args.a+n)+(e.args.c||0)+r;break;case 4:if(2==e.args.i)o=t.infoModel.getAtt(e.args.b)*(e.args.a+n)+(e.args.c||0)+r;else{var a=e.args.c?(e.args.c||0)+r:1+r;o=t.infoModel.getAtt(e.args.b)*a}}o>>=0}return o},e.prototype.tryUseSkill=function(t){var e=t.infoModel.handle,i=this.curSkill[e],o=this.curTarget[e];if(!i)return!1;var n=MathUtils.getDistance(t.x,t.y,o.x,o.y);return n<i.castRange*MapControl.CELL_SIZE},e.prototype.screeningSkill=function(t){var e=this.aiList[t];if(this.skillCD[t]=this.skillCD[t]||{},0==e.team){var i=UnitMgr.ins().getNoDieRole();if(i&&i!=e&&!this.checkDistance(e,i,10))return void(this.curSkill[t]=null)}var o=this.curSkill[t];if(o&&egret.getTimer()-this.skillCD[t][o.id]<o.cd&&(this.curSkill[t]=null),!this.curSkill[t]){var n=this.getCanUseSkillList(e);if(n){var r,a=0,s=n[a];if(r=s&&s.tarEff?DataCenter.ins().SkillsEffectsConfig[s.tarEff[0]]:null,r&&5==r.type&&e.hasBuff(r.group)&&(s=n[++a]),r=s&&s.tarEff?DataCenter.ins().SkillsEffectsConfig[s.tarEff[0]]:null,r&&2==r.type&&(UnitMgr.ins().checkCanAddBlood(e.team)||(s=n[++a])),s&&25e3==s.id){var l=this.curTarget[e.infoModel.handle];l&&3!=l.AI_STATE||(l=e),(confrontControl.isEncounter()||!UnitMgr.ins().checkCount(l,s.affectRange,2,l.team!=e.team))&&(s=n[++a])}s&&13e3==s.id&&(confrontControl.isEncounter()||!UnitMgr.ins().checkCount(e,s.affectRange,2))&&(s=n[++a]),this.curSkill[t]=s}}},e.prototype.checkDistance=function(t,e,i){void 0===i&&(i=5);var o=MathUtils.getDistance(t.x,t.y,e.x,e.y);return o<i*MapControl.CELL_SIZE},e.prototype.getCanUseSkillList=function(t,e){void 0===e&&(e=!0);var i=[];if(t instanceof UnitRole&&t.infoModel){if(Assert(t.infoModel.skillsData,"Character skills are empty，isMy:"+t.isMy+",fbType:"+MapControl.copyType+",fubenId:"+MapControl.copyId))return;if(i=t.infoModel.skillsData.concat(),0==t.team){var o=godWeaponControl.getJobGWNewSkill(t.infoModel.job);o&&(i=i.concat(o));var n=t.infoModel.index,r=experienceJadeNewControl.getJadeDataByID(n);r&&(i=i.concat(r.getSkillList())),i=i.concat(TotemSkillControl.ins().getSkillID(n));var a=reincarnateStarEquipControl.getPassiveSkills(n);a&&a.length&&(i=i.concat(a));var s=DevourEquipContorl.ins().getSuitSkills(t.infoModel);s&&(i=i.concat(s))}else{var r=t.infoModel.jadeData;r&&(i=i.concat(r.getSkillList()))}i=i.concat(uitrasoneEquipControl.getZhiZunSkills(t.infoModel))}else if(0==t.team)if(superRingControl.isFireRing(t.infoModel.handle)){var l=superRingControl.getRingSkill();if(l){var h=ObjectPool.pop("SkillVo");h.configID=l,i.push(h)}if(l=flameMarkControl.getCurSkillID()){var h=ObjectPool.pop("SkillVo");h.specialCD=flameMarkControl.getCurSkillCD(),h.configID=l,i.push(h)}}else if(t.infoModel.fixSkills.length)for(var u=t.infoModel.fixSkills,c=0;c<u.length;c++){var l=u[c],h=ObjectPool.pop("SkillVo");h.configID=l,i.push(h)}else{var p=1,h=ObjectPool.pop("SkillVo");h.configID=80001;var o=godWeaponControl.getReviseBySkill(35e3);o&&o.length&&(p=2,h.configID=80002),crazyDogControl.skinId&&(h.configID=crazyDogControl.getSummonerSkill(p)),i.push(h)}else{var h=ObjectPool.pop("SkillVo");h.configID=50001,i.push(h)}if(i&&0!=i.length){var d=t.infoModel.handle;this.skillCD[d]=this.skillCD[d]||{};var g=i.length;if(0!=g){for(var f=[],c=0;g>c;c++)if(i[c].canUse&&e!=i[c].isPassive){var m=0;if(0==t.team){var v=artifactControl.getReviseBySkill(i[c].id);v&&v.cd&&(m+=v.cd);var o=godWeaponControl.getReviseBySkill(i[c].id),y=void 0;o&&(y=o[0]),y&&y.cd&&(m+=y.cd);var C=SkillVo.reviseDp(i[c].id+i[c].lv,t.infoModel.index);C&&(m+=C.cd||0)}egret.getTimer()-this.skillCD[d][i[c].id]<i[c].cd-m||f.push(i[c])}return f.sort(this.sortFunc),f}}},e.prototype.sortFunc=function(t,e){var i=t.job,o=DataCenter.ins().SkillsSorderConfig[i];if(!o)return 0;var n=o.skillorder,r=n.length,a=n.length;for(var s in n)n[s]==t.id&&(r=+s),n[s]==e.id&&(a=+s);return r>a?1:a>r?-1:0},e.prototype.damageBaseCalculation=function(t,e,i){var o,n=0,r=0,a=0,s=0,l=!1,h=!1,u=t.infoModel,c=0,p=0,d=0,g=0,f=0;if(0==t.team){var m=artifactControl.getReviseBySkill(i.id);if(m&&(c=m.a||0,p=m.b||0,g=m.d||0,m.selfEff))for(var v in m.selfEff)o=t.buffList[m.selfEff[v]],o&&3==o.effConfig.type&&(f+=o.value);var y=godWeaponControl.getReviseBySkill(i.id),C=void 0;if(y&&(C=y[0]),C&&(c+=C.a||0,p+=C.b||0,g+=C.d||0,C.selfEff))for(var v in C.selfEff)o=t.buffList[C.selfEff[v]],o&&3==o.effConfig.type&&(f+=o.value)}if(i.preId&&DataCenter.ins().FlameMarkConfig.skillId.indexOf(i.preId)>=0){var b=u.lyMarkLv||0;if(b){var T=DataCenter.ins().FlameMarkLvConfig[b];T&&(c+=T.bulletDamage.a,p+=T.bulletDamage.b)}var w=u.lyMarkSkills||[];if(b=w[6]||0){var T=DataCenter.ins().FlameMarkEffectConfig[7][b];T.bulletDamage&&(c+=T.bulletDamage.a||0,p+=T.bulletDamage.b||0)}}if(l=t instanceof UnitRole?!0:!1,h=e instanceof UnitRole?!0:!1,n=l&&s?1==s?GameControl.calculateRealAttribute(e,5,t):GameControl.calculateRealAttribute(e,6,t):GameControl.calculateRealAttribute(e,5,t),r=n*(1-u.getAtt(20)/1e4),3==i.calcType){if(i.args){var S=0;if(0==t.team)for(var _=heroControl.subRolesLen,M=0;_>M;M++){var I=heroControl.getSubRoleByIndex(M);I&&(S+=I.getAtt(4))}else if(2==t.team)for(var D=focusAttackControl.getRoles(),_=D.length,M=0;_>M;M++){var I=D[M];I&&(S+=I.getAtt(4))}S=Math.max(S-r,.05*S);var E=i.args.b?i.args.b+p:0+p;a=S*(i.args.a+c)+E+d,a=Math.max(a,.05*S),a=e instanceof UnitRole?Math.floor(a*(1+u.getExAtt(22)/1e4)):Math.floor(a*(1+u.getExAtt(21+g)/1e4)),a=Math.floor(a*(1-u.getExAtt(20)/1e4)),this._isTogetherCrit&&(a=Math.floor(a*(1+Math.max(.2,.2+(u.getExAtt(71)-e.infoModel.getExAtt(72))/1e4))));var k=GameControl.calculateRealAttribute(t,21,t);k-=GameControl.calculateRealAttribute(e,22,t),k-=GameControl.calculateRealAttribute(e,16,t),a=Math.floor(a*(1+k/1e4)),a+=u.getAtt(60)*(1+u.getAtt(61)/1e4-e.infoModel.getAtt(62)/1e4)}}else if(2==i.targetType&&i.args){for(var P=0,x=Math.floor(i.id/1e3)%100,M=0;M<SkillConst.BASE_SKILL_INDEX.length;M++)x==SkillConst.BASE_SKILL_INDEX[M]&&(P=u.attributeExData[27]);var S=u.getAtt(4),R=GameControl.calculateRealAttribute(t,4,t);if(80002==i.configID||crazyDogControl.isSummonerSkill(i.configID)){var B=this.gePetSkillAdd(t);R+=Math.floor(S*B/1e4)}var L=GameControl.triggerAttr(t,37),U=0;L&&(U=u.getAtt(38),t.addBubble(15));var A=0;e.hasBuff(51001)&&u.getAtt(41)&&(A=u.getAtt(41),t.addBubble(17));var N=0;u.getAtt(43)&&e.infoModel.getAtt(0)/e.infoModel.getAtt(2)<u.getAtt(43)/1e4&&(N=u.getAtt(44),this.hashHpObj[e.hashCode]||(t.addBubble(19),this.hashHpObj[e.hashCode]=1));var G=0;1==u.type&&1==e.infoModel.type&&confrontControl.isEncounter()&&(G=confrontFightControl.getWeiSheHurt(t.isMy));var V=0;if(u.getExAtt(56)){var O=u.getAtt(0)/u.getAtt(2)*1e4;O<u.getExAtt(56)&&(V=Math.floor((u.getExAtt(56)-O)/u.getExAtt(57))*u.getExAtt(58))}u.getExAtt(59)&&this.isTriggerAttr(t,1,60)&&(V+=u.getExAtt(59));var E=i.args.b?i.args.b+p:0+p;h&&i.args.c&&(d+=i.args.c*e.infoModel.getAtt(0)),R=Math.max(R-r,.05*R),a=R*(i.args.a+P+c)+E+d+U,a=Math.floor(a*(1+(g+A+N+G+V)/1e4));var k=GameControl.calculateRealAttribute(t,21,t);k-=GameControl.calculateRealAttribute(e,22,t),k-=GameControl.calculateRealAttribute(e,16,t),a=Math.floor(a*(1+k/1e4)),a=Math.max(a,.05*S)}var F=(105-10*Math.random())/100;return a*=F,Math.floor(a)},e.prototype.gePetSkillAdd=function(t){var e=t.infoModel.masterHandle,i=UnitMgr.ins().getEntityByHandle(e);if(i&&i.infoModel&&i.infoModel.getExAtt(48)){var o=i.infoModel.getExAtt(48),n=0,r=UnitMgr.ins().getTeamCount(t.team);return 0==t.team?n=heroControl.subRolesLen+1-r:2==t.team&&confrontControl.isEncounter()&&(n=confrontFightControl.getRoles().length+1-r),o*n}return 0},e.prototype.damageBuff=function(t,e,i){t instanceof UnitMonster&&(1==t.team||3==t.team)&&t.infoModel.name!=LangMgr.getValueByKey("charMonsterSS")&&(i=0);var o=e.buffList[19001];if(o){var n=o.effConfig,r=Math.floor(i*n.args.a);o.value-=r,o.value<=0&&e.removeBuff(o),i=i-r+(o.value<0?-o.value:0)}if(o=e.buffList[60002]){var n=o.effConfig,r=Math.floor(i*(n.args.c/1e4));i-=r}if(o=e.buffList[60004],o&&(i=0),e instanceof UnitRole&&e.infoModel&&e.infoModel.exRingsData&&1==e.infoModel.exRingsData[1]){var a=e.infoModel.getAtt(1);if(a>0){var s=a-i;e.infoModel.setAtt(1,s>0?s:0),i=i-a>=0?i-a:0}}return o=e.buffList[80001],o&&i>0&&(i-=o.value,i=i>0?i:0),i},e.prototype.screeningTarget=function(t,e,i){void 0===e&&(e=Number.MAX_VALUE),void 0===i&&(i=!1);var o=t.infoModel.handle,n=this.curSkill[o],r=0;if(n&&(r=n.targetType),i||(i=1==r),!i&&this.lastTarget[o]){var a=UnitMgr.ins().getEntityByHandle(this.lastTarget[o]);if(a&&a.parent&&3!=a.AI_STATE)return void(this.curTarget[o]=a)}var s=UnitMgr.ins().screeningTargetByPos(t,i,0,e,this.aiList);switch(t.team){case 0:var l=this.checkMySubInList(s,!1,5);this.curTarget[o]=l;break;case 5:var a=this.checkMySubInList(s);this.curTarget[o]=a;break;default:this.curTarget[o]=s?s[0]:null}!i&&this.curTarget[o]&&(this.lastTarget[o]=this.curTarget[o].infoModel.handle)},e.prototype.checkMySubInList=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=0);for(var o=0;o<t.length;o++)if(e){if(t[o].team==i)return t[o]}else if(t[o].team!=i)return t[o];return null},e.prototype.startAshtarte=function(){this.zhanlingdelayTime&&egret.getTimer()-this.zhanlingdelayTime>DataCenter.ins().AshtarteConfig.delayTime&&(this.zhanlingdelayTime=0,this.checkShowZhanling()),egret.getTimer()-this.zhanlingTime>1e4&&this.checkShowZhanling()},e.prototype.checkShowZhanling=function(){if(this.zhanlingTime=egret.getTimer(),MapControl.sceneInHook()){var t=ashtarteControl.ZhanLingSkinId;if(ashtarteControl.getZhanLingDataById(0)){var e=UnitMgr.ins().getNoDieRole();
if(e){var i=ashtarteControl.getZhanLingDataById(0).level;e.showZhanling(t,i)&&AshtarteSkillControl.ins().checkWarSpiritBubbleTrigger()}}}},e.prototype.getEffectIdsByGroup=function(t){var e=[];for(var i in DataCenter.ins().SkillsEffectsConfig){var o=DataCenter.ins().SkillsEffectsConfig[i];o.group==t&&e.push(o.id)}return e.sort(),e},e.prototype.trace=function(t){this.isLog&&console.warn(t)},e.AI_UPDATE_TIME=100,e.SEND_TASK_TYPE=68,e}(SingleClass);__reflect(HookControl.prototype,"HookControl");var TotemSkillControl=function(t){function e(){var e=t.call(this)||this;return e.skillJob={},e.skillIndex={},e.addCustomEvent(354,e.onCreate),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getSkillID=function(t){return this.skillIndex&&this.skillIndex[t]?[this.skillIndex[t]]:[]},e.prototype.onCreate=function(t){t instanceof RoleModel&&t.isMy&&2==t.job&&this.initEff(t.job)},e.prototype.initEff=function(t){if(this.skillJob[t]){var e=this.skillJob[t].selfEff;if(e&&e.length){var i=DataCenter.ins().SkillsEffectsConfig[e[0]].args;if(i&&i.d){var o=UnitMgr.ins().getMainRoleByJob(t);o&&o.addEffect(0,i.i,i.d)}}}},e.prototype.init=function(){for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t),i=totemControl.getSkillID(e.index);i&&(this.skillJob[e.job]=new SkillVo(i),this.skillIndex[e.index]=this.skillJob[e.job],this.initEff(e.job))}},e.prototype.checkActedFHJT=function(t,e){if(t&&t instanceof UnitRole&&2==t.infoModel.job){for(var i=t.hasSkillBall(),o=DataCenter.ins().EffectConfig[7],n=0;n<e.length;n++){var r=e[n];if(t.infoModel.masterHandle==r.infoModel.masterHandle)return;i>0&&t.skillBallReady()&&SkillEffPlayDisplay.play(o.fileName,t,[r])}HookControl.ins().pStarting&&(i>0?t.skillBallReady()&&t.addEffect(7,11,i-1):t.removeEffect(7))}},e}(BaseSystem);__reflect(TotemSkillControl.prototype,"TotemSkillControl");var SkillBallMgt=function(){function t(t,e,i){void 0===e&&(e=8),void 0===i&&(i=PATH_SKILLEFF+"skill209"),this.nX=90,this.nY=60,this._angle=.1,this.runing=!1,this.readly=!1,this.target=t,this.max=e,this.ballRes=i,this.ballContainer=t.getBody().parent,this.creatBall(e)}return t.prototype.reset=function(t){this.max=t,this.readly=!0,this.remove(),this.creatBall(this.max)},t.prototype.starAddBall=function(t){if(void 0===t&&(t=3e3),this._balls){this.readly=!1,this.remove();var e=t/(this.max+1);TimerMgr.ins().remove(this.pushBall,this),TimerMgr.ins().doTimer(e,this.max,this.pushBall,this)}},t.prototype.pushBall=function(){if(!(this._balls.length>=this.max)){var t=ObjectPool.pop("GameMovieClip");t.playFile(this.ballRes,-1),this.ballContainer.addChild(t),this._balls.push(t),this.resetPos()}},t.prototype.creatBall=function(t){this._balls=[],this._angles=[];for(var e,i=2*Math.PI/t,o=0;t>o;o++)e=ObjectPool.pop("GameMovieClip"),this.ballContainer.addChild(e),this._angles[o]=i*o,e.x=this.nX*Math.cos(this._angles[o]),e.y=this.nY*Math.sin(this._angles[o])-40,this._balls.push(e),e.playFile(this.ballRes,-1);this.startRun()},t.prototype.resetPos=function(){for(var t,e=2*Math.PI/this._balls.length,i=0;i<this._balls.length;i++)t=this._balls[i],this._angles[i]=e*i,t.x=this.nX*Math.cos(this._angles[i]),t.y=this.nY*Math.sin(this._angles[i])-40},t.prototype.refPos=function(){var t=this;this.runing=!1;for(var e=this._balls.length,i=2*Math.PI/e,o=0;e>o;o++){this._angles[o]=i*o+4.7*e;var n=this._balls[o],r=this.nX*Math.cos(this._angles[o]),a=this.nY*Math.sin(this._angles[o])-40;egret.Tween.get(n).to({x:r,y:a},250).call(function(){t.runing=!0})}},t.prototype.startRun=function(){this.runing=!0,TimerMgr.ins().isExists(this.runCircle,this)||TimerMgr.ins().doTimer(100,0,this.runCircle,this)},t.prototype.stop=function(){this.runing=!1,TimerMgr.ins().removeAll(this)},t.prototype.getBallNum=function(){return this._balls.length},t.prototype.isReady=function(){return this.readly},t.prototype.attackT=function(t,e){var i=this;if(this._balls.length){for(var o=function(e){var o=i._balls.pop();if(DisplayUtils.removeFromParent(o),t){i.target.parent.addChild(o),o.x=i.target.x+o.x,o.y=i.target.y-40+o.y;var n=.6,r=MathUtils.getDistance(t.x,t.y,o.x,o.y),a=r/n;egret.Tween.get(o).to({x:t.x,y:t.y-60},a).call(function(){DisplayUtils.removeFromParent(o)})}else DisplayUtils.removeFromParent(o)},n=this._balls.length-e,r=0;n>r;r++)o(r);this.refPos()}},t.prototype.runCircle=function(){for(var t,e,i=this._balls.length,o=0,n=0,r=0;i>r;r++)t=this._balls[r],t.x=this.nX*Math.cos(this._angles[r]),t.y=this.nY*Math.sin(this._angles[r])-40,this._angles[r]+=this._angle,this._angles[r]=this._angles[r]%(2*Math.PI),e=t.parent,o=e.getChildIndex(this.target.getBody()),n=e.getChildIndex(t),this._angles[r]>=2.5&&this._angles[r]<=6?n>o&&e.addChildAt(t,o):o>n&&e.addChildAt(t,e.numChildren)},t.prototype.remove=function(){if(this._balls)for(;this._balls.length;){var t=this._balls.shift();t.stop(),DisplayUtils.removeFromParent(t),t=null}this._balls=[]},t.prototype.destroy=function(){if(this.stop(),this._balls){for(;this._balls.length;){var t=this._balls.shift();t.destroy(),t=null}this._balls=null}this.target=null,this._angles=null,this.ballContainer=null},t}();__reflect(SkillBallMgt.prototype,"SkillBallMgt");var LeaseControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.weaponId=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkOpen=function(t){return void 0===t&&(t=!1),ActorControl.level<DataCenter.ins().LeaseRentBaConfig.openLevel?(t&&tipsControl.warnTips(LangMgr.getValueByKey("levelOpen",DataCenter.ins().LeaseRentBaConfig.openLevel)),!1):GameServer.serverOpenDay+1<DataCenter.ins().LeaseRentBaConfig.openDay?(t&&tipsControl.warnTips(LangMgr.getValueByKey("serverDayOpen",DataCenter.ins().LeaseRentBaConfig.openDay)),!1):GameServer.serverOpenDay+1>=DataCenter.ins().LeaseRentBaConfig.afterNoBuyDay?(t&&tipsControl.warnTips(LangMgr.getValueByKey("doubleEndActivity")),!1):leaseControl.getBuyEndTime()<=0?(t&&tipsControl.warnTips(LangMgr.getValueByKey("doubleEndActivity")),!1):!0},e.prototype.getRedPoint=function(t,e){if(void 0===e&&(e=!0),!ServerStorage.ins().isInit)return!1;var i=DataCenter.ins().LeaseLvConfig[this.weaponId],o=CommonUtils.getObjectLength(DataCenter.ins().LeaseLvConfig);if(this.weaponId>=o)return!1;for(var n in DataCenter.ins().LeaseLvConfig){var r=DataCenter.ins().LeaseLvConfig[n];if((isNaN(t)||r.id==t)&&!(i&&i.recharge>=r.recharge)){if(e&&vipControl.exp>=r.recharge&&!this.firstRedPoint)return!0;if(vipControl.exp>=r.recharge&&ActorControl.yb>=r.yb)return!0}}return!1},e.prototype.getBuyEndTime=function(){var t=DataCenter.ins().LeaseRentBaConfig.afterNoBuyDay,e=DateUtils.formatMiniDateTime(GameServer._serverZeroTime)+(t-1)*DateUtils.MS_PER_DAY,i=e-GameServer.serverTime;return 0>=i&&(i=0),i},e.prototype.getTime=function(){var t=DataCenter.ins().LeaseRentBaConfig.closeTime[0],e=DataCenter.ins().LeaseRentBaConfig.closeTime[1],i=DataCenter.ins().LeaseRentBaConfig.closeTime[2],o=DataCenter.ins().LeaseRentBaConfig.closeTime[3],n=DateUtils.formatMiniDateTime(GameServer._serverZeroTime)+(t-1)*DateUtils.MS_PER_DAY+e*DateUtils.MS_PER_HOUR+i*DateUtils.MS_PER_MINUTE+o*DateUtils.MS_PER_SECOND,r=n-GameServer.serverTime;return 0>=r&&(r=0),r},e.prototype.dispatchFirstRedPoint=function(){EventMgr.ins().dispatch(682)},e.prototype.upGodWeaponRent=function(t){return[t]},e.prototype.downGodWeaponRent=function(t){this.weaponId=t,EventMgr.ins().dispatch(173)},__decorate([up(26,[1])],e.prototype,"upGodWeaponRent",null),__decorate([down(26,[4])],e.prototype,"downGodWeaponRent",null),e=__decorate([protocolsId(41)],e)}(BaseSystem);__reflect(LeaseControl.prototype,"LeaseControl");var LeaseView=function(t){function e(){var e=t.call(this)||this;return e.maxItem=3,e.skinName="LeaseViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.close=function(){TimerMgr.ins().remove(this.setTime,this)},e.prototype.open=function(){this.roleSelect0.hideRole(),this.addCustomEvent(173,this.updateView),this.addCustomEvent(466,this.updateView),this.addCustomEvent(467,this.updateView),this.addEventTouchTap(this.closeBtn,this.onClick);for(var t=0;t<this.maxItem;t++)this["lease"+(t+1)]&&this.addEventTouchTap(this["lease"+(t+1)],this.onClick),this["eff"+(t+1)]&&this.addEventTouchTap(this["eff"+(t+1)],this.onTouch);if(!this.arr){this.arr=[];for(var e in DataCenter.ins().LeaseLvConfig)this.arr.push(DataCenter.ins().LeaseLvConfig[e]);this.arr.sort(function(t,e){return t.sort<e.sort?-1:1})}this.updateView(),TimerMgr.ins().isExists(this.setTime,this)||TimerMgr.ins().doTimer(1e3,0,this.setTime,this),leaseControl.firstRedPoint||(leaseControl.firstRedPoint=!0,leaseControl.dispatchFirstRedPoint())},e.prototype.onTouch=function(t){for(var e=0;e<this.maxItem;e++)if(this["eff"+(e+1)]&&this["eff"+(e+1)]==t.currentTarget){if(!this.arr)break;var i=this.arr[e].zhuangbanId,o=DataCenter.ins().FashionIdConfig[i];if(!o||!o.cost)break;var n=DataCenter.ins().ItemConfig[o.cost.itemId];UIMgr.ins().open("FashionTipsView",n,!0);break}},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;default:if(!this.isOpen)return void tipsControl.warnTips(LangMgr.getValueByKey("doubleEndActivity"));for(var e=0;e<this.maxItem;e++)if(this["lease"+(e+1)]&&this["lease"+(e+1)]==t.currentTarget){if(!this.arr)break;if(vipControl.exp<this.arr[e].recharge){leaseControl.weaponId?tipsControl.warnTips(LangMgr.getValueByKey("lease1",this.arr[e].recharge-vipControl.exp)):tipsControl.warnTips(LangMgr.getValueByKey("lease2",this.arr[e].recharge));break}var i=DataCenter.ins().LeaseLvConfig[leaseControl.weaponId],o=i?i.yb:0,n=this.arr[e].yb-o;if(0>=n)return void tipsControl.warnTips(LangMgr.getValueByKey("lease3",this.arr[e].id,leaseControl.weaponId));if(ActorControl.yb<n)return void tipsControl.warnTips(LangMgr.getValueByKey("osaNoMoney"));leaseControl.upGodWeaponRent(this.arr[e].id);break}}},e.prototype.updateView=function(){this.isOpen=leaseControl.checkOpen(),this.actInfo.textFlow=TextUtils.generateTextFlow1(DataCenter.ins().LeaseRentBaConfig.desc),this.setTime(),this.updateEff(),this.updateBtn(),this.updateRedPoint()},e.prototype.updateRedPoint=function(){if(this.arr)for(var t=0;t<this.maxItem;t++){var e=t+1;this["redPoint"+e]&&(this["redPoint"+e].visible=this.isOpen&&leaseControl.getRedPoint(this.arr[t].id,!1))}},e.prototype.updateBtn=function(){for(var t=DataCenter.ins().LeaseLvConfig[leaseControl.weaponId],e=t?t.yb:0,i=t?t.id:0,o=0;o<this.maxItem;o++)if(this["lease"+(o+1)]&&this["already"+(o+1)]&&this["moneyGroup"+(o+1)]&&this["countDownGroup"+(o+1)]&&(this["lease"+(o+1)].enable=!1,this["countDownGroup"+(o+1)].visible=this["dlease"+(o+1)].visible=this["lease"+(o+1)].visible=this["already"+(o+1)].visible=this["moneyGroup"+(o+1)].visible=!1,this.isOpen)){var n=this.arr[o].yb;if(e>n)this["already"+(o+1)].visible=!0,this["already"+(o+1)].text=DataCenter.ins().LeaseRentBaConfig.rentTips;else if(i&&i==this.arr[o].id){this["countDownGroup"+(o+1)].visible=!0;var r=Math.floor(leaseControl.getTime()/DateUtils.MS_PER_DAY);this["dayCountDown"+(o+1)].text=0>=r?LangMgr.getValueByKey("jinstr"):""+r,this["price"+(o+1)].text=""+n}else this["moneyGroup"+(o+1)].visible=!0,this["lease"+(o+1)].visible=!0,this["dlease"+(o+1)].visible=!0,this["lease"+(o+1)].enable=!0,n-=e;this["dy"+(o+1)].text=""+n,this["nowMoney"+(o+1)].text=""+n}},e.prototype.updateEff=function(){for(var t=0;t<this.arr.length;t++){var e=t+1;this["mc"+e]||(this["mc"+e]=new GameMovieClip),this["mc"+e].parent||(this["eff"+e].addChild(this["mc"+e]),this["mc"+e].playFile(PATH_EFF+(""+this.arr[t].eff),-1))}},e.prototype.setTime=function(){if(!this.isOpen)return this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"),void TimerMgr.ins().remove(this.setTime,this);var t=leaseControl.getBuyEndTime();0>=t?(this.actTime.text=LangMgr.getValueByKey("doubleEndActivity"),TimerMgr.ins().remove(this.setTime,this),this.isOpen=!1):(t=Math.floor(t/DateUtils.MS_PER_SECOND),this.actTime.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_5,3))},e.openCheck=function(){return leaseControl.checkOpen(!0)?!0:!1},e}(BaseEuiView);__reflect(LeaseView.prototype,"LeaseView");var MeridiansControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upBoost=function(t){return[t]},e.prototype.upUpgrade=function(t){return[t]},e.prototype.downUpData=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];heroControl.getSubRoleByIndex(t).jingMaiData.init(e),EventMgr.ins().dispatch(233)},e.prototype.upBigUpLevel=function(t){return[t]},e.prototype.downBigUpLevel=function(t,e){var i;t?i=LangMgr.getValueByKey("roleTips11"):e||(i=LangMgr.getValueByKey("roleTips10")),i&&tipsControl.showTips(i)},e.prototype.canGradeupJingMai=function(){for(var t,e=[!1,!1,!1],i=0,o=0,n=heroControl.subRolesLen,r=0;n>r;r++){var a=heroControl.getSubRoleByIndex(r);if(t=DataCenter.ins().MeridiansLevelConfig[a.jingMaiData.level],i=t.count){var s=backpackControl.getBagGoodsCountById(0,200103);if(s){e[r]=!0;break}o=backpackControl.getBagGoodsCountById(0,t.itemId),e[r]=o>=i}else e[r]=!1}return e},__decorate([up(1,[2])],e.prototype,"upBoost",null),__decorate([up(2,[2])],e.prototype,"upUpgrade",null),__decorate([down(1,[2].concat(ByteConst.MeridiansVos))],e.prototype,"downUpData",null),__decorate([up(4,[3])],e.prototype,"upBigUpLevel",null),__decorate([down(4,[3,3])],e.prototype,"downBigUpLevel",null),e=__decorate([protocolsId(12)],e)}(BaseSystem);__reflect(MeridiansControl.prototype,"MeridiansControl");var MeridiansVo=function(){function t(){}return t.prototype.init=function(t){this.level=t[0],this.stage=t[1]},t.prototype.jingMaiCanUp=function(){var t=DataCenter.ins().MeridiansStageConfig[this.stage];if(t.stage>=DataCenter.ins().MeridiansCommonConfig.stageMax)return!1;var e=DataCenter.ins().MeridiansLevelConfig[this.level],i=backpackControl.getBagGoodsCountById(0,e.itemId);return i>=e.count},t}();__reflect(MeridiansVo.prototype,"MeridiansVo");var MeridiansPanel=function(t){function e(){var e=t.call(this)||this;return e.cursorLocation=[[132,131],[92,186],[165,177],[138,252],[84,231],[96,316],[152,339],[126,431]],e.curRole=0,e.canClick=!0,e.name=LangMgr.getValueByKey("equipment16"),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.danItemID=DataCenter.ins().MeridiansCommonConfig.levelItemid,this.cursor=new GameMovieClip,this.cursor.visible=!1},e.prototype.open=function(){this.addEventTouchTap(this.boostBtn,this.onTap),this.addEventTouchTap(this.bigUpLevelBtn,this.onTap),this.addCustomEvent(233,this.setForgeData),this.addCustomEvent(266,this.setForgeData),this.cursor.playFile(PATH_EFF+"jingmaiCursor",-1),this.setForgeData(!1)},e.prototype.close=function(){this.removeEventTouchTap(this.boostBtn,this.onTap),this.removeEventTouchTap(this.bigUpLevelBtn,this.onTap),this.canClick=!0,this.removeCustomEvents()},e.prototype.onTap=function(t){var e=this;switch(t.currentTarget){case this.boostBtn:var i=DataCenter.ins().MeridiansLevelConfig[this._data.level];if(!this.canClick)return;this._data.level%10==0&&this._data.level/10>this._data.stage&&0!=this._data.level?(this.canClick=!1,this.showUpgradeEffect(),TimerMgr.ins().doTimer(1e3,1,function(){meridiansControl.upUpgrade(e.curRole),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE),e.canClick=!0},this)):backpackControl.getBagGoodsCountById(0,i.itemId)>=i.count?(meridiansControl.upBoost(this.curRole),SoundUtils.ins().playEffect(SoundUtils.SKILL_UPGRADE)):warnControl.setBuyGoodsWarn(i.itemId);break;case this.bigUpLevelBtn:var o=DataCenter.ins().ItemConfig[this.danItemID].name;warnControl.show(LangMgr.getValueByKey("jingMaiShow1",o,DataCenter.ins().MeridiansCommonConfig.levelItemidStage,DataCenter.ins().MeridiansCommonConfig.levelItemChange,DataCenter.ins().ItemConfig[DataCenter.ins().MeridiansCommonConfig.itemid].name),function(){meridiansControl.upBigUpLevel(e.curRole)},this)}},e.prototype.showLight=function(t,e){},e.prototype.showUpgradeEffect=function(){for(var t=0;9>=t;t++)this["jinmai_"+t].setLights(4)},e.prototype.setForgeData=function(t){void 0===t&&(t=!0),this._data=heroControl.getSubRoleByIndex(this.curRole).jingMaiData;var e=DataCenter.ins().MeridiansStageConfig[this._data.stage],i=DataCenter.ins().MeridiansLevelConfig[this._data.level];this.jinmaiStage.data=LangMgr.getValueByKey("stageNumberTxt",e.level),this.jinMaiName.text=e.name,this.attr.text=AttributeData.getAttStr(AttributeData.AttrAddition(e.attr,i.attr),.75),this._totalPower=BackpackControl.getAttrPower(AttributeData.AttrAddition(e.attr,i.attr)),this.powerPanel.setPower(this._totalPower);var o=this._data.level/10-e.stage;if(e.stage<DataCenter.ins().MeridiansCommonConfig.stageMax){var n=void 0,r=void 0,a=backpackControl.getBagGoodsCountById(0,i.itemId);if(this.redPoint0.visible=a>=i.count,this._data.level>0&&this._data.level%10==0&&o?(n=DataCenter.ins().MeridiansStageConfig[this._data.stage+1],r=i):(n=e,r=DataCenter.ins().MeridiansLevelConfig[this._data.level+1]),0==this.nextAttr.visible&&(this.nextAttr.visible=!0,this.countLabel.x=2,this.countLabel.y=497),this.nextAttr.text=AttributeData.getAttStr(AttributeData.AttrAddition(n.attr,r.attr),0,1,"+",!1,!0),this.boostBtn.visible=!0,this._data.level>0&&this._data.level%10==0&&o)this.boostBtn.label=LangMgr.getValueByKey("jingMaiUpdate"),this.countLabel.text=LangMgr.getValueByKey("jingMaiCanUpdate"),this.cursor.visible=!1;else{this.boostBtn.label=LangMgr.getValueByKey("jingMaiCM");var s="";s=a>=i.count?"|C:"+ColorUtils.GREEN+"&T:":"|C:"+ColorUtils.RED+"&T:",this.countLabel.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("jingMaiCount",s+a,i.count))}this.cursor.x=this.cursorLocation[this._data.level%8][0],this.cursor.y=this.cursorLocation[this._data.level%8][1],this.showLight(this._data.level,o)}else this.nextAttr.visible=!1,this.boostBtn.visible=!1,this.countLabel.x=this.nextAttr.x-60,this.countLabel.y=this.nextAttr.y,this.redPoint0.visible=!1,this.cursor.parent&&this.removeChild(this.cursor),this.countLabel.text=LangMgr.getValueByKey("jingMaiMacLevel");for(var l=0;9>l;l++)this["nadis"+l].source="jingmailine"+(1==o||l+1<this._data.level%10?"1":"2");for(var h,u=!0,l=0;9>=l;l++)h=this["jinmai_"+l],h.item.visible=1==o||l+1<=this._data.level%10?!0:!1,h.bgImg.visible=!h.item.visible,h.item.visible?h.setLights(2):(t&&u&&l-1>=0&&this["jinmai_"+(l-1)].setLights(3),h.setLights(u?1:0),u=!1);var c=backpackControl.getBagGoodsCountById(0,this.danItemID);this.bigUpLevelBtn.redPoint&&(this.bigUpLevelBtn.redPoint.visible=c>0),this.bigUpLevelBtn.txt&&(this.bigUpLevelBtn.txt.text=c)},e}(BasePanel);__reflect(MeridiansPanel.prototype,"MeridiansPanel");var MeridiansItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="MeridiansItemRendererSkin",e.guang.visible=!1,e}return __extends(e,t),e.prototype.setLights=function(t){var e=this;if(0==t&&this.mc)return this.mc.stop(),void(this.mc.visible=!1);if(null==this.mc&&(this.mc=new GameMovieClip,this.mc.x=this.mc.y=20,this.addChild(this.mc)),this.mc.visible=!0,this.mc.parent||this.addChild(this.mc),1==t)this.mc.playFile(PATH_EFF+"bally1",-1);else if(2==t)this.mc.playFile(PATH_EFF+"bally2",-1);else if(3==t){var i=egret.Tween.get(this);this.mc.playFile(PATH_EFF+"bally3",1,null,!1),i.wait(800).call(function(){e.mc.playFile(PATH_EFF+"bally2",-1)})}else 4==t&&this.mc.playFile(PATH_EFF+"bally3",1,function(){DisplayUtils.removeFromParent(e.mc),e.mc=null},!0)},e}(BaseItemRender);__reflect(MeridiansItemRenderer.prototype,"MeridiansItemRenderer");var MerryshopView=function(t){function e(){var e=t.call(this)||this;return e.curIndex=0,e.chargeRate=0,e.barbc=new ProgressBarEff,e.isTopLevel=!0,e.skinName="MerryshopViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.barbc.setWidth(400),this.barbc.x=48,this.barbc.y=60,this.topGroup.addChild(this.barbc),this.list.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.addEventTouchTap(this.buyBtn,this.onTap),this.addCustomEvent(448,this.changeExpBar),this.addCustomEvent(448,this.changeAwards),this.chargeRate=GlobalModel.chargeRate,this.barbc.reset(),this.time=this.getLeftTime(),this.runTime(),TimerMgr.ins().doTimer(1e3,0,this.runTime,this),this.changeExpBar(),this.changeAwards()},e.prototype.getLeftTime=function(){return Math.floor((payControl.happyShopCountdown-GameServer.serverTime)/DateUtils.MS_PER_SECOND)},e.prototype.runTime=function(){var t=this.time;this.time-=1,t>0?this.cdTime&&(this.cdTime.textFlow=TextUtils.generateTextFlow("|S:17&C:"+LangMgr.getColor("color42")+"&T:"+DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_12)+"|")):(TimerMgr.ins().remove(this.runTime,this),this.cdTime&&(this.cdTime.textFlow=TextUtils.generateTextFlow("")),this.changeAwards())},e.prototype.changeExpBar=function(){var t=DataCenter.ins().RechargeHappyConfig[this.getRechargeIndex()],e=t.val/this.chargeRate;this.time>0&&(e/=2),this.barbc.setData(payControl.happyShopRechargeToltal/this.chargeRate,e),this.barbc.setLbValueText(payControl.happyShopRechargeToltal/this.chargeRate+"/"+e)},e.prototype.getRechargeIndex=function(){for(var t=CommonUtils.getObjectLength(DataCenter.ins().RechargeHappyConfig),e=t,i=1;t>=i;i++){var o=DataCenter.ins().RechargeHappyConfig[i].val/this.chargeRate;if(this.time>0&&(o/=2),payControl.happyShopRechargeToltal<o*this.chargeRate){e=i;break}}return e},e.prototype.changeAwards=function(){var t;if(this.curIndex=this.getRechargeIndex(),this.curIndex>0){for(var e=1;e<=this.curIndex;e++)if(!payControl.getRemindByIndex(e))return t=DataCenter.ins().RechargeHappyConfig[e],this.curIndex=e,this.setAwards(t?t:t=DataCenter.ins().RechargeHappyConfig[--this.curIndex]),void this.changeBtn();t=DataCenter.ins().RechargeHappyConfig[++this.curIndex],this.setAwards(t?t:t=DataCenter.ins().RechargeHappyConfig[--this.curIndex]),this.changeBtn()}},e.prototype.setAwards=function(t){var e=this.time>0,i=t.val/this.chargeRate;e?(i=Number(t.val/this.chargeRate/2),this.discountLabel.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("happyShopSaleTile",t.val/this.chargeRate,i))):this.discountLabel.textFlow=TextUtils.generateTextFlow(""),GlobalModel.isHw?this.rmbTxt.text=t.val+"":this.rmbTxt.text=i.toString(),this.desImg.source="hlg"+t.id+"_png",this.list.dataProvider=new eui.ArrayCollection(t.rewards),payControl.getRemindByIndex(t.id)?(this.buyBtn.enabled=!1,this.buyBtn.filters=FilterUtils.ARRAY_GRAY_FILTER,this.buyBtn.label=LangMgr.getValueByKey("activitAlreadingGet")):payControl.happyShopRechargeToltal/this.chargeRate>=i?(this.buyBtn.enabled=!0,this.buyBtn.filters=[],this.buyBtn.label=LangMgr.getValueByKey("activitGet")):(this.buyBtn.enabled=!0,this.buyBtn.filters=[],this.buyBtn.label=LangMgr.getValueByKey("happyRechrga"))},e.prototype.changeBtn=function(){this.curIndex>1?(this.leftBtn.visible=!0,this.rightBtn.visible=!0,this.curIndex>=CommonUtils.getObjectLength(DataCenter.ins().RechargeHappyConfig)&&(this.rightBtn.visible=!1)):this.curIndex<=1&&(this.leftBtn.visible=!1,this.rightBtn.visible=!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];TimerMgr.ins().remove(this.runTime,this),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.leftBtn,this.onTap),this.removeEventTouchTap(this.rightBtn,this.onTap),this.removeEventTouchTap(this.buyBtn,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn0:UIMgr.ins().close(this);break;case this.leftBtn:var e=DataCenter.ins().RechargeHappyConfig[--this.curIndex];this.showVipInfo(e);break;case this.rightBtn:var i=DataCenter.ins().RechargeHappyConfig[++this.curIndex];this.showVipInfo(i);break;case this.buyBtn:var o=DataCenter.ins().RechargeHappyConfig[this.curIndex].val/this.chargeRate;this.time>0&&(o/=2),payControl.happyShopRechargeToltal/this.chargeRate>=o?payControl.getRemindByIndex(this.curIndex)||payControl.upGetHappyShopAwards(this.curIndex):(UIMgr.ins().close(this),payControl.checkOpenWin())}},e.prototype.showVipInfo=function(t){t?this.setAwards(t):this.curIndex=this.getRechargeIndex(),this.changeBtn()},e}(BaseEuiView);__reflect(MerryshopView.prototype,"MerryshopView");var MythEquipControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkLegendForgeIsOpen=function(){return SwitchMgr.ins().checkOpen(72)},e.prototype.getLegendForgePower=function(t,e){var i=[];if(t.mythForgeVo){var o=t.mythForgeVo.getSlotData(e);if(o.level){var n=DataCenter.ins().MythLevelConfig[e][o.level];i=n.attr.concat();var r=t.getEquipByIndex(e);if(r.item.configID){var a=DataCenter.ins().ItemConfig[r.item.configID],s=ItemUtils.getQuality(a);if(5==s){for(var l=ItemUtils.getBaseAttrData(a),h=[],u=0;u<r.item.att.length;u++){var c=r.item.att[u];c&&c.value>0&&h.push(new AttributeData(c.type,c.value))}l=AttributeData.AttrAddition(h,l);for(var p=0;p<l.length;p++)l[p].value=Math.floor(l[p].value*n.percent/1e4);i=AttributeData.AttrAddition(i,l)}}}}return BackpackControl.getAttrPower(i)},e.prototype.getLegendForgeTZPower=function(t){var e=0,i=this.getSkillLv(t);if(i){var o=DataCenter.ins().MythSuitConfig[i];e+=BackpackControl.getAttrPower(o.attrs),e+=o.expower||0;var n=t.getEquipByIndex(0),r=t.getEquipByIndex(2),a=[];if(n.item.configID){var s=DataCenter.ins().ItemConfig[n.item.configID],l=ItemUtils.getQuality(s);if(5==l){for(var h=ItemUtils.getBaseAttrData(s),u=[],c=0;c<n.item.att.length;c++){var p=n.item.att[c];p&&p.value>0&&u.push(new AttributeData(p.type,p.value))}h=AttributeData.AttrAddition(u,h);for(var d=0;d<h.length;d++)h[d].value=Math.floor(h[d].value*o.percent/1e4);a=a.concat(h)}}if(r.item.configID){var s=DataCenter.ins().ItemConfig[r.item.configID],l=ItemUtils.getQuality(s);if(5==l){for(var g=ItemUtils.getBaseAttrData(s),f=[],c=0;c<r.item.att.length;c++){var p=r.item.att[c];p&&p.value>0&&f.push(new AttributeData(p.type,p.value))}g=AttributeData.AttrAddition(f,g);for(var d=0;d<g.length;d++)g[d].value=Math.floor(g[d].value*o.percent/1e4);a=AttributeData.AttrAddition(a,g)}}e+=BackpackControl.getAttrPower(a)}return e},e.prototype.upLegendSlotForge=function(t,e){return[t,e]},e.prototype.downLegendSlot=function(t,e,i){var o=this.getMythForgeVo(t);o.updateSlotData(e,i),EventMgr.ins().dispatch(174,[t,e,i])},e.prototype.getMythForgeVo=function(t){var e=heroControl.getSubRoleByIndex(t).mythForgeVo;return e||(e=new MythForgeVo,e.roleId=t,heroControl.getSubRoleByIndex(t).mythForgeVo=e),e},e.prototype.getSkillLv=function(t){var e=t.mythForgeVo?t.mythForgeVo.getSlotData(0).level:0,i=t.mythForgeVo?t.mythForgeVo.getSlotData(2).level:0,o=t.getEquipByIndex(0).item.configID||0,n=t.getEquipByIndex(2).item.configID||0,r=0,a=0;return o&&5==ItemUtils.getQuality(DataCenter.ins().ItemConfig[o])&&(r=o%100),n&&5==ItemUtils.getQuality(DataCenter.ins().ItemConfig[n])&&(a=n%100),Math.min(e,i,r,a)},e.prototype.getLegendForgeNextIsEnough=function(t,e){var i=heroControl.getSubRoleByIndex(t);if(!i.mythForgeVo)return!1;var o=i.mythForgeVo.getSlotData(e),n=o.level+1,r=DataCenter.ins().MythLevelConfig[o.slot][n];if(r){var a=backpackControl.getBagGoodsCountById(0,r.costItem),s=r.costNum;return a>=s}return!1},e.prototype.dispatchLegendSelected=function(t){EventMgr.ins().dispatch(633,t)},__decorate([up(9,[1,1])],e.prototype,"upLegendSlotForge",null),__decorate([down(9,[1,1,3])],e.prototype,"downLegendSlot",null),e=__decorate([protocolsId(7)],e)}(BaseSystem);__reflect(MythEquipControl.prototype,"MythEquipControl");var MythEquipRedPoint=function(t){function e(){var e=t.call(this)||this;return e.redPoint=!1,e.forgeRoleRed=[!1,!1,!1],e.forgeRed=!1,e.legendRoleRed=[!1,!1,!1],e.legendRed=!1,e.addCustomEventMany(e.dispatchRedPoint,570,569),e.addCustomEventMany(e.dispatchLegendUpRed,267,266,268),e.addCustomEventMany(e.dispatchLegendForgeRed,174,267,266),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getRoleRed=function(t){return this.legendRoleRed[t]||this.forgeRoleRed[t]},e.prototype.dispatchRedPoint=function(){var t=this.redPoint;this.redPoint=this.legendRed||this.forgeRed,EventMgr.ins().dispatch(568,t!=this.redPoint)},e.prototype.dispatchLegendUpRed=function(){var t=!1,e=this.legendRed;this.legendRed=!1;for(var i=0;i<heroControl.subRolesLen;i++){var o=equipControl.setLegendEquipItemUpState(0,heroControl.getSubRoleByIndex(i));o||(o=equipControl.setLegendEquipItemUpState(2,heroControl.getSubRoleByIndex(i))),o||(o=equipControl.setLegendEquipItemState(0,heroControl.getSubRoleByIndex(i))),o||(o=equipControl.setLegendEquipItemState(2,heroControl.getSubRoleByIndex(i))),this.legendRoleRed[i]!=o&&(this.legendRoleRed[i]=o,t=!0),o||(o=equipControl.checkRedPointEx(5,i)),this.legendRed=this.legendRed||this.legendRoleRed[i]||o}if(!this.legendRed){var n=backpackControl.getLegendOutEquips();this.legendRed=n.length>0}EventMgr.ins().dispatch(569,t||this.legendRed!=e)},e.prototype.dispatchLegendForgeRed=function(){if(!mythEquipControl.checkLegendForgeIsOpen())return void EventMgr.ins().dispatch(570,!1);var t=!1;this.forgeRed=!1;for(var e=0;e<heroControl.subRolesLen;e++){var i=mythEquipControl.getLegendForgeNextIsEnough(e,0);i||(i=mythEquipControl.getLegendForgeNextIsEnough(e,2)),this.forgeRoleRed[e]!=i&&(this.forgeRoleRed[e]=i,t=!0),this.forgeRed=this.forgeRed||this.forgeRoleRed[e]}EventMgr.ins().dispatch(570,t)},e}(BaseSystem);__reflect(MythEquipRedPoint.prototype,"MythEquipRedPoint");var MythForgeVo=function(){function t(){this.slotData=[]}return t.prototype.init=function(t){this.slotData=[];for(var e=0;e<t.length;e++)this.slotData.push(new MythSlotVo(e,t[e]))},t.prototype.getSlotData=function(t){for(var e=0;e<this.slotData.length;e++){var i=this.slotData[e];if(i.slot==t)return i}var o=new MythSlotVo(t,0);return this.slotData.push(o),o},t.prototype.updateSlotData=function(t,e){this.getSlotData(t).level=e},t}();__reflect(MythForgeVo.prototype,"MythForgeVo");var MythSlotVo=function(){function t(t,e){this.slot=t,this.level=e}return t}();__reflect(MythSlotVo.prototype,"MythSlotVo");var MythEquipPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._roleId=0,e._curIndex=0,e.curSkillLv=0,e.curSelectedLv=0,e.states=["forge","taozhuang"],e.needCount=0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.sword,this.onTap),this.addEventTouchTap(this.amor,this.onTap),this.addEventTouchTap(this.taozhuangImg,this.onTap),this.addEventTouchTap(this.executeBtn,this.onTap),this.addEventTouchTap(this.turnBeforeBtn,this.onTap),this.addEventTouchTap(this.turnNextBtn,this.onTap);for(var i=1;4>=i;i++)this.addEventTouchTap(this.getLabel(i),this.onTap);this.addCustomEvent(174,this.updateView),this.setRoleId(t[0]||0)},e.prototype.updateView=function(t){if(!t||t[0]==this._roleId){var e=heroControl.getSubRoleByIndex(this._roleId);if(e.mythForgeVo){var i=e.mythForgeVo.getSlotData(0),o=e.mythForgeVo.getSlotData(2);this.sword.setData(this._roleId,i),this.amor.setData(this._roleId,o)}this.updatePower(),t?this.setSelectedIndex(t[1]):this.setSelectedSkill()}},e.prototype.setRoleId=function(t){this._roleId=t,this.curSelectedLv=0,this.updateView()},e.prototype.setSelectedIndex=function(t){this.currentState!=this.states[0]&&(this.amor.showBall(!0),this.sword.showBall(!0)),this.currentState=this.states[0],this.validateNow(),this.swordEquipImg.visible=this.amorEquipImg.visible=!1,this._curIndex!=t?(this.getItem(this._curIndex).setSelected(!1),this._curIndex=t,this.getItem(this._curIndex).setSelected(!0)):this.getItem(this._curIndex).isSelected||this.getItem(this._curIndex).setSelected(!0),this.setSelectSkillEff(!1);var e=heroControl.getSubRoleByIndex(this._roleId);if(e.mythForgeVo){var i=e.mythForgeVo.getSlotData(this._curIndex);
if(i.level){var o=DataCenter.ins().MythLevelConfig[i.slot][i.level];this.curState.text=o.firstName;var n="\n"+LangMgr.getValueByKey("hijiBasic")+o.percent/100+"%";this.curAttr.text=AttributeData.getAttStr(o.attr,0,1,":")+n;var r=DataCenter.ins().MythLevelConfig[i.slot][i.level+1];if(r){this.nextState.text=r.firstName;var a="\n"+LangMgr.getValueByKey("hijiBasic")+r.percent/100+"%";this.nextAttr.text=AttributeData.getAttStr(r.attr,0,1,":")+a}else this.nextState.text="",this.nextAttr.text=""}else{this.curState.text=LangMgr.getValueByKey("notmyths");var n=0==i.slot?LangMgr.getValueByKey("atkhpbasesx"):LangMgr.getValueByKey("wufangmofanghp");this.curAttr.text=n;var o=DataCenter.ins().MythLevelConfig[i.slot][i.level+1];this.nextState.text=o.firstName;var a="\n"+LangMgr.getValueByKey("hijiBasic")+o.percent/100+"%";this.nextAttr.text=AttributeData.getAttStr(o.attr,0,1,":")+a}this.updateNextNeed()}},e.prototype.updateNextNeed=function(){var t=heroControl.getSubRoleByIndex(this._roleId),e=t.mythForgeVo.getSlotData(this._curIndex),i=e.level+1,o=DataCenter.ins().MythLevelConfig[e.slot][i];if(o){this.curState.horizontalCenter=-110,this.curAttr.horizontalCenter=-110,this.arrow.visible=!0,this.costGroup.visible=this.executeBtn.visible=!0,this.maxDesc.visible=!1;var n=o.costItem,r=DataCenter.ins().ItemConfig[n];this.icon.source=r.icon+"_png";var a=backpackControl.getBagGoodsCountById(0,n),s=o.costNum,l="|C:"+(a>=s?65280:16711680)+"&T:"+a+"|/"+s;this.countLabel.textFlow=TextUtils.generateTextFlow1(l),this.setBtnEff(a>=s),this.needItem=n,this.needCount=s-a}else this.curState.horizontalCenter=0,this.curAttr.horizontalCenter=0,this.arrow.visible=!1,this.costGroup.visible=this.executeBtn.visible=!1,this.maxDesc.visible=!0,this.setBtnEff(!1)},e.prototype.setSelectedSkill=function(){this.currentState!=this.states[1]&&(this.amor.showBall(!1),this.sword.showBall(!1)),this.currentState=this.states[1],this.validateNow(),this.getItem(this._curIndex).setSelected(!1),this.setSelectSkillEff(!0),this.setBtnEff(!1),this.curSkillLv=mythEquipControl.getSkillLv(heroControl.getSubRoleByIndex(this._roleId)),this.setSkillLv(this.curSelectedLv||this.curSkillLv||1)},e.prototype.setSkillLv=function(t){if(0==this.curSkillLv)this.turnNextBtn.visible=this.turnBeforeBtn.visible=!1;else if(1==t)this.turnBeforeBtn.visible=!1,this.turnNextBtn.visible=!0;else{var e=DataCenter.ins().MythSuitConfig[t];e||(t-=1),e=DataCenter.ins().MythSuitConfig[t+1],e?t>=this.curSkillLv+1?this.turnNextBtn.visible=!1:this.turnNextBtn.visible=!0:this.turnNextBtn.visible=!1,this.turnBeforeBtn.visible=!0}this.curSelectedLv=t;var e=DataCenter.ins().MythSuitConfig[t];this.curState0.text=e.name;var i=e.percent/100,o=LangMgr.getValueByKey("bloodexcalibur",i,i);o+="|C:"+LangMgr.getColor("qualityColor5")+"&T:"+AttributeData.getAttStr(e.attrs,0,1,":"),this.curAttr0.textFlow=TextUtils.generateTextFlow1(o),this.taozhuangImg.source=e.iconImg;var n=LangMgr.getValueByKey("excaliburpartsupto")+DataCenter.ins().MythLevelConfig[0][t].firstName,r=LangMgr.getValueByKey("godspartsupto")+DataCenter.ins().MythLevelConfig[2][t].firstName,a=LangMgr.getValueByKey("nEquipTips3")+DataCenter.ins().ItemConfig[e.itemId[0]].name,s=LangMgr.getValueByKey("nEquipTips3")+DataCenter.ins().ItemConfig[e.itemId[1]].name,l=heroControl.getSubRoleByIndex(this._roleId),h=l.mythForgeVo?l.mythForgeVo.getSlotData(0).level:0,u=l.mythForgeVo?l.mythForgeVo.getSlotData(2).level:0,c=l.getEquipByIndex(0).item.configID||0,p=l.getEquipByIndex(2).item.configID||0,d=0,g=0;c&&5==ItemUtils.getQuality(DataCenter.ins().ItemConfig[c])&&(d=c%100),p&&5==ItemUtils.getQuality(DataCenter.ins().ItemConfig[p])&&(g=p%100),this.swordEquipImg.visible=this.amorEquipImg.visible=!1;var f=65280;f=h>=t?65280:16711680,this.getLabel(1).textFlow=TextUtils.generateTextFlow1("|U:&C:"+f+"&T:"+n+"|"),f=u>=t?65280:16711680,this.getLabel(2).textFlow=TextUtils.generateTextFlow1("|U:&C:"+f+"&T:"+r+"|"),t>d?f=16711680:(f=65280,this.swordEquipImg.visible=!0),this.getLabel(3).textFlow=TextUtils.generateTextFlow1("|U:&C:"+f+"&T:"+a+"|"),t>g?f=16711680:(f=65280,this.amorEquipImg.visible=!0),this.getLabel(4).textFlow=TextUtils.generateTextFlow1("|U:&C:"+f+"&T:"+s+"|")},e.prototype.getLabel=function(t){return this["require"+t]},e.prototype.setSelectSkillEff=function(t){t?(this.skillSelMc=this.skillSelMc||new GameMovieClip,this.skillSelectEff.addChild(this.skillSelMc),this.skillSelMc.playFile(PATH_EFF+"quaeff5",-1)):this.skillSelMc&&this.skillSelMc.parent&&this.skillSelMc.parent.removeChild(this.skillSelMc)},e.prototype.setBtnEff=function(t){t?(this.btnMc=this.btnMc||new GameMovieClip,this.btnMc.scaleX=1.05,this.btnMc.scaleY=1,this.btnMc.x=this.executeBtn.x+this.executeBtn.width/2,this.btnMc.y=this.executeBtn.y+this.executeBtn.height/2,this.addChild(this.btnMc),this.btnMc.playFile(PATH_EFF+"chargeff1",-1)):this.btnMc&&this.btnMc.parent&&this.btnMc.parent.removeChild(this.btnMc)},e.prototype.onTap=function(t){t.currentTarget==this.sword||t.currentTarget==this.require1?this.setSelectedIndex(0):t.currentTarget==this.amor||t.currentTarget==this.require2?this.setSelectedIndex(2):t.currentTarget==this.taozhuangImg?this.setSelectedSkill():t.currentTarget==this.turnBeforeBtn?this.setSkillLv(this.curSelectedLv-1):t.currentTarget==this.turnNextBtn?this.setSkillLv(this.curSelectedLv+1):t.currentTarget==this.executeBtn?this.needCount<=0?mythEquipControl.upLegendSlotForge(this._roleId,this._curIndex):warnControl.setBuyGoodsWarn(this.needItem,this.needCount):t.currentTarget==this.require3?mythEquipControl.dispatchLegendSelected(0):t.currentTarget==this.require4&&mythEquipControl.dispatchLegendSelected(2)},e.prototype.getItem=function(t){return 0==t?this.sword:2==t?this.amor:void 0},e.prototype.updatePower=function(){var t=0,e=heroControl.getSubRoleByIndex(this._roleId);t+=mythEquipControl.getLegendForgePower(e,0),t+=mythEquipControl.getLegendForgePower(e,2),t+=mythEquipControl.getLegendForgeTZPower(e),this.powerPanel.setPower(t)},e.prototype.close=function(){this.removeCustomEvents()},e}(BasePanel);__reflect(MythEquipPanel.prototype,"MythEquipPanel");var MythEquipView=function(t){function e(){var e=t.call(this)||this;return e.selectIndex=-1,e.skinName="MythEquipViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t[0]||0,o=t[1]||0;this.roleSelect.setCurRole(o),this.tab.selectedIndex=this.viewStack.selectedIndex=i,this.addCustomEvent(569,this.updateRed),this.addCustomEvent(570,this.updateRed),this.addCustomEvent(633,this.setSelected),this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addEventChange(this.roleSelect,this.switchRole),this.setSelectedIndex(i),this.updateRed()},e.prototype.onTap=function(t){t.currentTarget==this.closeBtn?UIMgr.ins().close(this):t.currentTarget==this.help&&HelpControl.openHelpWin(50)},e.prototype.onTabTouch=function(t){this.setSelectedIndex(this.tab.selectedIndex)},e.prototype.onTabTouching=function(t){},e.prototype.switchRole=function(){var t=this.roleSelect.getCurRole();this.viewStack.getChildAt(this.tab.selectedIndex).setRoleId(t)},e.prototype.setSelected=function(t){this.viewStack.selectedIndex=this.tab.selectedIndex=0,this.setSelectedIndex(0,t)},e.prototype.setSelectedIndex=function(t,e){this.selectIndex>=0&&this.viewStack.getChildAt(this.selectIndex).close(),this.selectIndex=t;var i=this.viewStack.getChildAt(t);i.open(this.roleSelect.getCurRole(),e),this.help.visible=1==this.selectIndex,this.updateRed()},e.prototype.updateRed=function(){this.redPoint0.visible=MythEquipRedPoint.ins().legendRed,this.redPoint1.visible=MythEquipRedPoint.ins().forgeRed;for(var t=0;t<heroControl.subRolesLen;t++)0==this.viewStack.selectedIndex?this.roleSelect.showRedPoint(t,MythEquipRedPoint.ins().legendRoleRed[t]):1==this.viewStack.selectedIndex&&this.roleSelect.showRedPoint(t,MythEquipRedPoint.ins().forgeRoleRed[t])},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.selectedIndex>=0&&this.viewStack.getElementAt(this.viewStack.selectedIndex).close()},e}(BaseEuiView);__reflect(MythEquipView.prototype,"MythEquipView");var MythEquipSlotItemRenderer=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.effs=[],e._isSelected=!1,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.setSelected(!1)},e.prototype.setData=function(t,e){0==e.slot?this.currentState="sword":this.currentState="amor",this.validateNow();for(var i=0;7>i;i++)this.setPointOpen(i,i<e.level,e.level);var o=heroControl.getSubRoleByIndex(t).getEquipByIndex(e.slot);if(o.item.configID&&5==ItemUtils.getQuality(DataCenter.ins().ItemConfig[o.item.configID])){var n=DataCenter.ins().ItemConfig[o.item.configID];this.swordLevel.text=n.name,this.mc||(this.mc=new GameMovieClip),this.mc.parent||(this.weaponEff.addChild(this.mc),this.mc.playFile(PATH_EFF+"chuanqizbeff",-1))}else this.mc&&this.mc.parent&&this.mc.parent.removeChild(this.mc),this.swordLevel.text=LangMgr.getValueByKey("noequipment");this.redPoint.visible=mythEquipControl.getLegendForgeNextIsEnough(t,e.slot)},e.prototype.setSelected=function(t){this._isSelected=t,this.Select.visible=t},e.prototype.showBall=function(t){this.level.visible=t,t?(this.level.alpha=0,egret.Tween.get(this.level).to({alpha:1},1e3)):(this.level.alpha=0,egret.Tween.removeTweens(this.level))},Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._isSelected},enumerable:!0,configurable:!0}),e.prototype.getPoint=function(t){return this["point_"+t]},e.prototype.setPointOpen=function(t,e,i){var o=this.getPoint(t);o.source=e?"le_point2":"le_point1";var n=this.effs[t],r=i/7>>0,a=i%7,s=r?0==a?r-1:r:"";s=s?s:"",e?(this.effs[t]=n=n||new GameMovieClip,n.x=o.x+20,n.y=o.y+18,n.scaleX=n.scaleY=.7,n.parent||this.level.addChild(n),n.playFile(PATH_EFF+("feishengfire"+s),-1)):n&&n.parent&&n.parent.removeChild(n)},e}(eui.Component);__reflect(MythEquipSlotItemRenderer.prototype,"MythEquipSlotItemRenderer");var OfficeControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.officeDatas=[],e.titles=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downInfo=function(t,e,i){var o=heroControl.getSubRoleByJob(t);o&&(o.guanZhiLv=e),this.officeDatas[t]={job:t,idx:e,dailyAward:i},EventMgr.ins().dispatch(176,t)},e.prototype.upUpgrade=function(t){return[t]},e.prototype.upGetDaiylyAward=function(t){return[t]},e.prototype.open=function(){return reincarnateControl.lv>=DataCenter.ins().OfficeBaseConfig.zsLevel&&GameServer.serverOpenDay>=DataCenter.ins().OfficeBaseConfig.openDay-1},e.prototype.getAttrStr=function(t,e,i){void 0===i&&(i="+");for(var o=DataCenter.ins().OfficeLevelConfig[t][e],n=o.attr,r="",a="",s=0;s<n.length;s++){var l=n[s];86==l.type||16==l.type?(""!=a&&(a+="\n"),a+=AttributeData.getAttStrByType(l,0,i)):(""!=r&&(r+="\n"),r+=AttributeData.getAttStrByType(l,0,i))}return{str:r,exStr:a}},e.prototype.getPower=function(t){if(!t.guanZhiLv)return 0;var e=DataCenter.ins().OfficeLevelConfig[t.job][t.guanZhiLv];return BackpackControl.getAttrPower(e.attr)+ItemUtils.calculateRelatePower(e.attr,t)},e.prototype.checkItemIdCanDestroy=function(t){if(heroControl.subRolesLen<GlobalModel.roleNum)return!1;for(var e=heroControl.roles,i=DataCenter.ins().OfficeLevelConfig,o=0;o<e.length;o++){var n=e[o];if(0==n.guanZhiLv)return!1;for(var r=i[n.job],a=n.guanZhiLv+1;r[a];){if(r[a].costId==t)return!1;a+=1}}return!0},e.prototype.getTitle=function(t){var e=this.getTitleIdx(t),i=DataCenter.ins().OfficeLevelConfig[t.job][e];return i&&i.title?titleControl.getTitleByItemId(i.title):null},e.prototype.getRoleTitles=function(t){if(0==this.titles.length)for(var e in DataCenter.ins().OfficeLevelConfig){var i=DataCenter.ins().OfficeLevelConfig[e];this.titles[+e]=this.titles[+e]||[];for(var o in i)i[o].title&&this.titles[+e].push(i[o].idx);this.titles[+e].sort(function(t,e){return e>t?-1:1})}return this.titles[t]},e.prototype.getTitleIdx=function(t,e){void 0===e&&(e=0);for(var i=this.getRoleTitles(t.job),o=0,n=0;n<i.length;n++){var r=i[n];if(r>t.guanZhiLv){1==e&&(o=r);break}o=r}return o},__decorate([down(1,[3,3,3])],e.prototype,"downInfo",null),__decorate([up(2,[3])],e.prototype,"upUpgrade",null),__decorate([up(3,[3])],e.prototype,"upGetDaiylyAward",null),e=__decorate([protocolsId(31)],e)}(BaseSystem);__reflect(OfficeControl.prototype,"OfficeControl");var OfficeRedPoint=function(t){function e(){var e=t.call(this)||this;return e.isOpen=!1,e.isRed={},e.upgradeRed={},e.awardRed={},e.addCustomEventMany(e.dispatchOpen,466,112),e.addCustomEventMany(e.dispatchRedPoint,635,636),e.addCustomEvent(176,e.update),e.addCustomEventMany(e.update,700),e.addCustomEventMany(e.dispatchUpgradeRed,267,266,268),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.update=function(t){this.isOpen&&(this.dispatchDailyAwardRed(t),this.dispatchUpgradeRed(t))},Object.defineProperty(e.prototype,"redPoint",{get:function(){for(var t in this.isRed)if(this.isRed[t])return!0;return!1},enumerable:!0,configurable:!0}),e.prototype.getRed=function(t){return!!this.isRed[t]},e.prototype.getAwardRP=function(t){return!!this.awardRed[t]},e.prototype.getUpgradeRP=function(t){return!!this.upgradeRed[t]},e.prototype.dispatchOpen=function(){var t=this.isOpen;this.isOpen||(this.isOpen=officeControl.open()),t!=this.isOpen&&EventMgr.ins().dispatch(700,!0)},e.prototype.dispatchRedPoint=function(){for(var t=heroControl.roles,e=0;e<t.length;e++){var i=t[e];i&&(this.isRed[i.job]=this.upgradeRed[i.job]||this.awardRed[i.job])}EventMgr.ins().dispatch(634)},e.prototype.dispatchDailyAwardRed=function(t){if(!this.isOpen)return!1;if(void 0!=t){var e=this.awardRed[t];if(this.awardRed[t]=this.getDailyAwardRed(t),e!=this.awardRed[t])return void EventMgr.ins().dispatch(635,!0)}for(var i=!1,o=heroControl.roles,n=0;n<o.length;n++){var r=o[n];if(r){var e=this.awardRed[r.job];this.awardRed[r.job]=this.getDailyAwardRed(r.job),e!=this.awardRed[r.job]&&(i=!0)}}i&&EventMgr.ins().dispatch(635,i)},e.prototype.getDailyAwardRed=function(t){if(!this.isOpen)return!1;var e=officeControl.officeDatas[t];if(!e)return!1;var i=DataCenter.ins().OfficeLevelConfig[t][e.idx];if(i){var o=DataCenter.ins().OfficeDayAwardConfig[i.stage];if(0==e.dailyAward&&o&&o.award&&o.award.length)return!0}return!1},e.prototype.dispatchUpgradeRed=function(t){if(!this.isOpen)return!1;if(void 0!=t){var e=this.upgradeRed[t];if(this.upgradeRed[t]=this.getUpgradeRed(t),e!=this.upgradeRed[t])return void EventMgr.ins().dispatch(636,!0)}for(var i=!1,o=heroControl.roles,n=0;n<o.length;n++){var r=o[n];if(r){var e=this.upgradeRed[r.job];this.upgradeRed[r.job]=this.getUpgradeRed(r.job),e!=this.upgradeRed[r.job]&&(i=!0)}}i&&EventMgr.ins().dispatch(636,i)},e.prototype.getUpgradeRed=function(t){if(!this.isOpen)return!1;var e=officeControl.officeDatas[t];if(!e)return!1;var i=DataCenter.ins().OfficeLevelConfig[t][e.idx+1];return i&&backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.costId)>=i.costCount?!0:!1},e}(BaseSystem);__reflect(OfficeRedPoint.prototype,"OfficeRedPoint");var OfficeDailyAwardView=function(t){function e(){var e=t.call(this)||this;return e.curJob=0,e.skinName="OfficeDailyAwardViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t){this.curJob=t,this.addEventTouchTap(this.getBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap);for(var e=officeControl.officeDatas[t],i=officeControl.getRoleTitles(t),o=[],n=0;n<i.length;n++){var r=i[n],a=DataCenter.ins().OfficeLevelConfig[t][r];if(DataCenter.ins().OfficeDayAwardConfig[a.stage]&&o.push({job:t,idx:r}),r>e.idx)break}this.displayList.itemRenderer=OfficeDailyAwardItemRenderer,this.displayList.dataProvider=new eui.ArrayCollection(o),0==e.dailyAward?(this.getBtn.enabled=!0,this.getBtn.label=LangMgr.getValueByKey("activitGet1")):(this.getBtn.enabled=!1,this.getBtn.label=LangMgr.getValueByKey("activitAlreadingGet"))},e.prototype.onTap=function(t){if(t.currentTarget==this.getBtn){if(backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH)return void UIMgr.ins().open("BackpackFullTipsView",BackpackControl.BAG_ENOUGH);officeControl.upGetDaiylyAward(this.curJob),UIMgr.ins().close(this)}else t.currentTarget==this.bgClose&&UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(OfficeDailyAwardView.prototype,"OfficeDailyAwardView");var OfficePositionView=function(t){function e(){var e=t.call(this)||this;return e.curRole=0,e.curJob=1,e.isEnought=!1,e.lastObj={job:0,stage:0},e.isTopLevel=!0,e.skinName="OfficePositionViewSkin",e.getLabel.textFlow=(new egret.HtmlTextParser).parser("<u>"+e.getLabel.text+"</u>"),e}return __extends(e,t),e.prototype.open=function(t){void 0===t&&(t=0),this.curRole=t||0,this.roleSelect.setCurRole(t),this.addEventChange(this.roleSelect,this.setSelected),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.practiseBtn2,this.onTap),this.addEventTouchTap(this.upGradeBtn0,this.onTap),this.addEventTouchTap(this.titleName,this.onTap),this.addEventTouchTap(this.icon0,this.onTap),this.addEventTouchTap(this.countLabel0,this.onTap),this.addEventTouchTap(this.getLabel,this.onTap),this.addCustomEvent(634,this.updateRed),this.addCustomEvent(636,this.updateRed),this.addCustomEvent(176,this.updateView),this.updateView(),this.updateRed()},e.prototype.updateView=function(){this.curJob=heroControl.getSubRoleByIndex(this.curRole).job;var t=officeControl.officeDatas[this.curJob];if(t){var e=DataCenter.ins().OfficeLevelConfig[this.curJob][t.idx],i=DataCenter.ins().OfficeLevelConfig[this.curJob][t.idx+1];if(this.lastObj.job==this.curJob&&this.lastObj.stage&&this.lastObj.stage<e.stage&&this.onUpgrade(),this.lastObj.job=this.curJob,this.lastObj.stage=e.stage,0==t.idx?(!this.nextGroup.parent&&this.nowGroup.parent&&(this.nowGroup.parent.addChild(this.nextGroup),RecycleMgr.ins().reloadContainer(this.nextGroup)),DisplayUtils.removeFromParent(this.nowGroup),this.arrow.visible=!1):(this.nowGroup.parent||(this.nextGroup.parent.addChildAt(this.nowGroup,0),RecycleMgr.ins().reloadContainer(this.nowGroup)),this.arrow.visible=!0),e){this.lvlNow.text=LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(e.stage))+LangMgr.getValueByKey("numberLevel",StringUtils.NumberToChinese(e.level));var o="";if(e.attr&&e.attr.length){var n=officeControl.getAttrStr(this.curJob,t.idx);o+=n.str+"\n"+("|C:0xee00ff&T:"+n.exStr+"|")}this.attrNow.textFlow=TextUtils.generateTextFlow1(o)}if(i){this.nextGroup.parent||(this.nowGroup.parent.addChild(this.nextGroup),RecycleMgr.ins().reloadContainer(this.nextGroup)),this.upInfo.visible=this.nextTitleGroup.visible=!0,this.lvlNext.text=LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(i.stage))+LangMgr.getValueByKey("numberLevel",StringUtils.NumberToChinese(i.level));var o="";if(i.attr&&i.attr.length){var n=officeControl.getAttrStr(this.curJob,t.idx+1);o+=n.str+"\n"+("|C:0xee00ff&T:"+n.exStr+"|")}this.attrNext.textFlow=TextUtils.generateTextFlow1(o);var r=backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.costId),a=3532333;r<i.costCount&&(a=16580618),this.isEnought=r>=i.costCount,this.countLabel0.textFlow=TextUtils.generateTextFlow1("|C:"+a+"&T:"+r+"|/"+i.costCount),this.icon0.source=DataCenter.ins().ItemConfig[i.costId].icon+"_png",this.lbOver.visible=!1}else DisplayUtils.removeFromParent(this.nextGroup),this.upInfo.visible=this.nextTitleGroup.visible=!1,this.lbOver.visible=!0;this.nextTitleIdx=officeControl.getTitleIdx(heroControl.getSubRoleByIndex(this.curRole),1);var s=DataCenter.ins().OfficeLevelConfig[this.curJob][this.nextTitleIdx];this.tpisLevel.text=LangMgr.getValueByKey("stageNumberTxt",StringUtils.NumberToChinese(s.stage))+LangMgr.getValueByKey("numberLevel",StringUtils.NumberToChinese(s.level));var l=titleControl.getTitleByItemId(s.title);this.titleName.text="【"+l.name+"】",l.img?(this.title.source=l.img,this.titleEff.visible=!1,this.title.visible=!0,this.addEventTouchTap(this.title,this.onTap)):(this.titleMc=this.titleMc||new GameMovieClip,this.titleMc.playFile(PATH_EFF+l.eff,-1),this.titleEff.addChild(this.titleMc),this.titleEff.visible=!0,this.title.visible=!1,this.titleMc.touchEnabled=!0,this.addEventTouchTap(this.titleMc,this.onTap)),this.dailyRedPoint.visible=OfficeRedPoint.ins().getDailyAwardRed(this.curJob),this.btnRedPoint.visible=OfficeRedPoint.ins().getUpgradeRed(this.curJob),this.powerPanel.setPower(officeControl.getPower(heroControl.getSubRoleByIndex(this.curRole)))}},e.prototype.setSelected=function(t){t.data!=this.curRole&&(this.curRole=t.data,this.updateView())},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this);break;case this.practiseBtn2:var e=officeControl.officeDatas[this.curJob],i=DataCenter.ins().OfficeLevelConfig[this.curJob][e.idx];if(DataCenter.ins().OfficeDayAwardConfig[i.stage]&&DataCenter.ins().OfficeDayAwardConfig[i.stage].award.length)UIMgr.ins().open(OfficeDailyAwardView,this.curJob);else{var o=DataCenter.ins().OfficeLevelConfig[this.curJob][this.nextTitleIdx].title,n=titleControl.getTitleByItemId(o);tipsControl.showTips(LangMgr.getValueByKey("office1",n.name))}break;case this.upGradeBtn0:if(!this.isEnought)return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));officeControl.upUpgrade(this.curJob);break;case this.titleName:case this.titleMc:case this.title:var r=DataCenter.ins().OfficeLevelConfig[this.curJob][this.nextTitleIdx];if(r&&r.title){var a=new ItemBase;a.data=r.title,a.onClick()}break;case this.icon0:case this.countLabel0:var s=officeControl.officeDatas[this.curJob];if(s){var l=DataCenter.ins().OfficeLevelConfig[this.curJob][s.idx+1];if(l){var a=new ItemBase;a.data=l.costId,a.onClick()}}break;case this.getLabel:var h=officeControl.officeDatas[this.curJob],u=DataCenter.ins().OfficeLevelConfig[this.curJob][h.idx+1];u&&UIMgr.ins().open(ShopWarnView).setData(u.costId)}},e.prototype.onUpgrade=function(){var t=officeControl.getTitle(heroControl.getSubRoleByIndex(this.curRole));t&&CommonFun.show(1,t.name,t.img,t.eff,!0,null,0,-100)},e.prototype.updateRed=function(){for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t);this.roleSelect.showRedPoint(e.index,OfficeRedPoint.ins().getRed(e.job))}this.dailyRedPoint.visible=OfficeRedPoint.ins().getAwardRP(this.curJob),this.btnRedPoint.visible=OfficeRedPoint.ins().getUpgradeRP(this.curJob)},e}(BaseEuiView);__reflect(OfficePositionView.prototype,"OfficePositionView");var OfficeDailyAwardItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.dataChanged=function(){var t=DataCenter.ins().OfficeLevelConfig[this.data.job][this.data.idx],e=DataCenter.ins().OfficeDayAwardConfig[t.stage],i=titleControl.getTitleByItemId(t.title);this.levelName.text=i.name,this.rewardList.itemRenderer=ItemBase,this.rewardList.dataProvider=new eui.ArrayCollection(e.award.concat());var o=officeControl.officeDatas[this.data.job];this.currentGroup.visible=DataCenter.ins().OfficeLevelConfig[o.job][o.idx].stage==t.stage},e}(BaseItemRender);__reflect(OfficeDailyAwardItemRenderer.prototype,"OfficeDailyAwardItemRenderer");var OfflineRewardView=function(t){function e(){var e=t.call(this)||this;return e.arr=[],e.skinName="OfflineRewardViewSkin",e.uilayer=GameLayer.MAIN2,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.okBtn,this.onClick),this.addCustomEvent(466,this.updateYBText),this.arr=t[0],this.coin=t[1];for(var i=0;i<this.coin.length;i++)if(4==this.coin[i].id){this.arr.push(this.coin[i].count);break}this.update()},e.prototype.updateYBText=function(){this.ybTextGroup.visible=smeltControl.checkOpenSystem()},e.prototype.update=function(){this.time.text=LangMgr.getValueByKey("offLineTime",DateUtils.getFormatBySecond(this.arr[0],DateUtils.TIME_FORMAT_9)),this.equipNum.text=""+(this.arr[3]+this.arr[4]),this.jinglianshiNum.text=""+(this.arr[6]?this.arr[6]:0),0==this.arr[4]?this.bagFull.visible=!1:(this.bagFull.visible=!0,this.bagFull.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("smeltingAuto",this.arr[4])));var t=this.arr[1],e=this.arr[2];if(this.arr[5].length>0){for(var i=0;i<this.arr[5].length;i++){var o=this.arr[5][i];1==o.type?(this.label4.text=o.gold,this.label6.text=o.exp):2==o.type?(this.label3.text=o.gold,this.label5.text=o.exp):3==o.type?(t+=o.exp,e+=o.gold):4==o.type?(t+=o.exp,e+=o.gold):5==o.type&&(t+=o.exp,e+=o.gold)}this.exp.text=""+t,this.money.text=""+e}},e.prototype.onClick=function(){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(OfflineRewardView.prototype,"OfflineRewardView");var RambleBlackControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._blackList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkIsBlack=function(t){for(var e=0;e<this._blackList.length;e++){var i=this._blackList[e];if(i.roleId==t)return!0}return!1},e.prototype.getBlackList=function(){return this._blackList},e.prototype.downBlackList=function(t){this._blackList.length=t.length;for(var e=0;t.length>e;e++)this._blackList[e]=this._blackList[e]||new RambleKfBlackVo,this._blackList[e].init(t[e]),this._blackList[e].index=e+1;this._blackList.sort(function(t,e){return t.time<e.time?1:-1}),EventMgr.ins().dispatch(637)},e.prototype.upAddBlackRole=function(t){return[t.id,t.servId,t.name,t.job,t.sex,t.zsLevel,t.lv]},e.prototype.upDelBlackRole=function(t){return[t]},__decorate([down(10,[ByteConst.RambleKfBlackVos])],e.prototype,"downBlackList",null),__decorate([up(10,[6,3,8,1,1,1,2])],e.prototype,"upAddBlackRole",null),__decorate([up(11,[2])],e.prototype,"upDelBlackRole",null),e=__decorate([protocolsId(30)],e)}(BaseSystem);__reflect(RambleBlackControl.prototype,"RambleBlackControl");var RambleControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isShowTip=!1,e.chatInterval=5e3,e.charMax=50,e.canSpeak=!0,e.UpSpeak="",e._chatListData=new eui.ArrayCollection,e._systemListData=new eui.ArrayCollection,e._chatListData2=new eui.ArrayCollection,e._kfListData=new eui.ArrayCollection,e.curListData=new eui.ArrayCollection,e.canSpeakTime=0,e.kfNoReadMsgList=[],e.allChatOpen=!0,e.chatPoolDic={},e}return __extends(e,t),e.prototype.initLogin=function(){var t=this;egret.callLater(function(){t.removeAllChatByType(8)},this)},e.ins=function(){return t.ins.call(this)},e.prototype.upChatInfo=function(t,e,i){return void 0===i&&(i=0),e.length<=0?void tipsControl.showTips(LangMgr.getValueByKey("customChatContent1")):"@"==e.charAt(0)?void this.upGm(e):this.checkCanSpeak()?(this.upChat(t,e,i),void((7==t||10==t)&&this.isCanSpeak()&&this.checkChatSend(e,1,!0))):void this.chatLimit(t,e)},e.prototype.upGm=function(t){return[t]},e.prototype.upChat=function(t,e,i){return[t,i,e]},e.prototype.downNewChatMsg=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new RambleInfoVo;i.init(t),-1==partnerControl.indexOfBlackList(i.id)&&this.insertChatMsg(i),i.id==ActorControl.actorID&&this.checkChatSend(i.str,1,!1)},e.prototype.insertChatMsg=function(t){if(10==t.type){if(rambleBlackControl.checkIsBlack(t.id))return;this.insertMsg(this._kfListData,t),this.kfNoReadMsgList.push(t)}else this.insertMsg(this._chatListData,t);t.id==ActorControl.actorID&&rambleControl.startInterval(),this.dispatchNewChatMsg(t)},e.prototype.insertMsg=function(t,e,i){if(void 0==i&&(i=this.charMax),t.length>=i){var o=t.removeItemAt(0);this.removeAllChatMsg(o)}this.addWorldChat(e)},e.prototype.sortAllChatMsg=function(){this._chatListData2.refresh()},e.prototype.removeAllChatMsg=function(t){var e=this._chatListData2.getItemIndex(t);if(e>=0&&this._chatListData2.removeItemAt(e),UIMgr.ins().isShow(RambleMainView)){var i=UIMgr.ins().getView(RambleMainView);i.updateNewChatMsg()}},e.prototype.removeChatWithId=function(t){this.removeChatById(this._chatListData,t),this.removeChatById(this._chatListData2,t),this.removeChatById(this._kfListData,t)},e.prototype.removeChatById=function(t,e){if(t&&t.length){for(var i=[],o=0;o<t.length;o++){var n=t.getItemAt(o);n instanceof UnionMessageInfoVo?n.roleId!=e&&i.push(n):n.id!=e&&i.push(n)}t.source=i,t.refresh()}},e.prototype.dispatchNewChatMsg=function(t){EventMgr.ins().dispatch(226,t)},e.prototype.downSystemInfo=function(){},e.prototype.downIsSendSuccess=function(t){t&&this.dispatchSendInfoSuccess()},e.prototype.dispatchSendInfoSuccess=function(){EventMgr.ins().dispatch(643)},e.prototype.downSystemMessage=function(t,e,i){if(0==t||ActorControl.level>=t)switch(e){case 512:if(tipsControl.showBottomCenterTips(i),crossArenaControl.isKFArena){var o=new RambleSystemVo(0,i);copyControl.chatCampDtList.addItem(o),this.dispatchNewChatMsg(o)}break;case 8:tipsControl.showCenterTips2(i);break;case 4:ErrorUtils.ins().show(i);break;case 2:tipsControl.showCenterTips(i);break;default:tipsControl.showTips(i)}},e.prototype.downCannotSpeak=function(t){this.canSpeakTime=t},e.prototype.downRemoveRoleChat=function(t){this.removeRoleChat(t)},e.prototype.removeRoleChat=function(t){this.removeChatWithId(t),unionControl.removeMsgWithId(t),partnerControl.removeMsgWithId(t)},e.prototype.downAllChatMsg=function(t){for(var e=[],i=0;i<t.length;i++){var o=new RambleInfoVo;o.init(t[i]),-1!=partnerControl.indexOfBlackList(o.id)||RambleBlackControl.ins().checkIsBlack(o.id)||e.push(o)}this.initWorldChat(e),this.chatListData.length&&this.dispatchNewChatMsg(this.chatListData.getItemAt(this.chatListData.length-1))},e.prototype.isCanSpeak=function(){return this.canSpeakTime&&this.canSpeakTime>GameServer.serverTime/DateUtils.MS_PER_SECOND?!1:!0},Object.defineProperty(e.prototype,"chatListData",{get:function(){return this._chatListData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chatListData2",{get:function(){return this._chatListData2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"kfListData",{get:function(){return this._kfListData},enumerable:!0,configurable:!0}),e.prototype.setCurListData=function(t){this.curListData=t;var e;UIMgr.ins().isShow(RambleUIView)&&(e=UIMgr.ins().getView(RambleUIView),e.updataList()),UIMgr.ins().isShow(RambleMainView)&&(e=UIMgr.ins().getView(RambleMainView),e.updataList())},Object.defineProperty(e.prototype,"chatListTip",{get:function(){var t,e,i=this._chatListData.length,o=GlobalModel.chatShowNum;return i>o?(t=i-o,e=i):(t=0,e=i),this._chatListData.source.slice(t,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chatListTip2",{get:function(){var t=this._chatListData2;copyControl.isFBChatChannle()&&(t=copyControl.chatCampDtList),t||(t=new eui.ArrayCollection([]));var e,i,o=t.length,n=GlobalModel.chatShowNum;return o>n?(e=o-n,i=o):(e=0,i=o),t.source.slice(e,i)},enumerable:!0,configurable:!0}),e.prototype.startInterval=function(){this.canSpeak=!1,TimerMgr.ins().doTimer(this.chatInterval,1,this.timeDo,this)},e.prototype.timeDo=function(){this.canSpeak=!0},e.prototype.dispatchSysChatMsg=function(t){if(this._systemListData.length>=this.charMax){var e=this._systemListData.removeItemAt(0);this.removeAllChatMsg(e)}this.addSystemNotice(t),EventMgr.ins().dispatch(227,t)},Object.defineProperty(e.prototype,"systemListData",{get:function(){return this._systemListData},enumerable:!0,configurable:!0}),e.prototype.checkRepeatString=function(t){var e=t.length;if(10>=e)return!0;for(var i=0,o=0;e>o;o++){var n=t.charAt(o);-1!=this.UpSpeak.lastIndexOf(n)&&++i}return i>=10?(tipsControl.showTips(LangMgr.getValueByKey("customChatRepeatContent")),!1):!0},e.prototype.getWorldStr=function(){return crossFieldControl.isCross||crossBossControl.isKFBossBattle?LangMgr.getValueByKey("chatMenu2"):LangMgr.getValueByKey("chatMenu1")},e.prototype.checkChatSend=function(t,e,i){void 0===i&&(i=!1);var o=this.chatPoolDic[e]=this.chatPoolDic[e]||[];
if(i)o.push(t);else{var n=o.indexOf(t);n>=0?(ReportData.getIns().reportChatInfo(e,t),o.splice(0,n+1)):o.length>0&&(ReportData.getIns().reportChatInfo(e,t),o.splice(0,1))}},e.prototype.checkChatIsOpen=function(t){return void 0===t&&(t=!0),!0},e.prototype.upFace=function(t,e){if(e&&e.length){if(!this.checkCanSpeak()){for(var i="",o=0;o<e.length;o++){var n=e[o];i+="#"+n+"#"}return this.chatLimit(t,i),!1}return[t,e]}return!1},e.prototype.checkFaces=function(t,e){if(!e&&!e.length)return!1;if(!rambleControl.canSpeak)return tipsControl.showTips(LangMgr.getValueByKey("customChatFirst")),!0;if(-1!=e.indexOf("@"))return!1;if(copyControl.isFBChatChannle())return!1;var i=e.match(RambleEmojiRiceTextVo.CHAT_EMOJI);if(!i||!i.length)return!1;for(var o=i.length,n=0,r=[],a=0;o>a;a++){var s=i[a];n+=s.length,r.push(Number(s.match(StringUtils.REG_NUM)))}if(n==e.length){if(r.length>DataCenter.ins().RambleConstConfig.emojiMax)return tipsControl.showTips(LangMgr.getValueByKey("chatEmojisMax")),!0;var l=0;return 4==t?l=3:(l=2==t?10:7,rambleControl.UpSpeak=e),this.upFace(l,r),!0}return!1},e.prototype.checkSendMsg=function(t){return!0},e.prototype.canKfNoReadTip=function(){return this.kfNoReadMsgList.length>0&&ServerStorage.ins().getBitBool(ClientSetBit.kf_chat_tips)&&crossBossControl.isOpen()},e.prototype.checkAllChatOpen=function(t){return void 0===t&&(t=!0),!this.allChatOpen&&t&&tipsControl.showTips(LangMgr.getValueByKey("chatCloseFunc")),this.allChatOpen},e.prototype.checkCanSpeak=function(){return rambleControl.isCanSpeak()},e.prototype.chatLimit=function(t,e,i){switch(t){case 10:case 7:this.insertWorldChat(t,e);break;case 3:this.insertGuildChat(e);break;case 0:partnerControl.paserChatMsg(1,i,DateUtils.formatServerTime(GameServer.serverTime),e),partnerControl.dispatchFriendChange();break;case 8:this.insertCampChat(i,e)}},e.prototype.insertWorldChat=function(t,e){var i=heroControl.getSubRoleByIndex(0),o=new RambleInfoVo;o.type=t,o.id=ActorControl.actorID,o.servId=GlobalModel.srvid,o.name=ActorControl.myName,o.job=i.job,o.sex=i.sex,o.vip=vipControl.lv,o.monthCard=0,o.ladderLevel=0,o.isFirst=0,o.zsLevel=reincarnateControl.lv,o.lv=ActorControl.level,o.guild=unionControl.guildName,o.pointId=0,o.str=e,o.setNowTime(),rambleControl.insertChatMsg(o)},e.prototype.insertGuildChat=function(t){var e=heroControl.getSubRoleByIndex(0),i=new UnionMessageInfoVo;i.type=1,i.roleId=ActorControl.actorID,i.name=ActorControl.myName,i.job=e.job,i.sex=e.sex,i.office=unionControl.myOffice,i.vipLevel=vipControl.lv,i.monthCard=0,i.zsLevel=reincarnateControl.lv,i.lv=ActorControl.level,i.guildName=unionControl.guildName,i.str=t,i.setNowTime(),unionControl.addChatMsg(i),rambleControl.startInterval()},e.prototype.insertCampChat=function(t,e){var i=new RambleCampVo;i.str=e,i.type=t,i.name=ActorControl.myName,i.servId=GlobalModel.srvid,i.setNowTime(),copyControl.insertFbChat(i)},Object.defineProperty(e.prototype,"guildChatList",{get:function(){return unionControl.guildMessageInfoData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"campChatList",{get:function(){return copyControl.chatCampDtList},enumerable:!0,configurable:!0}),e.prototype.initWorldChat=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.insertWorldChatMessage(i)}this.chatListData.refresh(),this.chatListData2.refresh()},e.prototype.initGuildChat=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.insertGuildChatMessage(i)}this.guildChatList.refresh(),this.chatListData2.refresh()},e.prototype.initSystemNotice=function(t){for(var e=0;e<t.length;e++){var i=t[e];this.insertSystemNoticeMessage(i)}this.systemListData.refresh(),this.chatListData2.refresh()},e.prototype.addWorldChat=function(t){10==t.type?this.kfListData.addItem(t):this.chatListData.addItem(t),this.chatListData2.addItem(t)},e.prototype.addGuildChat=function(t){this.guildChatList.addItem(t),this.chatListData2.addItem(t)},e.prototype.addCampChat=function(t){this.campChatList.addItem(t),this.chatListData2.addItem(t)},e.prototype.addSystemNotice=function(t){this.systemListData.addItem(t),this.chatListData2.addItem(t)},e.prototype.removeAllChatByType=function(t){for(var e=this.chatListData2.length,i=e-1;i>-1;i--){var o=this.chatListData2.getItemAt(i);o.type==t&&this.chatListData2.removeItemAt(i)}8==t&&this.campChatList&&this.campChatList.removeAll()},e.prototype.insertWorldChatMessage=function(t){return t=10==t.type?rambleBlackControl.checkIsBlack(t.id)?null:this.insertItemToList(this.kfListData,t):this.insertItemToList(this.chatListData,t),t&&(t=this.insertItemToList(this.chatListData2,t,!1)),t},e.prototype.insertGuildChatMessage=function(t){return t=this.insertItemToList(this.guildChatList,t),t&&(t=this.insertItemToList(this.chatListData2,t,!1)),t},e.prototype.insertSystemNoticeMessage=function(t){return t=this.insertItemToList(this.systemListData,t),t&&(t=this.insertItemToList(this.chatListData2,t,!1)),t},e.prototype.binFunc=function(t,e){return t.time<e.time?-1:t.time>e.time?1:0},e.prototype.insertItemToList=function(t,e,i){void 0===i&&(i=!0);var o=t.source,n=CommonUtils.searchIndex(o,e,this.binFunc);if(i)for(var r=n-1;r>=0;){var a=o[r];if(a.time!=e.time)break;if(a.type==e.type)if(e.str){if(a.str==e.str)return}else if(e.content&&a.content==e.content)return;r-=1}return o.splice(n,-1,e),e},__decorate([up(0,[8])],e.prototype,"upGm",null),__decorate([up(1,[1,6,8])],e.prototype,"upChat",null),__decorate([down(1,ByteConst.RambleInfoVos.slice())],e.prototype,"downNewChatMsg",null),__decorate([down(2)],e.prototype,"downSystemInfo",null),__decorate([down(3,[0])],e.prototype,"downIsSendSuccess",null),__decorate([down(4,[3,3,8])],e.prototype,"downSystemMessage",null),__decorate([down(5,[3])],e.prototype,"downCannotSpeak",null),__decorate([down(6,[3])],e.prototype,"downRemoveRoleChat",null),__decorate([down(8,[ByteConst.RambleInfoVos])],e.prototype,"downAllChatMsg",null),__decorate([up(7,[1,[3]])],e.prototype,"upFace",null),e=__decorate([protocolsId(30)],e)}(BaseSystem);__reflect(RambleControl.prototype,"RambleControl");var RambleCampVo=function(t){function e(){var e=t.call(this)||this;return e.type=8,e}return __extends(e,t),e.prototype.initData=function(t,e,i,o,n){this.campType=t,this.servId=e,this.name=i,this.str=o,this.str=RambleHlpVo.checkVMsg(this.str),this.setTime(n)},e}(RambleBaseVo);__reflect(RambleCampVo.prototype,"RambleCampVo");var RambleEmojiRiceTextVo=function(t){function e(e){var i=t.call(this)||this;return i.emojiMaxH=0,i.emojiSize=1,i.curHight=0,i.curForceY=0,i.curForceX=0,i.curLine=1,i._autoWrapLine=!0,i._fontSize=16,i._lineSpacing=2,i._textColor=16777215,i._emojiAlignment=2,i.useDpEmojiSize=!1,i.canLink=!1,i.outLineSpacing=0,i.EMOJI_INTERVAL=3,i.EMOJI_DATA={80:{width:39,height:21,soure:"xvip_v2_png",scale:.8},81:{width:53,height:24,soure:"sxvip_v2_png",scale:.8}},i.txtPool=[],i.lineEmojiArr=[],i.lineTextArr=[],e&&i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),e.filterSpecEmojiStr=function(t){return t?t.replace(/#80#/g,"#*#"):t},e.prototype.startTouchBg=function(){this.touchBg||(this.touchBg=new eui.Rect,this.addChild(this.touchBg))},e.prototype.onAddToStage=function(t){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemoveFromStage,this)},e.prototype.onRemoveFromStage=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onAddToStage,this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this),this.reset()},Object.defineProperty(e.prototype,"richText",{set:function(t){if(this.reset(),t){var e=this.splitFace(t);if(!e.emojis)return void this.insertTxt(e.msgs[0]);for(var i=e.msgs.length,o=0;i>o;o++)this.insertTxt(e.msgs[o]),e.emojis[o]&&this.insertEmoji(e.emojis[o]);this.invalidateLayoutY(),this.touchBg&&(this.touchBg.graphics.clear(),this.touchBg.graphics.beginFill(0,0),this.touchBg.graphics.drawRect(0,0,this.width,this.uHeight+this._lineSpacing+this.outLineSpacing)),this.height=this.uHeight}},enumerable:!0,configurable:!0}),e.prototype.insertTxt=function(t){if(t){var e=this.addText(t);this.lineTextArr[this.curLine]||(this.lineTextArr[this.curLine]=[]),this.lineTextArr[this.curLine].push(e);var i=this.curLine;if(this.lineTextArr[i]){var o=this.lineTextArr[i][this.lineTextArr[i].length-1];if(o.textWidth+o.x>this.width){if(o.width=this.width-o.x,o.height=this._fontSize,o.width<this._fontSize&&(this.addPool(o),this.lineTextArr[this.curLine].splice(this.lineTextArr[this.curLine].indexOf(o),1)),!this._autoWrapLine)return;this.invalidateLayoutY(),this.curLine++,this.curForceX=0,this.curForceY+=(this.emojiMaxH>this._fontSize?this.emojiMaxH:this._fontSize)+this._lineSpacing,this.emojiMaxH=0;for(var n="",r=o.width<this._fontSize?0:1,a=r;a<o.numLines;a++)for(var s=o.$getLinesArr()[a].elements;s.length>0;){var l=s.shift(),h=l.style.href?"|E:"+l.style.href.slice(6):"",u=h?"&":"|",c=l.style.textColor?u+("C:"+l.style.textColor+"&T:"):"";u=c?"&":"|";var p=l.style.underline?u+"U:":"",d=c||h?"|":"";n+=h+p+c+l.text+d}this.insertTxt(n)}}}},e.prototype.addText=function(t){var e=this.getTxt();e.verticalAlign=egret.VerticalAlign.TOP,e.size=this._fontSize;var i=TextUtils.generateTextFlow1(t);if(i&&!this.canLink)for(var o="event:8,",n=0;n<i.length;n++){var r=i[n];if(r.style&&r.style.href&&r.style.href.indexOf(o)>=0){this.canLink=!0;break}}return e.textFlow=i,e.textColor=this._textColor,e.width=e.height=0/0,e.touchEnabled=!0,e.addEventListener(egret.TextEvent.LINK,this.onLink,this),this.addChild(e),e.x=this.curForceX,e.y=this.curForceY,this.curForceX+=e.textWidth,this.curHight=this.curHight>e.y+e.textHeight?this.curHight:e.y+e.textHeight,e},e.prototype.insertEmoji=function(t){var i=t.replace(e.CHAT_EMOJI_ID,""),o=this.getEmojiInfo(+i);if(!o)return void this.insertTxt(t);if(!(this.curForceX+this.EMOJI_INTERVAL>this.width)){var n=o.soure?o.soure:"emoji_"+i+"_png";e.VIP_IMG==t&&(o.width=45),this.useDpEmojiSize&&o.scale&&(this.emojiSize=o.scale);var r=o.width*this.emojiSize,a=o.height*this.emojiSize;this.emojiMaxH<a&&(this.emojiMaxH=a);var s=50;if(this.curForceX+r>this.width+s){if(!this._autoWrapLine)return;this.invalidateLayoutY(),this.curLine++,this.curForceX=0,this.curForceY+=this.emojiMaxH+this._lineSpacing,this.emojiMaxH=0}var l=this.addEmoji(n);l&&(this.lineEmojiArr[this.curLine]||(this.lineEmojiArr[this.curLine]={}),this.lineEmojiArr[this.curLine][l.hashCode]=l,l.width=r,l.height=a,l.y=this.getEmojiY(a),l.x=this.curForceX+this.EMOJI_INTERVAL,this.curHight=this.curHight>l.y+a?this.curHight:l.y+a,this.curForceX=l.x+r)}},e.prototype.addEmoji=function(t){var e=ObjectPool.pop("RambleEmojiVo");return e.setData(t),e.scaleX=e.scaleY=this.emojiSize,this.addChild(e),e},Object.defineProperty(e.prototype,"autoWrapLine",{set:function(t){this._autoWrapLine=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"emojiAlignment",{set:function(t){this._emojiAlignment=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textColor",{set:function(t){this._textColor=t;for(var e in this.lineTextArr)if(this.lineTextArr[e])for(var i=this.lineTextArr[e],o=0;o<i.length;o++){var n=i[o];n.textColor=t}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{set:function(t){this._fontSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{set:function(t){this._lineSpacing=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uHeight",{get:function(){return this.curHight>this.height?this.curHight:this.height},enumerable:!0,configurable:!0}),e.prototype.setEmojiSize=function(t){this.emojiSize=t},e.prototype.reset=function(){this.emojiMaxH=0,this.curHight=20,this.curForceX=0,this.curForceY=0,this.curLine=1,this.height=20,this.canLink=!1,this.removeText(),this.removeEmoji()},e.prototype.removeText=function(){for(var t in this.lineTextArr){for(var e=this.lineTextArr[t],i=0;i<e.length;i++){var o=e[i];this.addPool(o)}this.lineTextArr[t]=[]}this.lineTextArr=[]},e.prototype.removeEmoji=function(){for(var t in this.lineEmojiArr)if(this.lineEmojiArr[t]){for(var e in this.lineEmojiArr[t]){var i=this.lineEmojiArr[t][e];DisplayUtils.removeFromParent(i),i.reset(),ObjectPool.push(i)}this.lineEmojiArr[t]=null}this.lineEmojiArr=[]},e.prototype.getEmojiInfo=function(t){return DataCenter.ins().RambleEmojiConfig&&DataCenter.ins().RambleEmojiConfig[t]?DataCenter.ins().RambleEmojiConfig[t]:this.EMOJI_DATA[t]?this.EMOJI_DATA[t]:null},e.prototype.getEmojiY=function(t){var e=t-this._fontSize;switch(this._emojiAlignment){case 1:return this.curForceY;case 2:return this.curForceY-(e>>1);case 3:return this.curForceY-e;default:return this.curForceY}},e.prototype.splitFace=function(t){return{emojis:t.match(e.CHAT_EMOJI),msgs:t.split(e.CHAT_EMOJI)}},e.prototype.invalidateLayoutY=function(){if(this.lineTextArr[this.curLine])for(var t=this.lineTextArr[this.curLine],e=0;e<t.length;e++){var i=t[e];i.y=this.curForceY}if(this.lineEmojiArr[this.curLine])for(var o in this.lineEmojiArr[this.curLine]){var n=this.lineEmojiArr[this.curLine][o];this.emojiMaxH>n.height,n.y=this.getEmojiY(n.height)}},e.prototype.onLink=function(t){this.canLink&&(LinkUtils.textLink(t.text),e.isLinkRich=!0,TimerMgr.ins().once(60,function(){e.isLinkRich=!1},this))},e.prototype.getTxt=function(){return this.txtPool.pop()||new egret.TextField},e.prototype.addPool=function(t){t.removeEventListener(egret.TextEvent.LINK,this.onLink,this),DisplayUtils.removeFromParent(t),this.txtPool.indexOf(t)<0&&this.txtPool.push(t)},e.CHAT_EMOJI=/#[0-9][0-9]#/g,e.CHAT_EMOJI_ID=/#/g,e.isLinkRich=!1,e.EMOJI_MAX_ID=36,e.MAX_ID=100,e.VIP_IMG="#80#",e.SVIP_IMG="#81#",e}(egret.Sprite);__reflect(RambleEmojiRiceTextVo.prototype,"RambleEmojiRiceTextVo");var RambleEmojiVo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setData=function(t,e){void 0===e&&(e=!1),this.reset(),e?(this.emojiMc||(this.emojiMc=new GameMovieClip),this.emojiMc.playFile(PATH_EFF+t,-1),this.addChild(this.emojiMc)):(this.emojiImg||(this.emojiImg=new eui.Image),this.emojiImg.source=t,this.addChild(this.emojiImg))},e.prototype.reset=function(){this.emojiImg?(this.emojiImg.source="",DisplayUtils.removeFromParent(this.emojiImg)):this.emojiMc&&(this.emojiMc.stop(),DisplayUtils.removeFromParent(this.emojiMc))},e.prototype.dispose=function(){this.reset()},e}(egret.Sprite);__reflect(RambleEmojiVo.prototype,"RambleEmojiVo");var RambleHlpVo=function(){function t(){}return t.checkVMsg=function(t,e){return t},t.regInputEvt=function(t,e,i){if(t){var o=t instanceof eui.TextInput?t.textDisplay.hashCode:t.hashCode;this.sourceObj[o]={},this.sourceObj[o].input=t,this.sourceObj[o].btn=e,this.sourceObj[o].hasFace=i,t.addEventListener(egret.FocusEvent.FOCUS_IN,this.inputIn,this),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this)}else debug.log(LangMgr.getValueByKey("chatDescTips1"),t)},t.inputIn=function(t){if(!(document.body.scrollTop>0)){var e=t.target.hashCode;this.sourceObj[e]?UIMgr.ins().open(RambleInputView,this.sourceObj[e].input,this.sourceObj[e].btn,this.sourceObj[e].hasFace):debug.log(LangMgr.getValueByKey("chatDescTips2"),t.target)}},t.onRemovedFromStage=function(t){var e=t.target instanceof eui.TextInput?t.target.textDisplay.hashCode:t.target.hashCode;this.sourceObj[e]&&(this.sourceObj[e].input.removeEventListener(egret.FocusEvent.FOCUS_IN,this.inputIn,this),this.sourceObj[e].input.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemovedFromStage,this),delete this.sourceObj[e])},t.sourceObj={},__decorate([callLater],t,"inputIn",null),t}();__reflect(RambleHlpVo.prototype,"RambleHlpVo");var RambleInfoVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e.id=0,e.servId=0,e.name="",e.job=0,e.sex=0,e.vip=0,e.monthCard=0,e.ladderLevel=0,e.pointId=0,e.str="",e.isFirst=0,e.zsLevel=0,e.lv=0,e.guild="",e.titleId=0,e}return __extends(e,t),e.prototype.init=function(t){this.type=t[0],this.id=t[1],this.servId=t[2],this.name=t[3],this.job=t[4],this.sex=t[5],this.vip=t[6],this.monthCard=t[7],this.ladderLevel=t[8],this.isFirst=t[9],this.zsLevel=t[10],this.lv=t[11],this.guild=t[12],this.pointId=t[13],this.str=t[14],this.str=RambleHlpVo.checkVMsg(this.str,this.type),this.setTime(t[15])},e}(RambleBaseVo);__reflect(RambleInfoVo.prototype,"RambleInfoVo");var RambleKfBlackVo=function(){function t(){this.index=1}return t.prototype.init=function(t){this.roleId=t[0],this.serId=t[1],this.roleName=t[2],this.job=t[3],this.sex=t[4],this.zsLevel=t[5],this.level=t[6],this.time=t[7]},t}();__reflect(RambleKfBlackVo.prototype,"RambleKfBlackVo");var RambleSystemVo=function(t){function e(e,i){var o=t.call(this)||this;return o.type=e,o.str=i,o.setNowTime(),o}return __extends(e,t),e}(RambleBaseVo);__reflect(RambleSystemVo.prototype,"RambleSystemVo");var RambleEmojiView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RambleEmojiViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.emoji,this.onChooseEmoji),this.addEventTouchTap(this.closeBg,this.onTouch),this.chatInput=t[0]},e.prototype.close=function(){this.chatInput=null},e.prototype.onChooseEmoji=function(t){if(t.target instanceof eui.Image){if(!this.chatInput)return void UIMgr.ins().close(this);var e=t.target.name,i=e.replace(/emoji_/g,"");this.chatInput.text==LangMgr.getValueByKey("customChatContent")?this.chatInput.text="#"+i+"#":this.chatInput.text=this.chatInput.text.concat("#"+i+"#"),UIMgr.ins().close(this)}},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(RambleEmojiView.prototype,"RambleEmojiView");var RambleInputView=function(t){function e(){var e=t.call(this)||this;return e.historyMsg="",e.skinName="RambleInputViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(t,e,i){this.sourceInput=t,this.sourceSendBtn=e,e?this.sendBtn.label=this.sourceSendBtn.label:this.sendBtn.visible=!1,this.addEventChange(t,this.onChange),this.addEventTouchTap(this.chatInput,this.onTouch),this.addEventTouchTap(this.sendBtn,this.onTouch),this.addEventTouchTap(this.faceBtn,this.onTouch),this.addEventFocusOut(this.sourceInput,this.onSFocusOut),this.addEventFocusOut(this.chatInput,this.onFocusOut),this.addEventFocusIn(this.chatInput,this.onFocusIn),this.chatInput.text=t.text,this.historyMsg=t.text,this.isSourceFocus=!0,e||DisplayUtils.removeFromParent(this.sendBtn),i||DisplayUtils.removeFromParent(this.faceBtn),GameLayer.POPUP.parent||GameLayer.MAIN1.addChild(this),this.showFocus(),egret.Tween.get(this.lineImg,{loop:!0}).wait(400).to({visible:!1}).wait(400).to({visible:!0})},e.prototype.close=function(){this.removeEventChange(this.sourceInput,this.onChange),this.removeEventTouchTap(StageUtils.ins().getStage(),this.onTouch),this.removeEventFocusOut(this.sourceInput,this.onSFocusOut),this.removeEventFocusOut(this.chatInput,this.onFocusOut),this.removeEventFocusIn(this.chatInput,this.onFocusIn),egret.Tween.removeTweens(this.lineImg),TimerMgr.ins().removeAll(this.sourceInput)},e.prototype.onFocusOut=function(){UIMgr.ins().close(e)},e.prototype.onSFocusOut=function(){TimerMgr.ins().once(210,function(){UIMgr.ins().close(e)},this.sourceInput)},e.prototype.onFocusIn=function(){this.removeEventFocusOut(this.sourceInput,this.onSFocusOut),TimerMgr.ins().removeAll(this.sourceInput)},e.prototype.onChange=function(){this.isSourceFocus?(this.chatInput.text=this.sourceInput.text,this.chatInput.$invalidateTextField(),this.showFocus()):this.sourceInput.text=this.chatInput.text},e.prototype.showFocus=function(){this.sourceInput instanceof eui.TextInput?this.lineImg.x=this.sourceInput.textDisplay.textWidth+25:this.sourceInput instanceof eui.EditableText&&(this.lineImg.x=this.sourceInput.textWidth+25)},e.prototype.onTouch=function(t){switch(t.target){case this.chatInput:egret.Tween.removeTweens(this.lineImg),this.lineImg.visible=!1,this.isSourceFocus=!1,this.addEventChange(this.chatInput,this.onChange);break;case this.sendBtn:this.sourceSendBtn.dispatchEventWith(egret.TouchEvent.TOUCH_TAP,!0);break;case this.faceBtn:UIMgr.ins().open(RambleEmojiView,this.sourceInput)}},e.openCheck=function(){return DeviceUtils.IsIPhone},e}(BaseEuiView);__reflect(RambleInputView.prototype,"RambleInputView");var RamblePlayerTipsView=function(t){function e(){var e=t.call(this)||this;return e.currId=0,e.serverId=0,e.skinName="RamblePlayerTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return this.data=t[0],this.data?(this.currId=0,this.addEventTouchTap(this.btnIgnore,this.onTap),this.addEventTouchTap(this.btnChat,this.onTap),this.addEventTouchTap(this.btnFriend,this.onTap),this.addEventTouchTap(this.btnInfo,this.onTap),this.addEventTouchTap(this.rect,this.onTap),this.addCustomEvent(478,this.openOtherPlayerView),void this.initView()):void UIMgr.ins().close(e)},e.prototype.onTap=function(t){switch(t.target){case this.btnChat:if(!rambleControl.checkAllChatOpen())return;var i=partnerControl.getFriendIndex(this.currId);-1!=i?(UIMgr.ins().close(this),partnerControl.selectedRoleId=this.currId,UIMgr.ins().open("PartnerBgView",0)):tipsControl.showTips(LangMgr.getValueByKey("chatTips1"));break;case this.btnInfo:rankOtherUserControl.upFindPlayer(this.currId,this.serverId);break;case this.btnIgnore:if(!this.data)return;this.data.servId&&GlobalModel.srvid!=this.data.servId?DataCenter.ins().RambleConstConfig.crossShieldListSize<=rambleBlackControl.getBlackList().length?warnControl.show(LangMgr.getValueByKey("chatBlackMsg1"),function(){UIMgr.ins().open("PartnerBgView",3,1)},this):rambleBlackControl.checkIsBlack(this.data.roleId)?tipsControl.showTips(LangMgr.getValueByKey("chatBlackMsg2")):(rambleBlackControl.upAddBlackRole(this.data),tipsControl.showTips(LangMgr.getValueByKey("chatBlackMsg3")),UIMgr.ins().close(this)):partnerControl.upAddBlackList(this.currId,this.data.name);break;case this.btnFriend:partnerControl.upAddFriend(this.currId,this.data.name);break;case this.rect:UIMgr.ins().close(e)}},e.prototype.initView=function(){if(CommonFun.instanceofByName(this.data,"PartnerVo")){var t=this.data;this.labelName.text=t.name,t.zs?this.labelLv.text=LangMgr.getValueByKey("numberRotation",t.zs)+LangMgr.getValueByKey("numberLevel",t.lv):this.labelLv.text=LangMgr.getValueByKey("numberLevel",this.data.lv),this.labelGuild.text=t.guildName,this.imgBg.source=RambleListItemRenderer.HEAD_BG[t.sex],this.imgHead.source="head_"+t.job+t.sex,this.currId=t.id,this.serverId=0}else this.data instanceof UnionMemberInfoVo?(this.labelName.text=this.data.name,this.data.zsLevel?this.labelLv.text=LangMgr.getValueByKey("numberRotation",this.data.zsLevel)+LangMgr.getValueByKey("numberLevel",this.data.level):this.labelLv.text=LangMgr.getValueByKey("numberLevel",this.data.level),this.labelGuild.text=unionControl.guildName?unionControl.guildName:"",this.imgBg.source=RambleListItemRenderer.HEAD_BG[this.data.sex],this.imgHead.source="head_"+this.data.job+this.data.sex,this.currId=this.data.roleID,this.serverId=0):this.data instanceof UnionMessageInfoVo?(this.labelName.text=this.data.name,this.data.zsLevel?this.labelLv.text=LangMgr.getValueByKey("numberRotation",this.data.zsLevel)+LangMgr.getValueByKey("numberLevel",this.data.lv):this.labelLv.text=LangMgr.getValueByKey("numberLevel",this.data.lv),this.labelGuild.text=this.data.guildName,this.imgBg.source=RambleListItemRenderer.HEAD_BG[this.data.sex],this.imgHead.source="head_"+this.data.job+this.data.sex,this.currId=this.data.roleId,this.serverId=0):(this.labelName.text=this.data.name,this.data.zsLevel?this.labelLv.text=LangMgr.getValueByKey("numberRotation",this.data.zsLevel)+LangMgr.getValueByKey("numberLevel",this.data.lv):this.labelLv.text=LangMgr.getValueByKey("numberLevel",this.data.lv),this.labelGuild.text=this.data.guild,this.imgBg.source=RambleListItemRenderer.HEAD_BG[this.data.sex],this.imgHead.source="head_"+this.data.job+this.data.sex,this.currId=this.data.id,this.serverId=this.data.servId?this.data.servId:0);this.btnInfo.enabled=!crossFieldControl.isCrossServer,this.data.servId&&(this.btnChat.enabled=this.btnFriend.enabled=!crossFieldControl.isCrossServer)},e.prototype.openOtherPlayerView=function(t){UIMgr.ins().close(this),UIMgr.ins().close("PartnerBgView");var e=UIMgr.ins().open("RankRoleView",t);crossFieldControl.isCross&&e.hideEx(2)},e}(BaseEuiView);__reflect(RamblePlayerTipsView.prototype,"RamblePlayerTipsView");var RambleTipsView=function(t){function e(){var e=t.call(this)||this;return e.showOver=!1,e.skinName="RambleTipsViewSkin",e}return __extends(e,t),e.prototype.setData=function(t){this.lab.textFlow=TextUtils.generateTextFlow(t.str),this.setshowTime()},e.prototype.setshowTime=function(){this.showOver||TimerMgr.ins().remove(this.showOverInfo,this),TimerMgr.ins().doTimer(5e3,1,this.showOverInfo,this)},e.prototype.showOverInfo=function(){this.showOver=!0,DisplayUtils.removeFromParent(this)},e}(eui.Component);__reflect(RambleTipsView.prototype,"RambleTipsView");var RambleUIView=function(t){function e(){var e=t.call(this)||this;return e.exclusionWins=[],e}return __extends(e,t),e}(RambleMainView);__reflect(RambleUIView.prototype,"RambleUIView");var RambleView=function(t){function e(){var e=t.call(this)||this;return e.cruIndex=0,e.fistOpenGuild=!0,e.isStretch=!1,e.curTabType=[],e._curTabType=0,e.uilayer=GameLayer.POPUP,e.isTopLevel=!0,e.canDestroy=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RambleViewSkin",this.defaultText=LangMgr.getValueByKey("customZx"),this.chatInput.maxChars=30,this.input.maxChars=100,this.tabData=new eui.ArrayCollection,this.tab.dataProvider=this.tabData,this.chatList.touchEnabled=!1},e.prototype.isShowWorld=function(){return!crossFieldControl.isCrossServer},e.prototype.refTab=function(){copyControl.isFBChatChannle()?(this.curTabType=[3],this.tab.horizontalCenter=0):this.isShowWorld()?!SwitchMgr.ins().checkOpen(1001)&&crossBossControl.isOpen()&&GameServer.smallKFServOpenDay?this.curTabType=[0,1,2,4,5]:this.curTabType=[0,1,4,5]:(this.curTabType=[0,2,4,5],this.tab.horizontalCenter=0);for(var t=[],e=0;e<this.curTabType.length;e++){var i=this.curTabType[e],o=LangMgr.getValueByKey("chatMenu"+i);t.push(o)}this.tabData.replaceAll(t),this.tab.validateNow();for(var e=0;e<this.curTabType.length;e++){var n=this.tab.getVirtualElementAt(e);n&&(n.redPoint.visible=!1)}},e.prototype.getChatType=function(t){return this.curTabType[t]},Object.defineProperty(e.prototype,"curType",{get:function(){return this.curTabType[this.cruIndex]},enumerable:!0,configurable:!0}),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];0==this.input.text.length?(this.input.text=this.defaultText,this.input.textColor=7105644):this.input.textColor=14668213,this.addEventTouchTap(this.faceBtn,this.onTap),this.addEventTouchTap(this.chatList,this.onListTap),this.addEventTouchTap(this.upBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.sendBtn,this.onTap),this.addEventTouchTap(this.allReceiveBtn,this.onTap),this.addCustomEvent(226,this.getNewOne),this.addCustomEvent(643,this.textInOn),this.addEventChange(this.tab,this.selectIndexChange),this.addEventChanging(this.tab,this.checkIsOpen),this.addEventTouchTap(this.sendBtn0,this.onTap),this.addCustomEvent(644,this.getNewOneGuild),this.addCustomEvent(30,this.updataList),this.addCustomEvent(216,this.setOpenMail),this.addCustomEvent(215,this.onSendMail),this.addCustomEvent(12,this.updateMsgRedPoint),this.addCustomEvent(353,this.updateMsgRedPoint),this.addEventTouchTap(this.chatList,this.onSendMail),this.addEventTouchTap(this.unReadGroup,this.refListBottom),this.addEventFocusIn(this.chatInput,this.textInOn),this.addEventFocusIn(this.input,this.updateInput),this.addEventChangeStart(this.barList,this.scrollChangeStart),this.addEventChangeEnd(this.barList,this.scrollChangeEnd),this.refTab();var i=t[0];void 0==i&&(i=this._curTabType);for(var o=0;o<this.curTabType.length;o++)if(i==this.curTabType[o]){this.cruIndex=o;break}4==this.curType&&(unionControl.guildID?(this.curType>4||copyControl.isFBChatChannle())&&(this.cruIndex=0):this.cruIndex=0),(void 0==this.cruIndex||this.cruIndex>=this.curTabType.length)&&(this.cruIndex=0),this.backSelect(this.cruIndex),this.selectIndexChange(null),RambleHlpVo.regInputEvt(this.chatInput,this.sendBtn,!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventFocusIn(this.chatInput,this.textInOn),this.removeEventFocusIn(this.input,this.updateInput),this.removeEventChangeStart(this.barList,this.scrollChangeStart),this.removeEventChangeEnd(this.barList,this.scrollChangeEnd),WatcherUtil.removeFromArrayCollection(rambleControl.chatListData),WatcherUtil.removeFromArrayCollection(unionControl.guildMessageInfoData),WatcherUtil.removeFromArrayCollection(rambleControl.systemListData),WatcherUtil.removeFromArrayCollection(this.tab.dataProvider),this.chatList.dataProvider=null,this.isStopRef=!1},e.prototype.updateInput=function(){this.input.text==this.defaultText&&(this.input.text="",this.input.textColor=14668213)},e.prototype.checkIsOpen=function(t){var e=t.target;4!=this.getChatType(e.selectedIndex)||unionControl.guildID||(tipsControl.showTips(LangMgr.getValueByKey("customFristJoin")),t.preventDefault())},e.prototype.selectIndexChange=function(t){this.oldChangle=this.cruIndex,this.cruIndex=this.tab.selectedIndex,this._curTabType=this.curType,this.autoStopRefStatus(!1),this.updataList(!0),4==this.curType&&this.fistOpenGuild&&(this.fistOpenGuild=!1,unionControl.getAllGuildMessage()),2==this.curType&&(rambleControl.kfNoReadMsgList=[])},e.prototype.backSelect=function(t){this.tab.selectedIndex=t,this._curTabType=this.curType},e.prototype.onSendMail=function(t){if(t&&7==this.curType){var e=t.target.parent;if(e){var i=e.data;i&&emailUserControl.upMailContentData(i.handle)}}},e.prototype.setOpenMail=function(t){if(7==this.curType)for(var e=0;e<this.chatList.numChildren;e++){var i=this.chatList.getChildAt(e);if(i.data.handle==t.handle){i.data=t;break}}},e.prototype.updataList=function(t){void 0===t&&(t=!1);var e;switch(this.curType){case 0:this.currentState="all",this.validateNow(),this.chatList.itemRenderer=RambleListItem3Renderer,e=rambleControl.chatListData2;break;case 1:case 2:case 3:switch(this.currentState="world",this.validateNow(),this.chatList.itemRendererSkinName="RambleListItemRendererSkin",this.chatList.itemRenderer=RambleListItemRenderer,this.curType){case 1:e=rambleControl.chatListData;break;case 2:e=rambleControl.kfListData;break;case 3:e=copyControl.chatCampDtList}break;case 4:this.currentState="guild",this.validateNow(),this.chatList.itemRendererSkinName="RambleListItemRendererSkin",this.chatList.itemRenderer=RambleGuildItemRenderer,unionControl.refTimeOutList(),e=unionControl.guildMessageInfoData;break;case 5:this.currentState="sys",this.validateNow(),this.chatList.itemRenderer=RambleSystemItemRenderer,e=rambleControl.systemListData;break;case 6:this.currentState="customService",this.validateNow()}e&&(this.chatList.dataProvider=e),this.barList.stopAnimation(),egret.Tween.removeTweens(this.barList.viewport),this.refushBarListTop(),this.listDataChange(t),this.updateMsgRedPoint()},e.prototype.autoStopRefStatus=function(t){this.chatList.dataProvider&&(this.curDataLen=this.chatList.dataProvider.length,this.isStopRef=t)},e.prototype.scrollChangeStart=function(){this.autoStopRefStatus(!0)},e.prototype.refListBottom=function(){this.barList.stopAnimation(),this.autoStopRefStatus(!1),this.refushBar()},e.prototype.scrollChangeEnd=function(){var t=this.barList.viewport.contentHeight-this.barList.viewport.scrollV;t==this.barList.viewport.height&&(this.autoStopRefStatus(!1),this.refNoMsgTip())},e.prototype.refNoMsgTip=function(){if(this.unReadGroup.visible=!1,this.chatList.dataProvider&&this.isStopRef){var t=this.chatList.dataProvider.length-this.curDataLen;
this.unReadLabel.text=LangMgr.getValueByKey("chatNoMsg",t),this.unReadGroup.visible=t>0}},e.prototype.updateMsgRedPoint=function(){4==this.getChatType(this.tab.selectedIndex)&&(unionControl.noReadMsgList=[],unionControl.dispatchGuildChatRed()),this.updateTabTypeRed(4,unionControl.noReadMsgList.length>0&&!crossFieldControl.isCross)},e.prototype.getRedPoint=function(t){var e=this.curTabType.indexOf(t);if(e>=0){var i=this.tab.getVirtualElementAt(e);if(i)return i.redPoint}return null},e.prototype.updateTabTypeRed=function(t,e){var i=this.getRedPoint(t);i&&(i.visible=e)},e.prototype.getNewOne=function(t){-1==partnerControl.indexOfBlackList(t.id)&&(this.refushBar(),this.updateMsgRedPoint())},e.prototype.getNewOneGuild=function(t){-1==partnerControl.indexOfBlackList(t.id)&&this.refushBar()},e.prototype.listDataChange=function(t){if(this.chatList.dataProvider){var e=this.chatList.dataProvider.getItemAt(this.chatList.dataProvider.length-1);e&&e.id&&e.id==ActorControl.actorID&&this.autoStopRefStatus(!1),6!=this.curType&&(7==this.curType?this.refushBarListTop():this.refushBar(t))}},e.prototype.refushBar=function(t){var e=this;this.refNoMsgTip(),this.isStopRef||(t&&egret.Tween.get(this.barList.viewport).wait(110).call(function(){DisplayUtils.scrollerToBottom(e.barList,null,!0)},this),DisplayUtils.scrollerToBottom(this.barList))},e.prototype.refushBarListTop=function(){this.barList.viewport.scrollV=0},e.prototype.textInOn=function(){this.chatInput.text==LangMgr.getValueByKey("customChatContent")&&(this.chatInput.text="")},e.prototype.setStretchWin=function(){this.isStretch?(this.isStretch=!1,this.upBtn.scaleY=1,this.winGroup.height=e.LITTLE_HEIGHT):(this.isStretch=!0,this.upBtn.scaleY=-1,this.winGroup.height=e.BIG_HEIGHT),this.autoStopRefStatus(!1),this.updataList()},e.prototype.allReceiveMail=function(){for(var t=[],e=emailUserControl.getMailByReceive(),i=0;i<e.length;i++)t.push(e[i].handle);emailUserControl.upGetItem(t)},e.prototype.onListTap=function(){var t=this.chatList.selectedItem;if(t&&(t instanceof RambleInfoVo||t instanceof UnionMessageInfoVo||t instanceof RambleSystemVo)){if(t instanceof RambleSystemVo||t instanceof UnionMessageInfoVo){var e=t.str;if(e&&e.indexOf("|E:")>=0)return void this.onLink(e,t)}void 0!=t.lv&&UIMgr.ins().open(RamblePlayerTipsView,t)}},e.prototype.onLink=function(t,e){if(!RambleEmojiRiceTextVo.isLinkRich){var i=t.indexOf("|E:");t=t.slice(i+3,Number.MAX_VALUE),LinkUtils.textLink(t,e)}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.faceBtn:UIMgr.ins().open(RambleEmojiView,this.chatInput);break;case this.upBtn:this.setStretchWin(),this.refushBar();break;case this.closeBtn0:UIMgr.ins().close(this);break;case this.sendBtn:if(this.chatInput.text.indexOf("@")>-1)return void gameControl.upGMCommad(this.chatInput.text);if(!rambleControl.checkAllChatOpen())return;if(4!=this.curType&&!rambleControl.checkChatIsOpen())return;if(!rambleControl.canSpeak)return void tipsControl.showTips(LangMgr.getValueByKey("customChatFirst"));if(this.chatInput.text==LangMgr.getValueByKey("customChatContent")||""==this.chatInput.text)return void tipsControl.showTips(LangMgr.getValueByKey("customChatContent1"));if(!rambleControl.checkSendMsg(this.chatInput.text))return;if(4==this.curType)copyControl.isFBChatChannle()?copyControl.upFbChat(ActorControl.camp,this.chatInput.text):unionControl.upGuildMessage(this.chatInput.text),this.chatInput.text="";else{if(!SwitchMgr.ins().checkOpen(43,!0))return;rambleControl.checkRepeatString(this.chatInput.text)&&(copyControl.isFBChatChannle()||3==this.curType?copyControl.upFbChat(ActorControl.camp,this.chatInput.text):2==this.curType?rambleControl.upChatInfo(10,this.chatInput.text):1==this.curType?rambleControl.upChatInfo(7,this.chatInput.text):-1==this.curTabType.indexOf(1)&&this.curTabType.indexOf(2)>-1?rambleControl.upChatInfo(10,this.chatInput.text):rambleControl.upChatInfo(7,this.chatInput.text),rambleControl.UpSpeak=this.chatInput.text,this.chatInput.text="")}break;case this.sendBtn0:if(0==this.input.text.length||this.input.text==this.defaultText)return void tipsControl.showTips(LangMgr.getValueByKey("customNoEmpty"))}},e.BIG_HEIGHT=850,e.LITTLE_HEIGHT=370,e}(BaseEuiView);__reflect(RambleView.prototype,"RambleView");var RambleGuildItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.emojiTxt=new RambleEmojiRiceTextVo,e.emojiTxt.x=0,e.emojiTxt.y=8,e.emojiTxt.lineSpacing=8,e.emojiTxt.outLineSpacing=12,e.emojiTxt.textColor=13746831,e.emojiTxt.startTouchBg(),e.emojiTxt.y=8,e.addChild(e.emojiTxt),e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.height=0,this.showHead.visible=!1,this.showText.visible=!1,this.chatVip.visible=!1,this.data instanceof UnionMessageInfoVo){var t=this.data,e="",i="",o="",n="";1==t.type?(t.office&&(e="|C:"+LangMgr.getValueByKey("officeColor"+t.office)+"&T:["+LangMgr.getValueByKey("officeName"+t.office)+"]|"),i=vipControl.getVipEmoji(t.vipLevel),t.name&&(o="|C:0x16B2FF&T:["+t.name+"]|"),n="|C:0xDFD1B5&T:"+t.str+"|"):n="|C:0xDFD1B5&T:"+t.str+"|",n=RambleEmojiRiceTextVo.filterSpecEmojiStr(n),this.emojiTxt.width=this.textGroup.width,this.emojiTxt.richText=e+i+o+" "+n,this.height=this.emojiTxt.uHeight+14}},e}(BaseItemRender);__reflect(RambleGuildItemRenderer.prototype,"RambleGuildItemRenderer");var RambleKfBlackItemRenderer=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.addEventTouchTap(this.btn_delete,function(t){rambleBlackControl.upDelBlackRole(e.data.index)})},e.prototype.dataChanged=function(){this.label_name.text=this.data.roleName+"("+(this.data.zsLevel>0?LangMgr.getValueByKey("numberRotation",this.data.zsLevel):"")+LangMgr.getValueByKey("numberLevel",this.data.level),this.img_userIcon.source="head_"+this.data.job+this.data.sex,this.labelGuild.text="",this.headBg.source=RambleListItemRenderer.HEAD_BG[this.data.sex],this.severId.text="S"+this.data.serId},e}(BaseItemRender);__reflect(RambleKfBlackItemRenderer.prototype,"RambleKfBlackItemRenderer");var RambleListItem2Renderer=function(t){function e(){var e=t.call(this)||this;return e.emojiTxt=new RambleEmojiRiceTextVo,e.emojiTxt.textColor=13746831,e.emojiTxt.autoWrapLine=!1,e.addChild(e.emojiTxt),e}return __extends(e,t),e.prototype.dataChanged=function(){this.textGroup.visible=!1;var t=this.data,e=0;this.$parent&&(e=this.$parent.$explicitWidth||this.$parent.$getExplicitWidth&&this.$parent.$getExplicitWidth());var i="",o="",n="";if(t instanceof UnionMessageInfoVo)i=LangMgr.getValueByKey("chatGuild"),o=t.str,n=vipControl.getVipEmoji(t.vipLevel);else if(t instanceof RambleCampVo)i=LangMgr.getValueByKey("chatMenuType1"),o=t.str;else if(t instanceof RambleSystemVo)i=LangMgr.getValueByKey("chatSystem"),o=t.str;else{var r=LangMgr.getValueByKey("chatMenu"+(7==t.type?1:2));i="|C:0xDD6717&T:["+r+"]|",o=t.str,n=vipControl.getVipEmoji(t.vipLevel)}var a=10==t.type?"S"+t.servId:"",s=t.name?"|C:0x16B2FF&T:["+t.name+a+"]|":"";o=RambleEmojiRiceTextVo.filterSpecEmojiStr(o),this.emojiTxt.x=this.showChannel.x,this.emojiTxt.y=this.showChannel.y,this.emojiTxt.width=this.width,this.emojiTxt.height=this.showChannel.height,this.emojiTxt.useDpEmojiSize=!0,this.emojiTxt.richText=""+i+n+s+o,this.emojiTxt.textColor=14668213},e}(BaseItemRender);__reflect(RambleListItem2Renderer.prototype,"RambleListItem2Renderer");var RambleListItem3Renderer=function(t){function e(){var e=t.call(this)||this;return e.emojiTxt=new RambleEmojiRiceTextVo,e.emojiTxt.x=0,e.emojiTxt.y=8,e.emojiTxt.lineSpacing=8,e.emojiTxt.outLineSpacing=12,e.emojiTxt.textColor=13746831,e.emojiTxt.startTouchBg(),e.emojiTxt.y=8,e.addChild(e.emojiTxt),e}return __extends(e,t),e.prototype.dataChanged=function(){this.height=0,this.showHead.visible=!1,this.showText.visible=!1,this.chatVip.visible=!1;var t=this.data,e=0;this.$parent&&(e=this.$parent.$explicitWidth||this.$parent.$getExplicitWidth&&this.$parent.$getExplicitWidth());var i="",o="",n="",r="";if(t instanceof UnionMessageInfoVo)i=LangMgr.getValueByKey("chatGuild"),o=t.str,n=vipControl.getVipEmoji(t.vipLevel);else if(t instanceof RambleCampVo)i=LangMgr.getValueByKey("chatMenuType1"),o=t.str;else if(t instanceof RambleSystemVo)i=LangMgr.getValueByKey("chatSystem"),o=t.str;else{var a=LangMgr.getValueByKey("chatMenu"+(7==t.type?1:2));i="|C:0xDD6717&T:["+a+"]|",o=t.str,n=vipControl.getVipEmoji(t.vip)}if(o=RambleEmojiRiceTextVo.filterSpecEmojiStr(o),t.name){var s=10==t.type?"S"+t.servId:"";r="|C:0x16B2FF&T:["+t.name+s+"]|"}var l="|C:0xDFD1B5&T:"+o+"|";this.emojiTxt.width=e||this.textGroup.width,this.emojiTxt.richText=""+i+n+r+" "+l,this.height=this.emojiTxt.uHeight+14},e}(BaseItemRender);__reflect(RambleListItem3Renderer.prototype,"RambleListItem3Renderer");var RambleListItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.emojiTxt=new RambleEmojiRiceTextVo,e.emojiTxt.x=0,e.emojiTxt.y=8,e.emojiTxt.lineSpacing=8,e.emojiTxt.lineSpacing=20,e.emojiTxt.textColor=14668213,e.emojiTxt.startTouchBg(),e.emojiTxt.y=8,e.addChild(e.emojiTxt),e}return __extends(e,t),e.prototype.dataChanged=function(){this.showHead.visible=!1,this.showText.visible=!1,this.chatVip.visible=!1,this.height=0;var t=null;t=7==this.data.type?this.data:this.data;var e="",i="",o=10==this.data.type?"S"+t.servId:"",n="",r="";n=t.str,n=RambleEmojiRiceTextVo.filterSpecEmojiStr(n),r=vipControl.getVipEmoji(t.vip),e=t.name?"|C:0x16B2FF&T:["+t.name+o+"]|":"",i="|C:0xDFD1B5&T:"+n+"|",this.emojiTxt.width=this.textGroup.width,this.emojiTxt.richText=""+r+e+" "+i,this.height=this.emojiTxt.uHeight+14},e.HEAD_BG=["touxiangkuang0","touxiangkuang1"],e}(BaseItemRender);__reflect(RambleListItemRenderer.prototype,"RambleListItemRenderer");var RambleSystemItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="RambleSystemItemRendererSkin",e.addEventTextLink(e.str,e.onLink),e}return __extends(e,t),e.prototype.dataChanged=function(){1==this.data.type?(this.str.textFlow=TextUtils.generateTextFlow("|C:0xFD2F2F&T:"+this.data.str+"|"),this.type.source="lt_01"):(this.str.textFlow=TextUtils.generateTextFlow(this.data.str),this.type.source="lt_02")},e.prototype.onLink=function(t){LinkUtils.textLink(t.text)},e}(BaseItemRender);__reflect(RambleSystemItemRenderer.prototype,"RambleSystemItemRenderer");var RegressionView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RegressionViewSKin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.list.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onClick),this.addEventTouchTap(this.sure,this.onClick);var i=DataCenter.ins().RegressionConfig.leaveReward;this.list.dataProvider=new eui.ArrayCollection(i),this.scaleX=this.scaleY=1},e.prototype.oncloseEff=function(){egret.Tween.get(this).to({scaleX:.4,scaleY:.4},400).call(function(){UIMgr.ins().close(e)})},e.prototype.onClick=function(t){switch(t.currentTarget){case this.bgClose:case this.sure:this.oncloseEff()}},e}(BaseEuiView);__reflect(RegressionView.prototype,"RegressionView");var RenameView=function(t){function e(){var e=t.call(this)||this;return e.skinName="RenameViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.sureBtn,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.sureBtn:0==this.input.text.length?tipsControl.showTips(LangMgr.getValueByKey("reNameTips1")):null!=backpackControl.getBagItemById(450001)&&gameControl.upRename(this.input.text)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.sureBtn,this.onTap),this.input.text=""},e}(BaseEuiView);__reflect(RenameView.prototype,"RenameView");var ClientStorage=function(t){function e(){var e=t.call(this)||this;return e._storage={},e._tempStorage={},e.init(),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.setItem=function(t,e,i){void 0===i&&(i=SetValueType["default"]),this._storage[i][t]!=e&&(this._storage[i][t]=e,TimerMgr.ins().isExists(this.storage,this)||TimerMgr.ins().doNext(this.storage,this))},e.prototype.getItem=function(t,e){return void 0===e&&(e=SetValueType["default"]),this._storage[e][t]},e.prototype.delItem=function(t,e){void 0===e&&(e=SetValueType["default"]),delete this._storage[e][t],TimerMgr.ins().isExists(this.storage,this)||TimerMgr.ins().doNext(this.storage,this)},e.prototype.setBool=function(t,e,i){void 0===i&&(i=SetValueType["default"]),this.setItem(t,e?1:0,i)},e.prototype.getBool=function(t,e){return void 0===e&&(e=SetValueType["default"]),!!this.getItem(t,e)},e.prototype.setValue=function(t,e){this._tempStorage[t]=e},e.prototype.getValue=function(t){return this._tempStorage[t]},e.prototype.init=function(){try{var t=egret.localStorage.getItem(this.getStorageKey());t?this._storage=JSON.parse(t)||{}:this._storage={}}catch(e){debug.log(e),this._storage={}}this.initValue()},e.prototype.initValue=function(){this._storage[SetValueType["default"]]||(this._storage[SetValueType["default"]]={}),this._storage[SetValueType.special]||(this._storage[SetValueType.special]={})},e.prototype.storage=function(){try{var t=JSON.stringify(this._storage);egret.localStorage.setItem(this.getStorageKey(),t)}catch(e){}},e.prototype.getStorageKey=function(){return""+ActorControl.actorID||"game_dragon_lin"},e}(SingleClass);__reflect(ClientStorage.prototype,"ClientStorage");var SetValueType=function(){function t(){}return t["default"]="defaultValue",t.special="specialValue",t}();__reflect(SetValueType.prototype,"SetValueType");var ServerStorage=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.map={},e.isInit=!1,e}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},Object.defineProperty(e,"currPart",{get:function(){return i.ins().getValue(0)},enumerable:!0,configurable:!0}),Object.defineProperty(e,"currStep",{get:function(){return i.ins().getValue(1)},enumerable:!0,configurable:!0}),e.setSpecialGuild=function(t){var e=i.ins().getValue(22);this.getSpecialGuild(t)?e+=1<<t-1:e-=1<<t-1,i.ins().setValue(22,e)},e.getSpecialGuild=function(t){var e=i.ins().getValue(22);return!!(e>>t-1&1)},e.prototype.downParser=function(t){if(crossFieldControl.hasSwitchCross)return guideControl.init(),void this.dispatchInitSetting();for(var e=0;e<t.length;e++)this.map[t[e][0]]=t[e][1];this.isInit=!0,guideControl.init(),ActorControl.actorID&&this.initSetting(),this.dispatchInitSetting(),GameServer.ins().checkIsFirstLogin(),SceneMgr.ins().getCurrScene().updateBluntBangs()},e.prototype.dispatchInitSetting=function(){EventMgr.ins().dispatch(511,!0)},e.prototype.initSetting=function(){if(0==this.getBitValue(ClientSetBit.setting_view_init)){var t={sound_effect:1,shake_win:1,auto_heji:0,dice:0,hide_mine_wing:0,hide_other_wing:0,hide_friend_req:0,level_up_item_red:1,kf_chat_tips:0,hide_mine_zhanling:0,hide_other_zhanling:0};for(var e in t)ClientSetBit[e]&&(void 0!=ClientStorage.ins().getItem(e)?this.setBitBool(ClientSetBit[e],ClientStorage.ins().getItem(e)):this.setBitBool(ClientSetBit[e],t[e]||0));this.setBitValue(ClientSetBit.setting_view_init,1)}this.updateSetting()},e.prototype.updateSetting=function(){SoundUtils.ins().setEffectOn(this.getBitBool(ClientSetBit.sound_effect)),DisplayUtils.setShakeOn(this.getBitBool(ClientSetBit.shake_win))},e.prototype.dispatchUpdate=function(t){return t},e.prototype.upSave=function(t,e){return this.map[t]=e,this.dispatchUpdate(t),[t,e]},e.prototype.setValue=function(t,e){this.upSave(t,e)},e.prototype.getValue=function(t,e){return void 0===e&&(e=0),void 0==this.map[t]?e:this.map[t]},e.prototype.setBitValue=function(t,e){var i=100,o=t/31>>0,n=t%31;i+=o;var r=e?1:0;e=this.map[i],r?e|=1<<n:e&=~(1<<n),this.setValue(i,e)},e.prototype.getBitValue=function(t){var e=100,i=t/31>>0,o=t%31;e+=i;var n=this.getValue(e);return n>>o&1},e.prototype.setBitBool=function(t,e){return this.setBitValue(t,e?1:0)},e.prototype.getBitBool=function(t){return 1==this.getBitValue(t)},__decorate([down(19,[[3,3]])],e.prototype,"downParser",null),__decorate([up(19,[3,3])],e.prototype,"upSave",null),e=i=__decorate([protocolsId(255)],e);var i}(BaseSystem);__reflect(ServerStorage.prototype,"ServerStorage");var ClientSetBit=function(){function t(){}return t.guildFirstRed=0,t.firstRecharge=1,t.firstRechargeAni=2,t.isDailyDieFirstRecharge=3,t.isDailyDieMaBi=4,t.isDailyDieThreeRoles=5,t.activity5029=6,t.playWarn=7,t.legendtempleRedPoint=8,t.ladderMore=9,t.ladderMoreEff=10,t.kfzhbossRed=11,t.superVipEff=12,t.worldBossMult1=13,t.worldBossMultEff1=14,t.worldBossMult5=15,t.worldBossMultEff5=16,t.worldBossMult7=17,t.worldBossMultEff7=18,t.worldBossMult10=19,t.worldBossMultEff10=20,t.worldBossMult12=21,t.worldBossMultEff12=22,t.newFunNotice=23,t.godweaponrent=24,t.pubBossNoTipYb=25,t.pubBossNoTipItem=26,t.syBossNoTipItem=28,t.matchKOTips=29,t.matchGPTips=30,t.serverBattleShop=31,t.sound_effect=32,t.shake_win=33,t.auto_heji=34,t.dice=35,t.dice2=36,t.hide_mine_wing=37,t.hide_other_wing=38,t.hide_friend_req=39,t.level_up_item_red=40,t.kf_chat_tips=41,t.hide_mine_zhanling=42,t.hide_other_zhanling=43,t.hide_mine_title=44,t.hide_other_title=45,t.setting_view_init=48,t.renameCard=72,t.funcopen=73,t.bluntBangs=100,t}();__reflect(ClientSetBit.prototype,"ClientSetBit");var SettingView=function(t){function e(){var e=t.call(this)||this;return e.headRedLv=30,e.skinName="SettingViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){if(LongPressUtils.ins().removeOnceByTime(this.titleTxt.hashCode),LongPressUtils.ins().addOnceByTime(this.titleTxt,this.onLongTap,this,1e4),this.addEventTouchTap(this.bgClose,this.onTouch),this.addEventTouchTap(this.maskSound,this.onTouch),this.addEventTouchTap(this.maskShake,this.onTouch),this.addEventTouchTap(this.maskPunch,this.onTouch),this.addEventTouchTap(this.maskFriend,this.onTouch),this.addEventTouchTap(this.maskSelf,this.onTouch),this.addEventTouchTap(this.maskOther,this.onTouch),this.addEventTouchTap(this.bluntBangs,this.onTouch),this.maskSound.selected=ServerStorage.ins().getBitBool(ClientSetBit.sound_effect),this.maskShake.selected=ServerStorage.ins().getBitBool(ClientSetBit.shake_win),this.maskPunch.selected=ServerStorage.ins().getBitBool(ClientSetBit.auto_heji),this.maskFriend.selected=ServerStorage.ins().getBitBool(ClientSetBit.hide_friend_req),this.maskSelf.selected=ServerStorage.ins().getBitBool(ClientSetBit.hide_mine_wing),this.maskOther.selected=ServerStorage.ins().getBitBool(ClientSetBit.hide_other_wing),this.bluntBangs.selected=ServerStorage.ins().getBitBool(ClientSetBit.bluntBangs),ActorControl.level>=this.headRedLv&&!ServerStorage.ins().getValue(3)){var t=new GameMovieClip;t.playFile(PATH_EFF+"chargeff1",-1),this.effGroup.addChild(t),ServerStorage.ins().setValue(3,1)}this.openIdTxt&&(this.openIdTxt.text="UID:"+ActorControl.actorID),SDKManager.ins().SDKShowLogout()?this.switchUser&&this.addEventTouchTap(this.switchUser,this.onTouch):this.switchUser&&(this.switchUser.visible=!1)},e.prototype.onLongTap=function(){UIMgr.ins().open(GMNetCalcView)},e.prototype.close=function(){var t=UIMgr.playFun;t&&t.setSoundRadio(ServerStorage.ins().getBitBool(ClientSetBit.sound_effect));var e=UIMgr.ins().getView("RambleMainView");e&&e.refTipMsgStatus(),LongPressUtils.ins().removeOnceByTime(this.titleTxt.hashCode)},e.prototype.onTouch=function(t){var i=t.currentTarget;switch(i){case this.bgClose:UIMgr.ins().close(e);break;case this.maskSound:ServerStorage.ins().setBitBool(ClientSetBit.sound_effect,i.selected);break;case this.maskShake:ServerStorage.ins().setBitBool(ClientSetBit.shake_win,i.selected);break;case this.maskPunch:ServerStorage.ins().setBitBool(ClientSetBit.auto_heji,i.selected);break;case this.maskFriend:ServerStorage.ins().setBitBool(ClientSetBit.hide_friend_req,i.selected),this.reqFriendAppList();break;case this.maskSelf:ServerStorage.ins().setBitBool(ClientSetBit.hide_mine_zhanling,i.selected),ServerStorage.ins().setBitBool(ClientSetBit.hide_mine_wing,i.selected),UnitMgr.ins().updateRoleWingState(!0),ServerStorage.ins().setBitBool(ClientSetBit.hide_mine_title,i.selected),UnitMgr.ins().updateRoleTitleState(!0);break;case this.maskOther:ServerStorage.ins().setBitBool(ClientSetBit.hide_other_zhanling,i.selected),ServerStorage.ins().setBitBool(ClientSetBit.hide_other_wing,i.selected),UnitMgr.ins().updateRoleWingState(!1),ServerStorage.ins().setBitBool(ClientSetBit.hide_other_title,i.selected),UnitMgr.ins().updateRoleTitleState(!1);break;case this.bluntBangs:ServerStorage.ins().setBitBool(ClientSetBit.bluntBangs,i.selected),SceneMgr.ins().getCurrScene().updateBluntBangs();break;case this.switchUser:SDKManager.ins().SDKLogoutNative()}ServerStorage.ins().updateSetting()},e.prototype.reqFriendAppList=function(){partnerControl.upAppList()},__decorate([callDelay(200)],e.prototype,"reqFriendAppList",null),e}(BaseEuiView);__reflect(SettingView.prototype,"SettingView");var SignInControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loginTimes=0,e.conLoginTimes=0,e.todayReward=!1,e.comTimesIndexList=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.upSignIn=function(t){return[t]},e.prototype.downSignInData=function(t,e,i,o){this.loginTimes=t,this.todayReward=e,this.conLoginTimes=i,this.rewardIndex=o,EventMgr.ins().dispatch(79)},e.prototype.upGetReward=function(t){return[t]},e.prototype.showRedPoint=function(){var t=this.canNormalCheckIn()||this.checkCanReward();return t},e.prototype.canNormalCheckIn=function(){return!this.todayReward},e.prototype.checkCanReward=function(){var t=this.getRewardList(this.rewardIndex)?this.getRewardList(this.rewardIndex).days:0;return this.conLoginTimes>=t},e.prototype.getCheckInState=function(t){return t>this.loginTimes?0:t<this.loginTimes?2:this.todayReward?2:1},e.prototype.getRewardList=function(t){return DataCenter.ins().SignInDaysConfig[t+1]?DataCenter.ins().SignInDaysConfig[t+1]:null},__decorate([up(1,[2])],e.prototype,"upSignIn",null),__decorate([down(1,[2,0,2,2])],e.prototype,"downSignInData",null),__decorate([up(3,[3])],e.prototype,"upGetReward",null),e=__decorate([protocolsId(54)],e)}(BaseSystem);__reflect(SignInControl.prototype,"SignInControl");var SignInPanel=function(t){function e(){var e=t.call(this)||this;return e.currentDay=0,e.panelwidth=400,e.skinName="SignInPanelSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){this.effGroup.touchEnabled=!1,this.effGroup.touchChildren=!1,this.cardList.itemRenderer=SignInItemRenderer,this.listData=new eui.ArrayCollection,this.cardList.dataProvider=this.listData},e.prototype.open=function(){for(var t=this,e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];this.addCustomEvent(79,this.updateSignInData),this.addCustomEvent(106,this.updateSignInData),this.addEventTouchTap(this.cardList,this.onListTap),this.addEventTouchTap(this.rewardBtn,this.onClick),this.monthList=DataCenter.ins().SignInConfig,this.updateCheckInTimes(),this.updateList(),TimerMgr.ins().doNext(function(){signInControl.loginTimes>=25&&(t.cardScroller.viewport.scrollV=t.cardScroller.viewport.contentHeight-t.cardScroller.height)},this)},e.prototype.updateCheckInTimes=function(){this.checkInLab.text=LangMgr.getValueByKey("activitDay",signInControl.loginTimes.toString())},e.prototype.updateList=function(){this.listData.replaceAll(CommonUtils.objectToArray(this.monthList));var t=signInControl.conLoginTimes,e=signInControl.getRewardList(signInControl.rewardIndex);if(e){this.rewardBtn.visible=this.rewardItem.visible=!0,this.curRewardData=e;var i=this.curRewardData.days-t>=0?this.curRewardData.days-t:0,o=t>=this.curRewardData.days,n=o?LangMgr.getColor("color38"):ColorUtils.RED,r=LangMgr.getColor("color56"),a=LangMgr.getColor("color27"),s=LangMgr.getValueByKey("dailyTips8",n,t,r,this.curRewardData.days,a,i);this.dayReardText.textFlow=TextUtils.generateTextFlow(s),this.rewardItem.data=this.curRewardData.rewards[0],o?(this.rewardBtn.enabled=!0,this.eff||(this.eff=new GameMovieClip,this.eff.scaleX=.9,this.eff.scaleY=.9,this.eff.playFile(PATH_EFF+"chargeff1",-1)),this.eff.parent||this.effGroup.addChild(this.eff)):(this.rewardBtn.enabled=!1,DisplayUtils.removeFromParent(this.eff))}else DisplayUtils.removeFromParent(this.eff),this.rewardBtn.visible=this.rewardItem.visible=this.rewardBtn.enabled=!1,this.dayReardText.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("dailyGetAllGift"))},e.prototype.updateSignInData=function(t){this.updateCheckInTimes(),this.updateList()},e.prototype.onListTap=function(t){var e=this;if(t&&t.currentTarget&&this.cardList.selectedItem){var i=signInControl.getCheckInState(this.cardList.selectedItem.day);if(i)if(1==i)if(vipControl.lv>0)signInControl.upSignIn(this.cardList.selectedItem.day);else if(this.cardList.selectedItem.vipLabel&&vipControl.lv<this.cardList.selectedItem.vipLabel){var o=LangMgr.getValueByKey("dailyTips3"),n=warnControl.show(o,function(){signInControl.upSignIn(e.cardList.selectedItem.day)},this,function(){UIMgr.ins().open("PayFirstView")},this);n.showUI("","","","VIP1"),n.setBtnLabel(LangMgr.getValueByKey("dailyTips4"),LangMgr.getValueByKey("dailyTips5"))}else signInControl.upSignIn(this.cardList.selectedItem.day);else 2==i&&tipsControl.showTips(LangMgr.getValueByKey("dailyTips6"));else this.cardList.selectedItem.day>this.currentDay&&tipsControl.showTips(LangMgr.getValueByKey("dailyTips7"))}},e.prototype.onClick=function(t){signInControl.upGetReward(this.curRewardData.days)},e.prototype.cleanList=function(){this.cardList.dataProvider=null},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.eff),this.listData=null,this.removeCustomEvents(),this.cleanList()},e}(BaseEuiView);__reflect(SignInPanel.prototype,"SignInPanel");var SignInItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.id=0,e.checkInState=0,e.touchEnabled=!0,e.touchChildren=!1,e.skinName="SignInItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.resetView();var t=this.data;if(t){this.vipFlagGroup.touchChildren=!1,this.vipFlagGroup.touchEnabled=!1,this.dayFlagGroup.touchChildren=!1,this.dayFlagGroup.touchEnabled=!1,this.complement.touchEnabled=!1,this.dayFlagGroup.visible=!1,this.item.data=t.rewards[0],this.item.touchChildren=!1,this.item.touchEnabled=!1;var e=signInControl.getCheckInState(t.day);if(e)switch(e){case 1:this.checkInState=1,this.showFlag();break;case 2:this.checkInState=2,this.showChecked()}else{this.showFlag();var i=!1;this.item.touchChildren=!i,this.item.touchEnabled=!i}}this.showEquipEffect()},e.prototype.showEquipEffect=function(){var t=signInControl.getCheckInState(this.data.day);1!=t?this.equipEffect&&DisplayUtils.removeFromParent(this.equipEffect):(this.equipEffect=this.equipEffect||new GameMovieClip,this.equipEffect.touchEnabled=!1,this.equipEffect.scaleX=1.65,this.equipEffect.scaleY=1.75,this.equipEffect.parent||this.effGrp.addChild(this.equipEffect),this.equipEffect.playFile(PATH_EFF+"quaeff4",-1))},e.prototype.showChecked=function(){this.checked.visible=this.checkedMask.visible=!0},e.prototype.showFlag=function(){var t=this.data;if(t)if(t.vipLabel>0){var e=t.vipLabel;e>10&&(e=10);var i=DataCenter.ins().SignInVipConfig[e];i&&(this.vipFlagGroup.visible=!0,this.vipLab.text=LangMgr.getValueByKey("dailyVip",e))}else t.dayLabel>0&&(this.dayLab.text=LangMgr.getValueByKey("activitDay",t.day))},e.prototype.resetView=function(){this.complement.visible=!1,this.vipFlagGroup.visible=!1,this.dayFlagGroup.visible=!1,this.checked.visible=this.checkedMask.visible=!1,this.equipEffect&&DisplayUtils.removeFromParent(this.equipEffect)},e}(BaseItemRender);__reflect(SignInItemRenderer.prototype,"SignInItemRenderer");var StarSunControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.checkUpRedPoint=function(t,e){if(!starSunControl.open())return!1;var i;if(t){if(i=t,this.redPoint(i,e))return!0}else for(var o=0;o<heroControl.subRolesLen;o++)if(i=heroControl.getSubRoleByIndex(o),this.redPoint(i,e))return!0;return!1},e.prototype.redPoint=function(t,e){if(!t)return!1;if(!t.equipsData[e]||!t.equipsData[e].item||!t.equipsData[e].item.handle)return!1;var i=t.starSunVos;if(!i)return!1;for(var o=0;13>o;o++)if((isNaN(e)||o==e)&&DataCenter.ins().StarSunLvConfig[o]&&this.isMaterialUpLevel(o,i[o].level))return!0;return!1},e.prototype.open=function(){return GameServer.serverOpenDay>=DataCenter.ins().StarSunBaseConfig.serverDay-1&&reincarnateControl.lv>=DataCenter.ins().StarSunBaseConfig.zsLv?!0:!1},e.prototype.init=function(t,e){for(var i=0;i<e.length;i++){var o=e[i];t.starSunVos[i]=new StarSunVo(i,o)}},e.prototype.isMaterialUpLevel=function(t,e){if(!this.open())return!1;if(this.isMaxLevel(t,e))return!1;var i=DataCenter.ins().StarSunLvConfig[t][e+1];return backpackControl.getBagItemCount(BackpackControl.BAG_TYPE_OTHTER,i.costItem)>=i.costNum?!0:!1},e.prototype.isMaxLevel=function(t,e){var i=DataCenter.ins().StarSunLvConfig[t][e+1];return i?!1:!0},e.prototype.getAttrs=function(t,e,i){void 0===i&&(i=!1);var o=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)],n=0,r=t.starSunVos[e].level+(i?1:0);if(r){var a=DataCenter.ins().StarSunLvConfig[e][r];if(!a)return null;a.attr&&(o=AttributeData.AttrAddition(o,a.attr)),n+=BackpackControl.getAttrPower(o),n+=a.expower||0}return[o,n]},e.prototype.getPercentAttrs=function(t,e,i){void 0===i&&(i=!1);var o=[],n=0,r=t.starSunVos[e].level+(i?1:0);if(r){var a=DataCenter.ins().StarSunLvConfig[e][r];if(!a)return null;if(a.per){var s=heroControl.getBaseAttrs(t,e);s=heroControl.getBaseAttrPercent(s,a.per/1e4,!1),o=AttributeData.AttrAddition(o,s)}n+=BackpackControl.getAttrPower(o),n+=a.expower||0}return[o,n]},e.prototype.getSlotsByPos=function(t,e){for(var i=DataCenter.ins().StarSunBaseConfig.starInfo.length,o=[],n=t.starSunVos[e].level%i,r=0;i>r;r++,n--)o.push(Math.floor(t.starSunVos[e].level/i)+(n>0?1:0));return o},e.prototype.downStarSunInfo=function(t,e,i){var o=heroControl.getSubRoleByIndex(t);o.starSunVos[e]?o.starSunVos[e].level=i:o.starSunVos[e]=new StarSunVo(e,i),EventMgr.ins().dispatch(89)},e.prototype.upUpgrade=function(t,e){return[t,e]},__decorate([down(10,[1,1,3])],e.prototype,"downStarSunInfo",null),__decorate([up(10,[1,1])],e.prototype,"upUpgrade",null),e=__decorate([protocolsId(7)],e)}(BaseSystem);__reflect(StarSunControl.prototype,"StarSunControl");var StarSunRedPoint=function(t){function e(){var e=t.call(this)||this;return e.roleTabs=[],e.redPoint=!1,e.addCustomEventMany(e.dispatchStarSunRedPoint,655),e.addCustomEventMany(e.dispatchStarSunUpRedPoint,89,266,268,267),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchStarSunRedPoint=function(){this.redPoint=this.redPoint0,EventMgr.ins().dispatch(656,!0)},e.prototype.dispatchStarSunUpRedPoint=function(){for(var t=!1,e=0;e<heroControl.subRolesLen;e++){var i=heroControl.getSubRoleByIndex(e),o=!1;this.roleTabs[e]=!1;for(var n=0;13>n;n++)starSunControl.checkUpRedPoint(i,n)&&(o=!0);o&&(this.roleTabs[e]=!0,t=o)}this.redPoint0=t,EventMgr.ins().dispatch(655,!0)},e}(BaseSystem);__reflect(StarSunRedPoint.prototype,"StarSunRedPoint");var StarSunVo=function(){function t(t,e){void 0===e&&(e=0),this.id=t,this.level=e}return t}();__reflect(StarSunVo.prototype,"StarSunVo");var StarSunView=function(t){function e(){var e=t.call(this)||this;return e.starPos=[],e.aniPlaying=[],e.oldRes=[],e.skinName="StarSunViewSkin",e.isTopLevel=!0,e.canVis=!0,e}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];
this.stopEffTween()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.getItemTxt0,this.onTap),this.addEventTouchTap(this.upGradeBtn0,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventChange(this.roleSelect,this.switchRole),this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(89,this.EnhanceInfoCallBack),this.roleId=t[0]?t[0]:0,this.slot=t[1]?t[1]:0,this.costId=0;for(var i=0;i<this.starEff.numElements;i++)this.starPos[i]||(this.starPos[i]=new EquipPosAniVo(this["star"+i].x,this["star"+i].y,this["star"+i].scaleX,this["star"+i].scaleY));this.roleSelect.setCurRole(this.roleId),this.updateStarEffX(),this.updateView(),this.playEffTween()},e.prototype.switchRole=function(){var t=this.roleSelect.getCurRole();t!=this.roleId&&(this.roleId=t,this.updateView(),this.stopEffTween(),this.updateStarEffX(),this.playEffTween())},e.prototype.EnhanceInfoCallBack=function(){var t=this.getStarEffRes();if(this.oldRes.length){var e=this.oldRes.shift();this.swapItemPosAni(e,t[0]),this.oldRes.push(t[0])}else this.updateView()},e.prototype.onTap=function(t){if(!this.isPlaySuccess())switch(t.currentTarget){case this.upGradeBtn0:var e=heroControl.getSubRoleByIndex(this.roleId);if(starSunControl.isMaxLevel(this.slot,e.starSunVos[this.slot].level))return void tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));var i=starSunControl.isMaterialUpLevel(this.slot,e.starSunVos[this.slot].level);if(!i)return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));starSunControl.upUpgrade(this.roleId,this.slot);break;case this.getItemTxt0:warnControl.setBuyGoodsWarn(this.costId);break;case this.closeBtn:UIMgr.ins().close(this);break;case this.sp:tipsControl.showCenterTips(LangMgr.getValueByKey("starSun4"))}},e.prototype.updateView=function(){this.updateAttr(),this.updateCost(),this.updateRedPoint()},e.prototype.updateCost=function(){var t=heroControl.getSubRoleByIndex(this.roleId),e=DataCenter.ins().StarSunLvConfig[this.slot][t.starSunVos[this.slot].level+1];if(e){this.upInfo.visible=!0;var i=ColorUtils.RED,o=backpackControl.getBagItemById(e.costItem),n=e.costNum,r=o?o.count:0;r>=n&&(i=ColorUtils.GREEN),this.icon0.source=DataCenter.ins().ItemConfig[e.costItem].icon+"_png",this.countLabel0.textFlow=TextUtils.generateTextFlow1("|C:"+i+"&T:"+r+"|/"+n),this.costId=e.costItem}else this.upInfo.visible=!1,this.costId=0;this.getItemTxt0.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt0.text),this.getItemTxt0.visible=this.costId?!0:!1,this.maxlv.visible=!this.upInfo.visible,this.updateEffColor()},e.prototype.updateAttr=function(){var t=heroControl.getSubRoleByIndex(this.roleId),e=starSunControl.getAttrs(t,this.slot),i=starSunControl.getAttrs(t,this.slot,!0),o=starSunControl.getPercentAttrs(t,this.slot),n=e[0],r=i?i[0]:null,a=Number(e[1]);a+=Number(o[1]);for(var s in n[0])a+=ItemUtils.relatePower(n[0][s],t);this.powerPanel.setPower(a);for(var l=0;l<n.length;l++)this["attr"+n[l].type]&&(this["attr"+n[l].type].text=AttributeData.getAttrStrByType(n[l].type)+"+"+n[l].value,this["addAttr"+n[l].type].visible=r?!0:!1,r?r[l]&&(this["addAttr"+r[l].type].visible=this["arrow"+r[l].type].visible=r[l].value?!0:!1,this["addAttr"+r[l].type].text=r[l].value+""):this["addAttr"+n[l].type].visible=this["arrow"+n[l].type].visible=!1);var h=t.starSunVos[this.slot].level;if(h){var u=DataCenter.ins().StarSunLvConfig[this.slot][h];u.per&&(this.attr0.text=RoleModel.getEquipNameByType(this.slot)+LangMgr.getValueByKey("starSun1")+u.per/100+"%");var c=DataCenter.ins().StarSunLvConfig[this.slot][h+1];this.arrow0.visible=this.addAttr0.visible=c?!0:!1,c&&(this.addAttr0.text=c.per/100+"%")}else{this.attr0.text=RoleModel.getEquipNameByType(this.slot)+LangMgr.getValueByKey("starSun1")+"0%";var u=DataCenter.ins().StarSunLvConfig[this.slot][1];this.arrow0.visible=this.addAttr0.visible=u?!0:!1,u&&(this.addAttr0.text=u.per/100+"%")}},e.prototype.updateRedPoint=function(){for(var t=0;t<heroControl.subRolesLen;t++){var e=heroControl.getSubRoleByIndex(t);this.roleSelect.showRedPoint(t,starSunControl.checkUpRedPoint(e,this.slot))}var i=heroControl.getSubRoleByIndex(this.roleId);this.redPoint2.visible=starSunControl.isMaterialUpLevel(this.slot,i.starSunVos[this.slot].level)},e.prototype.updateStarEffX=function(){for(var t=this.getStarEffRes(),e=0;e<t.length;e++){var i=t[e];this["mc"+i]||(this["mc"+i]=new GameMovieClip),this["mc"+i].parent||this["starEff"+i].addChild(this["mc"+i]),this["star"+i].x=this.starPos[e].x,this["star"+i].y=this.starPos[e].y,this["star"+i].scaleX=this.starPos[e].scaleX,this["star"+i].scaleY=this.starPos[e].scaleY,this["y"+i]=this["star"+i].y,this["MoveY"+i]=this["y"+i]-10;var o=DataCenter.ins().StarSunBaseConfig.starInfo[i][0];this["mc"+i].name!=PATH_EFF+o&&this["mc"+i].playFile(PATH_EFF+o,-1)}this.oldRes=[],this.oldRes.push(t[0])},e.prototype.getNewEffPos=function(t,e){for(var i=[],o=this.getStarEffRes(),n=0;n<o.length;n++){var r=o[n];this["star"+r]&&(this["y"+r]=this.starPos[n].y,this["MoveY"+r]=this["y"+r]-10,r==e&&(i[0]=new EquipPosAniVo(this.starPos[n].x,this.starPos[n].y,this.starPos[n].scaleX,this.starPos[n].scaleY)),r==t&&(i[1]=new EquipPosAniVo(this.starPos[n].x,this.starPos[n].y,this.starPos[n].scaleX,this.starPos[n].scaleY)))}return i},e.prototype.getStarEffRes=function(){for(var t=[],e=heroControl.getSubRoleByIndex(this.roleId),i=0;i<this.starEff.numElements;i++)t.push(i);for(var o=e.starSunVos[this.slot].level,i=0,n=i+1;o>i;i++,n++)n>=t.length&&(n=1),t[0]^=t[n],t[n]^=t[0],t[0]^=t[n];return t},e.prototype.swapItemPosAni=function(t,e){var i=this;this.addSp(),TimerMgr.ins().isExists(this.aniTime,this)||(this["star"+t]&&egret.Tween.removeTweens(this["star"+t]),this["star"+e]&&egret.Tween.removeTweens(this["star"+e]),TimerMgr.ins().doTimer(100,0,this.aniTime,this)),this["ef"+t]||(this["ef"+t]=new GameMovieClip),this["ef"+t].parent||this["success"+t].addChild(this["ef"+t]),this["ef"+t].playFile(PATH_EFF+DataCenter.ins().StarSunBaseConfig.starInfo[t][2],1,function(){var o=i.getNewEffPos(t,e);i.action(t,new EquipPosAniVo(o[1].x,o[1].y,o[1].scaleX,o[1].scaleY)),i.action(e,new EquipPosAniVo(o[0].x,o[0].y,o[0].scaleX,o[0].scaleY))},this)},e.prototype.action=function(t,e){var i=this,o=this["star"+t];this.aniPlaying[t]=!0;var n=egret.Tween.get(o);n.to({x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY},500).call(function(){egret.Tween.removeTweens(o),i.aniPlaying[t]=!1,egret.Tween.removeTweens(o),egret.Tween.get(o,{loop:!0}).to({y:i["MoveY"+t]},1e3).to({y:i["y"+t]},1e3)})},e.prototype.aniTime=function(){this.isPlaySuccess()||(TimerMgr.ins().remove(this.aniTime,this),this.updateView(),this.cleanSp())},e.prototype.isPlaySuccess=function(){for(var t=0;t<this.starEff.numElements;t++)if(this.aniPlaying[t])return!0;return!1},e.prototype.playEffTween=function(){for(var t=0;t<this.starEff.numElements;t++)this["star"+t].y=this["y"+t],egret.Tween.removeTweens(this["star"+t]),egret.Tween.get(this["star"+t],{loop:!0}).to({y:this["MoveY"+t]},1e3).to({y:this["y"+t]},1e3)},e.prototype.stopEffTween=function(){for(var t=0;t<this.starEff.numElements;t++)this["star"+t]&&(this.aniPlaying[t]=!1,egret.Tween.removeTweens(this["star"+t]))},e.prototype.addSp=function(){this.sp||(this.sp=new eui.Group,this.sp.x=0,this.sp.y=0,this.sp.width=StageUtils.ins().getStage().width,this.sp.height=StageUtils.ins().getStage().height,this.sp.touchEnabled=!0),this.sp.parent||(StageUtils.ins().getStage().addChild(this.sp),this.addEventTouchTap(this.sp,this.onTap))},e.prototype.cleanSp=function(){this.removeEventTouchTap(this.sp,this.onTap),DisplayUtils.removeFromParent(this.sp)},e.prototype.updateEffColor=function(){var t=heroControl.getSubRoleByIndex(this.roleId);if(t&&t.starSunVos)for(var e=0;e<this.starEff.numElements;e++){var i=this["mc"+e];t.starSunVos[this.slot].level>e?this.setLight(i):this.setGray(i)}},e.prototype.setGray=function(t){t.filters=[new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0])]},e.prototype.setLight=function(t){t.filters=[]},e}(BaseEuiView);__reflect(StarSunView.prototype,"StarSunView");var StarSunAttrsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="StarSunAttrsItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data){var t=this.data.role,e=this.data.pos,i=starSunControl.getAttrs(t,e),o=starSunControl.getPercentAttrs(t,e),n=AttributeData.getAttStrSpecial([i[0],o[0]],4,1," ");if(t.starSunVos[e].level){var r=DataCenter.ins().StarSunLvConfig[e][t.starSunVos[e].level];r.per&&(n+="\n"+RoleModel.getEquipNameByType(e)+LangMgr.getValueByKey("starSun1")+r.per/100+"%")}this.attr.textFlow=TextUtils.generateTextFlow1(n)}},e}(BaseItemRender);__reflect(StarSunAttrsItemRenderer.prototype,"StarSunAttrsItemRenderer");var StarSunEnhanceTipsItemRenderer=function(t){function e(){var e=t.call(this)||this;return e.skinName="StarSunEnhanceTipsItemRendererSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data)for(var t=this.data,e=0;e<DataCenter.ins().StarSunBaseConfig.starInfo.length;e++)this["star"+e]&&(this["star"+e].source=DataCenter.ins().StarSunBaseConfig.starInfo[e][1],e+1>t&&this.setGray(this["star"+e]))},e.prototype.setGray=function(t){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];t.filters=[new egret.ColorMatrixFilter(e)]},e}(BaseItemRender);__reflect(StarSunEnhanceTipsItemRenderer.prototype,"StarSunEnhanceTipsItemRenderer");var CreateRoleScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(GameLayer.MAIN1),this.addLayer(GameLayer.POPUP),this.addLayer(GameLayer.TIPS);var e=loginControl.getCreateRoleView();UIMgr.ins().open(e),gameControl.heartbeat()},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(CreateRoleScene.prototype,"CreateRoleScene");var LoginScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(GameLayer.MAIN1),this.addLayer(GameLayer.POPUP),this.addLayer(GameLayer.TIPS),UIMgr.ins().open("LoginView")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(LoginScene.prototype,"LoginScene");var StartGameScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(GameLayer.MAIN1),this.addLayer(GameLayer.POPUP),this.addLayer(GameLayer.TIPS),UIMgr.ins().open("StartGameView")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(StartGameScene.prototype,"StartGameScene");var WXGameScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(GameLayer.MAIN1),this.addLayer(GameLayer.POPUP),this.addLayer(GameLayer.TIPS),UIMgr.ins().open("WXLoginView")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(WXGameScene.prototype,"WXGameScene");var YYBGameScene=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onEnter=function(){t.prototype.onEnter.call(this),this.addLayer(GameLayer.MAIN1),this.addLayer(GameLayer.POPUP),this.addLayer(GameLayer.TIPS),UIMgr.ins().open("YYBLoginView")},e.prototype.onExit=function(){t.prototype.onExit.call(this)},e}(BaseScene);__reflect(YYBGameScene.prototype,"YYBGameScene");var ThunderControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),i=e,e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){var t=0;for(var e in DataCenter.ins().ThunderSuitLvConfig[1])t=+e>t?+e:t;i.suitMaxCount=t},e.prototype.init=function(t,e){var i=t.thunderForgeVos;i||(i=[]);for(var o=0;o<e.length;o++){i[o]||(i[o]=new ThunderForgeVo(o)),i[o].slot=o;for(var n=0;n<e[o].length;n++)i[o].level[n]=e[o][n]}t.thunderForgeVos=i},e.prototype.initThunder=function(t,e){var i=t.thunderSuitVos;i||(i=[]);for(var o=0;o<e.length;o++)i[o]||(i[o]=new ThunderSuitVo(o)),i[o].slot=o,i[o].level=e[o];t.thunderSuitVos=i},e.prototype.checkSysOpen=function(){var t=DataCenter.ins().ThunderQuenBaseConfig.openLevel/1e3>>0,e=DataCenter.ins().ThunderQuenBaseConfig.openLevel%1e3>>0;return GameServer.serverOpenDay>=DataCenter.ins().ThunderQuenBaseConfig.openDay-1&&reincarnateControl.lv>=t&&ActorControl.level>=e?!0:!1},e.prototype.checkSysShow=function(){return!0},e.prototype.getRedPoint=function(){if(this.checkSysOpen()){if(this.getRedPoint0())return!0;if(this.getRedPoint1())return!0}return!1},e.prototype.getRedPoint0=function(t){for(var e=0;e<heroControl.subRolesLen;e++)if(isNaN(t)||t==e){var i=heroControl.getSubRoleByIndex(e).thunderForgeVos;if(i)for(var o=0;13>o;o++)if(i[o]&&DataCenter.ins().ThunderQuenBaseConfig.equipKong[o])for(var n=0;n<DataCenter.ins().ThunderQuenBaseConfig.equipKong[o].length;n++){var r=this.getConditionByKong(e,o,n);if(r){var a=this.getStrengthenEquipLevelConfig(e,o,n);if(a){var s=this.getCostByKong(a);if(s)return!0}}}}return!1},e.prototype.getRedPoint1=function(t){for(var e=0;e<heroControl.subRolesLen;e++)if(isNaN(t)||t==e)for(var i=0;7>=i;i++)if(this.getThunderRedPoint(e,i))return!0;return!1},e.prototype.upNewStrengthenInfoUp=function(t,e,i){return[t,e,i]},e.prototype.downNewStrengthenInfo=function(t,e,i,o){var n=heroControl.getSubRoleByIndex(t);n.thunderForgeVos||(n.thunderForgeVos=[]),n.thunderForgeVos[e]||(n.thunderForgeVos[e]=new ThunderForgeVo(e)),n.thunderForgeVos[e].slot=e,n.thunderForgeVos[e].level[i]=o,EventMgr.ins().dispatch(96)},e.prototype.getBaseAttrs=function(t,e){var i=[];if(t){var o=t.getEquipByIndex(e);if(o&&o.item){var n=DataCenter.ins().EquipConfig[o.item.configID];for(var r in n)if(-1!=AttributeData.attrNames.indexOf(r)&&n[r]){for(var a=!1,s=0;s<i.length;s++)if(i[s].type==AttributeData.translate[r]){i[s]+=n[r],a=!0;break}if(!a){var l=new AttributeData;l.type=AttributeData.translate[r],l.value=n[r],i.push(l)}}for(var h=o.item.att,u=0;u<h.length;u++){var c=h[u],a=!1;for(var p in AttributeData.attrNames)if(c.type==AttributeData.translate[AttributeData.attrNames[p]]){a=!0;break}if(a){a=!1;for(var d=0;d<i.length;d++){var g=i[d];if(g.type==c.type){g.value+=c.value,a=!0;break}}if(!a){var l=new AttributeData;l.type=c.type,l.value=c.value,i.push(l)}}}}}return i},e.prototype.getEquipSlotTotalLv=function(t,e){if(!t)return 0;var i=t.thunderForgeVos,o=0;if(i[e])for(var n in i[e].level)o+=i[e].level[n];return o},e.prototype.getRelatePower=function(t,e){var i=0;if(!t)return i;var o=t.thunderForgeVos;if(o[e]){var n=0;for(var r in o[e].level)n+=o[e].level[r];if(n){var a=[];for(var s in DataCenter.ins().ThunderQuenSumConfig[e])a.push(DataCenter.ins().ThunderQuenSumConfig[e][s]);a.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var l=0;l<a.length;l++){var h=a[l];if(h.attr&&n>=h.totalLevel){for(var u in h.attr)i+=ItemUtils.relatePower(h.attr[u],t);break}}}}return i},e.prototype.getBasePower=function(t,e){var i=0;if(!t)return i;var o=t.thunderForgeVos,n=0;for(var r in o)if(o[r]&&o[r].slot==e){for(var a in o[r].level)n+=o[r].level[a];break}if(n){var s=[];for(var l in DataCenter.ins().ThunderQuenSumConfig[e])s.push(DataCenter.ins().ThunderQuenSumConfig[e][l]);s.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});for(var h=0;h<s.length;h++){var u=s[h];if(n>=u.totalLevel){var c=this.getBaseAttrs(t,e);for(var p in c)c[p].value*=u.precent/100,c[p].value=c[p].value>>0;i+=BackpackControl.getAttrPower(c);break}}}return i},e.prototype.getAttrs=function(t,e,i){e||(e=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0)]);for(var o=t.thunderForgeVos,n=0;7>=n;n++)if((isNaN(i)||i==n)&&o[n])for(var r=0;r<o[n].level.length;r++)if(DataCenter.ins().ThunderQuenLvConfig[o[n].slot]&&DataCenter.ins().ThunderQuenLvConfig[o[n].slot][r]){var a=DataCenter.ins().ThunderQuenLvConfig[o[n].slot][r][o[n].level[r]];if(a)for(var s=0;s<a.attrs.length;s++){for(var l=!1,h=0;h<e.length;h++)if(e[h].type==a.attrs[s].type){e[h].value+=a.attrs[s].value,l=!0;break}if(!l){var u=new AttributeData;u.type=a.attrs[s].type,u.value=a.attrs[s].value,e.push(u)}}}return e},e.prototype.getDifAttrs=function(t,e,i){var o,n=[],r=heroControl.getSubRoleByIndex(t),a=r.thunderForgeVos;if(a[e]&&a[e].level[i]){o=DataCenter.ins().ThunderQuenLvConfig[e][i][a[e].level[i]];var s=DataCenter.ins().ThunderQuenLvConfig[e][i][a[e].level[i]+1];if(o&&s)for(var l=0;l<s.attrs.length;l++)if(o.attrs[l]&&s.attrs[l].type==o.attrs[l].type){var h=new AttributeData;h.type=s.attrs[l].type,h.value=s.attrs[l].value-o.attrs[l].value,n.push(h)}}else{o=DataCenter.ins().ThunderQuenLvConfig[e][i][1];for(var u=0;u<o.attrs.length;u++){var h=new AttributeData;h.type=o.attrs[u].type,h.value=o.attrs[u].value,n.push(h)}}return n},e.prototype.getConditionByKong=function(t,e,i){var o=DataCenter.ins().ThunderQuenCondConfig[e];if(!o)return!1;var n=heroControl.getSubRoleByIndex(t),r=n.thunderForgeVos,a=o[i];if(a&&r){for(var s=0;s<a.condition.length;s++){if(!r[a.condition[s].slot])return!1;if(r[e].level[a.condition[s].slot]<a.condition[s].lv)return!1}return!0}return a?!1:!0},e.prototype.getCostByKong=function(t){if(t){var e=backpackControl.getBagItemById(t.materialInfo.id),i=t.materialInfo.count,o=e?e.count:0;return o>=i}return!1},e.prototype.getStrengthenEquipLevelConfig=function(t,e,i){var o,n=heroControl.getSubRoleByIndex(t),r=n.thunderForgeVos[e];if(r){var a=r.level[i]+1;o=DataCenter.ins().ThunderQuenLvConfig[e][i][a]}else o=DataCenter.ins().ThunderQuenLvConfig[e][i][1];return o},e.prototype.upThunderEquipUp=function(t,e){return[t,e]},e.prototype.downThunderEquipUp=function(t,e,i){var o=heroControl.getSubRoleByIndex(t);o.thunderSuitVos[e].level=i,EventMgr.ins().dispatch(97)},e.prototype.getThunderRedPoint=function(t,e){var i=this.getThunderEquipLevelConfig(t,e);return this.getCostByThunder(i)},e.prototype.getCostByThunder=function(t){if(t){var e=backpackControl.getBagItemById(t.materialInfo.id),i=t.materialInfo.count,o=e?e.count:0;return o>=i}return!1},e.prototype.getThunderEquipLevelConfig=function(t,e){var i,o=heroControl.getSubRoleByIndex(t),n=o.thunderSuitVos[e];if(n){var r=n.level+1;i=DataCenter.ins().ThunderEquipLvConfig[e][r]}else i=DataCenter.ins().ThunderEquipLvConfig[e][1];return i},e.prototype.getThunderItemAttrs=function(t,e,i,o){e||(e=[new AttributeData(4,0),new AttributeData(5,0),new AttributeData(6,0),new AttributeData(2,0),new AttributeData(87,0),new AttributeData(88,0)]);for(var n=t.thunderSuitVos,r=0;7>=r;r++)if((!o||-1==o.indexOf(r))&&(isNaN(i)||i==r)&&n[r]){var a=n[r].level,s=DataCenter.ins().ThunderEquipLvConfig[r][a];if(s)for(var l=0;l<s.attrs.length;l++){for(var h=!1,u=0;u<e.length;u++)if(e[u].type==s.attrs[l].type){e[u].value+=s.attrs[l].value,h=!0;break}if(!h){var c=new AttributeData;c.type=s.attrs[l].type,c.value=s.attrs[l].value,e.push(c)}}}return e},e.prototype.getThunderItemNextAttrs=function(t,e){var i,o=[],n=heroControl.getSubRoleByIndex(t),r=n.thunderSuitVos;if(r[e]&&r[e].level){i=DataCenter.ins().ThunderEquipLvConfig[e][r[e].level];var a=DataCenter.ins().ThunderEquipLvConfig[e][r[e].level+1];if(i&&a)for(var s=0;s<a.attrs.length;s++)if(i.attrs[s]&&a.attrs[s].type==i.attrs[s].type){var l=new AttributeData;l.type=a.attrs[s].type,l.value=a.attrs[s].value-i.attrs[s].value,o.push(l)}}else{i=DataCenter.ins().ThunderEquipLvConfig[e][1];for(var s=0;s<i.attrs.length;s++){var l=new AttributeData;l.type=i.attrs[s].type,l.value=i.attrs[s].value,o.push(l)}}return o},e.prototype.getAttrValueDesc=function(t,e){var i="";switch(t){case 2:case 4:case 5:case 6:i=e+"";break;default:i=(e/100>>0)+"%"}return i},e.prototype.getSuitData=function(t,e){var i=[],o=DataCenter.ins().ThunderSuitLvConfig[t];if(!o)return null;var n=[],r=[];for(var a in o)if(n.push(+a),!r.length)for(var s in o[a])r.push(+s);if(r.sort(SortUtils.sortDescByKey),n.sort(SortUtils.sortDescByKey),0==t){for(var l=Math.min(e.thunderSuitVos[0]?e.thunderSuitVos[0].level:0,e.thunderSuitVos[2]?e.thunderSuitVos[2].level:0),h=0;h<r.length;h++)if(l>=r[h]){i.push(new ThunderSuitCalcVo(t,o[2][r[h]].level,o[2][r[h]].num));break}return i}if(1==t){for(var u=[e.thunderSuitVos[1]?e.thunderSuitVos[1].level:0,e.thunderSuitVos[3]?e.thunderSuitVos[3].level:0,e.thunderSuitVos[4]?e.thunderSuitVos[4].level:0,e.thunderSuitVos[5]?e.thunderSuitVos[5].level:0,e.thunderSuitVos[6]?e.thunderSuitVos[6].level:0,e.thunderSuitVos[7]?e.thunderSuitVos[7].level:0],c={},h=0;h<r.length;h++){var s=r[h];c[s]=0;for(var p=0;p<u.length;p++)u[p]>=s&&c[s]++}for(var h=0;h<n.length;h++){for(var a=n[h],p=0;p<r.length;p++){var s=r[p];if(c[s]>=a){i.push(new ThunderSuitCalcVo(t,o[a][s].level,o[a][s].num));break}}if(i.length>=n.length)break}return i}return null},e.prototype.getSuitRelatePower=function(t){var e=0;if(!t)return e;var i=this.getSuitData(0,t),o=this.getSuitData(1,t);if(i)for(var n in i){var r=i[n].type,a=i[n].level,s=i[n].num,l=this.getThunderSuitLevelConfig(r,s,a);for(var h in l.attrs)e+=ItemUtils.relatePower(l.attrs[h],t);e+=l.ex_power?l.ex_power:0}if(o)for(var n in o){var r=o[n].type,a=o[n].level,s=o[n].num,l=this.getThunderSuitLevelConfig(r,s,a);for(var h in l.attrs)e+=ItemUtils.relatePower(l.attrs[h],t);e+=l.ex_power?l.ex_power:0}return e},e.prototype.getThunderSuitAttrs=function(t,e,i){var o,n,r=[],a=0,s=[2,4,5,6,87,88];if(0==e?o=this.getSuitData(0,t):1==e?n=this.getSuitData(1,t):(o=this.getSuitData(0,t),n=this.getSuitData(1,t)),o)for(var l=0;l<o.length;l++)if(!i||i==o[l].num){var h=this.getThunderSuitLevelConfig(o[l].type,o[l].num,o[l].level);if(h&&h.attrs){for(var u=[],c=0;c<h.attrs.length;c++)-1!=s.indexOf(h.attrs[c].type)&&u.push(h.attrs[c]);r=AttributeData.AttrAddition(r,u),h.pre&&(a+=h.pre/100)}}if(n)for(var l=0;l<n.length;l++)if(!i||i==n[l].num){var h=this.getThunderSuitLevelConfig(n[l].type,n[l].num,n[l].level);if(h){var p=[];if(h.attrs)for(var c=0;c<h.attrs.length;c++)-1!=s.indexOf(h.attrs[c].type)&&p.push(h.attrs[c]);r=AttributeData.AttrAddition(r,p),h.pre&&(a+=h.pre/100)}}return[r,a]},e.prototype.getThunderAttrs=function(t,e){var i=this.getAttrs(t,null,e);i=this.getThunderItemAttrs(t,i,e);var o=this.getThunderSuitAttrs(t);return this.AddThunderPercent(i,o[1]),i=AttributeData.AttrAddition(i,o[0])},e.prototype.AddThunderPercent=function(t,e,i){void 0===i&&(i=!0);for(var o=0;o<t.length;o++)(2==t[o].type||4==t[o].type||5==t[o].type||6==t[o].type)&&(i?t[o].value*=1+e:t[o].value*=e,t[o].value=t[o].value>>0)},e.prototype.isThunderSkill=function(t){var e=DataCenter.ins().ThunderSuitLvConfig[0][2];for(var i in e)for(var o=e[i],n=o.skillId,r=0;r<n.length;r++){var a=n[r],s=DataCenter.ins().SkillsConfig[a];if(t==a||s.otherSkills&&s.otherSkills.indexOf(t)>-1)return!0}return!1},e.prototype.getCurThunderSkillLv=function(t){return Math.min(t.thunderSuitVos[0].level,t.thunderSuitVos[2].level)},e.prototype.getThunderSuitLevelConfig=function(t,e,i){return DataCenter.ins().ThunderSuitLvConfig[t]&&DataCenter.ins().ThunderSuitLvConfig[t][e]&&DataCenter.ins().ThunderSuitLvConfig[t][e][i]?DataCenter.ins().ThunderSuitLvConfig[t][e][i]:null},e.suitMaxCount=6,__decorate([up(6,[2,2,2])],e.prototype,"upNewStrengthenInfoUp",null),__decorate([down(6,[2,2,2,2])],e.prototype,"downNewStrengthenInfo",null),__decorate([up(7,[1,1])],e.prototype,"upThunderEquipUp",null),__decorate([down(7,[4,4,3])],e.prototype,"downThunderEquipUp",null),e=i=__decorate([protocolsId(7)],e);var i}(BaseSystem);__reflect(ThunderControl.prototype,"ThunderControl");var ThunderForgeVo=function(){function t(t){this.slot=t,this.level=[];var e=DataCenter.ins().ThunderQuenBaseConfig.equipKong[t];e||(e=DataCenter.ins().ThunderQuenBaseConfig.equipKong[0]);for(var i=0;i<e.length;i++)this.level[i]=0}return t}();__reflect(ThunderForgeVo.prototype,"ThunderForgeVo");var ThunderSuitCalcVo=function(){function t(t,e,i){this.type=t,this.level=e,this.num=i}return t}();__reflect(ThunderSuitCalcVo.prototype,"ThunderSuitCalcVo");var ThunderSuitVo=function(){function t(t){this.slot=t,this.level=0}return t}();__reflect(ThunderSuitVo.prototype,"ThunderSuitVo");var ThunderForgePanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.equipMc),this.stopIconTween()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.getItemTxt,this.onTap),this.addEventTouchTap(this.upGradeBtn,this.onTap),this.addEventTouchTap(this.suitAttr,this.onTap);for(var i=0;i<this.equips.numElements;i++)this.addEventTouchTap(this["equip"+i],this.onTap);for(var i=0;i<this.equipUps.numElements;i++)this.addEventTouchTap(this["equipUp"+i],this.onClick);this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(96,this.NewStrengthenInfoCallBack),this.roleId=t[0]?t[0]:0,this.slot=t[1]?t[1]:0,this.kong=t[2]?t[2]:0,this.costId=0,this.updateView()},e.prototype.NewStrengthenInfoCallBack=function(){this.playMc(),this.updateKongIndex(),this.updateView()},e.prototype.playMc=function(){if(this.equipUpEff0){var t=new GameMovieClip;t.playFile(PATH_EFF+"leitingcuilianchenggong",1),this.equipUpEff0.addChild(t)}if(this["equipUp"+this.kong]){var t=new GameMovieClip;t.playFile(PATH_EFF+"forgeSuccess",1),this["equipUp"+this.kong].eff.addChild(t)}},e.prototype.updateKongIndex=function(){var t=thunderControl.getStrengthenEquipLevelConfig(this.roleId,this.slot,this.kong);if(t){var e=thunderControl.getConditionByKong(this.roleId,this.slot,this.kong);if(e)return}for(var i=!1,o=0;o<DataCenter.ins().ThunderQuenBaseConfig.kongIcon.length;o++){var n=thunderControl.getStrengthenEquipLevelConfig(this.roleId,this.slot,o);if(n){this.kong=o,i=!0;break}}i||(this.kong=0)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.upGradeBtn:var e=thunderControl.getConditionByKong(this.roleId,this.slot,this.kong);if(!e){var i=DataCenter.ins().ThunderQuenCondConfig[this.slot][this.kong];if(i){for(var o="",n=0;n<i.condition.length;n++){var r=DataCenter.ins().ThunderQuenBaseConfig.equipKong[this.slot][i.condition[n].slot];o+=r+LangMgr.getValueByKey("thunerForge1",i.condition[n].lv),n+1<i.condition.length&&(o+=",")}return o+=LangMgr.getValueByKey("commonUnlock")+DataCenter.ins().ThunderQuenBaseConfig.equipKong[this.slot][this.kong],void tipsControl.showTips(o)}}var a=thunderControl.getStrengthenEquipLevelConfig(this.roleId,this.slot,this.kong);if(!a)return void tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));if(!thunderControl.getCostByKong(a))return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));thunderControl.upNewStrengthenInfoUp(this.roleId,this.slot,this.kong);break;case this.getItemTxt:warnControl.setBuyGoodsWarn(this.costId);break;case this.suitAttr:UIMgr.ins().open(ThunderStrengthTipsView,this.roleId,this.slot);break;default:for(var n=0;n<this.equips.numElements;n++)this["equip"+n]&&(this["equip"+n].select.visible=!1,t.currentTarget==this["equip"+n]&&(this["equip"+n].select.visible=!0,this.slot=n,this.updateKongIndex()));this.updateView()}},e.prototype.onClick=function(t){for(var e=this["equipUp"+this.kong],i=!1,o=-1,n=0;n<this.equipUps.numElements;n++)this["equipUp"+n]&&(this["equipUp"+n].select.visible=!1,t.currentTarget==this["equipUp"+n]&&(o=n,i=thunderControl.getConditionByKong(this.roleId,this.slot,n),i&&(this["equipUp"+n].select.visible=!0,this.kong=n)));if(!i&&o>0){e.select.visible=!0;var r=DataCenter.ins().ThunderQuenCondConfig[this.slot][o];if(r){for(var a="",n=0;n<r.condition.length;n++){var s=DataCenter.ins().ThunderQuenBaseConfig.equipKong[this.slot][r.condition[n].slot];a+=s+LangMgr.getValueByKey("thunerForge1",r.condition[n].lv),n+1<r.condition.length&&(a+=",")}return a+=LangMgr.getValueByKey("commonUnlock")+DataCenter.ins().ThunderQuenBaseConfig.equipKong[this.slot][o],void tipsControl.showCenterTips("|C:"+LangMgr.getColor("color22")+"&T:"+a)}}this.updateView()},e.prototype.setRoleId=function(t){this.roleId=t,this.updateKongIndex(),this.updateView()},e.prototype.updateView=function(){this.updateEquipUps(),this.updateAttr(),this.updateCost(),this.updateEquips(),this.updateEquipMc()},e.prototype.updateEquipMc=function(){this.equipMc||(this.equipMc=new GameMovieClip),this.equipMc.parent||this.equipEff.addChild(this.equipMc),this.equipMc.y=0,this.iconY=this.equipMc.y,this.iconMoveY=this.iconY-10,this.playIconTween();var t=PATH_EFF+DataCenter.ins().ThunderQuenBaseConfig.equipEff[this.slot];this.equipMc.name!=t&&this.equipMc.playFile(t,-1),this.equipBg.source="equipup_equip_bg_"+this.slot},e.prototype.updateEquips=function(){for(var t=heroControl.getSubRoleByIndex(this.roleId),e=t.thunderForgeVos,i=0;i<DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo.length;i++){var o=this["equip"+i];if(o){if(o.itemName.text=DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[i][0],o.redPoint.visible=!1,o.select.visible=this.slot==i,o.lvNum.text=thunderControl.getEquipSlotTotalLv(t,i)+"",!o.iconEff.numElements){var n=new GameMovieClip;n.playFile(PATH_EFF+DataCenter.ins().ThunderQuenBaseConfig.equipEff[i],-1),o.iconEff.addChild(n)}if(!e[i]||!DataCenter.ins().ThunderQuenBaseConfig.equipKong[i])continue;var r=!1;o.lvNum.visible=r;for(var a=0;a<DataCenter.ins().ThunderQuenBaseConfig.equipKong[i].length;a++){var s=thunderControl.getConditionByKong(this.roleId,i,a);if(s){r=!0;var l=thunderControl.getStrengthenEquipLevelConfig(this.roleId,i,a);if(l){var h=thunderControl.getCostByKong(l);if(h){o.redPoint.visible=h;break}}}}o.lvNum.visible=r}}},e.prototype.updateCost=function(){var t=thunderControl.getStrengthenEquipLevelConfig(this.roleId,this.slot,this.kong);if(t){this.upInfo.visible=!0;var e=ColorUtils.RED,i=backpackControl.getBagItemById(t.materialInfo.id),o=t.materialInfo.count,n=i?i.count:0;n>=o&&(e=ColorUtils.GREEN),this.icon.source=DataCenter.ins().ItemConfig[t.materialInfo.id].icon+"_png",this.countLabel.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+n+"|/"+o),this.costId=t.materialInfo.id}else this.upInfo.visible=!1,this.costId=0;this.getItemTxt.textFlow=TextUtils.generateTextFlow1("|U:&T:"+this.getItemTxt.text),this.getItemTxt.visible=this.costId?!0:!1,this.maxlv.visible=!this.upInfo.visible,this.redPoint0.visible=!1;var r=thunderControl.getConditionByKong(this.roleId,this.slot,this.kong);if(r){var a=thunderControl.getStrengthenEquipLevelConfig(this.roleId,this.slot,this.kong);a&&(this.redPoint0.visible=thunderControl.getCostByKong(a))}},e.prototype.updateAttr=function(){for(var t=heroControl.getSubRoleByIndex(this.roleId),e=thunderControl.getAttrs(t),i=BackpackControl.getAttrPower(e),o=0;7>=o;o++)i+=thunderControl.getRelatePower(t,o),i+=thunderControl.getBasePower(t,o);this.powerPanel.setPower(i);for(var n=thunderControl.getDifAttrs(this.roleId,this.slot,this.kong),o=0;o<e.length;o++)this["attr"+e[o].type]&&(this["attr"+e[o].type].text=AttributeData.getAttrStrByType(e[o].type)+"+"+e[o].value,this["addAttr"+e[o].type].visible=n.length?!0:!1,n.length?n[o]&&(this["addAttr"+e[o].type].visible=this["arrow"+e[o].type].visible=n[o].value?!0:!1,this["addAttr"+e[o].type].text=e[o].value+n[o].value+""):this["addAttr"+e[o].type].visible=this["arrow"+e[o].type].visible=!1)},e.prototype.updateEquipUps=function(){for(var t=heroControl.getSubRoleByIndex(this.roleId).thunderForgeVos,e=0;e<this.equipUps.numElements;e++){var i=this["equipUp"+e];if(i)if(DataCenter.ins().ThunderQuenBaseConfig.equipKong[this.slot].length<e)i.visible=!1;else{i.redPoint.visible=!1;var o=thunderControl.getConditionByKong(this.roleId,this.slot,e);if(o){var n=thunderControl.getStrengthenEquipLevelConfig(this.roleId,this.slot,e);n&&(i.redPoint.visible=thunderControl.getCostByKong(n))
}i.visible=!0,i.openText.text=DataCenter.ins().ThunderQuenBaseConfig.equipKong[this.slot][e],i.lvNum.text=t[this.slot].level[e],i.lvNum.visible=o?!0:!1,i.select.visible=this.kong==e,i.icon.visible=o?!0:!1,i.lock.visible=!i.icon.visible,i.icon.source=DataCenter.ins().ThunderQuenBaseConfig.kongIcon[e][1],i.nameImg.source=DataCenter.ins().ThunderQuenBaseConfig.kongIcon[e][0]}}},e.prototype.playIconTween=function(){this.equipMc&&(this.equipMc.y=this.iconY,egret.Tween.removeTweens(this.equipMc),egret.Tween.get(this.equipMc,{loop:!0}).to({y:this.iconMoveY},1e3).to({y:this.iconY},1e3))},e.prototype.stopIconTween=function(){egret.Tween.removeTweens(this.equipMc)},e}(BasePanel);__reflect(ThunderForgePanel.prototype,"ThunderForgePanel");var ThunderItemTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ThunderItemTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.itemId=t[0],this.updateView()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateView=function(){var t=DataCenter.ins().ItemConfig[this.itemId],e=ItemUtils.getSubType(t),i=DataCenter.ins().ThunderEquipLvConfig[e][1],o=BackpackControl.getAttrPower(i.attrs);o+=i.ex_power?i.ex_power:0,this.powerPanel.setPower(o),this.itemname.text=t.name,this.lblTitle.text=t.name,this.itemIcon.setData(t),this.mc||(this.mc=new GameMovieClip),this.mc.parent||this.thunderEff.addChild(this.mc),this.mc.playFile(PATH_EFF+DataCenter.ins().ThunderQuenBaseConfig.thunderRes[e][2],-1),this.content.textFlow=TextUtils.generateTextFlow1(t.desc)},e}(BaseEuiView);__reflect(ThunderItemTipsView.prototype,"ThunderItemTipsView");var ThunderSkillTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ThunderSkillTipsViewSkin",e.uilayer=GameLayer.POPUP,e.selfChar=new UnitMonster,e.selfChar.x=e.actor.x,e.selfChar.y=e.actor.y,e.selfChar.hideBodyContainer(),e.show.addChild(e.selfChar),e.targetChar=new UnitMonster,e.targetChar.x=e.target.x,e.targetChar.y=e.target.y,e.targetChar.hideBodyContainer(),e.show.addChild(e.targetChar),e}return __extends(e,t),e.prototype.initUI=function(){var e=this;t.prototype.initUI.call(this),this.maxLv=5,SkillEffPlayShow.bottomLayer=this.show,SkillEffPlayShow.topLayer=this.show,SkillEffPlayShow.setTimeout=function(t,e,i){TimerMgr.ins().doTimer(t,1,e,i)},SkillEffPlayShow.shake=function(t,i,o,n,r){r=r||1,t==UnitMgr.ins().getMainRole(0)&&Math.random()<r&&DisplayUtils.shakeIt(e.show,i,o,n)}},e.prototype.isAct=function(){return this.role.thunderSuitVos.length>0&&this.role.thunderSuitVos[0].level>=1&&this.role.thunderSuitVos[2].level>=1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTouch),this.role=heroControl.getSubRoleByIndex(t[0]);var i=this.role.job,o=1;if(this.isAct()){this.currentState="active",this.nametxt0.text=DataCenter.ins().ThunderQuenBaseConfig.suitSkillName[1]+"·"+LangMgr.getValueByKey("jobShort"+i),o=thunderControl.getCurThunderSkillLv(this.role);var n=thunderControl.getThunderSuitLevelConfig(0,2,o).skillId[i-1],r=DataCenter.ins().SkillsConfig[n],a=DataCenter.ins().SkillsDescConfig[r.desc];if(this.lvtxt0.text="Lv."+o,this.activeDesc0.text=DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[0][0]+LangMgr.getValueByKey("thunerForge1",o)+"，"+DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[2][0]+LangMgr.getValueByKey("thunerForge1",o),this.skillDesc0.textFlow=TextUtils.generateTextFlow1(a.desc),this.playSkillEff(a),o++,o>this.maxLv)return void(this.currentState="max");n=thunderControl.getThunderSuitLevelConfig(0,2,o).skillId[i-1],r=DataCenter.ins().SkillsConfig[n],a=DataCenter.ins().SkillsDescConfig[r.desc],this.lvtxt1.text="Lv."+o,this.activeDesc1.text=DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[0][0]+LangMgr.getValueByKey("thunerForge1",o)+"，"+DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[2][0]+LangMgr.getValueByKey("thunerForge1",o);var s=StringUtils.getStrColor(a.desc);this.skillDesc1.textFlow=TextUtils.generateTextFlow1(StringUtils.replaceStrColor(a.desc,s))}else{this.currentState="unactive",o=1;var n=thunderControl.getThunderSuitLevelConfig(0,2,o).skillId[i-1],r=DataCenter.ins().SkillsConfig[n],a=DataCenter.ins().SkillsDescConfig[r.desc];this.nametxt0.text=DataCenter.ins().ThunderQuenBaseConfig.suitSkillName[1]+"·"+LangMgr.getValueByKey("jobShort"+i),this.lvtxt0.text="Lv."+o,this.activeDesc0.text=DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[0][0]+LangMgr.getValueByKey("thunerForge1",1)+"，"+DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[2][0]+LangMgr.getValueByKey("thunerForge1",1);var s=StringUtils.getStrColor(a.desc);this.skillDesc0.textFlow=TextUtils.generateTextFlow1(StringUtils.replaceStrColor(a.desc,s)),this.playSkillEff(a)}},e.prototype.playSkillEff=function(t){var e=this;TimerMgr.ins().removeAll(this);var i=function(){SkillEffPlayShow.play(t.effectId,e.selfChar,[e.targetChar])};i(),TimerMgr.ins().doTimer(2e3,0,i,this)},e.prototype.onTouch=function(t){UIMgr.ins().close(this)},e}(BaseEuiView);__reflect(ThunderSkillTipsView.prototype,"ThunderSkillTipsView");var ThunderStrengthTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ThunderStrengthTipsViewSkin",e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.roleId=t[0],this.slot=t[1],this.updateActive(),this.updateView()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this)}},e.prototype.updateActive=function(){var t=heroControl.getSubRoleByIndex(this.roleId).thunderForgeVos;this.totalLevel=0,this.suitLv=1;for(var e in t)if(t[e]&&t[e].slot==this.slot){for(var i in t[e].level)this.totalLevel+=t[e].level[i];break}var o=[];for(var n in DataCenter.ins().ThunderQuenSumConfig[this.slot])o.push(DataCenter.ins().ThunderQuenSumConfig[this.slot][n]);o.sort(function(t,e){return t.totalLevel>e.totalLevel?-1:1});var r=!1;if(this.totalLevel){for(var a=0,i=0;i<o.length;i++){var s=o[i];if(a++,this.totalLevel>=s.totalLevel){this.suitConfig=s,r=1==a,r||(this.nextsuitConfig=o[a-2]);break}}this.suitLv=o.length-a+1}this.suitConfig?r?this.currentState="max":this.currentState="active":(this.currentState="unactive",this.suitConfig=o[o.length-1]),this.validateNow()},e.prototype.updateView=function(){this.setCurDesc(),this.setNextDesc()},e.prototype.setCurDesc=function(){this.name0.text=DataCenter.ins().ThunderQuenBaseConfig.suitSkillName[0]+LangMgr.getValueByKey("numberLevel",this.suitLv);var t="";if("unactive"==this.currentState&&(this.activeLbl.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("thunderStrength1",this.suitConfig.totalLevel,this.totalLevel,this.suitConfig.totalLevel))),t+=LangMgr.getValueByKey("thunderStrength2",RoleModel.getEquipNameByType(this.slot),this.suitConfig.precent),this.suitConfig.attr){var e=AttributeData.getCustomAttrValue(this.suitConfig.attr,65),i=void 0;e&&(i=[],i.push({type:65,value:LangMgr.getValueByKey("thunderStrength3",e)})),t+="\n"+AttributeData.getAttStr(this.suitConfig.attr,0,1,"+",!1,!0,null,"",i)}this.content0.textFlow=TextUtils.generateTextFlow1(t)},e.prototype.setNextDesc=function(){if(this.nextsuitConfig){this.name1.text=DataCenter.ins().ThunderQuenBaseConfig.suitSkillName[0]+LangMgr.getValueByKey("numberLevel",this.suitLv+1);var t="";if(this.nextActiveLbl.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("thunderStrength1",this.nextsuitConfig.totalLevel,this.totalLevel,this.nextsuitConfig.totalLevel)),t+=LangMgr.getValueByKey("thunderStrength2",RoleModel.getEquipNameByType(this.slot),this.nextsuitConfig.precent),this.nextsuitConfig.attr){var e=AttributeData.getCustomAttrValue(this.nextsuitConfig.attr,65),i=void 0;e&&(i=[],i.push({type:65,value:LangMgr.getValueByKey("thunderStrength3",e)})),t+="\n"+AttributeData.getAttStr(this.nextsuitConfig.attr,0,1,"+",!1,!0,null,"",i)}this.content1.textFlow=TextUtils.generateTextFlow1(t)}},e}(BaseEuiView);__reflect(ThunderStrengthTipsView.prototype,"ThunderStrengthTipsView");var ThunderSuitPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.equipPos=[],e.equipItems=[],e.aniTags=[],e.beginPoint=0,e.canDoList=[],e}return __extends(e,t),e.prototype.childrenCreated=function(){this.effY=this.equipEff.verticalCenter,this.effMoveY=this.effY-10},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().getView(ThunderView).isNotMove=!1,TimerMgr.ins().remove(this.aniTime,this),this.stopBeatAnimat(),this.stopTween()},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().getView(ThunderView).isNotMove=!0,this.addEventTouchTap(this.upGradeBtn,this.onTap),this.addEventTouchTap(this.skillBtn,this.onTap),this.addEventTouchTap(this.suitBtn,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap);for(var i=0;i<this.equipUps.numElements;i++)this["equip"+i]&&(this["equip"+i].name=i+"",this.equipPos[i]?(this["equip"+i].x=this.equipPos[i].x,this["equip"+i].y=this.equipPos[i].y):(this.equipPos[i]=new EquipPosAniVo(this["equip"+i].x,this["equip"+i].y,this["equip"+i].scaleX,this["equip"+i].scaleY),this.equipItems[i]=this["equip"+i],this.equipItems[i].x=this["equip"+i].x,this.equipItems[i].y=this["equip"+i].y,this.addEventTouchTap(this["equip"+i],this.onClick)));this.addCustomEvent(266,this.updateView),this.addCustomEvent(268,this.updateView),this.addCustomEvent(267,this.updateView),this.addCustomEvent(97,this.ThunderEquipUpCallBack),this.equipEff.touchEnabled=!1,this.roleId=t[0]?t[0]:0,this.slot=t[1]?t[1]:0,this.costId=0,this.updateView(),this.playUpTween()},e.prototype.ThunderEquipUpCallBack=function(){this.playMc(),this.updateView()},e.prototype.playMc=function(){if(this.equipUpEff0){var t=new GameMovieClip;t.playFile(PATH_EFF+"forgeSuccess",1),this.equipUpEff0.addChild(t)}this.startBeatAnimat()},e.prototype.addSp=function(){this.sp||(this.sp=new eui.Group,this.sp.x=0,this.sp.y=0,this.sp.width=StageUtils.ins().getStage().width,this.sp.height=StageUtils.ins().getStage().height,this.sp.touchEnabled=!0),this.sp.parent||(StageUtils.ins().getStage().addChild(this.sp),this.addEventTouchTap(this.sp,this.onTap))},e.prototype.cleanSp=function(){this.removeEventTouchTap(this.sp,this.onTap),DisplayUtils.removeFromParent(this.sp)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sp:tipsControl.showCenterTips(LangMgr.getValueByKey("thunderSuit1"));break;case this.upGradeBtn:var e=thunderControl.getThunderEquipLevelConfig(this.roleId,this.slot);if(!e)return void tipsControl.showTips(LangMgr.getValueByKey("maxLevel"));if(!thunderControl.getCostByThunder(e))return void tipsControl.showTips(LangMgr.getValueByKey("materialEnought"));thunderControl.upThunderEquipUp(this.roleId,this.slot);break;case this.skillBtn:UIMgr.ins().open(ThunderSkillTipsView,this.roleId);break;case this.suitBtn:UIMgr.ins().open(ThunderSuitTipsView,this.roleId,this.slot);break;case this.leftBtn:this.slot++,this.slot>7&&(this.slot=0),this.playEquipsAni();break;case this.rightBtn:this.slot--,this.slot<0&&(this.slot=7),this.playEquipsAni()}},e.prototype.onClick=function(t){if(!this.getTags()){for(var e=!1,i=0;i<this.equipUps.numElements;i++)this["equip"+i]&&t.currentTarget==this["equip"+i]&&(this.slot==i&&(e=!0),this.slot=i);e||this.playEquipsAni()}},e.prototype.setRoleId=function(t){if(this.roleId=t,this.updateView(),this.canDoList.length){this.canDoList.sort(SortUtils.sortAscByKey);var e=this.canDoList[0],i=heroControl.getSubRoleByIndex(t);i.thunderSuitVos[e]&&i.thunderSuitVos[e].level>=CommonUtils.getObjectLength(DataCenter.ins().ThunderEquipLvConfig[e])&&(this.slot=e,this.playEquipsAni())}},e.prototype.updateView=function(){this.updateEquips(),this.updateAttr(),this.updateCost(),this.updateEffect()},e.prototype.updateEffect=function(){this.equipEffMc||(this.equipEffMc=new GameMovieClip),this.equipEffMc.parent||(this.equipEff.addChild(this.equipEffMc),this.equipEffMc.touchEnabled=!1),this.equipEffMc.name!=PATH_EFF+DataCenter.ins().ThunderQuenBaseConfig.thunderRes[this.slot][0]&&this.equipEffMc.playFile(PATH_EFF+DataCenter.ins().ThunderQuenBaseConfig.thunderRes[this.slot][0],-1)},e.prototype.updateEquips=function(){this.canDoList=[];for(var t=0;t<this.equipPos.length;t++){var e=this.equipItems[t];e&&(e.x=this.equipPos[t].x,e.y=this.equipPos[t].y,e.scaleX=this.equipPos[t].scaleX,e.scaleY=this.equipPos[t].scaleY,this.updateEquipItem(Number(e.name))&&this.canDoList.push(Number(e.name)))}},e.prototype.updateEquipItem=function(t){var e=heroControl.getSubRoleByIndex(this.roleId),i=this["equip"+t];return i.lvNum.text=e.thunderSuitVos[t]?e.thunderSuitVos[t].level:0,i.nameLabel.text=""+DataCenter.ins().ThunderQuenBaseConfig.equipIconInfo[t][0],i.nameImg.source="equip_train_name"+t,i.itemIcon.source="equip_train_icon"+t,i.redPoint.visible=thunderControl.getThunderRedPoint(this.roleId,t),i.nameImg.visible=t==this.slot,i.nameLabel.visible=!(t==this.slot),i.redPoint.visible},e.prototype.updateAttr=function(){var t=heroControl.getSubRoleByIndex(this.roleId),e=thunderControl.getThunderSuitAttrs(t),i=thunderControl.getAttrs(t);e[1]||(i=[]);var o=thunderControl.getThunderItemAttrs(t);i=AttributeData.AttrAddition(i,o),thunderControl.AddThunderPercent(i,e[1]),i=AttributeData.AttrAddition(i,e[0]);var n=BackpackControl.getAttrPower(i);n+=thunderControl.getSuitRelatePower(t);for(var r=0;r<t.thunderSuitVos.length;r++)if(t.thunderSuitVos[r].level){var a=DataCenter.ins().ThunderEquipLvConfig[r][t.thunderSuitVos[r].level];n+=a.ex_power?a.ex_power:0}this.powerPanel.setPower(n);var s=thunderControl.getThunderItemNextAttrs(this.roleId,this.slot);thunderControl.AddThunderPercent(o,e[1]),thunderControl.AddThunderPercent(s,e[1]);for(var l=0;l<o.length;l++)if(this["attr"+o[l].type])if(this["attr"+o[l].type].visible=!0,this["attr"+o[l].type].text=AttributeData.getAttrStrByType(o[l].type)+"+"+thunderControl.getAttrValueDesc(o[l].type,o[l].value),s.length){this["addAttr"+o[l].type].visible=this["arrow"+o[l].type].visible=!1;for(var h=0;h<s.length;h++)if(s[h]&&s[h].type==o[l].type){this["addAttr"+o[l].type].visible=this["arrow"+o[l].type].visible=!0,this["addAttr"+o[l].type].text=thunderControl.getAttrValueDesc(o[l].type,o[l].value+s[h].value);break}}else this["addAttr"+o[l].type].visible=this["arrow"+o[l].type].visible=!1},e.prototype.updateCost=function(){var t=thunderControl.getThunderEquipLevelConfig(this.roleId,this.slot);if(t){this.upInfo.visible=!0;var e=ColorUtils.RED,i=backpackControl.getBagItemById(t.materialInfo.id),o=t.materialInfo.count,n=i?i.count:0;n>=o&&(e=ColorUtils.GREEN),this.icon.source=DataCenter.ins().ItemConfig[t.materialInfo.id].icon+"_png",this.countLabel.textFlow=TextUtils.generateTextFlow1("|C:"+e+"&T:"+n+"|/"+o),this.costId=t.materialInfo.id}else this.upInfo.visible=!1,this.costId=0;this.maxlv.visible=!this.upInfo.visible,this.redPoint0.visible=thunderControl.getThunderRedPoint(this.roleId,this.slot),this.upGradeBtn.labelDisplay.text=t&&1==t.level?LangMgr.getValueByKey("equiActive"):LangMgr.getValueByKey("equiUpdate")},e.prototype.calcEquipItemSortData=function(){for(var t=0,e=0,i=0;i<this.equipItems.length;i++)if(this["equip"+this.slot]==this.equipItems[i]){e=i;break}var o=e;return e>this.equipItems.length/2&&(t=1),t&&(o=this.equipItems.length-e),[t,o]},e.prototype.playEquipsAni=function(){if(!this.getTags()){for(var t=this.calcEquipItemSortData(),e=t[0],i=t[1],o=[],n=0;n<this.equipItems.length;n++)o.push(this.equipItems[n]);for(var n=0;i>n;n++)if(e){var r=this.equipItems.pop();this.equipItems.unshift(r)}else{var r=this.equipItems.shift();this.equipItems.push(r)}for(var a=[],n=0;n<o.length;n++){a[n]=[];for(var s=n,l=0;i>l;l++)e?s+=1:s-=1,s>=this.equipPos.length?s=0:0>s&&(s=this.equipPos.length-1),a[n].push(new EquipPosAniVo(this.equipPos[s].x,this.equipPos[s].y,this.equipPos[s].scaleX,this.equipPos[s].scaleY))}for(var n=0;n<a.length;n++)this.aniTags[n]=!0,this.action(o[n],a[n],n);this.addSp(),TimerMgr.ins().isExists(this.aniTime,this)||TimerMgr.ins().doTimer(100,0,this.aniTime,this)}},e.prototype.getTags=function(){for(var t=0;t<this.aniTags.length;t++)if(this.aniTags[t])return!0;return!1},e.prototype.aniTime=function(){this.getTags()||(TimerMgr.ins().remove(this.aniTime,this),this.updateView(),this.cleanSp())},e.prototype.action=function(t,e,i){var o=this;if(!e.length)return void(this.aniTags[i]=!1);var n=e.shift(),r=egret.Tween.get(t);r.to({x:n.x,y:n.y,scaleX:n.scaleX,scaleY:n.scaleY},500).call(function(){egret.Tween.removeTweens(t),o.action(t,e,i)})},e.prototype.startBeatAnimat=function(){this.stopBeatAnimat(),DisplayUtils.removeFromParent(this.equipEffMcShadow),this.equipEffMcShadow||(this.equipEffMcShadow=new GameMovieClip),this.equipEffMcShadow.parent||this.equipEff.addChild(this.equipEffMcShadow),this.equipEffMcShadow.touchEnabled=!1,this.equipEffMcShadow.playFile(this.equipEffMc.name,-1),this.equipEffMcShadow.visible=!1,TimerMgr.ins().doTimer(100,1,this.runTween,this)},e.prototype.runTween=function(){this.equipEffMcShadow.visible=!0,this.equipEffMcShadow.alpha=0,this.equipEffMcShadow.scaleX=this.equipEffMc.scaleX,this.equipEffMcShadow.scaleY=this.equipEffMc.scaleY,this.equipEffMcShadow.x=this.equipEffMc.x+(this.equipEffMc.width>>1),this.equipEffMcShadow.y=this.equipEffMc.y+(this.equipEffMc.height>>1),this.equipEffMcShadow.anchorOffsetX=this.equipEffMc.width>>1,this.equipEffMcShadow.anchorOffsetY=this.equipEffMc.height>>1,Tween.get(this.equipEffMcShadow).to({alpha:1},250).to({alpha:0,scaleX:1.2,scaleY:1.2},2e3,egret.Ease.cubicInOut)},e.prototype.stopBeatAnimat=function(){TimerMgr.ins().remove(this.runTween,this),this.equipEffMcShadow&&(Tween.removeTweens(this.equipEffMcShadow),this.equipEffMcShadow.visible=!1)},e.prototype.playUpTween=function(){this.equipEff&&(this.equipEff.verticalCenter=this.effY,egret.Tween.removeTweens(this.equipEff),egret.Tween.get(this.equipEff,{loop:!0}).to({verticalCenter:this.effMoveY},1e3).to({verticalCenter:this.effY},1e3))},e.prototype.stopTween=function(){egret.Tween.removeTweens(this.equipEff)},e}(BasePanel);__reflect(ThunderSuitPanel.prototype,"ThunderSuitPanel");var ThunderSuitTipsView=function(t){function e(){var e=t.call(this)||this;return e.skinName="ThunderSuitTipsViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap),this.roleId=t[0],this.slot=t[1],this.suits=thunderControl.getSuitData(1,heroControl.getSubRoleByIndex(this.roleId)),this.suits&&(this.updateActive(),this.updateView())},e.prototype.onTap=function(t){UIMgr.ins().close(this)},e.prototype.updateActive=function(){if(this.suits.length){var t=DataCenter.ins().ThunderSuitLvConfig[1],e=[];for(var i in t)-1==e.indexOf(+i)&&e.push(+i);for(var o=CommonUtils.getObjectLength(DataCenter.ins().ThunderSuitLvConfig[1][2]),n=0;n<e.length;n++){for(var r=!1,a=0;a<this.suits.length;a++)if(r=!0,e[n]==this.suits[a].num&&this.suits[a].level<o){r=!1;break}if(!r){this.currentState="active";break}}this.currentState||(this.currentState="max")}else this.currentState="unactive";this.validateNow()},e.prototype.updateView=function(){this.setCurDesc(),this.setNextDesc()},e.prototype.setCurDesc=function(){for(var t=heroControl.getSubRoleByIndex(this.roleId),e=0,i=0;i<t.thunderSuitVos.length;i++)0!=i&&2!=i&&t.thunderSuitVos[i].level&&e++;this.numLabel0.text="("+e+"/"+ThunderControl.suitMaxCount+")";var o=[2,4,6];if("unactive"==this.currentState)for(var i=0;i<o.length;i++){this["attrName"+o[i]].text=DataCenter.ins().ThunderQuenBaseConfig.suitNameHead[0]+"·"+o[i]+LangMgr.getValueByKey("thunderSuitTips1");var n=thunderControl.getThunderSuitLevelConfig(1,o[i],1);n.attrs&&(this["attr"+o[i]].text=AttributeData.getAttStr(n.attrs,0,1,"+")),n.pre&&(this["attr"+o[i]].text+="\n"+LangMgr.getValueByKey("thunderSuitTips2")+n.pre+"%")}else if("active"==this.currentState)for(var i=0;i<o.length;i++){DisplayUtils.removeFromParent(this["attrGroup"+o[i]]);for(var r=0;r<this.suits.length;r++)if(this.suits[r].num==o[i]){this.attrGroup.addChild(this["attrGroup"+o[i]]),this["attrName"+this.suits[r].num].text=DataCenter.ins().ThunderQuenBaseConfig.suitNameHead[this.suits[r].level-1]+"·"+o[i]+LangMgr.getValueByKey("thunderSuitTips1");var n=thunderControl.getThunderSuitLevelConfig(1,o[i],this.suits[r].level);n.attrs&&(this["attr"+o[i]].text=AttributeData.getAttStr(n.attrs,0,1,"+")),n.pre&&(this["attr"+o[i]].text+="\n"+LangMgr.getValueByKey("thunderSuitTips2")+n.pre+"%");break}}else for(var a=CommonUtils.getObjectLength(DataCenter.ins().ThunderSuitLvConfig[1][2]),i=0;i<o.length;i++)for(var r=0;r<this.suits.length;r++)if(this.suits[r].num==o[i]){this["attrName"+this.suits[r].num].text=DataCenter.ins().ThunderQuenBaseConfig.suitNameHead[a-1]+"·"+o[i]+LangMgr.getValueByKey("thunderSuitTips1");var n=thunderControl.getThunderSuitLevelConfig(1,o[i],a);n.attrs&&(this["attr"+o[i]].text=AttributeData.getAttStr(n.attrs,0,1,"+")),n.pre&&(this["attr"+o[i]].text+="\n"+LangMgr.getValueByKey("thunderSuitTips2")+n.pre+"%");break}var s=9144715,l=65280,h="";h+="|C:"+(t.thunderSuitVos[1]&&t.thunderSuitVos[1].level?l:s)+"&T:"+RoleModel.getEquipNameByType(1)+"   |",h+="|C:"+(t.thunderSuitVos[3]&&t.thunderSuitVos[3].level?l:s)+"&T:"+RoleModel.getEquipNameByType(3)+"   |",h+="|C:"+(t.thunderSuitVos[4]&&t.thunderSuitVos[4].level?l:s)+"&T:"+RoleModel.getEquipNameByType(4)+"   |",h+="|C:"+(t.thunderSuitVos[5]&&t.thunderSuitVos[5].level?l:s)+"&T:"+RoleModel.getEquipNameByType(5)+"   |",h+="|C:"+(t.thunderSuitVos[6]&&t.thunderSuitVos[6].level?l:s)+"&T:"+RoleModel.getEquipNameByType(6)+"   |",h+="|C:"+(t.thunderSuitVos[7]&&t.thunderSuitVos[7].level?l:s)+"&T:"+RoleModel.getEquipNameByType(7)+"   |",this.informationname0.textFlow=TextUtils.generateTextFlow1(h)},e.prototype.setNextDesc=function(){if("active"==this.currentState)for(var t=[6,4,2],e=0;e<t.length;e++){for(var i=!1,o=0;o<this.suits.length;o++)if(this.suits[o].num==t[e]){i=!0;var n=DataCenter.ins().ThunderSuitLvConfig[1][t[e]];n&&(n[this.suits[o].level+1]?(this["nattrName"+this.suits[o].num].text=DataCenter.ins().ThunderQuenBaseConfig.suitNameHead[this.suits[o].level]+"·"+t[e]+LangMgr.getValueByKey("thunderSuitTips1"),n[this.suits[o].level+1].attrs&&(this["nattr"+t[e]].text=AttributeData.getAttStr(n[this.suits[o].level+1].attrs,0,1,"+")),n[this.suits[o].level+1].pre&&(this["nattr"+t[e]].text+="\n"+LangMgr.getValueByKey("thunderSuitTips2")+n[this.suits[o].level+1].pre+"%")):DisplayUtils.removeFromParent(this["nattrGroup"+t[e]]));break}if(!i){var r=thunderControl.getThunderSuitLevelConfig(1,t[e],1);this["nattrName"+t[e]].text=DataCenter.ins().ThunderQuenBaseConfig.suitNameHead[1]+"·"+t[e]+LangMgr.getValueByKey("thunderSuitTips1"),r.attrs&&(this["nattr"+t[e]].text=AttributeData.getAttStr(r.attrs,0,1,"+")),r.pre&&(this["nattr"+t[e]].text+="\n"+LangMgr.getValueByKey("thunderSuitTips2")+r.pre+"%")}}},e}(BaseEuiView);__reflect(ThunderSuitTipsView.prototype,"ThunderSuitTipsView");var ThunderView=function(t){function e(){var e=t.call(this)||this;return e.curRole=0,e.curSelectIndex=0,e.skinName="ThunderViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.panelArr=[this.thunderForgePanel,this.thunderSuitPanel],this.viewStack.selectedIndex=0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.onTabTouch),this.addEventChanging(this.tab,this.onTabTouching),this.addEventTouchTap(this.closeBtn,this.onClick),this.addCustomEvent(96,this.setRedPoint),this.addCustomEvent(97,this.setRedPoint),this.curSelectIndex=t[0]?t[0]:0,this.roleSelect.setCurRole(0),this.addEventChange(this.roleSelect,this.switchRole),this.updateView()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(this)}},e.prototype.onTabTouch=function(t){this.panelArr[this.curSelectIndex].close(),this.setSelectedIndex(t.currentTarget.selectedIndex),this.setRedPoint()},e.prototype.onTabTouching=function(t){this.checkOpen(this.tab.selectedIndex)||t.preventDefault()},e.prototype.setSelectedIndex=function(t){this.curSelectIndex=t,this.panelArr[t].open(),this.viewStack.selectedIndex=t,this.switchRole()},e.prototype.checkOpen=function(t){if(1==t){if(GameServer.serverOpenDay+1<DataCenter.ins().ThunderQuenBaseConfig.suitOpenDay)return tipsControl.showTips(LangMgr.getValueByKey("tipsOpenSeverDays",DataCenter.ins().ThunderQuenBaseConfig.suitOpenDay)),!1;if(reincarnateControl.lv<DataCenter.ins().ThunderQuenBaseConfig.suitOpenZsLv)return tipsControl.showTips(LangMgr.getValueByKey("fbRotationOpen",DataCenter.ins().ThunderQuenBaseConfig.suitOpenZsLv)),!1}return!0},e.prototype.switchRole=function(){var t=this.roleSelect.getCurRole();this.panelArr[this.curSelectIndex].setRoleId(t)},e.prototype.updateView=function(){this.setSelectedIndex(this.curSelectIndex),this.setRedPoint()},e.prototype.setRedPoint=function(){for(var t=[[!1,!1,!1],[!1,!1,!1]],e=heroControl.subRolesLen,i=0;e>i;i++){var o=thunderControl.getRedPoint0(i);o&&(t[0][i]=o),o=thunderControl.getRedPoint1(i),o&&(t[1][i]=o)}for(var n=0;n<t.length;n++){this["redPoint"+n].visible=!1;for(var r=0;r<t[n].length;r++)this.curSelectIndex==n&&this.roleSelect.showRedPoint(r,t[n][r]),t[n][r]&&(this["redPoint"+n].visible=!0)}},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<this.panelArr.length;i++)this.panelArr[i].close&&this.panelArr[i].close()},e}(BaseEuiView);__reflect(ThunderView.prototype,"ThunderView");var UnionBossControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.leftTimes=0,e.canChallenge=0,e.isKilled=0,e.passId=0,e.challengeTime=0,e.bossHP=0,e.otherGuildId=0,e.otherGuildName="",e.otherGuildBossHp=0,e.winnerId=0,e.guildRankDic=[],e.guildPersonRankDic=[],e.guildBossState=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.downInfoChange=function(t,e,i){this.leftTimes=t,this.passRecord=[];for(var o=0;o<e.length;o++)this.passRecord[e[o][0]]=e[o][1];this.canChallenge=i,EventMgr.ins().dispatch(432)},e.prototype.downRewardRecord=function(t,e){this.isKilled=t;for(var i=[],o=0;o<e.length;o++){var n=new RewardVo;n.init(e[o]),i.push(n)}TimerMgr.ins().doTimer(800,1,function(){resultControl.create(MapControl.copyType,1,i,LangMgr.getValueByKey("userGitAward"))},this)},e.prototype.downDetailChange=function(t,e,i,o,n,r,a){this.passId=t,this.challengeTime=GameServer.serverTime+1e3*e,this.bossHP=i,this.otherGuildId=o,this.otherGuildName=n,this.otherGuildBossHp=r,this.winnerId=a,EventMgr.ins().dispatch(433)},e.prototype.downChallengeBack=function(t){this.guildBossState=t,0==this.guildBossState?(this.leftTimes--,this.dispatchChallengeSuccess()):5==this.guildBossState&&this.upGetBossInfo()},e.prototype.downRankInfoChange=function(t,e,i){this.guildRankDic[t]=[],this.guildPersonRankDic[t]=[];for(var o=0;o<e.length;o++){var n=new guildBossRankData;n.name=e[o][0],n.damage=e[o][1],n.rank=o+1,this.guildRankDic[t].push(n)}for(var o=0;o<i.length;o++){var n=new guildBossRankData;n.name=i[o][0],n.damage=i[o][1],n.devote=i[o][2],n.rank=o+1,this.guildPersonRankDic[t].push(n)}EventMgr.ins().dispatch(435)},e.prototype.upChallengeBoss=function(t){return[t]},e.prototype.upGetBossReward=function(t){return[t]},e.prototype.upGetBossInfo=function(){},e.prototype.upGetBossRankInfo=function(t){return[t]},e.prototype.getBossRewardState=function(){for(var t in unionBossControl.passRecord)if(1==unionBossControl.passRecord[t])return!0;return!1},e.prototype.getBossChallenge=function(){if(!this.isOpen())return!1;if(unionBossControl.leftTimes<=0)return!1;for(var t in unionBossControl.passRecord)if(0==unionBossControl.passRecord[t])return!0;return!1},e.prototype.isOpen=function(){return new Date(GameServer.serverTime).getDay()!=DataCenter.ins().UnionBossConfig.notOpenDayOfWeek},e.prototype.dispatchChallengeSuccess=function(){EventMgr.ins().dispatch(434)},__decorate([down(1,[3,[1,1],1])],e.prototype,"downInfoChange",null),__decorate([down(2,[1,ByteConst.RewardVos])],e.prototype,"downRewardRecord",null),__decorate([down(3,[3,3,3,3,8,3,3])],e.prototype,"downDetailChange",null),__decorate([down(4,[3])],e.prototype,"downChallengeBack",null),__decorate([down(5,[3,[8,6],[8,6,3]])],e.prototype,"downRankInfoChange",null),__decorate([up(1,[1])],e.prototype,"upChallengeBoss",null),__decorate([up(2,[3])],e.prototype,"upGetBossReward",null),__decorate([up(3)],e.prototype,"upGetBossInfo",null),__decorate([up(5,[3])],e.prototype,"upGetBossRankInfo",null),e=__decorate([protocolsId(46)],e)}(BaseSystem);__reflect(UnionBossControl.prototype,"UnionBossControl");var guildBossRankData=function(){function t(){this.name="",this.damage=0,this.rank=0,this.devote=0}return t}();__reflect(guildBossRankData.prototype,"guildBossRankData");var UnionControl=function(t){function e(){var e=t.call(this)||this;return e.guildID=0,e.guildName="",e.guildLv=0,e._buildingLevels=[],e.money=0,e.notice="",e.records=[],e.guildListInfos=[],e._guildMembers=[],e.applyGuilds=[],e._guillRoleSkillInfo=[],e.guildTaskInfos=new eui.ArrayCollection,e.guildMessageInfoData=new eui.ArrayCollection,e.isFirstGetMessageInfo=!0,e._memberSortType=0,e.pageMax=1,e._conCount=[],e.hasApply=!1,e.changeNameNum=0,e.noReadMsgList=[],e.flagState=0,e.sendToFireCount=[],e.isAuto=1,e.attrLimit=99999,e.noticeAudit=0,e.addCustomEvent(353,e.startCheckShow),e.addCustomEvent(360,e.setGuild),e.addCustomEvent(466,e.checkHFDp),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.initLogin=function(){this.isFirstGetMessageInfo=!0,this.upGuildInfo(),this.upMyGuildInfo()},e.prototype.checkHFDp=function(){for(var t in DataCenter.ins().UnionLevelConfig){var e=DataCenter.ins().UnionLevelConfig[t];for(var i in e){var o=e[i];if(!isNaN(o.hefu)){if(o.hefu<=GameServer._hefuCount)continue;delete DataCenter.ins().UnionLevelConfig[t][i]}}}},e.prototype.setGuild=function(t){var e=t[0],i=t[1];this.guildID!=e&&(this.guildID=e,this.guildName=i,this.upGuildInfo(),0!=this.guildID&&UIMgr.ins().isShow(UnionApplyView)&&(UIMgr.ins().close(UnionApplyView),UIMgr.ins().open(UnionMapView)))},e.prototype.getSkllInfoByIndex=function(t){return this._guillRoleSkillInfo[t]},e.prototype.getGuildMembersByIndex=function(t){return this._guildMembers[t]},e.prototype.getGuildTaskInfosByIndex=function(t){return this.guildTaskInfos.getItemAt(t)},e.prototype.getBuildingLevels=function(t){return void 0===t&&(t=-1),-1==t?this._buildingLevels:this._buildingLevels[t]},e.prototype.getConCount=function(t){return void 0===t&&(t=-1),-1==t?this._conCount:this._conCount[t]},e.prototype.upGuildInfo=function(){},e.prototype.downGuildInfo=function(t,e,i,o,n,r,a,s,l,h,u,c){if(this._buildingLevels=[],1==t){this.guildID=e,this.guildName=i;for(var p=0;p<o.length;p++)this._buildingLevels.push(o[p]);this.money=n,this.notice=r,this.downAddGuildlimit(a,s),this.guildLv=this._buildingLevels[0],this.upGuildMembers(),this.upGuildSkillInfo(),this.downUpdateFire(l,h),this.changeNameNum=u,this.noticeAudit=c,EventMgr.ins().dispatch(14,[this.guildID,this.guildName])}},e.prototype.upGuildMembers=function(){},e.prototype.downGuildMembers=function(t){this._guildMembers=[];for(var e=0;e<t.length;e++){var i=t[e],o=new UnionMemberInfoVo;o.roleID=i[0],o.name=i[1],o.office=i[2],o.job=i[3],o.sex=i[4],o.vipLevel=i[5],o.monthCard=i[6],o.contribution=i[7],o.curContribution=i[8],o.attack=i[9],o.downTime=i[10],o.level=i[11],o.zsLevel=i[12],this._guildMembers.push(o)}EventMgr.ins().dispatch(15)},e.prototype.upGuildList=function(t,e){},e.prototype.downGuildList=function(t){this.guildListInfos=[];for(var e=0;e<t.length;e++){var i=t[e],o=new UnionListInfoVo;o.guildRank=e+1,o.guildID=i[0],o.guildLevel=i[1],o.commentLv=i[2],o.guildMember=i[3],o.guildName=i[4],o.guildPresident=i[5],o.attr=i[6],this.guildListInfos.push(o)
}EventMgr.ins().dispatch(16)},e.prototype.upGuildCreate=function(t,e){return[t,e]},e.prototype.downGuildCreate=function(t,e){0==t&&(this.guildID=e,UIMgr.ins().close(UnionCreateView),UIMgr.ins().close(UnionApplyView),UIMgr.ins().open(UnionMapView),tipsControl.showTips(LangMgr.getValueByKey("clanCreat")),this.upGuildInfo(),EventMgr.ins().dispatch(17,!0))},e.prototype.upQuitGuild=function(){},e.prototype.upJoinGuild=function(t){return[t]},e.prototype.downJoinGuild=function(){this.hasApply=!0,EventMgr.ins().dispatch(18)},e.prototype.upApplyInfos=function(){},e.prototype.downApplyInfos=function(t){for(var e=[],i=0;i<t.length;i++){var o=t[i],n=new UnionApplyInfoVo;n.roleID=o[0],n.vipLevel=o[1],n.job=o[2],n.sex=o[3],n.attack=o[4],n.name=o[5],e.push(n)}this.hasApply=t.length>0,EventMgr.ins().dispatch(19,e)},e.prototype.upProcessJoin=function(t,e){return[t,e]},e.prototype.downProcessJoin=function(t,e){var i=this.applyGuilds,o=i.indexOf(t);-1!=o&&0==e&&i.splice(o,1),1==e&&EventMgr.ins().dispatch(20,!0)},e.prototype.upChangeOffice=function(t,e){return[t,e]},e.prototype.downChangeOffice=function(t,e){for(var i=0;i<this._guildMembers.length;i++){var o=this.getGuildMembersByIndex(i);if(o.roleID==t)return o.office=e,void(t==ActorControl.actorID&&EventMgr.ins().dispatch(13))}},e.prototype.upDemise=function(){},e.prototype.upKick=function(t){return[t]},e.prototype.downQuitGuild=function(t){t==ActorControl.actorID&&(this.clearGuildInfo(),UIMgr.ins().close(UnionView),UIMgr.ins().close(UnionMapView),UIMgr.ins().close(UnionBossDetailView),UIMgr.ins().close(UnionBossView),EventMgr.ins().dispatch(12,!0))},e.prototype.downUpdateGuildInfo=function(t){switch(t){case 1:break;case 2:this.upGuildInfo();break;case 3:this.upGuildMembers();break;case 4:break;case 5:this.upApplyInfos();break;case 6:}},e.prototype.upCon=function(t){return[t]},e.prototype.downGuildMoney=function(t){this.money=t,EventMgr.ins().dispatch(21)},e.prototype.upChangeNotice=function(t){return[t]},e.prototype.downChangeNotice=function(t,e){0==t?(this.notice=e,this.noticeAudit=0):-2==t&&(this.noticeAudit=1,tipsControl.showTips(LangMgr.getValueByKey("noticeCheck"))),EventMgr.ins().dispatch(22)},e.prototype.upGuildSkillInfo=function(){},e.prototype.downGuildSkillInfo=function(t){this._guillRoleSkillInfo=[];for(var e=0;e<t.length;e++){for(var i=new GuildRoleSkillInfo,o=t[e][0],n=0;n<o.length;n++){var r=new UnionSkillInfoVo;r.level=o[n],i.guildSkillInfo.push(r)}for(var a=t[e][1],s=0;s<a.length;s++){var r=new UnionSkillInfoVo;r.level=a[s][0],r.exp=a[s][1],i.practiceSkillInfo.push(r)}this._guillRoleSkillInfo.push(i)}EventMgr.ins().dispatch(23)},e.prototype.upLearnGuildSkill=function(t,e){return[t,e]},e.prototype.downLearnGuildSkill=function(t,e,i){this.getSkllInfoByIndex(t).guildSkillInfo[e-1].level=i,EventMgr.ins().dispatch(23),tipsControl.showTips(LangMgr.getValueByKey("clanUpdata"))},e.prototype.upPracticeGuildSkill=function(t,e){return[t,e]},e.prototype.downPracticeGuildSkill=function(t,e,i,o,n){this.getSkllInfoByIndex(t).practiceSkillInfo[e-1].level=i,this.getSkllInfoByIndex(t).practiceSkillInfo[e-1].exp=o,EventMgr.ins().dispatch(23),tipsControl.showTips(LangMgr.getValueByKey("clanUniting",n))},e.prototype.upUpBuilding=function(t){return[t]},e.prototype.downUpBuilding=function(t,e){this._buildingLevels[t-1]=e,this.guildLv=this._buildingLevels[0],EventMgr.ins().dispatch(24)},e.prototype.downGuildTaskInfos=function(t){this.guildTaskInfos.removeAll(),this.initTaskInfos();for(var e=0;e<t.length;e++){var i=new UnionTaskInfoVo;i.taskID=t[e][0],i.param=t[e][1],i.state=t[e][2],i.stdTask=DataCenter.ins().UnionTaskConfig[i.taskID],this.guildTaskInfos.addItem(i)}this.updateTaskList()},e.prototype.downGuildTaskUpdate=function(t,e,i){for(var o=0;o<this.guildTaskInfos.length;o++){var n=this.guildTaskInfos.getItemAt(o);if(n&&n.taskID==t){n.param=e,n.state=i;break}}this.updateTaskList()},e.prototype.updateTaskList=function(){for(var t=this.guildTaskInfos.source,e=t.length-1;e>=0;e--)0==t[e].stdTask.type&&t.splice(e,1);t.sort(this.taskInfosSortFunc),this.guildTaskInfos.replaceAll(t),EventMgr.ins().dispatch(25)},e.prototype.upGetTaskAward=function(t){return[t]},e.prototype.upManageList=function(){},e.prototype.downManageList=function(t){this.records=[];for(var e=0;e<t.length;e++)this.parserManage(t[e]);EventMgr.ins().dispatch(26)},e.prototype.parserManage=function(t){var e="",i=DateUtils.getFormatBySecond(.001*DateUtils.formatMiniDateTime(t[0]),8);i=StringUtils.complementByChar(i,16);var o=t[1],n=t[2],r=t[3],a=(t[4],t[5]);switch(t[6],o){case 7:e=i+"  "+LangMgr.getValueByKey("unionTxt"+o,a,r+Currency.getCurrencyName(n));break;case 8:e=i+"  "+LangMgr.getValueByKey("unionTxt"+o,a,DataCenter.ins().UnionConfig.buildingNames[n-1],r);break;case 9:var s=DataCenter.ins().ItemConfig[n];e=i+"  "+LangMgr.getValueByKey("unionTxt"+o,a,ItemUtils.getQualityColor(s),s.name);break;default:e=i+"  "+LangMgr.getValueByKey("unionTxt"+o,a)}this.records.unshift(e)},e.prototype.downManage=function(){},e.prototype.upConCount=function(){},e.prototype.downConCount=function(t){for(var e=0;e<t.length;e++)this._conCount[e]=t[e];EventMgr.ins().dispatch(27)},e.prototype.upMyGuildInfo=function(){},e.prototype.downMyGuildInfo=function(t,e,i){this.myCon=t,this.myTotalCon=e,this.myOffice=i,EventMgr.ins().dispatch(28)},e.prototype.upGuildMessage=function(t){return rambleControl.checkCanSpeak()?(rambleControl.checkChatSend(t,2,!0),[t]):(rambleControl.chatLimit(3,t),!1)},e.prototype.downGuildMessage=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new UnionMessageInfoVo;i.init(t),this.addChatMsg(i),i.roleId==ActorControl.actorID&&rambleControl.startInterval()},e.prototype.addChatMsg=function(t){if(t.roleId==ActorControl.actorID&&rambleControl.checkChatSend(t.str,2,!1),-1==partnerControl.indexOfBlackList(t.roleId)){if(this.guildMessageInfoData.length>=50){var e=this.guildMessageInfoData.removeItemAt(0);rambleControl.removeAllChatMsg(e)}rambleControl.addGuildChat(t),rambleControl.dispatchNewChatMsg(t),1==t.type&&t.roleId!=ActorControl.actorID&&this.noReadMsgList.push(t)}if(1==t.type){var i=new RambleInfoVo;i.name=t.name,i.type=7,i.str=t.str,i.setNowTime(),rambleControl.dispatchNewChatMsg(i)}else 2==t.type&&EventMgr.ins().dispatch(29,!0,t.str)},e.prototype.dispatchGetNewGuildMessage=function(t){EventMgr.ins().dispatch(644,t)},e.prototype.dispatchGuildChatRed=function(){EventMgr.ins().dispatch(642,this.noReadMsgList.length>0?1:0)},e.prototype.getAllGuildMessage=function(){this.isFirstGetMessageInfo&&(this.isFirstGetMessageInfo=!1,this.upAllGuildMessage())},e.prototype.upAllGuildMessage=function(){},e.prototype.downAllGuildMessage=function(t){for(var e=[],i=0;i<t.length;i++){var o=new UnionMessageInfoVo;o.init(t[i]),(o.hasTimeOut||-1==partnerControl.indexOfBlackList(o.roleId))&&e.push(o)}rambleControl.initGuildChat(e),this.guildMessageInfoData.length&&rambleControl.dispatchNewChatMsg(this.guildMessageInfoData.getItemAt(this.guildMessageInfoData.length-1)),EventMgr.ins().dispatch(30)},e.prototype.upAddGuildLimit=function(t,e){return[t,e]},e.prototype.downAddGuildlimit=function(t,e){this.isAuto=t,this.attrLimit=e},e.prototype.upToFire=function(t,e){return this.sendToFireCount.push([t,e]),[t]},e.prototype.downUpdateFire=function(t,e){this.fireDic=this.fireDic||{};var i=this.fireDic.fireLvl!=t||this.fireDic.fireVal!=e;if(this.fireDic.fireLvl=t,this.fireDic.fireVal=e,i)for(var o=DataCenter.ins().UnionConfig,n=backpackControl.getBagItemById(o.bonfireItem),r=n?n.count:0,a=0;a<this.sendToFireCount.length;a++)if(r==this.sendToFireCount[a][1]){for(;a>=0;){var s=this.sendToFireCount.shift()[0];tipsControl.showCenterTips(LangMgr.getValueByKey("unionTxt",5*s,30*s)),a-=1}break}EventMgr.ins().dispatch(31)},e.prototype.upGuildChangeName=function(t){return[t]},e.prototype.hasApplys=function(){return this.myOffice>=5&&this.hasApply},e.prototype.clearGuildInfo=function(){this.guildID=0,this.guildName="",this.guildListInfos=[],this._guildMembers=[],this.applyGuilds=[],this.pageMax=1,this.noReadMsgList=[],unionWarControl.getModel().canSendReward=!1,unionWarControl.getModel().canGetDay=!1,unionWarControl.getModel().getDayReward=!1,unionWarControl.getModel().canSend=!1,unionWarControl.getModel().canRod=!1,unionBossControl.passRecord=null,hatredControl.clearHelpMsg()},e.prototype.removeMsgWithId=function(t){for(var e=[],i=0;i<this.guildMessageInfoData.length;i++){var o=this.guildMessageInfoData.getItemAt(i);o.roleId!=t&&e.push(o)}this.guildMessageInfoData.source=e,this.guildMessageInfoData.refresh()},e.prototype.initTaskInfos=function(){if(null==this.guildTaskInfos){var t=[],e=DataCenter.ins().UnionTaskConfig;for(var i in e)if(e.hasOwnProperty(i)){var o=e[i],n=new UnionTaskInfoVo;n.taskID=o.id,n.param=0,n.state=0,n.stdTask=o,t.push(n)}this.guildTaskInfos.replaceAll(t)}},e.prototype.taskInfosSortFunc=function(t,e){if(t.state==e.state)return t.taskID<e.taskID?-1:t.taskID>e.taskID?1:0;if(2==t.state)return 1;if(2==e.state)return-1;if(2!=t.state&&2!=e.state){if(t.taskID<e.taskID)return-1;if(t.taskID>e.taskID)return 1}return 0},e.prototype.getMemberNum=function(){return this._guildMembers.length},e.prototype.getGuildMembers=function(t){return 0==t||this._memberSortType==t?this._guildMembers:1==t?this._guildMembers.sort(this.memberSortFunc):2==t?this._guildMembers.sort(this.memberSortFunc2):this._guildMembers},e.prototype.getOfficeNum=function(t){for(var e=this._guildMembers.length,i=0,o=0;e>o;o++){var n=this._guildMembers[o];n.office==t&&i++}return i},e.prototype.canAppointFHZ=function(){return this.getOfficeNum(5)<DataCenter.ins().UnionConfig.posCounts[this.guildLv-1][1]},e.prototype.memberSortFunc=function(t,e){return t.office>e.office?-1:t.office<e.office?1:t.office==e.office?t.contribution==e.contribution?0:t.contribution>e.contribution?-1:1:0},e.prototype.memberSortFunc2=function(t,e){return t.curContribution==e.curContribution?0:t.curContribution>e.curContribution?-1:1},e.prototype.checkIsInGuild=function(t){for(var e in this._guildMembers){var i=this._guildMembers[e];if(i.roleID==t)return!0}return!1},e.prototype.getGuildInfoByName=function(t){for(var e in this._guildMembers){var i=this._guildMembers[e];if(i.name==t)return i}return null},e.prototype.startCheckShow=function(){unionWarControl.getModel().checkinAppoint()?(UIMgr.ins().closeTopLevel(),UIMgr.ins().open(UnionWarUiInfoView)):UIMgr.ins().close(UnionWarUiInfoView)},e.prototype.isUpGradeBuilding=function(){if(unionControl.myOffice<5)return!1;for(var t=[1,2],e=0;e<t.length;e++){var i=t[e],o=unionControl.getBuildingLevels(i-1)||0,n=DataCenter.ins().UnionLevelConfig[i],r=0,a=null,s=null,l=0;for(var h in n)if(n.hasOwnProperty(h)){var u=n[h];r=u.level>r?u.level:r,u.level==o&&(a=u),u.level==o+1&&(s=u)}if((a||s||2==i)&&s&&r>o&&(l=s.upFund),!(1==i&&o>=r||1!=i&&o>=unionControl.guildLv||unionControl.money<l))return!0}return!1},e.prototype.checkIsOpenUploadLogo=function(){return!!window.uploadGuildLogo&&!!DataCenter.ins().UnionConfig.uploadOpen},e.prototype.uploadGuildLogo=function(t){window.uploadGuildLogo(this.guildID,t)},e.prototype.getGuildLogo=function(t,e){return void 0==t&&(t=this.guildID),void 0==e&&(e=this.flagState),0==e?"cgb_flag"+Math.abs(t%10):window.getGuildImageUrl(t)},e.prototype.refTimeOutList=function(t){if(t){var e=this.guildMessageInfoData.getItemIndex(t);e>-1&&this.guildMessageInfoData.removeItemAt(e),rambleControl.removeAllChatMsg(t)}else for(var i=this.guildMessageInfoData.length,o=i-1;o>-1;o--){var n=this.guildMessageInfoData.getItemAt(o);n.hasTimeOut&&(this.guildMessageInfoData.removeItemAt(i),rambleControl.removeAllChatMsg(n))}},__decorate([up(1)],e.prototype,"upGuildInfo",null),__decorate([down(1,[1,6,8,[4],3,8,4,3,2,3,3,1])],e.prototype,"downGuildInfo",null),__decorate([up(2)],e.prototype,"upGuildMembers",null),__decorate([down(2,[[3,8,4,4,4,3,4,3,3,10,6,3,3]])],e.prototype,"downGuildMembers",null),__decorate([up(3)],e.prototype,"upGuildList",null),__decorate([down(3,[[6,4,4,3,8,8,3]])],e.prototype,"downGuildList",null),__decorate([up(4,[1,8])],e.prototype,"upGuildCreate",null),__decorate([down(4,[4,6])],e.prototype,"downGuildCreate",null),__decorate([up(5)],e.prototype,"upQuitGuild",null),__decorate([up(6,[3])],e.prototype,"upJoinGuild",null),__decorate([down(6)],e.prototype,"downJoinGuild",null),__decorate([up(7)],e.prototype,"upApplyInfos",null),__decorate([down(7,[[3,3,4,4,10,8]])],e.prototype,"downApplyInfos",null),__decorate([up(8,[3,1])],e.prototype,"upProcessJoin",null),__decorate([down(8,[6,4])],e.prototype,"downProcessJoin",null),__decorate([up(9,[3,1])],e.prototype,"upChangeOffice",null),__decorate([down(9,[3,4])],e.prototype,"downChangeOffice",null),__decorate([up(10)],e.prototype,"upDemise",null),__decorate([up(11,[3])],e.prototype,"upKick",null),__decorate([down(11,[3])],e.prototype,"downQuitGuild",null),__decorate([down(12,[4])],e.prototype,"downUpdateGuildInfo",null),__decorate([up(13,[3])],e.prototype,"upCon",null),__decorate([down(13,[3])],e.prototype,"downGuildMoney",null),__decorate([up(14,[8])],e.prototype,"upChangeNotice",null),__decorate([down(14,[1,8])],e.prototype,"downChangeNotice",null),__decorate([up(15)],e.prototype,"upGuildSkillInfo",null),__decorate([down(15,[[[3],[3,3]]])],e.prototype,"downGuildSkillInfo",null),__decorate([up(16,[2,1])],e.prototype,"upLearnGuildSkill",null),__decorate([down(16,[2,4,3])],e.prototype,"downLearnGuildSkill",null),__decorate([up(18,[2,1])],e.prototype,"upPracticeGuildSkill",null),__decorate([down(18,[2,4,3,3,3])],e.prototype,"downPracticeGuildSkill",null),__decorate([up(17,[1])],e.prototype,"upUpBuilding",null),__decorate([down(17,[1,1])],e.prototype,"downUpBuilding",null),__decorate([down(19,[[3,3,3]])],e.prototype,"downGuildTaskInfos",null),__decorate([down(20,[3,3,3])],e.prototype,"downGuildTaskUpdate",null),__decorate([up(21,[1])],e.prototype,"upGetTaskAward",null),__decorate([up(22)],e.prototype,"upManageList",null),__decorate([down(22,[[6,4,3,3,3,8,8]])],e.prototype,"downManageList",null),__decorate([down(23)],e.prototype,"downManage",null),__decorate([up(24)],e.prototype,"upConCount",null),__decorate([down(24,[[3]])],e.prototype,"downConCount",null),__decorate([up(25)],e.prototype,"upMyGuildInfo",null),__decorate([down(25,[3,3,4])],e.prototype,"downMyGuildInfo",null),__decorate([up(26,[8])],e.prototype,"upGuildMessage",null),__decorate([down(26,ByteConst.UnionMessageInfoVos.slice())],e.prototype,"downGuildMessage",null),__decorate([up(27)],e.prototype,"upAllGuildMessage",null),__decorate([down(27,[ByteConst.UnionMessageInfoVos])],e.prototype,"downAllGuildMessage",null),__decorate([up(28,[1,3])],e.prototype,"upAddGuildLimit",null),__decorate([down(28,[4,3])],e.prototype,"downAddGuildlimit",null),__decorate([up(30,[2])],e.prototype,"upToFire",null),__decorate([down(30,[2,3])],e.prototype,"downUpdateFire",null),__decorate([up(31,[8])],e.prototype,"upGuildChangeName",null),e=__decorate([protocolsId(37)],e)}(BaseSystem);__reflect(UnionControl.prototype,"UnionControl");var UnionCopyControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bossTimer=1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getGkDatas=function(t){return void 0===t&&(t=-1),-1==t?this._gkDatas:this._gkDatas[t]},e.prototype.downInfo=function(t,e,i,o,n,r){this.fbNum=t,this.sweep=e,this.sweepNum=i,this.tongguan=o,this.zuwei=n,this.nextFb=r,this.dispatchGuildFubenInfo()},e.prototype.dispatchGuildFubenInfo=function(){EventMgr.ins().dispatch(436)},e.prototype.downRankInfo=function(t){this.rankDatas=[];for(var e=0;e<t.length;e++){var i=new UnionCopyRankInfoVo;i.rank=e+1,i.name=t[e][0],i.guanka=t[e][1],this.rankDatas.push(i)}this.dispatchGuildFubenInfo()},e.prototype.downMaxGKInfo=function(t,e,i,o,n,r){this.isMaxGK=t,0!=this.isMaxGK&&(this.maxName=e,this.maxCareer=i,this.maxSex=o,this.maxNum=n,this.maxZhuwei=r),this.dispatchGuildFubenInfo()},e.prototype.downGKInfo=function(t,e){this.fbgkNum=t,this._gkDatas=[];for(var i=0;i<e.length;i++)this._gkDatas.push(e[i]);this.dispatchGuildFubenInfo()},e.prototype.downChangeInfo=function(t){this.change=t},e.prototype.downRewardInfo=function(t,e){this.rewardNum=t,this.rewardRoleNum=e,this.dispatchGuildFubenInfo()},e.prototype.downBossInfo=function(t){this.bossGKNum=t},e.prototype.downBossTimerEndInfo=function(t,e){this.bossGKNum=t,this.bossTimer=DateUtils.formatMiniDateTime(e)},e.prototype.downSweepEnd=function(){},e.prototype.upRankInfo=function(){},e.prototype.upMaxGKInfo=function(){},e.prototype.upGKRoleInfo=function(t){return[t]},e.prototype.upChallange=function(){},e.prototype.upSweep=function(){},e.prototype.upZhuwei=function(){},e.prototype.upReward=function(){},e.prototype.hasbtn=function(){return GameServer.serverOpenDay>0&&(0==this.sweep&&this.fbNum>0||0==this.tongguan&&this.rewardNum>0)},Object.defineProperty(e.prototype,"bossTimerEnd",{get:function(){return this.bossTimer+egret.getTimer()},enumerable:!0,configurable:!0}),__decorate([down(1,[2,1,2,1,1,1])],e.prototype,"downInfo",null),__decorate([down(2,[[8,2]])],e.prototype,"downRankInfo",null),__decorate([down(3,[1,8,1,1,2,1])],e.prototype,"downMaxGKInfo",null),__decorate([down(4,[2,[8]])],e.prototype,"downGKInfo",null),__decorate([down(5,[1])],e.prototype,"downChangeInfo",null),__decorate([down(6,[2,2])],e.prototype,"downRewardInfo",null),__decorate([down(7,[2])],e.prototype,"downBossInfo",null),__decorate([down(8,[2,3])],e.prototype,"downBossTimerEndInfo",null),__decorate([down(9)],e.prototype,"downSweepEnd",null),__decorate([up(2)],e.prototype,"upRankInfo",null),__decorate([up(3)],e.prototype,"upMaxGKInfo",null),__decorate([up(4,[2])],e.prototype,"upGKRoleInfo",null),__decorate([up(5)],e.prototype,"upChallange",null),__decorate([up(6)],e.prototype,"upSweep",null),__decorate([up(7)],e.prototype,"upZhuwei",null),__decorate([up(8)],e.prototype,"upReward",null),e=__decorate([protocolsId(39)],e)}(BaseSystem);__reflect(UnionCopyControl.prototype,"UnionCopyControl");var UnionRedPoint=function(t){function e(){var e=t.call(this)||this;return e.hanghui=!1,e.sendReward=!1,e.redBag=!1,e.sczb=!1,e.hhdt=!1,e.gldt=!1,e.hhBoss=!1,e.dayReward=!1,e.guildFire=!1,e.roleTabs={},e.roleSkillTabs={},e.liangongRed=!1,e.devildomAwardRed=!1,e.addCustomEventMany(e.dispatchDayReward,413,12),e.addCustomEventMany(e.dispatchSczb,670,673),e.addCustomEventMany(e.dispatchSendReward,416,417,12,13,28),e.addCustomEventMany(e.dispatchRedBag,408,12),e.addCustomEventMany(e.dispatchHhdt,19,18,28,674,669),e.addCustomEventMany(e.dispatchGldt,24,26,21,28),e.addCustomEventMany(e.dispatchHanghui,672,671,668,667,674,461,436,419,14,675,676,266,268,269,12),e.addCustomEventMany(e.dispatchHanghuiBoss,433,432,12),e.addCustomEventMany(e.dispatchGuildFire,266,268,31),e.addCustomEventMany(e.dispatchLianGongRedPoint,24,23,28),e.addCustomEventMany(e.dispatchDevildomFenAward,336),e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.dispatchGuildFire=function(){var t=this.guildFire;if(unionControl.guildID){var e=DataCenter.ins().UnionConfig,i=backpackControl.getBagGoodsCountById(0,e.bonfireItem),o=10,n=GameServer.serverOpenDay+1,r=1e3*reincarnateControl.lv+ActorControl.level;for(var a in e.bonfirecaution)n>=+a&&r>=e.bonfirecaution[a][0]&&(o=e.bonfirecaution[a][1]);i>=o?this.guildFire=!0:this.guildFire=!1}else this.guildFire=!1;this.guildFire!=t&&EventMgr.ins().dispatch(667,!0)},e.prototype.dispatchHhdt=function(){var t=this.hhdt;this.hhdt=unionControl.hasApplys()||this.gldt,this.hhdt!=t&&EventMgr.ins().dispatch(668,!0)},e.prototype.dispatchGldt=function(){var t=this.gldt;this.gldt=unionControl.isUpGradeBuilding(),this.gldt!=t&&EventMgr.ins().dispatch(669,!0)},e.prototype.dispatchDayReward=function(){var t=this.dayReward;this.dayReward=unionWarControl.getModel().canGetDay&&!unionWarControl.getModel().getDayReward,this.dayReward!=t&&EventMgr.ins().dispatch(670,!0)},e.prototype.dispatchSczb=function(){var t=this.sczb;this.sczb=this.dayReward||this.redBag,this.sczb!=t&&EventMgr.ins().dispatch(671,!0)},e.prototype.dispatchRedBag=function(){var t=this.redBag;this.redBag=unionWarControl.getModel().isHaveRedBag(),this.redBag!=t&&EventMgr.ins().dispatch(673,!0)},e.prototype.dispatchSendReward=function(){var t=this.sendReward;this.sendReward=unionWarControl.getModel().canSendReward,this.sendReward!=t&&EventMgr.ins().dispatch(672,!0)},e.prototype.dispatchHanghui=function(){var t=this.hanghui,e=!1;unionCopyControl.hasbtn()&&(e=!0),(void 0==unionControl.guildID||0==unionControl.guildID)&&ActorControl.level>69&&(e=!0),this.hanghui=e||this.sendReward||this.redBag||this.sczb||this.hhBoss||this.guildFire||this.liangongRed||unionWarControl.getModel().isWatStart||this.hhdt,this.hanghui!=t&&EventMgr.ins().dispatch(685,!0)},e.prototype.dispatchHanghuiBoss=function(){var t=this.hhBoss;this.hhBoss=unionBossControl.getBossRewardState()||unionBossControl.getBossChallenge(),this.hhBoss!=t&&EventMgr.ins().dispatch(675,!0)},e.prototype.dispatchLianGongRedPoint=function(){this.liangongRed=!1;for(var t=e.Tab_LianGong,i=heroControl.subRolesLen,o=0;i>o;o++){var n=heroControl.getSubRoleByIndex(o);if(n){var r=unionControl.getSkllInfoByIndex(n.index);if(r){this.roleTabs[t]||(this.roleTabs[t]={}),this.roleTabs[t][o]=!1;for(var a=1;3>=a;a++){this.roleSkillTabs[o]||(this.roleSkillTabs[o]={}),this.roleSkillTabs[o][a]=!1;var s=DataCenter.ins().UnionCommonSkillConfig[a].length,l=r.guildSkillInfo[a-1].level;if(!(l>=s)){var h=this.getCommonSkillDP(a,l+1);if(h&&!(h.contribute>unionControl.myCon||ActorControl.gold<h.money)){var u=unionControl.getBuildingLevels(1),c=1>u||l>=DataCenter.ins().UnionConfig.commonSkillLevels[u-1];c||(this.roleSkillTabs[o][a]=!0,this.liangongRed=!0)}}}for(var p in this.roleSkillTabs[o])if(this.roleSkillTabs[o][p]){this.roleTabs[t][o]=!0;break}}}}EventMgr.ins().dispatch(674)},e.prototype.getCommonSkillDP=function(t,e){var i=DataCenter.ins().UnionCommonSkillConfig[t];if(0==e)return i[1];for(var o in i){var n=i[o];if(n.level==e)return n}return null},e.prototype.dispatchDevildomFenAward=function(){var t=this.devildomAwardRed;this.devildomAwardRed=devildomControl.getDevildomFenAwardRed(),t!=this.devildomAwardRed&&EventMgr.ins().dispatch(676,!0)},e.Tab_LianGong=0,e}(BaseSystem);__reflect(UnionRedPoint.prototype,"UnionRedPoint");var UnionStoreControl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.guildStoreLv=0,e.guildStoreNum=0,e._recordInfoAry=[],e._guildStoreItemData=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getRecordInfoAry=function(t){return void 0===t&&(t=-1),-1==t?this._recordInfoAry:this._recordInfoAry[t]},e.prototype.getGuildStoreItemData=function(t){return void 0===t&&(t=-1),-1==t?this._guildStoreItemData:this._guildStoreItemData[t]},e.prototype.downInfo=function(t,e){this.guildStoreLv=t,this.guildStoreNum=e,EventMgr.ins().dispatch(441)},e.prototype.downBoxInfo=function(t){for(var e=0;e<t.length;e++){var i=new UnionStoreRecordInfoVo;i.times=t[e][0],i.roleName=t[e][1],i.itemId=t[e][2],this._recordInfoAry.length>=50&&this._recordInfoAry.pop(),this._recordInfoAry.unshift(i)}EventMgr.ins().dispatch(442)},e.prototype.downBox=function(t){this._guildStoreItemData=[];for(var e=0;e<t.length;e++){var i=new UnionStoreItemDataVo;i.itemId=t[e][0],i.num=t[e][1],this._guildStoreItemData.push(i)}this.guildStoreNum-=1,EventMgr.ins().dispatch(443)},e.prototype.upGetInfo=function(){},e.prototype.upBoxInfo=function(){var t=0;return null!=this._recordInfoAry&&0!=this._recordInfoAry.length&&(t=this.getRecordInfoAry(0).times),[t]},e.prototype.upBox=function(){},__decorate([down(1,[1,1])],e.prototype,"downInfo",null),__decorate([down(2,[[3,8,3]])],e.prototype,"downBoxInfo",null),__decorate([down(3,[[3,3]])],e.prototype,"downBox",null),__decorate([up(1)],e.prototype,"upGetInfo",null),__decorate([up(2,[3])],e.prototype,"upBoxInfo",null),__decorate([up(3)],e.prototype,"upBox",null),e=__decorate([protocolsId(42)],e)}(BaseSystem);__reflect(UnionStoreControl.prototype,"UnionStoreControl");var UnionWarControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getModel=function(){return this._guildWarModel||(this._guildWarModel=new UnionWarModelVo),this._guildWarModel},e.prototype.upSendRedBag=function(t,e){return[t,e]},e.prototype.upRobRedBag=function(){},e.prototype.upJoinAc=function(){},e.prototype.upPlayNextMap=function(t){return[t]},e.prototype.upGuildRank=function(){},e.prototype.upOwnGuildRank=function(){},e.prototype.downGuildPersonalRank=function(t){for(var e=[],i=0;i<t.length;i++){var o=new RankGuildInfo;o.init(t[i]),e[i]=o}EventMgr.ins().dispatch(411,e)},e.prototype.upDayReward=function(t){return[t]},e.prototype.upOwnMyGuildRank=function(){},e.prototype.upStartGetFlag=function(){},e.prototype.upWinGuildInfo=function(){},e.prototype.downRedBagInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.getModel().initRedbagInfo(t),EventMgr.ins().dispatch(408)},e.prototype.downSendRedBack=function(t){t&&(UIMgr.ins().close(RedBagView),tipsControl.showTips(LangMgr.getValueByKey("clanSendHB")))},e.prototype.downRobRedBack=function(t){t&&(UIMgr.ins().close(RedBagView),UIMgr.ins().open(RedBagDetailsView,1))},e.prototype.downJoinPlayBack=function(t,e,i){this.getModel().doorDie=e,this.getModel().rewardFlag=i,t&&(UIMgr.ins().close(UnionWarMainView),UIMgr.ins().close(UnionMapView)),EventMgr.ins().dispatch(409)},e.prototype.downPlayNextCard=function(){},e.prototype.downGetPointInfo=function(t,e,i){this.getModel().ownPoint=t,this.getModel().guildPoint=e,i>0&&tipsControl.showTips(LangMgr.getValueByKey("clanGetScore",i)),this.dispatchPointUpdate()},e.prototype.dispatchPointUpdate=function(){EventMgr.ins().dispatch(410)},e.prototype.downGetGongXunChange=function(t){this.getModel().gongXun=t,this.dispatchPointUpdate()},e.prototype.downGuildRankinfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.getModel().initGuildRankInfo(t)},e.prototype.downGuildWarKillInfo=function(t,e,i){this.getModel().killName=e,this.getModel().killGuild=i,UIMgr.ins().open(UnionWarReliveView,2,t)},e.prototype.downGuildWarCityOwn=function(t){this.getModel().cityOwn=t,this.dispatchCityownChange()},e.prototype.dispatchCityownChange=function(){EventMgr.ins().dispatch(412)},e.prototype.downMyActivityRankInfo=function(t){this.getModel().initMyGuildRankInfo(t)},e.prototype.downDayRewardInfo=function(t,e,i){this.getModel().canGetDay=t,this.getModel().getDayReward=e,this.getModel().rewardDay=i,EventMgr.ins().dispatch(413)},e.prototype.downFlagInfoChange=function(t,e,i,o,n){this.getModel().flagAcId=0,this.getModel().flagStatu=t,0==this.getModel().flagStatu?this.getModel().endTime=e:2==this.getModel().flagStatu&&(this.getModel().endTime=e,this.getModel().flagName=i,this.getModel().flagAcId=o,this.getModel().flagGuild=n,this.getModel().flagAcId==ActorControl.actorID&&tipsControl.showTips(LangMgr.getValueByKey("guildStartCj"))),EventMgr.ins().dispatch(414)},e.prototype.downGuildWarResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(i=this.getModel()).decodeGulidWarResult.apply(i,t);var i},e.prototype.downHuDunInfoChange=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];EventMgr.ins().dispatch(415,t)},e.prototype.downAssignsReward=function(t,e,i){this.getModel().guildWarRank=t,this.getModel().canSendReward=e,this.getModel().rewardFlag=i,EventMgr.ins().dispatch(416)},e.prototype.upFenReward=function(t,e){for(var i=[],o=this.getModel().sendNumList,n=1;t>=n;n++){for(var r=[n],a=n-1,s=e[a].length,l=[],h=0;s>h;h++){var u=e[a][h],c=[];c.push(u.roleID),c.push(o[a][h]),l.push(c)}r.push(l),i.push(r)}return[i]},e.prototype.downSendRewardSuccess=function(t){t&&(UIMgr.ins().close(SelectMemberRewardView),this.getModel().canSendReward=!1,tipsControl.showTips(LangMgr.getValueByKey("guildPartFinsh"))),EventMgr.ins().dispatch(417)},e.prototype.downWinGuildInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.getModel().winGuildInfo||(this.getModel().winGuildInfo=new WinGuildInfo),this.getModel().winGuildInfo.init(t),EventMgr.ins().dispatch(418)},e.prototype.downGuildWarStarInfo=function(t,e,i){this.getModel().isWatStart=t,this.getModel().startTime=e,this.getModel().acEndTime=i,EventMgr.ins().dispatch(419)},e.prototype.downGuildWarDoorHuDun=function(t){bossControl.curShield=t,bossControl.dispatchShieldPer()},e.prototype.downLotteryInfo=function(t){bossControl.worldPrize=t,UIMgr.ins().open("WorldBossRewardView",1)},e.prototype.upPlayLotteryInfo=function(){},e.prototype.downRankInfoChange=function(t){this.getModel().rankListChange(t)},e.prototype.downChangeAttrHandle=function(t){14==MapControl.copyType&&(this.getModel().attHandle!=t&&(this.getModel().attHandle=t,UnitShowMgr.ins().showHideSomeOne(t)),this.dispatchWeixieChange(1))},e.prototype.dispatchWeixieChange=function(t){EventMgr.ins().dispatch(420,t)},e.prototype.dispatchGuildRedPointChange=function(t){EventMgr.ins().dispatch(421,t)},e.prototype.downChangeShowList=function(t){14==MapControl.copyType&&(this.getModel().changeWeiXieList(t,!1),this.getModel().changecanPlayList(t,!1),this.getModel().setMyGuildNum(t,!1),this.getModel().attHandle&&this.getModel().attHandle==t&&(this.getModel().attHandle=0))},e.prototype.downPointRewardInfo=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.getModel().initPointRewardInfo(t)},e.prototype.upPointReward=function(){},e.prototype.downDoorEndtime=function(t){this.getModel().doEndDoorTime(t)},e.prototype.downGetMyPoint=function(t){bossControl.dispatchLotteryRan(t)},e.prototype.dispatchLotteryPoint=function(t){EventMgr.ins().dispatch(504,t)},e.prototype.downTalkMaxPoint=function(t,e){bossControl.dispatchLotteryResult(e,t)},e.prototype.downKillHuman=function(t){EventMgr.ins().dispatch(422,t)},e.prototype.downHeFuBelong=function(t){this.GuildNameBelongs=[];for(var e=0;e<t.length;e++)this.GuildNameBelongs.push(t[e]);EventMgr.ins().dispatch(423)},e.prototype.upHeFuBelong=function(){},e.prototype.dispatchLotteryMaxPost=function(t,e){EventMgr.ins().dispatch(431,[t,e])},e.prototype.dispatchMyRankChange=function(){EventMgr.ins().dispatch(430)},e.prototype.dispatchPointRewardChange=function(){EventMgr.ins().dispatch(424)},e.prototype.dispatchCanplayChange=function(){EventMgr.ins().dispatch(425)},e.prototype.dispatchRankListChange=function(){EventMgr.ins().dispatch(426)},e.prototype.dispatchGuildNumChange=function(){EventMgr.ins().dispatch(427)},e.prototype.dispatchSendListChange=function(){EventMgr.ins().dispatch(428)},e.prototype.dispatchRankInfo=function(){EventMgr.ins().dispatch(429)},__decorate([up(2,[3,3])],e.prototype,"upSendRedBag",null),__decorate([up(3)],e.prototype,"upRobRedBag",null),__decorate([up(4)],e.prototype,"upJoinAc",null),__decorate([up(5,[1])],e.prototype,"upPlayNextMap",null),__decorate([up(8)],e.prototype,"upGuildRank",null),__decorate([up(9)],e.prototype,"upOwnGuildRank",null),__decorate([down(9,[ByteConst.RankGuildInfos])],e.prototype,"downGuildPersonalRank",null),__decorate([up(13,[3])],e.prototype,"upDayReward",null),__decorate([up(14)],e.prototype,"upOwnMyGuildRank",null),__decorate([up(16)],e.prototype,"upStartGetFlag",null),__decorate([up(21)],e.prototype,"upWinGuildInfo",null),__decorate([down(1,[3,0,0,3,3,3,ByteConst.GuildRedRobInfos])],e.prototype,"downRedBagInfo",null),__decorate([down(2,[0])],e.prototype,"downSendRedBack",null),__decorate([down(3,[0])],e.prototype,"downRobRedBack",null),__decorate([down(4,[0,0,1])],e.prototype,"downJoinPlayBack",null),__decorate([down(5)],e.prototype,"downPlayNextCard",null),__decorate([down(6,[3,3,3])],e.prototype,"downGetPointInfo",null),__decorate([down(7,[3])],e.prototype,"downGetGongXunChange",null),__decorate([down(8,[8,1,ByteConst.RankGuildInfos])],e.prototype,"downGuildRankinfo",null),__decorate([down(10,[3,8,8])],e.prototype,"downGuildWarKillInfo",null),__decorate([down(11,[8])],e.prototype,"downGuildWarCityOwn",null),__decorate([down(14,[ByteConst.MyRankGuildInfos])],e.prototype,"downMyActivityRankInfo",null),__decorate([down(12,[0,0,3])],e.prototype,"downDayRewardInfo",null),__decorate([down(15,[2,3,8,3,8])],e.prototype,"downFlagInfoChange",null),__decorate([down(17,[8,3,3,3,3])],e.prototype,"downGuildWarResult",null),__decorate([down(18,[3,3])],e.prototype,"downHuDunInfoChange",null),__decorate([down(19,[3,0,1])],e.prototype,"downAssignsReward",null),__decorate([up(20,[[3,[3,3]]])],e.prototype,"upFenReward",null),__decorate([down(20,[0])],e.prototype,"downSendRewardSuccess",null),__decorate([down(21,ByteConst.WinGuildInfos.slice())],e.prototype,"downWinGuildInfo",null),__decorate([down(22,[0,3,3])],e.prototype,"downGuildWarStarInfo",null),__decorate([down(23,[3])],e.prototype,"downGuildWarDoorHuDun",null),__decorate([down(24,[3])],e.prototype,"downLotteryInfo",null),__decorate([up(25)],e.prototype,"upPlayLotteryInfo",null),__decorate([down(26,[ByteConst.WarRankInfos])],e.prototype,"downRankInfoChange",null),__decorate([down(27,[10])],e.prototype,"downChangeAttrHandle",null),__decorate([down(28,[10])],e.prototype,"downChangeShowList",null),__decorate([down(29,ByteConst.PointRewarddInfos.slice())],e.prototype,"downPointRewardInfo",null),__decorate([up(30)],e.prototype,"upPointReward",null),__decorate([down(31,[1])],e.prototype,"downDoorEndtime",null),__decorate([down(25,[2])],e.prototype,"downGetMyPoint",null),__decorate([down(32,[3,8])],e.prototype,"downTalkMaxPoint",null),__decorate([down(33,[3])],e.prototype,"downKillHuman",null),__decorate([down(34,[[8]])],e.prototype,"downHeFuBelong",null),__decorate([up(34)],e.prototype,"upHeFuBelong",null),e=__decorate([protocolsId(40)],e)
}(BaseSystem);__reflect(UnionWarControl.prototype,"UnionWarControl");var RobberStartInfoVo=function(){function t(){}return t}();__reflect(RobberStartInfoVo.prototype,"RobberStartInfoVo");var UnionApplyInfoVo=function(){function t(){}return t}();__reflect(UnionApplyInfoVo.prototype,"UnionApplyInfoVo");var UnionCopyRankInfoVo=function(){function t(){}return t}();__reflect(UnionCopyRankInfoVo.prototype,"UnionCopyRankInfoVo");var UnionListInfoVo=function(){function t(){}return t}();__reflect(UnionListInfoVo.prototype,"UnionListInfoVo");var UnionMemberInfoVo=function(){function t(){this.level=0,this.zsLevel=0}return t.prototype.init=function(t){this.roleID=t[0],this.vipLevel=t[1],this.attack=t[2],this.sex=t[3],this.job=t[4],this.name=t[5],this.zsLevel=t[6],this.score=t[7],this.winRate=t[8],this.KfArenaCount=t[9],this.isJoinkfArena=1==t[10]},t.prototype.copyData=function(t){for(var e in t)this[e]=t[e]},t}();__reflect(UnionMemberInfoVo.prototype,"UnionMemberInfoVo");var UnionMessageInfoVo=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ctType=0,e}return __extends(e,t),e.prototype.init=function(t){this.type=t[0],this.str=t[1],this.str=RambleHlpVo.checkVMsg(this.str,this.type),this.setTime(t[2]);var e=t[3];e||(this.roleId=t[4],this.name=t[5],this.job=t[6],this.sex=t[7],this.vipLevel=t[8],this.monthCard=t[9],this.office=t[10],this.zsLevel=t[11],this.lv=t[12],this.guildName=t[13]),this.analyzeE()},e.prototype.analyzeE=function(){if(this.ctType=0,this.str.indexOf("|E:")>=0){var t=this.str,e=t.indexOf("|E:");t=t.slice(e+3,Number.MAX_VALUE);var i=void 0;if(t.indexOf(",")>=0?i=t.split(","):t.indexOf("*")>=0&&(i=t.split("*")),!i||i.length<=0)return;var o=+i[0];this.ctType=o,i[1]?this.ctData=i[1].split("+"):this.ctData=[],4==o?this.survivalTime=this.time+1e3*DataCenter.ins().RambleConstConfig.helpTime:5==o?this.survivalTime=this.time+1e3*DataCenter.ins().RambleConstConfig.helpTime:6==o&&(this.survivalTime=this.time+1e3*DataCenter.ins().MineConfig.leftTime),this.survivalTime&&this.caleTime()}},e.prototype.caleTime=function(){var t=this.survivalTime-GameServer.serverTime;t>0&&TimerMgr.ins().once(t,this.timeoutHandle,this)},e.prototype.timeoutHandle=function(){var t=unionControl.noReadMsgList.indexOf(this);t>-1&&unionControl.noReadMsgList.splice(t,1),unionControl.refTimeOutList(this),6==this.ctType&&mineControl.removeHelpIdx(+this.ctData[0])},Object.defineProperty(e.prototype,"hasTimeOut",{get:function(){var t=this.survivalTime&&this.survivalTime<GameServer.serverTime;if(t){var e=unionControl.noReadMsgList.indexOf(this);e>-1&&unionControl.noReadMsgList.splice(e,1)}return t},enumerable:!0,configurable:!0}),e}(RambleBaseVo);__reflect(UnionMessageInfoVo.prototype,"UnionMessageInfoVo");var GuildRoleSkillInfo=function(){function t(){this.guildSkillInfo=[],this.practiceSkillInfo=[]}return t}();__reflect(GuildRoleSkillInfo.prototype,"GuildRoleSkillInfo");var UnionSkillInfoVo=function(){function t(){}return t}();__reflect(UnionSkillInfoVo.prototype,"UnionSkillInfoVo");var UnionStoreItemDataVo=function(){function t(){}return t}();__reflect(UnionStoreItemDataVo.prototype,"UnionStoreItemDataVo");var UnionStoreRecordInfoVo=function(){function t(){}return t}();__reflect(UnionStoreRecordInfoVo.prototype,"UnionStoreRecordInfoVo");var UnionTaskInfoVo=function(){function t(){}return t}();__reflect(UnionTaskInfoVo.prototype,"UnionTaskInfoVo");var UnionWarModelVo=function(){function t(){this.guildPoint=0,this.ownPoint=0,this.gongXun=0,this.rewardDay=1,this.remainYB=-1,this.robYbNum=0,this.guildRankList=[],this.killName="",this.killGuild="",this.cityOwn=LangMgr.getValueByKey("clanEmptyJob"),this.myRankList=[],this.weixieList=[],this.canPlayList=[],this.flagStatu=0,this.endTime=0,this.flagName="",this.flagAcId=0,this.flagGuild="",this.canClick=!0,this._canSendReward=!1,this.rewardIndex=0,this.sendList=[],this.sendNumList=[],this.rewardFlag=0,this.winGuildInfo=new WinGuildInfo,this.rankList=[],this._doorEndtime=0,this.attHandle=0,this.myGuildPointRank=[],this.guildHandleList=[],this.guildNum=0}return t.prototype.creatGuildRankReward=function(t,e){void 0===e&&(e=-1),this.rewardList=[];var i=DataCenter.ins().UnionBattleDistriAwardConfig[t];for(var o in i)if(!i[o].rewardFlag||1==this.rewardFlag){if(Number(o)==e+1)return i[o].awardShow;var n=i[o].awardShow;for(var r in n)this.checkIsHave(n[r])}return this.rewardList},t.prototype.creatGuildRewardList=function(){if(this.configList)return this.configList;this.configList=[];var t=DataCenter.ins().UnionBattleDistriAwardConfig;for(var e in t)-1==this.configList.lastIndexOf(t[e][1].rank)&&this.configList.push(t[e][1].rank);return this.configList},t.prototype.checkIsHave=function(t){for(var e=!1,i=this.rewardList.length,o=0;i>o;o++){var n=this.rewardList[o];n.id==t.id&&n.type==t.type&&(e=!0,this.rewardList[o].count+=t.count)}e||this.rewardList.push(t)},t.prototype.initRedbagInfo=function(t){this.remainYB=t[0],this.canSend=t[1],this.canRod=t[2],this.sendYbNum=t[3],this.maxRedNum=t[4],this.remainRedNum=t[5],this.rebList=[];for(var e,i=0;i<t[6].length;i++)e=new GuildRedRobInfo,e.init(t[6][i]),ActorControl.actorID==e.acId&&(this.robYbNum=e.robNum),this.rebList.push(e)},t.prototype.isHaveRedBag=function(){return this.canSend||this.canRod},t.prototype.checkinAppoint=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=!1),!unionWarControl.getModel().isWatStart||0==MapControl.copyId||0==unionControl.guildID)return!1;var i=DataCenter.ins().UnionBattleLvConfig;for(var o in i)if(i[o].fbId==MapControl.copyId)return 0==t?!0:e&&i[o].id>=t?!0:i[o].id==t?!0:!1;return!1},t.prototype.initGuildRankInfo=function(t){this.lastGuildName=t[0],t[1],this.guildRankList=[];for(var e,i=0;i<t[2].length;i++)e=new RankGuildInfo,e.init(t[2][i]),this.guildRankList.push(e);unionWarControl.dispatchRankInfo()},t.prototype.getNextMapName=function(t){void 0===t&&(t=1);var e=(MapControl.copyId,DataCenter.ins().UnionBattleLvConfig),i=1;for(var o in e)t==e[o].id&&(i=t);return e[i].name},t.prototype.getIntoNextMapGongxun=function(){var t=MapControl.copyId,e=DataCenter.ins().UnionBattleLvConfig,i=1;for(var o in e)if(t==e[o].fbId){if(!(e[o].id<4))return 0;i=e[o].id+1}return e[i].feats},t.prototype.getMapLevelInfo=function(){var t=MapControl.copyId,e=DataCenter.ins().UnionBattleLvConfig,i=1;for(var o in e)t==e[o].fbId&&(i=e[o].id);return e[i]},t.prototype.initMyGuildRankInfo=function(t){this.myRankList=[];for(var e,i=0;i<t.length;i++)e=new MyRankGuildInfo,e.init(t[i]),this.myRankList.push(e);unionWarControl.dispatchMyRankChange()},t.prototype.changeWeiXieList=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=""),ActorControl.handle!=t){var o=this.checkListElements(t,this.weixieList);e?-1==o&&(this.weixieList.push(t),tipsControl.showTips(LangMgr.getValueByKey("guidAttackSelf",i))):-1!=o&&this.weixieList.splice(o,1),unionWarControl.dispatchWeixieChange(0)}},t.prototype.changecanPlayList=function(t,e){if(void 0===e&&(e=!0),ActorControl.handle!=t){var i=this.checkListElements(t,this.canPlayList);e?-1==i&&this.canPlayList.push(t):-1!=i&&this.canPlayList.splice(i,1),unionWarControl.dispatchCanplayChange()}},t.prototype.decodeGulidWarResult=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];(i=UIMgr.ins()).open.apply(i,[UnionWarResultView].concat(t));var i},t.prototype.checkListElements=function(t,e){if(e.length<=0)return-1;for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},t.prototype.getRewardByPoint=function(t){var e=[];if(!this.dataList){this.dataList=[];var i=DataCenter.ins().UnionBattlePerAwardConfig;for(var o in i)this.dataList.push(i[o])}for(var n=this.dataList.length,r=0;n>r;r++)t>=this.dataList[r].integral&&(e=e.concat(this.dataList[r].award));return e},t.prototype.getMyPointReward=function(){var t,e=DataCenter.ins().UnionBattlePerAwardConfig;for(var i in e)if(t=e[i],t.id==this.pointInfo.id)return t;return null},t.prototype.getMaxReward=function(){var t,e,i=DataCenter.ins().UnionBattlePerAwardConfig,o=0;for(var n in i)t=i[n],t.integral>o&&(o=t.integral,e=t);return e},Object.defineProperty(t.prototype,"clickTime",{get:function(){return this._clickTime},set:function(t){this.canClick=!1,this._clickTime=t,TimerMgr.ins().remove(this.endTimeChangeStatu,this),TimerMgr.ins().doTimer(1e3,this._clickTime,this.endTimeChangeStatu,this)},enumerable:!0,configurable:!0}),t.prototype.endTimeChangeStatu=function(){--this._clickTime,this._clickTime<=0&&(this.canClick=!0,TimerMgr.ins().remove(this.endTimeChangeStatu,this))},Object.defineProperty(t.prototype,"canSendReward",{get:function(){return 6==unionControl.myOffice&&this._canSendReward},set:function(t){this._canSendReward=t},enumerable:!0,configurable:!0}),t.prototype.getCanSendNumByRank=function(t){void 0===t&&(t=-1);var e=DataCenter.ins().UnionBattleDistriAwardConfig[this.guildWarRank],i=0;for(var o in e)if(!e[o].rewardFlag||1==this.rewardFlag){if(o==t+1+"")return e[o].count;++i}return i},t.prototype.checkISSendAll=function(){for(var t=this.getCanSendNumByRank(),e=0;t>e;e++){var i=this.getCanSendNumByRank(e);if(!this.sendList[e])return tipsControl.showTips(LangMgr.getValueByKey("guildTips1")),!1;for(var o=0,n=0;n<this.sendNumList[e].length;n++)o+=this.sendNumList[e][n];if(i>o)return tipsControl.showTips(LangMgr.getValueByKey("guildTips1")),!1;for(var n=0;n<this.sendList[e].length;n++)if(!unionControl.checkIsInGuild(this.sendList[e][n].roleID))return tipsControl.showTips(LangMgr.getValueByKey("guildOutGuild",this.sendList[e][n].name)),!1}return!0},Object.defineProperty(t.prototype,"acEndTime",{get:function(){return this._acEndTime},set:function(t){this._acEndTime=t,this._acEndTime>0&&(TimerMgr.ins().remove(this.reduceTime,this),TimerMgr.ins().doTimer(1e3,t,this.reduceTime,this))},enumerable:!0,configurable:!0}),t.prototype.reduceTime=function(){--this._acEndTime,this._acEndTime<=0&&TimerMgr.ins().remove(this.reduceTime,this)},t.prototype.setOpenDesc=function(){if(0==this.startTime)return"";var t=new Date(1e3*(this.startTime+1));return LangMgr.getValueByKey("guildWeek",t.getMonth()+1,t.getDate(),LangMgr.getValueByKey("weeksDay"+t.getDay()),DateUtils.formatTimeNum(t.getHours()),DateUtils.formatTimeNum(t.getMinutes()))},t.prototype.getCdByType=function(t){if(0==MapControl.copyId)return 0;var e=DataCenter.ins().UnionBattleLvConfig;for(var i in e)if(e[i].fbId==MapControl.copyId&&(1==t||3==t))return e[i].switchSceneCd;return 0},t.prototype.getIsShowGuildWarBtn=function(){if(0==this.startTime||DataCenter.ins().UnionBattleConstConfig.openLevel>ActorControl.level)return 0;var t=new Date(1e3*this.startTime),e=new Date(GameServer.serverTime);return t.getDate()==e.getDate()&&(e.getHours()<20||20==e.getHours()&&e.getMinutes()<=15)||this.isWatStart?1:0},t.prototype.rankListChange=function(t){this.rankList=[];for(var e,i=0;i<t.length;i++)e=new WarRankInfo,e.init(t[i]),this.rankList.push(e);unionWarControl.dispatchRankListChange()},t.prototype.initPointRewardInfo=function(t){this.pointInfo||(this.pointInfo=new PointRewarddInfo),this.pointInfo.init(t),unionWarControl.dispatchPointRewardChange()},t.prototype.getSelectDataByIndex=function(t){var e,i,o=[];if(this.sendList&&this.sendList[t]&&this.sendList[t].length>0){e=this.sendList[t],i=this.sendNumList[t];for(var n=void 0,r=0;r<e.length;r++)n=new SelectInfoData,n.data=e[r],n.num=i[r],o.push(n)}return o},t.prototype.getMyPointRankReward=function(t){var e=DataCenter.ins().UnionBattlePerRankAwardConfig;for(var i in e)if(e[i].rank==t)return e[i].award;return[]},t.prototype.doEndDoorTime=function(t){this._doorEndtime=t,TimerMgr.ins().remove(this.timeDo,this),TimerMgr.ins().doTimer(1e3,this._doorEndtime,this.timeDo,this)},t.prototype.timeDo=function(){--this._doorEndtime,this._doorEndtime<=0&&(this._doorEndtime=0,TimerMgr.ins().remove(this.timeDo,this))},Object.defineProperty(t.prototype,"doorEndtime",{get:function(){return this._doorEndtime},enumerable:!0,configurable:!0}),t.prototype.getMyGuildPointRank=function(){var t,e,i=unionControl.getGuildMembers(0),o=i.length;this.myGuildPointRank=[];for(var n=0;o>n;n++)t=i[n],e=new SelectInfoData,e.data=t,e.num=this.getPointByAcId(t.roleID),this.myGuildPointRank.push(e);return this.myGuildPointRank.sort(this.sort),this.myGuildPointRank},t.prototype.getPointByAcId=function(t){for(var e=this.myRankList.length,i=0;e>i;i++)if(this.myRankList[i].roleID==t)return this.myRankList[i].point;return 0},t.prototype.sort=function(t,e){var i=t.num,o=e.num;return i>o?-1:o>i?1:0},t.prototype.setMyGuildNum=function(t,e){void 0===e&&(e=!0);var i=this.checkListElements(t,this.guildHandleList);e?-1==i&&this.guildHandleList.push(t):i>-1&&this.guildHandleList.splice(i,1),this.guildNum=this.guildHandleList.length,unionWarControl.dispatchGuildNumChange()},t.prototype.clearGuildWarList=function(){this.checkinAppoint()&&(this.weixieList=[],this.canPlayList=[],this.attHandle=0,this.guildHandleList=[])},t}();__reflect(UnionWarModelVo.prototype,"UnionWarModelVo");var GuildRedRobInfo=function(){function t(){}return t.prototype.init=function(t){this.robNum=t[0],this.robName=t[1],this.acId=t[2]},t}();__reflect(GuildRedRobInfo.prototype,"GuildRedRobInfo");var RankGuildInfo=function(){function t(){}return t.prototype.init=function(t){this.guildName=t[0],this.ownName=t[1],this.guildPoint=t[2]},t}();__reflect(RankGuildInfo.prototype,"RankGuildInfo");var MyRankGuildInfo=function(){function t(){}return t.prototype.init=function(t){this.roleID=t[0],this.myName=t[1],this.mapName=t[2],this.point=t[3],this.attr=t[4],this.office=t[5],this.job=t[6],this.sex=t[7]},t}();__reflect(MyRankGuildInfo.prototype,"MyRankGuildInfo");var WinGuildInfo=function(){function t(){this.guildId=0,this.guildName="",this.guildOwnName="",this.guildOwnId=0,this.guildOwnJob=0,this.guildOwnSex=0,this.clothID=0,this.wapenId=0,this.wingOpen=0,this.winId=0}return t.prototype.init=function(t){this.guildId=t[0],this.guildName=t[1],this.guildOwnName=t[2],this.guildOwnId=t[3],this.guildOwnJob=t[4],this.guildOwnSex=t[5],this.clothID=t[6],this.wapenId=t[7],this.wingOpen=t[8],this.winId=t[9]},t}();__reflect(WinGuildInfo.prototype,"WinGuildInfo");var WarRankInfo=function(){function t(){}return t.prototype.init=function(t){this.name=t[0],this.point=t[1]},t}();__reflect(WarRankInfo.prototype,"WarRankInfo");var PointRewarddInfo=function(){function t(){}return t.prototype.init=function(t){this.isCan=t[0],this.id=t[1],this.point=t[2]},t}();__reflect(PointRewarddInfo.prototype,"PointRewarddInfo");var SelectInfoData=function(){function t(){}return t}();__reflect(SelectInfoData.prototype,"SelectInfoData");var UnionApplyListView=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionApplyListViewSkin",e.list.itemRenderer=UnionAppltListItemRender,e.isTopLevel=!0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.attrNum.restrict="0-9",this.attrNum.maxChars=8},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.list,this.onListTouch),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addCustomEvent(19,this.updateList),unionControl.upApplyInfos(),this.addEventTouchTap(this.checkBoxs,this.onTap),this.addEventChange(this.attrNum,this.onTxtChange),this.checkBoxs.selected=1==unionControl.isAuto,this.attrNum.text=unionControl.attrLimit+""},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.list,this.onListTouch),this.removeEventTouchTap(this.checkBoxs,this.onTap),this.removeEventChange(this.attrNum,this.onTxtChange),this.removeCustomEvents()},e.prototype.onTxtChange=function(t){unionControl.upAddGuildLimit(this.checkBoxs.selected?1:0,parseInt(this.attrNum.text))},e.prototype.updateList=function(t){t.sort(this.sort),this.list.dataProvider=new eui.ArrayCollection(t)},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=t.target.parent;e.onTap(t.target)}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(this);break;case this.checkBoxs:this.onTxtChange(null)}},e.prototype.sort=function(t,e){return t.attack>e.attack?-1:t.attack<e.attack?1:0},e}(BaseEuiView);__reflect(UnionApplyListView.prototype,"UnionApplyListView");var UnionApplyView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.dataArr=new eui.ArrayCollection([]),e.skinName="UnionApplyViewSkin",e.list.itemRenderer=UnionListItemRender,e.list.dataProvider=e.dataArr,e}return __extends(e,t),e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.createBtn,this.onTap),this.fgClose&&this.addEventTouchTap(this.fgClose,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.list,this.onListTouch),this.addCustomEvent(16,this.updateList),unionControl.upGuildList()},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=t.target.parent;e.onTap()}},e.prototype.updateList=function(){this.noGuild.visible=0==unionControl.guildListInfos.length,this.dataArr.replaceAll(unionControl.guildListInfos)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(this);break;case this.createBtn:UIMgr.ins().open(UnionCreateView)}},e.prototype.destoryView=function(){t.prototype.destoryView.call(this);for(var e=0;e<this.list.numElements;e++)this.list.getElementAt(e)&&this.list.getElementAt(e).destruct()},e}(BaseEuiView);__reflect(UnionApplyView.prototype,"UnionApplyView");var UnionCampFirePanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemCount=0,e.delayTime=0,e}return __extends(e,t),e.prototype.open=function(){this.addEvent(egret.TouchEvent.TOUCH_BEGIN,this.give,this.onGiveBegin),this.addEvent(egret.TouchEvent.TOUCH_END,this.give,this.onGiveEnd),this.addCustomEvent(31,this.update),this.update()},e.prototype.close=function(){this.removeEvent(egret.TouchEvent.TOUCH_BEGIN,this.give,this.onGiveBegin),this.removeEvent(egret.TouchEvent.TOUCH_END,this.give,this.onGiveEnd),this.removeCustomEvents(),TimerMgr.ins().removeAll(this)},e.prototype.update=function(){var t=unionControl.fireDic;t.fireLvl>0?this.firestar.visible=!0:this.firestar.visible=!1;for(var e=0;this["lv"+e];)this["lv"+e].visible=t.fireLvl>=e,this["fire"+e]&&(this["fire"+e].visible=t.fireLvl==e),e+=1;var i=DataCenter.ins().UnionBonFireConfig[t.fireLvl],o=DataCenter.ins().UnionBonFireConfig[t.fireLvl+1];i?(this.progressBar.maximum=i.value,this.progressBar.value=t.fireVal):(this.progressBar.maximum=100,this.progressBar.value=100);var n=DataCenter.ins().UnionConfig,r=backpackControl.getBagItemById(n.bonfireItem);r?(this.count.text=""+r.count,this.cha.textColor=this.count.textColor=ColorUtils.GREEN,this.itemCount=r.count,this.redPoint.visible=!0):(this.count.text="0",this.cha.textColor=this.count.textColor=LangMgr.getColor("color22"),this.itemCount=0,this.redPoint.visible=!1),o?(this.desc1.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("guildTips38",n.bonfireValue,n.bonfireReward[0].count)),this.desc2.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("guildTips39",(i.value-t.fireVal)/n.bonfireValue,o.reward))):(this.desc1.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("guildTips38",n.bonfireValue,n.bonfireReward[0].count)),this.desc2.textFlow=TextUtils.generateTextFlow1(LangMgr.getValueByKey("guildTips40",i.reward)))},e.prototype.onGiveBegin=function(){var t=this;this.itemCount>0&&(this.delayTime=1,TimerMgr.ins().doTimer(300,1,function(){1==t.delayTime&&(t.delayTime=0,TimerMgr.ins().doTimer(100,0,function(){t.stratAddFire()},t))},this))},e.prototype.onGiveEnd=function(){1==this.delayTime&&this.stratAddFire(),this.delayTime=0,TimerMgr.ins().removeAll(this)},e.prototype.stratAddFire=function(){if(this.itemCount>0){var t=DataCenter.ins().UnionConfig.bonfirecount;this.itemCount<t&&(t=this.itemCount),this.itemCount-=t,unionControl.upToFire(t,this.itemCount)}else tipsControl.showTips(LangMgr.getValueByKey("zhuzaiPropEnought")),TimerMgr.ins().removeAll(this)},e}(BasePanel);__reflect(UnionCampFirePanel.prototype,"UnionCampFirePanel");var UnionChangeNameView=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionChangeNameViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.open=function(){this.addEventTouchTap(this.sureBtn,this.onTap),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){var e=t.currentTarget;switch(e){case this.bgClose:case this.closeBtn:UIMgr.ins().close(this);break;case this.sureBtn:this.onChangeName()}},e.prototype.onChangeName=function(){""==this.input.text?tipsControl.showTips(LangMgr.getValueByKey("guildInputName")):(unionControl.upGuildChangeName(this.input.text),UIMgr.ins().close(this))},e}(BaseEuiView);__reflect(UnionChangeNameView.prototype,"UnionChangeNameView");var UnionConView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionConViewSkin",this.desc0.text=LangMgr.getValueByKey("guildTips28",DataCenter.ins().UnionDonateConfig[1].count),this.desc1.text=LangMgr.getValueByKey("guildTips29",DataCenter.ins().UnionDonateConfig[2].count),this.info0.text=LangMgr.getValueByKey("guildTips30",DataCenter.ins().UnionDonateConfig[1].awardContri,DataCenter.ins().UnionDonateConfig[1].awardFund),this.info1.text=LangMgr.getValueByKey("guildTips30",DataCenter.ins().UnionDonateConfig[2].awardContri,DataCenter.ins().UnionDonateConfig[2].awardFund)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.update=function(){var t=DataCenter.ins().UnionDonateConfig[1].dayCount[vipControl.lv],e=DataCenter.ins().UnionDonateConfig[1].dayCount[vipControl.lv+1],i=unionControl.getConCount();i[0]<=0?(e&&e-t>0?this.count0.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips31",vipControl.getVipStr(vipControl.lv+1),e-t)):this.count0.text=t-i[0]+"/"+DataCenter.ins().UnionDonateConfig[1].dayCount[vipControl.lv],this.btn0.enabled=!1):(this.btn0.enabled=!0,this.count0.text=t-i[0]+"/"+DataCenter.ins().UnionDonateConfig[1].dayCount[vipControl.lv]),this.btn1.enabled=i[1]>0,this.count1.text=DataCenter.ins().UnionDonateConfig[2].dayCount-i[1]+"/"+DataCenter.ins().UnionDonateConfig[2].dayCount},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.btn0,this.onTap),this.addEventTouchTap(this.btn1,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addCustomEvent(27,this.update),unionControl.upConCount(),0==vipControl.lv?this.btn0.label=LangMgr.getValueByKey("guildBecomVip"):this.btn0.label=LangMgr.getValueByKey("guildGX")},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.btn0,this.onTap),this.removeEventTouchTap(this.btn1,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.onTap=function(t){var e=unionControl.getConCount();switch(t.currentTarget){case this.btn0:0==vipControl.lv?UIMgr.ins().open("VipView"):e[0]<=0?tipsControl.showTips(LangMgr.getValueByKey("guildTimeEnought")):ActorControl.yb>=DataCenter.ins().UnionDonateConfig[1].count?unionControl.upCon(1):(tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),UIMgr.ins().close(this));break;case this.btn1:e[1]<=0?tipsControl.showTips(LangMgr.getValueByKey("guildTimeEnought")):ActorControl.gold>=DataCenter.ins().UnionDonateConfig[2].count?unionControl.upCon(2):tipsControl.showTips(LangMgr.getValueByKey("bossMoneyEnought"));break;case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(UnionConView.prototype,"UnionConView");var UnionCreateView=function(t){function e(){var e=t.call(this)||this;return e.selectLevel=1,e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionCreateViewSkin",this.leftLab.textFlow=(new egret.HtmlTextParser).parser(this.formatLab(1)),this.rightLab.textFlow=(new egret.HtmlTextParser).parser(this.formatLab(2))},e.prototype.changeSelect=function(t){this.selectLevel=t,this.selectBmp.x=1==this.selectLevel?this.bg1.x:this.bg2.x},e.prototype.formatLab=function(t){var e=DataCenter.ins().UnionCreateConfig,i=DataCenter.ins().UnionConfig,o=e[t].vipLv,n=o>0?LangMgr.getValueByKey("guildTips32",vipControl.getVipStr(o)):"",r=e[t].recharge;r>0&&(n=LangMgr.getValueByKey("guildTips32",LangMgr.getValueByKey("numberRecharge",r)));var a=0==e[t].award?"\n":LangMgr.getValueByKey("guildTips33",e[t].award.toString()),s=LangMgr.getValueByKey("guildTips34",e[t].level.toString())+"\n"+n+LangMgr.getValueByKey("guildTips35",i.maxMember[t-1])+a+LangMgr.getValueByKey("guildTips36",e[t].moneyCount.toString()),l="<font color="+LangMgr.getValueByKey("color103")+" size='16'>"+s+"</font>";return l},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.leftLab,this.onTap),this.addEventTouchTap(this.rightLab,this.onTap),this.addEventTouchTap(this.okBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){var e=this;switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(this);break;case this.okBtn:var i=DataCenter.ins().UnionCreateConfig,o=i[this.selectLevel],n=i[o.level].recharge;if(vipControl.exp<n)return void tipsControl.showTips(LangMgr.getValueByKey("userNoCZ"));var r=i[o.level].vipLv;if(vipControl.lv<r)return void tipsControl.showTips(LangMgr.getValueByKey("doubleVip"));""==this.textInput.text?tipsControl.showTips(LangMgr.getValueByKey("guildInputName")):ActorControl.yb<o.moneyCount?(tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney")),UIMgr.ins().close(this)):warnControl.show(LangMgr.getValueByKey("guildTips37",o.moneyCount,o.level,this.textInput.text),function(){unionControl.upGuildCreate(e.selectLevel,e.textInput.text)},this);break;case this.leftLab:this.changeSelect(1);break;case this.rightLab:this.changeSelect(2)}},e}(BaseEuiView);__reflect(UnionCreateView.prototype,"UnionCreateView");var UnionInfoPanel=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInit=!1,e.userGuild=UnionControl.ins(),e}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.initUI()},e.prototype.initUI=function(){this.checkJoin.textFlow=(new egret.HtmlTextParser).parser('<a href="event:"><u>'+this.checkJoin.text+"</u></a>"),this.checkJoin.touchEnabled=!0,this.list.itemRenderer=UnionMemberItem1Render,this.eff=new GameMovieClip,this.eff.x=this.checkJoin.x+40,this.eff.y=this.checkJoin.y+10,this.isInit=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.isInit||this.initUI(),this.addEventTouchTap(this.checkJoin,this.onLinkApply),this.addEventTouchTap(this.cityBtn,this.onTap),this.addEventTouchTap(this.conBtn,this.onTap),this.addEventTouchTap(this.rename,this.onTap),this.addCustomEvent(14,this.updateGuild),this.addCustomEvent(28,this.updateMyInfo),this.addCustomEvent(22,this.updateGuild),this.addCustomEvent(21,this.updateGuild),this.addCustomEvent(19,this.updateApplys),this.addCustomEvent(18,this.updateApplys),this.addCustomEvent(15,this.updateMember),this.updateApplys(),this.updateMyInfo(),this.updateGuild(),this.updateMember()},e.prototype.onTap=function(t){switch(t.currentTarget){case this.conBtn:UIMgr.ins().open(UnionConView);break;case this.cityBtn:UIMgr.ins().open(UnionNoticeView);break;case this.rename:UIMgr.ins().open(UnionChangeNameView)}},e.prototype.updateMyInfo=function(){this.myCon.text=this.userGuild.myCon+"",this.checkJoin.visible=this.userGuild.myOffice>=5,this.cityBtn.visible=this.userGuild.myOffice>=5},e.prototype.updateGuild=function(){this.guildName.text=this.userGuild.guildName,this.guildLevel.text=this.userGuild.guildLv.toString(),this.guildMoney.text=this.userGuild.money.toString(),this.notice.text=this.userGuild.notice,this.rename.visible=unionControl.changeNameNum&&this.userGuild.myOffice>=6,this.userGuild&&(this.auditText.text="",this.auditText.textFlow=TextUtils.generateTextFlow(LangMgr.getValueByKey("noticeCheck"+this.userGuild.noticeAudit)))},e.prototype.updateMember=function(){var t=unionControl.getBuildingLevels(3)||0,e=t?DataCenter.ins().UnionConfig.affairMember[t-1]:0;this.guildMember.text=this.userGuild.getMemberNum()+"/"+(DataCenter.ins().UnionConfig.maxMember[unionControl.guildLv-1]+e),this.list.dataProvider=new eui.ArrayCollection(this.userGuild.getGuildMembers(1))},e.prototype.onLinkApply=function(){UIMgr.ins().open(UnionApplyListView)},e.prototype.updateApplys=function(){this.userGuild.hasApplys()?(this.checkJoin.parent.addChildAt(this.eff,this.getChildIndex(this.checkJoin)),this.eff.playFile(PATH_EFF+"chargeff1",-1),this.eff.scaleX=.7,this.eff.scaleY=.7):DisplayUtils.removeFromParent(this.eff)},e}(BasePanel);__reflect(UnionInfoPanel.prototype,"UnionInfoPanel");var UnionListPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=UnionListItem2Render},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addCustomEvent(16,this.updateList),this.updateList(),this.pageChange(0)},e.prototype.pageChange=function(t){this.curPage!=t&&t>=0&&t<unionControl.pageMax&&(this.curPage=t,unionControl.upGuildList(this.curPage,6))},e.prototype.updateList=function(){this.list.dataProvider=new eui.ArrayCollection(unionControl.guildListInfos)},e}(BasePanel);__reflect(UnionListPanel.prototype,"UnionListPanel");var UnionManageBuildPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.buildList.itemRenderer=UnionBuildItemRender,this.messageList.itemRenderer=UnionEventItenRender},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0!=unionControl.guildID;return i||tipsControl.showTips(LangMgr.getValueByKey("guildDes4")),i},e.prototype.open=function(){this.addEventTouchTap(this.buildList,this.onListTouch),this.addCustomEvent(24,this.updateList),this.addCustomEvent(26,this.update),this.addCustomEvent(21,this.update),unionControl.upManageList(),this.updateList()},e.prototype.close=function(){this.removeEventTouchTap(this.buildList,this.onListTouch),this.removeCustomEvents()},e.prototype.update=function(){this.messageList.dataProvider=new eui.ArrayCollection(unionControl.records)},e.prototype.updateList=function(){this.index=this.buildScroller.viewport.scrollV,this.buildList.dataProvider=new eui.ArrayCollection([1,2,4,3]),this.refushBar()},e.prototype.refushBar=function(){TimerMgr.ins().remove(this.refushBarList,this),TimerMgr.ins().doTimer(100,1,this.refushBarList,this)},e.prototype.refushBarList=function(){TimerMgr.ins().remove(this.refushBarList,this),this.buildScroller.viewport.scrollV=this.index},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=t.target.parent;e.onTap(t.target)}},e}(BasePanel);__reflect(UnionManageBuildPanel.prototype,"UnionManageBuildPanel");var UnionMapView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="UnionMapViewSkin",this.list.itemRenderer=UnionMapMemberItemRender,this.guildWarEffect2=new GameMovieClip,this.guildRewardEff=new GameMovieClip
},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.manageBtn,this.onTap),this.addEventTouchTap(this.practiseBtn,this.onTap),this.addEventTouchTap(this.shopBtn,this.onTap),this.addEventTouchTap(this.cityBtn,this.onTap),this.addEventTouchTap(this.chatBtn,this.onTap),this.addEventTouchTap(this.rewardTouch,this.onTap),this.addCustomEvent(667,this.updateRedpoint),this.addCustomEvent(433,this.updateRedpoint),unionControl.upMyGuildInfo(),unionWarControl.upGuildRank(),unionBossControl.upGetBossInfo(),this.updateRedpoint(),this.addCustomEvent(419,this.refushGuildwarEffect),this.refushGuildwarEffect(),this.addCustomEvent(672,this.updateSendBtnStatu),this.updateSendBtnStatu(),this.addCustomEvent(671,this.updateGuildPoint),this.updateGuildPoint(),this.addCustomEvent(668,this.hhdtRed),this.hhdtRed(),this.addCustomEvent(675,this.updateBossPoint),this.updateBossPoint(),this.addCustomEvent(15,this.updateList),this.updateList()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];DisplayUtils.removeFromParent(this.guildWarEffect2),DisplayUtils.removeFromParent(this.guildRewardEff)},e.prototype.hhdtRed=function(){this.redPoint0.visible=UnionRedPoint.ins().hhdt},e.prototype.updateRedpoint=function(){this.redPoint1.visible=UnionRedPoint.ins().guildFire||UnionRedPoint.ins().liangongRed},e.prototype.updateGuildPoint=function(){this.redPoint2.visible=UnionRedPoint.ins().sczb},e.prototype.updateBossPoint=function(){this.redPoint3.visible=UnionRedPoint.ins().hhBoss},e.prototype.updateList=function(){this.list.dataProvider=new eui.ArrayCollection(unionControl.getGuildMembers(2))},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(e);break;case this.practiseBtn:UIMgr.ins().close(e),UIMgr.ins().open(UnionSkillView);break;case this.manageBtn:UIMgr.ins().close(e),UIMgr.ins().open(UnionView);break;case this.cityBtn:unionWarControl.upWinGuildInfo(),UIMgr.ins().close(e),UIMgr.ins().open(UnionWarMainView);break;case this.shopBtn:UIMgr.ins().open(UnionBossView);break;case this.chatBtn:UIMgr.ins().open(RambleView);break;case this.rewardTouch:UIMgr.ins().open(SelectMemberRewardView)}},e.prototype.updateSendBtnStatu=function(){this.rewardTouch.visible=this.reward.visible=UnionRedPoint.ins().sendReward,UnionRedPoint.ins().sendReward?(this.guildRewardEff.playFile(PATH_EFF+"giftShake",-1),this.guildRewardEff.x=30,this.guildRewardEff.y=30,this.reward.addChild(this.guildRewardEff)):DisplayUtils.removeFromParent(this.guildRewardEff)},e.prototype.refushGuildwarEffect=function(){unionWarControl.getModel().isWatStart?(this.guildWarEffect2.playFile(PATH_EFF+"swordSparkEff",-1),this.guildWarEffect2.x=28,this.guildWarEffect2.y=30,this.cityBtn.addChild(this.guildWarEffect2)):DisplayUtils.removeFromParent(this.guildWarEffect2)},e}(BaseEuiView);__reflect(UnionMapView.prototype,"UnionMapView");var UnionMemberPanel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.childrenCreated=function(){this.init()},e.prototype.init=function(){this.list.itemRenderer=UnionMemberItem2Render,this.dataArr=new eui.ArrayCollection,this.list.dataProvider=this.dataArr},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.quitBtn,this.onTap),this.addEventTouchTap(this.list,this.onListTouch),this.addCustomEvent(28,this.updateMyInfo),this.addCustomEvent(15,this.updateMember),this.updateMyInfo(),this.updateMember()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.quitBtn,this.onTap),this.removeEventTouchTap(this.list,this.onListTouch),this.removeCustomEvents()},e.prototype.onListTouch=function(t){if(t.target instanceof eui.Button){var e=t.target.parent.parent;e.onTap(t.target)}},e.prototype.updateMember=function(){var t=unionControl.getGuildMembers(1);this.dataArr.replaceAll(t)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.quitBtn:if(unionWarControl.getModel().isWatStart)return void warnControl.show(LangMgr.getValueByKey("guildDes1"),function(){},this);if(6==unionControl.myOffice&&unionControl.getMemberNum()>1)return void warnControl.show(LangMgr.getValueByKey("guildDes2"),function(){},this);warnControl.show(LangMgr.getValueByKey("guildDes3"),function(){unionControl.upQuitGuild()},this,null,null,"normal","center")}},e.prototype.updateMyInfo=function(){this.office.text=LangMgr.getValueByKey("officeName"+unionControl.myOffice),this.totalCon.text=unionControl.myTotalCon+"",this.mtips&&(this.mtips.text=LangMgr.getValueByKey("impeachTime",DataCenter.ins().UnionConfig.impeachTime/24/3600>>0))},e}(BasePanel);__reflect(UnionMemberPanel.prototype,"UnionMemberPanel");var UnionNoticeView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionNoticeViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.closeBtn1,this.onTap),this.addEventTouchTap(this.saveBtn,this.onTap),this.addEventTouchTap(this.bgrect,this.onTap),this.textInput.text=unionControl.notice},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.closeBtn1,this.onTap),this.removeEventTouchTap(this.saveBtn,this.onTap),this.removeEventTouchTap(this.bgrect,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn0:case this.closeBtn1:case this.bgrect:UIMgr.ins().close(this);break;case this.saveBtn:unionControl.notice=this.textInput.text,unionControl.upChangeNotice(this.textInput.text),UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(UnionNoticeView.prototype,"UnionNoticeView");var UnionShopPanel=function(t){function e(){var e=t.call(this)||this;return e.isOpenEff=!1,e.initUI(),e}return __extends(e,t),e.prototype.initUI=function(){this.skinName="UnionShopPanelSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.unionShopReskaiqi,this.onTap),this.addEventTouchTap(this.useBtn,this.onTap),this.addEventTouchTap(this.guildMore,this.onTap),unionStoreControl.upGetInfo(),unionStoreControl.upBoxInfo(),this.addCustomEvent(441,this.onupdateData),this.addCustomEvent(443,this.onItemInfo),this.addCustomEvent(442,this.onReadInfo),this.onupdateData(),this.unionShopResitem_7.visible=!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.unionShopReskaiqi,this.onTap),this.removeEventTouchTap(this.useBtn,this.onTap),this.removeEventTouchTap(this.guildMore,this.onTap),this.removeCustomEvents()},e.prototype.onupdateData=function(){if(unionStoreControl.guildStoreLv>0){this.unionShopResopen.visible=!0,this.unionShopResclose.visible=!1,this.unionShopResclose.touchEnabled=!1,this.unionShopResopen.touchEnabled=!0,DataCenter.ins().UnionStoreConfig.needContrib>unionControl.myCon?this.unionShopReslabel.textFlow=(new egret.HtmlTextParser).parser(unionControl.myCon+""):this.unionShopReslabel.textFlow=(new egret.HtmlTextParser).parser(unionControl.myCon+""),this.unionShopResxiaolabel.text=""+DataCenter.ins().UnionStoreConfig.needContrib;var t=DataCenter.ins().UnionStoreConfig.time[unionStoreControl.guildStoreLv-1],e=DataCenter.ins().UnionStoreConfig.time[unionStoreControl.guildStoreLv],i="";i=unionStoreControl.guildStoreNum<=0?"<font color='#f3311e'>"+unionStoreControl.guildStoreNum+"/"+t+"</font>":unionStoreControl.guildStoreNum+"/"+t,e?this.unionShopResshengyulabel.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTodaySY",i)):this.unionShopResshengyulabel.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTodaySY",i))}else this.unionShopResopen.visible=!1,this.unionShopResopen.touchEnabled=!1,this.unionShopResclose.touchEnabled=!0,this.unionShopResclose.visible=!0,this.unionShopReskaiqi.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips52"));for(var o in DataCenter.ins().UnionStoreConfig.item)this["unionShopResitem_"+o].data=DataCenter.ins().UnionStoreConfig.item[o];this.guildMore.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips53"))},e.prototype.onReadInfo=function(){var t=unionStoreControl.getRecordInfoAry();if(t.length>0){this.record.visible=!0;var e=DataCenter.ins().ItemConfig[t[0].itemId],i=ItemUtils.getQualityColor(e);if(this.record.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips54",t[0].roleName,i,e.name)),t.length>1){this.record1.visible=!0;var o=DataCenter.ins().ItemConfig[t[1].itemId];this.record1.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips54",t[1].roleName,i,o.name))}if(t.length>2){this.record2.visible=!0;var n=DataCenter.ins().ItemConfig[t[2].itemId];this.record2.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips54",t[2].roleName,i,n.name))}}else this.record.visible=!1,this.record1.visible=!1,this.record2.visible=!1},e.prototype.onItemInfo=function(){this.unionShopResitem_7.visible=!0;var t=unionStoreControl.getGuildStoreItemData(0);this.unionShopResitem_7.num=t.num,this.unionShopResitem_7.data=t.itemId,this.onupdateData()},e.prototype.startEff=function(){var t=this;this.unionShopResitem_7.visible=!1,this.isOpenEff=!0,this.openBoxEff=new GameMovieClip,this.openBoxEff.x=232,this.openBoxEff.y=287,this.openBoxEff.playFile(PATH_EFF+"kaibaoxiang",1,function(){unionStoreControl.upBox(),t.isOpenEff=!1}),this.addChild(this.openBoxEff)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn0:case this.closeBtn:UIMgr.ins().close(this);break;case this.unionShopReskaiqi:UIMgr.ins().open(UnionView,1);break;case this.useBtn:if(unionStoreControl.guildStoreNum<=0)return void tipsControl.showTips("|C:"+ColorUtils.RED+"&T:"+LangMgr.getValueByKey("guildTodaySY",0)+"|");if(DataCenter.ins().UnionStoreConfig.needContrib>unionControl.myCon)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips55"));if(!CommonFun.checkBackpackCount(1,1))return;this.isOpenEff||this.startEff();break;case this.guildMore:UIMgr.ins().open(UnionShopRecordView)}},e}(BasePanel);__reflect(UnionShopPanel.prototype,"UnionShopPanel");var UnionShopRecordView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionShopRecordViewSkin",this.list.itemRenderer=UnionShopRecordItemRender,this.arrList=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.closeBtn1,this.onTap),this.arrList.replaceAll(unionStoreControl.getRecordInfoAry()),this.list.dataProvider=this.arrList},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeEventTouchTap(this.closeBtn1,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn1:case this.closeBtn0:case this.closeBtn:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(UnionShopRecordView.prototype,"UnionShopRecordView");var UnionSkillPanel=function(t){function e(){var e=t.call(this)||this;return e.selectBmpX=[0,34,165,293],e.selectBmpY=[0,239,13,239],e.curRole=0,e.selectIconID=2,e}return __extends(e,t),e.prototype.childrenCreated=function(){this.learnLab.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips56"))},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0!=unionControl.guildID;return i||tipsControl.showTips(LangMgr.getValueByKey("guildDes4")),i},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.praBtn,this.onTap),this.addEventTouchTap(this.skillBmp1,this.onTap),this.addEventTouchTap(this.skillBmp2,this.onTap),this.addEventTouchTap(this.skillBmp3,this.onTap),this.addEventTextLink(this.learnLab,this.onLink),this.addCustomEvent(23,this.update),this.addCustomEvent(28,this.updateMyInfo),this.addCustomEvent(352,this.updateRole),this.addCustomEvent(14,this.update),this.addCustomEvent(674,this.updateRedPoint),unionControl.upGuildSkillInfo(),unionControl.upMyGuildInfo(),this.praBtnMc.touchEnabled=!1,this.update()},e.prototype.close=function(){},e.prototype.updateRedPoint=function(){UnionRedPoint.ins().roleSkillTabs[this.curRole]||(UnionRedPoint.ins().roleSkillTabs[this.curRole]={},UnionRedPoint.ins().roleSkillTabs[this.curRole][1]=!1,UnionRedPoint.ins().roleSkillTabs[this.curRole][2]=!1,UnionRedPoint.ins().roleSkillTabs[this.curRole][3]=!1),this.redPoint1.visible=UnionRedPoint.ins().roleSkillTabs[this.curRole][1],this.redPoint2.visible=UnionRedPoint.ins().roleSkillTabs[this.curRole][2],this.redPoint3.visible=UnionRedPoint.ins().roleSkillTabs[this.curRole][3],this.updateMc()},e.prototype.onLink=function(){UIMgr.ins().open(UnionView,1)},e.prototype.updateRole=function(){unionControl.upGuildSkillInfo()},e.prototype.updateMyInfo=function(){this.praCon.text=""+unionControl.myCon},e.prototype.update=function(t){void 0===t&&(t=-1),this.curRole=t>-1?t:this.curRole,this.updateMyInfo(),this.updateRedPoint(),this.selectSkill(this.selectIconID)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.skillBmp1:this.selectSkill(1),this.selectSkillBmp.source="guildskill_1";break;case this.skillBmp2:this.selectSkill(2),this.selectSkillBmp.source="guildskill_2";break;case this.skillBmp3:this.selectSkill(3),this.selectSkillBmp.source="guildskill_3";break;case this.praBtn:this.learnBtnOnClick()}},e.prototype.learnBtnOnClick=function(){var t=unionControl.getSkllInfoByIndex(this.curRole);if(!Assert(t.guildSkillInfo[this.selectSkillID-1],LangMgr.getValueByKey("guildTips57",this.curRole,this.selectSkillID))){var e=t.guildSkillInfo[this.selectSkillID-1].level,i=unionControl.getBuildingLevels(1),o=DataCenter.ins().UnionCommonSkillConfig[this.selectSkillID].length,n=e>=o?null:this.getCommonSkillDP(this.selectSkillID,e+1);return 0==i||e>=DataCenter.ins().UnionConfig.commonSkillLevels[i-1]?void tipsControl.showTips(LangMgr.getValueByKey("guildTips58")):n.contribute>unionControl.myCon?void tipsControl.showTips(LangMgr.getValueByKey("guildTips59")):ActorControl.gold<n.money?void tipsControl.showTips(LangMgr.getValueByKey("bossMoneyEnought")):void unionControl.upLearnGuildSkill(this.curRole,this.selectSkillID)}},e.prototype.selectSkill=function(t){this.selectIconID=t,this.selectBmp.horizontalCenter=this["skillBmp"+this.selectIconID].horizontalCenter,this.selectBmp.verticalCenter=this["skillBmp"+this.selectIconID].verticalCenter,this.selectPraSkill(t)},e.prototype.getTotalPower=function(){for(var t=unionControl.getSkllInfoByIndex(this.curRole),e=0,i=1;4>i;i++){var o=t.guildSkillInfo[this.selectSkillID-1].level;if(o>0){var n=this.getCommonSkillDP(i,o);e+=BackpackControl.getAttrPower(n.attrs)}}return e},e.prototype.selectPraSkill=function(t){this.praGroup.visible=!0,this.selectSkillID=t,this.selectSkillType=1;var e=unionControl.getSkllInfoByIndex(this.curRole);if(e){var i=e.guildSkillInfo[this.selectSkillID-1].level,o=this.getCommonSkillDP(this.selectSkillID,i),n=this.getCommonSkillLength(this.selectSkillID),r=unionControl.getBuildingLevels(1);if(this.praCurBase.textColor=0==i?LangMgr.getColor("color71"):LangMgr.getColor("color72"),this.praCurBase.text=0==i?LangMgr.getValueByKey("guildNoStudy"):AttributeData.getAttStr(o.attrs,0,1,"：",!0),this.praName.text=DataCenter.ins().UnionConfig.commonSkillNames[this.selectSkillID-1],this.learnLab.visible=1>r||i>=DataCenter.ins().UnionConfig.commonSkillLevels[r-1],this.praBtn.visible=!this.learnLab.visible,n>i){var a=this.getCommonSkillDP(this.selectSkillID,i+1);this.praNextLab.text=AttributeData.getAttStr(a.attrs,0,1,"：",!0);var s=unionControl.myCon>=a.contribute?LangMgr.getValueByKey("color104"):LangMgr.getValueByKey("color105"),l="<font color='#"+s+"'>"+a.contribute+"</font>";this.praCost.textFlow=(new egret.HtmlTextParser).parser(l),this.praCost0.text=a.money+"",this.praCost0.textColor=ActorControl.gold>=a.money?LangMgr.getColor("color72"):ColorUtils.RED,this.updateMc()}else this.praNextLab.text=LangMgr.getValueByKey("maxLevel"),this.praCost.text="0",this.praCost0.text="0",this.praCost0.textColor=LangMgr.getColor("color72"),DisplayUtils.removeFromParent(this.mc);this.lvTxt.text=LangMgr.getValueByKey("equiLevel1",i)}},e.prototype.updateMc=function(){return!UnionRedPoint.ins().roleSkillTabs[this.curRole][this.selectSkillID]||this.learnLab.visible?void DisplayUtils.removeFromParent(this.mc):(this.mc||(this.mc=new GameMovieClip),this.mc.parent||(this.mc.x=this.praBtnMc.width/2,this.mc.y=this.praBtnMc.height/2,this.praBtnMc.addChild(this.mc)),void this.mc.playFile(PATH_EFF+"chargeff1",-1))},e.prototype.getCommonSkillDP=function(t,e){var i=DataCenter.ins().UnionCommonSkillConfig[t];if(0==e)return i[1];for(var o in i){var n=i[o];if(n.level==e)return n}return null},e.prototype.getCommonSkillLength=function(t){var e=DataCenter.ins().UnionCommonSkillConfig[t],i=0;for(var o in e)i++;return i},e}(BasePanel);__reflect(UnionSkillPanel.prototype,"UnionSkillPanel");var UnionSkillView=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionSkillViewSkin",e.isTopLevel=!0,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventChange(this.tab,this.setSelectedIndex),this.addCustomEvent(667,this.updateRed),this.addCustomEvent(674,this.updateRoleRedPoint),this.addCustomEvent(674,this.updateRed),this.lastSelect=0,this.viewStack.selectedIndex=this.lastSelect,this.addEventChange(this.roleSelect,this.update),this.viewStack.getElementAt(this.lastSelect).open(),this.unionSkillPanel.curRole=this.roleSelect.getCurRole(),this.updateRed(),this.updateRoleRedPoint()},e.prototype.setSelectedIndex=function(t){this.selectedIndex(this.viewStack.selectedIndex)},e.prototype.selectedIndex=function(t){void 0!=this.lastSelect&&this.viewStack.getElementAt(this.lastSelect).close(),this.lastSelect=t,this.viewStack.getElementAt(this.lastSelect).open(),0==this.lastSelect?this.roleSelect.openRole():this.roleSelect.hideRole()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.unionSkillPanel.close(),this.unionCampFirePanel.close(),UIMgr.ins().open(UnionMapView)},e.prototype.update=function(){this.unionSkillPanel&&this.unionSkillPanel.update(this.roleSelect.getCurRole())},e.prototype.updateRed=function(){this.redPoint1.visible=UnionRedPoint.ins().guildFire,this.redPoint0.visible=UnionRedPoint.ins().liangongRed},e.prototype.updateRoleRedPoint=function(){for(var t=[!1,!1,!1],e=0;e<t.length;e++)this.roleSelect.showRedPoint(e,t[e]);for(var e=0;1>e;e++)if(UnionRedPoint.ins().roleTabs[e])for(var i=0;i<heroControl.subRolesLen;i++)this.roleSelect.showRedPoint(i,UnionRedPoint.ins().roleTabs[e][i])},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return unionControl.getSkllInfoByIndex(0)||unionControl.fireDic?!0:(tipsControl.showTips(LangMgr.getValueByKey("bossErrorTips")),!1)},e}(BaseEuiView);__reflect(UnionSkillView.prototype,"UnionSkillView");var UnionView=function(t){function e(){var e=t.call(this)||this;return e.isTopLevel=!0,e.skinName="UnionViewSkin",e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.tab.dataProvider=this.viewStack},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=0!=unionControl.guildID;return i||tipsControl.showTips(LangMgr.getValueByKey("guildDes4")),i},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&t.length>0?this.lastSelect=t[0]:this.lastSelect=0,this.viewStack.selectedIndex=this.lastSelect,this.addEventChange(this.tab,this.setSelectedIndex),this.addCustomEvent(669,this.updateRedPoint),unionControl.upMyGuildInfo(),unionControl.upGuildMembers(),this.updateRedPoint(),this.viewStack.getElementAt(this.lastSelect).open()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.viewStack.getElementAt(this.lastSelect).close(),UIMgr.ins().open(UnionMapView)},e.prototype.onTap=function(t){t.currentTarget},e.prototype.setSelectedIndex=function(t){this.viewStack.getElementAt(this.lastSelect).close(),this.lastSelect=this.viewStack.selectedIndex,this.viewStack.getElementAt(this.lastSelect).open()},e.prototype.updateRedPoint=function(){this.redPoint1.visible=UnionRedPoint.ins().gldt},e}(BaseEuiView);__reflect(UnionView.prototype,"UnionView");var UnionAppltListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionApplyListItemSkin",e}return __extends(e,t),e.prototype.onTap=function(t){if(unionWarControl.getModel().isWatStart)return void warnControl.show(LangMgr.getValueByKey("guildTips22"),function(){},this);if(this.data)switch(t){case this.ok:var e=unionControl.getBuildingLevels(3)||0,i=e?DataCenter.ins().UnionConfig.affairMember[e-1]:0;if(unionControl.getMemberNum()>=DataCenter.ins().UnionConfig.maxMember[unionControl.guildLv-1]+i)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips23"));unionControl.upProcessJoin(this.data.roleID,1);break;case this.cancel:unionControl.upProcessJoin(this.data.roleID,0)}},e.prototype.dataChanged=function(){if(this.data instanceof UnionApplyInfoVo){var t=this.data;t.vipLevel>0?this.nameLab.x=162:this.nameLab.x=109;var e="<font color='#C2BAA5'>"+t.name+"</font>";this.nameLab.textFlow=(new egret.HtmlTextParser).parser(e),this.attack0.text=t.attack+"",this.myFace.source="head_"+t.job+t.sex,this.vipTitle.visible=t.vipLevel>0}},e}(BaseItemRender);__reflect(UnionAppltListItemRender.prototype,"UnionAppltListItemRender");var UnionBuildItemRender=function(t){function e(){var e=t.call(this)||this;return e._maxLevel=0,e._curLevel=0,e._nextMoney=0,e.skinName="UnionBuildItemSkin",e}return __extends(e,t),e.prototype.onTap=function(t){switch(t){case this.upBtn:var e=this.data;if(unionControl.myOffice<5)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips24"));if(1==e&&this._curLevel>=this._maxLevel)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips25"));if(1!=e&&this._curLevel>=unionControl.guildLv)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips26"));if(unionControl.money<this._nextMoney)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips27"));unionControl.upUpBuilding(e)}},e.prototype.dataChanged=function(){var t=this.data;this.buildImg.visible=1==t,this._curLevel=unionControl.getBuildingLevels(t-1)||0;var e=DataCenter.ins().UnionLevelConfig[t],i=null,o=null;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];this._maxLevel=r.level>this._maxLevel?r.level:this._maxLevel,r.level==this._curLevel&&(i=r),r.level==this._curLevel+1&&(o=r)}(i||o||2==t)&&(this.nameLab.text=DataCenter.ins().UnionConfig.buildingNames[t-1],this.levelLab.text=LangMgr.getValueByKey("equipment28")+(null==this._curLevel?0:this._curLevel),o&&this._curLevel<this._maxLevel?(this._nextMoney=o.upFund,this.upLevelLab.text=1==t?"":LangMgr.getValueByKey("guildUpNeed",this._curLevel+1),this.money.text=unionControl.money+"/"+o.upFund,this.needMoney.text=LangMgr.getValueByKey("guildNeedMondy",o.upFund),this.progress.maximum=o.upFund,this.progress.value=unionControl.money,this.progress.visible=!0):(this.upLevelLab.text=LangMgr.getValueByKey("guildTips25"),i?this.money.text=unionControl.money+"/"+i.upFund:this.money.text=LangMgr.getValueByKey("maxLevel"),this.needMoney.text="",this.progress.visible=!1),this.buildingLab.text=DataCenter.ins().UnionConfig.buildingTips[t-1]),this.manege.source="unionmn"+t+"_png",3==t&&(this.progress.visible=this.progressbg.visible=this.progressblack.visible=this.levelLab.visible=this.needMoney.visible=this.money.visible=!1,this.upBtn.touchEnabled=!1,this.upBtn.label=LangMgr.getValueByKey("guildHope"),this.upBtn.currentState="disabled",this.upBtn.verticalCenter=0),this.updateRedPoint()},e.prototype.updateRedPoint=function(){var t=this.data;return 3==t?void(this.redPoint.visible=!1):unionControl.myOffice<5?void(this.redPoint.visible=!1):1==t&&this._curLevel>=this._maxLevel?void(this.redPoint.visible=!1):1!=t&&this._curLevel>=unionControl.guildLv?void(this.redPoint.visible=!1):unionControl.money<this._nextMoney?void(this.redPoint.visible=!1):void(this.redPoint.visible=!0)},e}(BaseItemRender);__reflect(UnionBuildItemRender.prototype,"UnionBuildItemRender");var UnionEventItenRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionEventItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if("string"==typeof this.data){var t=this.data;t&&""!=t&&(this.info.textFlow=(new egret.HtmlTextParser).parser(t))}},e}(BaseItemRender);__reflect(UnionEventItenRender.prototype,"UnionEventItenRender");var UnionListItem2Render=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionListItem2Skin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof UnionListInfoVo){var t=this.data,e=DataCenter.ins().UnionConfig;if(t&&e){t.guildRank<4?(this.numImg.source="guildpaihang"+t.guildRank,this.numLab.visible=!1,this.numImg.visible=!0):(this.numLab.text=t.guildRank+"",this.numLab.visible=!0,this.numImg.visible=!1),this.nameLab.textFlow=TextUtils.generateTextFlow1(t.guildName),this.member0.text=""+t.guildLevel,this.president.text=t.guildPresident;var i=t.commentLv?DataCenter.ins().UnionConfig.affairMember[t.commentLv-1]:0;this.member.text=t.guildMember+"/"+(e.maxMember[t.guildLevel-1]+i),this.attrLab.text=""+t.attr}}},e}(BaseItemRender);__reflect(UnionListItem2Render.prototype,"UnionListItem2Render");var UnionListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionListItemSkin",e}return __extends(e,t),e.prototype.onTap=function(){if(unionWarControl.getModel().isWatStart)return void warnControl.show(LangMgr.getValueByKey("guildTips41"),function(){},this);var t=this.data;if(-1==unionControl.applyGuilds.indexOf(t.guildID)){if(this.data.attr>ActorControl.power)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips42"));this.applyBtn.enabled=!1,this.applyBtn.label=LangMgr.getValueByKey("guildApply"),unionControl.applyGuilds.push(t.guildID),unionControl.upJoinGuild(t.guildID)}},e.prototype.dataChanged=function(){if(this.data instanceof UnionListInfoVo){var t=this.data,e=DataCenter.ins().UnionConfig;if(t&&e){this.numLab.text=t.guildRank+"",this.nameLab.textFlow=(new egret.HtmlTextParser).parser(t.guildName+("<font color="+LangMgr.getValueByKey("color109")+">(Lv."+t.guildLevel+")</font>")),this.president.text=t.guildPresident;var i=t.commentLv?DataCenter.ins().UnionConfig.affairMember[t.commentLv-1]:0;this.member.textColor=t.guildMember<e.maxMember[t.guildLevel-1]+i?LangMgr.getColor("color70"):ColorUtils.RED,this.member.text=t.guildMember+"/"+(e.maxMember[t.guildLevel-1]+i);var o=CommonUtils.overLength(t.attr);this.attrLabel.visible=o?!0:!1,o&&(this.attrLabel.text=LangMgr.getValueByKey("guildNeedFight")+o),unionControl.applyGuilds.indexOf(t.guildID)>-1?(this.applyBtn.enabled=!1,this.applyBtn.label=LangMgr.getValueByKey("guildApply")):(this.applyBtn.enabled=!0,this.applyBtn.label=LangMgr.getValueByKey("friendSQ"))}}},e.prototype.destruct=function(){},e}(BaseItemRender);__reflect(UnionListItemRender.prototype,"UnionListItemRender");var UnionMapMemberItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionMapMemberItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof UnionMemberInfoVo){var t=this.data;t&&(this.nameLab.text=t.name,this.office.text=LangMgr.getValueByKey("officeName"+t.office),this.conLab.text=t.curContribution+"")}},e}(BaseItemRender);__reflect(UnionMapMemberItemRender.prototype,"UnionMapMemberItemRender");var UnionMemberItem1Render=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionMemberItem1Skin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof UnionMemberInfoVo){var t=this.data;t&&(this.nameLab.text=t.name,this.office.text=LangMgr.getValueByKey("officeName"+t.office),this.conLab.text=t.contribution+"",this.monthcard.visible=!1,this.vip.removeChildren(),this.vip.visible=t.vipLevel>0,this.vipTitle.visible=t.vipLevel>0,t.vipLevel<10?this.vipNum=BitmapNumber.ins().createNumPic(t.vipLevel,"vip_v"):(this.vipNum=BitmapNumber.ins().createNumPic(1,"vip_v"),this.vipNum0=BitmapNumber.ins().createNumPic(0,"vip_v"),this.vipNum0.x=33,this.vipNum0.y=-1,this.vip.addChild(this.vipNum0)),this.vipNum.x=18,this.vipNum.y=-1,this.vip.addChild(this.vipNum))}},e}(BaseItemRender);__reflect(UnionMemberItem1Render.prototype,"UnionMemberItem1Render");var UnionMemberItem2Render=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionMemberItem2Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.hasEventListener(egret.Event.REMOVED_FROM_STAGE)||this.addEventRemovedFromStage(this,function(){EventMgr.ins().removeAll(e)}),this.addEventTouchTap(this,function(t){t.target instanceof eui.Button||e.data&&UIMgr.ins().open(RamblePlayerTipsView,e.data)})},e.prototype.onTap=function(t){if(unionWarControl.getModel().isWatStart)return void warnControl.show(LangMgr.getValueByKey("guildTips43"),function(){},this);var e=this.data,i=e.roleID;switch(t){case this.impeachBtn:warnControl.show(LangMgr.getValueByKey("guildTips44",DataCenter.ins().UnionConfig.impeachCost),function(){ActorControl.yb>=DataCenter.ins().UnionConfig.impeachCost?unionControl.upDemise():tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"))},this);break;case this.demiseBtn:warnControl.show(LangMgr.getValueByKey("guildTips45",e.name),function(){unionControl.upChangeOffice(i,6)},this);break;case this.downBtn:warnControl.show(LangMgr.getValueByKey("guildTips46",e.name),function(){unionControl.upChangeOffice(i,0)},this);break;case this.kickBtn:warnControl.show(LangMgr.getValueByKey("guildTips47",e.name),function(){unionControl.upKick(i)},this);break;case this.appointBtn:warnControl.show(LangMgr.getValueByKey("guildTips48",e.name),function(){unionControl.canAppointFHZ()?unionControl.upChangeOffice(i,5):tipsControl.showTips(LangMgr.getValueByKey("guildTips49"))},this);break;default:UIMgr.ins().open(RamblePlayerTipsView,this.data)}},e.prototype.dataChanged=function(){if(this.data instanceof UnionMemberInfoVo){var t=this.data;this.nameLab.textFlow=(new egret.HtmlTextParser).parser("["+LangMgr.getValueByKey("officeName"+t.office)+"]<font color='#DFDCDC'>"+t.name+"</font>"),this.conLab.text=LangMgr.getValueByKey("guildGXValue",t.contribution),this.attack.text=LangMgr.getValueByKey("godFightValue",t.attack),this.face.source="head_"+t.job+t.sex,this.headBG.source=RambleListItemRenderer.HEAD_BG[t.sex];var e=0,i=unionControl.myOffice;switch(6==i||5==i?(this.onLine.visible=!0,t.downTime>0?(e=.001*(GameServer.serverTime-DateUtils.formatMiniDateTime(t.downTime)),this.onLine.textFlow=TextUtils.generateTextFlow1("|C:"+ColorUtils.RED+"&T:"+DateUtils.getFormatBySecond(e,7))):this.onLine.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips50"))):this.onLine.visible=!1,this.group1.visible=!1,this.group2.visible=!1,this.group3.visible=!1,this.impeachBtn.visible=e>=DataCenter.ins().UnionConfig.impeachTime,this.vip.removeChildren(),this.vip.visible=t.vipLevel>0,this.vipTitle.visible=t.vipLevel>0,t.vipLevel<10?this.vipNum=BitmapNumber.ins().createNumPic(t.vipLevel,"vip_v"):(this.vipNum=BitmapNumber.ins().createNumPic(1,"vip_v"),this.vipNum0=BitmapNumber.ins().createNumPic(0,"vip_v"),this.vipNum0.x=33,this.vipNum0.y=-1,this.vip.addChild(this.vipNum0)),this.vipNum.x=18,this.vipNum.y=-1,this.vip.addChild(this.vipNum),i){case 6:if(6==t.office)break;
5==t.office?this.group2.visible=!0:(this.group3.visible=!0,this.appointBtn.visible=!0);break;case 5:if(6==t.office)this.group1.visible=!0;else{if(5==t.office)break;this.group3.visible=!0,this.appointBtn.visible=!1}break;case 4:case 3:case 2:6==t.office&&(this.group1.visible=!0)}}},e}(BaseItemRender);__reflect(UnionMemberItem2Render.prototype,"UnionMemberItem2Render");var UnionShopRecordItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionShopRecordItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof UnionStoreRecordInfoVo){var t=DataCenter.ins().ItemConfig[this.data.itemId];t?this.rank.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guildTips54",this.data.roleName,ItemUtils.getQualityColor(t),t.name)):this.rank.text=""}},e}(BaseItemRender);__reflect(UnionShopRecordItemRender.prototype,"UnionShopRecordItemRender");var UnionTaskItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionTaskItemSkin",e}return __extends(e,t),e.prototype.onTap=function(t){switch(t){case this.conBtn:case this.goBtn:this.conBtnOnCLick()}},e.prototype.conBtnOnCLick=function(){var t=this.data;switch(t.stdTask.type){case 31:t.param>=t.stdTask.target?tipsControl.showTips(LangMgr.getValueByKey("guildTips60")):ActorControl.yb>=t.stdTask.param?unionControl.upCon(t.stdTask.conID):tipsControl.showTips(LangMgr.getValueByKey("osaNoMoney"));break;case 32:t.param>=t.stdTask.target?tipsControl.showTips(LangMgr.getValueByKey("guildTips60")):ActorControl.gold>=t.stdTask.param?unionControl.upCon(t.stdTask.conID):warnControl.setBuyGoodsWarn(1);break;case 33:t.param>=t.stdTask.target?tipsControl.showTips(LangMgr.getValueByKey("guildTips60")):backpackControl.getBagGoodsCountById(0,t.stdTask.param)>=1?unionControl.upCon(t.stdTask.conID):tipsControl.showTips(LangMgr.getValueByKey("zhuzaiPropEnought"));break;default:GuideControl.guidance(t.stdTask.controlTarget[0],t.stdTask.controlTarget[1])}},e.prototype.goBtnOnClick=function(){var t=this.data;switch(t.state){case 0:GuideControl.guidance(t.stdTask.controlTarget[0],t.stdTask.controlTarget[1]);break;case 1:unionControl.upGetTaskAward(t.taskID);break;case 2:}},e.prototype.dataChanged=function(){if(this.data instanceof UnionTaskInfoVo){var t=this.data;if(t)if(this.taskIcon.source="guildtask_"+t.taskID,this.nameLab.text=t.stdTask.name,this.descLab.text=t.stdTask.desc,this.conGroup.visible=!0,this.getGroup.visible=!1,this.numLab.text=t.param+"/"+t.stdTask.target,this.conBtn.enabled=t.param<t.stdTask.target,t.param<t.stdTask.target)switch(t.stdTask.type){case 31:case 32:case 33:this.conBtn.label=LangMgr.getValueByKey("guildGX");break;default:this.conBtn.label=LangMgr.getValueByKey("guildGoGo")}else this.conBtn.label=LangMgr.getValueByKey("guildFinsh")}},e}(BaseItemRender);__reflect(UnionTaskItemRender.prototype,"UnionTaskItemRender");var UnionBossDetailView=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.skinName="UnionBossDetailViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.isPlayAnima=!1,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this)},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],this.addEventTouchTap(this.chanllage,this.onTap),this.addEventTouchTap(this.chanllageOme,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.rankBtn,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addCustomEvent(433,this.setView),this.addCustomEvent(432,this.upInfo),this.addCustomEvent(434,this.challengeSuccess),this.addCustomEvent(435,this.setRank),this.upInfo(),unionBossControl.upGetBossRankInfo(this.index+1)},e.prototype.upInfo=function(){unionBossControl.upGetBossInfo()},e.prototype.setView=function(){this.chanllagecount.text=""+LangMgr.getValueByKey("guilFightTimes")+unionBossControl.leftTimes+"/"+DataCenter.ins().UnionBossConfig.dayTimes;var t=unionBossControl.passId;this.chanllagecount.visible=unionBossControl.isOpen()&&t==this.index,this.chanllage.visible=unionBossControl.isOpen()&&this.index<=t,this.cantchanllage.visible=unionBossControl.isOpen()&&!this.chanllage.visible;var e=DataCenter.ins().UnionBossInfoConfig[this.index+1],i=DataCenter.ins().MonstersConfig[e.boss.monId];this.bossname.text=i.name,this.bossImage.source=e.ShowImg;for(var o=unionBossControl.passRecord[this.index+1],n=0;n<e.passAwards.length;n++)this["itemicon"+n].isShowName(!1),this["itemicon"+n].data=e.passAwards[n];for(var r=DataCenter.ins().UnionBossHpAwardsConfig[this.index+1],n=3;7>n;n++)this["itemicon"+n].isShowName(!1),this["itemicon"+n].data=r[n-2].awards[0];if(this.index<t)this.bosshp.value=0,this.bosshp.maximum=0,this.rewardBar.value=100,this.rewardBar.maximum=100;else if(this.index==t){var a=0;a=Math.ceil((i.hp-unionBossControl.bossHP)/i.hp*1e4)/100>>0,this.bosshp.maximum=100,this.bosshp.value=a,this.rewardBar.value=100-a,this.rewardBar.maximum=100}else this.bosshp.value=100,this.bosshp.maximum=100,this.rewardBar.value=0,this.rewardBar.maximum=100;this.chanllage.enabled=!0,this.chanllage.x=166,this.chanllageOme.visible=!1,0==o||this.bosshp.value?unionControl.guildLv>=DataCenter.ins().UnionBossConfig.radisLv&&this.chanllage.visible&&(this.chanllageOme.visible=!0,this.chanllage.x=54):1==o?this.chanllage.label=LangMgr.getValueByKey("activitGet1"):(this.chanllage.label=LangMgr.getValueByKey("activitAlreadingGet"),this.chanllage.enabled=!1),this.state.visible=!unionBossControl.isOpen(),this.state.visible&&(this.cantchanllage.visible=this.chanllageOme.visible=this.chanllage.visible=!1)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.chanllageOme:case this.chanllage:if(0==unionBossControl.passRecord[this.index+1]||this.bosshp.value){if(unionBossControl.challengeTime>GameServer.serverTime)return void tipsControl.showTips(LangMgr.getValueByKey("guilFighting"));if(unionBossControl.leftTimes<=0)return void tipsControl.showTips(LangMgr.getValueByKey("guilNoTimes"));unionBossControl.upChallengeBoss(t.currentTarget==this.chanllageOme?1:0)}else this.chanllage.label==LangMgr.getValueByKey("activitGet1")&&unionBossControl.upGetBossReward(this.index+1);break;case this.rankBtn:UIMgr.ins().open(UnionBossRankView,this.index);break;case this.fgClose:case this.bgClose:UIMgr.ins().close(e)}},e.prototype.challengeSuccess=function(){UIMgr.ins().close(UnionBossView),UIMgr.ins().close(UnionMapView),UIMgr.ins().close(e)},e.prototype.setRank=function(){for(var t=unionBossControl.guildRankDic[this.index+1],e=DataCenter.ins().UnionBossInfoConfig[this.index+1],i=DataCenter.ins().MonstersConfig[e.boss.monId],o=0;3>o;o++)if(t&&t[o]){this["rankGroup"+o].visible=!0,this["guildname"+o].text=t[o].name;var n=0,r=Math.ceil(t[o].damage/i.hp*1e4)/100;n=r>100?100:r,this["hpbar"+o].value=n,this["hpbar"+o].maximum=100,this["bosshpbg"+o].visible=this["hpbar"+o].visible=!0}else this["bosshpbg"+o].visible=this["hpbar"+o].visible=!1},e}(BaseEuiView);__reflect(UnionBossDetailView.prototype,"UnionBossDetailView");var UnionBossRankView=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.skinName="UnionBossRankViewSkin",e.isTopLevel=!0,e.uilayer=GameLayer.POPUP,e.list.itemRenderer=UnionBossRankItemRender,e}return __extends(e,t),e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],this.addEventTouchTap(this.bgClose,this.onTap),this.setView()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeCustomEvents()},e.prototype.setView=function(){for(var t=[],e=unionBossControl.guildPersonRankDic[this.index+1]||[],i=0;i<e.length;i++)e[i]&&(e[i].name==ActorControl.myName&&(this.myData=e[i]),t.push(e[i]));this.list.dataProvider=new eui.ArrayCollection(t),this.myData?(this.qiansan.visible=!0,this.myrank.visible=!0,this.myname.visible=!0,this.myharm.visible=!0,this.myreword.visible=!0,this.myData.rank<=3?this.qiansan.source="guildpaihang"+this.myData.rank:this.qiansan.source="",this.myrank.text=this.myData.rank+"",this.myname.text=this.myData.name,this.myharm.text=this.myData.damage+"",this.myreword.text=unionBossControl.leftTimes+"/"+DataCenter.ins().UnionBossConfig.dayTimes):(this.qiansan.visible=!1,this.myrank.visible=!1,this.myname.visible=!1,this.myharm.visible=!1,this.myreword.visible=!1)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(UnionBossRankView.prototype,"UnionBossRankView");var UnionBossView=function(t){function e(){var e=t.call(this)||this;return e.bossLen=0,e.itemLen=6,e.arrCount=0,e.currentArr=[],e.currentIndex=0,e.skinName="UnionBossViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.itemArr=[];for(var e=0;6>e;e++)this.itemArr.push(this["bossItem"+e]);this.bossLen=CommonUtils.getObjectLength(DataCenter.ins().UnionBossInfoConfig),this.arrCount=0,this.bossArr=[];for(var i=0;i<this.bossLen;i++)this.bossArr[this.arrCount]||(this.bossArr[this.arrCount]=[]),i<(this.arrCount+1)*this.itemLen?this.bossArr[this.arrCount].push(i):i==(this.arrCount+1)*this.itemLen&&(this.arrCount++,this.bossArr[this.arrCount]=[],this.bossArr[this.arrCount].push(i))},e.openCheck=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return unionControl.guildID||tipsControl.showTips(LangMgr.getValueByKey("guildDes4")),!!unionControl.guildID},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.imgleft,this.onTap),this.addEventTouchTap(this.imgRight,this.onTap);for(var i=0;i<this.itemLen;i++)this.addEventTouchTap(this.itemArr[i],this.onItemTap);this.addCustomEvent(433,this.setView),this.addCustomEvent(432,this.setView),this.addCustomEvent(434,this.challengeSuccess),this.currentIndex=this.getRuleIndex(),unionBossControl.upGetBossInfo()},e.prototype.getRuleIndex=function(){var t=Object.keys(DataCenter.ins().UnionBossInfoConfig).length,e=unionBossControl.passId;return e>=t&&(e-=1),Math.floor(e/this.itemLen)},e.prototype.setView=function(){var t=unionBossControl.passId+1,e=Object.keys(DataCenter.ins().UnionBossInfoConfig).length;t=t>=e?e:t,this.currentArr=this.bossArr[this.currentIndex];var i=DataCenter.ins().UnionBossInfoConfig[t];this.fightboss.source=i.ShowImg;for(var o=0;o<this.itemLen;o++)null!=this.currentArr[o]?(this.itemArr[o].data=this.currentArr[o],this.itemArr[o].visible=!0):this.itemArr[o].visible=!1;this.selfname.text=unionControl.guildName,this.enemyname.text=unionBossControl.otherGuildName;var n=CommonUtils.getObjectLength(DataCenter.ins().UnionBossInfoConfig),r=unionBossControl.passId+1>n?n:unionBossControl.passId+1,a=DataCenter.ins().UnionBossInfoConfig[r],s=DataCenter.ins().MonstersConfig[a.boss.monId],l=0,h=0;l=Math.ceil((s.hp-unionBossControl.bossHP)/s.hp*1e4)/100,this.sbhpbar.value=l,this.sbhpbar.maximum=100,this.ebhpbar.value=h,this.ebhpbar.maximum=100,this.state.visible=!unionBossControl.isOpen(),this.currentIndex?this.currentIndex==this.arrCount?(this.imgleft.visible=!0,this.imgRight.visible=!1):(this.imgleft.visible=!0,this.imgRight.visible=!0):(this.imgleft.visible=!1,this.imgRight.visible=!0)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(e);break;case this.imgleft:this.currentIndex--,this.currentIndex<=0&&(this.imgleft.visible=!1),this.setView(),this.imgRight.visible=!0;break;case this.imgRight:this.currentIndex++,this.currentIndex>=this.arrCount&&(this.imgRight.visible=!1),this.setView(),this.imgleft.visible=!0}},e.prototype.onItemTap=function(t){UIMgr.ins().open(UnionBossDetailView,t.currentTarget.data)},e.prototype.challengeSuccess=function(){UIMgr.ins().close(e),UIMgr.ins().close(UnionMapView)},e}(BaseEuiView);__reflect(UnionBossView.prototype,"UnionBossView");var UnionBossItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionBossItemSkin",e.bosshp.maximum=100,e.bosshp.slideDuration=0,e}return __extends(e,t),e.prototype.dataChanged=function(){var t=unionBossControl.passId,e=this.data+1,i=DataCenter.ins().UnionBossInfoConfig[e],o=DataCenter.ins().MonstersConfig[i.boss.monId];if(this.bossImage.source=i.ShowImg,this.data<t){this.bossname.textColor=LangMgr.getColor("color56"),this.bosshp.value=0;var n=unionBossControl.passRecord[e];this.passImg.visible=!0,this.redPoint0.visible=unionBossControl.isOpen()&&1==n}else this.data==t?(this.bossname.textColor=ColorUtils.NORMAL_COLOR,this.bosshp.value=Math.ceil((o.hp-unionBossControl.bossHP)/o.hp*1e4)/100>>0,this.redPoint0.visible=unionBossControl.isOpen()&&unionBossControl.leftTimes>0?!0:!1,this.passImg.visible=!1):(this.bossname.textColor=ColorUtils.NORMAL_COLOR,this.bosshp.value=100,this.redPoint0.visible=!1,this.passImg.visible=!1);this.bossname.text=e+"."+o.name},e.prototype.isOpen=function(){return(new Date).getDay()!=DataCenter.ins().UnionBossConfig.notOpenDayOfWeek},e}(BaseItemRender);__reflect(UnionBossItemRender.prototype,"UnionBossItemRender");var UnionBossRankItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionBossRankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.rank.text=this.data.rank,this.playerName.text=this.data.name,this.harm.text=this.data.damage;var t,e=!1,i=DataCenter.ins().UnionBossRankConfig;for(var o in i){if(i[o].srank<=this.data.rank&&i[o].erank>=this.data.rank){e=!0,this.reward.text=i[o].awards[0].count+"";break}0==i[o].srank&&0==i[o].erank&&(t=i[o])}e||(this.reward.text=t.awards[0].count+"")},e}(BaseItemRender);__reflect(UnionBossRankItemRender.prototype,"UnionBossRankItemRender");var DailyAwardView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="DailyAwardViewSkin",this.isTopLevel=!0,this.list.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn1,this.onTap),this.addEventTouchTap(this.sure,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.list.dataProvider=new eui.ArrayCollection(DataCenter.ins().UnionBattleDayAwardConfig[unionWarControl.getModel().rewardDay].award),unionWarControl.getModel().getDayReward?(this.sure.label=LangMgr.getValueByKey("activitAlreadingGet"),this.sure.enabled=!1):(this.sure.label=LangMgr.getValueByKey("activitGet"),this.sure.enabled=!0)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn1,this.onTap),this.removeEventTouchTap(this.sure,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn1:UIMgr.ins().close(e);break;case this.sure:if(unionWarControl.getModel().getDayReward)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips2"));if(!unionWarControl.getModel().canGetDay)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips3"));unionWarControl.upDayReward(unionWarControl.getModel().rewardDay),UIMgr.ins().close(e);break;case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DailyAwardView.prototype,"DailyAwardView");var DailyPresidentAwardView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="DailyPresidentAwardViewSkin",this.list.itemRenderer=ItemBase,this.dataArr=new eui.ArrayCollection},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap);var i=DataCenter.ins().UnionBattleConstConfig.occupationAward;this.dataArr.source=i,this.list.dataProvider=this.dataArr,this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.fgClose:case this.bgClose:UIMgr.ins().close(this)}},e}(BaseEuiView);__reflect(DailyPresidentAwardView.prototype,"DailyPresidentAwardView");var SelectMemberRewardView=function(t){function e(){var e=t.call(this)||this;return e.dataLen=[],e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SelectMemberRewardViewSkin",this.list.itemRenderer=SelectRewardItemRender},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];unionWarControl.upOwnMyGuildRank(),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.sendReward,this.onTap),this.addCustomEvent(428,this.refushList),this.refushPanelInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.sendReward,this.onTap),this.removeCustomEvents(),UIMgr.ins().open(UnionMapView)},e.prototype.refushPanelInfo=function(){this.rankLabel.text=LangMgr.getValueByKey("guildTips18",unionWarControl.getModel().guildWarRank),this.dataLen.length=unionWarControl.getModel().getCanSendNumByRank(),this.refushList()},e.prototype.refushList=function(){this.list.dataProvider=new eui.ArrayCollection(this.dataLen)},e.prototype.onTap=function(t){var i=this;switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(e);break;case this.sendReward:TimerMgr.ins().doTimer(100,1,function(){unionWarControl.getModel().checkISSendAll()&&unionWarControl.upFenReward(i.dataLen.length,unionWarControl.getModel().sendList)},this)}},e}(BaseEuiView);__reflect(SelectMemberRewardView.prototype,"SelectMemberRewardView");var SelectMemberView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="SelectMemberViewSkin",this.list.itemRenderer=MemberItem3Render},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.index=t[0],this.maxNum=t[1],this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.list,this.onTap),this.addEventTouchTap(this.sureBtn,this.onTap),unionWarControl.getModel().sendList[this.index]=[],unionWarControl.getModel().sendNumList[this.index]=[],this.selectList=[],this.numList=[],this.selectItemList=[],this.chooseNum.text=LangMgr.getValueByKey("guilChoose")+this.countNum()+"/"+this.maxNum,this.sureBtn.enabled=this.selectList.length==this.maxNum,this.refushList()},e.prototype.refushList=function(){this.list.dataProvider=new eui.ArrayCollection(unionWarControl.getModel().getMyGuildPointRank())},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.list,this.onTap),this.removeEventTouchTap(this.sureBtn,this.onTap),unionWarControl.dispatchSendListChange()},e.prototype.countNum=function(){var t=0;if(this.selectItemList)for(var e in this.selectItemList)t+=this.selectItemList[e].chooseNum;return t},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(e);break;case this.sureBtn:this.toNumList(),unionWarControl.getModel().sendList[this.index]=this.selectList,unionWarControl.getModel().sendNumList[this.index]=this.numList,UIMgr.ins().close(e);break;case this.list:var i=t.target.parent;if(i&&i.data){var o=this.selectItemList.lastIndexOf(i);switch(t.target){case i.btn1:--i.chooseNum,i.chooseNum<1&&(i.chooseNum=1);break;case i.btn2:if(this.countNum()>=this.maxNum)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips17"));++i.chooseNum;break;default:if(o>=0)i.checkBoxs.selected=!1,i.chooseNum=0,this.selectItemList.splice(o,1);else{if(this.countNum()>=this.maxNum)return i.checkBoxs.selected=!1,void tipsControl.showTips(LangMgr.getValueByKey("guildTips17"));i.checkBoxs.selected=!0,this.selectItemList.push(i),i.chooseNum=1}}i.num1.text=i.chooseNum+"",this.setAddInfoShow(i,i.checkBoxs.selected),this.chooseNum.text=LangMgr.getValueByKey("guilChoose")+this.countNum()+"/"+this.maxNum,this.sureBtn.enabled=this.countNum()==this.maxNum}}},e.prototype.setAddInfoShow=function(t,e){void 0===e&&(e=!1),t.btn1.visible=t.btn2.visible=t.num1.visible=t.inputBg.visible=e},e.prototype.toNumList=function(){if(this.selectItemList)for(var t in this.selectItemList)this.selectList.push(this.selectItemList[t].data.data),this.numList.push(this.selectItemList[t].chooseNum)},e}(BaseEuiView);__reflect(SelectMemberView.prototype,"SelectMemberView");var UnionWarMainView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.redEff=new GameMovieClip,this.enterEff=new GameMovieClip,this.titleEff=new GameMovieClip,this.skinName="UnionWarMainViewSkin",this.roleEff=new GameMovieClip,this.player.addChild(this.roleEff)},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.practiseBtn,this.onTap),this.addEventTouchTap(this.redBag,this.onTap),this.addEventTouchTap(this.play,this.onTap),this.addEventTouchTap(this.practiseBtn2,this.onTap),this.addEventTouchTap(this.practiseBtn0,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addEventTouchTap(this.practiseBtn1,this.onTap),this.addCustomEvent(413,this.refushRewardStatu),this.addCustomEvent(421,this.refushRewardStatu),this.addCustomEvent(409,this.refushStartEffect),this.practiseBtn1.visible=unionWarControl.getModel().guildRankList.length>0&&!unionWarControl.getModel().isWatStart,this.refushPanelInfo(),this.refushStartEffect(),this.refushTitleEffect(),this.addCustomEvent(673,this.updateRedBag),this.addCustomEvent(670,this.updateRedBag),this.updateRedBag()},e.prototype.updateRedBag=function(){this.redBag.visible=UnionRedPoint.ins().redBag,this.redPoint0.visible=UnionRedPoint.ins().dayReward},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().open(UnionMapView)},e.prototype.refushPanelInfo=function(){unionWarControl.getModel().isWatStart?this.openDesc.text="":this.openDesc.text=unionWarControl.getModel().setOpenDesc(),this.refushRewardStatu(),this.refushWinGuild()},e.prototype.refushStartEffect=function(){unionWarControl.getModel().isWatStart?(this.enterEff.playFile(PATH_EFF+"chargeff1",-1),this.enterEff.x=this.play.width>>1,this.enterEff.y=this.play.height>>1,this.play.addChild(this.enterEff)):DisplayUtils.removeFromParent(this.enterEff)},e.prototype.refushTitleEffect=function(){this.titleEff.playFile(PATH_EFF+"chenghaolcbz",-1),this.titleGroup.addChild(this.titleEff)},e.prototype.refushRewardStatu=function(){unionWarControl.getModel().canSend||unionWarControl.getModel().canRod?(this.redEff.playFile(PATH_EFF+"actIconCircle",-1),this.redEff.x=this.redEff.y=28,this.redBag.addChild(this.redEff)):DisplayUtils.removeFromParent(this.redEff)},e.prototype.refushWinGuild=function(){var t=unionWarControl.getModel().winGuildInfo.guildId>0;if(this.guildOwn.visible=t,this.guildName.visible=t,this.roleEff.visible=t,this.none.visible=!t,t){var e=unionWarControl.getModel().winGuildInfo;this.guildName.text=e.guildName,this.guildOwn.text=e.guildOwnName;var i=1==e.guildOwnSex?"junzhunv":"junzhunan";this.roleEff.playFile(PATH_EFF+i,-1)}},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(e);break;case this.practiseBtn:UIMgr.ins().open(UnionWarRewardView);break;case this.redBag:unionWarControl.getModel().canRod||unionWarControl.getModel().canSend?UIMgr.ins().open(RedBagView):UIMgr.ins().open(RedBagDetailsView);break;case this.play:if(!unionWarControl.getModel().isWatStart)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips4"));UIMgr.ins().close(UnionMapView),UIMgr.ins().close(e),unionWarControl.upJoinAc();break;case this.practiseBtn0:UIMgr.ins().open(DailyPresidentAwardView);break;case this.practiseBtn2:UIMgr.ins().open(DailyAwardView);break;case this.help:HelpControl.openHelpWin(8);break;case this.practiseBtn1:UIMgr.ins().open(UnionWarRewardView,0,1)}},e}(BaseEuiView);__reflect(UnionWarMainView.prototype,"UnionWarMainView");var UnionWarMemView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionWarMemViewSkin",this.list.itemRenderer=UnionWarMemListItemRender,this.data=new eui.ArrayCollection,this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.dataProvider=this.data,this.addCustomEvent(430,this.refushList),unionWarControl.upOwnMyGuildRank(),this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.removeCustomEvents()},e.prototype.refushList=function(){this.data.replaceAll(unionWarControl.getModel().myRankList)},e.prototype.onTap=function(t){UIMgr.ins().close(e)},e}(BaseEuiView);__reflect(UnionWarMemView.prototype,"UnionWarMemView");var UnionWarReliveView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionWarReliveViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];switch(this.type=t[0],this.sceneIndex=t[1],this.type){case 1:this.currentState="switch",this.defaultStr=LangMgr.getValueByKey("guildTips14"),this.s=unionWarControl.getModel().getCdByType(this.type);break;case 2:this.currentState="revive",this.defaultStr=LangMgr.getValueByKey("guildTips15"),this.s=t[1];break;case 3:this.currentState="exit",this.defaultStr=LangMgr.getValueByKey("guildTips16"),this.s=unionWarControl.getModel().getCdByType(this.type)}this.addEventTouchTap(this.closeBtn,this.onTap),this.timeDown.text=""+this.s+this.defaultStr,TimerMgr.ins().remove(this.updateCloseBtnLabel,this),TimerMgr.ins().doTimer(1e3,this.s,this.updateCloseBtnLabel,this),this.refushMapInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),TimerMgr.ins().remove(this.updateCloseBtnLabel,this),1!=this.type&&(unionWarControl.getModel().killName="")},e.prototype.refushMapInfo=function(){1==this.type?this.mapName.text=unionWarControl.getModel().getNextMapName(this.sceneIndex):2==this.type&&(this.killName.text=LangMgr.getValueByKey("bossFinghtLoss",unionWarControl.getModel().killName),this.guildName.text=LangMgr.getValueByKey("guildBelongClud",unionWarControl.getModel().killGuild))},e.prototype.updateCloseBtnLabel=function(){this.s--,this.s<=0&&(1==this.type&&unionWarControl.upPlayNextMap(this.sceneIndex),3==this.type&&copyControl.upExitFb(),UIMgr.ins().close(e)),this.timeDown.text=""+this.s+this.defaultStr},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(UnionWarReliveView.prototype,"UnionWarReliveView");var UnionWarResultView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.isTopLevel=!0,this.skinName="UnionWarResultViewSkin",this.closeBtn.label=LangMgr.getValueByKey("babelEnter"),this.list1.itemRenderer=ItemBase,this.list2.itemRenderer=ItemBase},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.guildName.text=""==t[0]?LangMgr.getValueByKey("clanEmptyJob"):t[0],this.myPoint.text=t[1]+"",this.guildPoint.text=""+t[2],this.guildRank.text=LangMgr.getValueByKey("ranking",t[3]),this.myRank.text=t[4]>0?LangMgr.getValueByKey("ranking",t[4]):LangMgr.getValueByKey("guanNoRank");var i=unionWarControl.getModel().getRewardByPoint(t[1]),o=unionWarControl.getModel().getMyPointRankReward(t[4]);this.list1.dataProvider=new eui.ArrayCollection(o.concat(i)),this.list2.dataProvider=new eui.ArrayCollection(unionWarControl.getModel().creatGuildRankReward(t[3])),this.s=10,this.addEventTouchTap(this.closeBtn,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap)},e.prototype.onTap=function(){UIMgr.ins().close(e)},e}(BaseEuiView);__reflect(UnionWarResultView.prototype,"UnionWarResultView");var UnionWarRewardView=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type=0,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionWarRewardViewSkin",this.isTopLevel=!0},e.prototype.addPanelList=function(){this.guildInteRankInfo=new UnionInteRankInfoPanel,this.viewStack.addChild(this.guildInteRankInfo),this.personalInteRankInfo=new PersonalInteRankInfoPanel,this.viewStack.addChild(this.personalInteRankInfo),this.guildInteRewardInfo=new UnionInteRewardInfoPanel,this.viewStack.addChild(this.guildInteRewardInfo),this.personInteRewardInfo=new PersonInteRewardInfoPanel,this.viewStack.addChild(this.personInteRewardInfo),this.cruPanel=this.viewStack.getChildAt(0),this.tab.dataProvider=this.viewStack},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t&&t[1]&&(this.type=t[1]),this.addPanelList(),t&&t[0]?this.viewStack.selectedIndex=t[0]:this.viewStack.selectedIndex=0,this.addEventTouchTap(this.closeBtn,this.onTap),this.addEventTouchTap(this.closeBtn0,this.onTap),this.addEventChange(this.tab,this.onTabTouch),this.cruPanel.open()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.closeBtn,this.onTap),this.removeEventTouchTap(this.closeBtn0,this.onTap),this.cruPanel.close(),this.viewStack.removeChildren(),this.type=0},e.prototype.onTap=function(t){switch(t.currentTarget){case this.closeBtn:case this.closeBtn0:UIMgr.ins().close(e)}},e.prototype.onTabTouch=function(t){this.cruPanel&&this.cruPanel.close(),this.cruPanel=this.viewStack.selectedChild,this.cruPanel.open()},e}(BaseEuiView);__reflect(UnionWarRewardView.prototype,"UnionWarRewardView");var UnionWarRulesView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionWarRulesViewSkin",this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bigBg,this.onTap),this.addEventTouchTap(this.bg,this.onTap),this.addEventTouchTap(this.attr,this.onTap),this.addEventTouchTap(this.leftBtn,this.onTap),this.addEventTouchTap(this.rightBtn,this.onTap),this.cruIndex=unionWarControl.getModel().getMapLevelInfo().id,this.refushInfo()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bigBg,this.onTap),this.removeEventTouchTap(this.bg,this.onTap),this.removeEventTouchTap(this.attr,this.onTap),this.removeEventTouchTap(this.leftBtn,this.onTap),this.removeEventTouchTap(this.rightBtn,this.onTap)},e.prototype.refushInfo=function(){var t=DataCenter.ins().UnionBattleLvConfig,e=t[this.cruIndex];
this.mapName.text=e.name,this.attr.textFlow=TextUtils.generateTextFlow(e.help),this.rightBtn.visible=this.cruIndex<4,this.leftBtn.visible=this.cruIndex>1},e.prototype.onTap=function(t){switch(t.currentTarget){case this.leftBtn:--this.cruIndex,this.refushInfo();break;case this.rightBtn:++this.cruIndex,this.refushInfo();break;case this.bigBg:UIMgr.ins().close(e);break;default:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(UnionWarRulesView.prototype,"UnionWarRulesView");var UnionWarTipsView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="GameTipsSkin",this.isTopLevel=!0},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this,this.onTap)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this,this.onTap)},e.prototype.onTap=function(t){UIMgr.ins().close(e)},e}(BaseEuiView);__reflect(UnionWarTipsView.prototype,"UnionWarTipsView");var UnionWarUiInfoView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="UnionWarUiInfoViewSkin",this.clickEffc=new GameMovieClip,this.pointEff=new GameMovieClip,this.pointEff.x=61,this.pointEff.y=34,this.list1.itemRenderer=UnionWarMemberHeadItemRender,this.list2.itemRenderer=UnionWarMemberHeadItemRender,this.sceneBar.maximum=300,this.sceneBar.labelFunction=function(){return""},this.bloodBar1.slideDuration=0,this.bloodBar.labelDisplay.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.Nextchengnei,this.onTap),this.addEventTouchTap(this.Nextchengnei0,this.onTap),this.addEventTouchTap(this.Nextdianqian,this.onTap),this.addEventTouchTap(this.Nexthuanggong,this.onTap),this.addCustomEvent(353,this.refushShowInfo),this.addCustomEvent(410,this.refushPoint),this.addCustomEvent(424,this.refushPointReward),this.addEventTouchTap(this.seeRank,this.onTap),this.addCustomEvent(412,this.cityOwnChange),this.addEventTouchTap(this.seeMyGuild,this.onTap),this.addCustomEvent(420,this.refushWeixieList),this.addCustomEvent(425,this.refushcanPlayList),this.addEventTouchTap(this.list1,this.listTap),this.addEventTouchTap(this.list2,this.listTap),this.addEventTouchTap(this.btn,this.onTap),this.addEventTouchTap(this.palaceFlag,this.onTap),this.addEventTouchTap(this.help,this.onTap),this.addEventTouchTap(this.mon,this.onTap),this.addEventTouchTap(this.guid2,this.onTap),this.addEventTouchTap(this.taskTraceBtn,this.onTap),this.addCustomEvent(414,this.refushFlagStatu),this.addCustomEvent(415,this.hudunChange),this.addCustomEvent(426,this.rankListChange),this.addCustomEvent(427,this.refushGuildNum),this.addCustomEvent(409,this.doorStatuChange),this.addCustomEvent(422,this.showSkill),this.addCustomEvent(472,this.updateHP),this.addCustomEvent(363,this.updateTarget),this.addEventTouchTap(this.ruleDesc,this.onTap),this.belongGroup.visible=!1,this.ruleDesc.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("guilPlayFunc")),this.refushShowInfo(),this.refushPoint(),this.cityOwnChange(),this.refushWeixieList(),this.refushcanPlayList(),this.rankListChange(),this.doorStatuChange(),this.refushFlagStatu(),this.refushGuildNum()},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().isShow("UnionWarReliveView")&&UIMgr.ins().close("UnionWarReliveView"),UIMgr.ins().isShow("TargetPlayerBigBloodView")&&UIMgr.ins().close("TargetPlayerBigBloodView"),this.currAttackHandle=0,TimerMgr.ins().removeAll(this),DisplayUtils.removeFromParent(this.clickEffc),DisplayUtils.removeFromParent(this.pointEff),this.clearRendererItem()},e.prototype.refushShowInfo=function(){this.gongxun.visible=unionWarControl.getModel().checkinAppoint(2),this.mon.visible=unionWarControl.getModel().checkinAppoint(2),this.bar1.y=this.mon.visible?99:30,this.flagGroup.visible=unionWarControl.getModel().checkinAppoint(4),this.flag.visible=unionWarControl.getModel().checkinAppoint(4),this.flag.y=103,this.scene.text=unionWarControl.getModel().getNextMapName(0),this.guid.visible=unionWarControl.getModel().checkinAppoint(2)&&unionWarControl.getModel().getIntoNextMapGongxun()>unionWarControl.getModel().gongXun,this.guid.visible?(this.clickEffc.playFile(PATH_EFF+"tapCircle"),this.clickEffc.x=this.guid.x-23,this.clickEffc.y=this.guid.y+this.guid.height/2-5,this.addChild(this.clickEffc)):DisplayUtils.removeFromParent(this.clickEffc);var t=unionWarControl.getModel().getMapLevelInfo();this.sceneBar.value=100*(t.id-1),this.weijihuo1.visible=!(t.id>=1),this.jihuo1.visible=t.id>=1,this.weijihuo2.visible=!(t.id>=2),this.jihuo2.visible=t.id>=2,this.weijihuo3.visible=!(t.id>=3),this.jihuo3.visible=t.id>=3,this.hgweijihuo.visible=!(t.id>=4),this.hgjh.visible=t.id>=4,this.Nextdianqian.visible=!1,this.Nextchengnei.visible=1==t.id,this.Nexthuanggong.visible=3==t.id,this.Nextchengnei0.visible=3==t.id,4==t.id&&(this.Nextdianqian.visible=!0),this.refreshLastTime(),TimerMgr.ins().doTimer(1e3,unionWarControl.getModel().acEndTime,this.refreshLastTime,this)},e.prototype.refreshLastTime=function(){this.lastTime.text=DateUtils.getFormatTimeByStyle(unionWarControl.getModel().acEndTime,DateUtils.STYLE_4)},e.prototype.refushGuildNum=function(){this.comNum.text=unionWarControl.getModel().guildNum+LangMgr.getValueByKey("guilPeople")},e.prototype.refushPoint=function(){this.guildPoint.text=unionWarControl.getModel().guildPoint+"",this.ownPoint.text=unionWarControl.getModel().ownPoint+"",this.point.text=unionWarControl.getModel().gongXun+"/"+unionWarControl.getModel().getIntoNextMapGongxun();var t=unionWarControl.getModel().getMapLevelInfo();unionWarControl.getModel().gongXun>=unionWarControl.getModel().getIntoNextMapGongxun()?2==t.id&&(this.Nextdianqian.visible=!0,this.point.visible=!1,this.gongxun.visible=!1):4!=t.id&&(this.Nextdianqian.visible=!1,this.point.visible=!0),this.refushPointReward(),this.doorStatuChange()},e.prototype.refushPointReward=function(){var t=unionWarControl.getModel().getMyPointReward();if(t){this.taskTraceName0.y=16;var e=LangMgr.getValueByKey("guilScoreAim")+"\r"+unionWarControl.getModel().ownPoint+"/"+t.integral;e+=unionWarControl.getModel().pointInfo.isCan?StringUtils.addColor(LangMgr.getValueByKey("guilFinsh"),"#35e62d"):"",this.taskTraceName0.textFlow=(new egret.HtmlTextParser).parser(e),t.award[0],unionWarControl.getModel().pointInfo.isCan?(this.taskTraceBtn.visible=!0,this.pointEff.playFile(PATH_EFF+"actIconCircle",-1),this.taskTraceBtn.addChild(this.pointEff)):DisplayUtils.removeFromParent(this.pointEff)}else this.taskTraceAwards0.visible=!1,DisplayUtils.removeFromParent(this.pointEff),this.taskTraceBtn.visible=!1;this.scorePoint.visible=this.pointEff.parent?!0:!1},e.prototype.cityOwnChange=function(){this.guildName.text=""==unionWarControl.getModel().cityOwn?LangMgr.getValueByKey("clanEmptyJob"):unionWarControl.getModel().cityOwn},e.prototype.refushWeixieList=function(t){void 0===t&&(t=0),this.list2.dataProvider=new eui.ArrayCollection(unionWarControl.getModel().weixieList),1==t&&this.refushcanPlayList(),this.weixie.visible=unionWarControl.getModel().checkinAppoint(2,!0)&&unionWarControl.getModel().weixieList.length>0},e.prototype.refushcanPlayList=function(t){t=t||unionWarControl.getModel().canPlayList,this.list1.dataProvider=new eui.ArrayCollection(t),this.attList.visible=unionWarControl.getModel().checkinAppoint(2,!0)&&(t.length>0||this.mon.visible)},e.prototype.doorStatuChange=function(){this.Nextchengnei.enabled=unionWarControl.getModel().doorDie},e.prototype.rankListChange=function(){for(var t,e=unionWarControl.getModel().rankList,i=0;3>i;i++)t=e[i],t?(this["rankName"+(i+1)].text=t.name,this["rankPoint"+(i+1)].text=t.point+""):(this["rankName"+(i+1)].text=LangMgr.getValueByKey("notAvailable"),this["rankPoint"+(i+1)].text="0")},e.prototype.refushFlagStatu=function(){if(TimerMgr.ins().remove(this.runTime,this),this.hudun1.visible=!1,0==unionWarControl.getModel().flagStatu?(this.clearTimeBar(),this.runTime(),TimerMgr.ins().doTimer(1e3,unionWarControl.getModel().endTime,this.runTime,this)):1==unionWarControl.getModel().flagStatu?(this.clearTimeBar(),this.timeDesc.text=LangMgr.getValueByKey("guilCanGetHQ")):(this.runTime(),this.bloodBar.maximum=DataCenter.ins().UnionBattleConstConfig.gatherTime,TimerMgr.ins().doTimer(1e3,unionWarControl.getModel().endTime,this.runTime,this),this.hudun1.visible=!0),this.palaceFlag.enabled=1==unionWarControl.getModel().flagStatu,this.flagStatu.visible=2==unionWarControl.getModel().flagStatu&&!this.flagGroup.visible,this.flagStatu.visible){var t=egret.Tween.get(this.flagStatu);this.flagStatu.x=480,t.to({x:106},500).call(function(){},this)}},e.prototype.clearTimeBar=function(){this.bloodBar.maximum=0,this.bloodBar.value=0,this.bloodBar.labelFunction=function(){return""}},e.prototype.hudunChange=function(t){this.hudun.maximum=t[1],this.hudun.value=t[0],this.hudun.labelFunction=function(){return Math.ceil(100*t[0]/t[1])+"%"}},e.prototype.runTime=function(){if(--unionWarControl.getModel().endTime,unionWarControl.getModel().endTime>=0)if(2!=unionWarControl.getModel().flagStatu)this.timeDesc&&(this.timeDesc.text=LangMgr.getValueByKey("guildTips5",Math.floor(unionWarControl.getModel().endTime/60),unionWarControl.getModel().endTime%60));else if(this.timeDesc&&(this.timeDesc.text=LangMgr.getValueByKey("guildTips6",unionWarControl.getModel().flagName)),this.bloodBar.value=unionWarControl.getModel().endTime,this.bloodBar.labelFunction=function(){return LangMgr.getValueByKey("guildTips7",Math.floor(unionWarControl.getModel().endTime/60),unionWarControl.getModel().endTime%60)},this.flagStatu.visible){var t=LangMgr.getValueByKey("guildTips8",unionWarControl.getModel().flagName,Math.floor(unionWarControl.getModel().endTime/60),unionWarControl.getModel().endTime%60);this.flagTime&&(this.flagTime.textFlow=(new egret.HtmlTextParser).parser(t)),this.guildName1&&(this.guildName1.text=LangMgr.getValueByKey("auctionPart1")+unionWarControl.getModel().flagGuild)}unionWarControl.getModel().endTime<=0&&TimerMgr.ins().remove(this.runTime,this)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.Nextchengnei:case this.Nextchengnei0:case this.Nextdianqian:case this.Nexthuanggong:if(""!=unionWarControl.getModel().killName)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips9"));if(unionWarControl.getModel().getIntoNextMapGongxun()>unionWarControl.getModel().gongXun)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips10"));if(!unionWarControl.getModel().doorDie)return void tipsControl.showTips(LangMgr.getValueByKey("guildTips11"));var e=1;t.currentTarget==this.Nextchengnei||t.currentTarget==this.Nextchengnei0?e=2:t.currentTarget==this.Nextdianqian?e=3:t.currentTarget==this.Nexthuanggong&&(e=4),UIMgr.ins().open(UnionWarReliveView,1,e);break;case this.seeRank:UIMgr.ins().open(UnionWarRewardView);break;case this.seeMyGuild:UIMgr.ins().open(UnionWarMemView);break;case this.btn:"down"==this.btn.currentState?this.refushcanPlayList([]):this.refushcanPlayList();break;case this.palaceFlag:0!=unionWarControl.getModel().flagStatu?unionWarControl.upStartGetFlag():tipsControl.showTips(LangMgr.getValueByKey("guildTips12"));break;case this.mon:this.clickEffc.playFile(PATH_EFF+"tapCircle",1),this.addChild(this.clickEffc),gameControl.dispatchChangeAttrPoint(0),this.guid.visible=!1;break;case this.help:HelpControl.openHelpWin(7);break;case this.taskTraceBtn:unionWarControl.getModel().pointInfo.isCan&&unionWarControl.upPointReward();break;case this.guid2:UIMgr.ins().open(UnionWarTipsView)}},e.prototype.listTap=function(t){if(t.target.parent instanceof UnionWarMemberHeadItemRender){var e=t.target.parent;if(e.showEffect(),!unionWarControl.getModel().canClick)return;if(unionWarControl.getModel().flagAcId==ActorControl.actorID)return void warnControl.show(LangMgr.getValueByKey("guildTips13"),function(){gameControl.dispatchChangeAttrPoint(e.data),UnitShowMgr.ins().showHideSomeOne(e.data)},this);gameControl.dispatchChangeAttrPoint(e.data),this.guid.visible&&DisplayUtils.removeFromParent(this.clickEffc),this.guid.visible=!1,unionWarControl.getModel().attHandle!=e.data&&UnitShowMgr.ins().showHideSomeOne(e.data)}},e.prototype.clearRendererItem=function(){for(var t=this.list1.numChildren,e=0;t>e;e++){var i=this.list1.getChildAt(e);i.clearEffect()}t=this.list2.numChildren;for(var e=0;t>e;e++){var i=this.list2.getChildAt(e);i.clearEffect()}},e.prototype.showSkill=function(t){if(!t)return egret.Tween.removeTweens(this.lzlabel),egret.Tween.removeTweens(this.skillGroup),void(this.skillGroup.visible=!1);this.skillGroup.visible&&(egret.Tween.removeTweens(this.lzlabel),egret.Tween.removeTweens(this.skillGroup)),this.skillGroup.visible=!0,this.skillGroup.alpha=1,this.lzlabel.scaleX=this.lzlabel.scaleY=1,this.lzlabel.text=t+"";var e=this;egret.Tween.get(this.lzlabel).to({scaleX:2,scaleY:2},200).to({scaleX:1,scaleY:1},100).call(function(){egret.Tween.get(e.skillGroup).wait(1e3).to({alpha:0},1e3).call(function(){egret.Tween.removeTweens(e.lzlabel),egret.Tween.removeTweens(e.skillGroup),e.skillGroup.visible=!1})})},e.prototype.updateTarget=function(){var t=unionWarControl.getModel().getMapLevelInfo();if(1==t.id?this.belongGroup.visible=!1:this.belongGroup.visible=!0,0==gameControl.currAttackHandle&&(this.belongGroup.visible=!1),0!=gameControl.currAttackHandle&&this.currAttackHandle!=gameControl.currAttackHandle){this.currAttackHandle=gameControl.currAttackHandle;var e=void 0,i=UnitMgr.ins().getEntitysBymasterhHandle(this.currAttackHandle,1);if(i&&i.length>0){e=i[0].infoModel;var o=e.name,n=o.split("\n");o=n[1]?n[1]:n[0],this.belongNameTxt0.textFlow=TextUtils.generateTextFlow(o),this.roleHead0.source="yuanhead"+e.job+e.sex,this.changeHp()}}this.belongGroup.visible&&this.changeHp()},e.prototype.updateHP=function(t){var e=t[0];t[1],t[2],t[3],e&&e.infoModel.masterHandle==this.currAttackHandle&&this.changeHp()},e.prototype.changeHp=function(){var t=UnitMgr.ins().getEntitysBymasterhHandle(this.currAttackHandle,1);if(t&&t.length>0){for(var e=t.length,i=0,o=0,n=0,r=0,a=0;e>a;a++){var s=t[a];if(s){var l=s.infoModel.getAtt(0)||0,h=s.infoModel.getAtt(2)||0;i+=l,o+=h;var u=s.infoModel.getAtt(25)||0,c=s.infoModel.getAtt(26)||0;n+=u,r+=c}}this.neigongBar1.maximum=r,this.neigongBar1.value=n,this.bloodBar1.maximum=o,this.bloodBar1.value=i,0>=i&&(this.belongGroup.visible=!1)}},e}(BaseEuiView);__reflect(UnionWarUiInfoView.prototype,"UnionWarUiInfoView");var MemberItem3Render=function(t){function e(){var e=t.call(this)||this;return e.chooseNum=1,e.skinName="MemberItem3Skin",e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.data instanceof SelectInfoData){var t=this.data;this.job.textFlow=(new egret.HtmlTextParser).parser("["+LangMgr.getValueByKey("officeName"+t.data.office)+"]"),this.nameLable.text=t.data.name,this.payNum.text=""+t.num,this.attr.text=""+t.data.attack,this.face.source="head_"+t.data.job+t.data.sex,this.headBg.source="touxiangkuang"+t.data.sex}this.checkBoxs.selected=!1,this.btn1.visible=this.btn2.visible=this.num1.visible=this.inputBg.visible=!1},e}(BaseItemRender);__reflect(MemberItem3Render.prototype,"MemberItem3Render");var PersonRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="PersonRewardItemSkin",e.itemList.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){this.desc.text=+this.data.integral+"",this.itemList.dataProvider=new eui.ArrayCollection(this.data.award)},e}(BaseItemRender);__reflect(PersonRewardItemRender.prototype,"PersonRewardItemRender");var SelectRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.index=0,e.skinName="SelectRewardItemSkin",e.list.itemRenderer=UnionWarMemberHeadItemRender,e.addEventTouchTap(e.leftBtn,e.onTap),e.addEventTouchTap(e.rightBtn,e.onTap),e.addEventTouchTap(e.choosePeople,e.onTap),e}return __extends(e,t),e.prototype.dataChanged=function(){var t=unionWarControl.getModel().creatGuildRankReward(unionWarControl.getModel().guildWarRank,this.itemIndex);this.goods.data=t[0],this.boxname.text=DataCenter.ins().ItemConfig[t[0].id].name,this.sendNum=unionWarControl.getModel().getCanSendNumByRank(this.itemIndex);var e=unionWarControl.getModel().getSelectDataByIndex(this.itemIndex),i=0;if(e.length>0)for(var o in e)i+=e[o].num;this.chooseNum.text=i+"/"+this.sendNum,this.list.dataProvider=new eui.ArrayCollection(e)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.choosePeople:unionWarControl.getModel().rewardIndex=this.itemIndex,UIMgr.ins().open(SelectMemberView,this.itemIndex,this.sendNum);break;case this.rightBtn:var e=this.list.layout.gap;if(this.list.numChildren<=0)return;var i=this.list.getChildAt(0);if(!i)return;var o=i.width+e,n=Math.ceil(this.list.width/o);if(this.index=Math.ceil(this.list.scrollH/o),this.index+n>=this.list.numElements)return;this.index++,egret.Tween.removeTweens(this.list);var r=egret.Tween.get(this.list);r.to({scrollH:o*this.index},100);break;case this.leftBtn:if(e=this.list.layout.gap,this.list.numChildren<=0)return;if(i=this.list.getChildAt(0),!i)return;if(o=i.width+e,n=Math.ceil(this.list.width/o),this.index=Math.ceil(this.list.scrollH/o),this.index<=0)return;this.index--,egret.Tween.removeTweens(this.list),r=egret.Tween.get(this.list),r.to({scrollH:o*this.index},100)}},e}(BaseItemRender);__reflect(SelectRewardItemRender.prototype,"SelectRewardItemRender");var UnionInteRankItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionInteRankItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.rank.text=this.itemIndex+1+"",this.guildName.text=this.data.guildName,this.guildOwn.text=this.data.ownName,this.point.text=this.data.guildPoint},e}(BaseItemRender);__reflect(UnionInteRankItemRender.prototype,"UnionInteRankItemRender");var UnionInteRewardItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionInteRewardItemSkin",e.list.itemRenderer=ItemBase,e}return __extends(e,t),e.prototype.dataChanged=function(){this.itemIndex<3?(this.numImg.visible=!0,this.rankLabel.visible=!1,this.numImg.source="guildpaihang"+(this.itemIndex+1)):(this.numImg.visible=!1,this.rankLabel.visible=!0,this.rankLabel.text=LangMgr.getValueByKey("ranking",this.itemIndex+1)),this.data.rank?this.list.dataProvider=new eui.ArrayCollection(this.data.award):this.list.dataProvider=new eui.ArrayCollection(unionWarControl.getModel().creatGuildRankReward(this.data))},e}(BaseItemRender);__reflect(UnionInteRewardItemRender.prototype,"UnionInteRewardItemRender");var UnionWarMemberHeadItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionWarMemberHeadItemSkin",e.clickEffc=new GameMovieClip,e.clickEffc.x=52,e.clickEffc.y=37,e}return __extends(e,t),e.prototype.dataChanged=function(){if(this.haveGuildName(!1),isNaN(this.data))this.data instanceof SelectInfoData&&(this.currentState="panel",this.num.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("part",this.data.num)),this.roleName.textFlow=(new egret.HtmlTextParser).parser(this.data.data.name),this.roleHead.source="yuanhead"+this.data.data.job+this.data.data.sex);else{this.currentState="war";var t=UnitMgr.ins().getEntityBymasterhHandle(this.data);if(t){var e=t.infoModel,i=e.guildName?"\n<font color='#6495ed'>"+e.guildName+"</font>":"",o=devildomControl.isDevildomBattle&&i?e.name+i:e.getNameWithServer2();o.indexOf("\n")>-1&&this.haveGuildName(!0),this.roleName.textFlow=(new egret.HtmlTextParser).parser(o),this.roleHead.source="yuanhead"+e.job+e.sex,unionWarControl.getModel().attHandle&&unionWarControl.getModel().attHandle==this.data&&this.addAttEffect()}else this.roleName.textFlow=(new egret.HtmlTextParser).parser(LangMgr.getValueByKey("tipsDead"))}},e.prototype.addAttEffect=function(){this.attEffect||(this.attEffect=new GameMovieClip,this.attEffect.x=49,this.attEffect.y=28),this.attEffect.playFile(PATH_EFF+"FightingEff",-1),this.addChild(this.attEffect)},e.prototype.removeAttEffect=function(){this.attEffect&&(this.attEffect.stop(),this.attEffect.destroy(),this.attEffect=null)},e.prototype.showEffect=function(){this.clickEffc.playFile(PATH_EFF+"tapCircle",1),this.addChild(this.clickEffc)},e.prototype.clearEffect=function(){DisplayUtils.removeFromParent(this.clickEffc),DisplayUtils.removeFromParent(this.attEffect)},e.prototype.haveGuildName=function(t){t?(this.namebg.height=45,this.height=110):(this.namebg.height=26,this.height=98)},e}(BaseItemRender);__reflect(UnionWarMemberHeadItemRender.prototype,"UnionWarMemberHeadItemRender");var UnionWarMemListItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionWarMemListItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.face.source="head_"+this.data.job+this.data.sex,this.nameLab.text="["+LangMgr.getValueByKey("officeName"+this.data.office)+"]",this.nameLab0.text=this.data.myName,this.conLab.text=this.data.point+"",this.attack.text=this.data.attr+"",this.onLine.text=""==this.data.mapName?LangMgr.getValueByKey("tipsDragoneCity"):this.data.mapName},e}(BaseItemRender);__reflect(UnionWarMemListItemRender.prototype,"UnionWarMemListItemRender");var PersonalInteRankInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="PersonalInteRankInfoPanelSkin",e.name=LangMgr.getValueByKey("individualRank"),e.list.itemRenderer=UnionInteRankItemRender,e.data=new eui.ArrayCollection([]),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.dataProvider=this.data,this.addCustomEvent(411,this.refushList),unionWarControl.upOwnGuildRank(),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap)},e.prototype.onTap=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.refushList=function(t){this.data.replaceAll(t)},e}(BasePanel);__reflect(PersonalInteRankInfoPanel.prototype,"PersonalInteRankInfoPanel");var PersonInteRewardInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="PersonInteRewardInfoPanelSkin",e.name=LangMgr.getValueByKey("individualWords"),e.list.itemRenderer=PersonRewardItemRender,e.list1.itemRenderer=UnionInteRewardItemRender,e.dataArr=new eui.ArrayCollection,e.dataArr1=new eui.ArrayCollection,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!this.dataList){this.dataList=[];var i=DataCenter.ins().UnionBattlePerAwardConfig;for(var o in i)this.dataList.push(i[o])}if(this.dataArr.source=this.dataList,this.list.dataProvider=this.dataArr,!this.dataList1){this.dataList1=[];var i=DataCenter.ins().UnionBattlePerRankAwardConfig;for(var o in i)this.dataList1.push(i[o])}this.dataArr1.source=this.dataList1,this.list1.dataProvider=this.dataArr1,this.fgClose&&this.addEventTouchEnd(this.fgClose,this.close)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(this)},e}(BasePanel);__reflect(PersonInteRewardInfoPanel.prototype,"PersonInteRewardInfoPanel");var UnionInteRankInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionInteRankInfoPanelSkin",e.name=LangMgr.getValueByKey("clanRank"),e.list.itemRenderer=UnionInteRankItemRender,e.data=new eui.ArrayCollection([]),e.model=unionWarControl.getModel(),e.lastName.text=e.model.isWatStart?LangMgr.getValueByKey("clanTimeRank"):LangMgr.getValueByKey("clanLastRank"),e.lastNameJie.text=e.model.isWatStart?LangMgr.getValueByKey("clanTimeResults"):LangMgr.getValueByKey("clanLastresults"),e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.list.dataProvider=this.data,this.addCustomEvent(429,this.refushList),unionWarControl.upGuildRank(),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap)},e.prototype.onTap=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeCustomEvents()},e.prototype.refushList=function(){this.data.replaceAll(this.model.guildRankList),this.model.guildRankList.length>0?this.guildName.text=this.model.guildRankList[0].guildName:this.guildName.text=LangMgr.getValueByKey("clanEmptyJob")},e}(BasePanel);__reflect(UnionInteRankInfoPanel.prototype,"UnionInteRankInfoPanel");var UnionInteRewardInfoPanel=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnionInteRewardInfoPanelSkin",e.name=LangMgr.getValueByKey("clanRewards"),e.dataArr=new eui.ArrayCollection,e.dataArr1=new eui.ArrayCollection,e.itemList.itemRenderer=ItemBase,e.list1.itemRenderer=UnionInteRewardItemRender,e}return __extends(e,t),e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=unionWarControl.getModel().creatGuildRewardList();this.dataArr1.source=i,this.list1.dataProvider=this.dataArr1;var o=DataCenter.ins().UnionBattleConstConfig.occupationAward;this.dataArr.source=o,this.itemList.dataProvider=this.dataArr,this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap)},e.prototype.onTap=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];UIMgr.ins().close(this)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.dataArr.source=null,this.dataArr1.source=null},e}(BasePanel);__reflect(UnionInteRewardInfoPanel.prototype,"UnionInteRewardInfoPanel");var RedBagDetailsView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RedBagDetailsViewSkin",this.list.itemRenderer=RedBagItemRender,this.effect=new GameMovieClip,this.effect.x=244,this.effect.y=300},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.bgClose,this.onTap),this.num.text=unionWarControl.getModel().robYbNum+"",this.list.dataProvider=new eui.ArrayCollection(unionWarControl.getModel().rebList),t[0]&&(this.effect.playFile(PATH_EFF+"yanhuaeff",1),this.addChild(this.effect))},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.bgClose,this.onTap),DisplayUtils.removeFromParent(this.effect)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(e)}},e}(BaseEuiView);__reflect(RedBagDetailsView.prototype,"RedBagDetailsView");var RedBagView=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="RedBagViewSkin",this.model=unionWarControl.getModel(),this.num1.restrict="0-9",this.num2.restrict="0-9"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.rob,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.send,this.onTap),this.addEventTouchTap(this.btn1,this.onTap),this.addEventTouchTap(this.btn2,this.onTap),this.addEventTouchTap(this.btn3,this.onTap),this.addEventTouchTap(this.btn4,this.onTap),this.addEventTouchTap(this.btn5,this.onTap),this.addEventTouchTap(this.btn6,this.onTap),this.addEventChange(this.num1,this.onTxtChange),this.addEventChange(this.num2,this.onTxtChange),this.model.canRod?(this.currentState="rob",this.refushInfo()):(this.currentState="send",this.refushSendInfo())},e.prototype.onTxtChange=function(t){var e=this,i=1;switch(t.currentTarget){case this.num1:i=1;break;case this.num2:i=2}TimerMgr.ins().doTimer(500,1,function(){e.checkInputChange(i)},this)},e.prototype.checkInputChange=function(t){var e;switch(t){case 1:e=Number(this.num1.text),e>this.sendYBMaxNum&&(e=this.sendYBMaxNum),this.sendYb=e,this.num1.text=this.sendYb+"";break;case 2:e=Number(this.num2.text),e>this.sendMaxNum&&(e=this.sendMaxNum),this.sendNum=e,this.num2.text=this.sendNum+""}this.checkPercentage()},e.prototype.refushSendInfo=function(){this.sendYb=this.sendYBMaxNum=this.model.remainYB,this.sendMaxNum=this.sendNum=unionControl.getMemberNum(),this.price.setPrice(this.sendYb),this.num1.text=this.sendYb+"",this.num2.text=this.sendNum+""},e.prototype.refushInfo=function(){this.remainBag.text=this.model.remainRedNum+"/"+this.model.maxRedNum},e.prototype.onTap=function(t){switch(t.currentTarget){case this.bgClose:UIMgr.ins().close(e);break;case this.rob:unionWarControl.upRobRedBag();break;case this.send:unionWarControl.upSendRedBag(this.sendYb,this.sendNum);break;case this.btn1:--this.sendYb,this.sendYb<this.sendNum&&(this.sendYb=this.sendNum),this.num1.text=this.sendYb+"";break;case this.btn2:++this.sendYb,this.sendYb>this.sendYBMaxNum&&(this.sendYb=this.sendYBMaxNum),this.num1.text=this.sendYb+"";break;case this.btn3:--this.sendNum,this.sendNum<1&&(this.sendNum=1),this.num2.text=this.sendNum+"";break;case this.btn4:++this.sendNum,this.sendNum>this.sendMaxNum&&(this.sendNum=this.sendMaxNum),this.num2.text=this.sendNum+"";break;case this.btn5:this.sendYb=this.sendYBMaxNum,this.num1.text=this.sendYb+"";break;case this.btn6:this.sendNum=this.sendMaxNum,this.num2.text=this.sendNum+""}},e.prototype.checkPercentage=function(){this.sendYb<this.sendNum&&(this.sendYb=this.sendNum,this.num1.text=this.sendYb+"")},e}(BaseEuiView);__reflect(RedBagView.prototype,"RedBagView");var RedBagItemRender=function(t){function e(){var e=t.call(this)||this;return e.skinName="RedBagItemSkin",e}return __extends(e,t),e.prototype.dataChanged=function(){this.num.text=this.data.robNum,this.nameLabel.text=this.data.robName},e}(BaseItemRender);__reflect(RedBagItemRender.prototype,"RedBagItemRender");var WarnControl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.show=function(t,e,i,o,n,r,a){void 0===o&&(o=null),void 0===n&&(n=null),void 0===r&&(r="normal"),void 0===a&&(a="center");var s=warnControl.setWarnLabel(t,{func:e,thisObj:i},{func2:o,thisObj2:n},r,a);return s},e.prototype.showDangerWarn=function(t){ServerStorage.ins().getBitValue(ClientSetBit.playWarn)?(t(),DangerWarnView.sureCall&&(DangerWarnView.sureCall(),DangerWarnView.sureCall=null),DangerWarnView.cancelCall=null):DangerWarnView.show(t)},e.prototype.setWarnLabel=function(t,e,i,o,n){void 0===o&&(o="normal"),void 0===n&&(n="left");var r=UIMgr.ins().open(WarnView);return r.setWarnLabel(t,e,i,o,n),r},e.prototype.setBuyGoodsWarn=function(t,e){void 0===e&&(e=1);var i=UIMgr.ins().open(ShopWarnView);return i.setData(t,e),i},e}(BaseSystem);__reflect(WarnControl.prototype,"WarnControl");var DangerWarnView=function(t){function e(){var e=t.call(this)||this;return e.skinName="DangerWarnViewSkin",e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.show=function(t,i){if(UIMgr.ins().isShow(e)){var o=UIMgr.ins().getView(e);o.sureCallback=t,o.cancelCallback=i}else UIMgr.ins().open(e,t,i)},e.prototype.open=function(t,e){this.sureCallback=t,this.cancelCallback=e,this.addEventTouchTap(this.bgClose,this.onClick),this.addEventTouchTap(this.sureBtn,this.onClick),this.addEventTouchTap(this.cancelBtn,this.onClick),this.updateView()},e.prototype.onClick=function(t){switch(t.currentTarget){case this.bgClose:this.onCancel();break;case this.sureBtn:this.onSure();break;case this.cancelBtn:this.onCancel()}},e.prototype.onCancel=function(){this.cancelCallback&&(this.cancelCallback(),this.cancelCallback=null),e.cancelCall&&(e.cancelCall(),e.cancelCall=null),UIMgr.ins().close(this)},e.prototype.onSure=function(){this.hintState.selected&&ServerStorage.ins().setBitValue(ClientSetBit.playWarn,1),this.sureCallback&&(this.sureCallback(),this.sureCallback=null),e.sureCall&&(e.sureCall(),e.sureCall=null),UIMgr.ins().close(this)
},e.prototype.close=function(){e.cancelCall=null,e.sureCall=null},e.prototype.updateView=function(){this.hintState.selected=!1,this.text.text=DataCenter.ins().WorldBossBaseConfig.pktips},e}(BaseEuiView);__reflect(DangerWarnView.prototype,"DangerWarnView");var ShopWarnView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="ShopWarnViewSkin",this.gainList.itemRenderer=GainGoodsItem,this.countTxt.restrict="0-9",this.price.setType(2),this.totalPrice.setType(2),this.itemIcon.imgJob.visible=!1},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.decBtn,this.onTap),this.addEventTouchTap(this.addBtn,this.onTap),this.addEventTouchTap(this.dec10Btn,this.onTap),this.addEventTouchTap(this.add10Btn,this.onTap),this.addEventTouchTap(this.buyBtn,this.onTap),this.addEventTouchTap(this.topUpBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.addEventItemTap(this.gainList,this.onTouchList),this.addEventChange(this.countTxt,this.onTxtChange),this.addCustomEvent(197,this.buyCallBack)},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventItemTap(this.gainList,this.onTouchList),this.removeEventTouchTap(this.decBtn,this.onTap),this.removeEventTouchTap(this.addBtn,this.onTap),this.removeEventTouchTap(this.dec10Btn,this.onTap),this.removeEventTouchTap(this.add10Btn,this.onTap),this.removeEventTouchTap(this.buyBtn,this.onTap),this.removeEventTouchTap(this.topUpBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventChange(this.countTxt,this.onTxtChange)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.decBtn:this.setTotalPrice(this._totalNum-1);break;case this.addBtn:this.setTotalPrice(this._totalNum+1);break;case this.dec10Btn:this.setTotalPrice(this._totalNum-10);break;case this.add10Btn:this.setTotalPrice(this._totalNum+10);break;case this.buyBtn:ActorControl.yb>=this.totalPrice.getPrice()?storeControl.upBuy(1,[[this._goodsId,this._totalNum]]):(tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),UIMgr.ins().close(this));break;case this.topUpBtn:payControl.checkOpenWin()&&UIMgr.ins().close(e);break;case this.fgClose:case this.bgClose:UIMgr.ins().close(e)}},e.prototype.onTouchList=function(t){var i=t.item;if(null!=t.item){var o=UIMgr.ins().viewOpenCheck(i[1],i[2]);if(o){var n=!0;if("PayDailyView"==i[1]){var r=payControl.getRechargeData(0);r&&r.num||(n=!1,UIMgr.ins().open("PayFirstView"))}n&&""!=i[1]&&GuideControl.guidance(i[1],i[2],i[3]),UIMgr.ins().close(e),UIMgr.ins().close("BookUpView"),UIMgr.ins().close("WeaponSoulFacadePanel"),UIMgr.ins().close("WeaponSoulBreakView"),"HeirloomComposeView"!=i[1]&&UIMgr.ins().close("HeirloomComposeView"),"LadderView"==i[1]&&UIMgr.ins().close("IntensifyView"),"PortalView"==i[1]&&UIMgr.ins().close("StoreView")}}},e.prototype.buyCallBack=function(t){t>0?UIMgr.ins().close(e):(tipsControl.showTips(LangMgr.getValueByKey("userNoMony")),UIMgr.ins().close(this))},e.prototype.onTxtChange=function(t){var e=Number(this.countTxt.text);this.setTotalPrice(e)},e.prototype.setData=function(t,e){var i;if(t>2e4){var o=DataCenter.ins().ItemConfig[t];this.itemIcon.setData(o),this.nameTxt.text=""+o.name,this.nameTxt.textColor=ItemUtils.getQualityColor(o),i=storeControl.getStoreByItemId(t),this.titleTxt.text=LangMgr.getValueByKey("warnTips5")}else{switch(this.itemIcon.setData(null),t){case 1:this.itemIcon.imgIcon.source=Currency.getCurrencyRes(t),this.nameTxt.text=Currency.getCurrencyName(t),this.titleTxt.text=LangMgr.getValueByKey("warnTips6");break;case 4:this.itemIcon.imgIcon.source=Currency.getCurrencyRes(t),this.nameTxt.text=Currency.getCurrencyName(t),this.titleTxt.text=LangMgr.getValueByKey("warnTips7");break;case 7:this.itemIcon.imgIcon.source=Currency.getCurrencyRes(t),this.nameTxt.text=Currency.getCurrencyName(t),this.titleTxt.text=LangMgr.getValueByKey("warnTips8");break;case 8:this.itemIcon.imgIcon.source=Currency.getCurrencyRes(t),this.nameTxt.text=Currency.getCurrencyName(t),this.titleTxt.text=LangMgr.getValueByKey("warnTips9");break;case 14:this.itemIcon.imgIcon.source=Currency.getCurrencyRes(t),this.nameTxt.text=Currency.getCurrencyName(t),this.titleTxt.text=LangMgr.getValueByKey("warnTips10")}this.nameTxt.textColor=16758826}var n=DataCenter.ins().PropsGainConfig[t],r=0;n?(this.gainList.dataProvider=new eui.ArrayCollection(n.gainWay),r=60*n.gainWay.length):this.gainList.dataProvider=new eui.ArrayCollection([]),i?(this.nameTxt.textAlign="center",this._goodsId=i.id,this.price.setPrice(i.price),this.setTotalPrice(e)):(DisplayUtils.removeFromParent(this.goodsGroup),this.nameTxt.textAlign="center"),this.tipGroup.y=this.gainListGroup.height+this.gainListGroup.y+3},e.prototype.setTotalPrice=function(t){0>=t?this._totalNum=1:t>=1e4?this._totalNum=9999:this._totalNum=t,this.countTxt.text=this._totalNum+"",this.totalPrice.setPrice(this._totalNum*this.price.getPrice())},e}(BaseEuiView);__reflect(ShopWarnView.prototype,"ShopWarnView");var WarnView=function(t){function e(){var e=t.call(this)||this;return e.uilayer=GameLayer.POPUP,e}return __extends(e,t),e.prototype.initUI=function(){t.prototype.initUI.call(this),this.skinName="WarnViewSkin"},e.prototype.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.addEventTouchTap(this.sureBtn,this.onTap),this.addEventTouchTap(this.notBtn,this.onTap),this.addEventTouchTap(this.bgClose,this.onTap),this.addEventTouchTap(this.cbx,this.onTap),this.fgClose&&this.addEventTouchEnd(this.fgClose,this.onTap),this.cbx.selected=daifugControl.autoTurnDice?!0:!1},e.prototype.close=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.removeEventTouchTap(this.sureBtn,this.onTap),this.removeEventTouchTap(this.notBtn,this.onTap),this.removeEventTouchTap(this.bgClose,this.onTap),this.removeEventTouchTap(this.cbx,this.onTap)},e.prototype.onTap=function(t){switch(t.currentTarget){case this.sureBtn:null!=this.callBack.func&&this.callBack.func.call(this.callBack.thisObj);break;case this.notBtn:case this.fgClose:case this.bgClose:this.calback2.func2&&this.calback2.func2.call(this.calback2.thisObj2);break;case this.cbx:daifugControl.autoTurnDice=t.currentTarget.selected}t.currentTarget!=this.cbx&&UIMgr.ins().close(e)},Object.defineProperty(e.prototype,"isShowWin",{get:function(){return this._isShowWin},set:function(t){this._isShowWin!=t&&(this._isShowWin=t)},enumerable:!0,configurable:!0}),e.prototype.setWarnLabel=function(t,e,i,o,n){void 0===i&&(i=null),void 0===o&&(o="normal"),void 0===n&&(n="left"),this.warnLabel.textFlow=TextUtils.generateTextFlow(t),this.callBack=e,this.calback2=i,this.currentState=o,this.warnLabel.textAlign=n},e.prototype.setBtnLabel=function(t,e){t&&(this.sureBtn.label=t),e&&(this.notBtn.label=e)},e.prototype.showUI=function(t,e,i,o){this.leftGroup.visible=!1,this.icon1.visible=!1,this.label1.visible=!1,this.rightGroup.visible=!1,this.icon2.visible=!1,this.label2.visible=!1,(t||e)&&(this.leftGroup.visible=!0,t&&(this.icon1.visible=!0,this.icon1.source=t),e&&(this.label1.visible=!0,this.label1.text=e)),(i||o)&&(this.rightGroup.visible=!0,i&&(this.icon2.visible=!0,this.icon2.source=i),o&&(this.label2.visible=!0,this.label2.text=o))},e}(BaseEuiView);__reflect(WarnView.prototype,"WarnView");var SocketConnection=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasShowReLoginWin=!1,e.disconnectTime=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.connect=function(t,e){DeviceUtils.IsWxMiniGame?this.connectSocket(t,e,GlobalModel.useWss):this.connectSocket(t,e,GlobalModel.isHttps&&GlobalModel.useWss)},e.prototype.onSocketConnected=function(){t.prototype.onSocketConnected.call(this),TimerMgr.ins().remove(this.reLogin,this),this.onConnectedCallback&&this.onConnectedCallback()},e.prototype.onSocketClose=function(t){if(t.data&&1006!=t.data.code&&1005!=t.data.code){var e="Code:"+t.data.code+",Reason:"+t.data.reason+",WasClean:"+t.data.wasClean;t.data.target&&(e+=",Url:"+t.data.target.url),ReportData.getIns().reportClientErrorLog("SocketClose",e)}debug.log("server disconnection!!! ip:"+this.host+" port:"+this.port),this.updateStatus(SocketConst.STATUS_DISCONNECT),TimerMgr.ins().remove(this.reLogin,this),crossFieldControl.closeSocket(),this.showReLoginWin()},e.prototype.connectError=function(t){var e="SocketError";isNaN(Number(t.data))||(e="Code:"+t.data),ReportData.getIns().reportClientErrorLog("SocketError",e),TimerMgr.ins().remove(this.reLogin,this),TimerMgr.ins().doTimer(1e3,1,this.reLogin,this)},e.prototype.reLogin=function(){this.close(),GlobalModel.checkClientVersion(this.loadGame)},e.prototype.onFinishCheck=function(t,e){t==SocketConst.STATUS_COMMUNICATION?(debug.log("connect server success！ip:"+this.host+" port:"+this.port),crossFieldControl.isCross?crossFieldControl.upKFLogin():this.sendCheckAccount()):t==SocketConst.STATUS_DISCONNECT&&debug.log("connect server close！ip:"+this.host+" port:"+this.port)},e.prototype.sendCheckAccount=function(){loginControl.upCheckAccount()},e.prototype.record=function(t){return GlobalModel.serverIP=null,GlobalModel.serverPort=null,"1"!=t.serverState?void alert(LangMgr.getValueByKey("serverState1")):t.isTestServer||"Test"!=GlobalModel.pf||GlobalModel.getUrlParamValue("isDebug")?(1==t.isvirtual&&(GlobalModel.setUrlParamValue("isHw",!0),(62==GlobalModel.gameId||70==GlobalModel.gameId)&&(GlobalModel.gameId=28),("62"==GlobalModel.pfid||"70"==GlobalModel.pfid)&&(GlobalModel.pfid="28")),GlobalModel.srvid=Number(t.serverId),GlobalModel.mainSrvid=Number(t.mainServerid),GlobalModel.srvname=t.serverName,GlobalModel.serverIP=t.serverIp,GlobalModel.serverPort=Number(t.serverPort),GlobalModel.isCreateRole=!t.actorid||String(t.actorid).length<=0,void Launcher.ins().loadConfig()):void alert(LangMgr.getValueByKey("serverState2"))},e.prototype.start=function(){GlobalModel.serverIP&&GlobalModel.serverPort&&(StartLoading.ins().showLoading(),e.ins().sendConnect(GlobalModel.serverIP,GlobalModel.serverPort),ReportData.getIns().reportPlayedServer())},e.prototype.showReLoginWin=function(){var t=this;if(StartLoading.ins().hideLoading(),!this.hasShowReLoginWin||!UIMgr.ins().isShow("WarnView")){this.hasShowReLoginWin=!0,this.disconnectTime=egret.getTimer();var e=function(){t.hasShowReLoginWin=!1,t.onClosedCallback&&t.onClosedCallback(),TimerMgr.ins().remove(t.reLogin,t),egret.getTimer()-t.disconnectTime>=6e3?t.reLogin():TimerMgr.ins().doTimer(6e3-(egret.getTimer()-t.disconnectTime),1,t.reLogin,t)};warnControl.show(LangMgr.getValueByKey("serverState3"),e,this,e,this,"sure")}},e.prototype.loadGame=function(){e.ins().newSocket(),e.ins().sendConnect(GlobalModel.serverIP,GlobalModel.serverPort)},e.prototype.sendConnect=function(t,i){e.ins().getSocket().connected?this.sendCheckAccount():(debug.log("connect to "+t+" ,port: "+i),this.connect(t,i))},e}(SocketBase);__reflect(SocketConnection.prototype,"SocketConnection");var CommonFun=function(){function t(){}return t.checkCurrency=function(t,e,i,o){switch(void 0===e&&(e=2),void 0===i&&(i=""),e){case 1:if(ActorControl.gold>=t)return!0;""==i&&(i=LangMgr.getValueByKey("bossMoneyEnought")),tipsControl.showTips(i);break;case 2:if(ActorControl.yb>=t)return!0;if(""==i&&(i=LangMgr.getValueByKey("osaNoMoney")),tipsControl.showTips(i),!crossFieldControl.isCross){var n=warnControl.show(LangMgr.getValueByKey("tipsTips3"),null,null,function(){payControl.checkOpenWin(),o&&"function"==typeof o&&o()});n.setBtnLabel(LangMgr.getValueByKey("cancel"),LangMgr.getValueByKey("artRenderer1"))}default:return debug.log("Money type error:",e),!1}return!1},t.checkBackpackCount=function(t,e){if(void 0===t&&(t=BackpackControl.BAG_ENOUGH),void 0===e&&(e=0),backpackControl.getSurplusCount()<t){switch(e){case 0:UIMgr.ins().open("BackpackFullTipsView",t);break;case 1:tipsControl.warnTips(LangMgr.getValueByKey("pactivityBag"))}return!1}return!0},t.checkLevel=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0);var o=!1,n=ActorControl.level;if(i&&(n=1e3*reincarnateControl.lv+ActorControl.level),o=n>=t,!o&&e)if(i){var r=t/1e3>>0,a=t%1e3;r>reincarnateControl.lv?tipsControl.warnTips(LangMgr.getValueByKey("commonFun1",r)):tipsControl.warnTips(LangMgr.getValueByKey("commonFun2",a))}else tipsControl.warnTips(LangMgr.getValueByKey("commonFun2",t));return o},t.checkVersion=function(t){t&&t()},t.viewItemTips=function(t,e){var i=DataCenter.ins().ItemConfig[t];if(i){var o=new ItemBase,n=1;Currency.getCurrencyRes(t)&&(n=0),o.data={id:t,type:n,count:e||1},o.onClick()}},t.dataToDropTag=function(t,e){return t.map(function(t){e.indexOf(t.id)>-1&&(t.isDrop=!0)},this),t},t.mergeRewardList=function(t){for(var e={},i=0;i<t.length;i++){var o=t[i];e[o.id]?e[o.id].count+=o.count:e[o.id]=o}return CommonUtils.objectToArrayShallow(e)},t.dropEff=function(t,e,i,o){if(void 0===o&&(o=0),e||(e=UnitMgr.ins().getNoDieRole()),0==o){for(var n=0;n<t.length;n++){var r=t[n];(0!=r.type||1==r.id||2==r.id||9==r.id)&&DropControl.addDrop([0!=DropControl.tempDropPoint.x?DropControl.tempDropPoint.x:Math.floor(e.x/MapControl.CELL_SIZE),0!=DropControl.tempDropPoint.y?DropControl.tempDropPoint.y:Math.floor(e.y/MapControl.CELL_SIZE),r])}DropControl.addCompleteFunc(i,this),DropControl.start(e)}},t.regKFBackFun=function(t,e){void 0===e&&(e=200);var i=this;if(!CrossServerSwitchView.backCloseFun){var o=function(){TimerMgr.ins().doTimer(e,1,t,i),CrossServerSwitchView.backCloseFun=null};CrossServerSwitchView.backCloseFun=o}},t.getMailAwards=function(t){var e=DataCenter.ins().EmailIdConfig[t];if(e){if(e.attachmentShow)return e.attachmentShow;if(e.attachment)return e.attachment}return[]},t.convertLevel=function(t){var e="",i=Math.floor(t/1e3);i&&(e+=LangMgr.getValueByKey("numberRotation",i));var o=t%1e3;return o&&(e+=LangMgr.getValueByKey("numberLevel",o)),e},t.getTargetValue=function(t,e){switch(t){case 0:return reincarnateControl.lv+1e3*ActorControl.level;case 1:return FeatherVo.getWingAllLevel();case 2:return RoleModel.getIntensifyTotalLvByType(2);case 3:return DragonSoulDataVo.getLongHunAllLevel();case 5:return bookControl.getBookPowerNumEx();case 6:return backpackControl.getEquipsScoreByRolesOfBody();case 7:var i=0,o=superRingControl.getSpecialRingDataById(GameConst.FIRE_RING_ID);return o&&o.level&&(i=o.level),i;case 8:return ActorControl.samsaraLv;case 9:return ashtarteControl.getZhanLingDataByLevel(isNaN(e)?0:e);case 10:return magicCircleControl.getPotentionTimes();case 11:return crazybtplayControl.getStrengthenLvAll();case 12:return ActorControl.power;case 13:return dominateEquipControl.getTotalScore();case 14:return runeControl.totalPower;case 15:return superRingControl.totalPower;case 16:return godWeaponControl.getMaxWeaponLv();case 17:return godWeaponControl.getActWeapon();case 18:return godWeaponControl.getGodItemQuality(isNaN(e)?2:e);case 19:return godWeaponControl.dunInfoData&&godWeaponControl.dunInfoData.listData?godWeaponControl.dunInfoData.listData.length:0;case 20:return beastControl.getCurBattle();case 21:return featherControl.getGodWingItem();case 22:return weaponsSoulControl.getWeaponsCount();case 23:var n=DataCenter.ins().AsTeamCopyConfig[copyControl.tfPassID];return n?n.id:0;case 24:return unionControl.guildID?1:0;case 25:return partnerControl.friendsList.length;case 26:return godWeaponControl.getWeaponTotalLv();case 27:return heroControl.subRolesLen}return 0},t.showTargetValue=function(t,e,i){switch(t){case 0:return 1e3>i?[e%1e3,i]:[e/1e3>>0,i/1e3>>0];default:return[e,i]}},t.showTaskValue=function(t,e,i){switch(t){case 83:return e=e>=i?1:0,i=1,[e,i];default:return[e,i]}},t.sortAwards=function(t){var e=function(t,e){var i=DataCenter.ins().ItemConfig[t.id],o=DataCenter.ins().ItemConfig[e.id],n=ItemUtils.getQuality(i),r=ItemUtils.getQuality(o);return SortUtils.sortDescByKey(n,r)};t.sort(e)},t.getMultInfo=function(t,e,i){void 0===e&&(e="day"),void 0===i&&(i="zsLevel");for(var o=GameServer.serverOpenDay+1,n=reincarnateControl.lv,r=null,a=0;a<t.length;a++){var s=t[a];if(e&&o<s[e])break;if(i&&n<s[i])break;r=s}return r},t.getWorldBossMultNum=function(t){var e=DataCenter.ins().WorldBossBaseConfig.multipleNum[t];return e&&GameServer.serverOpenDay+1>=e[0]?e[1]:1},t.flyItemToBag=function(t,e){if(!e){if(!t.parent)return;e={};var i=t.localToGlobal();e.parent=StageUtils.ins().getUIStage(),e.x=i.x+t.width/2,e.y=i.y+t.width/2}var o=new ItemBase;o.x=e.x,o.y=e.y,o.data=t.data,o.anchorOffsetX=o.width/2,o.anchorOffsetY=o.height/2,e.parent.addChild(o),gameControl.dispatchFlyItemEx(o)},t.openWin=function(t){if(t){var e=CommonUtils.copyDataHandler(t),i=e.shift();if(this.isCyberPuzzle(i))return void this.gotoQuanQia();(o=UIMgr.ins()).open.apply(o,[i].concat(e))}var o},t.isCyberPuzzle=function(t){return"CyberPuzzle"==t},t.gotoQuanQia=function(){return backpackControl.getSurplusCount()<BackpackControl.BAG_ENOUGH?(UIMgr.ins().closeTopLevel(),UIMgr.ins().open("BackpackFullTipsView")):copyControl.currentEnergy>=copyControl.energy?(UIMgr.ins().closeTopLevel(),copyControl.autoPk()):tipsControl.showTips(LangMgr.getValueByKey("powerInsufficient")),!1},t.getJobName=function(t){return LangMgr.getValueByKey("job"+(t+1))},t.andState=function(t){for(var e in t)if(1==t[e])return!0;return!1},t.show=function(t,e,i,o,n,r,a,s){void 0===n&&(n=!0),void 0===r&&(r=null),void 0===a&&(a=120),void 0===s&&(s=0),UIMgr.ins().open(ActivationView,t,e,i,o,n,r,a,s)},t.instanceofByName=function(t,e){return egret.getQualifiedClassName(t)==e},t.convertCfgLvToComLv=function(t,e){return 1e3*(e?e:0)+(t?t:1)},t}();__reflect(CommonFun.prototype,"CommonFun");var EgretModify=function(){function t(){}return t.modify=function(){"undefined"!=typeof generateEUI2?t.fixDefaultThm():(this.fixEXMLParser(),this.fixLoadThm(),this.fixComponentSkinName(),this.fixInputText(),this.fixHTML5StageText(),this.fixWebGLRenderContext(),this.fixWebGLRenderTarget())},t.fixCommonJs2ItemRenderer=function(){var t=eui.DataGroup.prototype.updateRenderer;eui.DataGroup.prototype.updateRenderer=function(e,i,o){var n=this.$DataGroup;if(n[11]=!0,null==o)return n[11]=!1,e;if(o instanceof Object){var r=!1;for(var a in o)if(o.hasOwnProperty(a)){r=!0;break}if(!r)return n[11]=!1,e}t.call(this,e,i,o)}},t.fixDefaultThm=function(){window.JSONParseClass.__proto__.createElementContentOrViewport=function(t,e){var i,o=this.getNormalizeEuiName(this.skinClass[t].className?this.skinClass[t].className:this.skinClass[t].$t);if("egret.tween.TweenGroup"==o)i=this.creatsEgretTweenGroup(t);else{var n=egret.getDefinitionByName(o),r=this.skinClass;this.$createNewObject(function(){i=new n,e&&r[t].className&&(i.isViewStackPanel=!0)}),this.addCommonProperty(t,i)}return this.target[t]=i,i},window.JSONParseClass.__proto__.applyState=function(){if(void 0!=this.skinClass.$s){var t=[];for(var e in this.skinClass.$s){var i=[],o=this.skinClass.$s[e];if(o.$saI)for(var n=0,r=o.$saI;n<r.length;n++){var a=r[n];i.push(new eui.AddItems(a.target,a.property,a.position,a.relativeTo))}if(o.$ssP)for(var s=0,l=o.$ssP;s<l.length;s++){var a=l[s];if(a.name){var h=a.value;if("scale9Grid"==a.name&&(h=this.getScale9Grid(a.value)),"string"==typeof h){var u=null,c=null;(u=h.match(/this._HorizontalLayout\d+$/))?c=u[0].replace("this.",""):(u=h.match(/this._VerticalLayout\d+$/))?c=u[0].replace("this.",""):(u=h.match(/this._TileLayout\d+$/))?c=u[0].replace("this.",""):(u=h.match(/this._BasicLayout\d+$/))&&(c=u[0].replace("this.","")),c&&(h=this.createLayout(c))}i.push(new eui.SetProperty(a.target,a.name,h))}else i.push(new eui.SetStateProperty(this.target,a.templates,a.chainIndex,this.target[a.target],a.property))}t.push(new eui.State(e,i))}this.target.states=t}},window.JSONParseClass.__proto__.addCommonProperty=function(t,e){var i,o,n=function(n){var a=r.skinClass[t][n];"$t"==n||("layout"==n?e[n]=r.createLayout(a):"$eleC"==n?i=a:"$sId"==n?o=a:"scale9Grid"==n?e[n]=r.getScale9Grid(a):"skinName"==n?r.$createNewObject(function(){if(e.isViewStackPanel){var t=e.__proto__;if(!t.__skinName_1){t.__skinName_1=a;var i=t.close;i&&(t.close_1=i,t.close=function(){this.skinName&&this.close_1()},i=null);var o=t.open;o&&(t.open_1=o,t.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$isInitSkin||this.$initSkin(),this.open_1.apply(this,t)},o=null);var r=t.childrenCreated;r&&(t.childrenCreated_1=r,t.childrenCreated=function(){},r=null),t.$initSkin,t.$initSkin=function(){this.skinName=this.__skinName_1,this.$isInitSkin=!0,this.childrenCreated_1()}}}else e[n]=a}):"itemRendererSkinName"==n?r.$createNewObject(function(){for(var t=a.split("."),i=window,o=0,r=t;o<r.length;o++){var s=r[o];i=i[s]}e[n]=i}):"itemRenderer"==n?e[n]=egret.getDefinitionByName(a):"dataProvider"==n?e[n]=r.createDataProvider(a):"viewport"==n?e[n]=r.createElementContentOrViewport(a):e[n]=a)},r=this;for(var a in this.skinClass[t])n(a);var s=[];if(i&&i.length>0)for(var l=0,h=i;l<h.length;l++){var u,c=h[l];u="$eV"==this.skinClass[t].$t?this.createElementContentOrViewport(c,!0):this.createElementContentOrViewport(c),s.push(u)}if(e.elementsContent=s,o&&o.length>0)for(var p=0,d=o;p<d.length;p++){var c=d[p];this.createElementContentOrViewport(c)}return e},window.JSONParseClass.__proto__.createDataProvider=function(t){if(""!=t){var e=this.createTypeObject(t),i=[];if(this.skinClass[t].source)for(var o=0,n=this.skinClass[t].source;o<n.length;o++){var r=n[o];i.push(this.createItemRender(r))}return e.source=i,e}}},t.fixEXMLParser=function(){var t=eui.sys.EXMLParser;t.prototype.getOverrideClassNameOfNode=function(t){if(t.attributes&&t.attributes.className){var e=egret.getDefinitionByName(t.attributes.className);if(e)return t.parent&&"ViewStack"==t.parent.localName&&t.attributes.skinName&&(this.addInitSkin(e,t.attributes.skinName),delete t.attributes.skinName),t.attributes.className}return this.getClassNameOfNode(t)},t.prototype.addInitSkin=function(t,e){var i=t.prototype;if(!i.__skinName_1){i.__skinName_1=e;var o=i.close;o&&(i.close_1=o,i.close=function(){this.skinName&&this.close_1()},o=null);var n=i.open;n&&(i.open_1=n,i.open=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.$isInitSkin||this.$initSkin(),this.open_1.apply(this,t)},n=null);var r=i.childrenCreated;r&&(i.childrenCreated_1=r,i.childrenCreated=function(){},r=null),i.$initSkin,i.$initSkin=function(){this.skinName=this.__skinName_1,this.$isInitSkin=!0,this.childrenCreated_1()}}},t.prototype.createFuncForNode=function(t){var e=t.localName,i=this.isBasicTypeData(e);if(i)return this.createBasicTypeForNode(t);var o=this.getOverrideClassNameOfNode(t),n=new eui.sys.EXFunction,r="_i",a=t.attributes.id;n.name=a+r,this.currentClass.addFunction(n);var s=new eui.sys.EXCodeBlock;n.codeBlock=s;var l="t";"Object"==e?s.addVar(l,"{}"):s.addVar(l,"new "+o+"()");var h=!!this.currentClass.getVariableByName(a);h&&s.addAssignment("this."+a,l),this.addAttributesToCodeBlock(s,l,t),this.initlizeChildNode(t,s,l);var u=this.delayAssignmentDic[a];if(u)for(var c=u.length,p=0;c>p;p++){var d=u[p];s.concat(d)}return s.addReturn(l),"this."+n.name+"()"};var e=t.prototype.formatValue;t.prototype.formatValue=function(t,i,o){return"itemRendererSkinName"==t?this.formatString(i):e.call(this,t,i,o)};var i=1;t.prototype.parse=function(t){var e=null;e=egret.XML.parse(t);var o=!1,n="";e.attributes["class"]?(n=e.attributes["class"],delete e.attributes["class"],o=!!n):n="$exmlClass_"+i++;var r=this.parseClass(e,n),a=r.toCode(),s=null,l=eval;if(s=l(a),o&&s){egret.registerClass(s,n);for(var h=n.split("."),u=h.length,c=__global,p=0;u-1>p;p++){var d=h[p];c=c[d]||(c[d]={})}c[h[u-1]]||(c[h[u-1]]=s)}return e=void 0,n=void 0,a=void 0,r=void 0,l=void 0,t=void 0,s},t=void 0},t.fixLoadThm=function(){var e=t.exmlsDic={},i=function(t,i){var o=i.match(/ class="([^"]*)"/i);e[o[1]]={path:t,content:i}};eui.Theme.prototype.onConfigLoaded=function(e){var o;if(e)try{o=JSON.parse(e)}catch(n){alert("Skin parse error!")}if(!o)return void alert("Skins load fail，Please check the network login again");if(o&&o.skins)for(var r=this.skinMap,a=o.skins,s=Object.keys(a),l=s.length,h=0;l>h;h++){var u=s[h];r[u]||this.mapSkin(u,a[u])}o.styles&&(this.$styles=o.styles),o.exmls&&0!=o.exmls.length?o.exmls[0].gjs?(o.exmls.forEach(function(t){return EXML.$parseURLContentAsJs(t.path,t.gjs,t.className)}),this.onLoaded()):o.exmls[0].content?(o.exmls.forEach(function(t){return i(t.path,t.content)}),t.preParserExml(),this.onLoaded()):EXML.$loadAll(o.exmls,this.onLoaded,this,!0):this.onLoaded()}},t.fixComponentSkinName=function(){var e=eui.Component.prototype.$parseSkinName;eui.Component.prototype.$parseSkinName=function(){var i=this.skinName;"string"==typeof i&&t.parseSkinName(i),e.call(this)}},t.parseSkinName=function(e){var i=t.exmlsDic;if(i&&i.hasOwnProperty(e)){var o=i[e];delete i[e],EXML.$parseURLContent(o.path,o.content)}},t.preParserExml=function(){for(var e=["skins.ButtonSkin","skins.CheckBoxSkin","skins.HScrollBarSkin","skins.HSliderSkin","skins.ItemRendererSkin","skins.PanelSkin","skins.ProgressBarSkin","skins.RadioButtonSkin","skins.ScrollerSkin","skins.TextInputSkin","skins.ToggleSwitchSkin","skins.VScrollBarSkin","skins.VSliderSkin","PortalViewSkin","GameSceneViewSkin","GameBottomViewSkin"],i=0,o=e;i<o.length;i++){var n=o[i];t.parseSkinName(n)}},t.fixInputText=function(){if(DeviceUtils.IsIPhone){var t=0,e=function(){var e=document.body.scrollHeight;e>=t-50&&(50>=t?document.body.scrollTop=e:document.body.scrollTop=e-t+50)},i=function(){document.body.scrollTop&&(document.body.scrollTop=0)},o=egret.web.HTMLInput.prototype.show;egret.web.HTMLInput.prototype.show=function(){o.call(this);var n=this._stageText,r=n.$textfield.localToGlobal(0,0);t=StageUtils.ins().getHeight()-r.y-n.$textfield.height,t=t*this.$scaleY*(window.devicePixelRatio||1)>>0,TimerMgr.ins().remove(i,null),TimerMgr.ins().once(100,e,null)};var n=egret.StageText.prototype.$hide;egret.StageText.prototype.$hide=function(){n.call(this),TimerMgr.ins().remove(e,null),TimerMgr.ins().once(100,i,null)}}},t.fixHTML5StageText=function(){if(egret.web.HTMLInput){var t=egret.web.HTMLInput.prototype.disconnectStageText;egret.web.HTMLInput.prototype.disconnectStageText=function(e){t.call(this,e),this._needShow=!1}}},t.fixWebGLRenderContext=function(){egret.web.WebGLRenderContext&&(egret.web.WebGLRenderContext.prototype.getWebGLTexture=function(t){return t.webGLTexture||("image"==t.format?t.webGLTexture=this.createTexture(t.source):"pvr"==t.format&&(t.webGLTexture=this.createTextureFromCompressedData(t.source.pvrtcData,t.width,t.height,t.source.mipmapsCount,t.source.format)),t.$deleteSource&&t.webGLTexture&&(t.source=null),t.webGLTexture&&(t.webGLTexture.smoothing=!0)),t.webGLTexture})},t.fixWebGLRenderTarget=function(){egret.web.WebGLRenderTarget&&(egret.web.WebGLRenderTarget.prototype.createTexture=function(){var t=this.gl,e=t.createTexture();return e&&(e.glContext=t,t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),e})},t}();__reflect(EgretModify.prototype,"EgretModify");var ItemUtils=function(){function t(){}return t.calculateBagItemScore=function(t,e){var i=DataCenter.ins().EquipConfig[t.itemConfig.id],o=DataCenter.ins().CombatPowerConfig,n=0,r=t.att,a=0;if(r){for(var s in AttributeData.itemTranslate)if(a=0,i[s]){for(var l=0;l<r.length;l++)if(r[l].type==AttributeData.itemTranslate[s]){a=i[s]+r[l].value;break}n+=(void 0==a?0:a)*o[AttributeData.itemTranslate[s]].power}}else for(var s in AttributeData.itemTranslate)if(a=i[s]){var h=RoleModel.getAttrTypeByName(s);n+=a*o[h].power}var u=0;return i.baseAttr1&&e&&-1==e.indexOf(i.baseAttr1.type)&&(u+=BackpackControl.getAttrPower([i.baseAttr1])),i.baseAttr2&&(u+=BackpackControl.getAttrPower([i.baseAttr2])),i.exPower&&(u+=i.exPower),Math.floor(n/100)+Math.floor(u)},t.pointCalNumber=function(e){var i=e.id;if(void 0!=t.itemPoints[i])return t.itemPoints[i];var o=DataCenter.ins().EquipConfig[i],n=DataCenter.ins().CombatPowerConfig,r=0;for(var a in AttributeData.itemTranslate){var s=AttributeData.itemTranslate[a],l=o[a];if(l){var h=n[s];r+=(l+Math.floor(l*ItemBase.ADDITION_RANGE/100))*h.power}}return t.itemPoints[i]=Math.floor(r/100),t.itemPoints[i]},t.getBaseAttrData=function(t){var e=DataCenter.ins().EquipConfig[t.id],i=[57],o=[];for(var n in AttributeData.itemTranslate)e[n]&&o.push(new AttributeData(AttributeData.itemTranslate[n],e[n]));return e.baseAttr1&&i.indexOf(e.baseAttr1.type)>=0&&o.push(new AttributeData(e.baseAttr1.type,e.baseAttr1.value)),e.baseAttr2&&i.indexOf(e.baseAttr2.type)>=0&&o.push(new AttributeData(e.baseAttr2.type,e.baseAttr2.value)),o},t.calculateRelatePower=function(t,e){var i=0;if(!t||!e)return i;for(var o=0,n=t;o<n.length;o++){var r=n[o];i+=this.relatePower(r,e)}return i},t.relatePower=function(t,e){var i=0,o=DataCenter.ins().CombatPowerConfig,n=o[t.type];if(n&&n.relate_type){var r=e.getAtt(n.relate_type),a=AttributeData.exRelate[n.relate_type];if(a){var s=e.getAtt(a);s&&(r=Math.floor(r/(1+s/1e4)))}i+=Math.floor(t.value*r*n.relate_power/100)}return i},t.relatePowerEx=function(t,e){for(var i=[],o=0;o<t.length;o++)if(t[o]&&t[o].type){var n=AttributeData.exRelateEx[t[o].type];if(n){var r=e.getAtt(n);if(r){var a=Math.floor(t[o].value/1e4*r);i.push(new AttributeData(n,a))}}}return i},t.getQuality=function(t){return t&&DataCenter.ins().ItemDescConfig[t.descIndex]?DataCenter.ins().ItemDescConfig[t.descIndex].quality:0},t.getQualityColor=function(t){return LangMgr.getColor("qualityColor"+this.getQuality(t))},t.getType=function(t){return t&&DataCenter.ins().ItemDescConfig[t.descIndex]?DataCenter.ins().ItemDescConfig[t.descIndex].type:0},t.getSubType=function(t){return t&&DataCenter.ins().ItemDescConfig[t.descIndex]?DataCenter.ins().ItemDescConfig[t.descIndex].subType:0},t.getJob=function(t){return t&&DataCenter.ins().ItemDescConfig[t.descIndex]?DataCenter.ins().ItemDescConfig[t.descIndex].job:0},t.itemPoints={},t}();__reflect(ItemUtils.prototype,"ItemUtils");var LinkUtils=function(){function t(){}return t.textLink=function(t,e){if(t){var i=void 0;if(t.indexOf(",")>=0?i=t.split(","):t.indexOf("*")>=0&&(i=t.split("*")),i&&!(i.length<=0))switch(+i[0]){case 1:if(!crossArenaControl.checkIsMatching())return;if(e&&e.roleId==ActorControl.actorID)return void tipsControl.showTips(LangMgr.getValueByKey("textLinkTips1"));copyControl.upEnterTFRoom(+i[1]);break;case 2:crossArenaControl.upJoinTeam(+i[1]);break;case 4:copyHelpControl.checkEnterToHelp(i[1],e.time);break;case 5:var o=i[1].split("+"),n=+o[1],r=+o[2];if(!hatredControl.isOpen()){var a=DataCenter.ins().ServerEenemyBaseConfig.openZsLevel/1e3>>0,s=DataCenter.ins().ServerEenemyBaseConfig.openZsLevel%1e3;return void tipsControl.showTips(LangMgr.getValueByKey("textLinkTips2",a,s))}if(ActorControl.actorID==r)return void tipsControl.showTips(LangMgr.getValueByKey("textLinkTips3"));if(0!=MapControl.copyId&&!toseongControl.isToseong)return void tipsControl.showCenterTips(LangMgr.getValueByKey("textLinkTips4"));if(!e.time||e.time<GameServer.serverTime)return void tipsControl.showTips(LangMgr.getValueByKey("textLinkTips5"));hatredControl.upAssist(r,n);break;case 6:if(e.roleId==ActorControl.actorID)return void tipsControl.showTips(LangMgr.getValueByKey("textLinkTips6"));if(!mineControl.openCheck(!0))return;if(copyControl.checkInFB())return;var l=i[1].split("+");mineControl.upHelpOther(+l[0]);break;case 8:CommonFun.viewItemTips(+i[1],+i[2])}}},t}();__reflect(LinkUtils.prototype,"LinkUtils");var Md5Utils=function(){function t(){}return t.hex_md5=function(t){return EncryptMd5.hex_md5(t)},t.obj_cntstr=function(t,e,i,o){void 0===i&&(i=[]),void 0===o&&(o=!0);var n=[];for(var r in t)n.push(r);o&&n.sort();for(var a=[],s=0;s<n.length;s++){var r=n[s];-1==i.indexOf(r)&&a.push(r+"="+t[r])
}var l=a.join("&");return l},t.obj_md5=function(t,e,i,o){void 0===i&&(i=[]),void 0===o&&(o=!0);var n=[];for(var r in t)n.push(r);o&&n.sort();for(var a=[],s=0;s<n.length;s++){var r=n[s];-1==i.indexOf(r)&&a.push(r+"="+t[r])}var l=a.join("&");return EncryptMd5.hex_md5(l+(e?"&"+e:""))},t.obj_md5_args=function(t,e,i,o,n,r){void 0===o&&(o=[]),void 0===n&&(n=[]),void 0===r&&(r=!0);var a=this.obj_md5(t,e,n,r),s=[];for(var l in t)s.push(l);r&&s.sort();for(var h=[],u=0;u<s.length;u++){var l=s[u];-1==o.indexOf(l)?h.push(l+"="+t[l]):h.push(l+"="+encodeURIComponent(t[l]))}var c=h.join("&");return i&&(c+="&sign="+a),c},t}();__reflect(Md5Utils.prototype,"Md5Utils");var Sha1Utils=function(){function t(){}return t.hex_sha1=function(t){return EncryptSha1.hex_sha1(t)},t}();__reflect(Sha1Utils.prototype,"Sha1Utils");var SoundUtils=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._delayTime=0,e._delayStartTime=0,e._runTimeGap=700,e._runTimeStart=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.playRunSound=function(){if(egret.getTimer()-this._runTimeStart>=this._runTimeGap){if(this._runTimeStart=egret.getTimer(),!GlobalModel.openSound)return;SoundManager.ins().playEffect(e.RUN)}},e.prototype.playRun=function(){egret.getTimer()-this._runTimeStart>this._runTimeGap+100&&this.playRunSound(),TimerMgr.ins().isExists(this.playRunSound,this)||TimerMgr.ins().doTimer(this._runTimeGap,0,this.playRunSound,this)},e.prototype.stopRun=function(){TimerMgr.ins().remove(this.playRunSound,this)},e.prototype.playEffect=function(t){egret.getTimer()-this._delayStartTime<this._delayTime||GlobalModel.openSound&&SoundManager.ins().playEffect(t)},e.prototype.playBg=function(t){GlobalModel.openSound&&SoundManager.ins().playBg(t)},e.prototype.touchBg=function(){GlobalModel.openSound&&SoundManager.ins().touchBg()},e.prototype.stopBg=function(){SoundManager.ins().stopBg()},e.prototype.setEffectOn=function(t){SoundManager.ins().setEffectOn(t)},e.prototype.setBgOn=function(t){SoundManager.ins().setBgOn(t)},e.prototype.delayTime=function(t){this._delayTime=t,this._delayStartTime=egret.getTimer()},e.RUN="run_mp3",e.VIEW="view_mp3",e.TASK="task_mp3",e.UPGRADE="upgrade_mp3",e.TRANSFER="transfer_mp3",e.WEAR="wear_mp3",e.CREATE_ROLE="createRole_mp3",e.STRENGTHEN="strengthen_mp3",e.SMELT="smelt_mp3",e.SKILL_UPGRADE="skillUpgrade_mp3",e.PLAY_OPEN_VIEW=!1,e}(SingleClass);__reflect(SoundUtils.prototype,"SoundUtils");var GameLoadingMJ=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.bg=new eui.Image;var t=GlobalModel.pfData;t&&t.startbg?this.bg.source=t.startbg:this.bg.source=PATH_ROOT+"loading/loading.png",this.addChild(this.bg),this.bg.width=580,this.bg.height=1330,this.bg.anchorOffsetX=this.bg.width/2,this.bg.anchorOffsetY=this.bg.height/2,this.bg.x=this.stage.stageWidth/2,this.bg.y=this.stage.stageHeight/2,this.progressPane=new egret.DisplayObjectContainer,this.addChild(this.progressPane),this.messageText=new eui.Label,this.messageText.width=360,this.messageText.height=20,this.messageText.textAlign=egret.HorizontalAlign.CENTER,this.messageText.x=0,this.messageText.y=0,this.messageText.size=20,this.progressPane.addChild(this.messageText),this.progressBg1=new eui.Image,this.progressBg1.source=PATH_ROOT+"loading/bar3.png",this.progressBg1.x=0,this.progressBg1.y=30,this.progressPane.addChild(this.progressBg1),this.progressBg2=new eui.Image,this.progressBg2.source=PATH_ROOT+"loading/bar2.png",this.progressBg2.scale9Grid=new egret.Rectangle(12,8,5,5),this.progressBg2.width=300,this.progressBg2.x=30,this.progressBg2.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg2),this.progressBg3=new eui.Image,this.progressBg3.source=PATH_ROOT+"loading/bar4.png",this.progressBg3.x=this.progressBg2.x+this.progressBg2.width,this.progressBg3.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg3),this.progress=new eui.Image,this.progress.source=PATH_ROOT+"loading/bar5.png",this.progress.scale9Grid=new egret.Rectangle(8,8,10,3),this.progress.width=0,this.progress.x=this.progressBg1.x+16,this.progress.y=this.progressBg1.y,this.progressPane.addChild(this.progress),this.posImage=new eui.Image,this.posImage.source=PATH_ROOT+"loading/bar1.png",this.posImage.y=15,this.posImage.x=6,this.progressPane.addChild(this.posImage),this.progressText=new eui.Label,this.progressText.width=this.messageText.width,this.progressText.height=20,this.progressText.textAlign=egret.HorizontalAlign.CENTER,this.progressText.x=0,this.progressText.y=this.progressBg1.y,this.progressText.size=20,this.progressPane.addChild(this.progressText),this.progressPane.x=(this.stage.stageWidth-360)/2,this.progressPane.y=650,this.addLink(LangMgr.getValueByKey("loadingLink"),720),this.gameHint=new eui.Label,this.gameHint.text=LangMgr.getValueByKey("loadingTips"),this.gameHint.size=14,this.gameHint.width=392,this.gameHint.height=40,this.gameHint.textAlign="center",this.gameHint.verticalAlign="middle",this.gameHint.textColor=14207153,this.gameHint.lineSpacing=5,this.gameHint.x=(this.stage.stageWidth-this.gameHint.width)/2,this.gameHint.y=this.stage.stageHeight-this.gameHint.height-10,this.addChild(this.gameHint),this.setOwnerDes(GlobalModel.ownerDes)},e}(GameLoadingUI);__reflect(GameLoadingMJ.prototype,"GameLoadingMJ");var GameLoadingQTT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.bg=new eui.Image;var t=GlobalModel.pfData;t&&t.startbg?this.bg.source=t.startbg:this.bg.source=PATH_ROOT+"loading/loading.png",this.addChild(this.bg),this.bg.width=580,this.bg.height=1330,this.bg.anchorOffsetX=this.bg.width/2,this.bg.anchorOffsetY=this.bg.height/2,this.bg.x=this.stage.stageWidth/2,this.bg.y=this.stage.stageHeight/2,this.progressPane=new egret.DisplayObjectContainer,this.addChild(this.progressPane),this.messageText=new eui.Label,this.messageText.width=360,this.messageText.height=20,this.messageText.textAlign=egret.HorizontalAlign.CENTER,this.messageText.textColor=16769280,this.messageText.stroke=1,this.messageText.strokeColor=0,this.messageText.x=0,this.messageText.y=-40,this.messageText.size=20,this.progressPane.addChild(this.messageText),this.progressBg1=new eui.Image,this.progressBg1.source=PATH_ROOT+"loading/bar3.png",this.progressBg1.x=0,this.progressBg1.y=30,this.progressPane.addChild(this.progressBg1),this.progressBg2=new eui.Image,this.progressBg2.source=PATH_ROOT+"loading/bar2.png",this.progressBg2.scale9Grid=new egret.Rectangle(12,8,5,5),this.progressBg2.width=300,this.progressBg2.x=30,this.progressBg2.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg2),this.progressBg3=new eui.Image,this.progressBg3.source=PATH_ROOT+"loading/bar4.png",this.progressBg3.x=this.progressBg2.x+this.progressBg2.width,this.progressBg3.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg3),this.progress=new eui.Image,this.progress.source=PATH_ROOT+"loading/bar5.png",this.progress.scale9Grid=new egret.Rectangle(8,8,10,3),this.progress.width=0,this.progress.x=this.progressBg1.x+25,this.progress.y=this.progressBg1.y+8,this.progressPane.addChild(this.progress),this.posImage=new eui.Image,this.posImage.source=PATH_ROOT+"loading/bar1.png",this.posImage.y=15,this.posImage.x=6,this.progressPane.addChild(this.posImage),this.progressText=new eui.Label,this.progressText.width=this.messageText.width,this.progressText.height=20,this.progressText.textAlign=egret.HorizontalAlign.CENTER,this.progressText.x=0,this.progressText.y=this.progressBg1.y-40,this.progressText.size=20,this.progressPane.addChild(this.progressText),this.progressPane.x=(this.stage.stageWidth-360)/2,this.progressPane.y=650,this.addLink(LangMgr.getValueByKey("loadingLink"),720),this.gameHint=new eui.Label,this.gameHint.text=LangMgr.getValueByKey("loadingTips"),this.gameHint.size=14,this.gameHint.width=392,this.gameHint.height=40,this.gameHint.textAlign="center",this.gameHint.verticalAlign="middle",this.gameHint.textColor=14207153,this.gameHint.lineSpacing=5,this.gameHint.x=(this.stage.stageWidth-this.gameHint.width)/2,this.gameHint.y=this.stage.stageHeight-this.gameHint.height-10,this.addChild(this.gameHint),this.setOwnerDes(GlobalModel.ownerDes)},e.prototype.setProgress=function(t,e,i,o){void 0===o&&(o=310);var n=o*t/100;egret.Tween.removeTweens(this.progress),this.posImage&&egret.Tween.removeTweens(this.posImage),i&&i>0?(egret.Tween.get(this.progress).to({width:n},i),this.posImage&&egret.Tween.get(this.posImage).to({x:n+6},i)):(this.progress.width=n,this.posImage&&(this.posImage.x=n+6)),this.progressText.text=Math.floor(t)+"%",this.messageText.text=e},e}(GameLoadingUI);__reflect(GameLoadingQTT.prototype,"GameLoadingQTT");var GameLoadingZGBY=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initUI=function(){this.bg=new eui.Image;var t=GlobalModel.notdifferentiate,e=GlobalModel.getUrlParamValue("rawChannelId"),i=GlobalModel.pfArgs[GlobalModel.pf];if(i=i?i[e]:"",e&&i&&i.startbg?this.bg.source=i.startbg:this.bg.source=PATH_ROOT+"loading/loading.png",this.addChild(this.bg),this.bg.width=580,this.bg.height=1200,this.bg.anchorOffsetX=this.bg.width/2,this.bg.anchorOffsetY=this.bg.height/2,this.bg.x=this.stage.stageWidth/2,this.bg.y=this.stage.stageHeight/2,this.progressPane=new egret.DisplayObjectContainer,this.addChild(this.progressPane),this.messageText=new eui.Label,this.messageText.width=360,this.messageText.height=20,this.messageText.textAlign=egret.HorizontalAlign.CENTER,this.messageText.x=0,this.messageText.y=0,this.messageText.size=20,this.progressPane.addChild(this.messageText),this.progressBg1=new eui.Image,this.progressBg1.source=PATH_ROOT+"loading/bar3.png",this.progressBg1.x=0,this.progressBg1.y=30,this.progressPane.addChild(this.progressBg1),this.progressBg2=new eui.Image,this.progressBg2.source=PATH_ROOT+"loading/bar2.png",this.progressBg2.scale9Grid=new egret.Rectangle(12,8,5,5),this.progressBg2.width=300,this.progressBg2.x=30,this.progressBg2.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg2),this.progressBg3=new eui.Image,this.progressBg3.source=PATH_ROOT+"loading/bar4.png",this.progressBg3.x=this.progressBg2.x+this.progressBg2.width,this.progressBg3.y=this.progressBg1.y,this.progressPane.addChild(this.progressBg3),this.progress=new eui.Image,this.progress.source=PATH_ROOT+"loading/bar5.png",this.progress.scale9Grid=new egret.Rectangle(8,8,10,3),this.progress.width=0,this.progress.x=this.progressBg1.x+16,this.progress.y=this.progressBg1.y,this.progressPane.addChild(this.progress),this.posImage=new eui.Image,this.posImage.source=PATH_ROOT+"loading/bar1.png",this.posImage.y=15,this.posImage.x=6,this.progressPane.addChild(this.posImage),this.progressText=new eui.Label,this.progressText.width=this.messageText.width,this.progressText.height=20,this.progressText.textAlign=egret.HorizontalAlign.CENTER,this.progressText.x=0,this.progressText.y=this.progressBg1.y,this.progressText.size=20,this.progressPane.addChild(this.progressText),this.progressPane.x=(this.stage.stageWidth-360)/2,this.progressPane.y=650,this.pgrBg1=new eui.Image,this.pgrBg1.source=PATH_ROOT+"loading/bar3.png",this.pgrBg1.x=0,this.pgrBg1.y=55,this.progressPane.addChild(this.pgrBg1),this.pgrBg2=new eui.Image,this.pgrBg2.source=PATH_ROOT+"loading/bar2.png",this.pgrBg2.scale9Grid=new egret.Rectangle(12,8,5,5),this.pgrBg2.width=300,this.pgrBg2.x=30,this.pgrBg2.y=this.pgrBg1.y,this.progressPane.addChild(this.pgrBg2),this.pgrBg3=new eui.Image,this.pgrBg3.source=PATH_ROOT+"loading/bar4.png",this.pgrBg3.x=this.pgrBg2.x+this.pgrBg2.width,this.pgrBg3.y=this.pgrBg1.y,this.progressPane.addChild(this.pgrBg3),this.pgress=new eui.Image,this.pgress.source=PATH_ROOT+"loading/bar5.png",this.pgress.scale9Grid=new egret.Rectangle(8,8,10,3),this.pgress.width=0,this.pgress.x=this.pgrBg1.x+16,this.pgress.y=this.pgrBg1.y,this.progressPane.addChild(this.pgress),this.addLink(LangMgr.getValueByKey("loadingLink"),770),this.gameHint=new eui.Label,this.gameHint.text="",this.gameHint.size=14,this.gameHint.width=392,this.gameHint.height=40,this.gameHint.textAlign="center",this.gameHint.verticalAlign="middle",this.gameHint.textColor=14207153,this.gameHint.lineSpacing=5,this.gameHint.x=(this.stage.stageWidth-this.gameHint.width)/2,this.gameHint.y=this.stage.stageHeight-this.gameHint.height-10,this.addChild(this.gameHint),e&&i&&i.ownerDes&&GlobalModel.setUrlParamValue("ownerDes",i.ownerDes),t.length>0){for(var o in t)if(GlobalModel.gameId==t[o]){var n=GlobalModel.pfArgs[GlobalModel.pf];n&&n.loadbg?this.bg.source=n.loadbg:n&&n.startbg&&(this.bg.source=n.startbg),this.setOwnerDes(n.ownerDes);break}}else this.setOwnerDes(GlobalModel.ownerDes);this.fakePress(),this.runTips()},e.prototype.setOwnerDes=function(t){!this.ownerDes&&this.stage&&(this.ownerDes=new eui.Label,this.ownerDes.size=12,this.ownerDes.width=506,this.ownerDes.height=139,this.ownerDes.textAlign="center",this.ownerDes.verticalAlign="middle",this.ownerDes.lineSpacing=5,this.ownerDes.textColor=14207153,this.ownerDes.horizontalCenter=0,this.ownerDes.y=this.stage.stageHeight-147,this.addChild(this.ownerDes)),this.ownerDes&&(this.ownerDes.text=t)},e}(GameLoadingUI);__reflect(GameLoadingZGBY.prototype,"GameLoadingZGBY");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=580,this.textField.height=100,this.textField.textAlign="center"},e.prototype.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI");var ResVersionMgr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.loadConfig=function(t,e,i){var o=this;HttpUtils.getIns().sendUrl(t,null,egret.HttpMethod.GET,this,function(t){t.currentTarget.response&&(o.resVersionData=JSON.parse(t.currentTarget.response)),e.call(i)},function(t){alert("version.json parse error!")})},e.prototype.registerVersionController=function(t){if(RES.getVirtualUrl)RES.getVirtualUrl=function(e){return this.getResVerUrl(t,e)}.bind(this);else if(RES.web)RES.web.Html5VersionController.prototype.getVirtualUrl=function(e){return this.getResVerUrl(t,e)}.bind(this);else{var e=new RES.VersionController;e.getVirtualUrl=function(e){return this.getResVerUrl(t,e)},RES.registerVersionController(e)}},e.prototype.getResVerUrl=function(t,i){return void 0!=e.ins().resVersionData&&(e.ins().resVersionData[i]?i+="?v="+e.ins().resVersionData[i]:".exml"!=i.substring(i.length-5,i.length)&&(i+="?v=1")),-1==i.lastIndexOf("http")&&(i=""+t+i),i},e}(SingleClass);__reflect(ResVersionMgr.prototype,"ResVersionMgr");var GlobalModel=function(){function t(){}return t.getHosts=function(){return egret.getOption("hosts")},t.init=function(t){if(this.urlParam={},debug.log("Init Platform data:",t),t){try{var e=JSON.parse(t)}catch(i){alert("PfCfg parse error!")}for(var o in e)"gameId"==o?this.urlParam.lzGameId=e[o]:"preloadLang"==o?LangMgr.addValue(e[o]):this.urlParam[o]=e[o]}var n=window.location.search;if(n&&""!=n&&(n=n.substring(1)))for(var r=n.split("&"),a=void 0,s=0;s<r.length;s++)a=r[s].split("="),this.urlParam[a[0]]=decodeURIComponent(decodeURI(a[1]));window.changeUrlParam&&window.changeUrlParam(this),window.setHtmlTitle&&this.urlParam.htmlTitle&&window.setHtmlTitle(this.urlParam.htmlTitle),this.showShare&&(platformAmuseControl.shareState=0),this.showFocus&&1!=this.getUrlParamValue("isfollow")&&(platformAmuseControl.focusState=0),debug.log("Args:",this.urlParam)},t.GetSearchParamByName=function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(e);return i?decodeURIComponent(decodeURI(i[2])):""},t.getUrlParamValue=function(t){return this.urlParam[t]||""},t.setUrlParamValue=function(t,e){this.urlParam[t]=e},Object.defineProperty(t,"resAdd",{get:function(){return this.urlParam.hosts||""},set:function(t){this.urlParam.hosts=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isCreateRole",{get:function(){return this.urlParam.isCreateRole||!1},set:function(t){this.urlParam.isCreateRole=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"createRolePreload",{get:function(){var t="createRole";return this.urlParam.createRolePreload&&(t=this.urlParam.createRolePreload[this.pf]?this.urlParam.createRolePreload[this.pf]:this.urlParam.createRolePreload.Test),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openID",{get:function(){return this.urlParam.user},set:function(t){this.urlParam.user=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvid",{get:function(){return parseInt(this.urlParam.srvid)},set:function(t){this.urlParam.srvid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"mainSrvid",{get:function(){return parseInt(this.urlParam.mainSrvid)},set:function(t){this.urlParam.mainSrvid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"srvname",{get:function(){return this.urlParam.srvname||""},set:function(t){this.urlParam.srvname=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverIP",{get:function(){return this.urlParam.srvaddr},set:function(t){this.urlParam.srvaddr=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverPort",{get:function(){return this.urlParam.srvport},set:function(t){this.urlParam.srvport=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"nickName",{get:function(){return this.urlParam.nickName||""},set:function(t){this.urlParam.nickName=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gameVersion",{get:function(){return void 0!=this.urlParam.version?parseInt(this.urlParam.version):1},set:function(t){this.urlParam.version=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gameId",{get:function(){return void 0!=this.urlParam.lzGameId?parseInt(this.urlParam.lzGameId):1},set:function(t){this.urlParam.lzGameId=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"appid",{get:function(){return this.urlParam.appid||this.gameId},set:function(t){this.urlParam.appid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ownerDes",{get:function(){var t=this.pfData;return t&&t.ownerDes?t.ownerDes:this.urlParam.ownerDes||""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"chOwnerDesPos",{get:function(){return this.urlParam.chOwnerDesPos||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"oneKeySmelt",{get:function(){return this.urlParam.oneKeySmelt||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"currentType",{get:function(){return this.urlParam.currentType||"￥"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"channelId",{get:function(){return this.urlParam.channelId||"0"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isAuditState",{get:function(){return this.appVersion==this.auditVersion},enumerable:!0,configurable:!0}),Object.defineProperty(t,"appVersion",{get:function(){return this.urlParam.appVersion||"0"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"auditVersion",{get:function(){return this.urlParam.auditVersion||""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openTab",{get:function(){return this.urlParam.openTab?this.urlParam.openTab==this.pf:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pfid",{get:function(){return this.urlParam.pfid||"1"},set:function(t){this.urlParam.pfid=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pf",{get:function(){return this.urlParam.pf||"Test"},set:function(t){this.urlParam.pf=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isWeb",{get:function(){return this.urlParam.isWeb||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"createAccountTime",{get:function(){return void 0!=this.urlParam.createaccounttime?parseInt(this.urlParam.createaccounttime):0},set:function(t){this.urlParam.createaccounttime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"createActorTime",{get:function(){return void 0!=this.urlParam.createactortime?parseInt(this.urlParam.createactortime):0},set:function(t){this.urlParam.createactortime=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"actorLoginTime",{get:function(){return void 0!=this.urlParam.actorlogintime?parseInt(this.urlParam.actorlogintime):0},set:function(t){this.urlParam.actorlogintime=t},enumerable:!0,configurable:!0}),t.setLoadProgress=function(t,e,i){GameLoadingUI.GetInstance().setProgress(t,e,i)},t.checkClientVersion=function(t){var e=this;if(DeviceUtils.IsWxMiniGame){var i=window.wx.getUpdateManager();i.onCheckForUpdate(function(t){console.log("wx hasUpdate:",t.hasUpdate)}),i.onUpdateReady(function(){window.wx.showModal({title:LangMgr.getValueByKey("updataTips"),content:LangMgr.getValueByKey("newversionready"),success:function(t){t.confirm&&i.applyUpdate()}})}),i.onUpdateFailed(function(){console.log(LangMgr.getValueByKey("newVersionFail"))}),t&&t()}else{t&&t();var o=new egret.HttpRequest;o.open(""+this.resAdd+PATH_ROOT+"pfCfg.json?v="+Date.now(),egret.HttpMethod.GET),o.send(),o.addEventListener(egret.Event.COMPLETE,function(t){var i=t.currentTarget.response;if(i){var o=JSON.parse(i);parseInt(o.version)!=e.gameVersion&&(alert(LangMgr.getValueByKey("gameverupdata",e.gameVersion+"->"+parseInt(o.version))),window.location.reload())}},this)}},Object.defineProperty(t,"mianUIState",{get:function(){return this.urlParam.mianUIState||"cq"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"skinType",{get:function(){return this.urlParam.skinType||"cq"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"changeUglyRes",{get:function(){return this.urlParam.changeUglyRes?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"jobUIState",{get:function(){return this.urlParam.jobUIState?!0:!1},enumerable:!0,configurable:!0}),t.bodyCoverWeapon=function(t){var e=this.urlParam.jobShowLayer;return e?1==e[t-1]:!1},Object.defineProperty(t,"bodyBindWeapon",{get:function(){return this.urlParam.bodyBindWeapon?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"weaponBindBody",{get:function(){return this.urlParam.weaponBindBody?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onlyShowDress",{get:function(){return this.urlParam.onlyShowDress?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"chargeRate",{get:function(){return void 0!=this.urlParam.chargeRate?Number(this.urlParam.chargeRate):100},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openSound",{get:function(){return this.urlParam.openSound?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openPatch",{get:function(){return this.urlParam.openPatch?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"showShare",{get:function(){return this.urlParam.showShare?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"showFocus",{get:function(){return this.urlParam.showFocus?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"os",{get:function(){return this.urlParam.os?this.urlParam.os:egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t,"baseVipLevel",{get:function(){return void 0!=this.urlParam.baseVipLevel?Number(this.urlParam.baseVipLevel):0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"roleNum",{get:function(){return void 0!=this.urlParam.roleNum?Number(this.urlParam.roleNum):3},enumerable:!0,configurable:!0}),Object.defineProperty(t,"chatShowNum",{get:function(){return void 0!=this.urlParam.chatShowNum?Number(this.urlParam.chatShowNum):2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"iconsIsLeft",{get:function(){return this.urlParam.iconsIsLeft?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isHw",{get:function(){return this.urlParam.isHw?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isXJP",{get:function(){return this.urlParam.isXJP?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"sdkDomain",{get:function(){if(this.urlParam.sdkDomain)return this.urlParam.sdkDomain;var t;switch(t=this.isHw?"http://hwltserver.lzhygame.com":this.isXJP?"http://xjpltserver.lzhygame.com":"http://ltserver.lzhygame.com",this.urlParam.serverSdkUrl){case 1:t="http://hnltserver.hnlzhd.com"}return"devtools"==window.wxPlatform?window.isMiniUseHttp||(t=t.replace("http:","https:")):"https:"==window.location.protocol&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"gmDomain",{get:function(){if(this.urlParam.gmDomain)return this.urlParam.gmDomain;var t;switch(t=this.isHw?"http://hwadmin.lzhygame.com":this.isXJP?"http://xjpadmin.lzhygame.com":DeviceUtils.IsWxMiniGame?"http://admin2.lzhygame.com":"http://admin.lzhygame.com",this.urlParam.serverSdkUrl){case 1:t="http://admin.hnlzhd.com"}return"devtools"==window.wxPlatform?window.isMiniUseHttp||(t=t.replace("http:","https:")):"https:"==window.location.protocol&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"showMicroclientDownload",{get:function(){return this.urlParam.showMicroclientDownload?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMicroclient",{get:function(){return this.urlParam.isMicroclient?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"loadingClass",{get:function(){return this.urlParam.loadingClass},enumerable:!0,configurable:!0}),Object.defineProperty(t,"playGameMusic",{get:function(){return this.urlParam.playGameMusic||""},enumerable:!0,configurable:!0}),Object.defineProperty(t,"IsQQHall",{get:function(){if("ZjH5"!=this.pf)return!1;var t=this.urlParam.ext;return t?t.indexOf("qqgame")>=0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pfArgs",{get:function(){return this.urlParam.pfArgs&&this.urlParam.pfArgs[this.gameId]||JSON.parse("{}")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"pfData",{get:function(){var t=this.pfArgs[this.pf];if(t){var e=this.getUrlParamValue("rawChannelId");return e?t[e]:t}return null},enumerable:!0,configurable:!0}),Object.defineProperty(t,"QuickH5ProductCode",{get:function(){var e=SDKConst.QuickH5ProductCode;switch(t.pfid){case"67":e="64471295314902425659433702151527";break;case"68":e="27680011050649275531612882595457";break;case"34":e="34789611540670077461401175602316";break;case"76":e="34846589717708876982183812111684";break;case"78":e="52055892179132852231891496402018";break;case"79":e="60675537160606593525271611859746";break;case"81":e="89691063088127017199691906683251";break;case"84":e="40534930470743900377240499134808";case"85":e="09494619042009704294211351557687";break;case"86":e="69783721435275683076639266333759";break;case"88":e="59648970473706468815878465795500";break;case"89":e="53818074046796660417022772109144";break;case"91":e="88420418265069997078423668799827";break;case"92":e="23596528987337064167579130472505";break;case"93":e="08969832438978932605843658089179"}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"QuickH5ProductKey",{get:function(){var e=SDKConst.QuickH5ProductKey;switch(t.pfid){case"67":e="07520473";break;case"68":e="22623743";break;case"34":e="88475690";break;case"76":e="07972870";break;case"78":e="22381313";break;case"79":e="80446717";break;case"81":e="11132763";break;case"84":e="96235539";case"85":e="63709999";break;case"86":e="62800024";break;case"88":e="46525220";break;case"89":e="42633473";break;case"91":e="66970053";break;case"92":e="86452741";break;case"93":e="97686011"}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openQuickReload",{get:function(){return this.urlParam.openQuickReload?this.urlParam.openQuickReload:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isHttps",{get:function(){return"devtools"==window.wxPlatform?!window.isMiniUseHttp:-1!=window.location.protocol.indexOf("https:")},enumerable:!0,configurable:!0}),Object.defineProperty(t,"useWss",{get:function(){return null!=this.urlParam.useWss?this.urlParam.useWss:!0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverNumberPlyer",{get:function(){return this.urlParam.serverNumberPlyer||0},set:function(t){this.urlParam.serverNumberPlyer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"notdifferentiate",{get:function(){return this.urlParam.notdifferentiate||[]},set:function(t){this.urlParam.notdifferentiate=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"serverStyle",{get:function(){return this.urlParam.serverStyle||[]},enumerable:!0,configurable:!0}),Object.defineProperty(t,"isMangleCfgWeb",{get:function(){return this.urlParam.isMangleCfgWeb||!1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"realNameState",{get:function(){return this.urlParam.realNameState},set:function(t){this.urlParam.realNameState=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"clientPlayerIp",{get:function(){return this.urlParam.clientPlayerIp||""},set:function(t){this.urlParam.clientPlayerIp=t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"openClientErrorLog",{get:function(){return this.urlParam.openClientErrorLog||!1},enumerable:!0,configurable:!0}),t}();__reflect(GlobalModel.prototype,"GlobalModel");var PHPConfig=function(){function t(){}return Object.defineProperty(t,"GET_PATCH_URL",{get:function(){var t=GlobalModel.gmDomain+":8080/api/getclientversion";return GlobalModel.isHttps&&(t=GlobalModel.gmDomain+"/api/getclientversion"),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SET_GM_REPORT",{get:function(){var t=GlobalModel.gmDomain+":81/api/report";return GlobalModel.isHttps&&(t=GlobalModel.gmDomain+"/api/report"),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GET_CHANNEL_URL",{get:function(){var t=GlobalModel.sdkDomain+"/api/report";return t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"REGISTER_LOGIN_URL",{get:function(){var t="Test"!=GlobalModel.pf?GlobalModel.sdkDomain+"/braintree/"+GlobalModel.gameId+"/sdkurlcallback":"http://www.xcvgame.cn/braintree/"+GlobalModel.gameId+"/sdkurlcallback";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"GET_SERVER_URL",{get:function(){var t="Test"!=GlobalModel.pf?GlobalModel.sdkDomain+"/api/getserver":"http://www.xcvgame.cn/api/getserver";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SET_USER_URL",{get:function(){var t="Test"!=GlobalModel.pf?GlobalModel.sdkDomain+"/api/setuser":"http://www.xcvgame.cn/api/setuser";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SET_ACTOR_INFO",{get:function(){var t="Test"!=GlobalModel.pf?GlobalModel.sdkDomain+"/api/setactorinfo":"http://www.xcvgame.cn/api/setactorinfo";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAKE_ORDER_URL",{get:function(){var t="Test"!=GlobalModel.pf?GlobalModel.sdkDomain+"/api/makeorder":"http://www.xcvgame.cn/api/makeorder";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SET_ROLE_INFO",{get:function(){var t="Test"!=GlobalModel.pf?GlobalModel.sdkDomain+"/api/roleinfo":"http://www.xcvgame.cn/api/roleinfo";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SET_LANZHUAN_INFO",{get:function(){var t=GlobalModel.sdkDomain+"/api/bluevip";return GlobalModel.isHttps&&(t=t.replace("http:","https:")),t},enumerable:!0,configurable:!0}),t.requestPhpData=function(t,e,i,o,n,r,a){for(var s=[],l=7;l<arguments.length;l++)s[l-7]=arguments[l];var h=new egret.HttpRequest;h.responseType=a?a:egret.HttpResponseType.TEXT,h.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r==egret.HttpMethod.POST?(h.open(t,egret.HttpMethod.POST),h.send(e)):(h.open(t+"?"+e,egret.HttpMethod.GET),h.send()),h.addEventListener(egret.Event.COMPLETE,function(t){s.unshift(t),i.apply(o,s)
},this),h.addEventListener(egret.IOErrorEvent.IO_ERROR,function(t){s.unshift(t),n.apply(o,s)},this)},t.VERIFY_KEY="123@#$567&*(adscv",t}();__reflect(PHPConfig.prototype,"PHPConfig");var Platform7724H5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SbPulSdk=window.SbPulSdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("qqesuid");var t={qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),qqesnickname:GlobalModel.getUrlParamValue("qqesnickname"),qqesavatar:GlobalModel.getUrlParamValue("qqesavatar"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),ext:GlobalModel.getUrlParamValue("ext"),qqestimestamp:GlobalModel.getUrlParamValue("qqestimestamp"),sign:GlobalModel.getUrlParamValue("sign")};this.SbPulSdk.init(t,function(t){1==t.channelId&&(SDKManager.ins().channelSdk=t,t.shareConfig(function(){platformAmuseControl.upWeiXinInviteGift()},{cp_p1:"",cp_p2:""}),t.isSubscribe(function(t){1!=t?platformAmuseControl.dispatchGuanZhu(0):platformAmuseControl.focusState=1})),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init"}))})},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),qqesnickname:GlobalModel.getUrlParamValue("qqesnickname"),qqesavatar:GlobalModel.getUrlParamValue("qqesavatar"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),ext:GlobalModel.getUrlParamValue("ext"),qqestimestamp:GlobalModel.getUrlParamValue("qqestimestamp"),sign:GlobalModel.getUrlParamValue("sign"),shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){var e={cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),cpguid:SDKConst.SbCpguId,roleName:t.nickName,serverid:t.serverId,level:t.level,ext:GlobalModel.getUrlParamValue("ext"),timestamp:Date.now()};e.sign=Md5Utils.obj_md5(e,SDKConst.SbKey),this.SbPulSdk.createRole(e)},e.prototype.SDKEnterGameNative=function(t){var e={cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),cpguid:SDKConst.SbCpguId,roleName:t.nickName,serverid:t.serverId,level:t.level,servername:t.serverName,vip:t.vip,ext:GlobalModel.getUrlParamValue("ext"),timestamp:Date.now()};e.sign=Md5Utils.obj_md5(e,SDKConst.SbKey),this.SbPulSdk.loginRole(e)},e.prototype.SDKUserUpgradeNative=function(t){},e.prototype.SDKPayNative=function(t){var e={order:t.order,cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),cpguid:SDKConst.SbCpguId,goodsname:t.goodsname,fee:t.fee,ext:GlobalModel.getUrlParamValue("ext"),timestamp:Date.now()};e.sign=Md5Utils.obj_md5(e,SDKConst.SbKey),this.SbPulSdk.pay(e)},e.prototype.SDKShowShare=function(){SDKManager.ins().channelSdk&&SDKManager.ins().channelSdk.share&&SDKManager.ins().channelSdk.share(function(){platformAmuseControl.upWeiXinInviteGift()},{cp_p1:"",cp_p2:""})},e.prototype.SDKShowQRCode=function(){SDKManager.ins().channelSdk&&SDKManager.ins().channelSdk.follow&&SDKManager.ins().channelSdk.follow()},e}(PlatformBase);__reflect(Platform7724H5.prototype,"Platform7724H5");var Platform99KH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TPGAME_SDK=window.TPGAME_SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid"),this.TPGAME_SDK.config({share:{friend:{title:"",desc:"",imgUrl:"",success:function(){platformAmuseControl.upWeiXinInviteGift()},cancel:function(){}},timeline:{title:"",imgUrl:"",success:function(){platformAmuseControl.upWeiXinInviteGift()},cancel:function(){}}},pay:{success:function(){},cancel:function(){}}}),this.nativeCallback(JSON.stringify({callType:"init"}))},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,access_token:GlobalModel.getUrlParamValue("access_token"),sign:GlobalModel.getUrlParamValue("sign"),isfollow:GlobalModel.getUrlParamValue("isfollow")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="2";e&&(o="1"),i&&(o="3");var n={action:o,data:{server_id:t.serverId,server_name:t.serverName,role_id:ActorControl.actorID,role_name:t.nickName,role_level:ActorControl.level}};this.TPGAME_SDK.reportGameInfo(n)},e.prototype.SDKPayNative=function(t){var e={out_trade_no:t.order,product_id:t.itemid,total_fee:100*t.fee,body:t.goodsname,detail:t.goodsname,attach:t.order},i=Md5Utils.obj_md5_args(e);i+=SDKConst.JBH5Key,e.sign=Sha1Utils.hex_sha1(i),this.TPGAME_SDK.pay(e)},e.prototype.SDKShowQRCode=function(){this.TPGAME_SDK.showQRCode()},e}(PlatformBase);__reflect(Platform99KH5.prototype,"Platform99KH5");var PlatformAiwanH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.AiwanSDK=window.AiwanSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.AiwanSDK.init(function(t){200==t.code&&SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",sdkcode:0,data:t}))})},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o=1;e?o=2:i&&(o=3);var n={roleId:ActorControl.actorID,roleName:ActorControl.myName,roleLevel:ActorControl.level,roleVip:vipControl.lv,serverId:t.serverId,serverName:t.serverName,event:o};this.AiwanSDK.uploadRole(n,function(t){200==t.code?console.log("GameDemo:AiwanSDK successfully upload "):console.log("GameDemo:AiwanSDK fail to upload :"+t.code+":"+t.msg)})},e.prototype.SDKPayNative=function(t){var e={cpOrderId:t.order,productPrice:100*t.fee,productId:t.itemid,productCount:t.amount,productName:t.goodsname,productDesc:t.goodsname,ext:t.order};this.AiwanSDK.payOrder(e,function(t){200==t.code?console.log("GameDemo:AiwanSDK checkout success"):console.log("GameDemo:AiwanSDK order failed:"+t.code+":"+t.msg)})},e.prototype.SDKLogoutNative=function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)0==i.sdkcode&&this.AiwanSDK.login(function(t){200==t.code?(console.log("GameDemo:AiwanSDK LoginOK: data=",t.data),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data}))):(console.log("GameDemo:AiwanSDK Login failed:"+t.msg),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1})))});else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.cp_mem_id,GlobalModel.setUrlParamValue("token",n.cp_user_token),SceneMgr.ins().runScene(StartGameScene)}else window.location.reload();else"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformAiwanH5.prototype,"PlatformAiwanH5");var PlatformAiwanH5WD=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.AiwanSDK=window.AiwanSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){56==GlobalModel.gameId&&GlobalModel.setUrlParamValue("pfid",56),this.AiwanSDK.init(function(t){200==t.code?(console.log("GameDemo:AiwanSDK init"),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",sdkcode:0,data:t}))):console.log("GameDemo:AiwanSDK initFail:"+t.msg)}),window.CpGame={logout:function(){window.location.reload()}}},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o=1;e?o=2:i&&(o=3);var n={roleId:ActorControl.actorID,roleName:ActorControl.myName,roleLevel:ActorControl.level,roleVip:vipControl.lv,serverId:t.serverId,serverName:t.serverName,event:o};this.AiwanSDK.uploadRole(n,function(t){200==t.code?console.log("GameDemo:AiwanSDK successfully upload "):console.log("GameDemo:AiwanSDK fail to upload :"+t.code+":"+t.msg)})},e.prototype.SDKPayNative=function(t){var e={cpOrderId:t.order,productPrice:100*t.fee,productId:t.itemid,productCount:t.amount,productName:t.goodsname,productDesc:t.goodsname,ext:t.order};this.AiwanSDK.payOrder(e,function(t){200==t.code?console.log("GameDemo:AiwanSDK checkout success"):console.log("GameDemo:AiwanSDK order failed:"+t.code+":"+t.msg)})},e.prototype.SDKLogoutNative=function(){this.AiwanSDK.logout(function(t){200==t.code?SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0})):console.log("GameDemo:AiwanSDK exitFail:"+t.msg)})},e.prototype.SDKShowLogout=function(){return!0},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)0==i.sdkcode&&this.AiwanSDK.login(function(t){200==t.code?(console.log("GameDemo:AiwanSDK loginOk: data=",t.data),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data}))):(console.log("GameDemo:AiwanSDK loginfail:"+t.msg),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1})))});else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.cp_mem_id,GlobalModel.setUrlParamValue("token",n.cp_user_token),SceneMgr.ins().runScene(StartGameScene)}else window.location.reload();else"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformAiwanH5WD.prototype,"PlatformAiwanH5WD");var PlatformBraintree=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKInitNative=function(){},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,uid:egret.localStorage.getItem("loginAccount"),gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token"),isLogin:GlobalModel.getUrlParamValue("isLogin"),shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("login info:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKPayNative=function(t){var e={serverId:t.serverId,serverName:t.serverName,goodsID:this.GetChannelItemId(t.itemid),cpOrderID:t.order,productName:t.goodsname};egret.ExternalInterface.call("SDKPayNative",JSON.stringify(e)),console.log("SDK pay info：",JSON.stringify(e))},e.prototype.onGetTonkenComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?console.log("GetTonken ok"):console.log("GetTonken fail"+e.info)}catch(i){console.log("GetTonken fail"+i)}},e.prototype.goPay=function(){},e.prototype.sendPayInfoToServer=function(t){},e.prototype.upperCase=function(t){return t?t.substring(0,1).toUpperCase()+t.substring(1):""},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.getSign=function(t){var e=this.getUrl(t);return EncryptMd5.hex_md5(e)},e.prototype.GetChannelItemId=function(t){var e=SDKManager.ins().UgameAppType;switch(e=this.upperCase(e),GlobalModel.os){case"android":t=SDKConst["GooglePayProductIds"+e][t];break;case"ios":t=SDKConst["IosProductIds"+e][t]}return t},e.prototype.scendMessage=function(t,e,i,o){PHPConfig.requestPhpData(t,this.getUrl(e),i,this,o,egret.HttpMethod.GET)},e}(PlatformBase);__reflect(PlatformBraintree.prototype,"PlatformBraintree");var PlatformBZ=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BZ_SDK=window.BZ_SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){var t={gid:SDKConst.BZGid,sub_gid:10066,opr_cid:SDKConst.BZOprCid,adv_cid:101,pkg_id:0,sdk_ver:"1.0.0"};this.BZ_SDK.init(t,function(t,e){console.log("bzmessage:",t.msg,"bzstatus:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",sdkcode:0,data:t}))})},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.openID,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={rtype:e?"create":i?"lvup":"login",cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",part_id:unionControl.guildID,part_name:unionControl.guildName,part_leader_id:"",part_leader_name:"",power:0==ActorControl.power?t.power:ActorControl.power,profession_id:t.job,profession_name:CommonFun.getJobName(t.job),gold:ActorControl.yb,coin:ActorControl.gold,create_ts:GlobalModel.createActorTime};this.BZ_SDK.reportLog(o)},e.prototype.SDKPayNative=function(t){var e={product_id:t.itemid,product_name:t.goodsname,product_desc:t.goodsname,pay_money:t.fee,cp_order_id:t.order,cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",gold:ActorControl.yb,coin:ActorControl.gold,ext:t.order};this.BZ_SDK.genOrder(e)},e.prototype.SDKLogoutNative=function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))},e.prototype.SDKShowLogout=function(){return!0},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if(console.log("SDK callback:",JSON.stringify(i)),"init"==o)0==i.sdkcode&&this.BZ_SDK.login(function(t,e){console.log("data:",t,"status:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t}))});else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.uid+"",GlobalModel.setUrlParamValue("token",n.token),GlobalModel.setUrlParamValue("uname",n.uname),SceneMgr.ins().runScene(StartGameScene)}else window.location.reload();else"logout"==o&&0==i.sdkcode&&(this.BZ_SDK.switchAccount(),window.location.reload())},e}(PlatformBase);__reflect(PlatformBZ.prototype,"PlatformBZ");var PlatformBZH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BZ_SDK=window.BZ_SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.openID,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){var t={gid:SDKConst.BZGid,sub_gid:SDKConst.BZSubGid,opr_cid:SDKConst.BZOprCid,adv_cid:101,pkg_id:0,sdk_ver:"1.0.0"};this.BZ_SDK.init(t,function(t,e){console.log("bzmessage:",t.msg,"bzstatus:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",sdkcode:0,data:t}))})},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={rtype:e?"create":i?"lvup":"login",cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",part_id:unionControl.guildID,part_name:unionControl.guildName,part_leader_id:"",part_leader_name:"",power:0==ActorControl.power?t.power:ActorControl.power,profession_id:t.job,profession_name:CommonFun.getJobName(t.job),gold:ActorControl.yb,coin:ActorControl.gold,create_ts:GlobalModel.createActorTime};this.BZ_SDK.reportLog(o)},e.prototype.SDKPayNative=function(t){var e={product_id:t.itemid,product_name:t.goodsname,product_desc:t.goodsname,pay_money:t.fee,cp_order_id:t.order,cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",gold:ActorControl.yb,coin:ActorControl.gold,ext:t.order};this.BZ_SDK.genOrder(e)},e.prototype.SDKLogoutNative=function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))},e.prototype.SDKShowLogout=function(){return!0},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if(console.log("SDK callback:",JSON.stringify(i)),"init"==o)0==i.sdkcode&&this.BZ_SDK.login(function(t,e){console.log("data:",t,"status:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t}))});else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.uid+"",GlobalModel.setUrlParamValue("token",n.token),GlobalModel.setUrlParamValue("uname",n.uname),SceneMgr.ins().runScene(StartGameScene)}else window.location.reload();else"logout"==o&&0==i.sdkcode&&(this.BZ_SDK.switchAccount(),window.location.reload())},e}(PlatformBase);__reflect(PlatformBZH5.prototype,"PlatformBZH5");var PlatformCandyH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.CYSDK=window.CYSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.CYSDK.CYInitialization(SDKConst.CandyAPP_ID,SDKConst.CandyApp_KEY)},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){this.CYSDK.CYLogin(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t}))})},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={token:GlobalModel.getUrlParamValue("token"),rolesId:ActorControl.actorID+"",roles:{name:ActorControl.myName,le:ActorControl.level}};(i||e)&&this.CYSDK.CYReport(o)},e.prototype.SDKPayNative=function(t){var e={token:GlobalModel.getUrlParamValue("token"),productId:this.getItemID(t.itemid),info:t.order};this.CYSDK.CYPayment(JSON.parse(JSON.stringify(e)),function(t){})},e.prototype.getItemID=function(t){var e="";switch(t){case 509:e="com.zsby.188";break;case 510:e="com.zsby.68";break;default:e=t}return e},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)debug.log("SDK init ok");else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.userID,GlobalModel.nickName=n.loginName,GlobalModel.setUrlParamValue("token",n.loginToken),GlobalModel.setUrlParamValue("isLogin",n.resultType),SceneMgr.ins().runScene(StartGameScene)}else this.SDKLoginNative();else"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformCandyH5.prototype,"PlatformCandyH5");var PlatformCGamex=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return console.log("CGamex loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),egret.ExternalInterface.call("SDKsetDataNative",JSON.stringify({gameRoleID:ActorControl.actorID,gameRoleName:t.nickName,gameUserLevel:ActorControl.level,serverId:t.serverId,serverName:t.serverName}))},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({amount:t.fee,cpOrderID:t.order,serverId:t.serverId,serverName:t.serverName,gameRoleID:ActorControl.actorID,gameRoleName:t.roleName,gameUserLevel:ActorControl.level,extrasParams:t.order}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"login"==o?0==i.sdkcode?(GlobalModel.appid=i.appId,GlobalModel.openID=i.userId,GlobalModel.nickName=i.userName,GlobalModel.setUrlParamValue("token",i.token),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformCGamex.prototype,"PlatformCGamex");var PlatformChengZi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t=Date.now(),e={uid:GlobalModel.openID,time:t,appkey:SDKConst.ChengZiKey},i=Md5Utils.obj_cntstr(e),o={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,time:t,sign:i};return console.log("ChengZi loginData:",JSON.stringify(o)),JSON.stringify(o)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={role_id:ActorControl.actorID,role_name:ActorControl.myName,role_vip:vipControl.lv,role_leve:ActorControl.level,role_serverid:t.serverId},n=JSON.stringify(o);egret.ExternalInterface.call("SDKLevelUpdate",n)},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({paytype:"android"==GlobalModel.os?"gp":"ios"==GlobalModel.os?"ios":"home"})},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({order_price:t.fee,order_itemid:this.GetChannelItemId(t.itemid),order_id:t.order,order_payType:"USD",role_id:ActorControl.actorID,role_name:ActorControl.myName,role_lv:ActorControl.level,serverId:t.serverId,serverName:t.serverName,ext:t.order}))},e.prototype.GetChannelItemId=function(t){return"android"==GlobalModel.os?t=SDKConst.GooglePayProductIdsLzby[t]:"ios"==GlobalModel.os&&(t=SDKConst.IosProductIds[t]),t},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;console.log("SDKCallBack",JSON.stringify(i)),"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("os",i.os),GlobalModel.setUrlParamValue("token",i.user_token),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"checkFailBill"==o?(platformAmuseControl.dispatchGameFBGift(i.fbflag),platformAmuseControl.dispatchGameFBRate(i.rateFlag)):"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformChengZi.prototype,"PlatformChengZi");var PlatformGame8UH5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t=Date.now(),e={uid:GlobalModel.openID,appId:GlobalModel.appid,time:t,support_share:1,support_follow:1,follow:1,age:1,sign:Md5Utils.obj_md5_args({uid:GlobalModel.openID,appid:GlobalModel.appid,time:t,appkey:SDKConst.Game8UH5})};return console.log("Game8u loginData:",JSON.stringify(e)),JSON.stringify(e)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),{isCreateRole:e,isLevelUp:i,roleCreateTime:GlobalModel.createActorTime,uid:GlobalModel.openID,username:GlobalModel.nickName,serverId:t.serverId,serverName:t.serverName,userRoleId:ActorControl.actorID,userRoleName:t.nickName,userRoleBalance:ActorControl.yb,vipLevel:vipControl.lv,userRoleLevel:ActorControl.level,partyId:unionControl.guildID,partyName:unionControl.guildName,gameRoleGender:"",gameRolePower:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone")}},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({paytype:"android"==GlobalModel.os?"gp":"ios"==GlobalModel.os?"ios":"home"})},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverId:t.serverId,serverName:t.serverName,goodsID:this.GetChannelItemId(t.itemid),cpOrderID:t.order,productName:t.goodsname}))},e.prototype.GetChannelItemId=function(t){return"android"==GlobalModel.os?t=SDKConst.GooglePayProductIds[t]:"ios"==GlobalModel.os&&(t=SDKConst.IosProductIds[t]),t},e.prototype.SDKStartForGift=function(){egret.ExternalInterface.call("SDKStartForGift",GlobalModel.srvid.toString())},e.prototype.SDKFaceStartGift=function(){egret.ExternalInterface.call("SDKFaceStartGift",GlobalModel.srvid.toString())},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("os",i.os),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"checkFailBill"==o?(platformAmuseControl.dispatchGameFBGift(i.fbflag),platformAmuseControl.dispatchGameFBRate(i.rateFlag)):"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformGame8UH5.prototype,"PlatformGame8UH5");var PlatformHaoWanBaH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url="https://api.ehw8.com",e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.getUrlParamValue("uid"),token:GlobalModel.getUrlParamValue("token"),shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKPayNative=function(t){var e={orderno:t.orderno,sign:t.gamesign};window.iframePay.open(this.url+"/game/v1/pay?"+this.getUrl(e),function(t){console.log("close pay:",t)})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?SceneMgr.ins().runScene(StartGameScene):this.SDKLoginNative():"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformHaoWanBaH5.prototype,"PlatformHaoWanBaH5");var PlatformHuaWei=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid};return console.log("loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({amount:t.fee,cpOrderID:t.order,serverId:t.serverId,serverName:t.serverName,gameRoleID:ActorControl.actorID,gameRoleName:t.roleName,gameUserLevel:ActorControl.level,extrasParams:t.order,gameSign:t.gameSign}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"login"==o?0==i.sdkcode?(GlobalModel.openID=i.playerId,SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformHuaWei.prototype,"PlatformHuaWei");var PlatformHuoSdk=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="1";e&&(o="2"),i&&(o="3");var n=this.getRoleInfo(t,o);egret.ExternalInterface.call("SDKLevelUpdate",JSON.stringify(n))},e.prototype.getRoleInfo=function(t,e){var i={role_id:ActorControl.actorID,role_level:ActorControl.level,role_name:ActorControl.myName,role_vip:vipControl.lv,server_id:t.serverId,server_name:t.serverName,role_type:e,scene:LangMgr.getValueByKey("guanGK",copyControl.guanqiaID),pos:"(0,0)",desc:LangMgr.getValueByKey("levelbattleing",copyControl.guanqiaID)};return i},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({order_id:t.order,price:t.fee,product_id:t.itemid,product_name:t.goodsname,product_desc:t.goodsname,cny:"CNY",shellext:t.order,playinfo:this.getRoleInfo(t,5)}))
},e.prototype.SDKLogoutNative=function(){egret.ExternalInterface.call("SDKSwitchAccount",null)},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;console.log("SDK callback",JSON.stringify(i)),"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("os",i.os),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformHuoSdk.prototype,"PlatformHuoSdk");var PlatformHuoSdkH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.HuoSdk=window.HuoSdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.HuoSdk.callback={init:function(t){console.log("init:",t),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init"}))},login:function(t){},pay:function(t){},uprole:function(t){},logout:function(t){2==t.status&&SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))}},this.HuoSdk.init({app_id:SDKConst.HuoAppId})},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this.HuoSdk.uprole({"role-event":5,"role-server_id":t.serverId,"role-server_name":t.serverName,"role-role_id":ActorControl.actorID,"role-role_name":t.nickName,"role-role_level":ActorControl.level,"role-role_vip":vipControl.lv,"role-onlineTime":0,"role-scene":"","role-axis":""})},e.prototype.SDKPayNative=function(t){this.HuoSdk.pay({"order-currency":"CNY","order-cp_order_id":t.order,"order-product_price":t.fee,"order-product_id":t.itemid,"order-product_name":t.goodsname,"order-product_desc":t.goodsname,"order-ext":t.order,"role-event":5,"role-server_id":t.serverId,"role-server_name":t.serverName,"role-role_id":ActorControl.actorID,"role-role_name":t.roleName,"role-role_level":ActorControl.level,"role-role_vip":vipControl.lv})},e.prototype.SDKLogoutNative=function(){this.HuoSdk.logout()},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?(GlobalModel.appid=GlobalModel.getUrlParamValue("app_id"),GlobalModel.openID=GlobalModel.getUrlParamValue("mem_id")+"",GlobalModel.setUrlParamValue("token",GlobalModel.getUrlParamValue("user_token"))):"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformHuoSdkH5.prototype,"PlatformHuoSdkH5");var PlatformJianwan=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){GameLoadingUI.GetInstance().showLogin(),t.prototype.SDKLoginNative.call(this)},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return console.log("Jianwan loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),egret.ExternalInterface.call("SDKsetDataNative",JSON.stringify({serverId:t.serverId,serverName:t.serverName,gameRoleName:t.nickName,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,roleCreateTime:GlobalModel.createAccountTime,partyId:unionControl.guildID,gameRoleGender:"",gameRolePower:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone"),isCreate:e,isUpLv:i}))},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverName:t.serverName,gameRoleName:t.roleName,serverId:t.serverId,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,goodsID:t.itemid,productName:t.goodsname,cpOrderID:t.order,count:t.amount,amount:t.fee,extrasParams:t.order}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(GlobalModel.setUrlParamValue("channelId",i.channelId),GlobalModel.openID=i.userId,GlobalModel.nickName=i.userName,GlobalModel.setUrlParamValue("token",i.token),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformJianwan.prototype,"PlatformJianwan");var PlatformJianwanH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.DataSdk=window.DataSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.DataSdk.init(SDKConst.JianwanH5Code,SDKConst.JianwanH5Key,!0,function(){console.log("SDK init ok")}),this.DataSdk.setLogoutNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))})},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return console.log("Jianwan loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKLoginNative=function(){this.DataSdk.login(function(t){t.status?SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data})):SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1}))})},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={isCreateRole:e,isLevelUp:i,roleCreateTime:GlobalModel.createActorTime,uid:GlobalModel.openID,username:GlobalModel.nickName,serverId:t.serverId,serverName:t.serverName,userRoleId:ActorControl.actorID,userRoleName:t.nickName,userRoleBalance:ActorControl.yb,vipLevel:vipControl.lv,userRoleLevel:ActorControl.level,partyId:unionControl.guildID,partyName:unionControl.guildName,gameRoleGender:"",gameRolePower:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone")},n=JSON.stringify(o);this.DataSdk.uploadGameRoleInfo(n,function(t){t.status?debug.log("Upload information successfully"):debug.log("upload information"+t.message)})},e.prototype.SDKPayNative=function(t){var e={productCode:SDKConst.JianwanH5Code,uid:GlobalModel.openID,username:GlobalModel.nickName,userRoleId:ActorControl.actorID,userRoleName:t.roleName,userServer:t.serverName,userLevel:ActorControl.level,cpOrderNo:t.order,amount:t.fee,count:t.amount,quantifier:LangMgr.getValueByKey("howmany"),subject:t.goodsname,desc:t.goodsname,callbackUrl:void 0!=t.callbackUrl?t.callbackUrl:"",extrasParams:t.order,goodsId:t.itemid},i=JSON.stringify(e);this.DataSdk.pay(i,function(t){console.log("DataSdk:Order to inform"+JSON.stringify(t))})},e.prototype.SDKLogoutNative=function(){this.DataSdk.logout(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o){var n=this.DataSdk.getChannelType();GlobalModel.setUrlParamValue("rawChannelId",n),debug.log("SDK init ok channelID:"+n)}else if("login"==o)if(0==i.sdkcode){var r=i.data;GlobalModel.openID=r.uid,GlobalModel.nickName=r.username,GlobalModel.setUrlParamValue("token",r.token),GlobalModel.setUrlParamValue("isLogin",r.isLogin);var n=this.DataSdk.getChannelType()||r.channelId;GlobalModel.setUrlParamValue("rawChannelId",n);var a=this.DataSdk.getExtrasConfig("channel");a&&""!=a||(a=n),GlobalModel.setUrlParamValue("channelId",a),4338==n&&GlobalModel.setUrlParamValue("showMicroclientDownload",!0),(386==n||1034==n)&&GlobalModel.setUrlParamValue("isMicroclient",!0),SceneMgr.ins().runScene(StartGameScene)}else this.SDKLoginNative();else"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformJianwanH5.prototype,"PlatformJianwanH5");var PlatformJiuYuanH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.xgGame=window.xgGame,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("user_id"),DeviceUtils.IsBluntBangs=DeviceUtils.IsIPhone&&("1125x2436"==MobileDevice.getResolution()||"1242x2688"==MobileDevice.getResolution())},e.prototype.SDKIsNeedInit=function(){return!1},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.SDKLoginNative=function(){this.xgGame.login(function(t){t.status?SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data})):SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1}))})},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.openID,game_appid:GlobalModel.getUrlParamValue("game_appid"),email:GlobalModel.getUrlParamValue("email"),new_time:GlobalModel.getUrlParamValue("new_time"),user_id:GlobalModel.getUrlParamValue("user_id"),sdkloginmodel:GlobalModel.getUrlParamValue("sdkloginmodel"),sdklogindomain:GlobalModel.getUrlParamValue("sdklogindomain"),loginplatform2cp:GlobalModel.getUrlParamValue("loginplatform2cp"),channelExt:GlobalModel.getUrlParamValue("channelExt"),sign:GlobalModel.getUrlParamValue("sign")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){},e.prototype.SDKUserUpgradeNative=function(t){},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={user_id:GlobalModel.openID,game_appid:SDKConst.JiuYuanAppid,server_id:t.serverId,server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName},n=this.signData(o,SDKConst.JiuYuanKey);o.sign=n,o.level=this.GetChannelLevel(GlobalModel.channelId,ActorControl.level,reincarnateControl.lv),o.Power=0==ActorControl.power?t.power:ActorControl.power,console.log("Upload parameters:",JSON.stringify(o)),this.xgGame.jointCreateRole(o)},e.prototype.GetChannelLevel=function(t,e,i){return e=1e4*i+e},e.prototype.SDKPayNative=function(t){var e={amount:100*t.fee,channelExt:GlobalModel.getUrlParamValue("channelExt"),game_appid:SDKConst.JiuYuanAppid,props_name:t.goodsname,sdkloginmodel:GlobalModel.getUrlParamValue("sdkloginmodel"),trade_no:t.order,user_id:GlobalModel.openID},i=this.signData(e,SDKConst.JiuYuanKey);e.sign=i,e.server_id=t.serverId,e.server_name=t.serverName,e.role_id=ActorControl.actorID,e.role_name=t.roleName,console.log("pay",JSON.stringify(e)),this.xgGame.h5paySdk(e,function(t){console.log("jiuyuanPay:",t)})},e.prototype.ksort=function(t,e,i){var o,n,r,a={},s=[],l=t,h=!1,u={};switch(i){case"SORT_STRING":o=function(t,e){return l.strnatcmp(t,e)};break;case"SORT_LOCALE_STRING":var c=t.i18n_loc_get_default();o=t.php_js.i18nLocales[c].sorting;break;case"SORT_NUMERIC":o=function(t,e){return t+0-(e+0)};break;default:o=function(t,e){var i=parseFloat(t),o=parseFloat(e),n=i+""===t,r=o+""===e;return n&&r?i>o?1:o>i?-1:0:n&&!r?1:!n&&r?-1:t>e?1:e>t?-1:0}}for(r in e)e.hasOwnProperty(r)&&s.push(r);for(s.sort(o),t.php_js=t.php_js||{},t.php_js.ini=t.php_js.ini||{},h=t.php_js.ini["phpjs.strictForIn"]&&t.php_js.ini["phpjs.strictForIn"].local_value&&"off"!==t.php_js.ini["phpjs.strictForIn"].local_value,u=h?e:u,n=0;n<s.length;n++)r=s[n],a[r]=e[r],h&&delete e[r];for(n in a)a.hasOwnProperty(n)&&(u[n]=a[n]);return h||u},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.signData=function(t,e){return t=this.ksort(this,t),t=this.getUrl(t)+e,EncryptMd5.hex_md5(t)},e.prototype.SDKLogoutNative=function(){window.location.reload()},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o||"login"==o||"logout"!=o&&"switchAccount"!=o||0!=i.sdkcode||window.location.reload()},e.prototype.getStatusHeight=function(){return 40},e.prototype.SDKShowShare=function(){this.xgGame.shareSdk({game_appid:SDKConst.JiuYuanAppid,title:LangMgr.getValueByKey("rexueqidaozhan"),desc:LangMgr.getValueByKey("rexueqidaozhan")},function(t){console.log("Share the results:",t),1==t.status&&platformAmuseControl.upWeiXinInviteGift()})},e}(PlatformBase);__reflect(PlatformJiuYuanH5.prototype,"PlatformJiuYuanH5");var PlatformJiuZun=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loginComplete=!1,e}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(t){egret.ExternalInterface.call("SDKLoginNative","")},e.prototype.SDKHasLoginScene=function(){return egret.getDefinitionByName("JiuZunYHGameScene")},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,serverid:GlobalModel.srvid,Isnew:GlobalModel.getUrlParamValue("Isnew"),Extension:GlobalModel.getUrlParamValue("Extension"),Realuserid:GlobalModel.getUrlParamValue("Realuserid"),ResultCode:GlobalModel.getUrlParamValue("ResultCode"),Token:GlobalModel.getUrlParamValue("Token"),Useraccount:GlobalModel.getUrlParamValue("Useraccount"),Userid:GlobalModel.getUrlParamValue("Userid")};return console.log("loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="0";e?o="1":i&&(o="2"),egret.ExternalInterface.call("SDKRoleDataNative",JSON.stringify({level:ActorControl.level,pf:GlobalModel.getUrlParamValue("pf"),role:t.nickName||GlobalModel.openID,roleid:ActorControl.actorID,roletype:o,serverid:t.serverId,servername:t.serverName,useraccount:GlobalModel.openID,rolegender:t.sex+"",rolebalance:ActorControl.yb+"",rolepower:ActorControl.power+"",viplevel:vipControl.lv+"",partyid:unionControl.guildID+"",partyname:unionControl.guildName+"",partyroleid:"0",partyrolename:"",professionid:ActorControl.job+"",profession:"",friendlist:"",createAccountTime:GlobalModel.createAccountTime,rolecreatetime:GlobalModel.createActorTime}))},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverName:t.serverName,roleName:t.roleName,serverId:t.serverId,roleId:ActorControl.actorID,coinNum:ActorControl.yb,vip:vipControl.lv,roleLevel:ActorControl.level,union:unionControl.guildName,productId:t.itemid,productName:t.goodsname,productDesc:"",cpOrderID:t.order,buyNum:t.amount,price:t.fee*SDKConst.YYBMoneyRate,extension:t.order,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?(debug.log("Game and NetiveSDK init ok"),GlobalModel.setUrlParamValue("appver",i.appver)):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.Userid,GlobalModel.setUrlParamValue("Isnew",i.Isnew),GlobalModel.setUrlParamValue("Extension",i.Extension),GlobalModel.setUrlParamValue("Realuserid",i.Realuserid),GlobalModel.setUrlParamValue("ResultCode",i.ResultCode),GlobalModel.setUrlParamValue("Token",i.Token),GlobalModel.setUrlParamValue("Useraccount",i.Useraccount),GlobalModel.setUrlParamValue("Userid",i.Userid),this.loginComplete||(this.loginComplete=!0,SceneMgr.ins().runScene(StartGameScene))):-2==i.sdkcode?debug.log("aoto login fail"):debug.log("login fail"):"logout"==o||"switchAccount"==o?0==i.sdkcode&&window.location.reload():"pay"==o&&0==i.sdkcode},e.prototype.SDKShowLogout=function(){return!0},e.prototype.SDKLogoutNative=function(){egret.ExternalInterface.call("SDKLogoutNative","")},e}(PlatformBase);__reflect(PlatformJiuZun.prototype,"PlatformJiuZun");var PlatformJiuZunH5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKInitNative=function(){this.JiuZunSDK=window.H5SDK(GlobalModel.getUrlParamValue("sdkappid"),GlobalModel.getUrlParamValue("jzpf"));var t={pf:GlobalModel.getUrlParamValue("jzpf"),sdkappid:GlobalModel.getUrlParamValue("sdkappid"),useraccount:GlobalModel.openID},e=EncryptMd5.hex_md5(this.toolStr(t,SDKConst.JiuZunKey));this.JiuZunSDK.init(GlobalModel.openID,e)},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.toolStr=function(t,e){var i="";for(var o in t)i+=o+"="+t[o]+"&";return i=i.substring(0,i.length-1)+e},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,sdkappid:GlobalModel.getUrlParamValue("sdkappid"),sdkpf:GlobalModel.getUrlParamValue("jzpf"),sign:GlobalModel.getUrlParamValue("sign"),shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="0";e&&(o="1"),i&&(o="2");var n="";48==GlobalModel.gameId||54==GlobalModel.gameId||75==GlobalModel.gameId||80==GlobalModel.gameId?n+=ActorControl.level:(reincarnateControl.lv&&reincarnateControl.lv>0&&(n+=LangMgr.getValueByKey("numberRotation",reincarnateControl.lv)),n+=LangMgr.getValueByKey("numberLevel",ActorControl.level));var r={level:n,pf:GlobalModel.getUrlParamValue("jzpf"),role:t.nickName||GlobalModel.openID,roleid:ActorControl.actorID,roletype:o,sdkappid:GlobalModel.getUrlParamValue("sdkappid"),serverid:t.serverId,servername:t.serverName,useraccount:GlobalModel.openID},a=EncryptMd5.hex_md5(this.toolStr(r,SDKConst.JiuZunKey)),s=JSON.stringify({rolegender:t.sex+"",rolebalance:ActorControl.yb+"",rolepower:(0==ActorControl.power?t.power:ActorControl.power)+"",viplevel:vipControl.lv+"",partyid:unionControl.guildID+"",partyname:unionControl.guildName+"",partyroleid:"0",partyrolename:"",professionid:ActorControl.job?ActorControl.job:"0",profession:"",friendlist:""});debug.log(s,"Report the information attach",o),this.JiuZunSDK.login(o,GlobalModel.openID,t.serverId,t.serverName,ActorControl.actorID,t.nickName||GlobalModel.openID,n,a,s)},e.prototype.SDKPayNative=function(t){var e={ext:t.order,itemname:t.itemid,level:ActorControl.level,money:100*t.fee,pf:GlobalModel.getUrlParamValue("jzpf"),role:ActorControl.myName,roleid:ActorControl.actorID,sdkappid:GlobalModel.getUrlParamValue("sdkappid"),serverid:t.serverId,servername:t.serverName,useraccount:GlobalModel.openID},i=EncryptMd5.hex_md5(this.toolStr(e,SDKConst.JiuZunKey));this.JiuZunSDK.pay(GlobalModel.openID,t.itemid,100*t.fee,t.order,t.serverId,t.serverName,ActorControl.actorID,ActorControl.myName,ActorControl.level,i)},e.prototype.SDKShowShare=function(){this.JiuZunSDK.share(GlobalModel.openID,function(t,e){100==t?console.log("Share success!"):console.log("Share the failure:",e)})},e.prototype.SDKShowQRCode=function(){this.JiuZunSDK.guanzhu(GlobalModel.openID,function(t,e){100==t?console.log("Focus on success!"):console.log("Pay attention to fail:",e)})},e}(PlatformBase);__reflect(PlatformJiuZunH5.prototype,"PlatformJiuZunH5");var PlatformKu25H5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ku25Sdk=window.ku25sdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("userid")+""},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,ext:GlobalModel.getUrlParamValue("ext"),sign:GlobalModel.getUrlParamValue("sign"),gameid:GlobalModel.getUrlParamValue("gameid")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={uid:GlobalModel.openID,gid:GlobalModel.getUrlParamValue("gameid"),server:t.serverId,rolename:t.nickName,rolelevel:ActorControl.level,rolefight:ActorControl.power};o.sign=EncryptMd5.hex_md5(o.uid+""+o.gid+o.server+o.rolelevel+SDKConst.Ku25H5LoginKey);var n=Md5Utils.obj_md5_args(o);ReportData.getIns().reportUrl("http://www.ku25.com/ku25tg/h5report/api.php",n)},e.prototype.SDKPayNative=function(t){var e={userid:GlobalModel.openID,cpuserid:ActorControl.actorID,role:t.roleName,gameid:GlobalModel.getUrlParamValue("gameid"),serverid:t.serverId,orderno:t.order,body:t.goodsname,fee:t.fee,ext:GlobalModel.getUrlParamValue("ext"),time:(Date.now()/1e3).toFixed(0)};e.sign=EncryptMd5.hex_md5(e.userid+""+e.cpuserid+e.orderno+e.gameid+e.serverid+e.fee+e.time+SDKConst.Ku25H5PayKey),this.Ku25Sdk.pay(e)},e}(PlatformBase);__reflect(PlatformKu25H5.prototype,"PlatformKu25H5");var PlatformLuoTuoH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url="https://gameluotuo.com/index.php",e}return __extends(e,t),e.prototype.getSign=function(t){var e=this.ksort(this,t),i=this.getUrl(e);return EncryptMd5.hex_md5(i+SDKConst.LuoTuoAppSecret)},e.prototype.payOnComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?(console.log("pay info get ok"),window.parent.postMessage(e.data,"*")):console.log("pay info get fail"+e.info)}catch(i){console.log("pay fail",i)}},e}(PlatformZwH5);__reflect(PlatformLuoTuoH5.prototype,"PlatformLuoTuoH5");var PlatformOrange=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t=Date.now(),e={uid:GlobalModel.openID,time:t,appkey:SDKConst.ChengZiKey},i=this.getSign(e),o={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,time:t,sign:i};return console.log("Orange loginData:",JSON.stringify(o)),JSON.stringify(o)},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.getSign=function(t){var e=this.getUrl(t);return EncryptMd5.hex_md5(e)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={role_id:ActorControl.actorID,role_name:ActorControl.myName,role_vip:vipControl.lv,role_leve:ActorControl.level,role_serverid:t.serverId},n=JSON.stringify(o);egret.ExternalInterface.call("SDKLevelUpdate",n)},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({order_price:t.fee,order_itemid:this.GetChannelItemId(t.itemid),order_id:t.order,order_payType:"USD",role_id:ActorControl.actorID,role_name:ActorControl.myName,role_lv:ActorControl.level,serverId:t.serverId,serverName:t.serverName,ext:t.order}))},e.prototype.upperCase=function(t){return t?t.substring(0,1).toUpperCase()+t.substring(1):""},e.prototype.GetChannelItemId=function(t){var e=SDKManager.ins().OrangeAppType;switch(e=this.upperCase(e),e=e?e:"Lzby",GlobalModel.os){case"android":t=SDKConst["GooglePayProductIds"+e][t];break;case"ios":t=SDKConst["IosProductIds"+e][t]}return t},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;console.log("SDK callback",JSON.stringify(i)),"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("os",i.os),GlobalModel.setUrlParamValue("token",i.user_token),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"checkFailBill"==o?(platformAmuseControl.dispatchGameFBGift(i.fbflag),platformAmuseControl.dispatchGameFBRate(i.rateFlag)):"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformOrange.prototype,"PlatformOrange");var PlatformOrangeH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SbPulSdk=window.SbPulSdk,e.baseGKLeve=0,e}return __extends(e,t),e.prototype.SDKInitNative=function(){var t={qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),qqesnickname:GlobalModel.getUrlParamValue("qqesnickname"),qqesavatar:GlobalModel.getUrlParamValue("qqesavatar"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),ext:GlobalModel.GetSearchParamByName("ext"),qqestimestamp:GlobalModel.getUrlParamValue("qqestimestamp")};t.sign=Md5Utils.obj_md5(t,SDKConst.BZSecret,["qqesavatar"]),GlobalModel.openID=GlobalModel.getUrlParamValue("qqesuid"),this.SbPulSdk.init(t,function(t){}),window.onunload=this.SDKLogoutNative},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,time:Date.now(),sign:GlobalModel.getUrlParamValue("sign"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),qqesnickname:GlobalModel.getUrlParamValue("qqesnickname"),qqesavatar:GlobalModel.getUrlParamValue("qqesavatar"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),ext:GlobalModel.GetSearchParamByName("ext"),qqestimestamp:GlobalModel.getUrlParamValue("qqestimestamp")};return JSON.stringify(t)},e.prototype.SDKEnterGameNative=function(t){var e={cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),serverId:t.serverId,serverName:t.serverName,roleId:ActorControl.actorID,rolePower:0==ActorControl.power?t.power:ActorControl.power,roleName:CommonFun.getJobName(t.job),nickName:t.nickName,level:1e3*t.zsLevel+t.level,vip:t.vip};this.SbPulSdk.beginGame(e),this.baseGKLeve=copyControl.guanqiaID},e.prototype.SDKCreateRoleNative=function(t){var e={qqesuid:GlobalModel.getUrlParamValue("qqesuid"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),serverId:t.serverId,serverName:t.serverName,roleId:ActorControl.actorID,rolePower:0==ActorControl.power?t.power:ActorControl.power,roleLevel:ActorControl.level,roleName:CommonFun.getJobName(t.job),nickName:t.nickName};this.SbPulSdk.createRole(e),GlobalModel.serverNumberPlyer<=1&&this.SbPulSdk.finishRegister()},e.prototype.SDKUserUpgradeNative=function(t){var e={cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),serverId:t.serverId,serverName:t.serverName,roleId:ActorControl.actorID,rolePower:0==ActorControl.power?t.power:ActorControl.power,roleName:CommonFun.getJobName(t.job),professionId:t.job,nickName:t.nickName,level:1e3*t.zsLevel+t.level,vip:vipControl.lv};this.SbPulSdk.userUpgrade(e),copyControl.guanqiaID>=18&&this.baseGKLeve<18&&GlobalModel.serverNumberPlyer<=1&&(this.SbPulSdk.finishLead(),this.baseGKLeve=copyControl.guanqiaID)},e.prototype.SDKPayNative=function(t){var e={order:t.order,cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),goodsname:t.goodsname,fee:t.fee,serverID:t.serverId,serverName:t.serverName,roleName:t.roleName,roleId:ActorControl.actorID,ext:GlobalModel.GetSearchParamByName("ext"),timestamp:Date.now()};e.sign=Md5Utils.obj_md5(e,SDKConst.BZSecret,["serverID","serverName","roleName","roleId"]),console.log("SDK pay:",e),this.SbPulSdk.pay(e)},e.prototype.SDKSetDataNative=function(t){this.SbPulSdk.buryingPoint({roleName:t.roleName,nickName:t.nickName,serverId:t.serverId,level:t.level,pointId:t.pointId,pointName:t.pointName,roleId:ActorControl.actorID,serverName:t.serverName,vip:t.vip,cpgameid:t.cpgameid,qqesuid:t.qqesuid,channelid:t.channelid,channeluid:t.channeluid})},e.prototype.SDKLogoutNative=function(){this.SbPulSdk.loginout(function(){debug.log("exit ok")})},e}(PlatformBase);__reflect(PlatformOrangeH5.prototype,"PlatformOrangeH5");var PlatformQQMiniGame=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.startTime=0,e}return __extends(e,t),e.prototype.SDKInitNative=function(){var t=this;window.qq.getSystemInfo({success:function(t){(-1!=t.model.search("iPhone X")||-1!=t.model.search("iPhone XR")||-1!=t.model.search("iPhone XS Max"))&&(DeviceUtils.IsBluntBangs=!0)}}),window.qq.onShow(function(e){0!=t.startTime&&egret.getTimer()-t.startTime>5e3&&(t.startTime=0,SocketConnection.ins().reLogin());var i=window.qq.getUpdateManager();i.onCheckForUpdate(function(t){console.log("upData:",t.hasUpdate)}),i.onUpdateReady(function(){window.qq.showModal({title:LangMgr.getValueByKey("updataTips"),content:LangMgr.getValueByKey("newversionready"),success:function(t){t.confirm&&i.applyUpdate()}})}),i.onUpdateFailed(function(){console.log("new ver load fail")})}),window.qq.onHide(function(){t.startTime=egret.getTimer()})},e.prototype.SDKIsNeedLoginNative=function(){return!GlobalModel.openID},e.prototype.SDKLoginNative=function(){window.qq.login({success:function(t){console.log("login ok:",t)},fail:function(){console.log("login fail!")}}),SceneMgr.ins().runScene(LoginScene)},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion};return console.log("QQMiniGame loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({subject:t.itemName})},e.prototype.SDKPayNative=function(t){},e}(PlatformBase);__reflect(PlatformQQMiniGame.prototype,"PlatformQQMiniGame");var PlatformQuick=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0
},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return console.log("Quick loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),egret.ExternalInterface.call("SDKsetDataNative",JSON.stringify({serverId:t.serverId,serverName:t.serverName,gameRoleName:t.nickName,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,roleCreateTime:GlobalModel.createAccountTime,partyId:unionControl.guildID,gameRoleGender:"",gameRolePower:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone"),isCreate:e,isUpLv:i,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime}))},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverName:t.serverName,gameRoleName:t.roleName,serverId:t.serverId,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,goodsID:t.itemid,productName:t.goodsname,cpOrderID:t.order,count:t.amount,amount:t.fee,extrasParams:t.order,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(i.channelId&&GlobalModel.setUrlParamValue("channelId",i.channelId),GlobalModel.openID=i.userId,GlobalModel.nickName=i.userName,GlobalModel.setUrlParamValue("token",i.token),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformQuick.prototype,"PlatformQuick");var PlatformQuickH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.QuickSDK=window.QuickSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.QuickSDK.init(SDKConst.QuickH5ProductCode,SDKConst.QuickH5ProductKey,!1,function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"init"}))}),this.QuickSDK.setSwitchAccountNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"switchAccount",sdkcode:0}))}),this.QuickSDK.setLogoutNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))})},e.prototype.SDKIsNeedInit=function(){return!0},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){this.QuickSDK.login(function(t){t.status?SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data})):SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1}))})},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token"),isLogin:GlobalModel.getUrlParamValue("isLogin"),shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={isCreateRole:e,uid:GlobalModel.openID,username:GlobalModel.nickName,serverId:t.serverId,serverName:t.serverName,userRoleId:ActorControl.actorID,userRoleName:t.nickName,userRoleBalance:ActorControl.yb,vipLevel:vipControl.lv,userRoleLevel:this.GetChannelLevel(GlobalModel.channelId,ActorControl.level,reincarnateControl.lv),partyId:unionControl.guildID,partyName:unionControl.guildName,gameRoleGender:"",gameRolePower:0==ActorControl.power?t.power:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone"),roleCreateTime:GlobalModel.createActorTime},n=JSON.stringify(o);this.QuickSDK.uploadGameRoleInfo(n,function(t){t.status?debug.log("Upload information successfully"):debug.log("Upload information fail:",t.message)})},e.prototype.GetChannelLevel=function(t,e,i){return void 0==i?e:((4289==t||4326==t)&&(e=1e4*i+e),e)},e.prototype.SDKPayNative=function(t){var e={productCode:SDKConst.QuickH5ProductCode,uid:GlobalModel.openID,username:GlobalModel.nickName,userRoleId:ActorControl.actorID,userRoleName:t.roleName,serverId:t.serverId,userServer:t.serverName,userLevel:ActorControl.level,cpOrderNo:t.order,amount:t.fee,count:t.amount,quantifier:LangMgr.getValueByKey("howmany"),subject:t.goodsname,desc:t.goodsname,callbackUrl:void 0!=t.callbackUrl?t.callbackUrl:"",extrasParams:t.order,goodsId:this.GetChannelItemId(GlobalModel.channelId,t.itemid)},i=JSON.stringify(e);this.QuickSDK.pay(i,function(t){console.log("QuickH5:Order to inform"+JSON.stringify(t))})},e.prototype.GetChannelItemId=function(t,e){return 4245==t&&(e=SDKConst.Quick1758H5[e]),e},e.prototype.SDKLogoutNative=function(){this.QuickSDK.logout(function(t){console.log("Game:exit ok")})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o){var n=this.QuickSDK.getChannelType();GlobalModel.setUrlParamValue("rawChannelId",n),debug.log("SDK init ok ChannelId:",n),this.SDKIsNeedInit()&&SDKManager.ins().SDKInitComplete()}else if("login"==o)if(0==i.sdkcode){var r=i.data;GlobalModel.openID=""+r.uid,GlobalModel.nickName=r.username,GlobalModel.setUrlParamValue("token",r.token),GlobalModel.setUrlParamValue("isLogin",r.isLogin);var n=this.QuickSDK.getChannelType()||r.channelId;GlobalModel.setUrlParamValue("rawChannelId",n);var a=this.QuickSDK.getExtrasConfig("channel");a&&""!=a||(a=n),GlobalModel.setUrlParamValue("channelId",a),4338==n&&GlobalModel.setUrlParamValue("showMicroclientDownload",!0),(386==n||1034==n)&&GlobalModel.setUrlParamValue("isMicroclient",!0),SceneMgr.ins().runScene(StartGameScene)}else this.SDKLoginNative();else"logout"!=o&&"switchAccount"!=o||0!=i.sdkcode||GlobalModel.openQuickReload&&window.location.reload()},e}(PlatformBase);__reflect(PlatformQuickH5.prototype,"PlatformQuickH5");var PlatformQuickH5TY=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.QuickSDK=window.QuickSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.QuickSDK.init(GlobalModel.QuickH5ProductCode,GlobalModel.QuickH5ProductKey,!1,function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"init"}))}),this.QuickSDK.setSwitchAccountNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"switchAccount",sdkcode:0}))}),this.QuickSDK.setLogoutNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))}),DeviceUtils.IsBluntBangs=DeviceUtils.IsIPhone&&("1125x2436"==MobileDevice.getResolution()||"1242x2688"==MobileDevice.getResolution())},e.prototype.SDKIsNeedInit=function(){return!0},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){this.QuickSDK.login(function(t){t.status?SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data})):SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1}))})},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token"),isLogin:GlobalModel.getUrlParamValue("isLogin"),shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={isCreateRole:e,uid:GlobalModel.openID,username:GlobalModel.nickName,serverId:t.serverId,serverName:t.serverName,userRoleId:ActorControl.actorID,userRoleName:t.nickName,userRoleBalance:ActorControl.yb,vipLevel:vipControl.lv,userRoleLevel:this.GetChannelLevel(GlobalModel.channelId,ActorControl.level,reincarnateControl.lv),partyId:unionControl.guildID,partyName:unionControl.guildName,gameRoleGender:"",gameRolePower:0==ActorControl.power?t.power:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone"),roleCreateTime:GlobalModel.createActorTime},n=JSON.stringify(o);this.QuickSDK.uploadGameRoleInfo(n,function(t){t.status?debug.log("Upload information successfully"):debug.log("Upload information fail:",t.message)}),"4515"==GlobalModel.channelId&&ReportData.getIns().reportChannelData(ActorControl.level,1)},e.prototype.GetChannelLevel=function(t,e,i){return void 0==i?e:((4289==t||4326==t)&&(e=1e4*i+e),e)},e.prototype.SDKPayNative=function(t){var e={productCode:SDKConst.QuickH5ProductCode,uid:GlobalModel.openID,username:GlobalModel.nickName,userRoleId:ActorControl.actorID,userRoleName:t.roleName,serverId:t.serverId,userServer:t.serverName,userLevel:ActorControl.level,cpOrderNo:t.order,amount:t.fee,count:t.amount,quantifier:LangMgr.getValueByKey("howmany"),subject:t.goodsname,desc:t.goodsname,callbackUrl:void 0!=t.callbackUrl?t.callbackUrl:"",extrasParams:t.order,goodsId:this.GetChannelItemId(GlobalModel.channelId,t.itemid)},i=JSON.stringify(e);this.QuickSDK.pay(i,function(e){console.log("QuickH5:Order to inform"+JSON.stringify(e)),"4515"==GlobalModel.channelId&&ReportData.getIns().reportChannelData(t.fee,2)})},e.prototype.GetChannelItemId=function(t,e){return 4245==t&&(e=SDKConst.Quick1758H5[e]),e},e.prototype.SDKLogoutNative=function(){this.QuickSDK.logout(function(t){window.location.reload()})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o){var n=this.QuickSDK.getChannelType();GlobalModel.setUrlParamValue("rawChannelId",n),debug.log("SDK init ok ChannelId:",n),this.SDKIsNeedInit()&&SDKManager.ins().SDKInitComplete()}else if("login"==o)if(0==i.sdkcode){var r=i.data;GlobalModel.openID=""+r.uid,GlobalModel.nickName=r.username,GlobalModel.setUrlParamValue("token",r.token),GlobalModel.setUrlParamValue("isLogin",r.isLogin);var n=this.QuickSDK.getChannelType()||r.channelId;GlobalModel.setUrlParamValue("rawChannelId",n);var a=this.QuickSDK.getExtrasConfig("channel");a&&""!=a||(a=n),GlobalModel.setUrlParamValue("channelId",a),4338==n&&GlobalModel.setUrlParamValue("showMicroclientDownload",!0),(386==n||1034==n)&&GlobalModel.setUrlParamValue("isMicroclient",!0),4552==n&&(GlobalModel.realNameState=r.realName,r.realName<=0&&this.QuickSDK.getExtendsVal("getRealNameMsg",this.realNameCallBack)),SceneMgr.ins().runScene(StartGameScene)}else this.SDKLoginNative();else"logout"!=o&&"switchAccount"!=o||0!=i.sdkcode||GlobalModel.openQuickReload&&window.location.reload()},e.prototype.realNameCallBack=function(t){GlobalModel.realNameState=1},e.prototype.SDKShowLogout=function(){var t=GlobalModel.getUrlParamValue("rawChannelId");return 32==t},e.prototype.getStatusHeight=function(){return 40},e}(PlatformBase);__reflect(PlatformQuickH5TY.prototype,"PlatformQuickH5TY");var PlatformQuickH5WD=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.QuickSDK=window.QuickSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.QuickSDK.init(SDKConst.QuickH5WDProductCode,SDKConst.QuickH5WDProductKey,!1),this.QuickSDK.setSwitchAccountNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"switchAccount",sdkcode:0}))}),this.QuickSDK.setLogoutNotification(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))}),this.nativeCallback(JSON.stringify({callType:"init"}))},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){this.QuickSDK.login(function(t){t.status?SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t.data})):SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1}))})},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token"),isLogin:GlobalModel.getUrlParamValue("isLogin")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={isCreateRole:e,uid:GlobalModel.openID,username:GlobalModel.nickName,serverId:t.serverId,serverName:t.serverName,userRoleId:ActorControl.actorID,userRoleName:t.nickName,userRoleBalance:ActorControl.yb,vipLevel:vipControl.lv,userRoleLevel:this.GetChannelLevel(GlobalModel.channelId,ActorControl.level,reincarnateControl.lv),partyId:unionControl.guildID,partyName:unionControl.guildName,gameRoleGender:"",gameRolePower:0==ActorControl.power?t.power:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone"),roleCreateTime:GlobalModel.createActorTime},n=JSON.stringify(o);this.QuickSDK.uploadGameRoleInfo(n,function(t){t.status?debug.log("Upload information successfully"):debug.log("Upload information fail:",t.message)})},e.prototype.GetChannelLevel=function(t,e,i){return void 0==i?e:((4289==t||4326==t)&&(e=1e4*i+e),e)},e.prototype.SDKPayNative=function(t){var e={productCode:SDKConst.QuickH5ProductCode,uid:GlobalModel.openID,username:GlobalModel.nickName,userRoleId:ActorControl.actorID,userRoleName:t.roleName,serverId:t.serverId,userServer:t.serverName,userLevel:ActorControl.level,cpOrderNo:t.order,amount:t.fee,count:t.amount,quantifier:LangMgr.getValueByKey("howmany"),subject:t.goodsname,desc:t.goodsname,callbackUrl:void 0!=t.callbackUrl?t.callbackUrl:"",extrasParams:t.order,goodsId:this.GetChannelItemId(GlobalModel.channelId,t.itemid)},i=JSON.stringify(e);this.QuickSDK.pay(i,function(t){console.log("QuickH5:Order to inform"+JSON.stringify(t))})},e.prototype.GetChannelItemId=function(t,e){return 4245==t&&(e=SDKConst.Quick1758H5[e]),e},e.prototype.SDKLogoutNative=function(){this.QuickSDK.logout(function(t){console.log("Game:exit ok")})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)debug.log("SDK init ok");else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=""+n.uid,GlobalModel.nickName=n.username,GlobalModel.setUrlParamValue("token",n.token),GlobalModel.setUrlParamValue("isLogin",n.isLogin);var r=this.QuickSDK.getExtrasConfig("channel");r&&""!=r||(r=this.QuickSDK.getChannelType()||n.channelId),GlobalModel.setUrlParamValue("channelId",r),SceneMgr.ins().runScene(StartGameScene)}else this.SDKLoginNative();else"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformQuickH5WD.prototype,"PlatformQuickH5WD");var PlatformQunHeiH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.QhSdk=window.qhsdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("username"),this.QhSdk.init({username:GlobalModel.openID,gid:SDKConst.QhGameId,qhchannel:GlobalModel.getUrlParamValue("qhchannel"),qhchannelid:GlobalModel.getUrlParamValue("qhchannelid"),time:GlobalModel.getUrlParamValue("time")}),this.QhSdk.iswxgz(function(t){console.log("state:",t.code),1!=t.code?platformAmuseControl.dispatchGuanZhu(0):platformAmuseControl.focusState=1})},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,serverid:GlobalModel.getUrlParamValue("serverid"),isadult:GlobalModel.getUrlParamValue("isadult"),time:GlobalModel.getUrlParamValue("time"),flag:GlobalModel.getUrlParamValue("flag")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1),this.QhSdk.role({act:e?"1":"2",serverid:t.serverId,rolename:t.serverName,roleid:ActorControl.actorID,level:ActorControl.level,power:ActorControl.power})},e.prototype.SDKPayNative=function(t){var e={userId:GlobalModel.openID,gid:SDKConst.QhGameId,roleName:t.roleName,goodsId:t.itemid,goodsName:t.goodsname,money:t.fee,ext:t.order,serverId:t.serverId,roleId:ActorControl.actorID,sign:EncryptMd5.hex_md5(t.fee+GlobalModel.openID+t.order+SDKConst.QunHeiH5ChargeKey)};this.QhSdk.pay(e,function(t,e){})},e.prototype.SDKShowShare=function(){this.QhSdk.share()},e.prototype.SDKShowQRCode=function(){this.QhSdk.wxgz()},e}(PlatformBase);__reflect(PlatformQunHeiH5.prototype,"PlatformQunHeiH5");var PlatformQuTouTiaoCPL=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){},e.prototype.SDKEnterGameNative=function(t){},e.prototype.SDKUserUpgradeNative=function(t){},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({ServerName:t.serverName,serverId:Number(t.serverId),UserId:GlobalModel.openID,RoleId:ActorControl.actorID,GoodsName:t.goodsname,OrderId:t.order,amount:t.fee*SDKConst.YYBMoneyRate,extrasParams:t.order,NoticeUrl:GlobalModel.getUrlParamValue("notifyUrl")}))},e.prototype.SDKTapExecute=function(){},e}(PlatformBase);__reflect(PlatformQuTouTiaoCPL.prototype,"PlatformQuTouTiaoCPL");var PlatformQuTouTiaoH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.QttSDK=window.qttGame,e}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.QttSDK.addNewRole({game_role:t.nickName,game_region:t.serverName,extend_info:{type:"newRole"}})},e.prototype.SDKEnterGameNative=function(t){this.QttSDK.startPlayGame({open_id:GlobalModel.openID,extend_info:{type:"enterGame"}})},e.prototype.SDKUserUpgradeNative=function(t){this.QttSDK.userInfo({role:t.nickName,region:t.serverName,level:ActorControl.level,ce:ActorControl.power,extend_info:{type:"up"}})},e.prototype.SDKPayNative=function(t){var e={money:100*t.fee,notifyUrl:GlobalModel.getUrlParamValue("notifyUrl"),openId:GlobalModel.openID,platform:GlobalModel.getUrlParamValue("platform"),land:GlobalModel.getUrlParamValue("land"),gameName:GlobalModel.getUrlParamValue("htmlTitle"),appId:GlobalModel.getUrlParamValue("appId"),ext:JSON.stringify({orderid:t.order})};this.QttSDK.pay(e)},e.prototype.SDKTapExecute=function(){this.QttSDK.openDialogMission()},e}(PlatformBase);__reflect(PlatformQuTouTiaoH5.prototype,"PlatformQuTouTiaoH5");var PlatformSdwH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SdwSDK=window.sdw,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid"),this.SdwSDK.getSdwQcodeInfo(GlobalModel.getUrlParamValue("appid"),function(t){console.log("state:",t.atSDW),1!=t.atSDW?platformAmuseControl.dispatchGuanZhu(0):platformAmuseControl.focusState=1}),this.SdwSDK.onSetShareOperate({title:"",desc:"",link:"",imgUrl:"",success:function(){platformAmuseControl.upWeiXinInviteGift()},cancel:function(){},fail:function(){}})},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,channel:GlobalModel.getUrlParamValue("channel"),appid:GlobalModel.getUrlParamValue("appid"),time:GlobalModel.getUrlParamValue("time"),sign:GlobalModel.getUrlParamValue("sign")};return console.log("loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t)},e.prototype.setData=function(t,e){void 0===e&&(e=!1),this.SdwSDK.postGameInfo({uid:Number(GlobalModel.openID),appid:GlobalModel.getUrlParamValue("appid"),channel:Number(GlobalModel.getUrlParamValue("channel")),id:GlobalModel.openID,nick:t.nickName,sid:t.serverId+"",sname:t.serverName,level:ActorControl.level,type:"RPG",vip:vipControl.lv,power:ActorControl.power,"new":e?0:1})},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({timestamp:t.timestamp,channel:GlobalModel.getUrlParamValue("channel"),subject:t.itemName,wxopenid:GlobalModel.getUrlParamValue("openid")||"",call_back_url:GlobalModel.getUrlParamValue("cburl"),merchant_url:GlobalModel.getUrlParamValue("cburl")})},e.prototype.SDKPayNative=function(t){this.SdwSDK.chooseSDWPay({subject:t.goodsname,appId:GlobalModel.getUrlParamValue("appid"),gameName:GlobalModel.getUrlParamValue("gamename"),accountId:GlobalModel.openID,amount:100*t.fee,cpOrderId:t.order,paychannel:"",call_back_url:GlobalModel.getUrlParamValue("cburl"),merchant_url:GlobalModel.getUrlParamValue("cburl"),sign:t.gameSign,timestamp:t.timestamp,channel:GlobalModel.getUrlParamValue("channel"),wxopenid:GlobalModel.getUrlParamValue("openid")||"",complete:function(t){}})},e.prototype.SDKShowQRCode=function(){this.SdwSDK.onShowQcode(GlobalModel.getUrlParamValue("appid"))},e}(PlatformBase);__reflect(PlatformSdwH5.prototype,"PlatformSdwH5");var PlatformSmileGamesH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameUrl="https://game.smilegames.cn/unicomPlugin/",e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,sign:GlobalModel.getUrlParamValue("sign"),u_token:GlobalModel.getUrlParamValue("u_token"),time:GlobalModel.getUrlParamValue("time"),appid:SDKConst.SmileGamesH5Appid,uid:GlobalModel.getUrlParamValue("uid"),shellext:GlobalModel.GetSearchParamByName("shellext")};return JSON.stringify(t)},e.prototype.getUrlData=function(t){var e=new Object,i=t;if(-1!=i.indexOf("?"))for(var o=i.substr(1),n=o.split("&"),r=0;r<n.length;r++)e[n[r].split("=")[0]]=n[r].split("=")[1];return e},e.prototype.SDKPayNative=function(t){var e=this.getUrlData(t.paydata.url),i={money:e.amount,appid:e.appid,serverid:e.serverid,uid:e.uid,amount:e.amount,extinfo:e.extinfo,sign:e.sign};window.parent.postMessage(i,"*")},e}(PlatformBase);__reflect(PlatformSmileGamesH5.prototype,"PlatformSmileGamesH5");var PlatformSoeasyH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ZmSdk=window.ZmSdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token"),isLogin:GlobalModel.getUrlParamValue("isLogin"),t:GlobalModel.getUrlParamValue("t"),sign:GlobalModel.getUrlParamValue("sign")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o=3;e&&(o=2),i&&(o=4);var n={datatype:o,serverid:t.serverId,servername:t.serverName,roleid:ActorControl.actorID,rolename:t.nickName,rolelevel:ActorControl.level,fightvalue:ActorControl.power,moneynum:ActorControl.yb,rolecreatetime:GlobalModel.createActorTime,rolelevelmtime:"",gender:"",professionid:t.job,profession:CommonFun.getJobName(t.job),vip:vipControl.lv,partyid:unionControl.guildID,partyname:unionControl.guildName,partyroleid:unionControl.guildID,partyrolename:unionControl.guildName,friendlist:[]};this.ZmSdk.getInstance().reportRoleStatus(n)},e.prototype.SDKPayNative=function(t){var e=100*t.fee,i={check:EncryptMd5.hex_md5(e+""+t.itemid+SDKConst.SoeasyH5SeceretKey),feeid:t.itemid,fee:e,feename:t.goodsname,extradata:t.order,serverid:t.serverId,rolename:t.roleName,roleid:ActorControl.actorID,servername:t.serverName,rolelevel:ActorControl.level};this.ZmSdk.getInstance().pay(i,function(t){console.log("SoeasyH5:Order to inform"+JSON.stringify(t))})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o){this.ZmSdk=window.ZmSdk;var n=i.data;GlobalModel.setUrlParamValue("channelId",n.common.channel),GlobalModel.setUrlParamValue("sdkindx",n.common.sdkindx),GlobalModel.setUrlParamValue("sdkname",n.common.sdkname),GlobalModel.openID=n.userdata.uid,GlobalModel.nickName=n.userdata.name,GlobalModel.setUrlParamValue("t",n.userdata.t),GlobalModel.setUrlParamValue("sign",n.userdata.sign)}},e}(PlatformBase);__reflect(PlatformSoeasyH5.prototype,"PlatformSoeasyH5");var PlatformTest=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKInitNative=function(){this.nativeCallback(JSON.stringify({callType:"init"}))},e.prototype.SDKIsNeedLoginNative=function(){return!GlobalModel.openID},e.prototype.SDKLoginNative=function(){SceneMgr.ins().runScene(LoginScene)},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,isSupper:GlobalModel.getUrlParamValue("isDebug")?1:0};return JSON.stringify(t)},e.prototype.showSuperVip=function(){return"52"==GlobalModel.pfid},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({subject:t.itemName})},e.prototype.SDKPayNative=function(t){(t.itemid/100>>0==2||t.itemid/100>>0==4)&&(t.itemid=t.itemid%100>>0),payControl.upPayDebug(t.itemid)},e.prototype.SDKMiniAuditVer=function(){return SDKConst.WXTestMiniAuditVer},e.prototype.SDKShowShare=function(t){window.wx&&window.wx.shareAppMessage&&window.wx.shareAppMessage({title:"TestShare",imageUrl:""}),t&&t instanceof Function&&t()},e.prototype.isShowSharePortalIcon=function(){return!0},e}(PlatformBase);__reflect(PlatformTest.prototype,"PlatformTest");var PlatformTongChengH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TCYSDK=window.TCYSDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("UserId")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.SDKLoginNative=function(){},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,timestamp:GlobalModel.getUrlParamValue("Timestamp"),sign:GlobalModel.getUrlParamValue("Sign"),shellext:GlobalModel.getUrlParamValue("shellext"),accesstoken:GlobalModel.getUrlParamValue("accesstoken")};return console.log("SDK loginData",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){var e={AppId:SDKConst.TongChengAppid,ServerId:t.serverId};this.TCYSDK.start("TCYSDK_LOGIN",e)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={AppId:SDKConst.TongChengAppid,ServerId:t.serverId,RoleName:t.nickName,GameLevel:ActorControl.level,CreateTime:GlobalModel.createActorTime};this.TCYSDK.start("TCYSDK_PUT_ROLE",o)},e.prototype.getAES=function(t){var e=SDKConst.TongChengAppSecret,i=SDKConst.TongChengAppSecret.substr(0,16),o=this.getAesString(t,e,i);return o},e.prototype.getAesString=function(t,e,i){var e=window.CryptoJS.enc.Utf8.parse(e),i=window.CryptoJS.enc.Utf8.parse(i),o=window.CryptoJS.AES.encrypt(t,e,{iv:i,mode:window.CryptoJS.mode.CBC,padding:window.CryptoJS.pad.Pkcs7});return o.toString()},e.prototype.SDKPayNative=function(t){var e={ProductSubject:t.goodsname,Price:t.fee,ProductBody:t.goodsname,OutOrderInfo:t.OutOrderInfo,OutOrderInfoSign:t.OutOrderInfoSign,Ext:t.order};console.log("pay data:",e),this.TCYSDK.start("TCYSDK_PAY",e,function(t,e){console.log(t,e)})},e.prototype.SDKLogoutNative=function(){window.location.reload()},e}(PlatformBase);__reflect(PlatformTongChengH5.prototype,"PlatformTongChengH5");var PlatformUc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,sid:GlobalModel.getUrlParamValue("sid"),shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("UC loginData:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1)},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({openID:GlobalModel.openID,serverName:t.serverName,gameRoleName:t.roleName,serverId:t.serverId,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,goodsID:t.itemid,productName:t.goodsname,cpOrderID:t.order,count:t.amount,amount:t.fee,extrasParams:t.order,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime,gameSign:t.gameSign}))},e.prototype.nativeCallback=function(e){var i=Base64.base64decode(e);t.prototype.nativeCallback.call(this,i);var o=JSON.parse(i),n=o.callType;if("init"==n)debug.log("SDK init ok");else if("login"==n)if(0==o.sdkcode){GlobalModel.setUrlParamValue("sid",o.sid);var r={sid:o.sid},a=Md5Utils.obj_md5_args(r);debug.log("UC Get UID parm:"+a),PHPConfig.requestPhpData("https://ltserver.xcvgame.top/uc/"+GlobalModel.gameId+"/sdkurlcallback",a,function(t){var i=JSON.parse(t.currentTarget.response);
console.log("UC parm:",t.currentTarget.response),1==i.status?(GlobalModel.openID=i.guid,GlobalModel.setUrlParamValue("shellext",i.shellext),SceneMgr.ins().runScene(StartGameScene)):(console.log("get UC id error!!!"),SDKManager.ins().NativeCallback(e))},this,function(t){console.log("get UC id error!!!"),SDKManager.ins().NativeCallback(e)})}else this.SDKLoginNative();else"logout"==n&&0==o.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformUc.prototype,"PlatformUc");var PlatformUCMiniGame=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKInitNative=function(){DeviceUtils.IsBluntBangs=!0,window.uc.getSystemInfo({success:function(t){e.systemInfo=t,console.log("phone Info",t),console.log("phone Type",MobileDevice.model)}})},e.prototype.SDKMiniAuditVer=function(){return SDKConst.UCMiniAuditVer},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){window.uc.login({success:function(t){console.log("login ok:",t),e.getUserOpenId(t.code)},fail:function(t){console.log("login fail:",t),e.ucLoginFail()}})},e.ucLoginFail=function(){window.uc.showModal({title:LangMgr.getValueByKey("loginfail"),content:LangMgr.getValueByKey("needrelogin"),cancelText:LangMgr.getValueByKey("relogin"),success:function(t){SDKManager.ins().SDKLoginNative()},fail:function(t){SDKManager.ins().SDKLoginNative()}})},e.getUserOpenId=function(t){var e={code:t},i=Md5Utils.obj_md5_args(e);console.log("UC get UID parm:"+i),PHPConfig.requestPhpData(GlobalModel.sdkDomain+"/"+GlobalModel.pf.toLowerCase()+"/"+GlobalModel.gameId+"/sdkurlcallback",i,function(t){console.log("UC parm:",t.currentTarget.response);var e=JSON.parse(t.currentTarget.response);1==e.status?(GlobalModel.openID=e.uid,GlobalModel.setUrlParamValue("session_key",e.session_key),GlobalModel.setUrlParamValue("shellext",e.shellext),SceneMgr.ins().runScene(StartGameScene)):console.log("get UC account error!!!")},this,function(t){console.log("get UC account error!!!")})},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("UCMiniGame loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.CheckSupportRecharge=function(){return e.systemInfo&&"iOS"==e.systemInfo.platform?(window.uc.showToast({content:LangMgr.getValueByKey("iosnonsupportpay")}),!1):!0},e.prototype.SDKPayNative=function(t){return e.systemInfo&&this.compareVersion(e.systemInfo.SDKVersion,"1.0.1")<0?void window.uc.showToast({content:LangMgr.getValueByKey("updataucie")}):(console.log("call Uc pay:",SDKConst.UcPayBizId,t),void window.uc.requestPayment({biz_id:SDKConst.UcPayBizId,token:t.paydata.token,trade_id:t.paydata.trade_id,success:function(t){console.log("pay ok:",t)},fail:function(t){console.log("pay fail:",t)}}))},e.prototype.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var i=Math.max(t.length,e.length);t.length<i;)t.push("0");for(;e.length<i;)e.push("0");for(var o=0;i>o;o++){var n=parseInt(t[o]),r=parseInt(e[o]);if(n>r)return 1;if(r>n)return-1}return 0},e.prototype.getStatusHeight=function(){var t=60;return MobileDevice.isFringeScreen()&&(t+=40),t},e}(PlatformBase);__reflect(PlatformUCMiniGame.prototype,"PlatformUCMiniGame");var PlatformUgame=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.getSign=function(t){var e=this.getUrl(t);return EncryptMd5.hex_md5(e)},e.prototype.SDKLoginNative=function(t){var e={type:t};egret.ExternalInterface.call("SDKLoginNative",JSON.stringify(e))},e.prototype.GetSDKCheckAccountArgs=function(){var t=Date.now(),e=SDKManager.ins().UgameAppType;e=this.upperCase(e);var i=this.upperCase(GlobalModel.os),o=SDKConst["UGameKey"+i+e],n={uid:GlobalModel.openID,time:t,appkey:o},r=this.getSign(n),a={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,time:t,sign:r};return console.log("Ugame loginParm:",JSON.stringify(a),JSON.stringify(n)),JSON.stringify(a)},e.prototype.SDKEnterGameNative=function(t){egret.ExternalInterface.call("SDKCheckFailBill",JSON.stringify({serverId:t.serverId,roleId:ActorControl.actorID,sdkUid:GlobalModel.openID,sPcText:GlobalModel.channelId})),this.setData(1)},e.prototype.SDKCreateRoleNative=function(t){this.setData(2)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(3)},e.prototype.setData=function(t){var e={type:t,lv:ActorControl.level,actorID:ActorControl.actorID,serverId:GlobalModel.srvid},i=JSON.stringify(e);egret.ExternalInterface.call("SDKLevelUpdate",i)},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({paytype:"android"==GlobalModel.os?"gp":"ios"==GlobalModel.os?"ios":"home"})},e.prototype.SDKPayNative=function(t){var e={serverId:t.serverId,serverName:t.serverName,goodsID:this.GetChannelItemId(t.itemid),cpOrderID:t.order,productName:t.goodsname};egret.ExternalInterface.call("SDKPayNative",JSON.stringify(e)),console.log("SDK pay info：",JSON.stringify(e))},e.prototype.showSuperVip=function(){return!0},e.prototype.upperCase=function(t){return t?t.substring(0,1).toUpperCase()+t.substring(1):""},e.prototype.GetChannelItemId=function(t){var e=SDKManager.ins().UgameAppType;switch(e=this.upperCase(e),GlobalModel.os){case"android":t=SDKConst["GooglePayProductIds"+e][t];break;case"ios":t=SDKConst["IosProductIds"+e][t]}return t},e.prototype.SDKStartForGift=function(){egret.ExternalInterface.call("SDKStartForGift",GlobalModel.srvid.toString())},e.prototype.SDKFaceStartGift=function(){egret.ExternalInterface.call("SDKFaceStartGift",GlobalModel.srvid.toString())},e.prototype.SDKMiniAuditVer=function(){return"ios"==GlobalModel.os?1:0},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;console.log("SDK callback",JSON.stringify(i)),"init"==o?debug.log("SDK init suc"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("os",i.os),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"checkFailBill"==o?(platformAmuseControl.dispatchGameFBGift(i.fbflag),platformAmuseControl.dispatchGameFBRate(i.rateFlag)):"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o?0==i.sdkcode&&window.location.reload():"appType"==o&&1==i.sdkcode&&(SDKManager.ins().UgameAppType=i.appType)},e}(PlatformBase);__reflect(PlatformUgame.prototype,"PlatformUgame");var PlatformUgameH5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("Uid"),GlobalModel.setUrlParamValue("exText","ugameh5"),"82"==GlobalModel.pfid&&(SDKConst.Ugameid="10216",SDKManager.ins().UgameAppType="F1game"),("10207"==SDKConst.Ugameid||"10216"==SDKConst.Ugameid)&&(GlobalModel.pf="Ugame")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.getSign=function(t){var e=this.getUrl(t)+SDKConst.UGameKeyAndroid;return EncryptMd5.hex_md5(e)},e.prototype.getUrl=function(t){var e="";for(var i in t)e+=i+"="+t[i]+"&";return e=e.substring(0,e.length-1)},e.prototype.GetSDKCheckAccountArgs=function(){var t={Ugameid:SDKConst.Ugameid,Uid:GlobalModel.openID,Time:Date.now()},e=(this.getSign(t),{pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.openID,lzext:"ugameh5",Ugameid:SDKConst.Ugameid,Uid:GlobalModel.openID,Time:GlobalModel.getUrlParamValue("Time"),sign:GlobalModel.getUrlParamValue("Sign"),Sign:GlobalModel.getUrlParamValue("Sign")});return console.log("UgameH5登陆参数:",JSON.stringify(e),JSON.stringify(t)),JSON.stringify(e)},e.prototype.SDKEnterGameNative=function(t){this.setData(1,t)},e.prototype.SDKCreateRoleNative=function(t){},e.prototype.SDKUserUpgradeNative=function(t){this.setData(3,t)},e.prototype.setData=function(t,e){var i={Ugameid:SDKConst.Ugameid,Uid:GlobalModel.openID,Serverid:e.serverId,ServerName:e.serverName,Roleid:ActorControl.actorID,RoleName:e.nickName,Method:3==t?"levelUp":"createRole",Time:GlobalModel.getUrlParamValue("Time")};window.parent.postMessage(i,"*")},e.prototype.SDKPayNative=function(t){var e={Ugameid:SDKConst.Ugameid,Uid:GlobalModel.openID,Serverid:t.serverId,Roleid:ActorControl.actorID,Method:"createPay",Time:GlobalModel.getUrlParamValue("Time"),Cp_orderid:t.order,Ctext:GlobalModel.getUrlParamValue("exText"),Sku:this.GetChannelItemId(t.itemid),UPrice:t.fee};window.parent.postMessage(e,"*"),console.log("SDK支付信息：",JSON.stringify(e))},e.prototype.showSuperVip=function(){return!0},e.prototype.upperCase=function(t){return t?t.substring(0,1).toUpperCase()+t.substring(1):""},e.prototype.GetChannelItemId=function(t){var e=SDKManager.ins().UgameAppType;e=this.upperCase(e);var i=SDKConst["GooglePayProductIds"+e][t];return i},e}(PlatformBase);__reflect(PlatformUgameH5.prototype,"PlatformUgameH5");var PlatformWmsdH5=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("Wmsd loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKPayNative=function(t){window.top.postMessage({cmd:"pay",args:{amount:t.fee,gameId:GlobalModel.getUrlParamValue("gameid"),serverId:t.serverId,subject:t.goodsname,body:t.goodsname,outTradeNo:t.order,attach:t.order}},"*")},e}(PlatformBase);__reflect(PlatformWmsdH5.prototype,"PlatformWmsdH5");var PlatformWx=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKHasLoginScene=function(){return WXGameScene},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,serverid:GlobalModel.srvid,code:GlobalModel.getUrlParamValue("code"),shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({appid:t.wxPayData.appid,partnerid:t.wxPayData.partnerid,prepayid:t.wxPayData.prepayid,noncestr:t.wxPayData.noncestr,timestamp:t.wxPayData.timestamp,"package":t.wxPayData["package"],gamesign:t.gameSign,orderid:t.order}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)debug.log("SDK init suc");else if("login"==o)if(0==i.sdkcode){GlobalModel.setUrlParamValue("code",i.code),GlobalModel.setUrlParamValue("os",i.os);var n={code:i.code,os:i.os,gameVersion:GlobalModel.gameVersion},r=Md5Utils.obj_md5_args(n);debug.log("wx get UID parm:"+r),PHPConfig.requestPhpData("https://ltserver.lzhygame.com/wx/"+GlobalModel.gameId+"/sdkurlcallback",r,function(t){var e=JSON.parse(t.currentTarget.response);debug.log("wx parm:",t.currentTarget.response),200==e.errcode?(GlobalModel.openID=e.open_id,GlobalModel.setUrlParamValue("shellext",e.shellext),SceneMgr.ins().runScene(StartGameScene)):debug.log("get wx Account error!!!")},function(t){debug.log("get wx Account error!!!")})}else debug.log("login fail");else"logout"==o?0==i.sdkcode&&window.location.reload():"switchAccount"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformWx.prototype,"PlatformWx");var PlatformX7syHW=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(PlatformX7sy);__reflect(PlatformX7syHW.prototype,"PlatformX7syHW");var PlatformXcH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.XCVGAMEH5SDKObj=window.XCVGAMEH5SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("useraccount"),platformAmuseControl.focusState=GlobalModel.getUrlParamValue("isfollow");var t=GlobalModel.getUrlParamValue("showshare");platformAmuseControl.shareState=0==t?-1:t,platformAmuseControl.wxInviteCount=GlobalModel.getUrlParamValue("sharenumber"),this.XCVGAMEH5SDK=this.XCVGAMEH5SDKObj.init(SDKConst.XiaoChouSdkappid,GlobalModel.getUrlParamValue("xcpf"))},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,useraccount:GlobalModel.openID,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){var e={power:ActorControl.power,moneynum:ActorControl.yb,balance:"",partyname:"",partyrolename:"",partyid:"",professionid:ActorControl.job,profession:"",gender:""};this.XCVGAMEH5SDK.logingame(GlobalModel.openID,t.serverId,t.serverName,ActorControl.actorID,ActorControl.myName,ActorControl.level,t.vip,JSON.stringify(e))},e.prototype.SDKEnterGameNative=function(t){var e={power:ActorControl.power,moneynum:ActorControl.yb,balance:"",partyname:"",partyrolename:"",partyid:"",professionid:ActorControl.job,profession:"",gender:""};this.XCVGAMEH5SDK.logingame(GlobalModel.openID,t.serverId,t.serverName,ActorControl.actorID,ActorControl.myName,ActorControl.level,t.vip,JSON.stringify(e))},e.prototype.SDKUserUpgradeNative=function(t){var e={power:ActorControl.power,moneynum:ActorControl.yb,balance:"",partyname:"",partyrolename:"",partyid:"",professionid:ActorControl.job,profession:"",gender:""};this.XCVGAMEH5SDK.roleupdate(GlobalModel.openID,t.serverId,t.nickName,ActorControl.actorID,ActorControl.myName,ActorControl.level,vipControl.lv,JSON.stringify(e))},e.prototype.SDKPayNative=function(t){var e={sdkappid:SDKConst.XiaoChouSdkappid,pf:GlobalModel.getUrlParamValue("xcpf"),useraccount:GlobalModel.openID,money:t.fee,itemname:t.itemid,attach:t.order,serviceid:GlobalModel.srvid,role:ActorControl.myName},i="attach="+e.attach+"&itemname="+e.itemname+"&money="+e.money+"&pf="+e.pf+"&role="+e.role+"&sdkappid="+e.sdkappid+"&serviceid="+e.serviceid+"&useraccount="+e.useraccount,o=EncryptMd5.hex_md5(i+SDKConst.XiaoChouSdkkey);this.XCVGAMEH5SDK.pay(e.useraccount,e.itemname,e.money,e.attach,e.serviceid,e.role,o)},e.prototype.SDKShowShare=function(){this.XCVGAMEH5SDK.share(GlobalModel.openID)},e.prototype.SDKShowQRCode=function(){this.XCVGAMEH5SDK.guanzhu(GlobalModel.openID)},e.prototype.SDKExitNative=function(){this.XCVGAMEH5SDK.loginout(GlobalModel.openID)},e}(PlatformBase);__reflect(PlatformXcH5.prototype,"PlatformXcH5");var PlatformXJH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.XJGAME_SDK=window.XJGAME_SDK,e.baseLeve=0,e}return __extends(e,t),e.prototype.SDKInitNative=function(){var t={pay:{success:function(){},cancel:function(){}}};this.XJGAME_SDK.config(t),GlobalModel.openID=GlobalModel.getUrlParamValue("user_identity"),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init"}))},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={};e?(o={serverId:t.serverId,playerName:ActorControl.myName},this.XJGAME_SDK.reportGameInfo(o)):i?(o={serverId:t.serverId,serverName:t.srvname,roleId:ActorControl.actorID,rolePower:ActorControl.power,roleName:CommonFun.getJobName(t.job),professionId:t.job,nickName:GlobalModel.nickName,level:ActorControl.level,vip:vipControl.lv},ActorControl.level>=10&&this.baseLeve<10&&(this.XJGAME_SDK.reportEvent({type:6,data:{}}),this.baseLeve=ActorControl.level),this.XJGAME_SDK.userUpgrade(o)):(o={serverId:1,newuser:1,userinfo:{serverId:t.serverId,serverName:t.srvname,roleId:ActorControl.actorID,rolePower:ActorControl.power,roleName:CommonFun.getJobName(t.job),professionId:t.job,nickName:GlobalModel.nickName,level:ActorControl.level,vip:vipControl.lv}},this.baseLeve=ActorControl.level,this.XJGAME_SDK.reportLoginInfo(o))},e.prototype.SDKPayNative=function(t){var e={out_trade_no:t.order,product_id:t.itemid,total_fee:100*t.fee,body:t.goodsname,detail:t.goodsname,attach:t.order},i=Md5Utils.obj_cntstr(e);i+=SDKConst.XjAppKey,e.sign=Sha1Utils.hex_sha1(i),this.XJGAME_SDK.pay(e)},e.prototype.SDKLogoutNative=function(){},e}(PlatformBase);__reflect(PlatformXJH5.prototype,"PlatformXJH5");var PlatformXYouH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.XYOUSDK=window.XYOU_SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){this.XYOUSDK.config(SDKConst.XYouH5GameKey,function(){console.log("pay suc")},function(){console.log("Share suc")},function(t){console.log("state："+t.state)}),this.XYOUSDK.getUserInfo(function(t){SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",data:t}))})},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,nickname:GlobalModel.getUrlParamValue("nickname"),headimg:GlobalModel.getUrlParamValue("headimg"),gender:GlobalModel.getUrlParamValue("gender"),sign:GlobalModel.getUrlParamValue("sign")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1)},e.prototype.SDKPayNative=function(t){this.XYOUSDK.pay({cost:100*t.fee,product_id:t.itemid,productName:t.goodsname,game_uid:ActorControl.actorID,game_orderno:t.order,app_ext1:t.order})},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o){var n=i.data;GlobalModel.openID=n.uid+"",GlobalModel.setUrlParamValue("nickname",n.nickname),GlobalModel.setUrlParamValue("headimg",encodeURIComponent(n.headimg)),GlobalModel.setUrlParamValue("gender",n.gender),GlobalModel.setUrlParamValue("sign",n.sign)}},e}(PlatformBase);__reflect(PlatformXYouH5.prototype,"PlatformXYouH5");var PlatformYiYou=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,token:GlobalModel.getUrlParamValue("token")};return console.log("YiYou loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="1";e&&(o="2"),i&&(o="3"),egret.ExternalInterface.call("SDKsetDataNative",JSON.stringify({serverId:t.serverId,serverName:t.serverName,gameRoleName:t.nickName,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,roleCreateTime:GlobalModel.createAccountTime,partyId:unionControl.guildID,gameRoleGender:"",gameRolePower:ActorControl.power,partyRoleId:unionControl.guildID,partyRoleName:unionControl.guildName,professionId:t.job,profession:CommonFun.getJobName(t.job),friendlist:LangMgr.getValueByKey("persontNone"),isCreate:e,isUpLv:i,rolelevelCtime:GlobalModel.createActorTime,rolelevelMtime:(Date.now()/1e3).toFixed(0)}))},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverName:t.serverName,gameRoleName:t.roleName,serverId:t.serverId,gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,goodsID:t.itemid,productName:t.goodsname,cpOrderID:t.order,count:t.amount,amount:t.fee,extrasParams:t.order,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init suc"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId+"",GlobalModel.setUrlParamValue("token",i.token),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformYiYou.prototype,"PlatformYiYou");var PlatformYj=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,channelId:GlobalModel.channelId,token:GlobalModel.getUrlParamValue("token")};return console.log("Yj loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="enterServer";e&&(o="createrole"),i&&(o="levelup"),egret.ExternalInterface.call("SDKsetDataNative",JSON.stringify({datatype:o,roleId:ActorControl.actorID,roleName:t.nickName,roleLevel:ActorControl.level,zoneId:t.serverId,zoneName:t.serverName,balance:ActorControl.yb,vip:vipControl.lv,partyName:unionControl.guildName,roleCTime:GlobalModel.createActorTime,roleLevelMTime:(Date.now()/1e3).toFixed(0)})),e||i||egret.ExternalInterface.call("SDKRoleDataNative",JSON.stringify({gameRoleID:ActorControl.actorID,gameRoleName:t.nickName,gameUserLevel:ActorControl.level,serverId:t.serverId,serverName:t.serverName}))},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({unitName:t.goodsname,unitPrice:100*t.fee,count:t.amount,extrasParams:t.order}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init ok"):"login"==o?0==i.sdkcode?(GlobalModel.appid=i.appId,GlobalModel.setUrlParamValue("channelId",i.channelId),GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("token",encodeURIComponent(i.token)),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformYj.prototype,"PlatformYj");var PlatformYouQuH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.H5And=window.h5And,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uname:GlobalModel.getUrlParamValue("uname"),os:GlobalModel.getUrlParamValue("os"),time:GlobalModel.getUrlParamValue("time"),switchUserBtn:GlobalModel.getUrlParamValue("switchUserBtn"),logotype:GlobalModel.getUrlParamValue("logotype"),logo_url:GlobalModel.getUrlParamValue("logo_url"),load_bg_type:GlobalModel.getUrlParamValue("load_bg_type"),load_bg_url:GlobalModel.getUrlParamValue("load_bg_url"),login_bg_type:GlobalModel.getUrlParamValue("uname"),login_bg_url:GlobalModel.getUrlParamValue("uname"),sign:GlobalModel.getUrlParamValue("sign")};return console.log("YouQu loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o=3;e&&(o=2),i&&(o=4),this.H5And.reportUserInfo(JSON.stringify({dataType:o,appid:GlobalModel.appid,serverID:t.serverId,serverName:t.serverName,userId:GlobalModel.openID,roleID:ActorControl.actorID,roleName:t.nickName,roleLevel:ActorControl.level,moneyNum:ActorControl.yb}))},e.prototype.SDKPayNative=function(t){this.H5And.pay(JSON.stringify({buyNum:1,serverId:t.serverId,serverName:t.serverName,roleId:ActorControl.actorID,roleName:t.roleName,roleLevel:ActorControl.level,vip:vipControl.lv,price:t.fee,productId:t.itemid,productName:t.goodsname,productDesc:t.goodsname,extension:t.order}))},e}(PlatformBase);__reflect(PlatformYouQuH5.prototype,"PlatformYouQuH5");var PlatformYouQuIOS=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,loginSign:GlobalModel.getUrlParamValue("loginSign")};return console.log("loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o=3;e&&(o=2),i&&(o=4),egret.ExternalInterface.call("SDKsetDataNative",JSON.stringify({gameRoleName:t.nickName,serverId:t.serverId,serverName:t.serverName,gameUserLevel:ActorControl.level,openID:GlobalModel.openID,gameRoleID:ActorControl.actorID,gold:ActorControl.gold,dataType:o}))},e.prototype.GetMakeOrderSdkArgs=function(t){return JSON.stringify({paytype:GlobalModel.isAuditState?"ios":"home"})},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({cpOrderID:t.order,amount:t.fee,serverId:t.serverId,serverName:t.serverName,gameRoleName:t.roleName,gameRoleID:ActorControl.actorID,goodsID:this.GetChannelItemId(t.itemid),productName:t.goodsname}))},e.prototype.GetChannelItemId=function(t){return GlobalModel.isAuditState&&(t=SDKConst.IosProductIds[t]),t},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;"init"==o?debug.log("SDK init suc"):"login"==o?0==i.sdkcode?(GlobalModel.openID=i.userId,GlobalModel.setUrlParamValue("loginSign",i.loginSign),SceneMgr.ins().runScene(StartGameScene)):this.SDKLoginNative():"logout"==o&&0==i.sdkcode&&window.location.reload()},e}(PlatformBase);__reflect(PlatformYouQuIOS.prototype,"PlatformYouQuIOS");var PlatformYxH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.YxSDK=window.yxsdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uname:GlobalModel.getUrlParamValue("uname"),os:GlobalModel.getUrlParamValue("os"),time:GlobalModel.getUrlParamValue("time"),switchUserBtn:GlobalModel.getUrlParamValue("switchUserBtn"),logotype:GlobalModel.getUrlParamValue("logotype"),logo_url:GlobalModel.getUrlParamValue("logo_url"),load_bg_type:GlobalModel.getUrlParamValue("load_bg_type"),load_bg_url:GlobalModel.getUrlParamValue("load_bg_url"),login_bg_type:GlobalModel.getUrlParamValue("uname"),login_bg_url:GlobalModel.getUrlParamValue("uname"),sign:GlobalModel.getUrlParamValue("sign")};return console.log("yx loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0,null,2)},e.prototype.SDKEnterGameNative=function(t){this.setData(t,null,null,3)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0,4)},e.prototype.setData=function(t,e,i,o){void 0===e&&(e=!1),void 0===i&&(i=!1);var n={dataType:o,appid:GlobalModel.appid,serverID:t.serverId,serverName:t.serverName,userId:GlobalModel.openID,roleID:ActorControl.actorID,roleName:ActorControl.myName,roleLevel:ActorControl.level,moneyNum:ActorControl.yb},r=JSON.stringify(n);this.YxSDK.reportUserInfo(r),debug.log("YxH5 submit info",n)},e.prototype.SDKPayNative=function(t){var e={buyNum:1,serverId:t.serverId+"",serverName:t.serverName,roleId:ActorControl.actorID,roleName:ActorControl.myName,roleLevel:ActorControl.level,vip:vipControl.lv,price:t.fee,productId:t.itemid,productName:t.goodsname,productDesc:t.goodsname,extension:t.order},i=JSON.stringify(e);this.YxSDK.pay(i)},e}(PlatformBase);__reflect(PlatformYxH5.prototype,"PlatformYxH5");var PlatformYyb=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loginComplete=!1,e}return __extends(e,t),e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(t){void 0!=t&&egret.ExternalInterface.call("SDKLoginNative",JSON.stringify(t))},e.prototype.SDKHasLoginScene=function(){return YYBGameScene},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,serverid:GlobalModel.srvid,platform:GlobalModel.getUrlParamValue("platform"),reg_channel:GlobalModel.getUrlParamValue("reg_channel"),user_type:GlobalModel.getUrlParamValue("user_type"),login_type:GlobalModel.getUrlParamValue("login_type"),yyb_pf:GlobalModel.getUrlParamValue("yyb_pf"),pf_key:GlobalModel.getUrlParamValue("pf_key"),access_token:GlobalModel.getUrlParamValue("access_token"),pay_token:GlobalModel.getUrlParamValue("pay_token"),refresh_token:GlobalModel.getUrlParamValue("refresh_token")};return console.log("loginParm:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKPayNative=function(t){egret.ExternalInterface.call("SDKPayNative",JSON.stringify({serverName:t.serverName,gameRoleName:t.roleName,serverId:SDKConst.YYBZoneId+Number(t.serverId),gameRoleID:ActorControl.actorID,gameUserBalance:ActorControl.yb,vipLevel:vipControl.lv,gameUserLevel:ActorControl.level,partyName:unionControl.guildName,goodsID:t.itemid,productName:t.goodsname,cpOrderID:t.order,count:t.amount,amount:t.fee*SDKConst.YYBMoneyRate,extrasParams:t.order,createAccountTime:GlobalModel.createAccountTime,createActorTime:GlobalModel.createActorTime}))},e.prototype.nativeCallback=function(e){e=Base64.base64decode(e),t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)debug.log("SDK init suc"),GlobalModel.setUrlParamValue("appver",i.appver);else if("login"==o)0==i.sdkcode?(GlobalModel.openID=i.open_id,GlobalModel.setUrlParamValue("platform",i.platform),GlobalModel.setUrlParamValue("reg_channel",i.reg_channel),GlobalModel.setUrlParamValue("user_type",i.user_type),GlobalModel.setUrlParamValue("login_type",i.login_type),GlobalModel.setUrlParamValue("yyb_pf",i.pf),GlobalModel.setUrlParamValue("pf_key",i.pf_key),GlobalModel.setUrlParamValue("access_token",i.access_token),GlobalModel.setUrlParamValue("pay_token",i.pay_token),GlobalModel.setUrlParamValue("refresh_token",i.refresh_token),this.loginComplete||(this.loginComplete=!0,SceneMgr.ins().runScene(StartGameScene))):-2==i.sdkcode?debug.log("aoto login fail"):debug.log("login fail");
else if("refreshToken"==o)GlobalModel.setUrlParamValue("access_token",i.access_token),GlobalModel.setUrlParamValue("pay_token",i.pay_token),GlobalModel.setUrlParamValue("refresh_token",i.refresh_token);else if("logout"==o)0==i.sdkcode&&window.location.reload();else if("switchAccount"==o)0==i.sdkcode&&window.location.reload();else if("pay"==o){if(0==i.sdkcode){var n={orderid:i.ysdkExtInfo,platform:i.platform,ts:Date.now(),openid:GlobalModel.openID,pf:GlobalModel.getUrlParamValue("yyb_pf"),openkey:1==i.platform?GlobalModel.getUrlParamValue("pay_token"):GlobalModel.getUrlParamValue("access_token"),pfkey:GlobalModel.getUrlParamValue("pf_key"),zoneid:SDKConst.YYBZoneId+Number(GlobalModel.srvid),saveValue:i.realSaveNum,access_token:GlobalModel.getUrlParamValue("pay_token"),pay_token:GlobalModel.getUrlParamValue("pay_token"),refresh_token:GlobalModel.getUrlParamValue("pay_token")},r=Md5Utils.obj_md5_args(n,PHPConfig.VERIFY_KEY,!0);console.log("pay callback parm:"+r),ReportYybPayData.getIns().reportUrl(GlobalModel.sdkDomain+"/yyb/"+GlobalModel.gameId+"/sdkpaycallback",r)}}else if("screenshots"==o){var a=new egret.RenderTexture;a.drawToTexture(Main.ins().stage,new egret.Rectangle(window.innerWidth/2,0,window.innerWidth,window.innerHeight));var s=a.toDataURL("image/png");egret.ExternalInterface.call("Screenshots",JSON.stringify({data:s}))}},e.prototype.SDKShowImmersiveIconNative=function(t){egret.ExternalInterface.call("SDKShowImmersiveIcon",t)},e.prototype.SDKShowLogout=function(){return!0},e.prototype.SDKShowShare=function(t){if(t){var e=t[0],i=t[1],o=CommonUtils.getImgBase64Data(e),n={base64Data:""+o,mTargetScene:i};egret.ExternalInterface.call("SDKToAppShare",JSON.stringify(n))}},e}(PlatformBase);__reflect(PlatformYyb.prototype,"PlatformYyb");var ReportYybPayData=function(){function t(){this.isComplete=!1,this.httpRequest=new egret.HttpRequest,this.httpRequestUrl=[]}return t.getIns=function(){return this._ins=this._ins||new t,this._ins},t.prototype.reportUrl=function(t,e,i){var o=new HrInfo;o.url=t,o.params=e,o.method=i,o.sendCount=3,this.httpRequestUrl.push(o),this.sendReportUrl()},t.prototype.sendReportUrl=function(){if(0==this.isComplete&&this.httpRequestUrl.length>0){var t=this.httpRequestUrl[0].url,e=this.httpRequestUrl[0].params,i=this.httpRequestUrl[0].method;this.httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),i==egret.HttpMethod.POST?(this.httpRequest.open(t,egret.HttpMethod.POST),this.httpRequest.send(e)):(this.httpRequest.open(t+"?"+e,egret.HttpMethod.GET),this.httpRequest.send()),this.isComplete=!0,this.httpRequest.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),this.httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this)}},t.prototype.onGetComplete=function(t){console.log("state:",t.currentTarget.response),1==t.currentTarget.response?(this.isComplete=!1,this.httpRequestUrl.shift(),this.sendReportUrl()):this.onGetIOError(null)},t.prototype.onGetIOError=function(t){this.isComplete=!1,this.httpRequestUrl[0].sendCount--,this.httpRequestUrl[0].sendCount>0&&this.sendReportUrl()},t}();__reflect(ReportYybPayData.prototype,"ReportYybPayData");var PlatformZjH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SbPulSdk=window.SbPulSdk,e}return __extends(e,t),e.prototype.SDKInitNative=function(){var t={qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),qqesnickname:GlobalModel.getUrlParamValue("qqesnickname"),qqesavatar:GlobalModel.getUrlParamValue("qqesavatar"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),ext:GlobalModel.GetSearchParamByName("ext"),qqestimestamp:GlobalModel.getUrlParamValue("qqestimestamp"),sign:GlobalModel.getUrlParamValue("sign")};this.SbPulSdk.init(t,function(t){GlobalModel.openID=GlobalModel.getUrlParamValue("qqesuid"),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init"}))}),this.GetUserLzInfo()},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),qqesnickname:GlobalModel.getUrlParamValue("qqesnickname"),qqesavatar:GlobalModel.getUrlParamValue("qqesavatar"),cpgameid:GlobalModel.getUrlParamValue("cpgameid"),ext:GlobalModel.GetSearchParamByName("ext"),qqestimestamp:GlobalModel.getUrlParamValue("qqestimestamp"),sign:GlobalModel.getUrlParamValue("sign"),shellext:GlobalModel.getUrlParamValue("shellext")};return JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){var e={qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),serverId:t.serverId,serverName:t.serverName,roleName:CommonFun.getJobName(t.job),nickName:t.nickName,cpgameid:GlobalModel.getUrlParamValue("cpgameid")};this.SbPulSdk.createRole(e)},e.prototype.SDKEnterGameNative=function(t){var e={cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),serverId:t.serverId,serverName:t.serverName,roleName:CommonFun.getJobName(t.job),nickName:t.nickName,level:1e3*t.zsLevel+t.level,vip:t.vip};this.SbPulSdk.beginGame(e)},e.prototype.SDKUserUpgradeNative=function(t){var e={cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),serverId:t.serverId,serverName:t.serverName,roleName:CommonFun.getJobName(t.job),roleId:t.job,nickName:t.nickName,level:1e3*t.zsLevel+t.level,vip:t.vip};this.SbPulSdk.userUpgrade(e)},e.prototype.SDKPayNative=function(t){var e={order:t.order,cpgameid:GlobalModel.getUrlParamValue("cpgameid"),qqesuid:GlobalModel.getUrlParamValue("qqesuid"),channelid:GlobalModel.getUrlParamValue("channelid"),channeluid:GlobalModel.getUrlParamValue("channeluid"),cpguid:GlobalModel.getUrlParamValue("guid"),goodsname:t.goodsname,fee:t.fee,serverID:t.serverId,serverName:t.serverName,roleName:t.roleName,roleId:ActorControl.actorID,ext:GlobalModel.GetSearchParamByName("ext"),timestamp:Date.now()};e.sign=Md5Utils.obj_md5(e,GlobalModel.getUrlParamValue("zjcode"),["serverID","serverName","roleName","roleId"]),this.SbPulSdk.pay(e)},e.prototype.SDKSetDataNative=function(t){this.SbPulSdk.buryingPoint({roleName:t.roleName,nickName:t.nickName,serverId:t.serverId,level:t.level,pointId:t.pointId,pointName:t.pointName,roleId:ActorControl.actorID,serverName:t.serverName,vip:t.vip,cpgameid:t.cpgameid,qqesuid:t.qqesuid,channelid:t.channelid,channeluid:t.channeluid})},e.prototype.SDKLogoutNative=function(){this.SbPulSdk.loginout(function(){debug.log("exit suc")})},e.prototype.SDKTapExecute=function(){var t=this;GlobalModel.IsQQHall&&this.SbPulSdk.openGameVip(function(){console.log("close Win"),t.GetUserLzInfo()})},e.prototype.GetUserLzInfo=function(){if(GlobalModel.IsQQHall){var t=GlobalModel.getUrlParamValue("ext");if(""!=t){var e=JSON.parse(t),i={channeluid:GlobalModel.getUrlParamValue("channeluid"),pf:e.pf,openkey:e.openkey},o=Md5Utils.obj_md5_args(i);PHPConfig.requestPhpData(PHPConfig.SET_LANZHUAN_INFO,o,function(t){var e=JSON.parse(t.currentTarget.response);0!=e.ret&&console.log("player info error 1!!!")},this,function(t){console.log("player info error 2!!!")})}}},e}(PlatformBase);__reflect(PlatformZjH5.prototype,"PlatformZjH5");var PlatformZSH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BZ_SDK=window.BZ_SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){var t={gid:10021,sub_gid:10076,opr_cid:10001,adv_cid:101,pkg_id:0,sdk_ver:"1.0.0"};this.BZ_SDK.init(t,function(t,e){console.log("bzmessage:",t.msg,"bzstatus:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",sdkcode:0,data:t}))})},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.openID,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={rtype:e?"create":i?"lvup":"login",cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",part_id:unionControl.guildID,part_name:unionControl.guildName,part_leader_id:"",part_leader_name:"",power:0==ActorControl.power?t.power:ActorControl.power,profession_id:t.job,profession_name:CommonFun.getJobName(t.job),gold:ActorControl.yb,coin:ActorControl.gold,create_ts:GlobalModel.createActorTime};this.BZ_SDK.reportLog(o)},e.prototype.SDKPayNative=function(t){var e={product_id:t.itemid,product_name:t.goodsname,product_desc:t.goodsname,pay_money:t.fee,cp_order_id:t.order,cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",gold:ActorControl.yb,coin:ActorControl.gold,ext:t.order};this.BZ_SDK.genOrder(e)},e.prototype.SDKLogoutNative=function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))},e.prototype.SDKShowLogout=function(){return!0},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if(console.log("SDK callback:",JSON.stringify(i)),"init"==o)0==i.sdkcode&&this.BZ_SDK.login(function(t,e){console.log("data:",t,"status:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t}))});else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.uid+"",GlobalModel.setUrlParamValue("token",n.token),GlobalModel.setUrlParamValue("uname",n.uname),SceneMgr.ins().runScene(StartGameScene)}else window.location.reload();else"logout"==o&&0==i.sdkcode&&(this.BZ_SDK.switchAccount(),window.location.reload())},e}(PlatformBase);__reflect(PlatformZSH5.prototype,"PlatformZSH5");var PlatformZSWDH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.BZ_SDK=window.BZ_SDK,e}return __extends(e,t),e.prototype.SDKInitNative=function(){},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,appId:GlobalModel.appid,uid:GlobalModel.openID,token:GlobalModel.getUrlParamValue("token")};return JSON.stringify(t)},e.prototype.SDKLoginNative=function(){var t={gid:10021,sub_gid:10076,opr_cid:10001,adv_cid:101,pkg_id:0,sdk_ver:"1.0.0"};this.BZ_SDK.init(t,function(t,e){console.log("bzmessage:",t.msg,"bzstatus:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"init",sdkcode:0,data:t}))})},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o={rtype:e?"create":i?"lvup":"login",cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",part_id:unionControl.guildID,part_name:unionControl.guildName,part_leader_id:"",part_leader_name:"",power:0==ActorControl.power?t.power:ActorControl.power,profession_id:t.job,profession_name:CommonFun.getJobName(t.job),gold:ActorControl.yb,coin:ActorControl.gold,create_ts:GlobalModel.createActorTime};this.BZ_SDK.reportLog(o)},e.prototype.SDKPayNative=function(t){var e={product_id:t.itemid,product_name:t.goodsname,product_desc:t.goodsname,pay_money:t.fee,cp_order_id:t.order,cp_server_id:t.serverId,cp_server_name:t.serverName,role_id:ActorControl.actorID,role_name:ActorControl.myName,level:ActorControl.level,vip_lv:vipControl.lv,gender:"",gold:ActorControl.yb,coin:ActorControl.gold,ext:t.order};this.BZ_SDK.genOrder(e)},e.prototype.SDKLogoutNative=function(){SDKManager.ins().NativeCallback(JSON.stringify({callType:"logout",sdkcode:0}))},e.prototype.SDKShowLogout=function(){return!0},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if(console.log("SDK callback:",JSON.stringify(i)),"init"==o)0==i.sdkcode&&this.BZ_SDK.login(function(t,e){console.log("data:",t,"status:",e),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t}))});else if("login"==o)if(0==i.sdkcode){var n=i.data;GlobalModel.openID=n.uid+"",GlobalModel.setUrlParamValue("token",n.token),GlobalModel.setUrlParamValue("uname",n.uname),SceneMgr.ins().runScene(StartGameScene)}else window.location.reload();else"logout"==o&&0==i.sdkcode&&(this.BZ_SDK.switchAccount(),window.location.reload())},e}(PlatformBase);__reflect(PlatformZSWDH5.prototype,"PlatformZSWDH5");var PlatformZwWxMini=function(t){function e(){var e=t.call(this)||this;return e.url="http://gameluotuo.cn/index.php",e.id="411",e.channel_id="3e6659ff55d4be83900c2b4e4ed9e694",e.token="cycjyx1604556993",e.appId="wx7f1563abedfddbd2",e.startTime=0,e.hasPopSub=!1,null!=window.zwWxMiniSdkId&&(e.id=window.zwWxMiniSdkId),null!=window.zwWxMiniSdkChannelId&&(e.channel_id=window.zwWxMiniSdkChannelId),null!=window.zwWxMiniSdkToken&&(e.token=window.zwWxMiniSdkToken),null!=window.zwWxMiniSdkAppId&&(e.appId=window.zwWxMiniSdkAppId),e}return __extends(e,t),e.prototype.SDKMiniAuditVer=function(){return null!=window.zwWxMiniAuditVerStr?SDKConst[window.zwWxMiniAuditVerStr]:SDKConst.ZwWxMiniCycjAuditVer},e.prototype.isShowMiniAccountJumpPortalIcon=function(){return!0},e.prototype.miniAccountJumpPortalIconTap=function(){this.sdkBaseInfo&&this.jumpXcx(this.sdkBaseInfo.appid,this.sdkBaseInfo.path,"uid="+GlobalModel.openID)},e.prototype.showSuperVip=function(){return!0},e.prototype.SDKInitNative=function(){window.wx.setKeepScreenOn({keepScreenOn:!0}),"devtools"==window.wxPlatform?window.isMiniUseHttp||(this.url=this.url.replace("http:","https:")):"https:"==window.location.protocol&&(this.url=this.url.replace("http:","https:")),this.systemInfo=window.wx.getSystemInfoSync(),console.log("systemInfo platform:",this.systemInfo.platform),console.log("systemInfo Model:",this.systemInfo.model),(-1!=this.systemInfo.model.search("iPhone X")||-1!=this.systemInfo.model.search("iPhone XR")||-1!=this.systemInfo.model.search("iPhone XS Max")||-1!=this.systemInfo.model.search("iPhone 11")||-1!=this.systemInfo.model.search("iPhone 12"))&&(DeviceUtils.IsBluntBangs=!0),this.getSkdBaseData();var t=this;window.wx.onShow(function(e){0!=t.startTime&&egret.getTimer()-t.startTime>5e3&&(t.startTime=0,SocketConnection.ins().reLogin())}),window.wx.onHide(function(){t.startTime=egret.getTimer()}),window.wx.showShareMenu({withShareTicket:!0})},e.prototype.getSkdBaseData=function(){var t={token:this.token,id:this.id};PHPConfig.requestPhpData(this.url,"g=Wap&m=Wxa&a=get_audit_status&"+Md5Utils.obj_cntstr(t),this.onGetSdkBaseInfo,this,function(t){console.log("getSdkBaseData io error!!!")},egret.HttpMethod.GET)},e.prototype.onGetSdkBaseInfo=function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?(console.log("getSdkBaseData ok: ",e),this.sdkBaseInfo=e):console.log("getSdkBaseData fail "+e.info)}catch(i){console.log("getSdkBaseData fail:",i)}},e.prototype.CheckSupportRecharge=function(){return this.sdkBaseInfo?"6001"==this.sdkBaseInfo.data?!0:"3003"==this.sdkBaseInfo.data&&"1"==this.sdkBaseInfo.close_ios?this.systemInfo.platform.toLowerCase().search("ios")>=0?(window.wx.showModal({content:LangMgr.getValueByKey("iosnonsupportpay")}),!1):!0:"3003"==this.sdkBaseInfo.data?(this.systemInfo.platform.toLowerCase().search("ios")>=0&&window.wx.showModal({content:LangMgr.getValueByKey("iosnonsupportpay")}),!1):!0:!0},e.prototype.isHideRechargeShow=function(){return this.sdkBaseInfo?"3003"==this.sdkBaseInfo.data&&"1"==this.sdkBaseInfo.close_ios?this.systemInfo.platform.toLowerCase().search("ios")>=0?!0:!1:"3003"==this.sdkBaseInfo.data?!0:!1:!1},e.prototype.SDKIsNeedLoginNative=function(){return!0},e.prototype.SDKLoginNative=function(){window.wx.login({success:function(t){console.log("login OK:",t),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:0,data:t}))},fail:function(t){console.log("login fail:",t),SDKManager.ins().NativeCallback(JSON.stringify({callType:"login",sdkcode:-1,data:t}))}})},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("check account args:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t),this.subscribeMessage()},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0),this.subscribeMessage()},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="0";e&&(o="1"),i&&(o="2");var n=ActorControl.level,r={session_3rd:GlobalModel.getUrlParamValue("session_3rd"),channel_id:this.channel_id,area:GlobalModel.srvname||"",role_name:ActorControl.myName||"",new_role:"1"!=o?"0":o,rank:n,money:ActorControl.yb};console.log("Report info:"+Md5Utils.obj_cntstr(r)),PHPConfig.requestPhpData(this.url,"g=Home&m=GameOauth&a=xyx_roles&"+Md5Utils.obj_cntstr(r),this.onGetComplete,this,this.onGetIOError,egret.HttpMethod.GET)},e.prototype.onGetComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?console.log("Report ok"):console.log("Report fail"+e.info)}catch(i){console.log("Report fail",i)}},e.prototype.onGetIOError=function(t){console.log("Report Io fail",t)},e.prototype.SDKPayNative=function(t){var e={token:this.token,session_3rd:GlobalModel.getUrlParamValue("session_3rd"),orderid:t.order,channel_id:this.channel_id,price:t.fee,other:"",client:this.systemInfo.platform};console.log("pay parm："+Md5Utils.obj_cntstr(e)),PHPConfig.requestPhpData(this.url,"g=Home&m=GameOauth&a=xyx_payinfo&"+Md5Utils.obj_cntstr(e),this.payOnComplete,this,this.payIOError,egret.HttpMethod.GET,egret.HttpResponseType.TEXT,e)},e.prototype.payOnComplete=function(t,e){var i=this;try{var o=JSON.parse(t.currentTarget.response);if(1001==o.status)switch(console.log("payInfo: ",o),o.data.pay_type){case"kf":this.compareVersion(this.systemInfo.SDKVersion,"2.0.3")<0?window.wx.showModal({content:LangMgr.getValueByKey("wxKfTip")}):window.wx.openCustomerServiceConversation({sessionFrom:o.data.session_from?o.data.session_from:"",showMessageCard:!0,sendMessageTitle:o.data.message,sendMessageImg:o.data.sendMessageImg?o.data.sendMessageImg:"https://kantuwan.cn/uploads/a/admin/3/3/1/4/5d0b2e00cfa13.jpg"});break;case"xcx":this.compareVersion(this.systemInfo.SDKVersion,"2.2.0")<0?window.wx.showModal({content:LangMgr.getValueByKey("wxNavMiniTip")}):this.jumpXcx(o.data.appid,o.data.path,"orderid="+o.data.orderid);break;case"midashi":if(1==o.data.pay_status)console.log("midashi pay success");else if(0==o.data.pay_status){var n=o.data.mode?o.data.mode:"game",r=o.data.env?o.data.env:0,a=o.data.offerId,s=o.data.currencyType?o.data.currencyType:"CNY",l=o.data.buyQuantity,h=o.data.zoneId,u=o.data.platform;console.log("mode:",n),console.log("env:",r),console.log("offerId:",a),console.log("currencyType:",s),console.log("buyQuantity:",l),console.log("zoneId:",h),console.log("platform:",u),window.wx.requestMidasPayment({mode:n,env:r,offerId:a,currencyType:s,buyQuantity:l,zoneId:h,platform:u,success:function(t){console.log("midashi payment success:",t),console.log("midashi payment success pay parm："+Md5Utils.obj_cntstr(e)),PHPConfig.requestPhpData(i.url,"g=Home&m=GameOauth&a=xyx_payinfo&"+Md5Utils.obj_cntstr(e),i.payOnComplete,i,i.payIOError,egret.HttpMethod.GET,egret.HttpResponseType.TEXT,e)},fail:function(t){console.log("midashi payment fail:",t)}})}}else console.log("payInfo fail:"+o.info)}catch(c){console.log("payInfo exception:",c)}},e.prototype.payIOError=function(t){console.log("pay data error: ",t)},e.prototype.jumpXcx=function(t,e,i){window.wx.navigateToMiniProgram({appId:t,envVersion:"release",path:e+"?"+i,success:function(t){}})},e.prototype.shareXcx=function(t,e,i){window.wx.shareAppMessage({title:t,imageUrl:e}),this.shareCallback&&this.shareCallback instanceof Function&&this.shareCallback()},e.prototype.isShowSharePortalIcon=function(){return!0},e.prototype.SDKShowShare=function(t){this.shareCallback=null,t&&t instanceof Function&&(this.shareCallback=t);var e={token:this.token,game_id:this.id,session_3rd:GlobalModel.getUrlParamValue("session_3rd")};PHPConfig.requestPhpData(this.url,"g=Wap&m=Wxaapi&a=game_share&"+Md5Utils.obj_cntstr(e),this.shareComplete,this,function(t){console.log("share io error!!!")})},e.prototype.shareComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?(console.log("share ok"),this.shareXcx(e.info.title,e.info.imgUrl,e.info.desc)):console.log("share info get fail"+e.info)}catch(i){console.log("share fail",i)}},e.prototype.loginOnComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);console.log("loginOnComplete responseJson",e),GlobalModel.openID=e.uid,e.shellext&&GlobalModel.setUrlParamValue("shellext",e.shellext),e.name&&GlobalModel.setUrlParamValue("name",e.name),e.wecha_id&&GlobalModel.setUrlParamValue("wecha_id",e.wecha_id),e.scene&&GlobalModel.setUrlParamValue("scene",e.scene),e.session_3rd&&GlobalModel.setUrlParamValue("session_3rd",e.session_3rd),e.pfid&&GlobalModel.setUrlParamValue("pfid",e.pfid),e.lzGameId&&(GlobalModel.gameId=e.lzGameId),SceneMgr.ins().runScene(StartGameScene);var i={token:this.token,game_id:this.id,session_3rd:GlobalModel.getUrlParamValue("session_3rd")};PHPConfig.requestPhpData(this.url,"g=Wap&m=Wxaapi&a=game_share&"+Md5Utils.obj_cntstr(i),function(t){try{var e=JSON.parse(t.currentTarget.response);1001==e.status?(console.log("init share ok:",e.info),window.wx.onShareAppMessage(function(){return{title:e.info.title,imageUrl:e.info.imgUrl}})):console.log("init share info get fail"+e.info)}catch(i){console.log("init share fail",i)}},this,function(t){console.log("init share io error!!!")})}catch(o){console.log("loginOnComplete fail",o)}},e.prototype.loginIOError=function(t){console.log("loginIOError",t)},e.prototype.nativeCallback=function(e){t.prototype.nativeCallback.call(this,e);var i=JSON.parse(e),o=i.callType;if("init"==o)debug.log("SDK init ok");else if("login"==o)if(0==i.sdkcode){var n=window.wx.getLaunchOptionsSync(),r=i.data,a={token:this.token,channel_id:this.channel_id,code:r.code,scene:n&&n.query&&JSON.stringify(n.query)},s=Md5Utils.obj_md5_args(a);console.log("wx php args:"+s),console.log("wx php url：",GlobalModel.sdkDomain+"/"+GlobalModel.pf.toLowerCase()+"/"+GlobalModel.gameId+"/sdkurlcallback"),PHPConfig.requestPhpData(GlobalModel.sdkDomain+"/"+GlobalModel.pf.toLowerCase()+"/"+GlobalModel.gameId+"/sdkurlcallback",s,this.loginOnComplete,this,this.loginIOError)}else this.SDKLoginNative()},e.prototype.getStatusHeight=function(){if(this.systemInfo){var t=930/this.systemInfo.windowHeight;return this.systemInfo.statusBarHeight*t}return 0},e.prototype.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var i=Math.max(t.length,e.length);t.length<i;)t.push("0");for(;e.length<i;)e.push("0");for(var o=0;i>o;o++){var n=parseInt(t[o]),r=parseInt(e[o]);if(n>r)return 1;if(r>n)return-1}return 0},e.prototype.subscribeMessage=function(){if(ActorControl.level>=10){var t={token:this.token};PHPConfig.requestPhpData(this.url,"g=Wap&m=Mwxaapi&a=templatemsg&"+Md5Utils.obj_cntstr(t),this.getSubscribeData,this,function(t){console.log("get subscribeMessage fail")})}else StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_END,this.subscribeMessage,this)},e.prototype.getSubscribeData=function(t){var e=this;try{var i=JSON.parse(t.currentTarget.response);if(1001==i.status){console.log("subscribedata: ",i);for(var o=[],n=0,r=i.data;n<r.length;n++){var a=r[n];o.push(a.template_id)}window.wx.getSetting({withSubscriptions:!0,success:function(t){var i=!1;if(console.log("user subscriptionsSetting:",t.subscriptionsSetting),o)for(var n=0,r=o;n<r.length;n++){var a=r[n];if(t.subscriptionsSetting.itemSettings&&"accept"==t.subscriptionsSetting.itemSettings[a]){i=!0;break}}i?(console.log("already subscribeMsg aleast One"),StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_END,e.wxsubFun,e)):(e.wxsubFun||(e.wxsubFun=function(t){if(t.target instanceof SignInItemRenderer){for(var i=!1,n=t.target.parent;n;){if(n instanceof SignInPanel){i=!0;break}n=n.parent}i&&(console.log("request wxsubFun:",o),e.hasPopSub=!0,window.wx.requestSubscribeMessage&&window.wx.requestSubscribeMessage({tmplIds:o,success:function(t){StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_END,e.wxsubFun,e);var i=[];for(var o in t)"accept"==t[o]&&i.push(o);if(console.log("user successSubscribeMsg:",i),i.length>=1){var n={token:e.token,template_id:i[0],appid:e.appId,session_3rd:GlobalModel.getUrlParamValue("session_3rd")};console.log("send subscribeMsg to channel：",e.url+"?g=Wap&m=Wxaapi&a=for_template_all&"+Md5Utils.obj_cntstr(n)),PHPConfig.requestPhpData(e.url,"g=Wap&m=Wxaapi&a=for_template_all&"+Md5Utils.obj_cntstr(n),function(t){try{var e=JSON.parse(t.currentTarget.response);console.log("send subscribeMsg Data: ",e),0==e.errcode&&console.log("send subscribeMsg Success: ",e)}catch(i){console.log("send subscribeMsg Fail",i)}},e,function(t){console.log("send subscribeMsg IO Fail")})}},fail:function(t){console.log("wx subscribeMsg Fail:",t)}}))}}),e.hasPopSub||(e.hasPopSub=!0,StageUtils.ins().getStage().removeEventListener(egret.TouchEvent.TOUCH_END,e.wxsubFun,e),StageUtils.ins().getStage().addEventListener(egret.TouchEvent.TOUCH_END,e.wxsubFun,e)))}})}else console.log("subscribedata no success")}catch(s){console.log("get subscribeData Fail",s)}},e}(PlatformBase);__reflect(PlatformZwWxMini.prototype,"PlatformZwWxMini");var PlatformZwWXMiniH5=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.url="https://gameluotuo.com/index.php",e}return __extends(e,t),e.prototype.SDKMiniAuditVer=function(){return 1},e.prototype.SDKInitNative=function(){GlobalModel.pf="zwwxmini",GlobalModel.openID=GlobalModel.getUrlParamValue("uid")},e.prototype.SDKIsNeedLoginNative=function(){return!1},e.prototype.showSuperVip=function(){return!0},e.prototype.GetSDKCheckAccountArgs=function(){var t={pf:GlobalModel.pf,gameId:GlobalModel.gameId,channelId:GlobalModel.channelId,gameVersion:GlobalModel.gameVersion,shellext:GlobalModel.getUrlParamValue("shellext")};return console.log("check account args:",JSON.stringify(t)),JSON.stringify(t)},e.prototype.SDKCreateRoleNative=function(t){this.setData(t,!0)},e.prototype.SDKEnterGameNative=function(t){this.setData(t)},e.prototype.SDKUserUpgradeNative=function(t){this.setData(t,!1,!0)},e.prototype.setData=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var o="0";e&&(o="1"),i&&(o="2");var n=ActorControl.level,r={userToken:GlobalModel.getUrlParamValue("userToken"),channel_id:GlobalModel.getUrlParamValue("channel_id"),area:GlobalModel.srvname||"",role_name:ActorControl.myName||"",new_role:"1"!=o?"0":o,rank:n,money:ActorControl.yb},a=this.getSign(r);r.sign=a;var s=Md5Utils.obj_cntstr(r);console.log("Report info:"+s),PHPConfig.requestPhpData(this.url+"/Home/GameOauth/roles",s,this.onGetComplete,this,this.onGetIOError,egret.HttpMethod.GET)},e.prototype.onGetComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);"1001"==e.status?console.log("Report ok"):console.log("Report fail"+e.info)}catch(i){console.log("Report fail exception:",i)}},e.prototype.onGetIOError=function(t){console.log("Report io fail: ",t)},e.prototype.SDKPayNative=function(t){var e={userToken:GlobalModel.getUrlParamValue("userToken"),channel_id:GlobalModel.getUrlParamValue("channel_id"),item_id:t.itemid,orderid:t.order,price:t.fee,other:""},i=this.getSign(e);e.sign=i;var o=Md5Utils.obj_cntstr(e);console.log("pay parm："+o),PHPConfig.requestPhpData(this.url+"/Home/GameOauth/pay_info",o,this.payOnComplete,this,this.payIOError,egret.HttpMethod.GET)},e.prototype.payOnComplete=function(t){try{var e=JSON.parse(t.currentTarget.response);"1001"==e.status?(console.log("pay info get ok"),window.parent.postMessage(e.data,"*")):console.log("pay info get fail "+e.info)}catch(i){console.log("pay info fail exception: ",i)}},e.prototype.payIOError=function(t){console.log("pay info io error: ",t)},e.prototype.getSign=function(t){var e=Md5Utils.obj_cntstr(t);return EncryptMd5.hex_md5(e+SDKConst.ZwWxMiniH5CycjAppSecret)},e}(PlatformBase);__reflect(PlatformZwWXMiniH5.prototype,"PlatformZwWXMiniH5");var ReportData=function(){function t(){this.isComplete=!1,this.httpRequest=new egret.HttpRequest,this.httpRequestUrl=[]}return t.getIns=function(){return this._ins=this._ins||new t,this._ins},t.prototype.reportPlayedServer=function(){var t={gameid:GlobalModel.gameId,account:GlobalModel.openID,channelId:GlobalModel.channelId,serverid:GlobalModel.srvid,pfid:GlobalModel.pfid,pf:GlobalModel.pf,time:Date.now()},e=Md5Utils.obj_md5_args(t,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_USER_URL,e)},t.prototype.reportActorInfo=function(){var t={account:GlobalModel.openID,serverid:GlobalModel.srvid,time:Date.now(),pfid:GlobalModel.pfid,gameid:GlobalModel.gameId,channelId:GlobalModel.channelId,actorid:ActorControl.actorID,pf:GlobalModel.pf},e=Md5Utils.obj_md5_args(t,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_ACTOR_INFO,e)},t.prototype.reportRoleInfo=function(t,e,i,o){if(void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),"Test"!=GlobalModel.pf){var n={pf:GlobalModel.pf,gameid:GlobalModel.gameId,account:GlobalModel.openID,serverid:GlobalModel.srvid,servername:GlobalModel.srvname,actorid:ActorControl.actorID,actorname:t.nickName||ActorControl.myName,power:0==ActorControl.power?t.power:ActorControl.power,level:ActorControl.level,viplevel:vipControl.lv,zslevel:reincarnateControl.lv,channelId:GlobalModel.channelId,roleCTime:GlobalModel.createActorTime,isuplevel:o?"createRole":i?"levelUp":"login"},r=Md5Utils.obj_md5_args(n,PHPConfig.VERIFY_KEY,!0,[],["isuplevel"]);this.reportUrl(PHPConfig.SET_ROLE_INFO,r)}},t.prototype.reportChatInfo=function(t,e,i,o,n){void 0===i&&(i=0),void 0===o&&(o=""),void 0===n&&(n="");var r={logdate:(GameServer.serverTime/1e3).toFixed(0),counter:"chat",pfromId:GlobalModel.gameId,fromServerId:GlobalModel.mainSrvid,fromActorId:ActorControl.actorID,fromActorName:ActorControl.myName,fromChannel:GlobalModel.pf,toServerId:GlobalModel.mainSrvid,toActorId:i,toActorName:o,toChannel:n,msgType:t,content:e},a=Md5Utils.obj_md5_args(r,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_GM_REPORT,a,egret.HttpMethod.POST)},t.prototype.reportIntervalPoint=function(t,e,i){if("Test"!=GlobalModel.pf){var o={counter:"accountDwellTime",sid:window.gameSig,pfromId:GlobalModel.pfid,time:(t/1e3).toFixed(1),typeId:e,logdate:(Date.now()/1e3).toFixed(0)};GlobalModel.openID&&(o.account=GlobalModel.openID,o.isNew=i);var n=Md5Utils.obj_md5_args(o,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_GM_REPORT,n,egret.HttpMethod.POST)}},t.prototype.reportChannelData=function(t,e){if("Test"!=GlobalModel.pf){var i={pf:GlobalModel.pf,gameid:GlobalModel.gameId,actorid:ActorControl.actorID,serverid:GlobalModel.srvid,time:Date.now(),uid:GlobalModel.openID,channelid:GlobalModel.channelId,serverName:GlobalModel.srvname,infoType:e,infoNum:t,gameRoleName:ActorControl.myName},o=Md5Utils.obj_md5_args(i,PHPConfig.VERIFY_KEY,!0);
this.reportUrl(PHPConfig.GET_CHANNEL_URL,o,egret.HttpMethod.POST)}},t.prototype.reportMicroclientReward=function(){var t={pfrom_id:GlobalModel.pfid,server_id:GlobalModel.mainSrvid,actorid:ActorControl.actorID,actorname:ActorControl.myName,counter:"wdrebate",channel:GlobalModel.channelId},e=Md5Utils.obj_md5_args(t,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_GM_REPORT,e,egret.HttpMethod.POST)},t.prototype.reportDoPoint=function(t){if("Test"!=GlobalModel.pf){var e={logdate:(Date.now()/1e3).toFixed(0),counter:1==t?"loadVersion":"loadRole",pfromId:GlobalModel.gameId},i=Md5Utils.obj_md5_args(e,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_GM_REPORT,i,egret.HttpMethod.POST)}},t.prototype.reportClientErrorLog=function(t,e){if("Test"!=GlobalModel.pf&&GlobalModel.openClientErrorLog){var i={pfromId:GlobalModel.pfid,serverId:GlobalModel.srvid,account:GlobalModel.openID,linkTime:(Date.now()/1e3).toFixed(0),desc:e,type:t,counter:"crossServerLogout"},o=Md5Utils.obj_md5_args(i,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_GM_REPORT,o,egret.HttpMethod.POST)}},t.prototype.reportDoPointLogin=function(){if("Test"!=GlobalModel.pf){var t={counter:"loadActorLogin",account:GlobalModel.openID,pfromId:GlobalModel.pfid,serverId:GlobalModel.srvid,actorId:ActorControl.actorID,loginTime:(Date.now()/1e3).toFixed(0)},e=Md5Utils.obj_md5_args(t,PHPConfig.VERIFY_KEY,!0);this.reportUrl(PHPConfig.SET_GM_REPORT,e,egret.HttpMethod.POST)}},t.prototype.reportUrl=function(t,e,i){var o=new HrInfo;o.url=t,o.params=e,o.method=i,o.sendCount=3,this.httpRequestUrl.push(o),this.sendReportUrl()},t.prototype.sendReportUrl=function(){if(0==this.isComplete&&this.httpRequestUrl.length>0){var t=this.httpRequestUrl[0].url,e=this.httpRequestUrl[0].params,i=this.httpRequestUrl[0].method;this.httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),i==egret.HttpMethod.POST?(this.httpRequest.open(t,egret.HttpMethod.POST),this.httpRequest.send(e)):(this.httpRequest.open(t+"?"+e,egret.HttpMethod.GET),this.httpRequest.send()),this.isComplete=!0,this.httpRequest.addEventListener(egret.Event.COMPLETE,this.onGetComplete,this),this.httpRequest.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onGetIOError,this)}},t.prototype.onGetComplete=function(t){this.isComplete=!1,this.httpRequestUrl.shift(),this.sendReportUrl()},t.prototype.onGetIOError=function(t){this.isComplete=!1,this.httpRequestUrl[0].sendCount--,this.httpRequestUrl[0].sendCount>0&&this.sendReportUrl()},t}();__reflect(ReportData.prototype,"ReportData");var HrInfo=function(){function t(){}return t}();__reflect(HrInfo.prototype,"HrInfo");var SDKManager=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.doPointTimes=0,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.Init=function(){var t=egret.getDefinitionByName("Platform"+GlobalModel.pf);return t?(this.platform=new t,debug.log("Platform:",this.platform,GlobalModel.pf),e.addNativeCallBack("callJSNativeFunc",this.platform.nativeCallback,this),e.addNativeCallBack("callChannelType",this.platform.nativeCallChannelType,this),e.addNativeCallBack("callAppVersion",this.platform.nativeCallAppVersion,this),void this.SDKInitNative()):void alert("Unknown platform:"+GlobalModel.pf)},e.prototype.SDKMiniAuditVer=function(){return this.platform?this.platform.SDKMiniAuditVer():0},e.prototype.SDKIsNeedInit=function(){return this.platform?this.platform.SDKIsNeedInit():!1},e.prototype.SDKInitComplete=function(){EventMgr.ins().dispatch(0)},e.addNativeCallBack=function(t,e,i){egret.ExternalInterface.addCallback(t,function(t){e.apply(i,[t])})},e.prototype.SDKInitNative=function(){this.platform&&this.platform.SDKInitNative()},e.prototype.SDKIsNeedLoginNative=function(){return this.platform?this.platform.SDKIsNeedLoginNative():!1},e.prototype.SDKAutoLoginNative=function(t){this.platform&&this.platform.SDKAutoLoginNative(t)},e.prototype.SDKLoginNative=function(t){this.platform&&this.platform.SDKLoginNative(t)},e.prototype.SDKHasLoginScene=function(){return this.platform?this.platform.SDKHasLoginScene():void 0},e.prototype.GetSDKCheckAccountArgs=function(){return this.platform?this.platform.GetSDKCheckAccountArgs():void 0},e.prototype.SDKCreateRoleNative=function(t){this.platform&&this.platform.SDKCreateRoleNative(t),ReportData.getIns().reportRoleInfo(t,!1,!1,!0)},e.prototype.SDKEnterGameNative=function(t){this.platform&&this.platform.SDKEnterGameNative(t),ReportData.getIns().reportRoleInfo(t,!0),this.doPointTimes||(ReportData.getIns().reportDoPointLogin(),this.doPointTimes+=1),GlobalModel.isMicroclient&&ReportData.getIns().reportMicroclientReward()},e.prototype.SDKUserUpgradeNative=function(t){this.platform&&this.platform.SDKUserUpgradeNative(t),ReportData.getIns().reportRoleInfo(t,!1,!0)},e.prototype.GetMakeOrderSdkArgs=function(t){return this.platform?this.platform.GetMakeOrderSdkArgs(t):null},e.prototype.CheckSupportRecharge=function(){return this.platform?this.platform.CheckSupportRecharge():!0},e.prototype.SDKPayNative=function(t){this.platform&&this.platform.SDKPayNative(t)},e.prototype.SDKSetDataNative=function(t){this.platform&&this.platform.SDKSetDataNative(t)},e.prototype.SDKLogoutNative=function(){this.platform&&this.platform.SDKLogoutNative()},e.prototype.SDKExitNative=function(){this.platform&&this.platform.SDKExitNative()},e.prototype.SDKShowShare=function(t){this.platform&&this.platform.SDKShowShare(t)},e.prototype.SDKShowQRCode=function(){this.platform&&this.platform.SDKShowQRCode()},e.prototype.SDKStartForGift=function(){this.platform&&this.platform.SDKStartForGift()},e.prototype.SDKFaceStartGift=function(){this.platform&&this.platform.SDKFaceStartGift()},e.prototype.NativeCallback=function(t){this.platform&&this.platform.nativeCallback(t)},e.prototype.SDKTapExecute=function(){this.platform&&this.platform.SDKTapExecute()},e.prototype.SDKShowImmersiveIconNative=function(t){this.platform&&this.platform.SDKShowImmersiveIconNative(t)},e.prototype.SDKShowLogout=function(){return this.platform?this.platform.SDKShowLogout():!1},e.prototype.SDKShowSuperVip=function(){return this.platform?this.platform.showSuperVip():!1},e.prototype.getStatusHeight=function(){return this.platform?this.platform.getStatusHeight():0},e.prototype.getBottomSafeHeight=function(){return this.platform?this.platform.getBottomSafeHeight():0},e.prototype.isShowMiniAccountJumpPortalIcon=function(){return this.platform?this.platform.isShowMiniAccountJumpPortalIcon():!1},e.prototype.miniAccountJumpPortalIconTap=function(){this.platform&&this.platform.miniAccountJumpPortalIconTap()},e.prototype.isHideRechargeShow=function(){return this.platform?this.platform.isHideRechargeShow():!1},e.prototype.isShowSharePortalIcon=function(){return this.platform?this.platform.isShowSharePortalIcon():!1},e}(SingleClass);__reflect(SDKManager.prototype,"SDKManager");var UnitFilterUtils=function(){function t(){}return t.getBuffFilter=function(t){return 1==t?FilterUtils.ARRAY_GRAY_FILTER:2==t?FilterUtils.ARRAY_GREEN_FILTER:null},t.getUnitFilter=function(t){var e=0;return this.isHard(t)?e=1:this.isPoison(t)&&(e=2),e},t.isHard=function(t){return 51001==t||150065==t},t.isPoison=function(t){return 23001==t||61001==t||150071==t},t}();__reflect(UnitFilterUtils.prototype,"UnitFilterUtils");var UnitItem=function(t){function e(){var e=t.call(this)||this;return e._effId=0,e.ignoreLeak=!0,e.touchEnabled=!1,e.touchChildren=!1,e._itemImg=new eui.Image,e._itemImg.x=-17,e._itemImg.y=-17,e._itemImg.scaleX=e._itemImg.scaleY=.6,e.addChild(e._itemImg),e._roatImg=new eui.Image("point3"),e._roatImg.anchorOffsetX=5,e._roatImg.anchorOffsetY=5,e._roatImg.alpha=0,e.addChild(e._roatImg),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.removeRoatEffect,e),e}return __extends(e,t),e.prototype.setData=function(t){t.type?this._itemImg.source=DataCenter.ins().ItemConfig[t.id].icon+"_png":1==t.id?this._itemImg.source="icgoods117_png":2==t.id?this._itemImg.source="icgoods121_png":4==t.id?this._itemImg.source="200136_png":9==t.id&&(this._itemImg.source="500007_png"),this._effId=t.dropEffId},e.prototype.addRoatEffect=function(){this.removeRoatEffect();var t=egret.Tween.get(this._roatImg,{loop:!0});t.to({alpha:1},200).to({rotation:90},1e3).to({alpha:0},200).wait(300)},e.prototype.removeRoatEffect=function(){this._roatImg.alpha=0,this._roatImg.rotation=0,egret.Tween.removeTweens(this._roatImg)},e.prototype.addEffect=function(){if(this._effId){this._itemMc||(this._itemMc=ObjectPool.pop("GameMovieClip")),this._itemMc.parent||this.addChild(this._itemMc);var t=DataCenter.ins().DropItemEffectConfig[this._effId];t&&t.resource&&this._itemMc.playFile(PATH_EFF+t.resource,-1)}},e.prototype.removeEffect=function(){this._itemMc&&(this._itemMc.destroy(),this._itemMc=null)},e}(BaseLeakDisplay);__reflect(UnitItem.prototype,"UnitItem");var UnitItemName=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e._nameTxt=new eui.Label,e._nameTxt.stroke=1,e._nameTxt.strokeColor=ColorUtils.BLACK,e._nameTxt.size=14,e._nameTxt.y=-25,e._nameTxt.width=120,e._nameTxt.x=-60,e._nameTxt.textAlign=egret.HorizontalAlign.CENTER,e.addChild(e._nameTxt),e}return __extends(e,t),e.prototype.setData=function(t){if(t.type){if(500007==t.id)this._nameTxt.text=""+t.count;else{var e=DataCenter.ins().ItemConfig[t.id].name;t.count>1?this._nameTxt.text=t.count+e:this._nameTxt.text=e}this._nameTxt.textColor=ItemUtils.getQualityColor(DataCenter.ins().ItemConfig[t.id])}else 1==t.id?(this._nameTxt.text=""+t.count,this._nameTxt.textColor=LangMgr.getColor("qualityColor0")):2==t.id?(this._nameTxt.text=LangMgr.getValueByKey("charItemYB",t.count),this._nameTxt.textColor=LangMgr.getColor("qualityColor5")):4==t.id?(this._nameTxt.text=LangMgr.getValueByKey("charItemStone",t.count),this._nameTxt.textColor=LangMgr.getColor("qualityColor2")):9==t.id&&(this._nameTxt.text=LangMgr.getValueByKey("charItemessence",t.count),this._nameTxt.textColor=LangMgr.getColor("qualityColor1"))},e}(egret.DisplayObjectContainer);__reflect(UnitItemName.prototype,"UnitItemName");var UnitItemNameMerge=function(t){function e(){var e=t.call(this)||this;return e.touchEnabled=!1,e.touchChildren=!1,e.item=new UnitItem,e.itemName=new UnitItemName,e}return __extends(e,t),Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){this._infoModel=t},enumerable:!0,configurable:!0}),e.prototype.setData=function(t){this.item.setData(t),this.itemName.setData(t),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this)},e.prototype.setItemParent=function(t){this._itemParent=t,this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this),this._itemParent.addChild(this)},e.prototype.addFloatEffect=function(){egret.Tween.removeTweens(this.item);var t=egret.Tween.get(this.item),e=this.item.y;this.item.y-=100,t.to({y:e},500,egret.Ease.bounceOut)},e.prototype.addRoatEffect=function(){this.item.addRoatEffect()},e.prototype.removeRoatEffect=function(){this.item.removeRoatEffect()},e.prototype.addEffect=function(){this.item.addEffect()},e.prototype.removeEffect=function(){this.item.removeEffect()},e.prototype.onAdd=function(t){this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),RecycleMgr.ins().reloadContainer(this.item),this._itemParent?(this._itemParent.addChild(this.item),this._itemParent.addChild(this.itemName)):(DropControl.dropContainer.addChild(this.item),DropControl.dropNameContainer.addChild(this.itemName))},e.prototype.onRemove=function(t){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.item.parent&&this.item.parent.removeChild(this.item),this.itemName.parent&&this.itemName.parent.removeChild(this.itemName),this.removeRoatEffect(),this.removeEffect()},Object.defineProperty(e.prototype,"x",{get:function(){return egret.superGetter(e,this,"x")},set:function(t){egret.superSetter(e,this,"x",t),this.itemName.x=t,this.item.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return egret.superGetter(e,this,"y")},set:function(t){egret.superSetter(e,this,"y",t),this.itemName.y=t,this.item.y=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"team",{get:function(){return this.infoModel.team},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.item.scaleX=1,this.item.scaleY=1,this.itemName.scaleX=1,this.itemName.scaleY=1},e.prototype.destruct=function(){this.item.scaleX=1,this.item.scaleY=1,this.itemName.scaleX=1,this.itemName.scaleY=1,this._itemParent=null,this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onAdd,this)},e}(egret.DisplayObjectContainer);__reflect(UnitItemNameMerge.prototype,"UnitItemNameMerge");var UnitMiner=function(t){function e(){var e=t.call(this)||this;return e.npcHead.currentState=e.npcHead.states[1],e}return __extends(e,t),Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){this._infoModel=t},enumerable:!0,configurable:!0}),e.prototype.updateModel=function(){t.prototype.updateModel.call(this);var e=DataCenter.ins().MineSourceConfig[this.infoModel.configID];this.npcHead.nameTxt.text=this.infoModel.name+LangMgr.getValueByKey("charMinerWorker"),this.npcHead.nameTxt.textColor=e.color,this.updateTime(),this.updateTitleState()},e.prototype.updateTime=function(){var t=Math.floor((this.infoModel.endTime-GameServer.serverTime)/1e3);t>=0?this.npcHead.timeTxt.text=DateUtils.getFormatBySecond(t,DateUtils.TIME_FORMAT_3):mineControl.remove(this.infoModel.index),this.playAction(UnitAction.ATTACK,function(){})},e.prototype.updateTitleState=function(){this.npcHead.updateState(this.infoModel)},e.prototype.destruct=function(){this.destroy(),ObjectPool.push(this)},e}(UnitNpc);__reflect(UnitMiner.prototype,"UnitMiner");var UnitNpcHead=function(t){function e(){var e=t.call(this)||this;return e.states=["none","mine"],e.skinName="UnitNpcHeadSkin",e.contentGroup.touchEnabled=!1,e.touchEnabled=!1,e}return __extends(e,t),e.prototype.updateModel=function(t){var e=t.npcConfig;e&&e.title?this.titleGroup.visible=!0:this.titleGroup.visible=!1,this.titleImg.source=e?e.title:"",this.icon.source=e?e.headIcon:""},e.prototype.updateState=function(t){t.isBeFight?this.setState(1):mineControl.getIsCanAtk(t)?this.setState(2):this.setState(0)},e.prototype.setState=function(t){1==t?this.workerState.source="":2==t?this.workerState.source="kuanggong_title":this.workerState.source="",this.setEff(t)},e.prototype.setEff=function(t){if(1==t){var e=this.getEff();e.playFile(PATH_EFF+"fighting",-1),e.x=this.stateGroup.width>>1,e.y=-20,this.stateGroup.addChild(e)}else this.eff&&(DisplayUtils.removeFromParent(this.eff),this.eff.dispose())},e.prototype.getEff=function(){return this.eff||(this.eff=new GameMovieClip),this.eff},e}(eui.Component);__reflect(UnitNpcHead.prototype,"UnitNpcHead");var UnitRole=function(t){function e(){var e=t.call(this)||this;return e.ringMc=[],e.zhanLingAttack=!1,e.touchEnabled=!1,e.touchChildren=!1,e.AI_STATE=0,e.neigongBar=new eui.ProgressBar,e.neigongBar.skinName="bloodyelskin",e.neigongBar.anchorOffsetY=-5,e.neigongBar.labelDisplay.visible=!1,e.neigongBar.labelFunction=function(){return""},e.titleCantainer.addChild(e.neigongBar),e.neigongBar.anchorOffsetX=Math.floor(e.neigongBar.width>>1),e._nameTxt.textColor=LangMgr.getColor("color39"),e._nameGroup.visible=!0,e._lilianTitle=new eui.Image,e._lilianTitle.scaleX=.5,e._lilianTitle.scaleY=.5,e._lilianTitle.bottom=-1,e._nameGroup.addChild(e._lilianTitle),e}return __extends(e,t),e.prototype.createTweenObj=function(){var t=this;this.dieTweenObj={set alpha(e){t.alpha=e},get alpha(){return t.alpha}},this.moveTweenObj={set x(e){t.x=e>>0,t.moveCamera()},set y(e){t.y=e>>0,t.moveCamera()},get x(){return t.x},get y(){return t.y}}},e.prototype.setClothesFileName=function(t,e){void 0===e&&(e=1);var i=this.infoModel;1==e?this.initBody(PATH_RENWU+t+"_"+i.sex):this.addMc(e,PATH_RENWU+t+"_"+i.sex)},e.prototype.setWeaponFileName=function(t,e){void 0===e&&(e=0),this.addMc(2,PATH_WUQI+t+"_"+e)},e.prototype.setWing=function(){var t=this.infoModel,e=t.isMy?ServerStorage.ins().getBitBool(ClientSetBit.hide_mine_wing):ServerStorage.ins().getBitBool(ClientSetBit.hide_other_wing);if(e)this.removeMc(3);else if(t.zhuangbei[2]>0){var i=DataCenter.ins().FashionIdConfig[t.zhuangbei[2]].res;this.setWingFileName(i)}else t.wingsData.openStatus&&DataCenter.ins().FeatherLevelConfig[t.wingsData.lv]&&this.setWingFileName(DataCenter.ins().FeatherLevelConfig[t.wingsData.lv].appearance)},e.prototype.setWingFileName=function(t){this.addMc(3,PATH_CHIBANG+t)},e.prototype.setHeirloomFileName=function(t){this.addMc(6,PATH_EFF+t)},e.prototype.setSoulFileName=function(t){"cq"==GlobalModel.mianUIState&&this.addMc(7,PATH_WUQI+t)},e.prototype.loadOther=function(e){if(this.action==UnitAction.DIE){if(1!=e&&2!=e){var i=this.getMc(e);return void(i&&(i.visible=!1))}}else{var i=this.getMc(e);i&&(i.visible=!0)}(8!=e||!this.zhanLingAttack&&this._state!=UnitAction.ATTACK)&&t.prototype.loadOther.call(this,e)},e.prototype.playBody=function(e){t.prototype.playBody.call(this,e),this.ringMc&&this.ringMc.length>0&&this.updateRingMC()},e.prototype.getResDir=function(t){var e=2*(this._dir-4);0>e&&(e=0);var i=UnitModel.getSceneDir();if(5!=i&&(i=UnitModel.getBodyDir()),GameServer.serverOpenDay<7||5==i)return this._dir-e;var o=this._dir-e;return 2>o?1:3},e.prototype.updateBlood=function(e){var i=this;void 0===e&&(e=!1),t.prototype.updateBlood.call(this,e),this._hpBar.value<=0&&this.onDead(function(){i.deadDelay()})},e.prototype.parseModel=function(){var t=this.infoModel;this._hpBar.thumb.source=this.isMy?"boolGreen_png":"boolRed_png",this.updateShadow(),this.setCharName(t.guildAndName),this.setLilian(t.lilianUrl),this.updateBlood(!0),this.updateNeiGong();var e=!1;if(e=appearanceControl.checkCanShow(t,0,0)){var i=appearanceControl.getEquipEffName(t,0,0);i&&this.setWeaponFileName(i,t.sex)}else if(e=appearanceControl.checkCanShow(t,0,1)){var i=appearanceControl.getEquipEffName(t,0,1);if(i){var o=appearanceControl.getWeaponFashionSex(t);this.setWeaponFileName(i,o)}}if(e=appearanceControl.checkCanShow(t,0,4)){var i=appearanceControl.getEquipEffName(t,0,4);if(i)if(t.heirloomDressId){var n=DataCenter.ins().HeirloomillusionConfig[t.heirloomDressId];this.setHeirloomFileName(n.eff+"w")}else this.setHeirloomFileName(i)}if(e=appearanceControl.checkCanShow(t,2,0)){var i=appearanceControl.getEquipEffName(t,2,0);i?this.setClothesFileName(i):this.setClothesFileName(RENWU_PREFIX+"000")}else if(e=appearanceControl.checkCanShow(t,2,1)){var i=appearanceControl.getEquipEffName(t,2,1);i&&this.setClothesFileName(i)}if(t.thirteenEquipLv){var i=appearanceControl.getEquipEffName(t,0,5);i&&this.setWeaponFileName(i,t.sex),i=appearanceControl.getEquipEffName(t,2,5),i&&this.setClothesFileName(i,t.sex)}if(6==t.weaponViewType&&t.weaponViewId){var i=appearanceControl.getEquipEffName(t,0,6);i&&this.setWeaponFileName(i,t.sex)}if(6==t.clothesViewType&&t.clothesViewId){var i=appearanceControl.getEquipEffName(t,2,6);i&&this.setClothesFileName(i)}this.setWing(),this.updateTitle(),this.updateNameColor()},e.prototype.updateNameColor=function(){var t=this.infoModel;return void 0==t?void debug.log("Model is null!!!"):void(t.camp>0&&campWarControl.isCampWar()?this.setNameTxtColor(t.camp!=campWarControl.camp?16711680:65280):!this.isMy&&t.camp>0&&crossArenaControl.isKFArena?this.setNameTxtColor(t.camp!=crossArenaControl.myCampId?16711680:10092288):2==this.team?this.setNameTxtColor(16776960):this.setNameTxtColor(16777215))},e.prototype.setHeirloomSuitEff=function(){var t=this.infoModel;if(void 0!=t&&t.heirloom&&!t.heirloomDressId){var e=t.heirloom.getSuitConfig(t);e&&e.weff&&this.setHeirloomFileName(e.weff)}},e.prototype.addBuff=function(e){t.prototype.addBuff.call(this,e);var i=e.effConfig;if(0==MapControl.copyId)switch(i.type){case 5:var o=void 0;if(0==this.team){var n=artifactControl.getReviseBySkill(35001),r=godWeaponControl.getReviseBySkill(35001),a=void 0;r&&(a=r[0]);var s=crazyDogControl.getLinkSkillReviseCfg(35001),l=i.args.a;n&&n.args&&n.args[0]&&(l+=n.args[0].vals[2]),a&&a.args&&a.args[0]&&(l+=a.args[0].vals[2]),s&&(l+=s.args[0].vals[2]),o=copyControl.createModel(DataCenter.ins().MonstersConfig[l]),o.x=this.x,o.y=this.y,o.masterHandle=this.infoModel.handle,o.setAtt(9,this.infoModel.getAtt(9));var h=0,u=o.getAtt(4);if(n&&n.args&&n.args[0]){var c=n.args[0].vals[3]?n.args[0].vals[3]:1;h+=this.infoModel.getAtt(4)*c}if(a&&a.args&&a.args[0]){var c=a.args[0].vals[3]?a.args[0].vals[3]:1;h+=this.infoModel.getAtt(4)*c}o.setAtt(4,(h>>0)+u)}else o=copyControl.createModel(DataCenter.ins().MonstersConfig[i.args.a]),o.x=this.x,o.y=this.y,o.masterHandle=this.infoModel.handle,o.setAtt(9,this.infoModel.getAtt(9));o.isMy=o.checkHandleIsMy(o.masterHandle),gameControl.createEntityByModel(o,this.team)}},e.prototype.updateNeiGong=function(){if(this.infoModel){var t=this.infoModel.getAtt(26);this.neigongBar.visible=this.checkNeigongVisible(),this.neigongBar.maximum=t,this.neigongBar.value=this.infoModel.getAtt(25),this.neigongBar.visible&&(this.showName(this.neigongBar.visible),this.showBlood(this.neigongBar.visible))}},e.prototype.checkNeigongVisible=function(){var t=this.infoModel.getAtt(26);return 0!=t&&this._state!=UnitAction.DIE},e.prototype.updateTitle=function(){var t=this.infoModel,e=t.title,i=t.isMy?ServerStorage.ins().getBitBool(ClientSetBit.hide_mine_title):ServerStorage.ins().getBitBool(ClientSetBit.hide_other_title);if(this.removeTitle(),this.action!=UnitAction.DIE&&!i&&this.getIsShowBody()){var o=DataCenter.ins().TitleConfig[e];t.canWearNewTitle&&t.newTitle&&(o=DataCenter.ins().FreshManTitleConfig[t.newTitle]),o?o.img?(null==this._title&&(this._title=new eui.Image,this._title.anchorOffsetX=115,this._title.anchorOffsetY=100,this.titleCantainer.addChild(this._title),this._title.addEventListener(egret.Event.COMPLETE,this.onTitleComplete,this)),this._title.source=o.img):o.eff&&(this.playTitleEff(o.eff),this.onTitleComplete()):t.isMy&&t==heroControl.getSubRoleByIndex(0)&&this.showNewPlayerTitle()}},e.prototype.removeHeadTitle=function(){this._headTitle&&(this._headTitle.source=""),this._headTitleMc&&(this._headTitleMc.destroy(),this._headTitleMc=null)},e.prototype.onTitleComplete=function(){var t=20,e=9,i=0;if(this._headTitle&&this._headTitle.source&&(i=this._headTitle.height,t+=i,this._headTitle.anchorOffsetX=this._headTitle.width>>1,this._headTitle.anchorOffsetY=t+e),this._title&&this._title.source){var o=i?.9*this._title.height:this._title.height;t+=o,this._title.anchorOffsetX=this._title.width>>1,this._title.anchorOffsetY=t}else if(this._titleMc){var o=i?53:60;this._titleMc.anchorOffsetY=t+o}},e.prototype.showNewPlayerTitle=function(){var t=DataCenter.ins().RoleTitleConfig[1];t&&0!=t.openFun&&-1!=t.openpf.indexOf(GlobalModel.pf)&&(vipControl.lv>=t.vip||ActorControl.level>=t.level&&reincarnateControl.lv>=t.zsLevel||this.playTitleEff(t.title))},e.prototype.playTitleEff=function(t){null==this._titleMc&&(this._titleMc=ObjectPool.pop("GameMovieClip"),this._titleMc.anchorOffsetX=0,this._titleMc.anchorOffsetY=80,this.titleCantainer.addChild(this._titleMc));var e=PATH_EFF+t;this.playFile(this._titleMc,e)},e.prototype.updateRingMC=function(){for(var t in this.ringMc)this.ringMc[t]&&(null==this.ringMc[t].parent&&this.addChild(this.ringMc[t]),this.ringMc[t].setEffectXY(this.dir))},e.prototype.setCharName=function(e){t.prototype.setCharName.call(this,e),this._lilianTitle.x=(this._nameGroup.width>>1)+(this._nameTxt.width>>1)-6,this._nameGroup.visible=!0},e.prototype.setLilian=function(t){this._lilianTitle.source=t},Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){t?this._infoModel=t:debug.log("Model is null!!!")},enumerable:!0,configurable:!0}),e.prototype.autoAddBlood=function(){if(this.action==UnitAction.DIE)return void egret.clearTimeout(this.timeID);if(this.getRealHp()<this.infoModel.getAtt(2)){var t=-this.infoModel.getAtt(18);this.hram(t);var e=this.infoModel.getAtt(0)-t,i=this.infoModel.getAtt(2);this.infoModel.setAtt(0,e>i?i:e),gameControl.dispatchEntityHpChange(this,null,1,t)}TimerMgr.ins().doTimer(1e3,1,this.autoAddBlood,this)},e.prototype.showNeigong=function(t){this.neigongBar.visible=t&&this.checkNeigongVisible()},e.prototype.showZhanling=function(t,e,i){if(!ashtarteControl.ZhanLingOpen())return!1;var o=DataCenter.ins().AshtarteLevelConfig[0][e];if(!o.talentLevel)return!1;if(!i)if(this.isMy){if(ServerStorage.ins().getBitBool(ClientSetBit.hide_mine_zhanling))return!1}else if(ServerStorage.ins().getBitBool(ClientSetBit.hide_other_zhanling))return!1;if(o=DataCenter.ins().AshtarteLevelConfig[t][e],Assert(o,"ZhanLingLevel is null : id("+t+"),lv("+e+")"))return!1;var n=o.appearance;return this.addMc(8,PATH_GUAIWU+n),this.updateZhanLingOffset(),TimerMgr.ins().remove(this.playZhanLingAttack,this),TimerMgr.ins().doTimer(200,1,this.playZhanLingAttack,this),TimerMgr.ins().remove(this.hideAshtarte,this),TimerMgr.ins().doTimer(3e3,1,this.hideAshtarte,this),!0},e.prototype.updateZhanLingOffset=function(){var t=this.getMc(8),e=DataCenter.ins().AshtarteConfig.anchorOffset;if(e){var i=0==this.dir||4==this.dir?0:1,o=e[i]||[];t.anchorOffsetX=o[0]||0,t.anchorOffsetY=o[1]||0}},e.prototype.playZhanLingAttack=function(){var t=this,e=8,i=this.getMc(e);if(i){i.scaleX=this._dir>4?-1:1;var o=this.getFileName(e)+"_"+this.getResDir(e)+UnitAction.ATTACK;this.zhanLingAttack=!0,i.playFile(o,1,function(){t.zhanLingAttack=!1;var o=t.getFileName(e)+"_"+t.getResDir(e)+UnitAction.STAND;i.playFile(o,-1,null,!1)},!1)}},e.prototype.hideAshtarte=function(){var t=this,e=this.getMc(8);e&&egret.Tween.get(e).to({alpha:0},DataCenter.ins().AshtarteConfig.disappearTime||1500).call(function(){t.removeMc(8)})},e.prototype.reset=function(){t.prototype.reset.call(this),this.zhanLingAttack=!1,this.AI_STATE=0},e.prototype.destruct=function(){t.prototype.destruct.call(this),this.AI_STATE=0,this._hpBar.visible=this._nameGroup.visible=!0,this._nameTxt.textColor=LangMgr.getColor("color39");for(var e in this.ringMc)this.ringMc[e]&&(this.ringMc[e].reset(),this.ringMc[e]=null,delete this.ringMc[e])},e.prototype.deadDelay=function(){this._hpBar.slideDuration=0,this._hpBar.value=0,this.neigongBar.slideDuration=0,this.neigongBar.value=this.neigongBar.maximum,this.stopMove(),this.removeHardStraight(),this.removeAllBuff(),this.hideAshtarte(),this.neigongBar.visible=!1,this._title&&(this._title.source=""),this._headTitle&&(this._headTitle.source=""),this._hpBar.visible=this._nameGroup.visible=!1,this.atking=!1,TimerMgr.ins().removeAll(this);var t=this.getMc(3);t&&(t.visible=!1),this.infoModel&&titleControl.refNewTitle(this.infoModel.masterHandle),this.infoModel&&this.infoModel.isMy&&gameControl.dispatchMoveCamera()},Object.defineProperty(e.prototype,"nameVisible",{get:function(){return this._nameGroup.visible},enumerable:!0,configurable:!0}),e.prototype.showNameAndHp=function(){this._hpBar.visible=this._nameGroup.visible=!0},e.prototype.showBodyContainer=function(){this.isShowBody||(t.prototype.showBodyContainer.call(this),this.neigongBar.alpha=1)},e.prototype.hideBodyContainer=function(){this.isShowBody&&(t.prototype.hideBodyContainer.call(this),this.neigongBar.alpha=0)},e.prototype.moveCamera=function(){this.checkIsCamera()&&(gameControl.dispatchMoveCamera(),this.checkMove())},e.prototype.checkMove=function(){if(toseongControl.isToseong){var t="sefety",e={x:MapControl.point2Grip(this.x),y:MapControl.point2Grip(this.y)};!this[t]&&MapControl.checkSafety(e)?(tipsControl.showCenterTips(LangMgr.getValueByKey("charRoleEnterSafety")),this[t]=!0):this[t]&&!MapControl.checkSafety(e)&&(tipsControl.showCenterTips(LangMgr.getValueByKey("charRoleOutSafety")),this[t]=!1)}},e.prototype.isSafety=function(){var t={x:MapControl.point2Grip(this.x),y:MapControl.point2Grip(this.y)};return MapControl.checkSafety(t)},e.prototype.onDead=function(t){this.stopMove(),this.removeTitle(),this.playAction(UnitAction.DIE),t&&TimerMgr.ins().once(300,t,this)},e.prototype.stopMove=function(){t.prototype.stopMove.call(this),this.checkIsCamera()&&(SoundUtils.ins().stopRun(),gameControl.dispatchAdjustMapPos())},e.prototype.checkIsCamera=function(){return lookControl.checkIsCamera(this)},e.prototype.hideBar=function(){this.neigongBar.visible=!1,this._hpBar.visible=!1},e.prototype.updateShadow=function(){this.isMy&&UnitHideMgr.ins().shadowMcOpen?(this.setShadowType(1),this.loadShadow()):this.setShadowType(0)},__decorate([callLater],e.prototype,"moveCamera",null),e}(UnitMonster);__reflect(UnitRole.prototype,"UnitRole");var UnitShadow=function(t){function e(){var e=t.call(this)||this;return e.lastType=-1,e}return __extends(e,t),e.prototype.setType=function(t){this.lastType!=t&&(this.reset(),this.lastType=t,0==t?(this.shadowImg=new eui.Image(PATH_RES+"shadow.png"),this.addChild(this.shadowImg),this.shadowImg.anchorOffsetX=28,this.shadowImg.anchorOffsetY=18):(this.shadowMc=ObjectPool.pop("GameMovieClip"),this.addChild(this.shadowMc),this.shadowMc.filters=FilterUtils.shadowFilter,this.shadowMc.matrix=new egret.Matrix(1,0,Math.tan(-20/180*Math.PI),.5,0,0)))},e.prototype.playFile=function(t,e,i){void 0===e&&(e=1),void 0===i&&(i=1),1==this.lastType&&t&&(this.shadowMc.playFile(t,e,null,!1),this.shadowMc.scaleX=i)},e.prototype.reset=function(){this.lastType>=0&&(this.shadowImg&&(DisplayUtils.removeFromParent(this.shadowImg),this.shadowImg=null),this.shadowMc&&(this.shadowMc.matrix=new egret.Matrix,this.shadowMc.destroy(),this.shadowMc=null),this.lastType=-1)},e.prototype.dispose=function(){this.reset(),DisplayUtils.removeFromParent(this)},e}(egret.DisplayObjectContainer);__reflect(UnitShadow.prototype,"UnitShadow");var UnitStatue=function(t){function e(e,i,o){var n=t.call(this)||this;return n.title=new GameMovieClip,n.title.playFile(PATH_EFF+e,-1),n.addChild(n.title),n.roleName=new eui.Label,n.roleName.size=14,n.roleName.strokeColor=0,n.roleName.stroke=1,n.roleName.lineSpacing=2,n.roleName.textAlign=egret.HorizontalAlign.CENTER,n.roleName.textFlow=TextUtils.generateTextFlow1(""+i),n.roleName.x=-n.roleName.width>>1,n.addChild(n.roleName),n.model=new eui.Image,n.model.source=o+"_png",n.addChild(n.model),n.model.once(egret.Event.COMPLETE,function(){n.model.x=-n.model.width>>1,n.model.y=-n.model.height,n.roleName.y=n.model.y-20,n.title.y=n.roleName.y-50},n),n}return __extends(e,t),Object.defineProperty(e.prototype,"weight",{get:function(){return this.y},enumerable:!0,configurable:!0}),e}(egret.DisplayObjectContainer);__reflect(UnitStatue.prototype,"UnitStatue");var UnitTransfer=function(t){function e(){var e=t.call(this)||this;return e.hasDir=[],e.touchEnabled=!0,e.transferName=new UnitTransferHead,e.transferName.anchorOffsetX=40,e.transferName.anchorOffsetY=21,e.titleCantainer.addChild(e.transferName),e.titleCantainer.anchorOffsetY=80,e}return __extends(e,t),Object.defineProperty(e.prototype,"infoModel",{get:function(){return this._infoModel},set:function(t){this._infoModel=t},enumerable:!0,configurable:!0}),e.prototype.updateModel=function(){this.x=this.infoModel.x,this.y=this.infoModel.y,this.transferName.updateModel(this.infoModel),this.addMc(1,this.infoModel.avatarFileName)},e}(UnitEffect);__reflect(UnitTransfer.prototype,"UnitTransfer");var UnitTransferHead=function(t){function e(){var e=t.call(this)||this;return e.skinName="UnitTransferHeadSkin",e}return __extends(e,t),e.prototype.updateModel=function(t){t.index?(this.visible=!0,this.num.text=t.index+""):this.visible=!1},e}(eui.Component);__reflect(UnitTransferHead.prototype,"UnitTransferHead");var UnitHideMgr=function(t){function e(){var e=t.call(this)||this;return e.isOpen=!1,e.isShow=!1,e.showHandles=[],e.showNum=3,e.storageKey="hide_fbtype_",e.lastAtkHandle=0,e.lastFbID=0,e.stageMsHandle={},e.stageRoleNum=0,e.maxStageRoleNum=10,e.ignoreMaxNum=3,e.shadowMcOpen=!1,e.addCustomEvent(356,e.onRemoveEntity),e.addCustomEvent(364,e.onChangeTarget),e.addCustomEvent(305,e.onRoleDie),e.addCustomEvent(103,e.onRoleDie),e.addCustomEvent(333,e.onRoleDie),e.addCustomEvent(327,e.onRoleDie),e.addCustomEvent(5,e.onLvChange),e.shadowMcOpen=DeviceUtils.isWebgl,e.enIns=UnitMgr.ins(),e
}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.changeScene=function(){this.lastFbID!=MapControl.copyId&&(this.lastFbID=MapControl.copyId,this.isOpen=this.getIsOpen(),this.showHandles.length=0,this.lastAtkHandle=0,this.stageMsHandle={},this.stageRoleNum=0,this.isOpen?(this.isShow=!ClientStorage.ins().getBool(this.storageKey+MapControl.copyType),this.maxStageRoleNum=this.getMaxStageNum(),UIMgr.ins().open("ShieldView")):UIMgr.ins().close("ShieldView"))},e.prototype.onCreateEntity=function(t){this.isOpen&&(t.isMy||1!=t.type&&4!=t.type||this.updateShowHandles(t.masterHandle,!0))&&(this.sendHandlesToServer(),this.checkCanToStage(t)&&this.addToStageList(t))},e.prototype.setShowState=function(t,e){this.isShow=t&&this.stageRoleNum<=this.ignoreMaxNum,this.showOrHideEntitys(this.isShow),this.sendHandlesToServer(),e||ClientStorage.ins().setBool(this.storageKey+MapControl.copyType,!t)},e.prototype.checkIsShowBody=function(t){if(!this.isOpen)return!0;if(!this.isShow)return!1;var e=this.enIns.getRootMasterHandle(t);return e?this.showHandles.indexOf(e)>=0:!0},e.prototype.onRemoveEntity=function(t){var e=(t[0],t[1]);if(this.isOpen){var i=e.infoModel;!e.isMy&&e instanceof UnitRole&&i.masterHandle&&this.updateShowHandles(i.masterHandle,!1)&&(this.sendHandlesToServer(),this.searchNewHandle()),this.removeFromStageList(i)&&this.searchRoleAddToStage()}},e.prototype.updateShowHandles=function(t,e){if(e&&this.showHandles.length>=this.showNum)return!1;var i=this.showHandles.indexOf(t);if(e){if(-1==i)return this.showHandles.push(t),!0}else if(i>=0)return this.showHandles.splice(i,1),!0;return!1},e.prototype.onChangeTarget=function(){if(this.isOpen&&gameControl.currAttackHandle!=this.lastAtkHandle){var t=gameControl.currAttackHandle,e=this.lastAtkHandle;if(this.lastAtkHandle=t,this.isShow||(e&&this.hideEntity(e),t&&this.showEntity(t),this.sendHandlesToServer()),t&&!(this.showHandles.indexOf(t)>=0)){if(this.showHandles.length>=this.showNum){var i=this.showHandles.shift();this.hideEntity(i)}this.showHandles.push(t),this.showEntity(t),this.checkIsInStageList(t)||(this.addRoleToStage(t),this.searchRoleRomoveFromStage()),this.sendHandlesToServer()}}},e.prototype.onRoleDie=function(){if(this.isOpen){var t=this.lastAtkHandle;this.lastAtkHandle=0,this.isShow||t&&(this.hideEntity(t),this.sendHandlesToServer())}},e.prototype.searchNewHandle=function(){var t=this.enIns.getAllEntity();for(var e in t){var i=t[e].infoModel;if(i&&!i.isMy&&1==i.type&&this.checkCanToStage(i)&&this.updateShowHandles(i.masterHandle,!0)){this.showEntity(i.masterHandle);break}}},e.prototype.showOrHideEntitys=function(t){for(var e=this.showHandles,i=0,o=e;i<o.length;i++){var n=o[i];t?this.showEntity(n):this.hideEntity(n)}},e.prototype.showEntity=function(t){for(var e=this.enIns.getEntityRelationHandle(t),i=0,o=e;i<o.length;i++){var n=o[i];n.showBodyContainer(),n.updateModel()}},e.prototype.hideEntity=function(t){for(var e=this.enIns.getEntityRelationHandle(t),i=0,o=e;i<o.length;i++){var n=o[i];n.hideBodyContainer()}},e.prototype.sendHandlesToServer=function(){var t=this.isShow?this.showHandles:this.lastAtkHandle?[this.lastAtkHandle]:[];gameControl.upGetOtherAttr(t)},e.prototype.getIsOpen=function(){return!!DataCenter.ins().ScenesConfig[MapControl.mapID].hideBodyEff},e.prototype.getMaxStageNum=function(){return DataCenter.ins().ScenesConfig[MapControl.mapID].maxShowNum||10},e.prototype.onLvChange=function(t){if(this.shadowMcOpen&&t>1){this.shadowMcOpen=!1;for(var e=this.enIns.getEntityByIsMy(!0),i=0;i<e.length;i++){var o=e[i];o instanceof UnitRole&&o.updateShadow()}}},e.prototype.showOrHideAllEntitys=function(t){var e=this.enIns.getAllEntity();for(var i in e){var o=e[i];o&&o.infoModel&&(t?(o.showBodyContainer(),o.showTitleCantainer(),o.showShadowCantainer()):(o.hideBodyContainer(),o.hideTitleCantainer(),o.hideShadowCantainer()))}},e.prototype.checkIsInStageList=function(t){return!!this.stageMsHandle[t]},e.prototype.checkCanToStage=function(t){if(this.stageRoleNum<this.maxStageRoleNum)return!0;var e=this.enIns.getRootMasterHandle(t.masterHandle);return this.checkIsInStageList(e)},e.prototype.addRoleToStage=function(t){for(var e=this.enIns.getEntityRelationHandle(t),i=0;i<e.length;i++){var o=e[i];o instanceof UnitRole&&this.addToStageList(o.infoModel),gameControl.addEntity(o)}},e.prototype.removeRoleFromStage=function(t){for(var e=this.enIns.getEntityRelationHandle(t),i=0;i<e.length;i++){var o=e[i];o instanceof UnitRole&&this.removeFromStageList(o.infoModel),DisplayUtils.removeFromParent(o)}},e.prototype.addToStageList=function(t){if(!t||!t.masterHandle)return!1;var e=this.enIns.getRootMasterHandle(t.masterHandle),i=this.stageMsHandle[e];return i?(i.indexOf(t.handle)<0&&i.push(t.handle),!1):(this.stageMsHandle[e]=[t.handle],this.stageRoleNum+=1,this.setShowState(!ClientStorage.ins().getBool(this.storageKey+MapControl.copyType),!0),!0)},e.prototype.removeFromStageList=function(t){if(!t||!t.masterHandle)return!1;var e=this.enIns.getRootMasterHandle(t.masterHandle),i=this.stageMsHandle[e];if(i){var o=i.indexOf(t.handle);if(o>=0&&i.splice(o,1),0==i.length)return delete this.stageMsHandle[e],this.stageRoleNum-=1,this.setShowState(!ClientStorage.ins().getBool(this.storageKey+MapControl.copyType),!0),!0}return!1},e.prototype.searchRoleAddToStage=function(){var t=this.enIns.getAllEntity();for(var e in t){var i=t[e];if(!i.parent&&i instanceof UnitMonster){var o=i.infoModel;if(o&&o.masterHandle){var n=this.enIns.getRootMasterHandle(o.masterHandle);this.checkCanToStage(o)&&this.addRoleToStage(n)}}}},e.prototype.searchRoleRomoveFromStage=function(){if(!(this.stageRoleNum<=this.maxStageRoleNum))for(var t in this.stageMsHandle){var e=+t;if(this.showHandles.indexOf(e)<0){this.removeRoleFromStage(e);break}}},e.prototype.showAllEntity=function(t){for(var e=this.enIns.getEntityRelationHandle(t),i=0;i<e.length;i++){var o=e[i];o.showBodyContainer(),o.showTitleCantainer()}},e.prototype.hideAllEntity=function(t){for(var e=this.enIns.getEntityRelationHandle(t),i=0;i<e.length;i++){var o=e[i];o.hideBodyContainer(),o.hideTitleCantainer()}},__decorate([callDelay(200)],e.prototype,"sendHandlesToServer",null),__decorate([callDelay(200)],e.prototype,"searchRoleAddToStage",null),e}(BaseSystem);__reflect(UnitHideMgr.prototype,"UnitHideMgr");var UnitMgr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.actorList={},e.masterList={},e.entityList={},e.transferList={},e.mineList={},e.distances=[],e.listCount=[],e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.getAllEntity=function(){return this.entityList},e.prototype.resetRole=function(){for(var t=heroControl.subRolesLen,e=0;t>e;e++){var i=heroControl.getSubRoleByIndex(e);if(i.name=ActorControl.myName,this.getEntityByHandle(i.handle)){var o=this.getEntityByHandle(i.handle);o.infoModel.setAtt(0,i.getAtt(2)),o.infoModel.setAtt(1,i.getAtt(3)),o.updateBlood(!0)}else i.setPos(DropControl.tempDropPoint.x*MapControl.CELL_SIZE,DropControl.tempDropPoint.y*MapControl.CELL_SIZE),i.setAtt(0,i.getAtt(2)),i.setAtt(1,i.getAtt(3)),gameControl.createEntityByModel(i,0)}},e.prototype.addList=function(t){if(t.infoModel.handle||(t.infoModel.handle=t.hashCode),this.entityList[t.infoModel.handle]!=t){if(this.entityList[t.infoModel.handle]=t,t.infoModel.masterHandle){var e=t.infoModel.masterHandle;this.masterList[e]||(this.masterList[e]=[]),this.masterList[e].push(t)}102==t.infoModel.type&&(this.mineList[t.infoModel.index]=t);var i=this.listCount[t.team]||0;this.listCount[t.team]=++i}},e.prototype.addTransfer=function(t){this.transferList[t.infoModel.configID]=t,SkillEffPlayDisplay.bottomLayer.addChild(t)},e.prototype.removeTransferById=function(t){var e=this.transferList[t];e&&(delete this.transferList[t],DisplayUtils.removeFromParent(e))},e.prototype.getTransferById=function(t){return this.transferList[t]},e.prototype.getMineByIndex=function(t){return this.mineList[t]},e.prototype.removeMineByIndex=function(t){var e=this.mineList[t];e&&(delete this.mineList[t],e.infoModel&&this.removeByHandle(e.infoModel.handle))},e.prototype.createEntity=function(t,e){switch(t.type){case 1:case 4:var i=t;e&&null!=e[0]?i.team=e[0]:t.masterHandle&&t.masterHandle==ActorControl.handle?i.team=0:i.team=2;var o=ObjectPool.pop("UnitRole");if(o.reset(),i.masterHandle==ActorControl.handle){var n=heroControl.getSubRoleByIndex(i.configID);n&&(n.mergeOtherAttr(i),i=n.mergeData(i),i.attributeData=n.attributeData,i.attributeExData=n.attributeExData)}o.infoModel=i,o.x=i.x,o.y=i.y,this.addList(o),MapControl.sceneInHook()&&HookControl.ins().add(o);var r=!0;if(0!=i.team){if(!UnitShowMgr.ins().checkShowHandle(i.masterHandle))return o.hideBodyContainer(),o.updateModel(),null;if(!UnitHideMgr.ins().checkCanToStage(i))return o.hideBodyContainer(),o.updateModel(),null;r=UnitHideMgr.ins().checkIsShowBody(i.masterHandle)}return r?o.showBodyContainer():o.hideBodyContainer(),o.updateModel(),titleControl.refNewTitle(o.infoModel.masterHandle),o;case 2:case 5:e&&null!=e[0]?t.team=e[0]:t.masterHandle&&0!=t.masterHandle?t.isMy?t.team=0:t.team=2:t.team=1;var a=ObjectPool.pop("UnitMonster");a.reset(),a.infoModel=t,a.x=t.x,a.y=t.y,this.addList(a),MapControl.sceneInHook()&&HookControl.ins().add(a);var r=!0;if(0!=a.team&&t.masterHandle){var s=this.getRootMasterHandle(t.masterHandle),l=this.getMasterList(s);if(l)for(var h=0,u=l;h<u.length;h++){var c=u[h];if(a!=c&&!c.parent)return a.hideBodyContainer(),a.updateModel(),null}2==t.team&&(r=UnitHideMgr.ins().checkIsShowBody(t.masterHandle))}return r?a.showBodyContainer():a.hideBodyContainer(),a.updateModel(),a;case 6:var p=ObjectPool.pop("UnitItemNameMerge");return p.setData(t.itemData),p.x=t.x,p.y=t.y,p.infoModel=t,this.addList(p),p.addRoatEffect(),p.addFloatEffect(),p.addEffect(),p;case 101:var d=ObjectPool.pop("UnitTransfer");return d.infoModel=t,this.addTransfer(d),d.updateModel(),d;case 100:var g=ObjectPool.pop("UnitNpc");return g.infoModel=t,this.addList(g),g.updateModel(),g;case 102:var f=ObjectPool.pop("UnitMiner");return f.infoModel=t,this.addList(f),f.updateModel(),f}return null},e.prototype.removeAll=function(){for(var t in this.entityList)this.removeByHandle(t);for(var t in this.transferList)this.removeTransferById(t);confrontFightControl.stop(),this.entityList={},this.masterList={},this.transferList={},this.actorList={},this.listCount=[]},e.prototype.hideOtherEntity=function(t){this.isHideOther=t;for(var e in this.entityList)2==this.entityList[e].team&&(t?DisplayUtils.removeFromParent(this.entityList[e]):gameControl.addEntity(this.entityList[e]))},e.prototype.getEntityRelationHandle=function(t){for(var e=this.getRootMasterHandle(t),i=this.getMasterList(e),o=[].concat(i||[]),n=0,r=o;n<r.length;n++){var a=r[n],s=a.infoModel;if(s&&3==s.job){var l=this.getMasterList(s.handle);l&&(o=o.concat(l));break}}return o},e.prototype.removeByHandle=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1);var o=this.entityList[t];if(o){var n=o.infoModel.masterHandle;if(n){for(var r=this.masterList[n],a=0;r&&a<r.length;a++)if(r[a]==o){r.splice(a,1);break}r&&0==r.length&&delete this.masterList[n]}delete this.entityList[t];for(var a in this.entityList)this.entityList[a].infoModel.masterHandle&&this.entityList[a].infoModel.masterHandle==t&&this.removeByHandle(this.entityList[a].infoModel.handle);var s=this.listCount[o.team]||0;return this.listCount[o.team]=--s,o instanceof UnitMonster&&(o.stopMove(),o.removeAllFilters()),egret.Tween.removeTweens(o),e&&(DisplayUtils.removeFromParent(o),o instanceof UnitMonster&&!(o instanceof UnitRole)&&o.destroy()),HookControl.ins().remove(o),DropControl.tempDropPoint.x=Math.floor(o.x/MapControl.CELL_SIZE),DropControl.tempDropPoint.y=Math.floor(o.y/MapControl.CELL_SIZE),(MapControl.sceneInHook()||16==MapControl.copyType)&&2==o.infoModel.type&&i&&gameControl.dispatchExpMc(o),102==o.infoModel.type&&(delete this.mineList[o.infoModel.index],o.destruct()),o}},e.prototype.getEntityByHandle=function(t){return this.entityList[t]},e.prototype.getMasterList=function(t){return this.masterList[t]},e.prototype.getRootMasterHandle=function(t){var e=this.getEntityByHandle(t);return e&&e.infoModel&&e.infoModel.masterHandle>0&&e.infoModel.masterHandle!=t?this.getRootMasterHandle(e.infoModel.masterHandle):t},e.prototype.getMainRole=function(t){return this.getEntityByHandle(heroControl.getSubRoleByIndex(t).handle)},e.prototype.getJobMainRole=function(t){var e,i=0;for(var o in heroControl.jobDic){if(i==t){e=heroControl.jobDic[o];break}i++}return this.getEntityByHandle(e.handle)},e.prototype.getMainRoleByJob=function(t){for(var e in heroControl.jobDic)if(+e==t)return this.getEntityByHandle(heroControl.jobDic[e].handle);return null},e.prototype.getNoDieRoleIndex=function(){for(var t,e=heroControl.subRolesLen,i=0;e>i;i++)if(t=this.getJobMainRole(i),t&&t.getHP()>0&&t.visible)return i;return-1},e.prototype.getNoDieRole=function(){for(var t,e=heroControl.subRolesLen,i=0;e>i;i++)if(t=this.getJobMainRole(i),t&&t.getHP()>0&&t.visible)return t;return null},e.prototype.getMyOtherRolePos=function(){var t=this.getNoDieRole(),e=this.getEntityByTeam(0),i=0,o={};for(var n in e){var r=e[n];if(r!=t){var a=e.length,s=[1,-1];2==a&&(s=[0]);var l=DirUtils.getGridByDir(t.dir+(s[i]||0),MapControl.CELL_SIZE);i+=1,o[r.infoModel.handle]={x:t.x+l.x,y:t.y+l.y}}}return o[t.infoModel.handle]={x:t.x,y:t.y},o},e.prototype.sortSubRole=function(t,e){return SortUtils.sortAscByKey(t.infoModel.job,e.infoModel.job)},e.prototype.getTeamCount=function(t){return confrontControl.isEncounter()?HookControl.ins().getTeamCount(t,[this.isRole]):this.listCount[t]||0},e.prototype.checkCount=function(t,e,i,o){void 0===i&&(i=1),void 0===o&&(o=!1);var n=0;for(var r in this.entityList){var a=this.entityList[r];if((!o&&a.team!=t.team||o&&a.team==t.team)&&MathUtils.getDistanceX2ByObject(t,a)<=Math.pow(e*MapControl.CELL_SIZE,2)&&(n++,n>=i))break}return n>=i},e.prototype.checkCanAddBlood=function(t){var e=!1;for(var i in this.entityList)this.entityList[i].team==t&&this.entityList[i].isCanAddBlood&&(e=!0);return e},e.prototype.getNoDieEntityBymasterhHandle=function(t){for(var e in this.entityList)if(this.entityList[e].infoModel&&this.entityList[e].infoModel.masterHandle&&this.entityList[e].infoModel.masterHandle==t&&2!=this.entityList[e].infoModel.type)return this.entityList[e];return null},e.prototype.getEntityBymasterhHandle=function(t){for(var e in this.entityList){var i=this.entityList[e].infoModel;if(i&&i.masterHandle==t&&2!=i.type)return this.entityList[e]}return null},e.prototype.getEntitysBymasterhHandle=function(t,e){void 0===e&&(e=-1);var i=[];for(var o in this.entityList){if(i.length>=3)return i;this.entityList[o].infoModel&&this.entityList[o].infoModel.masterHandle&&this.entityList[o].infoModel.masterHandle==t&&(-1==e||e==this.entityList[o].infoModel.type)&&i.push(this.entityList[o])}return i},e.prototype.getEntityByTeam=function(t){void 0===t&&(t=0);var e=[];for(var i in this.entityList)this.entityList[i].infoModel&&this.entityList[i].infoModel.team==t&&e.push(this.entityList[i]);return e},e.prototype.getEntityByMonsterId=function(t){var e=[];for(var i in this.entityList)this.entityList[i].infoModel&&this.entityList[i].infoModel.configID==t&&e.push(this.entityList[i]);return e},e.prototype.getEntityByIsMy=function(t){var e=[];for(var i in this.entityList)this.entityList[i].infoModel instanceof RoleModel&&this.entityList[i].infoModel.isMy==t&&e.push(this.entityList[i]);return e},e.prototype.updateRoleWingState=function(t){for(var e=this.getEntityByIsMy(t),i=0;i<e.length;i++){var o=e[i];o.setWing()}},e.prototype.updateRoleTitleState=function(t){for(var e=this.getEntityByIsMy(t),i=0;i<e.length;i++){var o=e[i];o.updateTitle()}},e.prototype.updateName=function(t){for(var e=this.getEntityByIsMy(t),i=0;i<e.length;i++){var o=e[i];o.setCharName(o.infoModel.guildAndName),o.updateNameColor()}},e.prototype.screeningTargetByMap=function(t,e,i,o){var n;if(Assert(n,"SkillCastRangeConf no such areaId:"+o))return this.screeningTargetByPos(t,!1,i,Number.MAX_VALUE);var r,a=MapControl.getTargetIndex(t,e,n.width,n.height);if(n.range[a],!r)return this.screeningTargetByPos(t,!1,i,Number.MAX_VALUE);for(var s=[],l=0;l<r.range.length;l++){var h=MapControl.getPoint(r.range[l],r.width,r.height);s.push(h)}s.push(new egret.Point(0,0));var u=MapControl.getIncludeElement(t,s,this.entityList);return this.screeningTargetByPos(t,!1,i,Number.MAX_VALUE,u)},e.prototype.screeningTargetByPos=function(t,e,i,o,n){void 0===e&&(e=!1),void 0===i&&(i=0),void 0===o&&(o=Number.MAX_VALUE),void 0===n&&(n=this.entityList);var r=MathUtils.getDistanceX2ByObject,a=o;o!=Number.MAX_VALUE&&(a=o*MapControl.CELL_SIZE*(o*MapControl.CELL_SIZE)),this.distances.length=0;var s;for(var l in n){var h=n[l];if((!e||h.team==t.team)&&(e||h.team!=t.team)&&(0!=t.team||5!=h.team)&&(5!=t.team||1==h.team||5==h.team)&&(h instanceof UnitRole||1==h.team||3==h.team)&&3!=h.AI_STATE){if(confrontControl.isEncounter())if(0==t.team){if(2!=h.team||e){if(0!=h.team||!e)continue}else if(!confrontControl.checkIsEncounter(confrontFightControl.encounterIndex,h.infoModel))continue}else if(2==t.team)if(e&&2==h.team);else if(e||confrontFightControl.willEntityFightTeam!=h.team)continue;s=r(t,h),s>a||this.distances.push({priority:s,target:h})}}this.distances.sort(this.sortFunc);var u=[],c=0;c=i?Math.min(this.distances.length,i):this.distances.length;for(var p=0;c>p;p++)u[p]=this.distances[p].target;return u},e.prototype.sortFunc=function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0},e.prototype.getActorByAcotorID=function(t){if(!this.actorList)return null;for(var e in this.actorList){var i=this.actorList[e];if(i.configID==t)return i}return null},e.prototype.getNpcByConfigID=function(t){if(!this.entityList)return null;for(var e in this.entityList){var i=this.entityList[e];if(i&&i.infoModel&&100==i.infoModel.type&&i.infoModel.configID==t)return i}return null},e.prototype.isRole=function(t){return t&&t.infoModel?1==t.infoModel.type||0==t.infoModel.type||4==t.infoModel.type:!1},e.prototype.isMonster=function(t){return t&&t.infoModel?2==t.infoModel.type||5==t.infoModel.type:!1},e.prototype.isMiner=function(t){return t&&t.infoModel?102==t.infoModel.type:!1},e.prototype.isNpc=function(t){return t&&t.infoModel?100==t.infoModel.type:!1},e.prototype.createNpc=function(t){var e=new NpcModel;return e.configID=t.id,e.x=t.x*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1)+(t.offX?t.offX:0),e.y=t.y*MapControl.CELL_SIZE+(MapControl.CELL_SIZE>>1)+(t.offY?t.offY:0),e.dir=t.d,gameControl.createEntityByModel(e)},e.prototype.getMasterSpeed=function(t){if(t.masterHandle){var e=this.getRootMasterHandle(t.masterHandle);if(e){var i=this.getMasterList(e);if(i&&i.length){for(var o=i.length,n=[],r=0;o>r;r++){var a=i[r];a&&a instanceof UnitRole&&a.getHP()>0&&a.visible&&(n[a.infoModel.job]=a.infoModel.getAtt(9))}o=n.length;for(var r=1;o>r;r++){var s=n[r];if(void 0!=s){if(1==t.type)return s;if(t.masterHandle==e)return s;var l=this.getEntityByHandle(t.masterHandle);if(l)return Math.min(s,l.infoModel.getAtt(9));break}}}}}return t.getAtt(9)},e.CHAR_DEFAULT_HEIGHT=118,e.CHAR_DEFAULT_TYPEFACE=110,e}(SingleClass);__reflect(UnitMgr.prototype,"UnitMgr");var UnitShowMgr=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MAX_SHOW_NUM=3,e.MAX_EFFECT_NUM=3,e.isOpen=!1,e}return __extends(e,t),e.ins=function(){return t.ins.call(this)},e.prototype.changeScene=function(){this.isOpen=!UnitHideMgr.ins().isOpen&&40!=MapControl.copyType&&!MapControl.sceneInHook(),19==MapControl.copyType?this.MAX_SHOW_NUM=5:this.MAX_SHOW_NUM=3,GameServer._hefuCount<1?this.MAX_SHOW_NUM=10:this.MAX_SHOW_NUM=5,GameServer.kfServerIDSmall&&(this.MAX_SHOW_NUM=3)},e.prototype.hideFurtherOtherRole=function(){if(!(this.countShowNum()<this.MAX_SHOW_NUM)){var t=UnitMgr.ins().getNoDieRole();if(t){var e,i=0,o=StageUtils.ins().getHeight()>>1,n=o*o,r=UnitMgr.ins().getAllEntity();for(var a in r){var s=r[a];if(s.parent&&s.infoModel&&0!=s.team&&1==s.infoModel.type){var l=MathUtils.getDistanceX2ByObject(t,s);if(l>n){e=s.infoModel.handle;break}l>i&&(i=l,e=s.infoModel.handle)}}this.hideByHandle(e)}}},e.prototype.showNearSomeOne=function(){if(this.isOpen&&!(this.countShowNum()>=this.MAX_SHOW_NUM)){var t=UnitMgr.ins().getNoDieRole();if(t){var e,i=Number.MAX_VALUE,o=StageUtils.ins().getWidth()>>1,n=o*o,r=UnitMgr.ins().getAllEntity();for(var a in r){var s=r[a];if(!s.parent&&s.infoModel&&0!=s.team&&1==s.infoModel.type){var l=MathUtils.getDistanceX2ByObject(t,s);if(n>l){e=s.infoModel.handle;break}i>l&&(i=l,e=s.infoModel.handle)}}this.showByHandle(e)}}},e.prototype.showHideSomeOne=function(t){if(this.isOpen&&t){var e=UnitMgr.ins().getEntityRelationHandle(t);e&&0!=e.length&&(this.hideFurtherOtherRole(),this.showByHandle(t))}},e.prototype.hideByHandle=function(t){if(!(gameControl.currAttackHandle==t||this.countShowNum()<this.MAX_SHOW_NUM))for(var e=UnitMgr.ins().getEntityRelationHandle(t),i=0,o=e;i<o.length;i++){var n=o[i];DisplayUtils.removeFromParent(n),n.hideBodyContainer()}},e.prototype.showByHandle=function(t){if(this.isOpen&&!(this.countShowNum()>=this.MAX_SHOW_NUM))for(var e=UnitMgr.ins().getEntityRelationHandle(t),i=0,o=e;i<o.length;i++){var n=o[i];gameControl.addEntity(n),n.showBodyContainer()}},e.prototype.checkShowSkillEffect=function(){return this.isOpen?this.countShowNum()<this.MAX_EFFECT_NUM?!0:!1:!0},e.prototype.checkShowHandle=function(t){if(!this.isOpen)return!0;var e=UnitMgr.ins(),i=e.getRootMasterHandle(t);return i&&this.countShowNum()>=this.MAX_SHOW_NUM?e.masterList[i]&&e.masterList[i].length&&e.masterList[i][0].parent?!0:!1:!0},e.prototype.countShowNum=function(){var t=0;if(!this.isOpen)return 0;var e=UnitMgr.ins().masterList;for(var i in e){var o=e[i];o&&o.length&&o[0].parent&&0!=o[0].team&&o[0].infoModel&&1==o[0].infoModel.type&&(t+=1)}return t},e}(SingleClass);__reflect(UnitShowMgr.prototype,"UnitShowMgr");var BuffModel=function(){function t(){this.multRate=1,this.isLift=!1}return t.prototype.dispose=function(){this.source=null,this.hostsHandle=null,this.multRate=1,this.isLift=!1},t.createBuff=function(e,i,o){var n=DataCenter.ins().SkillsEffectsConfig[e];Assert(n,LangMgr.getValueByKey("entityEmpty",e));var r=HookControl.ins().skillEffValue(i,n,o),a=o?o.time||0:0;return t.createBaseBuff(e,i,r,n.duration+a)},t.createBaseBuff=function(t,e,i,o){var n=DataCenter.ins().SkillsEffectsConfig[t];Assert(n,LangMgr.getValueByKey("entityEmpty",t));var r=ObjectPool.pop("BuffModel");if(r.effConfig=n,r.value=i,r.addTime=egret.getTimer(),r.endTime=r.addTime+(o?o:n.duration),r.count=(o?o:n.duration)/n.interval>>0,r.step=0,r.source=e,7==n.type){null==r.hostsHandle&&(r.hostsHandle=[]);var a=UnitMgr.ins().getRootMasterHandle(e.infoModel.handle);r.hostsHandle.indexOf(a)<0&&r.hostsHandle.push(a)}return r},t.isMaBi=function(t){var e=this.getBuffCfgByGroupId(t);return e?this.isCanotHit(e)&&1==e.effID:!1},t.hasReMabi=function(t){var e=t.buffList;for(var i in e){var o=e[i];if(o.reCanotHit())return!0}return!1},t.hasMabi=function(t){var e=!1;if(MapControl.sceneInHook())e=!0;else{var i=t.serverEffList;for(var o in i){var n=i[o];if(1==n.type){e=!0;break}}}if(e)for(var o in t.buffList){var r=t.buffList[o];if(r.effConfig&&this.isCanotHit(r.effConfig)&&1==r.effConfig.effID)return!0}return!1},t.hasReFronzen=function(t){var e=t.buffList;for(var i in e){var o=e[i];if(o.reFronzen())return!0}return!1},t.getBuffCfgByGroupId=function(t){for(var e in DataCenter.ins().SkillsEffectsConfig){var i=DataCenter.ins().SkillsEffectsConfig[e];if(i.group==t)return i}return null},t.prototype.isExecute=function(){return egret.getTimer()-this.addTime>this.step*this.effConfig.interval},t.prototype.canRemove=function(){return 5!=this.effConfig.type&&egret.getTimer()>=this.endTime},t.prototype.isCanotHit=function(){return 4==this.effConfig.type&&1==this.effConfig.args.i},t.isCanotHit=function(t){return 4==t.type&&t.args&&1==t.args.i},t.prototype.reCanotHit=function(){return 4==this.effConfig.type&&this.effConfig.args&&8==this.effConfig.args.i},t.prototype.isFronzen=function(){return 4==this.effConfig.type&&this.effConfig.args&&9==this.effConfig.args.i},t.prototype.reFronzen=function(){return 4==this.effConfig.type&&this.effConfig.args&&12==this.effConfig.args.i},t.prototype.isExtHurmK=function(){return 4==this.effConfig.type&&this.effConfig.args&&11==this.effConfig.args.i},t}();__reflect(BuffModel.prototype,"BuffModel");var ItemModel=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.initItemData=function(t){this.itemData=new RewardVo,this.itemData.init(t)},e}(UnitModel);__reflect(ItemModel.prototype,"ItemModel");var MineModel=function(t){function e(){var e=t.call(this)||this;return e.type=102,e}return __extends(e,t),Object.defineProperty(e.prototype,"npcConfig",{get:function(){var t=DataCenter.ins().MineSourceConfig[this.configID];return DataCenter.ins().NpcBaseConfig[t.npcId]},enumerable:!0,configurable:!0}),e.prototype.init=function(t){this.index=t[0],this.actorID=t[1],this.name=t[2],this.power=t[3],this.guildName=t[4],this.configID=t[5],this.startTime=DateUtils.formatMiniDateTime(t[6]),this.endTime=DateUtils.formatMiniDateTime(t[7]),this.isBeFight=t[8],this.beFightActorID=[];for(var e=0;e<t[9].length;e++)this.beFightActorID[e]=t[9][e];this.sceceId=mineControl.index},Object.defineProperty(e.prototype,"isBeMeRob",{get:function(){return this.beFightActorID.indexOf(ActorControl.actorID)>=0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBeMeFight",{get:function(){return mineControl.checkMineIsFight(this.endTime,this.index)},enumerable:!0,configurable:!0}),e.prototype.setBeMeFight=function(){mineControl.setMineIsFight(this)},Object.defineProperty(e.prototype,"isBeRobOver",{get:function(){return this.beFightActorID.length>=DataCenter.ins().MineConfig.maxBeRobCount},enumerable:!0,configurable:!0}),e}(NpcModel);__reflect(MineModel.prototype,"MineModel");var RoleModel=function(t){function e(){var e=t.call(this)||this;return e.thunderForgeVos=[],e.thunderSuitVos=[],e.runeDatas=[],e.wingSkillData=[],e.lilianLv=0,e._mbRing=0,e.hsRing=0,e.deCirShowID=0,e.starSunVos=[],e.thirteenEquipLv=0,e.guanZhiLv=0,e.type=1,e}return __extends(e,t),e.getAttrTypeByName=function(t){return AttributeData.translate[t]},e.getJobNameByJob=function(t){return LangMgr.getValueByKey("job"+(t+1))},e.getHejiEquipNameByType=function(t){return LangMgr.getValueByKey("roleBG"+(t+1))},e.getEquipNameByType=function(t){return LangMgr.getValueByKey("equipPosName"+t)},e.getWingEquipNameByType=function(t){return LangMgr.getValueByKey("roleEquipWing"+(t+1))},e.getIntensifyTotalLvByType=function(t){for(var e=0,i=heroControl.subRolesLen,o=0;i>o;o++)for(var n=heroControl.getSubRoleByIndex(o).equipsData,r=0;r<GameConst.FORGE_MAX;r++)switch(t){case 0:e+=n[r].strengthen;break;case 1:e+=n[r].gem;break;case 2:e+=n[r].zhuling}return e},e.getAllZSLevel=function(){for(var t=0,e=heroControl.subRolesLen,i=0;e>i;i++)for(var o=heroControl.getSubRoleByIndex(i).equipsData,n=0;n<GameConst.FORGE_MAX;n++){var r=o[n].item.configID,a=DataCenter.ins().ItemConfig[r];a&&4==ItemUtils.getQuality(a)&&a.zsLevel&&(t+=a.zsLevel)}return t},e.prototype.init=function(t){var e=0,i=0;this.title=t[e],e++,this.index=t[e],e++,this.job=t[e],e++,this.sex=t[e],e++,this.power=t[e],e++,this.skillsData=[];for(var o=0;o<t[e].length;o++)this.skillsData.push(SkillVo.getSkillByJob(this.job,o+1,t[e][o]));e++,this.equipsData=[];for(var n,o=0;o<t[e].length;o++)n=new EquipVo,n.init(t[e][o]),this.equipsData.push(n);e++,this.exRingsData=[];for(var o=0;o<t[e].length;o++)this.exRingsData.push(t[e][o]);e++,i=e+ByteConst.FeatherVos.length,this.wingsData=new FeatherVo,this.wingsData.init(t.slice(e,i)),e=i,i=e+ByteConst.MeridiansVos.length,this.jingMaiData=new MeridiansVo,this.jingMaiData.init(t.slice(e,i)),e=i,i=e+ByteConst.DragonSoulDataVos.length,this.loongSoulData=new DragonSoulDataVo,this.loongSoulData.init(t.slice(e,i)),e=i,this.initRune(t[e]),e++,this.initHeirloom(t[e]),e++,this.initWeapons(t[e]),e++,this.initNewStrengthen(t[e],t[e+1]),e+=2,this.initMasterEquip(t[e]),e++,this.initAtt(t[e]),e++,this.initExAtt(t[e]),e++,this.deCirShowID=t[e],e++,this.initJadeData(t[e]),e++,i=e+ByteConst.FashionIds.length,this.initZhuangbei(t.slice(e,i)),this.setWingSkill(),e=i,this.initLegendEquipForge(t[e]),e++,this.initEnhance(t[e]),e++,this.thirteenEquipLv=t[e],e++,this.heirloomDressId=t[e],e++,this.guanZhiLv=t[e],e++,this.weaponViewType=t[e],e++,this.weaponViewId=t[e],e++,this.clothesViewType=t[e],e++,this.clothesViewId=t[e]},e.prototype.initRune=function(t){var e=null;this.runeDatas=[];for(var i=0;i<t.length;i++)e=new ItemData,e.init(t[i]),this.runeDatas.push(e)},e.prototype.initHeirloom=function(t){this.heirloom||(this.heirloom=new HeirloomVo),this.heirloom.init(t)},e.prototype.initWeapons=function(t){this.weapons||(this.weapons=new WeaponsSoulDataVo),this.weapons.weaponsId=t},e.prototype.initNewStrengthen=function(t,e){thunderControl.init(this,t),thunderControl.initThunder(this,e)},e.prototype.initMasterEquip=function(t){this.masterEquips||(this.masterEquips=[]);for(var e=0;e<t.length;e++){var i=this.masterEquips[e];i||(i=new ItemData,this.masterEquips[e]=i),i.init(t[e])}},e.prototype.initAtt=function(e,i){void 0===i&&(i=!1),t.prototype.initAtt.call(this,e,i)},e.prototype.initExAtt=function(t){for(var e=0;e<t.length;e++)this.attributeExData[e]=t[e]},e.prototype.initJadeData=function(t){this.jadeData||(this.jadeData=new JadeDataNewVo),this.jadeData.initOther(t)},e.prototype.initZhuangbei=function(t){this.zhuangbei=[];for(var e=0;e<t.length;e++)this.zhuangbei.push(t[e])},e.prototype.setWingSkill=function(){this.wingSkillData=[];for(var t=0;t<this.wingsData.lv+1;t++){var e=DataCenter.ins().FeatherLevelConfig[t];e&&e.pasSkillId&&this.wingSkillData.push(e.pasSkillId)}},e.prototype.initLegendEquipForge=function(t){this.mythForgeVo=this.mythForgeVo||new MythForgeVo,this.mythForgeVo.roleId=this.index,this.mythForgeVo.init(t)},e.prototype.initEnhance=function(t){starSunControl.init(this,t)},e.prototype.intOtherRole=function(t){this.initAtt(t[0]),this.initExAtt(t[1]),this._name=t[2],this._servId=t[3],this.job=t[4],this.sex=t[5],this._lv=t[6],this.equipsData=[],this.equipsData[2]=new EquipVo,this.equipsData[2].item=new ItemData,this.equipsData[2].item.configID=t[7],this.equipsData[0]=new EquipVo,this.equipsData[0].item=new ItemData,this.equipsData[0].item.configID=t[8],this.wingsData=new FeatherVo,this.wingsData.lv=t[9],this.wingsData.openStatus=t[10],this.title=t[11],this.guildID=t[12],this.guildName=t[13],this.initZhuangbei(t.slice(14,17)),this.lilianLv=t[17],this.weaponsId=t[18],this.initHeirloom(t[19]),this.camp=t[20],this.weaponViewType=t[21],this.weaponViewId=t[22],this.clothesViewType=t[23],this.clothesViewId=t[23]},Object.defineProperty(e.prototype,"mbRing",{get:function(){return this._mbRing},set:function(t){this._mbRing=t},enumerable:!0,configurable:!0}),e.prototype.getMinEquipIndexByType=function(t){for(var e=0,i=Number.MAX_VALUE,o=0,n=IntensifyConst.FORGE_EQUIP.length,r=0;n>r;++r){var a=IntensifyConst.FORGE_EQUIP[r];switch(t){case 0:o=this.equipsData[a].strengthen;break;case 1:o=this.equipsData[a].gem;var s=DataCenter.ins().IntensifyOpenConfig[a];if(ActorControl.level<s.openLv)continue;break;case 2:o=this.equipsData[a].zhuling}i>o&&(i=o,e=a)}return e},e.prototype.getEquipForgeTotalLv=function(t){for(var e=0,i=IntensifyConst.FORGE_EQUIP.length;i--;){var o=IntensifyConst.FORGE_EQUIP[i];switch(t){case 0:e+=this.getEquipByIndex(o).strengthen;break;case 1:e+=this.getEquipByIndex(o).gem;break;case 2:e+=this.getEquipByIndex(o).zhuling}}return e},e.prototype.getEquipForgeLv=function(t,e){var i=0;switch(e){case 0:i+=this.getEquipByIndex(t).strengthen;break;case 1:i+=this.getEquipByIndex(t).gem;break;case 2:i+=this.getEquipByIndex(t).zhuling}return i},e.prototype.getAllHeirloomPower=function(){for(var t=0,e=0;8>e;e++)t+=this.getHeirloomSlotPower(e);return t},e.prototype.getHeirloomSlotPower=function(t){var e=this.heirloom.getInfoBySolt(t),i=BackpackControl.getAttrPower(e.attr)||0,o=e.attr_add,n=0,r=this.getEquipByIndex(t);
if(r.item.itemConfig){n+=r.item.point;for(var a=0;3>a;a++){var s=this.getEquipForgeLv(t,a),l=intensifyControl.getForgeConfigByPos(t,s,a);n+=BackpackControl.getAttrPower(l.attr)||0}}var h=i+Math.floor(n*(o/100));return h},e.prototype.getCurSkillIDs=function(){for(var t=[],e=0;e<this.skillsData.length;e++)t.push(this.skillsData[e].lv1ConfigID);return t},e.prototype.mergeData=function(t){return this.masterHandle=t.masterHandle,this.handle=t.handle,this.type=t.type,this.x=t.x,this.y=t.y,this.attributeData=t.attributeData,this.attributeExData=t.attributeExData,this.team=t.team,this.lilianLv=t.lilianLv,this.name=t.name,this.guildID=t.guildID,this.guildName=t.guildName,this.isMy=t.isMy,this.title=t.title,t instanceof e&&(this.warLevel=t.warLevel,this.mbRing=t.mbRing,this.hsRing=t.hsRing),this},e.prototype.mergeOtherAttr=function(t){for(var e=UnitModel.OtherAttrType,i=0;i<e.length;i++){var o=e[i];this.setAtt(o,t.getAtt(o))}},e.prototype.getEquipDataByPos=function(t){return this.equipsData&&this.equipsData[t]?this.equipsData[t]:null},e.prototype.getForgeTotalPower=function(t){for(var e=0,i=IntensifyConst.FORGE_EQUIP.length;i--;){var o=IntensifyConst.FORGE_EQUIP[i],n=void 0;switch(t){case 0:n=this.equipsData[o].strengthen;break;case 2:n=this.equipsData[o].zhuling;break;case 1:n=this.equipsData[o].gem}if(n>0){var r=intensifyControl.getForgeConfigByPos(o,n,t);e+=Math.floor(BackpackControl.getAttrPower(r.attr))}}return e},e.prototype.getWeaponTotalPower=function(t){var e=0,i=[];if(t>0)for(var o=DataCenter.ins().WeaponSoulConfig[t],n=0;n<o.actcond.length;n++){var r=o.actcond[n],a=this.weapons.getSlotByInfo(r);if(a)for(var s=0;s<a.attr.length;s++){var l=new AttributeData;l.type=a.attr[s].type,l.value=a.attr[s].value,i.push(l)}}else{var h=this.weapons.getInfoData();for(var u in h){var c=h[u];for(var p in c){var d=c[p];if(d&&d.level)for(var s=0;s<d.attr.length;s++){var l=new AttributeData,g=d.attr[s];l.type=g.type,l.value=g.value,i.push(l)}}}}var f=this.weapons.flexibleCount?this.weapons.flexibleCount-1:0,m=DataCenter.ins().WeaponSoulItemAttrConfig[f];if(i.length&&m)for(var n=0;n<m.attr.length;n++){for(var v=!1,s=0;s<i.length;s++)if(i[s].type==m.attr[n].type){v=!0,i[s].value+=m.attr[n].value;break}if(!v){var l=new AttributeData,g=m.attr[n];l.type=g.type,l.value=g.value,i.push(l)}}return e+=Math.floor(BackpackControl.getAttrPower(i))},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(t){this._name=t},enumerable:!0,configurable:!0}),e.prototype.getNameWithServer2=function(){return this._servId&&crossFieldControl.isCross?this.name+("\nS"+this._servId):this.name},Object.defineProperty(e.prototype,"guildAndName",{get:function(){var t=this.getNameWithServer(),e=this.camp>0&&campWarControl.isCampWar()?this.camp!=campWarControl.camp?"#FF0000":"#00FF00":null,i=0==this.guildID||void 0==this.guildID?t:"<font color='"+(e?e:this.guildID==unionWarControl.getModel().winGuildInfo.guildId?"#ffb243":this.guildID==unionControl.guildID?"#5add70":"#2CC2F8")+"}'>"+this.guildName+"</font>\n"+this.name;if(this.lilianLv>0){var o=DataCenter.ins().ExperienceKingLevelConfig[this.lilianLv];if(o.type>1){var n=Math.min(o.type,8),r=LangMgr.getValueByKey("experienceKingColor"+n);i+=" <font color="+(e?e:r)+">["+o.trainName+"]</font>"}}return i},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lilianUrl",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lv",{get:function(){return this._lv},enumerable:!0,configurable:!0}),e.prototype.getEquipByIndex=function(t){return this.equipsData[t]},e.prototype.hideWeapons=function(){var t=this.getEquipByIndex(0).item.configID;return 5==ItemUtils.getQuality(DataCenter.ins().ItemConfig[t])?!0:this.zhuangbei[1]>0?DataCenter.ins().EquipConfig[t]&&DataCenter.ins().EquipConfig[t].noWSoulEff>=1||-1!=DataCenter.ins().FashionConfig.effOpen.indexOf(this.zhuangbei[1]):!1},e.prototype.getEquipLen=function(){return this.equipsData.length},e.prototype.getExRingsData=function(t){return this.exRingsData[t]},e.prototype.setExRingsData=function(t,e){this.exRingsData[t]=e},e.isAllDie=function(t){var e=UnitMgr.ins().getMasterList(t?t.masterHandle:ActorControl.handle);if(!e||0==e.length)return!0;for(var i=0,o=e.length,n=0;o>n;n++){var r=e[n],a=r.infoModel.getAtt(0)||0;i+=a}return 0>=i},e}(UnitModel);__reflect(RoleModel.prototype,"RoleModel");var TransferModel=function(t){function e(){var e=t.call(this)||this;return e.type=101,e}return __extends(e,t),Object.defineProperty(e.prototype,"avatarFileName",{get:function(){return PATH_EFF+"movestand"},enumerable:!0,configurable:!0}),e}(NpcModel);__reflect(TransferModel.prototype,"TransferModel"),window.UnitAction=UnitAction,window.EffectModel=EffectModel,window.NpcModel=NpcModel,window.BaseEuiView=BaseEuiView,window.PlatformBase=PlatformBase,window.UnitEffect=UnitEffect,window.ItemBase=ItemBase,window.StartLoading=StartLoading,window.RoleItemRenderer=RoleItemRenderer,window.FeatherDeityItemRenderer=FeatherDeityItemRenderer,window.GreetView=GreetView,window.BaseScene=BaseScene,window.RambleBaseVo=RambleBaseVo,window.RambleMainView=RambleMainView,window.GameLoadingUI=GameLoadingUI,window.BaseSystem=BaseSystem,window.PlatformX7sy=PlatformX7sy,window.PlatformZwH5=PlatformZwH5,window.EuiLayer=EuiLayer,window.UnitModel=UnitModel,window.UnitMonster=UnitMonster,window.UnitNpc=UnitNpc,window.ByteConst=ByteConst,window.GuideViewBase=GuideViewBase,window.RegressionConfig=RegressionConfig,window.HeroControl=HeroControl,window.DataCenter=DataCenter,window.AssetAdapter=AssetAdapter,window.ThemeAdapter=ThemeAdapter,window.Currency=Currency,window.ActorControl=ActorControl,window.GameConst=GameConst,window.SkillConst=SkillConst,window.DamageControl=DamageControl,window.DamageContainer=DamageContainer,window.DamageDisplay=DamageDisplay,window.MapControl=MapControl,window.MapDisplay=MapDisplay,window.MapTile=MapTile,window.AnimaMgr=AnimaMgr,window.EntrustMgr=EntrustMgr,window.SwitchMgr=SwitchMgr,window.GameLayer=GameLayer,window.UIMgr=UIMgr,window.ActivationView=ActivationView,window.BubbleControl=BubbleControl,window.BubblePanel=BubblePanel,window.TalkPanel=TalkPanel,window.AppearanceControl=AppearanceControl,window.AttributeData=AttributeData,window.AttributeFormat=AttributeFormat,window.DieGuide=DieGuide,window.DropControl=DropControl,window.EquipPosAniVo=EquipPosAniVo,window.EquipVo=EquipVo,window.FlameMarkEffect=FlameMarkEffect,window.GameControl=GameControl,window.GameServer=GameServer,window.ItemData=ItemData,window.LookControl=LookControl,window.MoveControl=MoveControl,window.MultiKillControl=MultiKillControl,window.PayRewardVo=PayRewardVo,window.PayVo=PayVo,window.PromptControl=PromptControl,window.HintTargetData=HintTargetData,window.RankSubRoleVo=RankSubRoleVo,window.RewardVo=RewardVo,window.SkillVo=SkillVo,window.ArrowEffect=ArrowEffect,window.BitmapNumber=BitmapNumber,window.BossAttackButton=BossAttackButton,window.DropDown=DropDown,window.DropDownListItem=DropDownListItem,window.EasyLoading=EasyLoading,window.GainGoodsItem=GainGoodsItem,window.GainGoodsNoSkinItem=GainGoodsNoSkinItem,window.ItemBaseNoName=ItemBaseNoName,window.ItemBaseNoNameCanTap=ItemBaseNoNameCanTap,window.ItemBaseNoTap=ItemBaseNoTap,window.ItemBaseTimes=ItemBaseTimes,window.ItemIcon=ItemIcon,window.PriceIcon=PriceIcon,window.ProgressBarEff=ProgressBarEff,window.SkillEffPlayDisplay=SkillEffPlayDisplay,window.EffParam=EffParam,window.SkillEffConfig=SkillEffConfig,window.SkillEffPlayShow=SkillEffPlayShow,window.StarList=StarList,window.StarItem=StarItem,window.SuperRingTurnDisplayer=SuperRingTurnDisplayer,window.CrossServerSwitchView=CrossServerSwitchView,window.EquipNormalTipsView=EquipNormalTipsView,window.PowerPanel=PowerPanel,window.RoleSelectPanel=RoleSelectPanel,window.EquipNormalTipsItemRenderer=EquipNormalTipsItemRenderer,window.OtherRoleItemRenderer=OtherRoleItemRenderer,window.StageItemRenderer=StageItemRenderer,window.DailyRedBagControl=DailyRedBagControl,window.DailyRedBagPanel=DailyRedBagPanel,window.DailyRedBagLogsItemRenderer=DailyRedBagLogsItemRenderer,window.GMCommandView=GMCommandView,window.GMMemView=GMMemView,window.GMNetCalcItemRenderer=GMNetCalcItemRenderer,window.GMNetCalcView=GMNetCalcView,window.DownloadView=DownloadView,window.EmailUserControl=EmailUserControl,window.EmailDataVo=EmailDataVo,window.EmailDetailedView=EmailDetailedView,window.EmailPanel=EmailPanel,window.EmailItemRenderer=EmailItemRenderer,window.FeatherControl=FeatherControl,window.FeatherVo=FeatherVo,window.FeatherAptitudesTipsView=FeatherAptitudesTipsView,window.FeatherHintView=FeatherHintView,window.FeatherPanel=FeatherPanel,window.FeatherSkillTipsView=FeatherSkillTipsView,window.FeatherSoaringTipsView=FeatherSoaringTipsView,window.FeatherSkillItemRenderer=FeatherSkillItemRenderer,window.FeatherDeityRedPoint=FeatherDeityRedPoint,window.FeatherDeityForgeItemVo=FeatherDeityForgeItemVo,window.FeatherDeityForgeVo=FeatherDeityForgeVo,window.FeatherDeityVo=FeatherDeityVo,window.FeatherDeityComposePanel=FeatherDeityComposePanel,window.FeatherDeityForgePanel=FeatherDeityForgePanel,window.FeatherDeityPanel=FeatherDeityPanel,window.FeatherDeitySkillTipsView=FeatherDeitySkillTipsView,window.FeatherDeitySuitTipsView=FeatherDeitySuitTipsView,window.FeatherDeityTipsView=FeatherDeityTipsView,window.FeatherDeityTransferPanel=FeatherDeityTransferPanel,window.FeatherDeityView=FeatherDeityView,window.FeatherDeityComposeItemRenderer=FeatherDeityComposeItemRenderer,window.FeatherDeityForgeItemRendrere=FeatherDeityForgeItemRendrere,window.FeatherDeityItemItemRenderer=FeatherDeityItemItemRenderer,window.FeatherDeitySuitItemRenderer=FeatherDeitySuitItemRenderer,window.FlowerLogView=FlowerLogView,window.FlowerPanel=FlowerPanel,window.FlowerUseView=FlowerUseView,window.FlowerLogItemRenderer=FlowerLogItemRenderer,window.FlowerUseTargetItemRenderer=FlowerUseTargetItemRenderer,window.Greet1View=Greet1View,window.GuideControl=GuideControl,window.GuideConditionVo=GuideConditionVo,window.GuideArrow=GuideArrow,window.GuideArrow2=GuideArrow2,window.GuideEffectDisplay=GuideEffectDisplay,window.GuideUpgradeView=GuideUpgradeView,window.GuideView=GuideView,window.GuideSelectControl=GuideSelectControl,window.GuideSelectView=GuideSelectView,window.HelpControl=HelpControl,window.HelpView=HelpView,window.AshtarteSkillControl=AshtarteSkillControl,window.HookControl=HookControl,window.TotemSkillControl=TotemSkillControl,window.SkillBallMgt=SkillBallMgt,window.LeaseControl=LeaseControl,window.LeaseView=LeaseView,window.MeridiansControl=MeridiansControl,window.MeridiansVo=MeridiansVo,window.MeridiansPanel=MeridiansPanel,window.MeridiansItemRenderer=MeridiansItemRenderer,window.MerryshopView=MerryshopView,window.MythEquipControl=MythEquipControl,window.MythEquipRedPoint=MythEquipRedPoint,window.MythForgeVo=MythForgeVo,window.MythSlotVo=MythSlotVo,window.MythEquipPanel=MythEquipPanel,window.MythEquipView=MythEquipView,window.MythEquipSlotItemRenderer=MythEquipSlotItemRenderer,window.OfficeControl=OfficeControl,window.OfficeRedPoint=OfficeRedPoint,window.OfficeDailyAwardView=OfficeDailyAwardView,window.OfficePositionView=OfficePositionView,window.OfficeDailyAwardItemRenderer=OfficeDailyAwardItemRenderer,window.OfflineRewardView=OfflineRewardView,window.RambleBlackControl=RambleBlackControl,window.RambleControl=RambleControl,window.RambleCampVo=RambleCampVo,window.RambleEmojiRiceTextVo=RambleEmojiRiceTextVo,window.RambleEmojiVo=RambleEmojiVo,window.RambleHlpVo=RambleHlpVo,window.RambleInfoVo=RambleInfoVo,window.RambleKfBlackVo=RambleKfBlackVo,window.RambleSystemVo=RambleSystemVo,window.RambleEmojiView=RambleEmojiView,window.RambleInputView=RambleInputView,window.RamblePlayerTipsView=RamblePlayerTipsView,window.RambleTipsView=RambleTipsView,window.RambleUIView=RambleUIView,window.RambleView=RambleView,window.RambleGuildItemRenderer=RambleGuildItemRenderer,window.RambleKfBlackItemRenderer=RambleKfBlackItemRenderer,window.RambleListItem2Renderer=RambleListItem2Renderer,window.RambleListItem3Renderer=RambleListItem3Renderer,window.RambleListItemRenderer=RambleListItemRenderer,window.RambleSystemItemRenderer=RambleSystemItemRenderer,window.RegressionView=RegressionView,window.RenameView=RenameView,window.ClientStorage=ClientStorage,window.SetValueType=SetValueType,window.ServerStorage=ServerStorage,window.ClientSetBit=ClientSetBit,window.SettingView=SettingView,window.SignInControl=SignInControl,window.SignInPanel=SignInPanel,window.SignInItemRenderer=SignInItemRenderer,window.StarSunControl=StarSunControl,window.StarSunRedPoint=StarSunRedPoint,window.StarSunVo=StarSunVo,window.StarSunView=StarSunView,window.StarSunAttrsItemRenderer=StarSunAttrsItemRenderer,window.StarSunEnhanceTipsItemRenderer=StarSunEnhanceTipsItemRenderer,window.CreateRoleScene=CreateRoleScene,window.LoginScene=LoginScene,window.StartGameScene=StartGameScene,window.WXGameScene=WXGameScene,window.YYBGameScene=YYBGameScene,window.ThunderControl=ThunderControl,window.ThunderForgeVo=ThunderForgeVo,window.ThunderSuitCalcVo=ThunderSuitCalcVo,window.ThunderSuitVo=ThunderSuitVo,window.ThunderForgePanel=ThunderForgePanel,window.ThunderItemTipsView=ThunderItemTipsView,window.ThunderSkillTipsView=ThunderSkillTipsView,window.ThunderStrengthTipsView=ThunderStrengthTipsView,window.ThunderSuitPanel=ThunderSuitPanel,window.ThunderSuitTipsView=ThunderSuitTipsView,window.ThunderView=ThunderView,window.UnionBossControl=UnionBossControl,window.guildBossRankData=guildBossRankData,window.UnionControl=UnionControl,window.UnionCopyControl=UnionCopyControl,window.UnionRedPoint=UnionRedPoint,window.UnionStoreControl=UnionStoreControl,window.UnionWarControl=UnionWarControl,window.RobberStartInfoVo=RobberStartInfoVo,window.UnionApplyInfoVo=UnionApplyInfoVo,window.UnionCopyRankInfoVo=UnionCopyRankInfoVo,window.UnionListInfoVo=UnionListInfoVo,window.UnionMemberInfoVo=UnionMemberInfoVo,window.UnionMessageInfoVo=UnionMessageInfoVo,window.GuildRoleSkillInfo=GuildRoleSkillInfo,window.UnionSkillInfoVo=UnionSkillInfoVo,window.UnionStoreItemDataVo=UnionStoreItemDataVo,window.UnionStoreRecordInfoVo=UnionStoreRecordInfoVo,window.UnionTaskInfoVo=UnionTaskInfoVo,window.UnionWarModelVo=UnionWarModelVo,window.GuildRedRobInfo=GuildRedRobInfo,window.RankGuildInfo=RankGuildInfo,window.MyRankGuildInfo=MyRankGuildInfo,window.WinGuildInfo=WinGuildInfo,window.WarRankInfo=WarRankInfo,window.PointRewarddInfo=PointRewarddInfo,window.SelectInfoData=SelectInfoData,window.UnionApplyListView=UnionApplyListView,window.UnionApplyView=UnionApplyView,window.UnionCampFirePanel=UnionCampFirePanel,window.UnionChangeNameView=UnionChangeNameView,window.UnionConView=UnionConView,window.UnionCreateView=UnionCreateView,window.UnionInfoPanel=UnionInfoPanel,window.UnionListPanel=UnionListPanel,window.UnionManageBuildPanel=UnionManageBuildPanel,window.UnionMapView=UnionMapView,window.UnionMemberPanel=UnionMemberPanel,window.UnionNoticeView=UnionNoticeView,window.UnionShopPanel=UnionShopPanel,window.UnionShopRecordView=UnionShopRecordView,window.UnionSkillPanel=UnionSkillPanel,window.UnionSkillView=UnionSkillView,window.UnionView=UnionView,window.UnionAppltListItemRender=UnionAppltListItemRender,window.UnionBuildItemRender=UnionBuildItemRender,window.UnionEventItenRender=UnionEventItenRender,window.UnionListItem2Render=UnionListItem2Render,window.UnionListItemRender=UnionListItemRender,window.UnionMapMemberItemRender=UnionMapMemberItemRender,window.UnionMemberItem1Render=UnionMemberItem1Render,window.UnionMemberItem2Render=UnionMemberItem2Render,window.UnionShopRecordItemRender=UnionShopRecordItemRender,window.UnionTaskItemRender=UnionTaskItemRender,window.UnionBossDetailView=UnionBossDetailView,window.UnionBossRankView=UnionBossRankView,window.UnionBossView=UnionBossView,window.UnionBossItemRender=UnionBossItemRender,window.UnionBossRankItemRender=UnionBossRankItemRender,window.DailyAwardView=DailyAwardView,window.DailyPresidentAwardView=DailyPresidentAwardView,window.SelectMemberRewardView=SelectMemberRewardView,window.SelectMemberView=SelectMemberView,window.UnionWarMainView=UnionWarMainView,window.UnionWarMemView=UnionWarMemView,window.UnionWarReliveView=UnionWarReliveView,window.UnionWarResultView=UnionWarResultView,window.UnionWarRewardView=UnionWarRewardView,window.UnionWarRulesView=UnionWarRulesView,window.UnionWarTipsView=UnionWarTipsView,window.UnionWarUiInfoView=UnionWarUiInfoView,window.MemberItem3Render=MemberItem3Render,window.PersonRewardItemRender=PersonRewardItemRender,window.SelectRewardItemRender=SelectRewardItemRender,window.UnionInteRankItemRender=UnionInteRankItemRender,window.UnionInteRewardItemRender=UnionInteRewardItemRender,window.UnionWarMemberHeadItemRender=UnionWarMemberHeadItemRender,window.UnionWarMemListItemRender=UnionWarMemListItemRender,window.PersonalInteRankInfoPanel=PersonalInteRankInfoPanel,window.PersonInteRewardInfoPanel=PersonInteRewardInfoPanel,window.UnionInteRankInfoPanel=UnionInteRankInfoPanel,window.UnionInteRewardInfoPanel=UnionInteRewardInfoPanel,window.RedBagDetailsView=RedBagDetailsView,window.RedBagView=RedBagView,window.RedBagItemRender=RedBagItemRender,window.WarnControl=WarnControl,window.DangerWarnView=DangerWarnView,window.ShopWarnView=ShopWarnView,window.WarnView=WarnView,window.SocketConnection=SocketConnection,window.CommonFun=CommonFun,window.EgretModify=EgretModify,window.ItemUtils=ItemUtils,window.LinkUtils=LinkUtils,window.Md5Utils=Md5Utils,window.Sha1Utils=Sha1Utils,window.SoundUtils=SoundUtils,window.GameLoadingMJ=GameLoadingMJ,window.GameLoadingQTT=GameLoadingQTT,window.GameLoadingZGBY=GameLoadingZGBY,window.LoadingUI=LoadingUI,window.ResVersionMgr=ResVersionMgr,window.GlobalModel=GlobalModel,window.PHPConfig=PHPConfig,window.Platform7724H5=Platform7724H5,window.Platform99KH5=Platform99KH5,window.PlatformAiwanH5=PlatformAiwanH5,window.PlatformAiwanH5WD=PlatformAiwanH5WD,window.PlatformBraintree=PlatformBraintree,window.PlatformBZ=PlatformBZ,window.PlatformBZH5=PlatformBZH5,window.PlatformCandyH5=PlatformCandyH5,window.PlatformCGamex=PlatformCGamex,window.PlatformChengZi=PlatformChengZi,window.PlatformGame8UH5=PlatformGame8UH5,window.PlatformHaoWanBaH5=PlatformHaoWanBaH5,window.PlatformHuaWei=PlatformHuaWei,window.PlatformHuoSdk=PlatformHuoSdk,window.PlatformHuoSdkH5=PlatformHuoSdkH5,window.PlatformJianwan=PlatformJianwan,window.PlatformJianwanH5=PlatformJianwanH5,window.PlatformJiuYuanH5=PlatformJiuYuanH5,window.PlatformJiuZun=PlatformJiuZun,window.PlatformJiuZunH5=PlatformJiuZunH5,window.PlatformKu25H5=PlatformKu25H5,window.PlatformLuoTuoH5=PlatformLuoTuoH5,window.PlatformOrange=PlatformOrange,window.PlatformOrangeH5=PlatformOrangeH5,window.PlatformQQMiniGame=PlatformQQMiniGame,window.PlatformQuick=PlatformQuick,window.PlatformQuickH5=PlatformQuickH5,window.PlatformQuickH5TY=PlatformQuickH5TY,window.PlatformQuickH5WD=PlatformQuickH5WD,window.PlatformQunHeiH5=PlatformQunHeiH5,window.PlatformQuTouTiaoCPL=PlatformQuTouTiaoCPL,window.PlatformQuTouTiaoH5=PlatformQuTouTiaoH5,window.PlatformSdwH5=PlatformSdwH5,window.PlatformSmileGamesH5=PlatformSmileGamesH5,window.PlatformSoeasyH5=PlatformSoeasyH5,window.PlatformTest=PlatformTest,window.PlatformTongChengH5=PlatformTongChengH5,window.PlatformUc=PlatformUc,window.PlatformUCMiniGame=PlatformUCMiniGame,window.PlatformUgame=PlatformUgame,window.PlatformUgameH5=PlatformUgameH5,window.PlatformWmsdH5=PlatformWmsdH5,window.PlatformWx=PlatformWx,window.PlatformX7syHW=PlatformX7syHW,window.PlatformXcH5=PlatformXcH5,window.PlatformXJH5=PlatformXJH5,window.PlatformXYouH5=PlatformXYouH5,window.PlatformYiYou=PlatformYiYou,window.PlatformYj=PlatformYj,window.PlatformYouQuH5=PlatformYouQuH5,window.PlatformYouQuIOS=PlatformYouQuIOS,window.PlatformYxH5=PlatformYxH5,window.PlatformYyb=PlatformYyb,window.ReportYybPayData=ReportYybPayData,window.PlatformZjH5=PlatformZjH5,window.PlatformZSH5=PlatformZSH5,window.PlatformZSWDH5=PlatformZSWDH5,window.PlatformZwWxMini=PlatformZwWxMini,window.PlatformZwWXMiniH5=PlatformZwWXMiniH5,window.ReportData=ReportData,window.HrInfo=HrInfo,window.SDKManager=SDKManager,window.UnitFilterUtils=UnitFilterUtils,window.UnitItem=UnitItem,window.UnitItemName=UnitItemName,window.UnitItemNameMerge=UnitItemNameMerge,window.UnitMiner=UnitMiner,window.UnitNpcHead=UnitNpcHead,window.UnitRole=UnitRole,window.UnitShadow=UnitShadow,window.UnitStatue=UnitStatue,window.UnitTransfer=UnitTransfer,window.UnitTransferHead=UnitTransferHead,window.UnitHideMgr=UnitHideMgr,window.UnitMgr=UnitMgr,window.UnitShowMgr=UnitShowMgr,window.BuffModel=BuffModel,window.ItemModel=ItemModel,window.MineModel=MineModel,window.RoleModel=RoleModel,window.TransferModel=TransferModel,window.generateEUI2=generateEUI2,window.PATH_ROOT=PATH_ROOT,window.PATH_MAP=PATH_MAP,window.PATH_RES=PATH_RES,window.PATH_EFF=PATH_EFF,window.PATH_WUQI=PATH_WUQI,window.PATH_RENWU=PATH_RENWU,window.PATH_CHIBANG=PATH_CHIBANG,window.PATH_GUAIWU=PATH_GUAIWU,window.PATH_SKILLEFF=PATH_SKILLEFF,window.PATH_SKILLJSON=PATH_SKILLJSON,window.PATH_PUBLIC=PATH_PUBLIC,window.WUQI_PREFIX=WUQI_PREFIX,window.RENWU_PREFIX=RENWU_PREFIX,window.CHIBANG_PREFIX=CHIBANG_PREFIX,window.GUAIWU_PREFIX=GUAIWU_PREFIX,window.IntensifyConst=IntensifyConst;